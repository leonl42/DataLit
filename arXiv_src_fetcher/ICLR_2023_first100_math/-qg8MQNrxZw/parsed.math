('1', '1/64')
('1', '\\mathcal{O}((H+W)HW)')
('1', '\\mathcal{O}(HW)')
('3.1.1', '\\mathbf{x}_{s}')
('3.1.1', '\\downarrow')
('3.1.1', '\\bigotimes')
('3.1.1', '\\downarrow')
('3.1.1', '\\bigotimes')
('3.1.2', '\\mathbf{x}_{s}')
('3.1.3', '1\\times 1')
('3.2', '\\mathbf{y}_{o}=\\sum_{p\\in\\mathcal{G}(o)}\\text{softmax}_{p}\\left(\\mathbf{q}_{o}%\n^{\\top}\\mathbf{k}_{p}\\right)\\mathbf{v}_{p}')
('3.2', '\\mathbf{x}\\in\\mathbb{R}^{H\\times W\\times C}')
('3.2', '\\mathbf{q,k,v}')
('3.2', '\\mathbf{x}')
('3.2', '\\mathbf{q}=\\mathbf{W}_{q}\\mathbf{x},\\mathbf{k}=\\mathbf{W}_{k}\\mathbf{x},%\n\\mathbf{v}=\\mathbf{W}_{v}\\mathbf{x}')
('3.2', '\\mathbf{W}_{q},\\mathbf{W}_{k}\\in\\mathbb{R}^{C_{qk}\\times C},\\mathbf{W}_{v}\\in%\n\\mathbb{R}^{C_{v}\\times C}')
('3.2', '\\mathcal{G}(o)')
('3.2', 'o=(i,j)')
('3.2', 'H\\times W\\times C')
('3.2', '\\mathcal{O}(H^{2}W^{2}(C_{qk}+C_{v}))')
('3.2', '\\displaystyle\\mathbf{y}_{o}=\\sum_{p\\in\\mathcal{N}_{m\\times m}(o)}\\text{softmax%\n}_{p}\\left(\\mathbf{q}_{o}^{\\top}\\mathbf{k}_{p}\\right)\\mathbf{v}_{p}')
('3.2', '\\displaystyle\\mathbf{y}_{o}')
('3.2', '\\displaystyle=\\sum_{p\\in\\mathcal{N}_{m\\times m}(o)}\\text{softmax}_{p}\\left(%\n\\mathbf{q}_{o}^{\\top}\\mathbf{k}_{p}\\right)\\mathbf{v}_{p}')
('3.2', '\\begin{split}\\mathbf{y}_{o}=\\sum_{p\\in\\mathcal{N}_{1\\times W}(o)}\\text{softmax%\n}_{p}\\left(\\mathbf{q}_{o}^{\\top}\\mathbf{k}_{p}\\right)\\mathbf{v}_{p}\\\\\n~{}~{}~{}+\\sum_{p\\in\\mathcal{N}_{H\\times 1}(o)}\\text{softmax}_{p}\\left(\\mathbf%\n{q}_{o}^{\\top}\\mathbf{k}_{p}\\right)\\mathbf{v}_{p}\\end{split}')
('3.2', '\\mathcal{O}(m^{2}HW(C_{qk}+C_{v}))=\\mathcal{O}(HW)')
('3.2', '\\mathcal{N}_{m\\times m}(o)')
('3.2', 'm\\times m')
('3.2', 'o')
('3.2', '\\mathcal{O}((H+W)HW(C_{qk}+C_{v}))=\\mathcal{O}((HW)^{1.5})')
('3.2', '\\mathcal{N}_{H\\times 1}(o)')
('3.2', 'o')
('3.2', '\\mathcal{N}_{1\\times W}(o)')
('3.2', 'o')
('3.2', '\\begin{split}\\mathbf{q}_{(h)}=\\frac{1}{W}\\left(\\mathbf{q}^{\\rightarrow(H,C_{qk%\n},W)}\\mathbf{A}_{W}^{\\rightarrow(H,W,1)}\\right)^{\\rightarrow(H,C_{qk})}\\\\\n\\mathbf{q}_{(v)}=\\frac{1}{H}\\left(\\mathbf{q}^{\\rightarrow(W,C_{qk},H)}\\mathbf{%\nA}_{H}^{\\rightarrow(W,H,1)}\\right)^{\\rightarrow(W,C_{qk})}\\end{split}')
('3.2.1', '\\mathbf{q},\\mathbf{k},\\mathbf{v}')
('3.2.1', '\\mathbf{x}')
('3.2.1', '\\mathbf{W}_{q}^{(s)},\\mathbf{W}_{k}^{(s)}\\in\\mathbb{R}^{C_{qk}\\times C},%\n\\mathbf{W}_{v}^{(s)}\\in\\mathbb{R}^{C_{v}\\times C}')
('3.2.1', '\\mathbf{z}^{\\rightarrow(\\cdot)}')
('3.2.1', '\\mathbf{z}')
('3.2.1', '\\mathbf{A}')
('3.2.1', '\\mathbf{x}')
('3.2.1', '\\times')
('3.2.1', '\\mathbf{q}')
('3.2.1', '\\mathbf{k}')
('3.2.1', '\\mathbf{v}')
('3.2.1', '\\mathbf{q}_{(h)},\\mathbf{k}_{(h)},\\mathbf{v}_{(h)}\\in\\mathbb{R}^{H\\times C_{qk}}')
('3.2.1', '\\mathbf{q}_{(v)},\\mathbf{k}_{(v)},\\mathbf{v}_{(v)}\\in\\mathbb{R}^{W\\times C_{qk}}')
('3.2.1', '\\begin{split}\\mathbf{y}_{(i,j)}=\\sum_{p=1}^{H}\\text{softmax}_{p}\\left(\\mathbf{%\nq}_{(h)i}^{\\top}\\mathbf{k}_{(h)p}\\right)\\mathbf{v}_{(h)p}\\\\\n+\\sum_{p=1}^{W}\\text{softmax}_{p}\\left(\\mathbf{q}_{(v)j}^{\\top}\\mathbf{k}_{(v)%\np}\\right)\\mathbf{v}_{(v)p}\\end{split}')
('3.2.1', '\\times')
('3.2.1', '\\mathbf{q},\\mathbf{k},\\mathbf{v}')
('3.2.1', '\\mathcal{O}(HW(2C_{qk}+C_{v}))')
('3.2.1', '\\mathcal{O}((H^{2}+W^{2})(C_{qk}+C_{v}))')
('3.2.1', '\\mathcal{O}(HW(2C_{qk}+C_{v}))')
('3.2.1', '\\mathcal{O}(HW)')
('3.2.2', '\\mathbf{q}_{(h)}')
('3.2.2', '\\mathbf{k}_{(h)}')
('3.2.2', '\\mathbf{r}_{(h)}^{q},\\mathbf{r}_{(h)}^{k}\\in\\mathbb{R}^{H\\times C_{qk}}')
('3.2.2', '\\mathbf{B}_{(h)}^{q},\\mathbf{B}_{(h)}^{k}\\in\\mathbb{R}^{L\\times C_{qk}}')
('3.2.2', 'L')
('3.2.2', '\\mathbf{r}_{(v)}^{q},\\mathbf{r}_{(v)}^{k}\\in\\mathbb{R}^{W\\times C_{qk}}')
('3.2.2', '\\mathbf{q}_{(v)},\\mathbf{k}_{(v)}')
('3.2.2', '\\bigoplus')
('3.2.2', '\\bigoplus')
('3.2.2', '\\begin{split}\\mathbf{y}_{(i,j)}=\\sum_{p=1}^{H}\\text{softmax}_{p}\\left((\\mathbf%\n{q}_{(h)i}+\\mathbf{r}_{(h)i}^{q})^{\\top}(\\mathbf{k}_{(h)p}+\\mathbf{r}_{(h)p}^{%\nk})\\right)\\mathbf{v}_{(h)p}\\\\\n+\\sum_{p=1}^{W}\\text{softmax}_{p}\\left((\\mathbf{q}_{(v)j}+\\mathbf{r}_{(v)j}^{q%\n})^{\\top}(\\mathbf{k}_{(v)p}+\\mathbf{r}_{(v)p}^{k})\\right)\\mathbf{v}_{(v)p}\\end%\n{split}')
('3.2.3', '\\mathbf{q},\\mathbf{k},\\mathbf{v}')
('3.2.3', '\\mathbf{x}')
('3.2.3', '\\mathbf{W}_{q}^{(e)},\\mathbf{W}_{k}^{(e)}\\in\\mathbb{R}^{C_{qk}\\times C},%\n\\mathbf{W}_{v}^{(e)}\\in\\mathbb{R}^{C_{v}\\times C}')
('3.2.3', '\\times')
('3.2.3', '\\times')
('3.2.3', '\\mathbf{q},\\mathbf{k},\\mathbf{v}')
('3.2.3', '(2C_{qk}+C_{v})')
('3.2.3', 'C')
('3.2.3', '\\times')
('3.2.3', '\\mathcal{O}(3^{2}HW(2C_{qk}+C_{v}))')
('3.2.3', '\\times')
('3.2.3', '\\mathcal{O}(HWC(2C_{qk}+C_{v}))')
('3.2.4', 'C_{qk}=0.5C_{v}')
('3.2.4', '\\begin{split}&\\mathcal{O}((H^{2}+W^{2})(C_{qk}+C_{v})+\\mathcal{O}(2HW(2C_{qk}+%\nC_{v}))\\\\\n&+\\mathcal{O}((HWC+9HW)(2C_{qk}+C_{v}))\\\\\n&=\\mathcal{O}((1.5H^{2}+1.5W^{2}+4HW)C_{v})\\\\\n&+\\mathcal{O}((2HWC+18HW)C_{v})\\\\\n&=\\mathcal{O}(HW)\\end{split}')
('3.2.4', 'H=W')
('3.2.5', '512\\times 512')
('3.4', 'F_{s\\_i}')
('3.4', 'F_{t\\_i}')
('3.4', 'F_{s\\_spatial}')
('3.4', 'F_{t\\_spatial}')
('3.4', 'F_{s\\_i}')
('3.4', 'F_{t\\_i}')
('3.4', 'F_{s\\_spatial}')
('3.4', 'F_{t\\_spatial}')
('3.4.2', '\\begin{split}\\mathcal{L}=\\mathcal{L}_{cls}+\\mathcal{L}_{cross}+\\mathcal{L}_{%\nfeat}+\\mathcal{L}_{out}\\\\\n\\end{split}')
('3.4.2', '\\mathcal{L}_{cls}')
('3.4.2', '\\mathcal{L}_{cross}')
('3.4.2', '\\mathcal{L}_{feat}')
('3.4.2', '\\mathcal{L}_{out}')
('4.3', 'C_{in}')
('4.3', 'C_{q}+C_{k}+C_{v}')
('4.3', 'C_{in}')
('4.3', 'C_{in}')
('4.3', 'C_{in}')
('4.3', 'C_{q}+C_{k}+C_{v}')
('4.3', 'C_{in}')
('4.3', 'C_{in}')
