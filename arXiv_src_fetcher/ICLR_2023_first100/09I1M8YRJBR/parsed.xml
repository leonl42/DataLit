<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/09I1M8YRJBR"?>
<?latexml class="article"?>
<?latexml package="amsmath,graphicx,mlspconf"?>
<?latexml package="multirow"?>
<?latexml package="tabularray"?>
<?latexml package="amssymb"?>
<?latexml package="array"?>
<?latexml package="tablefootnote"?>
<?latexml package="tikz"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <para xml:id="p1">
    <ERROR class="undefined">\usetikzlibrary</ERROR>
    <p>decorations.pathreplacing
<ERROR class="undefined">\usetikzlibrary</ERROR>arrows




































<ERROR class="undefined">\name</ERROR>Katsiaryna Haitsiukevich, Onur Poyraz, Pekka Marttinen, Alexander Ilin
<ERROR class="undefined">\address</ERROR><!--  %**** main˙arxiv.tex Line 75 **** -->Department of Computer Science, Aalto University, Espoo, Finland</p>
  </para>
  <title>Diffusion models as probabilistic neural operators for recovering unobserved states of dynamical systems</title>
  <abstract name="Abstract">
    <p>This paper explores the efficacy of diffusion-based generative models as neural operators for partial differential equations (PDEs). Neural operators are neural networks that learn a mapping from the parameter space to the solution space of PDEs from data, and they can also solve the inverse problem of estimating the parameter from the solution. Diffusion models excel in many domains, but their potential as neural operators has not been thoroughly explored. In this work, we show that diffusion-based generative models exhibit many properties favourable for neural operators, and they can effectively generate the solution of a PDE conditionally on the parameter or recover the unobserved parts of the system. We propose to train a single model adaptable to multiple tasks, by alternating between the tasks during training. In our experiments with multiple realistic dynamical systems, diffusion models outperform other neural operators. Furthermore, we demonstrate how the probabilistic diffusion model can elegantly deal with systems which are only partially identifiable, by producing samples corresponding to the different possible solutions.</p>
  </abstract>
  <para xml:id="p2">
    <ERROR class="undefined">{keywords}</ERROR>
    <p>Diffusion Models, Neural Operator, Physical Systems Modelling, Partial Differential Equations</p>
  </para>
  <section inlist="toc" labels="LABEL:sec:intro" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>Physical dynamical systems can be expressed with partial differential equations (PDEs) and traditionally solved using methods like the finite difference method. This conventional approach cannot easily incorporate measurements of the process, which motivates the development of neural network methods that can combine the prior knowledge with data-driven learning.
Differential equations can be combined with neural networks by integrating the PDEs directly into the architecture
<cite class="ltx_citemacro_cite">[<bibref bibrefs="greydanus2019hamiltonian,haitsiukevich2021agrid" separator="," yyseparator=","/>]</cite>
or by including the PDE error in the loss to represent prior knowledge
<cite class="ltx_citemacro_cite">[<bibref bibrefs="raissi2019pinn" separator="," yyseparator=","/>]</cite>.
The first option complies with the underlying physics by design, but is system-specific and non-trivial to extend. In the second approach the architecture does not depend on the equations but the training requires the functional form of the equations and knowledge of the parameters, which may be unavailable.
Alternatively, it is possible to incorporate domain knowledge through a physics simulator, which can be integrated into the network architecture <cite class="ltx_citemacro_cite">[<bibref bibrefs="yang2022learning" separator="," yyseparator=","/>]</cite> or utilized to augment the training data <cite class="ltx_citemacro_cite">[<bibref bibrefs="lam2023learning" separator="," yyseparator=","/>]</cite>.
The simulator allows to collect a rich data set from the underlying process by randomizing its parameters, which alleviates the need for system identification at inference time, enables a wider class of models, and increases robustness against noise and distortions in the data. If the PDE is known at test time, it can be used to fine-tune the model’s prediction <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021physics" separator="," yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Neural operators are data-driven and learn a mapping from the input parameters or observations to the output. Most of them are deterministic, which suffices for approximating the mapping from the PDE parameters to the solution. However, for the inverse problems of recovering parameters or reconstructing an unobserved state, deterministic predictions may not capture all possible outcomes. To resolve this, we opt for probabilistic generative models, the diffusion models <cite class="ltx_citemacro_cite">[<bibref bibrefs="sohl2015deep,ho2020denoising" separator="," yyseparator=","/>]</cite><!--  %**** main˙arxiv.tex Line 100 **** -->, which have excelled in many domains.
We view the system state evolution, discretized across spacial and temporal dimensions, as an image with state variables stacked as channels. Consequently, the reconstruction of an unobserved state is analogous to a color restoration task. The diffusion models can be pre-trained on complete image data, and conditioning applied only at inference time <cite class="ltx_citemacro_cite">[<bibref bibrefs="lugmayr2022repaint" separator="," yyseparator=","/>]</cite>.
This ‘unconditional’ approach, called RePaint in <cite class="ltx_citemacro_cite">[<bibref bibrefs="lugmayr2022repaint" separator="," yyseparator=","/>]</cite>, is adaptable to many use cases, but with increased inference complexity. Alternatively, the model’s input can be augmented with the conditioning information already during training <cite class="ltx_citemacro_cite">[<bibref bibrefs="saharia2022palette,yang2023uni" separator="," yyseparator=","/>]</cite>, yielding a specialized model suitable for a single task. A similar approach has been used for multivariate time series prediction and imputation <cite class="ltx_citemacro_cite">[<bibref bibrefs="alcaraz2023diffusionbased" separator="," yyseparator=","/>]</cite>.</p>
    </para>
    <para xml:id="S1.p3">
      <p>Our novel contributions are: <text font="bold">1)</text> We define and compare multiple diffusion models for unobserved state reconstruction and prediction. Unlike existing works in this domain <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier,li2023transformer" separator="," yyseparator=","/>]</cite>,
we train our model with a ‘mixed conditional’ objective, allowing it to solve multiple tasks with a single training (see Fig. <ref labelref="LABEL:f:method_overview"/>).
<text font="bold">2)</text> We empirically demonstrate the strong performance of diffusion models in general, and the model with mixed conditional training in particular, against other neural operator baselines. <text font="bold">3)</text> We study systems which are not fully identifiable, and demonstrate that diffusion models can represent the variability of possible solutions.</p>
    </para>
    <figure inlist="lof" labels="LABEL:f:method_overview" placement="t" xml:id="S1.F1">
      <tags>
        <tag>Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <ERROR class="ltx_centering ltx_figure_panel undefined">{tblr}</ERROR>
      <break class="ltx_break"/>
      <p align="center" class="ltx_figure_panel">colspec = X[0.19,c,h] X[0.1,r,0.015] X[0.1,r,0.015] — X[0.19,c,h] — X[0.45,c,h] ,
cell12 = c=1c, stretch = ,
rowsep = 1pt,

<tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center">Full PDE solution</td>
            </tr>
          </tbody>
        </tabular>
&amp;
 <ERROR class="undefined">\SetCell</ERROR>[r=2]h <inline-block angle="90" depth="0.0pt" height="0.0pt" innerdepth="0.0pt" innerheight="0.0pt" innerwidth="0.0pt" width="0.0pt" xtranslate="0pt" ytranslate="0pt"/>
 <tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center">Conditional</td>
            </tr>
          </tbody>
        </tabular>  <tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center">Mixed Conditional (M-CEDM)</td>
            </tr>
          </tbody>
        </tabular>
<break/>
<tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center"><text fontsize="80%">Desired output</text></td>
            </tr>
          </tbody>
        </tabular><text fontsize="80%">    <tabular vattach="middle">
            <tbody>
              <tr>
                <td align="center">Model 1     …    Model <Math mode="inline" tex="5" text="5" xml:id="S1.F1.m1">
                    <XMath>
                      <XMTok meaning="5" role="NUMBER">5</XMTok>
                    </XMath>
                  </Math></td>
              </tr>
            </tbody>
          </tabular>  <tabular vattach="middle">
            <tbody>
              <tr>
                <td align="center">Single model</td>
              </tr>
            </tbody>
          </tabular> <break/><break/><!--  %**** main˙arxiv.tex Line 125 **** -->
<ERROR class="undefined">\SetCell</ERROR>[r=3]c
<inline-block class="ltx_parbox" vattach="top" width="68.3pt">
            <ERROR class="undefined">{tikzpicture}</ERROR>
            <p>[baseline=-115]
<ERROR class="undefined">\draw</ERROR>[-¿] (-1.4,-5.5) – (0.1, -5.5) node[below right, pos=0.8] <Math mode="inline" tex="t" text="t" xml:id="S1.F1.m2">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                </XMath>
              </Math>;
<ERROR class="undefined">\draw</ERROR>[-¿] (-1.4,-5.5) – (-1.4, -2.3) node[above left, pos=0.9] <Math mode="inline" tex="x" text="x" xml:id="S1.F1.m3">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                </XMath>
              </Math>;


<text yoffset="-0.5pt"><graphics candidates="img/systems/swe2_1000.pdf" graphic="img/systems/swe2_1000.pdf" options="height=76.82243pt,trim=22.76219pt 2.84526pt 2.84526pt 2.84526pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g1"/></text>
<inline-block angle="90" depth="36.4pt" height="40.4pt" innerdepth="1.6pt" innerheight="5.6pt" innerwidth="76.9pt" width="7.1pt" xtranslate="-34.88pt" ytranslate="2.33pt">
                <p>Velocity <Math mode="inline" tex="u" text="u" xml:id="S1.F1.m4">
                    <XMath>
                      <XMTok font="italic" role="UNKNOWN">u</XMTok>
                    </XMath>
                  </Math>     Height <Math mode="inline" tex="h" text="h" xml:id="S1.F1.m5">
                    <XMath>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                    </XMath>
                  </Math></p>
              </inline-block></p>
          </inline-block></text></p>
      <break class="ltx_break"/>
      <inline-block align="center" angle="90" class="ltx_figure_panel" depth="26.4pt" height="30.8pt" innerdepth="1.8pt" innerheight="6.1pt" innerwidth="57.3pt" width="7.9pt" xtranslate="-24.69pt" ytranslate="2.63pt">
        <p><text fontsize="90%">Training input</text></p>
      </inline-block>
      <break class="ltx_break"/>
      <graphics candidates="img/diff_cases/case1_tr.pdf" class="ltx_centering ltx_figure_panel" graphic="img/diff_cases/case1_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g2"/>
      <ERROR class="ltx_centering ltx_figure_panel undefined">{tikzpicture}</ERROR>
      <break class="ltx_break"/>
      <p align="center" class="ltx_figure_panel"><text fontsize="80%">[baseline=-30]
<ERROR class="undefined">\draw</ERROR><!--  %**** main˙arxiv.tex Line 150 **** -->[dashed] (1,-1) – (1,1);

   
<graphics candidates="img/diff_cases/case5_tr.pdf" graphic="img/diff_cases/case5_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g3"/>
 <graphics candidates="img/diff_cases/case1_tr.pdf" graphic="img/diff_cases/case1_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g4"/>
<graphics candidates="img/diff_cases/case2_tr.pdf" graphic="img/diff_cases/case2_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g5"/>
<graphics candidates="img/diff_cases/case3_tr.pdf" graphic="img/diff_cases/case3_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g6"/>
<graphics candidates="img/diff_cases/case4_tr.pdf" graphic="img/diff_cases/case4_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g7"/>
<ERROR class="undefined">{tikzpicture}</ERROR>[baseline=-40]
<ERROR class="undefined">\draw</ERROR>[decorate,decoration=brace,amplitude=10pt,mirror,raise=4pt,yshift=0pt] (-1.5,-1.5) – (-1.5, 0.85) node [black,midway,xshift=0.8cm]        <Math mode="inline" tex="\thicksim" text="thicksim" xml:id="S1.F1.m6">
            <XMath>
              <XMTok name="thicksim" role="RELOP">∼</XMTok>
            </XMath>
          </Math>     ;
<ERROR class="undefined">\node</ERROR>[text width=1cm] at (-0.3,0.25) <inline-block class="ltx_parbox" vattach="middle" width="22.8pt">
            <p>each batch</p>
          </inline-block>;
<ERROR class="undefined">\node</ERROR>[text width=1cm] at (-0.2,-0.5) <inline-block class="ltx_parbox" vattach="middle" width="8.5pt">
            <p><text fontsize="63%">i.i.d.</text></p>
          </inline-block>;</text></p>
      <break class="ltx_break"/>
      <graphics candidates="img/diff_cases/case4_tr.pdf" class="ltx_centering ltx_figure_panel" graphic="img/diff_cases/case4_tr.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g8"/>
      <break class="ltx_centering"/>
      <tabular class="ltx_centering ltx_figure_panel" vattach="middle">
        <tbody>
          <tr>
            <td align="center"><text fontsize="80%">Task 1     …     Task 5</text></td>
          </tr>
        </tbody>
      </tabular>
      <tabular class="ltx_centering ltx_figure_panel" vattach="middle">
        <tbody>
          <tr>
            <td align="center"><text fontsize="80%">Task 1       Task 2       Task 3       Task 4       Task 5</text></td>
          </tr>
        </tbody>
      </tabular>
      <break class="ltx_centering"/>
      <break class="ltx_centering"/>
      <inline-block align="center" angle="90" class="ltx_figure_panel" depth="27.5pt" height="32.0pt" innerdepth="1.8pt" innerheight="6.3pt" innerwidth="59.5pt" width="8.0pt" xtranslate="-25.76pt" ytranslate="2.63pt">
        <p><text fontsize="90%">Inference input</text></p>
      </inline-block>
      <graphics candidates="img/diff_cases/case1_inf.pdf" class="ltx_centering ltx_figure_panel" graphic="img/diff_cases/case1_inf.pdf" options="height=62.59605pt,trim=5.69054pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g9"/>
<!--  %**** main˙arxiv.tex Line 175 **** -->      <ERROR class="ltx_centering ltx_figure_panel undefined">{tikzpicture}</ERROR>
      <break class="ltx_break"/>
      <p align="center" class="ltx_figure_panel"><text fontsize="80%">[baseline=-30]
<ERROR class="undefined">\draw</ERROR>[dashed] (1,-1) – (1,1);

   
<graphics candidates="img/diff_cases/case5_inf.pdf" graphic="img/diff_cases/case5_inf.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g10"/>
 <graphics candidates="img/diff_cases/case1_inf.pdf" graphic="img/diff_cases/case1_inf.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g11"/>
 
<graphics candidates="img/diff_cases/case2_inf.pdf" graphic="img/diff_cases/case2_inf.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g12"/>
 
<graphics candidates="img/diff_cases/case3_inf.pdf" graphic="img/diff_cases/case3_inf.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g13"/>
 
<graphics candidates="img/diff_cases/case4_inf.pdf" graphic="img/diff_cases/case4_inf.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g14"/>
 
<graphics candidates="img/diff_cases/case5_inf.pdf" graphic="img/diff_cases/case5_inf.pdf" options="height=62.59605pt,trim=22.76219pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S1.F1.g15"/></text></p>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>Conditional and mixed conditional training of diffusion models demonstrated with the Shallow-Water Equation (SWE-orig). The system has two variables (channels) represented by the colored rectangles with time (<Math mode="inline" tex="t" text="t" xml:id="S1.F1.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">t</XMTok>
          </XMath>
        </Math>) and spatial coordinate (<Math mode="inline" tex="x" text="x" xml:id="S1.F1.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>) on the x- and y-axes. The ‘desired output’ is the full state which we train the model to reconstruct from partial information. The clean parts of the input represent the conditioning information (at training and inference time) and the noisy parts are reconstructed by denoising.
Each <text font="bold">conditional</text> model is trained with conditioning information for a single task. The <text font="bold">mixed conditional</text> training yields a single model for all defined tasks by sampling one task for each mini-batch during training.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 1</tag>Conditional and mixed conditional training of diffusion models demonstrated with the Shallow-Water Equation (SWE-orig). The system has two variables (channels) represented by the colored rectangles with time (<Math mode="inline" tex="t" text="t" xml:id="S1.F1.m9">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">t</XMTok>
          </XMath>
        </Math>) and spatial coordinate (<Math mode="inline" tex="x" text="x" xml:id="S1.F1.m10">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>) on the x- and y-axes. The ‘desired output’ is the full state which we train the model to reconstruct from partial information. The clean parts of the input represent the conditioning information (at training and inference time) and the noisy parts are reconstructed by denoising.
Each <text font="bold">conditional</text> model is trained with conditioning information for a single task. The <text font="bold">mixed conditional</text> training yields a single model for all defined tasks by sampling one task for each mini-batch during training.
</caption>
    </figure>
  </section>
  <section inlist="toc" labels="LABEL:sec:related_work" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Related work</title>
    <para xml:id="S2.p1">
      <p><text font="bold">Neural operators</text> <cite class="ltx_citemacro_cite">[<bibref bibrefs="kovachki2023neural" separator="," yyseparator=","/>]</cite> have strong performance in modelling of physical systems. State-of-the-art results on rectangular domains are produced by FNO <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier" separator="," yyseparator=","/>]</cite>. Recently proposed neural operators use the transformer architecture, e.g., OFormer <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2023transformer" separator="," yyseparator=","/>]</cite>.
Existing methods solve either the forward (parameters to solution) or the inverse (solution to parameters) problem. Unlike the neural operator approaches, a diffusion model can solve both of these problems at once by conditioning with known information. Concurrent to our work, <cite class="ltx_citemacro_cite">[<bibref bibrefs="long2024invertible" separator="," yyseparator=","/>]</cite> combines forward and inverse operators but in a non-diffusion model.</p>
    </para>
    <para xml:id="S2.p2">
      <p><text font="bold">Diffusion models for physical systems</text> have been successfully applied for predicting the dynamics of the system in the future, either by autoregressive unrolls <cite class="ltx_citemacro_cite">[<bibref bibrefs="kohl2023turbulent" separator="," yyseparator=","/>]</cite> or by taking the desired future time as a model input <cite class="ltx_citemacro_cite">[<bibref bibrefs="yang2023denoising" separator="," yyseparator=","/>]</cite>.
These models focus on prediction only while we consider training jointly for prediction and reconstruction. A work <cite class="ltx_citemacro_cite">[<bibref bibrefs="apte2023diffusion" separator="," yyseparator=","/>]</cite> utilized the diffusion model for data generation for several physical systems. It focused on unconditional generation that adheres to physical constraints of the system while we recover the unobserved states conditioned on partial information.</p>
    </para>
    <para xml:id="S2.p3">
      <p><text font="bold">Incorporation of PDE prior information into diffusion models</text>.
A physics-informed diffusion model <cite class="ltx_citemacro_cite">[<bibref bibrefs="bastek2024physics" separator="," yyseparator=","/>]</cite> includes a scaled PDE residual into the training objective, encouraging solutions that comply with the PDE. Alternatively, the gradient of the PDE residual guide the sampling <cite class="ltx_citemacro_cite">[<bibref bibrefs="jacobsen2023cocogen" separator="," yyseparator=","/>]</cite> or be directly fed into the model as an extra input channel during training <cite class="ltx_citemacro_cite">[<bibref bibrefs="shu2023physics" separator="," yyseparator=","/>]</cite>.
All of the approaches can be applied together with the methods in this paper.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Method</title>
    <figure inlist="lof" labels="LABEL:f:model_input" placement="t" xml:id="S3.F2">
      <tags>
        <tag>Figure 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <ERROR class="ltx_centering ltx_figure_panel undefined">{tblr}</ERROR>
      <break class="ltx_break"/>
      <p align="center" class="ltx_figure_panel"><!--  %**** main˙arxiv.tex Line 225 **** -->colspec = X[0.605,h],
cell12 = c=1c, stretch = 0,
rowsep = 0pt,

 <tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center"><text fontsize="90%">States to reconstruct</text></td>
            </tr>
          </tbody>
        </tabular>    <tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center"><text fontsize="90%">Conditioning</text></td>
            </tr>
          </tbody>
        </tabular>    <tabular vattach="middle">
          <tbody>
            <tr>
              <td align="center"><text fontsize="90%">Binary masks</text></td>
            </tr>
          </tbody>
        </tabular> <break/>
<break/><graphics candidates="img/diff_cases/model_inputs_flat_state.pdf" graphic="img/diff_cases/model_inputs_flat_state.pdf" options="height=36.98857pt,trim=5.69054pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S3.F2.g1"/>
<graphics candidates="img/diff_cases/model_inputs_flat_cond.pdf" graphic="img/diff_cases/model_inputs_flat_cond.pdf" options="height=36.98857pt,trim=5.69054pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S3.F2.g2"/>
<graphics candidates="img/diff_cases/model_inputs_flat_mask.pdf" graphic="img/diff_cases/model_inputs_flat_mask.pdf" options="height=36.98857pt,trim=5.69054pt 5.69054pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S3.F2.g3"/></p>
      <toccaption class="ltx_centering"><tag close=" ">2</tag>Model input for mixed conditional training.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 2</tag>Model input for mixed conditional training.
</caption>
    </figure>
    <subsection inlist="toc" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Background on diffusion models</title>
      <para xml:id="S3.SS1.p1">
        <p>Denoising diffusion probabilistic models (DDPMs) <cite class="ltx_citemacro_cite">[<bibref bibrefs="ho2020denoising" separator="," yyseparator=","/>]</cite> are a class of generative models which learn underlying data distribution by progressively removing noise from the distorted input. In particular, the training procedure requires defining a schedule for the magnitude of noise added to model input at every training iteration. The highest noise magnitude in the schedule makes the model input close to pure Gaussian noise. A neural network, predicting a denoised version of the input, is trained by optimizing a variational lower bound or a simplified objective <cite class="ltx_citemacro_cite">[<bibref bibrefs="ho2020denoising" separator="," yyseparator=","/>]</cite> between the added noise and the network prediction, or some other refined combinations (see, e.g., <cite class="ltx_citemacro_cite">[<bibref bibrefs="nichol2021improved,karras2022elucidating" separator="," yyseparator=","/>]</cite>).
Denoising diffusion models use the U-net architecture <cite class="ltx_citemacro_cite">[<bibref bibrefs="ronneberger2015u" separator="," yyseparator=","/>]</cite> with conditioning on the step <Math mode="inline" tex="t" text="t" xml:id="S3.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> of the noise schedule <cite class="ltx_citemacro_cite">[<bibref bibrefs="ho2020denoising" separator="," yyseparator=","/>]</cite>. The original architecture has been made more expressive by improvements in residual blocks <cite class="ltx_citemacro_cite">[<bibref bibrefs="song2020score,dhariwal2021diffusion" separator="," yyseparator=","/>]</cite> while inefficiencies in training dynamics have been remedied by input and output preconditioning <cite class="ltx_citemacro_cite">[<bibref bibrefs="karras2022elucidating" separator="," yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S3.SS1.p2">
        <p>One downside of diffusion models is the slow inference, which, starting from random noise, iteratively denoises the input into the final prediction. The original DDPM <cite class="ltx_citemacro_cite">[<bibref bibrefs="ho2020denoising" separator="," yyseparator=","/>]</cite> sampling uses the same number of steps as the training noise schedule (typically around 1000 steps). However, the number of inference steps can be significantly decreased by defining a separate inference schedule <cite class="ltx_citemacro_cite">[<bibref bibrefs="nichol2021improved,song2020denoising,karras2022elucidating" separator="," yyseparator=","/>]</cite>. The approaches <cite class="ltx_citemacro_cite">[<bibref bibrefs="nichol2021improved,song2020denoising" separator="," yyseparator=","/>]</cite> are uniformly skipping some steps in the training noise schedule. However, a better strategy for allocating the inference resources is skipping more steps in the beginning of the sampling process and preserving more steps closer to the end where the noise magnitude is smaller. This idea combined with a second order Heun method has been proposed by <cite class="ltx_citemacro_cite">[<bibref bibrefs="karras2022elucidating" separator="," yyseparator=","/>]</cite> and together with input and output preconditioning is referred to as EDM.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Mixed conditional training</title>
      <para xml:id="S3.SS2.p1">
        <p>We aim at training a model capable of solving several tasks, such as the unobserved state reconstruction, the system dynamics prediction from the parameter value, the underlying parameter recovery from the dynamics, and the prediction of future system states. The parameter values can be concatenated with the system states as an additional input channel making parameter recovery and dynamics prediction analogous to the state reconstruction task.
Similar problem formulation arises in image-to-image translation considered in Palette <cite class="ltx_citemacro_cite">[<bibref bibrefs="saharia2022palette" separator="," yyseparator=","/>]</cite> and in time series imputation and forecasting addressed in SSSD<sup>S4</sup> <cite class="ltx_citemacro_cite">[<bibref bibrefs="alcaraz2023diffusionbased" separator="," yyseparator=","/>]</cite>.
We propose to model the dynamics by a conditional diffusion model trained on a mixture of the tasks of interest as shown in Fig. <ref labelref="LABEL:f:method_overview"/>.</p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p>To simultaneously train for several tasks, we generate a mask corresponding to the unknown part of the system (e.g. upper or lower channel in Fig. <ref labelref="LABEL:f:method_overview"/>) for each training batch. For the observed channel(s), we sample the number of time steps observed (in the direction of the x-axis in Fig. <ref labelref="LABEL:f:method_overview"/>). For example, Task 3 in Fig. <ref labelref="LABEL:f:method_overview"/> corresponds to observing both channels partially for the first half of the time span, while in Tasks 4 and 5 only one channel is partially observed.</p>
      </para>
      <para xml:id="S3.SS2.p3">
        <p>Since a part of the full state is known, the diffusion process is applied only to the unobserved part. As shown in Fig. <ref labelref="LABEL:f:model_input"/>, the input for one denoising step consists of system states, such that noise is added to the unobserved part, and the observed part is kept noise free and given as conditioning information. The input is the same both at training and inference times. The conditioning information can be optionally accompanied by the corresponding binary masks as in SSSD<sup>S4</sup> which we also found beneficial. To take into account that the denoising should be applied only to the unknown part, the observed part is masked out from the loss.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Experiments</title>
    <figure inlist="lof" labels="LABEL:f:systems" placement="t" xml:id="S4.F3">
      <tags>
        <tag>Figure 3</tag>
        <tag role="refnum">3</tag>
        <tag role="typerefnum">Figure 3</tag>
      </tags>
      <ERROR class="ltx_centering ltx_figure_panel undefined">{tblr}</ERROR>
      <break class="ltx_break"/>
      <p align="center" class="ltx_figure_panel">colspec = X[0.05,r,0.015]X[0.17,c,h]X[0.05,r,0.015]X[0.30,h],
cell12 = c=1c, stretch = 0,
rowsep = 0pt,

<inline-block angle="90" depth="26.3pt" height="30.8pt" innerdepth="2.3pt" innerheight="6.8pt" innerwidth="57.2pt" width="9.0pt" xtranslate="-24.08pt" ytranslate="3.38pt">
          <p><text fontsize="90%">(a) Darcy flow</text></p>
        </inline-block>
&amp;  <graphics candidates="img/systems/darcy_0.pdf" graphic="img/systems/darcy_0.pdf" options="height=102.42992pt,trim=2.84526pt 2.84526pt 2.84526pt 2.84526pt,clip=true,keepaspectratio=true" xml:id="S4.F3.g1"/>
 <inline-block angle="90" depth="20.6pt" height="25.1pt" innerdepth="2.3pt" innerheight="6.8pt" innerwidth="45.7pt" width="9.0pt" xtranslate="-18.33pt" ytranslate="3.38pt">
          <p><text fontsize="90%">(b) Reactor</text></p>
        </inline-block>
 <graphics candidates="img/systems/reactor_1000.pdf" graphic="img/systems/reactor_1000.pdf" options="height=102.42992pt,trim=2.84526pt 2.84526pt 2.84526pt 2.84526pt,clip=true,keepaspectratio=true" xml:id="S4.F3.g2"/></p>
      <toccaption class="ltx_centering"><tag close=" ">3</tag>Example simulations from two of the studied systems.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 3</tag>Example simulations from two of the studied systems.
</caption>
    </figure>
    <table inlist="lot" labels="LABEL:tab:res_state1" placement="t" xml:id="S4.T1">
      <tags>
        <tag>Table 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Table 1</tag>
      </tags>
      <toccaption><tag close=" ">1</tag>
Model comparison on state reconstruction for the forward (Task 1, columns 2 – 4) and inverse (Task 2, columns 5 – 7) problems in case of identifiable systems. For each problem we present the mean absolute error (MAE) and the PDE residual error. All MAE values should be multiplied by <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S4.T1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.
</toccaption>
      <caption><tag close=": ">Table 1</tag>
Model comparison on state reconstruction for the forward (Task 1, columns 2 – 4) and inverse (Task 2, columns 5 – 7) problems in case of identifiable systems. For each problem we present the mean absolute error (MAE) and the PDE residual error. All MAE values should be multiplied by <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S4.T1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.
</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <tbody>
          <tr>
            <td align="center" border="r" rowspan="3" thead="row">Model</td>
            <td align="center" border="r" colspan="2" rowspan="2">Darcy, <Math mode="inline" tex="a\rightarrow u" text="a rightarrow u" xml:id="S4.T1.m3">
                <XMath>
                  <XMApp>
                    <XMTok name="rightarrow" role="ARROW">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" role="UNKNOWN">u</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="r" colspan="2" rowspan="2">SWE, <Math mode="inline" tex="h\rightarrow u" text="h rightarrow u" xml:id="S4.T1.m4">
                <XMath>
                  <XMApp>
                    <XMTok name="rightarrow" role="ARROW">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                    <XMTok font="italic" role="UNKNOWN">u</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="rr" colspan="2">Reactor,</td>
            <td align="center" border="r" colspan="2" rowspan="2">Darcy, <Math mode="inline" tex="u\rightarrow a" text="u rightarrow a" xml:id="S4.T1.m5">
                <XMath>
                  <XMApp>
                    <XMTok name="rightarrow" role="ARROW">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">u</XMTok>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="r" colspan="2" rowspan="2">SWE, <Math mode="inline" tex="u\rightarrow h" text="u rightarrow h" xml:id="S4.T1.m6">
                <XMath>
                  <XMApp>
                    <XMTok name="rightarrow" role="ARROW">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">u</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" colspan="2">Reactor,</td>
          </tr>
          <tr>
            <td align="center" border="rr" colspan="2"><Math mode="inline" tex="x_{p},T\rightarrow\theta,x_{a}" text="formulae@(list@(x _ p, T) rightarrow theta, x _ a)" xml:id="S4.T1.m7">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S4.T1.m7.2"/>
                      <XMRef idref="S4.T1.m7.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S4.T1.m7.2">
                        <XMTok name="rightarrow" role="ARROW">→</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S4.T1.m7.2.1"/>
                            <XMRef idref="S4.T1.m7.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S4.T1.m7.2.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.T1.m7.1">T</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S4.T1.m7.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math></td>
            <td align="center" colspan="2"><Math mode="inline" tex="\theta,x_{a}\rightarrow x_{p},T" text="formulae@(list@(theta, x _ a) rightarrow x _ p, T)" xml:id="S4.T1.m8">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S4.T1.m8.3"/>
                      <XMRef idref="S4.T1.m8.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S4.T1.m8.3">
                        <XMTok name="rightarrow" role="ARROW">→</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S4.T1.m8.1"/>
                            <XMRef idref="S4.T1.m8.3.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.T1.m8.1">θ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S4.T1.m8.3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.T1.m8.2">T</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" border="t"><text font="italic">MAE</text></td>
            <td align="center" border="r t"><text font="italic">PDE</text></td>
            <td align="center" border="t"><text font="italic">MAE</text></td>
            <td align="center" border="r t"><text font="italic">PDE</text></td>
            <td align="center" border="t"><text font="italic">MAE</text></td>
            <td align="center" border="rr t"><text font="italic">PDE</text></td>
            <td align="center" border="t"><text font="italic">MAE</text></td>
            <td align="center" border="r t"><text font="italic">PDE</text></td>
            <td align="center" border="t"><text font="italic">MAE</text></td>
            <td align="center" border="r t"><text font="italic">PDE</text></td>
            <td align="center" border="t"><text font="italic">MAE</text></td>
            <td align="center" border="t"><text font="italic">PDE</text></td>
          </tr>
          <tr>
            <td align="center" border="r t" thead="row">FNO <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier" separator="," yyseparator=","/>]</cite></td>
            <td align="center" border="t">7.55</td>
            <td align="center" border="r t">38.08</td>
            <td align="center" border="t">0.44</td>
            <td align="center" border="r t">0.9963</td>
            <td align="center" border="t">0.07</td>
            <td align="center" border="rr t">0.0146</td>
            <td align="center" border="t">3.38</td>
            <td align="center" border="r t">3.236</td>
            <td align="center" border="t">2.21</td>
            <td align="center" border="r t">1.1370</td>
            <td align="center" border="t">5.64</td>
            <td align="center" border="t">0.1132</td>
          </tr>
          <tr>
            <td align="center" border="r" thead="row">OFormer <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2023transformer" separator="," yyseparator=","/>]</cite></td>
            <td align="center">6.82</td>
            <td align="center" border="r">21.00</td>
            <td align="center">0.31</td>
            <td align="center" border="r">0.9966</td>
            <td align="center">0.13</td>
            <td align="center" border="rr">0.0083</td>
            <td align="center">4.06</td>
            <td align="center" border="r">6.683</td>
            <td align="center">0.81</td>
            <td align="center" border="r">0.9929</td>
            <td align="center">7.76</td>
            <td align="center">0.0282</td>
          </tr>
          <tr>
            <td align="center" border="r" thead="row">RePaint <cite class="ltx_citemacro_cite">[<bibref bibrefs="lugmayr2022repaint" separator="," yyseparator=","/>]</cite></td>
            <td align="center">9.80</td>
            <td align="center" border="r">6.909</td>
            <td align="center">0.69</td>
            <td align="center" border="r">1.0462</td>
            <td align="center">0.73</td>
            <td align="center" border="rr">0.1521</td>
            <td align="center">191.8</td>
            <td align="center" border="r">84.11</td>
            <td align="center">9.68</td>
            <td align="center" border="r">1.0429</td>
            <td align="center">188.3</td>
            <td align="center">0.2017</td>
          </tr>
          <tr>
            <td align="center" border="r" thead="row">CDDPM <cite class="ltx_citemacro_cite">[<bibref bibrefs="ho2020denoising" separator="," yyseparator=","/>]</cite></td>
            <td align="center">6.23</td>
            <td align="center" border="r">1.478</td>
            <td align="center">0.25</td>
            <td align="center" border="r">0.9925</td>
            <td align="center">0.09</td>
            <td align="center" border="rr">0.0039</td>
            <td align="center">0.25</td>
            <td align="center" border="r"><text font="bold">1.180</text></td>
            <td align="center">0.84</td>
            <td align="center" border="r"><text font="bold">0.9906</text></td>
            <td align="center">4.62</td>
            <td align="center">0.0039</td>
          </tr>
          <tr>
            <td align="center" border="r" thead="row">CEDM <cite class="ltx_citemacro_cite">[<bibref bibrefs="karras2022elucidating" separator="," yyseparator=","/>]</cite></td>
            <td align="center">5.52</td>
            <td align="center" border="r">1.344</td>
            <td align="center"><text font="bold">0.10</text></td>
            <td align="center" border="r">0.9923</td>
            <td align="center"><text font="bold">0.05</text></td>
            <td align="center" border="rr"><text font="bold">0.0015</text></td>
            <td align="center">0.18</td>
            <td align="center" border="r">1.192</td>
            <td align="center">0.44</td>
            <td align="center" border="r">0.9924</td>
            <td align="center">3.42</td>
            <td align="center"><text font="bold">0.0017</text></td>
          </tr>
          <tr>
            <td align="center" border="r t" thead="row">M-CEDM</td>
            <td align="center" border="t"><text font="bold">5.46</text></td>
            <td align="center" border="r t"><text font="bold">1.272</text></td>
            <td align="center" border="t"><text font="bold">0.10</text></td>
            <td align="center" border="r t"><text font="bold">0.9915</text></td>
            <td align="center" border="t">0.07</td>
            <td align="center" border="rr t">0.0020</td>
            <td align="center" border="t"><text font="bold">0.17</text></td>
            <td align="center" border="r t"><text font="bold">1.180</text></td>
            <td align="center" border="t"><text font="bold">0.43</text></td>
            <td align="center" border="r t"><text font="bold">0.9906</text></td>
            <td align="center" border="t"><text font="bold">2.69</text></td>
            <td align="center" border="t"><text font="bold">0.0017</text></td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <subsection inlist="toc" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Dynamical systems considered</title>
      <para xml:id="S4.SS1.p1">
        <p>We demonstrate the performance of the proposed diffusion models on four systems. The first three: Darcy flow, shallow water equation with periodic initial conditions, and the fixed-bed tubular reactor are fully identifiable given the conditioning information. The fourth system is the shallow water equation with an initial perturbation of the water level, and it is partially non-identifiable, meaning that multiple solutions are compatible with the given conditioning information. Below we specify these systems and their data generation.</p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p><text font="bold">Darcy Flow equation</text> is defined over a unit square with a 2D steady-state solution governed by</p>
        <equationgroup class="ltx_eqn_align" xml:id="S5.EGx1">
          <equation xml:id="S4.E1">
            <tags>
              <tag>(1)</tag>
              <tag role="refnum">1</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\nabla\left(a(x)\nabla u(x)\right)=f(x)\text{, }x\in(0,1)^{2}," text="nabla@(a * x * nabla@(u) * x) = f * x * [, ] * x element-of (open-interval@(0, 1)) ^ 2" xml:id="S4.E1.m3">
                <XMath>
                  <XMDual>
                    <XMRef idref="S4.E1.m3.7"/>
                    <XMWrap>
                      <XMApp xml:id="S4.E1.m3.7">
                        <XMTok meaning="multirelation"/>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S4.E1.m3.3"/>
                            <XMRef idref="S4.E1.m3.7.1"/>
                          </XMApp>
                          <XMApp>
                            <XMTok name="nabla" role="OPERATOR" xml:id="S4.E1.m3.3">∇</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S4.E1.m3.7.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMDual>
                                  <XMRef idref="S4.E1.m3.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.E1.m3.1">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S4.E1.m3.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.E1.m3.2">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                          <XMDual>
                            <XMRef idref="S4.E1.m3.4"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E1.m3.4">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMText>, </XMText>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S4.E1.m3.5"/>
                              <XMRef idref="S4.E1.m3.6"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S4.E1.m3.5">0</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok meaning="1" role="NUMBER" xml:id="S4.E1.m3.6">1</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\nabla\left(a(x)\nabla u(x)\right)" text="nabla@(a * x * nabla@(u) * x)" xml:id="S4.E1.m1">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="S4.E1.m1.3"/>
                          <XMRef idref="S4.E1.m1.4"/>
                        </XMApp>
                        <XMApp>
                          <XMTok name="nabla" role="OPERATOR" xml:id="S4.E1.m1.3">∇</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="S4.E1.m1.4">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMDual>
                                <XMRef idref="S4.E1.m1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E1.m1.1">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S4.E1.m1.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E1.m1.2">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=f(x)\text{, }x\in(0,1)^{2}," text="absent = f * x * [, ] * x element-of (open-interval@(0, 1)) ^ 2" xml:id="S4.E1.m2">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S4.E1.m2.4"/>
                        <XMWrap>
                          <XMApp xml:id="S4.E1.m2.4">
                            <XMTok meaning="multirelation"/>
                            <XMTok meaning="absent"/>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMDual>
                                <XMRef idref="S4.E1.m2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E1.m2.1">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMText>, </XMText>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            </XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S4.E1.m2.2"/>
                                  <XMRef idref="S4.E1.m2.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok meaning="0" role="NUMBER" xml:id="S4.E1.m2.2">0</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok meaning="1" role="NUMBER" xml:id="S4.E1.m2.3">1</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation labels="LABEL:eq:darcy" xml:id="S4.E2">
            <tags>
              <tag>(2)</tag>
              <tag role="refnum">2</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle u(x)=0\text{, }x\in\partial(0,1)^{2}," text="u * x = 0 * [, ] * x element-of partial-differential@((open-interval@(0, 1)) ^ 2)" xml:id="S4.E2.m3">
                <XMath>
                  <XMDual>
                    <XMRef idref="S4.E2.m3.4"/>
                    <XMWrap>
                      <XMApp xml:id="S4.E2.m3.4">
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">u</XMTok>
                          <XMDual>
                            <XMRef idref="S4.E2.m3.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E2.m3.1">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0" role="NUMBER">0</XMTok>
                          <XMText>, </XMText>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S4.E2.m3.2"/>
                                <XMRef idref="S4.E2.m3.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="S4.E2.m3.2">0</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok meaning="1" role="NUMBER" xml:id="S4.E2.m3.3">1</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle u(x)" text="u * x" xml:id="S4.E2.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">u</XMTok>
                        <XMDual>
                          <XMRef idref="S4.E2.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E2.m1.1">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=0\text{, }x\in\partial(0,1)^{2}," text="absent = 0 * [, ] * x element-of partial-differential@((open-interval@(0, 1)) ^ 2)" xml:id="S4.E2.m2">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S4.E2.m2.3"/>
                        <XMWrap>
                          <XMApp xml:id="S4.E2.m2.3">
                            <XMTok meaning="multirelation"/>
                            <XMTok meaning="absent"/>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="0" role="NUMBER">0</XMTok>
                              <XMText>, </XMText>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            </XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S4.E2.m2.1"/>
                                    <XMRef idref="S4.E2.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok meaning="0" role="NUMBER" xml:id="S4.E2.m2.1">0</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok meaning="1" role="NUMBER" xml:id="S4.E2.m2.2">1</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>with viscosity <Math mode="inline" tex="a(x)" text="a * x" xml:id="S4.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMDual>
                  <XMRef idref="S4.SS1.p2.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m1.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> being piece-wise constant and the force term <Math mode="inline" tex="f(x)=1" text="f * x = 1" xml:id="S4.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS1.p2.m2.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m2.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>. We use a subset of 1000 simulations from PDEBench <cite class="ltx_citemacro_cite">[<bibref bibrefs="takamoto2022pdebench" separator="," yyseparator=","/>]</cite>, of which one instance is shown in Fig. <ref labelref="LABEL:f:systems"/>(a).</p>
      </para>
      <para xml:id="S4.SS1.p3">
        <p><text font="bold">Shallow water equation (SWE-orig)</text> is derived from the compressible Navier-Stokes equation and describes free-surface fluid flow. The system is characterized by height <Math mode="inline" tex="h" text="h" xml:id="S4.SS1.p3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> and velocity <Math mode="inline" tex="u" text="u" xml:id="S4.SS1.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">u</XMTok>
            </XMath>
          </Math> of the fluid evolving as:</p>
        <equationgroup class="ltx_eqn_align" xml:id="S5.EGx2">
          <equation labels="LABEL:eq:swe" xml:id="S4.E3">
            <tags>
              <tag>(3)</tag>
              <tag role="refnum">3</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\frac{\partial h}{\partial t}=-\frac{\partial hu}{\partial x}%&#10;\text{, }\quad\frac{\partial hu}{\partial t}=-\frac{\partial(u^{2}h+0.5gh^{2})%&#10;}{\partial x}" text="formulae@(partial-differential@(h) / partial-differential@(t) = - (partial-differential@(h * u) / partial-differential@(x)) * [, ], partial-differential@(h * u) / partial-differential@(t) = - partial-differential@(u ^ 2 * h + 0.5 * g * h ^ 2) / partial-differential@(x))" xml:id="S4.E3.m3">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S4.E3.m3.2"/>
                      <XMRef idref="S4.E3.m3.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S4.E3.m3.2">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMText>, </XMText>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMHint name="quad" role="PUNCT" width="10pt"/>
                      <XMApp xml:id="S4.E3.m3.3">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                              <XMTok font="italic" role="UNKNOWN">u</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMApp>
                              <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                              <XMDual>
                                <XMRef idref="S4.E3.m3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E3.m3.1">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\frac{\partial h}{\partial t}" text="partial-differential@(h) / partial-differential@(t)" xml:id="S4.E3.m1">
                    <XMath>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=-\frac{\partial hu}{\partial x}\text{, }\quad\frac{\partial hu}{%&#10;\partial t}=-\frac{\partial(u^{2}h+0.5gh^{2})}{\partial x}" text="formulae@(absent = - (partial-differential@(h * u) / partial-differential@(x)) * [, ], partial-differential@(h * u) / partial-differential@(t) = - partial-differential@(u ^ 2 * h + 0.5 * g * h ^ 2) / partial-differential@(x))" xml:id="S4.E3.m2">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="S4.E3.m2.2"/>
                          <XMRef idref="S4.E3.m2.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S4.E3.m2.2">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMApp>
                                    <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMText>, </XMText>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMHint name="quad" role="PUNCT" width="10pt"/>
                          <XMApp xml:id="S4.E3.m2.3">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMDual>
                                    <XMRef idref="S4.E3.m2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S4.E3.m2.1">
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="g" text="g" xml:id="S4.SS1.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">g</XMTok>
            </XMath>
          </Math> is the gravitational constant. Here, we set <Math mode="inline" tex="g=1" text="g = 1" xml:id="S4.SS1.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> and randomize the initial conditions for <Math mode="inline" tex="h" text="h" xml:id="S4.SS1.p3.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math>. For <Math mode="inline" tex="t\in[0,0.128]" text="t element-of closed-interval@(0, 0.128)" xml:id="S4.SS1.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S4.SS1.p3.m6.1"/>
                    <XMRef idref="S4.SS1.p3.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S4.SS1.p3.m6.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0.128" role="NUMBER" xml:id="S4.SS1.p3.m6.2">0.128</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="x\in[-0.5,0.5]" text="x element-of closed-interval@(- 0.5, 0.5)" xml:id="S4.SS1.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S4.SS1.p3.m7.2"/>
                    <XMRef idref="S4.SS1.p3.m7.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S4.SS1.p3.m7.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0.5" role="NUMBER" xml:id="S4.SS1.p3.m7.1">0.5</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, and <Math mode="inline" tex="u_{0}=0" text="u _ 0 = 0" xml:id="S4.SS1.p3.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">u</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="h_{0}" text="h _ 0" xml:id="S4.SS1.p3.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> is calculated as:</p>
        <equationgroup class="ltx_eqn_align" xml:id="S5.EGx3">
          <equation xml:id="S4.E4">
            <tags>
              <tag>(4)</tag>
              <tag role="refnum">4</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\tilde{h}(0,x)=\sum_{k=-N}^{N}\lambda_{k}\cos(2\pi kx)+\gamma_{k}%&#10;\sin(2\pi kx)," text="tilde@(h) * open-interval@(0, x) = ((sum _ (k = - N)) ^ N)@(lambda _ k * cosine@(2 * pi * k * x)) + gamma _ k * sine@(2 * pi * k * x)" xml:id="S4.E4.m3">
                <XMath>
                  <XMDual>
                    <XMRef idref="S4.E4.m3.5"/>
                    <XMWrap>
                      <XMApp xml:id="S4.E4.m3.5">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S4.E4.m3.1"/>
                              <XMRef idref="S4.E4.m3.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S4.E4.m3.1">0</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E4.m3.2">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="S4.E4.m3.3"/>
                                  <XMRef idref="S4.E4.m3.5.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="cosine" role="TRIGFUNCTION" xml:id="S4.E4.m3.3">cos</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S4.E4.m3.5.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S4.E4.m3.4"/>
                                <XMRef idref="S4.E4.m3.5.2"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="S4.E4.m3.4">sin</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E4.m3.5.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\tilde{h}(0,x)" text="tilde@(h) * open-interval@(0, x)" xml:id="S4.E4.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S4.E4.m1.1"/>
                            <XMRef idref="S4.E4.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E4.m1.1">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E4.m1.2">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=\sum_{k=-N}^{N}\lambda_{k}\cos(2\pi kx)+\gamma_{k}\sin(2\pi kx)," text="absent = ((sum _ (k = - N)) ^ N)@(lambda _ k * cosine@(2 * pi * k * x)) + gamma _ k * sine@(2 * pi * k * x)" xml:id="S4.E4.m2">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S4.E4.m2.3"/>
                        <XMWrap>
                          <XMApp xml:id="S4.E4.m2.3">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="S4.E4.m2.1"/>
                                      <XMRef idref="S4.E4.m2.3.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="cosine" role="TRIGFUNCTION" xml:id="S4.E4.m2.1">cos</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S4.E4.m2.3.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="S4.E4.m2.2"/>
                                    <XMRef idref="S4.E4.m2.3.2"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="S4.E4.m2.2">sin</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S4.E4.m2.3.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation labels="LABEL:eq:swe_ic_period" xml:id="S4.E5">
            <tags>
              <tag>(5)</tag>
              <tag role="refnum">5</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle h(0,x)=1+\frac{\tilde{h}(0,x)-\min(\tilde{h}(0,x))}{\max(\tilde{%&#10;h}(0,x))-\min(\tilde{h}(0,x))}\text{,}" text="h * open-interval@(0, x) = 1 + ((tilde@(h) * open-interval@(0, x) - minimum@(tilde@(h) * open-interval@(0, x))) / (maximum@(tilde@(h) * open-interval@(0, x)) - minimum@(tilde@(h) * open-interval@(0, x)))) * [,]" xml:id="S4.E5.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.E5.m3.15"/>
                          <XMRef idref="S4.E5.m3.16"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m3.15">0</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m3.16">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S4.E5.m3.1"/>
                                  <XMRef idref="S4.E5.m3.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m3.1">0</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m3.2">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S4.E5.m3.5"/>
                                <XMRef idref="S4.E5.m3.6"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post" xml:id="S4.E5.m3.5">min</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E5.m3.6">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S4.E5.m3.3"/>
                                        <XMRef idref="S4.E5.m3.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m3.3">0</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m3.4">x</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S4.E5.m3.9"/>
                                <XMRef idref="S4.E5.m3.13"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post" xml:id="S4.E5.m3.9">max</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E5.m3.13">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S4.E5.m3.7"/>
                                        <XMRef idref="S4.E5.m3.8"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m3.7">0</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m3.8">x</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S4.E5.m3.12"/>
                                <XMRef idref="S4.E5.m3.14"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post" xml:id="S4.E5.m3.12">min</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E5.m3.14">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S4.E5.m3.10"/>
                                        <XMRef idref="S4.E5.m3.11"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m3.10">0</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m3.11">x</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMText>,</XMText>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle h(0,x)" text="h * open-interval@(0, x)" xml:id="S4.E5.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S4.E5.m1.1"/>
                            <XMRef idref="S4.E5.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m1.1">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m1.2">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=1+\frac{\tilde{h}(0,x)-\min(\tilde{h}(0,x))}{\max(\tilde{h}(0,x)%&#10;)-\min(\tilde{h}(0,x))}\text{,}" text="absent = 1 + ((tilde@(h) * open-interval@(0, x) - minimum@(tilde@(h) * open-interval@(0, x))) / (maximum@(tilde@(h) * open-interval@(0, x)) - minimum@(tilde@(h) * open-interval@(0, x)))) * [,]" xml:id="S4.E5.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S4.E5.m2.1"/>
                                      <XMRef idref="S4.E5.m2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m2.1">0</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m2.2">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="S4.E5.m2.5"/>
                                    <XMRef idref="S4.E5.m2.6"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post" xml:id="S4.E5.m2.5">min</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S4.E5.m2.6">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="S4.E5.m2.3"/>
                                            <XMRef idref="S4.E5.m2.4"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m2.3">0</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m2.4">x</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="S4.E5.m2.9"/>
                                    <XMRef idref="S4.E5.m2.13"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post" xml:id="S4.E5.m2.9">max</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S4.E5.m2.13">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="S4.E5.m2.7"/>
                                            <XMRef idref="S4.E5.m2.8"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m2.7">0</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m2.8">x</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="S4.E5.m2.12"/>
                                    <XMRef idref="S4.E5.m2.14"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post" xml:id="S4.E5.m2.12">min</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S4.E5.m2.14">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="S4.E5.m2.10"/>
                                            <XMRef idref="S4.E5.m2.11"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E5.m2.10">0</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m2.11">x</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMText>,</XMText>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="N=3" text="N = 3" xml:id="S4.SS1.p3.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\lambda_{k},\gamma_{k}\sim\mathcal{N}(0,1)" text="list@(lambda _ k, gamma _ k) similar-to N * open-interval@(0, 1)" xml:id="S4.SS1.p3.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S4.SS1.p3.m11.3"/>
                    <XMRef idref="S4.SS1.p3.m11.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S4.SS1.p3.m11.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS1.p3.m11.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS1.p3.m11.1"/>
                      <XMRef idref="S4.SS1.p3.m11.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0" role="NUMBER" xml:id="S4.SS1.p3.m11.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="S4.SS1.p3.m11.2">1</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. An example of this system is used in the illustrations in Fig. <ref labelref="LABEL:f:method_overview"/>.</p>
      </para>
      <para xml:id="S4.SS1.p4">
        <p><text font="bold">Shallow water equation (SWE-init)</text> is generated for <Math mode="inline" tex="x\in[-2.5,2.5]" text="x element-of closed-interval@(- 2.5, 2.5)" xml:id="S4.SS1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S4.SS1.p4.m1.2"/>
                    <XMRef idref="S4.SS1.p4.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S4.SS1.p4.m1.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="2.5" role="NUMBER">2.5</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="2.5" role="NUMBER" xml:id="S4.SS1.p4.m1.1">2.5</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="t\in[0,1.28]" text="t element-of closed-interval@(0, 1.28)" xml:id="S4.SS1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S4.SS1.p4.m2.1"/>
                    <XMRef idref="S4.SS1.p4.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S4.SS1.p4.m2.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1.28" role="NUMBER" xml:id="S4.SS1.p4.m2.2">1.28</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> with initial conditions:</p>
        <equationgroup class="ltx_eqn_align" xml:id="S5.EGx4">
          <equation labels="LABEL:eq:swe_ic" xml:id="S4.E6">
            <tags>
              <tag>(6)</tag>
              <tag role="refnum">6</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle h(0,x)=h_{\text{in}}+\epsilon\exp\left(\frac{(x-x_{0})^{2}}{2%&#10;\sigma^{2}}\right)\text{, }\quad u(0,x)=u_{0}\text{,}" text="formulae@(h * open-interval@(0, x) = h _ [in] + epsilon * exponential@((x - x _ 0) ^ 2 / (2 * sigma ^ 2)) * [, ], u * open-interval@(0, x) = u _ 0 * [,])" xml:id="S4.E6.m3">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S4.E6.m3.8"/>
                      <XMRef idref="S4.E6.m3.9"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S4.E6.m3.8">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S4.E6.m3.2"/>
                              <XMRef idref="S4.E6.m3.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S4.E6.m3.2">0</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E6.m3.3">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMText><text fontsize="70%">in</text></XMText>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S4.E6.m3.4"/>
                                <XMRef idref="S4.E6.m3.5"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S4.E6.m3.4">exp</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                                  <XMApp xml:id="S4.E6.m3.5">
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMDual>
                                        <XMRef idref="S4.E6.m3.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S4.E6.m3.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                            <XMText>, </XMText>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMHint name="quad" role="PUNCT" width="10pt"/>
                      <XMApp xml:id="S4.E6.m3.9">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">u</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S4.E6.m3.6"/>
                              <XMRef idref="S4.E6.m3.7"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S4.E6.m3.6">0</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E6.m3.7">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">u</XMTok>
                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                          <XMText>,</XMText>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle h(0,x)" text="h * open-interval@(0, x)" xml:id="S4.E6.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S4.E6.m1.1"/>
                            <XMRef idref="S4.E6.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="S4.E6.m1.1">0</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E6.m1.2">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=h_{\text{in}}+\epsilon\exp\left(\frac{(x-x_{0})^{2}}{2\sigma^{2}%&#10;}\right)\text{, }\quad u(0,x)=u_{0}\text{,}" text="formulae@(absent = h _ [in] + epsilon * exponential@((x - x _ 0) ^ 2 / (2 * sigma ^ 2)) * [, ], u * open-interval@(0, x) = u _ 0 * [,])" xml:id="S4.E6.m2">
                    <XMath>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="S4.E6.m2.6"/>
                          <XMRef idref="S4.E6.m2.7"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S4.E6.m2.6">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMText><text fontsize="70%">in</text></XMText>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="S4.E6.m2.2"/>
                                    <XMRef idref="S4.E6.m2.3"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S4.E6.m2.2">exp</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMApp xml:id="S4.E6.m2.3">
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMDual>
                                            <XMRef idref="S4.E6.m2.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="S4.E6.m2.1">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMText>, </XMText>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMHint name="quad" role="PUNCT" width="10pt"/>
                          <XMApp xml:id="S4.E6.m2.7">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">u</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S4.E6.m2.4"/>
                                  <XMRef idref="S4.E6.m2.5"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok meaning="0" role="NUMBER" xml:id="S4.E6.m2.4">0</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E6.m2.5">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                              <XMText>,</XMText>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="h_{\text{in}}\sim\mathcal{U}\left(1.2,5.2\right)" text="h _ [in] similar-to U * open-interval@(1.2, 5.2)" xml:id="S4.SS1.p4.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  <XMText><text fontsize="70%">in</text></XMText>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">U</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS1.p4.m3.1"/>
                      <XMRef idref="S4.SS1.p4.m3.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMTok meaning="1.2" role="NUMBER" xml:id="S4.SS1.p4.m3.1">1.2</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="5.2" role="NUMBER" xml:id="S4.SS1.p4.m3.2">5.2</XMTok>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\epsilon\sim\mathcal{U}\left(0.05,1\right)" text="epsilon similar-to U * open-interval@(0.05, 1)" xml:id="S4.SS1.p4.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">U</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS1.p4.m4.1"/>
                      <XMRef idref="S4.SS1.p4.m4.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMTok meaning="0.05" role="NUMBER" xml:id="S4.SS1.p4.m4.1">0.05</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="S4.SS1.p4.m4.2">1</XMTok>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="x_{0}\sim\mathcal{U}\left(-1,1\right)" text="x _ 0 similar-to U * open-interval@(- 1, 1)" xml:id="S4.SS1.p4.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">U</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS1.p4.m5.2"/>
                      <XMRef idref="S4.SS1.p4.m5.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMApp xml:id="S4.SS1.p4.m5.2">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="S4.SS1.p4.m5.1">1</XMTok>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\sigma\sim\mathcal{U}\left(0.2,2\right)" text="sigma similar-to U * open-interval@(0.2, 2)" xml:id="S4.SS1.p4.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">U</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS1.p4.m6.1"/>
                      <XMRef idref="S4.SS1.p4.m6.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMTok meaning="0.2" role="NUMBER" xml:id="S4.SS1.p4.m6.1">0.2</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="2" role="NUMBER" xml:id="S4.SS1.p4.m6.2">2</XMTok>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="(hu)_{0}\sim\mathcal{U}\left(-2.2,2.2\right)" text="(h * u) _ 0 similar-to U * open-interval@(- 2.2, 2.2)" xml:id="S4.SS1.p4.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMRef idref="S4.SS1.p4.m7.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS1.p4.m7.2">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMTok font="italic" role="UNKNOWN">u</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">U</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS1.p4.m7.3"/>
                      <XMRef idref="S4.SS1.p4.m7.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMApp xml:id="S4.SS1.p4.m7.3">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="2.2" role="NUMBER">2.2</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="2.2" role="NUMBER" xml:id="S4.SS1.p4.m7.1">2.2</XMTok>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. This equation models an abrupt change in the water level, e.g. caused by a dam break. Depending on the initial water velocity <Math mode="inline" tex="u_{0}" text="u _ 0" xml:id="S4.SS1.p4.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, several possible outcomes may correspond to the same observation of the height <Math mode="inline" tex="h" text="h" xml:id="S4.SS1.p4.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> (Fig. <ref labelref="LABEL:f:swe_predict"/>).</p>
      </para>
      <para xml:id="S4.SS1.p5">
        <p>For both SWE datasets the data are simulated using PyClaw <cite class="ltx_citemacro_cite">[<bibref bibrefs="ketcheson2012pyclaw" separator="," yyseparator=","/>]</cite> Python package implementing a finite volume method for this equation.</p>
      </para>
      <para xml:id="S4.SS1.p6">
        <p><text font="bold">Fixed-bed tubular reactor</text> is a system with hydrogenation of aromatics with concentration <Math mode="inline" tex="x_{a}" text="x _ a" xml:id="S4.SS1.p6.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
              </XMApp>
            </XMath>
          </Math> on the catalyst surface with activity <Math mode="inline" tex="\theta" text="theta" xml:id="S4.SS1.p6.m2">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math>. The reactor’s input contains a poisoning agent with concentration <Math mode="inline" tex="x_{p}" text="x _ p" xml:id="S4.SS1.p6.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> which deteriorates activity <Math mode="inline" tex="\theta" text="theta" xml:id="S4.SS1.p6.m4">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> <cite class="ltx_citemacro_cite">[<bibref bibrefs="price1977catalyst" separator="," yyseparator=","/>]</cite>. The system dynamics in space <Math mode="inline" tex="z" text="z" xml:id="S4.SS1.p6.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">z</XMTok>
            </XMath>
          </Math> and time <Math mode="inline" tex="t" text="t" xml:id="S4.SS1.p6.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> is modelled as</p>
        <equationgroup class="ltx_eqn_align" xml:id="S5.EGx5">
          <equation xml:id="S4.E7">
            <tags>
              <tag>(7)</tag>
              <tag role="refnum">7</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\frac{\partial x_{a,p}}{\partial t}=-U\frac{\partial x_{a,p}}{%&#10;\partial z}-\alpha(T)r_{a,p}," text="partial-differential@(x _ (list@(a, p))) / partial-differential@(t) = - U * (partial-differential@(x _ (list@(a, p))) / partial-differential@(z)) - alpha * T * r _ (list@(a, p))" xml:id="S4.E7.m3">
                <XMath>
                  <XMDual>
                    <XMRef idref="S4.E7.m3.8"/>
                    <XMWrap>
                      <XMApp xml:id="S4.E7.m3.8">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="S4.E7.m3.1"/>
                                  <XMRef idref="S4.E7.m3.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m3.1">a</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m3.2">p</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">U</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S4.E7.m3.3"/>
                                        <XMRef idref="S4.E7.m3.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m3.3">a</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m3.4">p</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            <XMDual>
                              <XMRef idref="S4.E7.m3.7"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S4.E7.m3.7">T</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="S4.E7.m3.5"/>
                                  <XMRef idref="S4.E7.m3.6"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m3.5">a</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m3.6">p</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\frac{\partial x_{a,p}}{\partial t}" text="partial-differential@(x _ (list@(a, p))) / partial-differential@(t)" xml:id="S4.E7.m1">
                    <XMath>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S4.E7.m1.1"/>
                                <XMRef idref="S4.E7.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m1.1">a</XMTok>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m1.2">p</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=-U\frac{\partial x_{a,p}}{\partial z}-\alpha(T)r_{a,p}," text="absent = - U * (partial-differential@(x _ (list@(a, p))) / partial-differential@(z)) - alpha * T * r _ (list@(a, p))" xml:id="S4.E7.m2">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S4.E7.m2.6"/>
                        <XMWrap>
                          <XMApp xml:id="S4.E7.m2.6">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">U</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMApp>
                                      <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="S4.E7.m2.1"/>
                                            <XMRef idref="S4.E7.m2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m2.1">a</XMTok>
                                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m2.2">p</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                <XMDual>
                                  <XMRef idref="S4.E7.m2.5"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.E7.m2.5">T</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="S4.E7.m2.3"/>
                                      <XMRef idref="S4.E7.m2.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m2.3">a</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E7.m2.4">p</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation labels="LABEL:eq:reactor" xml:id="S4.E8">
            <tags>
              <tag>(8)</tag>
              <tag role="refnum">8</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\frac{\partial T}{\partial t}=-\beta(x_{a},T)U\frac{\partial T}{%&#10;\partial z}+\gamma r_{a},\quad\frac{d\theta}{dt}=-r_{d}," text="formulae@(partial-differential@(T) / partial-differential@(t) = (- beta * open-interval@(x _ a, T) * U * (partial-differential@(T) / partial-differential@(z))) + gamma * r _ a, (d * theta) / (d * t) = - r _ d)" xml:id="S4.E8.m3">
                <XMath>
                  <XMDual>
                    <XMRef idref="S4.E8.m3.2"/>
                    <XMWrap>
                      <XMDual xml:id="S4.E8.m3.2">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="S4.E8.m3.2.1"/>
                          <XMRef idref="S4.E8.m3.2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S4.E8.m3.2.1">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S4.E8.m3.2.1.1"/>
                                      <XMRef idref="S4.E8.m3.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S4.E8.m3.2.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E8.m3.1">T</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">U</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMApp>
                                      <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                          <XMApp xml:id="S4.E8.m3.2.2">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\frac{\partial T}{\partial t}" text="partial-differential@(T) / partial-differential@(t)" xml:id="S4.E8.m1">
                    <XMath>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=-\beta(x_{a},T)U\frac{\partial T}{\partial z}+\gamma r_{a},\quad%&#10;\frac{d\theta}{dt}=-r_{d}," text="formulae@(absent = (- beta * open-interval@(x _ a, T) * U * (partial-differential@(T) / partial-differential@(z))) + gamma * r _ a, (d * theta) / (d * t) = - r _ d)" xml:id="S4.E8.m2">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S4.E8.m2.2"/>
                        <XMWrap>
                          <XMDual xml:id="S4.E8.m2.2">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="S4.E8.m2.2.1"/>
                              <XMRef idref="S4.E8.m2.2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S4.E8.m2.2.1">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMTok meaning="absent"/>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="S4.E8.m2.2.1.1"/>
                                          <XMRef idref="S4.E8.m2.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S4.E8.m2.2.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E8.m2.1">T</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="italic" role="UNKNOWN">U</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMApp>
                                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                              <XMApp xml:id="S4.E8.m2.2.2">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="U" text="U" xml:id="S4.SS1.p6.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">U</XMTok>
            </XMath>
          </Math> is the fluid velocity, <Math mode="inline" tex="\alpha(T)" text="alpha * T" xml:id="S4.SS1.p6.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMDual>
                  <XMRef idref="S4.SS1.p6.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p6.m8.1">T</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\beta(x_{a},T)" text="beta * open-interval@(x _ a, T)" xml:id="S4.SS1.p6.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S4.SS1.p6.m9.2"/>
                    <XMRef idref="S4.SS1.p6.m9.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS1.p6.m9.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p6.m9.1">T</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> are functions of temperature <Math mode="inline" tex="T" text="T" xml:id="S4.SS1.p6.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> and the concentration <Math mode="inline" tex="x_{a}" text="x _ a" xml:id="S4.SS1.p6.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\gamma" text="gamma" xml:id="S4.SS1.p6.m12">
            <XMath>
              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
            </XMath>
          </Math> is a constant and the functions <Math mode="inline" tex="r_{a}" text="r _ a" xml:id="S4.SS1.p6.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="r_{p}" text="r _ p" xml:id="S4.SS1.p6.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="r_{d}" text="r _ d" xml:id="S4.SS1.p6.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMath>
          </Math> are reaction, poisoning adsorption, and catalyst deactivation rates (see <cite class="ltx_citemacro_cite">[<bibref bibrefs="haitsiukevich2021agrid" separator="," yyseparator=","/>]</cite> for more details). A simulation of the system is shown in Fig. <ref labelref="LABEL:f:systems"/>(b).</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag>Baselines</title>
      <para xml:id="S4.SS2.p1">
        <p>We compared the proposed approach against the (non-diffusion) supervised neural operators FNO <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier" separator="," yyseparator=","/>]</cite> and OFormer <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2023transformer" separator="," yyseparator=","/>]</cite>, which have been trained using the implementations provided by the authors.
As diffusion model baselines, we compared the mixed conditional training (M-CEDM) with the ‘unconditional’ RePaint approach and the conditional diffusion models based on the DDPM (CDDPM) and EDM (CEDM).
RePaint and CDDPM are trained on the simplified objective <cite class="ltx_citemacro_cite">[<bibref bibrefs="ho2020denoising" separator="," yyseparator=","/>]</cite> by predicting added noise, while CEDM and M-CEDM use the EDM objective <cite class="ltx_citemacro_cite">[<bibref bibrefs="karras2022elucidating" separator="," yyseparator=","/>]</cite> and predict a mixture of noise and denoised image. All diffusion models rely on the 2nd order Heun sampler <cite class="ltx_citemacro_cite">[<bibref bibrefs="karras2022elucidating" separator="," yyseparator=","/>]</cite>. In all experiments we take 100 samples from each diffusion model and calculate the mean absolute error (MAE) and the PDE residual error by averaging across those samples. The number of parameters in the different models is approximately equal. The code and the datasets will be released upon acceptance.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS3">
      <tags>
        <tag>4.3</tag>
        <tag role="refnum">4.3</tag>
        <tag role="typerefnum">§4.3</tag>
      </tags>
      <title><tag close=" ">4.3</tag>Reconstruction of the unobserved variables</title>
      <para xml:id="S4.SS3.p1">
        <p>In this experiment (results in Table <ref labelref="LABEL:tab:res_state1"/>), we consider two tasks: forward and inverse. In the forward task we predict the solution <Math mode="inline" tex="u" text="u" xml:id="S4.SS3.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">u</XMTok>
            </XMath>
          </Math> conditioned on the parameter <Math mode="inline" tex="a" text="a" xml:id="S4.SS3.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> (Darcy), the velocity <Math mode="inline" tex="u" text="u" xml:id="S4.SS3.p1.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">u</XMTok>
            </XMath>
          </Math> from the height <Math mode="inline" tex="h" text="h" xml:id="S4.SS3.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> (SWE-orig) and both the concentration <Math mode="inline" tex="x_{a}" text="x _ a" xml:id="S4.SS3.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
              </XMApp>
            </XMath>
          </Math> and the catalyst <Math mode="inline" tex="\theta" text="theta" xml:id="S4.SS3.p1.m6">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> from the temperature <Math mode="inline" tex="T" text="T" xml:id="S4.SS3.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> and poisoning concentration <Math mode="inline" tex="x_{p}" text="x _ p" xml:id="S4.SS3.p1.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> (Reactor). For the inverse task the inputs and the targets are flipped (Tasks 1, 2 in Fig. <ref labelref="LABEL:f:method_overview"/>). For these tasks the supervised neural operators, FNO and OFormer, provide strong results. However, the PDE residuals are consistently smaller for the conditional and mixed conditional diffusion models (CDDPM, CEDM and M-CEDM), which means that their solutions are more compatible with the prior knowledge of the system dynamics. Since CEDM results were better than CDDPM, we selected it as the basis for training the mixed conditional approach. Comparing RePaint trained ‘unconditionally’ to generate both states jointly against the specialized conditional models, we conclude that the conditioning during training is beneficial. However RePaint uses a singe model for both forward and inverse problems, while the conditional models (including FNO and OFormer) use a dedicated model for each task. Similar to RePaint, M-CEDM uses a single model for both tasks but with performance similar to or better than the other conditionally trained models.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS4">
      <tags>
        <tag>4.4</tag>
        <tag role="refnum">4.4</tag>
        <tag role="typerefnum">§4.4</tag>
      </tags>
      <title><tag close=" ">4.4</tag>Future state prediction</title>
      <para xml:id="S4.SS4.p1">
        <p>Next, we compared the methods on Task 3 (future prediction) and Tasks 4-5 (reconstruction and prediction) in Fig. <ref labelref="LABEL:f:method_overview"/>, results shown in Table <ref labelref="LABEL:tab:res_time_pred"/>. For RePaint and M-CEDM, we used the same trained model as in Table <ref labelref="LABEL:tab:res_state1"/>. We selected M-CEDM as a representative of the conditional diffusion models as it was the best in the previous experiment and did not require retraining. For FNO and OFormer we had two models, one to reconstruct the state, the other for prediction. Both FNO and OFormer can handle inputs with different amounts of observed time steps at test time; however, the performance drops significantly when the models trained on the full state are applied to partial observations (marked by * in Table <ref labelref="LABEL:tab:res_time_pred"/>). By retraining FNO and OFormer for the correct input size, the performance improved but stayed below the diffusion model.</p>
      </para>
      <table inlist="lot" labels="LABEL:tab:res_time_pred" placement="t" xml:id="S4.T2">
        <tags>
          <tag>Table 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Table 2</tag>
        </tags>
        <toccaption><tag close=" ">2</tag>
Results for SWE-orig dataset in reconstruction and prediction (Tasks 3-5). MAE values should be multiplied by <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S4.T2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Models with * are the same as in Table <ref labelref="LABEL:tab:res_state1"/> and trained for full state reconstruction.
</toccaption>
        <caption><tag close=": ">Table 2</tag>
Results for SWE-orig dataset in reconstruction and prediction (Tasks 3-5). MAE values should be multiplied by <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S4.T2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Models with * are the same as in Table <ref labelref="LABEL:tab:res_state1"/> and trained for full state reconstruction.
</caption>
<!--  %**** main˙arxiv.tex Line 400 **** -->        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <thead>
            <tr>
              <td align="center" border="r" rowspan="2" thead="column row">Model</td>
              <td align="center" border="r" colspan="2" thead="column" vattach="top">Task 3</td>
              <td align="center" border="r" colspan="2" thead="column" vattach="top">Task 4</td>
              <td align="center" colspan="2" thead="column" vattach="top">Task 5</td>
            </tr>
            <tr>
              <td align="justify" thead="column" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt"><text font="italic">MAE</text></p>
                </inline-block></td>
              <td align="center" border="r" thead="column"><text font="italic">PDE</text></td>
              <td align="justify" thead="column" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt"><text font="italic">MAE</text></p>
                </inline-block></td>
              <td align="center" border="r" thead="column"><text font="italic">PDE</text></td>
              <td align="justify" thead="column" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt"><text font="italic">MAE</text></p>
                </inline-block></td>
              <td align="center" thead="column"><text font="italic">PDE</text></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center" border="r t" thead="row">FNO* <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier" separator="," yyseparator=","/>]</cite></td>
              <td align="justify" border="t" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.70</p>
                </inline-block></td>
              <td align="center" border="r t"><text font="bold">0.98</text></td>
              <td align="justify" border="t" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">51.2</p>
                </inline-block></td>
              <td align="center" border="r t">47.5</td>
              <td align="justify" border="t" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">90.7</p>
                </inline-block></td>
              <td align="center" border="t">150</td>
            </tr>
            <tr>
              <td align="center" border="r" thead="row">OFormer* <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2023transformer" separator="," yyseparator=","/>]</cite></td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.40</p>
                </inline-block></td>
              <td align="center" border="r">1.00</td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">30.3</p>
                </inline-block></td>
              <td align="center" border="r">105</td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">92.8</p>
                </inline-block></td>
              <td align="center">47.5</td>
            </tr>
            <tr>
              <td align="center" border="r" thead="row">FNO <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier" separator="," yyseparator=","/>]</cite></td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.70</p>
                </inline-block></td>
              <td align="center" border="r"><text font="bold">0.98</text></td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.56</p>
                </inline-block></td>
              <td align="center" border="r"><text font="bold">0.98</text></td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">1.34</p>
                </inline-block></td>
              <td align="center">1.04</td>
            </tr>
            <tr>
              <td align="center" border="r" thead="row">OFormer <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2023transformer" separator="," yyseparator=","/>]</cite></td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.40</p>
                </inline-block></td>
              <td align="center" border="r">1.00</td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.35</p>
                </inline-block></td>
              <td align="center" border="r">1.00</td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">1.04</p>
                </inline-block></td>
              <td align="center">1.01</td>
            </tr>
            <tr>
              <td align="center" border="r" thead="row">RePaint <cite class="ltx_citemacro_cite">[<bibref bibrefs="lugmayr2022repaint" separator="," yyseparator=","/>]</cite></td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.65</p>
                </inline-block></td>
              <td align="center" border="r">1.08</td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">0.79</p>
                </inline-block></td>
              <td align="center" border="r">1.04</td>
              <td align="justify" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt">54.2</p>
                </inline-block></td>
              <td align="center">4.72</td>
            </tr>
            <tr>
              <td align="center" border="r t" thead="row">M-CEDM</td>
              <td align="justify" border="t" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt"><text font="bold">0.08</text></p>
                </inline-block></td>
              <td align="center" border="r t">0.99</td>
              <td align="justify" border="t" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt"><text font="bold">0.14</text></p>
                </inline-block></td>
              <td align="center" border="r t">0.99</td>
              <td align="justify" border="t" vattach="top"><inline-block vattach="top">
                  <p width="14.2pt"><text font="bold">0.48</text></p>
                </inline-block></td>
              <td align="center" border="t"><text font="bold">0.99</text></td>
            </tr>
          </tbody>
        </tabular>
      </table>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS5">
      <tags>
        <tag>4.5</tag>
        <tag role="refnum">4.5</tag>
        <tag role="typerefnum">§4.5</tag>
      </tags>
      <title><tag close=" ">4.5</tag>Recovering several possible outcomes</title>
      <table inlist="lot" labels="LABEL:tab:res_unidentifiable" placement="t" xml:id="S4.T3">
        <tags>
          <tag>Table 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Table 3</tag>
        </tags>
<!--  %**** main˙arxiv.tex Line 425 **** -->        <toccaption><tag close=" ">3</tag>
Results of state reconstruction (Task 1) in the non-identifiable case (SWE-init). All MAE values should be multiplied by <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S4.T3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. We see that samples from the diffusion model include the correct prediction (‘closest’), and additional prior information (extra observed points or PDE error) can be useful to identify the most plausible samples.
</toccaption>
        <caption><tag close=": ">Table 3</tag>
Results of state reconstruction (Task 1) in the non-identifiable case (SWE-init). All MAE values should be multiplied by <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S4.T3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. We see that samples from the diffusion model include the correct prediction (‘closest’), and additional prior information (extra observed points or PDE error) can be useful to identify the most plausible samples.
</caption>
        <tabular class="ltx_centering" vattach="middle">
          <tbody>
            <tr>
              <td align="left" border="r">                    Model</td>
              <td align="center"><text font="italic">MAE</text></td>
              <td align="center"><text font="italic">PDE</text></td>
            </tr>
            <tr>
              <td align="left" border="r t">Kalman Filter <cite class="ltx_citemacro_cite">[<bibref bibrefs="kalman1960new" separator="," yyseparator=","/>]</cite></td>
              <td align="center" border="t">52.2</td>
              <td align="center" border="t">0.2858</td>
            </tr>
            <tr>
              <td align="left" border="r">FNO <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2021fourier" separator="," yyseparator=","/>]</cite></td>
              <td align="center">2.43</td>
              <td align="center">0.1300</td>
            </tr>
            <tr>
              <td align="left" border="r">OFormer <cite class="ltx_citemacro_cite">[<bibref bibrefs="li2023transformer" separator="," yyseparator=","/>]</cite></td>
              <td align="center">2.74</td>
              <td align="center">0.0400</td>
            </tr>
            <tr>
              <td align="left" border="r t">Diffusion model, mean prediction</td>
              <td align="center" border="t">55.1</td>
              <td align="center" border="t">0.0193</td>
            </tr>
            <tr>
              <td align="left" border="r">     - prediction selected by PDE error</td>
              <td align="center">13.7</td>
              <td align="center"><text font="bold">0.0159</text></td>
            </tr>
            <tr>
              <td align="left" border="r">     - prediction selected by 2 corner points</td>
              <td align="center">1.92</td>
              <td align="center">0.0161</td>
            </tr>
            <tr>
              <td align="left" border="r">     - prediction closest to the target</td>
              <td align="center"><text font="bold">1.53</text></td>
              <td align="center">0.0162</td>
            </tr>
          </tbody>
        </tabular>
      </table>
      <para xml:id="S4.SS5.p1">
        <p>Here we compare the models for velocity reconstruction (Task 1) in the SWE-init system, and the results are summarized in Table <ref labelref="LABEL:tab:res_unidentifiable"/>. The system is partially non-identifiability, which means that without additional information multiple reconstructions can be compatible with the conditioning information. The purpose of this experiment is to demonstrate the benefits of the probabilistic diffusion models in this scenario, namely their ability to generate multiple different samples reflecting the variability of possible solutions, and including the correct target value. Here, we include also the Kalman Filter <cite class="ltx_citemacro_cite">[<bibref bibrefs="kalman1960new" separator="," yyseparator=","/>]</cite>, obtained by linearizing the PDEs <cite class="ltx_citemacro_cite">[<bibref bibrefs="rafiee2009kalman" separator="," yyseparator=","/>]</cite>, as another probabilistic baseline.</p>
      </para>
      <para xml:id="S4.SS5.p2">
        <p>As shown in Table <ref labelref="LABEL:tab:res_unidentifiable"/>, the diffusion model mean prediction, obtained by averaging over the samples, has a higher MAE than the other methods, as expected. To illustrate this further, Fig. <ref labelref="LABEL:f:swe_predict"/> presents results for one test example with a large mean MAE. We see that the diffusion model produced samples which all have the same overall shape, but which differ in the initial velocity, which reflects true non-determinacy of the system. Further, the correct result is among the samples (‘closest’), and just by including two additional points in the conditioning set it can already be identified. The deterministic FNO and OFormer models have a relatively small MAE but they also introduce artifacts, making the prediction not compatible with the physical dynamics, as seen also in the large PDE-errors. The Kalman filter yields a plausible prediction but is less precise due to the linearization.</p>
      </para>
      <para xml:id="S4.SS5.p3">
        <p>Finally, Fig. <ref labelref="LABEL:f:swe_mae_pde_correlation"/> highlights the potential of the PDE-error as a prior to identify the most plausible samples. For all test examples the PDE-error is clearly correlated with the MAE (left and middle panels in Fig. <ref labelref="LABEL:f:swe_mae_pde_correlation"/>). However, even among the samples with the smallest PDE-errors, there can still be variability, as demonstrated on the middle row in Fig. <ref labelref="LABEL:f:swe_predict"/>. The rightmost panel in Fig. <ref labelref="LABEL:f:swe_mae_pde_correlation"/> confirms the earlier finding that the diffusion model produces samples with a smaller PDE-error, meaning that they better comply with the underlying physics.</p>
      </para>
      <figure inlist="lof" labels="LABEL:f:swe_predict" placement="t" xml:id="S4.F4">
        <tags>
          <tag>Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <graphics candidates="img/predict/predictions_all_61_pde.pdf" class="ltx_centering" graphic="img/predict/predictions_all_61_pde.pdf" options="height=176.40707pt,trim=5.69054pt 8.53581pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S4.F4.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>State reconstruction results for non-identifiable system SWE-init for a test sample with multiple possible outcomes. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 4</tag>State reconstruction results for non-identifiable system SWE-init for a test sample with multiple possible outcomes. </caption>
      </figure>
      <figure inlist="lof" labels="LABEL:f:swe_mae_pde_correlation" placement="t" xml:id="S4.F5">
        <tags>
          <tag>Figure 5</tag>
          <tag role="refnum">5</tag>
          <tag role="typerefnum">Figure 5</tag>
        </tags>
        <graphics candidates="img/mae_pde_scatter_hist.pdf" class="ltx_centering" graphic="img/mae_pde_scatter_hist.pdf" options="height=76.82243pt,trim=5.69054pt 8.53581pt 5.69054pt 5.69054pt,clip=true,keepaspectratio=true" xml:id="S4.F5.g1"/>
<!--  %**** main˙arxiv.tex Line 475 **** -->        <toccaption class="ltx_centering"><tag close=" ">5</tag>Detailed results for the non-identifiable system SWE-init. <text font="bold">Left</text>: PDE error vs. MAE for 100 samples for a single test case. <text font="bold">Middle</text>: Histogram of correlations between MAE and PDE error across the test set (red line shows the case on the left). <text font="bold">Right</text>: PDE errors of different models in the test set. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 5</tag>Detailed results for the non-identifiable system SWE-init. <text font="bold">Left</text>: PDE error vs. MAE for 100 samples for a single test case. <text font="bold">Middle</text>: Histogram of correlations between MAE and PDE error across the test set (red line shows the case on the left). <text font="bold">Right</text>: PDE errors of different models in the test set. </caption>
      </figure>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Discussion and Future work</title>
    <para xml:id="S5.p1">
      <p>We proposed a diffusion model that can be used as a neural operator to solve several tasks without retraining. Additionally, when the problem is not fully defined, the probabilistic model, unlike the deterministic alternatives, can produce several possible results compatible with the conditioning information, and we studied using prior knowledge, either additional measured points or the PDE error, as a way of selecting the most plausible samples.
As a limitation, the inference with the diffusion model requires sampling, which, despite recent improvements, is still slower than with the deterministic baselines. As future work, the model architecture could be tailored for the specifics of the dynamical systems.</p>
    </para>
  </section>
  <bibliography xml:id="bib">
    <title fontsize="90%">References</title>
    <biblist>
      <bibitem key="greydanus2019hamiltonian" xml:id="bib.bib1">
        <tags>
          <tag>[1]</tag>
          <tag role="refnum">1</tag>
        </tags>
        <bibblock><text fontsize="90%">
S. Greydanus et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Hamiltonian neural networks,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">NeurIPS.</text><text fontsize="90%">, 2019, vol. 32.
</text></bibblock>
      </bibitem>
      <bibitem key="haitsiukevich2021agrid" xml:id="bib.bib2">
        <tags>
          <tag>[2]</tag>
          <tag role="refnum">2</tag>
        </tags>
        <bibblock><text fontsize="90%">
K. Haitsiukevich et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“A grid-structured model of tubular reactors,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">2021 IEEE 19th Int. Conf. on Ind. Informatics (INDIN)</text><text fontsize="90%">, 2021, pp. 1–6.
</text></bibblock>
      </bibitem>
      <bibitem key="raissi2019pinn" xml:id="bib.bib3">
        <tags>
          <tag>[3]</tag>
          <tag role="refnum">3</tag>
        </tags>
        <bibblock><text fontsize="90%">
M. Raissi et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">J. Comput. Physics</text><text fontsize="90%">, vol. 378, pp. 686–707, 2019.
</text></bibblock>
      </bibitem>
      <bibitem key="yang2022learning" xml:id="bib.bib4">
        <tags>
          <tag>[4]</tag>
          <tag role="refnum">4</tag>
        </tags>
        <bibblock><text fontsize="90%">
T. Yang et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Learning physics constrained dynamics using autoencoders,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">NeurIPS</text><text fontsize="90%">, vol. 35, pp. 17157–17172, 2022.
</text></bibblock>
      </bibitem>
      <bibitem key="lam2023learning" xml:id="bib.bib5">
        <tags>
          <tag>[5]</tag>
          <tag role="refnum">5</tag>
        </tags>
        <bibblock><text fontsize="90%">
R. Lam et al.,
</text></bibblock>
        <bibblock><!--  %**** main˙arxiv.bbl Line 25 **** --><text fontsize="90%">“Learning skillful medium-range global weather forecasting,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">Science</text><text fontsize="90%">, p. eadi2336, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="li2021physics" xml:id="bib.bib6">
        <tags>
          <tag>[6]</tag>
          <tag role="refnum">6</tag>
        </tags>
        <bibblock><text fontsize="90%">
Z. Li et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Physics-informed neural operator for learning partial differential equations,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">ACM/JMS J. Data Science</text><text fontsize="90%">, 2021.
</text></bibblock>
      </bibitem>
      <bibitem key="sohl2015deep" xml:id="bib.bib7">
        <tags>
          <tag>[7]</tag>
          <tag role="refnum">7</tag>
        </tags>
        <bibblock><text fontsize="90%">
J. Sohl-Dickstein et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Deep unsupervised learning using nonequilibrium thermodynamics,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">ICML</text><text fontsize="90%">, 2015, pp. 2256–2265.
</text></bibblock>
      </bibitem>
      <bibitem key="ho2020denoising" xml:id="bib.bib8">
        <tags>
          <tag>[8]</tag>
          <tag role="refnum">8</tag>
        </tags>
        <bibblock><text fontsize="90%">
J. Ho et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Denoising diffusion probabilistic models,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">NeurIPS</text><text fontsize="90%">, vol. 33, pp. 6840–6851, 2020.
</text></bibblock>
      </bibitem>
      <bibitem key="lugmayr2022repaint" xml:id="bib.bib9">
        <tags>
          <tag>[9]</tag>
          <tag role="refnum">9</tag>
        </tags>
        <bibblock><text fontsize="90%">
A. Lugmayr et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Repaint: Inpainting using denoising diffusion probabilistic models,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">Proc. IEEE/CVF Conf. on Comp. Vision and Pattern Recognition</text><text fontsize="90%">, 2022, pp. 11461–11471.
</text></bibblock>
      </bibitem>
      <bibitem key="saharia2022palette" xml:id="bib.bib10">
        <tags>
          <tag>[10]</tag>
          <tag role="refnum">10</tag>
        </tags>
        <bibblock><text fontsize="90%">
C. Saharia et al.,
</text></bibblock>
        <bibblock><!--  %**** main˙arxiv.bbl Line 50 **** --><text fontsize="90%">“Palette: Image-to-image diffusion models,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">ACM SIGGRAPH 2022 Conf. Proc.</text><text fontsize="90%">, 2022, pp. 1–10.
</text></bibblock>
      </bibitem>
      <bibitem key="yang2023uni" xml:id="bib.bib11">
        <tags>
          <tag>[11]</tag>
          <tag role="refnum">11</tag>
        </tags>
        <bibblock><text fontsize="90%">
S. Yang et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Uni-paint: A unified framework for multimodal image inpainting with pretrained diffusion model,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">Proc. 31st ACM Int. Conf. on Multimedia</text><text fontsize="90%">, 2023, pp. 3190–3199.
</text></bibblock>
      </bibitem>
      <bibitem key="alcaraz2023diffusionbased" xml:id="bib.bib12">
        <tags>
          <tag>[12]</tag>
          <tag role="refnum">12</tag>
        </tags>
        <bibblock><text fontsize="90%">
J. Lopez Alcaraz et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Diffusion-based time series imputation and forecasting with structured state space models,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">Trans. Mach. Learn. Research</text><text fontsize="90%">, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="li2021fourier" xml:id="bib.bib13">
        <tags>
          <tag>[13]</tag>
          <tag role="refnum">13</tag>
        </tags>
        <bibblock><text fontsize="90%">
Z. Li et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Fourier neural operator for parametric partial differential equations,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">ICLR</text><text fontsize="90%">, 2021.
</text></bibblock>
      </bibitem>
      <bibitem key="li2023transformer" xml:id="bib.bib14">
        <tags>
          <tag>[14]</tag>
          <tag role="refnum">14</tag>
        </tags>
        <bibblock><text fontsize="90%">
Z. Li et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Transformer for partial differential equations’ operator learning,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">Trans. Mach. Learn. Research</text><text fontsize="90%">, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="kovachki2023neural" xml:id="bib.bib15">
        <tags>
          <tag>[15]</tag>
          <tag role="refnum">15</tag>
        </tags>
        <bibblock><text fontsize="90%">
N. Kovachki et al.,
</text></bibblock>
        <bibblock><!--  %**** main˙arxiv.bbl Line 75 **** --><text fontsize="90%">“Neural operator: Learning maps between function spaces with applications to pdes,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">J. Mach. Learn. Research</text><text fontsize="90%">, vol. 24, no. 89, pp. 1–97, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="long2024invertible" xml:id="bib.bib16">
        <tags>
          <tag>[16]</tag>
          <tag role="refnum">16</tag>
        </tags>
        <bibblock><text fontsize="90%">
D. Long et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Invertible fourier neural operators for tackling both forward and inverse problems,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">arXiv preprint arXiv:2402.11722</text><text fontsize="90%">, 2024.
</text></bibblock>
      </bibitem>
      <bibitem key="kohl2023turbulent" xml:id="bib.bib17">
        <tags>
          <tag>[17]</tag>
          <tag role="refnum">17</tag>
        </tags>
        <bibblock><text fontsize="90%">
G. Kohl et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Turbulent flow simulation using autoregressive conditional diffusion models,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">arXiv preprint arXiv:2309.01745</text><text fontsize="90%">, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="yang2023denoising" xml:id="bib.bib18">
        <tags>
          <tag>[18]</tag>
          <tag role="refnum">18</tag>
        </tags>
        <bibblock><text fontsize="90%">
G. Yang et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“A denoising diffusion model for fluid field prediction,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">arXiv preprint arXiv:2301.11661</text><text fontsize="90%">, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="apte2023diffusion" xml:id="bib.bib19">
        <tags>
          <tag>[19]</tag>
          <tag role="refnum">19</tag>
        </tags>
        <bibblock><text fontsize="90%">
R. Apte et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Diffusion model based data generation for partial differential equations,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">arXiv preprint arXiv:2306.11075</text><text fontsize="90%">, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="bastek2024physics" xml:id="bib.bib20">
        <tags>
          <tag>[20]</tag>
          <tag role="refnum">20</tag>
        </tags>
        <bibblock><text fontsize="90%">
J. Bastek et al.,
</text></bibblock>
        <bibblock><!--  %**** main˙arxiv.bbl Line 100 **** --><text fontsize="90%">“Physics-informed diffusion models,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">arXiv preprint arXiv:2403.14404</text><text fontsize="90%">, 2024.
</text></bibblock>
      </bibitem>
      <bibitem key="jacobsen2023cocogen" xml:id="bib.bib21">
        <tags>
          <tag>[21]</tag>
          <tag role="refnum">21</tag>
        </tags>
        <bibblock><text fontsize="90%">
C. Jacobsen et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Cocogen: Physically-consistent and conditioned score-based generative models for forward and inverse problems,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">arXiv preprint arXiv:2312.10527</text><text fontsize="90%">, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="shu2023physics" xml:id="bib.bib22">
        <tags>
          <tag>[22]</tag>
          <tag role="refnum">22</tag>
        </tags>
        <bibblock><text fontsize="90%">
D. Shu et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“A physics-informed diffusion model for high-fidelity flow field reconstruction,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">J. Comput. Physics</text><text fontsize="90%">, vol. 478, pp. 111972, 2023.
</text></bibblock>
      </bibitem>
      <bibitem key="nichol2021improved" xml:id="bib.bib23">
        <tags>
          <tag>[23]</tag>
          <tag role="refnum">23</tag>
        </tags>
        <bibblock><text fontsize="90%">
A.Q. Nichol et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Improved denoising diffusion probabilistic models,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">ICML</text><text fontsize="90%">, 2021, pp. 8162–8171.
</text></bibblock>
      </bibitem>
      <bibitem key="karras2022elucidating" xml:id="bib.bib24">
        <tags>
          <tag>[24]</tag>
          <tag role="refnum">24</tag>
        </tags>
        <bibblock><text fontsize="90%">
T. Karras et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Elucidating the design space of diffusion-based generative models,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">NeurIPS</text><text fontsize="90%">, vol. 35, pp. 26565–26577, 2022.
</text></bibblock>
      </bibitem>
      <bibitem key="ronneberger2015u" xml:id="bib.bib25">
        <tags>
          <tag>[25]</tag>
          <tag role="refnum">25</tag>
        </tags>
        <bibblock><text fontsize="90%">
O. Ronneberger et al.,
</text></bibblock>
        <bibblock><!--  %**** main˙arxiv.bbl Line 125 **** --><text fontsize="90%">“U-net: Convolutional networks for biomedical image segmentation,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">Med. Image Comput. and Computer-Assisted Intervention</text><text fontsize="90%">. Springer, 2015, pp. 234–241.
</text></bibblock>
      </bibitem>
      <bibitem key="song2020score" xml:id="bib.bib26">
        <tags>
          <tag>[26]</tag>
          <tag role="refnum">26</tag>
        </tags>
        <bibblock><text fontsize="90%">
Y. Song et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Score-based generative modeling through stochastic differential equations,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">ICLR</text><text fontsize="90%">, 2021.
</text></bibblock>
      </bibitem>
      <bibitem key="dhariwal2021diffusion" xml:id="bib.bib27">
        <tags>
          <tag>[27]</tag>
          <tag role="refnum">27</tag>
        </tags>
        <bibblock><text fontsize="90%">
P. Dhariwal et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Diffusion models beat gans on image synthesis,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">NeurIPS</text><text fontsize="90%">, vol. 34, pp. 8780–8794, 2021.
</text></bibblock>
      </bibitem>
      <bibitem key="song2020denoising" xml:id="bib.bib28">
        <tags>
          <tag>[28]</tag>
          <tag role="refnum">28</tag>
        </tags>
        <bibblock><text fontsize="90%">
J. Song et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Denoising diffusion implicit models,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">ICLR</text><text fontsize="90%">, 2021.
</text></bibblock>
      </bibitem>
      <bibitem key="takamoto2022pdebench" xml:id="bib.bib29">
        <tags>
          <tag>[29]</tag>
          <tag role="refnum">29</tag>
        </tags>
        <bibblock><text fontsize="90%">
M. Takamoto et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Pdebench: An extensive benchmark for scientific machine learning,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">NeurIPS</text><text fontsize="90%">, vol. 35, pp. 1596–1611, 2022.
</text></bibblock>
      </bibitem>
      <bibitem key="ketcheson2012pyclaw" xml:id="bib.bib30">
        <tags>
          <tag>[30]</tag>
          <tag role="refnum">30</tag>
        </tags>
        <bibblock><text fontsize="90%">
D.I. Ketcheson et al.,
</text></bibblock>
        <bibblock><!--  %**** main˙arxiv.bbl Line 150 **** --><text fontsize="90%">“Pyclaw: Accessible, extensible, scalable tools for wave propagation problems,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">SIAM J. Scientific Comput.</text><text fontsize="90%">, vol. 34, no. 4, pp. C210–C231, 2012.
</text></bibblock>
      </bibitem>
      <bibitem key="price1977catalyst" xml:id="bib.bib31">
        <tags>
          <tag>[31]</tag>
          <tag role="refnum">31</tag>
        </tags>
        <bibblock><text fontsize="90%">
T.H. Price et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Catalyst poisoning and fixed bed reactor dynamics—II: Adiabatic reactors,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">Chem. Eng. Sci.</text><text fontsize="90%">, vol. 32, no. 4, pp. 393–412, 1977.
</text></bibblock>
      </bibitem>
      <bibitem key="kalman1960new" xml:id="bib.bib32">
        <tags>
          <tag>[32]</tag>
          <tag role="refnum">32</tag>
        </tags>
        <bibblock><text fontsize="90%">
R.E. Kalman,
</text></bibblock>
        <bibblock><text fontsize="90%">“A new approach to linear filtering and prediction problems,”
</text></bibblock>
        <bibblock><text font="italic" fontsize="90%">J. Basic Eng.</text><text fontsize="90%">, vol. 82, no. 1, pp. 35–45, 1960.
</text></bibblock>
      </bibitem>
      <bibitem key="rafiee2009kalman" xml:id="bib.bib33">
        <tags>
          <tag>[33]</tag>
          <tag role="refnum">33</tag>
        </tags>
        <bibblock><text fontsize="90%">
M. Rafiee et al.,
</text></bibblock>
        <bibblock><text fontsize="90%">“Kalman filter based estimation of flow states in open channels using lagrangian sensing,”
</text></bibblock>
        <bibblock><text fontsize="90%">in </text><text font="italic" fontsize="90%">Proc. 48h IEEE Conf. on Decision and Control (CDC)</text><text fontsize="90%">, 2009, pp. 8266–8271.
</text></bibblock>
      </bibitem>
    </biblist>
  </bibliography>
</document>
