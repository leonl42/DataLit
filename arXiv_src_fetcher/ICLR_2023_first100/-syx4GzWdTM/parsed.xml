<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/university/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-syx4GzWdTM"?>
<?latexml class="IEEEtran" options="conference"?>
<?latexml package="cite"?>
<?latexml package="lineno" options="switch"?>
<?latexml package="amsmath,amssymb,amsfonts"?>
<?latexml package="algorithmic"?>
<?latexml package="graphicx"?>
<?latexml package="textcomp"?>
<?latexml package="xcolor"?>
<?latexml package="algorithm2e" options="vlined,ruled,linesnumbered"?>
<?latexml package="makecell"?>
<?latexml package="subfigure"?>
<?latexml package="mathtools"?>
<?latexml package="pbox"?>
<?latexml package="booktabs"?>
<?latexml package="microtype"?>
<?latexml package="flushend"?>
<?latexml package="caption"?>
<!--  %“newcommand–“cite˝[1]––“cite–#1˝˝˝ --><?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
<!--  %“linenumbers % FOR LINE NUMBERS 
     %“author–“IEEEauthorblockN–1“textsuperscript–st˝ Edward Chou˝ 
     %“IEEEauthorblockA–“textit–Stanford University˝ ““ 
     %ejchou@cs.stanford.edu˝ 
     %“and 
     %“IEEEauthorblockN–1“textsuperscript–st˝ Josh Beal˝ 
     %“IEEEauthorblockA–“textit–Stanford University˝ ““ 
     %joshbeal@cs.stanford.edu˝ 
     %“and 
     %“IEEEauthorblockN–3“textsuperscript–rd˝ Daniel Levy˝ 
     %**** main.tex Line 50 **** 
     %“IEEEauthorblockA–“textit–Stanford University˝ ““ 
     %danilevy@cs.stanford.edu˝ 
     %“and 
     %“IEEEauthorblockN–4“textsuperscript–th˝ Serena Yeung˝ 
     %“IEEEauthorblockA–“textit–Stanford University˝ ““ 
     %syyeung@stanford.edu˝ 
     %“and 
     %“IEEEauthorblockN–5“textsuperscript–th˝ Albert Haque˝ 
     %“IEEEauthorblockA–“textit–Stanford University˝ ““ 
     %ahaque@cs.stanford.edu˝ 
     %“and 
     %“IEEEauthorblockN–6“textsuperscript–th˝ Li Fei-Fei˝ 
     %“IEEEauthorblockA–“textit–Stanford University˝ ““ 
     %feifeili@cs.stanford.edu˝ 
     %˝““ -->  <title>Faster CryptoNets: Leveraging Sparsity for Real-World Encrypted Inference<break/><!--  %–“footnotesize “textsuperscript–*˝Note: Sub-titles are not captured in Xplore and 
     %should not be used˝ 
     %“thanks–Identify applicable funding agency here. If none, delete this.˝ --></title>
  <creator role="author">
    <personname>
Edward Chou1, Josh Beal2, Daniel Levy3, Serena Yeung4, Albert Haque 5, Li Fei-Fei7</personname>
    <contact role="thanks">authors 1 and 2 contributed equally</contact>
    <contact role="affiliation">Department of Computer Science, Stanford University<break/>Email:
1ejchou@cs.stanford.edu,
2joshbeal@cs.stanford.edu,
3danilevy@cs.stanford.edu,<break/><!--  %**** main.tex Line 75 **** -->4syyeung@stanford.edu,
5ahaque@cs.stanford.edu,
6feifeili@cs.stanford.edu</contact>
  </creator>
  <abstract name="Abstract">
    <p>Homomorphic encryption enables arbitrary computation over data while it remains encrypted.
This privacy-preserving feature is attractive for machine learning, but requires significant computational time due to the large overhead of the encryption scheme.
We present <text font="italic">Faster CryptoNets</text>, a method for efficient encrypted inference using neural networks.
We develop a pruning and quantization approach that leverages sparse representations in the underlying cryptosystem to accelerate inference.
We derive an optimal approximation for popular activation functions that achieves maximally-sparse encodings and minimizes approximation error.
We also show how privacy-safe training techniques can be used to reduce the overhead of encrypted inference for real-world datasets by leveraging transfer learning and differential privacy.
Our experiments show that our method maintains competitive accuracy and achieves a significant speedup over previous methods.
This work increases the viability of deep learning systems that use homomorphic encryption to protect user privacy.</p>
  </abstract>
  <keywords name="Index Terms">
Neural Networks, Deep Learning, Homomorphic Encryption, Privacy, Oblivious Inference
</keywords>
  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>I</tag>
      <tag role="refnum">I</tag>
      <tag role="typerefnum">§I</tag>
    </tags>
    <title><tag close=" ">I</tag><text font="smallcaps">Introduction</text></title>
    <para xml:id="S1.p1">
      <p><!--  %**** main.tex Line 100 **** -->As cloud-based machine learning services become more widespread, there is a strong need to ensure the confidentiality of sensitive healthcare records, financial data, and other information that enters third-party pipelines.
Traditional machine learning algorithms require access to raw data, which opens up potential security and privacy risks.
For some fields such as healthcare, regulations may preclude the use of external prediction services if the technology cannot provide the necessary privacy guarantees.</p>
    </para>
    <para xml:id="S1.p2">
      <p>In this work, we address the task of <text font="italic">encrypted inference</text> for secure machine learning services.
We make the assumption that the third-party provider already has a trained model, as is common in “machine learning as a service” paradigms.
Using cryptographic techniques, an organization such as a research hospital or fraud detection company will be able to offer prediction services to users while ensuring security guarantees for all parties involved.
We follow the procedure set by previous work <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets,xie2014crypto" separator="," yyseparator=","/>]</cite> and employ homomorphic encryption (HE) to convert a trained machine learning model into a HE-enabled model.</p>
    </para>
    <para xml:id="S1.p3">
      <p><!--  %Encrypting data is a common method for securing and preserving the privacy of data but is incompatible with many existing algorithms. -->Homomorphic encryption <!--  %Input/output 
     %In this paper, we address the problem of “textit–encrypted inference˝ using neural networks. --><cite class="ltx_citemacro_cite">[<bibref bibrefs="rivest1978data" separator="," yyseparator=","/>]</cite><!--  %“cite–graepel2012ml˝. --> allows a machine learning model to perform calculations over encrypted data. By design, the output prediction is also encrypted, which prevents the input or output from leaking information to the model’s host.
As show in Figure <ref labelref="LABEL:fig:pull"/>, the model does not decrypt the data nor is the private key needed
<cite class="ltx_citemacro_cite">[<bibref bibrefs="brakerski2014efficient" separator="," yyseparator=","/>]</cite>.</p>
    </para>
<!--  %The client has the ability to decrypt the output prediction with their private key. 
     %%Abstractly, such a machine learning model can be interpreted as a black-box machine: encrypted data goes in and encrypted data comes out. 
     %While encrypted computation is an attractive feature, it has only recently been applied to neural networks in “textit–CryptoNets˝. 
     %In their work, “cite–gilad2016cryptonets˝ successfully deploy a five-layer convolutional network which performs inferences on MNIST “cite–lecun1998mnist˝. 
     %“cite–coleman100dawnbench˝ -->    <para xml:id="S1.p4">
      <p><!--  %**** main.tex Line 125 **** -->Several challenges prevent widespread adoption of encrypted machine learning.
A major bottleneck is computational complexity.
Inference on plain networks is performed in the orders of milliseconds,
while encrypted networks require minutes or hours per example <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets,hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite><!--  %As the number of network layers increases, the number of multiplication operations increases __ also known as the “textit–multiplicative depth˝ “cite–coron2012public˝. -->.
Also, the reduced arithmetic set of HE prevents the use of modern activation functions <cite class="ltx_citemacro_cite">[<bibref bibrefs="chabanne2017privacy" separator="," yyseparator=","/>]</cite>.
necessitating the use of simpler lower-performance functions.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:pull" placement="t" xml:id="S1.F1">
      <tags>
        <tag>Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <graphics candidates="figures/pull/pull.jpg" class="ltx_centering" graphic="figures/pull/pull.jpg" options="width=433.62pt,keepaspectratio=true" xml:id="S1.F1.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">1</tag><text font="bold">Encrypted machine learning as a service paradigm.</text> Dashed lines indicate data transfer. The end-user (Alice) encrypts her sensitive data and sends it to a third-party host (Eve). Since Alice owns the private key, Eve cannot decrypt the input nor output prediction. Eve produces an encrypted prediction which is returned to Alice. Privacy is preserved in the entire pipeline for both inputs and outputs.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 1</tag><text font="bold">Encrypted machine learning as a service paradigm.</text> Dashed lines indicate data transfer. The end-user (Alice) encrypts her sensitive data and sends it to a third-party host (Eve). Since Alice owns the private key, Eve cannot decrypt the input nor output prediction. Eve produces an encrypted prediction which is returned to Alice. Privacy is preserved in the entire pipeline for both inputs and outputs.</caption>
    </figure>
    <subsection inlist="toc" xml:id="S1.SS1">
      <tags>
        <tag>I-A</tag>
        <tag role="refnum">I-A</tag>
        <tag role="typerefnum">§I-A</tag>
      </tags>
      <title><tag close=" ">I-A</tag><text font="italic">Contributions</text></title>
      <para xml:id="S1.SS1.p1">
        <p>We propose <text font="italic">Faster CryptoNets</text><!--  %The computational requirements of homomorphic encryption present substantial obstacles for adoption. --> – a method for encrypted inference on the order of seconds.
This is a significant improvement over existing state-of-the-art, which performs inference on the order of minutes.
Our contributions accelerate the homomorphic evaluation of deep learning models on encrypted data using sparse representations throughout the neural network.
Additionally, we are able to efficiently approximate modern activation functions.
Finally, we show how this technique can be combined with private training techniques in a plausible real-world scenario.
<!--  %With such barriers in place, the use of privacy-safe machine learning methods may be limited. --></p>
      </para>
      <para xml:id="S1.SS1.p2">
        <p><!--  %**** main.tex Line 150 **** -->By intelligently pruning the network parameters, we can avoid many multiplication operations – a major contributor to computational complexity.
We can progressively quantize the remaining network parameters such that the plaintext encodings achieve maximum sparsity.
Also, given that the activation function is the single most expensive operation of the network, we derive an optimal, quantized polynomial approximation to the activation function also with maximally-sparse encodings.
We empirically show a significant improvement in the runtime of the network on MNIST.
We perform additional experiments on larger datasets to demonstrate the viability and performance gain on practical tasks.
We use a feature-extraction based framework to reduce the number of layers requiring encrypted computation, while using differentially private training to achieve competitive accuracy on real-world datasets.
<!--  %“cite–gilad2016cryptonets˝. 
     %mohassel2017secureml --></p>
      </para>
<!--  %Overall, our work leverages the strengths of both machine learning and cryptography to reduce critical performance barriers of encrypted inference. -->    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:related_work" xml:id="S2">
    <tags>
      <tag>II</tag>
      <tag role="refnum">II</tag>
      <tag role="typerefnum">§II</tag>
    </tags>
    <title><tag close=" ">II</tag><text font="smallcaps">Related Work</text></title>
    <subsection inlist="toc" xml:id="S2.SS1">
      <tags>
        <tag>II-A</tag>
        <tag role="refnum">II-A</tag>
        <tag role="typerefnum">§II-A</tag>
      </tags>
      <title><tag close=" ">II-A</tag><text font="italic">Related Work</text></title>
      <para xml:id="S2.SS1.p1">
        <p>Privacy-preserving machine learning models attempt to address computation and statistical modeling of private data <cite class="ltx_citemacro_cite">[<bibref bibrefs="agrawal2000privacy" separator="," yyseparator=","/>]</cite>.
Privacy is preserved when two conditions are met: (i) the end-user learns nothing about the model and (ii) the model learns nothing from the data <cite class="ltx_citemacro_cite">[<bibref bibrefs="brickell2009privacy" separator="," yyseparator=","/>]</cite>.
Differential privacy, multi-party computation (MPC), and homomorphic encryption are different methods to preserve privacy.</p>
      </para>
      <para xml:id="S2.SS1.p2">
        <p><!--  %Differential privacy -->Differential privacy allows statistics to be computed over a dataset without revealing information about individual records <cite class="ltx_citemacro_cite">[<bibref bibrefs="dwork2008differential,chaudhuri2011differentially" separator="," yyseparator=","/>]</cite>.
A common method is to apply noise to individual examples to obfuscate statistical differences that might be distinguishable <cite class="ltx_citemacro_cite">[<bibref bibrefs="papernot2016semi" separator="," yyseparator=","/>]</cite><!--  %**** main.tex Line 175 **** -->.
However, differential privacy is better suited for the training phase. During test-time, adding noise to a single example may change the prediction.</p>
      </para>
      <para xml:id="S2.SS1.p3">
        <p>Secure multi-party computation enables multiple parties to jointly compute a function over their inputs while keeping their inputs private.
This has been explored using Garbled Circuits <cite class="ltx_citemacro_cite">[<bibref bibrefs="yao1986generate" separator="," yyseparator=","/>]</cite> in the works of <cite class="ltx_citemacro_cite">[<bibref bibrefs="rouhani2017deepsecure,kolesnikov2008improved" separator="," yyseparator=","/>]</cite> and <cite class="ltx_citemacro_cite">[<bibref bibrefs="mohassel2017secureml" separator="," yyseparator=","/>]</cite>.
These methods often involve a high communication complexity with significant bandwidth costs.</p>
      </para>
<!--  %in the online prediction phase. 
     %Recent works including “cite–riazi2018chameleon˝ and “cite–juvekar2018gazelle˝ aim to reduce these costs with hybrid approaches for the secure function evaluation. -->      <para xml:id="S2.SS1.p4">
        <p><!--  %Related work -->Fully homomorphic encryption (FHE) was proposed by <!--  %Ridge regression HE “cite–nikolaenko2013privacy˝. --><cite class="ltx_citemacro_cite">[<bibref bibrefs="gentry2009fully" separator="," yyseparator=","/>]</cite> and allows anyone to compute over encrypted data without decrypting it <cite class="ltx_citemacro_cite">[<bibref bibrefs="naehrig2011can" separator="," yyseparator=","/>]</cite>.
A weaker version of FHE, termed leveled homomorphic encryption (LHE) permits a subset of arithmetic operations on a depth-bounded arithmetic circuit <cite class="ltx_citemacro_cite">[<bibref bibrefs="brakerski2014efficient" separator="," yyseparator=","/>]</cite><!--  %“cite–gilad2016cryptonets˝ proposed CryptoNets, an approach for neural network inference over encrypted data. -->.
While HE has been explored for machine learning applications, many works focus on simpler models such as linear <!--  %In this seminal work, they demonstrated the success of a shallow convolutional neural network “cite–lecun1995convolutional˝ using a homomorphic encryption scheme. --><cite class="ltx_citemacro_cite">[<bibref bibrefs="hall2011secure" separator="," yyseparator=","/>]</cite>, logistic <cite class="ltx_citemacro_cite">[<bibref bibrefs="cheon2017privacy" separator="," yyseparator=","/>]</cite> and ridge regression <cite class="ltx_citemacro_cite">[<bibref bibrefs="irene2017ridge" separator="," yyseparator=","/>]</cite>.
CryptoNets <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/>]</cite> was one of the first works to implement HE in a neural network setting.
More recently, <cite class="ltx_citemacro_cite">[<bibref bibrefs="chabanne2017privacy" separator="," yyseparator=","/>]</cite> and <cite class="ltx_citemacro_cite">[<bibref bibrefs="hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite> extended this to deeper network architectures and developed additional polynomial approximations to the activation function that leveraged batch normalization for stability.</p>
      </para>
      <para xml:id="S2.SS1.p5">
        <p>Other works have explored the broader use of polynomial activation functions.
<cite class="ltx_citemacro_cite">[<bibref bibrefs="piazza1992artificial" separator="," yyseparator=","/>]</cite> and <cite class="ltx_citemacro_cite">[<bibref bibrefs="ma2005constructive" separator="," yyseparator=","/>]</cite> used a polynomial function in the non-encrypted domain to some success.
The original theory dates back to <cite class="ltx_citemacro_cite">[<bibref bibrefs="hornik1991approximation" separator="," yyseparator=","/>]</cite> who argues that as long as the activation function is arbitrarily bounded and non-constant, the neural network is a universal approximator.
Some prior work even suggests that neural networks equipped with polynomial functions have the same representational power as their non-polynomial counterparts <cite class="ltx_citemacro_cite">[<bibref bibrefs="gautier2016globally,livni2014computational" separator="," yyseparator=","/>]</cite>.
In §<ref labelref="LABEL:sec:prelim"/> and §<ref labelref="LABEL:sec:method"/>, we explore these ideas in greater detail.</p>
      </para>
      <para xml:id="S2.SS1.p6">
        <p><!--  %Deep compression was proposed by “cite–han2015deep˝ to reduce the computation required by a neural network. -->Recent works have proposed techniques that accelerate neural network inference on encrypted data.
Sanyal et. al. <!--  %In their work, the network pruning stage 
     %**** main.tex Line 200 **** --><cite class="ltx_citemacro_cite">[<bibref bibrefs="sanyal2018tapas" separator="," yyseparator=","/>]</cite> use sparsification techniques via binarized neural networks which achieves a similar speedup of around 30x wall-clock time as our technique on MNIST.
Florian et. al. <cite class="ltx_citemacro_cite">[<bibref bibrefs="florian2017fastdiscretize" separator="," yyseparator=","/>]</cite> opt for an approach that leverages scale invariance to allow unrestricted depth of neural networks. The technique we propose is distinct from these approaches due to its use of the encoding scheme to accelerate multiplicative operations, in contrast to the previous approaches which bypass expensive operations using the sign activation function. Our approach is advantageous in that it is more compatible with common neural network components; sign activation functions are known to cause difficulty with convergence, and the scale invariant <cite class="ltx_citemacro_cite">[<bibref bibrefs="florian2017fastdiscretize" separator="," yyseparator=","/>]</cite> precludes the use of convolutional layers. We do not present detailed comparisons to these works in our analysis due to these fundamental architectural differences, and opt for a direct comparison to CryptoNets to clearly demonstrate in which layers and with which operations are our speedups derived from.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:threat_model" xml:id="S3">
    <tags>
      <tag>III</tag>
      <tag role="refnum">III</tag>
      <tag role="typerefnum">§III</tag>
    </tags>
    <title><tag close=" ">III</tag><text font="smallcaps">Threat Model</text></title>
    <para xml:id="S3.p1">
      <p>Machine Learning as a Service (MLaaS) <cite class="ltx_citemacro_cite">[<bibref bibrefs="bae2018securityprivacyissues" separator="," yyseparator=","/>]</cite> is a framework where cloud providers offer machine learning training of inference hosted on the cloud. In our scenario we will be considering a MLaaS inference pipeline, where users send data to a remote server and receive predictions performed by machine learning models. The machine learning model is pre-trained on a proprietary dataset.</p>
    </para>
    <para xml:id="S3.p2">
      <p>A universal threat in multi-party situations is the inherent risk of data transmission, either by interception or side-channel attacks. This threat can be mitigated to a large extent by using strong cryptographic and signature protocols to protect the data in-transmission. However, a concern that is much harder to alleviate involves the threat of the cloud host collecting and utilizing the transmitted data without authorization <cite class="ltx_citemacro_cite">[<bibref bibrefs="bae2018securityprivacyissues" separator="," yyseparator=","/>]</cite>. In a naive scheme, a user sends encrypted data to the cloud, but also has to provide a key to the server to decrypt the data and compute a output with a machine learning algorithm before sending the encrypted prediction back to the user. The cloud host must have access to the plain data, and it is hard to guarantee or prove to the user that the data is not kept on the server, where it can either be sold to third-parties or be stolen by attackers who gain access to the data.</p>
    </para>
    <para xml:id="S3.p3">
      <p>Homomorphic encryption provides a solution to both problems. By design, the transmitted data is protected using a strong encryption scheme. It also enables ”oblivious inference”, where a cloud host operates on data that it is oblivious to. If the service provider is only allowed to compute on the encrypted data to compute an encrypted output without ever decrypting the data at any step, it will never have access to the plain data, guaranteeing data privacy from the cloud provider.</p>
    </para>
  </section>
  <section inlist="toc" labels="LABEL:sec:prelim" xml:id="S4">
    <tags>
      <tag>IV</tag>
      <tag role="refnum">IV</tag>
      <tag role="typerefnum">§IV</tag>
    </tags>
    <title><tag close=" ">IV</tag><text font="smallcaps">Preliminaries</text></title>
<!--  %We briefly give a primer on homomorphic encryption, including our encryption scheme. 
     %This will serve as the foundation of our method in “S“ref–sec:method˝. 
     %“subsection–Task Setting˝“label–sec:task˙setting˝ 
     %In this work, we address the task of “textit–encrypted inference˝. 
     %Our goal is to design a model that performs a set of homomorphic operations over an encrypted input. 
     %Let $“mathcal–M˝$ denote the message space (i.e., raw images) and $“mathcal–C˝$ denote the ciphertext space (i.e., encrypted images). 
     %Suppose the end-user, Alice, wishes to perform inference on her private data (input) $m “in “mathcal–M˝$ but lacks the machine learning model and compute necessary for inference. 
     %A third-party host, Eve, has a trained model $g:“mathcal–C˝ “rightarrow “mathcal–C˝$ suitable for homomorphic evaluation, which has been adapted from a standard trained ML model $g’:“mathcal–M˝ “rightarrow “mathcal–M˝$. Without loss of generality, let $g$ and $g’$ be a convolutional neural network “cite–lecun1995convolutional˝. 
     %Alice encrypts her input $m$ with the encryption function $E$, resulting in the encrypted input $E(m) “in “mathcal–C˝$. 
     %The newly encrypted message $E(m)$ is sent to Eve. 
     %Because $g$ operates on encrypted data, Eve can compute the encrypted output $g(E(m))$, while learning nothing about the contents of $m$. 
     %In this paper, our task is to design $g$ such that $g(E(m)) = E(g(m))$. 
     %Our model leverages homomorphic encryption (see “S“ref–sec:prelim˝) and as a result $g(E(x)) = E(g(x))$. 
     %When the encrypted output is sent back to Alice, she can now decrypt $E(g(x))$ which results in $D(E(g(x))) = g(x)$. 
     %This process is illustrated in Figure “ref–fig:pull˝. -->    <para xml:id="S4.p1">
      <p><!--  %“textbf–Homomorphic Encryption˝. -->A <!--  %Reword this paragraph on homomorphism because it’s a copy-paste from a different paper. --><text font="italic">homomorphism</text> is a structure-preserving transformation between two algebraic structures, which can be leveraged by cryptosystems to allow for arithmetic operations on encrypted data.
Let <Math mode="inline" tex="G_{q}" text="G _ q" xml:id="S4.p1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">G</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
            </XMApp>
          </XMath>
        </Math> be a cyclic group of order <Math mode="inline" tex="q" text="q" xml:id="S4.p1.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">q</XMTok>
          </XMath>
        </Math> with generator <Math mode="inline" tex="g" text="g" xml:id="S4.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">g</XMTok>
          </XMath>
        </Math>. Let <Math mode="inline" tex="h\in G_{q}" text="h element-of G _ q" xml:id="S4.p1.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">G</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> be randomly sampled as the public key.
Consider the ElGamal encryption scheme <cite class="ltx_citemacro_cite">[<bibref bibrefs="elgamal1985public" separator="," yyseparator=","/>]</cite>, which uses a map <Math mode="inline" tex="\Phi:G_{q}\rightarrow G_{q}\times G_{q}" text="Phi colon G _ q rightarrow G _ q * G _ q" xml:id="S4.p1.m5">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMTok name="Phi" role="UNKNOWN">Φ</XMTok>
              <XMApp>
                <XMTok name="rightarrow" role="ARROW">→</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">G</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">G</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">G</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> such that <Math mode="inline" tex="\Phi(m):=(g^{r},mh^{r})" text="Phi * m assign open-interval@(g ^ r, m * h ^ r)" xml:id="S4.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="assign" role="RELOP">:=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok name="Phi" role="UNKNOWN">Φ</XMTok>
                <XMDual>
                  <XMRef idref="S4.p1.m6.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.p1.m6.1">m</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.p1.m6.2"/>
                  <XMRef idref="S4.p1.m6.3"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.p1.m6.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">g</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.p1.m6.3">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> for random <Math mode="inline" tex="r" text="r" xml:id="S4.p1.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">r</XMTok>
          </XMath>
        </Math>.
The map <Math mode="inline" tex="\Phi" text="Phi" xml:id="S4.p1.m8">
          <XMath>
            <XMTok name="Phi" role="UNKNOWN">Φ</XMTok>
          </XMath>
        </Math> preserves the multiplicative structure of the integers such that <Math class="ltx_math_unparsed" mode="inline" tex="\Phi(m_{1}\times m_{2})=\Phi(m_{1})\otimes\Phi(m_{2})=(g^{(r_{1}+r_{2})},(m_{1%&#10;}\times m_{2})h^{(r_{1}+r_{2})}" xml:id="S4.p1.m9">
          <XMath>
            <XMTok name="Phi" role="UNKNOWN">Φ</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMTok meaning="times" role="MULOP">×</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMWrap>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok name="Phi" role="UNKNOWN">Φ</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMWrap>
            <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
            <XMTok name="Phi" role="UNKNOWN">Φ</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMWrap>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMDual>
                  <XMRef idref="S4.p1.m9.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.p1.m9.1">
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMTok role="PUNCT">,</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMDual>
                  <XMRef idref="S4.p1.m9.2"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.p1.m9.2">
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMWrap>
          </XMath>
        </Math>) where <Math mode="inline" tex="\otimes" text="tensor-product" xml:id="S4.p1.m10">
          <XMath>
            <XMTok meaning="tensor-product" name="otimes" role="MULOP">⊗</XMTok>
          </XMath>
        </Math> is the multiplication operation in <Math mode="inline" tex="G_{q}\times G_{q}" text="G _ q * G _ q" xml:id="S4.p1.m11">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">×</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">G</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">G</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="S4.p2">
      <p>The leveled homomorphic encryption scheme that we present below has a more complex algebraic structure, and supports both additive and multiplicative homomorphisms, but this example can serve as a basis for understanding the role of homomorphic encryption in our network design.</p>
    </para>
    <subsection inlist="toc" xml:id="S4.SS1">
      <tags>
        <tag>IV-A</tag>
        <tag role="refnum">IV-A</tag>
        <tag role="typerefnum">§IV-A</tag>
      </tags>
      <title><tag close=" ">IV-A</tag><text font="italic">Notation</text></title>
      <para xml:id="S4.SS1.p1">
        <p>Let <Math mode="inline" tex="R_{k}" text="R _ k" xml:id="S4.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> denote the polynomial ring <Math mode="inline" tex="\mathbb{Z}_{k}[x]/(x^{n}+1)" text="(Z _ k * delimited-[]@(x)) / (x ^ n + 1)" xml:id="S4.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">Z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S4.SS1.p1.m2.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p1.m2.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMRef idref="S4.SS1.p1.m2.2"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS1.p1.m2.2">
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
We let <Math mode="inline" tex="x\leftarrow S" text="x leftarrow S" xml:id="S4.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMApp>
            </XMath>
          </Math> denote uniformly random sampling of <Math mode="inline" tex="x" text="x" xml:id="S4.SS1.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> from an arbitrary set <Math mode="inline" tex="S" text="S" xml:id="S4.SS1.p1.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math>, and <Math mode="inline" tex="\lfloor\frac{t}{q}p\rceil" text="delimited-⌊⌉@((t / q) * p)" xml:id="S4.SS1.p1.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="delimited-⌊⌉"/>
                  <XMRef idref="S4.SS1.p1.m6.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                  <XMApp xml:id="S4.SS1.p1.m6.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  </XMApp>
                  <XMTok name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> denote a coefficient-wise division and rounding of the polynomial <Math mode="inline" tex="p" text="p" xml:id="S4.SS1.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> with respect to integer moduli <Math mode="inline" tex="t" text="t" xml:id="S4.SS1.p1.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="q" text="q" xml:id="S4.SS1.p1.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math>.
Let <Math mode="inline" tex="[p]_{q}" text="(delimited-[]@(p)) _ q" xml:id="S4.SS1.p1.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S4.SS1.p1.m10.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p1.m10.1">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> denote the reduction of the coefficients of the polynomial <Math mode="inline" tex="p" text="p" xml:id="S4.SS1.p1.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> modulo <Math mode="inline" tex="q" text="q" xml:id="S4.SS1.p1.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math>, and let <Math mode="inline" tex="\Delta" text="Delta" xml:id="S4.SS1.p1.m13">
            <XMath>
              <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
            </XMath>
          </Math> denote <Math mode="inline" tex="\lfloor{q/t}\rfloor" text="floor@(q / t)" xml:id="S4.SS1.p1.m14">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="floor"/>
                  <XMRef idref="S4.SS1.p1.m14.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                  <XMApp xml:id="S4.SS1.p1.m14.1">
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.</p>
      </para>
<!--  %It supports both additive and multiplicative homomorphisms. 
     %**** main.tex Line 250 **** 
     %“cite–bajard2016full˝ propose an encryption scheme, FV-RNS, which is a residue number system (RNS) variant of the FV encryption scheme “cite–fan2012somewhat˝. 
     %The security of FV-RNS depends on the Ring Learning With Errors problem “cite–lyubashevsky2010ideal˝. 
     %, which serves as the foundation of many defenses against quantum cryptanalysis. 
     %In FV-RNS, plaintexts are elements of the polynomial ring $R˙t$, where $t$ is the plaintext modulus and $n$ is the maximum degree of the polynomial, which is commonly selected to be one of $“–1024, 2048, 4096, 8192, 16384, 32768“˝$. 
     %The plaintext elements are mapped to multiple ciphertexts in $R˙q$ in the encryption scheme, with $q “gg t$ as the ciphertext coefficient modulus. 
     %As noted by “cite–lindner2011better˝, $“sigma = 3.19$ is often used. 
     %Let $“ell = “lfloor –“log˙w q˝ “rfloor$ be the number of terms in the base $w$ decomposition of polynomials in $R˙q$. 
     %Let $G˙q$ be a cyclic group of order $q$ with generator $g$. Let $h “in G˙q$ be randomly sampled as the public key. 
     %Consider the ElGamal encryption scheme “cite–elgamal1985public˝, which uses a map $“Phi: G˙q “rightarrow  G˙q “times G˙q$ such that $“Phi(m) := (g^r, mh^r)$ for random $r$. 
     %The map $“Phi$ preserves the multiplicative structure of the integers such that $“Phi(m˙1 “times m˙2) = “Phi(m˙1) “otimes “Phi(m˙2) = (g^–(r˙1+r˙2)˝, (m˙1 “times m˙2)h^–(r˙1+r˙2)˝$) where $“otimes$ is the multiplication operation in $G˙q “times  G˙q$. 
     %The leveled homomorphic encryption scheme that we present below has a more complex algebraic structure, and supports both additive and multiplicative homomorphisms, but this example can serve as a basis for understanding the role of homomorphic encryption in our network design. 
     %Consider the map $“Phi: “mathbb–Z˝ “rightarrow  “mathbb–Z˝˙7$ such that $“Phi(z) := z “mod 7$. 
     %This map $“Phi$ preserves both the additive and multiplicative structure of the integers, in the sense that for every $z˙1, z˙2 “in “mathbb–Z˝$, we have that $“Phi(z˙1 + z˙2) = “Phi(z˙1) “oplus “Phi(z˙2)$ and $“Phi(z˙1  z˙2) = “Phi(z˙1) “otimes “Phi(z˙2)$ where $“oplus$ and $“otimes$ are the addition and multiplication operations in $“mathbb–Z˝˙7$. The map $“Phi$ is a ring homomorphism between the rings $“mathbb–Z˝$ and $“mathbb–Z˝˙7$. 
     %This serves as a basis for homomorphic encryption. 
     %“textbf–Notation˝. 
     %Let $“mathcal–M˝$ denote the message space (i.e., raw images) and $“mathcal–C˝$ denote the ciphertext space (i.e., encrypted images). -->    </subsection>
    <subsection inlist="toc" xml:id="S4.SS2">
      <tags>
        <tag>IV-B</tag>
        <tag role="refnum">IV-B</tag>
        <tag role="typerefnum">§IV-B</tag>
      </tags>
      <title><tag close=" ">IV-B</tag><text font="italic">Encryption Scheme.</text></title>
      <para xml:id="S4.SS2.p1">
        <p>Bajard et al. <cite class="ltx_citemacro_cite">[<bibref bibrefs="bajard2016full" separator="," yyseparator=","/>]</cite><!--  %“cite–fan2012somewhat˝. --> proposed an encryption scheme, FV-RNS, which is a residue number system (RNS) variant of the FV encryption scheme. In FV-RNS, plaintexts are elements of the polynomial ring <!--  %The security of FV-RNS depends on the Ring Learning With Errors problem “cite–lyubashevsky2010ideal˝. 
     %, which serves as the foundation of many defenses against quantum cryptanalysis. 
     %**** main.tex Line 275 **** --><Math mode="inline" tex="R_{t}" text="R _ t" xml:id="S4.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math>, where <Math mode="inline" tex="t" text="t" xml:id="S4.SS2.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> is the plaintext modulus and <Math mode="inline" tex="n" text="n" xml:id="S4.SS2.p1.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
            </XMath>
          </Math> is the maximum degree of the polynomial, which is commonly selected to be one of <Math mode="inline" tex="\{1024,2048,4096,8192,16384,32768\}" text="set@(1024, 2048, 4096, 8192, 16384, 32768)" xml:id="S4.SS2.p1.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="S4.SS2.p1.m4.1"/>
                  <XMRef idref="S4.SS2.p1.m4.2"/>
                  <XMRef idref="S4.SS2.p1.m4.3"/>
                  <XMRef idref="S4.SS2.p1.m4.4"/>
                  <XMRef idref="S4.SS2.p1.m4.5"/>
                  <XMRef idref="S4.SS2.p1.m4.6"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMTok meaning="1024" role="NUMBER" xml:id="S4.SS2.p1.m4.1">1024</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="2048" role="NUMBER" xml:id="S4.SS2.p1.m4.2">2048</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="4096" role="NUMBER" xml:id="S4.SS2.p1.m4.3">4096</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="8192" role="NUMBER" xml:id="S4.SS2.p1.m4.4">8192</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="16384" role="NUMBER" xml:id="S4.SS2.p1.m4.5">16384</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="32768" role="NUMBER" xml:id="S4.SS2.p1.m4.6">32768</XMTok>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.
The plaintext elements are mapped to multiple ciphertexts in <Math mode="inline" tex="R_{q}" text="R _ q" xml:id="S4.SS2.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> in the encryption scheme, with <Math mode="inline" tex="q\gg t" text="q &gt;&gt; t" xml:id="S4.SS2.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="much-greater-than" name="gg" role="RELOP">≫</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %As noted by “cite–lindner2011better˝, $“sigma = 3.19$ is often used. --> as the ciphertext coefficient modulus.
For any logarithm base <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m7">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>, let <Math mode="inline" tex="\ell=\lfloor{\log_{\beta}q}\rfloor" text="ell = floor@((logarithm _ beta)@(q))" xml:id="S4.SS2.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="floor"/>
                    <XMRef idref="S4.SS2.p1.m8.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                    <XMApp xml:id="S4.SS2.p1.m8.1">
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> be the number of terms in the base-<Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m9">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> decomposition of polynomials in <Math mode="inline" tex="R_{q}" text="R _ q" xml:id="S4.SS2.p1.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> that is used for relinearization.</p>
      </para>
<!--  %in ciphertext multiplication. -->      <para xml:id="S4.SS2.p2">
        <p><!--  %“textbf–Key Generation˝. -->Let <Math mode="inline" tex="\chi" text="chi" xml:id="S4.SS2.p2.m1">
            <XMath>
              <XMTok font="italic" name="chi" role="UNKNOWN">χ</XMTok>
            </XMath>
          </Math> denote the truncated discrete Gaussian distribution.
The secret key is generated as <Math mode="inline" tex="s\leftarrow R_{3}" text="s leftarrow R _ 3" xml:id="S4.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> with coefficients <Math mode="inline" tex="s_{i}\in\{0,1,-1\}" text="s _ i element-of set@(0, 1, - 1)" xml:id="S4.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S4.SS2.p2.m3.1"/>
                    <XMRef idref="S4.SS2.p2.m3.2"/>
                    <XMRef idref="S4.SS2.p2.m3.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S4.SS2.p2.m3.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S4.SS2.p2.m3.2">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p2.m3.3">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
The public key <Math mode="inline" tex="(p_{0},p_{1})" text="open-interval@(p _ 0, p _ 1)" xml:id="S4.SS2.p2.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS2.p2.m4.1"/>
                  <XMRef idref="S4.SS2.p2.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS2.p2.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS2.p2.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is generated by sampling <Math mode="inline" tex="p_{0}\leftarrow R_{q}" text="p _ 0 leftarrow R _ q" xml:id="S4.SS2.p2.m5">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="e^{\prime}\leftarrow\chi" text="e ^ prime leftarrow chi" xml:id="S4.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok font="italic" name="chi" role="UNKNOWN">χ</XMTok>
              </XMApp>
            </XMath>
          </Math> and constructing <Math mode="inline" tex="p_{1}=[−(sp_{0}+e^{\prime})]_{q}" text="p _ 1 = (delimited-[]@(− * (s * p _ 0 + e ^ prime))) _ q" xml:id="S4.SS2.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S4.SS2.p2.m7.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S4.SS2.p2.m7.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN">−</XMTok>
                        <XMDual>
                          <XMRef idref="S4.SS2.p2.m7.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.SS2.p2.m7.1.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
The evaluation keys <Math mode="inline" tex="(a_{i},g_{i})" text="open-interval@(a _ i, g _ i)" xml:id="S4.SS2.p2.m8">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS2.p2.m8.1"/>
                  <XMRef idref="S4.SS2.p2.m8.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS2.p2.m8.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS2.p2.m8.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">g</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> are generated by sampling <Math mode="inline" tex="a_{i}\leftarrow R_{q}" text="a _ i leftarrow R _ q" xml:id="S4.SS2.p2.m9">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and constructing <Math mode="inline" tex="g_{i}=[−(a_{i}s+ie^{\prime})+\beta^{i}s^{2}]_{q}" text="g _ i = (delimited-[]@(− * (a _ i * s + i * e ^ prime) + beta ^ i * s ^ 2)) _ q" xml:id="S4.SS2.p2.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S4.SS2.p2.m10.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S4.SS2.p2.m10.1">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN">−</XMTok>
                          <XMDual>
                            <XMRef idref="S4.SS2.p2.m10.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S4.SS2.p2.m10.1.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for each <Math mode="inline" tex="i\in\{0,...,\ell\}" text="i element-of set@(0, ldots, ell)" xml:id="S4.SS2.p2.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">i</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S4.SS2.p2.m11.1"/>
                    <XMRef idref="S4.SS2.p2.m11.2"/>
                    <XMRef idref="S4.SS2.p2.m11.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S4.SS2.p2.m11.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S4.SS2.p2.m11.2">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ell" role="UNKNOWN" xml:id="S4.SS2.p2.m11.3">ℓ</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S4.SS2.p3">
        <p><!--  %“textbf–Encryption “&amp; Decryption˝. -->A plaintext <Math mode="inline" tex="m\in R_{t}" text="m element-of R _ t" xml:id="S4.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is encrypted by sampling <Math mode="inline" tex="u\leftarrow R_{3}" text="u leftarrow R _ 3" xml:id="S4.SS2.p3.m2">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> with coefficients <Math mode="inline" tex="u_{i}\in\{0,1,-1\}" text="u _ i element-of set@(0, 1, - 1)" xml:id="S4.SS2.p3.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">u</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S4.SS2.p3.m3.1"/>
                    <XMRef idref="S4.SS2.p3.m3.2"/>
                    <XMRef idref="S4.SS2.p3.m3.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S4.SS2.p3.m3.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S4.SS2.p3.m3.2">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m3.3">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="e_{1},e_{2}\leftarrow\chi" text="list@(e _ 1, e _ 2) leftarrow chi" xml:id="S4.SS2.p3.m4">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S4.SS2.p3.m4.1"/>
                    <XMRef idref="S4.SS2.p3.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S4.SS2.p3.m4.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m4.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMTok font="italic" name="chi" role="UNKNOWN">χ</XMTok>
              </XMApp>
            </XMath>
          </Math>, and letting <Math mode="inline" tex="(c_{0},c_{1})=([\lfloor{q/t}\rfloor m+p_{0}u+e_{1}]_{q},[p_{1}u+e_{1}]_{q})" text="open-interval@(c _ 0, c _ 1) = open-interval@((delimited-[]@(floor@(q / t) * m + p _ 0 * u + e _ 1)) _ q, (delimited-[]@(p _ 1 * u + e _ 1)) _ q)" xml:id="S4.SS2.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S4.SS2.p3.m5.1"/>
                    <XMRef idref="S4.SS2.p3.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m5.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m5.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S4.SS2.p3.m5.3"/>
                    <XMRef idref="S4.SS2.p3.m5.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m5.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S4.SS2.p3.m5.3.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S4.SS2.p3.m5.3.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="floor"/>
                                  <XMRef idref="S4.SS2.p3.m5.3.1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                                  <XMApp xml:id="S4.SS2.p3.m5.3.1.1">
                                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                  <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" role="UNKNOWN">m</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">u</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">e</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m5.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S4.SS2.p3.m5.4.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S4.SS2.p3.m5.4.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">u</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">e</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
A ciphertext <Math mode="inline" tex="(c_{0},c_{1})\in R_{q}\times R_{q}" text="open-interval@(c _ 0, c _ 1) element-of R _ q * R _ q" xml:id="S4.SS2.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S4.SS2.p3.m6.1"/>
                    <XMRef idref="S4.SS2.p3.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m6.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p3.m6.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is decrypted as <Math class="ltx_math_unparsed" mode="inline" tex="m=[\lfloor\frac{t}{q}[c_{0}+c_{1}s]_{q}\rceil]_{t}\in R_{t}" xml:id="S4.SS2.p3.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">m</XMTok>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                  </XMWrap>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS3">
      <tags>
        <tag>IV-C</tag>
        <tag role="refnum">IV-C</tag>
        <tag role="typerefnum">§IV-C</tag>
      </tags>
      <title><tag close=" ">IV-C</tag><text font="italic">Arithmetic</text></title>
      <para xml:id="S4.SS3.p1">
        <p>.
The addition of two ciphertexts <Math mode="inline" tex="(c_{0},c_{1})" text="open-interval@(c _ 0, c _ 1)" xml:id="S4.SS3.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p1.m1.1"/>
                  <XMRef idref="S4.SS3.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m1.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and <Math mode="inline" tex="(d_{0},d_{1})" text="open-interval@(d _ 0, d _ 1)" xml:id="S4.SS3.p1.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p1.m2.1"/>
                  <XMRef idref="S4.SS3.p1.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m2.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is <Math mode="inline" tex="(c_{0}+d_{0},c_{1}+d_{1})" text="open-interval@(c _ 0 + d _ 0, c _ 1 + d _ 1)" xml:id="S4.SS3.p1.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p1.m3.1"/>
                  <XMRef idref="S4.SS3.p1.m3.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m3.1">
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m3.2">
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.
The multiplication of two ciphertexts <Math mode="inline" tex="(c_{0},c_{1})" text="open-interval@(c _ 0, c _ 1)" xml:id="S4.SS3.p1.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p1.m4.1"/>
                  <XMRef idref="S4.SS3.p1.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and <Math mode="inline" tex="(d_{0},d_{1})" text="open-interval@(d _ 0, d _ 1)" xml:id="S4.SS3.p1.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p1.m5.1"/>
                  <XMRef idref="S4.SS3.p1.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m5.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p1.m5.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> occurs by constructing</p>
        <equation xml:id="S4.Ex1">
          <Math class="ltx_math_unparsed" mode="display" tex="c_{0}^{\prime}=\left[\left\lfloor\frac{t}{q}[c_{0}d_{0}]\right\rceil\right]_{q%&#10;}\textrm{ ,\quad}c_{1}^{\prime}=\left[\left\lfloor\frac{t}{q}[c_{0}d_{1}+c_{1}%&#10;d_{0}]\right\rceil\right]_{q}," xml:id="S4.Ex1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="true">[</XMTok>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="true">⌊</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                    <XMTok name="rceil" role="CLOSE" stretchy="true">⌉</XMTok>
                  </XMWrap>
                  <XMTok role="CLOSE" stretchy="true">]</XMTok>
                </XMWrap>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
              <XMText> , </XMText>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="true">[</XMTok>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="true">⌊</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                    <XMTok name="rceil" role="CLOSE" stretchy="true">⌉</XMTok>
                  </XMWrap>
                  <XMTok role="CLOSE" stretchy="true">]</XMTok>
                </XMWrap>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
              <XMTok role="PUNCT">,</XMTok>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S4.Ex2">
          <Math class="ltx_math_unparsed" mode="display" tex="\textrm{ and \,}c_{2}^{\prime}=\left[\left\lfloor\frac{t}{q}[c_{1}d_{1}]\right%&#10;\rceil\right]_{q}." xml:id="S4.Ex2.m1">
            <XMath>
              <XMText> and  </XMText>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="true">[</XMTok>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="true">⌊</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                    <XMTok name="rceil" role="CLOSE" stretchy="true">⌉</XMTok>
                  </XMWrap>
                  <XMTok role="CLOSE" stretchy="true">]</XMTok>
                </XMWrap>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
              <XMTok role="PERIOD">.</XMTok>
            </XMath>
          </Math>
        </equation>
        <p>We express <Math mode="inline" tex="c_{2}^{\prime}" text="(c _ 2) ^ prime" xml:id="S4.SS3.p1.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> in base <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS3.p1.m7">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> as <Math mode="inline" tex="c_{2}^{\prime}=\sum_{i=0}^{\ell}c_{2}^{\prime(i)}\beta^{i}" text="(c _ 2) ^ prime = ((sum _ (i = 0)) ^ ell)@((c _ 2) ^ (list@(prime1, i)) * beta ^ i)" xml:id="S4.SS3.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S4.SS3.p1.m8.2"/>
                          <XMRef idref="S4.SS3.p1.m8.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="prime1" role="SUPOP" xml:id="S4.SS3.p1.m8.2">′</XMTok>
                          <XMTok role="PUNCT">⁣</XMTok>
                          <XMDual xml:id="S4.SS3.p1.m8.3">
                            <XMRef idref="S4.SS3.p1.m8.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.SS3.p1.m8.1">i</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. We then let <Math mode="inline" tex="r_{0}=c_{0}^{\prime}+\sum_{i=0}^{\ell}a_{i}c_{2}^{\prime(i)}" text="r _ 0 = (c _ 0) ^ prime + ((sum _ (i = 0)) ^ ell)@(a _ i * (c _ 2) ^ (list@(prime1, i)))" xml:id="S4.SS3.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S4.SS3.p1.m9.2"/>
                            <XMRef idref="S4.SS3.p1.m9.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="prime1" role="SUPOP" xml:id="S4.SS3.p1.m9.2">′</XMTok>
                            <XMTok role="PUNCT">⁣</XMTok>
                            <XMDual xml:id="S4.SS3.p1.m9.3">
                              <XMRef idref="S4.SS3.p1.m9.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.SS3.p1.m9.1">i</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="r_{1}=c_{1}^{\prime}+\sum_{i=0}^{\ell}g_{i}c_{2}^{\prime(i)}" text="r _ 1 = (c _ 1) ^ prime + ((sum _ (i = 0)) ^ ell)@(g _ i * (c _ 2) ^ (list@(prime1, i)))" xml:id="S4.SS3.p1.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S4.SS3.p1.m10.2"/>
                            <XMRef idref="S4.SS3.p1.m10.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="prime1" role="SUPOP" xml:id="S4.SS3.p1.m10.2">′</XMTok>
                            <XMTok role="PUNCT">⁣</XMTok>
                            <XMDual xml:id="S4.SS3.p1.m10.3">
                              <XMRef idref="S4.SS3.p1.m10.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.SS3.p1.m10.1">i</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, which forms the product ciphertext <Math mode="inline" tex="(r_{0},r_{1})\in R_{q}\times R_{q}" text="open-interval@(r _ 0, r _ 1) element-of R _ q * R _ q" xml:id="S4.SS3.p1.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S4.SS3.p1.m11.1"/>
                    <XMRef idref="S4.SS3.p1.m11.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS3.p1.m11.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS3.p1.m11.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S4.SS3.p2">
        <p><!--  %Explain arithmetic for plaintext-ciphertext ? -->The addition of ciphertext <Math mode="inline" tex="(c_{0},c_{1})" text="open-interval@(c _ 0, c _ 1)" xml:id="S4.SS3.p2.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p2.m1.1"/>
                  <XMRef idref="S4.SS3.p2.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m1.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and plaintext <Math mode="inline" tex="m" text="m" xml:id="S4.SS3.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">m</XMTok>
            </XMath>
          </Math> is the ciphertext <Math mode="inline" tex="(c_{0}+\Delta m,c_{1})" text="open-interval@(c _ 0 + Delta * m, c _ 1)" xml:id="S4.SS3.p2.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p2.m3.1"/>
                  <XMRef idref="S4.SS3.p2.m3.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m3.1">
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m3.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. The multiplication of ciphertext <Math mode="inline" tex="(c_{0},c_{1})" text="open-interval@(c _ 0, c _ 1)" xml:id="S4.SS3.p2.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p2.m4.1"/>
                  <XMRef idref="S4.SS3.p2.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and plaintext <Math mode="inline" tex="m" text="m" xml:id="S4.SS3.p2.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">m</XMTok>
            </XMath>
          </Math> is the ciphertext <Math mode="inline" tex="(mc_{0},mc_{1})" text="open-interval@(m * c _ 0, m * c _ 1)" xml:id="S4.SS3.p2.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS3.p2.m6.1"/>
                  <XMRef idref="S4.SS3.p2.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m6.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p2.m6.2">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S4.SS3.p3">
        <p>The advantage of the residue number system variant is that the coefficient modulus <Math mode="inline" tex="q" text="q" xml:id="S4.SS3.p3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> can be decomposed into several small moduli <Math mode="inline" tex="q_{1},...,q_{k}" text="list@(q _ 1, ldots, q _ k)" xml:id="S4.SS3.p3.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S4.SS3.p3.m2.2"/>
                  <XMRef idref="S4.SS3.p3.m2.1"/>
                  <XMRef idref="S4.SS3.p3.m2.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S4.SS3.p3.m2.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S4.SS3.p3.m2.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS3.p3.m2.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to avoid multiple-precision operations on the polynomial coefficients in the homomorphic operations, which improves the efficiency of evaluation.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS4">
      <tags>
        <tag>IV-D</tag>
        <tag role="refnum">IV-D</tag>
        <tag role="typerefnum">§IV-D</tag>
      </tags>
      <title><tag close=" ">IV-D</tag><text font="italic">Integer Encoder</text></title>
      <para xml:id="S4.SS4.p1">
        <p>.
To encode real numbers involved in the computation, we choose a fixed precision for the values (15 bits) and scale each value by the corresponding power of 2 to get an integer for use with the encoder described below. After decryption, we can divide by the accumulated scaling factor to obtain a real value for the prediction.
The encoder consists of a base-2 integer encoder <cite class="ltx_citemacro_cite">[<bibref bibrefs="seal23" separator="," yyseparator=","/>]</cite>.
For a given integer <Math mode="inline" tex="z" text="z" xml:id="S4.SS4.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">z</XMTok>
            </XMath>
          </Math>, consider the binary expansion of <Math mode="inline" tex="|z|=z_{n-1}...z_{1}z_{0}" text="absolute-value@(z) = z _ (n - 1) * ldots * z _ 1 * z _ 0" xml:id="S4.SS4.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S4.SS4.p1.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS4.p1.m2.1">z</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok name="ldots" role="ID">…</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
The the coefficients <Math mode="inline" tex="b_{i}" text="b _ i" xml:id="S4.SS4.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> of the polynomial <Math mode="inline" tex="f(x)=\sum_{i=0}^{n-1}b_{i}x^{i}" text="f * x = ((sum _ (i = 0)) ^ (n - 1))@(b _ i * x ^ i)" xml:id="S4.SS4.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS4.p1.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS4.p1.m4.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">b</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> in the plaintext ring are <Math mode="inline" tex="z_{i}" text="z _ i" xml:id="S4.SS4.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> if <Math mode="inline" tex="z_{i}\geq 0" text="z _ i &gt;= 0" xml:id="S4.SS4.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> otherwise <Math mode="inline" tex="b_{i}=t-z_{i}" text="b _ i = t - z _ i" xml:id="S4.SS4.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">b</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
<!--  %Note that $t - z˙i = - z˙i “mod t$ and $f(2) = z$. 
     %The likelihood of coefficient reduction is much less compared to a direct encoding of the integer as a single coefficient. 
     %At the end of the computation, we can divide by the accumulated scaling factor to obtain a real value for the prediction. -->    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:method" xml:id="S5">
    <tags>
      <tag>V</tag>
      <tag role="refnum">V</tag>
      <tag role="typerefnum">§V</tag>
    </tags>
    <title><tag close=" ">V</tag><text font="smallcaps">Method</text></title>
<!--  %Homomorphic encryption methods have not been widely adopted in machine learning due to their large computational requirements, often requiring several minutes to hours per example “cite–hesamifard2017cryptodl, gilad2016cryptonets˝. 
     %In this section, we present our main contribution: leveraging sparsity and quantized approximations for several components of the neural network and its plaintext representations in the encryption scheme. -->    <subsection inlist="toc" xml:id="S5.SS1">
      <tags>
        <tag>V-A</tag>
        <tag role="refnum">V-A</tag>
        <tag role="typerefnum">§V-A</tag>
      </tags>
      <title><tag close=" ">V-A</tag><text font="italic">Sparse Polynomial Multiplication</text></title>
      <para xml:id="S5.SS1.p1">
        <p><!--  %**** main.tex Line 325 **** -->The convolutional and fully connected layers of a neural network require a substantial number of multiplications involving both the ciphertext inputs and the plaintext parameters of the model.
Each operation involves computing the product of two polynomials with up to <Math mode="inline" tex="n" text="n" xml:id="S5.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
            </XMath>
          </Math> nonzero coefficients.
While a brute-force implementation would require <Math mode="inline" tex="\mathcal{O}(n^{2})" text="O * n ^ 2" xml:id="S5.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p1.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS1.p1.m2.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> time to complete, homomorphic encryption methods are able to accomplish this in <Math mode="inline" tex="\mathcal{O}(n\log{}n)" text="O * n * logarithm@(n)" xml:id="S5.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p1.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS1.p1.m3.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> when certain conditions are met.
Assuming that the coefficient modulus <Math mode="inline" tex="q" text="q" xml:id="S5.SS1.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> is chosen such that <Math mode="inline" tex="(q-1)" text="q - 1" xml:id="S5.SS1.p1.m5">
            <XMath>
              <XMDual>
                <XMRef idref="S5.SS1.p1.m5.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S5.SS1.p1.m5.1">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is divisible by <Math mode="inline" tex="2n" text="2 * n" xml:id="S5.SS1.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>, we can invoke the Number Theoretic Transform to achieve <Math mode="inline" tex="\mathcal{O}(n\log{}n)" text="O * n * logarithm@(n)" xml:id="S5.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p1.m7.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS1.p1.m7.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> <cite class="ltx_citemacro_cite">[<bibref bibrefs="harvey2014faster" separator="," yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S5.SS1.p2">
        <p>Our contributions leverage the following insight: a substantial improvement in efficiency occurs when the plaintext multiplier <Math mode="inline" tex="z=\pm 2^{k}" text="z = plus-or-minus 2 ^ k" xml:id="S5.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                <XMApp>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for some <Math mode="inline" tex="k\in\mathbb{Z}" text="k element-of Z" xml:id="S5.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math>.
The polynomial that encodes this integer is <Math mode="inline" tex="b_{k}x^{k}" text="b _ k * x ^ k" xml:id="S5.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">b</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, a monomial multiplier.
For such parameters, sparse polynomial multiplication <cite class="ltx_citemacro_cite">[<bibref bibrefs="akleylek2016efficient" separator="," yyseparator=","/>]</cite> has been shown to use <Math mode="inline" tex="\mathcal{O}(n)" text="O * n" xml:id="S5.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p2.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS1.p2.m4.1">n</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> coefficient multiplications and modular reductions (see Algorithm <ref labelref="LABEL:alg:mult"/>).</p>
      </para>
      <float class="ltx_algorithm" labels="LABEL:alg:mult" xml:id="alg1">
        <tags>
          <tag><text font="bold">Algorithm 1</text></tag>
          <tag role="refnum">1</tag>
        </tags>
        <listing class="ltx_lst_numbers_left">
          <listingline><!--  %[tb] -->




















































<!--  %“footnotetext–footnote footnote footnote footnote˝ --><listing>
              <listingline xml:id="alg1.l1"><tags>
                  <tag role="refnum">1</tag>
                </tags>  <text font="bold">Input:</text> ciphertext <Math mode="inline" tex="c=\sum_{i=0}^{n-1}c_{i}x^{i}" text="c = ((sum _ (i = 0)) ^ (n - 1))@(c _ i * x ^ i)" xml:id="alg1.l1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">c</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
plaintext <Math mode="inline" tex="b=b_{k}x^{k}" text="b = b _ k * x ^ k" xml:id="alg1.l1.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">b</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">b</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
</listingline>
              <listingline xml:id="alg1.l2"><tags>
                  <tag role="refnum">2</tag>
                </tags>  <text font="bold">for</text> <Math mode="inline" tex="i=0" text="i = 0" xml:id="alg1.l2.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                      <XMTok meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMath>
                </Math> <text font="bold">to</text> <Math mode="inline" tex="n-1" text="n - 1" xml:id="alg1.l2.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMath>
                </Math> <text font="bold">do</text>


</listingline>
              <listingline xml:id="alg1.l3"><tags>
                  <tag role="refnum">3</tag>
                </tags>     Initialize <Math mode="inline" tex="j=i+k" text="j = i + k" xml:id="alg1.l3.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" role="UNKNOWN">k</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>.
</listingline>
              <listingline xml:id="alg1.l4"><tags>
                  <tag role="refnum">4</tag>
                </tags>     <text font="bold">if</text> <Math mode="inline" tex="j\geq n-1" text="j &gt;= n - 1" xml:id="alg1.l4.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math> <text font="bold">then</text>


</listingline>
              <listingline xml:id="alg1.l5"><tags>
                  <tag role="refnum">5</tag>
                </tags>        <Math mode="inline" tex="d_{j-(n-1)}=c_{i}(t-b_{k})" text="d _ (j - n - 1) = c _ i * (t - b _ k)" xml:id="alg1.l5.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                          <XMDual>
                            <XMRef idref="alg1.l5.m1.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="alg1.l5.m1.1">
                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="alg1.l5.m1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="alg1.l5.m1.2">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" role="UNKNOWN">t</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
</listingline>
              <listingline xml:id="alg1.l6"><tags>
                  <tag role="refnum">6</tag>
                </tags>     <text font="bold">else</text>

</listingline>
              <listingline xml:id="alg1.l7"><tags>
                  <tag role="refnum">7</tag>
                </tags>        <Math mode="inline" tex="d_{j}=c_{i}b_{k}" text="d _ j = c _ i * b _ k" xml:id="alg1.l7.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">b</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math><!--  %**** main.tex Line 350 **** -->
</listingline>
              <listingline xml:id="alg1.l8"><tags>
                  <tag role="refnum">8</tag>
                </tags>     <text font="bold">end</text> <text font="bold">if</text></listingline>
              <listingline xml:id="alg1.l9"><tags>
                  <tag role="refnum">9</tag>
                </tags>  <text font="bold">end</text> <text font="bold">for</text></listingline>
              <listingline xml:id="alg1.l10"><tags>
                  <tag role="refnum">10</tag>
                </tags>  <text font="bold">Output:</text> ciphertext <Math mode="inline" tex="d=\sum_{i=0}^{n-1}d_{i}x^{i}" text="d = ((sum _ (i = 0)) ^ (n - 1))@(d _ i * x ^ i)" xml:id="alg1.l10.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
</listingline>
            </listing>
</listingline>
        </listing>
        <toccaption><tag close=" ">1</tag>Sparse Plaintext-Ciphertext Multiplication</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 1</text></tag>Sparse Plaintext-Ciphertext Multiplication</caption>
      </float>
<!--  %%“end–minipage˝ -->    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:pruning" xml:id="S5.SS2">
      <tags>
        <tag>V-B</tag>
        <tag role="refnum">V-B</tag>
        <tag role="typerefnum">§V-B</tag>
      </tags>
      <title><tag close=" ">V-B</tag><text font="italic">Network Pruning and Quantization</text></title>
      <para xml:id="S5.SS2.p1">
        <p>The parameters of a neural network can be iteratively removed and clustered without affecting accuracy.
<cite class="ltx_citemacro_cite">[<bibref bibrefs="han2015deep" separator="," yyseparator=","/>]</cite> developed a compression method that leverages these techniques.
Since then, new pruning and quantization techniques have been proposed <cite class="ltx_citemacro_cite">[<bibref bibrefs="luo2017thinet" separator="," yyseparator=","/>]</cite><!--  %“cite–rastegari2016xnor˝. -->. We leverage these techniques to reduce the number of weights that contribute to the multiplication count, and convert the weights to powers of 2, which have sparse polynomial representations that reduce the cost of each multiplication. Together, these lead to significant reductions in inference time.</p>
      </para>
      <para xml:id="S5.SS2.p2">
        <p>We first train a pruned version of the network with Dynamic Network Surgery (DNS) <cite class="ltx_citemacro_cite">[<bibref bibrefs="guo2016dynamic" separator="," yyseparator=","/>]</cite> that incorporates connection splicing.
The remaining network parameters are quantized to powers of 2 following the incremental network quantization (INQ) procedure proposed by <cite class="ltx_citemacro_cite">[<bibref bibrefs="zhou2017incremental" separator="," yyseparator=","/>]</cite>.
The INQ method consists of an iterative quantization strategy to preserve the original inference accuracy.</p>
      </para>
      <para xml:id="S5.SS2.p3">
        <p>For each layer <Math mode="inline" tex="\ell" text="ell" xml:id="S5.SS2.p3.m1">
            <XMath>
              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
            </XMath>
          </Math>, the layer’s parameters <Math mode="inline" tex="\mathbf{W_{\ell}}" text="W _ ell" xml:id="S5.SS2.p3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                <XMTok font="bold" role="UNKNOWN">W</XMTok>
                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMApp>
            </XMath>
          </Math> have a corresponding binary pruning mask <Math mode="inline" tex="\mathbf{T_{\ell}}" text="T _ ell" xml:id="S5.SS2.p3.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                <XMTok font="bold" role="UNKNOWN">T</XMTok>
                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMApp>
            </XMath>
          </Math>.
The elements of the binary pruning mask <Math mode="inline" tex="\mathbf{T_{\ell}}" text="T _ ell" xml:id="S5.SS2.p3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                <XMTok font="bold" role="UNKNOWN">T</XMTok>
                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMApp>
            </XMath>
          </Math> get updated during gradient descent according to a discriminative measure of parameter importance <Math mode="inline" tex="h_{\ell}" text="h _ ell" xml:id="S5.SS2.p3.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMApp>
            </XMath>
          </Math>, typically incorporating a magnitude-based measure <Math mode="inline" tex="s" text="s" xml:id="S5.SS2.p3.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> such as <Math mode="inline" tex="s=\max|\mathbf{W_{\ell}}|" text="s = maximum@(absolute-value@(W _ ell))" xml:id="S5.SS2.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMApp>
                  <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S5.SS2.p3.m7.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S5.SS2.p3.m7.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="bold" role="UNKNOWN">W</XMTok>
                        <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><!--  %For each layer of convolutional or fully-connected parameters $“mathbf–W˙“ell˝$ in the network, we find the maximum magnitude $s = “max—“mathbf–W˙“ell˝—$. -->.
We define <Math mode="inline" tex="n_{1}" text="n _ 1" xml:id="S5.SS2.p3.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="n_{2}" text="n _ 2" xml:id="S5.SS2.p3.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math>, which will help bound our quantized values for each layer:</p>
        <equation xml:id="S5.Ex3">
          <Math mode="display" tex="n_{1}=\left\lfloor\log_{2}\frac{4s}{3}\right\rfloor\textrm{ and \,}n_{2}=n_{1}%&#10;+1-2^{\frac{k-1}{2}}," text="n _ 1 = floor@((logarithm _ 2)@((4 * s) / 3)) * [ and  ] * n _ 2 = (n _ 1 + 1) - 2 ^ ((k - 1) / 2)" xml:id="S5.Ex3.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S5.Ex3.m1.1"/>
                <XMWrap>
                  <XMApp xml:id="S5.Ex3.m1.1">
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="floor"/>
                          <XMRef idref="S5.Ex3.m1.1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="lfloor" role="OPEN" stretchy="true">⌊</XMTok>
                          <XMApp xml:id="S5.Ex3.m1.1.1">
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="4" role="NUMBER">4</XMTok>
                                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                              </XMApp>
                              <XMTok meaning="3" role="NUMBER">3</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok name="rfloor" role="CLOSE" stretchy="true">⌋</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMText> and  </XMText>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                        <XMApp>
                          <XMTok mathstyle="script" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
<!--  %**** main.tex Line 375 **** -->        <p>where <Math mode="inline" tex="k" text="k" xml:id="S5.SS2.p3.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> is used to restrict the set of powers for our desired bitwidth. We use <Math mode="inline" tex="k=5" text="k = 5" xml:id="S5.SS2.p3.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok meaning="5" role="NUMBER">5</XMTok>
              </XMApp>
            </XMath>
          </Math>.
Note that <Math mode="inline" tex="n_{1}\geq n_{2}" text="n _ 1 &gt;= n _ 2" xml:id="S5.SS2.p3.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and</p>
        <equation xml:id="S5.Ex4">
          <Math mode="display" tex="P=\{-2^{n_{1}},...,-2^{n_{2}},0,2^{n_{2}},...,2^{n_{1}}\}" text="P = set@(- 2 ^ (n _ 1), ldots, - 2 ^ (n _ 2), 0, 2 ^ (n _ 2), ldots, 2 ^ (n _ 1))" xml:id="S5.Ex4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.Ex4.m1.4"/>
                    <XMRef idref="S5.Ex4.m1.1"/>
                    <XMRef idref="S5.Ex4.m1.5"/>
                    <XMRef idref="S5.Ex4.m1.2"/>
                    <XMRef idref="S5.Ex4.m1.6"/>
                    <XMRef idref="S5.Ex4.m1.3"/>
                    <XMRef idref="S5.Ex4.m1.7"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S5.Ex4.m1.4">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S5.Ex4.m1.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.Ex4.m1.5">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S5.Ex4.m1.2">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.Ex4.m1.6">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S5.Ex4.m1.3">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.Ex4.m1.7">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>is the set of possible quantized values for the parameters of layer <Math mode="inline" tex="\mathbf{W_{\ell}}" text="W _ ell" xml:id="S5.SS2.p3.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                <XMTok font="bold" role="UNKNOWN">W</XMTok>
                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMApp>
            </XMath>
          </Math> in the network.
We define a monotonically increasing weight partition schedule using the discriminative measure <Math mode="inline" tex="h_{\ell}" text="h _ ell" xml:id="S5.SS2.p3.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMApp>
            </XMath>
          </Math> to progressively quantize the weights.
For example, one can quantize 50% of the weights, then 75%, then 87.5%, then 100%, retraining the other non-quantized weights at each step of the quantization procedure.</p>
      </para>
<!--  %cut this entirely? 
     %For each layer $“ell$, the layer’s parameters $“mathbf–W˙“ell˝$ have a corresponding binary pruning mask $“mathbf–T˙“ell˝$. 
     %The elements of the binary pruning mask $“mathbf–T˙“ell˝$ get updated during gradient descent according to a discriminative measure of parameter importance $h˙“ell$, typically incorporating a magnitude-based measure $s$ such as $s = “max—“mathbf–W˙“ell˝—$. 
     %%For each layer of convolutional or fully-connected parameters $“mathbf–W˙“ell˝$ in the network, we find the maximum magnitude $s = “max—“mathbf–W˙“ell˝—$. 
     %The values $n˙1$ and $n˙2$, defined below, will help bound the quantized values: 
     %“begin–equation*˝ 
     %n˙1 = “left“lfloor “log˙2 “frac–4s˝–3˝ “right“rfloor “textrm– and “,˝ n˙2 = n˙1 + 1 - 2^–“frac–k-1˝–2˝˝, 
     %“end–equation*˝ 
     %We select $k=5$ to cover the desired fixed-point range. 
     %Furthermore, note that $n˙1 “geq n˙2$ and, 
     %$$P = “–-2^–n˙1˝, ... , -2^–n˙2˝, 0, 2^–n˙2˝, ..., 2^–n˙1˝ “˝$$ 
     %is the set of possible quantized values for the parameters of layer $“mathbf–W˙“ell˝$ in the network. 
     %A monotonically increasing weight partition schedule using the discriminative measure $h˙“ell$ enables progressive quantization of the weights. -->    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:approx_activation" xml:id="S5.SS3">
      <tags>
        <tag>V-C</tag>
        <tag role="refnum">V-C</tag>
        <tag role="typerefnum">§V-C</tag>
      </tags>
      <title><tag close=" ">V-C</tag><text font="italic">Approximating the Activation Function</text></title>
      <para xml:id="S5.SS3.p1">
        <p>Using our pruning and quantization scheme from §<ref labelref="LABEL:sec:pruning"/>, our next contribution lies in finding the optimal polynomial approximation for any activation function given the constraint that the coefficients must be a power of 2.
The activation function of a neural network is critical for convergence <cite class="ltx_citemacro_cite">[<bibref bibrefs="glorot2011deep" separator="," yyseparator=","/>]</cite> and has been thoroughly explored in literature <cite class="ltx_citemacro_cite">[<bibref bibrefs="ramachandran2017swish" separator="," yyseparator=","/>]</cite>.
With the goal of encrypted network inference, we must find an approximation which balances approximation error with practical usability.
Inspired by <cite class="ltx_citemacro_cite">[<bibref bibrefs="brisebarre2006computing" separator="," yyseparator=","/>]</cite>, we find the best polynomial approximation.</p>
      </para>
      <para xml:id="S5.SS3.p2">
        <p><text font="bold">Polynomials</text>. Let <Math mode="inline" tex="x\in\mathbb{R}" text="x element-of R" xml:id="S5.SS3.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math> and let <Math mode="inline" tex="f:\mathbb{R}\rightarrow\mathbb{R}" text="f colon R rightarrow R" xml:id="S5.SS3.p2.m2">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMApp>
                  <XMTok name="rightarrow" role="ARROW">→</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> denote the activation function.
Our task is to approximate <Math mode="inline" tex="f" text="f" xml:id="S5.SS3.p2.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> with a polynomial <Math mode="inline" tex="p^{*}:\mathbb{R}\rightarrow\mathbb{R}" text="p ^ * colon R rightarrow R" xml:id="S5.SS3.p2.m4">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="rightarrow" role="ARROW">→</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="p^{*}(x)=p^{*}_{0}+p_{1}^{*}x+\cdots+p^{*}_{n}x^{n}" text="p ^ * * x = (p ^ *) _ 0 + (p _ 1) ^ * * x + cdots + (p ^ *) _ n * x ^ n" xml:id="S5.SS3.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S5.SS3.p2.m5.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p2.m5.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok name="cdots" role="ID">⋯</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> subject to the constraint that each coefficient is a power of 2.
Define <Math mode="inline" tex="\mathcal{P}^{(2)}_{n}" text="(P ^ 2) _ n" xml:id="S5.SS3.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                  <XMDual>
                    <XMRef idref="S5.SS3.p2.m6.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S5.SS3.p2.m6.1">2</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> as the set of all polynomials of degree less than or equal to <Math mode="inline" tex="n" text="n" xml:id="S5.SS3.p2.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
            </XMath>
          </Math>, such that all coefficients are base-2.
That is, <Math mode="inline" tex="\mathcal{P}^{(2)}_{n}=\{2^{a_{0}}+2^{a_{1}}x+\cdots+2^{a_{n}}x^{n},a_{i}\in%&#10;\mathbb{Z}\}" text="(P ^ 2) _ n = set@(list@(2 ^ (a _ 0) + 2 ^ (a _ 1) * x + cdots + 2 ^ (a _ n) * x ^ n, a _ i) element-of Z)" xml:id="S5.SS3.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                    <XMDual>
                      <XMRef idref="S5.SS3.p2.m8.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S5.SS3.p2.m8.1">2</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS3.p2.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S5.SS3.p2.m8.2">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S5.SS3.p2.m8.2.1"/>
                          <XMRef idref="S5.SS3.p2.m8.2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S5.SS3.p2.m8.2.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="50%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            </XMApp>
                            <XMTok name="cdots" role="ID">⋯</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S5.SS3.p2.m8.2.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                      <XMTok font="blackboard" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
Let <Math mode="inline" tex="p" text="p" xml:id="S5.SS3.p2.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> be the minimax approximation to <Math mode="inline" tex="f" text="f" xml:id="S5.SS3.p2.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> on some interval <Math mode="inline" tex="[-a,a]" text="closed-interval@(- a, a)" xml:id="S5.SS3.p2.m11">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S5.SS3.p2.m11.2"/>
                  <XMRef idref="S5.SS3.p2.m11.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="S5.SS3.p2.m11.2">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p2.m11.1">a</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.
Let <Math mode="inline" tex="\hat{p}" text="hat@(p)" xml:id="S5.SS3.p2.m12">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> be the same as <Math mode="inline" tex="p" text="p" xml:id="S5.SS3.p2.m13">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math>, but with all coefficients rounded to the nearest <Math mode="inline" tex="2^{k}" text="2 ^ k" xml:id="S5.SS3.p2.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="k\in\mathbb{Z}" text="k element-of Z" xml:id="S5.SS3.p2.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math>.
Note, <Math mode="inline" tex="\hat{p}\in\mathcal{P}^{(2)}_{n}" text="hat@(p) element-of (P ^ 2) _ n" xml:id="S5.SS3.p2.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                    <XMDual>
                      <XMRef idref="S5.SS3.p2.m16.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S5.SS3.p2.m16.1">2</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S5.SS3.p3">
        <p><text font="bold">Maximum Error &amp; Minimax</text>. The maximum difference (i.e., error) <Math mode="inline" tex="\delta" text="delta" xml:id="S5.SS3.p3.m1">
            <XMath>
              <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
            </XMath>
          </Math> between two functions <Math mode="inline" tex="g" text="g" xml:id="S5.SS3.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">g</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="h" text="h" xml:id="S5.SS3.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> is <Math mode="inline" tex="\delta(g,h)=\max_{x\in[-a,a]}|g(x)-h(x)|" text="delta * open-interval@(g, h) = (maximum _ (x element-of closed-interval@(- a, a)))@(absolute-value@(g * x - h * x))" xml:id="S5.SS3.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S5.SS3.p3.m4.3"/>
                      <XMRef idref="S5.SS3.p3.m4.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m4.3">g</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m4.4">h</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="closed-interval"/>
                          <XMRef idref="S5.SS3.p3.m4.2"/>
                          <XMRef idref="S5.SS3.p3.m4.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S5.SS3.p3.m4.2">
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S5.SS3.p3.m4.1">a</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S5.SS3.p3.m4.7"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="S5.SS3.p3.m4.7">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">g</XMTok>
                          <XMDual>
                            <XMRef idref="S5.SS3.p3.m4.5"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m4.5">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMDual>
                            <XMRef idref="S5.SS3.p3.m4.6"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m4.6">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
This provides a strong bound on the optimal polynomial approximation error <Math mode="inline" tex="\delta(f,p^{*})" text="delta * open-interval@(f, p ^ *)" xml:id="S5.SS3.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S5.SS3.p3.m5.1"/>
                    <XMRef idref="S5.SS3.p3.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m5.1">f</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.SS3.p3.m5.2">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="\delta(f,p)\leq\delta(f,p^{*})\leq\delta(f,\hat{p})." text="delta * open-interval@(f, p) &lt;= delta * open-interval@(f, p ^ *) &lt;= delta * open-interval@(f, hat@(p))" xml:id="S5.SS3.p3.m6">
            <XMath>
              <XMDual>
                <XMRef idref="S5.SS3.p3.m6.6"/>
                <XMWrap>
                  <XMApp xml:id="S5.SS3.p3.m6.6">
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S5.SS3.p3.m6.1"/>
                          <XMRef idref="S5.SS3.p3.m6.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m6.1">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m6.2">p</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S5.SS3.p3.m6.3"/>
                          <XMRef idref="S5.SS3.p3.m6.6.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m6.3">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S5.SS3.p3.m6.6.1">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S5.SS3.p3.m6.4"/>
                          <XMRef idref="S5.SS3.p3.m6.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p3.m6.4">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S5.SS3.p3.m6.5">
                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
We state minimax problem as follows. For a given activation function <Math mode="inline" tex="f" text="f" xml:id="S5.SS3.p3.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, we seek to find the best polynomial <Math mode="inline" tex="p^{*}\in\mathcal{P}^{(2)}_{n}" text="p ^ * element-of (P ^ 2) _ n" xml:id="S5.SS3.p3.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                    <XMDual>
                      <XMRef idref="S5.SS3.p3.m8.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S5.SS3.p3.m8.1">2</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> such that,</p>
        <equation xml:id="S5.E1">
          <tags>
            <tag>(1)</tag>
            <tag role="refnum">1</tag>
          </tags>
          <Math mode="display" tex="\delta(f,p^{*})=\min_{q\in\mathcal{P}^{(2)}_{n}}\delta(f,q)" text="delta * open-interval@(f, p ^ *) = (minimum _ (q element-of (P ^ 2) _ n))@(delta) * open-interval@(f, q)" xml:id="S5.E1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S5.E1.m1.2"/>
                      <XMRef idref="S5.E1.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.E1.m1.2">f</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S5.E1.m1.5">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            <XMDual>
                              <XMRef idref="S5.E1.m1.1"/>
                              <XMWrap>
                                <XMTok fontsize="50%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok fontsize="50%" meaning="2" role="NUMBER" xml:id="S5.E1.m1.1">2</XMTok>
                                <XMTok fontsize="50%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S5.E1.m1.3"/>
                      <XMRef idref="S5.E1.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.E1.m1.3">f</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.E1.m1.4">q</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>subject to the constraint,</p>
        <equation labels="LABEL:eq:constraint" xml:id="S5.E2">
          <tags>
            <tag>(2)</tag>
            <tag role="refnum">2</tag>
          </tags>
          <Math mode="display" tex="\delta(f,p^{*})\leq K\textrm{ where }K\geq\delta(f,p)." text="delta * open-interval@(f, p ^ *) &lt;= K * [ where ] * K &gt;= delta * open-interval@(f, p)" xml:id="S5.E2.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S5.E2.m1.4"/>
                <XMWrap>
                  <XMApp xml:id="S5.E2.m1.4">
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S5.E2.m1.1"/>
                          <XMRef idref="S5.E2.m1.4.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.E2.m1.1">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S5.E2.m1.4.1">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                      <XMText> where </XMText>
                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S5.E2.m1.2"/>
                          <XMRef idref="S5.E2.m1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.E2.m1.2">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.E2.m1.3">p</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
<!--  %“begin–equation˝“label–eq:constraint˝ 
     %**** main.tex Line 425 **** 
     %“delta(f, p^*) = “min˙–q “in “mathcal–P˝^–(2)˝˙n˝ “delta(f, q) “textrm–“quad subject to “quad˝ “delta(f, p^*) “leq K “textrm– where ˝ K “geq “delta(f, p). 
     %“end–equation˝ -->      <para xml:id="S5.SS3.p4">
        <p><text font="bold">Finite Number of Solutions.</text>
Let <Math mode="inline" tex="d,n\in\mathbb{N}" text="list@(d, n) element-of N" xml:id="S5.SS3.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S5.SS3.p4.m1.1"/>
                    <XMRef idref="S5.SS3.p4.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p4.m1.1">d</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p4.m1.2">n</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok font="blackboard" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math>, and <Math mode="inline" tex="D=\{0,...,d\}" text="D = set@(0, ldots, d)" xml:id="S5.SS3.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS3.p4.m2.1"/>
                    <XMRef idref="S5.SS3.p4.m2.2"/>
                    <XMRef idref="S5.SS3.p4.m2.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S5.SS3.p4.m2.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S5.SS3.p4.m2.2">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS3.p4.m2.3">d</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. For <Math mode="inline" tex="\forall i\in D" text="for-all@(i) element-of D" xml:id="S5.SS3.p4.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMApp>
            </XMath>
          </Math>, let <Math mode="inline" tex="x_{i},l_{i},u_{i}\in\mathbb{R}" text="list@(x _ i, l _ i, u _ i) element-of R" xml:id="S5.SS3.p4.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S5.SS3.p4.m4.1"/>
                    <XMRef idref="S5.SS3.p4.m4.2"/>
                    <XMRef idref="S5.SS3.p4.m4.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S5.SS3.p4.m4.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.SS3.p4.m4.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.SS3.p4.m4.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">u</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math> such that <Math mode="inline" tex="x_{j}\neq x_{k}" text="x _ j not-equals x _ k" xml:id="S5.SS3.p4.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> if <Math mode="inline" tex="j\neq k" text="j not-equals k" xml:id="S5.SS3.p4.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>. We can construct a bounded polyhedron,</p>
        <equation xml:id="S5.Ex5">
          <Math mode="display" tex="\mathcal{B}=\left\{(\alpha_{0},...,\alpha_{n})\in\mathbb{R}^{n+1}\;\Bigg{|}\;l%&#10;_{i}\leq\sum\limits_{j=0}^{n}\alpha_{j}x^{j}_{i}\leq u_{i},\forall i\in D\right\}" text="B = conditional-set@(vector@(alpha _ 0, ldots, alpha _ n) element-of R ^ (n + 1), formulae@(l _ i &lt;= ((sum _ (j = 0)) ^ n)@(alpha _ j * (x ^ j) _ i) &lt;= u _ i, for-all@(i) element-of D))" xml:id="S5.Ex5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="conditional-set"/>
                    <XMRef idref="S5.Ex5.m1.2"/>
                    <XMRef idref="S5.Ex5.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="true">{</XMTok>
                    <XMApp xml:id="S5.Ex5.m1.2">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="S5.Ex5.m1.2.1"/>
                          <XMRef idref="S5.Ex5.m1.1"/>
                          <XMRef idref="S5.Ex5.m1.2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S5.Ex5.m1.2.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok name="ldots" role="ID" xml:id="S5.Ex5.m1.1">…</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S5.Ex5.m1.2.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp rpadding="2.8pt">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok fontsize="260%" role="MIDDLE" rpadding="2.8pt" stretchy="false">|</XMTok>
                    <XMDual xml:id="S5.Ex5.m1.3">
                      <XMApp>
                        <XMTok meaning="formulae"/>
                        <XMRef idref="S5.Ex5.m1.3.1"/>
                        <XMRef idref="S5.Ex5.m1.3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S5.Ex5.m1.3.1">
                          <XMTok meaning="multirelation"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">l</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid2">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">u</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S5.Ex5.m1.3.2">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                            <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">D</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="true">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>where each <Math mode="inline" tex="(\alpha_{0},...,\alpha_{n})" text="vector@(alpha _ 0, ldots, alpha _ n)" xml:id="S5.SS3.p4.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="S5.SS3.p4.m7.2"/>
                  <XMRef idref="S5.SS3.p4.m7.1"/>
                  <XMRef idref="S5.SS3.p4.m7.3"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S5.SS3.p4.m7.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S5.SS3.p4.m7.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S5.SS3.p4.m7.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> tuple represents any polynomial <Math mode="inline" tex="q\in\mathcal{P}^{(2)}_{n}" text="q element-of (P ^ 2) _ n" xml:id="S5.SS3.p4.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                    <XMDual>
                      <XMRef idref="S5.SS3.p4.m8.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S5.SS3.p4.m8.1">2</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, and where <Math mode="inline" tex="\alpha_{i}" text="alpha _ i" xml:id="S5.SS3.p4.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> represents the degree <Math mode="inline" tex="i" text="i" xml:id="S5.SS3.p4.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math> coefficient.
<cite class="ltx_citemacro_cite">[<bibref bibrefs="brisebarre2006computing" separator="," yyseparator=","/>]</cite> show that the number of polynomials satisfying Equation <ref labelref="LABEL:eq:constraint"/> is finite if the polynomials are contained in <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S5.SS3.p4.m11">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math>.
They also proposed an efficient scanning method to find the optimal polynomial approximation <Math mode="inline" tex="p^{*}" text="p ^ *" xml:id="S5.SS3.p4.m12">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math>.
Equipped with our new-found approximation <Math mode="inline" tex="p^{*}" text="p ^ *" xml:id="S5.SS3.p4.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math>, we can evaluate the effectiveness of <Math mode="inline" tex="p^{*}" text="p ^ *" xml:id="S5.SS3.p4.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> as an activation function in both non-encrypted and encrypted domains.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S6">
    <tags>
      <tag>VI</tag>
      <tag role="refnum">VI</tag>
      <tag role="typerefnum">§VI</tag>
    </tags>
    <title><tag close=" ">VI</tag><text font="smallcaps">Experiments</text></title>
<!--  %Experiments are split into three sections: (i) an analysis of our quantized polynomial activation function approximations, (ii) a comparison with state-of-the-art methods and (iii) ablation studies. -->    <subsection inlist="toc" xml:id="S6.SS1">
      <tags>
        <tag>VI-A</tag>
        <tag role="refnum">VI-A</tag>
        <tag role="typerefnum">§VI-A</tag>
      </tags>
      <title><tag close=" ">VI-A</tag><text font="italic">Wall-clock Runtime</text></title>
      <para xml:id="S6.SS1.p1">
        <p>The runtime refers to the wall-clock time required to perform inference on an encrypted image. This metric is the default metric reported in previous encrypted works. However, the wall-clock time is an imperfect metric for measuring improvements in encrypted inference. It is hardware-dependent, varying greatly depending on the available memory and computational power of the device, and it is also possibly encryption-scheme dependent, with even the same encryption algorithm being implemented differently across libraries. In the next sections, we introduce a metric to evaluate our methods using hardware-independent metrics.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:exp_setting" xml:id="S6.SS2">
      <tags>
        <tag>VI-B</tag>
        <tag role="refnum">VI-B</tag>
        <tag role="typerefnum">§VI-B</tag>
      </tags>
      <title><tag close=" ">VI-B</tag><text font="italic">Explanation of HOPs</text></title>
<!--  %“textbf–Evaluation Metrics˝“label–sec:metrics˝ 
     %**** main.tex Line 450 **** 
     %In addition to the standard metrics of accuracy and message size, we benchmark our method using the following metrics. -->      <para xml:id="S6.SS2.p1">
        <p><!--  %“textbf–Performance Metrics˝. -->We report the number of homomorphic operations (HOPs) of our inference network.
This is in contrast to previous work <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets,chabanne2017privacy,hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite>, which measured either throughput or wall-clock time – both of which are highly dependent on hardware specifications and software parallelization, and are not entirely reliable measures.
The HOPs metric is similar to the FLOPs (floating point) metric used in scientific computing.</p>
      </para>
      <para xml:id="S6.SS2.p2">
        <p>A homomorphic operation is defined as addition or multiplication involving a ciphertext, a plaintext, or both.
The four classes of HOPs are (i) plaintext-ciphertext addition, (ii) ciphertext-ciphertext addition, (iii) plaintext-ciphertext multiplication, and (iv) ciphertext-ciphertext multiplication.
While the exact implementation of HOPs may vary, we believe HOPs are a hardware-independent metric for performance analysis that enable a better comparison of models for encrypted inference, demonstrating whether speedup occurs due to decreased number of operations or due to algorithmic speedup.</p>
      </para>
      <para xml:id="S6.SS2.p3">
        <p>It is important to note that the different HOPs classes vary in cost. In general, multiplicative operations are significantly more expensive than additive operations, with ciphertext-ciphertext multiplications being the most costly operations found in neural networks. Throughout our analysis, we break down our HOPs into separate operations, following the rule-of-thumb that reducing multiplicative HOPs outweighs the cost of adding additive HOPs.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS3">
      <tags>
        <tag>VI-C</tag>
        <tag role="refnum">VI-C</tag>
        <tag role="typerefnum">§VI-C</tag>
      </tags>
      <title><tag close=" ">VI-C</tag><text font="italic">Datasets</text></title>
      <para xml:id="S6.SS3.p1">
        <p><!--  %While this could be amortized over batches “cite–gilad2016cryptonets˝, given our task setting described in Figure “ref–fig:pull˝, we report the time for a single image. -->We use the MNIST dataset of handwritten digits <!--  %The timer was implemented using the high resolution clock from the C++ chrono library. --><cite class="ltx_citemacro_cite">[<bibref bibrefs="lecun1995convolutional" separator="," yyseparator=","/>]</cite> which contains <Math mode="inline" tex="28\times 28" text="28 * 28" xml:id="S6.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
              </XMApp>
            </XMath>
          </Math> grayscale images of Arabic numerals 0 to 9 (i.e., 10-class classification task), which has a standard split of 50,000 training images and 10,000 images test set images.
While MNIST is arguably a simple dataset, it has remained the standard benchmark for homomorphic inference tasks <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets,hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS4">
      <tags>
        <tag>VI-D</tag>
        <tag role="refnum">VI-D</tag>
        <tag role="typerefnum">§VI-D</tag>
      </tags>
      <title><tag close=" ">VI-D</tag><text font="italic">Network Architecture</text></title>
      <para xml:id="S6.SS4.p1">
        <p>The network architecture used for MNIST inference is presented below.
The architecture itself is a slight variant of the CryptoNet <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/>]</cite><!--  %**** main.tex Line 475 **** --> architecture that incorporates batch normalization layers to support a greater variety of activation functions. The multiplicative depth is unchanged.
As shown in Figure <ref labelref="LABEL:fig:approx"/>, our approximation error is minimized close to zero.
Batch normalization encourages the pre-activation values to fit in this range.
As confirmed in <cite class="ltx_citemacro_cite">[<bibref bibrefs="chabanne2017privacy" separator="," yyseparator=","/>]</cite> and <cite class="ltx_citemacro_cite">[<bibref bibrefs="hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite>, by reducing the variance in the input values to the activation layer, the approximation error of the network decreases.
Overall, our model is a convolutional neural network <cite class="ltx_citemacro_cite">[<bibref bibrefs="lecun1995convolutional" separator="," yyseparator=","/>]</cite> consisting of convolutional layers, activation functions, scaled average pooling, batch normalization, and fully-connected layers.</p>
      </para>
      <para xml:id="S6.SS4.p2">
        <p>1. <text font="italic">Convolutional Layer.</text> The input image is 28 x 28. There are 20 kernels of size 5 x 5, with stride 2, and padding of 1.</p>
      </para>
      <para xml:id="S6.SS4.p3">
        <p>2. <text font="italic">Batch Normalization Layer.</text> This layer applies the batch normalization weights and biases to each input value.</p>
      </para>
      <para xml:id="S6.SS4.p4">
        <p>3. <text font="italic">Activation Layer.</text> This layer applies the approximate activation function to each input value.</p>
      </para>
      <para xml:id="S6.SS4.p5">
        <p>4. <text font="italic">Scaled Average Pool Layer.</text> This layer has 3 x 3 windows, with a stride of 2, padding of 1, and output size of 5 x 13 x 13.</p>
      </para>
      <para xml:id="S6.SS4.p6">
        <p>5. <text font="italic">Convolutional Layer.</text> This layer has 50 kernels of size 20 x 5 x 5, with a stride of 1, and zero padding.</p>
      </para>
      <para xml:id="S6.SS4.p7">
        <p>6. <text font="italic">Scaled Average Pool Layer.</text> This layer has 3 x 3 windows and a stride of 2, padding of 1, and output size of 50 x 5 x 5.</p>
      </para>
      <para xml:id="S6.SS4.p8">
        <p>7. <text font="italic">Fully-Connected Layer.</text> This layer has parameters of size 1250 x 100 for matrix multiplication with respect to inputs.</p>
      </para>
      <para xml:id="S6.SS4.p9">
        <p>8. <text font="italic">Batch Normalization Layer.</text> This layer applies the batch normalization weights and biases to each input value.</p>
      </para>
      <para xml:id="S6.SS4.p10">
        <p>9. <text font="italic">Activation Layer.</text> This layer applies the approximate activation function to each input value.</p>
      </para>
      <para xml:id="S6.SS4.p11">
        <p>10. <text font="italic">Fully-Connected Layer.</text> This layer has parameters of size 100 x 10 for matrix multiplication with respect to inputs.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS5">
      <tags>
        <tag>VI-E</tag>
        <tag role="refnum">VI-E</tag>
        <tag role="typerefnum">§VI-E</tag>
      </tags>
      <title><tag close=" ">VI-E</tag><text font="italic">Encryption Scheme</text></title>
      <para xml:id="S6.SS5.p1">
        <p>.
The parameters for the FV-RNS encryption scheme are: coefficient count of <Math mode="inline" tex="n=8192" text="n = 8192" xml:id="S6.SS5.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok meaning="8192" role="NUMBER">8192</XMTok>
              </XMApp>
            </XMath>
          </Math>, plaintext moduli of <Math mode="inline" tex="t_{1}" text="t _ 1" xml:id="S6.SS5.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> = 1099511922689 and <Math mode="inline" tex="t_{2}" text="t _ 2" xml:id="S6.SS5.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> = 1099512004609. The values of <Math mode="inline" tex="q_{i}" text="q _ i" xml:id="S6.SS5.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> are selected for 128-bit security (<Math mode="inline" tex="\log q" text="logarithm@(q)" xml:id="S6.SS5.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> = 219). This choice of coefficient modulus <Math mode="inline" tex="q" text="q" xml:id="S6.SS5.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> meets the security standards established by the Homomorphic Encryption Standardization Workshop <cite class="ltx_citemacro_cite">[<bibref bibrefs="albrecht2018homomorphic" separator="," yyseparator=","/>]</cite>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS6">
      <tags>
        <tag>VI-F</tag>
        <tag role="refnum">VI-F</tag>
        <tag role="typerefnum">§VI-F</tag>
      </tags>
      <title><tag close=" ">VI-F</tag><text font="italic">Hardware/Software Setup</text></title>
      <para xml:id="S6.SS6.p1">
        <p>.
The machine used for the MNIST experiments has an Intel Core i7-5930K CPU at 3.5 GHz with 48 GB RAM on Ubuntu 17.10. The HE library was SEAL v2.3.0-4 <cite class="ltx_citemacro_cite">[<bibref bibrefs="seal23" separator="," yyseparator=","/>]</cite>, modified by us to support our proposed method.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS7">
      <tags>
        <tag>VI-G</tag>
        <tag role="refnum">VI-G</tag>
        <tag role="typerefnum">§VI-G</tag>
      </tags>
      <title><tag close=" ">VI-G</tag><text font="italic">Optimization Hyperparmeters</text></title>
      <para xml:id="S6.SS7.p1">
        <p>We provide the hyperparameter settings used to train our non-encrypted network.
A batch size of 64 was used and the model was trained for 30 epochs.
The learning rate schedule was initialized at <Math mode="inline" tex="\lambda=0.008" text="lambda = 0.008" xml:id="S6.SS7.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                <XMTok meaning="0.008" role="NUMBER">0.008</XMTok>
              </XMApp>
            </XMath>
          </Math> with a step size of 10 epochs and <Math mode="inline" tex="\gamma=0.1" text="gamma = 0.1" xml:id="S6.SS7.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
              </XMApp>
            </XMath>
          </Math>.
The model was trained with stochastic gradient descent with a momentum of 0.9.
For the square function, gradients were clipped at 0.25. He weight initialization was used for the convolutional layers.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS8">
      <tags>
        <tag>VI-H</tag>
        <tag role="refnum">VI-H</tag>
        <tag role="typerefnum">§VI-H</tag>
      </tags>
      <title><tag close=" ">VI-H</tag><text font="italic">Dynamic Network Surgery Hyperparemeters</text></title>
      <para xml:id="S6.SS8.p1">
        <p>We report the hyperparameters of our dynamic network surgery operations. The sparsity denotes the final fraction of non-pruned connections over the total connections c-rate denotes compression rate used to set the threshold of importance before removing a connection.</p>
      </para>
      <para xml:id="S6.SS8.p2">
        <p>We report metrics for each layer. The conv1 layer had a sparsity of 0.1440 and c-rate of 1.5. The conv2 layer had a sparsity of 0.0701 and c-rate of 1.65. The dense-fc1 layer had a sparsity of 0.0568 and c-rate of 1.65. The dense-fc2 layer had a sparsity of 0.1480 and c-rate of 1.5. All layers stopped at iteration 10,000.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:approx" xml:id="S6.SS9">
      <tags>
        <tag>VI-I</tag>
        <tag role="refnum">VI-I</tag>
        <tag role="typerefnum">§VI-I</tag>
      </tags>
      <title><tag close=" ">VI-I</tag><text font="italic">Approximation Results</text></title>
      <figure inlist="lof" labels="LABEL:fig:approx" placement="!htbp" xml:id="S6.F2">
        <tags>
          <tag>Figure 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Figure 2</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:approx_swish" xml:id="S6.F2.sf1">
          <tags>
            <tag><text fontsize="80%">(a)</text></tag>
            <tag role="refnum">2(a)</tag>
          </tags>
          <graphics candidates="figures/approx_fill/swish.eps" graphic="figures/approx_fill/swish.eps" options="width=122.85876pt,keepaspectratio=true" xml:id="S6.F2.sf1.g1"/>
          <toccaption><tag close=" ">(a)</tag>Swish<sup>1</sup>: <Math mode="inline" tex="f(x)=x/(1+e^{-x})" text="f * x = x / (1 + e ^ (- x))" xml:id="S6.F2.sf1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMRef idref="S6.F2.sf1.m2.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf1.m2.1">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMRef idref="S6.F2.sf1.m2.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S6.F2.sf1.m2.2">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">e</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></toccaption>
          <caption><tag close=" "><text fontsize="80%">(a)</text></tag><text fontsize="80%">Swish<sup>1</sup>: <Math mode="inline" tex="f(x)=x/(1+e^{-x})" text="f * x = x / (1 + e ^ (- x))" xml:id="S6.F2.sf1.m4">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok fontsize="125%" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMRef idref="S6.F2.sf1.m4.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf1.m4.1">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="divide" role="MULOP">/</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMRef idref="S6.F2.sf1.m4.2"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S6.F2.sf1.m4.2">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">e</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:approx_relu" xml:id="S6.F2.sf2">
          <tags>
            <tag><text fontsize="80%">(b)</text></tag>
            <tag role="refnum">2(b)</tag>
          </tags>
          <graphics candidates="figures/approx_fill/relu.eps" graphic="figures/approx_fill/relu.eps" options="width=122.85876pt,keepaspectratio=true" xml:id="S6.F2.sf2.g1"/>
          <toccaption><tag close=" ">(b)</tag>ReLU: <Math mode="inline" tex="f(x)=\max\{0,x\}" text="f * x = maximum@(0, x)" xml:id="S6.F2.sf2.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMRef idref="S6.F2.sf2.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf2.m1.1">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMRef idref="S6.F2.sf2.m1.2"/>
                      <XMRef idref="S6.F2.sf2.m1.3"/>
                      <XMRef idref="S6.F2.sf2.m1.4"/>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post" xml:id="S6.F2.sf2.m1.2">max</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S6.F2.sf2.m1.3">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf2.m1.4">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMApp>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math></toccaption>
          <caption><tag close=" "><text fontsize="80%">(b)</text></tag><text fontsize="80%">ReLU: <Math mode="inline" tex="f(x)=\max\{0,x\}" text="f * x = maximum@(0, x)" xml:id="S6.F2.sf2.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok fontsize="125%" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMRef idref="S6.F2.sf2.m2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf2.m2.1">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S6.F2.sf2.m2.2"/>
                        <XMRef idref="S6.F2.sf2.m2.3"/>
                        <XMRef idref="S6.F2.sf2.m2.4"/>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post" xml:id="S6.F2.sf2.m2.2">max</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                          <XMTok meaning="0" role="NUMBER" xml:id="S6.F2.sf2.m2.3">0</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf2.m2.4">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math></text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:approx_softplus" xml:id="S6.F2.sf3">
          <tags>
            <tag><text fontsize="80%">(c)</text></tag>
            <tag role="refnum">2(c)</tag>
          </tags>
          <graphics candidates="figures/approx_fill/softplus.eps" graphic="figures/approx_fill/softplus.eps" options="width=122.85876pt,keepaspectratio=true" xml:id="S6.F2.sf3.g1"/>
          <toccaption><tag close=" ">(c)</tag>Softplus: <Math mode="inline" tex="f(x)=\log(1+e^{x})" text="f * x = logarithm@(1 + e ^ x)" xml:id="S6.F2.sf3.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMRef idref="S6.F2.sf3.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf3.m1.1">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMRef idref="S6.F2.sf3.m1.2"/>
                      <XMRef idref="S6.F2.sf3.m1.3"/>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S6.F2.sf3.m1.2">log</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S6.F2.sf3.m1.3">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">e</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMApp>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math></toccaption>
          <caption><tag close=" "><text fontsize="80%">(c)</text></tag><text fontsize="80%">Softplus: <Math mode="inline" tex="f(x)=\log(1+e^{x})" text="f * x = logarithm@(1 + e ^ x)" xml:id="S6.F2.sf3.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok fontsize="125%" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMRef idref="S6.F2.sf3.m2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.sf3.m2.1">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S6.F2.sf3.m2.2"/>
                        <XMRef idref="S6.F2.sf3.m2.3"/>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S6.F2.sf3.m2.2">log</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S6.F2.sf3.m2.3">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">e</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math></text></caption>
        </figure>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>Approximation results (non-encrypted). (Top) Different approximation methods. The original activation function <Math mode="inline" tex="f(x)" text="f * x" xml:id="S6.F2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMRef idref="S6.F2.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m1.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is plotted with three approximations: the minimax estimate <Math mode="inline" tex="p(x)" text="p * x" xml:id="S6.F2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S6.F2.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m2.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, the rounded minimax estimate <Math mode="inline" tex="\hat{p}(x)" text="hat@(p) * x" xml:id="S6.F2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m3.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, and the our method – the quantized minimax approximation <Math mode="inline" tex="p^{*}(x)" text="p ^ * * x" xml:id="S6.F2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m4.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. (Bottom) Error of our method. Our method <Math mode="inline" tex="p^{*}(x)" text="p ^ * * x" xml:id="S6.F2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m5.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m5.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is compared to the baseline <Math mode="inline" tex="\hat{p}(x)" text="hat@(p) * x" xml:id="S6.F2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m6.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m6.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. The blue shaded area corresponds to the post-batch normalization region during the training procedure.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 2</tag>Approximation results (non-encrypted). (Top) Different approximation methods. The original activation function <Math mode="inline" tex="f(x)" text="f * x" xml:id="S6.F2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMRef idref="S6.F2.m7.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m7.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is plotted with three approximations: the minimax estimate <Math mode="inline" tex="p(x)" text="p * x" xml:id="S6.F2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S6.F2.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m8.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, the rounded minimax estimate <Math mode="inline" tex="\hat{p}(x)" text="hat@(p) * x" xml:id="S6.F2.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m9.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m9.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, and the our method – the quantized minimax approximation <Math mode="inline" tex="p^{*}(x)" text="p ^ * * x" xml:id="S6.F2.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m10.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m10.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. (Bottom) Error of our method. Our method <Math mode="inline" tex="p^{*}(x)" text="p ^ * * x" xml:id="S6.F2.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m11.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m11.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is compared to the baseline <Math mode="inline" tex="\hat{p}(x)" text="hat@(p) * x" xml:id="S6.F2.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S6.F2.m12.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.F2.m12.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. The blue shaded area corresponds to the post-batch normalization region during the training procedure.</caption>
      </figure>
      <para xml:id="S6.SS9.p1">
        <p><!--  %One disadvantage of existing encrypted inference methods is the use of linear activation functions such as the square function $x^2$. -->Prior work suggests that neural networks equipped with polynomial functions have the same representational power as their non-polynomial counterparts <cite class="ltx_citemacro_cite">[<bibref bibrefs="gautier2016globally,livni2014computational" separator="," yyseparator=","/>]</cite>.
<text font="italic"><!--  %Edward added% -->Faster CryptoNets</text><!--  %Edward added% --> uses quadratic activation functions that approximate modern activations with varying degrees of complexity and expressivity.
Our proposed method allows us to construct an optimal, quantized polynomial approximation of any arbitrary function.
In our experiments, we consider ReLU <cite class="ltx_citemacro_cite">[<bibref bibrefs="glorot2011deep" separator="," yyseparator=","/>]</cite>, Softplus <cite class="ltx_citemacro_cite">[<bibref bibrefs="dugas2001incorporating" separator="," yyseparator=","/>]</cite>, and Swish <cite class="ltx_citemacro_cite">[<bibref bibrefs="ramachandran2017swish" separator="," yyseparator=","/>]</cite><!--  %“footnote–Swish “cite–ramachandran2017swish˝ is also known as Gaussian Error Linear Units “cite–hendrycks2016bridging˝ and Sigmoid-Weighted Linear Units “cite–elfwing2018sigmoid˝.˝ -->.
We model all activation functions with a 2<!--  %We selected the above functions based on their prevalence in the deep learning community “cite–lecun2015deep˝. --><sup>nd</sup><!--  %**** main.tex Line 550 **** --> degree polynomial.
While higher-degree polynomials can decrease the approximation error, higher-degree polynomials also require more HOPs.</p>
      </para>
      <para xml:id="S6.SS9.p2">
        <p><!--  %“textbf–Instability of the Square Activation Function.˝ -->We note that <cite class="ltx_citemacro_cite">[<bibref bibrefs="ghodsi2017safetynets" separator="," yyseparator=","/>]</cite> showed how the gradient of the square function can be large.
Their solution was to apply gradient clipping to improve model convergence.
While this is a viable solution for recurrent networks <cite class="ltx_citemacro_cite">[<bibref bibrefs="chung2014empirical" separator="," yyseparator=","/>]</cite>, clipping gradients in a shallow network (such as ours) may indicate model instability and may not work for deeper variants.
To avoid this, we do not use the square activation function.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS10">
      <tags>
        <tag>VI-J</tag>
        <tag role="refnum">VI-J</tag>
        <tag role="typerefnum">§VI-J</tag>
      </tags>
      <title><tag close=" ">VI-J</tag><text font="italic">Polynomial Approximation Equations</text></title>
      <para xml:id="S6.SS10.p1">
        <p>We list the polynomial approximations to the Swish, Softplus, and ReLU activation functions.<break/></p>
      </para>
      <para xml:id="S6.SS10.p2">
        <p>Swish</p>
        <itemize xml:id="S6.I1">
          <item xml:id="S6.I1.i1">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="S6.I1.i1.p1">
              <p>Minimax: <Math mode="inline" tex="p=0.12050344x^{2}+0.5x+0.153613744" text="p = 0.12050344 * x ^ 2 + 0.5 * x + 0.153613744" xml:id="S6.I1.i1.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0.12050344" role="NUMBER">0.12050344</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok meaning="0.153613744" role="NUMBER">0.153613744</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
          <item xml:id="S6.I1.i2">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="S6.I1.i2.p1">
              <p>Rounded Minimax: <Math mode="inline" tex="\hat{p}=2^{-3}x^{2}+2^{-1}x+2^{-3}" text="hat@(p) = 2 ^ (- 3) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ (- 3)" xml:id="S6.I1.i2.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
          <item xml:id="S6.I1.i3">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">3rd item</tag>
            </tags>
            <para xml:id="S6.I1.i3.p1">
              <p>Quantized: <Math mode="inline" tex="p^{*}=2^{-3}x^{2}+2^{-1}x+2^{-4}" text="p ^ * = 2 ^ (- 3) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ (- 4)" xml:id="S6.I1.i3.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
        </itemize>
      </para>
      <para xml:id="S6.SS10.p3">
        <p>Softplus</p>
        <itemize xml:id="S6.I2">
          <item xml:id="S6.I2.i1">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="S6.I2.i1.p1">
              <p>Minimax: <Math mode="inline" tex="p=0.082812671x^{2}+0.5x+0.75248" text="p = 0.082812671 * x ^ 2 + 0.5 * x + 0.75248" xml:id="S6.I2.i1.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0.082812671" role="NUMBER">0.082812671</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok meaning="0.75248" role="NUMBER">0.75248</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
          <item xml:id="S6.I2.i2">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="S6.I2.i2.p1">
              <p>Rounded Minimax: <Math mode="inline" tex="\hat{p}=2^{-4}x^{2}+2^{-1}x+2^{0}" text="hat@(p) = 2 ^ (- 4) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ 0" xml:id="S6.I2.i2.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
          <item xml:id="S6.I2.i3">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">3rd item</tag>
            </tags>
            <para xml:id="S6.I2.i3.p1">
              <p>Quantized: <Math mode="inline" tex="p^{*}=2^{-4}x^{2}+2^{-1}x+2^{0}" text="p ^ * = 2 ^ (- 4) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ 0" xml:id="S6.I2.i3.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
        </itemize>
      </para>
      <para xml:id="S6.SS10.p4">
        <p>ReLU</p>
        <itemize xml:id="S6.I3">
          <item xml:id="S6.I3.i1">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="S6.I3.i1.p1">
              <p>Minimax: <Math mode="inline" tex="p=0.125x^{2}+0.5x+0.25" text="p = 0.125 * x ^ 2 + 0.5 * x + 0.25" xml:id="S6.I3.i1.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0.125" role="NUMBER">0.125</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
          <item xml:id="S6.I3.i2">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="S6.I3.i2.p1">
              <p>Rounded Minimax: <Math mode="inline" tex="\hat{p}=2^{-3}x^{2}+2^{-1}x+2^{-2}" text="hat@(p) = 2 ^ (- 3) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ (- 2)" xml:id="S6.I3.i2.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
          <item xml:id="S6.I3.i3">
            <tags>
              <tag>•</tag>
              <tag role="typerefnum">3rd item</tag>
            </tags>
            <para xml:id="S6.I3.i3.p1">
              <p>Quantized: <Math mode="inline" tex="p^{*}=2^{-3}x^{2}+2^{-1}x+2^{-2}" text="p ^ * = 2 ^ (- 3) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ (- 2)" xml:id="S6.I3.i3.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></p>
            </para>
          </item>
        </itemize>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS11">
      <tags>
        <tag>VI-K</tag>
        <tag role="refnum">VI-K</tag>
        <tag role="typerefnum">§VI-K</tag>
      </tags>
      <title><tag close=" ">VI-K</tag><text font="italic">Error Minimization</text></title>
      <figure inlist="lof" labels="LABEL:fig:hist" placement="t" xml:id="S6.F3">
        <tags>
          <tag>Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:hist_bn_conv1" xml:id="S6.F3.sf1">
          <tags>
            <tag><text fontsize="80%">(a)</text></tag>
            <tag role="refnum">3(a)</tag>
          </tags>
          <graphics candidates="figures/histograms/conv1_nobn.eps" graphic="figures/histograms/conv1_nobn.eps" options="width=101.17755pt,keepaspectratio=true" xml:id="S6.F3.sf1.g1"/>
          <toccaption><tag close=" ">(a)</tag>Convolution Layer</toccaption>
          <caption><tag close=" "><text fontsize="80%">(a)</text></tag><text fontsize="80%">Convolution Layer</text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:hist_no_bn_conv1" xml:id="S6.F3.sf2">
          <tags>
            <tag><text fontsize="80%">(b)</text></tag>
            <tag role="refnum">3(b)</tag>
          </tags>
          <graphics candidates="figures/histograms/conv1_bn.eps" graphic="figures/histograms/conv1_bn.eps" options="width=101.17755pt,keepaspectratio=true" xml:id="S6.F3.sf2.g1"/>
          <toccaption><tag close=" ">(b)</tag>Convolution Layer (BN)</toccaption>
          <caption><tag close=" "><text fontsize="80%">(b)</text></tag><text fontsize="80%">Convolution Layer (BN)</text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:hist_bn_fc1" xml:id="S6.F3.sf3">
          <tags>
            <tag><text fontsize="80%">(c)</text></tag>
            <tag role="refnum">3(c)</tag>
          </tags>
          <graphics candidates="figures/histograms/fc1_nobn.eps" graphic="figures/histograms/fc1_nobn.eps" options="width=101.17755pt,keepaspectratio=true" xml:id="S6.F3.sf3.g1"/>
          <toccaption><tag close=" ">(c)</tag>Dense (fc) Layer</toccaption>
          <caption><tag close=" "><text fontsize="80%">(c)</text></tag><text fontsize="80%">Dense (fc) Layer</text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" labels="LABEL:fig:hist_no_bn_fc1" xml:id="S6.F3.sf4">
          <tags>
            <tag><text fontsize="80%">(d)</text></tag>
            <tag role="refnum">3(d)</tag>
          </tags>
<!--  %**** main.tex Line 600 **** -->          <graphics candidates="figures/histograms/fc1_bn.eps" graphic="figures/histograms/fc1_bn.eps" options="width=101.17755pt,keepaspectratio=true" xml:id="S6.F3.sf4.g1"/>
          <toccaption><tag close=" ">(d)</tag>Dense (fc) Layer (BN)</toccaption>
          <caption><tag close=" "><text fontsize="80%">(d)</text></tag><text fontsize="80%">Dense (fc) Layer (BN)</text></caption>
        </figure>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>Distribution of pre- and post-activation values. (Top) The <Math mode="inline" tex="x" text="x" xml:id="S6.F3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> axis denotes the pre-activation value. (Bottom) The <Math mode="inline" tex="x" text="x" xml:id="S6.F3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> axis denotes the post-activation value. (Both) The <Math mode="inline" tex="y" text="y" xml:id="S6.F3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math> axis denotes a normalized frequency. The original activation function is denoted by <Math mode="inline" tex="f" text="f" xml:id="S6.F3.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, the baseline minimax estimate is <Math mode="inline" tex="p" text="p" xml:id="S6.F3.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math>, the baseline rounded minimax estimate is <Math mode="inline" tex="\hat{p}" text="hat@(p)" xml:id="S6.F3.m6">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math>, and our method is <Math mode="inline" tex="p^{*}" text="p ^ *" xml:id="S6.F3.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math>. BN denotes batch normalization was applied after the convolution but before <Math mode="inline" tex="f" text="f" xml:id="S6.F3.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>; this is reflected in the pre-activation value. (Bottom) Values after convolution but before applying <Math mode="inline" tex="f" text="f" xml:id="S6.F3.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 3</tag>Distribution of pre- and post-activation values. (Top) The <Math mode="inline" tex="x" text="x" xml:id="S6.F3.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> axis denotes the pre-activation value. (Bottom) The <Math mode="inline" tex="x" text="x" xml:id="S6.F3.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> axis denotes the post-activation value. (Both) The <Math mode="inline" tex="y" text="y" xml:id="S6.F3.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math> axis denotes a normalized frequency. The original activation function is denoted by <Math mode="inline" tex="f" text="f" xml:id="S6.F3.m13">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, the baseline minimax estimate is <Math mode="inline" tex="p" text="p" xml:id="S6.F3.m14">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math>, the baseline rounded minimax estimate is <Math mode="inline" tex="\hat{p}" text="hat@(p)" xml:id="S6.F3.m15">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math>, and our method is <Math mode="inline" tex="p^{*}" text="p ^ *" xml:id="S6.F3.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math>. BN denotes batch normalization was applied after the convolution but before <Math mode="inline" tex="f" text="f" xml:id="S6.F3.m17">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>; this is reflected in the pre-activation value. (Bottom) Values after convolution but before applying <Math mode="inline" tex="f" text="f" xml:id="S6.F3.m18">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>.</caption>
      </figure>
      <para xml:id="S6.SS11.p1">
        <p>The purpose of the error minimization experiment is to determine which activation function produces the lowest approximation error under our quantization constraints.
We evaluate the effectiveness of multiple approximation schemes including our method.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS12">
      <tags>
        <tag>VI-L</tag>
        <tag role="refnum">VI-L</tag>
        <tag role="typerefnum">§VI-L</tag>
      </tags>
      <title><tag close=" ">VI-L</tag><text font="italic">Activation Approximation Accuracy</text></title>
      <para xml:id="S6.SS12.p1">
        <p>We present Table <ref labelref="LABEL:table:sup_fullactivations"/> which contains accuracy values for all the layers and all of the activation functions over three trials.
Activation layers we considered include ReLU, square, Swish, and softplus, using the original function, approximated function, and quantized approximation function.</p>
      </para>
      <table inlist="lot" labels="LABEL:table:sup_fullactivations" placement="!htbp" xml:id="S6.T1">
        <tags>
          <tag>TABLE I</tag>
          <tag role="refnum">I</tag>
          <tag role="typerefnum">TABLE I</tag>
        </tags>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td border="r tt"/>
            <td align="center" border="r tt" colspan="2"><text fontsize="90%">Trial 1</text></td>
            <td align="center" border="r tt" colspan="2"><text fontsize="90%">Trial 2</text></td>
            <td align="center" border="r tt" colspan="2"><text fontsize="90%">Trial 3</text></td>
            <td align="center" border="r tt" colspan="2"><text fontsize="90%">Mean</text></td>
            <td align="center" border="tt" colspan="2"><text fontsize="90%">Stddev</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Activation</text></td>
            <td align="center" border="r"><text fontsize="90%">Train</text></td>
            <td align="center" border="r"><text fontsize="90%">Test</text></td>
            <td align="center" border="r"><text fontsize="90%">Train</text></td>
            <td align="center" border="r"><text fontsize="90%">Test</text></td>
            <td align="center" border="r"><text fontsize="90%">Train</text></td>
            <td align="center" border="r"><text fontsize="90%">Test</text></td>
            <td align="center" border="r"><text fontsize="90%">Train</text></td>
            <td align="center" border="r"><text fontsize="90%">Test</text></td>
            <td align="center" border="r"><text fontsize="90%">Train</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">Test</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Square</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.80</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.08</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.81</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.14</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.8</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.29</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.80</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.17</text></td>
            <td align="center" border="r t"><text fontsize="90%">0.01</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">0.11</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">ReLU</text></td>
            <td align="center" border="r"><text fontsize="90%">99.65</text></td>
            <td align="center" border="r"><text fontsize="90%">99.20</text></td>
            <td align="center" border="r"><text fontsize="90%">99.59</text></td>
            <td align="center" border="r"><text fontsize="90%">99.14</text></td>
            <td align="center" border="r"><text fontsize="90%">99.62</text></td>
            <td align="center" border="r"><text fontsize="90%">99.05</text></td>
            <td align="center" border="r"><text fontsize="90%">99.62</text></td>
            <td align="center" border="r"><text fontsize="90%">99.13</text></td>
            <td align="center" border="r"><text fontsize="90%">0.03</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">0.08</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">ReLU-approx</text></td>
            <td align="center" border="r"><text fontsize="90%">99.57</text></td>
            <td align="center" border="r"><text fontsize="90%">99.07</text></td>
            <td align="center" border="r"><text fontsize="90%">99.60</text></td>
            <td align="center" border="r"><text fontsize="90%">99.14</text></td>
            <td align="center" border="r"><text fontsize="90%">99.58</text></td>
            <td align="center" border="r"><text fontsize="90%">99.07</text></td>
            <td align="center" border="r"><text fontsize="90%">99.58</text></td>
            <td align="center" border="r"><text fontsize="90%">99.09</text></td>
            <td align="center" border="r"><text fontsize="90%">0.02</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">0.04</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Softplus</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.42</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.17</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.37</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.06</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.41</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.05</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.4</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.09</text></td>
            <td align="center" border="r t"><text fontsize="90%">0.03</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">0.07</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Softplus-A</text></td>
            <td align="center" border="r"><text fontsize="90%">99.34</text></td>
            <td align="center" border="r"><text fontsize="90%">99.05</text></td>
            <td align="center" border="r"><text fontsize="90%">99.39</text></td>
            <td align="center" border="r"><text fontsize="90%">98.98</text></td>
            <td align="center" border="r"><text fontsize="90%">99.38</text></td>
            <td align="center" border="r"><text fontsize="90%">98.98</text></td>
            <td align="center" border="r"><text fontsize="90%">99.37</text></td>
            <td align="center" border="r"><text fontsize="90%">99.00</text></td>
            <td align="center" border="r"><text fontsize="90%">0.03</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">0.04</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Softplus-AQ</text></td>
            <td align="center" border="r"><text fontsize="90%">99.17</text></td>
            <td align="center" border="r"><text fontsize="90%">98.92</text></td>
            <td align="center" border="r"><text fontsize="90%">99.13</text></td>
            <td align="center" border="r"><text fontsize="90%">98.92</text></td>
            <td align="center" border="r"><text fontsize="90%">99.17</text></td>
            <td align="center" border="r"><text fontsize="90%">98.87</text></td>
            <td align="center" border="r"><text fontsize="90%">99.16</text></td>
            <td align="center" border="r"><text fontsize="90%">98.9</text></td>
            <td align="center" border="r"><text fontsize="90%">0.16</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">0.03</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Swish</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.63</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.16</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.64</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.22</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.64</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.02</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.64</text></td>
            <td align="center" border="r t"><text fontsize="90%">99.13</text></td>
            <td align="center" border="r t"><text fontsize="90%">0.01</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">0.10</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Swish-A</text></td>
            <td align="center" border="r"><text fontsize="90%">99.56</text></td>
            <td align="center" border="r"><text fontsize="90%">99.07</text></td>
            <td align="center" border="r"><text fontsize="90%">99.59</text></td>
            <td align="center" border="r"><text fontsize="90%">99.13</text></td>
            <td align="center" border="r"><text fontsize="90%">99.58</text></td>
            <td align="center" border="r"><text fontsize="90%">99.07</text></td>
            <td align="center" border="r"><text fontsize="90%">99.58</text></td>
            <td align="center" border="r"><text fontsize="90%">99.09</text></td>
            <td align="center" border="r"><text fontsize="90%">0.02</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">0.03</text></td>
          </tr>
          <tr>
            <td align="left" border="bb r"><text fontsize="90%">Swish-AQ</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.56</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.09</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.60</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.12</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.60</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.08</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.59</text></td>
            <td align="center" border="bb r"><text fontsize="90%">99.10</text></td>
            <td align="center" border="bb r"><text fontsize="90%">0.02</text></td>
            <td align="center" border="bb" class="ltx_nopad_r"><text fontsize="90%">0.02</text></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">I</text></tag><text font="bold" fontsize="90%">Multiple trials for the activation function ablation study.</text><text fontsize="90%"> Values denote accuracy. Minimax approximation is denoted by </text><text font="italic" fontsize="90%">A</text><text fontsize="90%"> and polynomial approximation with quantized coefficients is </text><text font="italic" fontsize="90%">AQ</text><text fontsize="90%"> (our method). For each activation function, three models were trained with different random seeds. The mean accuracy and standard deviation are shown.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE I</tag><text font="bold">Multiple trials for the activation function ablation study.</text> Values denote accuracy. Minimax approximation is denoted by <text font="italic">A</text> and polynomial approximation with quantized coefficients is <text font="italic">AQ</text> (our method). For each activation function, three models were trained with different random seeds. The mean accuracy and standard deviation are shown.</caption>
      </table>
<!--  %The results indicate that Swish is the best activation function for our purposes of encrypted inference. 
     %From here on, feels disjoint; not sure how this relates to the evaluation mentioned above; not sure whether we use gradient clipping in the end; avoiding square activation function isn’t explained or cited.% 
     %NEED TO FIX. 
     %Figure “ref–fig:approx˙swish˝ indicates that our method approximates Swish better than ReLU and Softplus. 
     %Based on the test set results in Table “ref–table:ablation˙approx˙schemes˝, it suggests that ReLU may outperform the square function __ with Swish within one standard deviation %of ReLU and square. 
     %One of the goals of “textit–Faster CryptoNets˝ is to enable the application of larger and deeper networks on encrypted data. % reviewers will likely question why we didn’t test larger networks if this is one of our stated goals % 
     %State-of-the-art networks often employ many layers with complex non-linear activation functions “cite–krizhevsky2012imagenet, he2016deep˝. 
     %By modeling Swish for the remaining experiments in this paper, we can make progress towards this goal. 
     %Figure “ref–fig:hist˝ shows the distribution of pre- and post-activation values, with and without batch normalization. 
     %As previously mentioned in Figure “ref–fig:approx˙swish˝ (bottom), using our $p^*$ approximation, the approximation error is minimized in the interval $[-1, 1]$ (see the blue shaded region in Figure “ref–fig:approx˝). -->      <para xml:id="S6.SS12.p2">
        <p>Figure <ref labelref="LABEL:fig:approx"/> shows our approximation methods applied to Swish, ReLU, and softplus.
The functions are plotted on the top row.
Most approximations are able to fit the original function <Math mode="inline" tex="f" text="f" xml:id="S6.SS12.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> within the interval <Math mode="inline" tex="[-1,1]" text="closed-interval@(- 1, 1)" xml:id="S6.SS12.p2.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S6.SS12.p2.m2.2"/>
                  <XMRef idref="S6.SS12.p2.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="S6.SS12.p2.m2.2">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S6.SS12.p2.m2.1">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math><!--  %**** main.tex Line 675 **** -->.
The bottom row of Figure <ref labelref="LABEL:fig:approx"/> shows the approximation error of <Math mode="inline" tex="\hat{p}" text="hat@(p)" xml:id="S6.SS12.p2.m3">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="p^{*}" text="p ^ *" xml:id="S6.SS12.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> for different pre-activation <Math mode="inline" tex="x" text="x" xml:id="S6.SS12.p2.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> values.
Overall, Swish has lower error than ReLU and softplus.
If we can constrain the pre-activation values to fall within the interval, our model will have better approximations.
Conveniently, batch norm transforms the pre-activation values into a normal distribution with zero mean and unit variance <cite class="ltx_citemacro_cite">[<bibref bibrefs="ioffe2015batch" separator="," yyseparator=","/>]</cite> which reduces overall error of the approximation <cite class="ltx_citemacro_cite">[<bibref bibrefs="chabanne2017privacy" separator="," yyseparator=","/>]</cite>.
The shaded area under the curve in Figure <ref labelref="LABEL:fig:approx"/> shows the approximation error within the interval <Math mode="inline" tex="[-1,1]" text="closed-interval@(- 1, 1)" xml:id="S6.SS12.p2.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S6.SS12.p2.m6.2"/>
                  <XMRef idref="S6.SS12.p2.m6.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="S6.SS12.p2.m6.2">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S6.SS12.p2.m6.1">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.
Swish has lower error than both ReLU and softplus.</p>
      </para>
      <para xml:id="S6.SS12.p3">
        <p>In Figure <ref labelref="LABEL:fig:hist"/>, we investigate the correctness of our proposed activation approximation method by plotting the pre-activation and post-activation values of different layers for both the regular and approximated Swish functions.
The post-activation graphs in Figure <ref labelref="LABEL:fig:hist"/> for Swish show the minimum value between <Math mode="inline" tex="\approx-0.28" text="absent approximately-equals - 0.28" xml:id="S6.SS12.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="0.28" role="NUMBER">0.28</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
We analytically compute the theoretical minimum value for Swish by taking the first order derivative <Math mode="inline" tex="f^{\prime}(x)=f(x)+(1-f(x))\sigma(x)" text="f ^ prime * x = f * x + (1 - f * x) * sigma * x" xml:id="S6.SS12.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S6.SS12.p3.m2.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S6.SS12.p3.m2.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMRef idref="S6.SS12.p3.m2.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.SS12.p3.m2.2">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMDual>
                      <XMRef idref="S6.SS12.p3.m2.5"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S6.SS12.p3.m2.5">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMDual>
                              <XMRef idref="S6.SS12.p3.m2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S6.SS12.p3.m2.3">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                    <XMDual>
                      <XMRef idref="S6.SS12.p3.m2.4"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.SS12.p3.m2.4">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
This gives us the equation <Math mode="inline" tex="1+e^{-x}+xe^{-x}=0" text="1 + e ^ (- x) + x * e ^ (- x) = 0" xml:id="S6.SS12.p3.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, from which we can derive <Math mode="inline" tex="x\approx-1.27846" text="x approximately-equals - 1.27846" xml:id="S6.SS12.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="1.27846" role="NUMBER">1.27846</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
Using <Math mode="inline" tex="x\approx-1.27846" text="x approximately-equals - 1.27846" xml:id="S6.SS12.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="1.27846" role="NUMBER">1.27846</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> to compute <Math mode="inline" tex="f(x)" text="f * x" xml:id="S6.SS12.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMRef idref="S6.SS12.p3.m6.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.SS12.p3.m6.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, we get an approximate minimum value of <Math mode="inline" tex="-0.278465" text="- 0.278465" xml:id="S6.SS12.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok meaning="0.278465" role="NUMBER">0.278465</XMTok>
              </XMApp>
            </XMath>
          </Math>, which corroborates our empirical minimum values shown in Figure <ref labelref="LABEL:fig:hist"/>.
We find that this minimum value remains consistent for the approximated Swish function as well, validating the correctness of our approximation method.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sup:hops" xml:id="S6.SS13">
      <tags>
        <tag>VI-M</tag>
        <tag role="refnum">VI-M</tag>
        <tag role="typerefnum">§VI-M</tag>
      </tags>
      <title><tag close=" ">VI-M</tag><text font="italic">Detailed Breakdown of Homomorphic Operations</text></title>
      <table inlist="lot" labels="LABEL:table:sup_hops_cryptonets" placement="!htbp" xml:id="S6.T2">
        <tags>
          <tag>TABLE II</tag>
          <tag role="refnum">II</tag>
          <tag role="typerefnum">TABLE II</tag>
        </tags>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="left" border="r tt"><text fontsize="90%">Layer</text></td>
            <td align="center" border="r tt"><text fontsize="90%">HOPs</text></td>
            <td align="right" border="tt"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmPT-CT</text></td>
            <td border="tt"/>
            <td border="tt"/>
            <td border="tt"/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Adds</text></td>
            <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCT-CT</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Adds</text></td>
            <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmPT-CT</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Mults</text></td>
            <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCT-CT</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Mults</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Conv-1</text></td>
            <td align="center" border="r t"><text fontsize="90%">42,757</text></td>
            <td align="center" border="r t"><text fontsize="90%">845</text></td>
            <td align="center" border="r t"><text fontsize="90%">20,956</text></td>
            <td align="center" border="r t"><text fontsize="90%">20,956</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Act-1</text></td>
            <td align="center" border="r"><text fontsize="90%">845</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">845</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Pool-1</text></td>
            <td align="center" border="r"><text fontsize="90%">6,845</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">6,845</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Conv-2</text></td>
            <td align="center" border="r"><text fontsize="90%">309,950</text></td>
            <td align="center" border="r"><text fontsize="90%">1,250</text></td>
            <td align="center" border="r"><text fontsize="90%">154,350</text></td>
            <td align="center" border="r"><text fontsize="90%">154,350</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Pool-2</text></td>
            <td align="center" border="r"><text fontsize="90%">8,450</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">8,450</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">FC-1</text></td>
            <td align="center" border="r"><text fontsize="90%">241,192</text></td>
            <td align="center" border="r"><text fontsize="90%">100</text></td>
            <td align="center" border="r"><text fontsize="90%">120,546</text></td>
            <td align="center" border="r"><text fontsize="90%">120,546</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Act-2</text></td>
            <td align="center" border="r"><text fontsize="90%">100</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">100</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">FC-2</text></td>
            <td align="center" border="r"><text fontsize="90%">1990</text></td>
            <td align="center" border="r"><text fontsize="90%">10</text></td>
            <td align="center" border="r"><text fontsize="90%">990</text></td>
            <td align="center" border="r"><text fontsize="90%">990</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="bb r t"><text fontsize="90%">Total</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">612,129</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">2,205</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">312,137</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">296,842</text></td>
            <td align="center" border="bb t" class="ltx_nopad_r"><text fontsize="90%">945</text></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">II</text></tag><text fontsize="90%">CryptoNets HOPs. More detailed breakdown of HOPs for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. </text><text font="italic" fontsize="90%">Adds</text><text fontsize="90%"> and </text><text font="italic" fontsize="90%">mults</text><text fontsize="90%"> refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE II</tag>CryptoNets HOPs. More detailed breakdown of HOPs for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. <text font="italic">Adds</text> and <text font="italic">mults</text> refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.</caption>
      </table>
      <table inlist="lot" labels="LABEL:table:sup_hops_fastcryptonets" placement="!htbp" xml:id="S6.T3">
        <tags>
          <tag>TABLE III</tag>
          <tag role="refnum">III</tag>
          <tag role="typerefnum">TABLE III</tag>
        </tags>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="left" border="r tt"><text fontsize="90%">Layer</text></td>
            <td align="center" border="r tt"><text fontsize="90%">HOPs</text></td>
            <td align="right" border="tt"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmPT-CT</text></td>
            <td border="tt"/>
            <td border="tt"/>
            <td border="tt"/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Adds</text></td>
            <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCT-CT</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Adds</text></td>
            <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmPT-CT</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Mults</text></td>
            <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCT-CT</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left"><text fontsize="90%">Mults</text></td>
            <td/>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Conv-1</text></td>
            <td align="center" border="r t"><text fontsize="90%">8619</text></td>
            <td align="center" border="r t"><text fontsize="90%">1,690</text></td>
            <td align="center" border="r t"><text fontsize="90%">3,042</text></td>
            <td align="center" border="r t"><text fontsize="90%">3,887</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Act-1</text></td>
            <td align="center" border="r"><text fontsize="90%">5,070</text></td>
            <td align="center" border="r"><text fontsize="90%">845</text></td>
            <td align="center" border="r"><text fontsize="90%">1,690</text></td>
            <td align="center" border="r"><text fontsize="90%">1,690</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">845</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Pool-1</text></td>
            <td align="center" border="r"><text fontsize="90%">6,845</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">6,845</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Conv-2</text></td>
            <td align="center" border="r"><text fontsize="90%">22,950</text></td>
            <td align="center" border="r"><text fontsize="90%">1250</text></td>
            <td align="center" border="r"><text fontsize="90%">10,850</text></td>
            <td align="center" border="r"><text fontsize="90%">10,850</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Pool-2</text></td>
            <td align="center" border="r"><text fontsize="90%">8,450</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" border="r"><text fontsize="90%">8,450</text></td>
            <td align="center" border="r"><text fontsize="90%">—</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">FC-1</text></td>
            <td align="center" border="r"><text fontsize="90%">14,354</text></td>
            <td align="center" border="r"><text fontsize="90%">100</text></td>
            <td align="center" border="r"><text fontsize="90%">7,077</text></td>
            <td align="center" border="r"><text fontsize="90%">7,177</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Act-2</text></td>
            <td align="center" border="r"><text fontsize="90%">600</text></td>
            <td align="center" border="r"><text fontsize="90%">100</text></td>
            <td align="center" border="r"><text fontsize="90%">200</text></td>
            <td align="center" border="r"><text fontsize="90%">200</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">100</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Fc-2</text></td>
            <td align="center" border="r"><text fontsize="90%">306</text></td>
            <td align="center" border="r"><text fontsize="90%">10</text></td>
            <td align="center" border="r"><text fontsize="90%">148</text></td>
            <td align="center" border="r"><text fontsize="90%">148</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
          </tr>
          <tr>
            <td align="left" border="bb r t"><text fontsize="90%">Total</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">67,194</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">3,995</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">38,302</text></td>
            <td align="center" border="bb r t"><text fontsize="90%">23,952</text></td>
            <td align="center" border="bb t" class="ltx_nopad_r"><text fontsize="90%">945</text></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">III</text></tag><text fontsize="90%">Faster CryptoNets HOPs. More detailed breakdown of HOPs for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. </text><text font="italic" fontsize="90%">Adds</text><text fontsize="90%"> and </text><text font="italic" fontsize="90%">mults</text><text fontsize="90%"> refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE III</tag>Faster CryptoNets HOPs. More detailed breakdown of HOPs for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. <text font="italic">Adds</text> and <text font="italic">mults</text> refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.</caption>
      </table>
      <para xml:id="S6.SS13.p1">
        <p>In Table <ref labelref="LABEL:table:sup_hops_cryptonets"/>, we list the HOPs at a more granular level than those presented in Table <ref labelref="LABEL:table:sota"/> for CryptoNets. In Table <ref labelref="LABEL:table:sup_hops_fastcryptonets"/>, we list the HOPs for our <text font="italic">Faster CryptoNets</text> method. We can see that the number of HOPS is greatly reduced for each layer and for the overall network.</p>
      </para>
<!--  %Edward Changes% 
     %REVIEW.% 
     %In the bottom row, we plot the error for the approximated activations and quantized approximated activations.  We shade the batch-region shaded blue underneath the curves. 
     %Batch-norm transforms the pre-activation values into a normal distribution with zero mean and unit variance “cite–ioffe2015batch˝. 
     %For all the plots, the batch-norm constraints 
     %This behavior supports the result of “cite–chabanne2017privacy˝ and “cite–hesamifard2017cryptodl˝ who found that batch-norm reduces overall approximation error 
     %In Figure “ref–fig:approx˝, we can also see that for Swish and ReLU, the error is minimized between $[-1, 1]$, while for Softplus this minimization is less apparent. 
     %This demonstrates that Swish and ReLU appear to be better suited for approximated activation functions. 
     %The top row of Figure “ref–fig:hist˝ shows that most pre-activation values are contained in the $[-1, 1]$ interval, with the exception of the dense layer. 
     %% Figure “ref–fig:approx˙relu˝ shows that ReLU exhibits larger approximation errors in $[-1, 1]$ and 
     %Figure “ref–fig:approx˙softplus˝ shows that softplus exhibits maximal error in this interval, which corrobates the findings we find in Figure “ref–fig:approx˝. 
     %Applying batch normalization further ensures that pre-activation values fall within this optimal approximation range, leading to our decision to use Swish (see Figures “ref–fig:hist˙bn˙conv1˝ and “ref–fig:hist˙bn˙fc1˝). 
     %While we use Swish for our experiments, due to the similar polynomial approximation result, ReLU can be easily substituted. -->    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:sota" xml:id="S6.SS14">
      <tags>
        <tag>VI-N</tag>
        <tag role="refnum">VI-N</tag>
        <tag role="typerefnum">§VI-N</tag>
      </tags>
      <title><tag close=" ">VI-N</tag><text font="italic">Comparison with Prior Work</text></title>
<!--  %Table “ref–table:sota˝ shows our method compared to existing homomorphic encryption methods. 
     %The primary evaluation metric is the test set accuracy and single image inference HOPs. 
     %Secondary criteria are training accuracy and message sizes for data transfer between parties. -->      <table inlist="lot" labels="LABEL:table:sota" placement="!htbp" xml:id="S6.T4">
        <tags>
          <tag>TABLE IV</tag>
          <tag role="refnum">IV</tag>
          <tag role="typerefnum">TABLE IV</tag>
        </tags>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="left" border="r tt"><text fontsize="90%">Criteria</text></td>
            <td align="center" border="r tt"><text fontsize="90%">Faster CryptoNets</text></td>
            <td align="center" border="tt"><text fontsize="90%">CryptoNets</text></td>
            <td align="center" border="tt"><text fontsize="90%">CryptoDL-1</text></td>
            <td align="center" border="tt"><text fontsize="90%">CryptoDL-2</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">PT-CT Adds</text></td>
            <td align="center" border="r t"><text fontsize="90%">3,995</text></td>
            <td align="center" border="t"><text font="bold" fontsize="90%">2,205</text></td>
            <td align="center" border="t"><text fontsize="90%">30,750</text></td>
            <td align="center" border="t"><text fontsize="90%">161,546</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">CT-CT Adds</text></td>
            <td align="center" border="r"><text font="bold" fontsize="90%">38,302</text></td>
            <td align="center"><text fontsize="90%">312,137</text></td>
            <td align="center"><Math mode="inline" tex="2.31\times 10^{6}" text="2.31 * 10 ^ 6" xml:id="S6.T4.m1">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok fontsize="90%" meaning="2.31" role="NUMBER">2.31</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok fontsize="90%" meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="63%" meaning="6" role="NUMBER">6</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="4.61\times 10^{7}" text="4.61 * 10 ^ 7" xml:id="S6.T4.m2">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok fontsize="90%" meaning="4.61" role="NUMBER">4.61</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok fontsize="90%" meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="63%" meaning="7" role="NUMBER">7</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">PT-CT Mults</text></td>
            <td align="center" border="r"><text font="bold" fontsize="90%">23,952</text></td>
            <td align="center"><text fontsize="90%">296,842</text></td>
            <td align="center"><Math mode="inline" tex="2.31\times 10^{6}" text="2.31 * 10 ^ 6" xml:id="S6.T4.m3">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok fontsize="90%" meaning="2.31" role="NUMBER">2.31</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok fontsize="90%" meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="63%" meaning="6" role="NUMBER">6</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="4.62\times 10^{7}" text="4.62 * 10 ^ 7" xml:id="S6.T4.m4">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok fontsize="90%" meaning="4.62" role="NUMBER">4.62</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok fontsize="90%" meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="63%" meaning="7" role="NUMBER">7</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">CT-CT Mults</text></td>
            <td align="center" border="r"><text font="bold" fontsize="90%">945</text></td>
            <td align="center"><text font="bold" fontsize="90%">945</text></td>
            <td align="center"><text fontsize="90%">1,600</text></td>
            <td align="center"><text fontsize="90%">64,512</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Total HOPs</text></td>
            <td align="center" border="r"><text font="bold" fontsize="90%">67,194</text></td>
            <td align="center"><text fontsize="90%">612,129</text></td>
            <td align="center"><Math mode="inline" tex="4.65\times 10^{6}" text="4.65 * 10 ^ 6" xml:id="S6.T4.m5">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok fontsize="90%" meaning="4.65" role="NUMBER">4.65</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok fontsize="90%" meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="63%" meaning="6" role="NUMBER">6</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="9.27\times 10^{7}" text="9.27 * 10 ^ 7" xml:id="S6.T4.m6">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok fontsize="90%" meaning="9.27" role="NUMBER">9.27</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok fontsize="90%" meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="63%" meaning="7" role="NUMBER">7</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Encrypt+Decrypt Time</text></td>
            <td align="center" border="r t"><text font="bold" fontsize="90%">6.7 sec</text></td>
            <td align="center" border="t"><text fontsize="90%">47.5 sec</text></td>
            <td align="center" border="t"><text fontsize="90%">16.7 sec</text></td>
            <td align="center" border="t"><text fontsize="90%">16.7 sec</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Inference Time</text></td>
            <td align="center" border="r"><text font="bold" fontsize="90%">39.1 sec</text></td>
            <td align="center"><text fontsize="90%">249.6 sec</text></td>
            <td align="center"><text fontsize="90%">148.9 sec</text></td>
            <td align="center"><text fontsize="90%">320.0 sec</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="90%">Test Set Accuracy</text></td>
            <td align="center" border="r t"><text fontsize="90%">98.71</text></td>
            <td align="center" border="t"><text fontsize="90%">98.95</text></td>
            <td align="center" border="t"><text fontsize="90%">98.52</text></td>
            <td align="center" border="t"><text font="bold" fontsize="90%">99.52</text></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="90%">Message Size</text></td>
            <td align="center" border="r"><text fontsize="90%">411.1 MB</text></td>
            <td align="center"><text fontsize="90%">367.5 MB</text></td>
            <td align="center"><text font="bold" fontsize="90%">336.7 MB</text></td>
            <td align="center"><text font="bold" fontsize="90%">336.7 MB</text></td>
          </tr>
          <tr>
            <td align="left" border="bb r"><text fontsize="90%">Encryption Scheme</text></td>
            <td align="center" border="bb r"><text fontsize="90%">FV-RNS</text></td>
            <td align="center" border="bb"><text fontsize="90%">YASHE</text></td>
            <td align="center" border="bb"><text fontsize="90%">BGV</text></td>
            <td align="center" border="bb"><text fontsize="90%">BGV</text></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">IV</text></tag><text font="bold" fontsize="90%">Comparison of State-of-the-Art Methods (Encrypted).</text><text fontsize="90%"> Plaintext is denoted by PT and ciphertext is denoted by CT. </text><text font="italic" fontsize="90%">Adds</text><text fontsize="90%"> and </text><text font="italic" fontsize="90%">mults</text><text fontsize="90%"> refer to the number of homomorphic addition and multiplication operations, respectively. The total number of homomorphic operations is denoted by HOPs. Message size is the size of a single encrypted image. </text><text font="italic" fontsize="90%"><!--  %__ smaller is better. -->Faster CryptoNets</text><text fontsize="90%"> uses Swish-AQ while CryptoNets uses </text><Math mode="inline" tex="f(x)=x^{2}" text="f * x = x ^ 2" xml:id="S6.T4.m7">
            <XMath>
              <XMApp>
                <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">f</XMTok>
                  <XMDual>
                    <XMRef idref="S6.T4.m7.1"/>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S6.T4.m7.1">x</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="63%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><text fontsize="90%"> as the activation function. References: CryptoNets </text><cite class="ltx_citemacro_cite"><text fontsize="90%">[</text><bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/><text fontsize="90%">]</text></cite><text fontsize="90%">, CryptoDL </text><cite class="ltx_citemacro_cite"><text fontsize="90%">[</text><bibref bibrefs="hesamifard2017cryptodl" separator="," yyseparator=","/><text fontsize="90%">]</text></cite><text fontsize="90%">.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE IV</tag><text font="bold">Comparison of State-of-the-Art Methods (Encrypted).</text> Plaintext is denoted by PT and ciphertext is denoted by CT. <text font="italic">Adds</text> and <text font="italic">mults</text> refer to the number of homomorphic addition and multiplication operations, respectively. The total number of homomorphic operations is denoted by HOPs. Message size is the size of a single encrypted image. <text font="italic"><!--  %__ smaller is better. -->Faster CryptoNets</text> uses Swish-AQ while CryptoNets uses <Math mode="inline" tex="f(x)=x^{2}" text="f * x = x ^ 2" xml:id="S6.T4.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok fontsize="111%" meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMDual>
                    <XMRef idref="S6.T4.m8.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S6.T4.m8.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> as the activation function. References: CryptoNets <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/>]</cite>, CryptoDL <cite class="ltx_citemacro_cite">[<bibref bibrefs="hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite>.</caption>
      </table>
      <para xml:id="S6.SS14.p1">
        <p><!--  %“subsubsection–Number of Homomorphic Operations˝ -->The target use case of our work is inference on a single encrypted image (Figure <!--  %“textbf–Number of Homomorphic Operations˝. --><ref labelref="LABEL:fig:pull"/>).
We believe this approach is more analogous to practical use cases, where the third-party host runs asynchronous inference for individual users.
Additionally, <cite class="ltx_citemacro_cite">[<bibref bibrefs="Migliore:2017:HAH:3145508.3126558" separator="," yyseparator=","/>]</cite> suggests that there are very significant drawbacks to batching, including having to select more numerous and restricted NTT points, forcing specific computations away from NTT, and adding large computational cost.
Works focusing on accelerating neural networks neglect batching for similar reasons as ours (<cite class="ltx_citemacro_cite">[<bibref bibrefs="sanyal2018tapas" separator="," yyseparator=","/>]</cite> does not use batching, and <cite class="ltx_citemacro_cite">[<bibref bibrefs="florian2017fastdiscretize" separator="," yyseparator=","/>]</cite>. uses batching to compress messages but not to improve throughput). Works that do batch inputs use schemes not very efficient in practice (discussed in <cite class="ltx_citemacro_cite">[<bibref bibrefs="Migliore:2017:HAH:3145508.3126558" separator="," yyseparator=","/>]</cite>.) and do not report the batching cost. A thorough performance analysis of batching binary vs scalar messages across different libraries is beyond the scope of our paper but would be a great direction for future work.
As such, we do not implement ciphertext batching techniques in this paper, although we find it worth noting that our technique does not preclude the use of batching techniques. <cite class="ltx_citemacro_cite">[<bibref bibrefs="Migliore:2017:HAH:3145508.3126558" separator="," yyseparator=","/>]</cite> introduces the Karatsuba algorithm which supports batching with binary encoding, preserving the benefits from our method.</p>
      </para>
      <para xml:id="S6.SS14.p2">
        <p><!--  %“subsubsection–Test Set Accuracy “&amp; Inference Time˝ -->We refer (Table <!--  %“textbf–Test Set Accuracy “&amp; Inference Time˝. 
     %“textbf–Runtime Analysis˝. --><ref labelref="LABEL:table:sota"/>) for accuracy and runtime results.
The test set accuracy of our original model is 99.12%, and is slightly reduced to 98.71% after pruning and quantization.
Evaluation of network layers in <text font="italic">Faster CryptoNets</text> takes 39.1 seconds for one input, compared to 249.6 seconds for CryptoNet. We achieve a <Math class="ltx_math_unparsed" mode="inline" tex="6.4\times" xml:id="S6.SS14.p2.m1">
            <XMath>
              <XMTok meaning="6.4" role="NUMBER">6.4</XMTok>
              <XMTok meaning="times" role="MULOP">×</XMTok>
            </XMath>
          </Math> improvement in wall-clock time while maintaining accuracy comparable to that of CryptoNets, which achieved 98.95% test accuracy. We also find that our method achieves <Math class="ltx_math_unparsed" mode="inline" tex="9.1\times" xml:id="S6.SS14.p2.m2">
            <XMath>
              <XMTok meaning="9.1" role="NUMBER">9.1</XMTok>
              <XMTok meaning="times" role="MULOP">×</XMTok>
            </XMath>
          </Math> fewer HOPs, a larger improvement than raw wall-clock time suggests.
In <text font="italic">Faster CryptoNets</text><!--  %**** main.tex Line 800 **** -->, encoding/encryption takes 6.63 seconds, while decryption of the final layer’s output takes 0.02 seconds.
CryptoNets takes 44.5 seconds for encoding/encryption, and 3 seconds for decryption.
Our method is <Math class="ltx_math_unparsed" mode="inline" tex="6.7\times" xml:id="S6.SS14.p2.m3">
            <XMath>
              <XMTok meaning="6.7" role="NUMBER">6.7</XMTok>
              <XMTok meaning="times" role="MULOP">×</XMTok>
            </XMath>
          </Math> and <Math class="ltx_math_unparsed" mode="inline" tex="150\times" xml:id="S6.SS14.p2.m4">
            <XMath>
              <XMTok meaning="150" role="NUMBER">150</XMTok>
              <XMTok meaning="times" role="MULOP">×</XMTok>
            </XMath>
          </Math> faster for these operations, respectively.</p>
      </para>
<!--  %“subsubsection–Encryption “&amp; Decryption Time˝ 
     %“textbf–Encryption “&amp; Decryption Time˝. 
     %“textbf–Runtime Analysis˝. -->      <para xml:id="S6.SS14.p3">
        <p><!--  %“subsubsection–Data Transfer˝ -->MNIST images are <!--  %“textbf–Data Transfer˝. --><Math mode="inline" tex="28\times 28" text="28 * 28" xml:id="S6.SS14.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
              </XMApp>
            </XMath>
          </Math> pixels.
Each ciphertext consists of 2 polynomials resulting in 65,544 integers (64-bit).
Therefore, our message consists of <Math mode="inline" tex="28\times 28\times 65544\times 8" text="28 * 28 * 65544 * 8" xml:id="S6.SS14.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
                <XMTok meaning="65544" role="NUMBER">65544</XMTok>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMath>
          </Math> bytes, or 411.1 MB. The output of the network consists of the 10 outputs of the final dense layer, which gives us a result consisting of <Math mode="inline" tex="10\times 65544\times 8" text="10 * 65544 * 8" xml:id="S6.SS14.p3.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMTok meaning="65544" role="NUMBER">65544</XMTok>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMath>
          </Math> bytes, or 5.24 MB. In CryptoNets, the authors’ encryption scheme results in each image consuming 367.5 MB in encrypted form.
Our scheme results in comparable message sizes to previous work.</p>
      </para>
<!--  %Table “ref–table:layer˙times˝ shows a layer-by-layer analysis of runtime comparisons for both CryptoNet and Faster CryptoNet. 
     %We can see that for each layer, our network is orders of magnitude faster than the equivalent layer in CryptoNet. 
     %This contributes to a total improvement of 6.4x in recorded runtime for the inference of one image. 
     %We run our network on an Intel Core i7-5930K CPU at 3.50GHz with 48GB RAM. 
     %For our previous runtime calculations, we ran one instance of an inference task with our model, observing runtimes of around 43.9 seconds. 
     %We also parallelized multiple tasks using threading, spawning up to 125 different processes on an (AWS) machine with a single Intel Xeon CPU E7-8880 v3 running at 2.30GHz with 1.88 TB RAM. 
     %Using the given hardware, we observed minimal-to-no slowdown for each process. 
     %We assume that due to the similarities in architecture with the original CryptoNet, we can perform the same batched computations with an proportional reduction in computation. Thus, we have shown that our method leads to an order of magnitude improvement in the execution of the intermediate part of the network without the need for weight folding for combining the intermediate layers. 
     %**** main.tex Line 825 **** 
     %We report our results in Table “ref–table:hops˝. 
     %Table of plaintext test set accuracy and encrypted inference time (pruned-quantized cryptonet with different activation functions) 
     %“begin–figure*˝ 
     %“centering 
     %“begin–subfigure˝ 
     %“includegraphics[width=2.5in]–figures/approx/relu.png˝ 
     %“caption–A gull˝ 
     %“label–fig:gull˝ 
     %“end–subfigure˝ 
     %~ d 
     %“begin–subfigure˝ 
     %“includegraphics[width=2.5in]–figures/approx/swish.png˝ 
     %“caption–A tiger˝ 
     %“label–fig:tiger˝ 
     %“end–subfigure˝ 
     %“end–figure*˝ -->    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:ablation" xml:id="S6.SS15">
      <tags>
        <tag>VI-O</tag>
        <tag role="refnum">VI-O</tag>
        <tag role="typerefnum">§VI-O</tag>
      </tags>
      <title><tag close=" ">VI-O</tag><text font="italic">Ablation Studies</text></title>
      <table inlist="lot" labels="LABEL:table:layerwise" placement="!htbp" xml:id="S6.T5">
        <tags>
          <tag>TABLE V</tag>
          <tag role="refnum">V</tag>
          <tag role="typerefnum">TABLE V</tag>
        </tags>
<!--  %**** main.tex Line 850 **** -->        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td border="r tt"/>
            <td align="center" border="r tt" colspan="2"><text fontsize="80%">Faster CryptoNets</text></td>
            <td align="center" border="r tt" colspan="2"><text fontsize="80%">CryptoNets</text></td>
            <td align="center" border="tt" colspan="2"><text fontsize="80%">Relative</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="80%">Layer</text></td>
            <td align="center" border="t"><text fontsize="80%">Time</text></td>
            <td align="center" border="r t"><text fontsize="80%">HOPs</text></td>
            <td align="center" border="t"><text fontsize="80%">Time</text></td>
            <td align="center" border="r t"><text fontsize="80%">HOPs</text></td>
            <td align="center" border="t"><text fontsize="80%">Time</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="80%">HOPs</text></td>
          </tr>
          <tr>
            <td align="left" border="r t"><text fontsize="80%">Conv-1</text></td>
            <td align="center" border="t"><text font="bold" fontsize="80%">3.9</text></td>
            <td align="center" border="r t"><text font="bold" fontsize="80%">8,619</text></td>
            <td align="center" border="t"><text fontsize="80%">30.0</text></td>
            <td align="center" border="r t"><text fontsize="80%">42K</text></td>
            <td align="center" border="t"><Math class="ltx_math_unparsed" mode="inline" tex="7.7\times" xml:id="S6.T5.m1">
                <XMath>
                  <XMTok fontsize="80%" meaning="7.7" role="NUMBER">7.7</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="t" class="ltx_nopad_r"><Math class="ltx_math_unparsed" mode="inline" tex="4.9\times" xml:id="S6.T5.m2">
                <XMath>
                  <XMTok fontsize="80%" meaning="4.9" role="NUMBER">4.9</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="80%">Act-1</text></td>
            <td align="center"><text font="bold" fontsize="80%">23.4</text></td>
            <td align="center" border="r"><text fontsize="80%">5,070</text></td>
            <td align="center"><text fontsize="80%">81.0</text></td>
            <td align="center" border="r"><text fontsize="80%">845</text></td>
            <td align="center"><Math class="ltx_math_unparsed" mode="inline" tex="3.5\times" xml:id="S6.T5.m3">
                <XMath>
                  <XMTok fontsize="80%" meaning="3.5" role="NUMBER">3.5</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
            <td align="center" class="ltx_nopad_r"><Math class="ltx_math_unparsed" mode="inline" tex="0.2\times" xml:id="S6.T5.m4">
                <XMath>
                  <XMTok fontsize="80%" meaning="0.2" role="NUMBER">0.2</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="80%">Mid</text></td>
            <td align="center"><text font="bold" fontsize="80%">9.1</text></td>
            <td align="center" border="r"><text font="bold" fontsize="80%">53K</text></td>
            <td align="center"><text fontsize="80%">127.0</text></td>
            <td align="center" border="r"><text fontsize="80%">566K</text></td>
            <td align="center"><Math class="ltx_math_unparsed" mode="inline" tex="14\times" xml:id="S6.T5.m5">
                <XMath>
                  <XMTok fontsize="80%" meaning="14" role="NUMBER">14</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
            <td align="center" class="ltx_nopad_r"><Math class="ltx_math_unparsed" mode="inline" tex="11\times" xml:id="S6.T5.m6">
                <XMath>
                  <XMTok fontsize="80%" meaning="11" role="NUMBER">11</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="80%">Act-2</text></td>
            <td align="center"><text font="bold" fontsize="80%">2.7</text></td>
            <td align="center" border="r"><text fontsize="80%">600</text></td>
            <td align="center"><text fontsize="80%">10.0</text></td>
            <td align="center" border="r"><text fontsize="80%">100</text></td>
            <td align="center"><Math class="ltx_math_unparsed" mode="inline" tex="3.7\times" xml:id="S6.T5.m7">
                <XMath>
                  <XMTok fontsize="80%" meaning="3.7" role="NUMBER">3.7</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
            <td align="center" class="ltx_nopad_r"><Math class="ltx_math_unparsed" mode="inline" tex="0.2\times" xml:id="S6.T5.m8">
                <XMath>
                  <XMTok fontsize="80%" meaning="0.2" role="NUMBER">0.2</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="r"><text fontsize="80%">FC-2</text></td>
            <td align="center"><text font="bold" fontsize="80%">0.1</text></td>
            <td align="center" border="r"><text font="bold" fontsize="80%">306</text></td>
            <td align="center"><text fontsize="80%">1.6</text></td>
            <td align="center" border="r"><text fontsize="80%">1,990</text></td>
            <td align="center"><Math class="ltx_math_unparsed" mode="inline" tex="16\times" xml:id="S6.T5.m9">
                <XMath>
                  <XMTok fontsize="80%" meaning="16" role="NUMBER">16</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
            <td align="center" class="ltx_nopad_r"><Math class="ltx_math_unparsed" mode="inline" tex="6.5\times" xml:id="S6.T5.m10">
                <XMath>
                  <XMTok fontsize="80%" meaning="6.5" role="NUMBER">6.5</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="bb r t"><text fontsize="80%">Total</text></td>
            <td align="center" border="bb t"><text font="bold" fontsize="80%">39.1</text></td>
            <td align="center" border="bb r t"><text font="bold" fontsize="80%">67K</text></td>
            <td align="center" border="bb t"><text fontsize="80%">249.6</text></td>
            <td align="center" border="bb r t"><text fontsize="80%">612K</text></td>
            <td align="center" border="bb t"><Math class="ltx_math_unparsed" mode="inline" tex="6.4\times" xml:id="S6.T5.m11">
                <XMath>
                  <XMTok fontsize="80%" meaning="6.4" role="NUMBER">6.4</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="bb t" class="ltx_nopad_r"><Math class="ltx_math_unparsed" mode="inline" tex="9.1\times" xml:id="S6.T5.m12">
                <XMath>
                  <XMTok fontsize="80%" meaning="9.1" role="NUMBER">9.1</XMTok>
                  <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><!--  %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. --><text fontsize="80%">V</text><!--  %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. 
     %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. 
     %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. 
     %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. 
     %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. --></tag><text font="bold" fontsize="80%"><!--  %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. -->Layer-Wise Analysis (Encrypted).</text><text fontsize="80%"> Wall-clock time (seconds) and HOPs required for inference on a single encrypted image. K denotes thousands. </text><text font="italic" fontsize="80%">Act</text><text fontsize="80%"> refers to the activation function. </text><text font="italic" fontsize="80%">Mid</text><text fontsize="80%"> denotes a combination of pool1, conv2, pool2, and fc1, as reported by </text><cite class="ltx_citemacro_cite"><text fontsize="80%">[</text><bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/><text fontsize="80%">]</text></cite><text fontsize="80%">. </text></toccaption>
        <caption class="ltx_centering" fontsize="80%"><tag close=": ">TABLE V</tag><!--  %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. 
     %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. --><text font="bold"><!--  %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. -->Layer-Wise Analysis (Encrypted).<!--  %HOPs were computed analytically. %“textit–Faster CryptoNets˝ uses Swish-AQ while CryptoNets uses $f(x)=x^2$. --></text> Wall-clock time (seconds) and HOPs required for inference on a single encrypted image. K denotes thousands. <text font="italic">Act</text> refers to the activation function. <text font="italic">Mid</text> denotes a combination of pool1, conv2, pool2, and fc1, as reported by <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/>]</cite>. </caption>
      </table>
      <para xml:id="S6.SS15.p1">
        <p><text font="italic"><!--  %“textbf–Layer-Wise Analysis˝. -->Faster CryptoNets</text> differs from the CryptoNets model in that we use the Swish activation instead of the square function.
While both methods use a 2<sup>nd</sup> degree polynomial of the form <Math mode="inline" tex="p(x)=a_{0}+a_{1}x+a_{2}x" text="p * x = a _ 0 + a _ 1 * x + a _ 2 * x" xml:id="S6.SS15.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S6.SS15.p1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S6.SS15.p1.m1.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, our approximations use <Math mode="inline" tex="a_{0},a_{1}\neq 0" text="list@(a _ 0, a _ 1) not-equals 0" xml:id="S6.SS15.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S6.SS15.p1.m2.1"/>
                    <XMRef idref="S6.SS15.p1.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S6.SS15.p1.m2.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S6.SS15.p1.m2.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> for increased expressivity whereas the square function set <Math mode="inline" tex="a_{0}=a_{1}=0" text="a _ 0 = a _ 1 = 0" xml:id="S6.SS15.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, resulting in fewer HOPs for the square function.
This is shown in Table <ref labelref="LABEL:table:layerwise"/><!--  %**** main.tex Line 875 **** --> in the rows Act-1 and Act-2.
Despite our method requiring more HOPs for Act-1 and Act-2, we still achieve a faster inference time than CryptoNets.
At a per-layer level, our method yields up to <Math class="ltx_math_unparsed" mode="inline" tex="16\times" xml:id="S6.SS15.p1.m4">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
              <XMTok meaning="times" role="MULOP">×</XMTok>
            </XMath>
          </Math> and <Math class="ltx_math_unparsed" mode="inline" tex="11\times" xml:id="S6.SS15.p1.m5">
            <XMath>
              <XMTok meaning="11" role="NUMBER">11</XMTok>
              <XMTok meaning="times" role="MULOP">×</XMTok>
            </XMath>
          </Math> improvements for wall-clock and HOPs, respectively.</p>
      </para>
      <para xml:id="S6.SS15.p2">
        <p>We compare the performance of different activation functions when approximated with our proposed polynomial approximation and quantization (AQ) method.
For MNIST, Swish-AQ produced a test accuracy of 99.10%, while ReLU-AQ achieves an equivalent test accuracy of 99.09%.
We note the similarity of ReLU and Swish.
This finding is corroborated by the similarity of the approximations in Figure <ref labelref="LABEL:fig:approx"/>.
The polynomial coefficients we calculate for the ReLU and Swish approximations turn out to be the same, except for a constant factor.</p>
      </para>
<!--  %Table “ref–table:activation˙times˝ in Appendix “ref–sec:further˙analysis˝ compares the training and test set accuracy of multiple activation functions with our different approximation methods. 
     %%At a first glance, the table seems to present inconclusive results.% %Take this sentence out I think% 
     %We note the similarity of ReLU and Swish, both qualitatively and quantitatively. 
     %In particular, ReLU and Swish are within one standard deviation of each other, on both the training and test set. 
     %This finding is further corroborated by the similarity of the approximations in Figure “ref–fig:approx˝. 
     %The polynomial coefficients we calculate for the ReLU and Swish approximations turn out to be the same, except for a constant factor (see Appendix “ref–sup:coef˝). -->      <para xml:id="S6.SS15.p3">
        <p><!--  %“textbf–Pruning “&amp; Quantization˝. -->We evaluate the inference quality and runtime of pruning and quantization separately.
Pruning produced a test set accuracy of 98.73% and inference time of 104.7 seconds.
Quantization produced 99.06% and 162.5 seconds.
When combined, pruning and quantization produced 98.71% and 45.7 seconds.
We record the accuracies during each INQ step for both a non-pruned network in Table <ref labelref="LABEL:table:sup_quantize1"/> and a DNS pruned network in Table <ref labelref="LABEL:table:sup_quantize2"/>.
The accuracy is largely preserved as the network is successively quantized, demonstrating consistent preservation.
Overall, accuracy was preserved, or slightly improved in the case of quantization.</p>
      </para>
      <table inlist="lot" labels="LABEL:table:sup_quantize1" placement="!htbp" xml:id="S6.T6">
        <tags>
          <tag>TABLE VI</tag>
          <tag role="refnum">VI</tag>
          <tag role="typerefnum">TABLE VI</tag>
        </tags>
<!--  %**** main.tex Line 900 **** -->        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="center" border="r tt"><text fontsize="90%">INQ Step</text></td>
            <td align="center" border="r tt"><text fontsize="90%">Partition</text></td>
            <td align="center" border="r tt"><text fontsize="90%">Quantized%</text></td>
            <td align="center" border="tt" class="ltx_nopad_r"><text fontsize="90%">Accuracy</text></td>
          </tr>
          <tr>
            <td align="center" border="r t"><text fontsize="90%">1</text></td>
            <td align="center" border="r t"><text fontsize="90%">0.7</text></td>
            <td align="center" border="r t"><text fontsize="90%">30%</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">99.00</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">2</text></td>
            <td align="center" border="r"><text fontsize="90%">0.4</text></td>
            <td align="center" border="r"><text fontsize="90%">60%</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">99.02</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">3</text></td>
            <td align="center" border="r"><text fontsize="90%">0.2</text></td>
            <td align="center" border="r"><text fontsize="90%">80%</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.99</text></td>
          </tr>
          <tr>
            <td align="center" border="bb r"><text fontsize="90%">4</text></td>
            <td align="center" border="bb r"><text fontsize="90%">0.0</text></td>
            <td align="center" border="bb r"><text fontsize="90%">100%</text></td>
            <td align="center" border="bb" class="ltx_nopad_r"><text fontsize="90%">99.06</text></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">VI</text></tag><text fontsize="90%">INQ-only quantization schedule. Accuracies collected for each Incremental Network Quantization (INQ) step are reported in the Accuracy column. In each step, a progressively larger set of the weights are partitioned and quantized, as reported in columns 2 and 3.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE VI</tag>INQ-only quantization schedule. Accuracies collected for each Incremental Network Quantization (INQ) step are reported in the Accuracy column. In each step, a progressively larger set of the weights are partitioned and quantized, as reported in columns 2 and 3.</caption>
      </table>
      <table inlist="lot" labels="LABEL:table:sup_quantize2" placement="!htbp" xml:id="S6.T7">
        <tags>
          <tag>TABLE VII</tag>
          <tag role="refnum">VII</tag>
          <tag role="typerefnum">TABLE VII</tag>
        </tags>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="center" border="r tt"><text fontsize="90%">INQ Step</text></td>
            <td align="center" border="r tt"><text fontsize="90%">Partition</text></td>
            <td align="center" border="tt" class="ltx_nopad_r"><text fontsize="90%">Accuracy</text></td>
          </tr>
          <tr>
            <td align="center" border="r t"><text fontsize="90%">1</text></td>
            <td align="center" border="r t"><text fontsize="90%">0.98</text></td>
            <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">98.74</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">2</text></td>
            <td align="center" border="r"><text fontsize="90%">0.96</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.78</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">3</text></td>
            <td align="center" border="r"><text fontsize="90%">0.94</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.69</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">4</text></td>
            <td align="center" border="r"><text fontsize="90%">0.92</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.68</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">5</text></td>
            <td align="center" border="r"><text fontsize="90%">0.90</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.69</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">6</text></td>
            <td align="center" border="r"><text fontsize="90%">0.88</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.79</text></td>
          </tr>
          <tr>
            <td align="center" border="r"><text fontsize="90%">7</text></td>
            <td align="center" border="r"><text fontsize="90%">0.86</text></td>
            <td align="center" class="ltx_nopad_r"><text fontsize="90%">98.68</text></td>
          </tr>
          <tr>
            <td align="center" border="bb r"><text fontsize="90%">8</text></td>
            <td align="center" border="bb r"><text fontsize="90%">0.00</text></td>
            <td align="center" border="bb" class="ltx_nopad_r"><text fontsize="90%">98.71</text></td>
          </tr>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">VII</text></tag><text fontsize="90%">DNS+INQ quantization schedule. Similar analysis is performed on a Dynamic Network Surgery (DNS) pruned network. Accuracies collected for each INQ step are reported in the Accuracy column, as well as the weight partitioning in the Partition column.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE VII</tag>DNS+INQ quantization schedule. Similar analysis is performed on a Dynamic Network Surgery (DNS) pruned network. Accuracies collected for each INQ step are reported in the Accuracy column, as well as the weight partitioning in the Partition column.</caption>
      </table>
<!--  %Additionally, we found that our strategies for reducing the inference time were less effective on the simplified architecture proposed in CryptoNets due to the combination of the intermediate layers, which reduced the sparsity achieved in individual layers. -->    </subsection>
  </section>
  <section inlist="toc" xml:id="S7">
    <tags>
      <tag>VII</tag>
      <tag role="refnum">VII</tag>
      <tag role="typerefnum">§VII</tag>
    </tags>
    <title><tag close=" ">VII</tag><text font="smallcaps">Experimental Correctness</text></title>
    <para xml:id="S7.p1">
      <p>We make sure our parameters are selected properly so that our decrypted outputs are correct. We run encrypted inference on the 10,000 image MNIST test-set, and find no accuracy loss from our method’s plaintext results (98.71%). We also find an precision error of around 0.05% when comparing the plaintext and decrypted outputs. Upon further examination, we found that his error is introduced during the floating point to fixed point conversion prior to the encoding scheme, and that this error does not effect the accuracy of our model.</p>
    </para>
  </section>
  <section inlist="toc" labels="LABEL:sec:scaling_up" xml:id="S8">
    <tags>
      <tag>VIII</tag>
      <tag role="refnum">VIII</tag>
      <tag role="typerefnum">§VIII</tag>
    </tags>
    <title><tag close=" ">VIII</tag><text font="smallcaps">Scaling up</text></title>
    <para xml:id="S8.p1">
      <p>To evaluate how well our method works in real-world settings, we implement our techniques on larger datasets. First, we focus on CIFAR-10 as a larger practical image classification task. Next, we consider diabetic retinopathy dataset as a real-world medical imaging use-case where very deep neural networks would be used in practice.
For both experiments, we upgrade our machines to n1-megamem-96 instances offered by the Google Cloud Platform, which each have 96 Intel Skylake 2.0 GHz vCPUs and 1433.6 GB RAM.</p>
    </para>
    <subsection inlist="toc" xml:id="S8.SS1">
      <tags>
        <tag>VIII-A</tag>
        <tag role="refnum">VIII-A</tag>
        <tag role="typerefnum">§VIII-A</tag>
      </tags>
      <title><tag close=" ">VIII-A</tag><text font="italic">FV-RNS Parameters</text></title>
      <para xml:id="S8.SS1.p1">
        <p>We use a ring dimension <Math mode="inline" tex="n=8192" text="n = 8192" xml:id="S8.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok meaning="8192" role="NUMBER">8192</XMTok>
              </XMApp>
            </XMath>
          </Math> with fifteen plaintext moduli <Math mode="inline" tex="t^{(j)}" text="t ^ j" xml:id="S8.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMDual>
                  <XMRef idref="S8.SS1.p1.m2.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S8.SS1.p1.m2.1">j</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>: 40961, 65537, 114689, 147457, 188417, 270337, 286721, 319489, 417793, 557057, 638977, 737281, 778241, 786433, 925697. The values of the coefficient moduli <Math mode="inline" tex="q^{(j)}" text="q ^ j" xml:id="S8.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMDual>
                  <XMRef idref="S8.SS1.p1.m3.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S8.SS1.p1.m3.1">j</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> are selected to provide 128-bit security, such that <Math mode="inline" tex="\log q^{(j)}=219" text="logarithm@(q ^ j) = 219" xml:id="S8.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMDual>
                      <XMRef idref="S8.SS1.p1.m4.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S8.SS1.p1.m4.1">j</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
                <XMTok meaning="219" role="NUMBER">219</XMTok>
              </XMApp>
            </XMath>
          </Math>. Furthermore, each coefficient modulus <Math mode="inline" tex="q^{(j)}" text="q ^ j" xml:id="S8.SS1.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMDual>
                  <XMRef idref="S8.SS1.p1.m5.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S8.SS1.p1.m5.1">j</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is decomposed into four 64-bit moduli for efficient use of the RNS variant of the FV encryption scheme.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S9">
    <tags>
      <tag>IX</tag>
      <tag role="refnum">IX</tag>
      <tag role="typerefnum">§IX</tag>
    </tags>
    <title><tag close=" ">IX</tag><text font="smallcaps">CIFAR-10</text></title>
    <para xml:id="S9.p1">
      <p>MNIST is a relatively easy dataset, with simple machine learning algorithms like linear regression or KNN producing high accuracy results <cite class="ltx_citemacro_cite">[<bibref bibrefs="toghi2018mnistknn" separator="," yyseparator=","/>]</cite>. CIFAR-10 <cite class="ltx_citemacro_cite">[<bibref bibrefs="cifar10" separator="," yyseparator=","/>]</cite> is a more complicated task where CNN’s perform notably better than other methods.
We evaluated the CIFAR-10 performance of our method on the model used in CryptoDL <cite class="ltx_citemacro_cite">[<bibref bibrefs="hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite>, consisting of eight convolutional layers, which from now on we will denote as CNN-8.</p>
    </para>
    <table inlist="lot" labels="LABEL:table:activation_times_cifar" placement="!htbp" xml:id="S9.T8">
      <tags>
        <tag>TABLE VIII</tag>
        <tag role="refnum">VIII</tag>
        <tag role="typerefnum">TABLE VIII</tag>
      </tags>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="r tt"><text fontsize="90%">Activation</text></td>
          <td align="center" border="r tt"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCIFAR-10 Train Acc.</text></td>
          <td align="center" border="r tt"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCIFAR-10 Test Acc.</text></td>
        </tr>
        <tr>
          <td align="left" border="r t"><text fontsize="90%">ReLU</text></td>
          <td align="center" border="r t"><Math mode="inline" tex="\mathbf{93.10}" text="93.10" xml:id="S9.T8.m1">
              <XMath>
                <XMTok font="bold" fontsize="90%" meaning="93.10" role="NUMBER">93.10</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r t"><Math mode="inline" tex="\mathbf{86.76}" text="86.76" xml:id="S9.T8.m2">
              <XMath>
                <XMTok font="bold" fontsize="90%" meaning="86.76" role="NUMBER">86.76</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Square</text></td>
          <td align="center" border="r"><Math mode="inline" tex="59.97" text="59.97" xml:id="S9.T8.m3">
              <XMath>
                <XMTok fontsize="90%" meaning="59.97" role="NUMBER">59.97</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r"><Math mode="inline" tex="59.88" text="59.88" xml:id="S9.T8.m4">
              <XMath>
                <XMTok fontsize="90%" meaning="59.88" role="NUMBER">59.88</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Softplus</text></td>
          <td align="center" border="r"><Math mode="inline" tex="67.96" text="67.96" xml:id="S9.T8.m5">
              <XMath>
                <XMTok fontsize="90%" meaning="67.96" role="NUMBER">67.96</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r"><Math mode="inline" tex="67.94" text="67.94" xml:id="S9.T8.m6">
              <XMath>
                <XMTok fontsize="90%" meaning="67.94" role="NUMBER">67.94</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Swish</text></td>
          <td align="center" border="r"><Math mode="inline" tex="91.55" text="91.55" xml:id="S9.T8.m7">
              <XMath>
                <XMTok fontsize="90%" meaning="91.55" role="NUMBER">91.55</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r"><Math mode="inline" tex="86.24" text="86.24" xml:id="S9.T8.m8">
              <XMath>
                <XMTok fontsize="90%" meaning="86.24" role="NUMBER">86.24</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r t"><text fontsize="90%">ReLU-A</text></td>
          <td align="center" border="r t"><Math mode="inline" tex="\mathbf{77.95}" text="77.95" xml:id="S9.T8.m9">
              <XMath>
                <XMTok font="bold" fontsize="90%" meaning="77.95" role="NUMBER">77.95</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r t"><Math mode="inline" tex="\mathbf{75.99}" text="75.99" xml:id="S9.T8.m10">
              <XMath>
                <XMTok font="bold" fontsize="90%" meaning="75.99" role="NUMBER">75.99</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Softplus-A</text></td>
          <td align="center" border="r"><Math mode="inline" tex="75.11" text="75.11" xml:id="S9.T8.m11">
              <XMath>
                <XMTok fontsize="90%" meaning="75.11" role="NUMBER">75.11</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r"><Math mode="inline" tex="73.57" text="73.57" xml:id="S9.T8.m12">
              <XMath>
                <XMTok fontsize="90%" meaning="73.57" role="NUMBER">73.57</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Swish-A</text></td>
          <td align="center" border="r"><Math mode="inline" tex="77.30" text="77.30" xml:id="S9.T8.m13">
              <XMath>
                <XMTok fontsize="90%" meaning="77.30" role="NUMBER">77.30</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r"><Math mode="inline" tex="75.41" text="75.41" xml:id="S9.T8.m14">
              <XMath>
                <XMTok fontsize="90%" meaning="75.41" role="NUMBER">75.41</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r t"><text fontsize="90%">ReLU-AQ</text></td>
          <td align="center" border="r t"><Math mode="inline" tex="77.95" text="77.95" xml:id="S9.T8.m15">
              <XMath>
                <XMTok fontsize="90%" meaning="77.95" role="NUMBER">77.95</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r t"><Math mode="inline" tex="\mathbf{75.99}" text="75.99" xml:id="S9.T8.m16">
              <XMath>
                <XMTok font="bold" fontsize="90%" meaning="75.99" role="NUMBER">75.99</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Softplus-AQ</text></td>
          <td align="center" border="r"><Math mode="inline" tex="72.67" text="72.67" xml:id="S9.T8.m17">
              <XMath>
                <XMTok fontsize="90%" meaning="72.67" role="NUMBER">72.67</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="r"><Math mode="inline" tex="71.58" text="71.58" xml:id="S9.T8.m18">
              <XMath>
                <XMTok fontsize="90%" meaning="71.58" role="NUMBER">71.58</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="left" border="bb r"><text fontsize="90%">Swish-AQ</text></td>
          <td align="center" border="bb r"><Math mode="inline" tex="\mathbf{78.20}" text="78.20" xml:id="S9.T8.m19">
              <XMath>
                <XMTok font="bold" fontsize="90%" meaning="78.20" role="NUMBER">78.20</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="bb r"><Math mode="inline" tex="75.66" text="75.66" xml:id="S9.T8.m20">
              <XMath>
                <XMTok fontsize="90%" meaning="75.66" role="NUMBER">75.66</XMTok>
              </XMath>
            </Math></td>
        </tr>
      </tabular>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">VIII</text></tag><text fontsize="90%">Approximation results. Minimax approximation is denoted by </text><text font="italic" fontsize="90%">A</text><text fontsize="90%"> and polynomial approximation with quantized coefficients is </text><text font="italic" fontsize="90%">AQ</text><text fontsize="90%"> (our method). The training accuracy and test accuracy are shown for CIFAR-10.</text></toccaption>
      <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE VIII</tag>Approximation results. Minimax approximation is denoted by <text font="italic">A</text> and polynomial approximation with quantized coefficients is <text font="italic">AQ</text> (our method). The training accuracy and test accuracy are shown for CIFAR-10.</caption>
    </table>
    <table inlist="lot" labels="LABEL:table:sup_hops_cryptodl2" placement="!htbp" xml:id="S9.T9">
      <tags>
        <tag>TABLE IX</tag>
        <tag role="refnum">IX</tag>
        <tag role="typerefnum">TABLE IX</tag>
      </tags>
<!--  %**** main.tex Line 975 **** -->      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="r tt"><text fontsize="90%">Layer</text></td>
          <td align="right" border="tt"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmPT-CT</text></td>
          <td border="tt"/>
          <td border="tt"/>
          <td border="tt"/>
        </tr>
        <tr>
          <td align="left"><text fontsize="90%">Adds</text></td>
          <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCT-CT</text></td>
          <td/>
          <td/>
          <td/>
        </tr>
        <tr>
          <td align="left"><text fontsize="90%">Adds</text></td>
          <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmPT-CT</text></td>
          <td/>
          <td/>
          <td/>
        </tr>
        <tr>
          <td align="left"><text fontsize="90%">Mults</text></td>
          <td align="right"><ERROR class="undefined">\pbox</ERROR><text fontsize="90%">20cmCT-CT</text></td>
          <td/>
          <td/>
          <td/>
        </tr>
        <tr>
          <td align="left"><text fontsize="90%">Mults</text></td>
          <td/>
          <td/>
          <td/>
          <td/>
        </tr>
        <tr>
          <td align="left" border="r t"><text fontsize="90%">Conv-1</text></td>
          <td align="center" border="r t"><text fontsize="90%">36,864</text></td>
          <td align="center" border="r t"><text fontsize="90%">460,800</text></td>
          <td align="center" border="r t"><text fontsize="90%">479,232</text></td>
          <td align="center" border="t" class="ltx_nopad_r"><text fontsize="90%">0</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Conv-2</text></td>
          <td align="center" border="r"><text fontsize="90%">36,864</text></td>
          <td align="center" border="r"><text fontsize="90%">13,294,908</text></td>
          <td align="center" border="r"><text fontsize="90%">13,313,340</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Activ-1</text></td>
          <td align="center" border="r"><text fontsize="90%">18,432</text></td>
          <td align="center" border="r"><text fontsize="90%">36,864</text></td>
          <td align="center" border="r"><text fontsize="90%">55,296</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">36,864</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Pool-1</text></td>
          <td align="center" border="r"><text fontsize="90%">—</text></td>
          <td align="center" border="r"><text fontsize="90%">18,432</text></td>
          <td align="center" border="r"><text fontsize="90%">—</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Conv-3</text></td>
          <td align="center" border="r"><text fontsize="90%">18,432</text></td>
          <td align="center" border="r"><text fontsize="90%">5,968,347</text></td>
          <td align="center" border="r"><text fontsize="90%">5,977,563</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">0</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Conv-4</text></td>
          <td align="center" border="r"><text fontsize="90%">18,432</text></td>
          <td align="center" border="r"><text fontsize="90%">11,931,014</text></td>
          <td align="center" border="r"><text fontsize="90%">11,940,230</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Activ-2</text></td>
          <td align="center" border="r"><text fontsize="90%">9216</text></td>
          <td align="center" border="r"><text fontsize="90%">18,432</text></td>
          <td align="center" border="r"><text fontsize="90%">27,648</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">18,432</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Pool-2</text></td>
          <td align="center" border="r"><text fontsize="90%">0</text></td>
          <td align="center" border="r"><text fontsize="90%">9216</text></td>
          <td align="center" border="r"><text fontsize="90%">—</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Conv-5</text></td>
          <td align="center" border="r"><text fontsize="90%">9216</text></td>
          <td align="center" border="r"><text fontsize="90%">4,713,389</text></td>
          <td align="center" border="r"><text fontsize="90%">4,717,997</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">0</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Conv-6</text></td>
          <td align="center" border="r"><text fontsize="90%">9,216</text></td>
          <td align="center" border="r"><text fontsize="90%">9,421,992</text></td>
          <td align="center" border="r"><text fontsize="90%">9,426,600</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">0</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Activ-3</text></td>
          <td align="center" border="r"><text fontsize="90%">4,608</text></td>
          <td align="center" border="r"><text fontsize="90%">9,216</text></td>
          <td align="center" border="r"><text fontsize="90%">13,824</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">9,216</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">Pool-3</text></td>
          <td align="center" border="r"><text fontsize="90%">—</text></td>
          <td align="center" border="r"><text fontsize="90%">4,608</text></td>
          <td align="center" border="r"><text fontsize="90%">—</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">FC-1</text></td>
          <td align="center" border="r"><text fontsize="90%">256</text></td>
          <td align="center" border="r"><text fontsize="90%">29,4644</text></td>
          <td align="center" border="r"><text fontsize="90%">294,644</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">—</text></td>
        </tr>
        <tr>
          <td align="left" border="r"><text fontsize="90%">FC-2</text></td>
          <td align="center" border="r"><text fontsize="90%">10</text></td>
          <td align="center" border="r"><text fontsize="90%">2560</text></td>
          <td align="center" border="r"><text fontsize="90%">2,560</text></td>
          <td align="center" class="ltx_nopad_r"><text fontsize="90%">0</text></td>
        </tr>
        <tr>
          <td align="left" border="bb r t"><text fontsize="90%">Total</text></td>
          <td align="center" border="bb r t"><text fontsize="90%">161,546</text></td>
          <td align="center" border="bb r t"><text fontsize="90%">46,184,422</text></td>
          <td align="center" border="bb r t"><text fontsize="90%">46,248,934</text></td>
          <td align="center" border="bb t" class="ltx_nopad_r"><text fontsize="90%">64,512</text></td>
        </tr>
      </tabular>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">IX</text></tag><text fontsize="90%">CNN-8 HOPs. More detailed breakdown of HOPS for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. </text><text font="italic" fontsize="90%">Adds</text><text fontsize="90%"> and </text><text font="italic" fontsize="90%">mults</text><text fontsize="90%"> refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.</text></toccaption>
      <caption class="ltx_centering" fontsize="90%"><tag close=": ">TABLE IX</tag>CNN-8 HOPs. More detailed breakdown of HOPS for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. <text font="italic">Adds</text> and <text font="italic">mults</text> refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.</caption>
    </table>
    <subsection inlist="toc" xml:id="S9.SS1">
      <tags>
        <tag>IX-A</tag>
        <tag role="refnum">IX-A</tag>
        <tag role="typerefnum">§IX-A</tag>
      </tags>
      <title><tag close=" ">IX-A</tag><text font="italic">Activation Comparisons</text></title>
      <para xml:id="S9.SS1.p1">
        <p>We present Table <ref labelref="LABEL:table:activation_times_cifar"/> which contains accuracy values for all the layers and all of the activation functions.
Activation layers we considered include ReLU, square, Swish, and softplus, using the original function, approximated function, and quantized approximation function.
In Table <ref labelref="LABEL:table:activation_times_cifar"/>, we can see that training this model with the square activation function resulted in significantly worse test accuracy (59.88%) compared to training this model with the ReLU activation function (86.76%), confirming the theoretical loss of accuracy from instability of the square function for deeper neural networks.
Furthermore, we find that ReLU-AQ and Swish-AQ offer comparable levels of performance (77.95% and 78.20% training accuracy, 75.99% and 75.66% test accuracy), while significantly improving on the accuracy results that were achieved with the square activation function.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S9.SS2">
      <tags>
        <tag>IX-B</tag>
        <tag role="refnum">IX-B</tag>
        <tag role="typerefnum">§IX-B</tag>
      </tags>
      <title><tag close=" ">IX-B</tag><text font="italic">Pruning and Quantization</text></title>
      <para xml:id="S9.SS2.p1">
        <p>The pruning and quantization procedure results in a model with slightly improved accuracy (76.72%) that requires an order of magnitude fewer HOPS for inference (<Math mode="inline" tex="6.12\times 10^{8}" text="6.12 * 10 ^ 8" xml:id="S9.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="6.12" role="NUMBER">6.12</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="8" role="NUMBER">8</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> HOPs vs. <Math mode="inline" tex="6.47\times 10^{9}" text="6.47 * 10 ^ 9" xml:id="S9.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="6.47" role="NUMBER">6.47</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="9" role="NUMBER">9</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> HOPs for the baseline method).
The inference time for the model was 22,372 seconds with our method.</p>
      </para>
<!--  %Our optimization technique results in performance improvements that scale up linearly with network size (don’t know if this statement is entirely true..). -->    </subsection>
    <subsection inlist="toc" xml:id="S9.SS3">
      <tags>
        <tag>IX-C</tag>
        <tag role="refnum">IX-C</tag>
        <tag role="typerefnum">§IX-C</tag>
      </tags>
      <title><tag close=" ">IX-C</tag><text font="italic">Message Size</text></title>
      <para xml:id="S9.SS3.p1">
        <p>The message size for the input image is <Math mode="inline" tex="32\times 32\times 3\times 65544\times 8" text="32 * 32 * 3 * 65544 * 8" xml:id="S9.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="32" role="NUMBER">32</XMTok>
                <XMTok meaning="32" role="NUMBER">32</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
                <XMTok meaning="65544" role="NUMBER">65544</XMTok>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMath>
          </Math> bytes, or 1,610.8 MB.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S10">
    <tags>
      <tag>X</tag>
      <tag role="refnum">X</tag>
      <tag role="typerefnum">§X</tag>
    </tags>
    <title><tag close=" ">X</tag><text font="smallcaps">Medical Imaging</text></title>
    <figure inlist="lof" labels="LABEL:fig:method" placement="!htbp" xml:id="S10.F4">
      <tags>
        <tag>Figure 4</tag>
        <tag role="refnum">4</tag>
        <tag role="typerefnum">Figure 4</tag>
      </tags>
      <graphics candidates="figures/method_figure_v2.png" class="ltx_centering" graphic="figures/method_figure_v2.png" options="width=397.48499pt,keepaspectratio=true" xml:id="S10.F4.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">4</tag>Illustration of our proposed method for encrypted inference on retinal fundus images. The cloud provider delegates the computation of the pretrained layers of the neural network to the end-user and evaluates the task-specific layers using the homomorphic encryption scheme. The output of the network is returned in encrypted form to the end-user, who can decrypt to determine the prediction of the severity of diabetic retinopathy.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 4</tag>Illustration of our proposed method for encrypted inference on retinal fundus images. The cloud provider delegates the computation of the pretrained layers of the neural network to the end-user and evaluates the task-specific layers using the homomorphic encryption scheme. The output of the network is returned in encrypted form to the end-user, who can decrypt to determine the prediction of the severity of diabetic retinopathy.</caption>
    </figure>
    <table inlist="lot" labels="LABEL:tab:accuracy_results" placement="!htbp" xml:id="S10.T10">
      <tags>
        <tag>TABLE X</tag>
        <tag role="refnum">X</tag>
        <tag role="typerefnum">TABLE X</tag>
      </tags>
<!--  %**** main.tex Line 1025 **** -->      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="center" border="l r t"><text fontsize="80%">Model</text></td>
          <td align="center" border="r t"><text fontsize="80%">Layers Retrained</text></td>
          <td align="center" border="r t"><text fontsize="80%">Test Accuracy</text></td>
        </tr>
        <tr>
          <td align="center" border="l r t"><text fontsize="80%">CNN-8</text></td>
          <td align="center" border="r t"><text fontsize="80%">All Layers</text></td>
          <td align="center" border="r t"><text fontsize="80%">63.23</text></td>
        </tr>
        <tr>
          <td align="center" border="l r"><text fontsize="80%">DFE-RN-50</text></td>
          <td align="center" border="r"><text fontsize="80%">Top Block</text></td>
          <td align="center" border="r"><text fontsize="80%">69.89</text></td>
        </tr>
        <tr>
          <td align="center" border="l r"><text fontsize="80%">DP-DFE-RN-50</text></td>
          <td align="center" border="r"><text fontsize="80%">All layers (with DP)</text></td>
          <td align="center" border="r"><text fontsize="80%">76.47</text></td>
        </tr>
        <tr>
          <td align="center" border="b l r"><text fontsize="80%">ResNet-50</text></td>
          <td align="center" border="b r"><text fontsize="80%">All Layers</text></td>
          <td align="center" border="b r"><Math mode="inline" tex="\mathbf{80.61}" text="80.61" xml:id="S10.T10.m1">
              <XMath>
                <XMTok font="bold" fontsize="80%" meaning="80.61" role="NUMBER">80.61</XMTok>
              </XMath>
            </Math></td>
        </tr>
      </tabular>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">X</text></tag><text fontsize="80%">Accuracies and layers trained of each model. RN denotes ResNet, DFE denotes delegated feature extraction, and DP denotes differentially private. A ResNet-50 model is trained in a standard setting for benchmarking. We observe that DFE-RN-50 has significantly higher accuracy than the baseline CNN model and that DP-DFE-RN-50 further increases the test accuracy close to a plain ResNet-50 model. </text></toccaption>
      <caption class="ltx_centering" fontsize="80%"><tag close=": ">TABLE X</tag>Accuracies and layers trained of each model. RN denotes ResNet, DFE denotes delegated feature extraction, and DP denotes differentially private. A ResNet-50 model is trained in a standard setting for benchmarking. We observe that DFE-RN-50 has significantly higher accuracy than the baseline CNN model and that DP-DFE-RN-50 further increases the test accuracy close to a plain ResNet-50 model. </caption>
    </table>
    <table inlist="lot" labels="LABEL:tab:performance_results" placement="!htbp" xml:id="S10.T11">
      <tags>
        <tag>TABLE XI</tag>
        <tag role="refnum">XI</tag>
        <tag role="typerefnum">TABLE XI</tag>
      </tags>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="center" border="l r t"><text fontsize="80%">Model</text></td>
          <td align="center" border="r t"><text fontsize="80%">Accuracy</text></td>
          <td align="center" border="r t"><text fontsize="80%">HOPs</text></td>
          <td align="center" border="r t"><text fontsize="80%">Runtime (s)</text></td>
        </tr>
        <tr>
          <td align="center" border="l r t"><text fontsize="80%">CNN-8 (sparse)</text></td>
          <td align="center" border="r t"><text fontsize="80%">63.23</text></td>
          <td align="center" border="r t"><text fontsize="80%">1.33E8</text></td>
          <td align="center" border="r t"><text fontsize="80%">3325</text></td>
        </tr>
        <tr>
          <td align="center" border="l r"><text fontsize="80%">DP-DFE-RN-50</text></td>
          <td align="center" border="r"><text fontsize="80%">76.04</text></td>
          <td align="center" border="r"><text fontsize="80%">3.95E8</text></td>
          <td align="center" border="r"><Math mode="inline" tex="12493" text="12493" xml:id="S10.T11.m1">
              <XMath>
                <XMTok fontsize="80%" meaning="12493" role="NUMBER">12493</XMTok>
              </XMath>
            </Math></td>
        </tr>
        <tr>
          <td align="center" border="b l r"><text fontsize="80%">DP-DFE-RN-50 (sparse)</text></td>
          <td align="center" border="b r"><Math mode="inline" tex="\mathbf{76.47}" text="76.47" xml:id="S10.T11.m2">
              <XMath>
                <XMTok font="bold" fontsize="80%" meaning="76.47" role="NUMBER">76.47</XMTok>
              </XMath>
            </Math></td>
          <td align="center" border="b r"><Math mode="inline" tex="\mathbf{4.23E7}" text="4.23 * E7" xml:id="S10.T11.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="bold" fontsize="80%" meaning="4.23" role="NUMBER">4.23</XMTok>
                  <XMTok font="bold" fontsize="80%" role="UNKNOWN">E7</XMTok>
                </XMApp>
              </XMath>
            </Math></td>
          <td align="center" border="b r"><Math mode="inline" tex="\mathbf{1590}" text="1590" xml:id="S10.T11.m4">
              <XMath>
                <XMTok font="bold" fontsize="80%" meaning="1590" role="NUMBER">1590</XMTok>
              </XMath>
            </Math></td>
        </tr>
      </tabular>
<!--  %**** main.tex Line 1050 **** -->      <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">XI</text></tag><text fontsize="80%">Comparison of performance metrics for transfer learning vs. fully-trained models. We show that our privacy-safe delegated feature extraction model results in both higher accuracy and fewer HOPs/runtime, and also show that our sparsity techniques maintains high accuracy.</text></toccaption>
      <caption class="ltx_centering" fontsize="80%"><tag close=": ">TABLE XI</tag>Comparison of performance metrics for transfer learning vs. fully-trained models. We show that our privacy-safe delegated feature extraction model results in both higher accuracy and fewer HOPs/runtime, and also show that our sparsity techniques maintains high accuracy.</caption>
    </table>
    <table inlist="lot" labels="LABEL:tab:ablation_study" placement="!htbp" xml:id="S10.T12">
      <tags>
        <tag>TABLE XII</tag>
        <tag role="refnum">XII</tag>
        <tag role="typerefnum">TABLE XII</tag>
      </tags>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="center" border="l r t">Method</td>
          <td align="center" border="r t">Acc.</td>
          <td align="center" border="r t">HOPs</td>
          <td align="right" border="t"><ERROR class="undefined">\pbox</ERROR>20cmInference</td>
          <td border="t"/>
        </tr>
        <tr>
          <td align="right" border="l">Time (s)</td>
          <td align="center" border="r">Speedup</td>
          <td/>
          <td/>
          <td/>
        </tr>
        <tr>
          <td align="center" border="l r t">Original</td>
          <td align="center" border="r t">70.47</td>
          <td align="center" border="r t"><Math mode="inline" tex="3.95\times 10^{8}" text="3.95 * 10 ^ 8" xml:id="S10.T12.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="3.95" role="NUMBER">3.95</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMTok fontsize="70%" meaning="8" role="NUMBER">8</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></td>
          <td align="center" border="r t">12493</td>
          <td align="center" border="r t">–</td>
        </tr>
        <tr>
          <td align="center" border="l r">Pruned</td>
          <td align="center" border="r"><text font="bold">70.98</text></td>
          <td align="center" border="r"><Math mode="inline" tex="\mathbf{4.23\times 10^{7}}" text="4.23 * 10 ^ 7" xml:id="S10.T12.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok font="bold" meaning="4.23" role="NUMBER">4.23</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="bold" meaning="10" role="NUMBER">10</XMTok>
                    <XMTok font="bold" fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></td>
          <td align="center" border="r">1924</td>
          <td align="center" border="r">6.4x</td>
        </tr>
        <tr>
          <td align="center" border="b l r"><ERROR class="undefined">\pbox</ERROR>20cmPruned/Quantized</td>
          <td align="center" border="b r">70.55</td>
          <td align="center" border="b r"><Math mode="inline" tex="\mathbf{4.23\times 10^{7}}" text="4.23 * 10 ^ 7" xml:id="S10.T12.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok font="bold" meaning="4.23" role="NUMBER">4.23</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="bold" meaning="10" role="NUMBER">10</XMTok>
                    <XMTok font="bold" fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></td>
          <td align="center" border="b r"><text font="bold">1590</text></td>
          <td align="center" border="b r"><text font="bold">7.8x</text></td>
        </tr>
      </tabular>
      <toccaption class="ltx_centering"><tag close=" ">XII</tag>Ablation study of methods for improving performance of DFE-ResNet-152</toccaption>
      <caption class="ltx_centering"><tag close=": ">TABLE XII</tag>Ablation study of methods for improving performance of DFE-ResNet-152</caption>
    </table>
<!--  %DFE-RN-50  &amp; 69.89 &amp; $“mathbf–4.23E7˝$ &amp; $12493$ ““ 
     %DFE-RN-50 (sparse) &amp; $“mathbf–69.99˝$ &amp; $“mathbf–4.23E7˝$ &amp; $“mathbf–1590˝$ ““ -->    <figure inlist="lof" labels="LABEL:fig:data_example" placement="!htbp" xml:id="S10.F5">
      <tags>
        <tag>Figure 5</tag>
        <tag role="refnum">5</tag>
        <tag role="typerefnum">Figure 5</tag>
      </tags>
      <graphics candidates="figures/preprocess.png" class="ltx_centering ltx_figure_panel" graphic="figures/preprocess.png" options="width=108.405pt,keepaspectratio=true" xml:id="S10.F5.g1"/>
      <graphics candidates="figures/postprocess.png" class="ltx_centering ltx_figure_panel" graphic="figures/postprocess.png" options="width=108.405pt,keepaspectratio=true" xml:id="S10.F5.g2"/>
      <toccaption class="ltx_centering"><tag close=" "><!--  %**** main.tex Line 1075 **** -->5<!--  %**** main.tex Line 1075 **** 
     %**** main.tex Line 1075 **** 
     %**** main.tex Line 1075 **** 
     %**** main.tex Line 1075 **** 
     %**** main.tex Line 1075 **** --></tag><!--  %**** main.tex Line 1075 **** -->Illustration of retinal fundus image, graded with ‘none’ rating for diabetic retinopathy. The right image shows the result of the procedure for preprocessing.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 5</tag><!--  %**** main.tex Line 1075 **** 
     %**** main.tex Line 1075 **** -->Illustration of retinal fundus image, graded with ‘none’ rating for diabetic retinopathy. The right image shows the result of the procedure for preprocessing.<!--  %**** main.tex Line 1075 **** 
     %**** main.tex Line 1075 **** --></caption>
    </figure>
    <para xml:id="S10.p1">
      <p>A significant limiting factor in levelled encryption schemes used with neural networks is multiplicative depth, where only set amount of HE operations can be performed sequentially.
Increasing the multiplicative depth by choosing larger parameters incurs prohibitive cost, limiting us to neural networks with three activation functions with our current settings.
However, state-of-the-art real world applications for deep learning like medical imaging applications commonly use modern very deep neural networks.
To mitigate this issue, we propose the use of models trained with transfer learning, where the computations involved in the pretrained layers of the model can be delegated to the client, and encryption is applied only for the evaluation of the fine-tuned layers on the server.
Using this technique, which we call <text font="italic">Delegated Feature Extraction</text> (DFE), as well as <text font="italic">Faster CryptoNet</text> optimizations to speed up the computation, we achieve practical runtimes for large input sizes. An illustration of our technique is provided in Figure <ref labelref="LABEL:fig:method"/>.
We show how this technique can be improved with private training, demonstrating a viable framework where private, efficient, and powerful machine learning services can be provided.</p>
    </para>
<!--  %We use retinal images “cite–gulshan2016development˝ resized to $224 “times 224 “times 3$ and labels modified for binary classification. -->    <subsection inlist="toc" xml:id="S10.SS1">
      <tags>
        <tag>X-A</tag>
        <tag role="refnum">X-A</tag>
        <tag role="typerefnum">§X-A</tag>
      </tags>
      <title><tag close=" ">X-A</tag><text font="italic">Data</text></title>
      <para xml:id="S10.SS1.p1">
        <p>We chose the diabetic retinopathy dataset introduced by <cite class="ltx_citemacro_cite">[<bibref bibrefs="gulshan2016development" separator="," yyseparator=","/>]</cite> both for its clinical impact and the privacy-sensitive nature of retinal data. The dataset consists of macula-centered retinal fundus images primarily sourced from EyePACS and was graded by 54 opthalmologists or opthalmologist trainees using the International Clinical Diabetic Retinopathy scale <cite class="ltx_citemacro_cite">[<bibref bibrefs="severityscale" separator="," yyseparator=","/>]</cite> into ‘none’, ‘mild’, ‘moderate’, ‘severe’, or ‘proliferative’ ratings for the severity of the condition.</p>
      </para>
      <para xml:id="S10.SS1.p2">
        <p>We were able to obtain a subset of around 35,126 images of the dataset, with a label distribution of 25,810 ‘none’, 2,443 ‘mild’, 5,292 ‘moderate’, 873 ‘severe’, and 708 ‘proliferative’ diagnoses. Scans from both the left and right eye were sourced from each patient. To compare our results to the replication study performed by <cite class="ltx_citemacro_cite">[<bibref bibrefs="replicationstudy" separator="," yyseparator=","/>]</cite>, we group the ‘none’ and ‘mild’ labels to a ‘0’ label and the ‘moderate’, ‘severe’, and ‘proliferative’ labels to a ‘1’ label to reframe our problem into a binary classification task. We randomly subsampled our dataset to get an even split between our two labels, and following the guidelines recommended by <cite class="ltx_citemacro_cite">[<bibref bibrefs="gulshan2016development" separator="," yyseparator=","/>]</cite> we use an 80-20 split for training and test data.</p>
      </para>
      <para xml:id="S10.SS1.p3">
        <p>Before using the retinal images with our network, we perform some preprocessing on the raw images. The scans are scaled to <Math mode="inline" tex="224\times 224\times 3" text="224 * 224 * 3" xml:id="S10.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math>, the standard ImageNet input size, with cropping performed using edge detection to reframe the images. To normalize the colors and lighting, each image is subtracted by the local average color of each image, after which the local average is mapped to grayscale. Random rotation is performed on the image to make the model invariant to left/right eye positioning and for general augmentation. Samples of the data we use are provided in Figure <ref labelref="LABEL:fig:data_example"/>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS2">
      <tags>
        <tag>X-B</tag>
        <tag role="refnum">X-B</tag>
        <tag role="typerefnum">§X-B</tag>
      </tags>
      <title><tag close=" ">X-B</tag><text font="italic">Transfer Learning</text></title>
      <para xml:id="S10.SS2.p1">
        <p>Transfer learning is a useful way to learn an accurate model with limited data <cite class="ltx_citemacro_cite">[<bibref bibrefs="bengio2012deep" separator="," yyseparator=","/>]</cite>, and requires retraining (fine-tuning) of only a few of the layers of the network rather than training a full network from scratch <cite class="ltx_citemacro_cite">[<bibref bibrefs="hinton2006reducing" separator="," yyseparator=","/>]</cite>. The base layers are commonly trained on ImageNet <cite class="ltx_citemacro_cite">[<bibref bibrefs="deng2009imagenet,russakovsky2015imagenet" separator="," yyseparator=","/>]</cite>, and the final layers are retrained on a specific proprietary dataset. This practice is common in the healthcare setting, where large datasets are expensive to acquire and transfer learning can simplify and/or improve the training of the model, especially when using Machine Learning as a Service (MLaaS) offerings from cloud computing providers to expedite development of the application <cite class="ltx_citemacro_cite">[<bibref bibrefs="tajbakhsh2016convolutional,greenspan2016guest" separator="," yyseparator=","/>]</cite>. As we describe in more detail in our methods section, we can leverage transfer learning such that only a small number of fine-tuned layers of the network require evaluation under the encryption scheme, while the generic feature extraction of the base network layers is delegated to the client.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS3">
      <tags>
        <tag>X-C</tag>
        <tag role="refnum">X-C</tag>
        <tag role="typerefnum">§X-C</tag>
      </tags>
      <title><tag close=" ">X-C</tag><text font="italic">Network Architectures</text></title>
      <para xml:id="S10.SS3.p1">
        <p>We first implement a baseline model to train on the retinal dataset. Our baseline model (CNN-8) resembles the CNN network architecture presented in <cite class="ltx_citemacro_cite">[<bibref bibrefs="hesamifard2017cryptodl" separator="," yyseparator=","/>]</cite> for CIFAR-10, but is designed to support the larger input image sizes (scaled from <Math mode="inline" tex="32\times 32\times 3" text="32 * 32 * 3" xml:id="S10.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="32" role="NUMBER">32</XMTok>
                <XMTok meaning="32" role="NUMBER">32</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> to <Math mode="inline" tex="224\times 224\times 3" text="224 * 224 * 3" xml:id="S10.SS3.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> input). It leverages an identical multiplicative depth budget to our transfer learning models in realizing the privacy guarantees. In particular, it contains eight convolutional layers and three approximate activation functions.</p>
      </para>
      <para xml:id="S10.SS3.p2">
        <p><!--  %**** main.tex Line 1100 **** -->Modern deep neural networks like ResNet-152 <cite class="ltx_citemacro_cite">[<bibref bibrefs="he2015resnet" separator="," yyseparator=","/>]</cite> and Inception-v3 <cite class="ltx_citemacro_cite">[<bibref bibrefs="szegedy2015inception" separator="," yyseparator=","/>]</cite> can contain hundred of layers. The multiplicative depth of the fully-trained ResNet-152 or the Inception-v3 in <cite class="ltx_citemacro_cite">[<bibref bibrefs="gulshan2016development" separator="," yyseparator=","/>]</cite> is at least an order of magnitude greater and would have a prohibitively large runtime in the encrypted setting. Additionally, there exist challenges in achieving strong accuracy when training all layers of a deep neural network with approximate activation functions. Our proposed model (DFE-ResNet-152) only requires retraining of the top block of the ResNet-152 network, which contains three convolutional layers and three activation functions. For this top block, we replace the ReLU activation functions in the top block with our approximate activation function, and we use the rest of the ImageNet-pretrained model as a delegated feature extractor on the client.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS4">
      <tags>
        <tag>X-D</tag>
        <tag role="refnum">X-D</tag>
        <tag role="typerefnum">§X-D</tag>
      </tags>
      <title><tag close=" ">X-D</tag><text font="italic">Model Adaptations</text></title>
      <para xml:id="S10.SS4.p1">
        <p>We use the approximation of Swish <cite class="ltx_citemacro_cite">[<bibref bibrefs="ramachandran2017swish" separator="," yyseparator=","/>]</cite> given by <Math mode="inline" tex="p^{*}(x)=2^{-3}x^{2}+2^{-1}x+2^{-4}" text="p ^ * * x = 2 ^ (- 3) * x ^ 2 + 2 ^ (- 1) * x + 2 ^ (- 4)" xml:id="S10.SS4.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S10.SS4.p1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S10.SS4.p1.m1.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> as derived in previous sections. This approximation is required for only the activation functions in the retrained block, which reduces difficulties with convergence in training.</p>
      </para>
      <para xml:id="S10.SS4.p2">
        <p>Since the encryption scheme only supports addition and multiplication, some minor modifications are required to support average pooling. While other work has used scaled average pooling, in this work we encode the reciprocal of the size of the pooling window. Furthermore, to support the addition operation in the residual block, the scaling factor must be encoded as well, to scale the encrypted input image for the addition operation.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS5">
      <tags>
        <tag>X-E</tag>
        <tag role="refnum">X-E</tag>
        <tag role="typerefnum">§X-E</tag>
      </tags>
      <title><tag close=" ">X-E</tag><text font="italic">Client-Server Interaction</text></title>
      <para xml:id="S10.SS5.p1">
        <p>The client uses a standard deep learning framework to evaluate the base network layers on a single RGB retinal fundus image. Each element of the activation volume of the final base layer can be converted to a fixed-point value and encoded using the integer encoder described above. Each value is encrypted on the client and transmitted to the server. The server returns encrypted output values, which the client decrypts, converts to floating point, and applies the sigmoid function to learn the final predictions of the model. Given the support for deep learning operations in major mobile platforms, the client could even be the patient’s own mobile device, allowing for direct service models in developing countries.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:eval_metrics" xml:id="S10.SS6">
      <tags>
        <tag>X-F</tag>
        <tag role="refnum">X-F</tag>
        <tag role="typerefnum">§X-F</tag>
      </tags>
      <title><tag close=" ">X-F</tag><text font="italic">Evaluation Metrics</text></title>
      <para xml:id="S10.SS6.p1">
        <p><!--  %This is the common procedure of prior work on encrypted inference. -->The natural alternative to our proposed technique is to have the entire fully-trained model stored on the server and for clients to transmit their encrypted images for diagnosis.
We want to demonstrate that our proposed technique of using fine-tuned layers of a much deeper model has higher accuracy, greater performance, and a smaller message size, without compromising any security or privacy guarantees. Our primary points of comparison will be between a standard model that is fully-trained on our dataset and a transfer learning model that uses pretrained ImageNet weights and is fine-tuned on our dataset.</p>
      </para>
      <para xml:id="S10.SS6.p2">
        <p>We will need to consider the multiplicative depth of the models, which corresponds to the length of the deepest path of ciphertext multiplications through the network. We keep the multiplicative depth fixed between the two methods to enable a fair comparison. We will also analyze the count of homomorphic operations (HOPs), which serves as a hardware-independent and implementation-agnostic measure of the complexity of evaluation.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS7">
      <tags>
        <tag>X-G</tag>
        <tag role="refnum">X-G</tag>
        <tag role="typerefnum">§X-G</tag>
      </tags>
      <title><tag close=" ">X-G</tag><text font="italic">DP-SGD</text></title>
      <para xml:id="S10.SS7.p1">
        <p>Once concern of the earlier approach is that the users are limited to fine-tuning only a few layers of a network.
However, training the entire model and release the upper portion of the network as a feature extractor could lead to a privacy risk as the feature extractor could potentially leak sensitive information.
We explore the use of private training techniques to fine-tune the feature extractor further to improve accuracy while preserving end-to-end privacy.</p>
      </para>
      <para xml:id="S10.SS7.p2">
        <p>Differential privacy is a privacy construct which guarantees that an individual will not change the overall statistics of the population <cite class="ltx_citemacro_cite">[<bibref bibrefs="dwork2008differential" separator="," yyseparator=","/>]</cite>. Formally, it is defined that an algorithm <Math mode="inline" tex="M" text="M" xml:id="S10.SS7.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">M</XMTok>
            </XMath>
          </Math> and dataset <Math mode="inline" tex="D" text="D" xml:id="S10.SS7.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> are <Math mode="inline" tex="(\epsilon,\delta)" text="open-interval@(epsilon, delta)" xml:id="S10.SS7.p2.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S10.SS7.p2.m3.1"/>
                  <XMRef idref="S10.SS7.p2.m3.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="S10.SS7.p2.m3.1">ϵ</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" name="delta" role="UNKNOWN" xml:id="S10.SS7.p2.m3.2">δ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> private if <Math mode="inline" tex="P(M(x\in D)\in S)\leq e^{\epsilon}P(M(x\in D^{\prime})\in S)+\delta" text="P * (M * (x element-of D) element-of S) &lt;= e ^ epsilon * P * (M * (x element-of D ^ prime) element-of S) + delta" xml:id="S10.SS7.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMDual>
                    <XMRef idref="S10.SS7.p2.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S10.SS7.p2.m4.1">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">M</XMTok>
                          <XMDual>
                            <XMRef idref="S10.SS7.p2.m4.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S10.SS7.p2.m4.1.1">
                                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">S</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMTok font="italic" fontsize="70%" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">P</XMTok>
                    <XMDual>
                      <XMRef idref="S10.SS7.p2.m4.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S10.SS7.p2.m4.2">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">M</XMTok>
                            <XMDual>
                              <XMRef idref="S10.SS7.p2.m4.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S10.SS7.p2.m4.2.1">
                                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">S</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Applying differential privacy to neural networks helps ensure defenses against membership inference and model inversion attacks <cite class="ltx_citemacro_cite">[<bibref bibrefs="abadi2017privatetwoapproaches" separator="," yyseparator=","/>]</cite>. This can be achieved by either applying noise to gradients while training a single model <cite class="ltx_citemacro_cite">[<bibref bibrefs="abadi2016dpsgd" separator="," yyseparator=","/>]</cite> <cite class="ltx_citemacro_cite">[<bibref bibrefs="song2013stochastic" separator="," yyseparator=","/>]</cite> or by segregating data and adding noise in a collaborative learning setting <cite class="ltx_citemacro_cite">[<bibref bibrefs="papernot2018scalable" separator="," yyseparator=","/>]</cite> <cite class="ltx_citemacro_cite">[<bibref bibrefs="shokri2015privacy" separator="," yyseparator=","/>]</cite>.</p>
      </para>
      <para xml:id="S10.SS7.p3">
        <p>DP-SGD optimization was developed by <cite class="ltx_citemacro_cite">[<bibref bibrefs="abadi2016dpsgd" separator="," yyseparator=","/>]</cite> and involves adding Gaussian noise and clipping gradients of neural networks during training with stochastic gradient descent. It also keeps track of the privacy loss through a privacy accountant <cite class="ltx_citemacro_cite">[<bibref bibrefs="mcsherry2009privacyaccounting" separator="," yyseparator=","/>]</cite>, which prematurely terminates training when the total privacy cost of accessing training data exceeds a predetermined budget. Differential privacy is attained as clipping bounds the L2-norm of individual gradients, thus limiting the influence of each example on the learning updates. We outline the DP-SGD algorithm briefly below in Algorithm <ref labelref="LABEL:algo_dpgradopt"/>.</p>
      </para>
      <float class="ltx_algorithm" labels="LABEL:algo_dpgradopt" xml:id="alg2">
        <tags>
          <tag><text font="bold">Algorithm 2</text></tag>
          <tag role="refnum">2</tag>
        </tags>
        <listing class="ltx_lst_numbers_left">
          <listingline>


<text font="bold">input :</text>  Examples <Math mode="inline" tex="\{x_{1},...,x_{N}\}" text="set@(x _ 1, ldots, x _ N)" xml:id="alg2.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="alg2.m1.2"/>
                    <XMRef idref="alg2.m1.1"/>
                    <XMRef idref="alg2.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="alg2.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="alg2.m1.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="alg2.m1.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, loss function <Math mode="inline" tex="\mathcal{L}(\theta)=\frac{1}{N}\Sigma_{i}\mathcal{L}(\theta,x_{i})" text="L * theta = (1 / N) * Sigma _ i * L * open-interval@(theta, x _ i)" xml:id="alg2.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                    <XMDual>
                      <XMRef idref="alg2.m2.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="alg2.m2.1">θ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg2.m2.2"/>
                        <XMRef idref="alg2.m2.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="alg2.m2.2">θ</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="alg2.m2.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, Parameters: learning rate <Math mode="inline" tex="\eta_{t}" text="eta _ t" xml:id="alg2.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMath>
            </Math>, noise scale <Math mode="inline" tex="\sigma" text="sigma" xml:id="alg2.m4">
              <XMath>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
              </XMath>
            </Math>, group size <Math mode="inline" tex="L" text="L" xml:id="alg2.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
              </XMath>
            </Math>, gradient norm bound <Math mode="inline" tex="C" text="C" xml:id="alg2.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
              </XMath>
            </Math>.</listingline>
          <listingline>
<text font="bold">output :</text> <Math mode="inline" tex="\theta_{T}" text="theta _ T" xml:id="alg2.m7">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                </XMApp>
              </XMath>
            </Math> and calculate privacy cost <Math mode="inline" tex="(\epsilon,\delta)" text="open-interval@(epsilon, delta)" xml:id="alg2.m8">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="alg2.m8.1"/>
                    <XMRef idref="alg2.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="alg2.m8.1">ϵ</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" name="delta" role="UNKNOWN" xml:id="alg2.m8.2">δ</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> using a privacy accountant method</listingline>
          <listingline><tags>
              <tag>1</tag>
            </tags>
<text font="bold">Initialize</text> <Math mode="inline" tex="\theta_{0}" text="theta _ 0" xml:id="alg2.m9">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
              </XMath>
            </Math> randomly;</listingline>
          <listingline><tags>
              <tag>2</tag>
            </tags>
<text font="bold">for</text> <emph font="italic"><Math mode="inline" tex="t\in[T]" text="t element-of delimited-[]@(T)" xml:id="alg2.m10">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok role="UNKNOWN">t</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="alg2.m10.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok font="upright" role="OPEN" stretchy="false">[</XMTok>
                        <XMTok role="UNKNOWN" xml:id="alg2.m10.1">T</XMTok>
                        <XMTok font="upright" role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math></emph> <text font="bold">do</text></listingline>
          <listingline><tags>
              <tag>3</tag>
            </tags>  <rule height="100%" width="1px"/>   
Take a random sample <Math mode="inline" tex="L_{t}" text="L _ t" xml:id="alg2.m11">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMath>
            </Math> with sampling probability <Math mode="inline" tex="L/N" text="L / N" xml:id="alg2.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>4</tag>
            </tags>  <rule height="100%" width="1px"/>   
<text font="bold">Compute gradient</text>;</listingline>
          <listingline><tags>
              <tag>5</tag>
            </tags>  <rule height="100%" width="1px"/>   
For each <Math mode="inline" tex="i\in L_{t}" text="i element-of L _ t" xml:id="alg2.m13">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, compute <Math mode="inline" tex="\textbf{g}_{t}(x_{i})\leftarrow\nabla_{\theta_{t}}\mathcal{L}(\theta_{t},x_{i})" text="[g] _ t * x _ i leftarrow (nabla _ theta _ t)@(L) * open-interval@(theta _ t, x _ i)" xml:id="alg2.m14">
              <XMath>
                <XMApp>
                  <XMTok name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="bold">g</text></XMText>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="alg2.m14.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg2.m14.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg2.m14.2"/>
                        <XMRef idref="alg2.m14.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg2.m14.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="alg2.m14.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>6</tag>
            </tags>  <rule height="100%" width="1px"/>   
<text font="bold">Clip gradient</text>;</listingline>
          <listingline><tags>
              <tag>7</tag>
            </tags>  <rule height="100%" width="1px"/>   
<Math class="ltx_math_unparsed" mode="inline" tex="\overline{\textbf{g}}_{t}(x_{i})\leftarrow\textbf{g}_{t}(x_{i})/\text{max}(1,%&#10;\frac{\lVert\textbf{g}_{t}(x_{i})\rVert_{2}}{C}" xml:id="alg2.m15">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                    <XMText><text font="bold">g</text></XMText>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText><text font="bold">g</text></XMText>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMText>max</XMText>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="alg2.m15.2">1</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="alg2.m15.3">
                    <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-∥∥"/>
                          <XMRef idref="alg2.m15.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                          <XMApp xml:id="alg2.m15.1">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMText><text font="bold" fontsize="70%">g</text></XMText>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="alg2.m15.1.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="alg2.m15.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok fontsize="70%" name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">C</XMTok>
                  </XMApp>
                </XMWrap>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>8</tag>
            </tags>  <rule height="100%" width="1px"/>   
<text font="bold">Add noise</text>;</listingline>
          <listingline><tags>
              <tag>9</tag>
            </tags>  <rule height="100%" width="1px"/>   
<Math mode="inline" tex="\tilde{\textbf{g}}_{t}\leftarrow\frac{1}{L}(\Sigma_{i}(\overline{\textbf{g}}_{%&#10;t}(x_{i})+\mathcal{N}(0,\sigma^{2}C^{2}\mathcal{I})))" text="(tilde@([g])) _ t leftarrow (1 / L) * Sigma _ i * ((overline@([g])) _ t * x _ i + N * open-interval@(0, sigma ^ 2 * C ^ 2 * I))" xml:id="alg2.m16">
              <XMath>
                <XMApp>
                  <XMTok name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                      <XMText><text font="bold">g</text></XMText>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="alg2.m16.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg2.m16.2">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="alg2.m16.2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="alg2.m16.2.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                                      <XMText><text font="bold">g</text></XMText>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="alg2.m16.2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="alg2.m16.2.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="alg2.m16.1"/>
                                      <XMRef idref="alg2.m16.2.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok meaning="0" role="NUMBER" xml:id="alg2.m16.1">0</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="alg2.m16.2.1.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok font="caligraphic" role="UNKNOWN">I</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>10</tag>
            </tags>  <rule height="100%" width="1px"/>   
<text font="bold">Descent</text>;</listingline>
          <listingline><tags>
              <tag>11</tag>
            </tags>  <rule height="100%" width="1px"/>   
<Math mode="inline" tex="\theta_{t+1}\leftarrow\theta_{t}-\eta_{t}\tilde{\textbf{g}}_{t}" text="theta _ (t + 1) leftarrow theta _ t - eta _ t * (tilde@([g])) _ t" xml:id="alg2.m17">
              <XMath>
                <XMApp>
                  <XMTok name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
<!--  %**** main.tex Line 1150 **** -->                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                          <XMText><text font="bold">g</text></XMText>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>12</tag>
            </tags>  <rule height="100%" width="1px"/>   
</listingline>
          <listingline>
</listingline>
        </listing>
        <toccaption><tag close=" ">2</tag>Differentially private SGD</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 2</text></tag>Differentially private SGD</caption>
      </float>
      <para xml:id="S10.SS7.p4">
        <p>We use a modified DP-SGD algorithm <cite class="ltx_citemacro_cite">[<bibref bibrefs="abadi2016dpsgd" separator="," yyseparator=","/>]</cite> to fine-tune the entire network, using the following techniques introduced by <cite class="ltx_citemacro_cite">[<bibref bibrefs="zhang2018privatereleasing" separator="," yyseparator=","/>]</cite>; warm-starting, where a public dataset is used to initialize the weights of the model, and weights clustering, where the same dataset is used to estimate the gradient l2 norms of each parameter before using a hierarchical clustering algorithm to group parameters with similar clipping bounds (in Algorithm <ref labelref="LABEL:algo_weightcluster"/>). The public dataset we use is a smaller retinal scan dataset from the STARE project <cite class="ltx_citemacro_cite">[<bibref bibrefs="hoover2000stare" separator="," yyseparator=","/>]</cite>. We train the network privacy settings of <Math mode="inline" tex="\epsilon=8.0" text="epsilon = 8.0" xml:id="S10.SS7.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                <XMTok meaning="8.0" role="NUMBER">8.0</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\delta=1\times 10^{-5}" text="delta = 1 * 10 ^ (- 5)" xml:id="S10.SS7.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="5" role="NUMBER">5</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> giving us a <Math mode="inline" tex="\sigma" text="sigma" xml:id="S10.SS7.p4.m3">
            <XMath>
              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
            </XMath>
          </Math> value of <Math mode="inline" tex="0.399" text="0.399" xml:id="S10.SS7.p4.m4">
            <XMath>
              <XMTok meaning="0.399" role="NUMBER">0.399</XMTok>
            </XMath>
          </Math>. Finally, we retrain the layers to be encrypted as before, leaving us with our final model (DP-DFE-RN-50).</p>
      </para>
      <float class="ltx_algorithm" labels="LABEL:algo_weightcluster" xml:id="alg3">
        <tags>
          <tag><text font="bold">Algorithm 3</text></tag>
          <tag role="refnum">3</tag>
        </tags>
        <listing class="ltx_lst_numbers_left">
          <listingline>


<text font="bold">input :</text> k - target number of groups; <Math mode="inline" tex="\{c(g_{i})\}_{i}" text="(set@(c * g _ i)) _ i" xml:id="alg3.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg3.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg3.m1.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMDual>
                          <XMRef idref="alg3.m1.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="alg3.m1.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">g</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> - parameter-specific gradient clipping bounds</listingline>
          <listingline>
<text font="bold">output :</text> <Math mode="inline" tex="\mathcal{G}" text="G" xml:id="alg3.m2">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
              </XMath>
            </Math> - grouping of parameters</listingline>
          <listingline><tags>
              <tag>1</tag>
            </tags>
<Math class="ltx_math_unparsed" mode="inline" tex="\mathcal{G}\leftarrow\{(g_{i}:c(g_{i}))\}_{i}" xml:id="alg3.m3">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok name="colon" role="METARELOP">:</XMTok>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">g</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>2</tag>
            </tags>
<text font="bold">while</text> <emph font="italic"><Math mode="inline" tex="|\mathcal{G}|" text="absolute-value@(G)" xml:id="alg3.m4">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="alg3.m4.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="upright" role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="caligraphic upright" role="UNKNOWN" xml:id="alg3.m4.1">G</XMTok>
                      <XMTok font="upright" role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math> <Math mode="inline" tex="\geq" text="&gt;=" xml:id="alg3.m5">
                <XMath>
                  <XMTok font="upright" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                </XMath>
              </Math> k</emph> <text font="bold">do</text></listingline>
          <listingline><tags>
              <tag>3</tag>
            </tags>  <rule height="100%" width="1px"/>   
<Math mode="inline" tex="G,G^{\prime}\leftarrow\text{arg min}_{G,G^{\prime}\in\mathcal{G}}\text{max}(%&#10;\frac{c(G)}{c(G^{\prime})},\frac{c(G^{\prime})}{c(G)})" text="list@(G, G ^ prime) leftarrow [arg min] _ (list@(G, G ^ prime) element-of G) * [max] * open-interval@((c * G) / (c * G ^ prime), (c * G ^ prime) / (c * G))" xml:id="alg3.m6">
              <XMath>
                <XMApp>
                  <XMTok name="leftarrow" role="ARROW">←</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="alg3.m6.9"/>
                      <XMRef idref="alg3.m6.10"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m6.9">G</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg3.m6.10">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">G</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText>arg min</XMText>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="alg3.m6.1"/>
                            <XMRef idref="alg3.m6.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="alg3.m6.1">G</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="alg3.m6.2">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">G</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">G</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMText>max</XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg3.m6.7"/>
                        <XMRef idref="alg3.m6.8"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg3.m6.7">
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            <XMDual>
                              <XMRef idref="alg3.m6.3"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="alg3.m6.3">G</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            <XMDual>
                              <XMRef idref="alg3.m6.4"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="alg3.m6.4">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">G</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="alg3.m6.8">
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            <XMDual>
                              <XMRef idref="alg3.m6.5"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="alg3.m6.5">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">G</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            <XMDual>
                              <XMRef idref="alg3.m6.6"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="alg3.m6.6">G</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>;</listingline>
          <listingline><tags>
              <tag>4</tag>
            </tags>  <rule height="100%" width="1px"/>   
merge <Math mode="inline" tex="G" text="G" xml:id="alg3.m7">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">G</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="G^{\prime}" text="G ^ prime" xml:id="alg3.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">G</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> w. clipping bound <Math mode="inline" tex="\sqrt{c(G)^{2}+c(G^{\prime})^{2}}" text="square-root@(c * G ^ 2 + c * G ^ prime ^ 2)" xml:id="alg3.m9">
              <XMath>
                <XMApp>
                  <XMTok meaning="square-root"/>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMDual>
                          <XMRef idref="alg3.m9.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m9.1">G</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">c</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMDual>
                          <XMRef idref="alg3.m9.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="alg3.m9.2">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">G</XMTok>
                              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
</listingline>
          <listingline><tags>
              <tag>5</tag>
            </tags><text font="bold">return</text> <Math mode="inline" tex="\mathcal{G}" text="G" xml:id="alg3.m10">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
              </XMath>
            </Math>;</listingline>
          <listingline>

</listingline>
        </listing>
        <toccaption><tag close=" ">3</tag>Weight Clustering</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 3</text></tag>Weight Clustering</caption>
      </float>
      <para xml:id="S10.SS7.p5">
        <p>The accuracy and peformance metrics of our models are listed in Table <ref labelref="LABEL:tab:accuracy_results"/> and <ref labelref="LABEL:tab:performance_results"/>. We compare in terms of both a hardware-independent HOPS (homomorphic operations) and wall-clock runtime.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS8">
      <tags>
        <tag>X-H</tag>
        <tag role="refnum">X-H</tag>
        <tag role="typerefnum">§X-H</tag>
      </tags>
      <title><tag close=" ">X-H</tag><text font="italic">Message Sizes</text></title>
      <para xml:id="S10.SS8.p1">
        <p>The data transfer between the client and server consists of the values for the encrypted input and the values for the encrypted output prediction. Note that both the image and the prediction are encrypted under multiple keys held by the client, each corresponding to a distinct plaintext moduli <Math mode="inline" tex="t^{(j)}" text="t ^ j" xml:id="S10.SS8.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMDual>
                  <XMRef idref="S10.SS8.p1.m1.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S10.SS8.p1.m1.1">j</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, which leads the message size to be proportional to the number of moduli used for evaluation. We used fifteen plaintext moduli in our experiments.</p>
      </para>
      <para xml:id="S10.SS8.p2">
        <p>As a result, the message size for the encrypted input in our DFE-ResNet-152 method is <Math mode="inline" tex="15\times 2\times 2048\times 7\times 7\times 8192\times 4\times 8" text="15 * 2 * 2048 * 7 * 7 * 8192 * 4 * 8" xml:id="S10.SS8.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok meaning="2048" role="NUMBER">2048</XMTok>
                <XMTok meaning="7" role="NUMBER">7</XMTok>
                <XMTok meaning="7" role="NUMBER">7</XMTok>
                <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                <XMTok meaning="4" role="NUMBER">4</XMTok>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMath>
          </Math> bytes (789.2 GB), corresponding to the encryption of the <Math mode="inline" tex="2048\times 7\times 7" text="2048 * 7 * 7" xml:id="S10.SS8.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="2048" role="NUMBER">2048</XMTok>
                <XMTok meaning="7" role="NUMBER">7</XMTok>
                <XMTok meaning="7" role="NUMBER">7</XMTok>
              </XMApp>
            </XMath>
          </Math> activation volume. The message size for the encrypted input in our CNN-8 baseline method is <Math mode="inline" tex="15\times 2\times 224\times 224\times 3\times 8192\times 4\times 8" text="15 * 2 * 224 * 224 * 3 * 8192 * 4 * 8" xml:id="S10.SS8.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
                <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                <XMTok meaning="4" role="NUMBER">4</XMTok>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMath>
          </Math> bytes (1183.8 GB), corresponding to the encryption of the <Math mode="inline" tex="224\times 224\times 3" text="224 * 224 * 3" xml:id="S10.SS8.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="224" role="NUMBER">224</XMTok>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> input image. The message size of the encrypted output is identical in each case: <Math mode="inline" tex="15\times 2\times 1\times 8192\times 4\times 8" text="15 * 2 * 1 * 8192 * 4 * 8" xml:id="S10.SS8.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                <XMTok meaning="4" role="NUMBER">4</XMTok>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMath>
          </Math> bytes (7.9 MB).</p>
      </para>
      <para xml:id="S10.SS8.p3">
        <p>Since the input is transformed to a representation with a smaller dimensionality in the transfer learning method, the cost of data transfer is reduced by 1.5x. While the message size is significant in both cases, we note that ciphertext batching techniques can amortize the cost of encrypted inference when a user wishes to request predictions on multiple images. In the case of diabetic retinopathy detection, this could correspond to predictions for both the left and right eye, or predictions for images of multiple patients of a healthcare provider.</p>
      </para>
<!--  %$15 “times 2 “times 2048 “times 7 “times 7 “times 8192 “times 4 “times 8$ bytes ( 
     %$15 “times 2 “times 224 “times 224 “times 3 “times 8192 “times 4 “times 8$ bytes (1183.8 GB) 
     %$ 15 “times 2 “times 1 “times 8192 “times 4 “times 8$ bytes ($ -->    </subsection>
    <subsection inlist="toc" xml:id="S10.SS9">
      <tags>
        <tag>X-I</tag>
        <tag role="refnum">X-I</tag>
        <tag role="typerefnum">§X-I</tag>
      </tags>
      <title><tag close=" ">X-I</tag><text font="italic">Experimental Correctness</text></title>
      <para xml:id="S10.SS9.p1">
        <p>We validate on 100 images of our CIFAR-10 and Retina experiments to ascertain the correctness of our decrypted outputs. Once more, we find around 0.05% error due to the floating/fixed point conversion.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S10.SS10">
      <tags>
        <tag>X-J</tag>
        <tag role="refnum">X-J</tag>
        <tag role="typerefnum">§X-J</tag>
      </tags>
      <title><tag close=" ">X-J</tag><text font="italic">Overall Comparison</text></title>
      <para xml:id="S10.SS10.p1">
        <p>In a direct comparison between the baseline CNN-8 model and our transfer learning DFE-RN-50 model, we observe an across-the-board improvement. DFE-RN-50 has higher accuracy, significantly reduces both the count of HOPs and measured runtime, and produces smaller message sizes than our baseline model. We demonstrate the effectiveness of the sparsity-based optimization techniques to reduce computation time (7.8x speedup). We also show how other privacy concepts like differential privacy can be used to further improve the performance of our feature extraction architecture as we can see with the improved accuracy of DP-DFE-RN-50. To the best of our knowledge, this is the first implementation of homomorphic encryption and neural networks on a real-world medical imaging dataset.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S11">
    <tags>
      <tag>XI</tag>
      <tag role="refnum">XI</tag>
      <tag role="typerefnum">§XI</tag>
    </tags>
    <title><tag close=" ">XI</tag><text font="smallcaps">Discussion</text></title>
    <para xml:id="S11.p1">
      <p>Encrypted inference is not a panacea for private machine learning. It has some obvious constraints the paper touches on in several sections, including the computational cost and network depth limitations. Additionally, it does not cover the problem of private training and of defending against machine learning attacks. The encrypted inference paradigm is still vulnerable to black box attacks, as it still returns encrypted outputs that are otherwise unaffected. For example, membership inference <cite class="ltx_citemacro_cite">[<bibref bibrefs="Fredrikson:2015:MIA:2810103.2813677" separator="," yyseparator=","/>]</cite> and model stealing <cite class="ltx_citemacro_cite">[<bibref bibrefs="tramer2016stealingapis" separator="," yyseparator=","/>]</cite> attacks can be performed with only access to the outputs of the model.</p>
    </para>
<!--  %These issues will likely be solved by combining other privacy-preserving machine learning methods to form a fully private pipeline.  We presented a method to scale up DP-SGD “cite–abadi2016dpsgd˝, which trains a model with differential privacy guarantees and offers defenses against membership inference and model inversion attacks “cite–privatetwoapproaches˝.  A framework where DP-SGD is used to train the model to deploy for encrypted inference is a sample framework where homomorphic encryption will ensure privacy during data transmission and from the cloud host, guarantees private training techniques cannot provide themselves. 
     %Encrypted inference and model inversion defenses are important but orthogonal components of ML as a service. Nonetheless, we presented a method to scale up DP-SGD (https://arxiv.org/abs/1607.00133) which gives provable guarantees against related attacks and is complementary to HE techniques. In addition, works have shown that membership inference or model stealing attacks are dependent on the overfitting of the model and its confidence outputs rather than the numerical properties of the weights (https://arxiv.org/abs/1802.04889), and that model inversion is not an effective attack on CNNs (http://arxiv.org/abs/1610.05820, http://arxiv.org/abs/1702.07464). Preliminary analysis strongly suggest our quantized models are not overfitting, given the small generalization gap. -->  </section>
  <section inlist="toc" xml:id="S12">
    <tags>
      <tag>XII</tag>
      <tag role="refnum">XII</tag>
      <tag role="typerefnum">§XII</tag>
    </tags>
    <title><tag close=" ">XII</tag><text font="smallcaps">Conclusion</text></title>
    <para xml:id="S12.p1">
      <p><!--  %Privacy protection should be incorporated into thdesign of machine learning systems. -->Personal privacy is increasingly under threat in the modern digital age, and machine learning models continue to fuel the appetite for more invidual data and information.
Homomorphic encryption holds great promise due to the security guarantees it can provide against both eavesdroppers and service hosts.
Unlocking its potential will require reducing the high overhead of arithmetic operations prevalent in neural networks.</p>
    </para>
<!--  %Unlocking its potential will require accelerating the time-consuming operations of homomorphic arithmetic, which are prevalent for machine learning models. -->    <para xml:id="S12.p2">
      <p>In this work, we introduced and evaluated techniques for accelerating CryptoNets <cite class="ltx_citemacro_cite">[<bibref bibrefs="gilad2016cryptonets" separator="," yyseparator=","/>]</cite>.
The fundamental approach to our method is to leverage sparsity by using (i) efficient polynomial approximations for the activation functions and (ii) pruning and quantization that is tailored to the encryption scheme for significant performance gains.
We show that our method, <text font="italic">Faster CryptoNets</text><!--  %when using an approximate activation function. -->, is faster than CryptoNets without much loss of test set accuracy.We also demonstrate how our technique can be deployed in a privately trained feature extraction setting, possibly inspiring future avenues of work where different privacy concepts can be combined to deliver an end-to-end privacy safe training and inference pipeline. To the best of our knowledge, this is the first implementation of homomorphic encryption on a real-world medical imaging dataset.</p>
    </para>
<!--  %and more efficient encoding schemes “cite–chen2017high˝ could reduce the parameters required for the cryptosystem. -->    <para xml:id="S12.p3">
      <p>Recent developments can produce even greater improvements.
Structured sparsity <cite class="ltx_citemacro_cite">[<bibref bibrefs="wen2016learning" separator="," yyseparator=","/>]</cite>, filter-level pruning methods <cite class="ltx_citemacro_cite">[<bibref bibrefs="luo2017thinet" separator="," yyseparator=","/>]</cite>, and efficient batching scheme and hardware acceleration techniques <cite class="ltx_citemacro_cite">[<bibref bibrefs="Migliore:2017:HAH:3145508.3126558" separator="," yyseparator=","/>]</cite> could further accelerate evaluation of deeper networks.
In particular, more optimal encoding schemes could help reduce the message sizes of the encrypted data and provide more efficient parameters for the encryption scheme.
We hope this work will inspire future lines of research in efficient and privacy-safe machine learning.</p>
    </para>
<!--  %We trained our network on an Intel Core i7-5930K CPU at 3.50 GHz with 48 GB RAM. 
     %**** main.tex Line 1225 **** 
     %The test set was evaluated using a parallel implementation of our method. 
     %This parallel implementation was only used to speed up the computation of the full test set accuracy. 
     %It was not used to compute single image encrypted inference time. 
     %“subsubsection–Hardware˝  % Do not include hardware specs. Albert (Feb 9, 3:11 am) 
     %We run our network on an Intel Core i7-5930K CPU at 3.50GHz with 48GB RAM. 
     %For our previous runtime calculations, we ran one instance of an inference task with our model, observing runtimes of around 43.9 seconds. 
     %We also parallelized multiple tasks using threading, spawning up to 125 different processes on an (AWS) machine with a single Intel Xeon CPU E7-8880 v3 running at 2.30GHz wiImpth 1.88 TB RAM. 
     %Using the given hardware, we observed minimal-to-no slowdown for each process. 
     %“begin–table˝[H] 
     %“caption–Approximation results. Minimax approximation is denoted by “textit–A˝ and polynomial approximation with quantized coefficients is “textit–AQ˝ (our method). For each activation function, three models were trained. The mean accuracy and standard deviation are shown for MNIST and CIFAR-10.˝ 
     %“label–table:activation˙times˝ 
     %“centering 
     %“small 
     %“begin–tabular˝–@–˝l—c—c—c—c@–˝˝ 
     %“toprule 
     %Activation &amp; MNIST Train Acc. &amp; MNIST Test Acc. &amp; CIFAR-10 Train Acc. &amp; CIFAR-10 Test Acc. ““ “midrule 
     %ReLU &amp; $99.62 “pm 0.03$ &amp; $99.13 “pm 0.08$ &amp; $93.10Ψ“pm 0.00$ &amp; $86.76 “pm 0.00$  ““ 
     %Square &amp; $“mathbf–99.80 “pm 0.01˝$ &amp; $“mathbf–99.17 “pm 0.11˝$ &amp; $59.97 “pm 0.00$ &amp; $59.88 “pm 0.00$ ““ 
     %Softplus &amp; $99.40 “pm 0.03$ &amp; $99.09 “pm 0.07$ &amp; $67.96 “pm 0.00$ &amp; $67.94 “pm 0.00$ ““ 
     %Swish  &amp; $99.64 “pm 0.01$  &amp; $99.13 “pm 0.10$ &amp; $91.55 “pm 0.00$ &amp;Ψ$86.24 “pm 0.00$““   “midrule 
     %ReLU-A  &amp; $“mathbf–99.58 “pm 0.02˝$  &amp; $“mathbf–99.09 “pm 0.03˝$ &amp; $77.95 “pm 0.00$ &amp; $75.99 “pm 0.00$ ““ 
     %Softplus-A &amp; $99.37 “pm 0.03$ &amp; $99.00 “pm 0.04$ &amp; $75.11 “pm 0.00$ &amp; $73.57 “pm 0.00$ ““ 
     %Swish-A  &amp; $98.75 “pm 0.17$  &amp; $98.64 “pm 0.11$ &amp; $77.30 “pm 0.00$ &amp; $75.41 “pm 0.00$ ““ “midrule 
     %**** main.tex Line 1250 **** 
     %ReLU-AQ  &amp; $99.58 “pm 0.02$  &amp; $99.09 “pm 0.03$ &amp; $77.95 “pm 0.00$Ψ&amp; $75.99 “pm 0.00$““ 
     %Softplus-AQ &amp; $99.16 “pm 0.16$ &amp; $98.90 “pm 0.03$ &amp; $72.67 “pm 0.00$ &amp; $71.58 “pm 0.00$ ““ 
     %Swish-AQ  &amp; $“mathbf–99.59 “pm 0.02˝$  &amp; $“mathbf–99.10 “pm 0.02˝$ &amp; $78.20 “pm 0.00$ &amp; $75.66 “pm 0.00$ ““ “bottomrule 
     %“end–tabular˝ 
     %“end–table˝ 
     %Additionally, we present Table “ref–table:sup˙fullactivations˝ which contains values for each of the three trials for MNIST. 
     %“begin–table˝[H] 
     %“centering 
     %“small 
     %“begin–tabular˝–@–˝l—c—c—c—c—c—c—c—c—c—c@–˝˝ 
     %“toprule 
     %&amp;  “multicolumn–2˝–c—˝–Trial 1˝ &amp; “multicolumn–2˝–c—˝–Trial 2˝ &amp; “multicolumn–2˝–c—˝–Trial 3˝ &amp; “multicolumn–2˝–c—˝–Mean˝ &amp; “multicolumn–2˝–c˝–Stddev˝ ““ 
     %Activation &amp; Train &amp; Test &amp; Train &amp; Test &amp; Train &amp; Test &amp; Train &amp; Test &amp; Train &amp; Test ““ 
     %“midrule 
     %Square &amp; 99.80 &amp; 99.08 &amp; 99.81 &amp; 99.14 &amp; 99.8 &amp; 99.29 &amp; 99.80 &amp; 99.17 &amp; 0.01 &amp; 0.11 ““ 
     %ReLU &amp; 99.65 &amp; 99.20 &amp; 99.59 &amp; 99.14 &amp; 99.62 &amp; 99.05 &amp; 99.62 &amp; 99.13 &amp; 0.03 &amp; 0.08  ““ 
     %ReLU-approx &amp; 99.57 &amp; 99.07 &amp; 99.60 &amp; 99.14 &amp; 99.58 &amp; 99.07 &amp; 99.58 &amp; 99.09 &amp; 0.02 &amp; 0.04““ “midrule 
     %Softplus &amp; 99.42 &amp; 99.17 &amp; 99.37 &amp; 99.06 &amp; 99.41 &amp; 99.05 &amp; 99.4 &amp; 99.09 &amp; 0.03 &amp; 0.07 ““ 
     %Softplus-A &amp; 99.34 &amp; 99.05 &amp; 99.39 &amp; 98.98 &amp; 99.38 &amp; 98.98 &amp; 99.37 &amp; 99.00 &amp; 0.03 &amp; 0.04 ““ 
     %Softplus-AQ &amp; 99.17 &amp; 98.92 &amp; 99.13 &amp; 98.92 &amp; 99.17 &amp; 98.87 &amp; 99.16 &amp; 98.9 &amp; 0.16 &amp; 0.03 ““ “midrule 
     %Swish &amp; 99.63 &amp; 99.16 &amp; 99.64 &amp; 99.22 &amp; 99.64 &amp; 99.02 &amp; 99.64 &amp; 99.13 &amp; 0.01 &amp; 0.10  ““ 
     %Swish-A &amp; 99.56 &amp; 99.07 &amp; 99.59 &amp; 99.13 &amp; 99.58 &amp; 99.07 &amp; 99.58 &amp; 99.09 &amp; 0.02 &amp; 0.03 ““ 
     %Swish-AQ &amp; 99.56 &amp; 99.09 &amp; 99.60 &amp; 99.12 &amp; 99.60 &amp; 99.08 &amp; 99.59 &amp; 99.10 &amp; 0.02 &amp; 0.02 ““ 
     %**** main.tex Line 1275 **** 
     %“bottomrule 
     %“end–tabular˝ 
     %“caption–“textbf–Multiple trials for the activation function ablation study.˝ Values denote accuracy. Minimax approximation is denoted by “textit–A˝ and polynomial approximation with quantized coefficients is “textit–AQ˝ (our method). For each activation function, three models were trained with different random seeds. The mean accuracy and standard deviation are shown.˝ 
     %“label–table:sup˙fullactivations˝ 
     %“end–table˝ 
     %“subsection–Dynamic Network Surgery (DNS) hyperparameters˝ 
     %“begin–table˝[H] 
     %“centering 
     %“small 
     %“begin–tabular˝–@–˝l—c—c—c@–˝˝ 
     %“toprule 
     %Layer &amp;ΨSparsity &amp;Ψc-rateΨ&amp; iter-stop““ 
     %“midrule 
     %conv1 &amp; Ψ0.1760Ψ &amp; 1.25Ψ &amp; 10000 ““ 
     %conv2 &amp;Ψ0.0877 &amp;Ψ1.55 &amp;Ψ10000 ““ 
     %fc1Ψ&amp; 0.0532 &amp;Ψ1.65 &amp;Ψ10000 ““ 
     %fc2Ψ&amp; 0.1250 &amp;Ψ1.5Ψ&amp; 10000 ““ 
     %“bottomrule 
     %“end–tabular˝ 
     %“caption–“textbf–DNS Pruning Hyperparameters˝ The hyperparameters used for Dynamic Network Surgery (DNS) in our network are recorded for each layer.  Metrics include the sparsity of the layer, the compression rate (c-rate) of the new layer, and the number of iterations or pruning (iter-stop).˝ 
     %“label–table:sup˙dns˝ 
     %“end–table˝ 
     %“subsection–Detailed Breakdown of Homomorphic Operations˝“label–sup:hops˝ 
     %In this section, we list the HOPs at a more granular level than those presented in Table “ref–table:sota˝. 
     %Below, we show detailed results for our method “textit–Faster CryptoNets˝, the original CryptoNets “cite–gilad2016cryptonets˝, and both networks from CryptoDL “cite–hesamifard2017cryptodl˝. 
     %“begin–table˝[H] 
     %“centering 
     %“caption–CryptoDL-1 HOPs. More detailed breakdown of HOPs for each layer.  Plaintext is denoted by PT and ciphertext is denoted by CT. “textit–Adds˝ and “textit–mults˝ refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.˝ 
     %“label–table:sup˙hops˙cryptodl1˝ 
     %“small 
     %“begin–tabular˝–@–˝l—c—c—c—c—c@–˝˝ 
     %“toprule 
     %Layer &amp; HOPs &amp; “pbox–20cm˝–PT-CT ““ Adds˝ &amp; “pbox–20cm˝–CT-CT ““ Adds˝ &amp; “pbox–20cm˝–PT-CT ““ Mults˝ &amp; “pbox–20cm˝–CT-CT ““ Mults˝ ““ “midrule 
     %Conv-1 &amp; 609,408 &amp; 23,040 &amp; 287,424 &amp; 298,944 &amp; __ ““ 
     %Pool-1 &amp;  11,520 &amp; __ &amp; 115,20 &amp; __ &amp; __ ““ 
     %Conv-2 &amp;  3,207,296 &amp; 6,400 &amp; 1,598,848 &amp; 1,602,048 &amp; 0 ““ 
     %Pool-2 &amp;  3,200 &amp; __ &amp; 3,200 &amp; __ &amp; __ ““ 
     %Act-1 &amp; 6,400 &amp; 800 &amp; 1,600 &amp; 2,400 &amp; 1,600 ““ 
     %FC-1 &amp;  799,860 &amp; 500 &amp; 399,680 &amp; 399,680 &amp; __ ““ 
     %FC-2 &amp; 10,004 &amp; 10 &amp; 4,997 &amp; 4,997 &amp; __ ““  “midrule 
     %Total &amp;  4,647,688 &amp; 30,750 &amp; 2,307,269 &amp; 2,308,069 &amp; 1600 ““ “bottomrule 
     %“end–tabular˝ 
     %“end–table˝ 
     %“begin–table˝[H] 
     %“centering 
     %“caption–CryptoDL-2 HOPs. More detailed breakdown of HOPS for each layer. Plaintext is denoted by PT and ciphertext is denoted by CT. “textit–Adds˝ and “textit–mults˝ refer to the number of homomorphic addition and multiplication operations, respectively. Dashes indicate zero operations. FC refers to the dense (fully-connected) layer.˝ 
     %“label–table:sup˙hops˙cryptodl2˝ 
     %“small 
     %“begin–tabular˝–@–˝l—c—c—c—c—c@–˝˝ 
     %“toprule 
     %Layer &amp; HOPs &amp; “pbox–20cm˝–PT-CT ““ Adds˝ &amp; “pbox–20cm˝–CT-CT ““ Adds˝ &amp; “pbox–20cm˝–PT-CT ““ Mults˝ &amp; “pbox–20cm˝–CT-CT ““ Mults˝ ““ “midrule 
     %Conv-1 &amp; 976,896Ψ&amp; 36,864Ψ&amp; 460,800 &amp;Ψ479,232 &amp;Ψ0 ““ 
     %Conv-2 &amp; 26,645,112 &amp;Ψ36,864 &amp;Ψ13,294,908 &amp;Ψ13,313,340 &amp;Ψ__ ““ 
     %Activ-1 &amp; Ψ147456 &amp;Ψ18,432 &amp;Ψ36,864 &amp;Ψ55,296 &amp;Ψ36,864 ““ 
     %Pool-1 &amp; 18,432  &amp;Ψ__ &amp;Ψ18,432 &amp;Ψ__ &amp;Ψ__ ““ 
     %Conv-3 &amp;  11,964,342 &amp;Ψ18,432 &amp;Ψ5,968,347 &amp;Ψ5,977,563 &amp;Ψ0 ““ 
     %Conv-4 &amp;  23,889,676Ψ &amp; 18,432 &amp;Ψ11,931,014 &amp;Ψ11,940,230 &amp;Ψ__ ““ 
     %Activ-2 &amp; 73,728 &amp;Ψ9216 &amp;Ψ18,432 &amp;Ψ27,648 &amp;Ψ18,432 ““ 
     %Pool-2 &amp;  9,216Ψ &amp; 0 &amp;Ψ9216 &amp;Ψ__ &amp;Ψ__ ““ 
     %Conv-5 &amp;  9,440,602 &amp;Ψ9216  &amp;Ψ4,713,389 &amp;Ψ4,717,997 &amp;Ψ0 ““ 
     %Conv-6 &amp;  18,857,808Ψ &amp; 9,216Ψ &amp; 9,421,992 &amp;Ψ9,426,600 &amp;Ψ0 ““ 
     %Activ-3 &amp; 36,864 &amp;Ψ4,608 &amp;Ψ9,216 &amp;Ψ13,824 &amp;Ψ9,216 ““ 
     %Pool-3 &amp; 4,608 &amp;Ψ__ &amp;Ψ4,608 &amp;Ψ__ &amp;Ψ__ ““ 
     %FC-1 &amp;  589,544 &amp;Ψ256 &amp;Ψ29,4644 &amp;Ψ294,644 &amp;Ψ__ ““ 
     %FC-2 &amp; 5,130Ψ &amp; 10 &amp;Ψ2560 &amp;Ψ2,560 &amp;Ψ0 ““  “midrule 
     %Total &amp;  92,659,414 &amp;Ψ161,546 &amp;Ψ46,184,422 &amp;Ψ46,248,934 &amp;Ψ64,512 ““ “bottomrule 
     %**** main.tex Line 1350 **** 
     %“end–tabular˝ 
     %“end–table˝ -->    <pagination role="newpage"/>
    <pagination role="newpage"/>
<!--  %“bibliography–IEEEabrv,references˝ 
     %Generated by IEEEtranS.bst, version: 1.14 (2015/08/26) -->  </section>
  <bibliography xml:id="bib">
    <title>References</title>
    <biblist>
      <bibitem key="hoover2000stare" xml:id="bib.bib1">
        <tags>
          <tag>[1]</tag>
          <tag role="refnum">1</tag>
        </tags>
        <bibblock>
V. K. A. Hoover and M. Goldbaum, “Locating blood vessels in retinal images by
piece-wise threhsold probing of a matched filter response,” 2000.
</bibblock>
      </bibitem>
      <bibitem key="abadi2016dpsgd" xml:id="bib.bib2">
        <tags>
          <tag>[2]</tag>
          <tag role="refnum">2</tag>
        </tags>
        <bibblock>
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang, “Deep learning with differential privacy,” pp. 308–318, 2016.
[Online]. Available: http://doi.acm.org/10.1145/2976749.2978318
</bibblock>
      </bibitem>
      <bibitem key="abadi2017privatetwoapproaches" xml:id="bib.bib3">
        <tags>
          <tag>[3]</tag>
          <tag role="refnum">3</tag>
        </tags>
        <bibblock>
M. Abadi, Úlfar Erlingsson, I. Goodfellow, H. B. McMahan, N. Papernot,
I. Mironov, K. Talwar, and L. Zhang, “On the protection of private
information in machine learning systems: Two recent approaches,” in
<emph font="italic">IEEE 30th Computer Security Foundations Symposium (CSF)</emph>, 2017, pp.
1–6. [Online]. Available: https://arxiv.org/abs/1708.08022
</bibblock>
      </bibitem>
      <bibitem key="agrawal2000privacy" xml:id="bib.bib4">
        <tags>
          <tag>[4]</tag>
          <tag role="refnum">4</tag>
        </tags>
        <bibblock>
R. Agrawal and R. Srikant, “Privacy-preserving data mining,” in <emph font="italic">Sigmod
Record</emph>.   ACM, 2000.
</bibblock>
      </bibitem>
      <bibitem key="akleylek2016efficient" xml:id="bib.bib5">
        <tags>
          <tag>[5]</tag>
          <tag role="refnum">5</tag>
        </tags>
        <bibblock>
S. Akleylek, N. Bindel, J. Buchmann, J. Krämer, and G. A. Marson, “An
efficient lattice-based signature scheme with provably secure
instantiation,” in <emph font="italic">International Conference on Cryptology in
Africa</emph>.   Springer, 2016.
</bibblock>
      </bibitem>
      <bibitem key="albrecht2018homomorphic" xml:id="bib.bib6">
        <tags>
          <tag>[6]</tag>
          <tag role="refnum">6</tag>
        </tags>
        <bibblock>
M. Albrecht, M. Chase, H. Chen, J. Ding, Goldwasser <emph font="italic">et al.</emph>,
“Homomorphic encryption standard,” 2018.
</bibblock>
      </bibitem>
      <bibitem key="severityscale" xml:id="bib.bib7">
        <tags>
          <tag>[7]</tag>
          <tag role="refnum">7</tag>
        </tags>
        <bibblock>
American Academy of Ophthalmology, “International clinical diabetic
retinopathy disease severity scale detailed table.” 2002.
</bibblock>
      </bibitem>
      <bibitem key="bae2018securityprivacyissues" xml:id="bib.bib8">
        <tags>
          <tag>[8]</tag>
          <tag role="refnum">8</tag>
        </tags>
        <bibblock>
H. Bae, J. Jang, D. Jung, H. Jang, H. Ha, and S. Yoon, “Security
and Privacy Issues in Deep Learning,” <emph font="italic">ArXiv e-prints</emph>, Jul. 2018.
</bibblock>
      </bibitem>
      <bibitem key="bajard2016full" xml:id="bib.bib9">
        <tags>
          <tag>[9]</tag>
          <tag role="refnum">9</tag>
        </tags>
        <bibblock><!--  %**** main.tex Line 1425 **** -->
J.-C. Bajard, J. Eynard, A. Hasan, and V. Zucca, “A full rns variant of fv
like somewhat homomorphic encryption schemes,” in <emph font="italic">Selected Areas in
Cryptography</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="bengio2012deep" xml:id="bib.bib10">
        <tags>
          <tag>[10]</tag>
          <tag role="refnum">10</tag>
        </tags>
        <bibblock>
Y. Bengio, “Deep learning of representations for unsupervised and transfer
learning,” in <emph font="italic">Proceedings of ICML Workshop on Unsupervised and
Transfer Learning</emph>, 2012, pp. 17–36.
</bibblock>
      </bibitem>
      <bibitem key="florian2017fastdiscretize" xml:id="bib.bib11">
        <tags>
          <tag>[11]</tag>
          <tag role="refnum">11</tag>
        </tags>
        <bibblock>
F. Bourse, M. Minelli, M. Minihold, and P. Paillier, “Fast homomorphic
evaluation of deep discretized neural networks,” <emph font="italic">IACR Cryptology
ePrint Archive</emph>, vol. 2017, p. 1114, 2017.
</bibblock>
      </bibitem>
      <bibitem key="brakerski2014efficient" xml:id="bib.bib12">
        <tags>
          <tag>[12]</tag>
          <tag role="refnum">12</tag>
        </tags>
        <bibblock>
Z. Brakerski and V. Vaikuntanathan, “Efficient fully homomorphic encryption
from (standard) lwe,” <emph font="italic">Journal on Computing</emph>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="brickell2009privacy" xml:id="bib.bib13">
        <tags>
          <tag>[13]</tag>
          <tag role="refnum">13</tag>
        </tags>
        <bibblock>
J. Brickell and V. Shmatikov, “Privacy-preserving classifier learning,” in
<emph font="italic">International Conference on Financial Cryptography and Data
Security</emph>.   Springer, 2009.
</bibblock>
      </bibitem>
      <bibitem key="brisebarre2006computing" xml:id="bib.bib14">
        <tags>
          <tag>[14]</tag>
          <tag role="refnum">14</tag>
        </tags>
        <bibblock>
N. Brisebarre, J.-M. Muller, and A. Tisserand, “Computing machine-efficient
polynomial approximations,” <emph font="italic">Transactions on Mathematical Software</emph><!--  %**** main.tex Line 1450 **** -->,
2006.
</bibblock>
      </bibitem>
      <bibitem key="chabanne2017privacy" xml:id="bib.bib15">
        <tags>
          <tag>[15]</tag>
          <tag role="refnum">15</tag>
        </tags>
        <bibblock>
H. Chabanne, A. de Wargny, J. Milgram, C. Morel, and E. Prouff,
“Privacy-preserving classification on deep neural network.” <emph font="italic">IACR
Cryptology ePrint Archive</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="chaudhuri2011differentially" xml:id="bib.bib16">
        <tags>
          <tag>[16]</tag>
          <tag role="refnum">16</tag>
        </tags>
        <bibblock>
K. Chaudhuri, C. Monteleoni, and A. D. Sarwate, “Differentially private
empirical risk minimization,” <emph font="italic">JMLR</emph>, 2011.
</bibblock>
      </bibitem>
      <bibitem key="seal23" xml:id="bib.bib17">
        <tags>
          <tag>[17]</tag>
          <tag role="refnum">17</tag>
        </tags>
        <bibblock>
H. Chen, K. Han, Z. Huang, A. Jalali, and K. Laine, “Simple encrypted
arithmetic library v2.3.0,” Microsoft Research TechReport, 2017.
</bibblock>
      </bibitem>
      <bibitem key="cheon2017privacy" xml:id="bib.bib18">
        <tags>
          <tag>[18]</tag>
          <tag role="refnum">18</tag>
        </tags>
        <bibblock>
J. H. Cheon, J. Jeong, J. Lee, and K. Lee, “Privacy-preserving computations of
predictive medical models with minimax approximation and non-adjacent form,”
in <emph font="italic">International Conference on Financial Cryptography and Data
Security</emph>.   Springer, 2017.
</bibblock>
      </bibitem>
      <bibitem key="chung2014empirical" xml:id="bib.bib19">
        <tags>
          <tag>[19]</tag>
          <tag role="refnum">19</tag>
        </tags>
        <bibblock>
J. Chung, C. Gulcehre, K. Cho, and Y. Bengio, “Empirical evaluation of gated
recurrent neural networks on sequence modeling,” <emph font="italic">arXiv</emph>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="deng2009imagenet" xml:id="bib.bib20">
        <tags>
          <tag>[20]</tag>
          <tag role="refnum">20</tag>
        </tags>
        <bibblock>
J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei, “Imagenet: A
large-scale hierarchical image database,” in <emph font="italic">Computer Vision and
Pattern Recognition, 2009. CVPR 2009. IEEE Conference on</emph>.   IEEE, 2009, pp. 248–255.
</bibblock>
      </bibitem>
      <bibitem key="dugas2001incorporating" xml:id="bib.bib21">
        <tags>
          <tag>[21]</tag>
          <tag role="refnum">21</tag>
        </tags>
        <bibblock>
C. Dugas, Y. Bengio, F. Bélisle, C. Nadeau, and R. Garcia, “Incorporating
second-order functional knowledge for better option pricing,” in
<emph font="italic">NIPS</emph>, 2001.
</bibblock>
      </bibitem>
      <bibitem key="dwork2008differential" xml:id="bib.bib22">
        <tags>
          <tag>[22]</tag>
          <tag role="refnum">22</tag>
        </tags>
        <bibblock>
C. Dwork, “Differential privacy: A survey of results,” in <emph font="italic">International
Conference on Theory and Applications of Models of Computation</emph>.   Springer, 2008.
</bibblock>
      </bibitem>
      <bibitem key="elgamal1985public" xml:id="bib.bib23">
        <tags>
          <tag>[23]</tag>
          <tag role="refnum">23</tag>
        </tags>
        <bibblock>
T. ElGamal, “A public key cryptosystem and a signature scheme based on
discrete logarithms,” <emph font="italic">Transactions on Information Theory</emph>, 1985.
</bibblock>
      </bibitem>
      <bibitem key="Fredrikson:2015:MIA:2810103.2813677" xml:id="bib.bib24">
        <tags>
          <tag>[24]</tag>
          <tag role="refnum">24</tag>
        </tags>
        <bibblock>
M. Fredrikson, S. Jha, and T. Ristenpart, “Model inversion attacks that
exploit confidence information and basic countermeasures,” in
<emph font="italic"><!--  %**** main.tex Line 1500 **** -->Proceedings of the 22Nd ACM SIGSAC Conference on Computer and
Communications Security</emph>, ser. CCS ’15.   New York, NY, USA: ACM, 2015, pp. 1322–1333. [Online].
Available: http://doi.acm.org/10.1145/2810103.2813677
</bibblock>
      </bibitem>
      <bibitem key="gautier2016globally" xml:id="bib.bib25">
        <tags>
          <tag>[25]</tag>
          <tag role="refnum">25</tag>
        </tags>
        <bibblock>
A. Gautier, Q. N. Nguyen, and M. Hein, “Globally optimal training of
generalized polynomial neural networks with nonlinear spectral methods,” in
<emph font="italic">NIPS</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="gentry2009fully" xml:id="bib.bib26">
        <tags>
          <tag>[26]</tag>
          <tag role="refnum">26</tag>
        </tags>
        <bibblock>
C. Gentry <emph font="italic">et al.</emph>, “Fully homomorphic encryption using ideal lattices.”
in <emph font="italic">STOC</emph>, 2009.
</bibblock>
      </bibitem>
      <bibitem key="ghodsi2017safetynets" xml:id="bib.bib27">
        <tags>
          <tag>[27]</tag>
          <tag role="refnum">27</tag>
        </tags>
        <bibblock>
Z. Ghodsi, T. Gu, and S. Garg, “Safetynets: Verifiable execution of deep
neural networks on an untrusted cloud,” in <emph font="italic">NIPS</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="irene2017ridge" xml:id="bib.bib28">
        <tags>
          <tag>[28]</tag>
          <tag role="refnum">28</tag>
        </tags>
        <bibblock>
I. Giacomelli, S. Jha, M. Joye, C. D. Page, and K. Yoon, “Privacy-preserving
ridge regression with only linearly-homomorphic encryption,” Cryptology
ePrint Archive, 2017.
</bibblock>
      </bibitem>
      <bibitem key="gilad2016cryptonets" xml:id="bib.bib29">
        <tags>
          <tag>[29]</tag>
          <tag role="refnum">29</tag>
        </tags>
        <bibblock><!--  %**** main.tex Line 1525 **** -->
R. Gilad-Bachrach, N. Dowlin, K. Laine, K. Lauter, M. Naehrig, and J. Wernsing,
“Cryptonets: Applying neural networks to encrypted data with high throughput
and accuracy,” in <emph font="italic">ICML</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="glorot2011deep" xml:id="bib.bib30">
        <tags>
          <tag>[30]</tag>
          <tag role="refnum">30</tag>
        </tags>
        <bibblock>
X. Glorot, A. Bordes, and Y. Bengio, “Deep sparse rectifier neural networks,”
in <emph font="italic">AISTATS</emph>, 2011.
</bibblock>
      </bibitem>
      <bibitem key="greenspan2016guest" xml:id="bib.bib31">
        <tags>
          <tag>[31]</tag>
          <tag role="refnum">31</tag>
        </tags>
        <bibblock>
H. Greenspan, B. van Ginneken, and R. M. Summers, “Guest editorial deep
learning in medical imaging: Overview and future promise of an exciting new
technique,” <emph font="italic">IEEE Transactions on Medical Imaging</emph>, vol. 35, no. 5, pp.
1153–1159, 2016.
</bibblock>
      </bibitem>
      <bibitem key="gulshan2016development" xml:id="bib.bib32">
        <tags>
          <tag>[32]</tag>
          <tag role="refnum">32</tag>
        </tags>
        <bibblock>
V. Gulshan, , L. Peng <emph font="italic">et al.</emph>, “Development and validation of a deep
learning algorithm for detection of diabetic retinopathy in retinal fundus
photographs,” <emph font="italic">Jama</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="guo2016dynamic" xml:id="bib.bib33">
        <tags>
          <tag>[33]</tag>
          <tag role="refnum">33</tag>
        </tags>
        <bibblock>
Y. Guo, A. Yao, and Y. Chen, “Dynamic network surgery for efficient dnns,” in
<emph font="italic">NIPS</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="hall2011secure" xml:id="bib.bib34">
        <tags>
          <tag>[34]</tag>
          <tag role="refnum">34</tag>
        </tags>
        <bibblock>
R. Hall, S. E. Fienberg, and Y. Nardi, “Secure multiple linear regression
based on homomorphic encryption,” <emph font="italic">Journal of Official Statistics</emph><!--  %**** main.tex Line 1550 **** -->,
2011.
</bibblock>
      </bibitem>
      <bibitem key="han2015deep" xml:id="bib.bib35">
        <tags>
          <tag>[35]</tag>
          <tag role="refnum">35</tag>
        </tags>
        <bibblock>
S. Han, H. Mao, and W. J. Dally, “Deep compression: Compressing deep neural
networks with pruning, trained quantization and huffman coding,”
<emph font="italic">ICLR</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="harvey2014faster" xml:id="bib.bib36">
        <tags>
          <tag>[36]</tag>
          <tag role="refnum">36</tag>
        </tags>
        <bibblock>
D. Harvey, “Faster arithmetic for number-theoretic transforms,” <emph font="italic">Journal
of Symbolic Computation</emph>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="he2015resnet" xml:id="bib.bib37">
        <tags>
          <tag>[37]</tag>
          <tag role="refnum">37</tag>
        </tags>
        <bibblock>
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” <emph font="italic">CoRR</emph>, vol. abs/1512.03385, 2015. [Online]. Available:
http://arxiv.org/abs/1512.03385
</bibblock>
      </bibitem>
      <bibitem key="hesamifard2017cryptodl" xml:id="bib.bib38">
        <tags>
          <tag>[38]</tag>
          <tag role="refnum">38</tag>
        </tags>
        <bibblock>
E. Hesamifard, H. Takabi, and M. Ghasemi, “Cryptodl: Deep neural networks over
encrypted data,” <emph font="italic">arXiv</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="hinton2006reducing" xml:id="bib.bib39">
        <tags>
          <tag>[39]</tag>
          <tag role="refnum">39</tag>
        </tags>
        <bibblock>
G. E. Hinton and R. R. Salakhutdinov, “Reducing the dimensionality of data
with neural networks,” <emph font="italic">science</emph><!--  %**** main.tex Line 1575 **** -->, vol. 313, no. 5786, pp. 504–507,
2006.
</bibblock>
      </bibitem>
      <bibitem key="hornik1991approximation" xml:id="bib.bib40">
        <tags>
          <tag>[40]</tag>
          <tag role="refnum">40</tag>
        </tags>
        <bibblock>
K. Hornik, “Approximation capabilities of multilayer feedforward networks,”
<emph font="italic">Neural networks</emph>, 1991.
</bibblock>
      </bibitem>
      <bibitem key="ioffe2015batch" xml:id="bib.bib41">
        <tags>
          <tag>[41]</tag>
          <tag role="refnum">41</tag>
        </tags>
        <bibblock>
S. Ioffe and C. Szegedy, “Batch normalization: Accelerating deep network
training by reducing internal covariate shift,” in <emph font="italic">ICML</emph>, 2015.
</bibblock>
      </bibitem>
      <bibitem key="kolesnikov2008improved" xml:id="bib.bib42">
        <tags>
          <tag>[42]</tag>
          <tag role="refnum">42</tag>
        </tags>
        <bibblock>
V. Kolesnikov and T. Schneider, “Improved garbled circuit: Free xor gates and
applications,” in <emph font="italic">International Colloquium on Automata, Languages, and
Programming</emph>.   Springer, 2008.
</bibblock>
      </bibitem>
      <bibitem key="cifar10" xml:id="bib.bib43">
        <tags>
          <tag>[43]</tag>
          <tag role="refnum">43</tag>
        </tags>
        <bibblock>
A. Krizhevsky, V. Nair, and G. Hinton, “Cifar-10 (canadian institute for
advanced research).” [Online]. Available:
http://www.cs.toronto.edu/ kriz/cifar.html
</bibblock>
      </bibitem>
      <bibitem key="lecun1995convolutional" xml:id="bib.bib44">
        <tags>
          <tag>[44]</tag>
          <tag role="refnum">44</tag>
        </tags>
        <bibblock>
Y. LeCun, Y. Bengio <emph font="italic">et al.</emph>, “Convolutional networks for images, speech,
and time series,” <emph font="italic">The handbook of brain theory and neural networks</emph><!--  %**** main.tex Line 1600 **** -->,
1995.
</bibblock>
      </bibitem>
      <bibitem key="livni2014computational" xml:id="bib.bib45">
        <tags>
          <tag>[45]</tag>
          <tag role="refnum">45</tag>
        </tags>
        <bibblock>
R. Livni <emph font="italic">et al.</emph>, “On the computational efficiency of training neural
networks,” in <emph font="italic">NIPS</emph>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="luo2017thinet" xml:id="bib.bib46">
        <tags>
          <tag>[46]</tag>
          <tag role="refnum">46</tag>
        </tags>
        <bibblock>
J.-H. Luo, J. Wu, and W. Lin, “Thinet: A filter level pruning method for deep
neural network compression,” <emph font="italic">arXiv</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="ma2005constructive" xml:id="bib.bib47">
        <tags>
          <tag>[47]</tag>
          <tag role="refnum">47</tag>
        </tags>
        <bibblock>
L. Ma and K. Khorasani, “Constructive feedforward neural networks using
hermite polynomial activation functions,” <emph font="italic">Transactions on Neural
Networks</emph>, 2005.
</bibblock>
      </bibitem>
      <bibitem key="mcsherry2009privacyaccounting" xml:id="bib.bib48">
        <tags>
          <tag>[48]</tag>
          <tag role="refnum">48</tag>
        </tags>
        <bibblock>
F. D. McSherry, “Privacy integrated queries: An extensible platform for
privacy-preserving data analysis,” <emph font="italic">SIGMOD</emph>, 2009.
</bibblock>
      </bibitem>
      <bibitem key="Migliore:2017:HAH:3145508.3126558" xml:id="bib.bib49">
        <tags>
          <tag>[49]</tag>
          <tag role="refnum">49</tag>
        </tags>
        <bibblock>
V. Migliore, C. Seguin, M. M. Real, V. Lapotre, A. Tisserand, C. Fontaine,
G. Gogniat, and R. Tessier, “A high-speed accelerator for homomorphic
encryption using the karatsuba algorithm,” <emph font="italic">ACM Trans. Embed. Comput.
Syst.</emph><!--  %**** main.tex Line 1625 **** -->, vol. 16, no. 5s, pp. 138:1–138:17, Sep. 2017. [Online]. Available:
http://doi.acm.org/10.1145/3126558
</bibblock>
      </bibitem>
      <bibitem key="mohassel2017secureml" xml:id="bib.bib50">
        <tags>
          <tag>[50]</tag>
          <tag role="refnum">50</tag>
        </tags>
        <bibblock>
P. Mohassel and Y. Zhang, “Secureml: A system for scalable privacy-preserving
machine learning,” in <emph font="italic">Symposium on Security and Privacy</emph>.   IEEE, 2017.
</bibblock>
      </bibitem>
      <bibitem key="naehrig2011can" xml:id="bib.bib51">
        <tags>
          <tag>[51]</tag>
          <tag role="refnum">51</tag>
        </tags>
        <bibblock>
M. Naehrig, K. Lauter, and V. Vaikuntanathan, “Can homomorphic encryption be
practical?” in <emph font="italic">ACM Workshop on Cloud computing security</emph>.   ACM, 2011.
</bibblock>
      </bibitem>
      <bibitem key="papernot2016semi" xml:id="bib.bib52">
        <tags>
          <tag>[52]</tag>
          <tag role="refnum">52</tag>
        </tags>
        <bibblock>
N. Papernot, M. Abadi, U. Erlingsson, I. Goodfellow, and K. Talwar,
“Semi-supervised knowledge transfer for deep learning from private training
data,” <emph font="italic">ICLR</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="papernot2018scalable" xml:id="bib.bib53">
        <tags>
          <tag>[53]</tag>
          <tag role="refnum">53</tag>
        </tags>
        <bibblock>
N. Papernot, S. Song, I. Mironov, A. Raghunathan, K. Talwar, and
Ú. Erlingsson, “Scalable private learning with pate,” <emph font="italic">arXiv
preprint arXiv:1802.08908</emph>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="piazza1992artificial" xml:id="bib.bib54">
        <tags>
          <tag>[54]</tag>
          <tag role="refnum">54</tag>
        </tags>
        <bibblock><!--  %**** main.tex Line 1650 **** -->
F. Piazza, A. Uncini, and M. Zenobi, “Artificial neural networks with adaptive
polynomial activation function,” 1992.
</bibblock>
      </bibitem>
      <bibitem key="ramachandran2017swish" xml:id="bib.bib55">
        <tags>
          <tag>[55]</tag>
          <tag role="refnum">55</tag>
        </tags>
        <bibblock>
P. Ramachandran, B. Zoph, and Q. V. Le, “Swish: a self-gated activation
function,” <emph font="italic">arXiv</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="rivest1978data" xml:id="bib.bib56">
        <tags>
          <tag>[56]</tag>
          <tag role="refnum">56</tag>
        </tags>
        <bibblock>
R. L. Rivest, L. Adleman, and M. L. Dertouzos, “On data banks and privacy
homomorphisms,” <emph font="italic">Foundations of secure computation</emph>, 1978.
</bibblock>
      </bibitem>
      <bibitem key="rouhani2017deepsecure" xml:id="bib.bib57">
        <tags>
          <tag>[57]</tag>
          <tag role="refnum">57</tag>
        </tags>
        <bibblock>
B. D. Rouhani, M. S. Riazi, and F. Koushanfar, “Deepsecure: Scalable
provably-secure deep learning,” <emph font="italic">arXiv</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="russakovsky2015imagenet" xml:id="bib.bib58">
        <tags>
          <tag>[58]</tag>
          <tag role="refnum">58</tag>
        </tags>
        <bibblock>
O. Russakovsky, J. Deng, H. Su, J. Krause, S. Satheesh, S. Ma, Z. Huang,
A. Karpathy, A. Khosla, M. Bernstein <emph font="italic">et al.</emph>, “Imagenet large scale
visual recognition challenge,” <emph font="italic">International Journal of Computer
Vision</emph>, 2015.
</bibblock>
      </bibitem>
      <bibitem key="sanyal2018tapas" xml:id="bib.bib59">
        <tags>
          <tag>[59]</tag>
          <tag role="refnum">59</tag>
        </tags>
        <bibblock>
A. Sanyal, M. J. Kusner, A. Gascón, and V. Kanade, “TAPAS: Tricks
to Accelerate (encrypted) Prediction As a Service,” <emph font="italic">ArXiv e-prints</emph>,
Jun. 2018.
</bibblock>
      </bibitem>
      <bibitem key="shokri2015privacy" xml:id="bib.bib60">
        <tags>
          <tag>[60]</tag>
          <tag role="refnum">60</tag>
        </tags>
        <bibblock>
R. Shokri and V. Shmatikov, “Privacy-preserving deep learning,” in
<emph font="italic">Proceedings of the 22nd ACM SIGSAC conference on computer and
communications security</emph>.   ACM, 2015,
pp. 1310–1321.
</bibblock>
      </bibitem>
      <bibitem key="song2013stochastic" xml:id="bib.bib61">
        <tags>
          <tag>[61]</tag>
          <tag role="refnum">61</tag>
        </tags>
        <bibblock>
S. Song, K. Chaudhuri, and A. D. Sarwate, “Stochastic gradient descent with
differentially private updates,” in <emph font="italic">Global Conference on Signal and
Information Processing (GlobalSIP), 2013 IEEE</emph>.   IEEE, 2013, pp. 245–248.
</bibblock>
      </bibitem>
      <bibitem key="szegedy2015inception" xml:id="bib.bib62">
        <tags>
          <tag>[62]</tag>
          <tag role="refnum">62</tag>
        </tags>
        <bibblock>
C. Szegedy, V. Vanhoucke, S. Ioffe, J. Shlens, and Z. Wojna, “Rethinking the
inception architecture for computer vision,” <emph font="italic">CoRR</emph>, vol.
abs/1512.00567, 2015. [Online]. Available:
http://arxiv.org/abs/1512.00567
</bibblock>
      </bibitem>
      <bibitem key="tajbakhsh2016convolutional" xml:id="bib.bib63">
        <tags>
          <tag>[63]</tag>
          <tag role="refnum">63</tag>
        </tags>
        <bibblock>
N. Tajbakhsh, J. Y. Shin, S. R. Gurudu, R. T. Hurst, C. B. Kendall, M. B.
Gotway, and J. Liang, “Convolutional neural networks for medical image
analysis: Full training or fine tuning?” <emph font="italic">IEEE transactions on medical
imaging</emph>, vol. 35, no. 5, pp. 1299–1312, 2016.
</bibblock>
      </bibitem>
      <bibitem key="toghi2018mnistknn" xml:id="bib.bib64">
        <tags>
          <tag>[64]</tag>
          <tag role="refnum">64</tag>
        </tags>
        <bibblock>
B. Toghi and D. Grover, “MNIST Dataset Classification Utilizing k-NN
Classifier with Modified Sliding Window Metric,” <emph font="italic">ArXiv e-prints</emph>,
Sep. 2018.
</bibblock>
      </bibitem>
      <bibitem key="tramer2016stealingapis" xml:id="bib.bib65">
        <tags>
          <tag>[65]</tag>
          <tag role="refnum">65</tag>
        </tags>
        <bibblock>
F. Tramèr, F. Zhang, A. Juels, M. K. Reiter, and T. Ristenpart,
“Stealing machine learning models via prediction apis,” <emph font="italic">CoRR</emph>, vol.
abs/1609.02943, 2016. [Online]. Available:
http://arxiv.org/abs/1609.02943
</bibblock>
      </bibitem>
      <bibitem key="replicationstudy" xml:id="bib.bib66">
        <tags>
          <tag>[66]</tag>
          <tag role="refnum">66</tag>
        </tags>
        <bibblock>
M. Voets, K. Møllersen, and L. Ailo Bongo, “Replication study:
Development and validation of deep learning algorithm for detection of
diabetic retinopathy in retinal fundus photographs,” <emph font="italic">ArXiv e-prints</emph>,
Mar. 2018.
</bibblock>
      </bibitem>
      <bibitem key="wen2016learning" xml:id="bib.bib67">
        <tags>
          <tag>[67]</tag>
          <tag role="refnum">67</tag>
        </tags>
        <bibblock>
W. Wen <emph font="italic">et al.</emph>, “Learning structured sparsity in deep neural networks,”
in <emph font="italic">NIPS</emph>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="xie2014crypto" xml:id="bib.bib68">
        <tags>
          <tag>[68]</tag>
          <tag role="refnum">68</tag>
        </tags>
        <bibblock><!--  %**** main.tex Line 1725 **** -->
P. Xie, M. Bilenko, T. Finley, R. Gilad-Bachrach, K. Lauter, and M. Naehrig,
“Crypto-nets: Neural networks over encrypted data,” <emph font="italic">arXiv</emph>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="yao1986generate" xml:id="bib.bib69">
        <tags>
          <tag>[69]</tag>
          <tag role="refnum">69</tag>
        </tags>
        <bibblock>
A. C.-C. Yao, “How to generate and exchange secrets,” in <emph font="italic">Foundations of
Computer Science</emph>.   IEEE, 1986.
</bibblock>
      </bibitem>
      <bibitem key="zhang2018privatereleasing" xml:id="bib.bib70">
        <tags>
          <tag>[70]</tag>
          <tag role="refnum">70</tag>
        </tags>
        <bibblock>
X. Zhang, S. Ji, and T. Wang, “Differentially private releasing via deep
generative model,” <emph font="italic">CoRR</emph>, vol. abs/1801.01594, 2018. [Online].
Available: http://arxiv.org/abs/1801.01594
</bibblock>
      </bibitem>
      <bibitem key="zhou2017incremental" xml:id="bib.bib71">
        <tags>
          <tag>[71]</tag>
          <tag role="refnum">71</tag>
        </tags>
        <bibblock>
A. Zhou, A. Yao, Y. Guo, L. Xu, and Y. Chen, “Incremental network
quantization: Towards lossless cnns with low-precision weights,”
<emph font="italic">ICLR</emph>, 2017.
</bibblock>
      </bibitem>
    </biblist>
  </bibliography>
</document>
