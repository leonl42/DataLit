<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-9PVqZ-IR_"?>
<?latexml class="article"?>
<!--  %Copied &amp; adapted from --><!--  %https://github.com/dustinvtran/latex-templates/blob/master/papers/preamble/preamble.tex --><?latexml package="amsmath, amssymb, amsthm"?>
<?latexml package="mathtools"?>
<?latexml package="bbm"?>
<?latexml package="dsfont"?>
<?latexml package="xcolor" options="usenames,dvipsnames"?>
<!--  %# COUNTERS --><!--  %**** preamble.tex Line 25 **** --><!--  %# FIGURES --><?latexml package="graphicx"?>
<?latexml package="caption" options="labelfont=bf"?>
<?latexml package="subcaption" options="format=hang"?>
<!--  %# TABLES --><?latexml package="booktabs, array"?>
<?latexml package="multirow"?>
<!--  %# ALGORITHMS --><?latexml package="algorithm2e" options="algoruled"?>
<?latexml package="listings"?>
<?latexml package="fancyvrb"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<?latexml package="natbib"?>
<?latexml package="hyperref" options="colorlinks,linktoc=all,pagebackref=true"?>
<?latexml package="caption" options="hypcap=true"?>
<?latexml package="cleveref" options="nameinlink,capitalise"?>
<?latexml package="glossaries" options="acronym,nowarn,section,nogroupskip,nonumberlist"?>
<?latexml package="iclr2023_conference,times"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <resource src="ltx-listings.css" type="text/css"/>
  <para xml:id="p1">
    <ERROR class="undefined">\fvset</ERROR>
    <p><!--  %# BIBLIOGRAPHY AND LINKS -->fontsize=




<ERROR class="undefined">\creflabelformat</ERROR><!--  %¡- remove parenthesis from equations -->equation#2#1#3 



<!--  %# CODE SNIPPETS --><ERROR class="undefined">\glsdisablehyper</ERROR>
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Gaussian Processes]gp<text font="smallcaps">gp</text>Gaussian Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Conditional Neural Processes]cnp<text font="smallcaps">cnp</text>Conditional Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Neural Processes]np<text font="smallcaps">np</text>Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Neural Process Families]npf<text font="smallcaps">npf</text>Neural Process Family
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Attentive Neural Processes]anp<text font="smallcaps">anp</text>Attentive Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Conditional Attentive Neural Processes]canp<text font="smallcaps">canp</text>Conditional Attentive Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Convolutional Conditional Neural Processes]convcnp<text font="smallcaps">c</text>onv<text font="smallcaps">cnp</text>Convolutional Conditional Neural Processes
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Convolutional Neural Processes]convnp<text font="smallcaps">c</text>onv<text font="smallcaps">np</text>Convolutional Neural Processes
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Bootstrapping Neural Processes]bnp<text font="smallcaps">bnp</text>Bootstrapping Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Neural Bootstrapping Neural Processes]neubnp<text font="smallcaps">n</text>eu<text font="smallcaps">bnp</text>Neural Bootstrapping Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Martingale Posterior Neural Processes]mpnp<text font="smallcaps">mpnp</text>Martingale Posterior Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Bootstrapping Attentive Neural Processes]banp<text font="smallcaps">banp</text>Bootstrapping Attentive Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Neural Bootstrapping Attentive Neural Processes]neubanp<text font="smallcaps">n</text>eu<text font="smallcaps">banp</text>Neural Bootstrapping Attentive Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Martingale Posterior Attentive Neural Processes]mpanp<text font="smallcaps">mpanp</text>Martingale Posterior Attentive Neural Process
<ERROR class="undefined">\newacronym</ERROR>[<ERROR class="undefined">\glslongpluralkey</ERROR>=Multi-Layer Perceptrons]mlp<text font="smallcaps">mlp</text>Multi-Layer Perceptron
<ERROR class="undefined">\newacronym</ERROR>elbo<text font="smallcaps">elbo</text>Evidence Lower BOund
<ERROR class="undefined">\newacronym</ERROR>cidc.i.d.conditionally identically distributed
<ERROR class="undefined">\newacronym</ERROR>mab<text font="smallcaps">mab</text>Multihead Attention Block
<ERROR class="undefined">\newacronym</ERROR>isab<text font="smallcaps">isab</text><!--  %**** math.tex Line 200 **** --><!--  %Optional math commands from https://github.com/goodfeli/dlbook˙notation. 
     %“input–math˙commands.tex˝ 
     %“usepackage–hyperref˝ 
     %“usepackage–url˝ 
     %“input–preamble/preamble˝ -->Induced Self-Attention Block







































































































































































































 










<!--  %The “author macro works with any number of authors. There are two commands 
     %used to separate the names and addresses of multiple authors: “And and “AND. 
     %Using “And between authors leaves it to “LaTeX–˝ to determine where to break 
     %the lines. Using “AND forces a linebreak at that point. So, if “LaTeX–˝ 
     %puts 3 of 4 authors names on the first line, and the last on the second 
     %line, try using “AND instead of “And before the third author name. --><ERROR class="undefined">\iclrfinalcopy</ERROR><!--  %Uncomment for camera-ready version, but NOT for submission. --></p>
  </para>
  <title>Martingale Posterior Neural Processes</title>
  <creator role="author">
    <personname><!--  %Authors must not appear in the submitted version. They should be hidden -->Hyungi Lee<!--  %as long as the “iclrfinalcopy macro remains commented out below. 
     %Non-anonymous submissions will be rejected without review. --><sup><text font="italic">1</text></sup>, Eunggu Yun<sup><text font="italic">1</text></sup>, Giung Nam<sup><text font="italic">1</text></sup>, Edwin Fong<sup><text font="italic">2</text></sup>, Juho Lee<sup><text font="italic">1,3</text></sup> <break/>
<break/><sup>1</sup>KAIST, <sup>2</sup>Novo Nordisk, <sup>3</sup>AITRICS <break/><sup><text fontsize="80%">1</text></sup><text font="typewriter" fontsize="80%">{lhk2708, eunggu.yun, giung, juholee}@kaist.ac.kr, <sup><text font="serif">2</text></sup>chef@novonordisk.com<text font="serif">
</text></text></personname>
  </creator>
  <abstract name="Abstract">
    <p>A <ERROR class="undefined">\gls</ERROR>np estimates a stochastic process implicitly defined with neural networks given a stream of data, rather than pre-specifying priors already known, such as Gaussian processes. An ideal <ERROR class="undefined">\gls</ERROR>np would learn everything from data without any inductive biases, but in practice, we often restrict the class of stochastic processes for the ease of estimation. One such restriction is the use of a finite-dimensional latent variable accounting for the uncertainty in the functions drawn from <ERROR class="undefined">\glspl</ERROR>np. Some recent works show that this can be improved with more “data-driven” source of uncertainty such as bootstrapping. In this work, we take a different approach based on the martingale posterior, a recently developed alternative to Bayesian inference. For the martingale posterior, instead of specifying prior-likelihood pairs, a predictive distribution for future data is specified. Under specific conditions on the predictive distribution, it can be shown that the uncertainty in the generated future data actually corresponds to the uncertainty of the implicitly defined Bayesian posteriors. Based on this result, instead of assuming any form of the latent variables, we equip a <ERROR class="undefined">\gls</ERROR>np with a predictive distribution implicitly defined with neural networks and use the corresponding martingale posteriors as the source of uncertainty. The resulting model, which we name as <ERROR class="undefined">\gls</ERROR>mpnp, is demonstrated to outperform baselines on various tasks.</p>
  </abstract>
  <section inlist="toc" labels="LABEL:main:sec:introduction" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->    <para xml:id="S1.p1">
      <ERROR class="undefined">\glsresetall</ERROR>
    </para>
    <para xml:id="S1.p2">
      <p><!--  %“ljh–Just a draft. need polishing and proofreading˝ -->A <ERROR class="undefined">\gls</ERROR>np <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018conditional,garnelo2018neural" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> meta-learns a stochastic process describing the relationship between inputs and outputs in a given data stream, where each task in the data stream consists of a meta-training set of input-output pairs and also a meta-validation set. The <ERROR class="undefined">\gls</ERROR>np then defines an implicit stochastic process whose functional form is determined by a neural network taking the meta-training set as an input, and the parameters of the neural network are optimized to maximize the predictive likelihood for the meta-validation set. This approach is philosophically different from the traditional learning pipeline where one would first elicit a stochastic process from the known class of models (e.g., <ERROR class="undefined">\glspl</ERROR>gp) and hope that it describes the data well. An ideal <ERROR class="undefined">\gls</ERROR>np would assume minimal inductive biases and learn as much as possible from the data. In this regard, <ERROR class="undefined">\glspl</ERROR>np can be framed as a “data-driven” way of choosing proper stochastic processes.</p>
    </para>
    <para xml:id="S1.p3">
      <p>An important design choice for a <ERROR class="undefined">\gls</ERROR>np model is how to capture the uncertainty in the random functions drawn from stochastic processes. When mapping the meta-training set into a function, one might employ a deterministic mapping as in <cite class="ltx_citemacro_citet"><bibref bibrefs="garnelo2018conditional" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite>. However, it is more natural to assume that there may be multiple plausible functions that might have generated the given data, and thus encode the functional (epistemic) uncertainty as a part of the <ERROR class="undefined">\gls</ERROR>np model. <cite class="ltx_citemacro_citet"><bibref bibrefs="garnelo2018neural" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite> later proposed to map the meta-training set into a fixed dimensional <emph font="italic">global latent variable</emph> with a Gaussian posterior approximation. While this improves upon the vanilla model without such a latent variable <cite class="ltx_citemacro_citep">[<bibref bibrefs="le2018empirical" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>, expressing the functional uncertainty only through the Gaussian approximated latent variable has been reported to be a bottleneck <cite class="ltx_citemacro_citep">[<bibref bibrefs="louizos2019functional" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>. To this end, <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2020bootstrapping" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite> and <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2022neural" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite> propose to apply bootstrap to the meta-training set to use the uncertainty arising from the population distribution as a source for the functional uncertainty.</p>
    </para>
    <para xml:id="S1.p4">
      <p>In this paper, we take a rather different approach to define the functional uncertainty for <ERROR class="undefined">\glspl</ERROR>np. Specifically, we utilize the martingale posterior distribution <cite class="ltx_citemacro_citep">[<bibref bibrefs="fong2021martingale" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>, a recently developed alternative to conventional Bayesian inference. In the martingale posterior, instead of eliciting a likelihood-prior pair and inferring the Bayesian posterior, we elicit a joint predictive distribution on future data given observed data. Under suitable conditions on such a predictive distribution, it can be shown that the uncertainty due to the generated future data indeed corresponds to the uncertainty of the Bayesian posterior. Following this, we endow a <ERROR class="undefined">\gls</ERROR><!--  %“ed–Does the following make sense: ˝ -->np with a joint predictive distribution defined through neural networks and derive the functional uncertainty as the uncertainty arising when mapping the randomly generated future data to the functions. Compared to the previous approaches of either explicitly positing a finite-dimensional variable encoding the functional uncertainty or deriving it from a population distribution, our method makes minimal assumptions about the predictive distribution and gives more freedom to the model to choose the proper form of uncertainty solely from the data. Due to the theory of martingale posteriors, our model guarantees the existence of the martingale posterior corresponding to the valid Bayesian posterior of an implicitly defined parameter.
Furthermore, working in the space of future observations allows us to incorporate the latent functional uncertainty path with deterministic path in a more natural manner.</p>
    </para>
<!--  %“ljh–It would be good to have more concrete motivation to prefer the martingale posteriors over conventional Bayesian inference; what would be an advantage of doing that, aside from the fact that we don’t need to choose likelihood and prior?˝ “ed–I’ll have a think about this, and will also do some proofreading. Because of the time difference and my job hours, timing might be a bit tricky tomorrow. When would be the best time for me to proofread?˝ -->    <para xml:id="S1.p5">
      <p>We name our extension of <ERROR class="undefined">\glspl</ERROR>np with the joint predictive generative models as the <ERROR class="undefined">\gls</ERROR>mpnp. Throughout the paper, we propose an efficient neural network architecture for the generative model that is easy to implement, flexible, and yet guarantees the existence of the martingale posterior. We also propose a training scheme to stably learn the parameters of <ERROR class="undefined">\glspl</ERROR>mpnp. Using various synthetic and real-world regression tasks, we demonstrate that <ERROR class="undefined">\gls</ERROR>mpnp significantly outperforms the previous <ERROR class="undefined">\gls</ERROR>np variants in terms of predictive performance.</p>
    </para>
<!--  %“gls–npf˝~“citep–garnelo2018conditional, garnelo2018neural˝ is a class of parametric models which defines stochastic processes over given data using neural networks. 
     %**** introduction.tex Line 25 **** 
     %Unlike classical stochastic processes (e.g. “glspl–gp˝), “gls–npf˝ learns to fit a proper stochastic processes from data under meta-learning framework. 
     %The deterministic version of “gls–npf˝, “glspl–cnp˝~“citep–garnelo2018conditional˝ deterministically map each dataset to a certain stochastic process which does not consider functional uncertainty. 
     %In order to compensate for this problem, “glspl–np˝~“citep–garnelo2018neural˝ introduce a global latent variable which captures functional uncertainty. 
     %“citet–le2018empirical˝ empirically shows that considering functional uncertainty in “glspl–np˝ improves the diversity in function realizations and the predictive performance for data. 
     %Although “glspl–np˝ tries to capture functional uncertainty, there is some limitations for “glspl–np˝ to well capture uncertainty with a Gaussian latent variable. 
     %To overcome this problem, there are some prior works which applying advanced functional uncertainty modeling strategies~“citep–lee2020bootstrapping˝“citep–lee2022neural˝ instead of a global latent variable. 
     %“gls–bnp˝~“citep–lee2020bootstrapping˝ employs the residual bootstrapping strategy to make more robust uncertainty estimation even for the data-model mismatch situation. 
     %However, “gls–bnp˝ requires a high computational cost compared to “gls–np˝ due to it’s residual bootstrapping strategy. 
     %“gls–neubnp˝~“citep–lee2022neural˝ employs the recent computationally efficient bootstrapping of the neural network called Neural Bootstrapper~“citep–shin2021neural˝. 
     %However, “gls–neubnp˝ multiplies Dirichlet distributed random bootstrap weights to features of context dataset which disturbs model to well recovers the given dataset. 
     %This paper presents a novel extension of “gls–npf˝ which introduces functional uncertainty by changing posterior uncertainty on function parameters as predictive uncertainty on the unseen data conditional on the observed data... -->  </section>
  <section inlist="toc" labels="LABEL:main:sec:background" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Background</title>
    <subsection inlist="toc" xml:id="S2.SS1">
      <tags>
        <tag>2.1</tag>
        <tag role="autoref">subsection 2.1</tag>
        <tag role="refnum">2.1</tag>
        <tag role="typerefnum">§2.1</tag>
      </tags>
      <title><tag close=" ">2.1</tag>Settings and notations</title>
      <para xml:id="S2.SS1.p1">
        <p>Let <Math mode="inline" tex="{\mathcal{X}}=\mathbb{R}^{{d_{\text{in}}}}" text="X = R ^ (d _ [in])" xml:id="S2.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">X</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                    <XMText><text fontsize="50%">in</text></XMText>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> be an input space and <Math mode="inline" tex="{\mathcal{Y}}=\mathbb{R}^{d_{\text{out}}}" text="Y = R ^ (d _ [out])" xml:id="S2.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">Y</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                    <XMText><text fontsize="50%">out</text></XMText>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> be an output space.
We are given a set of <emph font="italic">tasks</emph> drawn from an (unknown) task distribution, <Math class="ltx_math_unparsed" mode="inline" tex="\tau_{1},\tau_{2},\dots\overset{\mathrm{i.i.d.}}{\sim}p_{\text{task}}(\tau)" text="list@(tau _ 1, tau _ 2, dots * i@.@i@.@d@.@(similar-to) * p _ [task] * tau)" xml:id="S2.SS1.p1.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S2.SS1.p1.m3.5"/>
                  <XMRef idref="S2.SS1.p1.m3.6"/>
                  <XMRef idref="S2.SS1.p1.m3.7"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S2.SS1.p1.m3.5">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S2.SS1.p1.m3.6">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S2.SS1.p1.m3.7">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok name="dots" role="ID">…</XMTok>
                    <XMApp>
                      <XMWrap role="OVERACCENT">
                        <XMTok role="UNKNOWN" xml:id="S2.SS1.p1.m3.1">i</XMTok>
                        <XMTok role="PERIOD">.</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S2.SS1.p1.m3.2">i</XMTok>
                        <XMTok role="PERIOD">.</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S2.SS1.p1.m3.3">d</XMTok>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                      <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMText><text fontsize="70%">task</text></XMText>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.SS1.p1.m3.4"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S2.SS1.p1.m3.4">τ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.
A task <Math mode="inline" tex="\tau" text="tau" xml:id="S2.SS1.p1.m4">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> consists of a dataset <Math mode="inline" tex="Z" text="Z" xml:id="S2.SS1.p1.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
            </XMath>
          </Math> and an index set <Math mode="inline" tex="c" text="c" xml:id="S2.SS1.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>, where <Math mode="inline" tex="Z=\{z_{i}\}_{i=1}^{n}" text="Z = ((set@(z _ i)) _ (i = 1)) ^ n" xml:id="S2.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S2.SS1.p1.m7.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S2.SS1.p1.m7.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> with each <Math mode="inline" tex="z_{i}=(x_{i},y_{i})\in{\mathcal{X}}\times{\mathcal{Y}}" text="z _ i = open-interval@(x _ i, y _ i) element-of X * Y" xml:id="S2.SS1.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p1.m8.1"/>
                    <XMRef idref="S2.SS1.p1.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS1.p1.m8.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S2.SS1.p1.m8.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">y</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">X</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">Y</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a pair of an input and an output. We assume <Math mode="inline" tex="Z" text="Z" xml:id="S2.SS1.p1.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
            </XMath>
          </Math> are i.i.d. conditioned on some function <Math mode="inline" tex="f" text="f" xml:id="S2.SS1.p1.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>. The index set <Math mode="inline" tex="c\subsetneq[n]" text="c subset-of-and-not-equals delimited-[]@(n)" xml:id="S2.SS1.p1.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="subset-of-and-not-equals" name="subsetneq" role="RELOP">⊊</XMTok>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.SS1.p1.m11.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m11.1">n</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="[n]:=\{1,\dots,n\}" text="delimited-[]@(n) assign set@(1, dots, n)" xml:id="S2.SS1.p1.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.SS1.p1.m12.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m12.1">n</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S2.SS1.p1.m12.2"/>
                    <XMRef idref="S2.SS1.p1.m12.3"/>
                    <XMRef idref="S2.SS1.p1.m12.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S2.SS1.p1.m12.2">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="dots" role="ID" xml:id="S2.SS1.p1.m12.3">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m12.4">n</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> defines the <emph font="italic">context set</emph> <Math mode="inline" tex="Z_{c}=\{z_{i}\}_{i\in c}" text="Z _ c = (set@(z _ i)) _ (i element-of c)" xml:id="S2.SS1.p1.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S2.SS1.p1.m13.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S2.SS1.p1.m13.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. The <emph font="italic">target set</emph> <Math mode="inline" tex="Z_{t}" text="Z _ t" xml:id="S2.SS1.p1.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> is defined similarly with the index <Math mode="inline" tex="t:=[n]\setminus c" text="t assign delimited-[]@(n) set-minus c" xml:id="S2.SS1.p1.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok meaning="set-minus" name="setminus" role="ADDOP">∖</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S2.SS1.p1.m15.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m15.1">n</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
<!--  %Let $“calX = “bbR^–“din˝$ be an input space and $“calY = “bbR^“dout$ be an output space. 
     %We are given a set of “emph–tasks˝ drawn from an (unknown) task distribution, $“tau˙1, “tau˙2, “dots “iidsim p˙“text–task˝(“tau)$. 
     %Each task $“tau$ consists of a tuple $“calD = (X, Y)$ and an index set $c “subsetneq [n]$ where $[n] := “–1,“dots, n“˝$. Here, $X = “–x˙i“˝˙–i=1˝^n$ is an input set with $x˙i “in “calX$ and $Y = “–y˙i“˝˙–i=1˝^n$ is an output set with $y˙i “in “calY$. The “emph–context set˝ indexed by $c$ is then defined as $“calD˙c = (X˙c, Y˙c)$ with $X˙c = “–x˙i“˝˙–i“in c˝$ and $Y˙c = “–y˙i“˝˙–i“in c˝$. The “emph–target˝ index set $t$ is defined as $t := [n] “setminus c$, and the corresponding target set $“calD˙t$ is defined similarly. -->    </subsection>
    <subsection inlist="toc" xml:id="S2.SS2">
      <tags>
        <tag>2.2</tag>
        <tag role="autoref">subsection 2.2</tag>
        <tag role="refnum">2.2</tag>
        <tag role="typerefnum">§2.2</tag>
      </tags>
      <title><tag close=" ">2.2</tag>Neural process families</title>
      <para xml:id="S2.SS2.p1">
        <p>Our goal is to train a class of random functions <Math mode="inline" tex="f:{\mathcal{X}}\to{\mathcal{Y}}" text="f colon X to Y" xml:id="S2.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMApp>
                  <XMTok name="to" role="ARROW">→</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">X</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">Y</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> that can effectively describe the relationship between inputs and outputs included in a set of tasks. Viewing this as a meta-learning problem, for each task <Math mode="inline" tex="\tau" text="tau" xml:id="S2.SS2.p1.m2">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math>, we can treat the context <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> as a meta-train set and target <Math mode="inline" tex="Z_{t}" text="Z _ t" xml:id="S2.SS2.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> as a meta-validation set. We wish to meta-learn a mapping from the context <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> to a random function <Math mode="inline" tex="f" text="f" xml:id="S2.SS2.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> that recovers the given context <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> (minimizing meta-training error) and predicts <Math mode="inline" tex="Z_{t}" text="Z _ t" xml:id="S2.SS2.p1.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> well (minimizing meta-validation error). Instead of directly estimating the infinite-dimensional <Math mode="inline" tex="f" text="f" xml:id="S2.SS2.p1.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, we learn a mapping from <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> to a predictive distribution for finite-dimensional observations,</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx1">
          <equation xml:id="S2.E1">
            <tags>
              <tag>(1)</tag>
              <tag role="autoref">Equation 1</tag>
              <tag role="refnum">1</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle p(Y|X,Z_{c})=\int\bigg{[}\prod_{i\in c}p(y_{i}|f,x_{i})\prod_{i%&#10;\in t}p(y_{i}|f,x_{i})\bigg{]}p(f|Z_{c})\mathrm{d}f," text="p * conditional@(Y, list@(X, Z _ c)) = integral@(delimited-[]@((product _ (i element-of c))@(p * conditional@(y _ i, list@(f, x _ i)) * (product _ (i element-of t))@(p * conditional@(y _ i, list@(f, x _ i))))) * p * conditional@(f, Z _ c) * differential-d@(f))" xml:id="S2.E1.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E1.m2.4"/>
                    <XMWrap>
                      <XMApp xml:id="S2.E1.m2.4">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E1.m2.4.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.E1.m2.4.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S2.E1.m2.1"/>
                                    <XMRef idref="S2.E1.m2.4.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m2.1">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S2.E1.m2.4.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S2.E1.m2.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="210%" role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="S2.E1.m2.4.2">
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMDual>
                                      <XMRef idref="S2.E1.m2.4.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S2.E1.m2.4.2.1">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="list"/>
                                              <XMRef idref="S2.E1.m2.2"/>
                                              <XMRef idref="S2.E1.m2.4.2.1.1"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m2.2">f</XMTok>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="S2.E1.m2.4.2.1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                        <XMDual>
                                          <XMRef idref="S2.E1.m2.4.2.2"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S2.E1.m2.4.2.2">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="S2.E1.m2.3"/>
                                                  <XMRef idref="S2.E1.m2.4.2.2.1"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m2.3">f</XMTok>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="S2.E1.m2.4.2.2.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok fontsize="210%" role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMDual>
                              <XMRef idref="S2.E1.m2.4.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S2.E1.m2.4.3">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle p(Y|X,Z_{c})=\int\bigg{[}\prod_{i\in c}p(y_{i}|f,x_{i})\prod_{i%&#10;\in t}p(y_{i}|f,x_{i})\bigg{]}p(f|Z_{c})\mathrm{d}f," text="p * conditional@(Y, list@(X, Z _ c)) = integral@(delimited-[]@((product _ (i element-of c))@(p * conditional@(y _ i, list@(f, x _ i)) * (product _ (i element-of t))@(p * conditional@(y _ i, list@(f, x _ i))))) * p * conditional@(f, Z _ c) * differential-d@(f))" xml:id="S2.E1.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E1.m1.4"/>
                        <XMWrap>
                          <XMApp xml:id="S2.E1.m1.4">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E1.m1.4.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E1.m1.4.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S2.E1.m1.1"/>
                                        <XMRef idref="S2.E1.m1.4.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.1">X</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S2.E1.m1.4.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="S2.E1.m1.4.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="210%" role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="S2.E1.m1.4.2">
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                        <XMDual>
                                          <XMRef idref="S2.E1.m1.4.2.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S2.E1.m1.4.2.1">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="S2.E1.m1.2"/>
                                                  <XMRef idref="S2.E1.m1.4.2.1.1"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.2">f</XMTok>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="S2.E1.m1.4.2.1.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                            <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                            <XMDual>
                                              <XMRef idref="S2.E1.m1.4.2.2"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="S2.E1.m1.4.2.2">
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="list"/>
                                                      <XMRef idref="S2.E1.m1.3"/>
                                                      <XMRef idref="S2.E1.m1.4.2.2.1"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.3">f</XMTok>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="S2.E1.m1.4.2.2.1">
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                      </XMApp>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="210%" role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMDual>
                                  <XMRef idref="S2.E1.m1.4.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S2.E1.m1.4.3">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where we are assuming the outputs <Math mode="inline" tex="Y" text="Y" xml:id="S2.SS2.p1.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
            </XMath>
          </Math> are independent given <Math mode="inline" tex="f" text="f" xml:id="S2.SS2.p1.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="X" text="X" xml:id="S2.SS2.p1.m13">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">X</XMTok>
            </XMath>
          </Math><!--  %**** background.tex Line 25 **** -->. We further restrict ourselves to simple heteroscedastic Gaussian measurement noises,</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx2">
          <equation xml:id="S2.E2">
            <tags>
              <tag>(2)</tag>
              <tag role="autoref">Equation 2</tag>
              <tag role="refnum">2</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle p(y|f,x)={\mathcal{N}}(y|\mu_{\theta}(x),\sigma^{2}_{\theta}(x)I%&#10;_{{d_{\text{out}}}})," text="p * conditional@(y, list@(f, x)) = N * conditional@(y, list@(mu _ theta * x, (sigma ^ 2) _ theta * x * I _ d _ [out]))" xml:id="S2.E2.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E2.m2.5"/>
                    <XMWrap>
                      <XMApp xml:id="S2.E2.m2.5">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E2.m2.5.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.E2.m2.5.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S2.E2.m2.1"/>
                                    <XMRef idref="S2.E2.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m2.1">f</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m2.2">x</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E2.m2.5.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.E2.m2.5.2">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S2.E2.m2.5.2.1"/>
                                    <XMRef idref="S2.E2.m2.5.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="S2.E2.m2.5.2.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="S2.E2.m2.3"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m2.3">x</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S2.E2.m2.5.2.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="S2.E2.m2.4"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m2.4">x</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                          <XMText><text fontsize="50%">out</text></XMText>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle p(y|f,x)={\mathcal{N}}(y|\mu_{\theta}(x),\sigma^{2}_{\theta}(x)I%&#10;_{{d_{\text{out}}}})," text="p * conditional@(y, list@(f, x)) = N * conditional@(y, list@(mu _ theta * x, (sigma ^ 2) _ theta * x * I _ d _ [out]))" xml:id="S2.E2.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E2.m1.5"/>
                        <XMWrap>
                          <XMApp xml:id="S2.E2.m1.5">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E2.m1.5.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E2.m1.5.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S2.E2.m1.1"/>
                                        <XMRef idref="S2.E2.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m1.1">f</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m1.2">x</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E2.m1.5.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E2.m1.5.2">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S2.E2.m1.5.2.1"/>
                                        <XMRef idref="S2.E2.m1.5.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="S2.E2.m1.5.2.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="S2.E2.m1.3"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m1.3">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S2.E2.m1.5.2.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="S2.E2.m1.4"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m1.4">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                              <XMText><text fontsize="50%">out</text></XMText>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\mu_{\theta}:{\mathcal{X}}\to{\mathcal{Y}}" text="mu _ theta colon X to Y" xml:id="S2.SS2.p1.m14">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="to" role="ARROW">→</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">X</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">Y</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\sigma_{\theta}^{2}:{\mathcal{X}}\to\mathbb{R}_{+}" text="(sigma _ theta) ^ 2 colon X to R _ +" xml:id="S2.SS2.p1.m15">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="to" role="ARROW">→</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">X</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> map an input to a mean function value and corresponding variance, respectively. <Math mode="inline" tex="\theta\in\mathbb{R}^{h}" text="theta element-of R ^ h" xml:id="S2.SS2.p1.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a parameter indexing the function <Math mode="inline" tex="f" text="f" xml:id="S2.SS2.p1.m17">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, and thus the above predictive distribution can be written as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx3">
          <equation xml:id="S2.E3">
            <tags>
              <tag>(3)</tag>
              <tag role="autoref">Equation 3</tag>
              <tag role="refnum">3</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle p(Y|X,Z_{c})=\int\bigg{[}\prod_{i\in[n]}{\mathcal{N}}(y_{i}|\mu_%&#10;{\theta}(x_{i}),\sigma_{\theta}^{2}(x_{i})I_{d_{\text{out}}})\bigg{]}p(\theta|%&#10;Z_{c})\mathrm{d}\theta." text="p * conditional@(Y, list@(X, Z _ c)) = integral@(delimited-[]@((product _ (i element-of delimited-[]@(n)))@(N * conditional@(y _ i, list@(mu _ theta * x _ i, (sigma _ theta) ^ 2 * x _ i * I _ d _ [out])))) * p * conditional@(theta, Z _ c) * differential-d@(theta))" xml:id="S2.E3.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E3.m2.3"/>
                    <XMWrap>
                      <XMApp xml:id="S2.E3.m2.3">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E3.m2.3.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.E3.m2.3.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S2.E3.m2.2"/>
                                    <XMRef idref="S2.E3.m2.3.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m2.2">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S2.E3.m2.3.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S2.E3.m2.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="210%" role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="S2.E3.m2.3.2">
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="S2.E3.m2.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E3.m2.1">n</XMTok>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                    <XMDual>
                                      <XMRef idref="S2.E3.m2.3.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S2.E3.m2.3.2.1">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="list"/>
                                              <XMRef idref="S2.E3.m2.3.2.1.1"/>
                                              <XMRef idref="S2.E3.m2.3.2.1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMApp xml:id="S2.E3.m2.3.2.1.1">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="S2.E3.m2.3.2.1.1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="S2.E3.m2.3.2.1.1.1">
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="S2.E3.m2.3.2.1.2">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                                  </XMApp>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="S2.E3.m2.3.2.1.2.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="S2.E3.m2.3.2.1.2.1">
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="50%">out</text></XMText>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok fontsize="210%" role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMDual>
                              <XMRef idref="S2.E3.m2.3.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S2.E3.m2.3.3">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle p(Y|X,Z_{c})=\int\bigg{[}\prod_{i\in[n]}{\mathcal{N}}(y_{i}|\mu_%&#10;{\theta}(x_{i}),\sigma_{\theta}^{2}(x_{i})I_{d_{\text{out}}})\bigg{]}p(\theta|%&#10;Z_{c})\mathrm{d}\theta." text="p * conditional@(Y, list@(X, Z _ c)) = integral@(delimited-[]@((product _ (i element-of delimited-[]@(n)))@(N * conditional@(y _ i, list@(mu _ theta * x _ i, (sigma _ theta) ^ 2 * x _ i * I _ d _ [out])))) * p * conditional@(theta, Z _ c) * differential-d@(theta))" xml:id="S2.E3.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E3.m1.3"/>
                        <XMWrap>
                          <XMApp xml:id="S2.E3.m1.3">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E3.m1.3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E3.m1.3.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S2.E3.m1.2"/>
                                        <XMRef idref="S2.E3.m1.3.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m1.2">X</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S2.E3.m1.3.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="S2.E3.m1.3.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="210%" role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="S2.E3.m1.3.2">
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="delimited-[]"/>
                                              <XMRef idref="S2.E3.m1.1"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E3.m1.1">n</XMTok>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                        <XMDual>
                                          <XMRef idref="S2.E3.m1.3.2.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S2.E3.m1.3.2.1">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="S2.E3.m1.3.2.1.1"/>
                                                  <XMRef idref="S2.E3.m1.3.2.1.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMApp xml:id="S2.E3.m1.3.2.1.1">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="S2.E3.m1.3.2.1.1.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="S2.E3.m1.3.2.1.1.1">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="S2.E3.m1.3.2.1.2">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                                      </XMApp>
                                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="S2.E3.m1.3.2.1.2.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="S2.E3.m1.3.2.1.2.1">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="50%">out</text></XMText>
                                                      </XMApp>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="210%" role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMDual>
                                  <XMRef idref="S2.E3.m1.3.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S2.E3.m1.3.3">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>A <ERROR class="undefined">\gls</ERROR>np is a parametric model which constructs a mapping from <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m18">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> to <Math mode="inline" tex="\theta" text="theta" xml:id="S2.SS2.p1.m19">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> as a neural network. The simplest version, <ERROR class="undefined">\gls</ERROR>cnp <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018conditional" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>, assumes a deterministic mapping from <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m20">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> to <Math mode="inline" tex="\theta" text="theta" xml:id="S2.SS2.p1.m21">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx4">
          <equation xml:id="S2.E4">
            <tags>
              <tag>(4)</tag>
              <tag role="autoref">Equation 4</tag>
              <tag role="refnum">4</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle p(\theta|Z_{c})=\delta_{r_{c}}(\theta),\quad r_{c}=f_{\text{enc}%&#10;}(Z_{c};\phi_{\text{enc}})," text="formulae@(p * conditional@(theta, Z _ c) = delta _ r _ c * theta, r _ c = f _ [enc] * list@(Z _ c, phi _ [enc]))" xml:id="S2.E4.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E4.m2.2"/>
                    <XMWrap>
                      <XMDual xml:id="S2.E4.m2.2">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="S2.E4.m2.2.1"/>
                          <XMRef idref="S2.E4.m2.2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S2.E4.m2.2.1">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E4.m2.2.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E4.m2.2.1.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S2.E4.m2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S2.E4.m2.1">θ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                          <XMApp xml:id="S2.E4.m2.2.2">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                <XMText><text fontsize="70%">enc</text></XMText>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="S2.E4.m2.2.2.1"/>
                                  <XMRef idref="S2.E4.m2.2.2.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E4.m2.2.2.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">;</XMTok>
                                  <XMApp xml:id="S2.E4.m2.2.2.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    <XMText><text fontsize="70%">enc</text></XMText>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle p(\theta|Z_{c})=\delta_{r_{c}}(\theta),\quad r_{c}=f_{\text{enc}%&#10;}(Z_{c};\phi_{\text{enc}})," text="formulae@(p * conditional@(theta, Z _ c) = delta _ r _ c * theta, r _ c = f _ [enc] * list@(Z _ c, phi _ [enc]))" xml:id="S2.E4.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E4.m1.2"/>
                        <XMWrap>
                          <XMDual xml:id="S2.E4.m1.2">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="S2.E4.m1.2.1"/>
                              <XMRef idref="S2.E4.m1.2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S2.E4.m1.2.1">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMDual>
                                    <XMRef idref="S2.E4.m1.2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.E4.m1.2.1.1">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S2.E4.m1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S2.E4.m1.1">θ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                              <XMApp xml:id="S2.E4.m1.2.2">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                    <XMText><text fontsize="70%">enc</text></XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="S2.E4.m1.2.2.1"/>
                                      <XMRef idref="S2.E4.m1.2.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.E4.m1.2.2.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">;</XMTok>
                                      <XMApp xml:id="S2.E4.m1.2.2.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                        <XMText><text fontsize="70%">enc</text></XMText>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\delta_{a}(x)" text="delta _ a * x" xml:id="S2.SS2.p1.m22">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S2.SS2.p1.m22.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS2.p1.m22.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is the Dirac delta function (which gives zero if <Math mode="inline" tex="x\neq a" text="x not-equals a" xml:id="S2.SS2.p1.m23">
            <XMath>
              <XMApp>
                <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\int\delta_{a}(x)\mathrm{d}x=1" text="integral@(delta _ a * x * differential-d@(x)) = 1" xml:id="S2.SS2.p1.m24">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.SS2.p1.m24.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS2.p1.m24.1">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>) and <Math mode="inline" tex="f_{\text{enc}}" text="f _ [enc]" xml:id="S2.SS2.p1.m25">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMText><text fontsize="70%">enc</text></XMText>
              </XMApp>
            </XMath>
          </Math> is a <emph font="italic">permutation-invariant</emph> neural network taking sets as inputs <cite class="ltx_citemacro_citep">[<bibref bibrefs="zaheer2017deep" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>, parameterized by <Math mode="inline" tex="\phi_{\text{enc}}" text="phi _ [enc]" xml:id="S2.SS2.p1.m26">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                <XMText><text fontsize="70%">enc</text></XMText>
              </XMApp>
            </XMath>
          </Math>. Given a summary <Math mode="inline" tex="\theta=r_{c}" text="theta = r _ c" xml:id="S2.SS2.p1.m27">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> of a context <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p1.m28">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math>, the <ERROR class="undefined">\gls</ERROR>cnp models the mean and variance functions <Math mode="inline" tex="(\mu,\sigma^{2})" text="open-interval@(mu, sigma ^ 2)" xml:id="S2.SS2.p1.m29">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.SS2.p1.m29.1"/>
                  <XMRef idref="S2.SS2.p1.m29.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S2.SS2.p1.m29.1">μ</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S2.SS2.p1.m29.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx5">
          <equation xml:id="S2.E5">
            <tags>
              <tag>(5)</tag>
              <tag role="autoref">Equation 5</tag>
              <tag role="refnum">5</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle(\mu_{\theta}(x),\log\sigma_{\theta}(x))=f_{\text{dec}}(x,r_{c};%&#10;\phi_{\text{dec}})," text="open-interval@(mu _ theta * x, logarithm@(sigma _ theta) * x) = f _ [dec] * vector@(x, r _ c, phi _ [dec])" xml:id="S2.E5.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E5.m2.4"/>
                    <XMWrap>
                      <XMApp xml:id="S2.E5.m2.4">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.E5.m2.4.1"/>
                            <XMRef idref="S2.E5.m2.4.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.E5.m2.4.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S2.E5.m2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E5.m2.1">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S2.E5.m2.4.2">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S2.E5.m2.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E5.m2.2">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">dec</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="S2.E5.m2.3"/>
                              <XMRef idref="S2.E5.m2.4.3"/>
                              <XMRef idref="S2.E5.m2.4.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E5.m2.3">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S2.E5.m2.4.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">;</XMTok>
                              <XMApp xml:id="S2.E5.m2.4.4">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                <XMText><text fontsize="70%">dec</text></XMText>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle(\mu_{\theta}(x),\log\sigma_{\theta}(x))=f_{\text{dec}}(x,r_{c};%&#10;\phi_{\text{dec}})," text="open-interval@(mu _ theta * x, logarithm@(sigma _ theta) * x) = f _ [dec] * vector@(x, r _ c, phi _ [dec])" xml:id="S2.E5.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E5.m1.4"/>
                        <XMWrap>
                          <XMApp xml:id="S2.E5.m1.4">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S2.E5.m1.4.1"/>
                                <XMRef idref="S2.E5.m1.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S2.E5.m1.4.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S2.E5.m1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.E5.m1.1">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S2.E5.m1.4.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S2.E5.m1.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.E5.m1.2">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                <XMText><text fontsize="70%">dec</text></XMText>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="vector"/>
                                  <XMRef idref="S2.E5.m1.3"/>
                                  <XMRef idref="S2.E5.m1.4.3"/>
                                  <XMRef idref="S2.E5.m1.4.4"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E5.m1.3">x</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S2.E5.m1.4.3">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">;</XMTok>
                                  <XMApp xml:id="S2.E5.m1.4.4">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    <XMText><text fontsize="70%">dec</text></XMText>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="f_{\text{dec}}" text="f _ [dec]" xml:id="S2.SS2.p1.m30">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMText><text fontsize="70%">dec</text></XMText>
              </XMApp>
            </XMath>
          </Math> is a feed-forward neural network parameterized by <Math mode="inline" tex="\phi_{\text{dec}}" text="phi _ [dec]" xml:id="S2.SS2.p1.m31">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                <XMText><text fontsize="70%">dec</text></XMText>
              </XMApp>
            </XMath>
          </Math>. Here the parameters <Math mode="inline" tex="(\phi_{\text{enc}},\phi_{\text{dec}})" text="open-interval@(phi _ [enc], phi _ [dec])" xml:id="S2.SS2.p1.m32">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.SS2.p1.m32.1"/>
                  <XMRef idref="S2.SS2.p1.m32.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S2.SS2.p1.m32.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                    <XMText><text fontsize="70%">enc</text></XMText>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S2.SS2.p1.m32.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                    <XMText><text fontsize="70%">dec</text></XMText>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> are optimized to maximize the expected predictive likelihood over tasks, <Math mode="inline" tex="\mathbb{E}_{\tau}[\log p(Y|X,Z_{c})]" text="E _ tau * delimited-[]@(logarithm@(p) * conditional@(Y, list@(X, Z _ c)))" xml:id="S2.SS2.p1.m33">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.SS2.p1.m33.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S2.SS2.p1.m33.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S2.SS2.p1.m33.2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S2.SS2.p1.m33.2.1">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S2.SS2.p1.m33.1"/>
                                <XMRef idref="S2.SS2.p1.m33.2.1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS2.p1.m33.1">X</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S2.SS2.p1.m33.2.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S2.SS2.p2">
        <p>Note that in the <ERROR class="undefined">\gls</ERROR>cnp, the mapping from <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S2.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math> to <Math mode="inline" tex="\theta" text="theta" xml:id="S2.SS2.p2.m2">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> is deterministic, so it does not consider <emph font="italic">functional uncertainty</emph> or epistemic (model) uncertainty. To resolve this, <cite class="ltx_citemacro_citet"><bibref bibrefs="garnelo2018neural" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> proposed <ERROR class="undefined">\gls</ERROR>np which learns a mapping from an arbitrary subset <Math mode="inline" tex="Z^{\prime}\subseteq Z" text="Z ^ prime subset-of-or-equals Z" xml:id="S2.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="subset-of-or-equals" name="subseteq" role="RELOP">⊆</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math> to a variational posterior <Math mode="inline" tex="q(\theta|Z^{\prime})" text="q * conditional@(theta, Z ^ prime)" xml:id="S2.SS2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS2.p2.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS2.p2.m4.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> approximating <Math mode="inline" tex="p(\theta|Z^{\prime})" text="p * conditional@(theta, Z ^ prime)" xml:id="S2.SS2.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS2.p2.m5.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS2.p2.m5.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> under an implicitly defined prior <Math mode="inline" tex="p(\theta)" text="p * theta" xml:id="S2.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS2.p2.m6.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S2.SS2.p2.m6.1">θ</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>:</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx6">
          <equation xml:id="S2.E6">
            <tags>
              <tag>(6)</tag>
              <tag role="autoref">Equation 6</tag>
              <tag role="refnum">6</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle(m_{Z^{\prime}},\log s_{Z^{\prime}})=f_{\text{enc}}(Z^{\prime};%&#10;\phi_{\text{enc}}),\quad p(\theta|Z^{\prime})\approx q(\theta|Z^{\prime}):={%&#10;\mathcal{N}}(\theta|m_{Z^{\prime}},s^{2}_{Z^{\prime}}I_{h})." text="formulae@(open-interval@(m _ (Z ^ prime), logarithm@(s _ (Z ^ prime))) = f _ [enc] * list@(Z ^ prime, phi _ [enc]), p * conditional@(theta, Z ^ prime) approximately-equals q * conditional@(theta, Z ^ prime) assign N * conditional@(theta, list@(m _ (Z ^ prime), (s ^ 2) _ (Z ^ prime) * I _ h)))" xml:id="S2.E6.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E6.m2.1"/>
                    <XMWrap>
                      <XMDual xml:id="S2.E6.m2.1">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="S2.E6.m2.1.1"/>
                          <XMRef idref="S2.E6.m2.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S2.E6.m2.1.1">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S2.E6.m2.1.1.1"/>
                                <XMRef idref="S2.E6.m2.1.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S2.E6.m2.1.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                    <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S2.E6.m2.1.1.2">
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                      <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                <XMText><text fontsize="70%">enc</text></XMText>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="S2.E6.m2.1.1.3"/>
                                  <XMRef idref="S2.E6.m2.1.1.4"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E6.m2.1.1.3">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">;</XMTok>
                                  <XMApp xml:id="S2.E6.m2.1.1.4">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    <XMText><text fontsize="70%">enc</text></XMText>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                          <XMApp xml:id="S2.E6.m2.1.2">
                            <XMTok meaning="multirelation"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E6.m2.1.2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E6.m2.1.2.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">q</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E6.m2.1.2.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E6.m2.1.2.2">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok meaning="assign" role="RELOP">:=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E6.m2.1.2.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.E6.m2.1.2.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S2.E6.m2.1.2.3.1"/>
                                        <XMRef idref="S2.E6.m2.1.2.3.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="S2.E6.m2.1.2.3.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                            <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S2.E6.m2.1.2.3.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle(m_{Z^{\prime}},\log s_{Z^{\prime}})=f_{\text{enc}}(Z^{\prime};%&#10;\phi_{\text{enc}}),\quad p(\theta|Z^{\prime})\approx q(\theta|Z^{\prime}):={%&#10;\mathcal{N}}(\theta|m_{Z^{\prime}},s^{2}_{Z^{\prime}}I_{h})." text="formulae@(open-interval@(m _ (Z ^ prime), logarithm@(s _ (Z ^ prime))) = f _ [enc] * list@(Z ^ prime, phi _ [enc]), p * conditional@(theta, Z ^ prime) approximately-equals q * conditional@(theta, Z ^ prime) assign N * conditional@(theta, list@(m _ (Z ^ prime), (s ^ 2) _ (Z ^ prime) * I _ h)))" xml:id="S2.E6.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E6.m1.1"/>
                        <XMWrap>
                          <XMDual xml:id="S2.E6.m1.1">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="S2.E6.m1.1.1"/>
                              <XMRef idref="S2.E6.m1.1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S2.E6.m1.1.1">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S2.E6.m1.1.1.1"/>
                                    <XMRef idref="S2.E6.m1.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S2.E6.m1.1.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                        <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S2.E6.m1.1.1.2">
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                    <XMText><text fontsize="70%">enc</text></XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="S2.E6.m1.1.1.3"/>
                                      <XMRef idref="S2.E6.m1.1.1.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.E6.m1.1.1.3">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">;</XMTok>
                                      <XMApp xml:id="S2.E6.m1.1.1.4">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                        <XMText><text fontsize="70%">enc</text></XMText>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                              <XMApp xml:id="S2.E6.m1.1.2">
                                <XMTok meaning="multirelation"/>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMDual>
                                    <XMRef idref="S2.E6.m1.1.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.E6.m1.1.2.1">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                  <XMDual>
                                    <XMRef idref="S2.E6.m1.1.2.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.E6.m1.1.2.2">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                  <XMDual>
                                    <XMRef idref="S2.E6.m1.1.2.3"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.E6.m1.1.2.3">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="S2.E6.m1.1.2.3.1"/>
                                            <XMRef idref="S2.E6.m1.1.2.3.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="S2.E6.m1.1.2.3.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="S2.E6.m1.1.2.3.2">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>With <Math mode="inline" tex="f_{\text{enc}}" text="f _ [enc]" xml:id="S2.SS2.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMText><text fontsize="70%">enc</text></XMText>
              </XMApp>
            </XMath>
          </Math>, the <ERROR class="undefined">\gls</ERROR><!--  %**** background.tex Line 50 **** -->elbo for the predictive likelihood is written as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx7">
          <equation xml:id="S2.Ex1">
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle\log p(Y|X,Z_{c})\geq\sum_{i\in[n]}\mathbb{E}_{q(\theta|Z)}[\log{%&#10;\mathcal{N}}(y_{i}|\mu_{\theta}(x_{i}),\sigma_{\theta}^{2}(x_{i})I_{d_{\text{%&#10;out}}})]-D_{\mathrm{KL}}[q(\theta|Z)\|p(\theta|Z_{c})]" xml:id="S2.Ex1.m3">
                <XMath>
                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex1.m3.3">X</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S2.Ex1.m3.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.Ex1.m3.1">n</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                      <XMDual>
                        <XMRef idref="S2.Ex1.m3.2"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S2.Ex1.m3.2">
                            <XMTok fontsize="70%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">y</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                          <XMText><text fontsize="50%">out</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    <XMTok fontsize="70%" role="UNKNOWN">KL</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok name="||" role="VERTBAR">∥</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\log p(Y|X,Z_{c})" text="logarithm@(p) * conditional@(Y, list@(X, Z _ c))" xml:id="S2.Ex1.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.Ex1.m1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.Ex1.m1.2">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="S2.Ex1.m1.1"/>
                                  <XMRef idref="S2.Ex1.m1.2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex1.m1.1">X</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S2.Ex1.m1.2.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\geq\sum_{i\in[n]}\mathbb{E}_{q(\theta|Z)}[\log{\mathcal{N}}(y_{i%&#10;}|\mu_{\theta}(x_{i}),\sigma_{\theta}^{2}(x_{i})I_{d_{\text{out}}})]-D_{%&#10;\mathrm{KL}}[q(\theta|Z)\|p(\theta|Z_{c})]" xml:id="S2.Ex1.m2">
                    <XMath>
                      <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S2.Ex1.m2.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.Ex1.m2.1">n</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          <XMDual>
                            <XMRef idref="S2.Ex1.m2.2"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.Ex1.m2.2">
                                <XMTok fontsize="70%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">I</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                              <XMText><text fontsize="50%">out</text></XMText>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">D</XMTok>
                        <XMTok fontsize="70%" role="UNKNOWN">KL</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok name="||" role="VERTBAR">∥</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S2.E7">
            <tags>
              <tag>(7)</tag>
              <tag role="autoref">Equation 7</tag>
              <tag role="refnum">7</tag>
            </tags>
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle\approx\sum_{i\in[n]}\mathbb{E}_{q(\theta|Z)}[\log{\mathcal{N}}(y%&#10;_{i}|\mu_{\theta}(x_{i}),\sigma_{\theta}^{2}(x_{i})I_{d_{\text{out}}})]-D_{%&#10;\mathrm{KL}}[q(\theta|Z)\|q(\theta|Z_{c})]." xml:id="S2.E7.m2">
                <XMath>
                  <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S2.E7.m2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E7.m2.1">n</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                      <XMDual>
                        <XMRef idref="S2.E7.m2.2"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S2.E7.m2.2">
                            <XMTok fontsize="70%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">y</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                          <XMText><text fontsize="50%">out</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    <XMTok fontsize="70%" role="UNKNOWN">KL</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok name="||" role="VERTBAR">∥</XMTok>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                  <XMTok role="PERIOD">.</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td/>
                <td align="left"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\approx\sum_{i\in[n]}\mathbb{E}_{q(\theta|Z)}[\log{\mathcal{N}}(y%&#10;_{i}|\mu_{\theta}(x_{i}),\sigma_{\theta}^{2}(x_{i})I_{d_{\text{out}}})]-D_{%&#10;\mathrm{KL}}[q(\theta|Z)\|q(\theta|Z_{c})]." xml:id="S2.E7.m1">
                    <XMath>
                      <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S2.E7.m1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E7.m1.1">n</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E7.m1.2"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.E7.m1.2">
                                <XMTok fontsize="70%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">I</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                              <XMText><text fontsize="50%">out</text></XMText>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">D</XMTok>
                        <XMTok fontsize="70%" role="UNKNOWN">KL</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok name="||" role="VERTBAR">∥</XMTok>
                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>An apparent limitation of the <ERROR class="undefined">\gls</ERROR>np is that it assumes a uni-modal Gaussian distribution as an approximate posterior for <Math mode="inline" tex="q(\theta|Z_{c})" text="q * conditional@(theta, Z _ c)" xml:id="S2.SS2.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS2.p2.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS2.p2.m8.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. Aside from the limited flexibility, it does not fit the motivation of <ERROR class="undefined">\glspl</ERROR>np trying to learn as much as possible in a data-driven manner, as pre-specified parametric families are used.</p>
      </para>
      <para xml:id="S2.SS2.p3">
        <p>There have been several improvements over the vanilla <ERROR class="undefined">\glspl</ERROR>cnp and <ERROR class="undefined">\glspl</ERROR>np, either by introducing attention mechanism <cite class="ltx_citemacro_citep">[<bibref bibrefs="vaswani2017attention" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite> for <Math mode="inline" tex="f_{\text{enc}}" text="f _ [enc]" xml:id="S2.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMText><text fontsize="70%">enc</text></XMText>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="f_{\text{dec}}" text="f _ [dec]" xml:id="S2.SS2.p3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMText><text fontsize="70%">dec</text></XMText>
              </XMApp>
            </XMath>
          </Math> <cite class="ltx_citemacro_citep">[<bibref bibrefs="kim2018attentive" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>, or using advanced functional uncertainty modeling (<cite class="ltx_citemacro_citep"><bibref bibrefs="lee2020bootstrapping" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref></cite>; <cite class="ltx_citemacro_citep"><bibref bibrefs="lee2022neural" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref></cite>). We provide a detailed review of the architectures for such variants in <ref labelref="LABEL:app:sec:architectures" show="creftype~refnum"/>. Throughout the paper, we will refer to this class of models as <ERROR class="undefined">\gls</ERROR>npf.</p>
      </para>
<!--  %“subsection–Neural Process Family˝ 
     %Consider a target dataset $“calD=(X,Y)$ where $X=“–x˙i“˝˙–i=1˝^n$ is an input set and $Y=“–y˙i“˝˙–i=1˝^n$ is an output set. 
     %Here we define subset $“calD˙C=(X˙C,Y˙C)=“–(x˙i,y˙i)“˝˙–i“in C˝$ as our context dataset where $C“subsetneq [n]$ denotes an index set. 
     %With these $“calD$ and $“calD˙C$, “gls–npf˝“citep–garnelo2018conditional, garnelo2018neural˝ learns to make a stochastic process which maps $x“in X$ to some conditional distribution $p(y—x,X˙C,Y˙C)$ by maximizing 
     %“begin–align˝ 
     %“log p(Y—X,“calD˙C) = “sum˙–i=1˝^n “log p(y˙i—x˙i, “calD˙C)=“sum˙–i=1˝^n “log p(y˙i—x˙i,X˙C,Y˙C). 
     %“end–align˝ 
     %The deterministic “gls–npf˝ called “glspl–cnp˝~“citep–garnelo2018conditional, gordon2020convolutional˝ predicts $p(y˙i—x˙i, X˙C,Y˙C)$ only with deterministic path which is made up with an “textit–permutation invariant˝~“citep–zaheer2017deep˝ encoder neural network $f˙–“enc˝$ and a decoder neural network $f˙–“dec˝$. 
     %Here an encoder neural network $f˙–“enc˝$ compresses $(X˙C,Y˙C)$ into a feature $r˙C$. 
     %A decoder neural network $f˙–“dec˝$ takes $r˙C$ and $x˙i$ as inputs and outputs the parameters of the distribution $p(y˙i—x˙i,X˙C,Y˙C)$. 
     %The conditional distribution $p(y˙i—x˙i,X˙C,Y˙C)$ is usually modelled as a Gaussian distribution. 
     %We can simplify these procedures as: 
     %“begin–align˝ 
     %r˙C = f˙“enc(X˙C,Y˙C), “quad (“mu˙i, “log“sigma˙i)=f˙“dec(x˙i,r˙C),“quad  p(y˙i—x˙i,X˙C,Y˙C)=“calN(y˙i—“mu˙i,“sigma˙i^2). 
     %“end–align˝ 
     %The stochastic “gls–npf˝ called “glspl–np˝~“citep–garnelo2018neural,foong2020meta˝ contains a latent path in addition to deterministic path to predict $p(y˙i—x˙i, X˙C,Y˙C)$. 
     %This latent path has an own permutation invariant latent encoder neural network $f˙–“lat˝$ and shares a decoder neural network $f˙–“dec˝$. 
     %$f˙“lat$ takes $(X˙C,Y˙C)$ as an input and outputs the parameters of Gaussian distribution $p(z—X˙C,Y˙C)$ where $z$ is a global latent variable of “gls–np˝. 
     %Global latent variable $z$ models a “textit–functional uncertainty˝ of “gls–np˝ which means that it helps “gls–np˝ to make the diverse conditional distribution $p(y˙i—x˙i,X˙C,Y˙C)$. With this latent path, the procedure of “glspl–np˝ can be summarized as: 
     %**** background.tex Line 75 **** 
     %“begin–align˝ 
     %&amp;r˙C = f˙“enc(X˙C,Y˙C), “quad (“mu˙z,“log“sigma˙z)=f˙“lat(X˙C,Y˙C),“quad z—“calD˙C“sim“calN(“mu˙z, “sigma˙z^2)““ 
     %&amp;(“mu˙i, “log“sigma˙i)=f˙“dec(x˙i,r˙C,z),“quad  p(y˙i—x˙i,X˙C,Y˙C)=“calN(y˙i—“mu˙i,“sigma˙i^2). 
     %“end–align˝ 
     %In order to train “gls–np˝, we can use ELBO of the conditional probability which is 
     %“begin–align˝ 
     %“log p(Y—X,“calD˙C) “geq “sum˙–i=1˝^n “bbE˙–q(z—“calD)˝“left[“log p(y˙i—x˙i,z,r˙C)“right]-“text–KL˝(q(z—“calD)——p(z—“calD˙C)). 
     %“end–align˝ 
     %If we approximate $p(z—“calD˙C)$ by $q(z—“calD˙C)$, this ELBO changes into our train loss function 
     %“begin–align˝ 
     %“sum˙–i=1˝^n “bbE˙–q(z—“calD)˝“left[“log p(y˙i—x˙i,z,r˙C)“right]-“text–KL˝(q(z—“calD)——p(z—“calD˙C)). 
     %“end–align˝ -->    </subsection>
    <subsection inlist="toc" xml:id="S2.SS3">
      <tags>
        <tag>2.3</tag>
        <tag role="autoref">subsection 2.3</tag>
        <tag role="refnum">2.3</tag>
        <tag role="typerefnum">§2.3</tag>
      </tags>
      <title><tag close=" ">2.3</tag>Martingale Posterior Distributions</title>
      <para xml:id="S2.SS3.p1">
        <p>The martingale posterior distribution <cite class="ltx_citemacro_citep">[<bibref bibrefs="fong2021martingale" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite> is a recent generalization of Bayesian inference which reframes posterior uncertainty on parameters as predictive uncertainty on the unseen population conditional on the observed data. Given observed samples <Math mode="inline" tex="Z=\{z_{i}\}_{i=1}^{n}" text="Z = ((set@(z _ i)) _ (i = 1)) ^ n" xml:id="S2.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S2.SS3.p1.m1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S2.SS3.p1.m1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> i.i.d. from the sampling density <Math mode="inline" tex="p_{0}" text="p _ 0" xml:id="S2.SS3.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, one can define the parameter of interest as a functional of <Math mode="inline" tex="p_{0}" text="p _ 0" xml:id="S2.SS3.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, that is</p>
        <equation xml:id="S2.Ex2">
          <Math content-tex="\theta_{0}=\theta(p_{0})=\argmin_{\theta}\int\ell(z,\theta)\,p_{0}(dz)," mode="display" tex="\theta_{0}=\theta(p_{0})=\operatorname*{arg\,min}_{\theta}\int\ell(z,\theta)\,%&#10;p_{0}(dz)," text="theta _ 0 = theta * p _ 0 = argmin _ theta * integral@(ell * open-interval@(z, theta) * p _ 0 * d * z)" xml:id="S2.Ex2.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S2.Ex2.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S2.Ex2.m1.3">
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMDual>
                        <XMRef idref="S2.Ex2.m1.3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S2.Ex2.m1.3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                          <XMTok role="UNKNOWN">min</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S2.Ex2.m1.1"/>
                              <XMRef idref="S2.Ex2.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex2.m1.1">z</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S2.Ex2.m1.2">θ</XMTok>
                              <XMTok role="CLOSE" rpadding="1.7pt" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S2.Ex2.m1.3.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.Ex2.m1.3.2">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="\ell" text="ell" xml:id="S2.SS3.p1.m4">
            <XMath>
              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
            </XMath>
          </Math> is a loss function. For example, <Math mode="inline" tex="\ell(z,\theta)=(z-\theta)^{2}" text="ell * open-interval@(z, theta) = (z - theta) ^ 2" xml:id="S2.SS3.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S2.SS3.p1.m5.1"/>
                      <XMRef idref="S2.SS3.p1.m5.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS3.p1.m5.1">z</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S2.SS3.p1.m5.2">θ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMRef idref="S2.SS3.p1.m5.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S2.SS3.p1.m5.3">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> would return <Math mode="inline" tex="\theta_{0}" text="theta _ 0" xml:id="S2.SS3.p1.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> as the mean, and <Math mode="inline" tex="\ell(z,\theta)=-\log p(z\mid\theta)" text="ell * open-interval@(z, theta) = - logarithm@(p) * conditional@(z, theta)" xml:id="S2.SS3.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S2.SS3.p1.m7.1"/>
                      <XMRef idref="S2.SS3.p1.m7.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS3.p1.m7.1">z</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S2.SS3.p1.m7.2">θ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.SS3.p1.m7.3"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.SS3.p1.m7.3">
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> would return the KL minimizing parameter between <Math class="ltx_math_unparsed" mode="inline" tex="p(\cdot\mid\theta)" xml:id="S2.SS3.p1.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                <XMTok name="mid" role="VERTBAR">∣</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMath>
          </Math> and <Math mode="inline" tex="p_{0}" text="p _ 0" xml:id="S2.SS3.p1.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S2.SS3.p2">
        <p>The next step of the martingale posterior is to construct a <emph font="italic">joint</emph> predictive density on <Math mode="inline" tex="Z^{\prime}=\{z_{i}\}_{i=n+1}^{N}" text="Z ^ prime = ((set@(z _ i)) _ (i = n + 1)) ^ N" xml:id="S2.SS3.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S2.SS3.p2.m1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S2.SS3.p2.m1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for some large <Math mode="inline" tex="N" text="N" xml:id="S2.SS3.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math>, which we write as <Math mode="inline" tex="p(Z^{\prime}\mid Z)" text="p * conditional@(Z ^ prime, Z)" xml:id="S2.SS3.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p2.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p2.m3.1">
                      <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. In a similar fashion to a bootstrap, one can imagine drawing <Math mode="inline" tex="Z^{\prime}\sim p(Z^{\prime}\mid Z)" text="Z ^ prime similar-to p * conditional@(Z ^ prime, Z)" xml:id="S2.SS3.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S2.SS3.p2.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S2.SS3.p2.m4.1">
                        <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, then computing <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="S2.SS3.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p2.m5.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p2.m5.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="g_{N}(z)=\frac{1}{N}\sum_{i=1}^{N}\delta_{z_{i}}(z)" text="g _ N * z = (1 / N) * ((sum _ (i = 1)) ^ N)@(delta _ z _ i * z)" xml:id="S2.SS3.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">g</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S2.SS3.p2.m6.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS3.p2.m6.1">z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S2.SS3.p2.m6.2"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS3.p2.m6.2">z</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><!--  %“ljh–Define $“theta(g˙N)$ somewhere?˝ -->. The predictive uncertainty in <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S2.SS3.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> induces uncertainty in <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="S2.SS3.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p2.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p2.m8.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> conditional on <Math mode="inline" tex="Z" text="Z" xml:id="S2.SS3.p2.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
            </XMath>
          </Math>. The key connection is that if <Math mode="inline" tex="p(Z^{\prime}\mid Z)" text="p * conditional@(Z ^ prime, Z)" xml:id="S2.SS3.p2.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p2.m10.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p2.m10.1">
                      <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is the Bayesian joint posterior predictive density, and <Math mode="inline" tex="\ell=-\log p(z\mid\theta)" text="ell = - logarithm@(p) * conditional@(z, theta)" xml:id="S2.SS3.p2.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.SS3.p2.m11.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.SS3.p2.m11.1">
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, then <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="S2.SS3.p2.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p2.m12.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p2.m12.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is distributed according to the Bayesian posterior <Math mode="inline" tex="\pi(\theta\mid Z)" text="pi * conditional@(theta, Z)" xml:id="S2.SS3.p2.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p2.m13.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p2.m13.1">
                      <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> as <Math mode="inline" tex="N\to\infty" text="N to infinity" xml:id="S2.SS3.p2.m14">
            <XMath>
              <XMApp>
                <XMTok name="to" role="ARROW">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                <XMTok meaning="infinity" name="infty" role="ID">∞</XMTok>
              </XMApp>
            </XMath>
          </Math>, under weak conditions. In other words, posterior uncertainty in <Math mode="inline" tex="\theta" text="theta" xml:id="S2.SS3.p2.m15">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> is equivalent to predictive uncertainty in <Math mode="inline" tex="\{z_{i}\}_{i=n+1}^{\infty}" text="((set@(z _ i)) _ (i = n + 1)) ^ infinity" xml:id="S2.SS3.p2.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S2.SS3.p2.m16.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S2.SS3.p2.m16.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok fontsize="70%" meaning="infinity" name="infty" role="ID">∞</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S2.SS3.p3">
        <p><cite class="ltx_citemacro_cite"><bibref bibrefs="fong2021martingale" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> specify more general <Math mode="inline" tex="p(Z^{\prime}\mid Z)" text="p * conditional@(Z ^ prime, Z)" xml:id="S2.SS3.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p3.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p3.m1.1">
                      <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> directly beyond the Bayesian posterior predictive, and define the (finite) martingale posterior
as
<Math mode="inline" tex="\pi_{N}(\theta\in A\mid Z)=\int\mathbbm{1}(\theta(g_{N})\in A)\,p(dZ^{\prime}%&#10;\mid Z)" text="pi _ N * (theta element-of conditional@(A, Z)) = integral@(1 * (theta * g _ N element-of A) * p * conditional@(d * Z ^ prime, Z))" xml:id="S2.SS3.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S2.SS3.p3.m2.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S2.SS3.p3.m2.1">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMApp>
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMTok font="italic" role="UNKNOWN">A</XMTok>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="blackboard" meaning="1" role="NUMBER">1</XMTok>
                    <XMDual>
                      <XMRef idref="S2.SS3.p3.m2.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.SS3.p3.m2.2">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMDual>
                              <XMRef idref="S2.SS3.p3.m2.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S2.SS3.p3.m2.2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">A</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" rpadding="1.7pt" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="S2.SS3.p3.m2.3"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.SS3.p3.m2.3">
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. In particular, the joint predictive density can be factorized into a sequence of 1-step-ahead predictives,
<Math mode="inline" tex="p(Z^{\prime}\mid Z)=\prod_{i=n+1}^{N}p(z_{i}\mid z_{1:i-1})," text="p * conditional@(Z ^ prime, Z) = ((product _ (i = n + 1)) ^ N)@(p * conditional@(z _ i, z _ (1 colon i - 1)))" xml:id="S2.SS3.p3.m3">
            <XMath>
              <XMDual>
                <XMRef idref="S2.SS3.p3.m3.1"/>
                <XMWrap>
                  <XMApp xml:id="S2.SS3.p3.m3.1">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMDual>
                        <XMRef idref="S2.SS3.p3.m3.1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S2.SS3.p3.m3.1.1">
                            <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok mathstyle="text" meaning="product" name="prod" role="SUMOP" scriptpos="post">∏</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMDual>
                          <XMRef idref="S2.SS3.p3.m3.1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.SS3.p3.m3.1.2">
                              <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
and the sequence <Math mode="inline" tex="\{p(z_{i}\mid z_{1:i-1})\}_{n+1}^{N}" text="((set@(p * conditional@(z _ i, z _ (1 colon i - 1)))) _ (n + 1)) ^ N" xml:id="S2.SS3.p3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S2.SS3.p3.m4.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S2.SS3.p3.m4.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMDual>
                          <XMRef idref="S2.SS3.p3.m4.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.SS3.p3.m4.1.1">
                              <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math> is elicited directly, removing the need for the likelihood and prior. Hyperparameters for the sequence of predictive distributions can be fitted in a data-driven way by maximizing</p>
        <equation xml:id="S2.Ex3">
          <Math mode="display" tex="\log p(Z)=\sum_{i=1}^{n}\log p(z_{i}\mid z_{1:i-1})," text="logarithm@(p) * Z = ((sum _ (i = 1)) ^ n)@(logarithm@(p) * conditional@(z _ i, z _ (1 colon i - 1)))" xml:id="S2.Ex3.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S2.Ex3.m1.2"/>
                <XMWrap>
                  <XMApp xml:id="S2.Ex3.m1.2">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S2.Ex3.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex3.m1.1">Z</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.Ex3.m1.2.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.Ex3.m1.2.1">
                              <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>which is analogous to the log marginal likelihood. <cite class="ltx_citemacro_cite"><bibref bibrefs="fong2021martingale" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> requires the sequence of predictives to be <ERROR class="undefined">\gls</ERROR>cid, which is a martingale condition on the sequence of predictives that ensures <Math mode="inline" tex="g_{N}" text="g _ N" xml:id="S2.SS3.p3.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math> exists almost surely. The Bayesian posterior predictive density is a special case, as exchangeability of <Math mode="inline" tex="p(Z^{\prime}\mid Z)" text="p * conditional@(Z ^ prime, Z)" xml:id="S2.SS3.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS3.p3.m6.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS3.p3.m6.1">
                      <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> implies the sequence of predictives is <ERROR class="undefined">\gls</ERROR>cid In fact, De Finetti’s theorem <cite class="ltx_citemacro_citep">[<bibref bibrefs="de1937prevision" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite> guarantees that any exchangeable joint density implies an underlying likelihood-prior form, but specifying the predictive density directly can be advantageous. It allows for easier computation, as we no longer require posterior approximations, and it also widens the class of available nonparametric predictives which we will see shortly.</p>
      </para>
<!--  %“ljh–Will you describe what a ‘‘martingale posterior’’ actually is here? (Definition 1 in “citet–fong2021martingale˝)˝. 
     %“ed–Just brainstorming some ideas below˝ 
     %In the meta-learning context, for each $“tau˙j “sim p(“tau)$, we are interested in  obtaining predictives $p˙“phi( “mathcal–D˝˙c’ “mid “mathcal–D˝˙c)$, where $“mathcal–D˝˙c’ = “–z˙i“˝˙–i = n+1:N˝$ and $“mathcal–D˝˙c “mid “tau˙j$ consists of i.i.d. samples. The log marginal likelihood for each task is $“log p(“mathcal–D˝˙c)$, so a valid training objective could be $E˙“tau[“log p(“mathcal–D˝˙c)]$. However, as we specify $p(“mathcal–D˝˙c’ “mid “mathcal–D˝˙c)$ directly, it is not obvious how to compute $“log p(“mathcal–D˝˙c)$. Instead, we could estimate this with  cross-validation, that is $p(“mathcal–D˝˙c^–“text–test˝˝“mid “mathcal–D˝˙c^–“text–train˝˝)$, where $“mathcal–D˝˙c = “mathcal–D˝˙c^–“text–test˝˝“cup “mathcal–D˝˙c^–“text–train˝˝$. Or is there anything stopping us from using $p(“mathcal–D˝˙t “mid “mathcal–D˝˙c)$? 
     %“ed–I was thinking $p(“calD˙t—“calD˙c)$ where $p$ is the generative model (not decoder), but I think this is very similar to $p(“mathcal–D˝˙c^–“text–test˝˝“mid “mathcal–D˝˙c^–“text–train˝˝)$.˝ 
     %“lhg–Ah... I see... Actually, I think we can’t measure $p(“calD˙t—“calD˙c)$ without decoder. I also tried $p(“calD˙c^–“text–test˝˝—“calD˙c^–train˝)$ with decoder. ˝ 
     %“ed–Ah I see, because we only have a generative model right? That’s a great motivator for the third term in (14) then. ˝ 
     %“lhg–yes. That’s right:)˝ 
     %–“textcolor–red˝–Hyungi: I think we can try $p(“mathcal–D˝˙c^–“text–test˝˝“mid “mathcal–D˝˙c^–“text–train˝˝)$ as our training objective and a minor curious point is ”Is this training objective helps our generator to make some reasonable pseudo context data?”. I think we have to check this with experiment. By the way $p(D˙C’’—D˙C “cup (D˙C’“textbackslash D˙C’’))$ loss did not work for directly generating pseudo context data framework.˝ ˝ 
     %“ed––Maybe it makes sense that the old objective doesn’t work too well, since $“mathcal–D˝˙C’ $ is simulated from $p(“mathcal–D˝˙C’ “mid “mathcal–D˝˙C)$, so it will always have high likelihood. Whereas checking the model on the actual observed $“mathcal–D˝˙c$ will force it to fit well?˝˝ 
     %“ed–Thanks for the update! By our feature model, do you mean the current objective in equation (14) performs the best? If so, maybe we should just stick to that then. We can also argue that it is somewhat difficult to estimate the density values $p(“mathcal–D˝˙C’ “mid “mathcal–D˝˙C)$ as the predictive is generative, and the third term is kind of a proxy for this ‘marginal likelihood’. ˝ 
     %**** background.tex Line 125 **** 
     %“lhg–Yeah, equation (14) performs the best. We are now doing some last trials on directly sampling version. As you said, I think we should stick to equation (14) and feature generating model.˝ 
     %“ed–Nice, I think it’s clear now and yes I agree :) I’ll perhaps add a sentence after (14) to describe the lack of a tractable marginal likelihood density. Will comment out the above after.˝ 
     %“lhg–That will be great for us. Thank you˝ 
     %–“color–red˝ Edwin: Expand to meta-learning framework, may need discussion of amortization? Or leave in Section 3.1? ˝ 
     %–“color–red˝ Juho: I will discuss the amortization part in section 3.1.˝ -->    </subsection>
    <subsection inlist="toc" labels="LABEL:main:subsec:exchangeable" xml:id="S2.SS4">
      <tags>
        <tag>2.4</tag>
        <tag role="autoref">subsection 2.4</tag>
        <tag role="refnum">2.4</tag>
        <tag role="typerefnum">§2.4</tag>
      </tags>
      <title><tag close=" ">2.4</tag>Exchangeable Generative Models</title>
      <para xml:id="S2.SS4.p1">
        <p>To construct a martingale posterior, we can either specify a sequence of one-step predictive distributions or the joint predictive density distribution directly, as long as the <ERROR class="undefined">\gls</ERROR>cid condition is satisfied. Here, we opt to specify an exchangeable <Math mode="inline" tex="p(Z^{\prime}\mid Z)" text="p * conditional@(Z ^ prime, Z)" xml:id="S2.SS4.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS4.p1.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS4.p1.m1.1">
                      <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> directly, which then implies the required <ERROR class="undefined">\gls</ERROR>cid predictives. We now briefly review exchangeable generative models which can be used to specify the exchangeable joint predictive. For a set of random variables <Math mode="inline" tex="Z=\{z_{i}\}_{i=1}^{n}" text="Z = ((set@(z _ i)) _ (i = 1)) ^ n" xml:id="S2.SS4.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S2.SS4.p1.m2.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S2.SS4.p1.m2.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> with each <Math mode="inline" tex="z_{i}\in{\mathcal{Z}}=\mathbb{R}^{d}" text="z _ i element-of Z = R ^ d" xml:id="S2.SS4.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">Z</XMTok>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we say the joint distribution <Math mode="inline" tex="p(Z)" text="p * Z" xml:id="S2.SS4.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS4.p1.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS4.p1.m4.1">Z</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is <emph font="italic">exchangeable</emph> if it is invariant to the arbitrary permutation of the indices, that is, <Math mode="inline" tex="p(Z)=p(\pi\cdot Z)" text="p * Z = p * (pi cdot Z)" xml:id="S2.SS4.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S2.SS4.p1.m5.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS4.p1.m5.1">Z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S2.SS4.p1.m5.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S2.SS4.p1.m5.2">
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for any permutation <Math mode="inline" tex="\pi" text="pi" xml:id="S2.SS4.p1.m6">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math> of <Math mode="inline" tex="[n]" text="delimited-[]@(n)" xml:id="S2.SS4.p1.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="delimited-[]"/>
                  <XMRef idref="S2.SS4.p1.m7.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS4.p1.m7.1">n</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. A simple way to construct such exchangeable random variables is to use a <emph font="italic">permutation-equivariant mapping</emph>. A mapping <Math mode="inline" tex="\mathbf{f}:{\mathcal{Z}}^{n}\to{\mathcal{Z}}^{n}" text="f colon Z ^ n to Z ^ n" xml:id="S2.SS4.p1.m8">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMApp>
                  <XMTok name="to" role="ARROW">→</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">Z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">Z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is permutation equivariant if <Math mode="inline" tex="\mathbf{f}(\pi\cdot Z)=\pi\cdot\mathbf{f}(Z)" text="f * (pi cdot Z) = (pi cdot f) * Z" xml:id="S2.SS4.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                  <XMDual>
                    <XMRef idref="S2.SS4.p1.m9.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S2.SS4.p1.m9.2">
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S2.SS4.p1.m9.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS4.p1.m9.1">Z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for any <Math mode="inline" tex="\pi" text="pi" xml:id="S2.SS4.p1.m10">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math>. Given <Math mode="inline" tex="\mathbf{f}" text="f" xml:id="S2.SS4.p1.m11">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, we can first generate i.i.d. random variables and apply <Math mode="inline" tex="\mathbf{f}" text="f" xml:id="S2.SS4.p1.m12">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> to construct a potentially correlated but exchangeable set of random variables <Math mode="inline" tex="Z" text="Z" xml:id="S2.SS4.p1.m13">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
            </XMath>
          </Math> as follows:</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx8">
          <equation xml:id="S2.E8">
            <tags>
              <tag>(8)</tag>
              <tag role="autoref">Equation 8</tag>
              <tag role="refnum">8</tag>
            </tags>
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle{\mathcal{E}}:=\{\varepsilon_{i}\}_{i=1}^{n}\overset{\mathrm{i.i.%&#10;d.}}{\sim}p_{0},\quad Z=\mathbf{f}({\mathcal{E}})." text="formulae@(E assign ((set@(varepsilon _ i)) _ (i = 1)) ^ n * i@.@i@.@d@.@(similar-to) * p _ 0, Z = f * E)" xml:id="S2.E8.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E8.m2.5"/>
                    <XMWrap>
                      <XMDual xml:id="S2.E8.m2.5">
                        <XMApp>
                          <XMTok meaning="formulae"/>
                          <XMRef idref="S2.E8.m2.5.1"/>
                          <XMRef idref="S2.E8.m2.5.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S2.E8.m2.5.1">
                            <XMTok meaning="assign" role="RELOP">:=</XMTok>
                            <XMTok font="caligraphic" role="UNKNOWN">E</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="set"/>
                                      <XMRef idref="S2.E8.m2.5.1.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                                      <XMApp xml:id="S2.E8.m2.5.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMWrap role="OVERACCENT">
                                  <XMTok role="UNKNOWN" xml:id="S2.E8.m2.1">i</XMTok>
                                  <XMTok role="PERIOD">.</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="S2.E8.m2.2">i</XMTok>
                                  <XMTok role="PERIOD">.</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="S2.E8.m2.3">d</XMTok>
                                  <XMTok role="PERIOD">.</XMTok>
                                </XMWrap>
                                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                          <XMApp xml:id="S2.E8.m2.5.2">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="bold" role="UNKNOWN">f</XMTok>
                              <XMDual>
                                <XMRef idref="S2.E8.m2.4"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E8.m2.4">E</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle{\mathcal{E}}:=\{\varepsilon_{i}\}_{i=1}^{n}\overset{\mathrm{i.i.%&#10;d.}}{\sim}p_{0},\quad Z=\mathbf{f}({\mathcal{E}})." text="formulae@(E assign ((set@(varepsilon _ i)) _ (i = 1)) ^ n * i@.@i@.@d@.@(similar-to) * p _ 0, Z = f * E)" xml:id="S2.E8.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E8.m1.5"/>
                        <XMWrap>
                          <XMDual xml:id="S2.E8.m1.5">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="S2.E8.m1.5.1"/>
                              <XMRef idref="S2.E8.m1.5.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S2.E8.m1.5.1">
                                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                <XMTok font="caligraphic" role="UNKNOWN">E</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="S2.E8.m1.5.1.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                                          <XMApp xml:id="S2.E8.m1.5.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMWrap role="OVERACCENT">
                                      <XMTok role="UNKNOWN" xml:id="S2.E8.m1.1">i</XMTok>
                                      <XMTok role="PERIOD">.</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="S2.E8.m1.2">i</XMTok>
                                      <XMTok role="PERIOD">.</XMTok>
                                      <XMTok role="UNKNOWN" xml:id="S2.E8.m1.3">d</XMTok>
                                      <XMTok role="PERIOD">.</XMTok>
                                    </XMWrap>
                                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                              <XMApp xml:id="S2.E8.m1.5.2">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                  <XMDual>
                                    <XMRef idref="S2.E8.m1.4"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E8.m1.4">E</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>For <Math mode="inline" tex="\mathbf{f}" text="f" xml:id="S2.SS4.p1.m14">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math>, we employ the modules introduced in <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2019set" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>. Specifically, we use a permutation equivariant module called <ERROR class="undefined">\gls</ERROR>isab. An <ERROR class="undefined">\gls</ERROR>isab mixes input sets through a learnable set of parameters called <emph font="italic">inducing points</emph> via <ERROR class="undefined">\glspl</ERROR>mab <cite class="ltx_citemacro_citep">[<bibref bibrefs="vaswani2017attention,lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>.</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx9">
          <equation xml:id="S2.E9">
            <tags>
              <tag>(9)</tag>
              <tag role="autoref">Equation 9</tag>
              <tag role="refnum">9</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\textsc{isab}({\mathcal{E}})=\textsc{mab}({\mathcal{E}},H)\in%&#10;\mathbb{R}^{n\times d}\text{ where }H=\textsc{mab}(I,{\mathcal{E}})\in\mathbb{%&#10;R}^{m\times d}." text="[isab] * E = [mab] * open-interval@(E, H) element-of R ^ (n * d) * [ where ] * H = [mab] * open-interval@(I, E) element-of R ^ (m * d)" xml:id="S2.E9.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S2.E9.m2.6"/>
                    <XMWrap>
                      <XMApp xml:id="S2.E9.m2.6">
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText><text font="smallcaps">isab</text></XMText>
                          <XMDual>
                            <XMRef idref="S2.E9.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E9.m2.1">E</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText><text font="smallcaps">mab</text></XMText>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S2.E9.m2.2"/>
                              <XMRef idref="S2.E9.m2.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E9.m2.2">E</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E9.m2.3">H</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMText> where </XMText>
                          <XMTok font="italic" role="UNKNOWN">H</XMTok>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText><text font="smallcaps">mab</text></XMText>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S2.E9.m2.4"/>
                              <XMRef idref="S2.E9.m2.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E9.m2.4">I</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E9.m2.5">E</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\textsc{isab}({\mathcal{E}})=\textsc{mab}({\mathcal{E}},H)\in%&#10;\mathbb{R}^{n\times d}\text{ where }H=\textsc{mab}(I,{\mathcal{E}})\in\mathbb{%&#10;R}^{m\times d}." text="[isab] * E = [mab] * open-interval@(E, H) element-of R ^ (n * d) * [ where ] * H = [mab] * open-interval@(I, E) element-of R ^ (m * d)" xml:id="S2.E9.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S2.E9.m1.6"/>
                        <XMWrap>
                          <XMApp xml:id="S2.E9.m1.6">
                            <XMTok meaning="multirelation"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText><text font="smallcaps">isab</text></XMText>
                              <XMDual>
                                <XMRef idref="S2.E9.m1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E9.m1.1">E</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText><text font="smallcaps">mab</text></XMText>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S2.E9.m1.2"/>
                                  <XMRef idref="S2.E9.m1.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E9.m1.2">E</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E9.m1.3">H</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMText> where </XMText>
                              <XMTok font="italic" role="UNKNOWN">H</XMTok>
                            </XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText><text font="smallcaps">mab</text></XMText>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S2.E9.m1.4"/>
                                  <XMRef idref="S2.E9.m1.5"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.E9.m1.4">I</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.E9.m1.5">E</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Here, <Math mode="inline" tex="I\in\mathbb{R}^{m\times d}" text="I element-of R ^ (m * d)" xml:id="S2.SS4.p1.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">I</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a set of <Math mode="inline" tex="m" text="m" xml:id="S2.SS4.p1.m16">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">m</XMTok>
            </XMath>
          </Math> inducing points and <Math mode="inline" tex="\textsc{mab}(\cdot,\cdot)" text="[mab] * open-interval@(cdot, cdot)" xml:id="S2.SS4.p1.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMText><text font="smallcaps">mab</text></XMText>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS4.p1.m17.1"/>
                    <XMRef idref="S2.SS4.p1.m17.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S2.SS4.p1.m17.1">⋅</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S2.SS4.p1.m17.2">⋅</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> computes attention between two sets.
The time-complexity of an <ERROR class="undefined">\gls</ERROR>isab is <Math mode="inline" tex="O(nm)" text="O * n * m" xml:id="S2.SS4.p1.m18">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS4.p1.m18.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S2.SS4.p1.m18.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, scales linear with input set sizes.</p>
      </para>
<!--  %“paragraph–Exchangeability˝ 
     %In order to generate a set structured data, model should satisfy a condition called “textit–exchangeability˝~“citep–kim2021setvae˝. Exchangeability condition means that the probability of generated set data does not depend on its ordering. To achieve exchangeability, a joint distribution of the generated set data should satisfy permutation invariance. In other words, for a set of random variables $“bX=“–X˙i“˝˙–i=1˝^n$ and for any permutation $“pi$, joint probability $p$ should satisfy: 
     %**** background.tex Line 150 **** 
     %“begin–align˝ 
     %p(“bX) = p(“pi(“bX)). 
     %“end–align˝ 
     %A nice and easy way to make a permutation invariant joint distribution is using a permutation equivariant function $f˙–“text–per˝˝$ and “textit–i.i.d.˝ random variable set $“bX’=“–X˙i’“˝˙–i=1˝^n$ which is called “textit–permutation-equivariant generative framework˝~“citep–kim2021setvae˝. 
     %In this framework, if we let $“bX = f˙–“text–per˝˝(“bX’)$ then the joint distribution of $“bX$ satisfies permutation invariant. 
     %“paragraph–Set Transformer˝ Set Transformer~“citep–lee2019set˝ is an attention-based neural network model which satisfies permutation invariant property for input dataset. It contains permutation equivariant module called ISAB. ISAB transforms the input dataset $“bx“in“bbR^–n“times d˝$ by a smaller set $I“in“bbR^–m“times d˝$ called inducing points: 
     %“begin–align˝ 
     %“text–ISAB˝(“bx) &amp;= “text–MAB˝(“bx, “bH)“in“bbR^–n“times d˝,““ 
     %“text–where ˝ “bH &amp;=“text–MAB˝(I,“bx)“in“bbR^–m“times d˝ 
     %“end–align˝ 
     %where MAB is a Multihead Attention Block which is a part of the Transformer~“citep–vaswani2017attention˝ encoder block except dropout and positional encoding. -->    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:main:sec:methods" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Methods</title>
    <para xml:id="S3.p1">
      <p><!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->In this section, we present a novel extension of <ERROR class="undefined">\gls</ERROR>npf called <ERROR class="undefined">\glspl</ERROR>mpnp. The main idea is to elicit joint predictive distributions that are constructed with equivariant neural networks instead of assuming priors for <Math mode="inline" tex="\theta" text="theta" xml:id="S3.p1.m1">
          <XMath>
            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
          </XMath>
        </Math>, and let the corresponding martingale posterior describe the functional uncertainty in the <ERROR class="undefined">\glspl</ERROR>np. We describe how we construct a <ERROR class="undefined">\gls</ERROR>mpnp in <ref labelref="LABEL:main:subsec:mpnp" show="creftype~refnum"/> and train it in <ref labelref="LABEL:main:subsec:training" show="creftype~refnum"/>.</p>
    </para>
<!--  %In “cref–main:subsec:mpnp˝, we describe how we construct “gls–mpnp˝ to generate pseudo context dataset $Z’$ from a given context set $Z˙C$. In “cref–main:subsec:training˝, we present a training procedure of “gls–mpnp˝. -->    <subsection inlist="toc" labels="LABEL:main:subsec:mpnp" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Martingale Posterior Neural Processes</title>
      <para xml:id="S3.SS1.p1">
        <p>Recall that the functional uncertainty in a <ERROR class="undefined">\gls</ERROR>np is encoded in a parameter <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math>. Rather than learning an approximate posterior <Math mode="inline" tex="q(\theta|Z_{c})" text="q * conditional@(theta, Z _ c)" xml:id="S3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p1.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m2.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, we introduce a joint predictive <Math mode="inline" tex="p(Z^{\prime}|Z_{c};\phi_{\text{pred}})" text="p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred]))" xml:id="S3.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p1.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m3.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S3.SS1.p1.m3.1.1"/>
                          <XMRef idref="S3.SS1.p1.m3.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S3.SS1.p1.m3.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">;</XMTok>
                          <XMApp xml:id="S3.SS1.p1.m3.1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                            <XMText><text fontsize="70%">pred</text></XMText>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> generating a <emph font="italic">pseudo context set</emph> <Math mode="inline" tex="Z^{\prime}=\{z^{\prime}_{i}\}_{i=1}^{N-|c|}" text="Z ^ prime = ((set@((z ^ prime) _ i)) _ (i = 1)) ^ (N - absolute-value@(c))" xml:id="S3.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S3.SS1.p1.m4.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S3.SS1.p1.m4.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">z</XMTok>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="S3.SS1.p1.m4.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS1.p1.m4.1">c</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> of size <Math mode="inline" tex="(N-|c|)\geq 1" text="N - absolute-value@(c) &gt;= 1" xml:id="S3.SS1.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p1.m5.2"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m5.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="S3.SS1.p1.m5.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m5.1">c</XMTok>
                          <XMTok role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %“ed–One question reviewers might ask is why do we use the MP $p(Z’ “mid Z˙c)$ instead of a more flexible $q(“theta “mid Z˙c)$ (e.g. a generative model). Amortization might be a key motivator, which helps us model the deterministic and latent path. It’s more natural to combine the pseudo and context data to get $“theta(Z’ “cup Z˙c)$ than to decode a latent $“theta$ and deterministic $“phi(Z˙c)$ through $f(“theta,“phi)$ like in “citep–kim2018attentive˝. ˝ -->.
Having generated a pseudo context, we combine with the existing context <!--  %“ljh–That is actually a good point. One possible answer is that, we can actually go beyond Bayesian inference by using alternative $“ell(z,“theta)$, and say that at least in this work we focused on $“ell$ being negative likelihood to showcase the idea. Another thing we could say is that, we potentially are not sure whether the parameter $“theta$ needs to be finite-dimensional vector; for instance, depending on the application, it would be more natural to assume that $“theta$ itself is a stochastic process. While even the most complex generative models (e.g., normalizing flows) cannot easily deal with them, ours can hypothetically cover that case. 
     %˝ --><Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.p1.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
              </XMApp>
            </XMath>
          </Math>, and construct the empirical density as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx10">
          <equation xml:id="S3.E10">
            <tags>
              <tag>(10)</tag>
              <tag role="autoref">Equation 10</tag>
              <tag role="refnum">10</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle g_{N}(z)=\frac{1}{N}\bigg{(}\sum_{i\in c}\delta_{z_{i}}(z)+\sum_%&#10;{i=1}^{N-|c|}\delta_{z^{\prime}_{i}}(z)\bigg{)}." text="g _ N * z = (1 / N) * ((sum _ (i element-of c))@(delta _ z _ i * z) + ((sum _ (i = 1)) ^ (N - absolute-value@(c)))@(delta _ (z ^ prime) _ i * z))" xml:id="S3.E10.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E10.m2.5"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E10.m2.5">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E10.m2.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m2.2">z</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E10.m2.5.1"/>
                            <XMWrap>
                              <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E10.m2.5.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E10.m2.3"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m2.3">z</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="absolute-value"/>
                                          <XMRef idref="S3.E10.m2.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E10.m2.1">c</XMTok>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E10.m2.4"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m2.4">z</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle g_{N}(z)=\frac{1}{N}\bigg{(}\sum_{i\in c}\delta_{z_{i}}(z)+\sum_%&#10;{i=1}^{N-|c|}\delta_{z^{\prime}_{i}}(z)\bigg{)}." text="g _ N * z = (1 / N) * ((sum _ (i element-of c))@(delta _ z _ i * z) + ((sum _ (i = 1)) ^ (N - absolute-value@(c)))@(delta _ (z ^ prime) _ i * z))" xml:id="S3.E10.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E10.m1.5"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E10.m1.5">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E10.m1.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.2">z</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E10.m1.5.1"/>
                                <XMWrap>
                                  <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E10.m1.5.1">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="S3.E10.m1.3"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.3">z</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="absolute-value"/>
                                              <XMRef idref="S3.E10.m1.1"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E10.m1.1">c</XMTok>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="S3.E10.m1.4"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.4">z</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Given <Math mode="inline" tex="g_{N}" text="g _ N" xml:id="S3.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math>, the estimate of the function parameter <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS1.p1.m8">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> is then recovered as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx11">
          <equation labels="LABEL:eq:recovering_theta" xml:id="S3.E11">
            <tags>
              <tag>(11)</tag>
              <tag role="autoref">Equation 11</tag>
              <tag role="refnum">11</tag>
            </tags>
            <MathFork>
              <Math content-tex="\displaystyle\theta(g_{N}):=\argmin_{\theta}\int\ell(z,\theta)g_{N}(dz)," tex="\displaystyle\theta(g_{N}):=\operatorname*{arg\,min}_{\theta}\int\ell(z,\theta%&#10;)g_{N}(dz)," text="theta * g _ N assign argmin _ theta * integral@(ell * open-interval@(z, theta) * g _ N * d * z)" xml:id="S3.E11.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E11.m2.3"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E11.m2.3">
                        <XMTok meaning="assign" role="RELOP">:=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E11.m2.3.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E11.m2.3.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                              <XMTok role="UNKNOWN">min</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S3.E11.m2.1"/>
                                  <XMRef idref="S3.E11.m2.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.E11.m2.1">z</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E11.m2.2">θ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E11.m2.3.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E11.m2.3.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math content-tex="\displaystyle\theta(g_{N}):=\argmin_{\theta}\int\ell(z,\theta)g_{N}(dz)," mode="inline" tex="\displaystyle\theta(g_{N}):=\operatorname*{arg\,min}_{\theta}\int\ell(z,\theta%&#10;)g_{N}(dz)," text="theta * g _ N assign argmin _ theta * integral@(ell * open-interval@(z, theta) * g _ N * d * z)" xml:id="S3.E11.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E11.m1.3"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E11.m1.3">
                            <XMTok meaning="assign" role="RELOP">:=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E11.m1.3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E11.m1.3.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                  <XMTok role="UNKNOWN">min</XMTok>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E11.m1.1"/>
                                      <XMRef idref="S3.E11.m1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E11.m1.1">z</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E11.m1.2">θ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S3.E11.m1.3.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E11.m1.3.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p><!--  %**** methods.tex Line 25 **** -->where in our case we simply choose <Math mode="inline" tex="\ell(z,\theta):=-\log{\mathcal{N}}(y|\mu_{\theta}(x),\sigma^{2}_{\theta}(x)I_{%&#10;d_{\text{out}}})" text="ell * open-interval@(z, theta) assign - logarithm@(N) * conditional@(y, list@(mu _ theta * x, (sigma ^ 2) _ theta * x * I _ d _ [out]))" xml:id="S3.SS1.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.SS1.p1.m9.1"/>
                      <XMRef idref="S3.SS1.p1.m9.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m9.1">z</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.SS1.p1.m9.2">θ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                      <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S3.SS1.p1.m9.5"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.p1.m9.5">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">y</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="S3.SS1.p1.m9.5.1"/>
                              <XMRef idref="S3.SS1.p1.m9.5.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S3.SS1.p1.m9.5.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.SS1.p1.m9.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m9.3">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.SS1.p1.m9.5.2">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.SS1.p1.m9.4"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m9.4">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                    <XMText><text fontsize="50%">out</text></XMText>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. The uncertainty in <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="S3.SS1.p1.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p1.m10.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m10.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is thus induced by the uncertainty in the generated pseudo context <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.p1.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <paragraph inlist="toc" xml:id="S3.SS1.SSS0.Px1">
        <title>Amortization</title>
        <para xml:id="S3.SS1.SSS0.Px1.p1">
          <p>The procedure of recovering <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS1.SSS0.Px1.p1.m1">
              <XMath>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              </XMath>
            </Math> via <ref labelref="LABEL:eq:recovering_theta" show="creftype~refnum"/> would originally require iterative optimization process except for simple cases. Fortunately, in our case, we can <emph font="italic">amortize</emph> this procedure, thanks to the mechanism of <ERROR class="undefined">\glspl</ERROR>cnp amortizing the inference procedure of estimating <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS1.SSS0.Px1.p1.m2">
              <XMath>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              </XMath>
            </Math> from the context. Given <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math>, a <ERROR class="undefined">\gls</ERROR>cnp learns an encoder producing <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS1.SSS0.Px1.p1.m4">
              <XMath>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              </XMath>
            </Math> that is trained to maximize the expected likelihood. That is,</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx12">
            <equation xml:id="S3.E12">
              <tags>
                <tag>(12)</tag>
                <tag role="autoref">Equation 12</tag>
                <tag role="refnum">12</tag>
              </tags>
              <MathFork>
                <Math content-tex="\displaystyle\tilde{\theta}(Z_{c})=f_{\text{enc}}(Z_{c};\phi_{\text{enc}}),%&#10;\quad\tilde{\theta}(Z_{c})\approx\argmin_{\theta}\int\ell(z,\theta)g_{c}(dz)," tex="\displaystyle\tilde{\theta}(Z_{c})=f_{\text{enc}}(Z_{c};\phi_{\text{enc}}),%&#10;\quad\tilde{\theta}(Z_{c})\approx\operatorname*{arg\,min}_{\theta}\int\ell(z,%&#10;\theta)g_{c}(dz)," text="formulae@(tilde@(theta) * Z _ c = f _ [enc] * list@(Z _ c, phi _ [enc]), tilde@(theta) * Z _ c approximately-equals argmin _ theta * integral@(ell * open-interval@(z, theta) * g _ c * d * z))" xml:id="S3.E12.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="S3.E12.m2.3"/>
                      <XMWrap>
                        <XMDual xml:id="S3.E12.m2.3">
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="S3.E12.m2.3.1"/>
                            <XMRef idref="S3.E12.m2.3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E12.m2.3.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.E12.m2.3.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E12.m2.3.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                  <XMText><text fontsize="70%">enc</text></XMText>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S3.E12.m2.3.1.2"/>
                                    <XMRef idref="S3.E12.m2.3.1.3"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E12.m2.3.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">;</XMTok>
                                    <XMApp xml:id="S3.E12.m2.3.1.3">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                      <XMText><text fontsize="70%">enc</text></XMText>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                            <XMApp xml:id="S3.E12.m2.3.2">
                              <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.E12.m2.3.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E12.m2.3.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                    <XMTok role="UNKNOWN">min</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E12.m2.1"/>
                                        <XMRef idref="S3.E12.m2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E12.m2.1">z</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E12.m2.2">θ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E12.m2.3.2.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E12.m2.3.2.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math content-tex="\displaystyle\tilde{\theta}(Z_{c})=f_{\text{enc}}(Z_{c};\phi_{\text{enc}}),%&#10;\quad\tilde{\theta}(Z_{c})\approx\argmin_{\theta}\int\ell(z,\theta)g_{c}(dz)," mode="inline" tex="\displaystyle\tilde{\theta}(Z_{c})=f_{\text{enc}}(Z_{c};\phi_{\text{enc}}),%&#10;\quad\tilde{\theta}(Z_{c})\approx\operatorname*{arg\,min}_{\theta}\int\ell(z,%&#10;\theta)g_{c}(dz)," text="formulae@(tilde@(theta) * Z _ c = f _ [enc] * list@(Z _ c, phi _ [enc]), tilde@(theta) * Z _ c approximately-equals argmin _ theta * integral@(ell * open-interval@(z, theta) * g _ c * d * z))" xml:id="S3.E12.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="S3.E12.m1.3"/>
                          <XMWrap>
                            <XMDual xml:id="S3.E12.m1.3">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="S3.E12.m1.3.1"/>
                                <XMRef idref="S3.E12.m1.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E12.m1.3.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E12.m1.3.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E12.m1.3.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                      <XMText><text fontsize="70%">enc</text></XMText>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E12.m1.3.1.2"/>
                                        <XMRef idref="S3.E12.m1.3.1.3"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E12.m1.3.1.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">;</XMTok>
                                        <XMApp xml:id="S3.E12.m1.3.1.3">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                          <XMText><text fontsize="70%">enc</text></XMText>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                                <XMApp xml:id="S3.E12.m1.3.2">
                                  <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E12.m1.3.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E12.m1.3.2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                        <XMTok role="UNKNOWN">min</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="S3.E12.m1.1"/>
                                            <XMRef idref="S3.E12.m1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E12.m1.1">z</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E12.m1.2">θ</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="S3.E12.m1.3.2.2"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S3.E12.m1.3.2.2">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="g_{c}" text="g _ c" xml:id="S3.SS1.SSS0.Px1.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> is the empirical density of <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.SSS0.Px1.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math>. Hence, given <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px1.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.SSS0.Px1.p1.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math>, we can just input <Math mode="inline" tex="Z^{\prime}\cup Z_{c}" text="Z ^ prime union Z _ c" xml:id="S3.SS1.SSS0.Px1.p1.m9">
              <XMath>
                <XMApp>
                  <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> into <Math mode="inline" tex="f_{\text{enc}}" text="f _ [enc]" xml:id="S3.SS1.SSS0.Px1.p1.m10">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMText><text fontsize="70%">enc</text></XMText>
                </XMApp>
              </XMath>
            </Math> and use the output <Math mode="inline" tex="\tilde{\theta}(Z^{\prime}\cup Z_{c})" text="tilde@(theta) * (Z ^ prime union Z _ c)" xml:id="S3.SS1.SSS0.Px1.p1.m11">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m11.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m11.1">
                        <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> as a proxy for <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="S3.SS1.SSS0.Px1.p1.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m12.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m12.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>. Compared to exactly computing <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="S3.SS1.SSS0.Px1.p1.m13">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m13.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m13.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, obtaining <Math mode="inline" tex="\tilde{\theta}(Z^{\prime}\cup Z_{c})" text="tilde@(theta) * (Z ^ prime union Z _ c)" xml:id="S3.SS1.SSS0.Px1.p1.m14">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m14.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m14.1">
                        <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> requires a single forward pass through <Math mode="inline" tex="f_{\text{enc}}" text="f _ [enc]" xml:id="S3.SS1.SSS0.Px1.p1.m15">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMText><text fontsize="70%">enc</text></XMText>
                </XMApp>
              </XMath>
            </Math>, which scales much better with <Math mode="inline" tex="N" text="N" xml:id="S3.SS1.SSS0.Px1.p1.m16">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMath>
            </Math>. Moreover, computation for multiple <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px1.p1.m17">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> required for bagging can easily be parallelized.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="S3.SS1.SSS0.Px2">
        <title>Specifying the joint predictives</title>
        <para xml:id="S3.SS1.SSS0.Px2.p1">
          <p>We construct the joint predictives <Math mode="inline" tex="p(Z^{\prime}|Z_{c};\phi_{\text{pred}})" text="p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred]))" xml:id="S3.SS1.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px2.p1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m1.1">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.SS1.SSS0.Px2.p1.m1.1.1"/>
                            <XMRef idref="S3.SS1.SSS0.Px2.p1.m1.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m1.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m1.1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                              <XMText><text fontsize="70%">pred</text></XMText>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> with a neural network. Other than the requirement of <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px2.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> being exchangeable (and thus <ERROR class="undefined">\gls</ERROR>cid), we give no inductive bias to <Math mode="inline" tex="p(Z^{\prime}|Z_{c};\phi_{\text{pred}})" text="p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred]))" xml:id="S3.SS1.SSS0.Px2.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px2.p1.m3.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m3.1">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.SS1.SSS0.Px2.p1.m3.1.1"/>
                            <XMRef idref="S3.SS1.SSS0.Px2.p1.m3.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m3.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m3.1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                              <XMText><text fontsize="70%">pred</text></XMText>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> and let the model learn <Math mode="inline" tex="\phi_{\text{pred}}" text="phi _ [pred]" xml:id="S3.SS1.SSS0.Px2.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                  <XMText><text fontsize="70%">pred</text></XMText>
                </XMApp>
              </XMath>
            </Math> from the data. We thus use the exchangeable generative model described in <ref labelref="LABEL:main:subsec:exchangeable" show="creftype~refnum"/>. Specifically, to generate <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px2.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>, we first generate <Math mode="inline" tex="{\mathcal{E}}=\{\varepsilon_{i}\}_{i=1}^{n}" text="E = ((set@(varepsilon _ i)) _ (i = 1)) ^ n" xml:id="S3.SS1.SSS0.Px2.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="set"/>
                          <XMRef idref="S3.SS1.SSS0.Px2.p1.m6.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                          <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m6.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> from some distribution (usually chosen to be a unit Gaussian <Math mode="inline" tex="{\mathcal{N}}(0,I_{d})" text="N * open-interval@(0, I _ d)" xml:id="S3.SS1.SSS0.Px2.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.SS1.SSS0.Px2.p1.m7.1"/>
                      <XMRef idref="S3.SS1.SSS0.Px2.p1.m7.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.SSS0.Px2.p1.m7.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m7.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>), and pass them through an equivariant <ERROR class="undefined">\gls</ERROR>isab block to form <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px2.p1.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>. To model the conditioning on <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.SSS0.Px2.p1.m9">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math>, we set the inducing point in the <ERROR class="undefined">\gls</ERROR>isab as a transform of <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.SSS0.Px2.p1.m10">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math>. That is, with an arbitrary feed-forward neural network <Math mode="inline" tex="h" text="h" xml:id="S3.SS1.SSS0.Px2.p1.m11">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
              </XMath>
            </Math>,</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx13">
            <equation xml:id="S3.E13">
              <tags>
                <tag>(13)</tag>
                <tag role="autoref">Equation 13</tag>
                <tag role="refnum">13</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle\textsc{isab}({\mathcal{E}})=\textsc{mab}({\mathcal{E}},H),\quad H%&#10;=\textsc{mab}(h(Z_{c}),{\mathcal{E}})," text="formulae@([isab] * E = [mab] * open-interval@(E, H), H = [mab] * open-interval@(h * Z _ c, E))" xml:id="S3.E13.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="S3.E13.m2.5"/>
                      <XMWrap>
                        <XMDual xml:id="S3.E13.m2.5">
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="S3.E13.m2.5.1"/>
                            <XMRef idref="S3.E13.m2.5.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E13.m2.5.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText><text font="smallcaps">isab</text></XMText>
                                <XMDual>
                                  <XMRef idref="S3.E13.m2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E13.m2.1">E</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText><text font="smallcaps">mab</text></XMText>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E13.m2.2"/>
                                    <XMRef idref="S3.E13.m2.3"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E13.m2.2">E</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E13.m2.3">H</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                            <XMApp xml:id="S3.E13.m2.5.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" role="UNKNOWN">H</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText><text font="smallcaps">mab</text></XMText>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E13.m2.5.2.1"/>
                                    <XMRef idref="S3.E13.m2.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E13.m2.5.2.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E13.m2.5.2.1.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S3.E13.m2.5.2.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E13.m2.4">E</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\textsc{isab}({\mathcal{E}})=\textsc{mab}({\mathcal{E}},H),\quad H%&#10;=\textsc{mab}(h(Z_{c}),{\mathcal{E}})," text="formulae@([isab] * E = [mab] * open-interval@(E, H), H = [mab] * open-interval@(h * Z _ c, E))" xml:id="S3.E13.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="S3.E13.m1.5"/>
                          <XMWrap>
                            <XMDual xml:id="S3.E13.m1.5">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="S3.E13.m1.5.1"/>
                                <XMRef idref="S3.E13.m1.5.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E13.m1.5.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText><text font="smallcaps">isab</text></XMText>
                                    <XMDual>
                                      <XMRef idref="S3.E13.m1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E13.m1.1">E</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText><text font="smallcaps">mab</text></XMText>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E13.m1.2"/>
                                        <XMRef idref="S3.E13.m1.3"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E13.m1.2">E</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E13.m1.3">H</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                                <XMApp xml:id="S3.E13.m1.5.2">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText><text font="smallcaps">mab</text></XMText>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E13.m1.5.2.1"/>
                                        <XMRef idref="S3.E13.m1.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E13.m1.5.2.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                          <XMDual>
                                            <XMRef idref="S3.E13.m1.5.2.1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="S3.E13.m1.5.2.1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E13.m1.4">E</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="h(Z_{c})=\{h(z_{i})\}_{i\in c}" text="h * Z _ c = (set@(h * z _ i)) _ (i element-of c)" xml:id="S3.SS1.SSS0.Px2.p1.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS1.SSS0.Px2.p1.m12.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m12.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S3.SS1.SSS0.Px2.p1.m12.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m12.2">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMDual>
                            <XMRef idref="S3.SS1.SSS0.Px2.p1.m12.2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.SS1.SSS0.Px2.p1.m12.2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.
The resulting model is an implicit generative model <cite class="ltx_citemacro_citep">[<bibref bibrefs="mohamed2016learning" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> in a sense that we can draw samples from it but cannot evaluate likelihoods.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="S3.SS1.SSS0.Px3">
        <title>Generating Representations</title>
        <figure inlist="lof" labels="LABEL:figure/main_concept_mpnp" placement="t" xml:id="S3.F1">
          <tags>
            <tag><text fontsize="90%">Figure 1</text></tag>
            <tag role="autoref">Figure 1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">Figure 1</tag>
          </tags>
          <graphics candidates="figure/main_concept.pdf" class="ltx_centering" graphic="figure/main_concept.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S3.F1.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">1</tag>Concept figure of our feature generating model applied to <ERROR class="undefined">\gls</ERROR>cnp <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018conditional" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite>. We first convert given context dataset <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.F1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> to the representation <Math mode="inline" tex="R_{c}" text="R _ c" xml:id="S3.F1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> using <ERROR class="undefined">\gls</ERROR>mlp layers. Next we sample <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="S3.F1.m3">
              <XMath>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
              </XMath>
            </Math> from a simple distribution (e.g. Gaussian). Then we generate the pseudo context representation <Math mode="inline" tex="R_{c}^{\prime}" text="(R _ c) ^ prime" xml:id="S3.F1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> using generator as one layer <ERROR class="undefined">\gls</ERROR>isab <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> in our experiment.
</toccaption>
          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 1</text></tag><text fontsize="90%">Concept figure of our feature generating model applied to <ERROR class="undefined">\gls</ERROR>cnp <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018conditional" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>]</cite>. We first convert given context dataset <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.F1.m5">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                </XMath>
              </Math> to the representation <Math mode="inline" tex="R_{c}" text="R _ c" xml:id="S3.F1.m6">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                </XMath>
              </Math> using <ERROR class="undefined">\gls</ERROR>mlp layers. Next we sample <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="S3.F1.m7">
                <XMath>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                </XMath>
              </Math> from a simple distribution (e.g. Gaussian). Then we generate the pseudo context representation <Math mode="inline" tex="R_{c}^{\prime}" text="(R _ c) ^ prime" xml:id="S3.F1.m8">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                </XMath>
              </Math> using generator as one layer <ERROR class="undefined">\gls</ERROR>isab <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>]</cite> in our experiment.
</text></caption>
<!--  %**** methods.tex Line 50 **** -->        </figure>
        <para xml:id="S3.SS1.SSS0.Px3.p1">
          <p>When <Math mode="inline" tex="z" text="z" xml:id="S3.SS1.SSS0.Px3.p1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math> is low-dimensional, it would be moderately easy to learn the joint predictives, but in practice, we often encounter problems with high-dimensional <Math mode="inline" tex="z" text="z" xml:id="S3.SS1.SSS0.Px3.p1.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math>, for instance when the input <Math mode="inline" tex="x" text="x" xml:id="S3.SS1.SSS0.Px3.p1.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
              </XMath>
            </Math> is a high-resolution image. For such cases, directly generating <Math mode="inline" tex="z" text="z" xml:id="S3.SS1.SSS0.Px3.p1.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math> may be harder than the original problem, severely deteriorating the overall learning procedure of <ERROR class="undefined">\gls</ERROR>mpnp.
Instead, we propose to generate the <emph font="italic">encoded representations</emph> of <Math mode="inline" tex="z" text="z" xml:id="S3.SS1.SSS0.Px3.p1.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math>. The encoders of the most of the <ERROR class="undefined">\glspl</ERROR>npf first encode an input <Math mode="inline" tex="z_{i}" text="z _ i" xml:id="S3.SS1.SSS0.Px3.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> into a representation <Math mode="inline" tex="r_{i}" text="r _ i" xml:id="S3.SS1.SSS0.Px3.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>. For the remaining of the forward pass, we only need <Math mode="inline" tex="r_{i}" text="r _ i" xml:id="S3.SS1.SSS0.Px3.p1.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>s instead of the original input <Math mode="inline" tex="z" text="z" xml:id="S3.SS1.SSS0.Px3.p1.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math>. Hence we can build a joint predictives <Math mode="inline" tex="p(R^{\prime}|R_{c};\phi_{\text{pred}})" text="p * conditional@(R ^ prime, list@(R _ c, phi _ [pred]))" xml:id="S3.SS1.SSS0.Px3.p1.m10">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.SSS0.Px3.p1.m10.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.SSS0.Px3.p1.m10.1">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">R</XMTok>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.SS1.SSS0.Px3.p1.m10.1.1"/>
                            <XMRef idref="S3.SS1.SSS0.Px3.p1.m10.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.SS1.SSS0.Px3.p1.m10.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">;</XMTok>
                            <XMApp xml:id="S3.SS1.SSS0.Px3.p1.m10.1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                              <XMText><text fontsize="70%">pred</text></XMText>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> generating <Math mode="inline" tex="R^{\prime}=\{r_{i}^{\prime}\}_{i=1}^{N-|c|}" text="R ^ prime = ((set@((r _ i) ^ prime)) _ (i = 1)) ^ (N - absolute-value@(c))" xml:id="S3.SS1.SSS0.Px3.p1.m11">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="set"/>
                          <XMRef idref="S3.SS1.SSS0.Px3.p1.m11.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                          <XMApp xml:id="S3.SS1.SSS0.Px3.p1.m11.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="S3.SS1.SSS0.Px3.p1.m11.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS1.SSS0.Px3.p1.m11.1">c</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> conditioned on <Math mode="inline" tex="R_{c}=\{r_{i}\}_{i\in c}" text="R _ c = (set@(r _ i)) _ (i element-of c)" xml:id="S3.SS1.SSS0.Px3.p1.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S3.SS1.SSS0.Px3.p1.m12.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S3.SS1.SSS0.Px3.p1.m12.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> as for generating <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px3.p1.m13">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> from <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="S3.SS1.SSS0.Px3.p1.m14">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math>. In the experiments, we compare these two versions of <ERROR class="undefined">\glspl</ERROR>mpnp (generating <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="S3.SS1.SSS0.Px3.p1.m15">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> and generating <Math mode="inline" tex="R^{\prime}" text="R ^ prime" xml:id="S3.SS1.SSS0.Px3.p1.m16">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>), and found that the one generating <Math mode="inline" tex="R^{\prime}" text="R ^ prime" xml:id="S3.SS1.SSS0.Px3.p1.m17">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> works much better both in terms of data efficiency in training and predictive performances, even when the dimension of <Math mode="inline" tex="z" text="z" xml:id="S3.SS1.SSS0.Px3.p1.m18">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
              </XMath>
            </Math> is not particularly large.
See <ref labelref="LABEL:figure/main_concept_mpnp" show="creftype~refnum"/> for our method applying to <ERROR class="undefined">\gls</ERROR>cnp model <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018conditional" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite>.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:main:subsec:training" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Training</title>
      <para xml:id="S3.SS2.p1">
        <p>With the generator <Math mode="inline" tex="p(Z^{\prime}|Z_{c};\phi_{\text{pred}})" text="p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred]))" xml:id="S3.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p1.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p1.m1.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S3.SS2.p1.m1.1.1"/>
                          <XMRef idref="S3.SS2.p1.m1.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S3.SS2.p1.m1.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">;</XMTok>
                          <XMApp xml:id="S3.SS2.p1.m1.1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                            <XMText><text fontsize="70%">pred</text></XMText>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, the marginal likelihood for a task <Math mode="inline" tex="\tau=(Z,c)" text="tau = open-interval@(Z, c)" xml:id="S3.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS2.p1.m2.1"/>
                    <XMRef idref="S3.SS2.p1.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m2.1">Z</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m2.2">c</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is computed as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx14">
          <equation labels="LABEL:eq:logmarginal_mp" xml:id="S3.E14">
            <tags>
              <tag>(14)</tag>
              <tag role="autoref">Equation 14</tag>
              <tag role="refnum">14</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\log p(Y|X,Z_{c})=\log\int\exp\bigg{(}-\sum_{i\in[n]}\ell(z_{i},%&#10;\tilde{\theta}(Z_{c}\cup Z^{\prime}))\bigg{)}p(Z^{\prime}|Z_{c};\phi_{\text{%&#10;pred}})\mathrm{d}Z^{\prime}." text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) = logarithm * integral@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * (Z _ c union Z ^ prime)))) * p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred])) * differential-d@(Z ^ prime))" xml:id="S3.E14.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E14.m2.4"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E14.m2.4">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E14.m2.4.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E14.m2.4.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S3.E14.m2.2"/>
                                    <XMRef idref="S3.E14.m2.4.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E14.m2.2">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S3.E14.m2.4.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="S3.E14.m2.3"/>
                                  <XMRef idref="S3.E14.m2.4.2"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E14.m2.3">exp</XMTok>
                                  <XMWrap>
                                    <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E14.m2.4.2">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="delimited-[]"/>
                                                <XMRef idref="S3.E14.m2.1"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E14.m2.1">n</XMTok>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="S3.E14.m2.4.2.1"/>
                                              <XMRef idref="S3.E14.m2.4.2.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="S3.E14.m2.4.2.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="S3.E14.m2.4.2.2">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="S3.E14.m2.4.2.2.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="S3.E14.m2.4.2.2.1">
                                                      <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                      </XMApp>
                                                      <XMApp>
                                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E14.m2.4.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E14.m2.4.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E14.m2.4.3.1"/>
                                        <XMRef idref="S3.E14.m2.4.3.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="S3.E14.m2.4.3.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">;</XMTok>
                                        <XMApp xml:id="S3.E14.m2.4.3.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                          <XMText><text fontsize="70%">pred</text></XMText>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\log p(Y|X,Z_{c})=\log\int\exp\bigg{(}-\sum_{i\in[n]}\ell(z_{i},%&#10;\tilde{\theta}(Z_{c}\cup Z^{\prime}))\bigg{)}p(Z^{\prime}|Z_{c};\phi_{\text{%&#10;pred}})\mathrm{d}Z^{\prime}." text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) = logarithm * integral@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * (Z _ c union Z ^ prime)))) * p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred])) * differential-d@(Z ^ prime))" xml:id="S3.E14.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E14.m1.4"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E14.m1.4">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E14.m1.4.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E14.m1.4.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E14.m1.2"/>
                                        <XMRef idref="S3.E14.m1.4.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E14.m1.2">X</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E14.m1.4.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="S3.E14.m1.3"/>
                                      <XMRef idref="S3.E14.m1.4.2"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E14.m1.3">exp</XMTok>
                                      <XMWrap>
                                        <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E14.m1.4.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="delimited-[]"/>
                                                    <XMRef idref="S3.E14.m1.1"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E14.m1.1">n</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="S3.E14.m1.4.2.1"/>
                                                  <XMRef idref="S3.E14.m1.4.2.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="S3.E14.m1.4.2.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="S3.E14.m1.4.2.2">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMApp>
                                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="S3.E14.m1.4.2.2.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="S3.E14.m1.4.2.2.1">
                                                          <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                                          <XMApp>
                                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                          </XMApp>
                                                          <XMApp>
                                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                                          </XMApp>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMDual>
                                    <XMRef idref="S3.E14.m1.4.3"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E14.m1.4.3">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="S3.E14.m1.4.3.1"/>
                                            <XMRef idref="S3.E14.m1.4.3.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="S3.E14.m1.4.3.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">;</XMTok>
                                            <XMApp xml:id="S3.E14.m1.4.3.2">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                              <XMText><text fontsize="70%">pred</text></XMText>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Note that <Math mode="inline" tex="p(Z^{\prime}|Z_{c};\phi_{\text{pred}})" text="p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred]))" xml:id="S3.SS2.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p1.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p1.m3.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S3.SS2.p1.m3.1.1"/>
                          <XMRef idref="S3.SS2.p1.m3.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMApp xml:id="S3.SS2.p1.m3.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">;</XMTok>
                          <XMApp xml:id="S3.SS2.p1.m3.1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                            <XMText><text fontsize="70%">pred</text></XMText>
                          </XMApp>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is <ERROR class="undefined">\gls</ERROR>cid, so there exists a corresponding martingale posterior <Math mode="inline" tex="\pi_{N}" text="pi _ N" xml:id="S3.SS2.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math> such that</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx15">
          <equation xml:id="S3.E15">
            <tags>
              <tag>(15)</tag>
              <tag role="autoref">Equation 15</tag>
              <tag role="refnum">15</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\log p(Y|X,Z_{c})=\log\int\exp\bigg{(}-\sum_{i\in[n]}\ell(z_{i},%&#10;\theta)\bigg{)}\pi_{N}(\theta|Z_{c})\mathrm{d}\theta." text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) = logarithm * integral@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, theta))) * pi _ N * conditional@(theta, Z _ c) * differential-d@(theta))" xml:id="S3.E15.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E15.m2.5"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E15.m2.5">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E15.m2.5.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E15.m2.5.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S3.E15.m2.2"/>
                                    <XMRef idref="S3.E15.m2.5.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E15.m2.2">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S3.E15.m2.5.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="S3.E15.m2.4"/>
                                  <XMRef idref="S3.E15.m2.5.2"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E15.m2.4">exp</XMTok>
                                  <XMWrap>
                                    <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E15.m2.5.2">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="delimited-[]"/>
                                                <XMRef idref="S3.E15.m2.1"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E15.m2.1">n</XMTok>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="S3.E15.m2.5.2.1"/>
                                              <XMRef idref="S3.E15.m2.3"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="S3.E15.m2.5.2.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E15.m2.3">θ</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E15.m2.5.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E15.m2.5.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\log p(Y|X,Z_{c})=\log\int\exp\bigg{(}-\sum_{i\in[n]}\ell(z_{i},%&#10;\theta)\bigg{)}\pi_{N}(\theta|Z_{c})\mathrm{d}\theta." text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) = logarithm * integral@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, theta))) * pi _ N * conditional@(theta, Z _ c) * differential-d@(theta))" xml:id="S3.E15.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E15.m1.5"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E15.m1.5">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E15.m1.5.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E15.m1.5.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E15.m1.2"/>
                                        <XMRef idref="S3.E15.m1.5.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E15.m1.2">X</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E15.m1.5.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="S3.E15.m1.4"/>
                                      <XMRef idref="S3.E15.m1.5.2"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E15.m1.4">exp</XMTok>
                                      <XMWrap>
                                        <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E15.m1.5.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="delimited-[]"/>
                                                    <XMRef idref="S3.E15.m1.1"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E15.m1.1">n</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="S3.E15.m1.5.2.1"/>
                                                  <XMRef idref="S3.E15.m1.3"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="S3.E15.m1.5.2.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E15.m1.3">θ</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S3.E15.m1.5.3"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E15.m1.5.3">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok meaning="differential-d" role="DIFFOP">d</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>We approximate the marginal likelihood via a consistent estimator,</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx16">
          <equation labels="LABEL:eq:mpnp_term1" xml:id="S3.E16">
            <tags>
              <tag>(16)</tag>
              <tag role="autoref">Equation 16</tag>
              <tag role="refnum">16</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\log p(Y|X,Z_{c})\approx\log\Bigg{[}\frac{1}{K}\sum_{k=1}^{K}\exp%&#10;\bigg{(}-\sum_{i\in[n]}\ell(z_{i},\tilde{\theta}(Z_{c}\cup Z^{\prime(k)}))%&#10;\bigg{)}\Bigg{]}:=-{\mathcal{L}}_{\text{marg}}(\tau,\phi)," text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) approximately-equals logarithm@((1 / K) * ((sum _ (k = 1)) ^ K)@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * (Z _ c union Z ^ (list@(prime1, k)))))))) assign - L _ [marg] * open-interval@(tau, phi)" xml:id="S3.E16.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E16.m2.10"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E16.m2.10">
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E16.m2.10.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E16.m2.10.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S3.E16.m2.5"/>
                                    <XMRef idref="S3.E16.m2.10.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E16.m2.5">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S3.E16.m2.10.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S3.E16.m2.7"/>
                            <XMRef idref="S3.E16.m2.10.2"/>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E16.m2.7">log</XMTok>
                            <XMWrap>
                              <XMTok fontsize="260%" role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="S3.E16.m2.10.2">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="S3.E16.m2.6"/>
                                      <XMRef idref="S3.E16.m2.10.2.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E16.m2.6">exp</XMTok>
                                      <XMWrap>
                                        <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E16.m2.10.2.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="delimited-[]"/>
                                                    <XMRef idref="S3.E16.m2.1"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E16.m2.1">n</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="S3.E16.m2.10.2.1.1"/>
                                                  <XMRef idref="S3.E16.m2.10.2.1.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="S3.E16.m2.10.2.1.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="S3.E16.m2.10.2.1.2">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMApp>
                                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="S3.E16.m2.10.2.1.2.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="S3.E16.m2.10.2.1.2.1">
                                                          <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                                          <XMApp>
                                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                          </XMApp>
                                                          <XMApp>
                                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                            <XMDual>
                                                              <XMApp>
                                                                <XMTok meaning="list"/>
                                                                <XMRef idref="S3.E16.m2.3"/>
                                                                <XMRef idref="S3.E16.m2.4"/>
                                                              </XMApp>
                                                              <XMWrap>
                                                                <XMTok name="prime1" role="SUPOP" xml:id="S3.E16.m2.3">′</XMTok>
                                                                <XMTok role="PUNCT">⁣</XMTok>
                                                                <XMDual xml:id="S3.E16.m2.4">
                                                                  <XMRef idref="S3.E16.m2.2"/>
                                                                  <XMWrap>
                                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E16.m2.2">k</XMTok>
                                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                                  </XMWrap>
                                                                </XMDual>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="260%" role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                        <XMTok meaning="assign" role="RELOP">:=</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                              <XMText><text fontsize="70%">marg</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S3.E16.m2.8"/>
                                <XMRef idref="S3.E16.m2.9"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E16.m2.8">τ</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E16.m2.9">ϕ</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\log p(Y|X,Z_{c})\approx\log\Bigg{[}\frac{1}{K}\sum_{k=1}^{K}\exp%&#10;\bigg{(}-\sum_{i\in[n]}\ell(z_{i},\tilde{\theta}(Z_{c}\cup Z^{\prime(k)}))%&#10;\bigg{)}\Bigg{]}:=-{\mathcal{L}}_{\text{marg}}(\tau,\phi)," text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) approximately-equals logarithm@((1 / K) * ((sum _ (k = 1)) ^ K)@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * (Z _ c union Z ^ (list@(prime1, k)))))))) assign - L _ [marg] * open-interval@(tau, phi)" xml:id="S3.E16.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E16.m1.10"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E16.m1.10">
                            <XMTok meaning="multirelation"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E16.m1.10.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E16.m1.10.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E16.m1.5"/>
                                        <XMRef idref="S3.E16.m1.10.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E16.m1.5">X</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E16.m1.10.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S3.E16.m1.7"/>
                                <XMRef idref="S3.E16.m1.10.2"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E16.m1.7">log</XMTok>
                                <XMWrap>
                                  <XMTok fontsize="260%" role="OPEN" stretchy="false">[</XMTok>
                                  <XMApp xml:id="S3.E16.m1.10.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMRef idref="S3.E16.m1.6"/>
                                          <XMRef idref="S3.E16.m1.10.2.1"/>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S3.E16.m1.6">exp</XMTok>
                                          <XMWrap>
                                            <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S3.E16.m1.10.2.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="delimited-[]"/>
                                                        <XMRef idref="S3.E16.m1.1"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E16.m1.1">n</XMTok>
                                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="open-interval"/>
                                                      <XMRef idref="S3.E16.m1.10.2.1.1"/>
                                                      <XMRef idref="S3.E16.m1.10.2.1.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="S3.E16.m1.10.2.1.1">
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="S3.E16.m1.10.2.1.2">
                                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMApp>
                                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                        </XMApp>
                                                        <XMDual>
                                                          <XMRef idref="S3.E16.m1.10.2.1.2.1"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMApp xml:id="S3.E16.m1.10.2.1.2.1">
                                                              <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                                              <XMApp>
                                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                              </XMApp>
                                                              <XMApp>
                                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                                <XMDual>
                                                                  <XMApp>
                                                                    <XMTok meaning="list"/>
                                                                    <XMRef idref="S3.E16.m1.3"/>
                                                                    <XMRef idref="S3.E16.m1.4"/>
                                                                  </XMApp>
                                                                  <XMWrap>
                                                                    <XMTok name="prime1" role="SUPOP" xml:id="S3.E16.m1.3">′</XMTok>
                                                                    <XMTok role="PUNCT">⁣</XMTok>
                                                                    <XMDual xml:id="S3.E16.m1.4">
                                                                      <XMRef idref="S3.E16.m1.2"/>
                                                                      <XMWrap>
                                                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E16.m1.2">k</XMTok>
                                                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                                      </XMWrap>
                                                                    </XMDual>
                                                                  </XMWrap>
                                                                </XMDual>
                                                              </XMApp>
                                                            </XMApp>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMApp>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok fontsize="260%" role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                            <XMTok meaning="assign" role="RELOP">:=</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                  <XMText><text fontsize="70%">marg</text></XMText>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E16.m1.8"/>
                                    <XMRef idref="S3.E16.m1.9"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E16.m1.8">τ</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E16.m1.9">ϕ</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math class="ltx_math_unparsed" mode="inline" tex="Z^{\prime(1)},\dots,Z^{\prime(K)}\overset{\mathrm{i.i.d.}}{\sim}p(Z^{\prime}|Z%&#10;_{c};\phi_{\text{pred}})" text="list@(Z ^ (list@(prime1, 1)), dots, Z ^ (list@(prime1, K)) * i@.@i@.@d@.@(similar-to) * p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred])))" xml:id="S3.SS2.p1.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS2.p1.m5.11"/>
                  <XMRef idref="S3.SS2.p1.m5.10"/>
                  <XMRef idref="S3.SS2.p1.m5.12"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS2.p1.m5.11">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.SS2.p1.m5.2"/>
                        <XMRef idref="S3.SS2.p1.m5.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="prime1" role="SUPOP" xml:id="S3.SS2.p1.m5.2">′</XMTok>
                        <XMTok role="PUNCT">⁣</XMTok>
                        <XMDual xml:id="S3.SS2.p1.m5.3">
                          <XMRef idref="S3.SS2.p1.m5.1"/>
                          <XMWrap>
                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="S3.SS2.p1.m5.1">1</XMTok>
                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="dots" role="ID" xml:id="S3.SS2.p1.m5.10">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p1.m5.12">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S3.SS2.p1.m5.5"/>
                          <XMRef idref="S3.SS2.p1.m5.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="prime1" role="SUPOP" xml:id="S3.SS2.p1.m5.5">′</XMTok>
                          <XMTok role="PUNCT">⁣</XMTok>
                          <XMDual xml:id="S3.SS2.p1.m5.6">
                            <XMRef idref="S3.SS2.p1.m5.4"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p1.m5.4">K</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMWrap role="OVERACCENT">
                        <XMTok role="UNKNOWN" xml:id="S3.SS2.p1.m5.7">i</XMTok>
                        <XMTok role="PERIOD">.</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.SS2.p1.m5.8">i</XMTok>
                        <XMTok role="PERIOD">.</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.SS2.p1.m5.9">d</XMTok>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                      <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p1.m5.12.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p1.m5.12.1">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="S3.SS2.p1.m5.12.1.1"/>
                              <XMRef idref="S3.SS2.p1.m5.12.1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S3.SS2.p1.m5.12.1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">;</XMTok>
                              <XMApp xml:id="S3.SS2.p1.m5.12.1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                <XMText><text fontsize="70%">pred</text></XMText>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. This objective would be suffice if we are given sufficiently good <Math mode="inline" tex="\tilde{\theta}(Z_{c}\cup Z^{\prime(k)})" text="tilde@(theta) * (Z _ c union Z ^ (list@(prime1, k)))" xml:id="S3.SS2.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS2.p1.m6.4"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p1.m6.4">
                      <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.SS2.p1.m6.2"/>
                            <XMRef idref="S3.SS2.p1.m6.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="prime1" role="SUPOP" xml:id="S3.SS2.p1.m6.2">′</XMTok>
                            <XMTok role="PUNCT">⁣</XMTok>
                            <XMDual xml:id="S3.SS2.p1.m6.3">
                              <XMRef idref="S3.SS2.p1.m6.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p1.m6.1">k</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, but we have to also train the encoder to properly amortize the parameter construction process <ref labelref="LABEL:eq:recovering_theta" show="creftype~refnum"/>. For this, we use only the given context data to optimize</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx17">
          <equation labels="LABEL:eq:mpnp_term2" xml:id="S3.E17">
            <tags>
              <tag>(17)</tag>
              <tag role="autoref">Equation 17</tag>
              <tag role="refnum">17</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\log p_{\textsc{cnp}}(Y|X,Z_{c})=-\sum_{i\in[n]}\ell(z_{i},\tilde%&#10;{\theta}(Z_{c})):=-{\mathcal{L}}_{\text{amort}}(\tau,\phi)" text="logarithm@(p _ [cnp]) * conditional@(Y, list@(X, Z _ c)) = - (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * Z _ c)) assign - L _ [amort] * open-interval@(tau, phi)" xml:id="S3.E17.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          <XMText><text font="smallcaps" fontsize="70%">cnp</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S3.E17.m2.5"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E17.m2.5">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E17.m2.2"/>
                                <XMRef idref="S3.E17.m2.5.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E17.m2.2">X</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S3.E17.m2.5.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S3.E17.m2.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E17.m2.1">n</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S3.E17.m2.6"/>
                              <XMRef idref="S3.E17.m2.7"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E17.m2.6">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.E17.m2.7">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.E17.m2.7.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E17.m2.7.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                          <XMText><text fontsize="70%">amort</text></XMText>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S3.E17.m2.3"/>
                            <XMRef idref="S3.E17.m2.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E17.m2.3">τ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E17.m2.4">ϕ</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\log p_{\textsc{cnp}}(Y|X,Z_{c})=-\sum_{i\in[n]}\ell(z_{i},\tilde%&#10;{\theta}(Z_{c})):=-{\mathcal{L}}_{\text{amort}}(\tau,\phi)" text="logarithm@(p _ [cnp]) * conditional@(Y, list@(X, Z _ c)) = - (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * Z _ c)) assign - L _ [amort] * open-interval@(tau, phi)" xml:id="S3.E17.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMText><text font="smallcaps" fontsize="70%">cnp</text></XMText>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E17.m1.5"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E17.m1.5">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S3.E17.m1.2"/>
                                    <XMRef idref="S3.E17.m1.5.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E17.m1.2">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S3.E17.m1.5.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="S3.E17.m1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E17.m1.1">n</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S3.E17.m1.6"/>
                                  <XMRef idref="S3.E17.m1.7"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E17.m1.6">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S3.E17.m1.7">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E17.m1.7.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E17.m1.7.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="assign" role="RELOP">:=</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                              <XMText><text fontsize="70%">amort</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S3.E17.m1.3"/>
                                <XMRef idref="S3.E17.m1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E17.m1.3">τ</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E17.m1.4">ϕ</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p><!--  %**** methods.tex Line 75 **** -->that is, we train the parameters <Math mode="inline" tex="(\phi_{\text{enc}},\phi_{\text{dec}})" text="open-interval@(phi _ [enc], phi _ [dec])" xml:id="S3.SS2.p1.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.SS2.p1.m7.1"/>
                  <XMRef idref="S3.SS2.p1.m7.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S3.SS2.p1.m7.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                    <XMText><text fontsize="70%">enc</text></XMText>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p1.m7.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                    <XMText><text fontsize="70%">dec</text></XMText>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> using <ERROR class="undefined">\gls</ERROR>cnp objective. Furthermore, we found that if we just maximize <ref labelref="LABEL:eq:mpnp_term1" show="creftype~refnum"/> and <ref labelref="LABEL:eq:mpnp_term2" show="creftype~refnum"/>, the model can cheat by ignoring the generated pseudo contexts and use only the original context to build function estimates. To prevent this, we further maximize the similar <ERROR class="undefined">\gls</ERROR>cnp objectives for each generated pseudo context to encourage the model to actually make use of the generated contexts.</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx18">
          <equation labels="LABEL:eq:mpnp_term3" xml:id="S3.E18">
            <tags>
              <tag>(18)</tag>
              <tag role="autoref">Equation 18</tag>
              <tag role="refnum">18</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\frac{1}{K}\sum_{k=1}^{K}\log p_{\textsc{cnp}}(Y|X,Z^{\prime(k)})%&#10;=-\frac{1}{K}\sum_{i\in[n]}\ell(z_{i},\tilde{\theta}(Z^{\prime(k)})):=-{%&#10;\mathcal{L}}_{\text{pseudo}}(\tau,\phi)" text="(1 / K) * ((sum _ (k = 1)) ^ K)@(logarithm@(p _ [cnp]) * conditional@(Y, list@(X, Z ^ (list@(prime1, k))))) = - (1 / K) * (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * Z ^ (list@(prime1, k)))) assign - L _ [pseudo] * open-interval@(tau, phi)" xml:id="S3.E18.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok font="italic" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMText><text font="smallcaps" fontsize="70%">cnp</text></XMText>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E18.m2.11"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E18.m2.11">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="S3.E18.m2.8"/>
                                    <XMRef idref="S3.E18.m2.11.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E18.m2.8">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S3.E18.m2.11.1">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="S3.E18.m2.2"/>
                                          <XMRef idref="S3.E18.m2.3"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok name="prime1" role="SUPOP" xml:id="S3.E18.m2.2">′</XMTok>
                                          <XMTok role="PUNCT">⁣</XMTok>
                                          <XMDual xml:id="S3.E18.m2.3">
                                            <XMRef idref="S3.E18.m2.1"/>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E18.m2.1">k</XMTok>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-[]"/>
                                  <XMRef idref="S3.E18.m2.4"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E18.m2.4">n</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S3.E18.m2.12"/>
                                <XMRef idref="S3.E18.m2.13"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E18.m2.12">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S3.E18.m2.13">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S3.E18.m2.13.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E18.m2.13.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="S3.E18.m2.6"/>
                                            <XMRef idref="S3.E18.m2.7"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="prime1" role="SUPOP" xml:id="S3.E18.m2.6">′</XMTok>
                                            <XMTok role="PUNCT">⁣</XMTok>
                                            <XMDual xml:id="S3.E18.m2.7">
                                              <XMRef idref="S3.E18.m2.5"/>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E18.m2.5">k</XMTok>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                          <XMText><text fontsize="70%">pseudo</text></XMText>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S3.E18.m2.9"/>
                            <XMRef idref="S3.E18.m2.10"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E18.m2.9">τ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E18.m2.10">ϕ</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\frac{1}{K}\sum_{k=1}^{K}\log p_{\textsc{cnp}}(Y|X,Z^{\prime(k)})%&#10;=-\frac{1}{K}\sum_{i\in[n]}\ell(z_{i},\tilde{\theta}(Z^{\prime(k)})):=-{%&#10;\mathcal{L}}_{\text{pseudo}}(\tau,\phi)" text="(1 / K) * ((sum _ (k = 1)) ^ K)@(logarithm@(p _ [cnp]) * conditional@(Y, list@(X, Z ^ (list@(prime1, k))))) = - (1 / K) * (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * Z ^ (list@(prime1, k)))) assign - L _ [pseudo] * open-interval@(tau, phi)" xml:id="S3.E18.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" role="UNKNOWN">K</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMText><text font="smallcaps" fontsize="70%">cnp</text></XMText>
                                </XMApp>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E18.m1.11"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E18.m1.11">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E18.m1.8"/>
                                        <XMRef idref="S3.E18.m1.11.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E18.m1.8">X</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E18.m1.11.1">
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="list"/>
                                              <XMRef idref="S3.E18.m1.2"/>
                                              <XMRef idref="S3.E18.m1.3"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok name="prime1" role="SUPOP" xml:id="S3.E18.m1.2">′</XMTok>
                                              <XMTok role="PUNCT">⁣</XMTok>
                                              <XMDual xml:id="S3.E18.m1.3">
                                                <XMRef idref="S3.E18.m1.1"/>
                                                <XMWrap>
                                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E18.m1.1">k</XMTok>
                                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="delimited-[]"/>
                                      <XMRef idref="S3.E18.m1.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E18.m1.4">n</XMTok>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E18.m1.12"/>
                                    <XMRef idref="S3.E18.m1.13"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E18.m1.12">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S3.E18.m1.13">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="S3.E18.m1.13.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S3.E18.m1.13.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="list"/>
                                                <XMRef idref="S3.E18.m1.6"/>
                                                <XMRef idref="S3.E18.m1.7"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok name="prime1" role="SUPOP" xml:id="S3.E18.m1.6">′</XMTok>
                                                <XMTok role="PUNCT">⁣</XMTok>
                                                <XMDual xml:id="S3.E18.m1.7">
                                                  <XMRef idref="S3.E18.m1.5"/>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E18.m1.5">k</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="assign" role="RELOP">:=</XMTok>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                              <XMText><text fontsize="70%">pseudo</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S3.E18.m1.9"/>
                                <XMRef idref="S3.E18.m1.10"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E18.m1.9">τ</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E18.m1.10">ϕ</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Combining these, the loss function for the <ERROR class="undefined">\gls</ERROR>mpnp is then</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx19">
          <equation labels="LABEL:eq:mpnp_term_whole" xml:id="S3.E19">
            <tags>
              <tag>(19)</tag>
              <tag role="autoref">Equation 19</tag>
              <tag role="refnum">19</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\mathbb{E}_{\tau}[{\mathcal{L}}(\tau,\phi)]=\mathbb{E}_{\tau}[{%&#10;\mathcal{L}}_{\text{marg}}(\tau,\phi)+{\mathcal{L}}_{\text{amort}}(\tau,\phi)+%&#10;{\mathcal{L}}_{\text{pseudo}}(\tau,\phi)]." text="E _ tau * delimited-[]@(L * open-interval@(tau, phi)) = E _ tau * delimited-[]@(L _ [marg] * open-interval@(tau, phi) + L _ [amort] * open-interval@(tau, phi) + L _ [pseudo] * open-interval@(tau, phi))" xml:id="S3.E19.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E19.m2.9"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E19.m2.9">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                            <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S3.E19.m2.9.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="S3.E19.m2.9.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E19.m2.1"/>
                                    <XMRef idref="S3.E19.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m2.1">τ</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m2.2">ϕ</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                            <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S3.E19.m2.9.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="S3.E19.m2.9.2">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                    <XMText><text fontsize="70%">marg</text></XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E19.m2.3"/>
                                      <XMRef idref="S3.E19.m2.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m2.3">τ</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m2.4">ϕ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                    <XMText><text fontsize="70%">amort</text></XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E19.m2.5"/>
                                      <XMRef idref="S3.E19.m2.6"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m2.5">τ</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m2.6">ϕ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                    <XMText><text fontsize="70%">pseudo</text></XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E19.m2.7"/>
                                      <XMRef idref="S3.E19.m2.8"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m2.7">τ</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m2.8">ϕ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\mathbb{E}_{\tau}[{\mathcal{L}}(\tau,\phi)]=\mathbb{E}_{\tau}[{%&#10;\mathcal{L}}_{\text{marg}}(\tau,\phi)+{\mathcal{L}}_{\text{amort}}(\tau,\phi)+%&#10;{\mathcal{L}}_{\text{pseudo}}(\tau,\phi)]." text="E _ tau * delimited-[]@(L * open-interval@(tau, phi)) = E _ tau * delimited-[]@(L _ [marg] * open-interval@(tau, phi) + L _ [amort] * open-interval@(tau, phi) + L _ [pseudo] * open-interval@(tau, phi))" xml:id="S3.E19.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E19.m1.9"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E19.m1.9">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-[]"/>
                                  <XMRef idref="S3.E19.m1.9.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                                  <XMApp xml:id="S3.E19.m1.9.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E19.m1.1"/>
                                        <XMRef idref="S3.E19.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m1.1">τ</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m1.2">ϕ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-[]"/>
                                  <XMRef idref="S3.E19.m1.9.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                                  <XMApp xml:id="S3.E19.m1.9.2">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                        <XMText><text fontsize="70%">marg</text></XMText>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="S3.E19.m1.3"/>
                                          <XMRef idref="S3.E19.m1.4"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m1.3">τ</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m1.4">ϕ</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                        <XMText><text fontsize="70%">amort</text></XMText>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="S3.E19.m1.5"/>
                                          <XMRef idref="S3.E19.m1.6"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m1.5">τ</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m1.6">ϕ</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                        <XMText><text fontsize="70%">pseudo</text></XMText>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="S3.E19.m1.7"/>
                                          <XMRef idref="S3.E19.m1.8"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="S3.E19.m1.7">τ</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E19.m1.8">ϕ</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
<!--  %“lhg–I submitted our paper to Openreview. You can check that.˝ 
     %“ed–Thank you!!˝ 
     %“glspl–mpnp˝ model contains generator function $f˙–“gen˝$ which generates a pseudo context dataset $Z’$ or a feature of pseudo context dataset $R’$. 
     %To make a generator of “gls–mpnp˝ to sample meaningful $Z’$ or $R’$, we need to carefully construct training objective function. Otherwise, the generator tends to sample pseudo context dataset far from context dataset or collapse to one-point which does not have enough meaning or affection to target dataset. We maximize our training objective function which consists of the following terms: 
     %“begin–align˝ 
     %“sum˙–i=1˝^n“left(“log p(y˙i—x˙i,Z˙c,“varnothing)+“log “frac–1˝–K˝“sum˙–k=1˝^K p(y˙i—x˙i,Z˙c,Z’^–(k)˝)+“frac–1˝–K˝“sum˙–k=1˝^K “log p(y˙i—x˙i, “varnothing, Z’^–(k)˝)“right) 
     %“end–align˝ 
     %% “ed–Thanks for updating, much clearer now. Should the third term be $p(y˙i “mid x˙i, “varnothing, Z’^–(k)˝)$ then?˝ 
     %% “lhg–Yes, that’s right. We don’t use context data in the third term.˝“ed–I added it, hope it’s ok!˝ 
     %where $K$ is the number of different generated pseudo context dataset. 
     %Here the first term $“log p(y—x,Z˙c, “varnothing)$ implies that our amortized model should also well predict the posterior distribution of $Z$ only with context dataset. 
     %The second term implies that the ensemble of our model should well predict the posterior distribution of $Z$ with context dataset and pseudo context dataset. 
     %The third term implies that our model should generate pseudo context dataset which well explains $Z$. 
     %This third term makes our model to actually generate more meaningful pseudo context dataset. 
     %**** methods.tex Line 100 **** 
     %See “cref–app:sec:ablation˙study˝ for generated pseudo context samples without third loss term. 
     %“ed–For the third term in (14), would it perhaps make more sense to put the sum inside the log, that is 
     %$$“log “frac–1˝–K˝ “sum˙–k=1˝^K p(y˙i “mid x˙i, “varnothing, Z’^–(k)˝)$$ 
     %so it is still kind of a posterior predictive density? Will this affect the results much?˝““ 
     %“lhg–We empirical check that $“log “frac–1˝–K˝ “sum˙–k=1˝^K p(y˙i “mid x˙i, “varnothing, Z’^–(k)˝)$ decrease the performances, and defeat by some baselines. And when I tried $“frac–1˝–K˝ “sum˙–k=1˝^K “log p(y˙i “mid x˙i, “varnothing, Z’^–(k)˝)$, somewhat I think was each generated pseudo context set $Z’^–(k)˝$ sampled independently and each sample should be sampled meaningfully. I mean if we use $“log “frac–1˝–K˝ “sum˙–k=1˝^K p(y˙i “mid x˙i, “varnothing, Z’^–(k)˝)$, then the generator does not sample each pseudo context dataset meaningfully.˝ 
     %“lhg– 
     %“begin–align˝ 
     %“log “Big(“frac–1˝–K˝“sum˙–k=1˝^K “exp–“big(“sum˙–i=1˝^n “log p(y˙i—x˙i,Z˙c,Z’^–(k)˝)“big)˝“Big) +“sum˙–i=1˝^n“left(“frac–1˝–K˝“sum˙–k=1˝^K “log p(y˙i—x˙i, “varnothing, Z’^–(k)˝) + “log p(y˙i—x˙i,Z˙c,“varnothing)“right) 
     %“end–align˝ 
     %˝ 
     %where $K$ is the number of different generated pseudo context dataset. Here, the first term is our posterior predictive density on $Z$, integrating over the posterior distribution of $“theta$ induced by the generator $p(Z˙c’ “mid Z˙c)$. 
     %The second term  ensures our generator generates meaningful pseudo context dataset which allow the decoder to predict well.  As we are unable to evaluate the marginal likelihood $Z˙c$ due to the implicit generative model, we rely on the decoder likelihood to improve the quality of $Z˙c’$ samples. “lhg–For this term, we use $“frac–1˝–K˝“sum˙–k=1˝^K “log p(y˙i—x˙i, “varnothing, Z’^–(k)˝)$ instead of $“log“frac–1˝–K˝“sum˙–k=1˝^K  p(y˙i—x˙i, “varnothing, Z’^–(k)˝)$ to ensure that our generator samples each $Z’^–(k)˝$s independently which well explains $Z$.˝ See “cref–app:sec:ablation˙study˝ for generated pseudo context samples without this second loss term. The final term $“log p(y—x,Z˙c, “varnothing)$ ensures that our amortized model also predicts well with only the context dataset. 
     %“ed–Thanks for the explanation on log sum vs sum log - we should add a sentence to justify this. It looks a bit like the first term in the ELBO in equation (7). For the other point, I would prefer to leave in $“varnothing$, since the term $p(y˙i “mid x˙i,Z˙c)$ is ambiguous, as it could be $p(y˙i “mid x˙i,Z˙c, “varnothing)$ or $“int p(y˙i “mid x˙i,Z˙c, Z˙c’) “, dp(Z˙c’ “mid Z˙c)$. Please correct me if I’m wrong!˝ 
     %“lhg–Okay, that will be great. I added some explanations:) I have a Ph.D. admission interview next Tuesday at 16:30 KST so can we keep discussing by e-mail or comments? I understand that martingale posterior distribution is an open problem for model-data mismatch situations, is it correct?˝ 
     %“ed–Yes that’s no problem, best of luck with the interview! :) @Juho should we cancel the Tuesday meeting then? We can communicate by email. Yep, model misspecification is still an open problem in the martingale posterior framework.˝ 
     %“lhg–Okay, great.˝ 
     %“ljh–No problem with me either!˝ 
     %“ed–The first term in the objective is more like the point-wise log posterior predictive density averaged over the $n$ data points, which is the KL divergence between the empirical distribution of $“mathcal–D˝$ and the posterior predictive $p(y “mid x,Z˙c)$.˝ 
     %“lhg–We changed our objective function. The first term changed from $“sum˙–i=1˝^n “log “frac–1˝–K˝“sum˙–k=1˝^K p(y˙i—x˙i,Z˙c,Z’^–(k)˝)$ to $“log “Big(“frac–1˝–K˝“sum˙–k=1˝^K “exp–“big(“sum˙–i=1˝^n “log p(y˙i—x˙i,Z˙c,Z’^–(k)˝)“big)˝“Big)$.˝ 
     %“ed– 
     %% Nice!! And this work well? The objective is looking much better motivated now :) 
     %% For the third term, we previously tried putting the avg inside the log, that is 
     %% $$“sum˙–i “in [n]˝ “log “frac–1˝–K˝ “sum˙–k =1˝^K  “exp“left(-“ell(z˙i, “tilde“theta(Z’^–(k)˝))“right),$$ and it didn’t work well right? 
     %Following the recent change to $“mathcal–L˝˙–“text–marg˝˝$, what about 
     %$$ 
     %-“mathcal–L˝˙–“text–pseudo˝˝^*(“phi) =  “log “frac–1˝–K˝ “sum˙–k =1˝^K  “exp“left(-“sum˙–i “in [n]˝ “ell(z˙i, “tilde“theta(Z’^–(k)˝))“right), 
     %$$ 
     %which is basically the first term, so a marginal likelihood, but only using $Z’^–(k)˝$. The current $-“mathcal–L˝˙–“text–pseudo˝˝$ is a just lower bound on $-“mathcal–L˝˙–“text–pseudo˝˝^*$ from Jensen’s inequality. 
     %%Because of this, I’m guessing the results will be similar. 
     %The objective would be nice and symmetric now, since it’s essentially 3 (marginal) likelihood terms, corresponding to context + pseudo, only context and only pseudo. 
     %% If we’re short on time, we can motivate $-“mathcal–L˝˙–“text–pseudo˝˝$ as being a lower bound to $-“mathcal–L˝^*˙–“text–pseudo˝˝$, that is perhaps numerically more stable. Really sorry for giving you more work Hyungi!! 
     %˝ 
     %“lhg–Actually, we simultaneously tried that term in experiment with (18) and sadly it didn’t work well...So we fixed (18). Maybe we can justify with lower bound or something else.˝ 
     %“ed–Ah damn, that’s unfortunate. Maybe we can stick to the lower bound justification then and point to the Supplementary.˝ 
     %“lhg–Yep, that will be good. Now we are trying $“lambda“calL^*$ with additional scaling factor $“lambda“geq 1$.˝ 
     %“ed–That’s a good idea, perhaps we need to balance $“mathcal–L˝˙–“text–pseudo˝˝$ with $“mathcal–L˝˙–“text–amort˝˝$?˝ 
     %“lhg–That’s a good point.˝ 
     %“paragraph–Main approach˝ 
     %“glspl–np˝ are interested in learning a latent function $f$ such that 
     %“begin–align*˝ 
     %f“sim p(f),“quad y—x,f“sim p(y—x,f) 
     %**** methods.tex Line 150 **** 
     %“end–align*˝ 
     %where $(x,y)“in “calD$. 
     %For instance, $f$ may be parameterized by decoder neural networks of “glspl–np˝, $“mu˙–“dec˝(“cdot;“theta)$ and $“sigma˙–“dec˝(“cdot;“theta)$, such that 
     %“begin–align*˝ 
     %“theta“sim p(“theta),“quad y—x,“theta“sim “calN(y—“mu˙–“dec˝(x;“theta),“sigma˙“dec^2 (x;“theta)). 
     %“end–align*˝ 
     %In martingale posterior neural processes, instead of assuming a prior (either for $p(f)$ or $p(“theta)$), we directly model a conditional joint predictive distributions of pseudo context dataset as, 
     %“begin–align*˝ 
     %“calD˙–C’˝“sim p˙“phi (“calD˙–C’˝—“calD˙C), 
     %“end–align*˝ 
     %where $“phi$ is a parameter of joint predictive distribution and $“calD˙–C’˝=“–(x˙i’,y˙i’)“˝˙–i=1˝^–n˙g˝$ is a generated pseudo context dataset with number of generated pseudo context data $n˙g“geq 1$. 
     %If $(x,y)$ is high-dimensional (such as images), we can instead consider an encoded vector $r˙C=f˙–“enc˝(“calD˙C)$ and learn the joint predictive distribution of the encoded representations as $p˙“phi (r˙–C’˝—r˙C)$. Using this predictive, we can construct an empirical predictive density as 
     %“begin–align*˝ 
     %g˙N(x,y) = “frac–1˝–—c—+n˙g˝“left(“sum˙–i“in c˝“delta˙–(x˙i,y˙i)˝ + “sum˙–i=1˝^–n˙g˝“delta˙–(x˙i’,y˙i’)˝“right). 
     %“end–align*˝ 
     %The estimate of the function parameter $“theta$ should originally be obtained as 
     %“begin–align*˝ 
     %“theta(g˙N):=“argmin˙“theta“int “ell((x,y),“theta)g˙N(dx,dy), 
     %“end–align*˝ 
     %where in our case we set 
     %“begin–align*˝ 
     %“ell((x,y),“theta)=-“log “calN (y—“mu˙–“dec˝(x;“theta),“sigma˙–“dec˝^2(x;“theta)). 
     %“end–align*˝ 
     %Instead of directly solving this, we introduce an amortization network with parameter $“lambda$ such that 
     %“begin–align*˝ 
     %**** methods.tex Line 175 **** 
     %“hat–“theta˝(“calD˙C“cup“calD˙–C’˝;“lambda)“approx “theta(g˙N). 
     %“end–align*˝ 
     %Here we can see that differently generated pseudo context dataset $“calD˙–C’˝^–(1)˝=“–(x˙i’^–(1)˝,y˙i’^–(1)˝)“˝˙–i=1˝^–n˙g˝$ and $“calD˙–C’˝^–(2)˝=“–(x˙i’^–(2)˝,y˙i’^–(2)˝)“˝˙–i=1˝^–n˙g˝$ formulate different empirical predictive densities. 
     %Different predictive densities also formulate different amortized $“hat–“theta˝$ which models functional uncertainty without both a global latent variable and a custom prior distribution. 
     %If we have chosen to learn the predictive of encoded representations, we first have to learn $“hat–“theta˝(“cdot;“lambda)$ using only real context representation $r˙C$, and put generated representation $r˙–C’˝$ into the amortization network later. 
     %“paragraph–Directly generating pseudo context data˝ 
     %In order to construct an empirical predictive density $g˙N(x,y)$, we have to sample a pseudo context dataset. 
     %The most straightforward approach to generate pseudo context dataset $“calD˙–C’˝$ is directly generating $(x˙i’,y˙i’)$ from given context dataset $“calD˙C$. 
     %Our first attempt to formulate generator function $f˙–“gen˝$ was to na“”ively use ISAB~“citep–lee2019set˝ module as our generator and sample whole $D˙–C’˝$ at once. 
     %We use concatenated $D˙C$ as inducing points $I“in“bbR^–—C—“times 2˝$ in ISAB and $g$, which is “textit–i.i.d˝ samples from Gaussian distribution, as input $“bx“in “bbR^–n˙g“times 2˝$. 
     %Because ISAB module satisfies permutation invariance for input dataset, we can directly sample a set $“calD˙–C’˝$ without break exchangeability... 
     %“paragraph–Generating features of pseudo context data˝ 
     %“begin–figure˝[t] 
     %“centering 
     %“includegraphics[width = “linewidth]–figure/feature model2.pdf˝ 
     %“caption–Concept figure of our feature generating model applied to “gls–canp˝~“citep–kim2018attentive˝. Here we sample $g$ from a simple distribution (e.g. Gaussian). We generate key feature $r˙k’$ and value feature $r˙v’$ for cross attention layer which are corresponding to pseudo context data. We use generator as one layer ISAB~“citep–lee2019set˝ in our experiment.˝ 
     %“label–fig:feature model2.pdf˝ 
     %“end–figure˝ 
     %As we mentioned above paragraph, directly generating pseudo context dataset is hard task, we construct our model to sample features of pseudo context dataset. 
     %We first encode our $“calD˙c$ into $r˙c“in“bbR^–—C—“times r˙“text–dim˝˝$ with our encoder neural network $f˙–“enc˝$. 
     %See “cref–fig:feature model2.pdf˝ for our method applying to “gls–canp˝ model~“citep–kim2018attentive˝. 
     %“subsection–Training˝ 
     %“label–main:subsec:training˝ 
     %“glspl–mpnp˝ model contains generator function $f˙–“gen˝$ which generates a pseudo context dataset $“calD˙–C’˝$ or a feature of pseudo context dataset $r˙–C’˝$. 
     %**** methods.tex Line 200 **** 
     %To make a generator of “gls–mpnp˝ to sample meaningful $“calD˙–C’˝$ or $r˙–C’˝$, we need to carefully construct training objective function. Otherwise, the generator tends to sample pseudo context dataset far from context dataset or collapse to one-point which does not have enough meaning or affection to target dataset. We consist our training objective function as maximizing following terms: 
     %“begin–align˝ 
     %“sum˙–i=1˝^n“left(“log p(y˙i—x˙i,“calD˙C)+“log “frac–1˝–K˝“sum˙–j=1˝^K p(y˙i—x˙i,“calD˙C,“calD˙–C’˝^–(j)˝)+“frac–1˝–K˝“sum˙–j=1˝^K “log p(y˙i—x˙i, “calD˙–C’˝^–(j)˝)“right) 
     %“end–align˝ 
     %“ed–Does the $p$ in the first term above need a subscript? So something like $p˙–“text–amort˝˝$ or something?˝ 
     %where $K$ is the number of different generated pseudo context dataset. 
     %Here the first term $“log p(y—x,“calD˙C)$ implies that our amortized model should also well predict the posterior distribution of $“calD$ only with context dataset. 
     %The second term implies that the ensemble of our model should well predict the posterior distribution of $“calD$ with context dataset and pseudo context dataset. 
     %The third term implies that our model should generate pseudo context dataset which well explains $“calD$. 
     %This third term makes our model to actually generate more meaningful pseudo context dataset. 
     %See “cref–app:sec:ablation˙study˝ for generated pseudo context samples with and without each loss terms. -->    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:main:sec:related" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Related Works</title>
    <para xml:id="S4.p1">
      <ERROR class="undefined">\gls</ERROR>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->      <p>cnp <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018conditional" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> is the first <ERROR class="undefined">\gls</ERROR>npf model which consists of simple <ERROR class="undefined">\gls</ERROR>mlp layers as its encoder and decoder. <ERROR class="undefined">\gls</ERROR>np <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018neural" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> also uses <ERROR class="undefined">\gls</ERROR>mlp layers as its encoder and decoder but introduces a global latent variable to model a functional uncertainty.
<ERROR class="undefined">\gls</ERROR>canp <cite class="ltx_citemacro_citep">[<bibref bibrefs="kim2018attentive" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> and <ERROR class="undefined">\gls</ERROR>anp <cite class="ltx_citemacro_citep">[<bibref bibrefs="kim2018attentive" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> are the models which apply attention modules as their encoder block in order to well summarize context information relevant to target points.
<cite class="ltx_citemacro_citet"><bibref bibrefs="louizos2019functional" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite> proposed <ERROR class="undefined">\glspl</ERROR>np model which employs local latent variables instead of a global latent variable by applying a graph neural network.
By applying convolution layers as their encoder, <cite class="ltx_citemacro_citet"><bibref bibrefs="gordon2020convolutional" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite> and <cite class="ltx_citemacro_citet"><bibref bibrefs="foong2020meta" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite> introduced a translation equivariant <ERROR class="undefined">\glspl</ERROR>cnp and <ERROR class="undefined">\glspl</ERROR>np model, respectively.
In addition to these works, <ERROR class="undefined">\gls</ERROR>bnp <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2020bootstrapping" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> suggests modeling functional uncertainty with the bootstrap <cite class="ltx_citemacro_citep">[<bibref bibrefs="efron1992bootstrap" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite><!--  %“gls–neubnp˝~“citep–lee2022neural˝ also used a recent bootstrap method called Neural Bootstrapper~“citep–shin2021neural˝ to model functional uncertainty. --> method instead of using a single global latent variable.</p>
    </para>
  </section>
  <section inlist="toc" labels="LABEL:main:sec:experiments" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Experiments</title>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->    <para xml:id="S5.p1">
      <p>We provide extensive experimental results to show how <ERROR class="undefined">\gls</ERROR>mpnp and <ERROR class="undefined">\gls</ERROR>mpanp effectively increase performance upon the following baselines: <ERROR class="undefined">\gls</ERROR>cnp, <ERROR class="undefined">\gls</ERROR>np, <ERROR class="undefined">\gls</ERROR>bnp, <ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>anp, and <ERROR class="undefined">\gls</ERROR>banp. All models except deterministic models (i.e., <ERROR class="undefined">\gls</ERROR>cnp and <ERROR class="undefined">\gls</ERROR>canp) use the same number of samples; <Math mode="inline" tex="K=5" text="K = 5" xml:id="S5.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMApp>
          </XMath>
        </Math> for the image completion task and <Math mode="inline" tex="K=10" text="K = 10" xml:id="S5.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMApp>
          </XMath>
        </Math> for the others. Refer to <ref labelref="LABEL:app:sec:architectures" show="creftypeplural~refnum"/><ERROR class="undefined">\crefpairconjunction</ERROR><ref labelref="LABEL:app:sec:details" show="refnum"/> for more detailed experimental setup including model architectures, dataset and evaluation metrics.</p>
    </para>
<!--  %In this section, we carry out various experiments to show how “gls–mpnp˝ effectly increase performance. 
     %We compare our model (“gls–mpnp˝ and “gls–mpanp˝) with various baseline “gls–npf˝ models(“gls–cnp˝, “gls–np˝, “gls–bnp˝, “gls–neubnp˝, “gls–canp˝, “gls–anp˝, “gls–banp˝ and “gls–neubanp˝). 
     %We used same number of samples($K=5$ for image completion task and $K=10$ for the others) for all models except deterministic models “gls–cnp˝ and “gls–canp˝. 
     %For detailed experimental setup including model architectures and dataset, please refer to “cref–app:sec:architectures,app:sec:details˝. -->    <subsection inlist="toc" labels="LABEL:main:sec:experiments:1dregression" xml:id="S5.SS1">
      <tags>
        <tag>5.1</tag>
        <tag role="autoref">subsection 5.1</tag>
        <tag role="refnum">5.1</tag>
        <tag role="typerefnum">§5.1</tag>
      </tags>
      <title><tag close=" ">5.1</tag>1D Regression</title>
      <para xml:id="S5.SS1.p1">
        <p>In this section, we conducted 1D regression experiments following <cite class="ltx_citemacro_citet"><bibref bibrefs="kim2018attentive" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> and <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2020bootstrapping" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>.
In this experiments, the dataset curves are generated from <ERROR class="undefined">\gls</ERROR>gp with 4 different settings: i) RBF kernels, ii) Matérn 5/2 kernels, iii) Periodic kernels, and iv) RBF kernels with Student’s <Math mode="inline" tex="t" text="t" xml:id="S5.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> noise.</p>
      </para>
      <paragraph inlist="toc" labels="LABEL:main:subsec:infinite_training" xml:id="S5.SS1.SSS0.Px1">
        <title>Infinite Training Dataset</title>
        <figure inlist="lof" labels="LABEL:fig:feature_method" placement="t" xml:id="S5.F2">
          <tags>
            <tag><text fontsize="90%">Figure 2</text></tag>
            <tag role="autoref">Figure 2</tag>
            <tag role="refnum">2</tag>
            <tag role="typerefnum">Figure 2</tag>
          </tags>
          <graphics candidates="figure/main_vis_1.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/main_vis_1.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="S5.F2.g1"/>
          <graphics candidates="figure/main_vis_2.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/main_vis_2.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="S5.F2.g2"/>
<!--  %“includegraphics[width = 0.32“textwidth]–figure/data plot 9.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/sample plot 9.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/posterior plot 9.pdf˝ -->          <toccaption class="ltx_centering"><tag close=" "><!--  %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ -->2<!--  %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ --></tag><!--  %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ -->Posterior samples of <!--  %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ --><ERROR class="undefined">\gls</ERROR>mpanp for 1D regression task with RBF kernel. The black dashed line is the true function sampled from <ERROR class="undefined">\gls</ERROR>gp with RBF kernel, and the black dots are context points. We visualized decoded mean and standard deviation with colored lines and areas. (Left) <ERROR class="undefined">\Gls</ERROR>mpanp posterior predictions using the combined features of the original contexts and the generated pseudo contexts. (Right) Predictions using only the generated pseudo contexts without the original contexts. The pseudo contexts are decoded into reasonable functions, especially with high uncertainty for the region without context points.</toccaption>
          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 2</text></tag><!--  %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ 
     %“caption–“color–blue˝It shows posterior samples of “gls–mpanp˝ with context data and generated pseudo context data in 1D regression task with RBF kernel. Here, the black dashed line is a function sampled from “gls–gp˝ with RBF kernel and the black dots are context points. (Left) Overlaid posterior predictions with the combined feature from the contexts and generated pseudo contexts. Colored lines and areas represent decoded mean and std. (Right) In order to show the quality of generated pseudo context dataset, we visualize the posterior predictions with feature only from the generated pseudo contexts.˝ 
     %“caption–Generated pseudo context data and posterior samples of MPANP in 1d regression task. (Left) 
     %We train an autoencoder that can decode the representations $R˙c$ into the points in the input space, and visualize the decoded inputs of the generated pseudo-contexts using the autoencoder. Red crosses are the real context data points, and the points sharing the same colors correspond to a set of pseudo context. (Right) Overlaid posterior predictions from the generated pseudo contexts.˝ --><text fontsize="90%">Posterior samples of <ERROR class="undefined">\gls</ERROR>mpanp for 1D regression task with RBF kernel. The black dashed line is the true function sampled from <ERROR class="undefined">\gls</ERROR>gp with RBF kernel, and the black dots are context points. We visualized decoded mean and standard deviation with colored lines and areas. (Left) <ERROR class="undefined">\Gls</ERROR>mpanp posterior predictions using the combined features of the original contexts and the generated pseudo contexts. (Right) Predictions using only the generated pseudo contexts without the original contexts. The pseudo contexts are decoded into reasonable functions, especially with high uncertainty for the region without context points.</text></caption>
        </figure>
<!--  %“begin–table˝[t] 
     %“caption–Context and target log likelihood values on data sampled from Gaussian Processes with various kernel. In the last column $t$-noise data generated by adding noise sampled from student $t$ distribution to Gaussian Processes with RBF Kernel. Performances are measured over 4 seeds.˝ 
     %“label–tab:table˙1d˝ 
     %“centering 
     %“scriptsize 
     %“resizebox–“textwidth˝–!˝– 
     %“begin–tabular˝–lrrrrrrrrrr˝ 
     %“toprule 
     %Dataset             &amp;               &amp; RBF           &amp;               &amp;Matern         &amp;               &amp; Periodic       &amp;               &amp;t-noise ““ 
     %“midrule 
     %&amp; context       &amp; target        &amp; context       &amp; target        &amp; context       &amp; target         &amp; context       &amp; target  ““ 
     %“midrule 
     %CNP                 &amp; $0.971“pm–0.004˝$ &amp; $0.266“pm–0.007˝$ &amp; $0.855“pm–0.001˝$ &amp; $0.105“pm–0.008˝$ &amp;$-0.151“pm–0.020˝$ &amp; $-0.722“pm–0.010˝$ &amp;$-0.005“pm–0.054˝$ &amp; $-0.583“pm–0.009˝$ ““ 
     %BNP                 &amp; $0.978“pm–0.018˝$ &amp; $0.307“pm–0.010˝$ &amp; $0.880“pm–0.006˝$ &amp; $0.153“pm–0.007˝$ &amp;$-0.086“pm–0.016˝$ &amp; $-0.703“pm–0.003˝$ &amp;$ 0.000“pm–0.059˝$ &amp; $-0.434“pm–0.012˝$  ““ 
     %**** experiments.tex Line 50 **** 
     %NeuBNP              &amp; $0.903“pm–0.005˝$ &amp; $0.248“pm–0.006˝$ &amp; $0.779“pm–0.012˝$ &amp; $0.091“pm–0.005˝$ &amp;$-0.084“pm–0.010˝$ &amp; $-0.691“pm–0.013˝$ &amp;$ 0.024“pm–0.081˝$ &amp; $-0.487“pm–0.043˝$  ““+ 
     %Ours                &amp; $“textbf–1.102˝“pm–0.008˝$ &amp; $“textbf–0.446˝“pm–0.007˝$ &amp; $“textbf–1.021˝“pm–0.004˝$ &amp; $“textbf–0.264˝“pm–0.008˝$ &amp;$ “textbf–0.174˝“pm–0.026˝$ &amp; $“textbf–-0.676˝“pm–0.007˝$ &amp;$ “textbf–0.205˝“pm–0.047˝$ &amp; $“textbf–-0.364˝“pm–0.008˝$  ““ 
     %“midrule 
     %AttnCNP              &amp; $1.372“pm–0.002˝$ &amp; $0.575“pm–0.021˝$ &amp; $1.371“pm–0.004˝$ &amp; $0.396“pm–0.004˝$ &amp; $“textbf–1.229˝“pm–0.028˝$ &amp; $-0.711“pm–0.015˝$ &amp; $0.415“pm–0.031˝$ &amp; $-0.783“pm–0.046˝$ ““ 
     %AttnBNP              &amp; $1.372“pm–0.001˝$ &amp; $0.644“pm–0.008˝$ &amp; $1.372“pm–0.001˝$ &amp; $0.462“pm–0.010˝$ &amp; $0.776“pm–0.001˝$ &amp; $-0.876“pm–0.034˝$ &amp; $0.813“pm–0.023˝$ &amp; $-0.489“pm–0.027˝$  ““ 
     %AttnNeuBNP           &amp; $1.353“pm–0.003˝$ &amp; $0.601“pm–0.002˝$ &amp; $1.341“pm–0.003˝$ &amp; $0.417“pm–0.011˝$ &amp; $0.626“pm–0.004˝$ &amp; $-0.744“pm–0.007˝$ &amp; $0.748“pm–0.039˝$ &amp; $“textbf–-0.391˝“pm–0.012˝$  ““ 
     %Ours                 &amp; $“textbf–1.375˝“pm–0.000˝$ &amp; $“textbf–0.686˝“pm–0.003˝$ &amp; $“textbf–1.374˝“pm–0.000˝$ &amp; $“textbf–0.487˝“pm–0.002˝$ &amp; $1.168“pm–0.036˝$ &amp; $“textbf–-0.662˝“pm–0.029˝$ &amp; $“textbf–0.887˝“pm–0.055˝$ &amp; $-0.476“pm–0.031˝$  ““ 
     %“bottomrule 
     %“end–tabular˝˝ 
     %“end–table˝ 
     %“input–table/table˙gp˙inf˝ -->        <table inlist="lot" labels="LABEL:table/main_gp_inf" placement="t" xml:id="S5.T1">
          <tags>
            <tag><text fontsize="90%">Table 1</text></tag>
            <tag role="autoref">Table 1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">Table 1</tag>
          </tags>
          <toccaption class="ltx_centering"><tag close=" ">1</tag>Test results for 1D regression tasks on RBF, Matern, Periodic, and <Math mode="inline" tex="t" text="t" xml:id="S5.T1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMath>
            </Math>-noise. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values. All values are averaged over four seeds. See <ref labelref="LABEL:table/app_gp_inf_full" show="creftype~refnum"/> for the task log-likelihood values.</toccaption>
          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 1</text></tag><text fontsize="90%">Test results for 1D regression tasks on RBF, Matern, Periodic, and <Math mode="inline" tex="t" text="t" xml:id="S5.T1.m2">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                </XMath>
              </Math>-noise. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values. All values are averaged over four seeds. See <ref labelref="LABEL:table/app_gp_inf_full" show="creftype~refnum"/> for the task log-likelihood values.</text></caption>
          <inline-block align="center" depth="0.0pt" height="143.4pt" width="433.6pt" xscale="0.796403152563431" xtranslate="-55.4pt" yscale="0.796403152563431" ytranslate="18.3pt">
            <tabular class="ltx_guessed_headers" vattach="middle">
              <tbody>
                <tr>
                  <td border="tt" thead="row"/>
                  <td align="center" border="tt" colspan="2">RBF</td>
                  <td align="center" border="tt" colspan="2">Matern</td>
                  <td align="center" border="tt" colspan="2">Periodic</td>
                  <td align="center" border="tt" colspan="2"><Math mode="inline" tex="t" text="t" xml:id="S5.T1.m3">
                      <XMath>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      </XMath>
                    </Math>-noise</td>
                </tr>
                <tr>
                  <td align="left" thead="row">Model</td>
                  <td align="right" border="t">Context</td>
                  <td align="right" border="t">Target</td>
                  <td align="right" border="t">Context</td>
                  <td align="right" border="t">Target</td>
                  <td align="right" border="t">Context</td>
                  <td align="right" border="t">Target</td>
                  <td align="right" border="t">Context</td>
                  <td align="right" border="t">Target</td>
                </tr>
                <tr>
                  <td align="left" border="t" thead="row">CNP</td>
                  <td align="right" border="t">1.096<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="S5.T1.m4">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.515<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T1.m5">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">1.031<Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T1.m6">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.347<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T1.m7">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">-0.120<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="S5.T1.m8">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">-0.729<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="S5.T1.m9">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.032<Math mode="inline" tex="\scriptstyle{\pm 0.014}" text="plus-or-minus 0.014" xml:id="S5.T1.m10">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.014" role="NUMBER">0.014</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">-0.816<Math mode="inline" tex="\scriptstyle{\pm 0.032}" text="plus-or-minus 0.032" xml:id="S5.T1.m11">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.032" role="NUMBER">0.032</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">NP</td>
                  <td align="right">1.022<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m12">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.498<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T1.m13">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.948<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T1.m14">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.337<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m15">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.267<Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="S5.T1.m16">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">-0.668</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T1.m17">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.201</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.025}" text="plus-or-minus 0.025" xml:id="S5.T1.m18">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.025" role="NUMBER">0.025</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.333<Math mode="inline" tex="\scriptstyle{\pm 0.078}" text="plus-or-minus 0.078" xml:id="S5.T1.m19">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.078" role="NUMBER">0.078</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">BNP</td>
                  <td align="right">1.112<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T1.m20">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.588<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="S5.T1.m21">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.057<Math mode="inline" tex="\scriptstyle{\pm 0.009}" text="plus-or-minus 0.009" xml:id="S5.T1.m22">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.009" role="NUMBER">0.009</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.418<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T1.m23">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.106<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="S5.T1.m24">
                      <XMath>
                        <XMApp>
<!--  %**** main_gp_inf.tex Line 25 **** -->                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.705<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="S5.T1.m25">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.009<Math mode="inline" tex="\scriptstyle{\pm 0.032}" text="plus-or-minus 0.032" xml:id="S5.T1.m26">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.032" role="NUMBER">0.032</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.619<Math mode="inline" tex="\scriptstyle{\pm 0.191}" text="plus-or-minus 0.191" xml:id="S5.T1.m27">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.191" role="NUMBER">0.191</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">MPNP (ours)</text></p>
                    </inline-block></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.189</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m28">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.675</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T1.m29">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.123</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m30">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.481</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="S5.T1.m31">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.205</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="S5.T1.m32">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">-0.668</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="S5.T1.m33">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.145<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="S5.T1.m34">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">-0.329</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.025}" text="plus-or-minus 0.025" xml:id="S5.T1.m35">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.025" role="NUMBER">0.025</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" border="t" thead="row">CANP</td>
                  <td align="right" border="t">1.304<Math mode="inline" tex="\scriptstyle{\pm 0.027}" text="plus-or-minus 0.027" xml:id="S5.T1.m36">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.027" role="NUMBER">0.027</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.847<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m37">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">1.264<Math mode="inline" tex="\scriptstyle{\pm 0.041}" text="plus-or-minus 0.041" xml:id="S5.T1.m38">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.041" role="NUMBER">0.041</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.662<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="S5.T1.m39">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.527<Math mode="inline" tex="\scriptstyle{\pm 0.106}" text="plus-or-minus 0.106" xml:id="S5.T1.m40">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.106" role="NUMBER">0.106</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">-0.592<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="S5.T1.m41">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.410<Math mode="inline" tex="\scriptstyle{\pm 0.155}" text="plus-or-minus 0.155" xml:id="S5.T1.m42">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.155" role="NUMBER">0.155</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">-0.577<Math mode="inline" tex="\scriptstyle{\pm 0.022}" text="plus-or-minus 0.022" xml:id="S5.T1.m43">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.022" role="NUMBER">0.022</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">ANP</td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T1.m44">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.850<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="S5.T1.m45">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T1.m46">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.663<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="S5.T1.m47">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.583<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="S5.T1.m48">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-1.019<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="S5.T1.m49">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.836<Math mode="inline" tex="\scriptstyle{\pm 0.071}" text="plus-or-minus 0.071" xml:id="S5.T1.m50">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.071" role="NUMBER">0.071</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.415<Math mode="inline" tex="\scriptstyle{\pm 0.131}" text="plus-or-minus 0.131" xml:id="S5.T1.m51">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.131" role="NUMBER">0.131</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">BANP</td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T1.m52">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.846<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="S5.T1.m53">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T1.m54">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.662<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m55">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.354</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T1.m56">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.496<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m57">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.646<Math mode="inline" tex="\scriptstyle{\pm 0.042}" text="plus-or-minus 0.042" xml:id="S5.T1.m58">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.042" role="NUMBER">0.042</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">-0.425<Math mode="inline" tex="\scriptstyle{\pm 0.050}" text="plus-or-minus 0.050" xml:id="S5.T1.m59">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.050" role="NUMBER">0.050</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">MPANP (ours)</text></p>
                    </inline-block></td>
                  <td align="right" border="bb">1.379<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T1.m60">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.881</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T1.m61">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold"><!--  %**** main˙gp˙inf.tex Line 50 **** -->1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T1.m62">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.692</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T1.m63">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb">1.348<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T1.m64">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">-0.494</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="S5.T1.m65">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.842</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.062}" text="plus-or-minus 0.062" xml:id="S5.T1.m66">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.062" role="NUMBER">0.062</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">-0.332</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="S5.T1.m67">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
              </tbody>
            </tabular>
          </inline-block>
        </table>
        <figure inlist="lof" labels="LABEL:figure/main_gp_finite" placement="t" xml:id="S5.F3">
          <tags>
            <tag><text fontsize="90%">Figure 3</text></tag>
            <tag role="autoref">Figure 3</tag>
            <tag role="refnum">3</tag>
            <tag role="typerefnum">Figure 3</tag>
          </tags>
          <graphics candidates="figure/main_gp_finite_np.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/main_gp_finite_np.pdf" options="width=411.93767pt,keepaspectratio=true" xml:id="S5.F3.g1"/>
          <break class="ltx_break"/>
          <graphics candidates="figure/main_gp_finite_anp.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/main_gp_finite_anp.pdf" options="width=411.93767pt,keepaspectratio=true" xml:id="S5.F3.g2"/>
          <toccaption class="ltx_centering"><tag close=" ">3</tag>Test target log-likelihood values with varying the number of train data for 1D regression tasks on RBF, Matern, Periodic, and <Math mode="inline" tex="t" text="t" xml:id="S5.F3.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMath>
            </Math>-noise. Here, x-axis denotes how many examples are used for training, i.e., <Math mode="inline" tex="\times 1" text="absent * 1" xml:id="S5.F3.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="absent"/>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math>, <Math mode="inline" tex="\times 2" text="absent * 2" xml:id="S5.F3.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="absent"/>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math>, and <Math mode="inline" tex="\times 5" text="absent * 5" xml:id="S5.F3.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="absent"/>
                  <XMTok meaning="5" role="NUMBER">5</XMTok>
                </XMApp>
              </XMath>
            </Math> respectively denote <Math mode="inline" tex="51200" text="51200" xml:id="S5.F3.m5">
              <XMath>
                <XMTok meaning="51200" role="NUMBER">51200</XMTok>
              </XMath>
            </Math>, <Math mode="inline" tex="102400" text="102400" xml:id="S5.F3.m6">
              <XMath>
                <XMTok meaning="102400" role="NUMBER">102400</XMTok>
              </XMath>
            </Math>, and <Math mode="inline" tex="256000" text="256000" xml:id="S5.F3.m7">
              <XMath>
                <XMTok meaning="256000" role="NUMBER">256000</XMTok>
              </XMath>
            </Math> train examples.</toccaption>
          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 3</text></tag><text fontsize="90%">Test target log-likelihood values with varying the number of train data for 1D regression tasks on RBF, Matern, Periodic, and <Math mode="inline" tex="t" text="t" xml:id="S5.F3.m8">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                </XMath>
              </Math>-noise. Here, x-axis denotes how many examples are used for training, i.e., <Math mode="inline" tex="\times 1" text="absent * 1" xml:id="S5.F3.m9">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">×</XMTok>
                    <XMTok meaning="absent"/>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math>, <Math mode="inline" tex="\times 2" text="absent * 2" xml:id="S5.F3.m10">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">×</XMTok>
                    <XMTok meaning="absent"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMath>
              </Math>, and <Math mode="inline" tex="\times 5" text="absent * 5" xml:id="S5.F3.m11">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">×</XMTok>
                    <XMTok meaning="absent"/>
                    <XMTok meaning="5" role="NUMBER">5</XMTok>
                  </XMApp>
                </XMath>
              </Math> respectively denote <Math mode="inline" tex="51200" text="51200" xml:id="S5.F3.m12">
                <XMath>
                  <XMTok meaning="51200" role="NUMBER">51200</XMTok>
                </XMath>
              </Math>, <Math mode="inline" tex="102400" text="102400" xml:id="S5.F3.m13">
                <XMath>
                  <XMTok meaning="102400" role="NUMBER">102400</XMTok>
                </XMath>
              </Math>, and <Math mode="inline" tex="256000" text="256000" xml:id="S5.F3.m14">
                <XMath>
                  <XMTok meaning="256000" role="NUMBER">256000</XMTok>
                </XMath>
              </Math> train examples.</text></caption>
        </figure>
        <para xml:id="S5.SS1.SSS0.Px1.p1">
          <p>Previous works <cite class="ltx_citemacro_citep">[<bibref bibrefs="garnelo2018neural,kim2018attentive,le2018empirical" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> assumed that there exists a <ERROR class="undefined">\gls</ERROR>gp curve generator that can provide virtually infinite amount of tasks for training. We first follow this setup, training all models for 100,000 steps where a new task is generated from each training step. We compare the models by picking checkpoints achieving the lowest validation loss. <ref labelref="LABEL:table/main_gp_inf" show="creftype~refnum"/> clearly shows that our model outperforms the other models in most cases. This results show that our model well captures the functional uncertainty compared to the other methods.
In <ref labelref="LABEL:app:sec:additional_experiments" show="creftype~refnum"/>, we also report the comparison with the baselines with increased number of parameters to match the additional number of parameters introduced for the generator in our model, where ours still significantly outperforms the baselines.</p>
        </para>
<!--  %We also report the performances of our model generating pseudo contexts directly in the input space, denoted as DirectNP and DirectANP in “cref–table/main˙gp˙inf˝. Unfortunately, DirectNP and DirectANP perform worse then ours when generating representations, presumably due to the difficulty of generating inputs that should be processed with nonlinear encoders and decoders. See “cref–app:sec:directly˙generating˙input˝ for the model architectures and the samples generated from DirectNP and DirectANP. In “cref–fig:feature˙method˝, we present the generated pseudo context data and posterior samples from trained “gls–mpanp˝ model. 
     %In “cref–app:sec:additional˙experiments˝, we also report the comparison with the baselines with increased number of parameters to match the additional number of parameters introduced for the generator in our model, where ours still significantly outperforms the baselines. -->      </paragraph>
      <paragraph inlist="toc" xml:id="S5.SS1.SSS0.Px2">
        <title>Finite Training Dataset</title>
        <para xml:id="S5.SS1.SSS0.Px2.p1">
          <p>We also compare the models on more realistic setting assuming a finite amount of training tasks. Specifically, we first configured the finite training dataset consisting of <Math mode="inline" tex="\{51200,102400,256000\}" text="set@(51200, 102400, 256000)" xml:id="S5.SS1.SSS0.Px2.p1.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS1.SSS0.Px2.p1.m1.1"/>
                    <XMRef idref="S5.SS1.SSS0.Px2.p1.m1.2"/>
                    <XMRef idref="S5.SS1.SSS0.Px2.p1.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="51200" role="NUMBER" xml:id="S5.SS1.SSS0.Px2.p1.m1.1">51200</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="102400" role="NUMBER" xml:id="S5.SS1.SSS0.Px2.p1.m1.2">102400</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="256000" role="NUMBER" xml:id="S5.SS1.SSS0.Px2.p1.m1.3">256000</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> examples at the start of the training, instead of generating new tasks for each training step. We then trained all models with the same 100,000 training iterations in order to train the models with the same training budget as in the infinite training dataset situation. <ref labelref="LABEL:figure/main_gp_finite" show="creftype~refnum"/> clearly shows that our model consistently outperforms other models in terms of the target log-likelihood even when the training dataset is finite. This indicates that <ERROR class="undefined">\glspl</ERROR>mpnp effectively learn a predictive distribution of unseen dataset from a given dataset with small number of tasks. Refer to <ref labelref="LABEL:app:sec:additional_experiments" show="creftype~refnum"/> for more detailed results.</p>
        </para>
<!--  %Now we compare the models on more realistic setting assuming a finite amount of training tasks. 
     %In order to train the models with the same training budget as in the infinite training dataset situation, we first configured the training dataset so that 500 epochs become 100000 steps. 
     %We then gradually increase the number of data so that 100000 steps become 250, 125, and 100 epochs, respectively. 
     %“cref–fig:figure˙gp˙finite˝ shows that our model consistently outperforms other models for almost all dataset size in “gls–gp˝ with RBF kernel. This shows that “glspl–mpnp˝ effectively learn a predictive distribution of unseen dataset from a given dataset with small number of tasks. Please refer to “cref–app:sec:additional˙experiments˝ for the results for the kernels other than RBF for which the results are similar as in RBF kernel. 
     %**** experiments.tex Line 100 **** 
     %“paragraph–Robustness Across Kernels˝ 
     %“input–table/table˙gp˙robust˝ 
     %“citet–lee2020bootstrapping˝ conducted model-data mismatch experiments in 1D regression experiments by training the models with RBF kernels and evaluating them on the tasks generated from “glspl–gp˝ with kernels other than RBF. 
     %Following “citet–lee2020bootstrapping˝, we first train a model with infinite “gls–gp˝ data with RBF kernel, 
     %and measure the log-likelihoods on the test datasets generated from other kernels. 
     %As one can see from “cref–tab:table˙gp˙robust˝, “glspl–mpnp˝ outperform baselines on RBF and Matern kernel (which is relatively simlar to RBF kernel compared to the others), but perform worse than bootstrap based method for the other kernels which are particularly designed to be robust under such settings. -->      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:main:sec:experiments:imagecompletion" xml:id="S5.SS2">
      <tags>
        <tag>5.2</tag>
        <tag role="autoref">subsection 5.2</tag>
        <tag role="refnum">5.2</tag>
        <tag role="typerefnum">§5.2</tag>
      </tags>
      <title><tag close=" ">5.2</tag>Image Completion</title>
      <table inlist="lot" labels="LABEL:table/main_image" placement="t" xml:id="S5.T2">
        <tags>
          <tag><text fontsize="90%">Table 2</text></tag>
          <tag role="autoref">Table 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Table 2</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>Test results for image completion tasks on MNIST, SVHN, and CelebA. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 2</text></tag><text fontsize="90%">Test results for image completion tasks on MNIST, SVHN, and CelebA. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</text></caption>
        <inline-block align="center" depth="0.0pt" height="132.9pt" width="433.6pt" xscale="0.738319872637138" xtranslate="-76.8pt" yscale="0.738319872637138" ytranslate="23.6pt">
          <tabular class="ltx_guessed_headers" vattach="middle">
            <tbody>
              <tr>
                <td border="tt" thead="row"/>
                <td align="center" border="tt" colspan="3">MNIST</td>
                <td align="center" border="tt" colspan="3">SVHN</td>
                <td align="center" border="tt" colspan="3">CelebA</td>
              </tr>
              <tr>
                <td align="left" thead="row">Model</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
              </tr>
              <tr>
                <td align="left" border="t" thead="row">CNP</td>
                <td align="right" border="t">0.878<Math mode="inline" tex="\scriptstyle{\pm 0.016}" text="plus-or-minus 0.016" xml:id="S5.T2.m1">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.016" role="NUMBER">0.016</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.690<Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T2.m2">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.706<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="S5.T2.m3">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">3.009<Math mode="inline" tex="\scriptstyle{\pm 0.069}" text="plus-or-minus 0.069" xml:id="S5.T2.m4">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.069" role="NUMBER">0.069</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.785<Math mode="inline" tex="\scriptstyle{\pm 0.053}" text="plus-or-minus 0.053" xml:id="S5.T2.m5">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.053" role="NUMBER">0.053</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.796<Math mode="inline" tex="\scriptstyle{\pm 0.054}" text="plus-or-minus 0.054" xml:id="S5.T2.m6">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.054" role="NUMBER">0.054</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.692<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T2.m7">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.099<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="S5.T2.m8">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.134<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="S5.T2.m9">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">NP</td>
                <td align="right">0.797<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="S5.T2.m10">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.707<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="S5.T2.m11">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.714<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T2.m12">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.045<Math mode="inline" tex="\scriptstyle{\pm 0.021}" text="plus-or-minus 0.021" xml:id="S5.T2.m13">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.021" role="NUMBER">0.021</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.841<Math mode="inline" tex="\scriptstyle{\pm 0.019}" text="plus-or-minus 0.019" xml:id="S5.T2.m14">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.019" role="NUMBER">0.019</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.851<Math mode="inline" tex="\scriptstyle{\pm 0.019}" text="plus-or-minus 0.019" xml:id="S5.T2.m15">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.019" role="NUMBER">0.019</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.721<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="S5.T2.m16">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.216<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="S5.T2.m17">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.246<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="S5.T2.m18">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">BNP</td>
                <td align="right">0.859<Math mode="inline" tex="\scriptstyle{\pm 0.050}" text="plus-or-minus 0.050" xml:id="S5.T2.m19">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.050" role="NUMBER">0.050</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.742<Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="S5.T2.m20">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.752<Math mode="inline" tex="\scriptstyle{\pm 0.029}" text="plus-or-minus 0.029" xml:id="S5.T2.m21">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.029" role="NUMBER">0.029</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.169<Math mode="inline" tex="\scriptstyle{\pm 0.028}" text="plus-or-minus 0.028" xml:id="S5.T2.m22">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.028" role="NUMBER">0.028</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.946<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="S5.T2.m23">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.957<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="S5.T2.m24">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.897<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="S5.T2.m25">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.329<Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T2.m26">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.394<Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T2.m27">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">MPNP (ours)</text></p>
                  </inline-block></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold"><!--  %**** main˙image.tex Line 25 **** -->0.861</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T2.m28">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.747</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T2.m29">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.757</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="S5.T2.m30">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">3.220</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="S5.T2.m31">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.980</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.016}" text="plus-or-minus 0.016" xml:id="S5.T2.m32">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.016" role="NUMBER">0.016</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.992</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.016}" text="plus-or-minus 0.016" xml:id="S5.T2.m33">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.016" role="NUMBER">0.016</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.997</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T2.m34">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.369</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T2.m35">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.407</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T2.m36">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" border="t" thead="row">CANP</td>
                <td align="right" border="t">0.871<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="S5.T2.m37">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.688<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="S5.T2.m38">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.685<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="S5.T2.m39">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">3.079<Math mode="inline" tex="\scriptstyle{\pm 0.052}" text="plus-or-minus 0.052" xml:id="S5.T2.m40">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.052" role="NUMBER">0.052</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">3.386<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="S5.T2.m41">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">3.335<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="S5.T2.m42">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.695<Math mode="inline" tex="\scriptstyle{\pm 0.033}" text="plus-or-minus 0.033" xml:id="S5.T2.m43">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.033" role="NUMBER">0.033</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.674<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="S5.T2.m44">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">2.642<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="S5.T2.m45">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">ANP</td>
                <td align="right">1.186<Math mode="inline" tex="\scriptstyle{\pm 0.050}" text="plus-or-minus 0.050" xml:id="S5.T2.m46">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.050" role="NUMBER">0.050</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.744<Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="S5.T2.m47">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.793<Math mode="inline" tex="\scriptstyle{\pm 0.009}" text="plus-or-minus 0.009" xml:id="S5.T2.m48">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.009" role="NUMBER">0.009</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.996<Math mode="inline" tex="\scriptstyle{\pm 0.064}" text="plus-or-minus 0.064" xml:id="S5.T2.m49">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.064" role="NUMBER">0.064</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.365<Math mode="inline" tex="\scriptstyle{\pm 0.053}" text="plus-or-minus 0.053" xml:id="S5.T2.m50">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.053" role="NUMBER">0.053</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.405<Math mode="inline" tex="\scriptstyle{\pm 0.053}" text="plus-or-minus 0.053" xml:id="S5.T2.m51">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.053" role="NUMBER">0.053</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">4.086<Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="S5.T2.m52">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.724<Math mode="inline" tex="\scriptstyle{\pm 0.029}" text="plus-or-minus 0.029" xml:id="S5.T2.m53">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.029" role="NUMBER">0.029</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.833<Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="S5.T2.m54">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">BANP</td>
                <td align="right">1.329<Math mode="inline" tex="\scriptstyle{\pm 0.021}" text="plus-or-minus 0.021" xml:id="S5.T2.m55">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.021" role="NUMBER">0.021</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.752<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T2.m56">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.819<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T2.m57">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">4.019<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="S5.T2.m58">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.437<Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="S5.T2.m59">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">3.476<Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="S5.T2.m60">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">4.126<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T2.m61">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.764<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="S5.T2.m62">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.871<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T2.m63">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">MPANP (ours)</text></p>
                  </inline-block></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.361</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="S5.T2.m64">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.798</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T2.m65">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.862</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T2.m66">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">4.117</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="S5.T2.m67">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">3.502</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="S5.T2.m68">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">3.544</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="S5.T2.m69">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">4.136</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="S5.T2.m70">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.833</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="S5.T2.m71">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.934</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.009}" text="plus-or-minus 0.009" xml:id="S5.T2.m72">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.009" role="NUMBER">0.009</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
            </tbody>
          </tabular>
        </inline-block>
      </table>
      <para xml:id="S5.SS2.p1">
        <p>Next we conducted 2D image completion tasks for three different datasets, i.e., MNIST, SVHN, and CelebA.
For training, we uniformly sample the number of context pixels <Math mode="inline" tex="|c|\in\{3,...,197\}" text="absolute-value@(c) element-of set@(3, ldots, 197)" xml:id="S5.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S5.SS2.p1.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p1.m1.1">c</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS2.p1.m1.2"/>
                    <XMRef idref="S5.SS2.p1.m1.3"/>
                    <XMRef idref="S5.SS2.p1.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="3" role="NUMBER" xml:id="S5.SS2.p1.m1.2">3</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S5.SS2.p1.m1.3">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="197" role="NUMBER" xml:id="S5.SS2.p1.m1.4">197</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and the number of target pixels <Math mode="inline" tex="|t|\in\{3,...,200-|c|\}" text="absolute-value@(t) element-of set@(3, ldots, 200 - absolute-value@(c))" xml:id="S5.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S5.SS2.p1.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p1.m2.1">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS2.p1.m2.2"/>
                    <XMRef idref="S5.SS2.p1.m2.3"/>
                    <XMRef idref="S5.SS2.p1.m2.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="3" role="NUMBER" xml:id="S5.SS2.p1.m2.2">3</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S5.SS2.p1.m2.3">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.SS2.p1.m2.5">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="200" role="NUMBER">200</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="S5.SS2.p1.m2.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p1.m2.4">c</XMTok>
                          <XMTok role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> from an image. For evaluation, we uniformly sample the number of context pixels <Math mode="inline" tex="|c|\in\{3,...,197\}" text="absolute-value@(c) element-of set@(3, ldots, 197)" xml:id="S5.SS2.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S5.SS2.p1.m3.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p1.m3.1">c</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS2.p1.m3.2"/>
                    <XMRef idref="S5.SS2.p1.m3.3"/>
                    <XMRef idref="S5.SS2.p1.m3.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="3" role="NUMBER" xml:id="S5.SS2.p1.m3.2">3</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S5.SS2.p1.m3.3">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="197" role="NUMBER" xml:id="S5.SS2.p1.m3.4">197</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and set all the remaining pixels as the targets. <ref labelref="LABEL:table/main_image" show="creftype~refnum"/> clearly demonstrates that our model outperforms the baselines over all three datasets, demonstrating the effectiveness of our method for high-dimensional image data. See <ref labelref="LABEL:app:sec:additional_experiments" show="creftype~refnum"/> for the visualizations of completed images along with the uncertainties in terms of predictive variances, and <ref labelref="LABEL:app:sec:details" show="creftype~refnum"/> for the detailed training setup.</p>
      </para>
<!--  %Next we conducted 2D image completion tasks for 3 different datasets (MNIST, SVHN, CelebA). 
     %We trained all models for 100 epochs. For each training task, we uniformly sample the number of contexts $—c—“in “–3,...,197“˝$ and number of targets $—t—“in “–3,...,200-—c—“˝$ from an image. For evaluation, for a test image, 
     %we first uniformly sample the number of contexts $—c—“in “–3, “dots, 197“˝$, and set all the remaining points as the targets. “cref–table/main˙image˝ shows that our model outperforms the baselines over all three datasets, demonstrating the effectiveness of our method for high-dimensional image data. Please refer to “cref–app:sec:additional˙experiments˝ for the visualizations of completed images along with the uncertainties in terms of predictive variances. 
     %“begin–table˝[t] 
     %“caption–Image completion task for MNIST and CIFAR10 dataset. We use $n˙c “in“–3,...,197“˝$ context points and $n˙t “in “–3,“ldots, 200-n˙c“˝$ target points.“Todo–Performances are measured over 4 seeds.˝˝ 
     %“label–tab:table˙2d˝ 
     %“centering 
     %“scriptsize 
     %“resizebox–“textwidth˝–!˝– 
     %**** experiments.tex Line 125 **** 
     %“begin–tabular˝–lrrrr˝ 
     %“toprule 
     %Dataset             &amp;               &amp; MNIST         &amp;               &amp; CIFAR10    ““ 
     %“midrule 
     %&amp; context       &amp; target        &amp; context       &amp; target     ““ 
     %“midrule 
     %AttnCNP              &amp; $1.366“pm–0˝$ &amp; $0.675“pm–0˝$ &amp; $“textbf–4.135˝“pm–0˝$ &amp; $2.223“pm–0˝$““ 
     %AttnBNP              &amp; $0.725“pm–0˝$ &amp; $0.662“pm–0˝$ &amp; $“textbf–4.135˝“pm–0˝$ &amp; $2.370“pm–0˝$““ 
     %AttnNeuBNP           &amp; $1.225“pm–0˝$ &amp; $0.767“pm–0˝$ &amp; $3.842“pm–0˝$ &amp; $2.488“pm–0˝$““ 
     %Ours                 &amp; $“textbf–1.371˝“pm–0˝$ &amp; $“textbf–0.899˝“pm–0˝$ &amp; $4.126“pm–0˝$ &amp; $“textbf–2.623˝“pm–0˝$““ 
     %“bottomrule 
     %“end–tabular˝ 
     %“begin–tabular˝–lrrrr˝ 
     %“toprule 
     %Dataset              &amp;               &amp; MNIST         &amp;               &amp; CIFAR10   ““ 
     %“midrule 
     %&amp; context       &amp; target        &amp; context       &amp; target     ““ 
     %“midrule 
     %CNP                  &amp; $1.113“pm–0˝$ &amp; $0.761“pm–0˝$ &amp; $2.725“pm–0˝$ &amp; $1.809“pm–0˝$““ 
     %BNP                  &amp; $1.059“pm–0˝$ &amp; $0.838“pm–0˝$ &amp; $2.734“pm–0˝$ &amp; $2.215“pm–0˝$““ 
     %NeuBNP               &amp; $1.076“pm–0˝$ &amp; $0.822“pm–0˝$ &amp; $2.857“pm–0˝$ &amp; $2.231“pm–0˝$““ 
     %Ours                 &amp; $“textbf–1.142˝“pm–0˝$ &amp; $“textbf–0.923˝“pm–0˝$ &amp; $“textbf–3.041˝“pm–0˝$ &amp; $“textbf–2.496˝“pm–0˝$““        “bottomrule 
     %“end–tabular˝˝ 
     %“end–table˝ -->    </subsection>
    <subsection inlist="toc" labels="LABEL:main:sec:experiments:bo" xml:id="S5.SS3">
      <tags>
        <tag>5.3</tag>
        <tag role="autoref">subsection 5.3</tag>
        <tag role="refnum">5.3</tag>
        <tag role="typerefnum">§5.3</tag>
      </tags>
      <title><tag close=" ">5.3</tag>Bayesian Optimization</title>
      <para xml:id="S5.SS3.p1">
        <p>Using pre-trained models with RBF kernels in <ref labelref="LABEL:main:subsec:infinite_training" show="creftype~refnum"/> Infinite Training Dataset experiments, we conducted Bayesian optimization <cite class="ltx_citemacro_citep">[<bibref bibrefs="brochu2010tutorial" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite> for two benchmark functions <cite class="ltx_citemacro_citep">[<bibref bibrefs="gramacy2012cases,sobester2008engineering" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>. As a performance measurement, we use best simple regret, which measures the difference between the current best value and the global optimum value. <ref labelref="LABEL:figure/main_bo_gram" show="creftype~refnum"/> depicts the normalized regret and the cumulative normalized regret averaged over 100 trials of the <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function.
Here, we also consider a <ERROR class="undefined">\gls</ERROR>gp variant with RBF kernel, tuned by pre-training <cite class="ltx_citemacro_citep">[<bibref bibrefs="wang2021automatic" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>.
It clearly demonstrates that our model shows the best performance among <ERROR class="undefined">\glspl</ERROR>np for both the normalized regret and the cumulative normalized regret. <ref labelref="LABEL:app:sec:additional_experiments:bo" show="creftype~refnum"/> provides the results for the <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function and <ref labelref="LABEL:app:sec:details:bo" show="creftype~refnum"/> provides detailed experimental setups.</p>
      </para>
      <figure inlist="lof" labels="LABEL:figure/main_bo_gram" xml:id="S5.F4">
        <tags>
          <tag><text fontsize="90%">Figure 4</text></tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <graphics candidates="figure/main_bo_gram_np.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/main_bo_gram_np" options="width=212.47617pt,keepaspectratio=true" xml:id="S5.F4.g1"/>
        <graphics candidates="figure/main_bo_gram_anp.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/main_bo_gram_anp" options="width=212.47617pt,keepaspectratio=true" xml:id="S5.F4.g2"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>Results for Bayesian optimization on <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function; we measured normalized simple regret and its cumulative value for a iteration. All models are pre-trained on 1D regression task generated with RBF kernel (cf. <ref labelref="LABEL:main:sec:experiments:1dregression" show="creftype~refnum"/>) and evaluated on the benchmark function for Bayesian optimization.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 4</text></tag><text fontsize="90%">Results for Bayesian optimization on <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function; we measured normalized simple regret and its cumulative value for a iteration. All models are pre-trained on 1D regression task generated with RBF kernel (cf. <ref labelref="LABEL:main:sec:experiments:1dregression" show="creftype~refnum"/>) and evaluated on the benchmark function for Bayesian optimization.</text></caption>
      </figure>
<!--  %“begin–figure˝[t] 
     %“centering 
     %“includegraphics[width=0.95“textwidth]–figure/BO.png˝ 
     %“caption–Results for Bayesian optimization with RBF kernel. Here we used 50 iterations for each model and report the means and standard deviations of minimum simple regret and cumulative simple regret for each iteration. The first and the second figure present the minimum simple regret for the models. The third and the forth figure present the cumulative simple regret for the models.˝ 
     %“label–fig:figure˙BO˝ 
     %“end–figure˝ 
     %We conducted Bayesian optimization~“citep–brochu2010tutorial˝ with tasks sampled from a “gls–gp˝ prior with RBF kernels. 
     %**** experiments.tex Line 175 **** 
     %We used pretrained models with RBF kernels in “cref–main:subsec:infinite˙training˝ Infinite Training Dataset experiments. 
     %In Bayesian optimization, we use best simple regret, which measures the difference between current best value and the global optimum value, as a performance measurement. 
     %Following “citet–lee2020bootstrapping˝, we evaluate the best simple regret and the cumulative best simple regret for 100 tasks. 
     %We used same fixed tasks and normalized initial minimum simple regret for the fare comparison among various models. 
     %In “cref–fig:figure˙BO˝, one can see that our model shows the best performance for both the best simple regret and especially on the cumulative best simple regret. -->    </subsection>
    <subsection inlist="toc" labels="LABEL:main:subsec:predator-prey" xml:id="S5.SS4">
      <tags>
        <tag>5.4</tag>
        <tag role="autoref">subsection 5.4</tag>
        <tag role="refnum">5.4</tag>
        <tag role="typerefnum">§5.4</tag>
      </tags>
      <title><tag close=" ">5.4</tag>Predator-Prey Model</title>
      <para xml:id="S5.SS4.p1">
        <p>Following <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2020bootstrapping" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>, we conducted the predator-prey population regression experiments. We first trained the models using the simulation datasets which are generated from a Lotka-Volterra model <cite class="ltx_citemacro_citep">[<bibref bibrefs="wilkinson2018stochastic" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite> with the simulation settings followed by <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2020bootstrapping" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>. Then tested on the generated simulation test dataset and real-world dataset which is called Hudson’s Bay hare-lynx data. As mentioned in <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2020bootstrapping" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>, the real-world dataset shows different tendency from generated simulation datasets, so we can treat this experiment as model-data mismatch experiments. In <ref labelref="LABEL:table/main_lv" show="creftype~refnum"/>, we can see the <ERROR class="undefined">\glspl</ERROR>mpnp outperform the other baselines for the test simulation datasets but underperforms in the real-world dataset compare to other baselines. This shows that model-data mismatch is an open problem for the <ERROR class="undefined">\glspl</ERROR>mpnp.</p>
      </para>
      <table inlist="lot" labels="LABEL:table/main_lv" placement="t" xml:id="S5.T3">
        <tags>
          <tag><text fontsize="90%">Table 3</text></tag>
          <tag role="autoref">Table 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Table 3</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>Test results for predator-prey population regression tasks on Lotka-Volterra simulated data and real data. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 3</text></tag><text fontsize="90%">Test results for predator-prey population regression tasks on Lotka-Volterra simulated data and real data. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</text></caption>
        <inline-block align="center" depth="0.0pt" height="144.5pt" width="346.9pt" xscale="0.802743845286554" xtranslate="-42.6pt" yscale="0.802743845286554" ytranslate="17.8pt">
          <tabular class="ltx_guessed_headers" vattach="middle">
            <tbody>
              <tr>
                <td border="tt" thead="row"/>
                <td align="center" border="tt" colspan="3">Simulated data</td>
                <td align="center" border="tt" colspan="3">Real data</td>
              </tr>
              <tr>
                <td align="left" thead="row">Model</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
              </tr>
              <tr>
                <td align="left" border="t" thead="row">CNP</td>
                <td align="right" border="t">0.327<Math mode="inline" tex="\scriptstyle{\pm 0.036}" text="plus-or-minus 0.036" xml:id="S5.T3.m1">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.036" role="NUMBER">0.036</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.035<Math mode="inline" tex="\scriptstyle{\pm 0.029}" text="plus-or-minus 0.029" xml:id="S5.T3.m2">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.029" role="NUMBER">0.029</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.181<Math mode="inline" tex="\scriptstyle{\pm 0.032}" text="plus-or-minus 0.032" xml:id="S5.T3.m3">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.032" role="NUMBER">0.032</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-2.686<Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="S5.T3.m4">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-3.201<Math mode="inline" tex="\scriptstyle{\pm 0.042}" text="plus-or-minus 0.042" xml:id="S5.T3.m5">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.042" role="NUMBER">0.042</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-3.000<Math mode="inline" tex="\scriptstyle{\pm 0.034}" text="plus-or-minus 0.034" xml:id="S5.T3.m6">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.034" role="NUMBER">0.034</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">NP</td>
                <td align="right">0.112<Math mode="inline" tex="\scriptstyle{\pm 0.063}" text="plus-or-minus 0.063" xml:id="S5.T3.m7">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.063" role="NUMBER">0.063</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.115<Math mode="inline" tex="\scriptstyle{\pm 0.057}" text="plus-or-minus 0.057" xml:id="S5.T3.m8">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.057" role="NUMBER">0.057</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.000<Math mode="inline" tex="\scriptstyle{\pm 0.060}" text="plus-or-minus 0.060" xml:id="S5.T3.m9">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.060" role="NUMBER">0.060</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-2.770<Math mode="inline" tex="\scriptstyle{\pm 0.028}" text="plus-or-minus 0.028" xml:id="S5.T3.m10">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.028" role="NUMBER">0.028</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-3.144<Math mode="inline" tex="\scriptstyle{\pm 0.031}" text="plus-or-minus 0.031" xml:id="S5.T3.m11">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.031" role="NUMBER">0.031</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-2.993<Math mode="inline" tex="\scriptstyle{\pm 0.029}" text="plus-or-minus 0.029" xml:id="S5.T3.m12">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.029" role="NUMBER">0.029</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">BNP</td>
                <td align="right">0.550<Math mode="inline" tex="\scriptstyle{\pm 0.057}" text="plus-or-minus 0.057" xml:id="S5.T3.m13">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.057" role="NUMBER">0.057</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.274<Math mode="inline" tex="\scriptstyle{\pm 0.042}" text="plus-or-minus 0.042" xml:id="S5.T3.m14">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.042" role="NUMBER">0.042</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.417<Math mode="inline" tex="\scriptstyle{\pm 0.050}" text="plus-or-minus 0.050" xml:id="S5.T3.m15">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.050" role="NUMBER">0.050</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-2.614</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.050}" text="plus-or-minus 0.050" xml:id="S5.T3.m16">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.050" role="NUMBER">0.050</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-3.052</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.022}" text="plus-or-minus 0.022" xml:id="S5.T3.m17">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.022" role="NUMBER">0.022</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-2.868</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="S5.T3.m18">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">MPNP (ours)</text></p>
                  </inline-block></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.626</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.041}" text="plus-or-minus 0.041" xml:id="S5.T3.m19">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.041" role="NUMBER">0.041</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.375</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.036}" text="plus-or-minus 0.036" xml:id="S5.T3.m20">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.036" role="NUMBER">0.036</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.500</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.038}" text="plus-or-minus 0.038" xml:id="S5.T3.m21">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.038" role="NUMBER">0.038</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-2.621<Math mode="inline" tex="\scriptstyle{\pm 0.072}" text="plus-or-minus 0.072" xml:id="S5.T3.m22">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.072" role="NUMBER">0.072</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-3.092<Math mode="inline" tex="\scriptstyle{\pm 0.054}" text="plus-or-minus 0.054" xml:id="S5.T3.m23">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.054" role="NUMBER">0.054</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-2.918<Math mode="inline" tex="\scriptstyle{\pm 0.061}" text="plus-or-minus 0.061" xml:id="S5.T3.m24">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.061" role="NUMBER">0.061</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" border="t" thead="row">CANP</td>
                <td align="right" border="t">0.689<Math mode="inline" tex="\scriptstyle{\pm 0.046}" text="plus-or-minus 0.046" xml:id="S5.T3.m25">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.046" role="NUMBER">0.046</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">1.615<Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="S5.T3.m26">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">1.023<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T3.m27">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-4.743<Math mode="inline" tex="\scriptstyle{\pm 1.119}" text="plus-or-minus 1.119" xml:id="S5.T3.m28">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="1.119" role="NUMBER">1.119</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-6.413<Math mode="inline" tex="\scriptstyle{\pm 0.339}" text="plus-or-minus 0.339" xml:id="S5.T3.m29">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.339" role="NUMBER">0.339</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-5.801<Math mode="inline" tex="\scriptstyle{\pm 0.733}" text="plus-or-minus 0.733" xml:id="S5.T3.m30">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.733" role="NUMBER">0.733</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">ANP</td>
                <td align="right">2.607<Math mode="inline" tex="\scriptstyle{\pm 0.015}" text="plus-or-minus 0.015" xml:id="S5.T3.m31">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.015" role="NUMBER">0.015</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.830<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="S5.T3.m32">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.234<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="S5.T3.m33">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.887<Math mode="inline" tex="\scriptstyle{\pm 0.078}" text="plus-or-minus 0.078" xml:id="S5.T3.m34">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.078" role="NUMBER">0.078</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-4.848<Math mode="inline" tex="\scriptstyle{\pm 0.385}" text="plus-or-minus 0.385" xml:id="S5.T3.m35">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.385" role="NUMBER">0.385</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-1.615<Math mode="inline" tex="\scriptstyle{\pm 0.188}" text="plus-or-minus 0.188" xml:id="S5.T3.m36">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.188" role="NUMBER">0.188</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">BANP</td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.654</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="S5.T3.m37">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.797<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="S5.T3.m38">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">2.240<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T3.m39">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.190</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.062}" text="plus-or-minus 0.062" xml:id="S5.T3.m40">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.062" role="NUMBER">0.062</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-3.597</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.279}" text="plus-or-minus 0.279" xml:id="S5.T3.m41">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.279" role="NUMBER">0.279</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.741</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.160}" text="plus-or-minus 0.160" xml:id="S5.T3.m42">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.160" role="NUMBER">0.160</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">MPANP (ours)</text></p>
                  </inline-block></td>
                <td align="right" border="bb">2.639<Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="S5.T3.m43">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.835</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="S5.T3.m44">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">2.254</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="S5.T3.m45">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb">1.995<Math mode="inline" tex="\scriptstyle{\pm 0.145}" text="plus-or-minus 0.145" xml:id="S5.T3.m46">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.145" role="NUMBER">0.145</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb">-5.073<Math mode="inline" tex="\scriptstyle{\pm 0.680}" text="plus-or-minus 0.680" xml:id="S5.T3.m47">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.680" role="NUMBER">0.680</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb">-1.690<Math mode="inline" tex="\scriptstyle{\pm 0.401}" text="plus-or-minus 0.401" xml:id="S5.T3.m48">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.401" role="NUMBER">0.401</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
            </tbody>
          </tabular>
        </inline-block>
      </table>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:main:sec:conclusion" xml:id="S6">
    <tags>
      <tag>6</tag>
      <tag role="autoref">section 6</tag>
      <tag role="refnum">6</tag>
      <tag role="typerefnum">§6</tag>
    </tags>
    <title><tag close=" ">6</tag>Conclusion</title>
    <para xml:id="S6.p1">
      <p>In this paper, we proposed a novel extension of <ERROR class="undefined">\glspl</ERROR>np by taking a new approach to model the functional uncertainty for <ERROR class="undefined">\glspl</ERROR>np.
The proposed model <ERROR class="undefined">\gls</ERROR>mpnp utilizes the martingale posterior distribution <cite class="ltx_citemacro_citep">[<bibref bibrefs="fong2021martingale" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>,
where the functional uncertainty is driven from the uncertainty of future data generated from the joint predictive.
We present a simple architecture satisfying the theoretical requirements of the martingale posterior, and propose a training scheme to properly train it. We empirically validate <ERROR class="undefined">\glspl</ERROR>mpnp on various tasks, where our method consistently outperforms the baselines.</p>
    </para>
    <paragraph inlist="toc" xml:id="S6.SS0.SSS0.Px1">
      <title>Limitation</title>
      <para xml:id="S6.SS0.SSS0.Px1.p1">
        <p>As we presented in the <text font="bold">Predator-Prey Model</text> experiments in <ref labelref="LABEL:main:subsec:predator-prey" show="creftype~refnum"/>,
our method did not significantly outperform baselines under model-data mismatch. This was also higlighted in <cite class="ltx_citemacro_citet"><bibref bibrefs="fong2021martingale" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>: model-data mismatch under the martingale posterior framework remains an open problem.
Our method with direct input generation also performed poorly, as we found it difficult to prevent models from generating meaningless inputs that are ignored by the decoders. We present more details on unsuccessful attempts for direct input generation in <ref labelref="LABEL:app:sec:directly_generating_input" show="creftype~refnum"/>.</p>
      </para>
      <pagination role="newpage"/>
      <pagination role="newpage"/>
    </paragraph>
    <paragraph inlist="toc" xml:id="S6.SS0.SSS0.Px2">
      <title>Societal Impacts</title>
      <para xml:id="S6.SS0.SSS0.Px2.p1">
        <p>Our work is unlikely to bring any negative societal impacts. Modeling functional uncertainty may be related to the discussion of safe AI within the community.</p>
      </para>
    </paragraph>
    <paragraph inlist="toc" xml:id="S6.SS0.SSS0.Px3">
      <title>Reproducibility Statement</title>
      <para xml:id="S6.SS0.SSS0.Px3.p1">
        <p>We argued our experimental details in <ref labelref="LABEL:app:sec:details" show="creftype~refnum"/> which contains used libraries and hardwares.
We presented all the dataset description in <ref labelref="LABEL:app:sec:details" show="creftype~refnum"/>.
We describes the model architecture details in <ref labelref="LABEL:app:sec:architectures" show="creftype~refnum"/>.</p>
      </para>
    </paragraph>
  </section>
  <section xml:id="Sx1">
    <title>Acknowledgements</title>
    <para xml:id="Sx1.p1">
      <p>This work was partly supported by Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT)
(No.2019-0-00075, Artificial Intelligence Graduate School Program(KAIST)), Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2022-0-00713), and Institute of Information &amp; communications Technology Planning &amp; Evaluation (IITP) grant funded by the Korea government(MSIT) (No.2021-0-02068, Artificial Intelligence Innovation Hub).</p>
    </para>
  </section>
  <bibliography citestyle="authoryear" files="references" xml:id="bib">
    <title>References</title>
  </bibliography>
  <pagination role="newpage"/>
  <pagination role="newpage"/>
<!--  %**** paper.tex Line 75 **** -->  <appendix inlist="toc" labels="LABEL:app:sec:architectures" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Model Architectures</title>
    <toctitle><tag close=" ">A</tag>Model Architectures</toctitle>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->    <figure inlist="lof" labels="LABEL:figure/main_concept_mpanp" placement="t" xml:id="A1.F5">
      <tags>
        <tag><text fontsize="90%">Figure 5</text></tag>
        <tag role="autoref">Figure 5</tag>
        <tag role="refnum">5</tag>
        <tag role="typerefnum">Figure 5</tag>
      </tags>
      <graphics candidates="figure/main_concept_mpanp.pdf" class="ltx_centering" graphic="figure/main_concept_mpanp.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A1.F5.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">5</tag>Concept figure of our feature generating model applied to <ERROR class="undefined">\gls</ERROR>canp <cite class="ltx_citemacro_citep">[<bibref bibrefs="kim2018attentive" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>. Here we sample <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="A1.F5.m1">
          <XMath>
            <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
          </XMath>
        </Math> from a simple distribution (e.g. Gaussian). We generate key feature <Math mode="inline" tex="R_{k}^{\prime}" text="(R _ k) ^ prime" xml:id="A1.F5.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
            </XMApp>
          </XMath>
        </Math> and value feature <Math mode="inline" tex="R_{v}^{\prime}" text="(R _ v) ^ prime" xml:id="A1.F5.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
              </XMApp>
              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
            </XMApp>
          </XMath>
        </Math> for cross attention layer which are corresponding to pseudo context data. We use generator as one layer <ERROR class="undefined">\gls</ERROR>isab <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> in our experiment.
</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 5</text></tag><text fontsize="90%">Concept figure of our feature generating model applied to <ERROR class="undefined">\gls</ERROR>canp <cite class="ltx_citemacro_citep">[<bibref bibrefs="kim2018attentive" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite>. Here we sample <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="A1.F5.m4">
            <XMath>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
            </XMath>
          </Math> from a simple distribution (e.g. Gaussian). We generate key feature <Math mode="inline" tex="R_{k}^{\prime}" text="(R _ k) ^ prime" xml:id="A1.F5.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> and value feature <Math mode="inline" tex="R_{v}^{\prime}" text="(R _ v) ^ prime" xml:id="A1.F5.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> for cross attention layer which are corresponding to pseudo context data. We use generator as one layer <ERROR class="undefined">\gls</ERROR>isab <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>]</cite> in our experiment.
</text></caption>
    </figure>
    <para xml:id="A1.p1">
      <p>In this section, we summarize the model architectures which we used in experiments.
Here, we only present simplified structures for each model.
To see exact computation procedures for <ERROR class="undefined">\glspl</ERROR>bnp, please refer to <cite class="ltx_citemacro_citet"><bibref bibrefs="lee2020bootstrapping" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>[</bibrefphrase>
            <bibrefphrase>]</bibrefphrase>
          </bibref></cite>. <ref labelref="LABEL:figure/main_concept_mpanp" show="creftype~refnum"/> shows our method applying to <ERROR class="undefined">\gls</ERROR>canp model <cite class="ltx_citemacro_citep">[<bibref bibrefs="kim2018attentive" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>.</p>
    </para>
<!--  %To see exact computation procedures for “glspl–bnp˝ and “glspl–neubnp˝, please refer to “citet–lee2020bootstrapping˝ and “citet–lee2022neural˝ respectively. -->    <subsection inlist="toc" xml:id="A1.SS1">
      <tags>
        <tag>A.1</tag>
        <tag role="autoref">subsection A.1</tag>
        <tag role="refnum">A.1</tag>
        <tag role="typerefnum">§A.1</tag>
      </tags>
      <title><tag close=" ">A.1</tag>Modules</title>
      <paragraph inlist="toc" xml:id="A1.SS1.SSS0.Px1">
        <title>Linear Layer</title>
        <para xml:id="A1.SS1.SSS0.Px1.p1">
          <p><Math mode="inline" tex="\text{Lin}(d_{\text{in}},d_{\text{out}})" text="[Lin] * open-interval@(d _ [in], d _ [out])" xml:id="A1.SS1.SSS0.Px1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Lin</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px1.p1.m1.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px1.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px1.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">in</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px1.p1.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> denotes the linear transformation of the input with dimension <Math mode="inline" tex="d_{\text{in}}" text="d _ [in]" xml:id="A1.SS1.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMText><text fontsize="70%">in</text></XMText>
                </XMApp>
              </XMath>
            </Math> into the output with dimension <Math mode="inline" tex="d_{\text{out}}" text="d _ [out]" xml:id="A1.SS1.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMText><text fontsize="70%">out</text></XMText>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS1.SSS0.Px2">
        <title>Multi-Layer Perceptron</title>
        <para xml:id="A1.SS1.SSS0.Px2.p1">
          <p><Math mode="inline" tex="\text{MLP}(n_{l},d_{\text{in}},d_{\text{hid}},d_{\text{out}})" text="[MLP] * vector@(n _ l, d _ [in], d _ [hid], d _ [out])" xml:id="A1.SS1.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>MLP</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="A1.SS1.SSS0.Px2.p1.m1.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px2.p1.m1.2"/>
                      <XMRef idref="A1.SS1.SSS0.Px2.p1.m1.3"/>
                      <XMRef idref="A1.SS1.SSS0.Px2.p1.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px2.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px2.p1.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">in</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px2.p1.m1.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">hid</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px2.p1.m1.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><!--  %**** architectures.tex Line 25 **** --> denotes a multi-layer perceptron with the structure:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx20">
            <equation xml:id="A1.Ex4">
              <MathFork>
                <Math tex="\displaystyle\text{MLP}(n_{l},d_{\text{in}},d_{\text{hid}},d_{\text{out}})=%&#10;\text{Lin}(d_{\text{hid}},d_{\text{out}})\circ(\text{ReLU}\circ\text{Lin}(d_{%&#10;\text{hid}},d_{\text{hid}}))^{n_{l}-2}\circ\text{ReLU}\circ\text{Lin}(d_{\text%&#10;{in}},d_{\text{hid}})," text="[MLP] * vector@(n _ l, d _ [in], d _ [hid], d _ [out]) = (([Lin] * open-interval@(d _ [hid], d _ [out])) compose (([ReLU] compose [Lin]) * open-interval@(d _ [hid], d _ [hid])) ^ (n _ l - 2) compose [ReLU] compose [Lin]) * open-interval@(d _ [in], d _ [hid])" xml:id="A1.Ex4.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex4.m2.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex4.m2.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="A1.Ex4.m2.1.1"/>
                                <XMRef idref="A1.Ex4.m2.1.2"/>
                                <XMRef idref="A1.Ex4.m2.1.3"/>
                                <XMRef idref="A1.Ex4.m2.1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex4.m2.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex4.m2.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">in</text></XMText>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex4.m2.1.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">hid</text></XMText>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex4.m2.1.4">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">out</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok meaning="compose" name="circ" role="MULOP">∘</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>Lin</XMText>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.Ex4.m2.1.5"/>
                                    <XMRef idref="A1.Ex4.m2.1.6"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex4.m2.1.5">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">hid</text></XMText>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex4.m2.1.6">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">out</text></XMText>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMRef idref="A1.Ex4.m2.1.7"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex4.m2.1.7">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok meaning="compose" name="circ" role="MULOP">∘</XMTok>
                                        <XMText>ReLU</XMText>
                                        <XMText>Lin</XMText>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A1.Ex4.m2.1.7.1"/>
                                          <XMRef idref="A1.Ex4.m2.1.7.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.Ex4.m2.1.7.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">hid</text></XMText>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex4.m2.1.7.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">hid</text></XMText>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">l</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMText>ReLU</XMText>
                              <XMText>Lin</XMText>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex4.m2.1.8"/>
                                <XMRef idref="A1.Ex4.m2.1.9"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex4.m2.1.8">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">in</text></XMText>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex4.m2.1.9">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">hid</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\text{MLP}(n_{l},d_{\text{in}},d_{\text{hid}},d_{\text{out}})=%&#10;\text{Lin}(d_{\text{hid}},d_{\text{out}})\circ(\text{ReLU}\circ\text{Lin}(d_{%&#10;\text{hid}},d_{\text{hid}}))^{n_{l}-2}\circ\text{ReLU}\circ\text{Lin}(d_{\text%&#10;{in}},d_{\text{hid}})," text="[MLP] * vector@(n _ l, d _ [in], d _ [hid], d _ [out]) = (([Lin] * open-interval@(d _ [hid], d _ [out])) compose (([ReLU] compose [Lin]) * open-interval@(d _ [hid], d _ [hid])) ^ (n _ l - 2) compose [ReLU] compose [Lin]) * open-interval@(d _ [in], d _ [hid])" xml:id="A1.Ex4.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex4.m1.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex4.m1.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="vector"/>
                                    <XMRef idref="A1.Ex4.m1.1.1"/>
                                    <XMRef idref="A1.Ex4.m1.1.2"/>
                                    <XMRef idref="A1.Ex4.m1.1.3"/>
                                    <XMRef idref="A1.Ex4.m1.1.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex4.m1.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex4.m1.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">in</text></XMText>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex4.m1.1.3">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">hid</text></XMText>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex4.m1.1.4">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">out</text></XMText>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok meaning="compose" name="circ" role="MULOP">∘</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>Lin</XMText>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.Ex4.m1.1.5"/>
                                        <XMRef idref="A1.Ex4.m1.1.6"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex4.m1.1.5">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMText><text fontsize="70%">hid</text></XMText>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex4.m1.1.6">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMText><text fontsize="70%">out</text></XMText>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMRef idref="A1.Ex4.m1.1.7"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex4.m1.1.7">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok meaning="compose" name="circ" role="MULOP">∘</XMTok>
                                            <XMText>ReLU</XMText>
                                            <XMText>Lin</XMText>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A1.Ex4.m1.1.7.1"/>
                                              <XMRef idref="A1.Ex4.m1.1.7.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.Ex4.m1.1.7.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.Ex4.m1.1.7.2">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMText>ReLU</XMText>
                                  <XMText>Lin</XMText>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.Ex4.m1.1.8"/>
                                    <XMRef idref="A1.Ex4.m1.1.9"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex4.m1.1.8">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">in</text></XMText>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex4.m1.1.9">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">hid</text></XMText>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <text class="ltx_markedasmath">ReLU</text> denotes the element-wise Rectified Linear Unit (ReLU) activation function.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS1.SSS0.Px3">
        <title>Multi-Head Attention</title>
        <para xml:id="A1.SS1.SSS0.Px3.p1">
          <p><Math mode="inline" tex="\text{MHA}(n_{\text{head}},d_{\text{out}})(Q,K,V)" text="[MHA] * open-interval@(n _ [head], d _ [out]) * vector@(Q, K, V)" xml:id="A1.SS1.SSS0.Px3.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>MHA</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m1.4"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m1.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMText><text fontsize="70%">head</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m1.5">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m1.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m1.2"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m1.1">Q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m1.2">K</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m1.3">V</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> denotes a multi-head attention <cite class="ltx_citemacro_citep">[<bibref bibrefs="vaswani2017attention" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> with <Math mode="inline" tex="n_{\text{head}}" text="n _ [head]" xml:id="A1.SS1.SSS0.Px3.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMText><text fontsize="70%">head</text></XMText>
                </XMApp>
              </XMath>
            </Math> heads which takes input as <Math mode="inline" tex="(Q,K,V)" text="vector@(Q, K, V)" xml:id="A1.SS1.SSS0.Px3.p1.m3">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m3.1"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m3.2"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m3.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m3.1">Q</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m3.2">K</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m3.3">V</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> and outputs the feature with dimension <Math mode="inline" tex="d_{\text{out}}" text="d _ [out]" xml:id="A1.SS1.SSS0.Px3.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMText><text fontsize="70%">out</text></XMText>
                </XMApp>
              </XMath>
            </Math>.
The actual computation of <Math mode="inline" tex="\text{MHA}(n_{\text{head}},d_{\text{out}})(Q,K,V)" text="[MHA] * open-interval@(n _ [head], d _ [out]) * vector@(Q, K, V)" xml:id="A1.SS1.SSS0.Px3.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>MHA</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m5.4"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m5.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m5.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMText><text fontsize="70%">head</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m5.5">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m5.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m5.2"/>
                      <XMRef idref="A1.SS1.SSS0.Px3.p1.m5.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m5.1">Q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m5.2">K</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m5.3">V</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> can be written as follows:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx21">
            <equation xml:id="A1.Ex5">
              <MathFork>
                <Math tex="\displaystyle(Q_{i}^{\prime})_{i=1}^{n_{\text{head}}}=\text{split}(\text{Lin}(%&#10;d_{q},d_{\text{out}})(Q),n_{\text{head}})" text="(((Q _ i) ^ prime) _ (i = 1)) ^ (n _ [head]) = [split] * open-interval@([Lin] * open-interval@(d _ q, d _ [out]) * Q, n _ [head])" xml:id="A1.Ex5.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMRef idref="A1.Ex5.m3.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex5.m3.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="50%">head</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>split</XMText>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex5.m3.3"/>
                            <XMRef idref="A1.Ex5.m3.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex5.m3.3">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>Lin</XMText>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.Ex5.m3.3.1"/>
                                  <XMRef idref="A1.Ex5.m3.3.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex5.m3.3.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.Ex5.m3.3.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMText><text fontsize="70%">out</text></XMText>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMDual>
                                <XMRef idref="A1.Ex5.m3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.1">Q</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex5.m3.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              <XMText><text fontsize="70%">head</text></XMText>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(Q_{i}^{\prime})_{i=1}^{n_{\text{head}}}" text="(((Q _ i) ^ prime) _ (i = 1)) ^ (n _ [head])" xml:id="A1.Ex5.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMRef idref="A1.Ex5.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex5.m1.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMText><text fontsize="50%">head</text></XMText>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{split}(\text{Lin}(d_{q},d_{\text{out}})(Q),n_{\text{head}})" text="absent = [split] * open-interval@([Lin] * open-interval@(d _ q, d _ [out]) * Q, n _ [head])" xml:id="A1.Ex5.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>split</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex5.m2.2"/>
                                <XMRef idref="A1.Ex5.m2.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex5.m2.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>Lin</XMText>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex5.m2.2.1"/>
                                      <XMRef idref="A1.Ex5.m2.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex5.m2.2.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex5.m2.2.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMDual>
                                    <XMRef idref="A1.Ex5.m2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.1">Q</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex5.m2.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMText><text fontsize="70%">head</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex6">
              <MathFork>
                <Math tex="\displaystyle(K_{i}^{\prime})_{i=1}^{n_{\text{head}}}=\text{split}(\text{Lin}(%&#10;d_{k},d_{\text{out}})(K),n_{\text{head}})" text="(((K _ i) ^ prime) _ (i = 1)) ^ (n _ [head]) = [split] * open-interval@([Lin] * open-interval@(d _ k, d _ [out]) * K, n _ [head])" xml:id="A1.Ex6.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMRef idref="A1.Ex6.m3.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex6.m3.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="50%">head</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>split</XMText>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex6.m3.3"/>
                            <XMRef idref="A1.Ex6.m3.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex6.m3.3">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>Lin</XMText>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.Ex6.m3.3.1"/>
                                  <XMRef idref="A1.Ex6.m3.3.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex6.m3.3.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.Ex6.m3.3.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMText><text fontsize="70%">out</text></XMText>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMDual>
                                <XMRef idref="A1.Ex6.m3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex6.m3.1">K</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex6.m3.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              <XMText><text fontsize="70%">head</text></XMText>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(K_{i}^{\prime})_{i=1}^{n_{\text{head}}}" text="(((K _ i) ^ prime) _ (i = 1)) ^ (n _ [head])" xml:id="A1.Ex6.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMRef idref="A1.Ex6.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex6.m1.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMText><text fontsize="50%">head</text></XMText>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{split}(\text{Lin}(d_{k},d_{\text{out}})(K),n_{\text{head}})" text="absent = [split] * open-interval@([Lin] * open-interval@(d _ k, d _ [out]) * K, n _ [head])" xml:id="A1.Ex6.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>split</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex6.m2.2"/>
                                <XMRef idref="A1.Ex6.m2.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex6.m2.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>Lin</XMText>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex6.m2.2.1"/>
                                      <XMRef idref="A1.Ex6.m2.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex6.m2.2.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex6.m2.2.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMDual>
                                    <XMRef idref="A1.Ex6.m2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex6.m2.1">K</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex6.m2.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMText><text fontsize="70%">head</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex7">
              <MathFork>
                <Math tex="\displaystyle(V_{i}^{\prime})_{i=1}^{n_{\text{head}}}=\text{split}(\text{Lin}(%&#10;d_{v},d_{\text{out}})(V),n_{\text{head}})" text="(((V _ i) ^ prime) _ (i = 1)) ^ (n _ [head]) = [split] * open-interval@([Lin] * open-interval@(d _ v, d _ [out]) * V, n _ [head])" xml:id="A1.Ex7.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMRef idref="A1.Ex7.m3.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex7.m3.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="50%">head</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>split</XMText>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex7.m3.3"/>
                            <XMRef idref="A1.Ex7.m3.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex7.m3.3">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>Lin</XMText>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.Ex7.m3.3.1"/>
                                  <XMRef idref="A1.Ex7.m3.3.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex7.m3.3.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.Ex7.m3.3.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMText><text fontsize="70%">out</text></XMText>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMDual>
                                <XMRef idref="A1.Ex7.m3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex7.m3.1">V</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex7.m3.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              <XMText><text fontsize="70%">head</text></XMText>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(V_{i}^{\prime})_{i=1}^{n_{\text{head}}}" text="(((V _ i) ^ prime) _ (i = 1)) ^ (n _ [head])" xml:id="A1.Ex7.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMRef idref="A1.Ex7.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex7.m1.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMText><text fontsize="50%">head</text></XMText>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{split}(\text{Lin}(d_{v},d_{\text{out}})(V),n_{\text{head}})" text="absent = [split] * open-interval@([Lin] * open-interval@(d _ v, d _ [out]) * V, n _ [head])" xml:id="A1.Ex7.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>split</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex7.m2.2"/>
                                <XMRef idref="A1.Ex7.m2.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex7.m2.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>Lin</XMText>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex7.m2.2.1"/>
                                      <XMRef idref="A1.Ex7.m2.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex7.m2.2.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex7.m2.2.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMDual>
                                    <XMRef idref="A1.Ex7.m2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex7.m2.1">V</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex7.m2.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMText><text fontsize="70%">head</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex8">
              <MathFork>
                <Math tex="\displaystyle H=\text{concat}([\text{softmax}(Q_{i}^{\prime}K_{i}^{\prime\top}%&#10;/\sqrt{d_{\text{out}}})V_{i}^{\prime}]_{i=1}^{n_{\text{head}}})" text="H = [concat] * ((delimited-[]@([softmax] * (((Q _ i) ^ prime * (K _ i) ^ (list@(prime1, top))) / square-root@(d _ [out])) * (V _ i) ^ prime)) _ (i = 1)) ^ (n _ [head])" xml:id="A1.Ex8.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>concat</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex8.m3.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex8.m3.3">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A1.Ex8.m3.3.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A1.Ex8.m3.3.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMText>softmax</XMText>
                                      <XMDual>
                                        <XMRef idref="A1.Ex8.m3.3.1.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.Ex8.m3.3.1.1">
                                            <XMTok meaning="divide" role="MULOP">/</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="list"/>
                                                    <XMRef idref="A1.Ex8.m3.2"/>
                                                    <XMRef idref="A1.Ex8.m3.1"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok name="prime1" role="SUPOP" xml:id="A1.Ex8.m3.2">′</XMTok>
                                                    <XMTok role="PUNCT">⁣</XMTok>
                                                    <XMTok fontsize="70%" meaning="top" role="ADDOP" xml:id="A1.Ex8.m3.1">⊤</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="square-root"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                <XMText><text fontsize="50%">head</text></XMText>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle H" text="H" xml:id="A1.Ex8.m1">
                      <XMath>
                        <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{concat}([\text{softmax}(Q_{i}^{\prime}K_{i}^{\prime\top}/%&#10;\sqrt{d_{\text{out}}})V_{i}^{\prime}]_{i=1}^{n_{\text{head}}})" text="absent = [concat] * ((delimited-[]@([softmax] * (((Q _ i) ^ prime * (K _ i) ^ (list@(prime1, top))) / square-root@(d _ [out])) * (V _ i) ^ prime)) _ (i = 1)) ^ (n _ [head])" xml:id="A1.Ex8.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>concat</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex8.m2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex8.m2.3">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-[]"/>
                                        <XMRef idref="A1.Ex8.m2.3.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                                        <XMApp xml:id="A1.Ex8.m2.3.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMText>softmax</XMText>
                                          <XMDual>
                                            <XMRef idref="A1.Ex8.m2.3.1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.Ex8.m2.3.1.1">
                                                <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    </XMApp>
                                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="list"/>
                                                        <XMRef idref="A1.Ex8.m2.2"/>
                                                        <XMRef idref="A1.Ex8.m2.1"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok name="prime1" role="SUPOP" xml:id="A1.Ex8.m2.2">′</XMTok>
                                                        <XMTok role="PUNCT">⁣</XMTok>
                                                        <XMTok fontsize="70%" meaning="top" role="ADDOP" xml:id="A1.Ex8.m2.1">⊤</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="square-root"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                    <XMText><text fontsize="50%">head</text></XMText>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex9">
              <MathFork>
                <Math tex="\displaystyle O=\text{LN}(Q^{\prime}+H)" text="O = [LN] * (Q ^ prime + H)" xml:id="A1.Ex9.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>LN</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex9.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex9.m3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">H</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle O" text="O" xml:id="A1.Ex9.m1">
                      <XMath>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{LN}(Q^{\prime}+H)" text="absent = [LN] * (Q ^ prime + H)" xml:id="A1.Ex9.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>LN</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex9.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex9.m2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex10">
              <MathFork>
                <Math tex="\displaystyle\text{MHA}(n_{\text{head}},d_{\text{out}})(Q,K,V)=\text{LN}(O+%&#10;\text{ReLU}(\text{Lin}(d_{\text{out}},d_{\text{out}})(O)))" text="[MHA] * open-interval@(n _ [head], d _ [out]) * vector@(Q, K, V) = [LN] * (O + [ReLU] * [Lin] * open-interval@(d _ [out], d _ [out]) * O)" xml:id="A1.Ex10.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>MHA</XMText>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex10.m3.5"/>
                            <XMRef idref="A1.Ex10.m3.6"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex10.m3.5">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              <XMText><text fontsize="70%">head</text></XMText>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex10.m3.6">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              <XMText><text fontsize="70%">out</text></XMText>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="vector"/>
                            <XMRef idref="A1.Ex10.m3.1"/>
                            <XMRef idref="A1.Ex10.m3.2"/>
                            <XMRef idref="A1.Ex10.m3.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m3.1">Q</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m3.2">K</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m3.3">V</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>LN</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex10.m3.7"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex10.m3.7">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok font="italic" role="UNKNOWN">O</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>ReLU</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex10.m3.7.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex10.m3.7.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMText>Lin</XMText>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A1.Ex10.m3.7.1.1"/>
                                          <XMRef idref="A1.Ex10.m3.7.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.Ex10.m3.7.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex10.m3.7.1.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMDual>
                                        <XMRef idref="A1.Ex10.m3.4"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m3.4">O</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\text{MHA}(n_{\text{head}},d_{\text{out}})(Q,K,V)" text="[MHA] * open-interval@(n _ [head], d _ [out]) * vector@(Q, K, V)" xml:id="A1.Ex10.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText>MHA</XMText>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex10.m1.4"/>
                              <XMRef idref="A1.Ex10.m1.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex10.m1.4">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                <XMText><text fontsize="70%">head</text></XMText>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex10.m1.5">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMText><text fontsize="70%">out</text></XMText>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="A1.Ex10.m1.1"/>
                              <XMRef idref="A1.Ex10.m1.2"/>
                              <XMRef idref="A1.Ex10.m1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m1.1">Q</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m1.2">K</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m1.3">V</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{LN}(O+\text{ReLU}(\text{Lin}(d_{\text{out}},d_{\text{out}}%&#10;)(O)))" text="absent = [LN] * (O + [ReLU] * [Lin] * open-interval@(d _ [out], d _ [out]) * O)" xml:id="A1.Ex10.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>LN</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex10.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex10.m2.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>ReLU</XMText>
                                    <XMDual>
                                      <XMRef idref="A1.Ex10.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex10.m2.2.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMText>Lin</XMText>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A1.Ex10.m2.2.1.1"/>
                                              <XMRef idref="A1.Ex10.m2.2.1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.Ex10.m2.2.1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.Ex10.m2.2.1.2">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMDual>
                                            <XMRef idref="A1.Ex10.m2.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex10.m2.1">O</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="(d_{q},d_{k},d_{v})" text="vector@(d _ q, d _ k, d _ v)" xml:id="A1.SS1.SSS0.Px3.p1.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m6.1"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m6.2"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m6.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m6.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m6.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS1.SSS0.Px3.p1.m6.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> denotes the dimension of <Math mode="inline" tex="Q,K,V" text="list@(Q, K, V)" xml:id="A1.SS1.SSS0.Px3.p1.m7">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m7.1"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m7.2"/>
                    <XMRef idref="A1.SS1.SSS0.Px3.p1.m7.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m7.1">Q</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m7.2">K</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px3.p1.m7.3">V</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> respectively, <text class="ltx_markedasmath">split</text> and <text class="ltx_markedasmath">concat</text> are the splitting and concatenating <Math mode="inline" tex="A" text="A" xml:id="A1.SS1.SSS0.Px3.p1.m10">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
              </XMath>
            </Math> in the feature dimension respectively, and <text class="ltx_markedasmath">LN</text> denotes the layer normalization <cite class="ltx_citemacro_citep">[<bibref bibrefs="ba2016layer" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS1.SSS0.Px4">
        <title>Self-Attention</title>
        <para xml:id="A1.SS1.SSS0.Px4.p1">
          <p><Math mode="inline" tex="\text{SA}(n_{\text{head}},d_{\text{out}})" text="[SA] * open-interval@(n _ [head], d _ [out])" xml:id="A1.SS1.SSS0.Px4.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>SA</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px4.p1.m1.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px4.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px4.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMText><text fontsize="70%">head</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px4.p1.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> denotes a self-attention module which is simply computed as <Math mode="inline" tex="\text{SA}(n_{\text{head}},d_{\text{out}})(X)=\text{MHA}(n_{\text{head}},d_{%&#10;\text{out}})(X,X,X)" text="[SA] * open-interval@(n _ [head], d _ [out]) * X = [MHA] * open-interval@(n _ [head], d _ [out]) * vector@(X, X, X)" xml:id="A1.SS1.SSS0.Px4.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText>SA</XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.5"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.6"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px4.p1.m2.5">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="70%">head</text></XMText>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px4.p1.m2.6">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMText><text fontsize="70%">out</text></XMText>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px4.p1.m2.1">X</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText>MHA</XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.7"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.8"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px4.p1.m2.7">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="70%">head</text></XMText>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px4.p1.m2.8">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMText><text fontsize="70%">out</text></XMText>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="vector"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.2"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.3"/>
                        <XMRef idref="A1.SS1.SSS0.Px4.p1.m2.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px4.p1.m2.2">X</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px4.p1.m2.3">X</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px4.p1.m2.4">X</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS1.SSS0.Px5">
        <title>Multi-head Attention Block</title>
        <para xml:id="A1.SS1.SSS0.Px5.p1">
          <p><Math mode="inline" tex="\text{MAB}(n_{\text{head}},d_{\text{out}})" text="[MAB] * open-interval@(n _ [head], d _ [out])" xml:id="A1.SS1.SSS0.Px5.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>MAB</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px5.p1.m1.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px5.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px5.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMText><text fontsize="70%">head</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px5.p1.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> denotes a multi-head attention block module <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> which is simply computed as <Math mode="inline" tex="\text{MAB}(n_{\text{head}},d_{\text{out}})(X,Y)=\text{MHA}(n_{\text{head}},d_{%&#10;\text{out}})(X,Y,Y)" text="[MAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(X, Y) = [MHA] * open-interval@(n _ [head], d _ [out]) * vector@(X, Y, Y)" xml:id="A1.SS1.SSS0.Px5.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText>MAB</XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.6"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.7"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px5.p1.m2.6">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="70%">head</text></XMText>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px5.p1.m2.7">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMText><text fontsize="70%">out</text></XMText>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.1"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px5.p1.m2.1">X</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px5.p1.m2.2">Y</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText>MHA</XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.8"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.9"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px5.p1.m2.8">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMText><text fontsize="70%">head</text></XMText>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.SS1.SSS0.Px5.p1.m2.9">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMText><text fontsize="70%">out</text></XMText>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="vector"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.3"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.4"/>
                        <XMRef idref="A1.SS1.SSS0.Px5.p1.m2.5"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px5.p1.m2.3">X</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px5.p1.m2.4">Y</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px5.p1.m2.5">Y</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS1.SSS0.Px6">
        <title>Induced Set Attention Block</title>
        <para xml:id="A1.SS1.SSS0.Px6.p1">
          <p><Math mode="inline" tex="\text{ISAB}(n_{\text{head}},d_{\text{out}})" text="[ISAB] * open-interval@(n _ [head], d _ [out])" xml:id="A1.SS1.SSS0.Px6.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>ISAB</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px6.p1.m1.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px6.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px6.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMText><text fontsize="70%">head</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px6.p1.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> denotes a induced set attention block <cite class="ltx_citemacro_citep">[<bibref bibrefs="lee2019set" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> which constructed with two stacked <text class="ltx_markedasmath">MAB</text> layers.
The actual computation of <Math mode="inline" tex="\text{ISAB}(n_{\text{head}},d_{\text{out}})(X,Y)" text="[ISAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(X, Y)" xml:id="A1.SS1.SSS0.Px6.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>ISAB</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px6.p1.m3.3"/>
                      <XMRef idref="A1.SS1.SSS0.Px6.p1.m3.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px6.p1.m3.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMText><text fontsize="70%">head</text></XMText>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS1.SSS0.Px6.p1.m3.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMText><text fontsize="70%">out</text></XMText>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS1.SSS0.Px6.p1.m3.1"/>
                      <XMRef idref="A1.SS1.SSS0.Px6.p1.m3.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px6.p1.m3.1">X</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.SSS0.Px6.p1.m3.2">Y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> can be written as follows:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx22">
            <equation xml:id="A1.Ex11">
              <MathFork>
                <Math tex="\displaystyle H=\text{MAB}(n_{\text{head}},d_{\text{out}})(Y,X)" text="H = [MAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(Y, X)" xml:id="A1.Ex11.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>MAB</XMText>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex11.m3.3"/>
                            <XMRef idref="A1.Ex11.m3.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex11.m3.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              <XMText><text fontsize="70%">head</text></XMText>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex11.m3.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              <XMText><text fontsize="70%">out</text></XMText>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex11.m3.1"/>
                            <XMRef idref="A1.Ex11.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex11.m3.1">Y</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex11.m3.2">X</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle H" text="H" xml:id="A1.Ex11.m1">
                      <XMath>
                        <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MAB}(n_{\text{head}},d_{\text{out}})(Y,X)" text="absent = [MAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(Y, X)" xml:id="A1.Ex11.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MAB</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex11.m2.3"/>
                                <XMRef idref="A1.Ex11.m2.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex11.m2.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMText><text fontsize="70%">head</text></XMText>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex11.m2.4">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">out</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex11.m2.1"/>
                                <XMRef idref="A1.Ex11.m2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex11.m2.1">Y</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex11.m2.2">X</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex12">
              <MathFork>
                <Math tex="\displaystyle\text{ISAB}(n_{\text{head}},d_{\text{out}})(X,Y)=\text{MAB}(n_{%&#10;\text{head}},d_{\text{out}})(X,H)." text="[ISAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(X, Y) = [MAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(X, H)" xml:id="A1.Ex12.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex12.m3.5"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex12.m3.5">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>ISAB</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex12.m3.5.1"/>
                                <XMRef idref="A1.Ex12.m3.5.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex12.m3.5.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMText><text fontsize="70%">head</text></XMText>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex12.m3.5.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">out</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex12.m3.1"/>
                                <XMRef idref="A1.Ex12.m3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m3.1">X</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m3.2">Y</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MAB</XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex12.m3.5.3"/>
                                <XMRef idref="A1.Ex12.m3.5.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex12.m3.5.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  <XMText><text fontsize="70%">head</text></XMText>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex12.m3.5.4">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMText><text fontsize="70%">out</text></XMText>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex12.m3.3"/>
                                <XMRef idref="A1.Ex12.m3.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m3.3">X</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m3.4">H</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\text{ISAB}(n_{\text{head}},d_{\text{out}})(X,Y)" text="[ISAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(X, Y)" xml:id="A1.Ex12.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText>ISAB</XMText>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex12.m1.3"/>
                              <XMRef idref="A1.Ex12.m1.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex12.m1.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                <XMText><text fontsize="70%">head</text></XMText>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex12.m1.4">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMText><text fontsize="70%">out</text></XMText>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex12.m1.1"/>
                              <XMRef idref="A1.Ex12.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m1.1">X</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m1.2">Y</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MAB}(n_{\text{head}},d_{\text{out}})(X,H)." text="absent = [MAB] * open-interval@(n _ [head], d _ [out]) * open-interval@(X, H)" xml:id="A1.Ex12.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex12.m2.3"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex12.m2.3">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MAB</XMText>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.Ex12.m2.3.1"/>
                                    <XMRef idref="A1.Ex12.m2.3.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex12.m2.3.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                      <XMText><text fontsize="70%">head</text></XMText>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex12.m2.3.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMText><text fontsize="70%">out</text></XMText>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.Ex12.m2.1"/>
                                    <XMRef idref="A1.Ex12.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m2.1">X</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex12.m2.2">H</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS2">
      <tags>
        <tag>A.2</tag>
        <tag role="autoref">subsection A.2</tag>
        <tag role="refnum">A.2</tag>
        <tag role="typerefnum">§A.2</tag>
      </tags>
      <title><tag close=" ">A.2</tag><ERROR class="undefined">\gls</ERROR>cnp, <ERROR class="undefined">\gls</ERROR>np, <ERROR class="undefined">\gls</ERROR>bnp, <ERROR class="undefined">\gls</ERROR>neubnp and <ERROR class="undefined">\gls</ERROR>mpnp</title>
      <paragraph inlist="toc" xml:id="A1.SS2.SSS0.Px1">
        <title>Encoder</title>
        <para xml:id="A1.SS2.SSS0.Px1.p1">
          <p>The models only with a deterministic encoder (<ERROR class="undefined">\gls</ERROR>cnp, <ERROR class="undefined">\gls</ERROR>bnp, <ERROR class="undefined">\gls</ERROR>mpnp) use the following structure:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx23">
            <equation xml:id="A1.Ex13">
              <MathFork>
                <Math tex="\displaystyle r_{c}=\frac{1}{|c|}\sum_{i\in c}\text{MLP}(n_{l}=5,d_{\text{in}}%&#10;=d_{z},d_{\text{hid}}=128,d_{\text{out}}=128)(z_{i})," text="r _ c = (1 / absolute-value@(c)) * (sum _ (i element-of c))@([MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * z _ i)" xml:id="A1.Ex13.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex13.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex13.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="A1.Ex13.m3.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex13.m3.1">c</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex13.m3.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex13.m3.2.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex13.m3.2.1.1"/>
                                        <XMRef idref="A1.Ex13.m3.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex13.m3.2.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="5" role="NUMBER">5</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex13.m3.2.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex13.m3.2.1.2.1"/>
                                            <XMRef idref="A1.Ex13.m3.2.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex13.m3.2.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex13.m3.2.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex13.m3.2.1.2.2.1"/>
                                                <XMRef idref="A1.Ex13.m3.2.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex13.m3.2.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex13.m3.2.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex13.m3.2.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex13.m3.2.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{c}" text="r _ c" xml:id="A1.Ex13.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\frac{1}{|c|}\sum_{i\in c}\text{MLP}(n_{l}=5,d_{\text{in}}=d_{z}%&#10;,d_{\text{hid}}=128,d_{\text{out}}=128)(z_{i})," text="absent = (1 / absolute-value@(c)) * (sum _ (i element-of c))@([MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * z _ i)" xml:id="A1.Ex13.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex13.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex13.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="A1.Ex13.m2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex13.m2.1">c</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>MLP</XMText>
                                    <XMDual>
                                      <XMRef idref="A1.Ex13.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMDual xml:id="A1.Ex13.m2.2.1">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex13.m2.2.1.1"/>
                                            <XMRef idref="A1.Ex13.m2.2.1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex13.m2.2.1.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                              </XMApp>
                                              <XMTok meaning="5" role="NUMBER">5</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex13.m2.2.1.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex13.m2.2.1.2.1"/>
                                                <XMRef idref="A1.Ex13.m2.2.1.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex13.m2.2.1.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">in</text></XMText>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMDual xml:id="A1.Ex13.m2.2.1.2.2">
                                                  <XMApp>
                                                    <XMTok meaning="formulae"/>
                                                    <XMRef idref="A1.Ex13.m2.2.1.2.2.1"/>
                                                    <XMRef idref="A1.Ex13.m2.2.1.2.2.2"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMApp xml:id="A1.Ex13.m2.2.1.2.2.1">
                                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="70%">hid</text></XMText>
                                                      </XMApp>
                                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMApp xml:id="A1.Ex13.m2.2.1.2.2.2">
                                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="70%">out</text></XMText>
                                                      </XMApp>
                                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    </XMApp>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMRef idref="A1.Ex13.m2.2.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex13.m2.2.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex14">
              <MathFork>
                <Math tex="\displaystyle f_{\text{enc}}(Z_{c})=r_{c}." text="f _ [enc] * Z _ c = r _ c" xml:id="A1.Ex14.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex14.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex14.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMText><text fontsize="70%">enc</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.Ex14.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex14.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{enc}}(Z_{c})" text="f _ [enc] * Z _ c" xml:id="A1.Ex14.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">enc</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.Ex14.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex14.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=r_{c}." text="absent = r _ c" xml:id="A1.Ex14.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex14.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex14.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>For the <ERROR class="undefined">\gls</ERROR>mpnp, <Math mode="inline" tex="f_{\text{enc}}(Z_{c})" text="f _ [enc] * Z _ c" xml:id="A1.SS2.SSS0.Px1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMText><text fontsize="70%">enc</text></XMText>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> changes into <Math mode="inline" tex="\text{concat}([r_{c},r_{c}^{\prime}])" text="[concat] * closed-interval@(r _ c, (r _ c) ^ prime)" xml:id="A1.SS2.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>concat</XMText>
                  <XMDual>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m2.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMDual xml:id="A1.SS2.SSS0.Px1.p1.m2.1">
                        <XMApp>
                          <XMTok meaning="closed-interval"/>
                          <XMRef idref="A1.SS2.SSS0.Px1.p1.m2.1.1"/>
                          <XMRef idref="A1.SS2.SSS0.Px1.p1.m2.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m2.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m2.1.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> where <Math mode="inline" tex="r_{c}^{\prime}" text="(r _ c) ^ prime" xml:id="A1.SS2.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> is the feature of the pseudo context data generated from generator in paragraph <text font="bold">Generator</text>.
The model also with a latent encoder (<ERROR class="undefined">\gls</ERROR>np) uses:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx24">
            <equation xml:id="A1.Ex15">
              <MathFork>
                <Math tex="\displaystyle r_{c}=\frac{1}{|c|}\sum_{i\in c}\text{MLP}(n_{l}=5,d_{\text{in}}%&#10;=d_{z},d_{\text{hid}}=128,d_{\text{out}}=128)(z_{i})," text="r _ c = (1 / absolute-value@(c)) * (sum _ (i element-of c))@([MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * z _ i)" xml:id="A1.Ex15.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex15.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex15.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="A1.Ex15.m3.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex15.m3.1">c</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex15.m3.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex15.m3.2.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex15.m3.2.1.1"/>
                                        <XMRef idref="A1.Ex15.m3.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex15.m3.2.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="5" role="NUMBER">5</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex15.m3.2.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex15.m3.2.1.2.1"/>
                                            <XMRef idref="A1.Ex15.m3.2.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex15.m3.2.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex15.m3.2.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex15.m3.2.1.2.2.1"/>
                                                <XMRef idref="A1.Ex15.m3.2.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex15.m3.2.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex15.m3.2.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex15.m3.2.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex15.m3.2.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{c}" text="r _ c" xml:id="A1.Ex15.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\frac{1}{|c|}\sum_{i\in c}\text{MLP}(n_{l}=5,d_{\text{in}}=d_{z}%&#10;,d_{\text{hid}}=128,d_{\text{out}}=128)(z_{i})," text="absent = (1 / absolute-value@(c)) * (sum _ (i element-of c))@([MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * z _ i)" xml:id="A1.Ex15.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex15.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex15.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="A1.Ex15.m2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex15.m2.1">c</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>MLP</XMText>
                                    <XMDual>
                                      <XMRef idref="A1.Ex15.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMDual xml:id="A1.Ex15.m2.2.1">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex15.m2.2.1.1"/>
                                            <XMRef idref="A1.Ex15.m2.2.1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex15.m2.2.1.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                              </XMApp>
                                              <XMTok meaning="5" role="NUMBER">5</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex15.m2.2.1.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex15.m2.2.1.2.1"/>
                                                <XMRef idref="A1.Ex15.m2.2.1.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex15.m2.2.1.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">in</text></XMText>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMDual xml:id="A1.Ex15.m2.2.1.2.2">
                                                  <XMApp>
                                                    <XMTok meaning="formulae"/>
                                                    <XMRef idref="A1.Ex15.m2.2.1.2.2.1"/>
                                                    <XMRef idref="A1.Ex15.m2.2.1.2.2.2"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMApp xml:id="A1.Ex15.m2.2.1.2.2.1">
                                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="70%">hid</text></XMText>
                                                      </XMApp>
                                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMApp xml:id="A1.Ex15.m2.2.1.2.2.2">
                                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="70%">out</text></XMText>
                                                      </XMApp>
                                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    </XMApp>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMRef idref="A1.Ex15.m2.2.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex15.m2.2.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex16">
              <MathFork>
                <Math tex="\displaystyle(m_{c},\log s_{c})=\frac{1}{|c|}\sum_{i\in c}\text{MLP}(n_{l}=2,d%&#10;_{\text{in}}=d_{z},d_{\text{hid}}=128,d_{\text{out}}=128\times 2)(z_{i})," text="open-interval@(m _ c, logarithm@(s _ c)) = (1 / absolute-value@(c)) * (sum _ (i element-of c))@([MLP] * formulae@(n _ l = 2, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128 * 2))) * z _ i)" xml:id="A1.Ex16.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex16.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex16.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex16.m3.2.1"/>
                              <XMRef idref="A1.Ex16.m3.2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex16.m3.2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex16.m3.2.2">
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="A1.Ex16.m3.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex16.m3.1">c</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex16.m3.2.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex16.m3.2.3">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex16.m3.2.3.1"/>
                                        <XMRef idref="A1.Ex16.m3.2.3.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex16.m3.2.3.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex16.m3.2.3.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex16.m3.2.3.2.1"/>
                                            <XMRef idref="A1.Ex16.m3.2.3.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex16.m3.2.3.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex16.m3.2.3.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex16.m3.2.3.2.2.1"/>
                                                <XMRef idref="A1.Ex16.m3.2.3.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex16.m3.2.3.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex16.m3.2.3.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                                    <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex16.m3.2.4"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex16.m3.2.4">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(m_{c},\log s_{c})" text="open-interval@(m _ c, logarithm@(s _ c))" xml:id="A1.Ex16.m1">
                      <XMath>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex16.m1.1"/>
                            <XMRef idref="A1.Ex16.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex16.m1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">m</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex16.m1.2">
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\frac{1}{|c|}\sum_{i\in c}\text{MLP}(n_{l}=2,d_{\text{in}}=d_{z}%&#10;,d_{\text{hid}}=128,d_{\text{out}}=128\times 2)(z_{i})," text="absent = (1 / absolute-value@(c)) * (sum _ (i element-of c))@([MLP] * formulae@(n _ l = 2, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128 * 2))) * z _ i)" xml:id="A1.Ex16.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex16.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex16.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="A1.Ex16.m2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex16.m2.1">c</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>MLP</XMText>
                                    <XMDual>
                                      <XMRef idref="A1.Ex16.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMDual xml:id="A1.Ex16.m2.2.1">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex16.m2.2.1.1"/>
                                            <XMRef idref="A1.Ex16.m2.2.1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex16.m2.2.1.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                              </XMApp>
                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex16.m2.2.1.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex16.m2.2.1.2.1"/>
                                                <XMRef idref="A1.Ex16.m2.2.1.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex16.m2.2.1.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">in</text></XMText>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMDual xml:id="A1.Ex16.m2.2.1.2.2">
                                                  <XMApp>
                                                    <XMTok meaning="formulae"/>
                                                    <XMRef idref="A1.Ex16.m2.2.1.2.2.1"/>
                                                    <XMRef idref="A1.Ex16.m2.2.1.2.2.2"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMApp xml:id="A1.Ex16.m2.2.1.2.2.1">
                                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="70%">hid</text></XMText>
                                                      </XMApp>
                                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMApp xml:id="A1.Ex16.m2.2.1.2.2.2">
                                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                        <XMText><text fontsize="70%">out</text></XMText>
                                                      </XMApp>
                                                      <XMApp>
                                                        <XMTok meaning="times" role="MULOP">×</XMTok>
                                                        <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMRef idref="A1.Ex16.m2.2.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex16.m2.2.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex17">
              <MathFork>
                <Math tex="\displaystyle s_{c}=0.1+0.9\cdot\text{softplus}(\log s_{c})," text="s _ c = 0.1 + (0.9 cdot [softplus]) * logarithm@(s _ c)" xml:id="A1.Ex17.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex17.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex17.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                <XMText>softplus</XMText>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A1.Ex17.m3.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex17.m3.1.1">
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle s_{c}" text="s _ c" xml:id="A1.Ex17.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=0.1+0.9\cdot\text{softplus}(\log s_{c})," text="absent = 0.1 + (0.9 cdot [softplus]) * logarithm@(s _ c)" xml:id="A1.Ex17.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex17.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex17.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                    <XMText>softplus</XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.Ex17.m2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex17.m2.1.1">
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex18">
              <MathFork>
                <Math tex="\displaystyle h_{c}={\mathcal{N}}(m_{c},s^{2}_{c}I_{h})," text="h _ c = N * open-interval@(m _ c, (s ^ 2) _ c * I _ h)" xml:id="A1.Ex18.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex18.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex18.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex18.m3.1.1"/>
                                <XMRef idref="A1.Ex18.m3.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex18.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex18.m3.1.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle h_{c}" text="h _ c" xml:id="A1.Ex18.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle={\mathcal{N}}(m_{c},s^{2}_{c}I_{h})," text="absent = N * open-interval@(m _ c, (s ^ 2) _ c * I _ h)" xml:id="A1.Ex18.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex18.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex18.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.Ex18.m2.1.1"/>
                                    <XMRef idref="A1.Ex18.m2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex18.m2.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex18.m2.1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex19">
              <MathFork>
                <Math tex="\displaystyle f_{\text{enc}}(Z_{c})=[r_{c};h_{c}]," text="f _ [enc] * Z _ c = list@(r _ c, h _ c)" xml:id="A1.Ex19.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex19.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex19.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMText><text fontsize="70%">enc</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.Ex19.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex19.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A1.Ex19.m3.1.2"/>
                              <XMRef idref="A1.Ex19.m3.1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="A1.Ex19.m3.1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">;</XMTok>
                              <XMApp xml:id="A1.Ex19.m3.1.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{enc}}(Z_{c})" text="f _ [enc] * Z _ c" xml:id="A1.Ex19.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">enc</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.Ex19.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex19.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=[r_{c};h_{c}]," text="absent = list@(r _ c, h _ c)" xml:id="A1.Ex19.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex19.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex19.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="A1.Ex19.m2.1.1"/>
                                  <XMRef idref="A1.Ex19.m2.1.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                                  <XMApp xml:id="A1.Ex19.m2.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">;</XMTok>
                                  <XMApp xml:id="A1.Ex19.m2.1.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="d_{z}=d_{x}+d_{y}" text="d _ z = d _ x + d _ y" xml:id="A1.SS2.SSS0.Px1.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">y</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> denotes the data dimension.
Data dimensions vary through tasks, <Math mode="inline" tex="d_{x}=1,d_{y}=1" text="formulae@(d _ x = 1, d _ y = 1)" xml:id="A1.SS2.SSS0.Px1.p1.m5">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m5.1"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m5.1">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m5.2">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">y</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for 1D regression tasks, <Math mode="inline" tex="d_{x}=2,d_{y}=1" text="formulae@(d _ x = 2, d _ y = 1)" xml:id="A1.SS2.SSS0.Px1.p1.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m6.1"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m6.1">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m6.2">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">y</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for MNIST image completion task, <Math mode="inline" tex="d_{x}=2,d_{y}=3" text="formulae@(d _ x = 2, d _ y = 3)" xml:id="A1.SS2.SSS0.Px1.p1.m7">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m7.1"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m7.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m7.1">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m7.2">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">y</XMTok>
                      </XMApp>
                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for SVHN and CelebA image completion tasks, and <Math mode="inline" tex="d_{x}=1,d_{y}=2" text="formulae@(d _ x = 1, d _ y = 2)" xml:id="A1.SS2.SSS0.Px1.p1.m8">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m8.1"/>
                    <XMRef idref="A1.SS2.SSS0.Px1.p1.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m8.1">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS2.SSS0.Px1.p1.m8.2">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">y</XMTok>
                      </XMApp>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> for Lotka Volterra task.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS2.SSS0.Px2">
        <title>Adaptation Layer</title>
        <para xml:id="A1.SS2.SSS0.Px2.p1">
          <ERROR class="undefined">\gls</ERROR>
          <p>bnp uses additional adaptation layer to combine bootstrapped representation and the base representation. This can be done with a simple linear layer</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx25">
            <equation xml:id="A1.E20">
              <tags>
                <tag>(20)</tag>
                <tag role="autoref">Equation 20</tag>
                <tag role="refnum">20</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle\tilde{r}_{c}=\text{Lin}(d_{\text{hid}}=128,d_{\text{hid}}=d_{x}+%&#10;128)(\tilde{r}_{c}^{(pre)})." text="(tilde@(r)) _ c = [Lin] * formulae@(d _ [hid] = 128, d _ [hid] = d _ x + 128) * ((tilde@(r)) _ c) ^ (p * r * e)" xml:id="A1.E20.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.E20.m2.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.E20.m2.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>Lin</XMText>
                            <XMDual>
                              <XMRef idref="A1.E20.m2.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.E20.m2.2.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.E20.m2.2.1.1"/>
                                    <XMRef idref="A1.E20.m2.2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.E20.m2.2.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">hid</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E20.m2.2.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">hid</text></XMText>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok meaning="128" role="NUMBER">128</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.E20.m2.2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E20.m2.2.2">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.E20.m2.1"/>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.E20.m2.1">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\tilde{r}_{c}=\text{Lin}(d_{\text{hid}}=128,d_{\text{hid}}=d_{x}+%&#10;128)(\tilde{r}_{c}^{(pre)})." text="(tilde@(r)) _ c = [Lin] * formulae@(d _ [hid] = 128, d _ [hid] = d _ x + 128) * ((tilde@(r)) _ c) ^ (p * r * e)" xml:id="A1.E20.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.E20.m1.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.E20.m1.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>Lin</XMText>
                                <XMDual>
                                  <XMRef idref="A1.E20.m1.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.E20.m1.2.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.E20.m1.2.1.1"/>
                                        <XMRef idref="A1.E20.m1.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.E20.m1.2.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">hid</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E20.m1.2.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">hid</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                            </XMApp>
                                            <XMTok meaning="128" role="NUMBER">128</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.E20.m1.2.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.E20.m1.2.2">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A1.E20.m1.1"/>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.E20.m1.1">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                                          </XMApp>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS2.SSS0.Px3">
        <title>Decoder</title>
        <para xml:id="A1.SS2.SSS0.Px3.p1">
          <p>All models use a single MLP as a decoder.
The models except <ERROR class="undefined">\gls</ERROR>np uses the following structure:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx26">
            <equation xml:id="A1.Ex20">
              <MathFork>
                <Math tex="\displaystyle(\mu,\log\sigma)=\text{MLP}(n_{l}=3,d_{\text{in}}=d_{x}+128,d_{%&#10;\text{hid}}=128,d_{\text{out}}=2)(\text{concat}([x,r_{c}]))" text="open-interval@(mu, logarithm@(sigma)) = [MLP] * formulae@(n _ l = 3, formulae@(d _ [in] = d _ x + 128, formulae@(d _ [hid] = 128, d _ [out] = 2))) * [concat] * closed-interval@(x, r _ c)" xml:id="A1.Ex20.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.Ex20.m3.1"/>
                          <XMRef idref="A1.Ex20.m3.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex20.m3.1">μ</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex20.m3.3">
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>MLP</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex20.m3.4"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMDual xml:id="A1.Ex20.m3.4">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex20.m3.4.1"/>
                                <XMRef idref="A1.Ex20.m3.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex20.m3.4.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                  </XMApp>
                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMDual xml:id="A1.Ex20.m3.4.2">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex20.m3.4.2.1"/>
                                    <XMRef idref="A1.Ex20.m3.4.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex20.m3.4.2.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">in</text></XMText>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok meaning="128" role="NUMBER">128</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex20.m3.4.2.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex20.m3.4.2.2.1"/>
                                        <XMRef idref="A1.Ex20.m3.4.2.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex20.m3.4.2.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">hid</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex20.m3.4.2.2.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMRef idref="A1.Ex20.m3.5"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex20.m3.5">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>concat</XMText>
                              <XMDual>
                                <XMRef idref="A1.Ex20.m3.5.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMDual xml:id="A1.Ex20.m3.5.1">
                                    <XMApp>
                                      <XMTok meaning="closed-interval"/>
                                      <XMRef idref="A1.Ex20.m3.2"/>
                                      <XMRef idref="A1.Ex20.m3.5.1.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex20.m3.2">x</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex20.m3.5.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(\mu,\log\sigma)" text="open-interval@(mu, logarithm@(sigma))" xml:id="A1.Ex20.m1">
                      <XMath>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex20.m1.1"/>
                            <XMRef idref="A1.Ex20.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex20.m1.1">μ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex20.m1.2">
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=3,d_{\text{in}}=d_{x}+128,d_{\text{hid}}=128,d_%&#10;{\text{out}}=2)(\text{concat}([x,r_{c}]))" text="absent = [MLP] * formulae@(n _ l = 3, formulae@(d _ [in] = d _ x + 128, formulae@(d _ [hid] = 128, d _ [out] = 2))) * [concat] * closed-interval@(x, r _ c)" xml:id="A1.Ex20.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex20.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex20.m2.2">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex20.m2.2.1"/>
                                    <XMRef idref="A1.Ex20.m2.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex20.m2.2.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex20.m2.2.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex20.m2.2.2.1"/>
                                        <XMRef idref="A1.Ex20.m2.2.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex20.m2.2.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                            </XMApp>
                                            <XMTok meaning="128" role="NUMBER">128</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex20.m2.2.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex20.m2.2.2.2.1"/>
                                            <XMRef idref="A1.Ex20.m2.2.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex20.m2.2.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex20.m2.2.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex20.m2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex20.m2.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>concat</XMText>
                                  <XMDual>
                                    <XMRef idref="A1.Ex20.m2.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMDual xml:id="A1.Ex20.m2.3.1">
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="A1.Ex20.m2.1"/>
                                          <XMRef idref="A1.Ex20.m2.3.1.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex20.m2.1">x</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex20.m2.3.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex21">
              <MathFork>
                <Math tex="\displaystyle\sigma=0.1+0.9\cdot\text{softplus}(\log\sigma)," text="sigma = 0.1 + (0.9 cdot [softplus]) * logarithm@(sigma)" xml:id="A1.Ex21.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex21.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex21.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                <XMText>softplus</XMText>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A1.Ex21.m3.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex21.m3.1.1">
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\sigma" text="sigma" xml:id="A1.Ex21.m1">
                      <XMath>
                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=0.1+0.9\cdot\text{softplus}(\log\sigma)," text="absent = 0.1 + (0.9 cdot [softplus]) * logarithm@(sigma)" xml:id="A1.Ex21.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex21.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex21.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                    <XMText>softplus</XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.Ex21.m2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex21.m2.1.1">
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex22">
              <MathFork>
                <Math tex="\displaystyle f_{\text{dec}}(x,r_{c})=(\mu,\sigma)," text="f _ [dec] * open-interval@(x, r _ c) = open-interval@(mu, sigma)" xml:id="A1.Ex22.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex22.m3.4"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex22.m3.4">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMText><text fontsize="70%">dec</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex22.m3.1"/>
                                <XMRef idref="A1.Ex22.m3.4.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex22.m3.1">x</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex22.m3.4.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex22.m3.2"/>
                              <XMRef idref="A1.Ex22.m3.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex22.m3.2">μ</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" name="sigma" role="UNKNOWN" xml:id="A1.Ex22.m3.3">σ</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{dec}}(x,r_{c})" text="f _ [dec] * open-interval@(x, r _ c)" xml:id="A1.Ex22.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">dec</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex22.m1.1"/>
                              <XMRef idref="A1.Ex22.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex22.m1.1">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex22.m1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=(\mu,\sigma)," text="absent = open-interval@(mu, sigma)" xml:id="A1.Ex22.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex22.m2.3"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex22.m2.3">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.Ex22.m2.1"/>
                                  <XMRef idref="A1.Ex22.m2.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex22.m2.1">μ</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" name="sigma" role="UNKNOWN" xml:id="A1.Ex22.m2.2">σ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>and <ERROR class="undefined">\gls</ERROR>np uses:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx27">
            <equation xml:id="A1.Ex23">
              <MathFork>
                <Math tex="\displaystyle(\mu,\log\sigma)=\text{MLP}(n_{l}=3,d_{\text{in}}=d_{x}+128\times&#10;2%&#10;,d_{\text{hid}}=128,d_{\text{out}}=2)(\text{concat}([x,r_{c},h_{c}]))" text="open-interval@(mu, logarithm@(sigma)) = [MLP] * formulae@(n _ l = 3, formulae@(d _ [in] = d _ x + 128 * 2, formulae@(d _ [hid] = 128, d _ [out] = 2))) * [concat] * list@(x, r _ c, h _ c)" xml:id="A1.Ex23.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.Ex23.m3.1"/>
                          <XMRef idref="A1.Ex23.m3.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex23.m3.1">μ</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex23.m3.3">
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>MLP</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex23.m3.4"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMDual xml:id="A1.Ex23.m3.4">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex23.m3.4.1"/>
                                <XMRef idref="A1.Ex23.m3.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex23.m3.4.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                  </XMApp>
                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMDual xml:id="A1.Ex23.m3.4.2">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex23.m3.4.2.1"/>
                                    <XMRef idref="A1.Ex23.m3.4.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex23.m3.4.2.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">in</text></XMText>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">×</XMTok>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex23.m3.4.2.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex23.m3.4.2.2.1"/>
                                        <XMRef idref="A1.Ex23.m3.4.2.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex23.m3.4.2.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">hid</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex23.m3.4.2.2.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMRef idref="A1.Ex23.m3.5"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex23.m3.5">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>concat</XMText>
                              <XMDual>
                                <XMRef idref="A1.Ex23.m3.5.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMDual xml:id="A1.Ex23.m3.5.1">
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A1.Ex23.m3.2"/>
                                      <XMRef idref="A1.Ex23.m3.5.1.1"/>
                                      <XMRef idref="A1.Ex23.m3.5.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex23.m3.2">x</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex23.m3.5.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex23.m3.5.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(\mu,\log\sigma)" text="open-interval@(mu, logarithm@(sigma))" xml:id="A1.Ex23.m1">
                      <XMath>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex23.m1.1"/>
                            <XMRef idref="A1.Ex23.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex23.m1.1">μ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex23.m1.2">
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=3,d_{\text{in}}=d_{x}+128\times 2,d_{\text{hid}%&#10;}=128,d_{\text{out}}=2)(\text{concat}([x,r_{c},h_{c}]))" text="absent = [MLP] * formulae@(n _ l = 3, formulae@(d _ [in] = d _ x + 128 * 2, formulae@(d _ [hid] = 128, d _ [out] = 2))) * [concat] * list@(x, r _ c, h _ c)" xml:id="A1.Ex23.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex23.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex23.m2.2">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex23.m2.2.1"/>
                                    <XMRef idref="A1.Ex23.m2.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex23.m2.2.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="3" role="NUMBER">3</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex23.m2.2.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex23.m2.2.2.1"/>
                                        <XMRef idref="A1.Ex23.m2.2.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex23.m2.2.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">×</XMTok>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex23.m2.2.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex23.m2.2.2.2.1"/>
                                            <XMRef idref="A1.Ex23.m2.2.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex23.m2.2.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex23.m2.2.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex23.m2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex23.m2.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>concat</XMText>
                                  <XMDual>
                                    <XMRef idref="A1.Ex23.m2.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMDual xml:id="A1.Ex23.m2.3.1">
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A1.Ex23.m2.1"/>
                                          <XMRef idref="A1.Ex23.m2.3.1.1"/>
                                          <XMRef idref="A1.Ex23.m2.3.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex23.m2.1">x</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex23.m2.3.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex23.m2.3.1.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex24">
              <MathFork>
                <Math tex="\displaystyle\sigma=0.1+0.9\cdot\text{softplus}(\log\sigma)," text="sigma = 0.1 + (0.9 cdot [softplus]) * logarithm@(sigma)" xml:id="A1.Ex24.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex24.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex24.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                <XMText>softplus</XMText>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A1.Ex24.m3.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex24.m3.1.1">
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\sigma" text="sigma" xml:id="A1.Ex24.m1">
                      <XMath>
                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=0.1+0.9\cdot\text{softplus}(\log\sigma)," text="absent = 0.1 + (0.9 cdot [softplus]) * logarithm@(sigma)" xml:id="A1.Ex24.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex24.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex24.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                    <XMText>softplus</XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.Ex24.m2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex24.m2.1.1">
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex25">
              <MathFork>
                <Math tex="\displaystyle f_{\text{dec}}(x,r_{c},h_{c})=(\mu,\sigma)." text="f _ [dec] * vector@(x, r _ c, h _ c) = open-interval@(mu, sigma)" xml:id="A1.Ex25.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex25.m3.4"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex25.m3.4">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMText><text fontsize="70%">dec</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="A1.Ex25.m3.1"/>
                                <XMRef idref="A1.Ex25.m3.4.1"/>
                                <XMRef idref="A1.Ex25.m3.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex25.m3.1">x</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex25.m3.4.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex25.m3.4.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex25.m3.2"/>
                              <XMRef idref="A1.Ex25.m3.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex25.m3.2">μ</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" name="sigma" role="UNKNOWN" xml:id="A1.Ex25.m3.3">σ</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{dec}}(x,r_{c},h_{c})" text="f _ [dec] * vector@(x, r _ c, h _ c)" xml:id="A1.Ex25.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">dec</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="A1.Ex25.m1.1"/>
                              <XMRef idref="A1.Ex25.m1.2"/>
                              <XMRef idref="A1.Ex25.m1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex25.m1.1">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex25.m1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex25.m1.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=(\mu,\sigma)." text="absent = open-interval@(mu, sigma)" xml:id="A1.Ex25.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex25.m2.3"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex25.m2.3">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.Ex25.m2.1"/>
                                  <XMRef idref="A1.Ex25.m2.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="A1.Ex25.m2.1">μ</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" name="sigma" role="UNKNOWN" xml:id="A1.Ex25.m2.2">σ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS2.SSS0.Px4">
        <title>Generator</title>
        <para xml:id="A1.SS2.SSS0.Px4.p1">
          <ERROR class="undefined">\gls</ERROR>
          <p>mpnp use a single <text class="ltx_markedasmath">ISAB</text> module as a generator. The <text class="ltx_markedasmath">ISAB</text> uses the following structure:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx28">
            <equation xml:id="A1.Ex26">
              <MathFork>
                <Math tex="\displaystyle\epsilon=\text{concat}([\epsilon_{i}]_{i=1}^{n_{\text{gen}}})" text="epsilon = [concat] * ((delimited-[]@(epsilon _ i)) _ (i = 1)) ^ (n _ [gen])" xml:id="A1.Ex26.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>concat</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex26.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex26.m3.1">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A1.Ex26.m3.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A1.Ex26.m3.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                <XMText><text fontsize="50%">gen</text></XMText>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\epsilon" text="epsilon" xml:id="A1.Ex26.m1">
                      <XMath>
                        <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{concat}([\epsilon_{i}]_{i=1}^{n_{\text{gen}}})" text="absent = [concat] * ((delimited-[]@(epsilon _ i)) _ (i = 1)) ^ (n _ [gen])" xml:id="A1.Ex26.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>concat</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex26.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex26.m2.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-[]"/>
                                        <XMRef idref="A1.Ex26.m2.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                                        <XMApp xml:id="A1.Ex26.m2.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                    <XMText><text fontsize="50%">gen</text></XMText>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex27">
              <MathFork>
                <Math tex="\displaystyle r_{c}^{\prime}=\text{ISAB}(n_{\text{head}}=8,d_{\text{out}}=128)%&#10;(\epsilon,r_{c})" text="(r _ c) ^ prime = [ISAB] * formulae@(n _ [head] = 8, d _ [out] = 128) * open-interval@(epsilon, r _ c)" xml:id="A1.Ex27.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>ISAB</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex27.m3.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMDual xml:id="A1.Ex27.m3.2">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex27.m3.2.1"/>
                                <XMRef idref="A1.Ex27.m3.2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex27.m3.2.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                    <XMText><text fontsize="70%">head</text></XMText>
                                  </XMApp>
                                  <XMTok meaning="8" role="NUMBER">8</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex27.m3.2.2">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMText><text fontsize="70%">out</text></XMText>
                                  </XMApp>
                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex27.m3.1"/>
                            <XMRef idref="A1.Ex27.m3.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A1.Ex27.m3.1">ϵ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex27.m3.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{c}^{\prime}" text="(r _ c) ^ prime" xml:id="A1.Ex27.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{ISAB}(n_{\text{head}}=8,d_{\text{out}}=128)(\epsilon,r_{c})" text="absent = [ISAB] * formulae@(n _ [head] = 8, d _ [out] = 128) * open-interval@(epsilon, r _ c)" xml:id="A1.Ex27.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>ISAB</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex27.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex27.m2.2">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex27.m2.2.1"/>
                                    <XMRef idref="A1.Ex27.m2.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex27.m2.2.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex27.m2.2.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex27.m2.1"/>
                                <XMRef idref="A1.Ex27.m2.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A1.Ex27.m2.1">ϵ</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex27.m2.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex28">
              <MathFork>
                <Math tex="\displaystyle f_{\text{gen}}(r_{c})=r_{c}^{\prime}" text="f _ [gen] * r _ c = (r _ c) ^ prime" xml:id="A1.Ex28.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                          <XMText><text fontsize="70%">gen</text></XMText>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.Ex28.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex28.m3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{gen}}(r_{c})" text="f _ [gen] * r _ c" xml:id="A1.Ex28.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">gen</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.Ex28.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex28.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=r_{c}^{\prime}" text="absent = (r _ c) ^ prime" xml:id="A1.Ex28.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="\epsilon_{i}" text="epsilon _ i" xml:id="A1.SS2.SSS0.Px4.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>s are i.i.d. sampled from Gaussian distribution with dimension 128 and <Math mode="inline" tex="n_{\text{gen}}" text="n _ [gen]" xml:id="A1.SS2.SSS0.Px4.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMText><text fontsize="70%">gen</text></XMText>
                </XMApp>
              </XMath>
            </Math> denotes a number of pseudo context data.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS3">
      <tags>
        <tag>A.3</tag>
        <tag role="autoref">subsection A.3</tag>
        <tag role="refnum">A.3</tag>
        <tag role="typerefnum">§A.3</tag>
      </tags>
      <title><tag close=" ">A.3</tag><ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>anp, <ERROR class="undefined">\gls</ERROR>banp and <ERROR class="undefined">\gls</ERROR>mpanp</title>
      <paragraph inlist="toc" xml:id="A1.SS3.SSS0.Px1">
        <title>Encoder</title>
        <para xml:id="A1.SS3.SSS0.Px1.p1">
          <p>The models only with a deterministic encoder (<ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>banp, <ERROR class="undefined">\gls</ERROR>neubanp and <ERROR class="undefined">\gls</ERROR>mpanp) use the following structure:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx29">
            <equation xml:id="A1.Ex29">
              <MathFork>
                <Math tex="\displaystyle r_{q}=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{x},d_{\text{hid}}=128,%&#10;d_{\text{out}}=128)(X)," text="r _ q = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ x, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X" xml:id="A1.Ex29.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex29.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex29.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex29.m3.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex29.m3.2.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex29.m3.2.1.1"/>
                                    <XMRef idref="A1.Ex29.m3.2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex29.m3.2.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="5" role="NUMBER">5</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex29.m3.2.1.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex29.m3.2.1.2.1"/>
                                        <XMRef idref="A1.Ex29.m3.2.1.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex29.m3.2.1.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex29.m3.2.1.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex29.m3.2.1.2.2.1"/>
                                            <XMRef idref="A1.Ex29.m3.2.1.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex29.m3.2.1.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex29.m3.2.1.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex29.m3.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex29.m3.1">X</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{q}" text="r _ q" xml:id="A1.Ex29.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{x},d_{\text{hid}}=128,d_{%&#10;\text{out}}=128)(X)," text="absent = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ x, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X" xml:id="A1.Ex29.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex29.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex29.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex29.m2.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex29.m2.2.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex29.m2.2.1.1"/>
                                        <XMRef idref="A1.Ex29.m2.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex29.m2.2.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="5" role="NUMBER">5</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex29.m2.2.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex29.m2.2.1.2.1"/>
                                            <XMRef idref="A1.Ex29.m2.2.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex29.m2.2.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex29.m2.2.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex29.m2.2.1.2.2.1"/>
                                                <XMRef idref="A1.Ex29.m2.2.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex29.m2.2.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex29.m2.2.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex29.m2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex29.m2.1">X</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex30">
              <MathFork>
                <Math class="ltx_math_unparsed" tex="\displaystyle r_{k}=\text{MLP}\qquad\qquad\qquad\qquad^{\prime\prime}\qquad%&#10;\qquad\qquad\qquad\ (X_{c})," xml:id="A1.Ex30.m3">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMText>MLP</XMText>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMHint name="qqqqqqqquad" role="PUNCT" width="80pt"/>
                      <XMTok fontsize="70%" name="prime2" role="SUPOP">′′</XMTok>
                    </XMApp>
                    <XMHint name="qqqqqqqquad" role="PUNCT" width="85pt"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{k}" text="r _ k" xml:id="A1.Ex30.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle=\text{MLP}\qquad\qquad\qquad\qquad^{\prime\prime}\qquad\qquad%&#10;\qquad\qquad\ (X_{c})," xml:id="A1.Ex30.m2">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMText>MLP</XMText>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMHint name="qqqqqqqquad" role="PUNCT" width="80pt"/>
                          <XMTok fontsize="70%" name="prime2" role="SUPOP">′′</XMTok>
                        </XMApp>
                        <XMHint name="qqqqqqqquad" role="PUNCT" width="85pt"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex31">
              <MathFork>
                <Math tex="\displaystyle r_{v}^{(\text{pre})}=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{z},d_{%&#10;\text{hid}}=128,d_{\text{out}}=128)(X_{c})," text="(r _ v) ^ [pre] = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X _ c" xml:id="A1.Ex31.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex31.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex31.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.Ex31.m3.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMText xml:id="A1.Ex31.m3.1"><text fontsize="70%">pre</text></XMText>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex31.m3.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex31.m3.2.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex31.m3.2.1.1"/>
                                    <XMRef idref="A1.Ex31.m3.2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex31.m3.2.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="5" role="NUMBER">5</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex31.m3.2.1.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex31.m3.2.1.2.1"/>
                                        <XMRef idref="A1.Ex31.m3.2.1.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex31.m3.2.1.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex31.m3.2.1.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex31.m3.2.1.2.2.1"/>
                                            <XMRef idref="A1.Ex31.m3.2.1.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex31.m3.2.1.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex31.m3.2.1.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex31.m3.2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex31.m3.2.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{v}^{(\text{pre})}" text="(r _ v) ^ [pre]" xml:id="A1.Ex31.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.Ex31.m1.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMText xml:id="A1.Ex31.m1.1"><text fontsize="70%">pre</text></XMText>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{z},d_{\text{hid}}=128,d_{%&#10;\text{out}}=128)(X_{c})," text="absent = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X _ c" xml:id="A1.Ex31.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex31.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex31.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex31.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex31.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex31.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex31.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex31.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="5" role="NUMBER">5</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex31.m2.1.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex31.m2.1.1.2.1"/>
                                            <XMRef idref="A1.Ex31.m2.1.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex31.m2.1.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex31.m2.1.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex31.m2.1.1.2.2.1"/>
                                                <XMRef idref="A1.Ex31.m2.1.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex31.m2.1.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex31.m2.1.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex31.m2.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex31.m2.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex32">
              <MathFork>
                <Math tex="\displaystyle r_{v}=\text{SA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{v}^{(%&#10;\text{pre})})," text="r _ v = [SA] * formulae@(n _ [head] = 8, d _ [out] = 128) * (r _ v) ^ [pre]" xml:id="A1.Ex32.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex32.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex32.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>SA</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex32.m3.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex32.m3.2.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex32.m3.2.1.1"/>
                                    <XMRef idref="A1.Ex32.m3.2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex32.m3.2.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex32.m3.2.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex32.m3.2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex32.m3.2.2">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.Ex32.m3.1"/>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMText xml:id="A1.Ex32.m3.1"><text fontsize="70%">pre</text></XMText>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{v}" text="r _ v" xml:id="A1.Ex32.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{SA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{v}^{(\text{%&#10;pre})})," text="absent = [SA] * formulae@(n _ [head] = 8, d _ [out] = 128) * (r _ v) ^ [pre]" xml:id="A1.Ex32.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex32.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex32.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>SA</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex32.m2.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex32.m2.2.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex32.m2.2.1.1"/>
                                        <XMRef idref="A1.Ex32.m2.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex32.m2.2.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMText><text fontsize="70%">head</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="8" role="NUMBER">8</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex32.m2.2.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex32.m2.2.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex32.m2.2.2">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A1.Ex32.m2.1"/>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                          <XMText xml:id="A1.Ex32.m2.1"><text fontsize="70%">pre</text></XMText>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex33">
              <MathFork>
                <Math tex="\displaystyle r_{c}=\text{MHA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{q},r_{%&#10;k},r_{v})," text="r _ c = [MHA] * formulae@(n _ [head] = 8, d _ [out] = 128) * vector@(r _ q, r _ k, r _ v)" xml:id="A1.Ex33.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex33.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex33.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MHA</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex33.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex33.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex33.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex33.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex33.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex33.m3.1.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="A1.Ex33.m3.1.2"/>
                                <XMRef idref="A1.Ex33.m3.1.3"/>
                                <XMRef idref="A1.Ex33.m3.1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex33.m3.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex33.m3.1.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex33.m3.1.4">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{c}" text="r _ c" xml:id="A1.Ex33.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MHA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{q},r_{k},r_{%&#10;v})," text="absent = [MHA] * formulae@(n _ [head] = 8, d _ [out] = 128) * vector@(r _ q, r _ k, r _ v)" xml:id="A1.Ex33.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex33.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex33.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MHA</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex33.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex33.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex33.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex33.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex33.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMText><text fontsize="70%">head</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="8" role="NUMBER">8</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex33.m2.1.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="vector"/>
                                    <XMRef idref="A1.Ex33.m2.1.2"/>
                                    <XMRef idref="A1.Ex33.m2.1.3"/>
                                    <XMRef idref="A1.Ex33.m2.1.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex33.m2.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex33.m2.1.3">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex33.m2.1.4">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex34">
              <MathFork>
                <Math tex="\displaystyle f_{\text{enc}}(Z_{c})=r_{c}." text="f _ [enc] * Z _ c = r _ c" xml:id="A1.Ex34.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex34.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex34.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMText><text fontsize="70%">enc</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.Ex34.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex34.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{enc}}(Z_{c})" text="f _ [enc] * Z _ c" xml:id="A1.Ex34.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">enc</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.Ex34.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex34.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=r_{c}." text="absent = r _ c" xml:id="A1.Ex34.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex34.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex34.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>For the <ERROR class="undefined">\gls</ERROR>mpanp, <Math mode="inline" tex="f_{\text{enc}}(Z_{c})" text="f _ [enc] * Z _ c" xml:id="A1.SS3.SSS0.Px1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMText><text fontsize="70%">enc</text></XMText>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.SS3.SSS0.Px1.p1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS3.SSS0.Px1.p1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> changes into</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx30">
            <equation xml:id="A1.Ex35">
              <MathFork>
                <Math tex="\displaystyle r_{c}=\text{MHA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{q},%&#10;\text{concat}([r_{k},r_{k}^{\prime}]),\text{concat}([r_{v},r_{v}^{\prime}]))," text="r _ c = [MHA] * formulae@(n _ [head] = 8, d _ [out] = 128) * vector@(r _ q, [concat] * closed-interval@(r _ k, (r _ k) ^ prime), [concat] * closed-interval@(r _ v, (r _ v) ^ prime))" xml:id="A1.Ex35.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex35.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex35.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MHA</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex35.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex35.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex35.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex35.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex35.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex35.m3.1.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="A1.Ex35.m3.1.2"/>
                                <XMRef idref="A1.Ex35.m3.1.3"/>
                                <XMRef idref="A1.Ex35.m3.1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex35.m3.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex35.m3.1.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>concat</XMText>
                                  <XMDual>
                                    <XMRef idref="A1.Ex35.m3.1.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMDual xml:id="A1.Ex35.m3.1.3.1">
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="A1.Ex35.m3.1.3.1.1"/>
                                          <XMRef idref="A1.Ex35.m3.1.3.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.Ex35.m3.1.3.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex35.m3.1.3.1.2">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex35.m3.1.4">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>concat</XMText>
                                  <XMDual>
                                    <XMRef idref="A1.Ex35.m3.1.4.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMDual xml:id="A1.Ex35.m3.1.4.1">
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="A1.Ex35.m3.1.4.1.1"/>
                                          <XMRef idref="A1.Ex35.m3.1.4.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.Ex35.m3.1.4.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex35.m3.1.4.1.2">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                            </XMApp>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{c}" text="r _ c" xml:id="A1.Ex35.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MHA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{q},\text{%&#10;concat}([r_{k},r_{k}^{\prime}]),\text{concat}([r_{v},r_{v}^{\prime}]))," text="absent = [MHA] * formulae@(n _ [head] = 8, d _ [out] = 128) * vector@(r _ q, [concat] * closed-interval@(r _ k, (r _ k) ^ prime), [concat] * closed-interval@(r _ v, (r _ v) ^ prime))" xml:id="A1.Ex35.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex35.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex35.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MHA</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex35.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex35.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex35.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex35.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex35.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMText><text fontsize="70%">head</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="8" role="NUMBER">8</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex35.m2.1.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="vector"/>
                                    <XMRef idref="A1.Ex35.m2.1.2"/>
                                    <XMRef idref="A1.Ex35.m2.1.3"/>
                                    <XMRef idref="A1.Ex35.m2.1.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex35.m2.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex35.m2.1.3">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMText>concat</XMText>
                                      <XMDual>
                                        <XMRef idref="A1.Ex35.m2.1.3.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMDual xml:id="A1.Ex35.m2.1.3.1">
                                            <XMApp>
                                              <XMTok meaning="closed-interval"/>
                                              <XMRef idref="A1.Ex35.m2.1.3.1.1"/>
                                              <XMRef idref="A1.Ex35.m2.1.3.1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                                              <XMApp xml:id="A1.Ex35.m2.1.3.1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.Ex35.m2.1.3.1.2">
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex35.m2.1.4">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMText>concat</XMText>
                                      <XMDual>
                                        <XMRef idref="A1.Ex35.m2.1.4.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMDual xml:id="A1.Ex35.m2.1.4.1">
                                            <XMApp>
                                              <XMTok meaning="closed-interval"/>
                                              <XMRef idref="A1.Ex35.m2.1.4.1.1"/>
                                              <XMRef idref="A1.Ex35.m2.1.4.1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                                              <XMApp xml:id="A1.Ex35.m2.1.4.1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.Ex35.m2.1.4.1.2">
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex36">
              <MathFork>
                <Math tex="\displaystyle f_{\text{enc}}=r_{c}," text="f _ [enc] = r _ c" xml:id="A1.Ex36.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex36.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex36.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">enc</text></XMText>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{enc}}" text="f _ [enc]" xml:id="A1.Ex36.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                          <XMText><text fontsize="70%">enc</text></XMText>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=r_{c}," text="absent = r _ c" xml:id="A1.Ex36.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex36.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex36.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="r_{k}^{\prime}" text="(r _ k) ^ prime" xml:id="A1.SS3.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="r_{v}^{\prime}" text="(r _ v) ^ prime" xml:id="A1.SS3.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> are the key and value features of the pseudo context data generated from generator in paragraph <text font="bold">Generator</text>.</p>
        </para>
        <para xml:id="A1.SS3.SSS0.Px1.p2">
          <ERROR class="undefined">\gls</ERROR>
          <p>anp constructed as:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx31">
            <equation xml:id="A1.Ex37">
              <MathFork>
                <Math tex="\displaystyle r_{q}=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{x},d_{\text{hid}}=128,%&#10;d_{\text{out}}=128)(X)," text="r _ q = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ x, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X" xml:id="A1.Ex37.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex37.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex37.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex37.m3.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex37.m3.2.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex37.m3.2.1.1"/>
                                    <XMRef idref="A1.Ex37.m3.2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex37.m3.2.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="5" role="NUMBER">5</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex37.m3.2.1.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex37.m3.2.1.2.1"/>
                                        <XMRef idref="A1.Ex37.m3.2.1.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex37.m3.2.1.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex37.m3.2.1.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex37.m3.2.1.2.2.1"/>
                                            <XMRef idref="A1.Ex37.m3.2.1.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex37.m3.2.1.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex37.m3.2.1.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex37.m3.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex37.m3.1">X</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{q}" text="r _ q" xml:id="A1.Ex37.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{x},d_{\text{hid}}=128,d_{%&#10;\text{out}}=128)(X)," text="absent = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ x, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X" xml:id="A1.Ex37.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex37.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex37.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex37.m2.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex37.m2.2.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex37.m2.2.1.1"/>
                                        <XMRef idref="A1.Ex37.m2.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex37.m2.2.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="5" role="NUMBER">5</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex37.m2.2.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex37.m2.2.1.2.1"/>
                                            <XMRef idref="A1.Ex37.m2.2.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex37.m2.2.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex37.m2.2.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex37.m2.2.1.2.2.1"/>
                                                <XMRef idref="A1.Ex37.m2.2.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex37.m2.2.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex37.m2.2.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex37.m2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex37.m2.1">X</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex38">
              <MathFork>
                <Math class="ltx_math_unparsed" tex="\displaystyle r_{k}=\text{MLP}\qquad\qquad\qquad\qquad^{\prime\prime}\qquad%&#10;\qquad\qquad\qquad\ (X_{c})," xml:id="A1.Ex38.m3">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMText>MLP</XMText>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMHint name="qqqqqqqquad" role="PUNCT" width="80pt"/>
                      <XMTok fontsize="70%" name="prime2" role="SUPOP">′′</XMTok>
                    </XMApp>
                    <XMHint name="qqqqqqqquad" role="PUNCT" width="85pt"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{k}" text="r _ k" xml:id="A1.Ex38.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle=\text{MLP}\qquad\qquad\qquad\qquad^{\prime\prime}\qquad\qquad%&#10;\qquad\qquad\ (X_{c})," xml:id="A1.Ex38.m2">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMText>MLP</XMText>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMHint name="qqqqqqqquad" role="PUNCT" width="80pt"/>
                          <XMTok fontsize="70%" name="prime2" role="SUPOP">′′</XMTok>
                        </XMApp>
                        <XMHint name="qqqqqqqquad" role="PUNCT" width="85pt"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex39">
              <MathFork>
                <Math tex="\displaystyle r_{v}^{\prime}=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{z},d_{\text{%&#10;hid}}=128,d_{\text{out}}=128)(X_{c})," text="(r _ v) ^ prime = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X _ c" xml:id="A1.Ex39.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex39.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex39.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex39.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex39.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex39.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex39.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex39.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="5" role="NUMBER">5</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex39.m3.1.1.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex39.m3.1.1.2.1"/>
                                        <XMRef idref="A1.Ex39.m3.1.1.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex39.m3.1.1.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex39.m3.1.1.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex39.m3.1.1.2.2.1"/>
                                            <XMRef idref="A1.Ex39.m3.1.1.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex39.m3.1.1.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex39.m3.1.1.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex39.m3.1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex39.m3.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{v}^{\prime}" text="(r _ v) ^ prime" xml:id="A1.Ex39.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=5,d_{\text{in}}=d_{z},d_{\text{hid}}=128,d_{%&#10;\text{out}}=128)(X_{c})," text="absent = [MLP] * formulae@(n _ l = 5, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128))) * X _ c" xml:id="A1.Ex39.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex39.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex39.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex39.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex39.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex39.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex39.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex39.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="5" role="NUMBER">5</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex39.m2.1.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex39.m2.1.1.2.1"/>
                                            <XMRef idref="A1.Ex39.m2.1.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex39.m2.1.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex39.m2.1.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex39.m2.1.1.2.2.1"/>
                                                <XMRef idref="A1.Ex39.m2.1.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex39.m2.1.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex39.m2.1.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex39.m2.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex39.m2.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex40">
              <MathFork>
                <Math tex="\displaystyle r_{v}=\text{SA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{v}^{%&#10;\prime})," text="r _ v = [SA] * formulae@(n _ [head] = 8, d _ [out] = 128) * (r _ v) ^ prime" xml:id="A1.Ex40.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex40.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex40.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>SA</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex40.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex40.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex40.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex40.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex40.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex40.m3.1.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex40.m3.1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex40.m3.1.2">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{v}" text="r _ v" xml:id="A1.Ex40.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{SA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{v}^{\prime})," text="absent = [SA] * formulae@(n _ [head] = 8, d _ [out] = 128) * (r _ v) ^ prime" xml:id="A1.Ex40.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex40.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex40.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>SA</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex40.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex40.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex40.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex40.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex40.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMText><text fontsize="70%">head</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="8" role="NUMBER">8</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex40.m2.1.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex40.m2.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex40.m2.1.2">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex41">
              <MathFork>
                <Math tex="\displaystyle r_{c}=\text{MHA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{q},r_{%&#10;k},r_{v})," text="r _ c = [MHA] * formulae@(n _ [head] = 8, d _ [out] = 128) * vector@(r _ q, r _ k, r _ v)" xml:id="A1.Ex41.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex41.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex41.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MHA</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex41.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex41.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex41.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex41.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex41.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex41.m3.1.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="vector"/>
                                <XMRef idref="A1.Ex41.m3.1.2"/>
                                <XMRef idref="A1.Ex41.m3.1.3"/>
                                <XMRef idref="A1.Ex41.m3.1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex41.m3.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex41.m3.1.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex41.m3.1.4">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle r_{c}" text="r _ c" xml:id="A1.Ex41.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MHA}(n_{\text{head}}=8,d_{\text{out}}=128)(r_{q},r_{k},r_{%&#10;v})," text="absent = [MHA] * formulae@(n _ [head] = 8, d _ [out] = 128) * vector@(r _ q, r _ k, r _ v)" xml:id="A1.Ex41.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex41.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex41.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MHA</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex41.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex41.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex41.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex41.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex41.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMText><text fontsize="70%">head</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="8" role="NUMBER">8</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex41.m2.1.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="vector"/>
                                    <XMRef idref="A1.Ex41.m2.1.2"/>
                                    <XMRef idref="A1.Ex41.m2.1.3"/>
                                    <XMRef idref="A1.Ex41.m2.1.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex41.m2.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex41.m2.1.3">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex41.m2.1.4">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex42">
              <MathFork>
                <Math tex="\displaystyle h_{i}^{\prime}=\text{MLP}(n_{l}=2,d_{\text{in}}=d_{z},d_{\text{%&#10;hid}}=128,d_{\text{out}}=128\times 2)(z_{i})," text="(h _ i) ^ prime = [MLP] * formulae@(n _ l = 2, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128 * 2))) * z _ i" xml:id="A1.Ex42.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex42.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex42.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>MLP</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex42.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex42.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex42.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex42.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex42.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                      </XMApp>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMDual xml:id="A1.Ex42.m3.1.1.2">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex42.m3.1.1.2.1"/>
                                        <XMRef idref="A1.Ex42.m3.1.1.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex42.m3.1.1.2.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">in</text></XMText>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex42.m3.1.1.2.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex42.m3.1.1.2.2.1"/>
                                            <XMRef idref="A1.Ex42.m3.1.1.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex42.m3.1.1.2.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">hid</text></XMText>
                                              </XMApp>
                                              <XMTok meaning="128" role="NUMBER">128</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.Ex42.m3.1.1.2.2.2">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">out</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">×</XMTok>
                                                <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex42.m3.1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex42.m3.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle h_{i}^{\prime}" text="(h _ i) ^ prime" xml:id="A1.Ex42.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{MLP}(n_{l}=2,d_{\text{in}}=d_{z},d_{\text{hid}}=128,d_{%&#10;\text{out}}=128\times 2)(z_{i})," text="absent = [MLP] * formulae@(n _ l = 2, formulae@(d _ [in] = d _ z, formulae@(d _ [hid] = 128, d _ [out] = 128 * 2))) * z _ i" xml:id="A1.Ex42.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex42.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex42.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>MLP</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex42.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex42.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex42.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex42.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex42.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                                          </XMApp>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMDual xml:id="A1.Ex42.m2.1.1.2">
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A1.Ex42.m2.1.1.2.1"/>
                                            <XMRef idref="A1.Ex42.m2.1.1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A1.Ex42.m2.1.1.2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMText><text fontsize="70%">in</text></XMText>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A1.Ex42.m2.1.1.2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A1.Ex42.m2.1.1.2.2.1"/>
                                                <XMRef idref="A1.Ex42.m2.1.1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A1.Ex42.m2.1.1.2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">hid</text></XMText>
                                                  </XMApp>
                                                  <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.Ex42.m2.1.1.2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                    <XMText><text fontsize="70%">out</text></XMText>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">×</XMTok>
                                                    <XMTok meaning="128" role="NUMBER">128</XMTok>
                                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex42.m2.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex42.m2.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex43">
              <MathFork>
                <Math tex="\displaystyle h_{i}=\text{SA}(n_{\text{head}}=8,d_{\text{out}}=128)(h_{i}^{%&#10;\prime})," text="h _ i = [SA] * formulae@(n _ [head] = 8, d _ [out] = 128) * (h _ i) ^ prime" xml:id="A1.Ex43.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex43.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex43.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>SA</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex43.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex43.m3.1.1">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex43.m3.1.1.1"/>
                                    <XMRef idref="A1.Ex43.m3.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex43.m3.1.1.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex43.m3.1.1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="128" role="NUMBER">128</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMRef idref="A1.Ex43.m3.1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex43.m3.1.2">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle h_{i}" text="h _ i" xml:id="A1.Ex43.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{SA}(n_{\text{head}}=8,d_{\text{out}}=128)(h_{i}^{\prime})," text="absent = [SA] * formulae@(n _ [head] = 8, d _ [out] = 128) * (h _ i) ^ prime" xml:id="A1.Ex43.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex43.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex43.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>SA</XMText>
                                <XMDual>
                                  <XMRef idref="A1.Ex43.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMDual xml:id="A1.Ex43.m2.1.1">
                                      <XMApp>
                                        <XMTok meaning="formulae"/>
                                        <XMRef idref="A1.Ex43.m2.1.1.1"/>
                                        <XMRef idref="A1.Ex43.m2.1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.Ex43.m2.1.1.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMText><text fontsize="70%">head</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="8" role="NUMBER">8</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.Ex43.m2.1.1.2">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMText><text fontsize="70%">out</text></XMText>
                                          </XMApp>
                                          <XMTok meaning="128" role="NUMBER">128</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.Ex43.m2.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex43.m2.1.2">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex44">
              <MathFork>
                <Math tex="\displaystyle(m_{c},\log s_{c})=\frac{1}{|c|}\sum_{i\in c}h_{i}," text="open-interval@(m _ c, logarithm@(s _ c)) = (1 / absolute-value@(c)) * (sum _ (i element-of c))@(h _ i)" xml:id="A1.Ex44.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex44.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex44.m3.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex44.m3.2.1"/>
                              <XMRef idref="A1.Ex44.m3.2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex44.m3.2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex44.m3.2.2">
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="A1.Ex44.m3.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex44.m3.1">c</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(m_{c},\log s_{c})" text="open-interval@(m _ c, logarithm@(s _ c))" xml:id="A1.Ex44.m1">
                      <XMath>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex44.m1.1"/>
                            <XMRef idref="A1.Ex44.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex44.m1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">m</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex44.m1.2">
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\frac{1}{|c|}\sum_{i\in c}h_{i}," text="absent = (1 / absolute-value@(c)) * (sum _ (i element-of c))@(h _ i)" xml:id="A1.Ex44.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex44.m2.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex44.m2.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="A1.Ex44.m2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex44.m2.1">c</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex45">
              <MathFork>
                <Math tex="\displaystyle s_{c}=0.1+0.9\cdot\text{softplus}(\log s_{c})," text="s _ c = 0.1 + (0.9 cdot [softplus]) * logarithm@(s _ c)" xml:id="A1.Ex45.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex45.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex45.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                <XMText>softplus</XMText>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A1.Ex45.m3.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex45.m3.1.1">
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle s_{c}" text="s _ c" xml:id="A1.Ex45.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=0.1+0.9\cdot\text{softplus}(\log s_{c})," text="absent = 0.1 + (0.9 cdot [softplus]) * logarithm@(s _ c)" xml:id="A1.Ex45.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex45.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex45.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
                                    <XMText>softplus</XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.Ex45.m2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex45.m2.1.1">
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex46">
              <MathFork>
                <Math tex="\displaystyle h_{c}={\mathcal{N}}(m_{c},s^{2}_{c}I_{h})," text="h _ c = N * open-interval@(m _ c, (s ^ 2) _ c * I _ h)" xml:id="A1.Ex46.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex46.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex46.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex46.m3.1.1"/>
                                <XMRef idref="A1.Ex46.m3.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex46.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex46.m3.1.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle h_{c}" text="h _ c" xml:id="A1.Ex46.m1">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle={\mathcal{N}}(m_{c},s^{2}_{c}I_{h})," text="absent = N * open-interval@(m _ c, (s ^ 2) _ c * I _ h)" xml:id="A1.Ex46.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex46.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex46.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.Ex46.m2.1.1"/>
                                    <XMRef idref="A1.Ex46.m2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex46.m2.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex46.m2.1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex47">
              <MathFork>
                <Math tex="\displaystyle f_{\text{enc}}(Z_{c})=[r_{c};h_{c}]." text="f _ [enc] * Z _ c = list@(r _ c, h _ c)" xml:id="A1.Ex47.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex47.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex47.m3.1">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMText><text fontsize="70%">enc</text></XMText>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.Ex47.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex47.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A1.Ex47.m3.1.2"/>
                              <XMRef idref="A1.Ex47.m3.1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="A1.Ex47.m3.1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">;</XMTok>
                              <XMApp xml:id="A1.Ex47.m3.1.3">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{enc}}(Z_{c})" text="f _ [enc] * Z _ c" xml:id="A1.Ex47.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">enc</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.Ex47.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex47.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=[r_{c};h_{c}]." text="absent = list@(r _ c, h _ c)" xml:id="A1.Ex47.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex47.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex47.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="A1.Ex47.m2.1.1"/>
                                  <XMRef idref="A1.Ex47.m2.1.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                                  <XMApp xml:id="A1.Ex47.m2.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">;</XMTok>
                                  <XMApp xml:id="A1.Ex47.m2.1.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>Note that <Math mode="inline" tex="r_{q}" text="r _ q" xml:id="A1.SS3.SSS0.Px1.p2.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="r_{k}" text="r _ k" xml:id="A1.SS3.SSS0.Px1.p2.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMath>
            </Math> are from the same MLP.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS3.SSS0.Px2">
        <title>Adaptation Layer</title>
        <para xml:id="A1.SS3.SSS0.Px2.p1">
          <p>Like <ERROR class="undefined">\gls</ERROR>bnp, <ERROR class="undefined">\gls</ERROR>banp also uses adaptation layer with same structure to combine bootstrapped representations.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS3.SSS0.Px3">
        <title>Decoder</title>
        <para xml:id="A1.SS3.SSS0.Px3.p1">
          <p>All models use the same decoder structure as their non-attentive counterparts.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A1.SS3.SSS0.Px4">
        <title>Generator</title>
        <para xml:id="A1.SS3.SSS0.Px4.p1">
          <ERROR class="undefined">\gls</ERROR>
          <p>mpanp use a single <text class="ltx_markedasmath">ISAB</text> module as a generator. The <text class="ltx_markedasmath">ISAB</text> uses the following structure:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx32">
            <equation xml:id="A1.Ex48">
              <MathFork>
                <Math tex="\displaystyle\epsilon=\text{concat}([\epsilon_{i}]_{i=1}^{n_{\text{gen}}})" text="epsilon = [concat] * ((delimited-[]@(epsilon _ i)) _ (i = 1)) ^ (n _ [gen])" xml:id="A1.Ex48.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>concat</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex48.m3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex48.m3.1">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A1.Ex48.m3.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A1.Ex48.m3.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                <XMText><text fontsize="50%">gen</text></XMText>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\epsilon" text="epsilon" xml:id="A1.Ex48.m1">
                      <XMath>
                        <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{concat}([\epsilon_{i}]_{i=1}^{n_{\text{gen}}})" text="absent = [concat] * ((delimited-[]@(epsilon _ i)) _ (i = 1)) ^ (n _ [gen])" xml:id="A1.Ex48.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>concat</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex48.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.Ex48.m2.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-[]"/>
                                        <XMRef idref="A1.Ex48.m2.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                                        <XMApp xml:id="A1.Ex48.m2.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                    <XMText><text fontsize="50%">gen</text></XMText>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex49">
              <MathFork>
                <Math tex="\displaystyle(r_{k}^{\prime},r_{v}^{\prime})=\text{ISAB}(n_{\text{head}}=8,d_{%&#10;\text{out}}=256)(\epsilon,\text{concat}([r_{k},r_{v}]))" text="open-interval@((r _ k) ^ prime, (r _ v) ^ prime) = [ISAB] * formulae@(n _ [head] = 8, d _ [out] = 256) * open-interval@(epsilon, [concat] * closed-interval@(r _ k, r _ v))" xml:id="A1.Ex49.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.Ex49.m3.2"/>
                          <XMRef idref="A1.Ex49.m3.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="A1.Ex49.m3.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex49.m3.3">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMText>ISAB</XMText>
                        <XMDual>
                          <XMRef idref="A1.Ex49.m3.4"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMDual xml:id="A1.Ex49.m3.4">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex49.m3.4.1"/>
                                <XMRef idref="A1.Ex49.m3.4.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex49.m3.4.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                    <XMText><text fontsize="70%">head</text></XMText>
                                  </XMApp>
                                  <XMTok meaning="8" role="NUMBER">8</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex49.m3.4.2">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMText><text fontsize="70%">out</text></XMText>
                                  </XMApp>
                                  <XMTok meaning="256" role="NUMBER">256</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex49.m3.1"/>
                            <XMRef idref="A1.Ex49.m3.5"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A1.Ex49.m3.1">ϵ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex49.m3.5">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>concat</XMText>
                              <XMDual>
                                <XMRef idref="A1.Ex49.m3.5.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMDual xml:id="A1.Ex49.m3.5.1">
                                    <XMApp>
                                      <XMTok meaning="closed-interval"/>
                                      <XMRef idref="A1.Ex49.m3.5.1.1"/>
                                      <XMRef idref="A1.Ex49.m3.5.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                                      <XMApp xml:id="A1.Ex49.m3.5.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex49.m3.5.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle(r_{k}^{\prime},r_{v}^{\prime})" text="open-interval@((r _ k) ^ prime, (r _ v) ^ prime)" xml:id="A1.Ex49.m1">
                      <XMath>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex49.m1.1"/>
                            <XMRef idref="A1.Ex49.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex49.m1.1">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex49.m1.2">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\text{ISAB}(n_{\text{head}}=8,d_{\text{out}}=256)(\epsilon,\text%&#10;{concat}([r_{k},r_{v}]))" text="absent = [ISAB] * formulae@(n _ [head] = 8, d _ [out] = 256) * open-interval@(epsilon, [concat] * closed-interval@(r _ k, r _ v))" xml:id="A1.Ex49.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>ISAB</XMText>
                            <XMDual>
                              <XMRef idref="A1.Ex49.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMDual xml:id="A1.Ex49.m2.2">
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A1.Ex49.m2.2.1"/>
                                    <XMRef idref="A1.Ex49.m2.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.Ex49.m2.2.1">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                        <XMText><text fontsize="70%">head</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.Ex49.m2.2.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMText><text fontsize="70%">out</text></XMText>
                                      </XMApp>
                                      <XMTok meaning="256" role="NUMBER">256</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.Ex49.m2.1"/>
                                <XMRef idref="A1.Ex49.m2.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A1.Ex49.m2.1">ϵ</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex49.m2.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>concat</XMText>
                                  <XMDual>
                                    <XMRef idref="A1.Ex49.m2.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMDual xml:id="A1.Ex49.m2.3.1">
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="A1.Ex49.m2.3.1.1"/>
                                          <XMRef idref="A1.Ex49.m2.3.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.Ex49.m2.3.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex49.m2.3.1.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex50">
              <MathFork>
                <Math tex="\displaystyle f_{\text{gen}}(r_{k},r_{v})=(r_{k}^{\prime},r_{v}^{\prime})" text="f _ [gen] * open-interval@(r _ k, r _ v) = open-interval@((r _ k) ^ prime, (r _ v) ^ prime)" xml:id="A1.Ex50.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                          <XMText><text fontsize="70%">gen</text></XMText>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex50.m3.1"/>
                            <XMRef idref="A1.Ex50.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex50.m3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex50.m3.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.Ex50.m3.3"/>
                          <XMRef idref="A1.Ex50.m3.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="A1.Ex50.m3.3">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex50.m3.4">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f_{\text{gen}}(r_{k},r_{v})" text="f _ [gen] * open-interval@(r _ k, r _ v)" xml:id="A1.Ex50.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMText><text fontsize="70%">gen</text></XMText>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex50.m1.1"/>
                              <XMRef idref="A1.Ex50.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex50.m1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex50.m1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=(r_{k}^{\prime},r_{v}^{\prime})" text="absent = open-interval@((r _ k) ^ prime, (r _ v) ^ prime)" xml:id="A1.Ex50.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.Ex50.m2.1"/>
                              <XMRef idref="A1.Ex50.m2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.Ex50.m2.1">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex50.m2.2">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="\epsilon_{i}" text="epsilon _ i" xml:id="A1.SS3.SSS0.Px4.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>s are i.i.d. sampled from Gaussian distribution with dimension 256 and <Math mode="inline" tex="n_{\text{gen}}" text="n _ [gen]" xml:id="A1.SS3.SSS0.Px4.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMText><text fontsize="70%">gen</text></XMText>
                </XMApp>
              </XMath>
            </Math> denotes a number of pseudo context data.</p>
        </para>
      </paragraph>
    </subsection>
  </appendix>
  <appendix inlist="toc" labels="LABEL:app:sec:additional_experiments" xml:id="A2">
    <tags>
      <tag>Appendix B</tag>
      <tag role="autoref">Appendix B</tag>
      <tag role="refnum">B</tag>
      <tag role="typerefnum">Appendix B</tag>
    </tags>
    <title><tag close=" ">Appendix B</tag>Additional Experiments</title>
    <toctitle><tag close=" ">B</tag>Additional Experiments</toctitle>
    <subsection inlist="toc" labels="LABEL:app:sec:additional_experiments:1dregression" xml:id="A2.SS1">
      <tags>
        <tag>B.1</tag>
        <tag role="autoref">subsection B.1</tag>
        <tag role="refnum">B.1</tag>
        <tag role="typerefnum">§B.1</tag>
      </tags>
      <title><tag close=" ">B.1</tag>1D Regression</title>
      <table inlist="lot" labels="LABEL:table/app_gp_inf_full" placement="t" xml:id="A2.T4">
        <tags>
          <tag><text fontsize="90%">Table 4</text></tag>
          <tag role="autoref">Table 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Table 4</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>Test results for 1D regression tasks on RBF, Matern, Periodic, and <Math mode="inline" tex="t" text="t" xml:id="A2.T4.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math>-noise. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 4</text></tag><text fontsize="90%">Test results for 1D regression tasks on RBF, Matern, Periodic, and <Math mode="inline" tex="t" text="t" xml:id="A2.T4.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMath>
            </Math>-noise. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</text></caption>
        <inline-block align="center" depth="0.0pt" height="111.9pt" width="433.6pt" xscale="0.621403532579847" xtranslate="-132.1pt" yscale="0.621403532579847" ytranslate="34.1pt">
          <tabular class="ltx_guessed_headers" colsep="3.0pt" vattach="middle">
            <tbody>
              <tr>
                <td border="tt" thead="row"/>
                <td align="center" border="tt" colspan="3">RBF</td>
                <td align="center" border="tt" colspan="3">Matern</td>
                <td align="center" border="tt" colspan="3">Periodic</td>
                <td align="center" border="tt" colspan="3"><Math mode="inline" tex="t" text="t" xml:id="A2.T4.m3">
                    <XMath>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    </XMath>
                  </Math>-noise</td>
              </tr>
              <tr>
                <td align="left" thead="row">Model</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
                <td align="right" border="t">Context</td>
                <td align="right" border="t">Target</td>
                <td align="right" border="t">Task</td>
              </tr>
              <tr>
                <td align="left" border="t" thead="row">CNP</td>
                <td align="right" border="t">1.096<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="A2.T4.m4">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.515<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="A2.T4.m5">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.796<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="A2.T4.m6">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">1.031<Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="A2.T4.m7">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.347<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T4.m8">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.693<Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="A2.T4.m9">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.120<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="A2.T4.m10">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.729<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T4.m11">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.363<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="A2.T4.m12">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.032<Math mode="inline" tex="\scriptstyle{\pm 0.014}" text="plus-or-minus 0.014" xml:id="A2.T4.m13">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.014" role="NUMBER">0.014</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.816<Math mode="inline" tex="\scriptstyle{\pm 0.032}" text="plus-or-minus 0.032" xml:id="A2.T4.m14">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.032" role="NUMBER">0.032</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.260<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="A2.T4.m15">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">NP</td>
                <td align="right">1.022<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m16">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.498<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m17">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.748<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T4.m18">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.948<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T4.m19">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.337<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m20">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.641<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m21">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.267<Math mode="inline" tex="\scriptstyle{\pm 0.024}" text="plus-or-minus 0.024" xml:id="A2.T4.m22">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.024" role="NUMBER">0.024</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.668</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T4.m23">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.441<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="A2.T4.m24">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.201</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.025}" text="plus-or-minus 0.025" xml:id="A2.T4.m25">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.025" role="NUMBER">0.025</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.333<Math mode="inline" tex="\scriptstyle{\pm 0.078}" text="plus-or-minus 0.078" xml:id="A2.T4.m26">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.078" role="NUMBER">0.078</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.038</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="A2.T4.m27">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">BNP</td>
                <td align="right">1.112<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m28">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.588<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T4.m29">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.841<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m30">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.057<Math mode="inline" tex="\scriptstyle{\pm 0.009}" text="plus-or-minus 0.009" xml:id="A2.T4.m31">
                    <XMath>
                      <XMApp>
<!--  %**** app_gp_inf_full.tex Line 25 **** -->                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.009" role="NUMBER">0.009</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.418<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T4.m32">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.741<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T4.m33">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.106<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="A2.T4.m34">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.705<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T4.m35">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.347<Math mode="inline" tex="\scriptstyle{\pm 0.010}" text="plus-or-minus 0.010" xml:id="A2.T4.m36">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.010" role="NUMBER">0.010</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.009<Math mode="inline" tex="\scriptstyle{\pm 0.032}" text="plus-or-minus 0.032" xml:id="A2.T4.m37">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.032" role="NUMBER">0.032</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.619<Math mode="inline" tex="\scriptstyle{\pm 0.191}" text="plus-or-minus 0.191" xml:id="A2.T4.m38">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.191" role="NUMBER">0.191</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.217<Math mode="inline" tex="\scriptstyle{\pm 0.036}" text="plus-or-minus 0.036" xml:id="A2.T4.m39">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.036" role="NUMBER">0.036</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">MPNP (ours)</text></p>
                  </inline-block></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.189</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m40">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.675</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m41">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.911</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m42">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.123</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m43">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.481</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T4.m44">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.796</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m45">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.205</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="A2.T4.m46">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.668</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="A2.T4.m47">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.171</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="A2.T4.m48">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.145<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="A2.T4.m49">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.329</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.025}" text="plus-or-minus 0.025" xml:id="A2.T4.m50">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.025" role="NUMBER">0.025</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.061<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="A2.T4.m51">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" border="t" thead="row">CANP</td>
                <td align="right" border="t">1.304<Math mode="inline" tex="\scriptstyle{\pm 0.027}" text="plus-or-minus 0.027" xml:id="A2.T4.m52">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.027" role="NUMBER">0.027</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.847<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m53">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">1.036<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="A2.T4.m54">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">1.264<Math mode="inline" tex="\scriptstyle{\pm 0.041}" text="plus-or-minus 0.041" xml:id="A2.T4.m55">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.041" role="NUMBER">0.041</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.662<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="A2.T4.m56">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.937<Math mode="inline" tex="\scriptstyle{\pm 0.031}" text="plus-or-minus 0.031" xml:id="A2.T4.m57">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.031" role="NUMBER">0.031</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.527<Math mode="inline" tex="\scriptstyle{\pm 0.106}" text="plus-or-minus 0.106" xml:id="A2.T4.m58">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.106" role="NUMBER">0.106</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.592<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T4.m59">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.010<Math mode="inline" tex="\scriptstyle{\pm 0.069}" text="plus-or-minus 0.069" xml:id="A2.T4.m60">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.069" role="NUMBER">0.069</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">0.410<Math mode="inline" tex="\scriptstyle{\pm 0.155}" text="plus-or-minus 0.155" xml:id="A2.T4.m61">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.155" role="NUMBER">0.155</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.577<Math mode="inline" tex="\scriptstyle{\pm 0.022}" text="plus-or-minus 0.022" xml:id="A2.T4.m62">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.022" role="NUMBER">0.022</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="t">-0.008<Math mode="inline" tex="\scriptstyle{\pm 0.098}" text="plus-or-minus 0.098" xml:id="A2.T4.m63">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.098" role="NUMBER">0.098</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">ANP</td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.380</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m64">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.850<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T4.m65">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.090<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m66">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.380</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m67">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.663<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T4.m68">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.019<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T4.m69">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.583<Math mode="inline" tex="\scriptstyle{\pm 0.011}" text="plus-or-minus 0.011" xml:id="A2.T4.m70">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.011" role="NUMBER">0.011</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-1.019<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="A2.T4.m71">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.090<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T4.m72">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.836<Math mode="inline" tex="\scriptstyle{\pm 0.071}" text="plus-or-minus 0.071" xml:id="A2.T4.m73">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.071" role="NUMBER">0.071</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.415<Math mode="inline" tex="\scriptstyle{\pm 0.131}" text="plus-or-minus 0.131" xml:id="A2.T4.m74">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.131" role="NUMBER">0.131</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.374<Math mode="inline" tex="\scriptstyle{\pm 0.034}" text="plus-or-minus 0.034" xml:id="A2.T4.m75">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.034" role="NUMBER">0.034</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" thead="row">BANP</td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.380</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m76">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.846<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T4.m77">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.088<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m78">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.380</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m79">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.662<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m80">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">1.018<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T4.m81">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.354</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T4.m82">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.496<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m83">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.634</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m84">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.646<Math mode="inline" tex="\scriptstyle{\pm 0.042}" text="plus-or-minus 0.042" xml:id="A2.T4.m85">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.042" role="NUMBER">0.042</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">-0.425<Math mode="inline" tex="\scriptstyle{\pm 0.050}" text="plus-or-minus 0.050" xml:id="A2.T4.m86">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.050" role="NUMBER">0.050</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right">0.270<Math mode="inline" tex="\scriptstyle{\pm 0.033}" text="plus-or-minus 0.033" xml:id="A2.T4.m87">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.033" role="NUMBER">0.033</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
              <tr>
                <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">MPANP (ours)</text></p>
                  </inline-block></td>
                <td align="right" border="bb">1.379<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m88">
                    <XMath>
                      <XMApp>
<!--  %**** app_gp_inf_full.tex Line 50 **** -->                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.881</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m89">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.102</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T4.m90">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.380</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T4.m91">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.692</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T4.m92">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">1.029</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T4.m93">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb">1.348<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m94">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.494</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T4.m95">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb">0.630<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T4.m96">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.842</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.062}" text="plus-or-minus 0.062" xml:id="A2.T4.m97">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.062" role="NUMBER">0.062</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="26.1pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">-0.332</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.026}" text="plus-or-minus 0.026" xml:id="A2.T4.m98">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.026" role="NUMBER">0.026</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                    <p><text font="bold">0.384</text></p>
                  </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.041}" text="plus-or-minus 0.041" xml:id="A2.T4.m99">
                    <XMath>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                        <XMTok fontsize="70%" meaning="0.041" role="NUMBER">0.041</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
            </tbody>
          </tabular>
        </inline-block>
      </table>
      <paragraph inlist="toc" xml:id="A2.SS1.SSS0.Px1">
        <title>Full results for <ref labelref="LABEL:table/main_gp_inf" show="creftype~refnum"/></title>
        <para xml:id="A2.SS1.SSS0.Px1.p1">
          <p>We provide the full test results for 1D regression tasks including context, target, and task log-likelihood values in <ref labelref="LABEL:table/app_gp_inf_full" show="creftype~refnum"/>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A2.SS1.SSS0.Px2">
        <title>Increasing the encoder size of baselines</title>
        <table inlist="lot" labels="LABEL:table/app_gp_inf_sizeup" placement="t" xml:id="A2.T5">
          <tags>
            <tag><text fontsize="90%">Table 5</text></tag>
            <tag role="autoref">Table 5</tag>
            <tag role="refnum">5</tag>
            <tag role="typerefnum">Table 5</tag>
          </tags>
          <toccaption class="ltx_centering"><tag close=" ">5</tag>Further comparisons with baselines with increased number of parameters. ‘Context’ and ‘Target’ respectively denote context and target log-liklihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</toccaption>
          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 5</text></tag><text fontsize="90%">Further comparisons with baselines with increased number of parameters. ‘Context’ and ‘Target’ respectively denote context and target log-liklihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</text></caption>
          <inline-block align="center" depth="0.0pt" height="164.3pt" width="433.6pt" xscale="0.912509313270732" xtranslate="-20.8pt" yscale="0.912509313270732" ytranslate="7.9pt">
            <tabular class="ltx_guessed_headers" vattach="middle">
              <tbody>
                <tr>
                  <td border="tt" thead="row"/>
                  <td border="tt" thead="row"/>
                  <td align="center" border="tt" colspan="3">RBF</td>
                  <td align="center" border="tt" colspan="3">Matern</td>
                </tr>
                <tr>
                  <td align="left" thead="row">Model</td>
                  <td align="right" thead="row"># Params</td>
                  <td align="right" border="t">Context</td>
                  <td align="right" border="t">Target</td>
                  <td align="right" border="t">Task</td>
                  <td align="right" border="t">Context</td>
                  <td align="right" border="t">Target</td>
                  <td align="right" border="t">Task</td>
                </tr>
                <tr>
                  <td align="left" border="t" thead="row">CNP</td>
                  <td align="right" border="t" thead="row">264 K</td>
                  <td align="right" border="t">1.096<Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="A2.T5.m1">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.517<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m2">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.797<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m3">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">1.017<Math mode="inline" tex="\scriptstyle{\pm 0.021}" text="plus-or-minus 0.021" xml:id="A2.T5.m4">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.021" role="NUMBER">0.021</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.340<Math mode="inline" tex="\scriptstyle{\pm 0.012}" text="plus-or-minus 0.012" xml:id="A2.T5.m5">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.012" role="NUMBER">0.012</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.681<Math mode="inline" tex="\scriptstyle{\pm 0.017}" text="plus-or-minus 0.017" xml:id="A2.T5.m6">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.017" role="NUMBER">0.017</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">NP</td>
                  <td align="right" thead="row">274 K</td>
                  <td align="right">1.026<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T5.m7">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.501<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m8">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.752<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m9">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.948<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m10">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.334<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T5.m11">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.640<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m12">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">BNP</td>
                  <td align="right" thead="row">261 K</td>
                  <td align="right">1.115<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m13">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.591<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m14">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.843<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T5.m15">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.051<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m16">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.416<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m17">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.736<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m18">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">MPNP (ours)</text></p>
                    </inline-block></td>
                  <td align="right" thead="row">266 K</td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.189</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m19">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.675</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m20">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.911</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m21">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.123</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m22">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.481</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m23">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.796</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m24">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" border="t" thead="row">CANP</td>
                  <td align="right" border="t" thead="row">868 K</td>
                  <td align="right" border="t">1.305<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m25">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.844<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T5.m26">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">1.035<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m27">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">1.278<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="A2.T5.m28">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.663<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T5.m29">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="t">0.947<Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="A2.T5.m30">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">ANP</td>
                  <td align="right" thead="row">877 K</td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T5.m31">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.858<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T5.m32">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.093<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T5.m33">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T5.m34">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.668<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T5.m35">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.020<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T5.m36">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" thead="row">BANP</td>
                  <td align="right" thead="row">885 K</td>
                  <td align="right">1.379<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T5.m37">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.839<Math mode="inline" tex="\scriptstyle{\pm 0.015}" text="plus-or-minus 0.015" xml:id="A2.T5.m38">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.015" role="NUMBER">0.015</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.085<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T5.m39">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.376<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T5.m40">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">0.652<Math mode="inline" tex="\scriptstyle{\pm 0.032}" text="plus-or-minus 0.032" xml:id="A2.T5.m41">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.032" role="NUMBER">0.032</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right">1.012<Math mode="inline" tex="\scriptstyle{\pm 0.014}" text="plus-or-minus 0.014" xml:id="A2.T5.m42">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.014" role="NUMBER">0.014</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">MPANP (ours)</text></p>
                    </inline-block></td>
                  <td align="right" border="bb" thead="row">877 K</td>
                  <td align="right" border="bb">1.379<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T5.m43">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.881</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m44">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.102</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T5.m45">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.380</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T5.m46">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">0.692</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T5.m47">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                      <p><text font="bold">1.029</text></p>
                    </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A2.T5.m48">
                      <XMath>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                          <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
              </tbody>
            </tabular>
          </inline-block>
        </table>
        <para xml:id="A2.SS1.SSS0.Px2.p1">
          <p>Since the generator increases the size of the encoder in <ERROR class="undefined">\glspl</ERROR>mpnp, one can claim that the performance gain of <ERROR class="undefined">\glspl</ERROR>mpnp may come from the increased model size. To verify this, we increased the hidden dimensions of the encoder of baselines and compared them with ours. The results displayed in <ref labelref="LABEL:table/app_gp_inf_sizeup" show="creftype~refnum"/> further clarify that ours still outperforms the baselines even when the number of parameters gets in line.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" xml:id="A2.SS2">
      <tags>
        <tag>B.2</tag>
        <tag role="autoref">subsection B.2</tag>
        <tag role="refnum">B.2</tag>
        <tag role="typerefnum">§B.2</tag>
      </tags>
      <title><tag close=" ">B.2</tag>High-D Regression</title>
      <para xml:id="A2.SS2.p1">
        <p><!--  %“paragraph–Settings˝ -->We conducted additional experiments on the synthetic high-dimensional regression data (i.e., generating one-dimensional y from four-dimensional x with RBF kernel). Here we used the same model structures with the 1D regression task except for the input layer, and the same settings for the RBF kernel with 1D regression except for <Math mode="inline" tex="l\sim\text{Unif}(0.5,3.0)" text="l similar-to [Unif] * open-interval@(0.5, 3.0)" xml:id="A2.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" role="UNKNOWN">l</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A2.SS2.p1.m1.1"/>
                      <XMRef idref="A2.SS2.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0.5" role="NUMBER" xml:id="A2.SS2.p1.m1.1">0.5</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="3.0" role="NUMBER" xml:id="A2.SS2.p1.m1.2">3.0</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. We fixed the base learning rate to <Math mode="inline" tex="0.00015" text="0.00015" xml:id="A2.SS2.p1.m2">
            <XMath>
              <XMTok meaning="0.00015" role="NUMBER">0.00015</XMTok>
            </XMath>
          </Math> for all models throughout the high-dimensional regression experiments.</p>
      </para>
      <para xml:id="A2.SS2.p2">
        <p><ref labelref="LABEL:table/app_high_d" show="creftype~refnum"/> clearly shows our <ERROR class="undefined">\glspl</ERROR>mpnp still outperform baselines for log-likelihood values we measured.</p>
      </para>
      <table inlist="lot" labels="LABEL:table/app_high_d" placement="t" xml:id="A2.T6">
        <tags>
          <tag><text fontsize="90%">Table 6</text></tag>
          <tag role="autoref">Table 6</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Table 6</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" ">6</tag>Test results for 4D regression tasks on RBF. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 6</text></tag><text fontsize="90%">Test results for 4D regression tasks on RBF. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</text></caption>
        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <tbody>
            <tr>
              <td border="tt" thead="row"/>
              <td align="center" border="tt" colspan="3">RBF</td>
            </tr>
            <tr>
              <td align="left" thead="row">Model</td>
              <td align="right" border="t">Context</td>
              <td align="right" border="t">Target</td>
              <td align="right" border="t">Task</td>
            </tr>
            <tr>
              <td align="left" border="t" thead="row">CNP</td>
              <td align="right" border="t">0.572<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T6.m1">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.265<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T6.m2">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.410<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A2.T6.m3">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">NP</td>
              <td align="right">0.568<Math mode="inline" tex="\scriptstyle{\pm 0.009}" text="plus-or-minus 0.009" xml:id="A2.T6.m4">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.009" role="NUMBER">0.009</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.267<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T6.m5">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.407<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T6.m6">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">BNP</td>
              <td align="right">0.621<Math mode="inline" tex="\scriptstyle{\pm 0.015}" text="plus-or-minus 0.015" xml:id="A2.T6.m7">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.015" role="NUMBER">0.015</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.323<Math mode="inline" tex="\scriptstyle{\pm 0.008}" text="plus-or-minus 0.008" xml:id="A2.T6.m8">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.008" role="NUMBER">0.008</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.467<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="A2.T6.m9">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPNP (ours)</text></p>
                </inline-block></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.820</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T6.m10">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.441</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T6.m11">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.633</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A2.T6.m12">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" border="t" thead="row">CANP</td>
              <td align="right" border="t">0.957<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T6.m13">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.585<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T6.m14">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.743<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A2.T6.m15">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">ANP</td>
              <td align="right">1.357<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T6.m16">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.320<Math mode="inline" tex="\scriptstyle{\pm 0.014}" text="plus-or-minus 0.014" xml:id="A2.T6.m17">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.014" role="NUMBER">0.014</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.890<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T6.m18">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">BANP</td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.380</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T6.m19">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.549<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A2.T6.m20">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">1.013<Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T6.m21">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPANP (ours)</text></p>
                </inline-block></td>
              <td align="right" border="bb">1.379<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A2.T6.m22">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.645</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A2.T6.m23">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="bb"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.046</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.002}" text="plus-or-minus 0.002" xml:id="A2.T6.m24">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.002" role="NUMBER">0.002</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
          </tbody>
        </tabular>
<!--  %**** additionalexperiments.tex Line 50 **** -->      </table>
    </subsection>
    <subsection inlist="toc" labels="LABEL:app:sec:additional_experiments:imagecompletion" xml:id="A2.SS3">
      <tags>
        <tag>B.3</tag>
        <tag role="autoref">subsection B.3</tag>
        <tag role="refnum">B.3</tag>
        <tag role="typerefnum">§B.3</tag>
      </tags>
      <title><tag close=" ">B.3</tag>Image Completion</title>
      <figure inlist="lof" labels="LABEL:figure/app_visualize_mnist" placement="t" xml:id="A2.F6">
        <tags>
          <tag><text fontsize="90%">Figure 6</text></tag>
          <tag role="autoref">Figure 6</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Figure 6</tag>
        </tags>
        <graphics candidates="figure/app_visualize_mnist.pdf" class="ltx_centering" graphic="figure/app_visualize_mnist.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F6.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">6</tag>Predicted mean and standard deviation of image pixels by trained <ERROR class="undefined">\glspl</ERROR>mpnp with MNIST dataset. The first column shows the real image from test dataset. The second column shows the context dataset which given to the models. The third and the forth columns show the predicted mean and standard deviation from the <ERROR class="undefined">\gls</ERROR>mpnp respectively. The fifth and the sixth columns show the predicted mean and standard deviation from the <ERROR class="undefined">\gls</ERROR>mpanp.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 6</text></tag><text fontsize="90%">Predicted mean and standard deviation of image pixels by trained <ERROR class="undefined">\glspl</ERROR>mpnp with MNIST dataset. The first column shows the real image from test dataset. The second column shows the context dataset which given to the models. The third and the forth columns show the predicted mean and standard deviation from the <ERROR class="undefined">\gls</ERROR>mpnp respectively. The fifth and the sixth columns show the predicted mean and standard deviation from the <ERROR class="undefined">\gls</ERROR>mpanp.</text></caption>
      </figure>
      <figure inlist="lof" labels="LABEL:figure/app_visualize_celeba" xml:id="A2.F7">
        <tags>
          <tag><text fontsize="90%">Figure 7</text></tag>
          <tag role="autoref">Figure 7</tag>
          <tag role="refnum">7</tag>
          <tag role="typerefnum">Figure 7</tag>
        </tags>
        <graphics candidates="figure/app_visualize_celeba.pdf" class="ltx_centering" graphic="figure/app_visualize_celeba.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F7.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">7</tag>Predicted mean of image pixels by trained <ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>anp, <ERROR class="undefined">\gls</ERROR>banp and <ERROR class="undefined">\gls</ERROR>mpanp model. (Column 1) Here we can see the 5 ground truth real image from the test dataset. (Column 2) The context set which given to the models. (Column 3-6) The predicted mean of image pixels by each models.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 7</text></tag><text fontsize="90%">Predicted mean of image pixels by trained <ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>anp, <ERROR class="undefined">\gls</ERROR>banp and <ERROR class="undefined">\gls</ERROR>mpanp model. (Column 1) Here we can see the 5 ground truth real image from the test dataset. (Column 2) The context set which given to the models. (Column 3-6) The predicted mean of image pixels by each models.</text></caption>
      </figure>
      <paragraph inlist="toc" xml:id="A2.SS3.SSS0.Px1">
        <title>MNIST</title>
        <para xml:id="A2.SS3.SSS0.Px1.p1">
          <p>We provide some completed MNIST images in <ref labelref="LABEL:figure/app_visualize_mnist" show="creftype~refnum"/>. It shows that both <ERROR class="undefined">\gls</ERROR>mpnp and <ERROR class="undefined">\gls</ERROR>mpanp successfully fill up the remaining parts of the image for a given context and capture the uncertainties as predictive variances.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A2.SS3.SSS0.Px2">
        <title>CelebA</title>
        <para xml:id="A2.SS3.SSS0.Px2.p1">
          <p>We also present five examples from the CelebA dataset in <ref labelref="LABEL:figure/app_visualize_celeba" show="creftype~refnum"/>. It shows that <ERROR class="undefined">\gls</ERROR>mpanp provides perceptually reasonable predictions even for complex three-channel images.</p>
        </para>
<!--  %In this section, we presents some examples of the visualizations of completed images along with the uncertainties in terms of predictive variances. 
     %We report 8 samples for the MNIST dataset. 
     %In “cref–figure/app˙visualize˙mnist˝, we report the results for the image completion with MNIST test dataset. 
     %Here we can see that both the “gls–mpnp˝ and the “gls–mpanp˝ well complete the remain parts of the image and well capture the uncertainties in terms of predictive variances. -->      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:app:sec:additional_experiments:bo" xml:id="A2.SS4">
      <tags>
        <tag>B.4</tag>
        <tag role="autoref">subsection B.4</tag>
        <tag role="refnum">B.4</tag>
        <tag role="typerefnum">§B.4</tag>
      </tags>
      <title><tag close=" ">B.4</tag>Bayesian Optimization</title>
      <figure inlist="lof" labels="LABEL:figure/app_bo_sob" xml:id="A2.F8">
        <tags>
          <tag><text fontsize="90%">Figure 8</text></tag>
          <tag role="autoref">Figure 8</tag>
          <tag role="refnum">8</tag>
          <tag role="typerefnum">Figure 8</tag>
        </tags>
        <graphics candidates="figure/app_bo_sob_np.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/app_bo_sob_np.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="A2.F8.g1"/>
        <graphics candidates="figure/app_bo_sob_anp.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/app_bo_sob_anp.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="A2.F8.g2"/>
        <toccaption class="ltx_centering"><tag close=" ">8</tag>Results for Bayesian optimization on <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 8</text></tag><text fontsize="90%">Results for Bayesian optimization on <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function.</text></caption>
      </figure>
      <para xml:id="A2.SS4.p1">
        <p>We provide the results for Bayesian optimization on the <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function in <ref labelref="LABEL:figure/app_bo_sob" show="creftype~refnum"/>. Our <ERROR class="undefined">\glspl</ERROR>mpnp consistently outperform baselines as discussed in <ref labelref="LABEL:main:sec:experiments:bo" show="creftype~refnum"/>. We also present the visual results for Bayesian optimization in <ref labelref="LABEL:figure/app_visualize_bo_np" show="creftypeplural~refnum"/><ERROR class="undefined">\crefpairconjunction</ERROR><ref labelref="LABEL:figure/app_visualize_bo_anp" show="refnum"/>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:figure/app_visualize_bo_np" xml:id="A2.F9">
        <tags>
          <tag><text fontsize="90%">Figure 9</text></tag>
          <tag role="autoref">Figure 9</tag>
          <tag role="refnum">9</tag>
          <tag role="typerefnum">Figure 9</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="A2.F9.sf1">
          <tags>
            <tag><text fontsize="90%">(a)</text></tag>
            <tag role="autoref">9(a)</tag>
            <tag role="refnum">9(a)</tag>
          </tags>
          <graphics candidates="figure/app_visualize_bo_gram_np.pdf" graphic="figure/app_visualize_bo_gram_np.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F9.sf1.g1"/>
          <toccaption><tag close=" ">(a)</tag><cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function</toccaption>
          <caption><tag close=" "><text fontsize="90%">(a)</text></tag><cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase><text fontsize="90%">[</text></bibrefphrase>
                <bibrefphrase><text fontsize="90%">]</text></bibrefphrase>
              </bibref></cite><text fontsize="90%"> function</text></caption>
        </figure>
        <break class="ltx_centering"/>
        <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="A2.F9.sf2">
          <tags>
            <tag><text fontsize="90%">(b)</text></tag>
            <tag role="autoref">9(b)</tag>
            <tag role="refnum">9(b)</tag>
          </tags>
          <graphics candidates="figure/app_visualize_bo_sob_np.pdf" graphic="figure/app_visualize_bo_sob_np.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F9.sf2.g1"/>
          <toccaption><tag close=" ">(b)</tag><cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function</toccaption>
          <caption><tag close=" "><text fontsize="90%">(b)</text></tag><cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase><text fontsize="90%">[</text></bibrefphrase>
                <bibrefphrase><text fontsize="90%">]</text></bibrefphrase>
              </bibref></cite><text fontsize="90%"> function</text></caption>
        </figure>
        <toccaption class="ltx_centering"><tag close=" ">9</tag>It depicts 10 solutions predicted by <ERROR class="undefined">\gls</ERROR>cnp, <ERROR class="undefined">\gls</ERROR>np, <ERROR class="undefined">\gls</ERROR>bnp, and <ERROR class="undefined">\gls</ERROR>mpnp. (a,b) Predicted results for <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function and <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function, respectively. (Row 1) Black circles indicate the whole initial points. (Row 2) It shows the 10 best solutions predicted by each models after the 5 iterations. (Row 3) It shows the 10 best solutions predicted by each models after the whole iterations.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 9</text></tag><text fontsize="90%">It depicts 10 solutions predicted by <ERROR class="undefined">\gls</ERROR>cnp, <ERROR class="undefined">\gls</ERROR>np, <ERROR class="undefined">\gls</ERROR>bnp, and <ERROR class="undefined">\gls</ERROR>mpnp. (a,b) Predicted results for <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function and <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function, respectively. (Row 1) Black circles indicate the whole initial points. (Row 2) It shows the 10 best solutions predicted by each models after the 5 iterations. (Row 3) It shows the 10 best solutions predicted by each models after the whole iterations.</text></caption>
      </figure>
      <figure inlist="lof" labels="LABEL:figure/app_visualize_bo_anp" xml:id="A2.F10">
        <tags>
          <tag><text fontsize="90%">Figure 10</text></tag>
          <tag role="autoref">Figure 10</tag>
          <tag role="refnum">10</tag>
          <tag role="typerefnum">Figure 10</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="A2.F10.sf1">
          <tags>
            <tag><text fontsize="90%">(a)</text></tag>
            <tag role="autoref">10(a)</tag>
            <tag role="refnum">10(a)</tag>
          </tags>
          <graphics candidates="figure/app_visualize_bo_gram_anp.pdf" graphic="figure/app_visualize_bo_gram_anp.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F10.sf1.g1"/>
          <toccaption><tag close=" ">(a)</tag><cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function</toccaption>
          <caption><tag close=" "><text fontsize="90%">(a)</text></tag><cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase><text fontsize="90%">[</text></bibrefphrase>
                <bibrefphrase><text fontsize="90%">]</text></bibrefphrase>
              </bibref></cite><text fontsize="90%"> function</text></caption>
        </figure>
        <break class="ltx_centering"/>
        <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="A2.F10.sf2">
          <tags>
            <tag><text fontsize="90%">(b)</text></tag>
            <tag role="autoref">10(b)</tag>
            <tag role="refnum">10(b)</tag>
          </tags>
          <graphics candidates="figure/app_visualize_bo_sob_anp.pdf" graphic="figure/app_visualize_bo_sob_anp.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F10.sf2.g1"/>
          <toccaption><tag close=" ">(b)</tag><cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function</toccaption>
          <caption><tag close=" "><text fontsize="90%">(b)</text></tag><cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase><text fontsize="90%">[</text></bibrefphrase>
                <bibrefphrase><text fontsize="90%">]</text></bibrefphrase>
              </bibref></cite><text fontsize="90%"> function</text></caption>
        </figure>
<!--  %**** additionalexperiments.tex Line 125 **** -->        <toccaption class="ltx_centering"><tag close=" ">10</tag>It depicts 10 solutions predicted by <ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>anp, <ERROR class="undefined">\gls</ERROR>banp, and <ERROR class="undefined">\gls</ERROR>mpanp. (a,b) Predicted results for <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function and <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function, respectively. (Row 1) Black circles indicate the whole initial points. (Row 2) It shows the 10 best solutions predicted by each models after the 5 iterations. (Row 3) It shows the 10 best solutions predicted by each models after the whole iterations.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 10</text></tag><text fontsize="90%">It depicts 10 solutions predicted by <ERROR class="undefined">\gls</ERROR>canp, <ERROR class="undefined">\gls</ERROR>anp, <ERROR class="undefined">\gls</ERROR>banp, and <ERROR class="undefined">\gls</ERROR>mpanp. (a,b) Predicted results for <cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function and <cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>[</bibrefphrase>
                <bibrefphrase>]</bibrefphrase>
              </bibref></cite> function, respectively. (Row 1) Black circles indicate the whole initial points. (Row 2) It shows the 10 best solutions predicted by each models after the 5 iterations. (Row 3) It shows the 10 best solutions predicted by each models after the whole iterations.</text></caption>
      </figure>
<!--  %Here as the generator increases the size of the encoder in “glspl–mpnp˝, we also increase the size of the encoder of the baselines for the fare comparisons. 
     %As you can see in “cref–tab:table˙gp˙inf˙eq˝, our model still significantly outperforms the baselines. 
     %“begin–table˝[t] 
     %“caption–Context and target log likelihood values on data sampled from Gaussian Processes with various kernel. Here we used almost the same number of parameters for models. Performances are measured over 4 seeds.““˝ 
     %“label–tab:table˙gp˙inf˙eq˝ 
     %“centering 
     %“scriptsize 
     %“renewcommand–“arraystretch˝–0.9˝ 
     %“resizebox–0.95“textwidth˝–!˝– 
     %“begin–tabular˝–lrrrrrrrrrrrr˝ 
     %“toprule 
     %“multirow–3˝–*˝–Model˝ &amp; “multicolumn–2˝–r˝–RBF˝                                   &amp; “multicolumn–2˝–r˝–Matern˝                                &amp; “multicolumn–2˝–r˝–Periodic˝                                &amp; “multicolumn–2˝–r˝–$t$-noise˝                               ““ 
     %“cmidrule(lr)–2-3˝                                          “cmidrule(lr)–4-5˝                                          “cmidrule(lr)–6-7˝                                            “cmidrule(lr)–8-9˝ 
     %&amp; context                     &amp; target                      &amp; context                     &amp; target                      &amp; context                      &amp; target                       &amp; context                      &amp; target                       ““ 
     %“midrule 
     %CNP                    &amp;         0.983  $“pm–0.006˝$ &amp;         0.298  $“pm–0.006˝$ &amp;         0.889  $“pm–0.010˝$ &amp;         0.140  $“pm–0.003˝$ &amp;         -0.091  $“pm–0.010˝$ &amp;         -0.742  $“pm–0.039˝$ &amp;         -0.032  $“pm–0.021˝$ &amp;         -0.724  $“pm–0.018˝$ ““ 
     %NP                     &amp;         0.984  $“pm–0.010˝$ &amp;         0.308  $“pm–0.008˝$ &amp;         0.876  $“pm–0.004˝$ &amp;         0.148  $“pm–0.006˝$ &amp;         -0.325  $“pm–0.049˝$ &amp;         -0.698  $“pm–0.035˝$ &amp;         -0.016  $“pm–0.022˝$ &amp;         -0.677  $“pm–0.039˝$ ““ 
     %**** additionalexperiments.tex Line 150 **** 
     %BNP                    &amp;         1.042  $“pm–0.007˝$ &amp;         0.371  $“pm–0.003˝$ &amp;         0.904  $“pm–0.013˝$ &amp;         0.176  $“pm–0.006˝$ &amp;         -0.087  $“pm–0.004˝$ &amp;         -0.738  $“pm–0.022˝$ &amp;         -0.042  $“pm–0.051˝$ &amp;         -0.664  $“pm–0.021˝$ ““ 
     %% NeuBNP                 &amp;         0.954  $“pm–0.010˝$ &amp;         0.284  $“pm–0.004˝$ &amp;         0.861  $“pm–0.014˝$ &amp;         0.130  $“pm–0.003˝$ &amp;         -0.176  $“pm–0.028˝$ &amp;         -0.797  $“pm–0.015˝$ &amp;         -0.066  $“pm–0.013˝$ &amp;         -0.683  $“pm–0.096˝$ ““ 
     %MPNP (ours)            &amp; “textBF–1.086˝ $“pm–0.005˝$ &amp; “textBF–0.457˝ $“pm–0.002˝$ &amp; “textBF–1.005˝ $“pm–0.014˝$ &amp; “textBF–0.278˝ $“pm–0.006˝$ &amp; “textBF–-0.017˝ $“pm–0.013˝$ &amp; “textBF–-0.681˝ $“pm–0.009˝$ &amp; “textBF– 0.119˝ $“pm–0.025˝$ &amp; “textBF–-0.381˝ $“pm–0.013˝$ ““ 
     %“cmidrule(lr)–1-1˝       “cmidrule(lr)–2-3˝                                          “cmidrule(lr)–4-5˝                                          “cmidrule(lr)–6-7˝                                            “cmidrule(lr)–8-9˝ 
     %CANP                   &amp;         1.372  $“pm–0.001˝$ &amp;         0.625  $“pm–0.005˝$ &amp;         1.370  $“pm–0.002˝$ &amp;         0.429  $“pm–0.016˝$ &amp;          1.157  $“pm–0.051˝$ &amp;         -0.748  $“pm–0.037˝$ &amp;          0.309  $“pm–0.065˝$ &amp;         -0.804  $“pm–0.049˝$ ““ 
     %ANP                    &amp;         1.374  $“pm–0.001˝$ &amp;         0.648  $“pm–0.016˝$ &amp;         1.371  $“pm–0.002˝$ &amp;         0.462  $“pm–0.020˝$ &amp;          1.191  $“pm–0.054˝$ &amp;         -0.709  $“pm–0.024˝$ &amp;          0.695  $“pm–0.048˝$ &amp;         -0.750  $“pm–0.082˝$ ““ 
     %BANP                   &amp;         1.372  $“pm–0.000˝$ &amp;         0.653  $“pm–0.014˝$ &amp;         1.370  $“pm–0.002˝$ &amp;         0.450  $“pm–0.006˝$ &amp; “textBF– 1.243˝ $“pm–0.083˝$ &amp;         -0.647  $“pm–0.028˝$ &amp;          0.437  $“pm–0.034˝$ &amp;         -0.645  $“pm–0.057˝$ ““ 
     %% NeuBANP                &amp;         1.358  $“pm–0.001˝$ &amp;         0.661  $“pm–0.003˝$ &amp;         1.352  $“pm–0.001˝$ &amp;         0.477  $“pm–0.004˝$ &amp;          0.721  $“pm–0.018˝$ &amp;         -0.790  $“pm–0.007˝$ &amp;          0.763  $“pm–0.060˝$ &amp;         -0.460  $“pm–0.019˝$ ““ 
     %MPANP (ours)           &amp; “textBF–1.374˝ $“pm–0.000˝$ &amp; “textBF–0.698˝ $“pm–0.007˝$ &amp; “textBF–1.373˝ $“pm–0.001˝$ &amp; “textBF–0.501˝ $“pm–0.005˝$ &amp;          1.167  $“pm–0.047˝$ &amp; “textBF–-0.628˝ $“pm–0.027˝$ &amp; “textBF– 0.773˝ $“pm–0.039˝$ &amp; “textBF–-0.446˝ $“pm–0.057˝$ ““ 
     %% CNP                    &amp;         0.964  $“pm–0.006˝$ &amp;         0.288  $“pm–0.006˝$ &amp;         0.859  $“pm–0.009˝$ &amp;         0.124  $“pm–0.011˝$ &amp;         -0.139  $“pm–0.007˝$ &amp;         -0.742  $“pm–0.011˝$ &amp;         -0.012  $“pm–0.021˝$ &amp;         -0.760  $“pm–0.025˝$ ““ 
     %% NP                     &amp;         0.953  $“pm–0.003˝$ &amp;         0.306  $“pm–0.004˝$ &amp;         0.842  $“pm–0.015˝$ &amp;         0.133  $“pm–0.008˝$ &amp;         -0.346  $“pm–0.026˝$ &amp;         -0.698  $“pm–0.007˝$ &amp;         -0.018  $“pm–0.022˝$ &amp;         -0.656  $“pm–0.028˝$ ““ 
     %% BNP                    &amp;         1.020  $“pm–0.006˝$ &amp;         0.372  $“pm–0.006˝$ &amp;         0.929  $“pm–0.008˝$ &amp;         0.206  $“pm–0.006˝$ &amp;         -0.036  $“pm–0.031˝$ &amp;         -0.738  $“pm–0.011˝$ &amp;         -0.051  $“pm–0.051˝$ &amp;         -0.670  $“pm–0.023˝$ ““ 
     %% NeuBNP                 &amp;         0.929  $“pm–0.011˝$ &amp;         0.275  $“pm–0.007˝$ &amp;         0.834  $“pm–0.008˝$ &amp;         0.122  $“pm–0.004˝$ &amp;         -0.231  $“pm–0.010˝$ &amp;         -0.785  $“pm–0.023˝$ &amp;          0.038  $“pm–0.009˝$ &amp;         -0.516  $“pm–0.018˝$ ““ 
     %% MPNP (ours)            &amp; “textBF–1.086˝ $“pm–0.005˝$ &amp; “textBF–0.457˝ $“pm–0.002˝$ &amp; “textBF–1.005˝ $“pm–0.014˝$ &amp; “textBF–0.278˝ $“pm–0.006˝$ &amp; “textBF–-0.017˝ $“pm–0.013˝$ &amp; “textBF–-0.681˝ $“pm–0.009˝$ &amp; “textBF– 0.119˝ $“pm–0.025˝$ &amp; “textBF–-0.381˝ $“pm–0.013˝$ ““ 
     %% “cmidrule(lr)–1-1˝       “cmidrule(lr)–2-3˝                                          “cmidrule(lr)–4-5˝                                          “cmidrule(lr)–6-7˝                                            “cmidrule(lr)–8-9˝ 
     %% CANP                   &amp;         1.372  $“pm–0.000˝$ &amp;         0.611  $“pm–0.008˝$ &amp;         1.370  $“pm–0.001˝$ &amp;         0.423  $“pm–0.004˝$ &amp;          1.168  $“pm–0.051˝$ &amp;         -0.747  $“pm–0.037˝$ &amp;          0.404  $“pm–0.057˝$ &amp;         -1.036  $“pm–0.103˝$ ““ 
     %% ANP                    &amp;         1.372  $“pm–0.003˝$ &amp;         0.617  $“pm–0.027˝$ &amp;         1.372  $“pm–0.001˝$ &amp;         0.432  $“pm–0.025˝$ &amp; “textBF–1.178˝  $“pm–0.054˝$ &amp;         -0.719  $“pm–0.024˝$ &amp;          0.708  $“pm–0.054˝$ &amp;         -0.728  $“pm–0.093˝$ ““ 
     %% BANP                   &amp; “textBF–1.374˝ $“pm–0.001˝$ &amp;         0.663  $“pm–0.002˝$ &amp;         1.371  $“pm–0.002˝$ &amp;         0.472  $“pm–0.003˝$ &amp;          0.754  $“pm–0.083˝$ &amp;         -0.913  $“pm–0.028˝$ &amp;          0.477  $“pm–0.008˝$ &amp;         -0.660  $“pm–0.059˝$ ““ 
     %% NeuBANP                &amp;         1.357  $“pm–0.002˝$ &amp;         0.651  $“pm–0.005˝$ &amp;         1.352  $“pm–0.002˝$ &amp;         0.473  $“pm–0.007˝$ &amp;          0.697  $“pm–0.022˝$ &amp;         -0.779  $“pm–0.013˝$ &amp;          0.670  $“pm–0.028˝$ &amp;         -0.450  $“pm–0.014˝$ ““ 
     %% MPANP (ours)           &amp; “textBF–1.374˝ $“pm–0.000˝$ &amp; “textBF–0.698˝ $“pm–0.007˝$ &amp; “textBF–1.373˝ $“pm–0.001˝$ &amp; “textBF–0.501˝ $“pm–0.005˝$ &amp;         1.167 $“pm–0.047˝$ &amp; “textBF–-0.628˝ $“pm–0.027˝$ &amp; “textBF– 0.773˝ $“pm–0.039˝$ &amp; “textBF–-0.446˝ $“pm–0.057˝$ ““ 
     %“bottomrule 
     %“end–tabular˝˝ 
     %“end–table˝ 
     %In this section, we report the experiment results with the baselines with increased number of parameters to match the additional number of parameters introduced for the generator in “glspl–mpnp˝. 
     %Here as the generator increases the size of the encoder in “glspl–mpnp˝, we also increase the size of the encoder of the baselines for the fare comparisons. 
     %**** additionalexperiments.tex Line 175 **** 
     %As you can see in “cref–tab:table˙gp˙inf˙eq˝, our model still significantly outperforms the baselines. 
     %“subsection–Finite Training Dataset Other Kernels˝ 
     %“begin–figure˝[t] 
     %“centering 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙ctx˙cnps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙tar˙cnps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙ctx˙canps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙tar˙canps.pdf˝ 
     %“includegraphics[width=“textwidth]–figure/out˙matern.pdf˝ 
     %“caption–Results of Finite Training Dataset experiments with Matern 5/2 kernel.˝ 
     %“label–fig:figure˙gp˙finite˙matern˝ 
     %“end–figure˝ 
     %“begin–figure˝[t] 
     %“centering 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙ctx˙cnps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙tar˙cnps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙ctx˙canps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙tar˙canps.pdf˝ 
     %“includegraphics[width=“textwidth]–figure/out˙periodic.pdf˝ 
     %“caption–Results of Finite Training Dataset experiments with Periodic kernel.˝ 
     %“label–fig:figure˙gp˙finite˙periodic˝ 
     %“end–figure˝ 
     %“begin–figure˝[t] 
     %“centering 
     %**** additionalexperiments.tex Line 200 **** 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙ctx˙cnps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙tar˙cnps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙ctx˙canps.pdf˝ 
     %% “includegraphics[width=0.24“textwidth]–figure/gp˙finite/rbf˙tar˙canps.pdf˝ 
     %“includegraphics[width=“textwidth]–figure/out˙t˙noise.pdf˝ 
     %“caption–Results of Finite Training Dataset experiments with RBF kernel with Students’ $t$ distributed noise.˝ 
     %“label–fig:figure˙gp˙finite˙t˙noise˝ 
     %“end–figure˝ 
     %In this section, we presents the remain results of Finite Training Dataset in “cref–main:subsec:infinite˙training˝ for the kernels other than RBF. 
     %Here as you can see in “cref–fig:figure˙gp˙finite˙matern˝, “cref–fig:figure˙gp˙finite˙periodic˝ and “cref–fig:figure˙gp˙finite˙t˙noise˝, “glspl–mpnp˝ consistently outperforms the baselines. 
     %“subsection–Predator-Prey Model˝ 
     %“label–app:subsec:predator-prey˝ 
     %“input–table/table˙lotka˝ 
     %Following “citet–lee2020bootstrapping˝, we conducted the predator-prey population regression experiments. 
     %We first trained the models using the simulation datasets which are generated from a Lotka-Volterra model~“citep–wilkinson2018stochastic˝ with the simulation settings followed by “citet–lee2020bootstrapping˝. Then tested on the generated simulation test dataset and real-world dataset which is called Hudson’s Bay hare-lynx data. 
     %As mentioned in “citet–lee2020bootstrapping˝, the real-world dataset shows different tendency from generated simulation datasets, so we can also treat this experiment as model-data mismatch experiments. 
     %In “cref–tab:table˙lotka˝, we can see that “glspl–mpnp˝ outperforms the other baselines for the test simulation datasets but underperforms in the real-world dataset compare to other baselines especially in the “gls–mpanp˝ case. 
     %This also shows that model-data mismatch is an open problem for the “glspl–mpnp˝. -->    </subsection>
  </appendix>
  <appendix inlist="toc" labels="LABEL:app:sec:details" xml:id="A3">
    <tags>
      <tag>Appendix C</tag>
      <tag role="autoref">Appendix C</tag>
      <tag role="refnum">C</tag>
      <tag role="typerefnum">Appendix C</tag>
    </tags>
    <title><tag close=" ">Appendix C</tag>Experimental Details</title>
    <toctitle><tag close=" ">C</tag>Experimental Details</toctitle>
    <para xml:id="A3.p1">
      <p><!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->We attached our code in supplementary material. Our codes used python libraries JAX <cite class="ltx_citemacro_citep">[<bibref bibrefs="jax2018github" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>, Flax <cite class="ltx_citemacro_citep">[<bibref bibrefs="flax2020github" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> and Optax <cite class="ltx_citemacro_citep">[<bibref bibrefs="optax2020github" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite>.
These python libraries are available under the Apache-2.0 license<note mark="1" role="footnote" xml:id="footnote1"><tags>
            <tag>1</tag>
            <tag role="autoref">footnote 1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">footnote 1</tag>
          </tags><ref class="ltx_href" href="https://www.apache.org/licenses/LICENSE-2.0">https://www.apache.org/licenses/LICENSE-2.0</ref></note>.</p>
    </para>
    <para xml:id="A3.p2">
      <p>We conducted all experiments on a single NVIDIA GeForce RTX 3090 GPU, except for the image completion tasks presented in <ref labelref="LABEL:main:sec:experiments:imagecompletion" show="creftype~refnum"/>; we used 8 TPUv3 cores supported by TPU Research Cloud<note mark="2" role="footnote" xml:id="footnote2"><tags>
            <tag>2</tag>
            <tag role="autoref">footnote 2</tag>
            <tag role="refnum">2</tag>
            <tag role="typerefnum">footnote 2</tag>
          </tags><ref class="ltx_href" href="https://sites.research.google/trc/about/">https://sites.research.google/trc/about/</ref></note> for the 2D image completion task. For optimization, we used Adam <cite class="ltx_citemacro_citep">[<bibref bibrefs="kingma2015adam" separator="," show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>]</cite> optimizer with a cosine learning rate schedule. Unless specified, we selected the base learning rate from a grid of <Math mode="inline" tex="\{5\times 10^{-4.50},5\times 10^{-4.25},5\times 10^{-4.00},5\times 10^{-3.75},%&#10;5\times 10^{-3.50}\}" text="set@(5 * 10 ^ (- 4.50), 5 * 10 ^ (- 4.25), 5 * 10 ^ (- 4.00), 5 * 10 ^ (- 3.75), 5 * 10 ^ (- 3.50))" xml:id="A3.p2.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="set"/>
                <XMRef idref="A3.p2.m1.1"/>
                <XMRef idref="A3.p2.m1.2"/>
                <XMRef idref="A3.p2.m1.3"/>
                <XMRef idref="A3.p2.m1.4"/>
                <XMRef idref="A3.p2.m1.5"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">{</XMTok>
                <XMApp xml:id="A3.p2.m1.1">
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="5" role="NUMBER">5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="4.50" role="NUMBER">4.50</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="A3.p2.m1.2">
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="5" role="NUMBER">5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="4.25" role="NUMBER">4.25</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="A3.p2.m1.3">
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="5" role="NUMBER">5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="4.00" role="NUMBER">4.00</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="A3.p2.m1.4">
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="5" role="NUMBER">5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="3.75" role="NUMBER">3.75</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="A3.p2.m1.5">
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="5" role="NUMBER">5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="3.50" role="NUMBER">3.50</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">}</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> based on validation task log-likelihood.</p>
    </para>
<!--  %For all experiments, we use Adam optimizer with learning rate $5 “cdot 10^–-4˝$. For image completion tasks, we also use cosine learning rate scheduling. 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %“subsection–Experimental Resources˝ 
     %We conduct most of the experiments on 8 TPUv3 cores, supported by TPU Research Cloud“footnote–“href–https://sites.research.google/trc/about/˝–https://sites.research.google/trc/about/˝˝ and the others on 8 RTX3090 cores. -->    <subsection inlist="toc" xml:id="A3.SS1">
      <tags>
        <tag>C.1</tag>
        <tag role="autoref">subsection C.1</tag>
        <tag role="refnum">C.1</tag>
        <tag role="typerefnum">§C.1</tag>
      </tags>
      <title><tag close=" ">C.1</tag>Evaluation metric</title>
      <para xml:id="A3.SS1.p1">
        <p>Following <cite class="ltx_citemacro_citet"><bibref bibrefs="le2018empirical" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite>, for <ERROR class="undefined">\gls</ERROR>cnp and <ERROR class="undefined">\gls</ERROR>canp, which are deterministic models, we used the normalized predictive log-likelihood <Math mode="inline" tex="\frac{1}{n}\sum_{i=1}^{n}\log p(y_{i}|x_{i},Z_{c})" text="(1 / n) * ((sum _ (i = 1)) ^ n)@(logarithm@(p) * conditional@(y _ i, list@(x _ i, Z _ c)))" xml:id="A3.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A3.SS1.p1.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A3.SS1.p1.m1.1">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A3.SS1.p1.m1.1.1"/>
                              <XMRef idref="A3.SS1.p1.m1.1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="A3.SS1.p1.m1.1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A3.SS1.p1.m1.1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. For other models, we used a approximation of the normalized predictive log-likelihood as:</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx33">
          <equation xml:id="A3.E21">
            <tags>
              <tag>(21)</tag>
              <tag role="autoref">Equation 21</tag>
              <tag role="refnum">21</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\frac{1}{n}\sum_{i=1}^{n}\log p(y_{i}|x_{i},Z_{c})\approx\frac{1}%&#10;{n}\sum_{i=1}^{n}\log\frac{1}{K}\sum_{k=1}^{K}p(y_{i}|x_{i},\theta^{(k)})," text="(1 / n) * ((sum _ (i = 1)) ^ n)@(logarithm@(p) * conditional@(y _ i, list@(x _ i, Z _ c))) approximately-equals (1 / n) * ((sum _ (i = 1)) ^ n)@(logarithm@(1 / K) * ((sum _ (k = 1)) ^ K)@(p * conditional@(y _ i, list@(x _ i, theta ^ k))))" xml:id="A3.E21.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="A3.E21.m2.2"/>
                    <XMWrap>
                      <XMApp xml:id="A3.E21.m2.2">
                        <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.E21.m2.2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.E21.m2.2.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="A3.E21.m2.2.1.1"/>
                                        <XMRef idref="A3.E21.m2.2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A3.E21.m2.2.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A3.E21.m2.2.1.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMDual>
                                    <XMRef idref="A3.E21.m2.2.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.E21.m2.2.2">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A3.E21.m2.2.2.1"/>
                                            <XMRef idref="A3.E21.m2.2.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A3.E21.m2.2.2.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A3.E21.m2.2.2.2">
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                              <XMDual>
                                                <XMRef idref="A3.E21.m2.1"/>
                                                <XMWrap>
                                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E21.m2.1">k</XMTok>
                                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\frac{1}{n}\sum_{i=1}^{n}\log p(y_{i}|x_{i},Z_{c})\approx\frac{1}%&#10;{n}\sum_{i=1}^{n}\log\frac{1}{K}\sum_{k=1}^{K}p(y_{i}|x_{i},\theta^{(k)})," text="(1 / n) * ((sum _ (i = 1)) ^ n)@(logarithm@(p) * conditional@(y _ i, list@(x _ i, Z _ c))) approximately-equals (1 / n) * ((sum _ (i = 1)) ^ n)@(logarithm@(1 / K) * ((sum _ (k = 1)) ^ K)@(p * conditional@(y _ i, list@(x _ i, theta ^ k))))" xml:id="A3.E21.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="A3.E21.m1.2"/>
                        <XMWrap>
                          <XMApp xml:id="A3.E21.m1.2">
                            <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.E21.m1.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.E21.m1.2.1">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A3.E21.m1.2.1.1"/>
                                            <XMRef idref="A3.E21.m1.2.1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A3.E21.m1.2.1.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A3.E21.m1.2.1.2">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMDual>
                                        <XMRef idref="A3.E21.m1.2.2"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.E21.m1.2.2">
                                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="list"/>
                                                <XMRef idref="A3.E21.m1.2.2.1"/>
                                                <XMRef idref="A3.E21.m1.2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A3.E21.m1.2.2.1">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A3.E21.m1.2.2.2">
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A3.E21.m1.1"/>
                                                    <XMWrap>
                                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E21.m1.1">k</XMTok>
                                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\theta^{k}" text="theta ^ k" xml:id="A3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>s are independent samples for <Math mode="inline" tex="k\in[K]" text="k element-of delimited-[]@(K)" xml:id="A3.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="A3.SS1.p1.m3.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.p1.m3.1">K</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS2">
      <tags>
        <tag>C.2</tag>
        <tag role="autoref">subsection C.2</tag>
        <tag role="refnum">C.2</tag>
        <tag role="typerefnum">§C.2</tag>
      </tags>
      <title><tag close=" ">C.2</tag>1D Regression</title>
      <para xml:id="A3.SS2.p1">
        <p>To generate tasks <Math mode="inline" tex="(Z,c)" text="open-interval@(Z, c)" xml:id="A3.SS2.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A3.SS2.p1.m1.1"/>
                  <XMRef idref="A3.SS2.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m1.1">Z</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m1.2">c</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, we first sample <Math class="ltx_math_unparsed" mode="inline" tex="x\overset{\mathrm{i.i.d.}}{\sim}\text{Unif}(-2,2)" text="x * i@.@i@.@d@.@(similar-to) * [Unif] * open-interval@(- 2, 2)" xml:id="A3.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMApp>
                  <XMWrap role="OVERACCENT">
                    <XMTok role="UNKNOWN" xml:id="A3.SS2.p1.m2.1">i</XMTok>
                    <XMTok role="PERIOD">.</XMTok>
                    <XMTok role="UNKNOWN" xml:id="A3.SS2.p1.m2.2">i</XMTok>
                    <XMTok role="PERIOD">.</XMTok>
                    <XMTok role="UNKNOWN" xml:id="A3.SS2.p1.m2.3">d</XMTok>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                  <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                </XMApp>
                <XMText>Unif</XMText>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A3.SS2.p1.m2.5"/>
                    <XMRef idref="A3.SS2.p1.m2.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A3.SS2.p1.m2.5">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="2" role="NUMBER" xml:id="A3.SS2.p1.m2.4">2</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and generate <Math mode="inline" tex="Y" text="Y" xml:id="A3.SS2.p1.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
            </XMath>
          </Math> using each kernel. We use RBF kernel <Math mode="inline" tex="k(x,x^{\prime})=s^{2}\cdot\exp\left(\frac{-||x-x^{\prime}||^{2}}{2\ell^{2}}\right)" text="k * open-interval@(x, x ^ prime) = s ^ 2 cdot exponential@((- (norm@(x - x ^ prime)) ^ 2) / (2 * ell ^ 2))" xml:id="A3.SS2.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A3.SS2.p1.m4.2"/>
                      <XMRef idref="A3.SS2.p1.m4.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m4.2">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.p1.m4.5">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMRef idref="A3.SS2.p1.m4.3"/>
                      <XMRef idref="A3.SS2.p1.m4.4"/>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A3.SS2.p1.m4.3">exp</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="A3.SS2.p1.m4.4">
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.SS2.p1.m4.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN">‖</XMTok>
                                  <XMApp xml:id="A3.SS2.p1.m4.1">
                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                      <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMApp>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, Matern <Math mode="inline" tex="5/2" text="5 / 2" xml:id="A3.SS2.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMTok meaning="5" role="NUMBER">5</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> kernel <Math mode="inline" tex="k(x,x^{\prime})=s^{2}\cdot\left(1+\frac{\sqrt{5}d}{\ell}+\frac{5d^{2}}{3\ell^{%&#10;2}}\right)" text="k * open-interval@(x, x ^ prime) = s ^ 2 cdot (1 + (square-root@(5) * d) / ell + (5 * d ^ 2) / (3 * ell ^ 2))" xml:id="A3.SS2.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A3.SS2.p1.m6.1"/>
                      <XMRef idref="A3.SS2.p1.m6.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m6.1">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.p1.m6.2">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A3.SS2.p1.m6.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMApp xml:id="A3.SS2.p1.m6.3">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMApp>
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok meaning="square-root"/>
                              <XMTok fontsize="70%" meaning="5" role="NUMBER">5</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok fontsize="70%" meaning="5" role="NUMBER">5</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, and periodic kernel <Math mode="inline" tex="k(x,x^{\prime})=s^{2}\cdot\exp\left(\frac{-2\sin^{2}(\pi||x-x^{\prime}||^{2}/p%&#10;)}{\ell^{2}}\right)" text="k * open-interval@(x, x ^ prime) = s ^ 2 cdot exponential@((- 2 * (sine ^ 2)@((pi * (norm@(x - x ^ prime)) ^ 2) / p)) / ell ^ 2)" xml:id="A3.SS2.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A3.SS2.p1.m7.3"/>
                      <XMRef idref="A3.SS2.p1.m7.6"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m7.3">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.p1.m7.6">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMRef idref="A3.SS2.p1.m7.4"/>
                      <XMRef idref="A3.SS2.p1.m7.5"/>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A3.SS2.p1.m7.4">exp</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="A3.SS2.p1.m7.5">
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A3.SS2.p1.m7.1"/>
                                  <XMRef idref="A3.SS2.p1.m7.2"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A3.SS2.p1.m7.1">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                    <XMTok fontsize="70%" meaning="sine" role="TRIGFUNCTION">sin</XMTok>
                                    <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.SS2.p1.m7.2">
                                      <XMTok fontsize="70%" meaning="divide" role="MULOP">/</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="norm"/>
                                              <XMRef idref="A3.SS2.p1.m7.2.1"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN">‖</XMTok>
                                              <XMApp xml:id="A3.SS2.p1.m7.2.1">
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE">‖</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                            <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                            <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMApp>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> where all kernels use <Math mode="inline" tex="s\sim\text{Unif}(0.1.1.0)" text="s similar-to [Unif] * 0.1.1.0" xml:id="A3.SS2.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMRef idref="A3.SS2.p1.m8.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0.1.1.0" role="NUMBER" xml:id="A3.SS2.p1.m8.1">0.1.1.0</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\ell\sim\text{Unif}(0.1.0.6)" text="ell similar-to [Unif] * 0.1.0.6" xml:id="A3.SS2.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMRef idref="A3.SS2.p1.m9.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0.1.0.6" role="NUMBER" xml:id="A3.SS2.p1.m9.1">0.1.0.6</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, and <Math mode="inline" tex="p\sim\text{Unif}(0.1.0.5)" text="p similar-to [Unif] * 0.1.0.5" xml:id="A3.SS2.p1.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMRef idref="A3.SS2.p1.m10.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0.1.0.5" role="NUMBER" xml:id="A3.SS2.p1.m10.1">0.1.0.5</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. To generate t-noise dataset, we use Student-<Math mode="inline" tex="t" text="t" xml:id="A3.SS2.p1.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> with degree of freedom <Math mode="inline" tex="2.1" text="2.1" xml:id="A3.SS2.p1.m12">
            <XMath>
              <XMTok meaning="2.1" role="NUMBER">2.1</XMTok>
            </XMath>
          </Math> to sample noise <Math mode="inline" tex="\epsilon\sim\gamma\cdot{\mathcal{T}}(2.1)" text="epsilon similar-to (gamma cdot T) * 2.1" xml:id="A3.SS2.p1.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A3.SS2.p1.m13.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="2.1" role="NUMBER" xml:id="A3.SS2.p1.m13.1">2.1</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="\gamma\sim\text{Unif}(0,0.15)" text="gamma similar-to [Unif] * open-interval@(0, 0.15)" xml:id="A3.SS2.p1.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A3.SS2.p1.m14.1"/>
                      <XMRef idref="A3.SS2.p1.m14.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0" role="NUMBER" xml:id="A3.SS2.p1.m14.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="0.15" role="NUMBER" xml:id="A3.SS2.p1.m14.2">0.15</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Then we add the noise to the curves generated from RBF kernel. We draw index set <Math mode="inline" tex="|c|\sim\text{Unif}(3,50-3)" text="absolute-value@(c) similar-to [Unif] * open-interval@(3, 50 - 3)" xml:id="A3.SS2.p1.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A3.SS2.p1.m15.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m15.1">c</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A3.SS2.p1.m15.2"/>
                      <XMRef idref="A3.SS2.p1.m15.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="3" role="NUMBER" xml:id="A3.SS2.p1.m15.2">3</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.p1.m15.3">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="50" role="NUMBER">50</XMTok>
                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="n-|c|\sim\text{Unif}(3,50-|c|)" text="n - absolute-value@(c) similar-to [Unif] * open-interval@(3, 50 - absolute-value@(c))" xml:id="A3.SS2.p1.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="A3.SS2.p1.m16.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m16.1">c</XMTok>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Unif</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A3.SS2.p1.m16.3"/>
                      <XMRef idref="A3.SS2.p1.m16.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="3" role="NUMBER" xml:id="A3.SS2.p1.m16.3">3</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.p1.m16.4">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="50" role="NUMBER">50</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="A3.SS2.p1.m16.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m16.2">c</XMTok>
                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> to maintain <Math mode="inline" tex="\max|Z|\leq 50" text="maximum@(absolute-value@(Z)) &lt;= 50" xml:id="A3.SS2.p1.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="A3.SS2.p1.m17.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.p1.m17.1">Z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="50" role="NUMBER">50</XMTok>
              </XMApp>
            </XMath>
          </Math>. We use a batch size of <Math mode="inline" tex="256" text="256" xml:id="A3.SS2.p1.m18">
            <XMath>
              <XMTok meaning="256" role="NUMBER">256</XMTok>
            </XMath>
          </Math> for training.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS3">
      <tags>
        <tag>C.3</tag>
        <tag role="autoref">subsection C.3</tag>
        <tag role="refnum">C.3</tag>
        <tag role="typerefnum">§C.3</tag>
      </tags>
      <title><tag close=" ">C.3</tag>Image Completion</title>
      <para xml:id="A3.SS3.p1">
        <p>We use the following datasets for image completion experiments.</p>
      </para>
      <paragraph inlist="toc" xml:id="A3.SS3.SSS0.Px1">
        <title>MNIST</title>
        <para xml:id="A3.SS3.SSS0.Px1.p1">
          <p>We split MNIST <cite class="ltx_citemacro_citep">[<bibref bibrefs="lecun1998gradient" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> train dataset into train set with 50,000 samples and validation set with 10,000 samples. We use whole 10,000 samples in test dataset as test set. We make <Math mode="inline" tex="28\times 28" text="28 * 28" xml:id="A3.SS3.SSS0.Px1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="28" role="NUMBER">28</XMTok>
                  <XMTok meaning="28" role="NUMBER">28</XMTok>
                </XMApp>
              </XMath>
            </Math> grids which both axes starting from <Math mode="inline" tex="-0.5" text="- 0.5" xml:id="A3.SS3.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                </XMApp>
              </XMath>
            </Math> to <Math mode="inline" tex="0.5" text="0.5" xml:id="A3.SS3.SSS0.Px1.p1.m3">
              <XMath>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
              </XMath>
            </Math> to indicate the coordinate of pixels, and normalize pixel values into <Math mode="inline" tex="[-0.5,0.5]" text="closed-interval@(- 0.5, 0.5)" xml:id="A3.SS3.SSS0.Px1.p1.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="A3.SS3.SSS0.Px1.p1.m4.2"/>
                    <XMRef idref="A3.SS3.SSS0.Px1.p1.m4.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A3.SS3.SSS0.Px1.p1.m4.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0.5" role="NUMBER" xml:id="A3.SS3.SSS0.Px1.p1.m4.1">0.5</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>. We use a batch size of <Math mode="inline" tex="128" text="128" xml:id="A3.SS3.SSS0.Px1.p1.m5">
              <XMath>
                <XMTok meaning="128" role="NUMBER">128</XMTok>
              </XMath>
            </Math> for training.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A3.SS3.SSS0.Px2">
        <title>SVHN</title>
        <para xml:id="A3.SS3.SSS0.Px2.p1">
          <p>We split SVHN <cite class="ltx_citemacro_citep">[<bibref bibrefs="netzer2011reading" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> train dataset into train set with 58,600 samples and validation set with 14,657 samples. We use whole 26,032 samples in test dataset as test set. We make <Math mode="inline" tex="32\times 32" text="32 * 32" xml:id="A3.SS3.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="32" role="NUMBER">32</XMTok>
                  <XMTok meaning="32" role="NUMBER">32</XMTok>
                </XMApp>
              </XMath>
            </Math> grids which both axes starting from <Math mode="inline" tex="-0.5" text="- 0.5" xml:id="A3.SS3.SSS0.Px2.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                </XMApp>
              </XMath>
            </Math> to <Math mode="inline" tex="0.5" text="0.5" xml:id="A3.SS3.SSS0.Px2.p1.m3">
              <XMath>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
              </XMath>
            </Math> to indicate the coordinate of pixels, and normalize pixel values into <Math mode="inline" tex="[-0.5,0.5]" text="closed-interval@(- 0.5, 0.5)" xml:id="A3.SS3.SSS0.Px2.p1.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="A3.SS3.SSS0.Px2.p1.m4.2"/>
                    <XMRef idref="A3.SS3.SSS0.Px2.p1.m4.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A3.SS3.SSS0.Px2.p1.m4.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0.5" role="NUMBER" xml:id="A3.SS3.SSS0.Px2.p1.m4.1">0.5</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>. We use a batch size of <Math mode="inline" tex="128" text="128" xml:id="A3.SS3.SSS0.Px2.p1.m5">
              <XMath>
                <XMTok meaning="128" role="NUMBER">128</XMTok>
              </XMath>
            </Math> for training.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A3.SS3.SSS0.Px3">
        <title>CelebA</title>
        <para xml:id="A3.SS3.SSS0.Px3.p1">
          <p>We use splits of CelebA <cite class="ltx_citemacro_citep">[<bibref bibrefs="liu2015faceattributes" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>]</cite> dataset as provided (162,770 train samples, 19,867 validation samples, 19,962 test samples). We crop <Math mode="inline" tex="32\times 32" text="32 * 32" xml:id="A3.SS3.SSS0.Px3.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="32" role="NUMBER">32</XMTok>
                  <XMTok meaning="32" role="NUMBER">32</XMTok>
                </XMApp>
              </XMath>
            </Math> pixels of center of images. We make <Math mode="inline" tex="32\times 32" text="32 * 32" xml:id="A3.SS3.SSS0.Px3.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="32" role="NUMBER">32</XMTok>
                  <XMTok meaning="32" role="NUMBER">32</XMTok>
                </XMApp>
              </XMath>
            </Math> grids which both axes starting from <Math mode="inline" tex="-0.5" text="- 0.5" xml:id="A3.SS3.SSS0.Px3.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                </XMApp>
              </XMath>
            </Math> to <Math mode="inline" tex="0.5" text="0.5" xml:id="A3.SS3.SSS0.Px3.p1.m4">
              <XMath>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
              </XMath>
            </Math> to indicate the coordinate of pixels, and normalize pixel values into <Math mode="inline" tex="[-0.5,0.5]" text="closed-interval@(- 0.5, 0.5)" xml:id="A3.SS3.SSS0.Px3.p1.m5">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="A3.SS3.SSS0.Px3.p1.m5.2"/>
                    <XMRef idref="A3.SS3.SSS0.Px3.p1.m5.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A3.SS3.SSS0.Px3.p1.m5.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0.5" role="NUMBER" xml:id="A3.SS3.SSS0.Px3.p1.m5.1">0.5</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>. We use a batch size of <Math mode="inline" tex="128" text="128" xml:id="A3.SS3.SSS0.Px3.p1.m6">
              <XMath>
                <XMTok meaning="128" role="NUMBER">128</XMTok>
              </XMath>
            </Math> for training.</p>
        </para>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:app:sec:details:bo" xml:id="A3.SS4">
      <tags>
        <tag>C.4</tag>
        <tag role="autoref">subsection C.4</tag>
        <tag role="refnum">C.4</tag>
        <tag role="typerefnum">§C.4</tag>
      </tags>
      <title><tag close=" ">C.4</tag>Bayesian Optimization</title>
      <para xml:id="A3.SS4.p1">
        <p>We use the following benchmark functions for Bayesian optimization experiments. Throughout the experiments, we adjust the function to have the domain of <Math mode="inline" tex="[-2.0,2.0]" text="closed-interval@(- 2.0, 2.0)" xml:id="A3.SS4.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="A3.SS4.p1.m1.2"/>
                  <XMRef idref="A3.SS4.p1.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="A3.SS4.p1.m1.2">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok meaning="2.0" role="NUMBER">2.0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="2.0" role="NUMBER" xml:id="A3.SS4.p1.m1.1">2.0</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.</p>
      </para>
      <paragraph inlist="toc" xml:id="A3.SS4.SSS0.Px1">
        <title><cite class="ltx_citemacro_citet"><bibref bibrefs="gramacy2012cases" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function</title>
        <para xml:id="A3.SS4.SSS0.Px1.p1">
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx34">
            <equation xml:id="A3.E22">
              <tags>
                <tag>(22)</tag>
                <tag role="autoref">Equation 22</tag>
                <tag role="refnum">22</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle f(x)=\frac{\sin(10\pi x)}{2x}+(x-1)^{4}," text="f * x = sine@(10 * pi * x) / (2 * x) + (x - 1) ^ 4" xml:id="A3.E22.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.E22.m2.4"/>
                      <XMWrap>
                        <XMApp xml:id="A3.E22.m2.4">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMDual>
                              <XMRef idref="A3.E22.m2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A3.E22.m2.3">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A3.E22.m2.1"/>
                                  <XMRef idref="A3.E22.m2.2"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="A3.E22.m2.1">sin</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.E22.m2.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="10" role="NUMBER">10</XMTok>
                                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMRef idref="A3.E22.m2.4.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.E22.m2.4.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f(x)=\frac{\sin(10\pi x)}{2x}+(x-1)^{4}," text="f * x = sine@(10 * pi * x) / (2 * x) + (x - 1) ^ 4" xml:id="A3.E22.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.E22.m1.4"/>
                          <XMWrap>
                            <XMApp xml:id="A3.E22.m1.4">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                <XMDual>
                                  <XMRef idref="A3.E22.m1.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.E22.m1.3">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A3.E22.m1.1"/>
                                      <XMRef idref="A3.E22.m1.2"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="A3.E22.m1.1">sin</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.E22.m1.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="10" role="NUMBER">10</XMTok>
                                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMRef idref="A3.E22.m1.4.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.E22.m1.4.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="x\in[0.5,2.5]" text="x element-of closed-interval@(0.5, 2.5)" xml:id="A3.SS4.SSS0.Px1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="closed-interval"/>
                      <XMRef idref="A3.SS4.SSS0.Px1.p1.m1.1"/>
                      <XMRef idref="A3.SS4.SSS0.Px1.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok meaning="0.5" role="NUMBER" xml:id="A3.SS4.SSS0.Px1.p1.m1.1">0.5</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="2.5" role="NUMBER" xml:id="A3.SS4.SSS0.Px1.p1.m1.2">2.5</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> and a global optimum is at <Math mode="inline" tex="x^{\ast}\approx 0.5486" text="x ^ ast approximately-equals 0.5486" xml:id="A3.SS4.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMTok meaning="0.5486" role="NUMBER">0.5486</XMTok>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A3.SS4.SSS0.Px2">
        <title><cite class="ltx_citemacro_citet"><bibref bibrefs="sobester2008engineering" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>[</bibrefphrase>
              <bibrefphrase>]</bibrefphrase>
            </bibref></cite> function</title>
        <para xml:id="A3.SS4.SSS0.Px2.p1">
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx35">
            <equation xml:id="A3.E23">
              <tags>
                <tag>(23)</tag>
                <tag role="autoref">Equation 23</tag>
                <tag role="refnum">23</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle f(x)=(6x-2)^{2}\sin(12x-4)," text="f * x = (6 * x - 2) ^ 2 * sine@(12 * x - 4)" xml:id="A3.E23.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.E23.m2.3"/>
                      <XMWrap>
                        <XMApp xml:id="A3.E23.m2.3">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMDual>
                              <XMRef idref="A3.E23.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A3.E23.m2.1">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMRef idref="A3.E23.m2.3.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.E23.m2.3.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="6" role="NUMBER">6</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    </XMApp>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="A3.E23.m2.2"/>
                                <XMRef idref="A3.E23.m2.3.2"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="A3.E23.m2.2">sin</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.E23.m2.3.2">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="12" role="NUMBER">12</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    </XMApp>
                                    <XMTok meaning="4" role="NUMBER">4</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle f(x)=(6x-2)^{2}\sin(12x-4)," text="f * x = (6 * x - 2) ^ 2 * sine@(12 * x - 4)" xml:id="A3.E23.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.E23.m1.3"/>
                          <XMWrap>
                            <XMApp xml:id="A3.E23.m1.3">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                <XMDual>
                                  <XMRef idref="A3.E23.m1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.E23.m1.1">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMRef idref="A3.E23.m1.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.E23.m1.3.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="6" role="NUMBER">6</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A3.E23.m1.2"/>
                                    <XMRef idref="A3.E23.m1.3.2"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="sine" role="TRIGFUNCTION" xml:id="A3.E23.m1.2">sin</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.E23.m1.3.2">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="12" role="NUMBER">12</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok meaning="4" role="NUMBER">4</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="x\in[0,1]" text="x element-of closed-interval@(0, 1)" xml:id="A3.SS4.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="closed-interval"/>
                      <XMRef idref="A3.SS4.SSS0.Px2.p1.m1.1"/>
                      <XMRef idref="A3.SS4.SSS0.Px2.p1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok meaning="0" role="NUMBER" xml:id="A3.SS4.SSS0.Px2.p1.m1.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="A3.SS4.SSS0.Px2.p1.m1.2">1</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> and a global optimum is at <Math mode="inline" tex="x^{\ast}\approx 0.7572" text="x ^ ast approximately-equals 0.7572" xml:id="A3.SS4.SSS0.Px2.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMTok meaning="0.7572" role="NUMBER">0.7572</XMTok>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
<!--  %“section–Ablation Study˝ 
     %“label–app:sec:ablation˙study˝ 
     %“begin–table˝[t] 
     %“caption–Context and target log likelihood values on data sampled from Gaussian Processes with various kernel. Here we trained the same model with different losses. Performances are measured over 4 seeds.““˝ 
     %“label–tab:table˙gp˙inf˙ablation˝ 
     %“centering 
     %“scriptsize 
     %“renewcommand–“arraystretch˝–0.9˝ 
     %“resizebox–0.95“textwidth˝–!˝– 
     %“begin–tabular˝–lrrrrrrrrrrrr˝ 
     %“toprule 
     %“multirow–3˝–*˝–Model˝ &amp; “multicolumn–2˝–r˝–RBF˝                                   &amp; “multicolumn–2˝–r˝–Matern˝                                &amp; “multicolumn–2˝–r˝–Periodic˝                                &amp; “multicolumn–2˝–r˝–$t$-noise˝                               ““ 
     %“cmidrule(lr)–2-3˝                                          “cmidrule(lr)–4-5˝                                          “cmidrule(lr)–6-7˝                                            “cmidrule(lr)–8-9˝ 
     %&amp; context                     &amp; target                      &amp; context                     &amp; target                      &amp; context                      &amp; target                       &amp; context                      &amp; target                       ““ 
     %“midrule 
     %MPNP (ours)                                              &amp;         1.086  $“pm–0.005˝$ &amp;         0.457  $“pm–0.002˝$ &amp;         1.005  $“pm–0.014˝$ &amp;         0.278  $“pm–0.006˝$ &amp;         -0.017  $“pm–0.013˝$ &amp;         -0.681  $“pm–0.009˝$ &amp;          0.119  $“pm–0.025˝$ &amp;         -0.381  $“pm–0.013˝$ ““ 
     %- $“calL˙–“text–amort˝˝$                                 &amp;         1.146  $“pm–0.010˝$ &amp;         0.487  $“pm–0.009˝$ &amp;         1.064  $“pm–0.002˝$ &amp;         0.300  $“pm–0.005˝$ &amp;         -0.002  $“pm–0.039˝$ &amp;         -0.673  $“pm–0.011˝$ &amp;          0.166  $“pm–0.027˝$ &amp;         -0.372  $“pm–0.043˝$ ““ 
     %- $“calL˙–“text–pseudo˝˝$                                &amp;         1.090  $“pm–0.008˝$ &amp;         0.445  $“pm–0.006˝$ &amp;         1.012  $“pm–0.004˝$ &amp;         0.277  $“pm–0.007˝$ &amp;          0.058  $“pm–0.018˝$ &amp;         -0.669  $“pm–0.007˝$ &amp;          0.239  $“pm–0.006˝$ &amp;         -0.348  $“pm–0.023˝$ ““ 
     %- $“calL˙–“text–amort˝˝$ - $“calL˙–“text–pseudo˝˝$       &amp;         1.160  $“pm–0.008˝$ &amp;         0.493  $“pm–0.006˝$ &amp;         1.092  $“pm–0.012˝$ &amp;         0.320  $“pm–0.004˝$ &amp;          0.074  $“pm–0.019˝$ &amp;         -0.666  $“pm–0.010˝$ &amp;          0.365  $“pm–0.010˝$ &amp;         -0.416  $“pm–0.086˝$ ““ 
     %“cmidrule(lr)–1-1˝       “cmidrule(lr)–2-3˝                                          “cmidrule(lr)–4-5˝                                          “cmidrule(lr)–6-7˝                                            “cmidrule(lr)–8-9˝ 
     %MPANP (ours)                                             &amp;         1.374  $“pm–0.000˝$ &amp;         0.698  $“pm–0.007˝$ &amp;         1.373  $“pm–0.001˝$ &amp;         0.501  $“pm–0.005˝$ &amp;          1.153  $“pm–0.049˝$ &amp;         -0.638  $“pm–0.030˝$ &amp;          0.773  $“pm–0.039˝$ &amp;         -0.446  $“pm–0.057˝$ ““ 
     %- $“calL˙–“text–amort˝˝$                                 &amp;         1.359  $“pm–0.001˝$ &amp;         0.703  $“pm–0.001˝$ &amp;         1.351  $“pm–0.006˝$ &amp;         0.501  $“pm–0.004˝$ &amp;          1.007  $“pm–0.064˝$ &amp;         -0.651  $“pm–0.032˝$ &amp;          0.496  $“pm–0.023˝$ &amp;         -0.520  $“pm–0.059˝$ ““ 
     %- $“calL˙–“text–pseudo˝˝$                                &amp;         1.375  $“pm–0.000˝$ &amp;         0.678  $“pm–0.010˝$ &amp;         1.373  $“pm–0.002˝$ &amp;         0.480  $“pm–0.007˝$ &amp;          1.129  $“pm–0.065˝$ &amp;         -0.606  $“pm–0.005˝$ &amp;          0.786  $“pm–0.056˝$ &amp;         -0.433  $“pm–0.011˝$ ““ 
     %- $“calL˙–“text–amort˝˝$ - $“calL˙–“text–pseudo˝˝$       &amp;         1.374  $“pm–0.001˝$ &amp;         0.680  $“pm–0.002˝$ &amp;         1.370  $“pm–0.007˝$ &amp;         0.486  $“pm–0.014˝$ &amp;          0.811  $“pm–0.142˝$ &amp;         -0.789  $“pm–0.132˝$ &amp;          0.826  $“pm–0.030˝$ &amp;         -0.428  $“pm–0.037˝$ ““ 
     %**** ablationstudy.tex Line 25 **** 
     %“bottomrule 
     %“end–tabular˝˝ 
     %“end–table˝ 
     %“begin–figure˝[t] 
     %“centering 
     %“includegraphics[width = 0.32“textwidth]–figure/sample plot 9 amort.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/sample plot 9 pseudo.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/sample plot 9 both.pdf˝ 
     %% “includegraphics[width = 0.32“textwidth]–figure/data plot 9.pdf˝ 
     %% “includegraphics[width = 0.32“textwidth]–figure/sample plot 9.pdf˝ 
     %% “includegraphics[width = 0.32“textwidth]–figure/posterior plot 9.pdf˝ 
     %“caption–Generated pseudo context data samples of MPANP in 1d regression task. (Left) Generated pseudo context when we remove the term $“calL˙–“text–amort˝˝$ from the loss $“calL$. (Middle) Generated pseudo context when we remove the term $“calL˙–“text–pseudo˝˝$ from the loss $“calL$. (Right) Generated pseudo context when we remove the terms $“calL˙–“text–amort˝˝$ and $“calL˙–“text–pseudo˝˝$ from the loss $“calL$.˝ 
     %“label–fig:feature˙ablation˝ 
     %“end–figure˝ 
     %In this section, we conduct some ablation studies on loss function and report the generated pseudo context data and the performances of the “glspl–mpnp˝ in 1D regression. 
     %As our loss function essentially contain the $“calL˙–“text–marg˝˝$ term, we conduct the ablation studies on the other terms ($“calL˙–“text–pseudo˝˝$ and $“calL˙–“text–amort˝˝$). 
     %We have three cases i) loss function $“calL$ without $“calL˙–“text–amort˝˝$, ii) loss function $“calL$ without $“calL˙–“text–pseudo˝˝$ and iii) loss function $“calL$ without $“calL˙–“text–amort˝˝$ and $“calL˙–“text–pseudo˝˝$. 
     %We report the performances of the three cases in “cref–tab:table˙gp˙inf˙ablation˝. 
     %Also we present the generated pseudo context data from the three cases in “cref–fig:feature˙ablation˝. 
     %Here you can see that without any term in $“calL$, the model cannot actually generate meaningful pseudo context dataset from real context dataset. -->      </paragraph>
    </subsection>
  </appendix>
  <appendix inlist="toc" labels="LABEL:app:sec:directly_generating_input" xml:id="A4">
    <tags>
      <tag>Appendix D</tag>
      <tag role="autoref">Appendix D</tag>
      <tag role="refnum">D</tag>
      <tag role="typerefnum">Appendix D</tag>
    </tags>
    <title><tag close=" ">Appendix D</tag>Directly Generating Input Model</title>
    <toctitle><tag close=" ">D</tag>Directly Generating Input Model</toctitle>
    <para xml:id="A4.p1">
      <p>In this section, we present our model generating pseudo contexts directly in the input space.
We will present two kinds of model structure, i) directly generating pseudo context pair <Math mode="inline" tex="(x,y)" text="open-interval@(x, y)" xml:id="A4.p1.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="open-interval"/>
                <XMRef idref="A4.p1.m1.1"/>
                <XMRef idref="A4.p1.m1.2"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="A4.p1.m1.1">x</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="A4.p1.m1.2">y</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> simultaneously by ISAB, ii) generating pseudo context data <Math mode="inline" tex="x" text="x" xml:id="A4.p1.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="y" text="y" xml:id="A4.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math>, sequentially.</p>
    </para>
    <subsection inlist="toc" xml:id="A4.SS1">
      <tags>
        <tag>D.1</tag>
        <tag role="autoref">subsection D.1</tag>
        <tag role="refnum">D.1</tag>
        <tag role="typerefnum">§D.1</tag>
      </tags>
      <title><tag close=" ">D.1</tag>Construction</title>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px1">
        <title>Generating pseudo context pair simultaneously.</title>
        <para xml:id="A4.SS1.SSS0.Px1.p1">
          <p>The generator of our first model which simultaneously generating pseudo context pair <Math mode="inline" tex="(x^{\prime},y^{\prime})" text="open-interval@(x ^ prime, y ^ prime)" xml:id="A4.SS1.SSS0.Px1.p1.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A4.SS1.SSS0.Px1.p1.m1.1"/>
                    <XMRef idref="A4.SS1.SSS0.Px1.p1.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A4.SS1.SSS0.Px1.p1.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A4.SS1.SSS0.Px1.p1.m1.2">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">y</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, takes real context dataset <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="A4.SS1.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> as input and outputs pseudo context dataset <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="A4.SS1.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>.
Here the generator is the one layer ISAB module.
Then we concatenate <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="A4.SS1.SSS0.Px1.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="A4.SS1.SSS0.Px1.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> in order to treat this concatenated set as context dataset.
Then the encoder takes this concatenated context set as input.
And the others are the same with <ERROR class="undefined">\gls</ERROR>cnp or <ERROR class="undefined">\gls</ERROR>canp.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px2">
        <title>Sequentially generating pseudo context data <Math mode="inline" tex="x" text="x" xml:id="A4.SS1.SSS0.Px2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="y" text="y" xml:id="A4.SS1.SSS0.Px2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math></title>
        <para xml:id="A4.SS1.SSS0.Px2.p1">
          <p>In this model, the generator takes real context dataset <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="A4.SS1.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> as input and outputs only <Math mode="inline" tex="x^{\prime}" text="x ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>s of <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>.
Here the generator is the one layer ISAB module with additional one linear layer.
Then we consider these <Math mode="inline" tex="x^{\prime}" text="x ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>s as our target dataset and find the mean and variance of <Math mode="inline" tex="y^{\prime}" text="y ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">y</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> for each <Math mode="inline" tex="x^{\prime}" text="x ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> by forwarding the model with context dataset <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="A4.SS1.SSS0.Px2.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> and target <Math mode="inline" tex="x^{\prime}" text="x ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math>.
We sample <Math mode="inline" tex="y^{\prime}" text="y ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m9">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">y</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> from the Gaussian distribution with mean and variance from the prior step.
We again concatenate <Math mode="inline" tex="Z_{c}" text="Z _ c" xml:id="A4.SS1.SSS0.Px2.p1.m10">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMath>
            </Math> with <Math mode="inline" tex="Z^{\prime}" text="Z ^ prime" xml:id="A4.SS1.SSS0.Px2.p1.m11">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMath>
            </Math> and use them as context dataset.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px3">
        <title>Training</title>
        <para xml:id="A4.SS1.SSS0.Px3.p1">
          <p>Having directly generated a pseudo context set, we construct our empirical density as</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx36">
            <equation xml:id="A4.E24">
              <tags>
                <tag>(24)</tag>
                <tag role="autoref">Equation 24</tag>
                <tag role="refnum">24</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle g_{N}(z)=\frac{1}{N}\bigg{(}\sum_{i\in c}\delta_{z_{i}}(z)+\sum_%&#10;{i=1}^{N-|c|}\delta_{z^{\prime}_{i}}(z)\bigg{)}." text="g _ N * z = (1 / N) * ((sum _ (i element-of c))@(delta _ z _ i * z) + ((sum _ (i = 1)) ^ (N - absolute-value@(c)))@(delta _ (z ^ prime) _ i * z))" xml:id="A4.E24.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A4.E24.m2.5"/>
                      <XMWrap>
                        <XMApp xml:id="A4.E24.m2.5">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">g</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A4.E24.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A4.E24.m2.2">z</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A4.E24.m2.5.1"/>
                              <XMWrap>
                                <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A4.E24.m2.5.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A4.E24.m2.3"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A4.E24.m2.3">z</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="absolute-value"/>
                                            <XMRef idref="A4.E24.m2.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E24.m2.1">c</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                            <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A4.E24.m2.4"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A4.E24.m2.4">z</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle g_{N}(z)=\frac{1}{N}\bigg{(}\sum_{i\in c}\delta_{z_{i}}(z)+\sum_%&#10;{i=1}^{N-|c|}\delta_{z^{\prime}_{i}}(z)\bigg{)}." text="g _ N * z = (1 / N) * ((sum _ (i element-of c))@(delta _ z _ i * z) + ((sum _ (i = 1)) ^ (N - absolute-value@(c)))@(delta _ (z ^ prime) _ i * z))" xml:id="A4.E24.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A4.E24.m1.5"/>
                          <XMWrap>
                            <XMApp xml:id="A4.E24.m1.5">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A4.E24.m1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A4.E24.m1.2">z</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A4.E24.m1.5.1"/>
                                  <XMWrap>
                                    <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A4.E24.m1.5.1">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A4.E24.m1.3"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A4.E24.m1.3">z</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="absolute-value"/>
                                                <XMRef idref="A4.E24.m1.1"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E24.m1.1">c</XMTok>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A4.E24.m1.4"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A4.E24.m1.4">z</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>Given <Math mode="inline" tex="g_{N}" text="g _ N" xml:id="A4.SS1.SSS0.Px3.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math>, we find the function parameter <Math mode="inline" tex="\theta" text="theta" xml:id="A4.SS1.SSS0.Px3.p1.m2">
              <XMath>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              </XMath>
            </Math><!--  %**** directlygeneratinginput.tex Line 25 **** --> as</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx37">
            <equation xml:id="A4.E25">
              <tags>
                <tag>(25)</tag>
                <tag role="autoref">Equation 25</tag>
                <tag role="refnum">25</tag>
              </tags>
              <MathFork>
                <Math content-tex="\displaystyle\theta(g_{N}):=\argmin_{\theta}\int\ell(z,\theta)g_{N}(dz)," tex="\displaystyle\theta(g_{N}):=\operatorname*{arg\,min}_{\theta}\int\ell(z,\theta%&#10;)g_{N}(dz)," text="theta * g _ N assign argmin _ theta * integral@(ell * open-interval@(z, theta) * g _ N * d * z)" xml:id="A4.E25.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A4.E25.m2.3"/>
                      <XMWrap>
                        <XMApp xml:id="A4.E25.m2.3">
                          <XMTok meaning="assign" role="RELOP">:=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMDual>
                              <XMRef idref="A4.E25.m2.3.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A4.E25.m2.3.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                <XMTok role="UNKNOWN">min</XMTok>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A4.E25.m2.1"/>
                                    <XMRef idref="A4.E25.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A4.E25.m2.1">z</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.E25.m2.2">θ</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A4.E25.m2.3.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A4.E25.m2.3.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math content-tex="\displaystyle\theta(g_{N}):=\argmin_{\theta}\int\ell(z,\theta)g_{N}(dz)," mode="inline" tex="\displaystyle\theta(g_{N}):=\operatorname*{arg\,min}_{\theta}\int\ell(z,\theta%&#10;)g_{N}(dz)," text="theta * g _ N assign argmin _ theta * integral@(ell * open-interval@(z, theta) * g _ N * d * z)" xml:id="A4.E25.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A4.E25.m1.3"/>
                          <XMWrap>
                            <XMApp xml:id="A4.E25.m1.3">
                              <XMTok meaning="assign" role="RELOP">:=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMDual>
                                  <XMRef idref="A4.E25.m1.3.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A4.E25.m1.3.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp name="argmin" role="OPERATOR" scriptpos="mid">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                    <XMTok role="UNKNOWN">min</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A4.E25.m1.1"/>
                                        <XMRef idref="A4.E25.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A4.E25.m1.1">z</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.E25.m1.2">θ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A4.E25.m1.3.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A4.E25.m1.3.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where we simply choose <Math mode="inline" tex="l(z,\theta):=-\log{\mathcal{N}}(y|\mu_{\theta}(x),\sigma_{\theta}^{2}(x)I_{d_{%&#10;out}})" text="l * open-interval@(z, theta) assign - logarithm@(N) * conditional@(y, list@(mu _ theta * x, (sigma _ theta) ^ 2 * x * I _ d _ (o * u * t)))" xml:id="A4.SS1.SSS0.Px3.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="assign" role="RELOP">:=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">l</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.1"/>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m3.1">z</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m3.2">θ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.5"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m3.5">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">y</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.5.1"/>
                                <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.5.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m3.5.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.3"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m3.3">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m3.5.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m3.4"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m3.4">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">o</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">u</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.
In order to train the directly generating input model, which well approximate <Math mode="inline" tex="\theta(g_{N})" text="theta * g _ N" xml:id="A4.SS1.SSS0.Px3.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMDual>
                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m4.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, we should construct different objective function from <ref labelref="LABEL:eq:mpnp_term_whole" show="creftype~refnum"/> because we can compute the exact <Math mode="inline" tex="\int\ell(z,\theta)g_{N}(dz)" text="integral@(ell * open-interval@(z, theta) * g _ N * d * z)" xml:id="A4.SS1.SSS0.Px3.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m5.1"/>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m5.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m5.1">z</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m5.2">θ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A4.SS1.SSS0.Px3.p1.m5.3"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m5.3">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, unlike the feature generating model.
First, we approximate the marginal likelihood which is,</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx38">
            <equation labels="LABEL:eq:direct1" xml:id="A4.E26">
              <tags>
                <tag>(26)</tag>
                <tag role="autoref">Equation 26</tag>
                <tag role="refnum">26</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle\log p(Y|X,Z_{c})\approx\log\Bigg{[}\frac{1}{K}\sum_{k=1}^{K}\exp%&#10;\bigg{(}-\sum_{i\in[n]}\ell(z_{i},\tilde{\theta}(Z_{c}\cup Z^{\prime(k)}))%&#10;\bigg{)}\Bigg{]}:=-{\mathcal{L}}_{\text{marg}}(\tau,\phi)," text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) approximately-equals logarithm@((1 / K) * ((sum _ (k = 1)) ^ K)@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * (Z _ c union Z ^ (list@(prime1, k)))))))) assign - L _ [marg] * open-interval@(tau, phi)" xml:id="A4.E26.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A4.E26.m2.10"/>
                      <XMWrap>
                        <XMApp xml:id="A4.E26.m2.10">
                          <XMTok meaning="multirelation"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A4.E26.m2.10.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A4.E26.m2.10.1">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A4.E26.m2.5"/>
                                      <XMRef idref="A4.E26.m2.10.1.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A4.E26.m2.5">X</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A4.E26.m2.10.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="A4.E26.m2.7"/>
                              <XMRef idref="A4.E26.m2.10.2"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A4.E26.m2.7">log</XMTok>
                              <XMWrap>
                                <XMTok fontsize="260%" role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="A4.E26.m2.10.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A4.E26.m2.6"/>
                                        <XMRef idref="A4.E26.m2.10.2.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A4.E26.m2.6">exp</XMTok>
                                        <XMWrap>
                                          <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A4.E26.m2.10.2.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="delimited-[]"/>
                                                      <XMRef idref="A4.E26.m2.1"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E26.m2.1">n</XMTok>
                                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A4.E26.m2.10.2.1.1"/>
                                                    <XMRef idref="A4.E26.m2.10.2.1.2"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A4.E26.m2.10.2.1.1">
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMApp xml:id="A4.E26.m2.10.2.1.2">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMApp>
                                                        <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                      </XMApp>
                                                      <XMDual>
                                                        <XMRef idref="A4.E26.m2.10.2.1.2.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMApp xml:id="A4.E26.m2.10.2.1.2.1">
                                                            <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                            </XMApp>
                                                            <XMApp>
                                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                              <XMDual>
                                                                <XMApp>
                                                                  <XMTok meaning="list"/>
                                                                  <XMRef idref="A4.E26.m2.3"/>
                                                                  <XMRef idref="A4.E26.m2.4"/>
                                                                </XMApp>
                                                                <XMWrap>
                                                                  <XMTok name="prime1" role="SUPOP" xml:id="A4.E26.m2.3">′</XMTok>
                                                                  <XMTok role="PUNCT">⁣</XMTok>
                                                                  <XMDual xml:id="A4.E26.m2.4">
                                                                    <XMRef idref="A4.E26.m2.2"/>
                                                                    <XMWrap>
                                                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E26.m2.2">k</XMTok>
                                                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                                    </XMWrap>
                                                                  </XMDual>
                                                                </XMWrap>
                                                              </XMDual>
                                                            </XMApp>
                                                          </XMApp>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok fontsize="260%" role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                          <XMTok meaning="assign" role="RELOP">:=</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                <XMText><text fontsize="70%">marg</text></XMText>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A4.E26.m2.8"/>
                                  <XMRef idref="A4.E26.m2.9"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E26.m2.8">τ</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E26.m2.9">ϕ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\log p(Y|X,Z_{c})\approx\log\Bigg{[}\frac{1}{K}\sum_{k=1}^{K}\exp%&#10;\bigg{(}-\sum_{i\in[n]}\ell(z_{i},\tilde{\theta}(Z_{c}\cup Z^{\prime(k)}))%&#10;\bigg{)}\Bigg{]}:=-{\mathcal{L}}_{\text{marg}}(\tau,\phi)," text="logarithm@(p) * conditional@(Y, list@(X, Z _ c)) approximately-equals logarithm@((1 / K) * ((sum _ (k = 1)) ^ K)@(exponential@(- (sum _ (i element-of delimited-[]@(n)))@(ell * open-interval@(z _ i, tilde@(theta) * (Z _ c union Z ^ (list@(prime1, k)))))))) assign - L _ [marg] * open-interval@(tau, phi)" xml:id="A4.E26.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A4.E26.m1.10"/>
                          <XMWrap>
                            <XMApp xml:id="A4.E26.m1.10">
                              <XMTok meaning="multirelation"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A4.E26.m1.10.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A4.E26.m1.10.1">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A4.E26.m1.5"/>
                                          <XMRef idref="A4.E26.m1.10.1.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A4.E26.m1.5">X</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A4.E26.m1.10.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A4.E26.m1.7"/>
                                  <XMRef idref="A4.E26.m1.10.2"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A4.E26.m1.7">log</XMTok>
                                  <XMWrap>
                                    <XMTok fontsize="260%" role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A4.E26.m1.10.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMRef idref="A4.E26.m1.6"/>
                                            <XMRef idref="A4.E26.m1.10.2.1"/>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A4.E26.m1.6">exp</XMTok>
                                            <XMWrap>
                                              <XMTok fontsize="210%" role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A4.E26.m1.10.2.1">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                      <XMDual>
                                                        <XMApp>
                                                          <XMTok meaning="delimited-[]"/>
                                                          <XMRef idref="A4.E26.m1.1"/>
                                                        </XMApp>
                                                        <XMWrap>
                                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E26.m1.1">n</XMTok>
                                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A4.E26.m1.10.2.1.1"/>
                                                        <XMRef idref="A4.E26.m1.10.2.1.2"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A4.E26.m1.10.2.1.1">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                        </XMApp>
                                                        <XMTok role="PUNCT">,</XMTok>
                                                        <XMApp xml:id="A4.E26.m1.10.2.1.2">
                                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                          <XMApp>
                                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                                          </XMApp>
                                                          <XMDual>
                                                            <XMRef idref="A4.E26.m1.10.2.1.2.1"/>
                                                            <XMWrap>
                                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                              <XMApp xml:id="A4.E26.m1.10.2.1.2.1">
                                                                <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                                                <XMApp>
                                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                                </XMApp>
                                                                <XMApp>
                                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                                                  <XMDual>
                                                                    <XMApp>
                                                                      <XMTok meaning="list"/>
                                                                      <XMRef idref="A4.E26.m1.3"/>
                                                                      <XMRef idref="A4.E26.m1.4"/>
                                                                    </XMApp>
                                                                    <XMWrap>
                                                                      <XMTok name="prime1" role="SUPOP" xml:id="A4.E26.m1.3">′</XMTok>
                                                                      <XMTok role="PUNCT">⁣</XMTok>
                                                                      <XMDual xml:id="A4.E26.m1.4">
                                                                        <XMRef idref="A4.E26.m1.2"/>
                                                                        <XMWrap>
                                                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E26.m1.2">k</XMTok>
                                                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                                        </XMWrap>
                                                                      </XMDual>
                                                                    </XMWrap>
                                                                  </XMDual>
                                                                </XMApp>
                                                              </XMApp>
                                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                            </XMWrap>
                                                          </XMDual>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok fontsize="210%" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMApp>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok fontsize="260%" role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMTok meaning="assign" role="RELOP">:=</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                    <XMText><text fontsize="70%">marg</text></XMText>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A4.E26.m1.8"/>
                                      <XMRef idref="A4.E26.m1.9"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E26.m1.8">τ</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E26.m1.9">ϕ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math class="ltx_math_unparsed" mode="inline" tex="Z^{\prime(1)},\dots,Z^{\prime(K)}\overset{\mathrm{i.i.d.}}{\sim}p(Z^{\prime}|Z%&#10;_{c};\phi_{\text{pred}})" text="list@(Z ^ (list@(prime1, 1)), dots, Z ^ (list@(prime1, K)) * i@.@i@.@d@.@(similar-to) * p * conditional@(Z ^ prime, list@(Z _ c, phi _ [pred])))" xml:id="A4.SS1.SSS0.Px3.p1.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.11"/>
                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.10"/>
                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.12"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m6.11">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.2"/>
                          <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="prime1" role="SUPOP" xml:id="A4.SS1.SSS0.Px3.p1.m6.2">′</XMTok>
                          <XMTok role="PUNCT">⁣</XMTok>
                          <XMDual xml:id="A4.SS1.SSS0.Px3.p1.m6.3">
                            <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A4.SS1.SSS0.Px3.p1.m6.1">1</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="dots" role="ID" xml:id="A4.SS1.SSS0.Px3.p1.m6.10">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m6.12">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.5"/>
                            <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.6"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="prime1" role="SUPOP" xml:id="A4.SS1.SSS0.Px3.p1.m6.5">′</XMTok>
                            <XMTok role="PUNCT">⁣</XMTok>
                            <XMDual xml:id="A4.SS1.SSS0.Px3.p1.m6.6">
                              <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.4"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m6.4">K</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMWrap role="OVERACCENT">
                          <XMTok role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m6.7">i</XMTok>
                          <XMTok role="PERIOD">.</XMTok>
                          <XMTok role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m6.8">i</XMTok>
                          <XMTok role="PERIOD">.</XMTok>
                          <XMTok role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m6.9">d</XMTok>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                        <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMDual>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.12.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m6.12.1">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.12.1.1"/>
                                <XMRef idref="A4.SS1.SSS0.Px3.p1.m6.12.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m6.12.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">;</XMTok>
                                <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m6.12.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  <XMText><text fontsize="70%">pred</text></XMText>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>.
<ref labelref="LABEL:eq:direct1" show="creftype~refnum"/> is the same training object with <ref labelref="LABEL:eq:mpnp_term1" show="creftype~refnum"/>.
As we mentioned in <ref labelref="LABEL:main:subsec:training" show="creftype~refnum"/>, if we are given sufficiently well approximated <Math class="ltx_math_unparsed" mode="inline" tex="\tilde{\theta}(Z_{c}\cup Z^{{}^{\prime}(K)})" text="tilde@(theta) * (Z _ c union Z ^ [(K)′])" xml:id="A4.SS1.SSS0.Px3.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A4.SS1.SSS0.Px3.p1.m7.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m7.1">
                        <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                          <XMArg rule="Superscript">
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="pre2"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMArg>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> then this objective would be suffice. However only with <ref labelref="LABEL:eq:direct1" show="creftype~refnum"/>, we cannot train the encoder to properly amortize the parameter construction process <ref labelref="LABEL:eq:recovering_theta" show="creftype~refnum"/>. To overcome this issue, we use <Math mode="inline" tex="\int\ell(z,\theta)g_{N}(dz)" text="integral@(ell * open-interval@(z, theta) * g _ N * d * z)" xml:id="A4.SS1.SSS0.Px3.p1.m8">
              <XMath>
                <XMApp>
                  <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m8.1"/>
                        <XMRef idref="A4.SS1.SSS0.Px3.p1.m8.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m8.1">z</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.SS1.SSS0.Px3.p1.m8.2">θ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A4.SS1.SSS0.Px3.p1.m8.3"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A4.SS1.SSS0.Px3.p1.m8.3">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> as our second training objective which is,</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx39">
            <equation labels="LABEL:eq:direct2" xml:id="A4.E27">
              <tags>
                <tag>(27)</tag>
                <tag role="autoref">Equation 27</tag>
                <tag role="refnum">27</tag>
              </tags>
              <MathFork>
                <Math class="ltx_math_unparsed" tex="\displaystyle\frac{1}{K}\sum_{k=1}^{K}\int\ell(z,\theta)g_{N}^{(k)}(dz)=\frac{%&#10;1}{K}\sum_{k=1}^{K}\sum_{z\in Z_{c}\cup Z^{{}^{\prime}(k)}}\Big{(}-\ell\big{(}%&#10;z,\tilde{\theta}(Z_{c}\cup Z^{{}^{\prime}(k)}\big{)}\Big{)}:={\mathcal{L}}_{%&#10;\text{amort}}(\tau,\phi)." xml:id="A4.E27.m2">
                  <XMath>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                    <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A4.E27.m2.2">z</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.E27.m2.3">θ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A4.E27.m2.1"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E27.m2.1">k</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" role="UNKNOWN">z</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                      <XMTok font="italic" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="union" name="cup" role="ADDOP">∪</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                            <XMArg rule="Superscript">
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="pre3"/>
                                <XMWrap>
                                  <XMTok fontsize="50%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="50%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                            </XMArg>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="160%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                      <XMWrap>
                        <XMTok fontsize="120%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A4.E27.m2.4">z</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp>
                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMArg rule="Superscript">
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="pre2"/>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                            </XMArg>
                          </XMApp>
                          <XMTok fontsize="120%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok fontsize="160%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok meaning="assign" role="RELOP">:=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                        <XMText><text fontsize="70%">amort</text></XMText>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E27.m2.5">τ</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E27.m2.6">ϕ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\frac{1}{K}\sum_{k=1}^{K}\int\ell(z,\theta)g_{N}^{(k)}(dz)=\frac{%&#10;1}{K}\sum_{k=1}^{K}\sum_{z\in Z_{c}\cup Z^{{}^{\prime}(k)}}\Big{(}-\ell\big{(}%&#10;z,\tilde{\theta}(Z_{c}\cup Z^{{}^{\prime}(k)}\big{)}\Big{)}:={\mathcal{L}}_{%&#10;\text{amort}}(\tau,\phi)." xml:id="A4.E27.m1">
                      <XMath>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A4.E27.m1.2">z</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A4.E27.m1.3">θ</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A4.E27.m1.1"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A4.E27.m1.1">k</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">z</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="union" name="cup" role="ADDOP">∪</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                <XMArg rule="Superscript">
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="pre3"/>
                                    <XMWrap>
                                      <XMTok fontsize="50%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="50%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMArg>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="160%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                          <XMWrap>
                            <XMTok fontsize="120%" role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A4.E27.m1.4">z</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp>
                              <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                              </XMApp>
                              <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                                <XMArg rule="Superscript">
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="pre2"/>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMArg>
                              </XMApp>
                              <XMTok fontsize="120%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                            <XMTok fontsize="160%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMTok meaning="assign" role="RELOP">:=</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                            <XMText><text fontsize="70%">amort</text></XMText>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E27.m1.5">τ</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E27.m1.6">ϕ</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>Combining these two functions, our loss function for the direct <ERROR class="undefined">\gls</ERROR>mpnp is then</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx40">
            <equation xml:id="A4.E28">
              <tags>
                <tag>(28)</tag>
                <tag role="autoref">Equation 28</tag>
                <tag role="refnum">28</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle\mathbb{E}_{\tau}[{\mathcal{L}}(\tau,\phi)]=\mathbb{E}_{\tau}[{%&#10;\mathcal{L}}_{\text{marg}}(\tau,\phi)+{\mathcal{L}}_{\text{amort}}(\tau,\phi)]." text="E _ tau * delimited-[]@(L * open-interval@(tau, phi)) = E _ tau * delimited-[]@(L _ [marg] * open-interval@(tau, phi) + L _ [amort] * open-interval@(tau, phi))" xml:id="A4.E28.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A4.E28.m2.7"/>
                      <XMWrap>
                        <XMApp xml:id="A4.E28.m2.7">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                              <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A4.E28.m2.7.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="A4.E28.m2.7.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A4.E28.m2.1"/>
                                      <XMRef idref="A4.E28.m2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E28.m2.1">τ</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E28.m2.2">ϕ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                              <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A4.E28.m2.7.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="A4.E28.m2.7.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                      <XMText><text fontsize="70%">marg</text></XMText>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A4.E28.m2.3"/>
                                        <XMRef idref="A4.E28.m2.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E28.m2.3">τ</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E28.m2.4">ϕ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                      <XMText><text fontsize="70%">amort</text></XMText>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A4.E28.m2.5"/>
                                        <XMRef idref="A4.E28.m2.6"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E28.m2.5">τ</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E28.m2.6">ϕ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\mathbb{E}_{\tau}[{\mathcal{L}}(\tau,\phi)]=\mathbb{E}_{\tau}[{%&#10;\mathcal{L}}_{\text{marg}}(\tau,\phi)+{\mathcal{L}}_{\text{amort}}(\tau,\phi)]." text="E _ tau * delimited-[]@(L * open-interval@(tau, phi)) = E _ tau * delimited-[]@(L _ [marg] * open-interval@(tau, phi) + L _ [amort] * open-interval@(tau, phi))" xml:id="A4.E28.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A4.E28.m1.7"/>
                          <XMWrap>
                            <XMApp xml:id="A4.E28.m1.7">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A4.E28.m1.7.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A4.E28.m1.7.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A4.E28.m1.1"/>
                                          <XMRef idref="A4.E28.m1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E28.m1.1">τ</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E28.m1.2">ϕ</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A4.E28.m1.7.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A4.E28.m1.7.2">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                          <XMText><text fontsize="70%">marg</text></XMText>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A4.E28.m1.3"/>
                                            <XMRef idref="A4.E28.m1.4"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E28.m1.3">τ</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E28.m1.4">ϕ</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                                          <XMText><text fontsize="70%">amort</text></XMText>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A4.E28.m1.5"/>
                                            <XMRef idref="A4.E28.m1.6"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" name="tau" role="UNKNOWN" xml:id="A4.E28.m1.5">τ</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A4.E28.m1.6">ϕ</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" xml:id="A4.SS2">
      <tags>
        <tag>D.2</tag>
        <tag role="autoref">subsection D.2</tag>
        <tag role="refnum">D.2</tag>
        <tag role="typerefnum">§D.2</tag>
      </tags>
      <title><tag close=" ">D.2</tag>Sample</title>
      <table inlist="lot" labels="LABEL:table/app_gp_inf_direct" placement="t" xml:id="A4.T7">
        <tags>
          <tag><text fontsize="90%">Table 7</text></tag>
          <tag role="autoref">Table 7</tag>
          <tag role="refnum">7</tag>
          <tag role="typerefnum">Table 7</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" ">7</tag>Test results for 1D regression tasks on RBF. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 7</text></tag><text fontsize="90%">Test results for 1D regression tasks on RBF. ‘Context’ and ‘Target’ respectively denote context and target log-likelihood values, and ‘Task’ denotes the task log-likelihood. All values are averaged over four seeds.</text></caption>
        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <tbody>
            <tr>
              <td border="tt" thead="row"/>
              <td align="center" border="tt" colspan="3">RBF</td>
            </tr>
            <tr>
              <td align="left" thead="row">Model</td>
              <td align="right" border="t">Context</td>
              <td align="right" border="t">Target</td>
              <td align="right" border="t">Task</td>
            </tr>
            <tr>
              <td align="left" border="t" thead="row">CNP</td>
              <td align="right" border="t">1.096<Math mode="inline" tex="\scriptstyle{\pm 0.023}" text="plus-or-minus 0.023" xml:id="A4.T7.m1">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.023" role="NUMBER">0.023</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.515<Math mode="inline" tex="\scriptstyle{\pm 0.018}" text="plus-or-minus 0.018" xml:id="A4.T7.m2">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.018" role="NUMBER">0.018</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.796<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="A4.T7.m3">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">NP</td>
              <td align="right">1.022<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A4.T7.m4">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.498<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m5">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.748<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A4.T7.m6">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">BNP</td>
              <td align="right">1.112<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m7">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.588<Math mode="inline" tex="\scriptstyle{\pm 0.004}" text="plus-or-minus 0.004" xml:id="A4.T7.m8">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.004" role="NUMBER">0.004</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.841<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m9">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="59.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPNP (ours)</text></p>
                </inline-block></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.189</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A4.T7.m10">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.675</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m11">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.911</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m12">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="76.6pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPNP DSI(ours)</text></p>
                </inline-block></td>
              <td align="right">1.120<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A4.T7.m13">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.551<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A4.T7.m14">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.822<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A4.T7.m15">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="79.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPNP DSE(ours)</text></p>
                </inline-block></td>
              <td align="right">1.121<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A4.T7.m16">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.555<Math mode="inline" tex="\scriptstyle{\pm 0.006}" text="plus-or-minus 0.006" xml:id="A4.T7.m17">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.006" role="NUMBER">0.006</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.824<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A4.T7.m18">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" border="t" thead="row">CANP</td>
              <td align="right" border="t">1.304<Math mode="inline" tex="\scriptstyle{\pm 0.027}" text="plus-or-minus 0.027" xml:id="A4.T7.m19">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.027" role="NUMBER">0.027</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">0.847<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A4.T7.m20">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="t">1.036<Math mode="inline" tex="\scriptstyle{\pm 0.020}" text="plus-or-minus 0.020" xml:id="A4.T7.m21">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.020" role="NUMBER">0.020</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">ANP</td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.380</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A4.T7.m22">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.850<Math mode="inline" tex="\scriptstyle{\pm 0.007}" text="plus-or-minus 0.007" xml:id="A4.T7.m23">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.007" role="NUMBER">0.007</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">1.090<Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m24">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row">BANP</td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.380</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A4.T7.m25">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.846<Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A4.T7.m26">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">1.088<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A4.T7.m27">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="66.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPANP (ours)</text></p>
                </inline-block></td>
              <td align="right">1.379<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A4.T7.m28">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">0.881</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.003}" text="plus-or-minus 0.003" xml:id="A4.T7.m29">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.003" role="NUMBER">0.003</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.102</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.001}" text="plus-or-minus 0.001" xml:id="A4.T7.m30">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.001" role="NUMBER">0.001</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="83.3pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPANP DSI(ours)</text></p>
                </inline-block></td>
              <td align="right"><inline-block depth="0.0pt" height="6.4pt" width="22.8pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">1.380</text></p>
                </inline-block><Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A4.T7.m31">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">0.796<Math mode="inline" tex="\scriptstyle{\pm 0.013}" text="plus-or-minus 0.013" xml:id="A4.T7.m32">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.013" role="NUMBER">0.013</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right">1.069<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A4.T7.m33">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
            <tr>
              <td align="left" border="bb" thead="row"><inline-block depth="2.5pt" height="7.5pt" width="86.5pt" xscale="1" xtranslate="0.0pt" yscale="1" ytranslate="0.0pt">
                  <p><text font="bold">MPANP DSE(ours)</text></p>
                </inline-block></td>
              <td align="right" border="bb">1.380<Math mode="inline" tex="\scriptstyle{\pm 0.000}" text="plus-or-minus 0.000" xml:id="A4.T7.m34">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.000" role="NUMBER">0.000</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="bb">0.783<Math mode="inline" tex="\scriptstyle{\pm 0.014}" text="plus-or-minus 0.014" xml:id="A4.T7.m35">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.014" role="NUMBER">0.014</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="bb">1.064<Math mode="inline" tex="\scriptstyle{\pm 0.005}" text="plus-or-minus 0.005" xml:id="A4.T7.m36">
                  <XMath>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                      <XMTok fontsize="70%" meaning="0.005" role="NUMBER">0.005</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
          </tbody>
        </tabular>
      </table>
      <figure inlist="lof" labels="LABEL:fig:direct_sample" placement="t" xml:id="A4.F11">
        <tags>
          <tag><text fontsize="90%">Figure 11</text></tag>
          <tag role="autoref">Figure 11</tag>
          <tag role="refnum">11</tag>
          <tag role="typerefnum">Figure 11</tag>
        </tags>
<!--  %**** directlygeneratinginput.tex Line 100 **** -->        <graphics candidates="figure/direct2_pseudo.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/direct2_pseudo.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="A4.F11.g1"/>
        <graphics candidates="figure/direct8_pseudo.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/direct8_pseudo.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="A4.F11.g2"/>
<!--  %“includegraphics[width = 0.32“textwidth]–figure/data plot 9.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/sample plot 9.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/posterior plot 9.pdf˝ -->        <toccaption class="ltx_centering"><tag close=" ">11</tag>It shows generated pseudo context dataset of direct <ERROR class="undefined">\gls</ERROR>mpanp for 1D regression task with RBF kernel. The red dots are true context points sampled from <ERROR class="undefined">\gls</ERROR>gp with RBF kernel, and the black dots are generated pseudo context points. (Left) Results from simultaneously generating pseudo context pair <ERROR class="undefined">\gls</ERROR>mpanp model. (Right) Results from sequentially generating pseudo context data <ERROR class="undefined">\gls</ERROR>mpanp model.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 11</text></tag><text fontsize="90%">It shows generated pseudo context dataset of direct <ERROR class="undefined">\gls</ERROR>mpanp for 1D regression task with RBF kernel. The red dots are true context points sampled from <ERROR class="undefined">\gls</ERROR>gp with RBF kernel, and the black dots are generated pseudo context points. (Left) Results from simultaneously generating pseudo context pair <ERROR class="undefined">\gls</ERROR>mpanp model. (Right) Results from sequentially generating pseudo context data <ERROR class="undefined">\gls</ERROR>mpanp model.</text></caption>
      </figure>
      <figure inlist="lof" labels="LABEL:fig:direct_decode" placement="t" xml:id="A4.F12">
        <tags>
          <tag><text fontsize="90%">Figure 12</text></tag>
          <tag role="autoref">Figure 12</tag>
          <tag role="refnum">12</tag>
          <tag role="typerefnum">Figure 12</tag>
        </tags>
        <graphics candidates="figure/direct2.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/direct2.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="A4.F12.g1"/>
        <graphics candidates="figure/direct8.pdf" class="ltx_centering ltx_figure_panel" graphic="figure/direct8.pdf" options="width=212.47617pt,keepaspectratio=true" xml:id="A4.F12.g2"/>
<!--  %“includegraphics[width = 0.32“textwidth]–figure/data plot 9.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/sample plot 9.pdf˝ 
     %“includegraphics[width = 0.32“textwidth]–figure/posterior plot 9.pdf˝ -->        <toccaption class="ltx_centering"><tag close=" ">12</tag>It shows posterior samples of direct <ERROR class="undefined">\gls</ERROR>mpanp for 1D regression task with RBF kernel. The black dashed line is a function sampled from <ERROR class="undefined">\gls</ERROR>gp with RBF kernel, and the black dots are context points. We visualized decoded mean and standard deviation with colored lines and areas. (Left) Results from simultaneously generating pseudo context pair <ERROR class="undefined">\gls</ERROR>mpanp model. (Right) Results from sequentially generating pseudo context data <ERROR class="undefined">\gls</ERROR>mpanp model.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 12</text></tag><text fontsize="90%">It shows posterior samples of direct <ERROR class="undefined">\gls</ERROR>mpanp for 1D regression task with RBF kernel. The black dashed line is a function sampled from <ERROR class="undefined">\gls</ERROR>gp with RBF kernel, and the black dots are context points. We visualized decoded mean and standard deviation with colored lines and areas. (Left) Results from simultaneously generating pseudo context pair <ERROR class="undefined">\gls</ERROR>mpanp model. (Right) Results from sequentially generating pseudo context data <ERROR class="undefined">\gls</ERROR>mpanp model.</text></caption>
      </figure>
      <para xml:id="A4.SS2.p1">
        <p>In this section, we presents how the directly generating input model actually samples the pseudo context datasets.</p>
      </para>
      <para xml:id="A4.SS2.p2">
        <p>In <ref labelref="LABEL:fig:direct_sample" show="creftype~refnum"/>, we report generated pseudo context datasets and posterior samples from two different cases of directly generating input models for 1D regression task with RBF kernel. Here we can see that the generator samples pseudo context datasets far from the real context dataset. This phenomenon occurs because the generator learns to generate meaningless inputs ignored by the decoder.
In <ref labelref="LABEL:fig:direct_decode" show="creftype~refnum"/>, we report how two different directly generating <ERROR class="undefined">\glspl</ERROR><!--  %**** directlygeneratinginput.tex Line 125 **** -->mpanp predict posterior samples for 1D regression task with RBF kernel.
Although directly generated pseudo context dataset are a bit far from context dataset, our model still well capture the functional uncertainty in this case.
We report the test results for 1D regression tasks on RBF for two directly generating models in <ref labelref="LABEL:table/app_gp_inf_direct" show="creftype~refnum"/>.
DSI and DSE indicate simultaneously generating models and sequentially generating models, respectively.
<ref labelref="LABEL:table/app_gp_inf_direct" show="creftype~refnum"/> shows that our directly generating models still outperform <ERROR class="undefined">\gls</ERROR>cnp and <ERROR class="undefined">\gls</ERROR>canp in the perspective of log-likelihood.</p>
      </para>
<!--  %In “cref–fig:direct˝, we report generated pseudo context dataset from three different cases of directly generating input model. 
     %The first figure on the left of the “cref–fig:direct˝ shows the generated pseudo context samples from simultaneously generating model without the term $“calL˙–“text–amort˝˝$ in the loss $“calL$. 
     %Here, we can see that the generator learns to generate meaningless inputs that are ignored by the decoder. 
     %The second figure on the middle of the “cref–fig:direct˝ shows the generated pseudo context samples from simultaneously generating model after adding the term $“calL˙–“text–amort˝˝$ in the loss $“calL$. 
     %In this figure, we can see that although the model generates much more meaningful pseudo context dataset compare to the first one, still the generator fails to make sufficiently reasonable pseudo context dataset. 
     %The third figure on the right of the “cref–fig:direct˝ shows the generated pseudo context samples from sequentially generating model. 
     %In this figure, we can see that the model generates sufficiently meaningful pseudo context dataset compare to the others but it generates overconfidently for the unseen data points. 
     %Thus it fails to capture the functional uncertainty of the model which occurs the lack of the performance. 
     %“subsection–Long Training˝ -->    </subsection>
  </appendix>
</document>
