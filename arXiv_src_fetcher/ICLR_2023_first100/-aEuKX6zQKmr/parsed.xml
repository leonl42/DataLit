<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-aEuKX6zQKmr"?>
<!--  %This must be in the first 5 lines to tell arXiv to use pdfLaTeX, which is strongly recommended. --><!--  %In particular, the hyperref package requires pdfLaTeX in order to break URLs across lines. --><?latexml class="article" options="11pt"?>
<?latexml package="acl"?>
<?latexml package="times"?>
<?latexml package="latexsym"?>
<?latexml package="graphicx"?>
<?latexml package="booktabs"?>
<?latexml package="tabularx"?>
<?latexml package="amsmath, bm"?>
<?latexml package="multirow, multicol"?>
<?latexml package="tabularx"?>
<?latexml package="colortbl"?>
<?latexml package="verbatim"?>
<?latexml package="fontenc" options="T1"?>
<?latexml package="inputenc" options="utf8"?>
<?latexml package="microtype"?>
<?latexml package="inconsolata"?>
<?latexml package="graphicx"?>
<!--  %If␣the␣title␣and␣author␣information␣does␣not␣fit␣in␣the␣area␣allocated,␣uncomment␣the␣following --><!--  %\setlength\titlebox{&lt;dim&gt;} --><!--  %and␣set␣&lt;dim&gt;␣to␣something␣5cm␣or␣larger. --><!--  %Author␣information␣can␣be␣set␣in␣various␣styles: --><!--  %For␣several␣authors␣from␣the␣same␣institution: --><!--  %\author{Author␣1␣\and␣...␣\and␣Author␣n␣\\ --><!--  %Address␣line␣\\␣...␣\\␣Address␣line} --><!--  %if␣the␣names␣do␣not␣fit␣well␣on␣one␣line␣use --><!--  %Author␣1␣\\␣{\bf␣Author␣2}␣\\␣...␣\\␣{\bf␣Author␣n}␣\\ --><!--  %For␣authors␣from␣different␣institutions: --><!--  %\author{Author␣1␣\\␣Address␣line␣\\␣␣...␣\\␣Address␣line --><!--  %\And␣␣...␣\And --><!--  %Author␣n␣\\␣Address␣line␣\\␣...␣\\␣Address␣line} --><!--  %To␣start␣a␣separate␣‘‘row’’␣of␣authors␣use␣\AND,␣as␣in --><!--  %\author{Author␣1␣\\␣Address␣line␣\\␣␣...␣\\␣Address␣line --><!--  %\AND --><!--  %Author␣2␣\\␣Address␣line␣\\␣...␣\\␣Address␣line␣\And --><!--  %Author␣3␣\\␣Address␣line␣\\␣...␣\\␣Address␣line} --><!--  %\author{ --><!--  %\textbf{First␣Author\textsuperscript{1}}, --><!--  %\textbf{Second␣Author\textsuperscript{1,2}}, --><!--  %\textbf{Third␣T.␣Author\textsuperscript{1}}, --><!--  %\textbf{Fourth␣Author\textsuperscript{1}}, --><!--  %\\ --><!--  %\textbf{Fifth␣Author\textsuperscript{1,2}}, --><!--  %\textbf{Sixth␣Author\textsuperscript{1}}, --><!--  %\textbf{Seventh␣Author\textsuperscript{1}}, --><!--  %\textbf{Eighth␣Author␣\textsuperscript{1,2,3,4}}, --><!--  %****␣acl_latex.tex␣Line␣100␣**** --><!--  %\\ --><!--  %\textbf{Ninth␣Author\textsuperscript{1}}, --><!--  %\textbf{Tenth␣Author\textsuperscript{1}}, --><!--  %\textbf{Eleventh␣E.␣Author\textsuperscript{1,2,3,4,5}}, --><!--  %\textbf{Twelfth␣Author\textsuperscript{1}}, --><!--  %\\ --><!--  %\textbf{Thirteenth␣Author\textsuperscript{3}}, --><!--  %\textbf{Fourteenth␣F.␣Author\textsuperscript{2,4}}, --><!--  %\textbf{Fifteenth␣Author\textsuperscript{1}}, --><!--  %\textbf{Sixteenth␣Author\textsuperscript{1}}, --><!--  %\\ --><!--  %\textbf{Seventeenth␣S.␣Author\textsuperscript{4,5}}, --><!--  %\textbf{Eighteenth␣Author\textsuperscript{3,4}}, --><!--  %\textbf{Nineteenth␣N.␣Author\textsuperscript{2,5}}, --><!--  %\textbf{Twentieth␣Author\textsuperscript{1}} --><!--  %\\ --><!--  %\\ --><!--  %\textsuperscript{1}Affiliation␣1, --><!--  %\textsuperscript{2}Affiliation␣2, --><!--  %\textsuperscript{3}Affiliation␣3, --><!--  %\textsuperscript{4}Affiliation␣4, --><!--  %\textsuperscript{5}Affiliation␣5 --><!--  %\\ --><!--  %\small{ --><!--  %\textbf{Correspondence:}␣\href{mailto:email@domain}{email@domain} --><!--  %****␣acl_latex.tex␣Line␣125␣**** --><!--  %} --><!--  %} --><?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title>Intermediate Distillation: Data-Efficient Distillation <break/>from Black-Box LLMs for Information Retrieval</title>
  <creator role="author">
    <personname><!--  %****␣acl_latex.tex␣Line␣75␣**** -->Zizhong Li  Haopeng Zhang  Jiawei Zhang <!--  %\author{First␣Author␣\\ 
     %Affiliation␣/␣Address␣line␣1␣\\ 
     %Affiliation␣/␣Address␣line␣2␣\\ 
     %Affiliation␣/␣Address␣line␣3␣\\ 
     %\texttt{email@domain}␣\\\And 
     %Second␣Author␣\\ 
     %Affiliation␣/␣Address␣line␣1␣\\ 
     %Affiliation␣/␣Address␣line␣2␣\\ 
     %Affiliation␣/␣Address␣line␣3␣\\ 
     %\texttt{email@domain}␣\\} --><break/>IFM Lab, University of California, Davis <break/><text font="typewriter">{zzoli, hapzhang, jiwzhang}@ucdavis.edu</text> <break/></personname>
  </creator>
  <abstract name="Abstract">
    <p>Recent research has explored distilling knowledge from large language models (LLMs) to optimize retriever models, especially within the retrieval-augmented generation (RAG) framework.
However, most existing training methods rely on extracting supervision signals from LLMs’ weights or their output probabilities, which is not only resource-intensive but also incompatible with black-box LLMs.
In this paper, we introduce <text font="italic">Intermediate Distillation</text>, a data-efficient knowledge distillation training scheme that treats LLMs as black boxes and distills their knowledge via an innovative LLM-ranker-retriever pipeline, solely using LLMs’ ranking generation as the supervision signal.
Extensive experiments demonstrate that our proposed method can significantly improve the performance of retriever models with only 1,000 training instances.
Moreover, our distilled retriever model significantly boosts performance in question-answering tasks within the RAG framework, demonstrating the potential of LLMs to economically and effectively train smaller models.</p>
  </abstract>
<!--  %In␣this␣paper,␣we␣propose␣an␣alternative,␣more␣efficient␣method␣for␣leveraging␣the␣supervision␣capabilities␣of␣LLMs␣without␣direct␣access␣to␣their␣weights.␣We␣introduce␣a␣multi-step␣training␣technique␣that␣employs␣natural␣language␣outputs␣from␣LLMs␣as␣supervision␣signals.␣Our␣experimental␣results␣indicate␣that␣this␣method␣not␣only␣improves␣the␣performance␣of␣information␣retrievers␣more␣than␣traditional␣signals␣but␣also␣demonstrates␣significant␣advancements␣in␣question-answering␣tasks␣within␣the␣Retrieval-Augmented␣Generation␣(RAG)␣framework.␣These␣findings␣underscore␣the␣potential␣of␣LLMs␣to␣enhance␣smaller␣models’␣training␣effectively␣and␣economically. -->  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>The rapid growth and superior performance of large language models (LLMs) <cite class="ltx_citemacro_cite"><bibref bibrefs="ouyang2022training,openai2023gpt4,wang2024survey" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> have made them a preferred choice for a wide range of NLP applications <cite class="ltx_citemacro_cite"><bibref bibrefs="xi2023rise,wang2024survey,wu2023bloomberggpt,zhang2023extractive,zhang2023summit" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
LLMs have demonstrated robust zero-shot ranking abilities in English and various low-resource languages <cite class="ltx_citemacro_cite"><bibref bibrefs="adeyemi2023zero,sun2023chatgpt" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. Consequently, researchers have applied LLMs to the task of information retrieval, where they outperform previous text search and similarity measurement methods <cite class="ltx_citemacro_cite"><bibref bibrefs="ma2023fine,xu2024bmretriever" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:01" placement="t" xml:id="S1.F1">
      <tags>
        <tag>Figure 1</tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
<!--  %\vspace{-0.5cm}␣␣%␣调整与下文的间距 -->      <graphics candidates="latex/pic/fig1.pdf" class="ltx_centering" graphic="latex/pic/fig1.pdf" options="width=216.81pt,keepaspectratio=true" xml:id="S1.F1.g1"/>
<!--  %Reduce␣the␣figure␣size␣so␣that␣it␣is␣slightly␣narrower␣than␣the␣column. -->      <toccaption class="ltx_centering"><tag close=" ">1</tag>Previous distillation methods (left) rely on extracting supervision signals from LLM’s weights or using LLM’s output probabilities to train the retriever model.
In contrast, our approach (right) bypasses the need for LLM’s likelihood, directly using the LLM’s ranking responses as supervision signals.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 1</tag>Previous distillation methods (left) rely on extracting supervision signals from LLM’s weights or using LLM’s output probabilities to train the retriever model.
In contrast, our approach (right) bypasses the need for LLM’s likelihood, directly using the LLM’s ranking responses as supervision signals.</caption>
<!--  %调整与下文的间距 -->    </figure>
    <para xml:id="S1.p2">
      <p>The retrieval-augmented generation (RAG) framework has been widely adopted to alleviate hallucination problems in LLMs generation, especially for knowledge-intensive tasks <cite class="ltx_citemacro_cite"><bibref bibrefs="lewis2020retrieval" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
The RAG framework consists of two key components: a retriever to locate relevant information from a large corpus based on a given input, and a reader, typically a LLM, to integrate this information into its generation <cite class="ltx_citemacro_cite"><bibref bibrefs="izacard2023atlas,shi2023replug" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.</p>
    </para>
<!--  %****␣intro.tex␣Line␣25␣**** 
     %to␣enhance␣the␣content␣generation. 
     %Influenced␣by␣such␣impressive␣performance,␣there␣are␣also␣numerous␣studies␣which␣have␣explored␣how␣to␣effectively␣leverage␣the␣capabilities␣of␣LLMs␣to␣complement␣information␣retrieval␣models,␣leading␣to␣the␣development␣of␣joint-training␣in␣Retrieval-augmented␣Generation␣(RAG)␣framework␣\cite{lewis2020retrieval}. 
     %During␣the␣inference␣stage,␣the␣information␣retrieved␣by␣the␣retriever␣improves␣the␣accuracy␣of␣the␣reader’s␣output␣and␣reduces␣the␣frequency␣of␣hallucination␣responses. 
     %traditional␣retrieval␣algorithms␣and 
     %Moreover,␣unlike␣using␣the␣retrieval␣algorithms␣or␣off-the-shelf␣models,␣jointly␣training␣RAG␣further␣enhances␣the␣performance␣of␣the␣retriever␣from␣another␣perspective.␣Specifically,␣it␣uses␣the␣powerful␣semantic␣alignment␣capabilities␣of␣LLMs␣to␣distill␣and␣train␣the␣retrieval␣model,␣thereby␣improving␣the␣overall␣performance␣of␣the␣RAG␣framework. -->    <para xml:id="S1.p3">
      <p>How to distill knowledge from LLMs to optimize the retriever in the RAG framework with in-domain data has been a crucial challenge.
Early efforts proposed training the retriever with white-box LLM readers by extracting supervision signals directly from the LLMs’ weights <cite class="ltx_citemacro_cite"><bibref bibrefs="izacard2023atlas,rubin2023long,guu2020retrieval" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
However, this approach becomes more computationally intensive and time-consuming as LLMs increase in size.
Meanwhile, it is incompatible with closed-source models.</p>
    </para>
    <para xml:id="S1.p4">
      <p>Recently, researchers have also turned to knowledge distillation for the retriever from black-box LLMs by training the retriever directly from generated outputs, such as RePLUG <cite class="ltx_citemacro_cite"><bibref bibrefs="shi2023replug" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> and In-Context RALM <cite class="ltx_citemacro_cite"><bibref bibrefs="ram2023context" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
However, both methods use the generation log probabilities for correct answers as the distillation signal to train the retriever, which may suffer from:
1) Limited application scenarios, as the output probabilities are not always available for closed-source LLMs.
2) Discrepancy between retrieval and generation, where training LLMs’ next-token prediction is not optimal for retriever training.
3) High computing costs, since hundreds of thousands of training instances are required in their training process.</p>
    </para>
    <para xml:id="S1.p5">
      <p>To address these limitations, we propose <text font="italic">Intermediate Distillation</text><!--  %Specifically,␣we␣first␣leverage␣the␣generated␣reranking␣responses␣to␣distill␣a␣smaller␣re-ranker␣model.␣Based␣on␣this,␣we␣further␣utilize␣this␣well-trained␣re-ranker␣model␣to␣distillation␣training␣a␣small␣retriever␣model,␣thereby␣intermediately␣transferring␣part␣of␣the␣retrieval␣capabilities␣of␣the␣large␣language␣model␣to␣the␣smaller␣retriever. -->, a data-efficient training scheme that leverages LLM-generated ranking responses to guide the training of the retriever.
Our model employs a rerank-then-retrieve pipeline, where LLMs indirectly influence the retriever training via an intermediate ranker model.
We chose this pipeline for three main reasons:
1) The robust zero-shot ranking capabilities of LLMs establish a strong foundation for knowledge distillation.
2) Using LLMs to generate a relevance-based ranking order is more suitable for retriever training than depending on LLMs output probabilities, making the supervision signals more reliable.
3) There are no restrictions on accessing this generated ranking order.
<!--  %Instead␣of␣direct␣distilling␣the␣retriever␣model,␣we␣use␣a␣rerank-then-retriever␣pipeline␣to␣let␣LLM␣intermediately␣guide␣the␣training␣of␣retriever␣model,␣and␣the␣reasons␣are␣mainly␣twofold. 
     %****␣intro.tex␣Line␣50␣**** --></p>
    </para>
<!--  %the␣re-ranking␣capability␣of␣LLMs␣for␣retrieved␣documents␣according␣to␣its␣relevance␣to␣the␣query␣prompt␣is␣more␣reliable␣than␣their␣direct␣ability␣to␣scale␣the␣relevance␣of␣retrieved␣documents. 
     %Compared␣to␣the␣former,␣generating␣natural␣language␣responses␣is␣much␣more␣challenging␣for␣the␣latter␣to␣provide␣more␣accurate␣answers␣for␣large␣language␣models. 
     %Second,␣as␣previous␣research␣has␣found,␣the␣learning␣ability␣of␣the␣small-scale␣retrievers␣is␣limited.␣Introducing␣a␣re-ranker␣model␣with␣stronger␣data␣fitting␣ability␣as␣a␣learning␣intermediary␣helps␣them␣better␣assimilate␣the␣knowledge␣from␣large␣language␣models. -->    <para xml:id="S1.p6">
      <p>Specifically, we first train a ranker model using the ranking orders generated by LLMs as supervision signals. We then employ this trained ranker to further train the retriever model.
We conduct a series of experiments using advanced, closed-source LLMs that restrict output probability access.
The empirical results demonstrate the effectiveness of our method, requiring 100x to even 1000x less data than previous methods <cite class="ltx_citemacro_cite"><bibref bibrefs="ram2023context,shi2023replug" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite><!--  %Specifically,␣our␣training␣starts␣with␣an␣off-the-shelf␣retriever␣model␣that␣searches␣for␣relevant␣documents␣from␣a␣large␣corpus␣and␣then␣form␣a␣subset␣of␣relevance␣retrieved␣documents␣for␣a␣specific␣given␣query. -->, thereby significantly reducing computational costs.
Our main contributions are:
<!--  %We␣concatenate␣this␣query␣with␣all␣documents␣in␣this␣subset␣to␣create␣an␣input␣prompt␣for␣the␣LLM. 
     %The␣LLM␣then␣generates␣a␣ranking␣list␣based␣on␣the␣relevance␣of␣the␣documents,␣which␣is␣used␣to␣unsupervised␣train␣a␣ranker␣model. 
     %This␣ranker␣model,␣initially␣starting␣with␣an␣off-the-shelf␣retriever␣checkpoint,␣is␣trained␣for␣the␣distillation␣training␣of␣the␣retriever␣model. 
     %Subsequently,␣this␣distilled␣ranker␣model␣provides␣unsupervised␣training␣signals␣to␣the␣retriever␣model,␣which␣also␣starts␣from␣an␣off-the-shelf␣retriever␣checkpoint. 
     %This␣method␣effectively␣transfers␣the␣LLM’s␣advanced␣semantic␣alignment␣capabilities␣to␣the␣smaller␣retriever␣model,␣enhancing␣its␣accuracy␣in␣identifying␣the␣relevant␣documents. 
     %Specifically,␣we␣initialize␣our␣training␣framework␣by␣using␣an␣off-the-shelf␣retriever␣model␣to␣search␣several␣documents␣from␣large␣corpus␣based␣on␣the␣given␣query,␣as␣the␣candidate␣document␣pool␣for␣ranking. 
     %Then,␣we␣concatenate␣the␣query␣and␣all␣of␣the␣documents␣in␣the␣candidate␣pool␣to␣reform␣an␣input␣prompt␣for␣LLM,␣letting␣it␣generate␣a␣ranking␣list␣according␣to␣the␣&lt;query,␣document&gt;␣pair␣relevance,␣which␣could␣used␣for␣distill␣training␣a␣ranker␣model. 
     %We␣further␣utilize␣this␣well-trained␣re-ranker␣model␣to␣unsupervised␣training␣the␣off-the-shelf␣retriever␣model␣mentioned␣above,␣thereby␣intermediately␣transferring␣the␣semantic␣alignment␣capability␣the␣LLMs␣have␣to␣the␣smaller␣retriever␣model. 
     %We␣conduct␣a␣series␣of␣empirical␣experiments␣using␣various␣LLMs␣to␣demonstrate␣the␣effectiveness␣of␣our␣proposed␣distillation␣framework. 
     %We␣also␣compare␣our␣method␣with␣other␣supervised␣training␣signals,␣such␣as␣NLP␣task␣evaluation␣metrics,␣showcasing␣the␣superiority␣of␣our␣method. 
     %Furthermore,␣we␣integrate␣our␣well-trained␣retriever␣models␣into␣the␣RAG␣framework␣and␣assess␣their␣performance␣in␣question-answering␣tasks. 
     %The␣experimental␣results␣further␣validate␣the␣universality␣and␣adaptability␣of␣our␣distillation␣approach. --></p>
      <itemize xml:id="S1.I1">
<!--  %****␣intro.tex␣Line␣75␣**** -->        <item xml:id="S1.I1.i1">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">1st item</tag>
          </tags>
          <para xml:id="S1.I1.i1.p1">
            <p>We introduce Intermediate Distillation, a data-efficient knowledge distillation training scheme that optimizes retrieval models from black-box LLMs via an intermediate ranker model in a two-stage process.</p>
          </para>
        </item>
        <item itemsep="-2.0pt" xml:id="S1.I1.i2">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">2nd item</tag>
          </tags>
          <para xml:id="S1.I1.i2.p1">
            <p>We conduct extensive experiments with cutting-edge LLMs and demonstrate the efficacy and efficiency of the proposed method in enhancing information retrieval performance compared to other supervision signals.</p>
          </para>
        </item>
        <item itemsep="-2.0pt" xml:id="S1.I1.i3">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">3rd item</tag>
          </tags>
          <para xml:id="S1.I1.i3.p1">
            <p>We deploy our distilled retriever model within the RAG framework and demonstrate its effectiveness in downstream tasks such as open-domain question-answering.</p>
          </para>
        </item>
      </itemize>
    </para>
<!--  %Meanwhile,␣the␣presence␣of␣the␣Retrieval-augmented␣Generation␣(RAG)␣framework␣\cite{lewis2020retrieval}␣has␣further␣enhanced␣the␣quality␣of␣LLMs’␣responses. 
     %That␣is,␣by␣leveraging␣the␣retriever␣model␣which␣dynamically␣searches␣the␣relevant␣information␣feed␣to␣the␣language␣model␣for␣generation,␣the␣corresponding␣responses␣become␣more␣accurate␣and␣the␣frequency␣of␣the␣hallucinations␣also␣reduces␣compared␣to␣using␣the␣vanilla␣language␣model. 
     %However,␣it␣has␣been␣a␣great␣challenge␣for␣the␣RAG␣framework␣to␣retrieve␣the␣passages␣that␣are␣most␣likely␣to␣be␣the␣target␣answers␣from␣a␣large␣amount␣of␣corpus,␣as␣training␣a␣high-quality␣retriever␣model␣is␣time-consuming␣and 
     %Influenced␣by␣the␣large␣language␣models’␣impressive␣performance,␣previous␣works␣have␣explored␣the␣retrieve␣ability␣of␣LLM␣fine-tuning␣it␣as␣a␣retriever␣or␣a␣re-ranker,␣which␣shows␣the␣fine-tuned␣LLM␣achieves␣state-of-the-art␣performance,␣surpassing␣previous␣smaller␣retriever␣models.␣However,␣huge␣computational␣and␣time␣resources␣are␣needed␣to␣fine-tune␣a␣large␣language␣model␣before␣it␣becomes␣a␣high-quality␣retriever␣model.␣In␣this␣context,␣exploring␣how␣to␣utilize␣the␣capabilities␣of␣large␣language␣models␣more␣cost-effectively␣has␣become␣a␣valuable␣research␣question. -->  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Related Work</title>
    <para xml:id="S2.p1">
      <p><!--  %Our␣proposed␣framework␣aims␣to␣utilizes␣the␣advanced␣semantic␣alignment␣capabilities␣of␣LLMs␣to␣distill␣their␣knowledge␣into␣smaller␣retriever␣models. -->In this section, we provide a comprehensive background of information retrieval systems and knowledge distillation research related to LLMs.</p>
    </para>
<!--  %Since␣our␣proposed␣knowledge␣distillation␣framework␣aims␣to␣␣the␣advanced␣semantic␣alignment␣capabilities␣of␣current␣large␣language␣models␣(LLMs)␣Therefore,␣we␣incorporate␣foundational␣concepts␣from␣information␣retrieval␣systems␣and␣knowledge␣distillation␣research␣to␣provide␣a␣comprehensive␣background. -->    <figure inlist="lof" labels="LABEL:fig:02" xml:id="S2.F2">
      <tags>
        <tag>Figure 2</tag>
        <tag role="autoref">Figure 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <graphics candidates="latex/pic/fig2-3.pdf" class="ltx_centering" graphic="latex/pic/fig2-3.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S2.F2.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">2</tag>The two-stage knowledge distillation process of our proposed Intermediate Distillation scheme. In Stage 1, we use re-ranking order <Math mode="inline" tex="\pi" text="pi" xml:id="S2.F2.m1">
          <XMath>
            <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
          </XMath>
        </Math> (highlighted in the green background color) as the supervisory signal to train a ranker model. In Stage 2, this distilled ranker unsupervised trains the retriever model to enhance its performance.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 2</tag>The two-stage knowledge distillation process of our proposed Intermediate Distillation scheme. In Stage 1, we use re-ranking order <Math mode="inline" tex="\pi" text="pi" xml:id="S2.F2.m2">
          <XMath>
            <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
          </XMath>
        </Math> (highlighted in the green background color) as the supervisory signal to train a ranker model. In Stage 2, this distilled ranker unsupervised trains the retriever model to enhance its performance.</caption>
    </figure>
    <subsection inlist="toc" xml:id="S2.SS1">
      <tags>
        <tag>2.1</tag>
        <tag role="autoref">subsection 2.1</tag>
        <tag role="refnum">2.1</tag>
        <tag role="typerefnum">§2.1</tag>
      </tags>
      <title><tag close=" ">2.1</tag>Retrieval-Augmented Generation</title>
      <para xml:id="S2.SS1.p1">
        <p>Information retrieval plays a crucial role in various knowledge-intensive NLP tasks, including question-answering <cite class="ltx_citemacro_cite"><bibref bibrefs="siriwardhana2023improving,zhang2024raft" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, fact-verification <cite class="ltx_citemacro_cite"><bibref bibrefs="hang2024trumorgpt,khaliq2024ragar" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and open-domain dialogue <cite class="ltx_citemacro_cite"><bibref bibrefs="wang2024unims,shuster2021retrieval" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
A prevalent approach in information retrieval is the multi-stage retrieval process <cite class="ltx_citemacro_cite"><bibref bibrefs="nogueira2020document" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, which first uses a retriever model to search several most relevant documents from the large corpus, then employs a ranker model to further optimize the ranking order based on relevance, and returns the top few most relevant documents finally.</p>
      </para>
<!--  %For␣example,␣researchers␣have␣fine-tuned␣LLMs␣to␣act␣as␣retrieval␣or␣re-ranking␣models,␣which␣outperform␣the␣existing␣smaller␣models. 
     %Moreover,␣it␣has␣already␣demonstrated␣that␣LLMs␣are␣of␣excellent␣zero-shot␣reranking␣capabilities. 
     %The␣effectiveness␣of␣the␣RAG␣framework␣has␣been␣validated␣across␣various␣NLP␣downstream␣tasks,␣including␣open␣domain␣question-answering,␣fact-verification␣and␣dialogue. -->      <para xml:id="S2.SS1.p2">
        <p>Recently, the retriever models are increasingly used to enhance the generation quality of LLMs for knowledge-intensive tasks due to their flexibility and effectiveness, leading to the development of the retrieval-augmented generation (RAG) framework <cite class="ltx_citemacro_cite"><bibref bibrefs="guu2020retrieval,izacard2023atlas" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite><!--  %This␣method␣reduces␣the␣dependency␣of␣LLMs␣on␣their␣internal␣parameters␣to␣encode␣world␣knowledge,␣thereby␣reducing␣the␣occurrence␣of␣hallucination␣problems␣in␣LLMs␣generation. -->.
This framework integrates information retrieval into the generation process of LLMs, which helps overcome the models’ limitations, such as hallucination, by utilizing external up-to-date information.
In the RAG framework, the retrieved information can be in the form of tokens, entities, or text chunks (i.e., documents), and the retrieval can occur once or repeatedly every <!--  %Normally,␣the␣RAG␣framework␣consists␣of␣a␣retriever␣model␣and␣a␣reader␣model. 
     %****␣related.tex␣Line␣25␣**** 
     %The␣retriever␣is␣responsible␣for␣searching␣the␣relevant␣information␣from␣the␣large␣corpus,␣while␣the␣reader␣combines␣this␣retrieved␣information␣with␣query␣as␣input␣and␣generate␣responses. --><Math mode="inline" tex="n" text="n" xml:id="S2.SS1.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
            </XMath>
          </Math><!--  %Specifically,␣the␣retrieved␣information␣form␣can␣be␣tokens,␣entities,␣or␣text␣chunks␣(i.e.,␣documents);␣the␣retrieval␣process␣can␣be␣performed␣just␣once,␣or␣it␣can␣be␣executed␣every␣$n$␣tokens,␣which␣could␣enhance␣the␣performance␣but␣also␣increase␣the␣inference␣time␣cost. --> tokens, for finding a balance between the performance and time-cost.
Additionally, the retrieval model in RAG is adaptable to both encoder-to-decoder <cite class="ltx_citemacro_cite"><bibref bibrefs="guu2020retrieval,izacard2023atlas" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and decoder-only language models <cite class="ltx_citemacro_cite"><bibref bibrefs="borgeaud2022improving,ram2023context" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, and is applicable during both the pre-training <cite class="ltx_citemacro_cite"><bibref bibrefs="zhong2022training,min2022nonparametric" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and inference stages <cite class="ltx_citemacro_cite"><bibref bibrefs="menick2022teaching,min2023factscore" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.</p>
      </para>
      <para xml:id="S2.SS1.p3">
        <p>In this paper, we use the advanced knowledge from LLMs as the supervision signal to train the retriever models through a multi-stage (i.e., rerank-then-retrieve) training scheme.
We then integrate our well-trained retriever model into the RAG framework,
demonstrating the effectiveness of our proposed training framework in question-answering tasks.</p>
      </para>
<!--  %demonstrating␣that␣our␣distillation␣method␣substantially␣improves␣the␣performance␣of␣LLMs␣in␣question-answering␣downstream␣tasks. -->    </subsection>
    <subsection inlist="toc" xml:id="S2.SS2">
      <tags>
        <tag>2.2</tag>
        <tag role="autoref">subsection 2.2</tag>
        <tag role="refnum">2.2</tag>
        <tag role="typerefnum">§2.2</tag>
      </tags>
      <title><tag close=" ">2.2</tag>Knowledge Distillation in LLMs.</title>
      <para xml:id="S2.SS2.p1">
        <p>Knowledge distillation is widely used to transfer knowledge from complex, large teacher models to smaller student models <cite class="ltx_citemacro_cite"><bibref bibrefs="hinton2015distilling" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
Influenced by the outstanding performance of LLMs, more and more studies focus on using LLMs as teacher models to distill knowledge into smaller task-specific models <cite class="ltx_citemacro_cite"><bibref bibrefs="brown-etal-2023-efficient" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, and the distillation methods can be categorized into two types: white-box <cite class="ltx_citemacro_cite"><bibref bibrefs="gu2023minillm,agarwal2023gkd,udagawa-etal-2023-comparative" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and black-box <cite class="ltx_citemacro_cite"><bibref bibrefs="li2022explanations,ho2022large,hsieh2023distilling" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
Specifically, white-box training leverages both the predictions and the parameters of LLMs to exact knowledge, which can be memory-intensive and computationally demanding.
In contrast, black-box training only relies on the predictions of LLMs, making it less resource-intensive.</p>
      </para>
      <para xml:id="S2.SS2.p2">
        <p>Many studies have successfully integrated knowledge distillation within the RAG framework to train the retriever models.
For white-box LLM distillation training, previous researches employ LLM likelihood, such as attention scores, to assess the relevance distribution of retrieved documents <cite class="ltx_citemacro_cite"><bibref bibrefs="izacard2023atlas,izacard2022unsupervised" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
Meanwhile, some recent studies have also explored methods for training RAG using black-box LLMs, like In-Context RALM <cite class="ltx_citemacro_cite"><bibref bibrefs="ram2023context" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and RePLUG <cite class="ltx_citemacro_cite"><bibref bibrefs="shi2023replug" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite><!--  %This␣kind␣of␣methods␣use␣the␣LLM’s␣output␣probability␣distribution␣as␣the␣supervisory␣signal␣to␣train␣the -->.
The remaining problem is that these methods still rely on the generation log probabilities for the ground truth as the supervision signals in distillation training, which tend to have a degree of randomness and are limited to the availability of the output probabilities.
Furthermore, aligning LLM predictions with the goals of retriever training is not the optimal choice since there remains a gap between retrieval and generation.
<!--  %They␣directly␣transfer␣the␣semantic␣relevance␣of␣the␣retrieved␣information␣to␣the␣retriever␣model␣based␣on␣the␣next␣token’s␣prediction␣probability,␣which␣is␣assumed␣to␣be␣the␣ground␣truth. --></p>
      </para>
<!--  %Typically,␣using␣white-box␣training␣methods␣require␣deploying␣LLMs␣locally,␣which␣is␣complex␣to␣implement. 
     %****␣related.tex␣Line␣50␣**** 
     %Moreover,␣this␣kind␣of␣methods␣consumes␣increasingly␣more␣computational␣resources␣as␣the␣scale␣of␣LLMs␣models␣continues␣to␣expand,␣making␣it␣progressively␣more␣difficult␣to␣sustain. 
     %Some␣recent␣studies␣have␣proposed␣methods␣for␣training␣Retrieval-Augmented␣Generation␣(RAG)␣based␣on␣black-box␣language␣models. 
     %Currently,␣there␣are␣also␣some␣studies␣that␣conduct␣training␣within␣the␣Retrieval-Augmented␣Generation␣(RAG)␣framework␣based␣on␣black-box␣LLMs,␣such␣as␣in-context␣learning␣and␣RePLUG. 
     %Generally,␣these␣output␣probability-based␣methods␣have␣more␣randomness,␣and␣has␣limited␣scope␣since␣the␣output␣probabilities␣of␣LLMs␣are␣not␣always␣available. 
     %In␣addition,␣optimizing␣the␣prediction␣of␣LLM␣is␣not␣always␣matching␣the␣goal␣of␣training␣a␣retriever␣model,␣as␣there␣has␣a␣gap␣between␣retrieval␣and␣generation␣process. 
     %the␣training␣a␣retrieval␣model␣to␣semantically␣align␣directly␣with␣LLMs␣also␣requires␣extensive␣training␣data. 
     %These␣methods␣use␣LLMs␣to␣generate␣a␣series␣of␣quantitative␣score␣distributions␣to␣measure␣how␣much␣each␣retrieved␣document␣could␣improve␣the␣LM␣perplexity,␣thereby␣reveal␣the␣relevance␣of␣each␣document␣to␣the␣query. 
     %However,␣this␣score␣distribution␣is␣not␣stable. -->      <para xml:id="S2.SS2.p3">
        <p>In contrast, our proposed distillation method only requires black-box LLMs to output a relevance-based ranking order of the candidate relevant documents, yielding more consistent, matching, and interpretable results than output probability-based methods.
Moreover, our method is much more data efficient, requiring about 100x and 1000x less data compared to previous approaches <cite class="ltx_citemacro_cite"><bibref bibrefs="shi2023replug,ram2023context" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, significantly saving computational resources and increasing the flexibility of the training process.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Method</title>
<!--  %We␣introduce␣Light␣LLM-Guider,␣a␣lightweight␣knowledge␣distillation␣method␣that␣treats␣LLM␣as␣a␣black-box␣and␣transfer␣its␣superior␣semantic␣alignment␣ability␣to␣reranker␣models␣and␣hence␣the␣performance␣of␣the␣retriever␣model␣within␣retrieval-augmented␣generation␣framework. 
     %0112␣delete 
     %Previous␣work␣in␣information␣retrieval␣often␣uses␣a␣ranker␣model␣to␣refine␣the␣order␣of␣information␣retrieved␣by␣the␣retriever␣model,␣aiming␣to␣improve␣the␣accuracy␣of␣the␣top␣results. 
     %In␣this␣work,␣we␣utilize␣the␣ranker␣model␣differently,␣using␣it␣as␣an␣intermediary␣for␣knowledge␣distillation␣from␣LLMs␣to␣the␣retriever␣model,␣as␣letting␣LLMs␣perform␣relevance-based␣ranking␣tasks␣for␣ranker␣training␣is␣simpler␣and␣more␣robust␣than␣having␣them␣directly␣generate␣a␣relevance␣likelihood␣for␣retriever␣training. 
     %we␣adapt␣this␣two-stage␣workflow,␣using␣a␣ranker␣model␣as␣an␣intermediary␣for␣knowledge␣distillation␣from␣LLMs␣to␣the␣retriever␣model␣instead␣of␣as␣a␣way␣to␣enhance␣the␣results’␣accuracy. 
     %As␣discussed␣in␣the␣previous␣sections,␣letting␣LLMs␣perform␣relevance-based␣ranking␣tasks␣is␣simpler␣and␣more␣robust␣than␣having␣them␣predict␣or␣directly␣generate␣a␣quantified␣likelihood␣of␣information␣relevance. -->    <para xml:id="S3.p1">
      <p>Our two-stage distillation scheme uses a ranker model and a retriever model as the student models and a LLM as the teacher model.
As shown in Figure <ref labelref="LABEL:fig:02"/>, we initially employ an off-the-shelf retriever to select a subset of documents <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.p1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
            </XMApp>
          </XMath>
        </Math> from a large corpus <Math mode="inline" tex="D" text="D" xml:id="S3.p1.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math> based on their relevance to a query <Math mode="inline" tex="Q" text="Q" xml:id="S3.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">Q</XMTok>
          </XMath>
        </Math>.
The LLM then re-ranks these documents, creating a ranking order <Math mode="inline" tex="\pi" text="pi" xml:id="S3.p1.m4">
          <XMath>
            <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
          </XMath>
        </Math>, which is used to train the ranker model in the distillation <text font="italic">Stage 1</text>.
In <text font="italic">Stage 2</text><!--  %The␣following␣sections␣introduce␣our␣proposed␣framework␣in␣details,␣and␣is␣organized␣as␣follows. -->, this ranker enhances the original retriever by minimizing the KL-divergence between their similarity likelihood.
In detail, Section <ref labelref="LABEL:sec:3-1"/> provides the formal definitions of the related tasks.
In Section <ref labelref="LABEL:sec:3-2"/> and Section <ref labelref="LABEL:sec:3-3"/>, we show how knowledge is directly transferred from LLMs to a ranker model and then further conveyed to a retriever model, respectively.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:3-1" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Problem Formulation</title>
      <para xml:id="S3.SS1.p1">
        <p>Given a question <Math mode="inline" tex="Q" text="Q" xml:id="S3.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
            </XMath>
          </Math>, the goal of a retriever model is to find a subset of the most relevant documents <Math mode="inline" tex="D_{n}=\{n_{1},n_{2},...,n_{k}\}\subseteq D" text="D _ n = set@(n _ 1, n _ 2, ldots, n _ k) subset-of-or-equals D" xml:id="S3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS1.p1.m2.2"/>
                    <XMRef idref="S3.SS1.p1.m2.3"/>
                    <XMRef idref="S3.SS1.p1.m2.1"/>
                    <XMRef idref="S3.SS1.p1.m2.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m2.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m2.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S3.SS1.p1.m2.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m2.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="subset-of-or-equals" name="subseteq" role="RELOP">⊆</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMApp>
            </XMath>
          </Math> from a large knowledge corpus <Math mode="inline" tex="D=\{d_{1},d_{2},...,d_{m}\}" text="D = set@(d _ 1, d _ 2, ldots, d _ m)" xml:id="S3.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS1.p1.m3.2"/>
                    <XMRef idref="S3.SS1.p1.m3.3"/>
                    <XMRef idref="S3.SS1.p1.m3.1"/>
                    <XMRef idref="S3.SS1.p1.m3.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m3.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m3.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S3.SS1.p1.m3.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m3.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, where each <Math mode="inline" tex="d_{i},n_{i}" text="list@(d _ i, n _ i)" xml:id="S3.SS1.p1.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS1.p1.m4.1"/>
                  <XMRef idref="S3.SS1.p1.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS1.p1.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS1.p1.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> represents a unique document.
In the retrieval-augmented generation (RAG) framework, this subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS1.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> is combined with the question <Math mode="inline" tex="Q" text="Q" xml:id="S3.SS1.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
            </XMath>
          </Math> to form the reader’s prompt input and then generates the corresponding answer <Math mode="inline" tex="A" text="A" xml:id="S3.SS1.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S3.SS1.p2">
        <p>For the re-ranking task in our distillation framework, the teacher ranker model (i.e., LLMs) is tasked with reordering the documents <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> according to their relevance to the question <Math mode="inline" tex="Q" text="Q" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
            </XMath>
          </Math>.
The re-ranking order can be represented as <Math mode="inline" tex="\pi:T_{sim}(n_{i},Q)&gt;T_{sim}(n_{k},Q)&gt;...&gt;T_{sim}(n_{j},Q)" text="pi colon T _ (s * i * m) * open-interval@(n _ i, Q) &gt; T _ (s * i * m) * open-interval@(n _ k, Q) &gt; ldots &gt; T _ (s * i * m) * open-interval@(n _ j, Q)" xml:id="S3.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMApp>
                  <XMTok meaning="multirelation"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS1.p2.m3.4"/>
                        <XMRef idref="S3.SS1.p2.m3.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.p2.m3.4">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m3.1">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS1.p2.m3.5"/>
                        <XMRef idref="S3.SS1.p2.m3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.p2.m3.5">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m3.2">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMTok name="ldots" role="ID">…</XMTok>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS1.p2.m3.6"/>
                        <XMRef idref="S3.SS1.p2.m3.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.p2.m3.6">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m3.3">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, indicating the descending order of relevance from the documents <Math mode="inline" tex="n_{i},n_{j},...,n_{k}" text="list@(n _ i, n _ j, ldots, n _ k)" xml:id="S3.SS1.p2.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS1.p2.m4.2"/>
                  <XMRef idref="S3.SS1.p2.m4.3"/>
                  <XMRef idref="S3.SS1.p2.m4.1"/>
                  <XMRef idref="S3.SS1.p2.m4.4"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS1.p2.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS1.p2.m4.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S3.SS1.p2.m4.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS1.p2.m4.4">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> in the subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>.
This order information <Math mode="inline" tex="\pi" text="pi" xml:id="S3.SS1.p2.m6">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math> is first transferred to the ranker model, which serves as an intermediary between the LLM and the retriever model.
Subsequently, the ranker model conveys this knowledge to the retriever, thereby enhancing its performance.</p>
      </para>
<!--  %and␣serve␣as␣an␣intermediary␣to␣transfer␣the␣knowledge␣from␣LLMs␣to␣the␣retriever␣model␣finally. -->      <figure inlist="lof" labels="LABEL:fig:03" xml:id="S3.F3">
        <tags>
          <tag>Figure 3</tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <graphics candidates="latex/pic/fig3.pdf" class="ltx_centering" graphic="latex/pic/fig3.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S3.F3.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>An example of our LLM teacher model’s re-ranking process.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 3</tag>An example of our LLM teacher model’s re-ranking process.</caption>
<!--  %\vspace{-3mm} -->      </figure>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:3-2" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Stage 1: Distillation from LLMs to Ranker</title>
      <para xml:id="S3.SS2.p1">
        <p><!--  %\textbf{Ranking␣Data␣Initialization} -->The initial step of our knowledge distillation workflow is data initialization, where we find the relevant document subsets <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> from corpus <Math mode="inline" tex="D" text="D" xml:id="S3.SS2.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> for each specified question <Math mode="inline" tex="Q" text="Q" xml:id="S3.SS2.p1.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
            </XMath>
          </Math>.
These subsets then serve as the input for the <text font="italic">Stage 1</text> training.
In practice, we employ a widely-used information retrieval model, Contriever <cite class="ltx_citemacro_cite"><bibref bibrefs="izacard2022unsupervised" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, as the retriever model for data initialization. <break/><!--  %Additionally,␣we␣initialize␣both␣the␣ranker␣and␣retriever␣models␣within␣our␣distillation␣framework␣using␣off-the-shelf␣Contriever␣model␣checkpoints.\\ --><text font="bold">Re-ranking by LLMs.</text>
In this stage, we utilize LLM’s guaranteed zero-shot ranking capabilities to generate high-quality re-ranking orders for each subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS2.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> based on the relevance to the corresponding question <Math mode="inline" tex="Q" text="Q" xml:id="S3.SS2.p1.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
            </XMath>
          </Math>.
We use a list-wise ranking prompt, which is adapted from the RankGPT <cite class="ltx_citemacro_cite"><bibref bibrefs="sun2023chatgpt" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite><!--  %****␣method.tex␣Line␣50␣**** -->, as our input ranking prompt.
Figure <ref labelref="LABEL:fig:03"/> illustrates a LLM re-ranking process, where the LLM generates a re-ranking order <Math mode="inline" tex="\pi_{D_{n}}:T_{sim}(n_{1},Q)&gt;T_{sim}(n_{5},Q)&gt;T_{sim}(n_{4},Q)&gt;T_{sim}(n_{3},Q%&#10;)&gt;T_{sim}(n_{2},Q)" text="pi _ D _ n colon T _ (s * i * m) * open-interval@(n _ 1, Q) &gt; T _ (s * i * m) * open-interval@(n _ 5, Q) &gt; T _ (s * i * m) * open-interval@(n _ 4, Q) &gt; T _ (s * i * m) * open-interval@(n _ 3, Q) &gt; T _ (s * i * m) * open-interval@(n _ 2, Q)" xml:id="S3.SS2.p1.m6">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="multirelation"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p1.m6.6"/>
                        <XMRef idref="S3.SS2.p1.m6.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p1.m6.6">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m6.1">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p1.m6.7"/>
                        <XMRef idref="S3.SS2.p1.m6.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p1.m6.7">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="5" role="NUMBER">5</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m6.2">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p1.m6.8"/>
                        <XMRef idref="S3.SS2.p1.m6.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p1.m6.8">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m6.3">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p1.m6.9"/>
                        <XMRef idref="S3.SS2.p1.m6.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p1.m6.9">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m6.4">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p1.m6.10"/>
                        <XMRef idref="S3.SS2.p1.m6.5"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p1.m6.10">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p1.m6.5">Q</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><!--  %We␣found␣that␣the␣LLM’s␣excellent␣semantic␣alignment␣capabilities␣effectively␣pushed␣documents␣containing␣the␣corresponding␣answers␣to␣higher␣positions␣in␣the␣generated␣responses,␣as␣shown␣in␣Table␣2␣(where␣the␣numbers␣represent␣the␣average␣ranking␣position␣of␣documents␣containing␣the␣answers). -->.
Following this, we use these re-ranking orders to transfer LLM’s knowledge into a smaller but more efficient ranker model.
<break/><text font="bold">Ranker Distillation Training</text>
We initialize our ranker model by using the dual-encoder structure <text font="italic">Contriever</text><!--  %To␣extract␣the␣ranker␣model’s␣representation␣of␣the␣similarity␣between␣each␣document␣$n_i␣\subset␣D_n$ --> checkpoint.
For each question <Math mode="inline" tex="Q" text="Q" xml:id="S3.SS2.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
            </XMath>
          </Math> and its retrieved document <Math mode="inline" tex="n_{i}\subseteq D_{n}" text="n _ i subset-of-or-equals D _ n" xml:id="S3.SS2.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="subset-of-or-equals" name="subseteq" role="RELOP">⊆</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we represent the question and document using the average value from the last hidden layer of the ranker model, denoted as <Math mode="inline" tex="\hat{Q}" text="hat@(Q)" xml:id="S3.SS2.p1.m9">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\hat{n}_{i}" text="(hat@(n)) _ i" xml:id="S3.SS2.p1.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math>, respectively.
For each training data instance, once we have the representative embeddings <Math mode="inline" tex="\hat{Q}" text="hat@(Q)" xml:id="S3.SS2.p1.m11">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\hat{n}_{i}" text="(hat@(n)) _ i" xml:id="S3.SS2.p1.m12">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math>, we proceed to calculate the similarity likelihood <Math mode="inline" tex="P_{RANK}" text="P _ (R * A * N * K)" xml:id="S3.SS2.p1.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> over <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS2.p1.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>, which can be defined as:</p>
        <equation xml:id="S3.E1">
          <tags>
            <tag>(1)</tag>
            <tag role="autoref">Equation 1</tag>
            <tag role="refnum">1</tag>
          </tags>
          <Math mode="display" tex="P_{RANK}(n_{i}|Q)=\frac{exp(s(\hat{n}_{i},\hat{Q})/\theta)}{\sum_{k=1}^{K}exp(%&#10;s(\hat{n}_{k},\hat{Q})/\theta)}" text="P _ (R * A * N * K) * conditional@(n _ i, Q) = (e * x * p * ((s * open-interval@((hat@(n)) _ i, hat@(Q))) / theta)) / ((sum _ (k = 1)) ^ K)@(e * x * p * ((s * open-interval@((hat@(n)) _ k, hat@(Q))) / theta))" xml:id="S3.E1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">P</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.E1.m1.5"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.E1.m1.5">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="S3.E1.m1.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E1.m1.2">
                          <XMTok meaning="divide" role="MULOP">/</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S3.E1.m1.2.1"/>
                                <XMRef idref="S3.E1.m1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E1.m1.2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMApp>
                                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S3.E1.m1.1">
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E1.m1.4"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E1.m1.4">
                            <XMTok meaning="divide" role="MULOP">/</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S3.E1.m1.4.1"/>
                                  <XMRef idref="S3.E1.m1.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E1.m1.4.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMApp>
                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S3.E1.m1.3">
                                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="s" text="s" xml:id="S3.SS2.p1.m15">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> denotes the dot-product between the ranker’s representation vectors of the question and each retrieved document, and <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS2.p1.m16">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> is the temperature hyper-parameter.</p>
      </para>
<!--  %\textbf{Ranker␣Training␣Objective} -->      <para xml:id="S3.SS2.p2">
        <p>After obtaining the ranker model’s similarity likelihood <Math mode="inline" tex="P_{RANK}(n_{i}|Q)" text="P _ (R * A * N * K) * conditional@(n _ i, Q)" xml:id="S3.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m1.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> over its relevant document subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>, and the LLM-generated re-ranking order <Math mode="inline" tex="\pi_{D_{n}}" text="pi _ D _ n" xml:id="S3.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we use ListMLE <cite class="ltx_citemacro_cite"><bibref bibrefs="xia2008listwise" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, a list-wise loss function for distillation training from LLMs to the ranker model.
ListMLE considers the similarity likelihood <Math mode="inline" tex="P_{RANK}(D_{n})" text="P _ (R * A * N * K) * D _ n" xml:id="S3.SS2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m4.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> as the predicted list and <Math mode="inline" tex="\pi_{D_{n}}" text="pi _ D _ n" xml:id="S3.SS2.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> as the ground truth, aiming to minimize the following loss function:</p>
        <equationgroup xml:id="S3.E2">
          <tags>
            <tag>(2)</tag>
            <tag role="autoref">Equation 2</tag>
            <tag role="refnum">2</tag>
          </tags>
          <equation xml:id="S3.E2X">
            <MathFork>
              <Math tex="\displaystyle L(P_{RANK},\pi)=-logP(\pi_{P_{RANK}}|\pi)" text="L * open-interval@(P _ (R * A * N * K), pi) = - l * o * g * P * conditional@(pi _ P _ (R * A * N * K), pi)" xml:id="S3.E2X.m1">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.E2X.m1.2"/>
                          <XMRef idref="S3.E2X.m1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E2X.m1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" name="pi" role="UNKNOWN" xml:id="S3.E2X.m1.1">π</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">l</XMTok>
                        <XMTok font="italic" role="UNKNOWN">o</XMTok>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" role="UNKNOWN">P</XMTok>
                        <XMDual>
                          <XMRef idref="S3.E2X.m1.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S3.E2X.m1.3">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">R</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">A</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math tex="\displaystyle L(P_{RANK},\pi)" text="L * open-interval@(P _ (R * A * N * K), pi)" xml:id="S3.E2X.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S3.E2X.m2.2"/>
                            <XMRef idref="S3.E2X.m2.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S3.E2X.m2.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMTok font="italic" role="UNKNOWN">P</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" name="pi" role="UNKNOWN" xml:id="S3.E2X.m2.1">π</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math tex="\displaystyle=-logP(\pi_{P_{RANK}}|\pi)" text="absent = - l * o * g * P * conditional@(pi _ P _ (R * A * N * K), pi)" xml:id="S3.E2X.m3">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">l</XMTok>
                            <XMTok font="italic" role="UNKNOWN">o</XMTok>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E2X.m3.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E2X.m3.1">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">R</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">A</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S3.E2Xa">
            <MathFork>
              <Math tex="\displaystyle=-log\prod_{j=1}^{k}\frac{exp(P_{RANK}(n_{i}))}{\sum_{m=j}^{k}exp%&#10;(P_{RANK}(n_{m}))}" text="absent = - l * o * g * ((product _ (j = 1)) ^ k)@((e * x * p * P _ (R * A * N * K) * n _ i) / ((sum _ (m = j)) ^ k)@(e * x * p * P _ (R * A * N * K) * n _ m))" xml:id="S3.E2Xa.m1">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">l</XMTok>
                        <XMTok font="italic" role="UNKNOWN">o</XMTok>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                              <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">e</XMTok>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E2Xa.m1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E2Xa.m1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                      <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E2Xa.m1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E2Xa.m1.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                  <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMDual>
                                  <XMRef idref="S3.E2Xa.m1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E2Xa.m1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                        <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="S3.E2Xa.m1.2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S3.E2Xa.m1.2.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                            <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td/>
                <td align="left"><Math tex="\displaystyle=-log\prod_{j=1}^{k}\frac{exp(P_{RANK}(n_{i}))}{\sum_{m=j}^{k}exp%&#10;(P_{RANK}(n_{m}))}" text="absent = - l * o * g * ((product _ (j = 1)) ^ k)@((e * x * p * P _ (R * A * N * K) * n _ i) / ((sum _ (m = j)) ^ k)@(e * x * p * P _ (R * A * N * K) * n _ m))" xml:id="S3.E2Xa.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">l</XMTok>
                            <XMTok font="italic" role="UNKNOWN">o</XMTok>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                  <XMTok mathstyle="display" meaning="product" name="prod" role="SUMOP" scriptpos="mid">∏</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMDual>
                                    <XMRef idref="S3.E2Xa.m2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E2Xa.m2.1">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                          <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="S3.E2Xa.m2.1.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S3.E2Xa.m2.1.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                              <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMDual>
                                      <XMRef idref="S3.E2Xa.m2.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E2Xa.m2.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="S3.E2Xa.m2.2.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="S3.E2Xa.m2.2.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\pi_{P_{RANK}}" text="pi _ P _ (R * A * N * K)" xml:id="S3.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">A</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> represents the permutation of documents ordered by the ground truth ranking <Math mode="inline" tex="\pi" text="pi" xml:id="S3.SS2.p2.m7">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math>.
The loss function calculates an exponential probability distribution over all elements of <Math mode="inline" tex="P(\pi_{P_{RANK}}|\pi)" text="P * conditional@(pi _ P _ (R * A * N * K), pi)" xml:id="S3.SS2.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m8.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">R</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">A</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, expressing the loss as the negative log-likelihood of the ground truth order <Math mode="inline" tex="\pi" text="pi" xml:id="S3.SS2.p2.m9">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:3-3" xml:id="S3.SS3">
      <tags>
        <tag>3.3</tag>
        <tag role="autoref">subsection 3.3</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">§3.3</tag>
      </tags>
      <title><tag close=" ">3.3</tag>Stage 2: Distillation from Ranker to Retriever</title>
      <para xml:id="S3.SS3.p1">
        <p><!--  %After␣completing␣Stage␣1␣of␣our␣proposed␣framework,␣we␣obtain␣a␣well-trained␣ranker␣model. -->In <text font="italic">Stage 2</text>, this well-train ranker model is used to enhance the retriever model’s performance by transferring knowledge from LLMs.<break/><!--  %\textbf{Compute␣Retriever␣Similarity␣Likelihood.} -->We initialize our retriever model using a dual-encoder Contriever checkpoint, similar to the ranker.
For each question and its retrieved document, we also compute their representations <Math mode="inline" tex="\widetilde{Q}" text="widetilde@(Q)" xml:id="S3.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok name="widetilde" role="OVERACCENT">~</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\widetilde{n}_{i}" text="(widetilde@(n)) _ i" xml:id="S3.SS3.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="widetilde" role="OVERACCENT">~</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> by calculating the average value from the retriever model’s last hidden layer and the similarity distribution <Math mode="inline" tex="P_{RETR}" text="P _ (R * E * T * R)" xml:id="S3.SS3.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">E</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> of the retriever model over <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S3.SS3.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> is defined as:</p>
        <equation xml:id="S3.E3">
          <tags>
            <tag>(3)</tag>
            <tag role="autoref">Equation 3</tag>
            <tag role="refnum">3</tag>
          </tags>
          <Math mode="display" tex="P_{RETR}(n_{i}|Q)=\frac{exp(s(\widetilde{n}_{i},\widetilde{Q})/\theta)}{\sum_{%&#10;k=1}^{K}exp(s(\widetilde{n}_{k},\widetilde{Q})/\theta)}" text="P _ (R * E * T * R) * conditional@(n _ i, Q) = (e * x * p * ((s * open-interval@((widetilde@(n)) _ i, widetilde@(Q))) / theta)) / ((sum _ (k = 1)) ^ K)@(e * x * p * ((s * open-interval@((widetilde@(n)) _ k, widetilde@(Q))) / theta))" xml:id="S3.E3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">P</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">E</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.E3.m1.5"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.E3.m1.5">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="S3.E3.m1.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E3.m1.2">
                          <XMTok meaning="divide" role="MULOP">/</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S3.E3.m1.2.1"/>
                                <XMRef idref="S3.E3.m1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E3.m1.2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMApp>
                                    <XMTok name="widetilde" role="OVERACCENT">~</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S3.E3.m1.1">
                                  <XMTok name="widetilde" role="OVERACCENT">~</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E3.m1.4"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E3.m1.4">
                            <XMTok meaning="divide" role="MULOP">/</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S3.E3.m1.4.1"/>
                                  <XMRef idref="S3.E3.m1.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E3.m1.4.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMApp>
                                      <XMTok name="widetilde" role="OVERACCENT">~</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S3.E3.m1.3">
                                    <XMTok name="widetilde" role="OVERACCENT">~</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="s" text="s" xml:id="S3.SS3.p1.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> represents the dot-product between the retriever’s representation vectors of the question and each retrieved document, and <Math mode="inline" tex="\theta" text="theta" xml:id="S3.SS3.p1.m6">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> is the temperature hyper-parameter.</p>
      </para>
      <para xml:id="S3.SS3.p2">
        <p><!--  %\textbf{Retriever␣Training␣Objective} -->We then leverage the similarity likelihood <!--  %****␣method.tex␣Line␣100␣**** --><Math mode="inline" tex="P_{RANK}" text="P _ (R * A * N * K)" xml:id="S3.SS3.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> from the previously trained ranker model to enhance the retriever model’s performance under an unsupervised learning process by minimizing the KL-divergence between <Math mode="inline" tex="P_{RANK}" text="P _ (R * A * N * K)" xml:id="S3.SS3.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="P_{RETR}" text="P _ (R * E * T * R)" xml:id="S3.SS3.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">E</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>:</p>
        <equation xml:id="S3.E4">
          <tags>
            <tag>(4)</tag>
            <tag role="autoref">Equation 4</tag>
            <tag role="refnum">4</tag>
          </tags>
          <Math class="ltx_math_unparsed" mode="display" tex="D_{KL}(P_{RANK}||P_{RETR})" xml:id="S3.E4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                </XMApp>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">A</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">E</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS3.p3">
        <p>This process ensures the retriever model aligns more closely with the text similarity knowledge from the LLMs.
Through this two-stage distillation scheme, we enhance the retrieval accuracy and effectiveness of the retriever model, which can be further applied to the RAG framework to improve its performance on knowledge-intensive NLP tasks.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:4" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Experiment</title>
    <table inlist="lot" labels="LABEL:tab:tab02" placement="t" xml:id="S4.T1">
      <tags>
        <tag>Table 1</tag>
        <tag role="autoref">Table 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Table 1</tag>
      </tags>
      <inline-block align="center" depth="0.0pt" height="203.8pt" width="393.3pt" xscale="0.9" xtranslate="-21.8pt" yscale="0.9" ytranslate="11.3pt">
        <inline-block depth="0.0pt" height="226.4pt" width="433.6pt" xscale="1.04824122401019" xtranslate="10.0pt" yscale="1.04824122401019" ytranslate="-5.2pt">
          <tabular colsep="4.3pt" vattach="middle">
            <tbody>
              <tr>
                <td align="center" border="tt" rowspan="2"><text font="bold">Distillation Methods</text></td>
                <td align="center" border="tt" colspan="4"><text font="bold">NQ</text></td>
                <td align="center" border="tt" colspan="4"><text font="bold">TriviaQA</text></td>
                <td border="tt"/>
              </tr>
              <tr>
                <td align="center" border="t"><text font="bold">HR@5<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m1">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td align="center" border="t"><text font="bold">HR@10<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m2">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td align="center" border="t"><text font="bold">EM<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m3">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td align="center" border="t"><text font="bold">F1<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m4">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td border="t"/>
                <td align="center" border="t"><text font="bold">HR@5<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m5">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td align="center" border="t"><text font="bold">HR@10<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m6">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td align="center" border="t"><text font="bold">EM<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m7">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
                <td align="center" border="t"><text font="bold">F1<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S4.T1.m8">
                      <XMath>
                        <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                      </XMath>
                    </Math></text></td>
              </tr>
              <tr>
                <td align="center" border="t">w/o Distillation</td>
                <td align="center" border="t">0.478</td>
                <td align="center" border="t">0.583</td>
                <td align="center" border="t">26.09</td>
                <td align="center" border="t">36.75</td>
                <td border="t"/>
                <td align="center" border="t">0.595</td>
                <td align="center" border="t">0.678</td>
                <td align="center" border="t">54.99</td>
                <td align="center" border="t">63.55</td>
              </tr>
              <tr backgroundcolor="#F4F4F4">
                <td align="center" border="t" colspan="10"><text backgroundcolor="#F4F4F4" font="bold slanted">Supervised Distillation</text></td>
              </tr>
              <tr>
                <td align="center" border="t">BM25</td>
                <td align="center" border="t">0.186</td>
                <td align="center" border="t">0.262</td>
                <td align="center" border="t">18.17</td>
                <td align="center" border="t">27.88</td>
                <td border="t"/>
                <td align="center" border="t">0.120</td>
                <td align="center" border="t">0.175</td>
                <td align="center" border="t">46.90</td>
                <td align="center" border="t">55.38</td>
              </tr>
              <tr>
                <td align="center">Rule-Based</td>
                <td align="center">0.223</td>
                <td align="center">0.303</td>
                <td align="center">19.75</td>
                <td align="center">29.64</td>
                <td/>
                <td align="center">0.277</td>
                <td align="center">0.356</td>
                <td align="center">50.08</td>
                <td align="center">58.45</td>
              </tr>
              <tr>
                <td align="center">Metric (ROUGE-2)</td>
                <td align="center">0.534</td>
                <td align="center">0.643</td>
                <td align="center">27.76</td>
                <td align="center">38.16</td>
                <td/>
                <td align="center">0.641</td>
                <td align="center">0.716</td>
                <td align="center">56.17</td>
                <td align="center">64.92</td>
              </tr>
              <tr backgroundcolor="#F4F4F4">
                <td align="center" border="t" colspan="10"><text backgroundcolor="#F4F4F4" font="bold slanted">Intermediate Distillation (Ours)</text></td>
              </tr>
              <tr>
                <td align="center" border="t">GPT-3.5 Turbo</td>
                <td align="center" border="t">0.505</td>
                <td align="center" border="t">0.606</td>
                <td align="center" border="t">25.84</td>
                <td align="center" border="t">36.13</td>
                <td border="t"/>
                <td align="center" border="t">0.587</td>
                <td align="center" border="t">0.664</td>
                <td align="center" border="t">53.72</td>
                <td align="center" border="t">62.16</td>
              </tr>
              <tr>
                <td align="center">GPT-4o</td>
                <td align="center">0.553</td>
                <td align="center">0.652</td>
                <td align="center">27.01</td>
                <td align="center">37.38</td>
                <td/>
                <td align="center">0.664</td>
                <td align="center"><text font="bold">0.734</text></td>
                <td align="center">56.27</td>
                <td align="center">64.98</td>
              </tr>
              <tr>
                <td align="center">GPT-4 Turbo</td>
                <td align="center">0.545</td>
                <td align="center">0.656</td>
                <td align="center">28.31</td>
                <td align="center">38.68</td>
                <td/>
                <td align="center">0.662</td>
                <td align="center">0.727</td>
                <td align="center">56.15</td>
                <td align="center">65.07</td>
              </tr>
              <tr>
                <td align="center" border="bb">Claude3 Opus</td>
                <td align="center" border="bb"><text font="bold">0.562</text></td>
                <td align="center" border="bb"><text font="bold">0.665</text></td>
                <td align="center" border="bb"><text font="bold">28.45</text></td>
                <td align="center" border="bb"><text font="bold">38.83</text></td>
                <td border="bb"/>
                <td align="center" border="bb"><text font="bold">0.669</text></td>
                <td align="center" border="bb">0.733</td>
                <td align="center" border="bb"><text font="bold">56.68</text></td>
                <td align="center" border="bb"><text font="bold">65.36</text></td>
              </tr>
            </tbody>
          </tabular>
        </inline-block>
      </inline-block>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>The performance comparison of our proposed Intermediate Distillation scheme with other baseline supervised distillation methods on question-answering tasks.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Table 1</tag>The performance comparison of our proposed Intermediate Distillation scheme with other baseline supervised distillation methods on question-answering tasks.</caption>
<!--  %调整与下文的间距 
     %****␣experiment.tex␣Line␣50␣**** -->    </table>
    <subsection inlist="toc" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Experiment Setup</title>
      <para xml:id="S4.SS1.p1">
        <p><text font="bold">Dataset</text> We conduct experiments on two benchmark open-domain question-answering datasets: <text font="italic">NaturalQuestions (NQ)</text> <cite class="ltx_citemacro_cite"><bibref bibrefs="kwiatkowski-etal-2019-natural" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and <text font="italic">TriviaQA</text> <cite class="ltx_citemacro_cite"><bibref bibrefs="joshi-etal-2017-triviaqa" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
The <text font="italic">NQ</text> dataset includes queries from <text font="italic">google.com query</text> and their corresponding Wikipedia pages, each with an annotated passage containing the answer.
We use the dataset version provided by ATLAS <cite class="ltx_citemacro_cite"><bibref bibrefs="izacard2023atlas" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite><!--  %Similarly,␣the␣document␣source␣of␣the␣question-answer␣pairs␣in␣\textit{TriviaQA}␣dataset␣is␣also␣collected␣from␣Wikipedia␣and␣the␣web. --> and follow its training, validation, and testing splits: 79,168/8,757/3,610.
Similarly, we also use the <text font="italic">TriviaQA</text>, which contains question-answer pairs sourced from Wikipedia and the web, that ATLAS provides and following its training, validation, and testing splits: 78,785/8,837/11,313.
For the knowledge corpus base, we utilize data from
Wikipedia as of December 20, 2018, adapting the passage embeddings provided by ATLAS.</p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p>For our experiments, we selectively sample 1,000 instances from each training set from <text font="italic">NQ</text> and <text font="italic">TriviaQA</text>, keeping validation and testing sets unchanged.
We further discuss the impact of selecting different types of training data in Section <ref labelref="LABEL:sec:5-2"/><!--  %We␣sample␣only␣1,000␣data␣instances␣from␣the␣original␣training␣set␣partitions␣of␣the␣\textit{NaturalQuestions}␣\textit{TriviaQA}␣datasets␣to␣form␣our␣final␣training␣dataset␣while␣keeping␣the␣size␣of␣validation␣and␣test␣sets␣unchanged. -->.
This training set size is about 100 to 1,000 times smaller than those used in previous black-box LLM distillation methods within the RAG framework, demonstrating the superior data efficiency of our approach.
The impact of training set size on performance is discussed further in Section <!--  %The␣training␣data␣sets␣we␣select␣consist␣of␣question-answer␣pairs␣where␣the␣corresponding␣relevant␣retrieved␣document␣subset␣contains␣the␣answer␣(i.e.,␣ground␣truth)␣but␣is␣not␣directly␣ranked␣first␣in␣the␣subset. 
     %We␣choose␣this␣training␣set␣size␣and␣select␣strategy␣for␣two␣reasons:␣1)␣Obtaining␣responses␣from␣closed-source␣LLMs␣leads␣to␣considerable␣costs,␣and␣using␣1,000␣entries␣instead␣of␣tens␣of␣thousands␣of␣entries␣strikes␣a␣balance␣between␣economic␣expenses␣and␣improvements␣in␣model␣performance;␣2)␣Our␣experimental␣results,␣which␣detailed␣in␣the␣following␣section,␣show␣that␣this␣sampling␣strategy␣significantly␣improves␣the␣retriever␣model’s␣performance␣within␣the␣RAG␣framework,␣outperforming␣other␣training␣methods. --><ref labelref="LABEL:sec:5-3"/>. <break/><!--  %Section␣5␣further␣explore␣how␣training␣set␣size␣affects␣the␣retriever␣model’s␣performance␣improvement.\\ 
     %\textbf{Experimental␣Settings} 
     %We␣use␣the␣pre-trained␣\textit{Contriever}␣model␣as␣our␣initial␣reranker␣model␣and␣retriever␣model. 
     %For␣knowledge␣distillation␣training,␣we␣choose␣the␣high-performing␣GPT3.5,␣GPT4o,␣GPT4-turbo␣and␣Claude3␣to␣serve␣as␣the␣teacher␣model.\\ --><text font="bold">Baseline</text> We evaluate our distillation framework, Intermediate Distillation, against the following established text similarity methods: <text font="italic">ROUGE-2</text>, an evaluation metric frequently used in NLP, and <text font="italic">BM25</text>, a popular information retrieval algorithm.
The idea of employing NLP evaluation metrics like ROUGE-2 for knowledge distillation in retriever models is first proposed by <cite class="ltx_citemacro_cite"><bibref bibrefs="he2022metric" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, which also uses a multi-step distillation approach to solve the Commonsense Reasoning tasks <note mark="1" role="footnote" xml:id="footnote1"><tags>
              <tag>1</tag>
              <tag role="autoref">footnote 1</tag>
              <tag role="refnum">1</tag>
              <tag role="typerefnum">footnote 1</tag>
            </tags>We choose ROUGE-2 as our compared baseline metric, as it outperforms other metrics in this prior study.</note>.
For both ROUGE-2 and BM25, we use the similarity likelihood between the query and its relevant documents via their calculation to generate re-ranking order as the supervision signals.
Meanwhile, we do not consider the previous work <text font="italic">RePLUG</text> <cite class="ltx_citemacro_cite"><bibref bibrefs="shi2023replug" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> as a baseline since it uses a larger data scale and relies on LLMs output probabilities, which is not a fair comparison.</p>
      </para>
      <para xml:id="S4.SS1.p3">
        <p>In addition, we conduct a <text font="italic">Rule-Based</text> experiment that ranks documents containing the answer at the top in re-ranking order, which aims to demonstrate that effective re-ranking distillation signals should not only highlight answers.<break/><!--  %We␣evaluate␣the␣effectiveness␣of␣our␣methods␣and␣baseline␣approaches␣on␣retriever␣models,␣as␣well␣as␣the␣retriever’s␣performance␣with␣the␣RAG␣framework.\\ --><text font="bold">Experimental Settings</text>
We initialize our ranker and retriever models using the Contriever checkpoint <cite class="ltx_citemacro_cite"><bibref bibrefs="izacard2022unsupervised" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> with a dual-encoder structure.
For our proposed distillation scheme, we select several cutting-edge and representative LLMs as the teacher models, including GPT-3.5 Turbo, GPT-4o, GPT-4 Turbo, and Claude3 Opus.
To comprehensively evaluate the performance of our retriever model, we integrate the distilled retriever model into the RAG framework for question-answering tasks, which allows us to measure the improvement in the quality of responses generated by the language model.
In the RAG framework, we use the reader model Llama-3-8B-Instruct <cite class="ltx_citemacro_cite"><bibref bibrefs="touvron2023llama" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> to generate answers.
We also evaluate a baseline version of this RAG framework without additional distillation training for the retriever (i.e., <text font="italic">w/o Distillation</text> experiment). <break/><text font="bold">Implantation Details</text> We set both the ranker and retriever models with a hidden layer size of 768, thus totally have approximately 10 million training parameters for each model.
The learning rates are set as 5e-5 for the ranker model and 2e-5 for the retriever model.
Both models are trained for 5 epochs on the <text font="italic">NQ</text> and <text font="italic">TriviaQA</text> datasets, using a batch size of 20 and optimized with the Adam optimizer.
Additionally, we restrict the size of the relevant document subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S4.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> to 5, each retrieved document with a maximum length of 128. We further discuss the impact of the retrieve subset (i.e., re-ranking list) size in Section <ref labelref="LABEL:sec:5-4"/>.
<break/><text font="bold">Evaluation Metrics</text> We evaluate the retrieval performance of our distilled retriever model through the <text font="italic">top-5</text> and <text font="italic">top-10</text> retrieval Hit Rates (HR@5 and HR@10), which is the percentage of questions where the relevant document subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S4.SS1.p3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> includes at lease one correct answers with the top-5 and top-10 documents.
For question-answering tasks in the RAG framework, we use the standard Exact Match (EM) metric and F1-Score to evaluate the accuracy and precision of the language model generated responses.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag>Experimental Results</title>
      <para xml:id="S4.SS2.p1">
        <p>We present our experimental results, including all the baseline methods and settings evaluated on the testing set of <text font="italic">NQ</text> and <text font="italic">TriviaQA</text> in Table <ref labelref="LABEL:tab:tab02"/><note mark="2" role="footnote" xml:id="footnote2"><tags>
              <tag>2</tag>
              <tag role="autoref">footnote 2</tag>
              <tag role="refnum">2</tag>
              <tag role="typerefnum">footnote 2</tag>
            </tags>The highest values in the table are highlighted in bold on both the NQ and TriviaQA datasets.</note>.
The experimental results show that the retriever model, under our proposed Intermediate Distillation scheme and supervised by Claude3, achieves the best performance in most evaluation metrics, confirming the effectiveness of our proposed method.</p>
      </para>
      <para xml:id="S4.SS2.p2">
        <p>Moreover, the quality of supervision signals from LLMs greatly influences the performance of the distilled retriever models.
For example, the retriever model trained under GPT-4 Turbo supervision outperforms the one supervised by GPT-3.5 Turbo within our Intermediate Distillation scheme, aligning with GPT-4 Turbo’s higher performance across various NLP tasks <cite class="ltx_citemacro_cite"><bibref bibrefs="openai2023gpt4" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
As the rapid development of LLMs, this improvement in supervision quality has also evolved: from being less effective than the ROUGE-2 metric (i.e., as seen the retriever under supervised by GPT-3.5 Turbo) to significantly surpass it (i.e., supervised by GPT-4 Turbo).</p>
      </para>
      <para xml:id="S4.SS2.p3">
        <p><!--  %****␣experiment.tex␣Line␣100␣**** -->In the RAG framework for question-answering tasks, a stronger retriever model is more likely to enhance the output quality of the reader model, demonstrating the effectiveness and adaptability of the Intermediate Distillation framework for NLP downstream tasks.
However, according to our experimental results, while Intermediate Distillation using GPT-4o typically outperforms Supervised Distillation using ROUGE-2 in retrieval performance, the latter can still produce higher quality generations within RAG.
This divergence may be due to the different objectives of the retriever and the reader: the retriever focuses on accurately identifying the ground truth, whereas the reader wants the retriever to provide information that more effectively helps the reader in generating accurate responses.
This discrepancy remains a topic that can be further explored in future work.

<!--  %At␣the␣same␣time,␣while␣the␣trend␣between␣the␣retriever’s␣performance␣and␣the␣quality␣of␣the␣reader’s␣output␣in␣RAG␣usually␣aligned,␣they␣do␣not␣always␣match␣perfectly. 
     %\textbf{1)␣Incorporating␣the␣external␣retrieved␣information␣can␣be␣very␣helpful␣for␣generation.}␣As␣the␣first␣experiment␣in␣Table␣\ref{tab:tab02}␣demonstrates,␣language␣models␣without␣retrieval-augmentation␣do␣not␣perform␣as␣well␣on␣these␣two␣question-answering␣datasets␣compared␣to␣those␣enhanced␣by␣a␣retrieval␣model. 
     %This␣indicates␣that␣for␣LLMs␣(especially␣those␣with␣fewer␣parameters),␣the␣generation␣quality␣which␣relys␣solely␣on␣their␣internal␣parameters␣is␣not␣ideal. 
     %In␣constrast,␣retrieval-augmentation␣can␣significantly␣improve␣their␣generation␣quality.\\ 
     %%␣用外部监督信号进行知识蒸馏可以影响检索器的性能 
     %\textbf{2)␣Knowledge␣distillation␣using␣external␣supervision␣signals␣can␣significantly␣impact␣the␣performance␣of␣the␣retriever.}␣Specifically,␣distilling␣the␣retriever␣with␣reranking␣signals␣from␣metrics␣or␣LLM’s␣generation␣can␣enhance␣the␣performance␣of␣the␣retriever. 
     %However,␣using␣supervision␣signals␣derived␣from␣retrieval␣algorithms␣(i.e.,␣BM25)␣or␣rule-based␣ranking␣method␣tends␣to␣significantly␣degrade␣the␣retriever’s␣performance.␣\\ 
     %%␣直接蒸馏没有间接蒸馏的效果好 
     %\textbf{3)␣Intermediate␣distillation␣yields␣better␣performance␣than␣directly␣distill␣knowledge␣from␣LLMs␣to␣the␣retrieval␣model.}␣According␣to␣the␣Table␣\ref{tab:tab02},␣we␣can␣see␣that␣using␣the␣relevance␣score␣distribution␣provided␣directly␣by␣GPT-4o␣(i.e.,␣\textit{Direct␣Distillation}␣experiment)␣as␣the␣supervision␣signal␣for␣knowledge␣distillation␣can␣not␣train␣retrieval␣models␣that␣perform␣as␣well␣in␣both␣retrieval␣and␣RAG␣applications␣as␣the␣models␣trained␣using␣our␣proposed␣method␣via␣the␣same␣LLM,␣which␣employs␣the␣ranking␣model␣as␣an␣intermediary.␣\\ 
     %%␣性能好的语言模型蒸馏效果更好 
     %\textbf{4)␣Supervision␣signals␣generated␣by␣higher-performing␣LLMs␣are␣of␣better␣quality,␣resulting␣in␣more␣effective␣distillation␣training.}␣Compared␣the␣performance␣of␣the␣trained␣retriever␣models␣distilled␣by␣GPT3.5␣and␣GPT4␣series␣(i.e.,␣GPT4o␣and␣GPT4-turbo),␣the␣retrieval␣models␣distilled␣using␣the␣GPT-4␣series␣exhibit␣significant␣advantages␣both␣in␣retrieval-augmented␣generation␣performance. 
     %This␣aligns␣with␣the␣high␣performance␣reported␣for␣these␣LLMs␣across␣various␣NLP␣tasks.␣\\ 
     %%␣retrieve和rag的性能不强相关 
     %\textbf{5)␣For␣distilled␣retrieval␣models,␣the␣performance␣in␣retrieval␣tasks␣is␣not␣strongly␣correlated␣with␣the␣enhancement␣effect␣on␣language␣model␣generation.}␣From␣Table␣\ref{tab:tab02}␣we␣can␣see␣that␣although␣GPT-4o␣improves␣the␣retrieval␣capabilities␣of␣the␣model␣more␣than␣signals␣derived␣from␣rouge2␣during␣distillation␣training,␣the␣retrievers␣trained␣with␣the␣latter␣actually␣perform␣better␣in␣retrieval-enhanced␣generation␣than␣those␣trained␣with␣the␣former. --></p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:5" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Analysis</title>
    <para xml:id="S5.p1">
      <p>In this section, we conduct ablation studies and a series of quantitative analyses to evaluate how various experimental designs and settings affect the outcomes of our distillation results.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:5-1" xml:id="S5.SS1">
      <tags>
        <tag>5.1</tag>
        <tag role="autoref">subsection 5.1</tag>
        <tag role="refnum">5.1</tag>
        <tag role="typerefnum">§5.1</tag>
      </tags>
      <title><tag close=" ">5.1</tag>Ablation Studies</title>
      <para xml:id="S5.SS1.p1">
        <p>In this subsection, we conduct an experiment named <text font="italic">Direct Distillation</text>, where we train the retriever model directly using the relevance likelihood generated by LLM. More details of experiment setting can be found in Appendix <ref labelref="LABEL:sec:appendix-A"/>.
We compare the results of this approach with our proposed two-stage distillation scheme under the same LLM teacher model (i.e., GPT-4o), and the experimental results are shown in Table <ref labelref="LABEL:tab:tab03"/>.
The results indicate that the Direct Distillation method is less effective than our proposed Intermediate Distillation scheme, which further validates the rationality of the two-stage design of our proposed framework.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:5-2" xml:id="S5.SS2">
      <tags>
        <tag>5.2</tag>
        <tag role="autoref">subsection 5.2</tag>
        <tag role="refnum">5.2</tag>
        <tag role="typerefnum">§5.2</tag>
      </tags>
      <title><tag close=" ">5.2</tag>Impact of the Training Data Type</title>
      <table inlist="lot" labels="LABEL:tab:performance-drp LABEL:tab:tab03" placement="t" xml:id="S5.T2">
        <tags>
          <tag>Table 2</tag>
          <tag role="autoref">Table 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Table 2</tag>
        </tags>
        <inline-block align="center" depth="0.0pt" height="82.1pt" width="220.1pt" xscale="1.0" xtranslate="0.0pt" yscale="1.0" ytranslate="0.0pt">
          <inline-block depth="0.0pt" height="82.1pt" width="216.8pt" xscale="0.760162573354084" xtranslate="-34.2pt" yscale="0.760162573354084" ytranslate="13.0pt">
            <tabular class="ltx_guessed_headers" colsep="4.3pt" vattach="middle">
              <tbody>
                <tr>
                  <td align="center" border="tt" rowspan="2" thead="column"><text font="bold">Method</text></td>
                  <td align="center" border="tt" rowspan="2" thead="column"><text font="bold">Dataset</text></td>
                  <td align="center" border="tt" colspan="3" thead="column"><text font="bold">Evaluation Metrics</text></td>
                  <td border="tt"/>
                </tr>
                <tr>
                  <td align="center" border="t" thead="column"><text font="bold">EM<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S5.T2.m1">
                        <XMath>
                          <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                        </XMath>
                      </Math></text></td>
                  <td align="center" border="t" thead="column"><text font="bold">F1<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S5.T2.m2">
                        <XMath>
                          <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                        </XMath>
                      </Math></text></td>
                  <td align="center" border="t" thead="column"><text font="bold">HR@5<Math mode="inline" tex="\uparrow" text="uparrow" xml:id="S5.T2.m3">
                        <XMath>
                          <XMTok font="medium" name="uparrow" role="ARROW">↑</XMTok>
                        </XMath>
                      </Math></text></td>
                  <td border="t"/>
                </tr>
                <tr>
                  <td align="center" border="t">Direct Distillation</td>
                  <td align="center" border="t">NQ</td>
                  <td align="center" border="t">26.23</td>
                  <td align="center" border="t">36.47</td>
                  <td align="center" border="t">0.505</td>
                  <td border="t"/>
                </tr>
                <tr>
                  <td/>
                  <td align="center">TriviaQA</td>
                  <td align="center">55.39</td>
                  <td align="center">63.96</td>
                  <td align="center">0.623</td>
                  <td/>
                </tr>
                <tr>
                  <td align="center" border="t">Intermediate Distillation</td>
                  <td align="center" border="t">NQ</td>
                  <td align="center" border="t">27.01</td>
                  <td align="center" border="t">37.38</td>
                  <td align="center" border="t">0.553</td>
                  <td border="t"/>
                </tr>
                <tr>
                  <td border="bb"/>
                  <td align="center" border="bb">TriviaQA</td>
                  <td align="center" border="bb">56.27</td>
                  <td align="center" border="bb">64.98</td>
                  <td align="center" border="bb">0.664</td>
                  <td border="bb"/>
                </tr>
              </tbody>
            </tabular>
          </inline-block>
        </inline-block>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>Ablation studies on the effectiveness of two-stage distillation scheme design.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Table 2</tag>Ablation studies on the effectiveness of two-stage distillation scheme design.</caption>
<!--  %调整与下文的间距 -->      </table>
      <figure inlist="lof" labels="LABEL:fig:04" xml:id="S5.F4">
        <tags>
          <tag>Figure 4</tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <graphics candidates="latex/pic/fig4.pdf" class="ltx_centering" graphic="latex/pic/fig4.pdf" options="width=195.12767pt,keepaspectratio=true" xml:id="S5.F4.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>The performance of retriever models across three types of training sets, which vary based on the initial appearance and placement of ground truth in the retrieved subsets.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 4</tag>The performance of retriever models across three types of training sets, which vary based on the initial appearance and placement of ground truth in the retrieved subsets.</caption>
      </figure>
      <para xml:id="S5.SS2.p1">
        <p>Our previous experiment demonstrate that Rule-Based supervision signals, which places documents containing answers at the top, are ineffective and detrimentally impacting the retriever’s performance.
This indicates that simply re-ranking documents based solely on the presence of ground truth (i.e., the correct answer) does not provide the high-quality text similarity insights required for effective distillation.
To delve deeper into the influence of the appearance and placement of ground truth in the re-ranking process, we categorize the initial retrieved document subsets <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="S5.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> based on <text font="italic">NQ</text>’s queries into three categories:
(1) <text font="italic">Following-Answer</text>: contains at least one document with the correct answer, but this kind of document is not at the first position in the subset.
This data type is used in our experiments detailed in Section <ref labelref="LABEL:sec:4"/>.
(2) <text font="italic">First-Answer</text>: contains at least one document with the correct answer, and this kind of documents is at the first position in the subset.
(3) <text font="italic">No-Answer</text>: no documents in the subset contain the correct answer.</p>
      </para>
      <para xml:id="S5.SS2.p2">
        <p>We follow the same training setting used in our primary experiments in Section <ref labelref="LABEL:sec:4"/><!--  %The␣performance␣of␣the␣retriever␣models␣under␣these␣three␣data␣types␣of␣training␣are␣shown␣in␣Figure␣\ref{fig:04}. -->, and use GPT-4 Turbo as the LLM teacher model.
Together with findings from the <!--  %The␣results␣indicate␣that␣subsets␣with␣having␣ground-truth␣documents␣(i.e.,␣Following-GT␣and␣First-GT)␣significantly␣improve␣retriever␣performance␣more␣than␣those␣without␣(i.e.,␣No-GT). 
     %distilling␣the␣retriever␣model␣using␣subsets␣of␣relevant␣documents␣that␣contain␣the␣ground␣truth␣(i.e.,␣Follow-GT␣and␣First-GT)␣produces␣better␣results␣compared␣to␣using␣the␣types␣that␣do␣not␣contain␣the␣answer␣(i.e.,␣No-GT),␣and␣using␣Follow-GT␣proves␣to␣be␣more␣effective␣than␣using␣First-GT␣overall. --><text font="italic">Rule-Based</text> experiments in Section <ref labelref="LABEL:sec:4"/>, the experiment results shown in Figure <ref labelref="LABEL:fig:04"/> indicate that considering the semantic similarity of the text is far more important than arranging documents containing the answers to the top for re-ranking in distillation training, as even the retriever under the <text font="italic">No-Answer</text> data set training has notable improvements.</p>
      </para>
      <para xml:id="S5.SS2.p3">
        <p>Moreover, as the <text font="italic">Following-Answer</text> training data, where the correct answers are not ranked first initially, yields better training results than using the the <text font="italic">First-Answer</text> training data, indicating that optimizing the ground truth placement in re-ranking also has a positive effect on the experimental results after the consideration of text similarity.</p>
      </para>
<!--  %Combined␣with␣the␣results␣from␣the␣Rule-Based␣experiments,␣this␣experimental␣results␣show␣that␣both␣prioritizing␣documents␣containing␣the␣answers␣and␣considering␣the␣semantic␣similarity␣of␣the␣text␣beyond␣just␣the␣answers␣determine␣the␣quality␣of␣the␣re-ranking␣distillation␣signals. -->    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:5-3" xml:id="S5.SS3">
      <tags>
        <tag>5.3</tag>
        <tag role="autoref">subsection 5.3</tag>
        <tag role="refnum">5.3</tag>
        <tag role="typerefnum">§5.3</tag>
      </tags>
      <title><tag close=" ">5.3</tag>Impact of the Training Set Size</title>
      <para xml:id="S5.SS3.p1">
        <p>Our previous experiments demonstrate that our distillation framework significantly enhances retriever model performance with just 1,000 training instances.
In this subsection, we explore how different training set sizes affect distillation effectiveness.
We use training sets of of 50, 100, 200, 500, 1000, and 2000 data instances from the <text font="italic">Following-Answer</text> data type, with other settings consistent with our experiments in Section <ref labelref="LABEL:sec:4"/>.
In addition, we use GPT-4 Turbo as our LLM teacher model.</p>
      </para>
<!--  %In␣addition␣to␣this,␣we␣use␣the␣same␣training␣setting␣as␣Section␣\ref{sec:5-1}␣uses␣to␣train␣the␣retriever␣model,␣and␣the␣experimental␣results␣are␣shown␣in␣Figure␣\ref{fig:05}. -->      <para xml:id="S5.SS3.p2">
        <p>Results in Figure <ref labelref="LABEL:fig:05"/><!--  %initial␣increases␣in␣performance␣are␣significant␣with␣small␣training␣sets. --> show that the performance of the retriever model improves significantly with training data with thousands of or even only hundreds of instances.
These empirical findings highlight the data efficiency of our proposed distillation scheme.
In addition, although initial performance increases are notable with small training sets, the rate of improvement decreases as more training data is used.
This pattern indicates a <!--  %****␣ablation.tex␣Line␣75␣**** --><text font="italic">scaling law</text> in distillation training, where further enhancements become increasingly difficult as the model’s performance improves.
For models that already perform well, even marginal improvements require much more data, demanding greater training resources.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:05" xml:id="S5.F5">
        <tags>
          <tag>Figure 5</tag>
          <tag role="autoref">Figure 5</tag>
          <tag role="refnum">5</tag>
          <tag role="typerefnum">Figure 5</tag>
        </tags>
        <graphics candidates="latex/pic/fig5.pdf" class="ltx_centering" graphic="latex/pic/fig5.pdf" options="width=216.81pt,keepaspectratio=true" xml:id="S5.F5.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">5</tag>The performance of retriever models under different training set size.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 5</tag>The performance of retriever models under different training set size.</caption>
      </figure>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:5-4" xml:id="S5.SS4">
      <tags>
        <tag>5.4</tag>
        <tag role="autoref">subsection 5.4</tag>
        <tag role="refnum">5.4</tag>
        <tag role="typerefnum">§5.4</tag>
      </tags>
      <title><tag close=" ">5.4</tag>Impact of the Re-ranking List Size</title>
      <figure inlist="lof" labels="LABEL:fig:06" placement="!htbp" xml:id="S5.F6">
        <tags>
          <tag>Figure 6</tag>
          <tag role="autoref">Figure 6</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Figure 6</tag>
        </tags>
        <graphics candidates="latex/pic/fig6.pdf" class="ltx_centering" graphic="latex/pic/fig6.pdf" options="width=216.81pt,keepaspectratio=true" xml:id="S5.F6.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">6</tag>The performance of retriever models under different size of the re-ranking list. The performance corresponding to 0 re-ranking list size represents the baseline retriever model performance.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 6</tag>The performance of retriever models under different size of the re-ranking list. The performance corresponding to 0 re-ranking list size represents the baseline retriever model performance.</caption>
      </figure>
      <para xml:id="S5.SS4.p1">
        <p><!--  %That␣is,␣during␣the␣initial␣data␣collection␣phase,␣the␣off-the-shelf␣retriever␣model␣returns␣the␣top-3,␣top-5,␣top-7,␣and␣top-10␣relevant␣documents,␣respectively. -->In previous experiments, we set the re-ranking list to five documents (i.e., we retrieve five relevant documents each time).
Generally, larger re-ranking lists offer more supervision signals from LLMs, thus potentially enhancing the effectiveness of distillation training.
To explore the impact of re-ranking list size on our distillation method, we vary the re-ranking list sizes, using the top-3, top-5, top-7, and top-10 documents from each relevant retrieved subset to conduct the distillation training.
We keep other training settings consistent with those in our primary experiments in Section <ref labelref="LABEL:sec:4"/> and use GPT-4 Turbo as the LLM teacher model.</p>
      </para>
      <para xml:id="S5.SS4.p2">
        <p>The experimental results shown in Figure <ref labelref="LABEL:fig:06"/> show that increasing the re-ranking list size progressively improves the effectiveness of the distillation training.
As the list expands from re-ranking three documents to ten documents, the performance of the distilled retriever model consistently improves.
Moreover, compared with the retriever model’s baseline performance, setting the size of the re-ranking list to 3 still significantly improves the retriever model’s performance not only in HitRate@3 but also across broader metrics from HitRate@5 to HitRate@10.</p>
      </para>
<!--  %TODO␣in␣appendix: 
     %direct␣distill␣prompt␣cases 
     %case␣studies␣in␣metric␣v.s.␣LLM␣RAG␣performance -->    </subsection>
  </section>
  <section inlist="toc" xml:id="S6">
    <tags>
      <tag>6</tag>
      <tag role="autoref">section 6</tag>
      <tag role="refnum">6</tag>
      <tag role="typerefnum">§6</tag>
    </tags>
    <title><tag close=" ">6</tag>Conclusion</title>
    <para xml:id="S6.p1">
      <p>We propose Intermediate Distillation, a two-stage data-efficient knowledge distillation scheme that uses the remarkable capabilities of black-box LLMs to train an information retrieval model through an intermediate ranker model.
We conduct extensive experiments with advanced LLMs, demonstrating that our method enhances the effectiveness and efficiency of the retriever model performance compared to other supervision signals.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S7">
    <tags>
      <tag>7</tag>
      <tag role="autoref">section 7</tag>
      <tag role="refnum">7</tag>
      <tag role="typerefnum">§7</tag>
    </tags>
    <title><tag close=" ">7</tag>Limitation</title>
    <para xml:id="S7.p1">
      <p>This paper proposes a data-efficient distillation scheme using black-box LLMs to train smaller information retrieval models, which prove its effectiveness with training data on the scale of thousands.
However, we do not evaluate our proposed distillation scheme with larger scales of training data, such as tens of thousands or millions of instances, due to budget limitations on accessing responses from closed-source LLMs and insufficient computational resources to utilize high-quality open-source LLMs like Llama-70B.
In the future work, we will focus on extending this study to larger-scale training data, using either closed-source or advanced open-source LLMs to further analysis the effectiveness of our proposed distillation scheme.</p>
    </para>
  </section>
  <bibliography citestyle="authoryear" files="custom" xml:id="bib">
    <title>References</title>
  </bibliography>
  <pagination role="newpage"/>
  <appendix inlist="toc" labels="LABEL:sec:appendix-A" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Analysis of Different Distillation Signal Generated by LLMs</title>
    <toctitle><tag close=" ">A</tag>Analysis of Different Distillation Signal Generated by LLMs</toctitle>
    <para xml:id="A1.p1">
      <p>Here we provide more details about the prompt design of the <text font="italic">Direct Distillation</text> experiment.
We also analyze the corresponding generation quality of LLMs, including the stability and interpretability, and compare it with the re-ranking generation.</p>
    </para>
    <subsection inlist="toc" xml:id="A1.SS1">
      <tags>
        <tag>A.1</tag>
        <tag role="autoref">subsection A.1</tag>
        <tag role="refnum">A.1</tag>
        <tag role="typerefnum">§A.1</tag>
      </tags>
      <title><tag close=" ">A.1</tag>Direct Distillation Prompt Design</title>
      <para xml:id="A1.SS1.p1">
        <p>We follow the re-ranking prompt format design and replace the re-ranking task with quantifying the similarity scores of the retrieved documents for LLM’s supervised signals generation. An example input prompt and the generated responses without explanations is as follows:<break/><break/><text framed="underline">Input Prompt</text>:</p>
        <verbatim font="typewriter">
I will provide one query with {num}
documents, each indicated by number
identifier x.
Please answer me with a list of the
similarity score between the provided
query and documents based on your judgment.
The score should be between 0-1.
Please don’t use interoperator and only
output the score list.
&lt;Question&gt; {question}
&lt;Document1&gt; {document n1}
...
</verbatim>
        <p><text framed="underline">Generated Response</text><!--  %****␣appendix.tex␣Line␣25␣**** -->:</p>
        <verbatim font="typewriter">
[0.1, 0.1, ...., 0.8, 0.2]
</verbatim>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS2">
      <tags>
        <tag>A.2</tag>
        <tag role="autoref">subsection A.2</tag>
        <tag role="refnum">A.2</tag>
        <tag role="typerefnum">§A.2</tag>
      </tags>
      <title><tag close=" ">A.2</tag>Comparison with Re-ranking Response</title>
      <para xml:id="A1.SS2.p1">
        <p>We compare the responses generated from re-ranking prompts and those derived from similarity score prompts used in the Direct Distillation experiment.
Specifically, we randomly select 1,000 data instances from the <text font="italic">NQ</text> dataset, using the queries and their retrieved documents to prompt the LLM to generate both list-wise re-ranking orders and similarity scores.
Examples of responses generated by the LLM, specifically using GPT-4 Turbo, are shown in Table <ref labelref="LABEL:table:03"/>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:07" placement="!htbp" xml:id="A1.F7">
        <tags>
          <tag>Figure 7</tag>
          <tag role="autoref">Figure 7</tag>
          <tag role="refnum">7</tag>
          <tag role="typerefnum">Figure 7</tag>
        </tags>
        <graphics candidates="latex/pic/fig7.pdf" class="ltx_centering" graphic="latex/pic/fig7.pdf" options="width=208.13574pt,keepaspectratio=true" xml:id="A1.F7.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">7</tag>Spearman Correlation between the responses from the re-ranking prompt and the responses from the similarity score prompt.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 7</tag>Spearman Correlation between the responses from the re-ranking prompt and the responses from the similarity score prompt.</caption>
      </figure>
      <para xml:id="A1.SS2.p2">
        <p>Table <ref labelref="LABEL:table:03"/> shows that responses generated from re-ranking prompts are more interpretable than those from similarity score prompts, which often use scaled values that are ambiguous.
Additionally, responses from the similarity score-based prompt frequently yield extreme values, such as 0.0 (completely dissimilar) or 1.0 (highly similar), in some cases, which means that that supervision signals based on similarity scores are less informative and act more like binary signals in certain data instances.</p>
      </para>
      <para xml:id="A1.SS2.p3">
        <p>Moreover, we use the <text font="italic">Spearman Correlation</text> to assess the consistency between responses generated from re-ranking prompts and those from similarity score prompts, and the analysis result is visualized in Figure <ref labelref="LABEL:fig:07"/>.
A higher Spearman correlation value suggests a stronger positive correlation between the two types of responses.
From Figure <ref labelref="LABEL:fig:07"/>, we can see that many response pairs are closely related, indicating the stability and reliability of LLMs in generating responses for similar tasks.
In addition, based on our previous analysis, we can see that the responses from re-ranking prompts are not only reliable but also possess a higher information density compared to those from similarity score prompts, showing that responses from re-ranking prompts have higher-quality supervision capabilities.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS3">
      <tags>
        <tag>A.3</tag>
        <tag role="autoref">subsection A.3</tag>
        <tag role="refnum">A.3</tag>
        <tag role="typerefnum">§A.3</tag>
      </tags>
      <title><tag close=" ">A.3</tag>Implantation Details of Direct Distillation Experiment</title>
      <para xml:id="A1.SS3.p1">
        <p>We use the same training settings as those used in Intermediate Distillation experiments.
Superficially, we set the retriever model with a hidden layer size to 768 and initialize it using a dual-encoder Contriever checkpoint.
The model is trained over five epochs using the same dataset as described in Section <ref labelref="LABEL:sec:4"/>, with a learning rate of 5e-5, a batch size of 20, and optimization via the Adam optimizer.
In addition, we also limit the size of the relevant document subset <Math mode="inline" tex="D_{n}" text="D _ n" xml:id="A1.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> to five, and each retrieved document with a maximum length of 128.</p>
      </para>
      <table inlist="lot" labels="LABEL:table:03" placement="!ht" xml:id="A1.T3">
        <tags>
          <tag>Table 3</tag>
          <tag role="autoref">Table 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Table 3</tag>
        </tags>
        <tabular class="ltx_centering ltx_guessed_headers" colsep="4.3pt" vattach="middle">
          <thead>
            <tr>
              <td align="justify" border="l r t" thead="column" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text font="bold" fontsize="90%">Question &amp; Retrieved Documents</text></p>
                </inline-block></td>
              <td align="center" border="r t" thead="column"><text font="bold" fontsize="90%">Type</text></td>
              <td align="center" border="r t" thead="column" vattach="top"><text font="bold" fontsize="90%">LLM’s Generation</text></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="justify" border="l r t" rowspan="2" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%"><text font="bold">[Question]</text> membership in the european union requires countries to have which type of government
<text font="bold">[Document1] </text> the european continent. the eu’s example is being followed by the african union, the union of south American nations…
<text font="bold">[Document2] </text> powers of states, the considerable level of translation and the choice of a lesser city as the capital…
<text font="bold">[Document3]</text> principal characteristic of classical <text color="#FF0000">democracy</text>. the concept of a mixed government was studied during the renaissance and the age of reason by niccolo machiavelli, giambattista vico…
<text font="bold">[Document4]</text> thus essentially preventing it from participating in government. the european union ( eu ) is an association of twenty - eight sovereign member states…
<text font="bold">[Document5]</text> civiletti opinions, not all funding gaps led to shutdowns. of the nine funding gaps between 1980 and 1990, only four led to furloughs…</text></p>
                </inline-block></td>
              <td align="center" border="r t"><text font="italic" fontsize="90%">Re-ranking</text></td>
              <td align="justify" border="r t" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%">[</text><text font="italic" fontsize="90%">Re-ranking order</text><text fontsize="90%">] </text><text color="#0000FF" fontsize="90%">Document5, Document3, Document2, Document1, Document4</text><text fontsize="90%">.
</text><text font="italic" fontsize="90%">[Explanation]</text><text fontsize="90%"> Document5 directly discusses the governmental systems used by most European nations, particularly the parliamentary system, which is relevant since the EU generally comprises nations with parliamentary democracies. This makes it the most relevant to the query about the type of government required for EU membership. Document3 talks about mixed constitutions…</text></p>
                </inline-block></td>
            </tr>
            <tr>
              <td align="center" border="r t"><text font="italic" fontsize="90%">Similarity Score</text></td>
              <td align="justify" border="r t" vattach="top"><inline-block vattach="top">
<!--  %****␣appendix.tex␣Line␣75␣**** -->                  <p width="170.7pt"><text fontsize="90%">[</text><text font="italic" fontsize="90%">Similarity scores from Document1 to Document5</text><text fontsize="90%">] </text><text color="#0000FF" fontsize="90%">Doc1:0.0, Doc2:0.1, Doc3:0.3, Doc4:0.1, Doc5:0.7</text><text fontsize="90%">.
</text><text font="italic" fontsize="90%">[Explanation]</text><text fontsize="90%"> Document1 talks about the EU and various other international organizations, focusing on aspects like the single market and policy integration but does not mention government types required for EU membership. Hence, the score is 0.0. Document2 discusses the structure of EU governance…</text></p>
                </inline-block></td>
            </tr>
            <tr>
              <td align="justify" border="l r t" rowspan="2" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%"><text font="bold">[Question]</text> when was the immigration reform and control act passed
<text font="bold">[Document1] </text> united states temporarily for money or a better life. an increase in legal immigrants migrating to the united states also led to an increase of illegal aliens…
<text font="bold">[Document2] </text> there are noted communists, socialists, and anti - american sympathizers. parts of the act remain in place today…
<text font="bold">[Document3] </text> …the immigration reform and control act ( irca ), also known as the simpson 2013 mazzoli act or the reagan amnesty, signed into law by ronald reagan on <text color="#FF0000">november 6</text>, 1986…
<text font="bold">[Document4] </text> five percent of the u. s. workforce. it was also estimated that about 70 percent of those illegal workers…
<text font="bold">[Document5] </text> to reduce them as restrictionists. "fry traced" restrictions roots " to a surprising surge in illegal and legal immigration…</text></p>
                </inline-block></td>
              <td align="center" border="r t"><text font="italic" fontsize="90%">Re-ranking</text></td>
              <td align="justify" border="r t" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%">[</text><text font="italic" fontsize="90%">Re-ranking order</text><text fontsize="90%">] </text><text color="#0000FF" fontsize="90%">Document3, Document1, Document4, Document5, Document2</text><text fontsize="90%">.
</text><text font="italic" fontsize="90%">[Explanation]</text><text fontsize="90%"> Document3 directly answers the query by explicitly mentioning the "Immigration Reform and Control Act of 1986" and stating it was signed into law by Ronald Reagan on November 6, 1986. It provides the most specific information related to the query…</text></p>
                </inline-block></td>
            </tr>
            <tr>
              <td align="center" border="r t"><text font="italic" fontsize="90%">Similarity Score</text></td>
              <td align="justify" border="r t" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%">[</text><text font="italic" fontsize="90%">Similarity scores from Document1 to Document5</text><text fontsize="90%">] </text><text color="#0000FF" fontsize="90%">Doc1:0.0, Doc2:0.0, Doc3:1.0, Doc4:0.0, Doc5:0.0</text><text fontsize="90%">.
</text><text font="italic" fontsize="90%">[Explanation]</text><text fontsize="90%"> Document1 discusses general immigration trends and issues but does not provide the specific date of the passage of the Immigration Reform and Control Act, which is directly asked in the query. Therefore, it receives a score of 0.0. Although Document2 mentions other immigration-related legislation and acts, it does not specify…</text></p>
                </inline-block></td>
            </tr>
            <tr>
              <td align="justify" border="b l r t" rowspan="2" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%"><text font="bold">[Question]</text> who sings in there’s something about mary
<text font="bold">[Document1] </text> melody. mary described the completed song as "whitney - fied". meron maintains that…
<text font="bold">[Document2] </text> …he film concludes with the two engaging in a kiss while singer / songwriter <text color="#FF0000">jonathan richman</text>, who has periodically narrated the story in song throughout the film…
<text font="bold">[Document3] </text> day but her. minutes later bing notices his tackle box has been disturbed, and an instant later the kids see the door to the tent is open…
<text font="bold">[Document4] </text> true opinions of other contestants and her stance on the judges. the book achieves in combining fifty years of a’salt of the earth’existence with a new - found life of fame…
<text font="bold"><!--  %****␣appendix.tex␣Line␣100␣**** -->[Document5] </text> and breezy number and the narrator opens up the story about bing and his family. and while bing is cleaning the fish, he tells the story of " goldilocks"…</text></p>
                </inline-block></td>
              <td align="center" border="r t"><text font="italic" fontsize="90%">Re-ranking</text></td>
              <td align="justify" border="r t" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%">[</text><text font="italic" fontsize="90%">Re-ranking order</text><text fontsize="90%">] </text><text color="#0000FF" fontsize="90%">Document2, Document5, Document4, Document1, Document3</text><text fontsize="90%">.
</text><text font="italic" fontsize="90%">[Explanation]</text><text fontsize="90%"> Document2 is the most relevant sentence as it directly answers the query. It mentions that Jonathan Richman narrated parts of the story through song throughout the film "There’s Something About Mary," which clearly identifies the singer related to your query…</text></p>
                </inline-block></td>
            </tr>
            <tr>
              <td align="center" border="b r t"><text font="italic" fontsize="90%">Similarity Score</text></td>
              <td align="justify" border="b r t" vattach="top"><inline-block vattach="top">
                  <p width="170.7pt"><text fontsize="90%">[</text><text font="italic" fontsize="90%">Similarity scores from Document1 to Document5</text><text fontsize="90%">] </text><text color="#0000FF" fontsize="90%">Doc1:0.0, Doc2:1.0, Doc3:0.0, Doc4:0.0, Doc5:0.0</text><text fontsize="90%">.
</text><text font="italic" fontsize="90%">[Explanation]</text><text fontsize="90%"> Document1 discusses a song in a completely different context, related to "Cinderella" and Whitney Houston’s music adjustments, not related to the film "There’s Something About Mary." Thus, it doesn’t answer the query about who sings in the specified film, receives a score of 0.0. Document2 directly answers the query. It mentions that Jonathan Richman narrated parts of the story…</text></p>
                </inline-block></td>
            </tr>
          </tbody>
        </tabular>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">3</text></tag><text fontsize="90%">Examples of two different LLM-generated responses. We also let LLM generate the corresponding explanations in these examples. The red color indicates the corresponding answer to the question.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">Table 3</tag>Examples of two different LLM-generated responses. We also let LLM generate the corresponding explanations in these examples. The red color indicates the corresponding answer to the question.</caption>
      </table>
<!--  %\section{Case␣Studies␣of␣Metric␣and␣LLM␣Distillation␣in␣RAG} -->    </subsection>
  </appendix>
</document>
