<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/04K3PMtMckp"?>
<?latexml class="article"?>
<?latexml package="xcolor" options="table,dvipsnames"?>
<?latexml package="url"?>
<?latexml package="tikz"?>
<?latexml package="comment"?>
<?latexml package="amsmath,amssymb,amsthm"?>
<?latexml package="color"?>
<?latexml package="epsfig"?>
<?latexml package="graphicx"?>
<?latexml package="wrapfig"?>
<?latexml package="xspace"?>
<?latexml package="bbold"?>
<?latexml package="nicefrac" options="nice"?>
<?latexml package="mathtools"?>
<?latexml package="booktabs"?>
<?latexml package="fontawesome"?>
<?latexml package="caption" options="font=footnotesize"?>
<?latexml package="subcaption"?>
<?latexml package="stfloats"?>
<?latexml package="pbox"?>
<?latexml package="multirow"?>
<?latexml package="microtype"?>
<?latexml package="hyperref" options="colorlinks=true, citecolor=citecolor, linkcolor=linkcolor, breaklinks=true"?>
<?latexml package="ICLRtemplate/iclr2023_conference,times"?>
<!--  %%%%% NEW MATH DEFINITIONS %%%%% --><?latexml package="amsmath,amsfonts,bm"?>
<!--  %Laplace distribution --><!--  %See usage in notation.tex. Chosen to match Daphne’s book. --><?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <para xml:id="p1">
    <ERROR class="undefined">\iclrfinalcopy</ERROR>
<!--  %Uncomment for camera-ready version, but NOT for submission. -->  </para>
  <title>The hidden uniform cluster prior in<break/>self-supervised learning</title>
  <creator role="author">
    <personname>Mahmoud Assran<sup><text font="italic">1,2,3</text></sup>, Randall Balestriero<sup><text font="italic">1</text></sup>, Quentin Duval<sup><text font="italic">1</text></sup>, Florian Bordes<sup><text font="italic">1,3,4</text></sup>, Ishan Misra<sup><text font="italic">1</text></sup><break/><text font="bold">Piotr Bojanowski<sup><text font="medium italic">1</text></sup>, Pascal Vincent<sup><text font="medium italic">1</text></sup>, Michael Rabbat<sup><text font="medium italic">1,3</text></sup>, Nicolas Ballas<sup><text font="medium italic">1</text></sup><break/><sup><text font="medium italic">1</text></sup>Meta AI (FAIR) <break/><sup><text font="medium italic">2</text></sup>McGill University, ECE <break/><sup><text font="medium italic">3</text></sup>Mila, Quebec AI Institute<break/><sup><text font="medium italic">4</text></sup>Universite de Montreal, DIRO
</text></personname>
    <contact role="thanks"><text font="typewriter">massran@meta.com</text></contact>
  </creator>
  <abstract name="Abstract">
    <p><!--  %A successful paradigm in representation learning is to perform self-supervised pretraining using tasks based on mini-batch statistics; (e.g., SimCLR, VICReg, SwAV, MSN). -->A successful paradigm in representation learning is to perform self-supervised pretraining using tasks based on mini-batch statistics (e.g., SimCLR, VICReg, SwAV, MSN).
We show that in the formulation of all these methods is an overlooked prior to learn features that enable uniform clustering of the data.
While this prior has led to remarkably semantic representations when pretraining on class-balanced data, such as ImageNet, we demonstrate that it can hamper performance when pretraining on class-imbalanced data.
By moving away from conventional uniformity priors and instead preferring power-law distributed feature clusters, we show that one can improve the quality of the learned representations on real-world class-imbalanced datasets.
To demonstrate this, we develop an extension of the Masked Siamese Networks (MSN) method to support the use of arbitrary features priors.
<!--  %We show that in the formulation of all these methods is an overlooked prior to learn features that enable uniform clustering of the data. 
     %**** main.tex Line 75 **** 
     %While this prior has led to remarkably semantic representations when pretraining on class-balanced data, such as ImageNet, we demonstrate that it can  hamper performance when pretraining on class-imbalanced data. 
     %By moving away from conventional uniformity priors and instead reformulating self-supervised criteria to prefer power-law distributed feature clusters, we show that one can improve the quality of the learned representations on real-world class-imbalanced datasets. 
     %, which occur in many applications. --></p>
<!--  %In particular, we extend the Masked Siamese Networks method (MSN) to support the use of arbitrary features prior such as power-law distribution. 
     %By moving away from conventional uniformity priors and instead reformulating self-supervised criteria to match the expected class prior of downstream tasks, we show that one can improve the quality of the learned representations on real-world class-imbalanced datasets. We coin this prior-aware criterion –“em Prior Matching Siamese Networks˝ (PMSN). -->  </abstract>
  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>Self-supervised pretraining has emerged as a highly effective strategy for unsupervised representation learning, with remarkable advances demonstrated by joint-embedding methods <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple,caron2021emerging,bardes2021vicreg,assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
In the context of visual data, these approaches typically learn representations by training a neural network encoder to produce similar embeddings for two or more views of the same image.
However, since outputting a constant vector regardless of the input would satisfy this objective, one of the main challenges with joint-embedding methods is to prevent such pathological solutions.
A common remedy is to employ a regularizer that maximizes the volume of space occupied by the representations.
This is sometimes referred to as the volume maximization principle.
In practice, the volume maximization principle is implemented in a variety of ways, for example, by contrasting negative samples <cite class="ltx_citemacro_citep">(<bibref bibrefs="bromley1993signature,he2019moco,chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, by removing correlations in the feature space <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg,zbontar2021barlow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, or by finding high entropy clusterings of the data <cite class="ltx_citemacro_citep">(<bibref bibrefs="asano2019self,caron2020unsupervised,assran2021semi,assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
When pretrained on the ImageNet dataset <cite class="ltx_citemacro_citep">(<bibref bibrefs="russakovsky2015imagenet" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, these methods have been shown to produce representations that encode highly semantic features <cite class="ltx_citemacro_citep">(<bibref bibrefs="caron2020unsupervised,caron2021emerging,assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="S1.p2">
      <p>However, the commonly used ImageNet-1K dataset is relatively class-balanced, which is in contrast to most real-world settings, where data is often <emph font="italic">class-imbalanced</emph> and semantic concepts follow a long-tailed power-law distribution <cite class="ltx_citemacro_citep">(<bibref bibrefs="newman2005power,mahajan2018exploring,van2018inaturalist" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Indeed, it has been shown that pretraining the same joint-embedding methods on long-tailed datasets can lead to significant drops in performance <cite class="ltx_citemacro_citep">(<bibref bibrefs="tian2021divide" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Such an observation is problematic in that it significantly hinders the applicability of modern research advances with joint-embedding methods to real-world settings.</p>
    </para>
    <para xml:id="S1.p3">
      <p><!--  %“textcolor–red˝–list the SSL methods for which we show the  uniform prior˝ -->In this work, we explore the use of joint-embedding methods for class-imbalanced datasets.
First, we theoretically show that current methods with volume maximization regularizers such as VICReg <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, SwAV <cite class="ltx_citemacro_citep">(<bibref bibrefs="caron2020unsupervised" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite><!--  %DINO~“citep–caron2021emerging˝, and (we don’t have DINO) -->, MSN <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and SimCLR <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> (with limited assumptions), have a uniform feature prior; i.e., a bias to learn features that enable grouping the data into clusters of roughly equal size.
Consequently, these joint-embedding methods will penalize features that do not uniformly cluster the data, even if such features correlate well with class information; see Figure <ref labelref="LABEL:fig:kmeans"/>.</p>
    </para>
<!--  %discalimer on theory w. projectino head -->    <para xml:id="S1.p4">
      <p><!--  %**** main.tex Line 125 **** -->Second, we empirically validate that joint-embedding methods employing volume maximization regularizers are sensitive to the mini-batch class distributions.
These approaches fail to learn class-discriminative features when the samples within a mini-batch do not follow a uniform class distribution.
This observation partially explains why performance degrades when pretraining with real-world data, where sampled mini-batches often contain highly imbalanced class distributions.

<!--  %Thus, in practice, these methods work well on ImageNet because of its uniform class prior. 
     %“setlength–“intextsep˝–0pt˝ --></p>
    </para>
    <figure float="right" inlist="lof" labels="LABEL:fig:kmeans" xml:id="S1.F1">
      <tags>
        <tag><text fontsize="90%">Figure 1</text></tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
<!--  %“begin–figure˝[t] -->      <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:visu_rcdm_balanced" xml:id="S1.F1.sf1">
        <tags>
          <tag><text fontsize="90%">(a)</text></tag>
          <tag role="autoref">1(a)</tag>
          <tag role="refnum">1(a)</tag>
        </tags>
        <graphics candidates="assets/kmeans_0.5.pdf" class="ltx_centering" graphic="assets/kmeans_0.5.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S1.F1.sf1.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">(a)</tag>K-means with class-balanced data</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(a)</text></tag><text fontsize="90%">K-means with class-balanced data</text></caption>
      </figure>
      <break class="ltx_centering"/>
      <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:visu_rcdm_unbalanced" xml:id="S1.F1.sf2">
        <tags>
          <tag><text fontsize="90%">(b)</text></tag>
          <tag role="autoref">1(b)</tag>
          <tag role="refnum">1(b)</tag>
        </tags>
        <graphics candidates="assets/kmeans_0.95.pdf" class="ltx_centering" graphic="assets/kmeans_0.95.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S1.F1.sf2.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">(b)</tag>K-means with class-imbalanced data</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(b)</text></tag><text fontsize="90%">K-means with class-imbalanced data</text></caption>
      </figure>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>Impact of uniform cluster prior in K-means when class distribution of data is imbalanced. K-means clustering depicted in color (green vs red). Ground-truth cluster separation depicted with a dotted black line. When uniform feature prior is not satisfied, K-means can identify undesirable features for discriminating between data points.</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 1</text></tag><text fontsize="90%">Impact of uniform cluster prior in K-means when class distribution of data is imbalanced. K-means clustering depicted in color (green vs red). Ground-truth cluster separation depicted with a dotted black line. When uniform feature prior is not satisfied, K-means can identify undesirable features for discriminating between data points.</text></caption>
    </figure>
    <para xml:id="S1.p5">
      <p>Finally, based on this observation, we propose to move away from conventional uniformity priors and instead reformulate self-supervised criteria to prefer long-tailed feature priors that are more aligned with the distribution of semantic concepts in real-world datasets.
In particular, we extend Masked Siamese Networks (MSN) of <cite class="ltx_citemacro_citet"><bibref bibrefs="assran2022masked" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> to support the use of arbitrary features priors, and refer to this extension as <text font="italic">Prior Matching for Siamese Networks (PMSN)</text><!--  %**** main.tex Line 150 **** -->.
When pretraining on the iNaturalist 2018 dataset <!--  %we use the Masked Siamese Network (MSN) framework of~“citet–assran2022masked˝ and replace the high entropy cluster prior with a power-law prior. --><cite class="ltx_citemacro_citep">(<bibref bibrefs="van2018inaturalist" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, which is naturally long-tailed, we demonstrate that moving away from uniform priors leads to more semantic representations and improved transfer on downstream tasks.</p>
    </para>
<!--  %Indeed, many real-world datasets are class-imbalanced and the semantic concepts we wish to capture actually follow long-tailed power-law distributions~“citep–newman2005power,mahajan2018exploring˝. -->  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Background</title>
    <para xml:id="S2.p1">
      <p>Given the recent success of joint-embedding methods, there is a growing literature that aims to build a better understanding of their behaviour.
Several works have sought to develop generalization bounds for joint-embedding methods with volume maximization penalties <cite class="ltx_citemacro_citep">(<bibref bibrefs="arora2019theoretical,balestriero2022contrastive" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Other works have sought to better understand the differences between various volume maximization penalties and connect them under limited assumptions <cite class="ltx_citemacro_citep">(<bibref bibrefs="garrido2022duality" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
In general, it has been shown that <Math mode="inline" tex="\ell_{2}" text="ell _ 2" xml:id="S2.p1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
            </XMApp>
          </XMath>
        </Math>-normalized contrastive losses can be decomposed into an “alignment” plus volume maximization component that scatters the representations uniformly on the unit hypersphere <cite class="ltx_citemacro_citep">(<bibref bibrefs="wang2020understanding" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Following this observation, other works <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2021intriguing" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> have sought to reformulate contrastive losses to scatter representations either (a) uniformly on the unit hypercube, or (b) onto Gaussian distributions (which have the highest entropy amongst all distributions with a given variance).
There is also theoretical work <cite class="ltx_citemacro_citep">(<bibref bibrefs="tian2021understanding" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> which aims to understand why certain joint-embedding methods, such as BYOL <cite class="ltx_citemacro_citep">(<bibref bibrefs="grill2020bootstrap" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, can avoid representation collapse without explicit use of a volume maximization penalty.</p>
    </para>
    <para xml:id="S2.p2">
      <p>While these works have helped build our understanding on the training dynamics of joint-embedding methods, they do not directly explain why empirical use of these methods with real-world class-imbalanced data has often led to a degradation in downstream task performance <cite class="ltx_citemacro_citep">(<bibref bibrefs="tian2021divide,goyal2022vision" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> (see Appendix <ref labelref="LABEL:apndx:relatedwork"/> for a broader discussion of related work).
In this work, we explore the use of joint-embedding methods with class-imbalanced data.
In particular, we theoretically show that a broad range of methods (beyond contrastive) prescribe a uniform <emph font="italic">feature</emph> prior, and that this prior is detrimental when pretraining with class-imbalanced data.</p>
    </para>
  </section>
  <section inlist="toc" labels="LABEL:sec:theory" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Uniform priors in modern self-supervised learning</title>
    <para xml:id="S3.p1">
      <p>In this section, we theoretically show that common SSL methods such a, VICReg <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, SwAV <cite class="ltx_citemacro_citep">(<bibref bibrefs="caron2020unsupervised" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, MSN <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, and (with limited assumptions) SimCLR <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, correspond to variants of K-means, and thereby impose a uniform cluster prior; i.e., a bias to learn features that enable uniform clustering of the data.
The governing assumption in K-means is the presence of isotropic data clusters, with roughly an equal number of samples per cluster <cite class="ltx_citemacro_citep">(<bibref bibrefs="wu2009adapting,liang2012k" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
When this assumption is not satisfied in practice, K-means may learn undesirable features for discriminating between samples (cf. Figure <ref labelref="LABEL:fig:kmeans"/>).</p>
    </para>
    <subsection inlist="toc" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Background: K-means formulations and the uniform prior</title>
      <paragraph inlist="toc" xml:id="S3.SS1.SSS0.Px1">
        <title>Explicit (Centroid) K-means.</title>
        <para xml:id="S3.SS1.SSS0.Px1.p1">
          <p>Recall that K-means proposes a centroid based clustering of the data.
In particular, given a set of <Math mode="inline" tex="N" text="N" xml:id="S3.SS1.SSS0.Px1.p1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMath>
            </Math> data points <Math mode="inline" tex="\{{\bm{x}}_{n}\}^{N}_{n=1}" text="((set@(x _ n)) ^ N) _ (n = 1)" xml:id="S3.SS1.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S3.SS1.SSS0.Px1.p1.m2.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m2.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, K-means partitions the elements into <Math mode="inline" tex="K" text="K" xml:id="S3.SS1.SSS0.Px1.p1.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> disjoint groups <Math mode="inline" tex="{\mathbb{X}}_{1},\dots,{\mathbb{X}}_{K}" text="list@(𝕏 _ 1, dots, 𝕏 _ K)" xml:id="S3.SS1.SSS0.Px1.p1.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m4.2"/>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m4.1"/>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m4.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m4.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok role="UNKNOWN">𝕏</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="dots" role="ID" xml:id="S3.SS1.SSS0.Px1.p1.m4.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m4.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok role="UNKNOWN">𝕏</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, such that <Math mode="inline" tex="\sum^{K}_{i=1}\lvert{\mathbb{X}}_{i}\rvert=N" text="((sum ^ K) _ (i = 1))@(absolute-value@(𝕏 _ i)) = N" xml:id="S3.SS1.SSS0.Px1.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="S3.SS1.SSS0.Px1.p1.m5.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="lvert" role="OPEN" stretchy="false">|</XMTok>
                        <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m5.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok role="UNKNOWN">𝕏</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok name="rvert" role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math>.
The K-means objective can be written as</p>
          <equation labels="LABEL:eq:kmeans" xml:id="S3.E1">
            <tags>
              <tag>(1)</tag>
              <tag role="autoref">Equation 1</tag>
              <tag role="refnum">1</tag>
            </tags>
            <Math mode="display" tex="\min_{\{{\mathbb{X}}_{k}\}_{k=1}^{K}}\sum_{k=1}^{K}\sum_{{\bm{x}}\in{\mathbb{X%&#10;}}_{k}}\|{\bm{x}}-\mu_{k}\|^{2}_{2}," text="minimum _ (((set@(𝕏 _ k)) _ (k = 1)) ^ K) * ((sum _ (k = 1)) ^ K)@((sum _ (x element-of 𝕏 _ k))@(((norm@(x - mu _ k)) ^ 2) _ 2))" xml:id="S3.E1.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S3.E1.m1.2"/>
                  <XMWrap>
                    <XMApp xml:id="S3.E1.m1.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="set"/>
                                <XMRef idref="S3.E1.m1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                <XMApp xml:id="S3.E1.m1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok fontsize="50%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="S3.E1.m1.2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok name="||" role="OPEN">‖</XMTok>
                                  <XMApp xml:id="S3.E1.m1.2.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok name="||" role="CLOSE">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>where the optimization problem is to identify the members of the disjoint sets <Math mode="inline" tex="{\mathbb{X}}_{1},\ldots,{\mathbb{X}}_{K}" text="list@(𝕏 _ 1, ldots, 𝕏 _ K)" xml:id="S3.SS1.SSS0.Px1.p1.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m6.2"/>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m6.1"/>
                    <XMRef idref="S3.SS1.SSS0.Px1.p1.m6.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m6.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok role="UNKNOWN">𝕏</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S3.SS1.SSS0.Px1.p1.m6.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.SSS0.Px1.p1.m6.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok role="UNKNOWN">𝕏</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, and <Math mode="inline" tex="\mu_{k}" text="mu _ k" xml:id="S3.SS1.SSS0.Px1.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMath>
            </Math> (the <Math mode="inline" tex="k^{\text{th}}" text="k ^ [th]" xml:id="S3.SS1.SSS0.Px1.p1.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMText><text fontsize="70%">th</text></XMText>
                </XMApp>
              </XMath>
            </Math> cluster centroid) is precisely the average of the members of <Math mode="inline" tex="{\mathbb{X}}_{k}" text="𝕏 _ k" xml:id="S3.SS1.SSS0.Px1.p1.m9">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok role="UNKNOWN">𝕏</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="S3.SS1.SSS0.Px2">
        <title>Implicit (Centroid) K-means.</title>
        <para xml:id="S3.SS1.SSS0.Px2.p1">
          <p>One important note that we will carry through our study is that K-means does not require explicit computation of the cluster centroids <Math mode="inline" tex="\mu_{k}" text="mu _ k" xml:id="S3.SS1.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMath>
            </Math> to evaluate the objective.
To see this standard result, one can relate the sum of pairwise distances to the sum of radial distances for any data partition,</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx1">
            <equation labels="LABEL:eq2" xml:id="S3.E2">
              <tags>
                <tag>(2)</tag>
                <tag role="autoref">Equation 2</tag>
                <tag role="refnum">2</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle\sum_{k=1}^{K}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}\lVert{\bm{x}}-%&#10;\mu_{k}\rVert^{2}_{2}=\sum_{k=1}^{K}\frac{1}{2\lvert{\mathbb{X}}_{k}\rvert}%&#10;\sum_{{\bm{x}},{\bm{x}}^{\prime}\in{\mathbb{X}}_{k}}\lVert{\bm{x}}-{\bm{x}}^{%&#10;\prime}\rVert^{2}_{2}." text="((sum _ (k = 1)) ^ K)@((sum _ (x element-of 𝕏 _ k))@(((delimited-∥∥@(x - mu _ k)) ^ 2) _ 2)) = ((sum _ (k = 1)) ^ K)@((1 / (2 * absolute-value@(𝕏 _ k))) * (sum _ (list@(x, x ^ prime) element-of 𝕏 _ k))@(((delimited-∥∥@(x - x ^ prime)) ^ 2) _ 2))" xml:id="S3.E2.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="S3.E2.m3.4"/>
                      <XMWrap>
                        <XMApp xml:id="S3.E2.m3.4">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="delimited-∥∥"/>
                                      <XMRef idref="S3.E2.m3.4.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                      <XMApp xml:id="S3.E2.m3.4.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="absolute-value"/>
                                      <XMRef idref="S3.E2.m3.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok name="lvert" role="OPEN" stretchy="false">|</XMTok>
                                      <XMApp xml:id="S3.E2.m3.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok role="UNKNOWN">𝕏</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMTok name="rvert" role="CLOSE" stretchy="false">|</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E2.m3.2"/>
                                        <XMRef idref="S3.E2.m3.3"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="bold italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m3.2">x</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E2.m3.3">
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-∥∥"/>
                                        <XMRef idref="S3.E2.m3.4.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                        <XMApp xml:id="S3.E2.m3.4.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\sum_{k=1}^{K}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}\lVert{\bm{x}}-%&#10;\mu_{k}\rVert^{2}_{2}" text="((sum _ (k = 1)) ^ K)@((sum _ (x element-of 𝕏 _ k))@(((delimited-∥∥@(x - mu _ k)) ^ 2) _ 2))" xml:id="S3.E2.m1">
                      <XMath>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-∥∥"/>
                                    <XMRef idref="S3.E2.m1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                    <XMApp xml:id="S3.E2.m1.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\sum_{k=1}^{K}\frac{1}{2\lvert{\mathbb{X}}_{k}\rvert}\sum_{{\bm{%&#10;x}},{\bm{x}}^{\prime}\in{\mathbb{X}}_{k}}\lVert{\bm{x}}-{\bm{x}}^{\prime}%&#10;\rVert^{2}_{2}." text="absent = ((sum _ (k = 1)) ^ K)@((1 / (2 * absolute-value@(𝕏 _ k))) * (sum _ (list@(x, x ^ prime) element-of 𝕏 _ k))@(((delimited-∥∥@(x - x ^ prime)) ^ 2) _ 2))" xml:id="S3.E2.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="S3.E2.m2.4"/>
                          <XMWrap>
                            <XMApp xml:id="S3.E2.m2.4">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="absolute-value"/>
                                          <XMRef idref="S3.E2.m2.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok name="lvert" role="OPEN" stretchy="false">|</XMTok>
                                          <XMApp xml:id="S3.E2.m2.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok role="UNKNOWN">𝕏</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok name="rvert" role="CLOSE" stretchy="false">|</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="S3.E2.m2.2"/>
                                            <XMRef idref="S3.E2.m2.3"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m2.2">x</XMTok>
                                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                            <XMApp xml:id="S3.E2.m2.3">
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="delimited-∥∥"/>
                                            <XMRef idref="S3.E2.m2.4.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                            <XMApp xml:id="S3.E2.m2.4.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>This result suggests that the K-means loss can be minimized by either learning cluster centroids (explicit K-means), or by learning cluster memberships (implicit K-means).
We make this relation precise in Proposition <ref labelref="LABEL:prop:kmeans"/>, which is proven in Appendix <ref labelref="LABEL:proof:kmeans1"/> and was already noted in <cite class="ltx_citemacro_citet"><bibref bibrefs="zha2001spectral,awasthi2015relax" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite>.</p>
        </para>
        <theorem class="ltx_theorem_proposition" inlist="thm theorem:proposition" labels="LABEL:prop:kmeans" xml:id="Thmproposition1">
          <tags>
            <tag>Proposition 1</tag>
            <tag role="autoref">1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">Proposition 1</tag>
          </tags>
          <title class="ltx_runin"><tag><text font="bold">Proposition 1</text></tag><text font="bold">.</text></title>
          <para xml:id="Thmproposition1.p1">
            <p><text font="italic"><!--  %**** main.tex Line 200 **** -->The explicit K-means problem, defined by learning a set of <Math mode="inline" tex="K" text="K" xml:id="Thmproposition1.p1.m1">
                  <XMath>
                    <XMTok role="UNKNOWN">K</XMTok>
                  </XMath>
                </Math> centroids <Math mode="inline" tex="\mu_{1},\dots,\mu_{K}" text="list@(mu _ 1, dots, mu _ K)" xml:id="Thmproposition1.p1.m2">
                  <XMath>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="Thmproposition1.p1.m2.2"/>
                        <XMRef idref="Thmproposition1.p1.m2.1"/>
                        <XMRef idref="Thmproposition1.p1.m2.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="Thmproposition1.p1.m2.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="upright" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok font="upright" role="PUNCT">,</XMTok>
                        <XMTok font="upright" name="dots" role="ID" xml:id="Thmproposition1.p1.m2.1">…</XMTok>
                        <XMTok font="upright" role="PUNCT">,</XMTok>
                        <XMApp xml:id="Thmproposition1.p1.m2.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>, admits the same global optimum as the implicit K-means problem, defined by learning a cluster membership matrix <Math mode="inline" tex="{\bm{P}}\in\{0,1\}^{N\times K}" text="P element-of (set@(0, 1)) ^ (N * K)" xml:id="Thmproposition1.p1.m3">
                  <XMath>
                    <XMApp>
                      <XMTok font="upright" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="bold" role="UNKNOWN">P</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="set"/>
                            <XMRef idref="Thmproposition1.p1.m3.1"/>
                            <XMRef idref="Thmproposition1.p1.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="upright" role="OPEN" stretchy="false">{</XMTok>
                            <XMTok font="upright" meaning="0" role="NUMBER" xml:id="Thmproposition1.p1.m3.1">0</XMTok>
                            <XMTok font="upright" role="PUNCT">,</XMTok>
                            <XMTok font="upright" meaning="1" role="NUMBER" xml:id="Thmproposition1.p1.m3.2">1</XMTok>
                            <XMTok font="upright" role="CLOSE" stretchy="false">}</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok font="upright" fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">N</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>, such that <Math mode="inline" tex="{\bm{P}}\mathbf{1}_{K}=\mathbf{1}_{N}" text="P * 1 _ K = 1 _ N" xml:id="Thmproposition1.p1.m4">
                  <XMath>
                    <XMApp>
                      <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="bold" role="UNKNOWN">P</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold upright" meaning="1" role="NUMBER">1</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold upright" meaning="1" role="NUMBER">1</XMTok>
                        <XMTok fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>.</text></p>
          </para>
        </theorem>
        <para xml:id="S3.SS1.SSS0.Px2.p2">
          <p>The fundamental assumptions governing the success of K-means lie in having clusters with roughly the same number of samples and intra-cluster data covariance that is isotropic with the form <Math mode="inline" tex="\sigma{\bm{I}}" text="sigma * I" xml:id="S3.SS1.SSS0.Px2.p2.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                </XMApp>
              </XMath>
            </Math>, where <Math mode="inline" tex="\sigma&gt;0" text="sigma &gt; 0" xml:id="S3.SS1.SSS0.Px2.p2.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="{\bm{I}}" text="I" xml:id="S3.SS1.SSS0.Px2.p2.m3">
              <XMath>
                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
              </XMath>
            </Math> is the identity matrix <cite class="ltx_citemacro_citep">(<bibref bibrefs="wu2009adapting,liang2012k" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite>.
In the sequel, we will show that various SSL methods can be seen as employing either explicit or implicit K-means.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:swav" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>How K-means naturally emerges from self-supervised losses</title>
      <para xml:id="S3.SS2.p1">
        <p>In this section, we demonstrate how standard SSL methods naturally employ K-means at their core.
Although this result might seem intuitive for methods that explicitly compute a clustering of the representations, we surprisingly found that this is also the case for some methods (e.g., VICReg) that do not explicitly involve centroid parameters or a clustering step.</p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p><text font="bold">Implicit K-means: VICReg and SimCLR.</text> 
The VICReg loss <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> consists of three terms, one measuring the <Math mode="inline" tex="\ell_{2}" text="ell _ 2" xml:id="S3.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> distance between the positive view pairs, one encouraging the off-diagonal entries of the embedding covariance matrix to go to <Math mode="inline" tex="0" text="0" xml:id="S3.SS2.p2.m2">
            <XMath>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMath>
          </Math>, and one encouraging its diagonal entries to be greater than <Math mode="inline" tex="1" text="1" xml:id="S3.SS2.p2.m3">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>.
One standard simplification done in practice to study VICReg is to switch the variance and covariance terms to a single term so that the new VICReg loss is given by</p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx2">
          <equation labels="LABEL:eq:VICR2" xml:id="S3.E3">
            <tags>
              <tag>(3)</tag>
              <tag role="autoref">Equation 3</tag>
              <tag role="refnum">3</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\mathcal{L}=\alpha\|\mathrm{Cov}({\bm{Z}})-{\bm{I}}\|_{F}^{2}+%&#10;\frac{\gamma}{N}\sum_{i,j=1}^{N}({\bm{G}})_{i,j}\|{\bm{z}}_{i}-{\bm{z}}_{j}\|_%&#10;{2}^{2}," text="L = alpha * ((norm@(Cov * Z - I)) _ F) ^ 2 + (gamma / N) * ((sum _ (list@(i, j) = 1)) ^ N)@(G _ (list@(i, j)) * ((norm@(z _ i - z _ j)) _ 2) ^ 2)" xml:id="S3.E3.m3">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E3.m3.7"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E3.m3.7">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="S3.E3.m3.7.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="||" role="OPEN">‖</XMTok>
                                    <XMApp xml:id="S3.E3.m3.7.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok role="UNKNOWN">Cov</XMTok>
                                        <XMDual>
                                          <XMRef idref="S3.E3.m3.5"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.E3.m3.5">Z</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                    </XMApp>
                                    <XMTok name="||" role="CLOSE">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E3.m3.1"/>
                                        <XMRef idref="S3.E3.m3.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m3.1">i</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m3.2">j</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMRef idref="S3.E3.m3.6"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.E3.m3.6">G</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="S3.E3.m3.3"/>
                                      <XMRef idref="S3.E3.m3.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m3.3">i</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m3.4">j</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="S3.E3.m3.7.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                        <XMApp xml:id="S3.E3.m3.7.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\mathcal{L}=" text="L = absent" xml:id="S3.E3.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle\alpha\|\mathrm{Cov}({\bm{Z}})-{\bm{I}}\|_{F}^{2}+\frac{\gamma}{N%&#10;}\sum_{i,j=1}^{N}({\bm{G}})_{i,j}\|{\bm{z}}_{i}-{\bm{z}}_{j}\|_{2}^{2}," text="alpha * ((norm@(Cov * Z - I)) _ F) ^ 2 + (gamma / N) * ((sum _ (list@(i, j) = 1)) ^ N)@(G _ (list@(i, j)) * ((norm@(z _ i - z _ j)) _ 2) ^ 2)" xml:id="S3.E3.m2">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E3.m2.7"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E3.m2.7">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="norm"/>
                                      <XMRef idref="S3.E3.m2.7.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok name="||" role="OPEN">‖</XMTok>
                                      <XMApp xml:id="S3.E3.m2.7.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok role="UNKNOWN">Cov</XMTok>
                                          <XMDual>
                                            <XMRef idref="S3.E3.m2.5"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.E3.m2.5">Z</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                      </XMApp>
                                      <XMTok name="||" role="CLOSE">‖</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="S3.E3.m2.1"/>
                                          <XMRef idref="S3.E3.m2.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m2.1">i</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m2.2">j</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMRef idref="S3.E3.m2.6"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.E3.m2.6">G</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="S3.E3.m2.3"/>
                                        <XMRef idref="S3.E3.m2.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m2.3">i</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E3.m2.4">j</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="norm"/>
                                          <XMRef idref="S3.E3.m2.7.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok name="||" role="OPEN">‖</XMTok>
                                          <XMApp xml:id="S3.E3.m2.7.2">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok name="||" role="CLOSE">‖</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\mathrm{Cov}({\bm{Z}})" text="Cov * Z" xml:id="S3.SS2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN">Cov</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.SS2.p2.m4.1">Z</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is the covariance matrix of the vectors <Math mode="inline" tex="{\bm{z}}_{1},\ldots,{\bm{z}}_{n}" text="list@(z _ 1, ldots, z _ n)" xml:id="S3.SS2.p2.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS2.p2.m5.2"/>
                  <XMRef idref="S3.SS2.p2.m5.1"/>
                  <XMRef idref="S3.SS2.p2.m5.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS2.p2.m5.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S3.SS2.p2.m5.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p2.m5.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, the constants <Math mode="inline" tex="\alpha,\gamma&gt;0" text="list@(alpha, gamma) &gt; 0" xml:id="S3.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.SS2.p2.m6.1"/>
                    <XMRef idref="S3.SS2.p2.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok font="italic" name="alpha" role="UNKNOWN" xml:id="S3.SS2.p2.m6.1">α</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" name="gamma" role="UNKNOWN" xml:id="S3.SS2.p2.m6.2">γ</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> are hyper-parameters, and <Math mode="inline" tex="G_{i,j}\in\{0,1\}" text="G _ (list@(i, j)) element-of set@(0, 1)" xml:id="S3.SS2.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">G</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S3.SS2.p2.m7.1"/>
                      <XMRef idref="S3.SS2.p2.m7.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p2.m7.1">i</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p2.m7.2">j</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS2.p2.m7.3"/>
                    <XMRef idref="S3.SS2.p2.m7.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m7.3">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS2.p2.m7.4">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is equal to 1 when the representations <Math mode="inline" tex="z_{i}" text="z _ i" xml:id="S3.SS2.p2.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="z_{j}" text="z _ j" xml:id="S3.SS2.p2.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">z</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> correspond to positive views of the same image.
From this formulation, we relate VICReg to the implicit K-means algorithm in Proposition <ref labelref="LABEL:prop:vicreg"/>, which is proven in Appendix <ref labelref="LABEL:proof:kmeans2"/><!--  %Reference to an equation, lower-case. -->.
In particular, note how the summation term on the right hand side of equation <ref labelref="LABEL:eq:VICR2"/><!--  %Reference to an equation, lower-case. --> recovers the right hand side of equation <ref labelref="LABEL:eq2"/>.</p>
      </para>
<!--  %Although not needed for the VICReg loss, the (implicit) centroids from VICReg can be obtained by averaging the embeddings of the augmented samples $“mu˙n=“mathbb–E˝˙–t “sim “mathcal–T˝˝[f˙–“theta˝(t(“vx˙n))]$, 
     %where $“mathcal–T˝$ is the random data-augmentation defining the positive samples, and $f˙–“theta˝$ is the DN mapping. In fact, VICReg employs as many centroids as there are –“em original˝ samples i.e. $K=N/T$ with $T$ the number of augmentation per sample. We now obtain our first result. -->      <theorem class="ltx_theorem_proposition" inlist="thm theorem:proposition" labels="LABEL:prop:vicreg" xml:id="Thmproposition2">
        <tags>
          <tag>Proposition 2</tag>
          <tag role="autoref">2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Proposition 2</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Proposition 2</text></tag><text font="bold">.</text></title>
        <para xml:id="Thmproposition2.p1">
          <p><text font="italic">VICReg with hyper-parameters <Math mode="inline" tex="\gamma\gg\alpha" text="gamma &gt;&gt; alpha" xml:id="Thmproposition2.p1.m1">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="much-greater-than" name="gg" role="RELOP">≫</XMTok>
                    <XMTok name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok name="alpha" role="UNKNOWN">α</XMTok>
                  </XMApp>
                </XMath>
              </Math><!--  %Reference to an equation, lower-case. --> recovers the K-means loss from equation <ref labelref="LABEL:eq:kmeans"/> on the embeddings, with an additional regularizer enforcing orthogonality of the centroids.</text></p>
        </para>
      </theorem>
      <para xml:id="S3.SS2.p3">
        <p>The hyper-parameter requirement <Math mode="inline" tex="\gamma\gg\alpha" text="gamma &gt;&gt; alpha" xml:id="S3.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="much-greater-than" name="gg" role="RELOP">≫</XMTok>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
              </XMApp>
            </XMath>
          </Math> is commonly employed with VICReg in practice to ensure invariance to the pre-defined set of data-augmentations used to construct the positive image views.
In fact, in the opposite case, where <Math mode="inline" tex="\alpha\gg\gamma" text="alpha &gt;&gt; gamma" xml:id="S3.SS2.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="much-greater-than" name="gg" role="RELOP">≫</XMTok>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              </XMApp>
            </XMath>
          </Math>, a degenerate whitening can be learned without keeping any information about the input samples due to the non-linearity of the deep neural network mapping, as shown in <cite class="ltx_citemacro_citet"><bibref bibrefs="balestriero2022contrastive" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
Note that under mild conditions, the VICReg loss has been shown to be equivalent to the SimCLR loss <cite class="ltx_citemacro_citep">(<bibref bibrefs="garrido2022duality" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
In such scenarios, Proposition <ref labelref="LABEL:prop:vicreg"/> would also directly apply to the SimCLR method.</p>
      </para>
      <para xml:id="S3.SS2.p4">
        <p><text font="bold">Explicit K-means with soft constraints: MSN.</text>
 
A common relaxation of constrained K-means is to remove the hard cluster assignment constraint, such that the condition <Math mode="inline" tex="{\bm{P}}_{i,j}\in\{0,1\}" text="P _ (list@(i, j)) element-of set@(0, 1)" xml:id="S3.SS2.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S3.SS2.p4.m1.1"/>
                      <XMRef idref="S3.SS2.p4.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p4.m1.1">i</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p4.m1.2">j</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS2.p4.m1.3"/>
                    <XMRef idref="S3.SS2.p4.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p4.m1.3">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS2.p4.m1.4">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is generalized to <Math mode="inline" tex="{\bm{P}}_{i,j}\in[0,1]" text="P _ (list@(i, j)) element-of closed-interval@(0, 1)" xml:id="S3.SS2.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S3.SS2.p4.m2.1"/>
                      <XMRef idref="S3.SS2.p4.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p4.m2.1">i</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p4.m2.2">j</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S3.SS2.p4.m2.3"/>
                    <XMRef idref="S3.SS2.p4.m2.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p4.m2.3">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS2.p4.m2.4">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="wang2010learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
This relaxes constrained K-means to the more general Gaussian Mixture Model (GMM) formulation, where each data point can partially belong to all clusters with some probability mass.
Since, the derivation of the GMM loss (i.e., the ELBO and log-likelihood) is beyond the scope of this section, we simply state the objective as</p>
        <equation labels="LABEL:eq:GMM" xml:id="S3.E4">
          <tags>
            <tag>(4)</tag>
            <tag role="autoref">Equation 4</tag>
            <tag role="refnum">4</tag>
          </tags>
          <Math class="ltx_math_unparsed" mode="display" tex="\min_{\{\mu_{k},\Sigma_{k}\}_{k=1}^{K}}\sum_{{\bm{x}}\in{\mathbb{X}}}\sum_{k=1%&#10;}^{K}\frac{[p({\bm{x}})]_{k}}{2}\lVert{\bm{x}}-\mu_{k}\rVert^{2}_{\Sigma^{-1}}%&#10;+N\sum_{k=1}^{K}\log\det(\Sigma_{k})+\sum_{{\bm{x}}\in{\mathbb{X}}}D_{\text{KL%&#10;}}(p({\bm{x}})\ \lVert\ {\bm{\pi}})," xml:id="S3.E4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S3.E4.m1.1"/>
                        <XMRef idref="S3.E4.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S3.E4.m1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E4.m1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok fontsize="70%" name="Sigma" role="UNKNOWN">Σ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="50%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
              </XMApp>
              <XMApp>
                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.E4.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S3.E4.m1.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMDual>
                          <XMRef idref="S3.E4.m1.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.E4.m1.3">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMWrap>
                    <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                    <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                  </XMWrap>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                  <XMTok fontsize="70%" name="Sigma" role="UNKNOWN">Σ</XMTok>
                  <XMApp>
                    <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
              <XMTok meaning="plus" role="ADDOP">+</XMTok>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
              </XMApp>
              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
              <XMTok meaning="determinant" role="LIMITOP" scriptpos="mid">det</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
              <XMTok meaning="plus" role="ADDOP">+</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMText><text fontsize="70%">KL</text></XMText>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.E4.m1.5">x</XMTok>
                  <XMTok role="CLOSE" rpadding="5.0pt" stretchy="false">)</XMTok>
                </XMWrap>
                <XMWrap>
                  <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                  <XMTok font="bold italic" lpadding="5.0pt" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="{\bm{\pi}}" text="pi" xml:id="S3.SS2.p4.m3">
            <XMath>
              <XMTok font="bold italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math> is the cluster prior and <Math mode="inline" tex="[p({\bm{x}})]_{k}" text="(delimited-[]@(p * x)) _ k" xml:id="S3.SS2.p4.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S3.SS2.p4.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m4.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMDual>
                        <XMRef idref="S3.SS2.p4.m4.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.SS2.p4.m4.1">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is the posterior probability of input <Math mode="inline" tex="{\bm{x}}" text="x" xml:id="S3.SS2.p4.m5">
            <XMath>
              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> belonging to cluster <Math mode="inline" tex="k" text="k" xml:id="S3.SS2.p4.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>, obtained from</p>
        <equation xml:id="S3.Ex1">
          <Math mode="display" tex="p({\bm{x}})=\text{softmax}\left({\bm{W}}^{T}{\bm{x}}+\log({\bm{\pi}})-\frac{1}%&#10;{2}\lVert{\bm{x}}\rVert_{2}^{2}-\frac{1}{2}\text{diag}({\bm{W}}^{T}{\bm{W}})%&#10;\right)," text="p * x = [softmax] * ((W ^ T * x + logarithm@(pi)) - (1 / 2) * ((delimited-∥∥@(x)) _ 2) ^ 2 - (1 / 2) * [diag] * W ^ T * W)" xml:id="S3.Ex1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.Ex1.m1.5"/>
                <XMWrap>
                  <XMApp xml:id="S3.Ex1.m1.5">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMDual>
                        <XMRef idref="S3.Ex1.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.Ex1.m1.1">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>softmax</XMText>
                      <XMDual>
                        <XMRef idref="S3.Ex1.m1.5.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S3.Ex1.m1.5.1">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                </XMApp>
                                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="S3.Ex1.m1.2"/>
                                  <XMRef idref="S3.Ex1.m1.3"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.Ex1.m1.2">log</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="bold italic" name="pi" role="UNKNOWN" xml:id="S3.Ex1.m1.3">π</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="delimited-∥∥"/>
                                      <XMRef idref="S3.Ex1.m1.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN" xml:id="S3.Ex1.m1.4">x</XMTok>
                                      <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMText>diag</XMText>
                              <XMDual>
                                <XMRef idref="S3.Ex1.m1.5.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.Ex1.m1.5.1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="{\bm{W}}=[\mu_{1},\dots,\mu_{K}]" text="W = list@(mu _ 1, dots, mu _ K)" xml:id="S3.SS2.p4.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.SS2.p4.m7.2"/>
                    <XMRef idref="S3.SS2.p4.m7.1"/>
                    <XMRef idref="S3.SS2.p4.m7.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m7.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="dots" role="ID" xml:id="S3.SS2.p4.m7.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m7.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> concatenates the centroids, and <Math mode="inline" tex="\text{diag}(\cdot)" text="[diag] * cdot" xml:id="S3.SS2.p4.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMText>diag</XMText>
                <XMDual>
                  <XMRef idref="S3.SS2.p4.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S3.SS2.p4.m8.1">⋅</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> extracts the diagonal of its matrix argument into a column vector.</p>
      </para>
      <para xml:id="S3.SS2.p5">
        <p>Of particular interest to us is the case in which the prior is set to the uniform distribution, <Math mode="inline" tex="[{\bm{\pi}}]_{k}=\nicefrac{{1}}{{K}}" text="(delimited-[]@(pi)) _ k = 1 / K" xml:id="S3.SS2.p5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.SS2.p5.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok font="bold italic" name="pi" role="UNKNOWN" xml:id="S3.SS2.p5.m1.1">π</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP" stretchy="true" width="-0.15em" xoffset="-0.1em">/</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER" rpadding="-0.5em" yoffset="0.3em">1</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for all <Math mode="inline" tex="k\in[K]" text="k element-of delimited-[]@(K)" xml:id="S3.SS2.p5.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S3.SS2.p5.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p5.m2.1">K</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, the covariance matrix is isotropic, <Math mode="inline" tex="\Sigma_{k}=\sigma{\bm{I}}" text="Sigma _ k = sigma * I" xml:id="S3.SS2.p5.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for <Math mode="inline" tex="\sigma\geq 0" text="sigma &gt;= 0" xml:id="S3.SS2.p5.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, and the centroids and data vectors are <Math mode="inline" tex="\ell_{2}" text="ell _ 2" xml:id="S3.SS2.p5.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %Reference to an equation, lower-case. -->-normalized, in which case equation <ref labelref="LABEL:eq:GMM"/> simplifies to</p>
        <equation labels="LABEL:eq:GMM_uni" xml:id="S3.E5">
          <tags>
            <tag>(5)</tag>
            <tag role="autoref">Equation 5</tag>
            <tag role="refnum">5</tag>
          </tags>
          <Math mode="display" tex="\min_{\mu_{1},\ldots,\mu_{K}}\sum_{{\bm{x}}\in{\mathbb{X}}}\sum_{k=1}^{K}\frac%&#10;{[\text{softmax}({\bm{W}}^{T}{\bm{x}})]_{k}}{2}\|{\bm{x}}-\mu_{k}\|^{2}_{2}-%&#10;\sum_{x\in{\mathbb{X}}}H\left(\text{softmax}({\bm{W}}^{T}{\bm{x}})\right)." text="minimum _ (list@(mu _ 1, ldots, mu _ K)) * (sum _ (x element-of 𝕏))@(((sum _ (k = 1)) ^ K)@(((delimited-[]@([softmax] * W ^ T * x)) _ k / 2) * ((norm@(x - mu _ k)) ^ 2) _ 2)) - (sum _ (x element-of 𝕏))@(H * [softmax] * W ^ T * x)" xml:id="S3.E5.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E5.m1.5"/>
                <XMWrap>
                  <XMApp xml:id="S3.E5.m1.5">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E5.m1.2"/>
                            <XMRef idref="S3.E5.m1.1"/>
                            <XMRef idref="S3.E5.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E5.m1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok fontsize="70%" name="ldots" role="ID" xml:id="S3.E5.m1.1">…</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="S3.E5.m1.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="S3.E5.m1.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="S3.E5.m1.4">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMText>softmax</XMText>
                                      <XMDual>
                                        <XMRef idref="S3.E5.m1.4.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S3.E5.m1.4.1">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                            </XMApp>
                                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="S3.E5.m1.5.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="||" role="OPEN">‖</XMTok>
                                    <XMApp xml:id="S3.E5.m1.5.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok name="||" role="CLOSE">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">H</XMTok>
                        <XMDual>
                          <XMRef idref="S3.E5.m1.5.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="S3.E5.m1.5.2">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>softmax</XMText>
                              <XMDual>
                                <XMRef idref="S3.E5.m1.5.2.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E5.m1.5.2.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p><!--  %Reference to an equation, lower-case. -->One can also express the simplified GMM objective in equation <ref labelref="LABEL:eq:GMM_uni"/> in terms of the marginal entropy (with a summation inside the entropy term) by following the ELBO derivations of <cite class="ltx_citemacro_citet"><bibref bibrefs="hoffman2016elbo" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite><!--  %Replacing the feature-space $“ell˙2$ distance in~“eqref–eq:GMM˙uni˝ with a cluster-assignment cross-entropy provides an alternative metric sometimes leveraged in the context of K-means~“citep–meilua2006uniqueness˝. -->.
The Masked Siamese Network (MSN) loss <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> with positive pairs <Math mode="inline" tex="{\bm{x}}_{n},{\bm{x}}_{n}^{+}" text="list@(x _ n, (x _ n) ^ +)" xml:id="S3.SS2.p5.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS2.p5.m6.1"/>
                  <XMRef idref="S3.SS2.p5.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS2.p5.m6.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p5.m6.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and posteriors <Math mode="inline" tex="{\bm{p}}_{n}=\text{softmax}({\bm{W}}^{T}{\bm{x}}_{n}/\sigma)" text="p _ n = [softmax] * ((W ^ T * x _ n) / sigma)" xml:id="S3.SS2.p5.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>softmax</XMText>
                  <XMDual>
                    <XMRef idref="S3.SS2.p5.m7.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS2.p5.m7.1">
                        <XMTok meaning="divide" role="MULOP">/</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="{\bm{p}}_{n}^{+}=\text{softmax}({\bm{W}}^{T}{\bm{x}}_{n}^{+}/\sigma)" text="(p _ n) ^ + = [softmax] * ((W ^ T * (x _ n) ^ +) / sigma)" xml:id="S3.SS2.p5.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>softmax</XMText>
                  <XMDual>
                    <XMRef idref="S3.SS2.p5.m8.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS2.p5.m8.1">
                        <XMTok meaning="divide" role="MULOP">/</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, with temperature <Math mode="inline" tex="\sigma" text="sigma" xml:id="S3.SS2.p5.m9">
            <XMath>
              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
            </XMath>
          </Math>, is</p>
        <equation labels="LABEL:eq:msn" xml:id="S3.E6">
<!--  %“frac–1˝–N˝ “sum^N˙–n=1˝ H(“vp˙–n˝^+, “vp˙n) + “lambda D˙–“text–KL˝˝(–“overline–“vp˝“ “lVert“ “vp˙“text–prior˝˝), -->          <tags>
            <tag>(6)</tag>
            <tag role="autoref">Equation 6</tag>
            <tag role="refnum">6</tag>
          </tags>
          <Math mode="display" tex="\frac{1}{N}\sum^{N}_{n=1}H({\bm{p}}_{n}^{+},{\bm{p}}_{n})-\lambda H({\overline%&#10;{{\bm{p}}}})," text="(1 / N) * ((sum ^ N) _ (n = 1))@(H * open-interval@((p _ n) ^ +, p _ n)) - lambda * H * overline@(p)" xml:id="S3.E6.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E6.m1.2"/>
                <XMWrap>
                  <XMApp xml:id="S3.E6.m1.2">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">H</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S3.E6.m1.2.1"/>
                              <XMRef idref="S3.E6.m1.2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.E6.m1.2.1">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.E6.m1.2.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                      <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E6.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E6.m1.1">
                            <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="\lambda&gt;0" text="lambda &gt; 0" xml:id="S3.SS2.p5.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, and <Math mode="inline" tex="\overline{{\bm{p}}}\coloneqq\frac{1}{N}\sum^{N}_{n=1}{\bm{p}}_{n}" text="overline@(p) coloneqq (1 / N) * ((sum ^ N) _ (n = 1))@(p _ n)" xml:id="S3.SS2.p5.m11">
            <XMath>
              <XMApp>
                <XMTok name="coloneqq" role="RELOP">≔</XMTok>
                <XMApp>
                  <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
We show that the MSN objective can be seen as variant of K-means variant employing an explicit cluster-membership penalty (cf. Appendix <ref labelref="LABEL:proof:kmeans3"/>).</p>
      </para>
      <theorem class="ltx_theorem_proposition" inlist="thm theorem:proposition" labels="LABEL:prop:msn" xml:id="Thmproposition3">
        <tags>
          <tag>Proposition 3</tag>
          <tag role="autoref">3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Proposition 3</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Proposition 3</text></tag><text font="bold">.</text></title>
        <para xml:id="Thmproposition3.p1">
          <p><text font="italic"><!--  %Reference to an equation, lower-case. -->MSN recovers the GMM loss from equation <ref labelref="LABEL:eq:GMM_uni"/> with the variation that the <Math mode="inline" tex="\ell_{2}" text="ell _ 2" xml:id="Thmproposition3.p1.m1">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="upright" name="ell" role="UNKNOWN">ℓ</XMTok>
                    <XMTok font="upright" fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMath>
              </Math> distance is replaced with the cross-entropy distance of the posterior.</text></p>
        </para>
      </theorem>
      <para xml:id="S3.SS2.p6">
        <p><text font="bold">Explicit K-means with hard constraints: SwAV</text> 
Among popular K-means variants, one particular version requires specification of the cardinality of the clusters <cite class="ltx_citemacro_citep">(<bibref bibrefs="kleindessner2019fair,bradley2000constrained,rujeerapaiboon2019size" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Specifically, the number of items in each cluster <Math mode="inline" tex="\lvert{\mathbb{X}}_{k}\rvert" text="absolute-value@(𝕏 _ k)" xml:id="S3.SS2.p6.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="absolute-value"/>
                  <XMRef idref="S3.SS2.p6.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok name="lvert" role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S3.SS2.p6.m1.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok role="UNKNOWN">𝕏</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMTok name="rvert" role="CLOSE" stretchy="false">|</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is strictly enforced to take a specific value <Math mode="inline" tex="N_{k}" text="N _ k" xml:id="S3.SS2.p6.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>.
The resulting K-means formulation becomes</p>
        <equation labels="LABEL:eq:constrained" xml:id="S3.E7">
          <tags>
            <tag>(7)</tag>
            <tag role="autoref">Equation 7</tag>
            <tag role="refnum">7</tag>
          </tags>
          <Math mode="display" tex="\min_{\{{\mathbb{X}}_{k}\}_{k=1}^{K}\text{s.t.}|{\mathbb{X}}_{k}|=N_{k}}\sum_{%&#10;k=1}^{K}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}\|{\bm{x}}-\mu_{k}\|^{2}_{2}." text="minimum _ (((set@(𝕏 _ k)) _ (k = 1)) ^ K * [s.t.] * absolute-value@(𝕏 _ k) = N _ k) * ((sum _ (k = 1)) ^ K)@((sum _ (x element-of 𝕏 _ k))@(((norm@(x - mu _ k)) ^ 2) _ 2))" xml:id="S3.E7.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E7.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S3.E7.m1.3">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
<!--  %**** main.tex Line 275 **** -->                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="set"/>
                                  <XMRef idref="S3.E7.m1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                  <XMApp xml:id="S3.E7.m1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok fontsize="50%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                          <XMText><text fontsize="70%">s.t.</text></XMText>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="absolute-value"/>
                              <XMRef idref="S3.E7.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">|</XMTok>
                              <XMApp xml:id="S3.E7.m1.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">|</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="S3.E7.m1.3.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok name="||" role="OPEN">‖</XMTok>
                                <XMApp xml:id="S3.E7.m1.3.1">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok name="||" role="CLOSE">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>When <Math mode="inline" tex="N_{k}=\frac{N}{K}" text="N _ k = N / K" xml:id="S3.SS2.p6.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we obtain strict enforcement of the uniform cluster prior, which is otherwise implicit in the formulation, but not strictly enforced.
This variant of K-means was previously used in <cite class="ltx_citemacro_citet"><bibref bibrefs="wang2010learning" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.
The SwAV <cite class="ltx_citemacro_citep">(<bibref bibrefs="caron2020unsupervised" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> loss with positive posterior pairs <Math mode="inline" tex="{\bm{p}}_{n},{\bm{p}}_{n}^{+}" text="list@(p _ n, (p _ n) ^ +)" xml:id="S3.SS2.p6.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS2.p6.m4.1"/>
                  <XMRef idref="S3.SS2.p6.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS2.p6.m4.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p6.m4.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math><!--  %Reference to an equation, lower-case. --> (defined similarly to those in equation <ref labelref="LABEL:eq:msn"/>) is</p>
        <equation labels="LABEL:eq:swav" xml:id="S3.E8">
          <tags>
            <tag>(8)</tag>
            <tag role="autoref">Equation 8</tag>
            <tag role="refnum">8</tag>
          </tags>
          <Math mode="display" tex="\frac{1}{N}\sum^{N}_{n=1}H({\bm{p}}_{n}^{+},{\bm{p}}_{n})\quad\text{subject to%&#10;}\quad{\bm{P}}\mathbf{1}_{N}=\frac{N}{K}\mathbf{1}_{K};\quad{\bm{P}}^{\top}%&#10;\mathbf{1}_{K}=\mathbf{1}_{N}," text="formulae@(list@((1 / N) * ((sum ^ N) _ (n = 1))@(H * open-interval@((p _ n) ^ +, p _ n)), [subject to], P * 1 _ N) = (N / K) * 1 _ K, P ^ top * 1 _ K = 1 _ N)" xml:id="S3.E8.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E8.m1.2"/>
                <XMWrap>
                  <XMDual xml:id="S3.E8.m1.2">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S3.E8.m1.2.1"/>
                      <XMRef idref="S3.E8.m1.2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S3.E8.m1.2.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E8.m1.2.1.1"/>
                            <XMRef idref="S3.E8.m1.1"/>
                            <XMRef idref="S3.E8.m1.2.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E8.m1.2.1.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E8.m1.2.1.1.1"/>
                                      <XMRef idref="S3.E8.m1.2.1.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E8.m1.2.1.1.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.E8.m1.2.1.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMHint name="quad" role="PUNCT" width="10pt"/>
                            <XMText xml:id="S3.E8.m1.1">subject to</XMText>
                            <XMHint name="quad" role="PUNCT" width="10pt"/>
                            <XMApp xml:id="S3.E8.m1.2.1.2">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            <XMTok font="italic" role="UNKNOWN">K</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="10.0pt">;</XMTok>
                      <XMApp xml:id="S3.E8.m1.2.2">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                            <XMTok fontsize="70%" meaning="top" role="ADDOP">⊤</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="{\bm{P}}=[{\bm{p}}^{+}_{1},\ldots,{\bm{p}}^{+}_{n}]" text="P = list@((p ^ +) _ 1, ldots, (p ^ +) _ n)" xml:id="S3.SS2.p6.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.SS2.p6.m5.2"/>
                    <XMRef idref="S3.SS2.p6.m5.1"/>
                    <XMRef idref="S3.SS2.p6.m5.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S3.SS2.p6.m5.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S3.SS2.p6.m5.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p6.m5.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> concatenates the predictions.
In <cite class="ltx_citemacro_citet"><bibref bibrefs="caron2020unsupervised" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, this constraint is enforced in practice by projecting the matrix <Math mode="inline" tex="{\bm{P}}" text="P" xml:id="S3.SS2.p6.m6">
            <XMath>
              <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
            </XMath>
          </Math> onto the constraint set in each iteration using the Sinkhorn-Knopp algorithm <cite class="ltx_citemacro_citep">(<bibref bibrefs="cuturi2013sinkhorn" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
SwAV thus recovers a strictly constrained variant of K-means (cf. Appendix <ref labelref="LABEL:proof:swav"/>).</p>
      </para>
      <theorem class="ltx_theorem_proposition" inlist="thm theorem:proposition" labels="LABEL:prop:swav" xml:id="Thmproposition4">
        <tags>
          <tag>Proposition 4</tag>
          <tag role="autoref">4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Proposition 4</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Proposition 4</text></tag><text font="bold">.</text></title>
        <para xml:id="Thmproposition4.p1">
          <p><text font="italic"><!--  %Reference to an equation, lower-case. -->SwAV recovers the constrained K-means loss from equation <ref labelref="LABEL:eq:GMM_uni"/> with constraint enforcement through Sinkhorn-Knopp normalization.</text></p>
        </para>
      </theorem>
      <para xml:id="S3.SS2.p7">
        <p>Note that for all presented SSL methods and their corresponding K-means variants, enforcing normalization of the centroids and features does not reduce the generality of the results; in this case, we simply obtain a correspondence to similar variants of spherical K-means <cite class="ltx_citemacro_citep">(<bibref bibrefs="hornik2012spherical" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:class_stratified" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Negative effect of uniform priors for class-imbalanced data</title>
    <para xml:id="S4.p1">
      <p>As proven in Section <ref labelref="LABEL:sec:theory"/><!--  %Whenever the data distribution fails in any of its assumptions, uniform cluster priors can lead to undesirable representations (cf.~Figure~“ref–fig:kmeans˝) and have been linked to issues such as bias in facial recognition models~“citep–buolamwini2018gender˝, and gender bias in word-level language models~“citep–bordia2019identifying˝. -->, joint-embedding methods employing volume maximization regularizers have an uniform feature prior.
Following this observation, in this section we empirically demonstrate that such methods are sensitive to non-uniform mini-batch class distributions.</p>
    </para>
<!--  %To solve this limitation, two strategies are available. One is to interact with this prior, either by moving away from K-means to GMM and imposing or learning the correct cluster prior, or by strictly enforcing a given prior through explicit constraints in K-means. The second solution is to leave the prior uniform but instead replace the distance used to compare pairs of samples as done for example in t-SNE~“citep–van2008visualizing˝ and k-medoids~“citep–park2009simple˝. We will explore in a later Sec.~“ref–sec:priors˝ how one can adopt the first strategy i.e. adapting the cluster prior, to better fit the data distribution. 
     %–“bf Known issues with uniform priors of K-means variants˝ 
     %~ 
     %Whenever the data distribution fails in any of its assumptions, K-means gets skewed toward producing an incorrect representation (see Figure~“ref–fig:kmeans˝) which negatively impacts performances causing, e.g., bias in facial recognition models “cite–buolamwini2018gender˝, gender bias in word-level language models “cite–bordia2019identifying˝. To solve this limitation, two strategies are available. One is to interact with this prior, either by moving away from K-means to GMM and imposing or learning the correct cluster prior, or by strictly enforcing a given prior through explicit constraints in K-means. The second solution is to leave the prior uniform but instead replace the distance used to compare pairs of samples as done for example in t-SNE “cite–van2008visualizing˝ and k-medoids “cite–park2009simple˝. After empirically validating that joint-embeddings methods also suffer from this uniform prior, we will explore in a later Sec.~“ref–sec:priors˝ how one can adopt the first strategy i.e. adapting the cluster prior, to better fit the data distribution. -->    <paragraph inlist="toc" xml:id="S4.SS0.SSS0.Px1">
      <title>Experimental setup.</title>
      <para xml:id="S4.SS0.SSS0.Px1.p1">
        <p>We explore three joint-embedding methods employing diverse collapse prevention strategies: SimCLR <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, VICReg <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, and MSN <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
We also compare the performance of those models to instance-based methods such as MAE <cite class="ltx_citemacro_citep">(<bibref bibrefs="he2021masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and data2vec <cite class="ltx_citemacro_citep">(<bibref bibrefs="baevski2022data2vec" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which do not employ volume maximization regularizers.
In this evaluation, all models are pretrained on the ImageNet-1K dataset without access to the class labels.
To explore sensitivity to mini-batch class distributions, we explore two dichotomous sampling strategies (which do require semantic knowledge of the image classes).</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px1.p2">
        <p>One strategy, termed <emph font="italic">class-balanced sampling</emph>, constructs the mini-batches in each iteration by first randomly selecting 960 classes out of the 1000 ImageNet-1K classes, and then sampling an equal number of images from each class.<note mark="1" role="footnote" xml:id="footnote1"><tags>
              <tag>1</tag>
              <tag role="autoref">footnote 1</tag>
              <tag role="refnum">1</tag>
              <tag role="typerefnum">footnote 1</tag>
            </tags>We choose 960 classes instead of 1000 so that the overall batch size is divisible by the number of GPUs utilized for distributed training.</note><!--  %**** main.tex Line 325 **** -->
Given that ImageNet is relatively class-balanced, this strategy produces mini-batches with similar statistics to traditional uniform sampling.
Another strategy, termed <emph font="italic">class-imbalanced sampling</emph>, constructs the mini-batches in each iteration by first randomly selecting <Math mode="inline" tex="K\ll 960" text="K &lt;&lt; 960" xml:id="S4.SS0.SSS0.Px1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="much-less-than" name="ll" role="RELOP">≪</XMTok>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMApp>
            </XMath>
          </Math> classes out of the 1000 ImageNet-1K classes, and then sampling an equal number of images from each class, such that the total mini-batch size is the same as under the class-balanced sampling strategy. We pick <Math mode="inline" tex="K" text="K" xml:id="S4.SS0.SSS0.Px1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> as the smallest value needed to reach the default batch size for each respective method: <Math mode="inline" tex="8" text="8" xml:id="S4.SS0.SSS0.Px1.p2.m3">
            <XMath>
              <XMTok meaning="8" role="NUMBER">8</XMTok>
            </XMath>
          </Math> for SimCLR (which has the a default batch size of <Math mode="inline" tex="4096" text="4096" xml:id="S4.SS0.SSS0.Px1.p2.m4">
            <XMath>
              <XMTok meaning="4096" role="NUMBER">4096</XMTok>
            </XMath>
          </Math>) and <Math mode="inline" tex="2" text="2" xml:id="S4.SS0.SSS0.Px1.p2.m5">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math> for VICReg and MSN (which have default batch sizes of <Math mode="inline" tex="1024" text="1024" xml:id="S4.SS0.SSS0.Px1.p2.m6">
            <XMath>
              <XMTok meaning="1024" role="NUMBER">1024</XMTok>
            </XMath>
          </Math>).
Note that the class-imbalanced strategy maintains the same marginal probability of sampling individual data points as compared to the class-balanced sampling strategy (see Appendix <ref labelref="LABEL:app:marginalprob"/> for a derivation of this equivalence).</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px1.p3">
        <p>After pretraining all models using the various sampling strategies, we evaluate performance on a wide range of downstream tasks requiring different levels of abstraction, i.e., classification with CIFAR100 <cite class="ltx_citemacro_citep">(<bibref bibrefs="krizhevsky2009learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, Places205 <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhou2014learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, and iNat18 <cite class="ltx_citemacro_citep">(<bibref bibrefs="van2018inaturalist" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>; object counting with Clevr/Count <cite class="ltx_citemacro_citep">(<bibref bibrefs="johnson2017clevr" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>; and depth prediction with Clevr/Dist <cite class="ltx_citemacro_citep">(<bibref bibrefs="johnson2017clevr" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and KITTI <cite class="ltx_citemacro_citep">(<bibref bibrefs="geiger2013vision" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
We also evaluate in-distribution performance of ImageNet classification <cite class="ltx_citemacro_citep">(<bibref bibrefs="russakovsky2015imagenet,chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Additional pretraining and evaluation details can be found in Appendix <ref labelref="LABEL:apndx:classstratified_sampling"/>; the full set of results can be found in Appendix <ref labelref="LABEL:apndx:classstratified_results"/>.</p>
      </para>
      <table inlist="lot" labels="LABEL:tb:class_stratified_sampling" placement="h" xml:id="S4.T1">
        <tags>
          <tag><text fontsize="90%">Table 1</text></tag>
          <tag role="autoref">Table 1</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Table 1</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">1</text></tag><text font="bold" fontsize="80%">Transfer:</text><text fontsize="80%"> Evaluation of the pretraining mini-batch sampling distribution on various downstream tasks. Each cell reports the task performance when pretraining with class-balanced sampling minus the task performance when pretraining with class-imbalanced sampling. Sampling imbalanced mini-batches during pretraining leads to a significant drop in image classification tasks for joint-embedding methods with volume maximization priors (SimCLR, MSN, VICReg), whereas instance-based methods, which do not employ such regularization (MAE, data2vec), are relatively unaffected.
</text></toccaption>
        <caption class="ltx_centering" fontsize="80%"><tag close=": "><text fontsize="113%">Table 1</text></tag><text font="bold" fontsize="113%">Transfer:<text font="medium"> Evaluation of the pretraining mini-batch sampling distribution on various downstream tasks. Each cell reports the task performance when pretraining with class-balanced sampling minus the task performance when pretraining with class-imbalanced sampling. Sampling imbalanced mini-batches during pretraining leads to a significant drop in image classification tasks for joint-embedding methods with volume maximization priors (SimCLR, MSN, VICReg), whereas instance-based methods, which do not employ such regularization (MAE, data2vec), are relatively unaffected.
</text></text></caption>
        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <thead>
            <tr>
              <td border="r tt" thead="column"/>
              <td align="center" border="tt" thead="column"><text fontsize="80%">ImageNet</text></td>
              <td align="center" border="tt" thead="column"><text fontsize="80%">iNat18</text></td>
              <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
              <td align="center" border="tt" thead="column"><text fontsize="80%">Places205</text></td>
              <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
              <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
              <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="right" border="r tt tt"><text fontsize="80%">SimCLR</text></td>
              <td align="center" border="tt tt"><text color="#FF0000" fontsize="80%">-11.2</text></td>
              <td align="center" border="tt tt"><text color="#FF0000" fontsize="80%">-8.0</text></td>
              <td align="center" border="tt tt"><text color="#FF0000" fontsize="80%">-10.2</text></td>
              <td align="center" border="tt tt"><text color="#FF0000" fontsize="80%">-5.2</text></td>
              <td align="center" border="r tt tt"><text color="#FF0000" fontsize="80%">-4.3</text></td>
              <td align="center" border="tt tt"><text fontsize="80%">+0.9</text></td>
              <td align="center" border="tt tt"><text fontsize="80%">+1.2</text></td>
            </tr>
            <tr>
              <td align="right" border="r"><text fontsize="80%">MSN</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-17.7</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-15.1</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-13.2</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-4.6</text></td>
              <td align="center" border="r"><text color="#FF0000" fontsize="80%">-6.4</text></td>
              <td align="center"><text fontsize="80%">+1.9</text></td>
              <td align="center"><text fontsize="80%">-1.6</text></td>
            </tr>
            <tr>
              <td align="right" border="r"><text fontsize="80%">VICReg</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-17.7</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-17.3</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-12.0</text></td>
              <td align="center"><text color="#FF0000" fontsize="80%">-6.0</text></td>
              <td align="center" border="r"><text color="#FF0000" fontsize="80%">-3.0</text></td>
              <td align="center"><text fontsize="80%">+0.7</text></td>
              <td align="center"><text fontsize="80%">-1.1</text></td>
            </tr>
            <tr>
              <td align="right" border="r t"><text fontsize="80%">data2vec</text></td>
              <td align="center" border="t"><text fontsize="80%">-0.8</text></td>
              <td align="center" border="t"><text fontsize="80%">+0.3</text></td>
              <td align="center" border="t"><text fontsize="80%">-1.6</text></td>
              <td align="center" border="t"><text fontsize="80%">+0.0</text></td>
              <td align="center" border="r t"><text fontsize="80%">-2.1</text></td>
              <td align="center" border="t"><text fontsize="80%">-1.5</text></td>
              <td align="center" border="t"><text fontsize="80%">-0.1</text></td>
            </tr>
            <tr>
              <td align="right" border="bb r"><text fontsize="80%">MAE</text></td>
              <td align="center" border="bb"><text fontsize="80%">-0.1</text></td>
              <td align="center" border="bb"><text fontsize="80%">+1.4</text></td>
              <td align="center" border="bb"><text fontsize="80%">+2.5</text></td>
              <td align="center" border="bb"><text fontsize="80%">+0.1</text></td>
              <td align="center" border="bb r"><text fontsize="80%">-0.8</text></td>
              <td align="center" border="bb"><text fontsize="80%">+0.0</text></td>
              <td align="center" border="bb"><text fontsize="80%">+0.0</text></td>
            </tr>
          </tbody>
        </tabular>
      </table>
<!--  %“begin–figure˝ 
     %“centering 
     %“includegraphics[width=“textwidth]–assets/balanced˙vs˙imbalanced.pdf˝ 
     %“caption–Visual representations of the results of Table “ref–tb:class˙stratified˙sampling˝. Methods relying on volume maximization regularizers all exhibit similar performance alteration across diverse transfer tasks.˝ 
     %“label–fig:visu˙rcdm˙unbalanced˝ 
     %“end–figure˝ -->    </paragraph>
    <paragraph inlist="toc" xml:id="S4.SS0.SSS0.Px2">
      <title>Empirical observations.</title>
      <para xml:id="S4.SS0.SSS0.Px2.p1">
        <p>As can be seen in Table <ref labelref="LABEL:tb:class_stratified_sampling"/>, the performance of joint-embedding methods employing volume maximization regularizers degrades significantly on all the semantic downstream tasks (IN1K, CIFAR100, Places205, Clevr/Count) when the mini-batches sampled during pretraining are not class-balanced (e.g., drops by as much as 17.7 top-1 on IN1K), but remain relatively stable (and even marginally improve) on low-level depth prediction tasks Clevr/Dist and KITTI, suggesting that class-imbalanced pretraining leads the model to capture lower-level (less semantic) features.</p>
      </para>
      <para xml:id="S4.SS0.SSS0.Px2.p2">
        <p>By contrast, evaluations with instanced-based methods data2vec and MAE in Table <ref labelref="LABEL:tb:class_stratified_sampling"/> show different trends.
The MAE method employs a simple pixel-reconstruction loss for representation learning, and thus does not explicitly compute mini-batch statistics during pretraining.
The data2vec method is more similar to MSN, SimCLR, and VICReg in that it utilizes a joint-embedding architecture; however, in contrast to those methods, data2vec does not explicitly compute mini-batch statistics during pretraining, and instead relies on architectural heuristics and careful hyperparameter choices to prevent collapse.
When evaluating these methods with class-balanced pretraining versus class-imbalanced pretraining, we observe virtually no change in downstream task performance.
Only methods with explicit volume maximization terms exhibit sensitivity to the mini-batch class distribution.</p>
      </para>
    </paragraph>
    <paragraph inlist="toc" xml:id="S4.SS0.SSS0.Px3">
      <title>Visualizing learned prototype vectors.</title>
      <para xml:id="S4.SS0.SSS0.Px3.p1">
        <p>In Figure <ref labelref="LABEL:fig:visu_rcdm_sampling"/>, we use RCDM <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> to visualize the prototypes learned by an MSN model pretrained on IN1K with either class-balanced or class-imbalanced mini-batch distributions.
A prototype here refers to a row in the weight matrix of the final linear layer in the encoder.
Each row in Figure <ref labelref="LABEL:fig:visu_rcdm_sampling"/> corresponds to samples generated by conditioning on a <emph font="italic">single prototype</emph> using various random seeds.
Characteristics that remain constant across a row in Figure <ref labelref="LABEL:fig:visu_rcdm_sampling"/> reflect information contained in the prototype, whereas characteristics that vary reflect information that is not contained (i.e., to which the representations are invariant).
When pretraining with class-balanced mini-batches, the emergent features tend to be associated with high-level concepts, such as specific ImageNet classes (Figure <ref labelref="LABEL:fig:visu_rcdm_balanced"/>).
In contrast, when pretraining with class-imbalanced mini-batches, the learned features tend to be associated with low-level concepts, such as shape, pose, or texture (Figure <ref labelref="LABEL:fig:visu_rcdm_unbalanced"/>).</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:visu_rcdm_sampling" placement="h" xml:id="S4.F2">
        <tags>
          <tag><text fontsize="90%">Figure 2</text></tag>
          <tag role="autoref">Figure 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Figure 2</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:visu_rcdm_balanced" xml:id="S4.F2.sf1">
          <tags>
            <tag><text fontsize="90%">(a)</text></tag>
            <tag role="autoref">2(a)</tag>
            <tag role="refnum">2(a)</tag>
          </tags>
          <graphics candidates="assets/MSN_fig_balanced.pdf" class="ltx_centering" graphic="assets/MSN_fig_balanced.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf1.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">(a)</tag>Pretraining with class-balanced mini-batch sampling</toccaption>
          <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(a)</text></tag><text fontsize="90%">Pretraining with class-balanced mini-batch sampling</text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:visu_rcdm_unbalanced" xml:id="S4.F2.sf2">
          <tags>
            <tag><text fontsize="90%">(b)</text></tag>
            <tag role="autoref">2(b)</tag>
            <tag role="refnum">2(b)</tag>
          </tags>
          <graphics candidates="assets/MSN_fig_unbalanced.pdf" class="ltx_centering" graphic="assets/MSN_fig_unbalanced.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf2.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">(b)</tag>Pretraining with class-imbalanced mini-batch sampling</toccaption>
          <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(b)</text></tag><text fontsize="90%">Pretraining with class-imbalanced mini-batch sampling</text></caption>
        </figure>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>
Visualization of prototypes learned by an MSN model pretrained on ImageNet-1K with either class-balanced or class-imbalanced mini-batch distributions.
We use RCDM <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> to enable visualization of the prototypes (details in Appendix <ref labelref="LABEL:apndx:rcdm"/>).
Each row corresponds to samples generated by conditioning on a prototype with various random seeds.
Features that remain constant across the row depict information contained in the prototypes, whereas features that vary depict information that is not contained.
a) When pretraining with class-balanced mini-batches, the emergent features tend to be associated with high level concepts, such as specific ImageNet classes.
b) By contrast, when pretraining with class-imbalanced mini-batches, the learned features tend to be associated with low-level concepts, such as shape, pose, or texture.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 2</text></tag><text fontsize="90%">
Visualization of prototypes learned by an MSN model pretrained on ImageNet-1K with either class-balanced or class-imbalanced mini-batch distributions.
We use RCDM <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> to enable visualization of the prototypes (details in Appendix <ref labelref="LABEL:apndx:rcdm"/>).
Each row corresponds to samples generated by conditioning on a prototype with various random seeds.
Features that remain constant across the row depict information contained in the prototypes, whereas features that vary depict information that is not contained.
a) When pretraining with class-balanced mini-batches, the emergent features tend to be associated with high level concepts, such as specific ImageNet classes.
b) By contrast, when pretraining with class-imbalanced mini-batches, the learned features tend to be associated with low-level concepts, such as shape, pose, or texture.</text></caption>
      </figure>
    </paragraph>
  </section>
  <section inlist="toc" labels="LABEL:sec:priors" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Prior Matching for Siamese Networks</title>
    <para xml:id="S5.p1">
      <p>Section <ref labelref="LABEL:sec:class_stratified"/> validates that in settings where the samples within a mini-batch do not follow a uniform class distribution, joint-embedding methods with volume maximization penalties encode less class-oriented features, and perform worse on downstream semantic classification tasks.
In this section, we demonstrate that using alternative (long-tailed) feature priors can lead to representations of a higher semantic level when pretraining on real-world class-imbalanced data.</p>
    </para>
    <paragraph inlist="toc" xml:id="S5.SS0.SSS0.Px1">
      <title>Siamese Networks with Arbitrary Prior.</title>
      <para xml:id="S5.SS0.SSS0.Px1.p1">
        <p>In <cite class="ltx_citemacro_citet"><bibref bibrefs="assran2022masked" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, the MSN prior is explicitly set to the uniform distribution.
As discussed in [Section <ref labelref="LABEL:sec:theory"/><!--  %Reference to an equation, lower-case. -->, equation <ref labelref="LABEL:eq:GMM"/>], the KL penalty in MSN explicitly encourages learning representations that enable uniform clustering of the data.
However, when pretraining with class-imbalanced data, the semantic concepts of interest no longer satisfy the assumptions of the uniformity prior.
In particular, natural observations “in the wild” tend to follow long-tailed (often power-law) distributions <cite class="ltx_citemacro_citep">(<bibref bibrefs="newman2005power,mahajan2018exploring,van2018inaturalist" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite><!--  %Based on this observation, we explore the effect of swapping the uniform feature prior in MSN with an alternative long-tailed feature prior. -->.
Based on this observation, we introduce Prior Matching for Siamese Networks (PMSN), which extends MSN to support the use of arbitrary feature priors.
Specifically, we modify MSN by replacing the negative entropy term in equation <!--  %Reference to an equation, lower-case. --><ref labelref="LABEL:eq:msn"/> with the KL-divergence to a user-specified distribution.<note mark="2" role="footnote" xml:id="footnote2"><tags>
              <tag>2</tag>
              <tag role="autoref">footnote 2</tag>
              <tag role="refnum">2</tag>
              <tag role="typerefnum">footnote 2</tag>
            </tags><!--  %Reference to an equation, lower-case. -->The negative entropy in equation <ref labelref="LABEL:eq:msn"/> is simply the KL-divergence to the uniform distribution plus a constant.</note>
For instance, we can instantiate PMSN as</p>
        <equation labels="LABEL:eq:msn_prior" xml:id="S5.E9">
          <tags>
            <tag>(9)</tag>
            <tag role="autoref">Equation 9</tag>
            <tag role="refnum">9</tag>
          </tags>
          <Math class="ltx_math_unparsed" mode="display" tex="\frac{1}{N}\sum^{N}_{i=1}H({\bm{p}}_{i}^{+},{\bm{p}}_{i})+\lambda D_{\text{KL}%&#10;}(\overline{{\bm{p}}}\ \lVert\ {\bm{p}}_{\text{\sc pl}(\tau)})," xml:id="S5.E9.m1">
            <XMath>
              <XMApp>
                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
              <XMTok font="italic" role="UNKNOWN">H</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
              <XMTok meaning="plus" role="ADDOP">+</XMTok>
              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMText><text fontsize="70%">KL</text></XMText>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp rpadding="5.0pt">
                  <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMWrap>
                  <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" lpadding="5.0pt" role="UNKNOWN">p</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text font="smallcaps" fontsize="70%">pl</text></XMText>
                      <XMDual>
                        <XMRef idref="S5.E9.m1.1"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN" xml:id="S5.E9.m1.1">τ</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="{\bm{p}}_{\text{PL}(\tau)}" text="p _ ([PL] * tau)" xml:id="S5.SS0.SSS0.Px1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText><text fontsize="70%">PL</text></XMText>
                  <XMDual>
                    <XMRef idref="S5.SS0.SSS0.Px1.p1.m1.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN" xml:id="S5.SS0.SSS0.Px1.p1.m1.1">τ</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a power-law distribution with exponent <Math mode="inline" tex="\tau&gt;0" text="tau &gt; 0" xml:id="S5.SS0.SSS0.Px1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </paragraph>
    <subsection inlist="toc" xml:id="S5.SS1">
      <tags>
        <tag>5.1</tag>
        <tag role="autoref">subsection 5.1</tag>
        <tag role="refnum">5.1</tag>
        <tag role="typerefnum">§5.1</tag>
      </tags>
      <title><tag close=" ">5.1</tag>Toy setting</title>
      <para xml:id="S5.SS1.p1">
        <p><!--  %**** main.tex Line 425 **** -->We claim that the uniform prior in joint-embedding methods significantly impacts the features captured in their learned representations.
To illustrate this point to the research community using well-known data, we construct a toy setting to study how changes in the prior affect the suppression and selection of features by the encoder.
We take grayscaled CIFAR10 <cite class="ltx_citemacro_citep">(<bibref bibrefs="krizhevsky2009learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> images and overlay one of ten MNIST digits <cite class="ltx_citemacro_citep">(<bibref bibrefs="lecun-mnisthandwrittendigit-2010" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> in the top left corner, such that the overall distribution of MNIST digits in the dataset follows a power-law distribution with exponent <Math mode="inline" tex="0.5" text="0.5" xml:id="S5.SS1.p1.m1">
            <XMath>
              <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
            </XMath>
          </Math>.<note mark="3" role="footnote" xml:id="footnote3"><tags>
              <tag>3</tag>
              <tag role="autoref">footnote 3</tag>
              <tag role="refnum">3</tag>
              <tag role="typerefnum">footnote 3</tag>
            </tags>Note the image distribution is still uniform over the CIFAR10 classes.</note>
Next we perform self-supervised pretraining on this dataset using PMSN.
We compare pretraining using a uniform feature prior, to pretraining using a power-law prior with exponent equal to <Math mode="inline" tex="0.5" text="0.5" xml:id="S5.SS1.p1.m2">
            <XMath>
              <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
            </XMath>
          </Math>, which corresponds to the true power-law distribution of MNIST digits in the toy dataset.</p>
      </para>
      <para xml:id="S5.SS1.p2">
        <p>The first column in Figure <ref labelref="LABEL:fig:cifar10-nn"/> shows reference images from this toy dataset; the images in subsequent column visualize the corresponding nearest neighbours in the embedding space of the pretrained models.
When pretraining using a power-law prior, the MNIST digit is encoded by the model, and the nearest neighbours all have the same digit class (Figure <ref labelref="LABEL:fig:cifar10-nn-powerlaw"/>).
However, when pretraining with a uniform prior, MNIST digit information is discarded by the model, and therefore the nearest neighbours have different digit classes (Figure <ref labelref="LABEL:fig:cifar10-nn-uniform"/><!--  %By contrast, the CIFAR10 class ‘‘feature’’ does admit a uniform clustering of the data, and so the nearest neighbours obtained with the uniform prior tend to have the same object class. -->).
In particular, since the MNIST digit “feature” does not admit a uniform clustering of the data, it is discarded when pretraining with the conventional volume maximization penalty.
This toy experiment provides insight into how semantic features in class-imbalanced datasets can be suppressed by the encoder and how alternative (non-uniform) priors can be used to recover such features.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:cifar10-nn" placement="t" xml:id="S5.F3">
        <tags>
          <tag><text fontsize="90%">Figure 3</text></tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" inlist="lof" xml:id="S5.F3.sf1">
          <tags>
            <tag><text fontsize="90%">(a)</text></tag>
            <tag role="autoref">3(a)</tag>
            <tag role="refnum">3(a)</tag>
          </tags>
          <graphics candidates="assets/cifar10-ref.pdf" graphic="assets/cifar10-ref.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.sf1.g1"/>
          <toccaption><tag close=" ">(a)</tag>Ref.<break/> </toccaption>
          <caption><tag close=" "><text fontsize="90%">(a)</text></tag><text fontsize="90%">Ref.<break/> </text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:cifar10-nn-powerlaw" xml:id="S5.F3.sf2">
          <tags>
            <tag><text fontsize="90%">(b)</text></tag>
            <tag role="autoref">3(b)</tag>
            <tag role="refnum">3(b)</tag>
          </tags>
          <graphics candidates="assets/cifar10-powerlaw.pdf" class="ltx_centering" graphic="assets/cifar10-powerlaw.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.sf2.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">(b)</tag>Nearest Neighbours when pretraining with power-law prior<break/><text font="bold">(Matching MNIST digit distribution)</text></toccaption>
          <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(b)</text></tag><text fontsize="90%">Nearest Neighbours when pretraining with power-law prior<break/><text font="bold">(Matching MNIST digit distribution)</text></text></caption>
        </figure>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:cifar10-nn-uniform" xml:id="S5.F3.sf3">
          <tags>
            <tag><text fontsize="90%">(c)</text></tag>
            <tag role="autoref">3(c)</tag>
            <tag role="refnum">3(c)</tag>
          </tags>
<!--  %**** main.tex Line 450 **** -->          <graphics candidates="assets/cifar10-uniform.pdf" class="ltx_centering" graphic="assets/cifar10-uniform.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.sf3.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">(c)</tag>Nearest Neighbours when pretraining with uniform prior<break/><text font="bold">(Not matching MNIST digit distribution)</text></toccaption>
          <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(c)</text></tag><text fontsize="90%">Nearest Neighbours when pretraining with uniform prior<break/><text font="bold">(Not matching MNIST digit distribution)</text></text></caption>
        </figure>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>Each row visualizes the nearest neighbours of the references images (first column), in the embedding space of an PMSN model
pretrained on grayscaled images with an MNIST digit in the top left corner.
The distribution of MNIST digits in the dataset is constructed to follow a long-tailed power-law distribution.
b) When pretraining using a power-law prior, the MNIST digit is encoded by the model, and the nearest neighbours all have the same digit class.
c) When pretraining with a uniform prior, the MNIST digit information is discarded by the model, and therefore the nearest neighbours have different digit classes.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 3</text></tag><text fontsize="90%">Each row visualizes the nearest neighbours of the references images (first column), in the embedding space of an PMSN model
pretrained on grayscaled images with an MNIST digit in the top left corner.
The distribution of MNIST digits in the dataset is constructed to follow a long-tailed power-law distribution.
b) When pretraining using a power-law prior, the MNIST digit is encoded by the model, and the nearest neighbours all have the same digit class.
c) When pretraining with a uniform prior, the MNIST digit information is discarded by the model, and therefore the nearest neighbours have different digit classes.</text></caption>
      </figure>
    </subsection>
    <subsection inlist="toc" xml:id="S5.SS2">
      <tags>
        <tag>5.2</tag>
        <tag role="autoref">subsection 5.2</tag>
        <tag role="refnum">5.2</tag>
        <tag role="typerefnum">§5.2</tag>
      </tags>
      <title><tag close=" ">5.2</tag>Natural class-imbalanced setting</title>
      <para xml:id="S5.SS2.p1">
        <p>In this section, we examine the downstream task performance obtained by pretraining PMSN in more realistic settings.
We examine pretraining with both the IN1K, which is relatively class-balanced, and with the iNaturalist18 dataset <cite class="ltx_citemacro_citep">(<bibref bibrefs="van2018inaturalist" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite><!--  %; see Figure~“ref–fig:˝. -->, which is relatively class-imbalanced.
The iNat18 dataset contains approximately 430K images from over 8142 different species of plants and animals; since some species are more abundant and easier to photograph than others, the class distribution of images in this dataset naturally follows a long-tailed distribution. After pretraining with either iNat18 or IN1k, we examine downstream task performance on the same set of tasks used in Section <!--  %In contrast, the ImageNet-1K (IN1k) dataset is relatively balanced and contains approximately 1M curated images from 1000 different categories. %~“citep–todo˝; see Figure~“ref–fig:˝ for a depiction of the IN-1K class distribution. --><ref labelref="LABEL:sec:class_stratified"/>.
Additional details about the experimental setup can be found in Appendix <ref labelref="LABEL:apndx:priors"/>.</p>
      </para>
      <paragraph inlist="toc" xml:id="S5.SS2.SSS0.Px1">
        <title>Results with true class distribution.</title>
        <para xml:id="S5.SS2.SSS0.Px1.p1">
          <p><!--  %**** main.tex Line 475 **** -->Table <ref labelref="LABEL:tb:inat_class_prior"/> compares iNat18 pretraining with PMSN using a uniform distribution or the <emph font="italic">true</emph> class distribution of iNat18.
In particular, if we have <Math mode="inline" tex="D" text="D" xml:id="S5.SS2.SSS0.Px1.p1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math> images in the dataset and <Math mode="inline" tex="D_{k}" text="D _ k" xml:id="S5.SS2.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMath>
            </Math> images in the <Math mode="inline" tex="k^{\text{th}}" text="k ^ [th]" xml:id="S5.SS2.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMText><text fontsize="70%">th</text></XMText>
                </XMApp>
              </XMath>
            </Math> class category, then we define the class-prior, <Math mode="inline" tex="{\bm{p}}_{\text{class}}" text="p _ [class]" xml:id="S5.SS2.SSS0.Px1.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                  <XMText><text fontsize="70%">class</text></XMText>
                </XMApp>
              </XMath>
            </Math>, such that <Math mode="inline" tex="[{\bm{p}}_{\text{class}}]_{k}=\nicefrac{{D_{k}}}{{D}}" text="(delimited-[]@(p _ [class])) _ k = D _ k / D" xml:id="S5.SS2.SSS0.Px1.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="S5.SS2.SSS0.Px1.p1.m5.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp xml:id="S5.SS2.SSS0.Px1.p1.m5.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                          <XMText><text fontsize="70%">class</text></XMText>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP" stretchy="true" width="-0.15em" xoffset="-0.1em">/</XMTok>
                    <XMApp rpadding="-0.5em" yoffset="0.3em">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.
Of course this information is not usually assumed to be known in self-supervised pretraining; we consider it here to illustrate the effect of the uniform prior on representation learning.
As shown in Table <ref labelref="LABEL:tb:inat_class_prior"/>, simply replacing the uniform prior with the long-tailed class-prior improves performance on <emph font="italic">all</emph> downstream tasks: object classification with CIFAR100 (+0.9%), iNat18 (+3.0%), Places205 (+1.4%), object counting with Clevr/Count (+2.1%), and depth prediction with Clevr/Dist (+2.3%) and KITTI (+2.7%).</p>
        </para>
        <para xml:id="S5.SS2.SSS0.Px1.p2">
          <p>These results clearly support the intuition that moving away from the uniformity prior when pretraining with class-imbalanced data can improve the quality of the representations that are learned.
However, note that we have used the true class distribution in these experiments.
While this distribution may be estimated using weak supervision sources often available for internet-scale data (e.g., image captions or hashtags), we would prefer general methods that do not require precise a priori knowledge of the class distribution.</p>
        </para>
        <table inlist="lot" labels="LABEL:tb:inat_class_prior" placement="h" xml:id="S5.T2">
          <tags>
            <tag><text fontsize="90%">Table 2</text></tag>
            <tag role="autoref">Table 2</tag>
            <tag role="refnum">2</tag>
            <tag role="typerefnum">Table 2</tag>
          </tags>
          <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">2</text></tag><text font="bold" fontsize="80%">True Class Prior:</text><text fontsize="80%"> Comparing the uniform prior with the class prior computed from the true class distribution leads to significant gains on downstream tasks.</text></toccaption>
          <caption class="ltx_centering" fontsize="80%"><tag close=": "><text fontsize="113%">Table 2</text></tag><text font="bold" fontsize="113%">True Class Prior:<text font="medium"> Comparing the uniform prior with the class prior computed from the true class distribution leads to significant gains on downstream tasks.</text></text></caption>
          <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
            <thead>
              <tr>
                <td align="right" border="r tt" thead="column"><text fontsize="80%">Prior</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">iNat18</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
                <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" border="tt tt" colspan="7" cssstyle="padding-bottom:2.84526pt"><text font="bold" fontsize="70%">Pretrained on iNaturalist18 (ViT-S/16)</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><text fontsize="80%">uniform</text></td>
                <td align="center"><text fontsize="80%">29.1</text></td>
                <td align="center"><text fontsize="80%">59.4</text></td>
                <td align="center"><text fontsize="80%"> 36.9</text></td>
                <td align="center" border="r"><text fontsize="80%">69.4</text></td>
                <td align="center"><text fontsize="80%">56.8</text></td>
                <td align="center"><text fontsize="80%">68.2</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><text fontsize="80%">class-prior</text></td>
                <td align="center"><text font="bold" fontsize="80%">32.1</text></td>
                <td align="center"><text font="bold" fontsize="80%">60.3</text></td>
                <td align="center"><text font="bold" fontsize="80%">38.3</text></td>
                <td align="center" border="r"><text font="bold" fontsize="80%">71.5</text></td>
                <td align="center"><text font="bold" fontsize="80%">59.1</text></td>
                <td align="center"><text font="bold" fontsize="80%">70.9</text></td>
              </tr>
              <tr>
                <td align="right" border="bb r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="S5.T2.m1">
                    <XMath>
                      <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                    </XMath>
                  </Math></td>
                <td align="center" border="bb"><text color="#0000FF" fontsize="80%">+3.0</text></td>
                <td align="center" border="bb"><text color="#0000FF" fontsize="80%">+0.9</text></td>
                <td align="center" border="bb"><text color="#0000FF" fontsize="80%">+1.4</text></td>
                <td align="center" border="bb r"><text color="#0000FF" fontsize="80%">+2.1</text></td>
                <td align="center" border="bb"><text color="#0000FF" fontsize="80%">+2.3</text></td>
                <td align="center" border="bb"><text color="#0000FF" fontsize="80%">+2.7</text></td>
              </tr>
            </tbody>
          </tabular>
        </table>
      </paragraph>
      <paragraph inlist="toc" xml:id="S5.SS2.SSS0.Px2">
        <title>Results with general power-law distributions.</title>
        <para xml:id="S5.SS2.SSS0.Px2.p1">
          <p>Table <ref labelref="LABEL:tb:inat_powerlaw_priors"/> evaluates models pretrained using PMSN on the ImageNet-1K and iNat18 datasets when we do not use precise knowledge of the class distribution.
In particular, we explore a power-law prior, <Math mode="inline" tex="{\bm{p}}_{\text{\sc PL}(\tau)}" text="p _ ([PL] * tau)" xml:id="S5.SS2.SSS0.Px2.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText><text font="smallcaps" fontsize="70%">PL</text></XMText>
                    <XMDual>
                      <XMRef idref="S5.SS2.SSS0.Px2.p1.m1.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN" xml:id="S5.SS2.SSS0.Px2.p1.m1.1">τ</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, such that <Math mode="inline" tex="[{\bm{p}}_{\text{\sc PL}(\tau)}]_{k}\propto\nicefrac{{1}}{{k}}^{\tau}" text="(delimited-[]@(p _ ([PL] * tau))) _ k proportional-to (1 / k) ^ tau" xml:id="S5.SS2.SSS0.Px2.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="S5.SS2.SSS0.Px2.p1.m2.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp xml:id="S5.SS2.SSS0.Px2.p1.m2.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText><text font="smallcaps" fontsize="70%">PL</text></XMText>
                            <XMDual>
                              <XMRef idref="S5.SS2.SSS0.Px2.p1.m2.1"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN" xml:id="S5.SS2.SSS0.Px2.p1.m2.1">τ</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok meaning="divide" role="MULOP" stretchy="true" width="-0.15em" xoffset="-0.1em">/</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER" rpadding="-0.5em" yoffset="0.3em">1</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> with power-law exponent <Math mode="inline" tex="\tau=0.25" text="tau = 0.25" xml:id="S5.SS2.SSS0.Px2.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
                </XMApp>
              </XMath>
            </Math>.
As expected, use of a power-law prior improves downstream task performance when pretraining on the class-imbalanced iNat18 dataset (top half of Table <ref labelref="LABEL:tb:inat_powerlaw_priors"/>), but degrades performance when pretraining on the class-balanced ImageNet-1K dataset (bottom half of Table <ref labelref="LABEL:tb:inat_powerlaw_priors"/>).
These results indicate that it is preferable to match the prior distribution in self-supervised algorithms to the distribution of semantic concepts in the pretraining dataset.
In the case of ImageNet pretraining, the uniform prior more closely matches the distribution of classes in the dataset, and thus we expect it to achieve strong downstream task performance in that setting.</p>
        </para>
        <para xml:id="S5.SS2.SSS0.Px2.p2">
          <p>While these results support the observation that one can still improve SSL pretraining on class-imbalanced datasets without having a priori knowledge of the class distribution, comparing to Table <ref labelref="LABEL:tb:inat_class_prior"/> shows that it would be preferable to use the true class distribution when such information is available.
In short, we consider the results of this section as a demonstration of the effect of non-uniform feature priors and do not claim to have completely solved the issue of class-imbalanced pretraining.</p>
        </para>
        <table inlist="lot" labels="LABEL:tb:inat_powerlaw_priors" placement="t" xml:id="S5.T3">
          <tags>
            <tag><text fontsize="90%">Table 3</text></tag>
            <tag role="autoref">Table 3</tag>
            <tag role="refnum">3</tag>
            <tag role="typerefnum">Table 3</tag>
          </tags>
          <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">3</text></tag><text font="bold" fontsize="80%">Power-Law Prior</text><text fontsize="80%">: PMSN with a power-law prior achieves better downstream performance than uniform prior, when the pretraining dataset has a long-tailed classes distribution. Power-law prior hurts performance for class-balance pretraining dataset. Feature Prior should therefore matches the class-distribution.</text></toccaption>
          <caption class="ltx_centering" fontsize="80%"><tag close=": "><text fontsize="113%">Table 3</text></tag><text font="bold" fontsize="113%">Power-Law Prior<text font="medium">: PMSN with a power-law prior achieves better downstream performance than uniform prior, when the pretraining dataset has a long-tailed classes distribution. Power-law prior hurts performance for class-balance pretraining dataset. Feature Prior should therefore matches the class-distribution.</text></text></caption>
          <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
            <thead>
              <tr>
                <td align="right" border="r tt" thead="column"><text fontsize="80%">Prior</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">iNat18</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
                <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
                <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" border="tt tt" colspan="7" cssstyle="padding-bottom:2.84526pt"><text font="bold" fontsize="70%">Pretrained on iNaturalist18 (ViT-S/16)</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><text fontsize="80%">uniform</text></td>
                <td align="center"><text fontsize="80%">29.1</text></td>
                <td align="center"><text fontsize="80%">59.4</text></td>
                <td align="center"><text fontsize="80%"> 36.9</text></td>
                <td align="center" border="r"><text fontsize="80%">69.4</text></td>
                <td align="center"><text fontsize="80%">56.8</text></td>
                <td align="center"><text fontsize="80%">68.2</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><text fontsize="80%">power-law</text></td>
                <td align="center"><text fontsize="80%">30.1</text></td>
                <td align="center"><text fontsize="80%">60.1</text></td>
                <td align="center"><text fontsize="80%">37.7</text></td>
                <td align="center" border="r"><text fontsize="80%">71.1</text></td>
                <td align="center"><text fontsize="80%">58.9</text></td>
                <td align="center"><text fontsize="80%">68.2</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="S5.T3.m1">
                    <XMath>
                      <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                    </XMath>
                  </Math></td>
                <td align="center"><text color="#0000FF" fontsize="80%">+1.0</text></td>
                <td align="center"><text color="#0000FF" fontsize="80%">+0.7</text></td>
                <td align="center"><text color="#0000FF" fontsize="80%">+0.8</text></td>
                <td align="center" border="r"><text color="#0000FF" fontsize="80%">+1.7</text></td>
                <td align="center"><text color="#0000FF" fontsize="80%">+2.1</text></td>
                <td align="center"><text fontsize="80%">+0.0</text></td>
              </tr>
              <tr>
                <td align="center" border="t" colspan="7" cssstyle="padding-bottom:2.84526pt"><text font="bold" fontsize="70%">Pretrained on ImageNet (ViT-B/16)</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><text fontsize="80%">uniform</text></td>
                <td align="center"><text fontsize="80%">41.9</text></td>
                <td align="center"><text fontsize="80%">81.7</text></td>
                <td align="center"><text fontsize="80%">54.0</text></td>
                <td align="center" border="r"><text fontsize="80%">74.3</text></td>
                <td align="center"><text fontsize="80%">57.8</text></td>
                <td align="center"><text fontsize="80%">73.3</text></td>
              </tr>
              <tr>
                <td align="right" border="r"><text fontsize="80%">power-law</text></td>
                <td align="center"><text fontsize="80%">22.0</text></td>
                <td align="center"><text fontsize="80%">63.8</text></td>
                <td align="center"><text fontsize="80%">38.3</text></td>
                <td align="center" border="r"><text fontsize="80%">71.4</text></td>
                <td align="center"><text fontsize="80%">65.8</text></td>
                <td align="center"><text fontsize="80%">66.6</text></td>
              </tr>
              <tr>
                <td align="right" border="bb r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="S5.T3.m2">
                    <XMath>
                      <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                    </XMath>
                  </Math></td>
                <td align="center" border="bb"><text color="#FF0000" fontsize="80%">-19.9</text></td>
                <td align="center" border="bb"><text color="#FF0000" fontsize="80%">-17.8</text></td>
                <td align="center" border="bb"><text color="#FF0000" fontsize="80%">-15.7</text></td>
                <td align="center" border="bb r"><text color="#FF0000" fontsize="80%">-2.9</text></td>
                <td align="center" border="bb"><text color="#0000FF" fontsize="80%">+8.0</text></td>
                <td align="center" border="bb"><text color="#FF0000" fontsize="80%">-6.7</text></td>
              </tr>
            </tbody>
          </tabular>
        </table>
      </paragraph>
      <paragraph inlist="toc" xml:id="S5.SS2.SSS0.Px3">
        <title>Visualizing learned prototype vectors.</title>
        <para xml:id="S5.SS2.SSS0.Px3.p1">
          <p>In Figure <ref labelref="LABEL:fig:visu_rcdm_inat"/>, we use RCDM to visualize the prototypes of a PMSN model pretrained with either power-law or uniform priors on the iNat18 dataset.
The features that emerge when pretraining with a power-law prior are more associated with high level concepts such as specific image classes.
For example, one can recognize specific types of birds and plants in Figure <ref labelref="LABEL:fig:visu_rcdm_inat_powerlaw"/>, which is not the case with the samples generated using the uniform prior prototypes in Figure <ref labelref="LABEL:fig:visu_rcdm_inat_uniforme"/>.
These qualitative results further highlight the effect of the overlooked uniform prior in self-supervised learning with class-imbalanced data.</p>
        </para>
        <figure inlist="lof" labels="LABEL:fig:visu_rcdm_inat" placement="h" xml:id="S5.F4">
          <tags>
            <tag><text fontsize="90%">Figure 4</text></tag>
            <tag role="autoref">Figure 4</tag>
            <tag role="refnum">4</tag>
            <tag role="typerefnum">Figure 4</tag>
          </tags>
          <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:visu_rcdm_inat_powerlaw" xml:id="S5.F4.sf1">
            <tags>
              <tag><text fontsize="90%">(a)</text></tag>
              <tag role="autoref">4(a)</tag>
              <tag role="refnum">4(a)</tag>
            </tags>
            <graphics candidates="assets/MSN2_prior_powerlaw.pdf" class="ltx_centering" graphic="assets/MSN2_prior_powerlaw.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.sf1.g1"/>
            <toccaption class="ltx_centering"><tag close=" "><!--  %**** main.tex Line 550 **** -->(a)<!--  %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** --></tag><!--  %**** main.tex Line 550 **** -->
Pretraining on iNat18 with power-law prior<break/><text font="bold">(Prior matching iNat18 class distribution)</text>
</toccaption>
            <caption class="ltx_centering"><tag close=" "><!--  %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** --><text fontsize="90%"><!--  %**** main.tex Line 550 **** -->(a)<!--  %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** --></text></tag><!--  %**** main.tex Line 550 **** 
     %**** main.tex Line 550 **** --><text fontsize="90%">
Pretraining on iNat18 with power-law prior<break/><text font="bold">(Prior matching iNat18 class distribution)</text>
</text></caption>
          </figure>
          <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:visu_rcdm_inat_uniforme" xml:id="S5.F4.sf2">
            <tags>
              <tag><text fontsize="90%">(b)</text></tag>
              <tag role="autoref">4(b)</tag>
              <tag role="refnum">4(b)</tag>
            </tags>
            <graphics candidates="assets/MSN2_prior_uniform.pdf" class="ltx_centering" graphic="assets/MSN2_prior_uniform.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.sf2.g1"/>
            <toccaption class="ltx_centering"><tag close=" ">(b)</tag>
Pretraining on iNat18 with uniform prior.<break/><text font="bold">(Prior not aligned with iNat18 class distribution)</text>
</toccaption>
            <caption class="ltx_centering"><tag close=" "><text fontsize="90%">(b)</text></tag><text fontsize="90%">
Pretraining on iNat18 with uniform prior.<break/><text font="bold">(Prior not aligned with iNat18 class distribution)</text>
</text></caption>
          </figure>
          <toccaption class="ltx_centering"><tag close=" ">4</tag>Visualization of prototypes learned by an PMSN model pretrained with either uniform or powerlaw priors on the iNat18 dataset. We use RCDM <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> to enable visualization of the prototypes. Each row corresponds to samples generated by conditioning on a prototype with various random seeds. Features that remain constant across the row depicts information contained in the prototypes, whereas features that vary depict information that is not contained.
a) Features that emerge when pretraining with a powerlaw prior on the iNat18 dataset tend to be associated with high level concepts such as specific image classes.
b) Features that emerge by pretraining with a uniform prior are largely associated with low-level concepts such as texture.</toccaption>
          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 4</text></tag><text fontsize="90%">Visualization of prototypes learned by an PMSN model pretrained with either uniform or powerlaw priors on the iNat18 dataset. We use RCDM <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>)</cite> to enable visualization of the prototypes. Each row corresponds to samples generated by conditioning on a prototype with various random seeds. Features that remain constant across the row depicts information contained in the prototypes, whereas features that vary depict information that is not contained.
a) Features that emerge when pretraining with a powerlaw prior on the iNat18 dataset tend to be associated with high level concepts such as specific image classes.
b) Features that emerge by pretraining with a uniform prior are largely associated with low-level concepts such as texture.</text></caption>
        </figure>
      </paragraph>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S6">
    <tags>
      <tag>6</tag>
      <tag role="autoref">section 6</tag>
      <tag role="refnum">6</tag>
      <tag role="typerefnum">§6</tag>
    </tags>
    <title><tag close=" ">6</tag>Conclusion</title>
    <para xml:id="S6.p1">
      <p>In this work, we show that many common self-supervised learning frameworks have a prior to capture features that enable uniform clustering of the data, and as such, require class-balanced datasets to learn class-discriminative features.
By reformulating self-supervised criteria to prefer power-law distributed features, one can improve quality of the learned representations on real-world class-imbalanced datasets.</p>
    </para>
<!--  %“newpage -->    <pagination role="newpage"/>
<!--  %**** main.tex Line 575 **** -->  </section>
  <section xml:id="Sx1">
    <title>Reproducibility statement</title>
    <para xml:id="Sx1.p1">
      <p>To facilitate reproducibility, we provide details on our pretraining and evaluation protocol in Appendices <ref labelref="LABEL:apndx:classstratified_sampling"/> and <ref labelref="LABEL:apndx:priors"/>.
When pretraining using existing methods, we leverage publicly available implementations along with the default hyperparameters; see Appendix <ref labelref="LABEL:apndx:classstratified_sampling"/> for details.
For evaluation, we use the publicly available VISSL codebase <cite class="ltx_citemacro_citep">(<bibref bibrefs="goyal2021vissl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>; specific evaluation configurations are provided in Appendix <ref labelref="LABEL:apndx:classstratified_sampling_eval"/>.
The training details for the PMSN experiments are provided in Appendix <ref labelref="LABEL:sec:priors"/>.
And finally, the proofs for all propositions in Section <ref labelref="LABEL:sec:theory"/> are produced in Appendix <ref labelref="LABEL:apndx:proofs"/>.</p>
    </para>
  </section>
  <bibliography citestyle="authoryear" files="refs.bib" xml:id="bib">
    <title>References</title>
  </bibliography>
<!--  %“input–proofs˝ -->  <pagination role="newpage"/>
  <appendix inlist="toc" labels="LABEL:apndx:relatedwork" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Broader related work</title>
    <toctitle><tag close=" ">A</tag>Broader related work</toctitle>
    <para xml:id="A1.p1">
      <p>Joint-embedding architectures are an active line of research in self-supervised representation learning <cite class="ltx_citemacro_citep">(<bibref bibrefs="wu2018unsupervised,he2019moco,chen2020exploring,grill2020bootstrap,chen2020mocov2,caron2021emerging,bardes2021vicreg,zhou2021ibotyes" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
These approaches rely on invariance based pretraining where a neural network encoder is trained to output similar embeddings for two or more views of the same image. To avoid pathological solution, joint-embedding approaches use explicit regularization <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple,caron2021emerging,bardes2021vicreg,assran2021semi" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or architectural constraints <cite class="ltx_citemacro_citep">(<bibref bibrefs="grill2020bootstrap,chen2020exploring" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="A1.p2">
      <p>Explicit regularization usually maximizes the volume of space occupied by the representations. Regularization can be implemented using various strategies such as contrasting negative samples <cite class="ltx_citemacro_citep">(<bibref bibrefs="bromley1993signature,he2019moco,chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, variance-covariance regularization <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg,zbontar2021barlow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, or by maximizing the entropy of the representations <cite class="ltx_citemacro_citep">(<bibref bibrefs="asano2019self,caron2020unsupervised,caron2021emerging,assran2021semi,assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Alternative collapse-prevention approaches based on architectural constraints leverage architectural design to avoid collapse such as stopping the gradient flow in one of the Siamese Network branches <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, using a momentum encoder to compute the network targets <cite class="ltx_citemacro_citep">(<bibref bibrefs="grill2020bootstrap" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, or using an asymmetric prediction head <cite class="ltx_citemacro_citep">(<bibref bibrefs="grill2020bootstrap,chen2020simple,baevski2022data2vec" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Recent theoretical work <cite class="ltx_citemacro_citep">(<bibref bibrefs="tian2021understanding" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite><!--  %**** main.tex Line 600 **** --> explores why certain joint-embedding methods with architectural constraint avoid representation collapse without explicit use of a volume maximization penalty; the implicit collapse prevention mechanisms here are not mutually exclusive.
Recent empirical work <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022guillotine" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> studies the invariance properties of these pretrained representations.
The work of <cite class="ltx_citemacro_citet"><bibref bibrefs="mitrovic2020representation" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> has drawn connections between invariance and causality when the data-augmentations used during pretraining manipulate specific factors of variation in the data-generating distribution.
Other works have studied the computational efficiency of joint-embedding methods, and demonstrated how small amounts of supervision can be used to accelerate convergence <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2020supervision" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="A1.p3">
      <p>While joint-embedding architectures are usually leveraged to learn a global image representations, some works explore these use of these architecture for learning local and dense representations <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2022intra,gidaris2020learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
More recently, <cite class="ltx_citemacro_citet"><bibref bibrefs="lecun2022path" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> proposes an architecture based on joint-embedding approaches to learn generic world model, capturing both dense local features as well as global image features.</p>
    </para>
    <para xml:id="A1.p4">
      <p>Orthogonal to the contributions of invariance-based pretraining, another line of work attempts to learn representations by artificially masking parts of the input and training a network to reconstruct the hidden content <cite class="ltx_citemacro_citep">(<bibref bibrefs="vincent2010stacked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Auto-regressive models, and denoising auto-encoders, in particular, predict clean visual inputs from noisy views <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020generative,vincent2010stacked,he2021masked,bao2021beit,baevski2022data2vec" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. A mask-noise is usually used to perturb the images and those approaches predict the masked inputs either at the pixel level <cite class="ltx_citemacro_citep">(<bibref bibrefs="dosovitskiy2020image,he2021masked,xie2019unsupervised" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or at a token-level, using a pixel (often patch-level) tokenizer <cite class="ltx_citemacro_citep">(<bibref bibrefs="bao2021beit,wei2021masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
While these works demonstrate impressive scalability, they usually learn features at a low-level of semantic abstraction compared to joint-embedding approaches <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="A1.p5">
      <p>More recently, a set of approaches attempt to combine both joint-embedding and reconstruction based approaches <cite class="ltx_citemacro_cite"><bibref bibrefs="zhou2021ibotyes,el2021large" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>, wherein they combine an invariance pretraining loss with a patch-level reconstruction loss.</p>
    </para>
  </appendix>
  <appendix inlist="toc" xml:id="A2">
    <tags>
      <tag>Appendix B</tag>
      <tag role="autoref">Appendix B</tag>
      <tag role="refnum">B</tag>
      <tag role="typerefnum">Appendix B</tag>
    </tags>
    <title><tag close=" ">Appendix B</tag>Relation to the InfoMax principle</title>
    <toctitle><tag close=" ">B</tag>Relation to the InfoMax principle</toctitle>
    <para xml:id="A2.p1">
      <p>A longstanding conviction in unsupervised representation learning is that the resulting representations should be both maximally informative about the inputs, while also satisfying certain simplicity constraints <cite class="ltx_citemacro_citep">(<bibref bibrefs="linsker1988self,goodfellow2016deep" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
The former objective is often referred to as the information-maximization principle (InfoMax), while the latter is sometimes referred to as the parsimony principle <cite class="ltx_citemacro_citep">(<bibref bibrefs="ma2022principles" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, which is crucial to the problem formulation.
Indeed, <cite class="ltx_citemacro_citet"><bibref bibrefs="bridle1991unsupervised" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>, one of the first works to empirically explore unsupervised representation learning via information-maximization, found that, in the absence of additional constraints, the resulting InfoMax representations may not be very useful.
The more recent analysis of <cite class="ltx_citemacro_citet"><bibref bibrefs="tschannen2019mutual" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> also argues that simplicity constraints are essential to the success of modern representation learning methods built on the InfoMax principle.
Historically, simplicity constraints were enforced by encouraging the learned representations to be sparse, low-dimensional, or disentangled, i.e., the individual dimensions of the representation vector should be statistically independent.</p>
    </para>
    <para xml:id="A2.p2">
      <p>Modern state-of-the-art approaches for unsupervised representation learning still frequently employ an information-maximization formulation <cite class="ltx_citemacro_citep">(<bibref bibrefs="hjelm2018learning,bachman2019learning,krause2010discriminative,hu2017learning,oord2018representation" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, but with the simplicity constraints manifested in self-supervised loss terms.
One example is the widespread view-invariance penalty <cite class="ltx_citemacro_citep">(<bibref bibrefs="misra2020self" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, often coupled with with independence <cite class="ltx_citemacro_citep">(<bibref bibrefs="zbontar2021barlow,bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or low-dimensionality constraints, e.g., by projecting representations on the unit hypersphere <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple,he2019moco,grill2020bootstrap" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="A2.p3">
      <p>To better understand these methods, recall that the mutual information, <Math mode="inline" tex="I(\cdot,\cdot)" text="I * open-interval@(cdot, cdot)" xml:id="A2.p3.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">I</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A2.p3.m1.1"/>
                  <XMRef idref="A2.p3.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok name="cdot" role="MULOP" xml:id="A2.p3.m1.1">⋅</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="cdot" role="MULOP" xml:id="A2.p3.m1.2">⋅</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, between a latent vector <Math mode="inline" tex="Z" text="Z" xml:id="A2.p3.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
          </XMath>
        </Math> and data <Math mode="inline" tex="X" text="X" xml:id="A2.p3.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">X</XMTok>
          </XMath>
        </Math> can be written as</p>
      <equation xml:id="A2.Ex2">
        <Math mode="display" tex="I(Z,X)=H[Z]-H[Z|X]," text="I * open-interval@(Z, X) = H * delimited-[]@(Z) - H * delimited-[]@(conditional@(Z, X))" xml:id="A2.Ex2.m1">
          <XMath>
            <XMDual>
              <XMRef idref="A2.Ex2.m1.4"/>
              <XMWrap>
                <XMApp xml:id="A2.Ex2.m1.4">
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A2.Ex2.m1.1"/>
                        <XMRef idref="A2.Ex2.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.Ex2.m1.1">Z</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.Ex2.m1.2">X</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="A2.Ex2.m1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A2.Ex2.m1.3">Z</XMTok>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">H</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="A2.Ex2.m1.4.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="A2.Ex2.m1.4.1">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="H[Z]" text="H * delimited-[]@(Z)" xml:id="A2.p3.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">H</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="delimited-[]"/>
                  <XMRef idref="A2.p3.m4.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A2.p3.m4.1">Z</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is the marginal entropy of <Math mode="inline" tex="Z" text="Z" xml:id="A2.p3.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
          </XMath>
        </Math>, and <Math mode="inline" tex="H[Z|X]" text="H * delimited-[]@(conditional@(Z, X))" xml:id="A2.p3.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">H</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="delimited-[]"/>
                  <XMRef idref="A2.p3.m6.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="A2.p3.m6.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN">Z</XMTok>
                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is the expected entropy of the posterior distribution.
In learning a representation of the data, <Math mode="inline" tex="Z" text="Z" xml:id="A2.p3.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
          </XMath>
        </Math>, that maximizes the mutual information <Math mode="inline" tex="I(Z,X)" text="I * open-interval@(Z, X)" xml:id="A2.p3.m8">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">I</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A2.p3.m8.1"/>
                  <XMRef idref="A2.p3.m8.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A2.p3.m8.1">Z</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A2.p3.m8.2">X</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, we thereby seek to maximize the marginal entropy of <Math mode="inline" tex="Z" text="Z" xml:id="A2.p3.m9">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
          </XMath>
        </Math>, i.e., search for uniformly distributed feature embeddings.</p>
    </para>
    <para xml:id="A2.p4">
      <p>However, as we show in this work, perhaps the features that we wish our representations to capture are not necessarily those with the highest marginal entropy.
It is often the case that the semantic concepts we wish to capture actually follow a long-tailed distribution in the wild .
Such desirable features would be penalized under existing information-maximization frameworks.
Thus, in the absence of finer grained notions of information, perhaps it is necessary to reconsider the longstanding conviction of seeking representations that maximize information content.</p>
    </para>
  </appendix>
  <appendix inlist="toc" labels="LABEL:apndx:proofs" xml:id="A3">
    <tags>
      <tag>Appendix C</tag>
      <tag role="autoref">Appendix C</tag>
      <tag role="refnum">C</tag>
      <tag role="typerefnum">Appendix C</tag>
    </tags>
    <title><tag close=" ">Appendix C</tag>Theoretical guarantees</title>
    <toctitle><tag close=" ">C</tag>Theoretical guarantees</toctitle>
    <subsection inlist="toc" labels="LABEL:proof:kmeans1" xml:id="A3.SS1">
      <tags>
        <tag>C.1</tag>
        <tag role="autoref">subsection C.1</tag>
        <tag role="refnum">C.1</tag>
        <tag role="typerefnum">§C.1</tag>
      </tags>
      <title><tag close=" ">C.1</tag>Proof of proposition <ref labelref="LABEL:prop:kmeans"/></title>
      <para xml:id="A3.SS1.p1">
        <p>We will demonstrate that</p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx3">
          <equation xml:id="A3.E10">
            <tags>
              <tag>(10)</tag>
              <tag role="autoref">Equation 10</tag>
              <tag role="refnum">10</tag>
            </tags>
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\min_{c=1,\dots,K}%&#10;\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}=\min_{{\bm{P}}\in\{0,1\}^{N\times K}:%&#10;{\bm{P}}\mathbf{1}_{K}=\mathbf{1}_{N}}\sum_{k=1}^{K}\sum_{n,n^{\prime}=1}^{N}%&#10;\frac{{\bm{P}}_{n,k}{\bm{P}}_{n^{\prime},k}}{\mathbf{1}_{N}^{T}{\bm{P}}_{.,k}}%&#10;\lVert{\bm{x}}_{n}-{\bm{x}}_{n^{\prime}}\rVert^{2}_{2}," xml:id="A3.E10.m2">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A3.E10.m2.2"/>
                        <XMRef idref="A3.E10.m2.1"/>
                        <XMRef idref="A3.E10.m2.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A3.E10.m2.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.E10.m2.1">…</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="A3.E10.m2.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="A3.E10.m2.4"/>
                          <XMRef idref="A3.E10.m2.5"/>
                          <XMRef idref="A3.E10.m2.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.E10.m2.4">1</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.E10.m2.5">…</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m2.6">K</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                      </XMWrap>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="A3.E10.m2.7"/>
                              <XMRef idref="A3.E10.m2.8"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.E10.m2.7">0</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.E10.m2.8">1</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.E10.m2.9"/>
                            <XMRef idref="A3.E10.m2.10"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m2.9">n</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.E10.m2.10">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.E10.m2.11"/>
                            <XMRef idref="A3.E10.m2.12"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m2.11">n</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m2.12">k</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.E10.m2.14"/>
                            <XMRef idref="A3.E10.m2.13"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A3.E10.m2.14">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m2.13">k</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                        <XMArg rule="Subscript">
                          <XMTok fontsize="70%" role="PERIOD">.</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMArg>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                      </XMWrap>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\min_{c=1,\dots,K}%&#10;\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}=\min_{{\bm{P}}\in\{0,1\}^{N\times K}:%&#10;{\bm{P}}\mathbf{1}_{K}=\mathbf{1}_{N}}\sum_{k=1}^{K}\sum_{n,n^{\prime}=1}^{N}%&#10;\frac{{\bm{P}}_{n,k}{\bm{P}}_{n^{\prime},k}}{\mathbf{1}_{N}^{T}{\bm{P}}_{.,k}}%&#10;\lVert{\bm{x}}_{n}-{\bm{x}}_{n^{\prime}}\rVert^{2}_{2}," xml:id="A3.E10.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.E10.m1.2"/>
                            <XMRef idref="A3.E10.m1.1"/>
                            <XMRef idref="A3.E10.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A3.E10.m1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.E10.m1.1">…</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.E10.m1.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A3.E10.m1.4"/>
                              <XMRef idref="A3.E10.m1.5"/>
                              <XMRef idref="A3.E10.m1.6"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.E10.m1.4">1</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.E10.m1.5">…</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m1.6">K</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                          </XMWrap>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="set"/>
                                  <XMRef idref="A3.E10.m1.7"/>
                                  <XMRef idref="A3.E10.m1.8"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.E10.m1.7">0</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.E10.m1.8">1</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A3.E10.m1.9"/>
                                <XMRef idref="A3.E10.m1.10"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m1.9">n</XMTok>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMApp xml:id="A3.E10.m1.10">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A3.E10.m1.11"/>
                                <XMRef idref="A3.E10.m1.12"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m1.11">n</XMTok>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m1.12">k</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A3.E10.m1.14"/>
                                <XMRef idref="A3.E10.m1.13"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A3.E10.m1.14">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.E10.m1.13">k</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                            <XMArg rule="Subscript">
                              <XMTok fontsize="70%" role="PERIOD">.</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMArg>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                          </XMWrap>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where the left-hand side minimizes over the values of the <Math mode="inline" tex="K" text="K" xml:id="A3.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> centroids and the inner minimization identifies the cluster membership of sample <Math mode="inline" tex="x_{n}" text="x _ n" xml:id="A3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>.
To do so, one should first notice that almost surely, for any input <Math mode="inline" tex="{\bm{x}}_{n}" text="x _ n" xml:id="A3.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>, the <Math class="ltx_math_unparsed" mode="inline" tex="\min_{c=1,\dots,K}\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}" xml:id="A3.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post">min</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="A3.SS1.p1.m4.1"/>
                      <XMRef idref="A3.SS1.p1.m4.2"/>
                      <XMRef idref="A3.SS1.p1.m4.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.SS1.p1.m4.1">1</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.SS1.p1.m4.2">…</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS1.p1.m4.3">K</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMWrap>
                    <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                    <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                  </XMWrap>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> is attained for a single centroid. In fact, for any continuous distribution on the data (and/or centroids) the probability to sample them so that a sample <Math mode="inline" tex="{\bm{x}}" text="x" xml:id="A3.SS1.p1.m5">
            <XMath>
              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> lies exactly equidistant from two (or more) centroids is <Math mode="inline" tex="0" text="0" xml:id="A3.SS1.p1.m6">
            <XMath>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMath>
          </Math> since this is a space of dimension <Math mode="inline" tex="D-1" text="D - 1" xml:id="A3.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, which has measure <Math mode="inline" tex="0" text="0" xml:id="A3.SS1.p1.m8">
            <XMath>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMath>
          </Math><!--  %**** main.tex Line 650 **** -->.
Hence, we first obtain</p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx4">
          <equation xml:id="A3.Ex3">
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\min_{c=1,\dots,K}%&#10;\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}=\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1%&#10;}^{N}\min_{{\bm{p}}\in\{0,1\}^{K}:{\bm{p}}^{T}\mathbf{1}_{K}=1}\sum_{k=1}^{K}{%&#10;\bm{p}}_{k}\lVert{\bm{x}}_{n}-\mu_{k}\rVert^{2}_{2}," xml:id="A3.Ex3.m2">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A3.Ex3.m2.2"/>
                        <XMRef idref="A3.Ex3.m2.1"/>
                        <XMRef idref="A3.Ex3.m2.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex3.m2.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex3.m2.1">…</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="A3.Ex3.m2.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="A3.Ex3.m2.4"/>
                          <XMRef idref="A3.Ex3.m2.5"/>
                          <XMRef idref="A3.Ex3.m2.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex3.m2.4">1</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex3.m2.5">…</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex3.m2.6">K</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                      </XMWrap>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A3.Ex3.m2.8"/>
                        <XMRef idref="A3.Ex3.m2.7"/>
                        <XMRef idref="A3.Ex3.m2.9"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex3.m2.8">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex3.m2.7">…</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="A3.Ex3.m2.9">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="A3.Ex3.m2.10"/>
                              <XMRef idref="A3.Ex3.m2.11"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex3.m2.10">0</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex3.m2.11">1</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                      </XMWrap>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\min_{c=1,\dots,K}%&#10;\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}=\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1%&#10;}^{N}\min_{{\bm{p}}\in\{0,1\}^{K}:{\bm{p}}^{T}\mathbf{1}_{K}=1}\sum_{k=1}^{K}{%&#10;\bm{p}}_{k}\lVert{\bm{x}}_{n}-\mu_{k}\rVert^{2}_{2}," xml:id="A3.Ex3.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex3.m1.2"/>
                            <XMRef idref="A3.Ex3.m1.1"/>
                            <XMRef idref="A3.Ex3.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex3.m1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex3.m1.1">…</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.Ex3.m1.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A3.Ex3.m1.4"/>
                              <XMRef idref="A3.Ex3.m1.5"/>
                              <XMRef idref="A3.Ex3.m1.6"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex3.m1.4">1</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex3.m1.5">…</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex3.m1.6">K</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                          </XMWrap>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex3.m1.8"/>
                            <XMRef idref="A3.Ex3.m1.7"/>
                            <XMRef idref="A3.Ex3.m1.9"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex3.m1.8">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex3.m1.7">…</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.Ex3.m1.9">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="set"/>
                                  <XMRef idref="A3.Ex3.m1.10"/>
                                  <XMRef idref="A3.Ex3.m1.11"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex3.m1.10">0</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex3.m1.11">1</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                          </XMWrap>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>and because each sub-problem is independent, we can pull them out of the sum to obtain</p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx5">
          <equation xml:id="A3.Ex4">
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\min_{c=1,\dots,K}%&#10;\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}=\min_{\mu_{1},\dots,\mu_{k}}\min_{{%&#10;\bm{P}}\in\{0,1\}^{N\times K}:{\bm{P}}\mathbf{1}_{K}}\sum_{n=1}^{N}\sum_{k=1}^%&#10;{K}{\bm{P}}_{n,k}\lVert{\bm{x}}_{n}-\mu_{k}\rVert^{2}_{2}," xml:id="A3.Ex4.m2">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A3.Ex4.m2.2"/>
                        <XMRef idref="A3.Ex4.m2.1"/>
                        <XMRef idref="A3.Ex4.m2.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex4.m2.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex4.m2.1">…</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="A3.Ex4.m2.3">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="A3.Ex4.m2.4"/>
                          <XMRef idref="A3.Ex4.m2.5"/>
                          <XMRef idref="A3.Ex4.m2.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex4.m2.4">1</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex4.m2.5">…</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex4.m2.6">K</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                      </XMWrap>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A3.Ex4.m2.8"/>
                        <XMRef idref="A3.Ex4.m2.7"/>
                        <XMRef idref="A3.Ex4.m2.9"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex4.m2.8">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex4.m2.7">…</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="A3.Ex4.m2.9">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="A3.Ex4.m2.10"/>
                              <XMRef idref="A3.Ex4.m2.11"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex4.m2.10">0</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex4.m2.11">1</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A3.Ex4.m2.12"/>
                        <XMRef idref="A3.Ex4.m2.13"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex4.m2.12">n</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex4.m2.13">k</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                      </XMWrap>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\min_{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\min_{c=1,\dots,K}%&#10;\lVert{\bm{x}}_{n}-\mu_{c}\rVert^{2}_{2}=\min_{\mu_{1},\dots,\mu_{k}}\min_{{%&#10;\bm{P}}\in\{0,1\}^{N\times K}:{\bm{P}}\mathbf{1}_{K}}\sum_{n=1}^{N}\sum_{k=1}^%&#10;{K}{\bm{P}}_{n,k}\lVert{\bm{x}}_{n}-\mu_{k}\rVert^{2}_{2}," xml:id="A3.Ex4.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex4.m1.2"/>
                            <XMRef idref="A3.Ex4.m1.1"/>
                            <XMRef idref="A3.Ex4.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex4.m1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex4.m1.1">…</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.Ex4.m1.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A3.Ex4.m1.4"/>
                              <XMRef idref="A3.Ex4.m1.5"/>
                              <XMRef idref="A3.Ex4.m1.6"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex4.m1.4">1</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex4.m1.5">…</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex4.m1.6">K</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            </XMApp>
                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                          </XMWrap>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex4.m1.8"/>
                            <XMRef idref="A3.Ex4.m1.7"/>
                            <XMRef idref="A3.Ex4.m1.9"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex4.m1.8">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex4.m1.7">…</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.Ex4.m1.9">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="set"/>
                                  <XMRef idref="A3.Ex4.m1.10"/>
                                  <XMRef idref="A3.Ex4.m1.11"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex4.m1.10">0</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex4.m1.11">1</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex4.m1.12"/>
                            <XMRef idref="A3.Ex4.m1.13"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex4.m1.12">n</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex4.m1.13">k</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                          </XMWrap>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>now we can switch the minimization order to obtain</p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx6">
          <equation xml:id="A3.Ex5">
            <MathFork>
              <Math tex="\displaystyle\min_{{\bm{P}}\in\{0,1\}^{N\times K}:{\bm{P}}\mathbf{1}_{K}}\min_%&#10;{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\sum_{k=1}^{K}{\bm{P}}_{n,k}\lVert{\bm{x}%&#10;}_{n}-\mu_{k}\rVert^{2}_{2}=\min_{{\bm{P}}\in\{0,1\}^{N\times K}:{\bm{P}}%&#10;\mathbf{1}_{K}}\sum_{n=1}^{N}\sum_{k=1}^{K}{\bm{P}}_{n,k}\lVert{\bm{x}}_{n}-%&#10;\mu^{*}_{k}\rVert^{2}_{2}," text="(minimum _ (P element-of (set@(0, 1)) ^ (N * K) colon P * 1 _ K))@(minimum _ (list@(mu _ 1, dots, mu _ k))) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(P _ (list@(n, k)) * ((delimited-∥∥@(x _ n - mu _ k)) ^ 2) _ 2)) = minimum _ (P element-of (set@(0, 1)) ^ (N * K) colon P * 1 _ K) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(P _ (list@(n, k)) * ((delimited-∥∥@(x _ n - (mu ^ *) _ k)) ^ 2) _ 2))" xml:id="A3.Ex5.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="A3.Ex5.m2.12"/>
                    <XMWrap>
                      <XMApp xml:id="A3.Ex5.m2.12">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="set"/>
                                        <XMRef idref="A3.Ex5.m2.1"/>
                                        <XMRef idref="A3.Ex5.m2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex5.m2.1">0</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex5.m2.2">1</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="A3.Ex5.m2.4"/>
                                  <XMRef idref="A3.Ex5.m2.3"/>
                                  <XMRef idref="A3.Ex5.m2.5"/>
                                </XMApp>
                                <XMWrap>
                                  <XMApp xml:id="A3.Ex5.m2.4">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex5.m2.3">…</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A3.Ex5.m2.5">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A3.Ex5.m2.6"/>
                                      <XMRef idref="A3.Ex5.m2.7"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m2.6">n</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m2.7">k</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-∥∥"/>
                                        <XMRef idref="A3.Ex5.m2.12.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                        <XMApp xml:id="A3.Ex5.m2.12.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="set"/>
                                      <XMRef idref="A3.Ex5.m2.8"/>
                                      <XMRef idref="A3.Ex5.m2.9"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex5.m2.8">0</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex5.m2.9">1</XMTok>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A3.Ex5.m2.10"/>
                                      <XMRef idref="A3.Ex5.m2.11"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m2.10">n</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m2.11">k</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-∥∥"/>
                                        <XMRef idref="A3.Ex5.m2.12.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                        <XMApp xml:id="A3.Ex5.m2.12.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                              <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\min_{{\bm{P}}\in\{0,1\}^{N\times K}:{\bm{P}}\mathbf{1}_{K}}\min_%&#10;{\mu_{1},\dots,\mu_{k}}\sum_{n=1}^{N}\sum_{k=1}^{K}{\bm{P}}_{n,k}\lVert{\bm{x}%&#10;}_{n}-\mu_{k}\rVert^{2}_{2}=\min_{{\bm{P}}\in\{0,1\}^{N\times K}:{\bm{P}}%&#10;\mathbf{1}_{K}}\sum_{n=1}^{N}\sum_{k=1}^{K}{\bm{P}}_{n,k}\lVert{\bm{x}}_{n}-%&#10;\mu^{*}_{k}\rVert^{2}_{2}," text="(minimum _ (P element-of (set@(0, 1)) ^ (N * K) colon P * 1 _ K))@(minimum _ (list@(mu _ 1, dots, mu _ k))) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(P _ (list@(n, k)) * ((delimited-∥∥@(x _ n - mu _ k)) ^ 2) _ 2)) = minimum _ (P element-of (set@(0, 1)) ^ (N * K) colon P * 1 _ K) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(P _ (list@(n, k)) * ((delimited-∥∥@(x _ n - (mu ^ *) _ k)) ^ 2) _ 2))" xml:id="A3.Ex5.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="A3.Ex5.m1.12"/>
                        <XMWrap>
                          <XMApp xml:id="A3.Ex5.m1.12">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="set"/>
                                            <XMRef idref="A3.Ex5.m1.1"/>
                                            <XMRef idref="A3.Ex5.m1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                            <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex5.m1.1">0</XMTok>
                                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex5.m1.2">1</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A3.Ex5.m1.4"/>
                                      <XMRef idref="A3.Ex5.m1.3"/>
                                      <XMRef idref="A3.Ex5.m1.5"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMApp xml:id="A3.Ex5.m1.4">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex5.m1.3">…</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A3.Ex5.m1.5">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A3.Ex5.m1.6"/>
                                          <XMRef idref="A3.Ex5.m1.7"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m1.6">n</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m1.7">k</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="delimited-∥∥"/>
                                            <XMRef idref="A3.Ex5.m1.12.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                            <XMApp xml:id="A3.Ex5.m1.12.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="A3.Ex5.m1.8"/>
                                          <XMRef idref="A3.Ex5.m1.9"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                          <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="A3.Ex5.m1.8">0</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex5.m1.9">1</XMTok>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok fontsize="50%" meaning="times" role="MULOP">×</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A3.Ex5.m1.10"/>
                                          <XMRef idref="A3.Ex5.m1.11"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m1.10">n</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex5.m1.11">k</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="delimited-∥∥"/>
                                            <XMRef idref="A3.Ex5.m1.12.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                            <XMApp xml:id="A3.Ex5.m1.12.2">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                                </XMApp>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>with <Math mode="inline" tex="\mu^{*}_{k}" text="(mu ^ *) _ k" xml:id="A3.SS1.p1.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> the mean of the samples within cluster <Math mode="inline" tex="k" text="k" xml:id="A3.SS1.p1.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>, i.e. <Math mode="inline" tex="\frac{1}{({\bm{P}}^{T}\mathbf{1}_{N})_{k}}\sum_{n=1}^{N}{\bm{P}}_{n,k}{\bm{x}}%&#10;_{n}" text="(1 / (P ^ T * 1 _ N) _ k) * ((sum _ (n = 1)) ^ N)@(P _ (list@(n, k)) * x _ n)" xml:id="A3.SS1.p1.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMDual>
                      <XMRef idref="A3.SS1.p1.m11.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A3.SS1.p1.m11.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="A3.SS1.p1.m11.2"/>
                          <XMRef idref="A3.SS1.p1.m11.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS1.p1.m11.2">n</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS1.p1.m11.3">k</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
The only thing left to show is that the sum of distances to the cluster means is equivalent to the pairwise distances between all the points within each cluster with an appropriate normalization, which is a standard result; see, e.g., <cite class="ltx_citemacro_citet"><bibref bibrefs="zha2001spectral" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:proof:kmeans2" xml:id="A3.SS2">
      <tags>
        <tag>C.2</tag>
        <tag role="autoref">subsection C.2</tag>
        <tag role="refnum">C.2</tag>
        <tag role="typerefnum">§C.2</tag>
      </tags>
      <title><tag close=" ">C.2</tag>Proof of proposition <ref labelref="LABEL:prop:vicreg"/></title>
      <paragraph inlist="toc" xml:id="A3.SS2.SSS0.Px1">
        <title>Notation.</title>
        <para xml:id="A3.SS2.SSS0.Px1.p1">
          <p>Before establishing the theoretical connections between common joint-embedding methods for self-supervised learning and the K-means method, we first define some notation to facilitate the discussion.
Given a “stand-alone” dataset, <Math mode="inline" tex="{\bm{X}}^{\prime}\in\mathbb{R}^{N^{\prime}\times 3HW}" text="X ^ prime element-of ℝ ^ (N ^ prime * 3 * H * W)" xml:id="A3.SS2.SSS0.Px1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok role="UNKNOWN">ℝ</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">H</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">W</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, we construct the pretraining data <Math mode="inline" tex="{\bm{X}}\in\mathbb{R}^{N\times 3HW}" text="X element-of ℝ ^ (N * 3 * H * W)" xml:id="A3.SS2.SSS0.Px1.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok role="UNKNOWN">ℝ</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">H</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">W</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> by repeatedly perturbing the elements of the stand-alone dataset.
Specifically,</p>
          <equation xml:id="A3.Ex6">
            <Math mode="display" tex="{\bm{X}}\triangleq[\text{View}_{1}({\bm{X}}^{\prime})^{T},\dots,\text{View}_{V%&#10;}({\bm{X}}^{\prime})^{T}]^{T}," text="X triangleq (list@([View] _ 1 * X ^ prime ^ T, dots, [View] _ V * X ^ prime ^ T)) ^ T" xml:id="A3.Ex6.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A3.Ex6.m1.2"/>
                  <XMWrap>
                    <XMApp xml:id="A3.Ex6.m1.2">
                      <XMTok name="triangleq" role="RELOP">≜</XMTok>
<!--  %**** main.tex Line 675 **** -->                      <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex6.m1.2.1"/>
                            <XMRef idref="A3.Ex6.m1.1"/>
                            <XMRef idref="A3.Ex6.m1.2.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMApp xml:id="A3.Ex6.m1.2.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMText>View</XMText>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMRef idref="A3.Ex6.m1.2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.Ex6.m1.2.1.1">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok name="dots" role="ID" xml:id="A3.Ex6.m1.1">…</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A3.Ex6.m1.2.2">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMText>View</XMText>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMRef idref="A3.Ex6.m1.2.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.Ex6.m1.2.2.1">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>where <Math class="ltx_math_unparsed" mode="inline" tex="\text{View}_{i}(.)" xml:id="A3.SS2.SSS0.Px1.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText>View</XMText>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok role="PERIOD">.</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMath>
            </Math> is a sample-wise image transformation, e.g., random crop, color jitter, patch masking.
We also define the ground-truth similarity matrix, <Math mode="inline" tex="{\bm{G}}\in\{0,1\}^{N\times 3HW}" text="G element-of (set@(0, 1)) ^ (N * 3 * H * W)" xml:id="A3.SS2.SSS0.Px1.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="A3.SS2.SSS0.Px1.p1.m4.1"/>
                        <XMRef idref="A3.SS2.SSS0.Px1.p1.m4.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="A3.SS2.SSS0.Px1.p1.m4.1">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="1" role="NUMBER" xml:id="A3.SS2.SSS0.Px1.p1.m4.2">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">H</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">W</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, given by</p>
          <equation xml:id="A3.Ex7">
            <Math mode="display" tex="{\bm{G}}_{i,j}=\begin{cases}({\bm{x}}_{i}\sim{\bm{x}}_{j}),\;\;i\neq j\\&#10;0,\;\;\;\;\;\;\;\;\;\;\;\;\;\;\;i=j\end{cases}," text="G _ (list@(i, j)) = cases@(list@(x _ i similar-to x _ j, i) not-equals j, [otherwise], list@(0, i) = j, [otherwise])" xml:id="A3.Ex7.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A3.Ex7.m1.5"/>
                  <XMWrap>
                    <XMApp xml:id="A3.Ex7.m1.5">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A3.Ex7.m1.3"/>
                            <XMRef idref="A3.Ex7.m1.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex7.m1.3">i</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex7.m1.4">j</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="cases"/>
                          <XMRef idref="A3.Ex7.m1.1"/>
                          <XMText><text font="italic">otherwise</text></XMText>
                          <XMRef idref="A3.Ex7.m1.2"/>
                          <XMText><text font="italic">otherwise</text></XMText>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">{</XMTok>
                          <XMArray>
                            <XMRow>
                              <XMCell align="left">
                                <XMApp xml:id="A3.Ex7.m1.1">
                                  <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A3.Ex7.m1.1.2"/>
                                      <XMRef idref="A3.Ex7.m1.1.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMDual xml:id="A3.Ex7.m1.1.2">
                                        <XMRef idref="A3.Ex7.m1.1.2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex7.m1.1.2.1">
                                            <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok role="PUNCT" rpadding="5.6pt">,</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex7.m1.1.1">i</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                </XMApp>
                              </XMCell>
                              <XMCell/>
                            </XMRow>
                            <XMRow>
                              <XMCell align="left">
                                <XMApp xml:id="A3.Ex7.m1.2">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A3.Ex7.m1.2.1"/>
                                      <XMRef idref="A3.Ex7.m1.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok meaning="0" role="NUMBER" xml:id="A3.Ex7.m1.2.1">0</XMTok>
                                      <XMTok role="PUNCT" rpadding="41.7pt">,</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex7.m1.2.2">i</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                </XMApp>
                              </XMCell>
                              <XMCell/>
                            </XMRow>
                          </XMArray>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>where the <Math mode="inline" tex="\sim" text="similar-to" xml:id="A3.SS2.SSS0.Px1.p1.m5">
              <XMath>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
              </XMath>
            </Math> operator returns <Math mode="inline" tex="1" text="1" xml:id="A3.SS2.SSS0.Px1.p1.m6">
              <XMath>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMath>
            </Math> if its two arguments are positively related (i.e., correspond to different views of the same sample).
We also define the matrix of <text font="italic">embeddings</text> obtained from a model <Math mode="inline" tex="f_{\theta}(\cdot)" text="f _ theta * cdot" xml:id="A3.SS2.SSS0.Px1.p1.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A3.SS2.SSS0.Px1.p1.m7.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok name="cdot" role="MULOP" xml:id="A3.SS2.SSS0.Px1.p1.m7.1">⋅</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> as</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx7">
            <equation labels="LABEL:eq:embedding" xml:id="A3.E11">
              <tags>
                <tag>(11)</tag>
                <tag role="autoref">Equation 11</tag>
                <tag role="refnum">11</tag>
              </tags>
              <MathFork>
                <Math tex="\displaystyle{\bm{Z}}\triangleq[{\bm{z}}_{1},\dots,{\bm{z}}_{N}]^{T}\in\mathbb%&#10;{R}^{N\times D}\;\;\text{ with }\;{\bm{z}}_{n}\triangleq f_{\theta}({\bm{x}}_{%&#10;n})." text="Z triangleq (list@(z _ 1, dots, z _ N)) ^ T element-of ℝ ^ (N * D) * [ with ] * z _ n triangleq f _ theta * x _ n" xml:id="A3.E11.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.E11.m2.2"/>
                      <XMWrap>
                        <XMApp xml:id="A3.E11.m2.2">
                          <XMTok meaning="multirelation"/>
                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                          <XMTok name="triangleq" role="RELOP">≜</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A3.E11.m2.2.1"/>
                                <XMRef idref="A3.E11.m2.1"/>
                                <XMRef idref="A3.E11.m2.2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="A3.E11.m2.2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok name="dots" role="ID" xml:id="A3.E11.m2.1">…</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A3.E11.m2.2.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp rpadding="5.6pt">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok role="UNKNOWN">ℝ</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMText rpadding="2.8pt"> with </XMText>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok name="triangleq" role="RELOP">≜</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">f</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A3.E11.m2.2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A3.E11.m2.2.3">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle{\bm{Z}}\triangleq[{\bm{z}}_{1},\dots,{\bm{z}}_{N}]^{T}\in\mathbb%&#10;{R}^{N\times D}\;\;\text{ with }\;{\bm{z}}_{n}\triangleq f_{\theta}({\bm{x}}_{%&#10;n})." text="Z triangleq (list@(z _ 1, dots, z _ N)) ^ T element-of ℝ ^ (N * D) * [ with ] * z _ n triangleq f _ theta * x _ n" xml:id="A3.E11.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.E11.m1.2"/>
                          <XMWrap>
                            <XMApp xml:id="A3.E11.m1.2">
                              <XMTok meaning="multirelation"/>
                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              <XMTok name="triangleq" role="RELOP">≜</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="A3.E11.m1.2.1"/>
                                    <XMRef idref="A3.E11.m1.1"/>
                                    <XMRef idref="A3.E11.m1.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMApp xml:id="A3.E11.m1.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok name="dots" role="ID" xml:id="A3.E11.m1.1">…</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A3.E11.m1.2.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp rpadding="5.6pt">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok role="UNKNOWN">ℝ</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMText rpadding="2.8pt"> with </XMText>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok name="triangleq" role="RELOP">≜</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A3.E11.m1.2.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.E11.m1.2.3">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>Now we are ready to present our first equivalence relations for the VICReg and SimCLR methods.
The VICReg loss <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite>, which is a function of <Math mode="inline" tex="{\bm{X}}" text="X" xml:id="A3.SS2.SSS0.Px1.p1.m8">
              <XMath>
                <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="{\bm{G}}" text="G" xml:id="A3.SS2.SSS0.Px1.p1.m9">
              <XMath>
                <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
              </XMath>
            </Math>, can be defined as</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx8">
            <equation xml:id="A3.Ex8">
              <MathFork>
                <Math tex="\displaystyle\mathcal{L}=\alpha\sum_{k=1}^{K}\max\left(0,1-\sqrt{\mathrm{Cov}(%&#10;{\bm{Z}})_{k,k}}\right)+\beta\sum_{k=1}^{K}\sum_{\begin{subarray}{c}\ell=1\\&#10;\ell\not=k\end{subarray}}^{K}\mathrm{Cov}({\bm{Z}})^{2}_{k,\ell}+\frac{\gamma}%&#10;{N}\sum_{i=1}^{N}\sum_{j=1}^{N}({\bm{G}})_{i,j}\|{\bm{z}}_{i}-{\bm{z}}_{j}\|_{%&#10;2}^{2}," text="L = alpha * ((sum _ (k = 1)) ^ K)@(maximum@(0, 1 - square-root@(Cov * Z _ (list@(k, k))))) + beta * ((sum _ (k = 1)) ^ K)@(((sum _ (list@(Array[[ell = 1], [ell not-equals k]]))) ^ K)@(Cov * (Z ^ 2) _ (list@(k, ell)))) + (gamma / N) * ((sum _ (i = 1)) ^ N)@(((sum _ (j = 1)) ^ N)@(G _ (list@(i, j)) * ((norm@(z _ i - z _ j)) _ 2) ^ 2))" xml:id="A3.Ex8.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.Ex8.m3.12"/>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex8.m3.12">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A3.Ex8.m3.8"/>
                                    <XMRef idref="A3.Ex8.m3.9"/>
                                    <XMRef idref="A3.Ex8.m3.12.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="A3.Ex8.m3.8">max</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMTok meaning="0" role="NUMBER" xml:id="A3.Ex8.m3.9">0</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A3.Ex8.m3.12.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMApp>
                                          <XMTok meaning="square-root"/>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok role="UNKNOWN">Cov</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMDual>
                                                <XMRef idref="A3.Ex8.m3.3"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex8.m3.3">Z</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="A3.Ex8.m3.1"/>
                                                  <XMRef idref="A3.Ex8.m3.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m3.1">k</XMTok>
                                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m3.2">k</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A3.Ex8.m2.1.mf"/>
                                        </XMApp>
                                        <XMArray rowsep="0pt" xml:id="A3.Ex8.m2.1.mf">
                                          <XMRow>
                                            <XMCell align="center">
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                            </XMCell>
                                          </XMRow>
                                          <XMRow>
                                            <XMCell align="center">
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="not-equals" name="not-=" role="RELOP">≠</XMTok>
                                                <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMCell>
                                          </XMRow>
                                        </XMArray>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN">Cov</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMRef idref="A3.Ex8.m3.10"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex8.m3.10">Z</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A3.Ex8.m3.4"/>
                                          <XMRef idref="A3.Ex8.m3.5"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m3.4">k</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok fontsize="70%" name="ell" role="UNKNOWN" xml:id="A3.Ex8.m3.5">ℓ</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMRef idref="A3.Ex8.m3.11"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex8.m3.11">G</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A3.Ex8.m3.6"/>
                                          <XMRef idref="A3.Ex8.m3.7"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m3.6">i</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m3.7">j</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="norm"/>
                                            <XMRef idref="A3.Ex8.m3.12.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="||" role="OPEN">‖</XMTok>
                                            <XMApp xml:id="A3.Ex8.m3.12.2">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok name="||" role="CLOSE">‖</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\mathcal{L}=" text="L = absent" xml:id="A3.Ex8.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                          <XMTok meaning="absent"/>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\alpha\sum_{k=1}^{K}\max\left(0,1-\sqrt{\mathrm{Cov}({\bm{Z}})_{k%&#10;,k}}\right)+\beta\sum_{k=1}^{K}\sum_{\begin{subarray}{c}\ell=1\\&#10;\ell\not=k\end{subarray}}^{K}\mathrm{Cov}({\bm{Z}})^{2}_{k,\ell}+\frac{\gamma}%&#10;{N}\sum_{i=1}^{N}\sum_{j=1}^{N}({\bm{G}})_{i,j}\|{\bm{z}}_{i}-{\bm{z}}_{j}\|_{%&#10;2}^{2}," text="alpha * ((sum _ (k = 1)) ^ K)@(maximum@(0, 1 - square-root@(Cov * Z _ (list@(k, k))))) + beta * ((sum _ (k = 1)) ^ K)@(((sum _ (list@(Array[[ell = 1], [ell not-equals k]]))) ^ K)@(Cov * (Z ^ 2) _ (list@(k, ell)))) + (gamma / N) * ((sum _ (i = 1)) ^ N)@(((sum _ (j = 1)) ^ N)@(G _ (list@(i, j)) * ((norm@(z _ i - z _ j)) _ 2) ^ 2))" xml:id="A3.Ex8.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.Ex8.m2.13"/>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex8.m2.13">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A3.Ex8.m2.9"/>
                                      <XMRef idref="A3.Ex8.m2.10"/>
                                      <XMRef idref="A3.Ex8.m2.13.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid" xml:id="A3.Ex8.m2.9">max</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                                        <XMTok meaning="0" role="NUMBER" xml:id="A3.Ex8.m2.10">0</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A3.Ex8.m2.13.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                          <XMApp>
                                            <XMTok meaning="square-root"/>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok role="UNKNOWN">Cov</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                <XMDual>
                                                  <XMRef idref="A3.Ex8.m2.4"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex8.m2.4">Z</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="list"/>
                                                    <XMRef idref="A3.Ex8.m2.2"/>
                                                    <XMRef idref="A3.Ex8.m2.3"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m2.2">k</XMTok>
                                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m2.3">k</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A3.Ex8.m2.1"/>
                                          </XMApp>
                                          <XMArray rowsep="0pt" xml:id="A3.Ex8.m2.1">
                                            <XMRow>
                                              <XMCell align="center">
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                              </XMCell>
                                            </XMRow>
                                            <XMRow>
                                              <XMCell align="center">
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="not-equals" name="not-=" role="RELOP">≠</XMTok>
                                                  <XMTok fontsize="70%" name="ell" role="UNKNOWN">ℓ</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                              </XMCell>
                                            </XMRow>
                                          </XMArray>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok role="UNKNOWN">Cov</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMDual>
                                            <XMRef idref="A3.Ex8.m2.11"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex8.m2.11">Z</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A3.Ex8.m2.5"/>
                                            <XMRef idref="A3.Ex8.m2.6"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m2.5">k</XMTok>
                                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                            <XMTok fontsize="70%" name="ell" role="UNKNOWN" xml:id="A3.Ex8.m2.6">ℓ</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMRef idref="A3.Ex8.m2.12"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex8.m2.12">G</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A3.Ex8.m2.7"/>
                                            <XMRef idref="A3.Ex8.m2.8"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m2.7">i</XMTok>
                                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex8.m2.8">j</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="norm"/>
                                              <XMRef idref="A3.Ex8.m2.13.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok name="||" role="OPEN">‖</XMTok>
                                              <XMApp xml:id="A3.Ex8.m2.13.2">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok name="||" role="CLOSE">‖</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p><!--  %Reference to an equation, lower-case. -->but this desired result relies on the simplification employed in equation <ref labelref="LABEL:eq:VICR2"/>.
To prove our statement, we first remind the reader of a common result that we will heavily rely on: the decomposition of the covariance matrix into within- and between-cluster covariance matrices. Let us assume for simplicity that <Math mode="inline" tex="{\bm{Z}}" text="Z" xml:id="A3.SS2.SSS0.Px1.p1.m10">
              <XMath>
                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
              </XMath>
            </Math> is already centered. We can now decompose the covariance into</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx9">
            <equation xml:id="A3.Ex9">
              <MathFork>
                <Math tex="\displaystyle\mathrm{Cov}({\bm{Z}})=\frac{1}{N}{\bm{Z}}^{T}{\bm{H}}{\bm{Z}}=%&#10;\frac{1}{N}\left({\bm{Z}}^{T}{\bm{G}}{\bm{Z}}+{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){%&#10;\bm{Z}}\right)," text="Cov * Z = (1 / N) * Z ^ T * H * Z = (1 / N) * (Z ^ T * G * Z + Z ^ T * (I - G) * Z)" xml:id="A3.Ex9.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.Ex9.m3.2"/>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex9.m3.2">
                          <XMTok meaning="multirelation"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN">Cov</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex9.m3.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex9.m3.1">Z</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                            </XMApp>
                            <XMTok font="bold italic" role="UNKNOWN">H</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                          </XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A3.Ex9.m3.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex9.m3.2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex9.m3.2.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.Ex9.m3.2.1.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\mathrm{Cov}({\bm{Z}})=" text="Cov * Z = absent" xml:id="A3.Ex9.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN">Cov</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex9.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex9.m1.1">Z</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok meaning="absent"/>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\frac{1}{N}{\bm{Z}}^{T}{\bm{H}}{\bm{Z}}=\frac{1}{N}\left({\bm{Z}}%&#10;^{T}{\bm{G}}{\bm{Z}}+{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right)," text="(1 / N) * Z ^ T * H * Z = (1 / N) * (Z ^ T * G * Z + Z ^ T * (I - G) * Z)" xml:id="A3.Ex9.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.Ex9.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex9.m2.1">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                </XMApp>
                                <XMTok font="bold italic" role="UNKNOWN">H</XMTok>
                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A3.Ex9.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A3.Ex9.m2.1.1">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="A3.Ex9.m2.1.1.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A3.Ex9.m2.1.1.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where two terms are now the <text font="italic">between cluster</text> and <text font="italic">within cluster</text> covariances, with <Math mode="inline" tex="{\bm{H}}" text="H" xml:id="A3.SS2.SSS0.Px1.p1.m11">
              <XMath>
                <XMTok font="bold italic" role="UNKNOWN">H</XMTok>
              </XMath>
            </Math> the centering matrix defined by <Math mode="inline" tex="{\bm{I}}-\mathbf{1}_{N}\mathbf{1}_{N}^{T}/N" text="I - (1 _ N * (1 _ N) ^ T) / N" xml:id="A3.SS2.SSS0.Px1.p1.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold" meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.
Let’s first consider the LHS of the VICReg loss to simplify it into</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx10">
            <equation xml:id="A3.Ex10">
              <MathFork>
                <Math tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}=%&#10;\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}+\frac{1}{N}{\bm{Z}}^{T}({\bm{I}%&#10;}-{\bm{G}}){\bm{Z}}-{\bm{I}}\right\|_{F}^{2}" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 = ((norm@(((1 / N) * Z ^ T * G * Z + (1 / N) * Z ^ T * (I - G) * Z) - I)) _ F) ^ 2" xml:id="A3.Ex10.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="norm"/>
                              <XMRef idref="A3.Ex10.m3.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">‖</XMTok>
                              <XMApp xml:id="A3.Ex10.m3.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="norm"/>
                              <XMRef idref="A3.Ex10.m3.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">‖</XMTok>
                              <XMApp xml:id="A3.Ex10.m3.2">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex10.m3.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.Ex10.m3.2.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}=" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 = absent" xml:id="A3.Ex10.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex10.m1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex10.m1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok meaning="absent"/>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}+\frac{1}{N}{\bm{Z}%&#10;}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}-{\bm{I}}\right\|_{F}^{2}" text="((norm@(((1 / N) * Z ^ T * G * Z + (1 / N) * Z ^ T * (I - G) * Z) - I)) _ F) ^ 2" xml:id="A3.Ex10.m2">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="A3.Ex10.m2.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                <XMApp xml:id="A3.Ex10.m2.1">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex10.m2.1.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex10.m2.1.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex11">
              <MathFork>
                <Math tex="\displaystyle=\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_%&#10;{F}^{2}+\left\|\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right\|_{F}^%&#10;{2}" text="absent = ((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + ((norm@((1 / N) * Z ^ T * (I - G) * Z)) _ F) ^ 2" xml:id="A3.Ex11.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="A3.Ex11.m3.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                <XMApp xml:id="A3.Ex11.m3.1">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="A3.Ex11.m3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                <XMApp xml:id="A3.Ex11.m3.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex11.m3.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex11.m3.2.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A3.Ex11.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{%&#10;F}^{2}+\left\|\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right\|_{F}^{2}" text="((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + ((norm@((1 / N) * Z ^ T * (I - G) * Z)) _ F) ^ 2" xml:id="A3.Ex11.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex11.m2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex11.m2.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex11.m2.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex11.m2.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex11.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.Ex11.m2.2.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex12">
              <MathFork>
                <Math tex="\displaystyle\hskip 128.0374pt+\frac{2}{N}Tr\left({\bm{Z}}^{T}({\bm{I}}-{\bm{G%&#10;}}){\bm{Z}}(\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}})\right)" text="+ (2 / N) * T * r * Z ^ T * (I - G) * Z * ((1 / N) * Z ^ T * G * Z - I)" xml:id="A3.Ex12.m2">
                  <XMath>
                    <XMApp>
                      <XMTok lpadding="128.0pt" meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">T</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMDual>
                          <XMRef idref="A3.Ex12.m2.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A3.Ex12.m2.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.Ex12.m2.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.Ex12.m2.1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              <XMDual>
                                <XMRef idref="A3.Ex12.m2.1.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.Ex12.m2.1.2">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle\hskip 128.0374pt+\frac{2}{N}Tr\left({\bm{Z}}^{T}({\bm{I}}-{\bm{G%&#10;}}){\bm{Z}}(\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}})\right)" text="+ (2 / N) * T * r * Z ^ T * (I - G) * Z * ((1 / N) * Z ^ T * G * Z - I)" xml:id="A3.Ex12.m1">
                      <XMath>
                        <XMApp>
                          <XMTok lpadding="128.0pt" meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex12.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex12.m1.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex12.m1.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex12.m1.1.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  <XMDual>
                                    <XMRef idref="A3.Ex12.m1.1.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex12.m1.1.2">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                          </XMApp>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex13">
              <MathFork>
                <Math tex="\displaystyle=\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_%&#10;{F}^{2}+\left\|\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right\|_{F}^%&#10;{2}-\frac{2}{N}Tr\left({\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right)" text="absent = (((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + ((norm@((1 / N) * Z ^ T * (I - G) * Z)) _ F) ^ 2) - (2 / N) * T * r * Z ^ T * (I - G) * Z" xml:id="A3.Ex13.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex13.m3.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex13.m3.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex13.m3.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex13.m3.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex13.m3.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.Ex13.m3.2.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMDual>
                            <XMRef idref="A3.Ex13.m3.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="A3.Ex13.m3.3">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A3.Ex13.m3.3.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.Ex13.m3.3.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A3.Ex13.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{%&#10;F}^{2}+\left\|\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right\|_{F}^{%&#10;2}-\frac{2}{N}Tr\left({\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right)" text="(((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + ((norm@((1 / N) * Z ^ T * (I - G) * Z)) _ F) ^ 2) - (2 / N) * T * r * Z ^ T * (I - G) * Z" xml:id="A3.Ex13.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="A3.Ex13.m2.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                    <XMApp xml:id="A3.Ex13.m2.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="A3.Ex13.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                    <XMApp xml:id="A3.Ex13.m2.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex13.m2.2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex13.m2.2.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex13.m2.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex13.m2.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex13.m2.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex13.m2.3.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex14">
              <MathFork>
                <Math tex="\displaystyle\hskip 156.49014pt+\frac{2}{N^{2}}Tr\left({\bm{Z}}^{T}({\bm{I}}-{%&#10;\bm{G}}){\bm{Z}}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}\right)" text="+ (2 / N ^ 2) * T * r * Z ^ T * (I - G) * Z * Z ^ T * G * Z" xml:id="A3.Ex14.m2">
                  <XMath>
                    <XMApp>
                      <XMTok lpadding="156.5pt" meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">T</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMDual>
                          <XMRef idref="A3.Ex14.m2.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A3.Ex14.m2.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.Ex14.m2.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A3.Ex14.m2.1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                              </XMApp>
                              <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle\hskip 156.49014pt+\frac{2}{N^{2}}Tr\left({\bm{Z}}^{T}({\bm{I}}-{%&#10;\bm{G}}){\bm{Z}}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}\right)" text="+ (2 / N ^ 2) * T * r * Z ^ T * (I - G) * Z * Z ^ T * G * Z" xml:id="A3.Ex14.m1">
                      <XMath>
                        <XMApp>
                          <XMTok lpadding="156.5pt" meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex14.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex14.m1.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex14.m1.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex14.m1.1.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex15">
              <MathFork>
                <Math tex="\displaystyle=\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_%&#10;{F}^{2}+\sum_{i}\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){%&#10;\bm{Z}}\right)\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}%&#10;){\bm{Z}}\right)-2\right]" text="absent = ((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z * delimited-[]@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 2))" xml:id="A3.Ex15.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="A3.Ex15.m2.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                <XMApp xml:id="A3.Ex15.m2.1">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A3.Ex15.m2.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex15.m2.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex15.m2.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex15.m2.2.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A3.Ex15.m2.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">[</XMTok>
                                <XMApp xml:id="A3.Ex15.m2.3">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex15.m2.3.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                                        <XMApp xml:id="A3.Ex15.m2.3.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A3.Ex15.m2.3.1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex15.m2.3.1.1">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_%&#10;{F}^{2}+\sum_{i}\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){%&#10;\bm{Z}}\right)\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}%&#10;){\bm{Z}}\right)-2\right]" text="absent = ((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z * delimited-[]@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 2))" xml:id="A3.Ex15.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="A3.Ex15.m1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                    <XMApp xml:id="A3.Ex15.m1.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A3.Ex15.m1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A3.Ex15.m1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex15.m1.2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex15.m1.2.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A3.Ex15.m1.3"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">[</XMTok>
                                    <XMApp xml:id="A3.Ex15.m1.3">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="A3.Ex15.m1.3.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                                            <XMApp xml:id="A3.Ex15.m1.3.1">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMRef idref="A3.Ex15.m1.3.1.1"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A3.Ex15.m1.3.1.1">
                                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex16">
              <MathFork>
                <Math tex="\displaystyle+\frac{2}{N^{2}}Tr\left({\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}{%&#10;\bm{Z}}^{T}{\bm{G}}{\bm{Z}}\right)," text="+ (2 / N ^ 2) * T * r * Z ^ T * (I - G) * Z * Z ^ T * G * Z" xml:id="A3.Ex16.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.Ex16.m2.1"/>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex16.m2.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex16.m2.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex16.m2.1.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex16.m2.1.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex16.m2.1.1.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle+\frac{2}{N^{2}}Tr\left({\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}{%&#10;\bm{Z}}^{T}{\bm{G}}{\bm{Z}}\right)," text="+ (2 / N ^ 2) * T * r * Z ^ T * (I - G) * Z * Z ^ T * G * Z" xml:id="A3.Ex16.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.Ex16.m1.1"/>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex16.m1.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMDual>
                                  <XMRef idref="A3.Ex16.m1.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A3.Ex16.m1.1.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex16.m1.1.1.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex16.m1.1.1.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>where <Math mode="inline" tex="\lambda_{i}({\bm{M}})" text="lambda _ i * M" xml:id="A3.SS2.SSS0.Px1.p1.m13">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A3.SS2.SSS0.Px1.p1.m13.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m13.1">M</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> returns the <Math mode="inline" tex="i^{\rm th}" text="i ^ th" xml:id="A3.SS2.SSS0.Px1.p1.m14">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">th</XMTok>
                </XMApp>
              </XMath>
            </Math> eigenvalue of its matrix argument <Math mode="inline" tex="{\bm{M}}" text="M" xml:id="A3.SS2.SSS0.Px1.p1.m15">
              <XMath>
                <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
              </XMath>
            </Math>; the last equality is obtained by noticing that <Math mode="inline" tex="\|{\bm{M}}\|_{F}^{2}=\sum_{i}\lambda_{i}({\bm{M}})^{2}" text="((norm@(M)) _ F) ^ 2 = (sum _ i)@(lambda _ i * M ^ 2)" xml:id="A3.SS2.SSS0.Px1.p1.m16">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="norm"/>
                          <XMRef idref="A3.SS2.SSS0.Px1.p1.m16.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="||" role="OPEN">‖</XMTok>
                          <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m16.1">M</XMTok>
                          <XMTok name="||" role="CLOSE">‖</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMRef idref="A3.SS2.SSS0.Px1.p1.m16.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m16.2">M</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> and that for a symmetric positive semidefinite matrix, <Math mode="inline" tex="Tr({\bm{M}})=\sum_{i}\lambda_{i}({\bm{M}})" text="T * r * M = (sum _ i)@(lambda _ i * M)" xml:id="A3.SS2.SSS0.Px1.p1.m17">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMDual>
                      <XMRef idref="A3.SS2.SSS0.Px1.p1.m17.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m17.1">M</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A3.SS2.SSS0.Px1.p1.m17.2"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m17.2">M</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>; we thus obtain the following upper and lower bounds</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx11">
            <equation xml:id="A3.Ex17">
              <MathFork>
                <Math tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}%&#10;\leq\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}+%&#10;\sum_{i}\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right)" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 &lt;= ((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z)" xml:id="A3.Ex17.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="norm"/>
                              <XMRef idref="A3.Ex17.m3.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">‖</XMTok>
                              <XMApp xml:id="A3.Ex17.m3.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="A3.Ex17.m3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                <XMApp xml:id="A3.Ex17.m3.2">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A3.Ex17.m3.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex17.m3.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex17.m3.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex17.m3.3.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}\leq" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 &lt;= absent" xml:id="A3.Ex17.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex17.m1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex17.m1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok meaning="absent"/>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{%&#10;F}^{2}+\sum_{i}\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm%&#10;{Z}}\right)" text="((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z)" xml:id="A3.Ex17.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex17.m2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex17.m2.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.Ex17.m2.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                                  <XMApp xml:id="A3.Ex17.m2.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex17.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.Ex17.m2.2.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex18">
              <MathFork>
                <Math tex="\displaystyle\times\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{%&#10;\bm{G}}){\bm{Z}}\right)-2+\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm%&#10;{Z}}\right)\right]" text="absent * delimited-[]@((lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 2) + lambda _ i * (1 / N) * Z ^ T * G * Z)" xml:id="A3.Ex18.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">×</XMTok>
                      <XMTok meaning="absent"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="A3.Ex18.m2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">[</XMTok>
                          <XMApp xml:id="A3.Ex18.m2.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A3.Ex18.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A3.Ex18.m2.1.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex18.m2.1.1.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex18.m2.1.1.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.Ex18.m2.1.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                                  <XMApp xml:id="A3.Ex18.m2.1.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle\times\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{%&#10;\bm{G}}){\bm{Z}}\right)-2+\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm%&#10;{Z}}\right)\right]" text="absent * delimited-[]@((lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 2) + lambda _ i * (1 / N) * Z ^ T * G * Z)" xml:id="A3.Ex18.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">×</XMTok>
                          <XMTok meaning="absent"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="A3.Ex18.m1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">[</XMTok>
                              <XMApp xml:id="A3.Ex18.m1.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex18.m1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                                        <XMApp xml:id="A3.Ex18.m1.1.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A3.Ex18.m1.1.1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex18.m1.1.1.1">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex18.m1.1.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMApp xml:id="A3.Ex18.m1.1.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex19">
              <MathFork>
                <Math tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}%&#10;\geq\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}+%&#10;\sum_{i}\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}}\right)" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 &gt;= ((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z)" xml:id="A3.Ex19.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="norm"/>
                              <XMRef idref="A3.Ex19.m3.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">‖</XMTok>
                              <XMApp xml:id="A3.Ex19.m3.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="norm"/>
                                <XMRef idref="A3.Ex19.m3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                <XMApp xml:id="A3.Ex19.m3.2">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A3.Ex19.m3.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A3.Ex19.m3.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex19.m3.3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex19.m3.3.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}\geq" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 &gt;= absent" xml:id="A3.Ex19.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex19.m1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex19.m1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok meaning="absent"/>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{%&#10;F}^{2}+\sum_{i}\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm%&#10;{Z}}\right)" text="((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z)" xml:id="A3.Ex19.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex19.m2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex19.m2.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.Ex19.m2.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                                  <XMApp xml:id="A3.Ex19.m2.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex19.m2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.Ex19.m2.2.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex20">
              <MathFork>
                <Math tex="\displaystyle\times\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{%&#10;\bm{G}}){\bm{Z}}\right)-2+\lambda_{K+1-i}\left(\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}%&#10;{\bm{Z}}\right)\right]" text="absent * delimited-[]@((lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 2) + lambda _ ((K + 1) - i) * (1 / N) * Z ^ T * G * Z)" xml:id="A3.Ex20.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">×</XMTok>
                      <XMTok meaning="absent"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="A3.Ex20.m2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">[</XMTok>
                          <XMApp xml:id="A3.Ex20.m2.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A3.Ex20.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A3.Ex20.m2.1.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex20.m2.1.1.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex20.m2.1.1.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A3.Ex20.m2.1.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                                  <XMApp xml:id="A3.Ex20.m2.1.2">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle\times\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{%&#10;\bm{G}}){\bm{Z}}\right)-2+\lambda_{K+1-i}\left(\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}%&#10;{\bm{Z}}\right)\right]" text="absent * delimited-[]@((lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 2) + lambda _ ((K + 1) - i) * (1 / N) * Z ^ T * G * Z)" xml:id="A3.Ex20.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">×</XMTok>
                          <XMTok meaning="absent"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="A3.Ex20.m1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">[</XMTok>
                              <XMApp xml:id="A3.Ex20.m1.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A3.Ex20.m1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                                        <XMApp xml:id="A3.Ex20.m1.1.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A3.Ex20.m1.1.1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex20.m1.1.1.1">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex20.m1.1.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMApp xml:id="A3.Ex20.m1.1.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A3.Ex21">
              <MathFork>
                <Math tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}%&#10;\geq\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}+%&#10;\sum_{i}\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{%&#10;Z}}\right)-1\right]^{2}-K," text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 &gt;= (((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@((delimited-[]@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 1)) ^ 2)) - K" xml:id="A3.Ex21.m3">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.Ex21.m3.1"/>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex21.m3.1">
                          <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex21.m3.1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex21.m3.1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="norm"/>
                                      <XMRef idref="A3.Ex21.m3.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                      <XMApp xml:id="A3.Ex21.m3.1.2">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                          </XMApp>
                                          <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="delimited-[]"/>
                                      <XMRef idref="A3.Ex21.m3.1.3"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">[</XMTok>
                                      <XMApp xml:id="A3.Ex21.m3.1.3">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A3.Ex21.m3.1.3.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                                              <XMApp xml:id="A3.Ex21.m3.1.3.1">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="A3.Ex21.m3.1.3.1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A3.Ex21.m3.1.3.1.1">
                                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                      <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                                      <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                                <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">]</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">K</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}\geq" text="((norm@((1 / N) * Z ^ T * Z - I)) _ F) ^ 2 &gt;= absent" xml:id="A3.Ex21.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="A3.Ex21.m1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                  <XMApp xml:id="A3.Ex21.m1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok meaning="absent"/>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{%&#10;F}^{2}+\sum_{i}\left[\lambda_{i}\left(\frac{1}{N}{\bm{Z}}^{T}({\bm{I}}-{\bm{G}%&#10;}){\bm{Z}}\right)-1\right]^{2}-K," text="(((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2 + (sum _ i)@((delimited-[]@(lambda _ i * (1 / N) * Z ^ T * (I - G) * Z - 1)) ^ 2)) - K" xml:id="A3.Ex21.m2">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.Ex21.m2.1"/>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex21.m2.1">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="A3.Ex21.m2.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">‖</XMTok>
                                        <XMApp xml:id="A3.Ex21.m2.1.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                            </XMApp>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                          </XMApp>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-[]"/>
                                        <XMRef idref="A3.Ex21.m2.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">[</XMTok>
                                        <XMApp xml:id="A3.Ex21.m2.1.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMRef idref="A3.Ex21.m2.1.2.1"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                                <XMApp xml:id="A3.Ex21.m2.1.2.1">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMApp>
                                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                                  </XMApp>
                                                  <XMDual>
                                                    <XMRef idref="A3.Ex21.m2.1.2.1.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A3.Ex21.m2.1.2.1.1">
                                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>from which is becomes clear that to minimize the variance+covariance terms, one must either maximize the intra-cluster variance, or the inter-cluster variance, or both. However, the intra-cluster variance is exactly the invariance term since it can be expressed as</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx12">
            <equation xml:id="A3.Ex22">
              <MathFork>
                <Math tex="\displaystyle\sum_{j=1}^{N}({\bm{G}})_{i,j}\|{\bm{z}}_{i}-{\bm{z}}_{j}\|_{2}^{%&#10;2}=2Tr({\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}})," text="((sum _ (j = 1)) ^ N)@(G _ (list@(i, j)) * ((norm@(z _ i - z _ j)) _ 2) ^ 2) = 2 * T * r * Z ^ T * (I - G) * Z" xml:id="A3.Ex22.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.Ex22.m2.4"/>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex22.m2.4">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMRef idref="A3.Ex22.m2.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex22.m2.3">G</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="A3.Ex22.m2.1"/>
                                    <XMRef idref="A3.Ex22.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex22.m2.1">i</XMTok>
                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex22.m2.2">j</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="norm"/>
                                      <XMRef idref="A3.Ex22.m2.4.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok name="||" role="OPEN">‖</XMTok>
                                      <XMApp xml:id="A3.Ex22.m2.4.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok name="||" role="CLOSE">‖</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMDual>
                              <XMRef idref="A3.Ex22.m2.4.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A3.Ex22.m2.4.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A3.Ex22.m2.4.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A3.Ex22.m2.4.2.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\sum_{j=1}^{N}({\bm{G}})_{i,j}\|{\bm{z}}_{i}-{\bm{z}}_{j}\|_{2}^{%&#10;2}=2Tr({\bm{Z}}^{T}({\bm{I}}-{\bm{G}}){\bm{Z}})," text="((sum _ (j = 1)) ^ N)@(G _ (list@(i, j)) * ((norm@(z _ i - z _ j)) _ 2) ^ 2) = 2 * T * r * Z ^ T * (I - G) * Z" xml:id="A3.Ex22.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.Ex22.m1.4"/>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex22.m1.4">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMRef idref="A3.Ex22.m1.3"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.Ex22.m1.3">G</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="A3.Ex22.m1.1"/>
                                        <XMRef idref="A3.Ex22.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex22.m1.1">i</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex22.m1.2">j</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="norm"/>
                                          <XMRef idref="A3.Ex22.m1.4.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok name="||" role="OPEN">‖</XMTok>
                                          <XMApp xml:id="A3.Ex22.m1.4.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="bold italic" role="UNKNOWN">z</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok name="||" role="CLOSE">‖</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMDual>
                                  <XMRef idref="A3.Ex22.m1.4.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.Ex22.m1.4.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A3.Ex22.m1.4.2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex22.m1.4.2.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>and thus the only possible solution to minimize the invariance term while minimizing the variance+covariance is to minimize <Math mode="inline" tex="\left\|\frac{1}{N}{\bm{Z}}^{T}{\bm{G}}{\bm{Z}}-{\bm{I}}\right\|_{F}^{2}" text="((norm@((1 / N) * Z ^ T * G * Z - I)) _ F) ^ 2" xml:id="A3.SS2.SSS0.Px1.p1.m18">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="norm"/>
                        <XMRef idref="A3.SS2.SSS0.Px1.p1.m18.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">‖</XMTok>
                        <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m18.1">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                            </XMApp>
                            <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN">Z</XMTok>
                          </XMApp>
                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math> and thus we recover that VICReg’s loss corresponds to the K-means loss plus a regularizer <Math mode="inline" tex="\|\mu\mu^{T}-{\bm{I}}\|_{F}^{2}" text="((norm@(mu * mu ^ T - I)) _ F) ^ 2" xml:id="A3.SS2.SSS0.Px1.p1.m19">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="norm"/>
                        <XMRef idref="A3.SS2.SSS0.Px1.p1.m19.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="||" role="OPEN">‖</XMTok>
                        <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m19.1">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                        </XMApp>
                        <XMTok name="||" role="CLOSE">‖</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math><!--  %**** main.tex Line 725 **** --> as in</p>
          <equationgroup class="ltx_eqn_align" xml:id="A9.EGx13">
            <equation xml:id="A3.Ex23">
              <MathFork>
                <Math tex="\displaystyle\frac{\gamma}{N}\sum_{k=1}^{K}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}%&#10;\|{\bm{x}}-\mu_{k}\|_{2}^{2}+\alpha\|{\bm{M}}^{T}{\bm{M}}-{\bm{I}}\|_{F}^{2}," text="(gamma / N) * ((sum _ (k = 1)) ^ K)@((sum _ (x element-of 𝕏 _ k))@(((norm@(x - mu _ k)) _ 2) ^ 2)) + alpha * ((norm@(M ^ T * M - I)) _ F) ^ 2" xml:id="A3.Ex23.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A3.Ex23.m2.1"/>
                      <XMWrap>
                        <XMApp xml:id="A3.Ex23.m2.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="A3.Ex23.m2.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                        <XMApp xml:id="A3.Ex23.m2.1.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="A3.Ex23.m2.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="||" role="OPEN">‖</XMTok>
                                    <XMApp xml:id="A3.Ex23.m2.1.2">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                        </XMApp>
                                        <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                                      </XMApp>
                                      <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                    </XMApp>
                                    <XMTok name="||" role="CLOSE">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle\frac{\gamma}{N}\sum_{k=1}^{K}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}%&#10;\|{\bm{x}}-\mu_{k}\|_{2}^{2}+\alpha\|{\bm{M}}^{T}{\bm{M}}-{\bm{I}}\|_{F}^{2}," text="(gamma / N) * ((sum _ (k = 1)) ^ K)@((sum _ (x element-of 𝕏 _ k))@(((norm@(x - mu _ k)) _ 2) ^ 2)) + alpha * ((norm@(M ^ T * M - I)) _ F) ^ 2" xml:id="A3.Ex23.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A3.Ex23.m1.1"/>
                          <XMWrap>
                            <XMApp xml:id="A3.Ex23.m1.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                        <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="norm"/>
                                            <XMRef idref="A3.Ex23.m1.1.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="||" role="OPEN">‖</XMTok>
                                            <XMApp xml:id="A3.Ex23.m1.1.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok name="||" role="CLOSE">‖</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="A3.Ex23.m1.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                        <XMApp xml:id="A3.Ex23.m1.1.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                            </XMApp>
                                            <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                                          </XMApp>
                                          <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                                        </XMApp>
                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>with <Math mode="inline" tex="{\bm{M}}\triangleq[\mu_{1},\dots,\mu_{K}]" text="M triangleq list@(mu _ 1, dots, mu _ K)" xml:id="A3.SS2.SSS0.Px1.p1.m20">
              <XMath>
                <XMApp>
                  <XMTok name="triangleq" role="RELOP">≜</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="A3.SS2.SSS0.Px1.p1.m20.2"/>
                      <XMRef idref="A3.SS2.SSS0.Px1.p1.m20.1"/>
                      <XMRef idref="A3.SS2.SSS0.Px1.p1.m20.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m20.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="dots" role="ID" xml:id="A3.SS2.SSS0.Px1.p1.m20.1">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m20.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, and the number of centroids <Math mode="inline" tex="K" text="K" xml:id="A3.SS2.SSS0.Px1.p1.m21">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> is given by <Math mode="inline" tex="\min(\dim({\bm{z}}),rank({\bm{G}}+{\bm{I}}))" text="minimum@(dimension@(z), r * a * n * k * (G + I))" xml:id="A3.SS2.SSS0.Px1.p1.m22">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMRef idref="A3.SS2.SSS0.Px1.p1.m22.2"/>
                    <XMRef idref="A3.SS2.SSS0.Px1.p1.m22.3"/>
                    <XMRef idref="A3.SS2.SSS0.Px1.p1.m22.4"/>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post" xml:id="A3.SS2.SSS0.Px1.p1.m22.2">min</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m22.3">
                        <XMTok meaning="dimension" role="LIMITOP">dim</XMTok>
                        <XMDual>
                          <XMRef idref="A3.SS2.SSS0.Px1.p1.m22.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m22.1">z</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m22.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMTok font="italic" role="UNKNOWN">k</XMTok>
                        <XMDual>
                          <XMRef idref="A3.SS2.SSS0.Px1.p1.m22.4.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m22.4.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                              <XMTok font="bold italic" role="UNKNOWN">I</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMApp>
                </XMDual>
              </XMath>
            </Math> and the centroids are given by <Math class="ltx_math_unparsed" mode="inline" tex="\mu_{k}=\frac{1}{\langle{\bm{P}}_{.,k},\mathbf{1}\rangle}\sum_{n=1}^{N}{\bm{P}%&#10;}_{n,k}{\bm{x}}_{n}" text="mu _ k = (1 / list@(P _ [.,k], 1)) * ((sum _ (n = 1)) ^ N)@(P _ (list@(n, k)) * x _ n)" xml:id="A3.SS2.SSS0.Px1.p1.m23">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="A3.SS2.SSS0.Px1.p1.m23.2"/>
                          <XMRef idref="A3.SS2.SSS0.Px1.p1.m23.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" name="langle" role="OPEN" stretchy="false">⟨</XMTok>
                          <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m23.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            <XMArg rule="Subscript">
                              <XMTok fontsize="50%" role="PERIOD">.</XMTok>
                              <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMArg>
                          </XMApp>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="bold" fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.SS2.SSS0.Px1.p1.m23.1">1</XMTok>
                          <XMTok fontsize="70%" name="rangle" role="CLOSE" stretchy="false">⟩</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A3.SS2.SSS0.Px1.p1.m23.3"/>
                              <XMRef idref="A3.SS2.SSS0.Px1.p1.m23.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m23.3">n</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m23.4">k</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> with <Math mode="inline" tex="{\bm{G}}={\bm{P}}^{T}{\bm{D}}{\bm{P}}" text="G = P ^ T * D * P" xml:id="A3.SS2.SSS0.Px1.p1.m24">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN">G</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                    </XMApp>
                    <XMTok font="bold italic" role="UNKNOWN">D</XMTok>
                    <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, and finally <Math mode="inline" tex="{\mathbb{X}}_{k}=\{{\bm{x}}_{n}\in{\mathbb{X}}:{\bm{P}}_{n,k}&gt;0\}" text="𝕏 _ k = conditional-set@(x _ n element-of 𝕏, P _ (list@(n, k)) &gt; 0)" xml:id="A3.SS2.SSS0.Px1.p1.m25">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok role="UNKNOWN">𝕏</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="conditional-set"/>
                      <XMRef idref="A3.SS2.SSS0.Px1.p1.m25.3"/>
                      <XMRef idref="A3.SS2.SSS0.Px1.p1.m25.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m25.3">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok role="UNKNOWN">𝕏</XMTok>
                      </XMApp>
                      <XMTok name="colon" role="METARELOP">:</XMTok>
                      <XMApp xml:id="A3.SS2.SSS0.Px1.p1.m25.4">
                        <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">P</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="A3.SS2.SSS0.Px1.p1.m25.1"/>
                              <XMRef idref="A3.SS2.SSS0.Px1.p1.m25.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m25.1">n</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS2.SSS0.Px1.p1.m25.2">k</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math></p>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:proof:kmeans3" xml:id="A3.SS3">
      <tags>
        <tag>C.3</tag>
        <tag role="autoref">subsection C.3</tag>
        <tag role="refnum">C.3</tag>
        <tag role="typerefnum">§C.3</tag>
      </tags>
      <title><tag close=" ">C.3</tag>Proof of proposition <ref labelref="LABEL:prop:msn"/></title>
      <para xml:id="A3.SS3.p1">
        <p><!--  %Reference to an equation, lower-case. -->The proof is relatively straightforward and will follow the same principle as the proof showing how GMM recovers K-means. The only difference is that we will take the zero-noise limit of the MSN loss (equation <ref labelref="LABEL:eq:msn"/><!--  %Reference to an equation, lower-case. -->) instead of GMM loss (equation <ref labelref="LABEL:eq:GMM_uni"/>), and we will see that we recover a constrained version of K-means with extra constraints on the cluster distribution.
The MSN loss is defined for positive pairs <Math mode="inline" tex="{\bm{x}}_{n},{\bm{x}}_{n}^{+}" text="list@(x _ n, (x _ n) ^ +)" xml:id="A3.SS3.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A3.SS3.p1.m1.1"/>
                  <XMRef idref="A3.SS3.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A3.SS3.p1.m1.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A3.SS3.p1.m1.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and estimates the corresponding cluster posteriors <Math mode="inline" tex="{\bm{p}}_{n},{\bm{p}}_{n}^{+}" text="list@(p _ n, (p _ n) ^ +)" xml:id="A3.SS3.p1.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A3.SS3.p1.m2.1"/>
                  <XMRef idref="A3.SS3.p1.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A3.SS3.p1.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A3.SS3.p1.m2.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> via
<Math mode="inline" tex="\text{softmax}({\bm{M}}^{T}{\bm{x}}_{n}/\sigma)" text="[softmax] * ((M ^ T * x _ n) / sigma)" xml:id="A3.SS3.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMText>softmax</XMText>
                <XMDual>
                  <XMRef idref="A3.SS3.p1.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m3.1">
                      <XMTok meaning="divide" role="MULOP">/</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\text{softmax}({\bm{M}}^{T}{\bm{x}}^{+}_{n}/\sigma^{+})" text="[softmax] * ((M ^ T * (x ^ +) _ n) / sigma ^ +)" xml:id="A3.SS3.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMText>softmax</XMText>
                <XMDual>
                  <XMRef idref="A3.SS3.p1.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m4.1">
                      <XMTok meaning="divide" role="MULOP">/</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> respectively with <Math mode="inline" tex="{\bm{M}}\triangleq[\mu_{1},\dots,\mu_{K}]" text="M triangleq list@(mu _ 1, dots, mu _ K)" xml:id="A3.SS3.p1.m5">
            <XMath>
              <XMApp>
                <XMTok name="triangleq" role="RELOP">≜</XMTok>
                <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A3.SS3.p1.m5.2"/>
                    <XMRef idref="A3.SS3.p1.m5.1"/>
                    <XMRef idref="A3.SS3.p1.m5.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m5.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="dots" role="ID" xml:id="A3.SS3.p1.m5.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m5.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> as we employed in VICReg, and the two temperature parameters are commonly <Math mode="inline" tex="\sigma^{+}\gg\sigma&gt;0" text="sigma ^ + &gt;&gt; sigma &gt; 0" xml:id="A3.SS3.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                </XMApp>
                <XMTok meaning="much-greater-than" name="gg" role="RELOP">≫</XMTok>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>; this asymmetry is know as sharpening. Without loss of generality we consider the <Math mode="inline" tex="\sigma" text="sigma" xml:id="A3.SS3.p1.m7">
            <XMath>
              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
            </XMath>
          </Math>MSN loss, i.e., the MSN loss re-scaled by <Math mode="inline" tex="\sigma" text="sigma" xml:id="A3.SS3.p1.m8">
            <XMath>
              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
            </XMath>
          </Math>, this does not alter the training dynamics as the learning rate can be adapted accordingly, but will simplify our derivations below; we thus also replace <Math mode="inline" tex="\lambda" text="lambda" xml:id="A3.SS3.p1.m9">
            <XMath>
              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
            </XMath>
          </Math> with <Math mode="inline" tex="\lambda/\sigma" text="lambda / sigma" xml:id="A3.SS3.p1.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
              </XMApp>
            </XMath>
          </Math>. In this setting, we see that <Math mode="inline" tex="\text{softmax}({\bm{M}}^{T}{\bm{x}}^{+}_{n}/\sigma^{+})_{k}=\delta(k-k(n))" text="[softmax] * ((M ^ T * (x ^ +) _ n) / sigma ^ +) _ k = delta * (k - k * n)" xml:id="A3.SS3.p1.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>softmax</XMText>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMRef idref="A3.SS3.p1.m11.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A3.SS3.p1.m11.2">
                          <XMTok meaning="divide" role="MULOP">/</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">M</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                  <XMDual>
                    <XMRef idref="A3.SS3.p1.m11.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A3.SS3.p1.m11.3">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">k</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                          <XMDual>
                            <XMRef idref="A3.SS3.p1.m11.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS3.p1.m11.1">n</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> where we hereafter denote <Math content-tex="k(n)=\argmin_{c}\|\mu_{c}-{\bm{x}}_{n}^{+}\|_{2}" mode="inline" tex="k(n)=\operatorname*{arg\,min}_{c}\|\mu_{c}-{\bm{x}}_{n}^{+}\|_{2}" text="k * n = (argmin _ c)@((norm@(mu _ c - (x _ n) ^ +)) _ 2)" xml:id="A3.SS3.p1.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMDual>
                    <XMRef idref="A3.SS3.p1.m12.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS3.p1.m12.1">n</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                      <XMTok role="UNKNOWN">min</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="norm"/>
                        <XMRef idref="A3.SS3.p1.m12.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="||" role="OPEN">‖</XMTok>
                        <XMApp xml:id="A3.SS3.p1.m12.2">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok name="||" role="CLOSE">‖</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> as the cluster assignment of the positive view of <Math mode="inline" tex="{\bm{x}}_{n}" text="x _ n" xml:id="A3.SS3.p1.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %leading to the MSN loss being -->. With those notations, we can finally derive
<!--  %“begin–align*˝ 
     %MSN=“sum˙–n=1˝^–N˝“—“vx˙n-“mu˙–k(n)˝ “—˙2^2/“sigma+“text–LogSumExp˝(-“—“vx˙n-“mu˙1 “—˙2^2/“sigma,“dots,-“—“vx˙n-“mu˙K “—˙2^2/“sigma)- “lambda H(–“overline–“vp˝˝), 
     %“end–align*˝ 
     %and thus by exploiting the log-sum-exp inequalities we obtain 
     %“begin–align*˝ 
     %MSN &amp;“leq “sum˙–n=1˝^–N˝“underbrace–“—“vx˙n-“mu˙–k(n)˝ “—˙2^2/“sigma-“min(“—“vx˙n-“mu˙1 “—˙2^2/“sigma,“dots,“—“vx˙n-“mu˙K “—˙2^2/“sigma)˝˙–=0 “iff “argmin˙c “—“vx˙n-“mu˙c“—˙2=“argmin˙c“—“vx˙n^+-“mu˙c“—˙2˝- “lambda H(–“overline–“vp˝˝)+“log(K)““ 
     %&amp;“leq “sum˙–n=1˝^–N˝“—“vx˙n-“mu˙–k(n)˝ “—˙2^2/“sigma- “lambda H(–“overline–“vp˝˝)+“log(K)““ 
     %“end–align*˝ --></p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx14">
          <equation xml:id="A3.Ex24">
            <MathFork>
              <Math class="ltx_math_unparsed" tex="\displaystyle\lim_{\sigma\mapsto 0}\sigma MSN=\lim_{\sigma\mapsto 0}\left[%&#10;\frac{\sigma}{N}\sum^{N}_{n=1}H({\bm{p}}_{n}^{+},{\bm{p}}_{n})+\lambda D_{%&#10;\text{KL}}({\overline{{\bm{p}}}\ \lVert\ {\bm{p}}_{\text{prior}}})\right]" xml:id="A3.Ex24.m3">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                      <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                  <XMTok font="italic" role="UNKNOWN">M</XMTok>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                      <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="true">[</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">H</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                      <XMText><text fontsize="70%">KL</text></XMText>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp rpadding="5.0pt">
                        <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                        <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                          <XMTok font="bold italic" lpadding="5.0pt" role="UNKNOWN">p</XMTok>
                          <XMText><text fontsize="70%">prior</text></XMText>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok role="CLOSE" stretchy="true">]</XMTok>
                    </XMWrap>
                  </XMWrap>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\lim_{\sigma\mapsto 0}\sigma MSN=" text="(limit _ (sigma maps-to 0))@(sigma * M * S * N) = absent" xml:id="A3.Ex24.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                              <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                            <XMTok font="italic" role="UNKNOWN">M</XMTok>
                            <XMTok font="italic" role="UNKNOWN">S</XMTok>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok meaning="absent"/>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle\lim_{\sigma\mapsto 0}\left[\frac{\sigma}{N}\sum^{N}_{n=1}H({\bm{%&#10;p}}_{n}^{+},{\bm{p}}_{n})+\lambda D_{\text{KL}}({\overline{{\bm{p}}}\ \lVert\ %&#10;{\bm{p}}_{\text{prior}}})\right]" xml:id="A3.Ex24.m2">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                          <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">[</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">H</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" role="UNKNOWN">D</XMTok>
                          <XMText><text fontsize="70%">KL</text></XMText>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp rpadding="5.0pt">
                            <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                              <XMTok font="bold italic" lpadding="5.0pt" role="UNKNOWN">p</XMTok>
                              <XMText><text fontsize="70%">prior</text></XMText>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMTok role="CLOSE" stretchy="true">]</XMTok>
                        </XMWrap>
                      </XMWrap>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A3.Ex25">
            <MathFork>
              <Math tex="\displaystyle=\lim_{\sigma\mapsto 0}\left[-\frac{\sigma}{N}\sum_{n=1}^{N}\sum_%&#10;{k=1}^{K}\delta(k-k(n))\log\left(\text{softmax}({\bm{W}}^{T}{\bm{x}}_{n}/%&#10;\sigma)_{k}\right)\right]+\lambda\sum_{k=1}^{K}\frac{N_{k}}{N}\log\left(\frac{%&#10;N_{k}/N}{({\bm{p}}_{\rm prior})_{k}}\right)" text="absent = (limit _ (sigma maps-to 0))@(delimited-[]@(- (sigma / N) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(delta * (k - k * n) * logarithm@([softmax] * ((W ^ T * x _ n) / sigma) _ k))))) + lambda * ((sum _ (k = 1)) ^ K)@((N _ k / N) * logarithm@(N _ k / N / p _ prior _ k))" xml:id="A3.Ex25.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                            <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="delimited-[]"/>
                            <XMRef idref="A3.Ex25.m2.6"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">[</XMTok>
                            <XMApp xml:id="A3.Ex25.m2.6">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                      <XMDual>
                                        <XMRef idref="A3.Ex25.m2.6.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex25.m2.6.1">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                              <XMDual>
                                                <XMRef idref="A3.Ex25.m2.2"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex25.m2.2">n</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMDual>
                                        <XMApp>
                                          <XMRef idref="A3.Ex25.m2.3"/>
                                          <XMRef idref="A3.Ex25.m2.6.2"/>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex25.m2.3">log</XMTok>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                                            <XMApp xml:id="A3.Ex25.m2.6.2">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMText>softmax</XMText>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                <XMDual>
                                                  <XMRef idref="A3.Ex25.m2.6.2.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A3.Ex25.m2.6.2.1">
                                                      <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                      <XMApp>
                                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMApp>
                                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                          <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                                        </XMApp>
                                                        <XMApp>
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                                        </XMApp>
                                                      </XMApp>
                                                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                          </XMWrap>
                                        </XMApp>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="A3.Ex25.m2.4"/>
                                <XMRef idref="A3.Ex25.m2.5"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex25.m2.4">log</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                                  <XMApp xml:id="A3.Ex25.m2.5">
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMApp>
                                      <XMTok meaning="divide" role="MULOP">/</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                      <XMDual>
                                        <XMRef idref="A3.Ex25.m2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex25.m2.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                            <XMTok fontsize="70%" role="UNKNOWN">prior</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td/>
                <td align="left"><Math mode="inline" tex="\displaystyle=\lim_{\sigma\mapsto 0}\left[-\frac{\sigma}{N}\sum_{n=1}^{N}\sum_%&#10;{k=1}^{K}\delta(k-k(n))\log\left(\text{softmax}({\bm{W}}^{T}{\bm{x}}_{n}/%&#10;\sigma)_{k}\right)\right]+\lambda\sum_{k=1}^{K}\frac{N_{k}}{N}\log\left(\frac{%&#10;N_{k}/N}{({\bm{p}}_{\rm prior})_{k}}\right)" text="absent = (limit _ (sigma maps-to 0))@(delimited-[]@(- (sigma / N) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(delta * (k - k * n) * logarithm@([softmax] * ((W ^ T * x _ n) / sigma) _ k))))) + lambda * ((sum _ (k = 1)) ^ K)@((N _ k / N) * logarithm@(N _ k / N / p _ prior _ k))" xml:id="A3.Ex25.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                                <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A3.Ex25.m1.6"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">[</XMTok>
                                <XMApp xml:id="A3.Ex25.m1.6">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                          <XMDual>
                                            <XMRef idref="A3.Ex25.m1.6.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex25.m1.6.1">
                                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A3.Ex25.m1.2"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex25.m1.2">n</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMDual>
                                            <XMApp>
                                              <XMRef idref="A3.Ex25.m1.3"/>
                                              <XMRef idref="A3.Ex25.m1.6.2"/>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex25.m1.3">log</XMTok>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                                <XMApp xml:id="A3.Ex25.m1.6.2">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMText>softmax</XMText>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                    <XMDual>
                                                      <XMRef idref="A3.Ex25.m1.6.2.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A3.Ex25.m1.6.2.1">
                                                          <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                          <XMApp>
                                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                            <XMApp>
                                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                              <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                                            </XMApp>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                                            </XMApp>
                                                          </XMApp>
                                                          <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                              </XMWrap>
                                            </XMApp>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A3.Ex25.m1.4"/>
                                    <XMRef idref="A3.Ex25.m1.5"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex25.m1.4">log</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMApp xml:id="A3.Ex25.m1.5">
                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                        <XMApp>
                                          <XMTok meaning="divide" role="MULOP">/</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMDual>
                                            <XMRef idref="A3.Ex25.m1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex25.m1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                                <XMTok fontsize="70%" role="UNKNOWN">prior</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p><!--  %**** main.tex Line 750 **** -->where we could push the limit inside <Math mode="inline" tex="D_{\text{KL}}" text="D _ [KL]" xml:id="A3.SS3.p1.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMText><text fontsize="70%">KL</text></XMText>
              </XMApp>
            </XMath>
          </Math> since we assume that no cluster is empty and thus the KL function is continuous as <Math mode="inline" tex="\sigma\mapsto 0" text="sigma maps-to 0" xml:id="A3.SS3.p1.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, and that <Math mode="inline" tex="\lim_{\sigma\mapsto 0}\overline{{\bm{p}}}=(\frac{N_{1}}{N},\dots,\frac{N_{K}}{%&#10;N})" text="(limit _ (sigma maps-to 0))@(overline@(p)) = vector@(N _ 1 / N, dots, N _ K / N)" xml:id="A3.SS3.p1.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="limit" role="LIMITOP" scriptpos="post">lim</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                      <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok name="overline" role="OVERACCENT">¯</XMTok>
                    <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="A3.SS3.p1.m16.1"/>
                    <XMRef idref="A3.SS3.p1.m16.2"/>
                    <XMRef idref="A3.SS3.p1.m16.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m16.1">
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="dots" role="ID" xml:id="A3.SS3.p1.m16.2">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m16.3">
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">K</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. The value of <Math mode="inline" tex="N_{k}" text="N _ k" xml:id="A3.SS3.p1.m17">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is the number of samples that are assigned to cluster <Math mode="inline" tex="k" text="k" xml:id="A3.SS3.p1.m18">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>. This assumption, which was only used for simplicity, can be removed easily by noticing that <Math mode="inline" tex="\lim_{u\mapsto 0}u\log(u)=0" text="(limit _ (u maps-to 0))@(u * logarithm@(u)) = 0" xml:id="A3.SS3.p1.m19">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="limit" role="LIMITOP" scriptpos="post">lim</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">u</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">u</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="A3.SS3.p1.m19.1"/>
                        <XMRef idref="A3.SS3.p1.m19.2"/>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.SS3.p1.m19.1">log</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS3.p1.m19.2">u</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>. Now considering the left term of the loss we obtain a direct simplification of the log-softmax as follows</p>
        <equationgroup class="ltx_eqn_gather" xml:id="A9.EGx15">
          <equation xml:id="A3.Ex26">
            <Math mode="display" tex="\displaystyle\lim_{\sigma\mapsto 0}\left[-\frac{\sigma}{N}\sum_{n=1}^{N}\sum_{%&#10;k=1}^{K}\delta(k-k(n))\log\left(\text{softmax}({\bm{W}}^{T}{\bm{x}}_{n}/\sigma%&#10;)_{k}\right)\right]" text="(limit _ (sigma maps-to 0))@(delimited-[]@(- (sigma / N) * ((sum _ (n = 1)) ^ N)@(((sum _ (k = 1)) ^ K)@(delta * (k - k * n) * logarithm@([softmax] * ((W ^ T * x _ n) / sigma) _ k)))))" xml:id="A3.Ex26.m1">
              <XMath>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok meaning="limit" role="LIMITOP" scriptpos="mid">lim</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="maps-to" name="mapsto" role="ARROW">↦</XMTok>
                      <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="A3.Ex26.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">[</XMTok>
                      <XMApp xml:id="A3.Ex26.m1.3">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                <XMDual>
                                  <XMRef idref="A3.Ex26.m1.3.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A3.Ex26.m1.3.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                        <XMDual>
                                          <XMRef idref="A3.Ex26.m1.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex26.m1.1">n</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A3.Ex26.m1.2"/>
                                    <XMRef idref="A3.Ex26.m1.3.2"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex26.m1.2">log</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMApp xml:id="A3.Ex26.m1.3.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMText>softmax</XMText>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMDual>
                                            <XMRef idref="A3.Ex26.m1.3.2.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex26.m1.3.2.1">
                                                <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                                    <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                    <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="true">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>
          </equation>
          <equation xml:id="A3.Ex27">
            <Math content-tex="\displaystyle=\frac{1}{N}\sum_{n=1}^{N}\underbrace{\|{\bm{x}}_{n}-\mu_{k(n)}\|%&#10;_{2}^{2}-\min_{k=1,\dots,K}\|{\bm{x}}_{n}-\mu_{k}\|_{2}^{2}}_{=0\iff\argmin_{c%&#10;}\|{\bm{x}}_{n}-\mu_{c}\|_{2}=\argmin_{c}\|{\bm{x}}_{n}^{+}-\mu_{c}\|_{2}}," mode="display" tex="\displaystyle=\frac{1}{N}\sum_{n=1}^{N}\underbrace{\|{\bm{x}}_{n}-\mu_{k(n)}\|%&#10;_{2}^{2}-\min_{k=1,\dots,K}\|{\bm{x}}_{n}-\mu_{k}\|_{2}^{2}}_{=0\iff%&#10;\operatorname*{arg\,min}_{c}\|{\bm{x}}_{n}-\mu_{c}\|_{2}=\operatorname*{arg\,%&#10;min}_{c}\|{\bm{x}}_{n}^{+}-\mu_{c}\|_{2}}," text="absent = (1 / N) * ((sum _ (n = 1)) ^ N)@((underbrace@(((norm@(x _ n - mu _ (k * n))) _ 2) ^ 2 - (minimum _ (k = list@(1, dots, K)))@(((norm@(x _ n - mu _ k)) _ 2) ^ 2))) _ (list@(absent = 0, absent iff (argmin _ c)@((norm@(x _ n - mu _ c)) _ 2), absent = (argmin _ c)@((norm@((x _ n) ^ + - mu _ c)) _ 2))))" xml:id="A3.Ex27.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A3.Ex27.m1.10"/>
                  <XMWrap>
                    <XMApp xml:id="A3.Ex27.m1.10">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMApp scriptpos="mid">
                              <XMTok name="underbrace" role="UNDERACCENT">⏟</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="A3.Ex27.m1.5"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                        <XMApp xml:id="A3.Ex27.m1.5">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              <XMDual>
                                                <XMRef idref="A3.Ex27.m1.1"/>
                                                <XMWrap>
                                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex27.m1.1">n</XMTok>
                                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A3.Ex27.m1.2"/>
                                          <XMRef idref="A3.Ex27.m1.3"/>
                                          <XMRef idref="A3.Ex27.m1.4"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.Ex27.m1.2">1</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.Ex27.m1.3">…</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.Ex27.m1.4">K</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="norm"/>
                                          <XMRef idref="A3.Ex27.m1.6"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok name="||" role="OPEN">‖</XMTok>
                                          <XMApp xml:id="A3.Ex27.m1.6">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok name="||" role="CLOSE">‖</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A3.Ex27.m1.7"/>
                                <XMRef idref="A3.Ex27.m1.8"/>
                                <XMRef idref="A3.Ex27.m1.9"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A3.Ex27.m1.7">
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">⁣</XMTok>
                                <XMApp xml:id="A3.Ex27.m1.8">
                                  <XMTok fontsize="70%" meaning="iff" role="METARELOP">⇔</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok fontsize="70%" role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                        <XMTok fontsize="70%" role="UNKNOWN">min</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="norm"/>
                                          <XMRef idref="A3.Ex27.m1.8.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" name="||" role="OPEN">‖</XMTok>
                                          <XMApp xml:id="A3.Ex27.m1.8.1">
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok fontsize="70%" name="||" role="CLOSE">‖</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT">⁣</XMTok>
                                <XMApp xml:id="A3.Ex27.m1.9">
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok fontsize="70%" role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                                        <XMTok fontsize="70%" role="UNKNOWN">min</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="norm"/>
                                          <XMRef idref="A3.Ex27.m1.9.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" name="||" role="OPEN">‖</XMTok>
                                          <XMApp xml:id="A3.Ex27.m1.9.1">
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">n</XMTok>
                                              </XMApp>
                                              <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok fontsize="70%" name="||" role="CLOSE">‖</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </equationgroup>
        <p>which is minimized whenever all the samples <Math mode="inline" tex="{\bm{x}}_{n}" text="x _ n" xml:id="A3.SS3.p1.m20">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> that have their positive views <Math mode="inline" tex="{\bm{x}}_{n}^{+}" text="(x _ n) ^ +" xml:id="A3.SS3.p1.m21">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
              </XMApp>
            </XMath>
          </Math> associated to the same centroid belong to the same cluster; thus the overall MSN loss can be written as</p>
        <equationgroup class="ltx_eqn_align" xml:id="A9.EGx16">
          <equation xml:id="A3.Ex28">
            <MathFork>
              <Math tex="\displaystyle\sum_{k=1}^{N}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}\|{\bm{x}}-\mu_{k%&#10;}\|_{2}^{2}+\lambda\sum_{k=1}^{K}\frac{N_{k}}{N}\log\left(\frac{N_{k}/N}{({\bm%&#10;{p}}_{\rm prior})_{k}}\right)," text="((sum _ (k = 1)) ^ N)@((sum _ (x element-of 𝕏 _ k))@(((norm@(x - mu _ k)) _ 2) ^ 2)) + lambda * ((sum _ (k = 1)) ^ K)@((N _ k / N) * logarithm@(N _ k / N / p _ prior _ k))" xml:id="A3.Ex28.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="A3.Ex28.m2.4"/>
                    <XMWrap>
                      <XMApp xml:id="A3.Ex28.m2.4">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="A3.Ex28.m2.4.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="||" role="OPEN">‖</XMTok>
                                    <XMApp xml:id="A3.Ex28.m2.4.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok name="||" role="CLOSE">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A3.Ex28.m2.2"/>
                                  <XMRef idref="A3.Ex28.m2.3"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex28.m2.2">log</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A3.Ex28.m2.3">
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMApp>
                                        <XMTok meaning="divide" role="MULOP">/</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMDual>
                                          <XMRef idref="A3.Ex28.m2.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A3.Ex28.m2.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                              <XMTok fontsize="70%" role="UNKNOWN">prior</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\sum_{k=1}^{N}\sum_{{\bm{x}}\in{\mathbb{X}}_{k}}\|{\bm{x}}-\mu_{k%&#10;}\|_{2}^{2}+\lambda\sum_{k=1}^{K}\frac{N_{k}}{N}\log\left(\frac{N_{k}/N}{({\bm%&#10;{p}}_{\rm prior})_{k}}\right)," text="((sum _ (k = 1)) ^ N)@((sum _ (x element-of 𝕏 _ k))@(((norm@(x - mu _ k)) _ 2) ^ 2)) + lambda * ((sum _ (k = 1)) ^ K)@((N _ k / N) * logarithm@(N _ k / N / p _ prior _ k))" xml:id="A3.Ex28.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="A3.Ex28.m1.4"/>
                        <XMWrap>
                          <XMApp xml:id="A3.Ex28.m1.4">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMTok font="bold italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok fontsize="70%" role="UNKNOWN">𝕏</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="A3.Ex28.m1.4.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                        <XMApp xml:id="A3.Ex28.m1.4.1">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A3.Ex28.m1.2"/>
                                      <XMRef idref="A3.Ex28.m1.3"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.Ex28.m1.2">log</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                                        <XMApp xml:id="A3.Ex28.m1.3">
                                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                          <XMApp>
                                            <XMTok meaning="divide" role="MULOP">/</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                            <XMDual>
                                              <XMRef idref="A3.Ex28.m1.1"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A3.Ex28.m1.1">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                                                  <XMTok fontsize="70%" role="UNKNOWN">prior</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math content-tex="{\mathbb{X}}_{k}=\{{\bm{x}}\in{\mathbb{X}}:\argmin_{c=1,\dots,K}\|{\bm{x}}^{+}%&#10;-\mu_{c}\|_{2}=k\}" mode="inline" tex="{\mathbb{X}}_{k}=\{{\bm{x}}\in{\mathbb{X}}:\operatorname*{arg\,min}_{c=1,\dots%&#10;,K}\|{\bm{x}}^{+}-\mu_{c}\|_{2}=k\}" text="𝕏 _ k = conditional-set@(x element-of 𝕏, (argmin _ (c = list@(1, dots, K)))@((norm@(x ^ + - mu _ c)) _ 2) = k)" xml:id="A3.SS3.p1.m22">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok role="UNKNOWN">𝕏</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="conditional-set"/>
                    <XMRef idref="A3.SS3.p1.m22.4"/>
                    <XMRef idref="A3.SS3.p1.m22.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m22.4">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                      <XMTok role="UNKNOWN">𝕏</XMTok>
                    </XMApp>
                    <XMTok name="colon" role="METARELOP">:</XMTok>
                    <XMApp xml:id="A3.SS3.p1.m22.5">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                            <XMTok role="UNKNOWN">min</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A3.SS3.p1.m22.1"/>
                                <XMRef idref="A3.SS3.p1.m22.2"/>
                                <XMRef idref="A3.SS3.p1.m22.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A3.SS3.p1.m22.1">1</XMTok>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMTok fontsize="70%" name="dots" role="ID" xml:id="A3.SS3.p1.m22.2">…</XMTok>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A3.SS3.p1.m22.3">K</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="norm"/>
                              <XMRef idref="A3.SS3.p1.m22.5.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok name="||" role="OPEN">‖</XMTok>
                              <XMApp xml:id="A3.SS3.p1.m22.5.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok name="||" role="CLOSE">‖</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:proof:swav" xml:id="A3.SS4">
      <tags>
        <tag>C.4</tag>
        <tag role="autoref">subsection C.4</tag>
        <tag role="refnum">C.4</tag>
        <tag role="typerefnum">§C.4</tag>
      </tags>
      <title><tag close=" ">C.4</tag>Proof of proposition <ref labelref="LABEL:prop:swav"/></title>
      <para xml:id="A3.SS4.p1">
        <p>The proof for SwAV mainly relies on the same development as done for MSN. That is, we saw that with enough sharpening, the cross-entropy between <Math mode="inline" tex="{\bm{p}}_{n}^{+}" text="(p _ n) ^ +" xml:id="A3.SS4.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="{\bm{p}}_{n}" text="p _ n" xml:id="A3.SS4.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> falls back to the K-means like term with an extra margin that is minimized only when the two views are in the same cluster. The difference arises in that SwAV explicitly adds linear constraints on the cluster-membership matrix whereas MSN was employing a KL-divergence between the average posterior and the prior. The connection between the linear constraint and the SwAV Sinkhorn-Knopp procedure has been made precisely in <cite class="ltx_citemacro_citet"><bibref bibrefs="wang2010learning" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, where it was shown that the latter solved a relaxed optimization problem for which the cluster-membership is no longer constrained to be <Math mode="inline" tex="0" text="0" xml:id="A3.SS4.p1.m3">
            <XMath>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMath>
          </Math> or <Math mode="inline" tex="1" text="1" xml:id="A3.SS4.p1.m4">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
  </appendix>
  <appendix inlist="toc" labels="LABEL:apndx:classstratified_sampling" xml:id="A4">
    <tags>
      <tag>Appendix D</tag>
      <tag role="autoref">Appendix D</tag>
      <tag role="refnum">D</tag>
      <tag role="typerefnum">Appendix D</tag>
    </tags>
    <title><tag close=" ">Appendix D</tag>Pretraining and evaluation details for section <ref labelref="LABEL:sec:class_stratified"/></title>
    <toctitle><tag close=" ">D</tag>Pretraining and evaluation details for section <ref labelref="LABEL:sec:class_stratified"/></toctitle>
    <subsection inlist="toc" xml:id="A4.SS1">
      <tags>
        <tag>D.1</tag>
        <tag role="autoref">subsection D.1</tag>
        <tag role="refnum">D.1</tag>
        <tag role="typerefnum">§D.1</tag>
      </tags>
      <title><tag close=" ">D.1</tag>Pretraining protocol</title>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px1">
        <title>SimCLR.</title>
        <para xml:id="A4.SS1.SSS0.Px1.p1">
          <p>We use the VISSL <cite class="ltx_citemacro_citep">(<bibref bibrefs="goyal2021vissl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> code base to pretrain a ResNet-50 with SimCLR <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2020simple" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite>, with a batch size of <Math mode="inline" tex="4096" text="4096" xml:id="A4.SS1.SSS0.Px1.p1.m1">
              <XMath>
                <XMTok meaning="4096" role="NUMBER">4096</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="300" text="300" xml:id="A4.SS1.SSS0.Px1.p1.m2">
              <XMath>
                <XMTok meaning="300" role="NUMBER">300</XMTok>
              </XMath>
            </Math> epochs.
Our pretraining follow the standard hyperparameters defined in <cite class="ltx_citemacro_citet"><bibref bibrefs="chen2020simple" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite>.
The learning rate follows the default cosine schedule with a <Math mode="inline" tex="10" text="10" xml:id="A4.SS1.SSS0.Px1.p1.m3">
              <XMath>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMath>
            </Math> epoch warmup. We use a temperature of <Math mode="inline" tex="0.1" text="0.1" xml:id="A4.SS1.SSS0.Px1.p1.m4">
              <XMath>
                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
              </XMath>
            </Math> for the contrastive loss and LARS <cite class="ltx_citemacro_citep">(<bibref bibrefs="you2017large" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> as an optimizer. We modify the sampler to force <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px1.p1.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> different classes inside each mini-batch where <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px1.p1.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> is set to <Math mode="inline" tex="8" text="8" xml:id="A4.SS1.SSS0.Px1.p1.m7">
              <XMath>
                <XMTok meaning="8" role="NUMBER">8</XMTok>
              </XMath>
            </Math> for the class-imbalanced sampling experiments and <Math mode="inline" tex="960" text="960" xml:id="A4.SS1.SSS0.Px1.p1.m8">
              <XMath>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMath>
            </Math> for the class-balanced sampling experiments.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px2">
        <title>VICReg.</title>
        <para xml:id="A4.SS1.SSS0.Px2.p1">
          <p>We pretrain a ResNet-50 with VICReg <cite class="ltx_citemacro_citep">(<bibref bibrefs="bardes2021vicreg" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> using the LARS optimizer with a batch size of <Math mode="inline" tex="1024" text="1024" xml:id="A4.SS1.SSS0.Px2.p1.m1">
              <XMath>
                <XMTok meaning="1024" role="NUMBER">1024</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="300" text="300" xml:id="A4.SS1.SSS0.Px2.p1.m2">
              <XMath>
                <XMTok meaning="300" role="NUMBER">300</XMTok>
              </XMath>
            </Math> epochs using the official code base, which is publicly available: <ref class="ltx_url" font="typewriter" href="https://github.com/facebookresearch/vicreg">https://github.com/facebookresearch/vicreg</ref>.
Our pretraining follow the standard hyperparameters defined in <cite class="ltx_citemacro_citet"><bibref bibrefs="bardes2021vicreg" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite>.
The learning rate follows the default cosine schedule with a <Math mode="inline" tex="10" text="10" xml:id="A4.SS1.SSS0.Px2.p1.m3">
              <XMath>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMath>
            </Math> epoch warmup.
We set the dimensions of the expander MLP to the default <Math mode="inline" tex="8192-8192-8192" text="8192 - 8192 - 8192" xml:id="A4.SS1.SSS0.Px2.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                  <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                  <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                </XMApp>
              </XMath>
            </Math>.
Weight decay is set to <Math mode="inline" tex="10^{-6}" text="10 ^ (- 6)" xml:id="A4.SS1.SSS0.Px2.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, the variance and invariance coefficients are set to <Math mode="inline" tex="25.0" text="25.0" xml:id="A4.SS1.SSS0.Px2.p1.m6">
              <XMath>
                <XMTok meaning="25.0" role="NUMBER">25.0</XMTok>
              </XMath>
            </Math>, and the covariance coefficient is set to <Math mode="inline" tex="1.0" text="1.0" xml:id="A4.SS1.SSS0.Px2.p1.m7">
              <XMath>
                <XMTok meaning="1.0" role="NUMBER">1.0</XMTok>
              </XMath>
            </Math>.
We modify the sampler to force <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px2.p1.m8">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> different classes inside each mini-batch where <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px2.p1.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> is set to <Math mode="inline" tex="2" text="2" xml:id="A4.SS1.SSS0.Px2.p1.m10">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math> for the class-imbalanced sampling experiments and <Math mode="inline" tex="960" text="960" xml:id="A4.SS1.SSS0.Px2.p1.m11">
              <XMath>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMath>
            </Math> for the class-balanced sampling experiments.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px3">
        <title>MSN.</title>
        <para xml:id="A4.SS1.SSS0.Px3.p1">
          <p>We pretrain a ViT-B/16 with MSN <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> using the AdamW optimizer with a batch size of <Math mode="inline" tex="1024" text="1024" xml:id="A4.SS1.SSS0.Px3.p1.m1">
              <XMath>
                <XMTok meaning="1024" role="NUMBER">1024</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="300" text="300" xml:id="A4.SS1.SSS0.Px3.p1.m2">
              <XMath>
                <XMTok meaning="300" role="NUMBER">300</XMTok>
              </XMath>
            </Math> epochs and <Math mode="inline" tex="1024" text="1024" xml:id="A4.SS1.SSS0.Px3.p1.m3">
              <XMath>
                <XMTok meaning="1024" role="NUMBER">1024</XMTok>
              </XMath>
            </Math> prototypes using the official code base, which is publicly available: <ref class="ltx_url" font="typewriter" href="https://github.com/facebookresearch/msn">https://github.com/facebookresearch/msn</ref><!--  %**** main.tex Line 800 **** -->.
Our pretraining follow the standard hyperparameters defined in <cite class="ltx_citemacro_citet"><bibref bibrefs="assran2022masked" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite>.
The learning rate follows the default cosine schedule with a <Math mode="inline" tex="15" text="15" xml:id="A4.SS1.SSS0.Px3.p1.m4">
              <XMath>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
              </XMath>
            </Math> epoch warmup.
Weight decay is linearly increased from <Math mode="inline" tex="0.04" text="0.04" xml:id="A4.SS1.SSS0.Px3.p1.m5">
              <XMath>
                <XMTok meaning="0.04" role="NUMBER">0.04</XMTok>
              </XMath>
            </Math> to <Math mode="inline" tex="0.4" text="0.4" xml:id="A4.SS1.SSS0.Px3.p1.m6">
              <XMath>
                <XMTok meaning="0.4" role="NUMBER">0.4</XMTok>
              </XMath>
            </Math>.
Gradient clipping is set to <Math mode="inline" tex="3.0" text="3.0" xml:id="A4.SS1.SSS0.Px3.p1.m7">
              <XMath>
                <XMTok meaning="3.0" role="NUMBER">3.0</XMTok>
              </XMath>
            </Math>, the entropy coefficient is set to <Math mode="inline" tex="1.0" text="1.0" xml:id="A4.SS1.SSS0.Px3.p1.m8">
              <XMath>
                <XMTok meaning="1.0" role="NUMBER">1.0</XMTok>
              </XMath>
            </Math>, the temperature is set to <Math mode="inline" tex="0.1" text="0.1" xml:id="A4.SS1.SSS0.Px3.p1.m9">
              <XMath>
                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
              </XMath>
            </Math>, the sharpening exponent is set to <Math mode="inline" tex="0.25" text="0.25" xml:id="A4.SS1.SSS0.Px3.p1.m10">
              <XMath>
                <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
              </XMath>
            </Math>, and the masking ratio is set to <Math mode="inline" tex="0.5" text="0.5" xml:id="A4.SS1.SSS0.Px3.p1.m11">
              <XMath>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
              </XMath>
            </Math>.
The number of random-mask views in each iteration is set to <Math mode="inline" tex="1" text="1" xml:id="A4.SS1.SSS0.Px3.p1.m12">
              <XMath>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMath>
            </Math>, and the number of focal-mask views in each iteration is set to <Math mode="inline" tex="10" text="10" xml:id="A4.SS1.SSS0.Px3.p1.m13">
              <XMath>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMath>
            </Math>.
We modify the sampler to force <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px3.p1.m14">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> different classes inside each mini-batch where <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px3.p1.m15">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> is set to <Math mode="inline" tex="2" text="2" xml:id="A4.SS1.SSS0.Px3.p1.m16">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math> for the class-imbalanced sampling experiments and <Math mode="inline" tex="960" text="960" xml:id="A4.SS1.SSS0.Px3.p1.m17">
              <XMath>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMath>
            </Math> for the class-balanced sampling experiments.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px4">
        <title>MAE.</title>
        <para xml:id="A4.SS1.SSS0.Px4.p1">
          <p>We pretrain a ViT-L/16 with MAE <cite class="ltx_citemacro_citep">(<bibref bibrefs="he2021masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> using the AdamW optimizer with a batch size of <Math mode="inline" tex="1024" text="1024" xml:id="A4.SS1.SSS0.Px4.p1.m1">
              <XMath>
                <XMTok meaning="1024" role="NUMBER">1024</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="800" text="800" xml:id="A4.SS1.SSS0.Px4.p1.m2">
              <XMath>
                <XMTok meaning="800" role="NUMBER">800</XMTok>
              </XMath>
            </Math> epochs using the official code base, which is publicly available: <ref class="ltx_url" font="typewriter" href="https://github.com/facebookresearch/mae">https://github.com/facebookresearch/mae</ref>.
Our pretraining follow the standard hyperparameters defined in <cite class="ltx_citemacro_citet"><bibref bibrefs="he2021masked" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite>.
The learning rate follows the default cosine schedule with a <Math mode="inline" tex="40" text="40" xml:id="A4.SS1.SSS0.Px4.p1.m3">
              <XMath>
                <XMTok meaning="40" role="NUMBER">40</XMTok>
              </XMath>
            </Math> epoch warmup.
Weight decay is set to <Math mode="inline" tex="0.05" text="0.05" xml:id="A4.SS1.SSS0.Px4.p1.m4">
              <XMath>
                <XMTok meaning="0.05" role="NUMBER">0.05</XMTok>
              </XMath>
            </Math>, and the masking ratio is set to <Math mode="inline" tex="0.75" text="0.75" xml:id="A4.SS1.SSS0.Px4.p1.m5">
              <XMath>
                <XMTok meaning="0.75" role="NUMBER">0.75</XMTok>
              </XMath>
            </Math>.
We modify the sampler to force <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px4.p1.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> different classes inside each mini-batch where <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px4.p1.m7">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> is set to <Math mode="inline" tex="2" text="2" xml:id="A4.SS1.SSS0.Px4.p1.m8">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math> for the class-imbalanced sampling experiments and <Math mode="inline" tex="960" text="960" xml:id="A4.SS1.SSS0.Px4.p1.m9">
              <XMath>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMath>
            </Math> for the class-balanced sampling experiments.</p>
        </para>
      </paragraph>
      <paragraph inlist="toc" xml:id="A4.SS1.SSS0.Px5">
        <title>data2vec.</title>
        <para xml:id="A4.SS1.SSS0.Px5.p1">
          <p>We pretrain a ViT-B/16 with data2vec <cite class="ltx_citemacro_citep">(<bibref bibrefs="he2021masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> using the AdamW optimizer with a batch size of <Math mode="inline" tex="2048" text="2048" xml:id="A4.SS1.SSS0.Px5.p1.m1">
              <XMath>
                <XMTok meaning="2048" role="NUMBER">2048</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="800" text="800" xml:id="A4.SS1.SSS0.Px5.p1.m2">
              <XMath>
                <XMTok meaning="800" role="NUMBER">800</XMTok>
              </XMath>
            </Math> epochs using the official code base, which is publicly available: <ref class="ltx_url" font="typewriter" href="http://github.com/facebookresearch/data2vec_vision/tree/main/beit">http://github.com/facebookresearch/data2vec_vision/tree/main/beit</ref>.
Our pretraining follow the standard hyperparameters defined in <cite class="ltx_citemacro_citet"><bibref bibrefs="baevski2022data2vec" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite>.
Specifically, the learning rate follows the default cosine schedule with a <Math mode="inline" tex="10" text="10" xml:id="A4.SS1.SSS0.Px5.p1.m3">
              <XMath>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMath>
            </Math> epoch warmup.
Path drop is set to <Math mode="inline" tex="0.25" text="0.25" xml:id="A4.SS1.SSS0.Px5.p1.m4">
              <XMath>
                <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
              </XMath>
            </Math>, gradient clipping is set to <Math mode="inline" tex="3.0" text="3.0" xml:id="A4.SS1.SSS0.Px5.p1.m5">
              <XMath>
                <XMTok meaning="3.0" role="NUMBER">3.0</XMTok>
              </XMath>
            </Math>, weight decay is set to <Math mode="inline" tex="0.05" text="0.05" xml:id="A4.SS1.SSS0.Px5.p1.m6">
              <XMath>
                <XMTok meaning="0.05" role="NUMBER">0.05</XMTok>
              </XMath>
            </Math>, and the target layers are set to <Math mode="inline" tex="[6,7,8,9,10,11]" text="list@(6, 7, 8, 9, 10, 11)" xml:id="A4.SS1.SSS0.Px5.p1.m7">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A4.SS1.SSS0.Px5.p1.m7.1"/>
                    <XMRef idref="A4.SS1.SSS0.Px5.p1.m7.2"/>
                    <XMRef idref="A4.SS1.SSS0.Px5.p1.m7.3"/>
                    <XMRef idref="A4.SS1.SSS0.Px5.p1.m7.4"/>
                    <XMRef idref="A4.SS1.SSS0.Px5.p1.m7.5"/>
                    <XMRef idref="A4.SS1.SSS0.Px5.p1.m7.6"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok meaning="6" role="NUMBER" xml:id="A4.SS1.SSS0.Px5.p1.m7.1">6</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="7" role="NUMBER" xml:id="A4.SS1.SSS0.Px5.p1.m7.2">7</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="8" role="NUMBER" xml:id="A4.SS1.SSS0.Px5.p1.m7.3">8</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="9" role="NUMBER" xml:id="A4.SS1.SSS0.Px5.p1.m7.4">9</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="10" role="NUMBER" xml:id="A4.SS1.SSS0.Px5.p1.m7.5">10</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="11" role="NUMBER" xml:id="A4.SS1.SSS0.Px5.p1.m7.6">11</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>.
We modify the sampler to force <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px5.p1.m8">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> different classes inside each mini-batch where <Math mode="inline" tex="K" text="K" xml:id="A4.SS1.SSS0.Px5.p1.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
              </XMath>
            </Math> is set to <Math mode="inline" tex="2" text="2" xml:id="A4.SS1.SSS0.Px5.p1.m10">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math> for the class-imbalanced sampling experiments and <Math mode="inline" tex="960" text="960" xml:id="A4.SS1.SSS0.Px5.p1.m11">
              <XMath>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMath>
            </Math> for the class-balanced sampling experiments.</p>
        </para>
      </paragraph>
    </subsection>
    <subsection inlist="toc" labels="LABEL:apndx:classstratified_sampling_eval" xml:id="A4.SS2">
      <tags>
        <tag>D.2</tag>
        <tag role="autoref">subsection D.2</tag>
        <tag role="refnum">D.2</tag>
        <tag role="typerefnum">§D.2</tag>
      </tags>
      <title><tag close=" ">D.2</tag>Evaluation protocol</title>
      <para xml:id="A4.SS2.p1">
        <p>For linear evaluation, we use the default linear evaluation configurations of VISSL <cite class="ltx_citemacro_citep">(<bibref bibrefs="goyal2021vissl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> to evaluate our models on the following datasets: ImageNet <cite class="ltx_citemacro_citep">(<bibref bibrefs="russakovsky2015imagenet" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, iNaturalist18 <cite class="ltx_citemacro_citep">(<bibref bibrefs="van2018inaturalist" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, CIFAR100 <cite class="ltx_citemacro_citep">(<bibref bibrefs="krizhevsky2009learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, Clevr/Count <cite class="ltx_citemacro_citep">(<bibref bibrefs="johnson2017clevr" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, Clevr/Dist <cite class="ltx_citemacro_citep">(<bibref bibrefs="johnson2017clevr" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, KITTI/Dist <cite class="ltx_citemacro_citep">(<bibref bibrefs="geiger2013vision" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and Places205 <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhou2014learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</p>
      </para>
      <para xml:id="A4.SS2.p2">
        <p>For pretrained models based on Vision Transformers <cite class="ltx_citemacro_citep">(<bibref bibrefs="dosovitskiy2020image" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, we report the best linear classifier number among the following representations:</p>
        <itemize xml:id="A4.I1">
          <item xml:id="A4.I1.i1">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="A4.I1.i1.p1">
              <p>the concatenation of the last <Math mode="inline" tex="4" text="4" xml:id="A4.I1.i1.p1.m1">
                  <XMath>
                    <XMTok meaning="4" role="NUMBER">4</XMTok>
                  </XMath>
                </Math> layers of the class token, <cite class="ltx_citemacro_citep">(<bibref bibrefs="caron2021emerging" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                    <bibrefphrase>, </bibrefphrase>
                  </bibref>)</cite></p>
            </para>
          </item>
          <item xml:id="A4.I1.i2">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="A4.I1.i2.p1">
              <p>the representation of the last layer of the class token.</p>
            </para>
          </item>
        </itemize>
      </para>
      <para xml:id="A4.SS2.p3">
        <p>For pretrained models based on ResNet50 architectures <cite class="ltx_citemacro_citep">(<bibref bibrefs="he2016deep" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, we follow the evaluation protocol of SEER <cite class="ltx_citemacro_citep">(<bibref bibrefs="goyal2022vision" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and report the best linear classifier number among the following representations:</p>
        <itemize xml:id="A4.I2">
          <item xml:id="A4.I2.i1">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="A4.I2.i1.p1">
              <p>the final representation layer (of dimension <Math mode="inline" tex="2048" text="2048" xml:id="A4.I2.i1.p1.m1">
                  <XMath>
                    <XMTok meaning="2048" role="NUMBER">2048</XMTok>
                  </XMath>
                </Math> for a ResNet50),</p>
            </para>
          </item>
          <item xml:id="A4.I2.i2">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="A4.I2.i2.p1">
              <p>an adaptive average pooling of the last feature map, concatenated to get <Math mode="inline" tex="8192" text="8192" xml:id="A4.I2.i2.p1.m1">
                  <XMath>
                    <XMTok meaning="8192" role="NUMBER">8192</XMTok>
                  </XMath>
                </Math> dimensions.</p>
            </para>
          </item>
        </itemize>
      </para>
      <para xml:id="A4.SS2.p4">
        <p>We also follow the default VISSL <cite class="ltx_citemacro_citep">(<bibref bibrefs="goyal2021vissl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> configuration and attach <Math mode="inline" tex="2" text="2" xml:id="A4.SS2.p4.m1">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math> linear heads per chosen representation, one composed of a single linear layer, and one with an added batch normalization <cite class="ltx_citemacro_citep">(<bibref bibrefs="https://doi.org/10.48550/arxiv.1502.03167" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> before the linear layer.</p>
      </para>
    </subsection>
  </appendix>
  <appendix inlist="toc" labels="LABEL:apndx:priors" xml:id="A5">
    <tags>
      <tag>Appendix E</tag>
      <tag role="autoref">Appendix E</tag>
      <tag role="refnum">E</tag>
      <tag role="typerefnum">Appendix E</tag>
    </tags>
    <title><tag close=" ">Appendix E</tag>Pretraining and evaluation details for section <ref labelref="LABEL:sec:priors"/></title>
    <toctitle><tag close=" ">E</tag>Pretraining and evaluation details for section <ref labelref="LABEL:sec:priors"/></toctitle>
    <subsection inlist="toc" xml:id="A5.SS1">
      <tags>
        <tag>E.1</tag>
        <tag role="autoref">subsection E.1</tag>
        <tag role="refnum">E.1</tag>
        <tag role="typerefnum">§E.1</tag>
      </tags>
      <title><tag close=" ">E.1</tag>Pretraining protocol</title>
      <subsubsection inlist="toc" xml:id="A5.SS1.SSS1">
        <tags>
          <tag>E.1.1</tag>
          <tag role="autoref">subsubsection E.1.1</tag>
          <tag role="refnum">E.1.1</tag>
          <tag role="typerefnum">§E.1.1</tag>
        </tags>
        <title><tag close=" ">E.1.1</tag>Toy setting</title>
        <para xml:id="A5.SS1.SSS1.p1">
          <p>We pretrain a ViT-Tiny/4 with MSN <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> using the AdamW optimizer with a batch size of <Math mode="inline" tex="1024" text="1024" xml:id="A5.SS1.SSS1.p1.m1">
              <XMath>
                <XMTok meaning="1024" role="NUMBER">1024</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="300" text="300" xml:id="A5.SS1.SSS1.p1.m2">
              <XMath>
                <XMTok meaning="300" role="NUMBER">300</XMTok>
              </XMath>
            </Math> epochs and <Math mode="inline" tex="10" text="10" xml:id="A5.SS1.SSS1.p1.m3">
              <XMath>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMath>
            </Math> prototypes using the official code base, which is publicly available: <ref class="ltx_url" font="typewriter" href="https://github.com/facebookresearch/msn">https://github.com/facebookresearch/msn</ref><!--  %**** main.tex Line 850 **** -->.
The learning rate follows the default cosine schedule with a <Math mode="inline" tex="15" text="15" xml:id="A5.SS1.SSS1.p1.m4">
              <XMath>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
              </XMath>
            </Math> epoch warmup.
Weight decay is linearly increased from <Math mode="inline" tex="0.04" text="0.04" xml:id="A5.SS1.SSS1.p1.m5">
              <XMath>
                <XMTok meaning="0.04" role="NUMBER">0.04</XMTok>
              </XMath>
            </Math> to <Math mode="inline" tex="0.4" text="0.4" xml:id="A5.SS1.SSS1.p1.m6">
              <XMath>
                <XMTok meaning="0.4" role="NUMBER">0.4</XMTok>
              </XMath>
            </Math>.
Gradient clipping is set to <Math mode="inline" tex="0.0" text="0.0" xml:id="A5.SS1.SSS1.p1.m7">
              <XMath>
                <XMTok meaning="0.0" role="NUMBER">0.0</XMTok>
              </XMath>
            </Math>, the entropy coefficient is set to <Math mode="inline" tex="100.0" text="100.0" xml:id="A5.SS1.SSS1.p1.m8">
              <XMath>
                <XMTok meaning="100.0" role="NUMBER">100.0</XMTok>
              </XMath>
            </Math>, the temperature is set to <Math mode="inline" tex="0.1" text="0.1" xml:id="A5.SS1.SSS1.p1.m9">
              <XMath>
                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
              </XMath>
            </Math>, the sharpening exponent is set to <Math mode="inline" tex="0.25" text="0.25" xml:id="A5.SS1.SSS1.p1.m10">
              <XMath>
                <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
              </XMath>
            </Math>, and the masking ratio is set to <Math mode="inline" tex="0.05" text="0.05" xml:id="A5.SS1.SSS1.p1.m11">
              <XMath>
                <XMTok meaning="0.05" role="NUMBER">0.05</XMTok>
              </XMath>
            </Math>.
The number of random-mask views in each iteration is set to <Math mode="inline" tex="1" text="1" xml:id="A5.SS1.SSS1.p1.m12">
              <XMath>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMath>
            </Math>, and the number of focal-mask views in each iteration is set to <Math mode="inline" tex="0" text="0" xml:id="A5.SS1.SSS1.p1.m13">
              <XMath>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMath>
            </Math>.
To accommodate the lower-resolution images, we modify the scale of random-resized-crop data augmentation to <Math mode="inline" tex="(0.5,1.0)" text="open-interval@(0.5, 1.0)" xml:id="A5.SS1.SSS1.p1.m14">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A5.SS1.SSS1.p1.m14.1"/>
                    <XMRef idref="A5.SS1.SSS1.p1.m14.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0.5" role="NUMBER" xml:id="A5.SS1.SSS1.p1.m14.1">0.5</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1.0" role="NUMBER" xml:id="A5.SS1.SSS1.p1.m14.2">1.0</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> and train without Gaussian-Blur.</p>
        </para>
      </subsubsection>
      <subsubsection inlist="toc" xml:id="A5.SS1.SSS2">
        <tags>
          <tag>E.1.2</tag>
          <tag role="autoref">subsubsection E.1.2</tag>
          <tag role="refnum">E.1.2</tag>
          <tag role="typerefnum">§E.1.2</tag>
        </tags>
        <title><tag close=" ">E.1.2</tag>Natural class-imbalanced setting</title>
        <para xml:id="A5.SS1.SSS2.p1">
          <p>We pretrain a ViT-S/16 with MSN <cite class="ltx_citemacro_citep">(<bibref bibrefs="assran2022masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> using the AdamW optimizer with a batch size of <Math mode="inline" tex="4096" text="4096" xml:id="A5.SS1.SSS2.p1.m1">
              <XMath>
                <XMTok meaning="4096" role="NUMBER">4096</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="300" text="300" xml:id="A5.SS1.SSS2.p1.m2">
              <XMath>
                <XMTok meaning="300" role="NUMBER">300</XMTok>
              </XMath>
            </Math> epochs and <Math mode="inline" tex="8142" text="8142" xml:id="A5.SS1.SSS2.p1.m3">
              <XMath>
                <XMTok meaning="8142" role="NUMBER">8142</XMTok>
              </XMath>
            </Math> prototypes using the official code base, which is publicly available: <ref class="ltx_url" font="typewriter" href="https://github.com/facebookresearch/msn">https://github.com/facebookresearch/msn</ref>.
The learning rate follows the default cosine schedule with a <Math mode="inline" tex="15" text="15" xml:id="A5.SS1.SSS2.p1.m4">
              <XMath>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
              </XMath>
            </Math> epoch warmup.
Weight decay is linearly increased from <Math mode="inline" tex="0.04" text="0.04" xml:id="A5.SS1.SSS2.p1.m5">
              <XMath>
                <XMTok meaning="0.04" role="NUMBER">0.04</XMTok>
              </XMath>
            </Math> to <Math mode="inline" tex="0.4" text="0.4" xml:id="A5.SS1.SSS2.p1.m6">
              <XMath>
                <XMTok meaning="0.4" role="NUMBER">0.4</XMTok>
              </XMath>
            </Math>.
Gradient clipping is set to <Math mode="inline" tex="3.0" text="3.0" xml:id="A5.SS1.SSS2.p1.m7">
              <XMath>
                <XMTok meaning="3.0" role="NUMBER">3.0</XMTok>
              </XMath>
            </Math>, the entropy coefficient is set to <Math mode="inline" tex="5.0" text="5.0" xml:id="A5.SS1.SSS2.p1.m8">
              <XMath>
                <XMTok meaning="5.0" role="NUMBER">5.0</XMTok>
              </XMath>
            </Math>, the temperature is set to <Math mode="inline" tex="0.1" text="0.1" xml:id="A5.SS1.SSS2.p1.m9">
              <XMath>
                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
              </XMath>
            </Math>, the sharpening exponent is set to <Math mode="inline" tex="0.25" text="0.25" xml:id="A5.SS1.SSS2.p1.m10">
              <XMath>
                <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
              </XMath>
            </Math>, and the masking ratio is set to <Math mode="inline" tex="0.15" text="0.15" xml:id="A5.SS1.SSS2.p1.m11">
              <XMath>
                <XMTok meaning="0.15" role="NUMBER">0.15</XMTok>
              </XMath>
            </Math>.
The number of random-mask views in each iteration is set to <Math mode="inline" tex="1" text="1" xml:id="A5.SS1.SSS2.p1.m12">
              <XMath>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMath>
            </Math>, and the number of focal-mask views in each iteration is set to <Math mode="inline" tex="10" text="10" xml:id="A5.SS1.SSS2.p1.m13">
              <XMath>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMath>
            </Math>.</p>
        </para>
      </subsubsection>
    </subsection>
    <subsection inlist="toc" xml:id="A5.SS2">
      <tags>
        <tag>E.2</tag>
        <tag role="autoref">subsection E.2</tag>
        <tag role="refnum">E.2</tag>
        <tag role="typerefnum">§E.2</tag>
      </tags>
      <title><tag close=" ">E.2</tag>Evaluation protocol</title>
      <para xml:id="A5.SS2.p1">
        <p>We use the exact same evaluation protocol as <ref labelref="LABEL:apndx:classstratified_sampling_eval"/>.</p>
      </para>
    </subsection>
  </appendix>
  <appendix inlist="toc" xml:id="A6">
    <tags>
      <tag>Appendix F</tag>
      <tag role="autoref">Appendix F</tag>
      <tag role="refnum">F</tag>
      <tag role="typerefnum">Appendix F</tag>
    </tags>
    <title><tag close=" ">Appendix F</tag>Alternatives to feature priors for section <ref labelref="LABEL:sec:priors"/>: data sampling</title>
    <toctitle><tag close=" ">F</tag>Alternatives to feature priors for section <ref labelref="LABEL:sec:priors"/>: data sampling</toctitle>
    <para xml:id="A6.p1">
      <p>As an alternative to changing the feature prior, perhaps one can devise more intelligence sampling strategies to align the class distribution in the sampled mini-batches with the implicit uniform prior in self-supervised algorithms.
Here, we investigate the impact on the mini-batch sampling schemes when pretraining on iNat18.
We compare (uniform) random sampling to unthresholded inverse square-root frequency sampling <cite class="ltx_citemacro_citep">(<bibref bibrefs="https://doi.org/10.48550/arxiv.1310.4546" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, which is commonly applied in the context of (weakly) supervised learning on internet-scale class-imbalanced data.
Specifically, the prescription of inverse square-root frequency sampling is to sample a class with probability inversely proportional to the square root of the frequency of the class, and then sample images uniformly within the class.
For example, if we have <Math mode="inline" tex="D" text="D" xml:id="A6.p1.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math> images in the dataset and <Math mode="inline" tex="D_{k}" text="D _ k" xml:id="A6.p1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
            </XMApp>
          </XMath>
        </Math> images in the <Math mode="inline" tex="k^{\text{th}}" text="k ^ [th]" xml:id="A6.p1.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
              <XMText><text fontsize="70%">th</text></XMText>
            </XMApp>
          </XMath>
        </Math> class category, then the probability of sampling class <Math mode="inline" tex="k" text="k" xml:id="A6.p1.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math> is equal to <Math mode="inline" tex="\nicefrac{{\sqrt{D_{k}}}}{{D}}" text="square-root@(D _ k) / D" xml:id="A6.p1.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="divide" role="MULOP" stretchy="true" width="-0.15em" xoffset="-0.1em">/</XMTok>
              <XMApp rpadding="-0.5em" yoffset="0.3em">
                <XMTok meaning="square-root"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post4"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
            </XMApp>
          </XMath>
        </Math>, as opposed to the traditional <Math mode="inline" tex="\nicefrac{{D_{k}}}{{D}}" text="D _ k / D" xml:id="A6.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="divide" role="MULOP" stretchy="true" width="-0.15em" xoffset="-0.1em">/</XMTok>
              <XMApp rpadding="-0.5em" yoffset="0.3em">
                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
              </XMApp>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
            </XMApp>
          </XMath>
        </Math><!--  %**** main.tex Line 875 **** --> probability under uniform sampling.
The effect of this sampling strategy is to mitigate class-imbalances by oversampling underrepresented classes in the dataset.
While such an effect is desirable, one limitation to this strategy is that it induces an implicit reduction in the dataset size; for example, we may see the same images from the tail of the distribution very frequently and, given finite training time, may never see some of the images in the head.
Another limitation of this strategy is that requires knowing the class label (or a weak class label) for every image in the training set.</p>
    </para>
    <para xml:id="A6.p2">
      <p>Despite these limitations, we explore inverse frequency sampling in Table <ref labelref="LABEL:tb:inatsampling"/> and observe that it does not improve upon uniform random sampling.
We hypothesize the inverse frequency sampling tends to aggressively over-sample classes with very few examples, reducing the effective number of images seen per epoch and thus degrading the quality of the learned representations.
This result suggests that changing the feature prior is a more viable solution for pretraining with class-imbalanced data.</p>
    </para>
    <table inlist="lot" labels="LABEL:tb:inatsampling" placement="h" xml:id="A6.T4">
      <tags>
        <tag><text fontsize="90%">Table 4</text></tag>
        <tag role="autoref">Table 4</tag>
        <tag role="refnum">4</tag>
        <tag role="typerefnum">Table 4</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">4</text></tag><text font="bold" fontsize="80%">Impact of Sampling Scheme</text><text fontsize="80%">: Changing the mini-batch distribution by using an inverse square root sampling strategy on iNat18 does not improve downstream performance of the learned representations.</text></toccaption>
      <caption class="ltx_centering" fontsize="80%"><tag close=": "><text fontsize="113%">Table 4</text></tag><text font="bold" fontsize="113%">Impact of Sampling Scheme<text font="medium">: Changing the mini-batch distribution by using an inverse square root sampling strategy on iNat18 does not improve downstream performance of the learned representations.</text></text></caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="right" border="r tt" thead="column"><text fontsize="80%">Sampling</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">iNat18</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
            <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center" border="tt tt" colspan="7" cssstyle="padding-bottom:2.84526pt"><text font="bold" fontsize="70%">Pretrained on iNaturalist18 (ViT-S/16)</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><text fontsize="80%">Uniform</text></td>
            <td align="center"><text font="bold" fontsize="80%">29.1</text></td>
            <td align="center"><text font="bold" fontsize="80%">59.4</text></td>
            <td align="center"><text font="bold" fontsize="80%">36.9</text></td>
            <td align="center" border="r"><text font="bold" fontsize="80%">69.4</text></td>
            <td align="center"><text fontsize="80%">56.8</text></td>
            <td align="center"><text font="bold" fontsize="80%">68.2</text></td>
          </tr>
          <tr>
            <td align="right" border="bb r"><text fontsize="80%">Inverse Square Root Freq</text></td>
            <td align="center" border="bb"><text fontsize="80%">23.4</text></td>
            <td align="center" border="bb"><text fontsize="80%">58.4</text></td>
            <td align="center" border="bb"><text fontsize="80%">35.1</text></td>
            <td align="center" border="bb r"><text fontsize="80%">68.3</text></td>
            <td align="center" border="bb"><text font="bold" fontsize="80%">59.8</text></td>
            <td align="center" border="bb"><text fontsize="80%">66.6</text></td>
          </tr>
        </tbody>
      </tabular>
    </table>
  </appendix>
  <appendix inlist="toc" labels="LABEL:app:marginalprob" xml:id="A7">
    <tags>
      <tag>Appendix G</tag>
      <tag role="autoref">Appendix G</tag>
      <tag role="refnum">G</tag>
      <tag role="typerefnum">Appendix G</tag>
    </tags>
    <title><tag close=" ">Appendix G</tag>Marginal sampling probabilities</title>
    <toctitle><tag close=" ">G</tag>Marginal sampling probabilities</toctitle>
    <para xml:id="A7.p1">
      <p>The class-imbalanced strategy in Section <ref labelref="LABEL:sec:class_stratified"/> maintains the same marginal probability of sampling individual data points as compared to the class-balanced sampling strategy; i.e., the probability of sampling a particular data point in each iteration is unchanged.
To see this, suppose we have a mini-batch of size <Math mode="inline" tex="B=n\times 960" text="B = n * 960" xml:id="A7.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">B</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMTok meaning="960" role="NUMBER">960</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> for some integer <Math mode="inline" tex="n&gt;0" text="n &gt; 0" xml:id="A7.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math>.
Under class-balanced sampling, we will thus sample <Math mode="inline" tex="960" text="960" xml:id="A7.p1.m3">
          <XMath>
            <XMTok meaning="960" role="NUMBER">960</XMTok>
          </XMath>
        </Math> classes in each iteration, and then <Math mode="inline" tex="n" text="n" xml:id="A7.p1.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">n</XMTok>
          </XMath>
        </Math> images per class.
Under class-imbalanced sampling, we will first sample <Math mode="inline" tex="2" text="2" xml:id="A7.p1.m5">
          <XMath>
            <XMTok meaning="2" role="NUMBER">2</XMTok>
          </XMath>
        </Math> classes in each iteration, and then <Math mode="inline" tex="n\times 480" text="n * 480" xml:id="A7.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">×</XMTok>
              <XMTok font="italic" role="UNKNOWN">n</XMTok>
              <XMTok meaning="480" role="NUMBER">480</XMTok>
            </XMApp>
          </XMath>
        </Math> images per class so that the overall batch size is <Math mode="inline" tex="B" text="B" xml:id="A7.p1.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>.
Now consider the probability of sampling a data point <Math mode="inline" tex="x" text="x" xml:id="A7.p1.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> that comes form a class <Math mode="inline" tex="C" text="C" xml:id="A7.p1.m9">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">C</XMTok>
          </XMath>
        </Math> in our dataset containing <Math mode="inline" tex="N\geq 480\cdot n" text="N &gt;= 480 cdot n" xml:id="A7.p1.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
              <XMApp>
                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                <XMTok meaning="480" role="NUMBER">480</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> samples.
Under class-balanced sampling, the probability of sampling the data point <Math mode="inline" tex="x" text="x" xml:id="A7.p1.m11">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> can be factored as</p>
      <equation xml:id="A7.Ex29">
        <Math mode="display" tex="p_{\text{balanced}}(x)=p(x|C)p(C)=\frac{{N-1\choose n-1}}{{N\choose n}}\frac{{%&#10;999\choose 959}}{{1000\choose 960}}=\frac{n}{N}\frac{960}{1000}." text="p _ [balanced] * x = p * conditional@(x, C) * p * C = (((N - 1) binomial (n - 1)) / (N binomial n)) * ((999 binomial 959) / (1000 binomial 960)) = (n / N) * (960 / 1000)" xml:id="A7.Ex29.m1">
          <XMath>
            <XMDual>
              <XMRef idref="A7.Ex29.m1.19"/>
              <XMWrap>
                <XMApp xml:id="A7.Ex29.m1.19">
                  <XMTok meaning="multirelation"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMText><text fontsize="70%">balanced</text></XMText>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A7.Ex29.m1.17"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A7.Ex29.m1.17">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="A7.Ex29.m1.19.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A7.Ex29.m1.19.1">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" role="UNKNOWN">C</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="A7.Ex29.m1.18"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A7.Ex29.m1.18">C</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex29.m1.1"/>
                          <XMRef idref="A7.Ex29.m1.2"/>
                          <XMRef idref="A7.Ex29.m1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex29.m1.13">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex29.m1.1"/>
                            <XMApp xml:id="A7.Ex29.m1.2">
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp xml:id="A7.Ex29.m1.3">
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex29.m1.4"/>
                          <XMRef idref="A7.Ex29.m1.5"/>
                          <XMRef idref="A7.Ex29.m1.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex29.m1.14">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex29.m1.4"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A7.Ex29.m1.5">N</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A7.Ex29.m1.6">n</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex29.m1.7"/>
                          <XMRef idref="A7.Ex29.m1.8"/>
                          <XMRef idref="A7.Ex29.m1.9"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex29.m1.15">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex29.m1.7"/>
                            <XMTok fontsize="70%" meaning="999" role="NUMBER" xml:id="A7.Ex29.m1.8">999</XMTok>
                            <XMTok fontsize="70%" meaning="959" role="NUMBER" xml:id="A7.Ex29.m1.9">959</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex29.m1.10"/>
                          <XMRef idref="A7.Ex29.m1.11"/>
                          <XMRef idref="A7.Ex29.m1.12"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex29.m1.16">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex29.m1.10"/>
                            <XMTok fontsize="70%" meaning="1000" role="NUMBER" xml:id="A7.Ex29.m1.11">1000</XMTok>
                            <XMTok fontsize="70%" meaning="960" role="NUMBER" xml:id="A7.Ex29.m1.12">960</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok meaning="960" role="NUMBER">960</XMTok>
                      <XMTok meaning="1000" role="NUMBER">1000</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PERIOD">.</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>Under class-imbalanced sampling, the probability of sampling <Math mode="inline" tex="x" text="x" xml:id="A7.p1.m12">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> can be factored as</p>
      <equation xml:id="A7.Ex30">
        <Math mode="display" tex="p_{\text{imbalanced}}(x)=p(x|C)p(C)=\frac{{N-1\choose 480\cdot n-1}}{{N\choose&#10;4%&#10;80\cdot n}}\frac{{999\choose 1}}{{1000\choose 2}}=\frac{480\cdot n}{N}\frac{2}%&#10;{1000}," text="p _ [imbalanced] * x = p * conditional@(x, C) * p * C = (((N - 1) binomial (480 cdot n - 1)) / (N binomial (480 cdot n))) * ((999 binomial 1) / (1000 binomial 2)) = ((480 cdot n) / N) * (2 / 1000)" xml:id="A7.Ex30.m1">
          <XMath>
            <XMDual>
              <XMRef idref="A7.Ex30.m1.19"/>
              <XMWrap>
                <XMApp xml:id="A7.Ex30.m1.19">
                  <XMTok meaning="multirelation"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMText><text fontsize="70%">imbalanced</text></XMText>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A7.Ex30.m1.17"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A7.Ex30.m1.17">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="A7.Ex30.m1.19.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A7.Ex30.m1.19.1">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" role="UNKNOWN">C</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="A7.Ex30.m1.18"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A7.Ex30.m1.18">C</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex30.m1.1"/>
                          <XMRef idref="A7.Ex30.m1.2"/>
                          <XMRef idref="A7.Ex30.m1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex30.m1.13">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex30.m1.1"/>
                            <XMApp xml:id="A7.Ex30.m1.2">
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp xml:id="A7.Ex30.m1.3">
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" name="cdot" role="MULOP">⋅</XMTok>
                                <XMTok fontsize="70%" meaning="480" role="NUMBER">480</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex30.m1.4"/>
                          <XMRef idref="A7.Ex30.m1.5"/>
                          <XMRef idref="A7.Ex30.m1.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex30.m1.14">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex30.m1.4"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A7.Ex30.m1.5">N</XMTok>
                            <XMApp xml:id="A7.Ex30.m1.6">
                              <XMTok fontsize="70%" name="cdot" role="MULOP">⋅</XMTok>
                              <XMTok fontsize="70%" meaning="480" role="NUMBER">480</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex30.m1.7"/>
                          <XMRef idref="A7.Ex30.m1.8"/>
                          <XMRef idref="A7.Ex30.m1.9"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex30.m1.15">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex30.m1.7"/>
                            <XMTok fontsize="70%" meaning="999" role="NUMBER" xml:id="A7.Ex30.m1.8">999</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="A7.Ex30.m1.9">1</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A7.Ex30.m1.10"/>
                          <XMRef idref="A7.Ex30.m1.11"/>
                          <XMRef idref="A7.Ex30.m1.12"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A7.Ex30.m1.16">
                            <XMTok mathstyle="text" meaning="binomial" role="FRACOP" thickness="0pt" xml:id="A7.Ex30.m1.10"/>
                            <XMTok fontsize="70%" meaning="1000" role="NUMBER" xml:id="A7.Ex30.m1.11">1000</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="A7.Ex30.m1.12">2</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok meaning="480" role="NUMBER">480</XMTok>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMTok meaning="1000" role="NUMBER">1000</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>from which it is clear that <Math mode="inline" tex="p_{\text{balanced}}(x)" text="p _ [balanced] * x" xml:id="A7.p1.m13">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMText><text fontsize="70%">balanced</text></XMText>
              </XMApp>
              <XMDual>
                <XMRef idref="A7.p1.m13.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A7.p1.m13.1">x</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is equal to <Math mode="inline" tex="p_{\text{imbalanced}}(x)" text="p _ [imbalanced] * x" xml:id="A7.p1.m14">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMText><text fontsize="70%">imbalanced</text></XMText>
              </XMApp>
              <XMDual>
                <XMRef idref="A7.p1.m14.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A7.p1.m14.1">x</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
  </appendix>
  <appendix inlist="toc" labels="LABEL:apndx:rcdm" xml:id="A8">
    <tags>
      <tag>Appendix H</tag>
      <tag role="autoref">Appendix H</tag>
      <tag role="refnum">H</tag>
      <tag role="typerefnum">Appendix H</tag>
    </tags>
    <title><tag close=" ">Appendix H</tag>Visualizing prototypes with rcdm</title>
    <toctitle><tag close=" ">H</tag>Visualizing prototypes with rcdm</toctitle>
    <para xml:id="A8.p1">
      <p>We use the RCDM framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> to visualize the representations and prototypes learned with MSN. RCDM trains a conditional generative diffusion model, which maps a noise vector to pixel space using a neural network representation as conditioning. Many works <cite class="ltx_citemacro_citep">(<bibref bibrefs="dale2,imagen" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> have demonstrated the potential of conditional diffusion model for image generation, however they are also very useful, as highlighted by <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> to get a better understanding of what is learned by neural networks.</p>
    </para>
    <para xml:id="A8.p2">
      <p>During training, RCDM takes as input a noisy image <Math mode="inline" tex="\hat{x}_{t}" text="(hat@(x)) _ t" xml:id="A8.p2.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
              </XMApp>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> (corrupted with an <Math mode="inline" tex="\epsilon_{t}" text="epsilon _ t" xml:id="A8.p2.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> noise vector such as <Math mode="inline" tex="\hat{x}_{t}={\bm{x}}+\epsilon_{t}" text="(hat@(x)) _ t = x + epsilon _ t" xml:id="A8.p2.m3">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>) and the representation vector <Math mode="inline" tex="{\bm{y}}" text="y" xml:id="A8.p2.m4">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> computed by MSN of the image <Math mode="inline" tex="{\bm{x}}" text="x" xml:id="A8.p2.m5">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>. Then, RCDM is train, with a denoising score matching loss <cite class="ltx_citemacro_citep">(<bibref bibrefs="vincent2011connection,ddpm_2020" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, to reconstruct the image <Math mode="inline" tex="{\bm{x}}" text="x" xml:id="A8.p2.m6">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> that was used to compute the representation vector <Math mode="inline" tex="{\bm{y}}" text="y" xml:id="A8.p2.m7">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math>. More formally, we define a RCDM neural network <Math mode="inline" tex="g_{\eta}(\hat{x}_{t},{\bm{y}})" text="g _ eta * open-interval@((hat@(x)) _ t, y)" xml:id="A8.p2.m8">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok font="italic" fontsize="70%" name="eta" role="UNKNOWN">η</XMTok>
              </XMApp>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A8.p2.m8.2"/>
                  <XMRef idref="A8.p2.m8.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="A8.p2.m8.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN" xml:id="A8.p2.m8.1">y</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> that learns to predict the noise component <Math mode="inline" tex="\epsilon_{t}" text="epsilon _ t" xml:id="A8.p2.m9">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> of <Math mode="inline" tex="\hat{x}_{t}" text="(hat@(x)) _ t" xml:id="A8.p2.m10">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
              </XMApp>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math>, ie. by minimizing <Math mode="inline" tex="\|g_{\eta}(\hat{x}_{t},{\bm{y}})-\epsilon_{t}\|_{2}^{2}" text="((norm@(g _ eta * open-interval@((hat@(x)) _ t, y) - epsilon _ t)) _ 2) ^ 2" xml:id="A8.p2.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="norm"/>
                    <XMRef idref="A8.p2.m11.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="||" role="OPEN">‖</XMTok>
                    <XMApp xml:id="A8.p2.m11.2">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">g</XMTok>
                          <XMTok font="italic" fontsize="70%" name="eta" role="UNKNOWN">η</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A8.p2.m11.2.1"/>
                            <XMRef idref="A8.p2.m11.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A8.p2.m11.2.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="bold italic" role="UNKNOWN" xml:id="A8.p2.m11.1">y</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok name="||" role="CLOSE">‖</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
            </XMApp>
          </XMath>
        </Math>. As demonstrated by <cite class="ltx_citemacro_citep">(<bibref bibrefs="bordes2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, RCDM extract as many information as possible from the representation vector <Math mode="inline" tex="{\bm{y}}" text="y" xml:id="A8.p2.m12">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> in order to reconstruct faithfully the image.</p>
    </para>
<!--  %Specifically, conditional diffusion model samples from a distribution by reversing a gradual noising process. Sampling starts with noise $“vx˙T$ and a conditioning vector $“vy$ and produces gradually less-noisy samples $“vx˙–T-1˝, “vx˙–T-2˝$ until generating a sample $“vx˙0$. In, RCDM, the diffusion process is parameterized by a neural network $g˙–“eta˝(“vx˙–t˝, “vy)$ which learns to generate a less noisy sample $“vx˙–t-1˝$ from $“vx˙t$ by predicting the noise component $“epsilon$ of $“vx˙t$, ie. by minimizing $“—g˙–“eta˝(“vx˙–t˝, “vy) - “epsilon“—˙2^2$ -->    <para xml:id="A8.p3">
      <p><!--  %**** main.tex Line 925 **** -->The conditioning vector <Math mode="inline" tex="{\bm{y}}" text="y" xml:id="A8.p3.m1">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> is computed from <Math mode="inline" tex="{\bm{x}}" text="x" xml:id="A8.p3.m2">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> using a pretrained and frozen MSN model.
MSN generates as output the probability distribution <Math mode="inline" tex="{\bm{p}}" text="p" xml:id="A8.p3.m3">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
          </XMath>
        </Math> that an image <Math mode="inline" tex="{\bm{x}}" text="x" xml:id="A8.p3.m4">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> belongs to a given cluster, <Math class="ltx_math_unparsed" mode="inline" tex="{\bm{p}}=\text{softmax}({\bm{W}}^{t}p_{\gamma}(f_{\theta}({\bm{x}}))" xml:id="A8.p3.m5">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">p</XMTok>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMText>softmax</XMText>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="bold italic" role="UNKNOWN" xml:id="A8.p3.m5.1">x</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMWrap>
          </XMath>
        </Math> where <Math mode="inline" tex="{\bm{W}}" text="W" xml:id="A8.p3.m6">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
          </XMath>
        </Math> is the matrix concatenating all the prototypes (or cluster centroids), <Math mode="inline" tex="p_{\gamma}" text="p _ gamma" xml:id="A8.p3.m7">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
            </XMApp>
          </XMath>
        </Math> the projection head and <Math mode="inline" tex="f_{\theta}" text="f _ theta" xml:id="A8.p3.m8">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
            </XMApp>
          </XMath>
        </Math> the encoder. To visualize the prototype contained in <Math mode="inline" tex="{\bm{W}}" text="W" xml:id="A8.p3.m9">
          <XMath>
            <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
          </XMath>
        </Math>, we first train a conditional generative diffusion model that take the last linear layer input as conditioning, i.e <Math mode="inline" tex="{\bm{y}}=p_{\gamma}(f_{\theta}({\bm{x}}))" text="y = p _ gamma * f _ theta * x" xml:id="A8.p3.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="bold italic" role="UNKNOWN">y</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="A8.p3.m10.2"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A8.p3.m10.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">f</XMTok>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A8.p3.m10.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="bold italic" role="UNKNOWN" xml:id="A8.p3.m10.1">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.
After training, we replace the image embedding with a learned prototype and generate the corresponding output in pixel space by setting <Math mode="inline" tex="{\bm{y}}={\bm{W}}_{i}" text="y = W _ i" xml:id="A8.p3.m11">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="bold italic" role="UNKNOWN">y</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" role="UNKNOWN">W</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, where <Math mode="inline" tex="i" text="i" xml:id="A8.p3.m12">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">i</XMTok>
          </XMath>
        </Math> is randomly selected.</p>
    </para>
    <para xml:id="A8.p4">
      <p>To summarize, we gather for every images in the training set their embedding (with dimension size of 256)<note mark="4" role="footnote" xml:id="footnote4"><tags>
            <tag>4</tag>
            <tag role="autoref">footnote 4</tag>
            <tag role="refnum">4</tag>
            <tag role="typerefnum">footnote 4</tag>
          </tags>the one that is use to perform the clustering with respect to the prototypes</note> of a trained MSN model. Then, we use these embedding as conditioning for RCDM which is train to reconstruct the corresponding image associated to a given embedding. When training is complete, we replace the projector’s embedding by the prototype learned with MSN (which also have a dimension of 256). By doing so we can visualize which information is associated to each prototype (or cluster) learned with MSN. For every RCDM training, we used the same defaults settings as the ones on <ref class="ltx_url" font="typewriter" href="https://github.com/facebookresearch/RCDM">https://github.com/facebookresearch/RCDM</ref>. We train each network for 200000 iterations.</p>
    </para>
<!--  %In Figure “ref–fig:visu˙rcdm˙imagenet˙condimage˝, we show additional samples with RCDM where instead of using prototypes for conditioning, we show how the samples look like when using $y = “mW^t p˙“gamma(f˙“theta(x))$ directly. When training MSN with balance data, the generated samples belong to the sample class as the image used for conditioning which is not the case when using MSN trained with unbalanced data. This conclusion was also reached in the Figure “ref–fig:visu˙rcdm˙sampling˝ when visualizing prototype directly. 
     %“begin–figure˝[h] 
     %“begin–subfigure˝–“textwidth˝ 
     %“centering 
     %“includegraphics[width=“textwidth]–assets/RCDM˙MSNv2˙condimages˙balanced.pdf˝ 
     %“caption–MSN trained on balanced data.˝ 
     %“end–subfigure˝ 
     %“begin–subfigure˝–“textwidth˝ 
     %“centering 
     %“includegraphics[width=“textwidth]–assets/RCDM˙MSNv2˙condimages.pdf˝ 
     %“caption–MSN trained on unbalanced data.˝ 
     %“label–fig:visu˙rcdm˙imagenet˙condimage˝ 
     %“end–subfigure˝ 
     %“caption–Visualization of samples generated by RCDM when conditioning on the representation given by MSN on the images in the first column. Subsequent columns correspond to different seed for the generative model. When using as conditioning, representations from an MSN trained with balance data, we can see that the generated samples belong to the same class as the image used for conditioning. However when using MSN trained with unbalanced data, the samples don’t belong to the same class anymore but share more low level features.˝ 
     %“end–figure˝ -->  </appendix>
  <appendix inlist="toc" labels="LABEL:apndx:classstratified_results" xml:id="A9">
    <tags>
      <tag>Appendix I</tag>
      <tag role="autoref">Appendix I</tag>
      <tag role="refnum">I</tag>
      <tag role="typerefnum">Appendix I</tag>
    </tags>
    <title><tag close=" ">Appendix I</tag>Full set of results for section <ref labelref="LABEL:sec:class_stratified"/></title>
    <toctitle><tag close=" ">I</tag>Full set of results for section <ref labelref="LABEL:sec:class_stratified"/></toctitle>
    <para xml:id="A9.p1">
      <p>In this section, we report the full experimental results for Section <ref labelref="LABEL:sec:class_stratified"/>.
Tables <ref labelref="LABEL:tb:simclr"/>, <ref labelref="LABEL:tb:msn"/>,<ref labelref="LABEL:tb:vicreg"/>, <ref labelref="LABEL:tb:data2vec"/> and  <ref labelref="LABEL:tb:mae"/>, and  show the results of SimCLR, MSN, VICReg, data2vec and MAE on the CIFAR100, CIFAR100 <Math mode="inline" tex="1\%" text="1percent" xml:id="A9.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="percent" role="POSTFIX">%</XMTok>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math>, Place205, Clevr/Count, Clevr/Dist and KITTI downstream tasks. Additionaly, we reports performance on ImageNet linear and ImageNet low-shot <Math mode="inline" tex="1\%" text="1percent" xml:id="A9.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="percent" role="POSTFIX">%</XMTok>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> in Tables <ref labelref="LABEL:tb:indistribution"/> and <ref labelref="LABEL:tb:indistribution_lowshot"/>. Figure <ref labelref="LABEL:fig:visu_class_stratified"/> shows a summary of the main results.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:visu_class_stratified" placement="t" xml:id="A9.F5">
      <tags>
        <tag><text fontsize="90%">Figure 5</text></tag>
        <tag role="autoref">Figure 5</tag>
        <tag role="refnum">5</tag>
        <tag role="typerefnum">Figure 5</tag>
      </tags>
      <graphics candidates="assets/balanced_vs_imbalanced.pdf" class="ltx_centering" graphic="assets/balanced_vs_imbalanced.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="A9.F5.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">5</tag>Visual representations of the results of Table <ref labelref="LABEL:tb:class_stratified_sampling"/>. Methods relying on volume maximization regularizers all exhibit similar performance alteration across diverse transfer tasks.</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 5</text></tag><text fontsize="90%">Visual representations of the results of Table <ref labelref="LABEL:tb:class_stratified_sampling"/>. Methods relying on volume maximization regularizers all exhibit similar performance alteration across diverse transfer tasks.</text></caption>
    </figure>
    <table inlist="lot" labels="LABEL:tb:data2vec LABEL:tb:indistribution LABEL:tb:indistribution_lowshot LABEL:tb:mae LABEL:tb:msn LABEL:tb:simclr LABEL:tb:vicreg" placement="h" xml:id="A9.T11">
      <tags>
        <tag><text fontsize="90%">Table 11</text></tag>
        <tag role="autoref">Table 11</tag>
        <tag role="refnum">11</tag>
        <tag role="typerefnum">Table 11</tag>
      </tags>
      <toccaption><tag close=" "><text fontsize="80%">5</text></tag><text font="bold" fontsize="80%">SimCLR</text><text fontsize="80%">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a significant drop in image classification tasks.</text></toccaption>
      <caption fontsize="80%"><tag close=": "><text fontsize="113%">Table 5</text></tag><text font="bold" fontsize="113%">SimCLR<text font="medium">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a significant drop in image classification tasks.</text></text></caption>
      <tabular class="ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100 </text><Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m1">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
            <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt"><text fontsize="80%">960 cls per batch</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">69.9</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">31.4</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">52.1</text></td>
            <td align="center" border="r tt tt"><text fontsize="80%">77.4</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">65.5</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">70.5</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><text fontsize="80%">8 cls per batch</text></td>
            <td align="center"><text fontsize="80%">63.4</text></td>
            <td align="center"><text fontsize="80%">21.25</text></td>
            <td align="center"><text fontsize="80%">47.1</text></td>
            <td align="center" border="r"><text fontsize="80%">73.8</text></td>
            <td align="center"><text fontsize="80%">66.5</text></td>
            <td align="center"><text fontsize="80%">71.7</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m2">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-6.4</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-10.2</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-5.2</text></td>
            <td align="center" border="r"><text color="#FF0000" fontsize="80%">-4.3</text></td>
            <td align="center"><text fontsize="80%">+0.9</text></td>
            <td align="center"><text fontsize="80%">+1.2</text></td>
          </tr>
        </tbody>
      </tabular>
      <toccaption><tag close=" "><text fontsize="80%">6</text></tag><text font="bold" fontsize="80%">MSN</text><text fontsize="80%">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a significant drop in image classification tasks.</text></toccaption>
      <caption fontsize="80%"><tag close=": "><text fontsize="113%">Table 6</text></tag><text font="bold" fontsize="113%">MSN<text font="medium">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a significant drop in image classification tasks.</text></text></caption>
      <tabular class="ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100 </text><Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m3">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
            <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt"><text fontsize="80%">960 cls per batch</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">84.3</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">46.2</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">81.0</text></td>
            <td align="center" border="r tt tt"><text fontsize="80%">56.7</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">63.7</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">73.2</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><text fontsize="80%">2 cls per batch</text></td>
            <td align="center"><text fontsize="80%">71.4</text></td>
            <td align="center"><text fontsize="80%">26.4</text></td>
            <td align="center"><text fontsize="80%">76.4</text></td>
            <td align="center" border="r"><text fontsize="80%">50.3</text></td>
            <td align="center"><text fontsize="80%">65.6</text></td>
            <td align="center"><text fontsize="80%">71.5</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m4">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-12.9</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-13.2</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-4.6</text></td>
            <td align="center" border="r"><text color="#FF0000" fontsize="80%">-6.4</text></td>
            <td align="center"><text fontsize="80%">+1.9</text></td>
            <td align="center"><text fontsize="80%">-1.6</text></td>
          </tr>
        </tbody>
      </tabular>
      <toccaption><tag close=" "><text fontsize="80%">7</text></tag><text font="bold" fontsize="80%">VICReg</text><text fontsize="80%">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a significant drop in image classification tasks.</text></toccaption>
      <caption fontsize="80%"><tag close=": "><text fontsize="113%">Table 7</text></tag><text font="bold" fontsize="113%">VICReg<text font="medium">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a significant drop in image classification tasks.</text></text></caption>
      <tabular class="ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100 </text><Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m5">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
            <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt"><text fontsize="80%">960 cls per batch</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">69.7</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">28.9</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">51.0</text></td>
            <td align="center" border="r tt tt"><text fontsize="80%">79.8</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">69.0</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">73.3</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><text fontsize="80%">2 cls per batch</text></td>
            <td align="center"><text fontsize="80%">60.8</text></td>
            <td align="center"><text fontsize="80%">16.9</text></td>
            <td align="center"><text fontsize="80%">44.9</text></td>
            <td align="center" border="r"><text fontsize="80%">76.8</text></td>
            <td align="center"><text fontsize="80%">69.84</text></td>
            <td align="center"><text fontsize="80%">72.1</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m6">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-8.9</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-12.0</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-6.0</text></td>
            <td align="center" border="r"><text color="#FF0000" fontsize="80%">-3.0</text></td>
            <td align="center"><text fontsize="80%">+0.7</text></td>
            <td align="center"><text fontsize="80%">-1.1</text></td>
          </tr>
        </tbody>
      </tabular>
      <toccaption><tag close=" "><text fontsize="80%">8</text></tag><text font="bold" fontsize="80%">data2vec</text><text fontsize="80%">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a similar performances across tasks.</text></toccaption>
      <caption fontsize="80%"><tag close=": "><text fontsize="113%">Table 8</text></tag><text font="bold" fontsize="113%">data2vec<text font="medium">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a similar performances across tasks.</text></text></caption>
      <tabular class="ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100 </text><Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m7">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
            <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt"><text fontsize="80%">960 cls per batch</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">50.3</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">13.7</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">37.0</text></td>
            <td align="center" border="r tt tt"><text fontsize="80%">76.8</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">49.7</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">65.3</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><text fontsize="80%">2 cls per batch</text></td>
            <td align="center"><text fontsize="80%">48.6</text></td>
            <td align="center"><text fontsize="80%">13.1</text></td>
            <td align="center"><text fontsize="80%">37.0</text></td>
            <td align="center" border="r"><text fontsize="80%">74.7</text></td>
            <td align="center"><text fontsize="80%">48.2</text></td>
            <td align="center"><text fontsize="80%">65.1</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m8">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text fontsize="80%">-1.7</text></td>
            <td align="center"><text fontsize="80%">-0.5</text></td>
            <td align="center"><text fontsize="80%">0</text></td>
            <td align="center" border="r"><text color="#FF0000" fontsize="80%">-2.1</text></td>
            <td align="center"><text fontsize="80%">+1.5</text></td>
            <td align="center"><text fontsize="80%">-0.2</text></td>
          </tr>
        </tbody>
      </tabular>
      <toccaption><tag close=" "><text fontsize="80%">9</text></tag><text font="bold" fontsize="80%">MAE</text><text fontsize="80%">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a similar performance across tasks.</text></toccaption>
      <caption fontsize="80%"><tag close=": "><text fontsize="113%">Table 9</text></tag><text font="bold" fontsize="113%">MAE<text font="medium">: Evaluation of the mini-batch sampling distribution on various downstream task. Sampling imbalanced mini-batches lead to a similar performance across tasks.</text></text></caption>
      <tabular class="ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">CIFAR100 </text><Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m9">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Place205</text></td>
            <td align="center" border="r tt" thead="column"><text fontsize="80%">Clevr/Count</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">Clevr/Dist</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">KITTI</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt"><text fontsize="80%">960 cls per batch</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">75.0</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">28.3</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">50.4</text></td>
            <td align="center" border="r tt tt"><text fontsize="80%">90.4</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">72.4</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">70.0</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><text fontsize="80%">2 cls per batch</text></td>
            <td align="center"><text fontsize="80%">75.4</text></td>
            <td align="center"><text fontsize="80%">30.8</text></td>
            <td align="center"><text fontsize="80%">50.3</text></td>
            <td align="center" border="r"><text fontsize="80%">89.6</text></td>
            <td align="center"><text fontsize="80%">71.7</text></td>
            <td align="center"><text fontsize="80%">70.0</text></td>
          </tr>
          <tr>
            <td align="right" border="r"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m10">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text fontsize="80%">+0.4</text></td>
            <td align="center"><text fontsize="80%">+2.5</text></td>
            <td align="center"><text fontsize="80%">-0.1</text></td>
            <td align="center" border="r"><text fontsize="80%">-0.8</text></td>
            <td align="center"><text fontsize="80%">-0.7</text></td>
            <td align="center"><text fontsize="80%">+0.0</text></td>
          </tr>
        </tbody>
      </tabular>
      <toccaption><tag close=" "><text fontsize="80%">10</text></tag><text font="bold" fontsize="80%">In-distribution:</text><text fontsize="80%"> Evaluation of the mini-batch sampling distribution on in-distribution ImageNet linear evaluation using </text><Math mode="inline" tex="100\%" text="100percent" xml:id="A9.T11.m11">
          <XMath>
            <XMApp>
              <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
              <XMTok fontsize="80%" meaning="100" role="NUMBER">100</XMTok>
            </XMApp>
          </XMath>
        </Math><text fontsize="80%"> of the training set.</text></toccaption>
      <caption fontsize="80%"><tag close=": "><text fontsize="113%">Table 10</text></tag><text font="bold" fontsize="113%">In-distribution:<text font="medium"> Evaluation of the mini-batch sampling distribution on in-distribution ImageNet linear evaluation using <Math mode="inline" tex="100\%" text="100percent" xml:id="A9.T11.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                  <XMTok meaning="100" role="NUMBER">100</XMTok>
                </XMApp>
              </XMath>
            </Math> of the training set.</text></text></caption>
      <tabular class="ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column row"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">SimCLR</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">MSN</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">VICReg</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">data2vec</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">MAE</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt" thead="row"><text fontsize="80%">class balanced sampling</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">66.9</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">77.1</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">69.1</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">41.5</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">65.9</text></td>
          </tr>
          <tr>
            <td align="right" border="r" thead="row"><text fontsize="80%">class imbalanced sampling</text></td>
            <td align="center"><text fontsize="80%">55.8</text></td>
            <td align="center"><text fontsize="80%">59.4</text></td>
            <td align="center"><text fontsize="80%">51.4</text></td>
            <td align="center"><text fontsize="80%">40.6</text></td>
            <td align="center"><text fontsize="80%">65.8</text></td>
          </tr>
          <tr>
            <td align="right" border="r" thead="row"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m13">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-11.1</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-17.7</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-17.7</text></td>
            <td align="center"><text fontsize="80%">-0.8</text></td>
            <td align="center"><text fontsize="80%">-0.1</text></td>
          </tr>
        </tbody>
      </tabular>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">11</text></tag><text font="bold" fontsize="80%">In-distribution low-shot:</text><text fontsize="80%"> Evaluation of the mini-batch sampling distribution on in-distribution ImageNet linear evaluation using only </text><Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m14">
          <XMath>
            <XMApp>
              <XMTok fontsize="80%" meaning="percent" role="POSTFIX">%</XMTok>
              <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math><text fontsize="80%"> of the training set.</text></toccaption>
      <caption class="ltx_centering" fontsize="80%"><tag close=": "><text fontsize="113%">Table 11</text></tag><text font="bold" fontsize="113%">In-distribution low-shot:<text font="medium"> Evaluation of the mini-batch sampling distribution on in-distribution ImageNet linear evaluation using only <Math mode="inline" tex="1\%" text="1percent" xml:id="A9.T11.m15">
              <XMath>
                <XMApp>
                  <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math> of the training set.</text></text></caption>
      <tabular class="ltx_centering ltx_figure_panel ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td border="r tt" thead="column row"/>
            <td align="center" border="tt" thead="column"><text fontsize="80%">MSN</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">VICReg</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">data2vec</text></td>
            <td align="center" border="tt" thead="column"><text fontsize="80%">MAE</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="right" border="r tt tt" thead="row"><text fontsize="80%">class balanced sampling</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">66.2</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">48.6</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">27.4</text></td>
            <td align="center" border="tt tt"><text fontsize="80%">35.1</text></td>
          </tr>
          <tr>
            <td align="right" border="r" thead="row"><text fontsize="80%">class imbalanced sampling</text></td>
            <td align="center"><text fontsize="80%">28.0</text></td>
            <td align="center"><text fontsize="80%">18.1</text></td>
            <td align="center"><text fontsize="80%">31.4</text></td>
            <td align="center"><text fontsize="80%">34.8</text></td>
          </tr>
          <tr>
            <td align="right" border="r" thead="row"><Math mode="inline" tex="\Delta" text="Delta" xml:id="A9.T11.m16">
                <XMath>
                  <XMTok fontsize="80%" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-38.2</text></td>
            <td align="center"><text color="#FF0000" fontsize="80%">-30.5</text></td>
            <td align="center"><text fontsize="80%">+4.0</text></td>
            <td align="center"><text fontsize="80%">-0.3</text></td>
          </tr>
        </tbody>
      </tabular>
    </table>
  </appendix>
</document>
