<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-z7O7fk_Cs"?>
<?latexml class="article"?>
<?latexml package="wrapfig"?>
<?latexml package="graphicx"?>
<?latexml package="natbib"?>
<?latexml package="booktabs"?>
<?latexml package="subcaption"?>
<?latexml package="cprotect"?>
<?latexml package="amssymb,amsmath,amsthm,mathtools"?>
<?latexml package="epstopdf"?>
<?latexml package="bbm"?>
<?latexml package="geometry" options="marginratio=1:1,height=600pt,width=460pt,tmargin=100pt"?>
<?latexml package="layout, color"?>
<?latexml package="bbm"?>
<?latexml package="enumerate"?>
<?latexml package="authblk"?>
<?latexml package="algorithmic"?>
<?latexml package="algorithm"?>
<?latexml package="setspace"?>
<?latexml package="hyperref"?>
<?latexml package="url"?>
<?latexml package="caption" options="font=scriptsize"?>
<?latexml package="subcaption" options="font=scriptsize"?>
<?latexml package="mdwlist"?>
<?latexml package="multirow"?>
<?latexml package="amsthm"?>
<?latexml package="color"?>
<?latexml package="makecell"?>
<!--  %**** JKO˙arxiv˙v4.tex Line 50 **** --><?latexml package="array"?>
<?latexml preamble="\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}"?>
<?latexml package="soul"?>
<?latexml package="xcolor"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title>Normalizing flow neural networks by JKO scheme</title>
  <creator role="author">
    <personname>Chen Xu</personname>
    <contact role="affiliation"><text fontsize="90%">H. Milton Stewart School of Industrial and Systems Engineering, Georgia Institute of Technology.</text></contact>
  </creator>
  <creator role="author">
    <personname><!--  %**** JKO˙arxiv˙v4.tex Line 100 **** -->Xiuyuan Cheng</personname>
    <contact role="affiliation"><text fontsize="90%">Department of Mathematics, Duke University</text></contact>
  </creator>
  <creator role="author">
    <personname>Yao Xie</personname>
    <contact role="affiliation"><text fontsize="90%">H. Milton Stewart School of Industrial and Systems Engineering, Georgia Institute of Technology.</text></contact>
  </creator>
  <date role="creation">
</date>
  <abstract name="Abstract">
    <p>Normalizing flow is a class of deep generative models for efficient sampling and likelihood estimation, which achieves attractive performance, particularly in high dimensions. The flow is often implemented using a sequence of invertible residual blocks. Existing works adopt special network architectures and regularization of flow trajectories. In this paper, we develop a neural ODE flow network called JKO-iFlow, inspired by the Jordan-Kinderleherer-Otto (JKO) scheme, which unfolds the discrete-time dynamic of the Wasserstein gradient flow. The proposed method stacks residual blocks one after another, allowing efficient block-wise training of the residual blocks, avoiding sampling SDE trajectories and score matching or variational learning, thus reducing the memory load and difficulty in end-to-end training. We also develop adaptive time reparameterization of the flow network with a progressive refinement of the induced trajectory in probability space to improve the model accuracy further. Experiments with synthetic and real data show that the proposed JKO-iFlow network achieves competitive performance compared with existing flow and diffusion models at a significantly reduced computational and memory cost.</p>
  </abstract>
  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <figure float="right" inlist="lof" labels="LABEL:fig:trajectory" xml:id="S1.F1">
      <tags>
        <tag><text fontsize="90%">Figure 1</text></tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="156.1pt" xml:id="S1.F1.fig1">
        <graphics candidates="JKOFlow_1D_transition_ZtoX.png" graphic="JKOFlow_1D_transition_ZtoX.png" options="width=433.62pt,keepaspectratio=true" xml:id="S1.F1.g1"/>
        <toccaption><tag close=" ">a</tag>JKO-iFlow</toccaption>
        <caption><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">JKO-iFlow</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="156.1pt" xml:id="S1.F1.fig2">
        <graphics candidates="FFJORD_1D_transition_ZtoX.png" graphic="FFJORD_1D_transition_ZtoX.png" options="width=433.62pt,keepaspectratio=true" xml:id="S1.F1.g2"/>
        <toccaption><tag close=" ">b</tag>usual CNF</toccaption>
        <caption><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">usual CNF</text></caption>
      </figure>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>
Comparison of JKO-iFlow (proposed) and standard
CNF models.
In contrast to most existing CNF models,
JKO-iFlow learns the unique deterministic transport equation corresponding to the diffusion process by <text color="#000000">directly performing block-wise</text> training of a neural ODE model.
</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 1</text></tag><text fontsize="90%">
Comparison of JKO-iFlow (proposed) and standard
CNF models.
In contrast to most existing CNF models,
JKO-iFlow learns the unique deterministic transport equation corresponding to the diffusion process by <text color="#000000">directly performing block-wise</text> training of a neural ODE model.
</text></caption>
    </figure>
    <para xml:id="S1.p1">
      <p>Generative models have wide applications in statistics and machine learning to infer data-generating distributions
and to sample from the model distributions learned from the data.
In addition to widely used deep generative models such as variational auto-encoders (VAE) <cite class="ltx_citemacro_cite"><bibref bibrefs="VAE,VAE_review" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>
and generative adversarial networks (GAN) <cite class="ltx_citemacro_cite"><bibref bibrefs="GAN,WassersteinGAN" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>, normalizing flow models <cite class="ltx_citemacro_cite"><bibref bibrefs="nflow_review" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> have been popular and with a great potential. The flow model learns the data distribution via an invertible mapping <Math mode="inline" tex="F" text="F" xml:id="S1.p1.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">F</XMTok>
          </XMath>
        </Math> between the data density <Math mode="inline" tex="p_{X}" text="p _ X" xml:id="S1.p1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
            </XMApp>
          </XMath>
        </Math> in <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="S1.p1.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
            </XMApp>
          </XMath>
        </Math> and the target standard multivariate Gaussian density <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S1.p1.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="Z\sim\mathcal{N}(0,I_{d})" text="Z similar-to N * open-interval@(0, I _ d)" xml:id="S1.p1.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S1.p1.m5.1"/>
                    <XMRef idref="S1.p1.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S1.p1.m5.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S1.p1.m5.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">I</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.
While flow models, once trained, can be utilized for efficient data sampling and explicit likelihood evaluation, training of such models is often difficult in practice. To alleviate such difficulties, many prior works <cite class="ltx_citemacro_citep">(<bibref bibrefs="dinh2015nice,RNVP,kingma2018glow,iResnet,ruthotto2020machine,OT-Flow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, among others, have explored designs of training objectives, network architectures, and computational techniques.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Among various flow models, continuous normalizing flow (CNF) transports the data density to a target distribution through continuous dynamics, primarily neural ODE <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2018neural" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> models. CNF models have shown promising performance on generative tasks <cite class="ltx_citemacro_cite"><bibref bibrefs="FFJORD,nflow_review" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
However, a known computational challenge of CNF models is model regularization, primarily due to the non-uniqueness of the flow transport.
Without additional regularization, the trained CNF model <text color="#000000">such as FFJORD <cite class="ltx_citemacro_cite"><bibref bibrefs="FFJORD" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite></text> may follow a less regular trajectory in the probability space, see Figure <ref labelref="LABEL:fig:trajectory"/>(b),
which may worsen the generative performance.
While regularization of flow models has been developed using different techniques, including using spectral normalization <cite class="ltx_citemacro_cite"><bibref bibrefs="iResnet" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> and optimal transport <cite class="ltx_citemacro_cite"><bibref bibrefs="liutkus2019sliced,OT-Flow,finlay2020train,xu2022invertible,huang2023bridging" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite><!--  %**** JKO˙arxiv˙v4.tex Line 150 **** -->, only using regularization may not resolve the non-uniqueness of the flow.
Besides regularization, several practical difficulties remain when training CNF models, particularly the high computational cost.
In many settings, CNF models consist of stacked blocks, and each can be complex.
<text font="italic">End-to-end training</text> of such deep models often places a high demand on computational resources and memory consumption.</p>
    </para>
    <para xml:id="S1.p3">
      <p>In this work, we propose JKO-iFlow,
an invertible normalizing flow network that unfolds the Wasserstein gradient flow via a neural ODE model inspired by the JKO-scheme <cite class="ltx_citemacro_cite"><bibref bibrefs="jordan1998variational" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
The JKO scheme, see (<ref labelref="LABEL:eq:def-JKO-1"/>), can be viewed as a proximal step
to minimize the Kullback–Leibler (KL) divergence
between the current density and the equilibrium density. It recovers the solution of the Fokker-Planck equation <text color="#000000">(FPE)</text> in the limit of small step size.
The proposed JKO-iFlow model thus can be viewed as trained to learn the <text font="italic">unique</text> transport map following the FPE
which flows from the data distribution toward the normal equilibrium and gives a smooth trajectory of density evolution, see Figure <ref labelref="LABEL:fig:trajectory"/>(a).
Unlike most CNF models, where all the residual blocks are
trained end-to-end,
each block in the JKO-iFlow network implements one step in the JKO scheme <text color="#000000">to learn the deterministic transport map</text> by minimizing an objective of that block given the trained previous blocks.
The block-wise training significantly reduces memory and computational load.
<text color="#000000"><!--  %**** JKO˙arxiv˙v4.tex Line 175 **** -->
Theoretically, with a small step size, the discrete-time transport map approximates the continuous solution of FPE,
which leads to the invertibility of each trained residual block.
This leaves the residual blocks to be completely general, such as graph neural network layers and convolutional neural network layers, depending on the structure of data considered in the problem.
The theoretical need for small step sizes
does not incur a restriction in practice,
whereby one can use step size not exceeding a certain maximum value
when adopting the neural ODE integration.</text>
We further introduce time reparameterization with progressive refinement in computing the flow network, where each block corresponds to a representative point along the density evolution trajectory in the space of probability measures.
<text color="#000000">The algorithm adaptively chooses the number of blocks and step sizes.</text></p>
    </para>
    <para xml:id="S1.p4">
      <p>The proposed approach is related to the diffusion models <cite class="ltx_citemacro_citep">(<bibref bibrefs="song2019generative,ho2020denoising,block2020generative,song2021score" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> yet differs fundamentally in that our approach is a type of flow models, which directly computes the data likelihood, and such likelihood estimation is essential for statistical inference. While the diffusion models can also indirectly obtain likelihood estimation, they are more designed as samplers.
<text color="#000000">In terms of implementation, our approach</text> trains a neural ODE model without SDE sampling (injection of noise) nor learning of score matching.
It also differs from previous works on progressive training of ResNet generative models <cite class="ltx_citemacro_cite"><bibref bibrefs="johnson2019framework,fan2022variational" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> in that the model trains an invertible flow mapping and avoids inner loops of variational learning. We refer to Section <ref labelref="LABEL:related_work"/> for more discussions on related works.
Empirically, JKO-iFlow yields competitive performance as other CNF models with significantly less computation.
The model is also compatible with general equilibrium density <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S1.p4.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> having a parametrized potential <Math mode="inline" tex="V" text="V" xml:id="S1.p4.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">V</XMTok>
          </XMath>
        </Math>, exemplified by the application to the conditional generation setting where <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S1.p4.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> is replaced with Gaussian mixtures <cite class="ltx_citemacro_cite"><bibref bibrefs="xu2022invertible" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.
In summary, the contributions of the work include</p>
    </para>
    <para xml:id="S1.p5">
      <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S1.p5.m1">
          <XMath>
<!--  %**** JKO_arxiv_v4.tex Line 200 **** -->            <XMTok name="bullet" role="MULOP">∙</XMTok>
          </XMath>
        </Math> We propose <text color="#000000">an invertible</text> neural ODE model where each residual block <text color="#000000">corresponds to</text> a JKO step, and the training objective can be computed <text color="#000000">from pushed data samples through the previous blocks.</text>
The residual block has a general form, and the invertibility is ensured due to the regularity and continuity of the approximate solution of the FPE.</p>
    </para>
    <para xml:id="S1.p6">
      <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S1.p6.m1">
          <XMath>
            <XMTok name="bullet" role="MULOP">∙</XMTok>
          </XMath>
        </Math> We develop a block-wise procedure to train the JKO-iFlow model, which can adaptively determine the number of blocks.
We also propose to adaptively reparameterize the computed trajectory in the probability space with refinement, which <text color="#000000">improves the model accuracy and the overall computational efficiency.</text></p>
    </para>
    <para xml:id="S1.p7">
      <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S1.p7.m1">
          <XMath>
            <XMTok name="bullet" role="MULOP">∙</XMTok>
          </XMath>
        </Math>
We show that JKO-iFlow greatly reduces memory and computational cost when achieving competitive or better generative performance
and likelihood estimation
compared to existing flow and diffusion models on simulated and real data.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:related_work" xml:id="S1.SS1">
      <tags>
        <tag>1.1</tag>
        <tag role="autoref">subsection 1.1</tag>
        <tag role="refnum">1.1</tag>
        <tag role="typerefnum">§1.1</tag>
      </tags>
      <title><tag close=" ">1.1</tag>Related works</title>
      <para xml:id="S1.SS1.p1">
        <p>For deep generative models, popular approaches include generative adversarial networks (GAN) <cite class="ltx_citemacro_citep">(<bibref bibrefs="GAN,WassersteinGAN,CGAN" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and variational auto-encoder (VAE)<cite class="ltx_citemacro_citep">(<bibref bibrefs="VAE,VAE_review" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Apart from known training difficulties (e.g., mode collapse <cite class="ltx_citemacro_citep">(<bibref bibrefs="Salimans2016ImprovedTF" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and posterior collapse <cite class="ltx_citemacro_citep">(<bibref bibrefs="Lucas2019UnderstandingPC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite><!--  %**** JKO˙arxiv˙v4.tex Line 225 **** -->), these models do not provide likelihood or inference of data density.
The normalizing flow framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="nflow_review" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> has been extensively developed, including continuous flow <cite class="ltx_citemacro_citep">(<bibref bibrefs="FFJORD" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, Monge-Ampere flow <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhang2018monge" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, discrete flow <cite class="ltx_citemacro_citep">(<bibref bibrefs="ResFlow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
<text color="#000000">and extension to non-Euclidean data <cite class="ltx_citemacro_citep">(<bibref bibrefs="liu2019graph,mathieu2020riemannian,xu2022invertible" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite>.</text>
Efforts have been made to develop novel invertible mapping structures <cite class="ltx_citemacro_citep">(<bibref bibrefs="RNVP,papamakarios2017masked" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>
and regularize the flow trajectories <text color="#000000">by transport cost </text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="finlay2020train,OT-Flow,ruthotto2020machine,xu2022invertible,huang2023bridging" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Despite such efforts, the model and computational challenges of normalizing flow models include regularization and the large model size when using a large number of residual blocks, which cannot be determined a priori, and the associated memory and computational load.</p>
      </para>
      <para xml:id="S1.SS1.p2">
        <p>In parallel to continuous normalizing flows, which are neural ODE models, neural SDE models become an emerging tool for generative tasks. Diffusion process and Langevin dynamics in deep generative models have been studied in score-based generative models <cite class="ltx_citemacro_citep">(<bibref bibrefs="song2019generative,ho2020denoising,block2020generative,song2021score" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> under different settings.
Specifically, these models estimate the score function
(i.e., the gradient of the log probability density with respect to data) of data distribution via neural network parametrization, which may encounter challenges in learning and sampling high dimensional data and call for special techniques <cite class="ltx_citemacro_citep">(<bibref bibrefs="song2019generative" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
The recent work of <cite class="ltx_citemacro_cite"><bibref bibrefs="song2021score" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> developed reverse-time SDE sampling for score-based generative models
and adopted the connection to neural ODE to compute the likelihood; using the same idea of backward SDE, <cite class="ltx_citemacro_cite"><bibref bibrefs="zhang2021diffusion" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> proposed joint training of forward and backward neural SDEs. Theoretically, latent diffusion <cite class="ltx_citemacro_cite"><bibref bibrefs="tzen2019theoretical,tzen2019neural" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> was used to analyze neural SDE models.
The current work focuses on a neural ODE model where the deterministic vector field <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S1.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S1.SS1.p2.m1.1"/>
                    <XMRef idref="S1.SS1.p2.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p2.m1.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p2.m1.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is to be learned from data following a JKO scheme of the FPE.
Rather than neural SDE, our approach involves no sampling of SDE trajectories nor learning of the score function, and it learns an invertible residual network directly.
In contrast, diffusion-based models derive the ODE model from the learned diffusion model to achieve explicit likelihood computation.
For example, <cite class="ltx_citemacro_cite"><bibref bibrefs="song2021score" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> derived neural ODE model
from the learned score function of the diffused data marginal distributions for all <Math mode="inline" tex="t" text="t" xml:id="S1.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math>.
We experimentally obtain competitive or improved performance against the diffusion model on simulated two-dimensional and high-dimensional tabular data.</p>
      </para>
      <para xml:id="S1.SS1.p3">
        <p><!--  %**** JKO˙arxiv˙v4.tex Line 250 **** -->JKO-inspired deep models have been studied in several recent works.
<cite class="ltx_citemacro_citep">(<bibref bibrefs="bunne2022proximal" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> reformulated the JKO step
for minimizing an energy function over convex functions.
JKO scheme has also been used to discretize Wasserstein gradient flow to learn a deep generative model in <cite class="ltx_citemacro_citep">(<bibref bibrefs="alvarez-melis2022optimizing,mokrov2021large" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
which adopted input convex neural networks (ICNN) <cite class="ltx_citemacro_citep">(<bibref bibrefs="amos2017input" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
ICNN, as a special type of network architecture,
may have limited expressiveness <cite class="ltx_citemacro_citep">(<bibref bibrefs="rout2022generative,korotin2021wasserstein" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
In addition to using the gradient of ICNN,
<cite class="ltx_citemacro_citep">(<bibref bibrefs="fan2022variational" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> proposed parametrizing the transport in a JKO step by a residual network but identified difficulty in calculating the push-forward distribution.
The approach in <cite class="ltx_citemacro_citep">(<bibref bibrefs="fan2022variational" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> also relies on a variational formulation, which requires training an additional network similar to the discriminator in GAN using inner loops.
The idea of progressive additive learning in training generative ResNet, namely training ResNet block-wisely by a variational loss, dates back to <cite class="ltx_citemacro_cite"><bibref bibrefs="johnson2019framework" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> under the GAN framework.
Our method trains an invertible neural-ODE flow network that flows from data density to the normal one and backward, which enables the computation of model likelihood as in other neural-ODE approaches.
The objective in each JKO step to minimize KL divergence can also be computed directly without any inner-loop training, see Section <ref labelref="LABEL:sec:algo"/>.</p>
      </para>
      <para xml:id="S1.SS1.p4">
        <p>Compared to score-based neural SDE methods, our approach is closer to the more recent flow-based models related to diffusion models <cite class="ltx_citemacro_citep">(<bibref bibrefs="lipman2023flow,albergo2023building,boffi2023probability" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. These works proposed to learn the transport equation (a deterministic ODE) corresponding to the SDE process.
Specifically, <cite class="ltx_citemacro_citep">(<bibref bibrefs="lipman2023flow,albergo2023building" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> matched the velocity field from interpolated distributions between initial and terminal ones;
<cite class="ltx_citemacro_citep">(<bibref bibrefs="boffi2023probability" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> proposed to learn the score <Math mode="inline" tex="\nabla\log\rho_{t}(x)" text="(nabla@(logarithm))@(rho _ t) * x" xml:id="S1.SS1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMApp>
                    <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMRef idref="S1.SS1.p4.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S1.SS1.p4.m1.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> (where <Math mode="inline" tex="\rho_{t}" text="rho _ t" xml:id="S1.SS1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> solves the FPE and is unknown <text font="italic">a priori</text>) to solve high-dimensional FPE.
Using Stein’s identity (which is equivalent to the derivation in Section <ref labelref="LABEL:subsec:optimal-f"/>), the step-wise training objective in <cite class="ltx_citemacro_citep">(<bibref bibrefs="boffi2023probability" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite><!--  %**** JKO˙arxiv˙v4.tex Line 275 **** --> optimizes to learn the score without the need to simulate the entire SDE.
The idea of approximating the solution of FPE by a deterministic transport equation dates back to the 90s <cite class="ltx_citemacro_cite"><bibref bibrefs="degond1990deterministic,degond1989weighted" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>,
and has been used in kernel-based solver of FPE in <cite class="ltx_citemacro_citep">(<bibref bibrefs="maoutsa2020interacting" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and studied via a self-consistency equation in <cite class="ltx_citemacro_citep">(<bibref bibrefs="shen2022self" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
While our approach learns an equivalent velocity field at the infinitesimal time step, see section <ref labelref="LABEL:subsec:optimal-f"/>, the formulation in JKO-iFlow is at a finite time-step motivated by the JKO scheme.
We also mention that an independent concurrent work <cite class="ltx_citemacro_citep">(<bibref bibrefs="vidal2023taming" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> proposed a similar block-wise training algorithm using the JKO scheme under the framework of <cite class="ltx_citemacro_citep">(<bibref bibrefs="OT-Flow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>
and demonstrated benefits in avoiding tuning the penalty hyperparameter associated with the KL-divergence objective.
Our model is applied to generative tasks of high-dimensional data, including image data, and we also develop additional techniques for computing the flow probability trajectory.</p>
      </para>
      <para xml:id="S1.SS1.p5">
        <p>For the expressiveness of deep generative models,
approximation properties of deep neural networks for representing probability distributions have been developed in several works.
<cite class="ltx_citemacro_cite"><bibref bibrefs="lee2017ability" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> established approximation by composition of Barron functions <cite class="ltx_citemacro_citep">(<bibref bibrefs="barron1993universal" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>;
<cite class="ltx_citemacro_cite"><bibref bibrefs="bailey2018size" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> developed space-filling approach, which was generalized in <cite class="ltx_citemacro_cite"><bibref bibrefs="perekrestenko2020constructive,perekrestenko2021high" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>; <cite class="ltx_citemacro_cite"><bibref bibrefs="lu2020universal" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> constructed a deep ReLU network with guaranteed approximation under integral probability metrics, using techniques of empirical measures and optimal transport.
These results show that deep neural networks can provably transport one source distribution to a target one with sufficient model capacity under certain regularity conditions of the pair of densities.
Our JKO-iFlow model potentially leads to a constructive approximation analysis of the neural ODE flow model.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:background" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Preliminaries</title>
    <para xml:id="S2.p1">
      <p><text font="italic">Normalizing flow</text>.
A normalizing flow can be mathematically expressed via a density evolution equation of <Math mode="inline" tex="\rho(x,t)" text="rho * open-interval@(x, t)" xml:id="S2.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p1.m1.1"/>
                  <XMRef idref="S2.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m1.1">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m1.2">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> such that <Math mode="inline" tex="\rho(x,0)=p_{X}" text="rho * open-interval@(x, 0) = p _ X" xml:id="S2.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.p1.m2.1"/>
                    <XMRef idref="S2.p1.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m2.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m2.2">0</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> and as <Math mode="inline" tex="t" text="t" xml:id="S2.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">t</XMTok>
          </XMath>
        </Math> increases <Math mode="inline" tex="\rho(x,t)" text="rho * open-interval@(x, t)" xml:id="S2.p1.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p1.m4.1"/>
                  <XMRef idref="S2.p1.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m4.1">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m4.2">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> approaches <Math mode="inline" tex="p_{Z}\sim\mathcal{N}(0,I_{d})" text="p _ Z similar-to N * open-interval@(0, I _ d)" xml:id="S2.p1.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.p1.m5.1"/>
                    <XMRef idref="S2.p1.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m5.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S2.p1.m5.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">I</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="tabak2010density" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Given an initial distribution <Math mode="inline" tex="\rho(x,0)" text="rho * open-interval@(x, 0)" xml:id="S2.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p1.m6.1"/>
                  <XMRef idref="S2.p1.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m6.1">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m6.2">0</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, such a flow typically is not unique.
We consider when the flow is induced by an ODE of <Math mode="inline" tex="x(t)" text="x * t" xml:id="S2.p1.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
              <XMDual>
                <XMRef idref="S2.p1.m7.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m7.1">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> in <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="S2.p1.m8">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
            </XMApp>
          </XMath>
        </Math></p>
      <equation labels="LABEL:eq:ode-Xt" xml:id="S2.E1">
        <tags>
          <tag>(1)</tag>
          <tag role="autoref">Equation 1</tag>
          <tag role="refnum">1</tag>
        </tags>
        <Math mode="display" tex="\dot{x}(t)={\bf f}(x(t),t)," text="dot@(x) * t = f * open-interval@(x * t, t)" xml:id="S2.E1.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S2.E1.m1.4"/>
              <XMWrap>
                <XMApp xml:id="S2.E1.m1.4">
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.E1.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.1">t</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S2.E1.m1.4.1"/>
                        <XMRef idref="S2.E1.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.E1.m1.4.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E1.m1.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.2">t</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.3">t</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="x(0)\sim p_{X}" text="x * 0 similar-to p _ X" xml:id="S2.p1.m9">
          <XMath>
            <XMApp>
              <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMRef idref="S2.p1.m9.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m9.1">0</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.
The marginal density of <Math mode="inline" tex="x(t)" text="x * t" xml:id="S2.p1.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
              <XMDual>
                <XMRef idref="S2.p1.m10.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m10.1">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is denoted as <Math mode="inline" tex="p(x,t)" text="p * open-interval@(x, t)" xml:id="S2.p1.m11">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p1.m11.1"/>
                  <XMRef idref="S2.p1.m11.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m11.1">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m11.2">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, and it evolves according to the continuity equation (Liouville equation) of (<ref labelref="LABEL:eq:ode-Xt"/>) written as</p>
      <equation labels="LABEL:eq:Liouville" xml:id="S2.E2">
        <tags>
          <tag>(2)</tag>
          <tag role="autoref">Equation 2</tag>
          <tag role="refnum">2</tag>
        </tags>
        <Math mode="display" tex="\partial_{t}p+\nabla\cdot(p{\bf f})=0,\quad p(x,0)=p_{X}(x)." text="formulae@((partial-differential _ t)@(p) + nabla cdot (p * f) = 0, p * open-interval@(x, 0) = p _ X * x)" xml:id="S2.E2.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S2.E2.m1.4"/>
              <XMWrap>
                <XMDual xml:id="S2.E2.m1.4">
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="S2.E2.m1.4.1"/>
                    <XMRef idref="S2.E2.m1.4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S2.E2.m1.4.1">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                          <XMDual>
                            <XMRef idref="S2.E2.m1.4.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S2.E2.m1.4.1.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                    <XMApp xml:id="S2.E2.m1.4.2">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.E2.m1.1"/>
                            <XMRef idref="S2.E2.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m1.1">x</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="S2.E2.m1.2">0</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.E2.m1.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.E2.m1.3">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMTok role="PERIOD">.</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
    </para>
    <para class="ltx_noindent" xml:id="S2.p2">
      <p><text font="italic">Ornstein–Uhlenbeck (OU) process</text>.
Consider a Langevin dynamic denoted by the SDE <Math mode="inline" tex="dX_{t}=-\nabla V(X_{t})dt+\sqrt{2}dW_{t}" text="d * X _ t = (- nabla@(V) * X _ t * d * t) + square-root@(2) * d * W _ t" xml:id="S2.p2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                      <XMTok font="italic" role="UNKNOWN">V</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.p2.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.p2.m1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok meaning="square-root"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">W</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, where <Math mode="inline" tex="V" text="V" xml:id="S2.p2.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">V</XMTok>
          </XMath>
        </Math> is the potential of the equilibrium density <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S2.p2.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math>.
We focus on the case of normal equilibrium, that is, <Math mode="inline" tex="V(x)=|x|^{2}/2" text="V * x = (absolute-value@(x)) ^ 2 / 2" xml:id="S2.p2.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
                <XMDual>
                  <XMRef idref="S2.p2.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.p2.m4.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S2.p2.m4.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.p2.m4.2">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> and then <Math mode="inline" tex="p_{Z}\propto e^{-V}" text="p _ Z proportional-to e ^ (- V)" xml:id="S2.p2.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>. In this case, the process is known as the (multivariate) OU process. Suppose <Math mode="inline" tex="X_{0}\sim p_{X}" text="X _ 0 similar-to p _ X" xml:id="S2.p2.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, and let the density of <Math mode="inline" tex="X_{t}" text="X _ t" xml:id="S2.p2.m7">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">X</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> be <Math mode="inline" tex="\rho(x,t)" text="rho * open-interval@(x, t)" xml:id="S2.p2.m8">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p2.m8.1"/>
                  <XMRef idref="S2.p2.m8.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p2.m8.1">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p2.m8.2">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> also denoted as <Math mode="inline" tex="\rho_{t}(\cdot)" text="rho _ t * cdot" xml:id="S2.p2.m9">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMDual>
                <XMRef idref="S2.p2.m9.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok name="cdot" role="MULOP" xml:id="S2.p2.m9.1">⋅</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. The Fokker-Planck equation (FPE) describes the evolution of <Math mode="inline" tex="\rho_{t}" text="rho _ t" xml:id="S2.p2.m10">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> towards the equilibrium <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S2.p2.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> as follows, where <Math mode="inline" tex="V(x):={|x|^{2}}/{2}" text="V * x assign (absolute-value@(x)) ^ 2 / 2" xml:id="S2.p2.m12">
          <XMath>
            <XMApp>
              <XMTok meaning="assign" role="RELOP">:=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
                <XMDual>
                  <XMRef idref="S2.p2.m12.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.p2.m12.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S2.p2.m12.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.p2.m12.2">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>,</p>
      <equation labels="LABEL:eq:fokker-planck" xml:id="S2.E3">
        <tags>
          <tag>(3)</tag>
          <tag role="autoref">Equation 3</tag>
          <tag role="refnum">3</tag>
        </tags>
        <Math mode="display" tex="\partial_{t}\rho=\nabla\cdot(\rho\nabla V+\nabla\rho),\quad\rho(x,0)=p_{X}(x)." text="formulae@((partial-differential _ t)@(rho) = nabla cdot (rho * nabla@(V) + nabla@(rho)), rho * open-interval@(x, 0) = p _ X * x)" xml:id="S2.E3.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S2.E3.m1.4"/>
              <XMWrap>
                <XMDual xml:id="S2.E3.m1.4">
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="S2.E3.m1.4.1"/>
                    <XMRef idref="S2.E3.m1.4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S2.E3.m1.4.1">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMDual>
                          <XMRef idref="S2.E3.m1.4.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.E3.m1.4.1.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                <XMApp>
                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
<!--  %**** JKO_arxiv_v4.tex Line 325 **** -->                    <XMApp xml:id="S2.E3.m1.4.2">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.E3.m1.1"/>
                            <XMRef idref="S2.E3.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m1.1">x</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="0" role="NUMBER" xml:id="S2.E3.m1.2">0</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.E3.m1.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m1.3">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMTok role="PERIOD">.</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>Under generic conditions, <Math mode="inline" tex="\rho_{t}" text="rho _ t" xml:id="S2.p2.m13">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> converges to <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S2.p2.m14">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> exponentially fast.
For Wasserstein-2 distance and the standard normal <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S2.p2.m15">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math>, classical argument gives that (take <Math mode="inline" tex="C=1" text="C = 1" xml:id="S2.p2.m16">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">C</XMTok>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> in Eqn (6) of <cite class="ltx_citemacro_cite"><bibref bibrefs="bolley2012convergence" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>)</p>
      <equation labels="LABEL:eq:W2-convergence-FK" xml:id="S2.E4">
        <tags>
          <tag>(4)</tag>
          <tag role="autoref">Equation 4</tag>
          <tag role="refnum">4</tag>
        </tags>
        <Math mode="display" tex="W_{2}(\rho_{t},p_{Z})\leq e^{-t}W_{2}(\rho_{0},p_{Z}),\quad t&gt;0." text="formulae@(W _ 2 * open-interval@(rho _ t, p _ Z) &lt;= e ^ (- t) * W _ 2 * open-interval@(rho _ 0, p _ Z), t &gt; 0)" xml:id="S2.E4.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S2.E4.m1.1"/>
              <XMWrap>
                <XMDual xml:id="S2.E4.m1.1">
                  <XMApp>
                    <XMTok meaning="formulae"/>
                    <XMRef idref="S2.E4.m1.1.1"/>
                    <XMRef idref="S2.E4.m1.1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="S2.E4.m1.1.1">
                      <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">W</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.E4.m1.1.1.1"/>
                            <XMRef idref="S2.E4.m1.1.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.E4.m1.1.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S2.E4.m1.1.1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">e</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">W</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.E4.m1.1.1.3"/>
                            <XMRef idref="S2.E4.m1.1.1.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S2.E4.m1.1.1.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S2.E4.m1.1.1.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                    <XMApp xml:id="S2.E4.m1.1.2">
                      <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMTok meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMWrap>
                </XMDual>
                <XMTok role="PERIOD">.</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
    </para>
    <para class="ltx_noindent" xml:id="S2.p3">
      <p><text font="italic">JKO scheme</text>. The seminal work <cite class="ltx_citemacro_cite"><bibref bibrefs="jordan1998variational" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> established a time discretization scheme of the solution to (<ref labelref="LABEL:eq:fokker-planck"/>) by the gradient flow to minimize <Math class="ltx_math_unparsed" mode="inline" tex="{\rm KL}(\rho||p_{Z})" xml:id="S2.p3.m1">
          <XMath>
            <XMTok role="UNKNOWN">KL</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMWrap>
          </XMath>
        </Math> under the Wasserstein-2 metric in probability space.
Denote by <Math mode="inline" tex="\mathcal{P}" text="P" xml:id="S2.p3.m2">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
          </XMath>
        </Math> the space of all probability densities on <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="S2.p3.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
            </XMApp>
          </XMath>
        </Math> with a finite second moment.
The JKO scheme computes a sequence of distributions <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S2.p3.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="k=0,1,\cdots," text="k = list@(0, 1, cdots)" xml:id="S2.p3.m5">
          <XMath>
            <XMDual>
              <XMRef idref="S2.p3.m5.4"/>
              <XMWrap>
                <XMApp xml:id="S2.p3.m5.4">
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S2.p3.m5.1"/>
                      <XMRef idref="S2.p3.m5.2"/>
                      <XMRef idref="S2.p3.m5.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok meaning="0" role="NUMBER" xml:id="S2.p3.m5.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="S2.p3.m5.2">1</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="cdots" role="ID" xml:id="S2.p3.m5.3">⋯</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> starting from <Math mode="inline" tex="p_{0}=\rho_{0}\in\mathcal{P}" text="p _ 0 = rho _ 0 element-of P" xml:id="S2.p3.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
            </XMApp>
          </XMath>
        </Math>.
With step size <Math mode="inline" tex="h&gt;0" text="h &gt; 0" xml:id="S2.p3.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math>, the scheme at the <Math mode="inline" tex="k" text="k" xml:id="S2.p3.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math>-th step is written as</p>
      <equation labels="LABEL:eq:def-JKO-1" xml:id="S2.E5">
<!--  %“quad -->        <tags>
          <tag>(5)</tag>
          <tag role="autoref">Equation 5</tag>
          <tag role="refnum">5</tag>
        </tags>
        <Math mode="display" tex="p_{k+1}=\arg\min_{\rho\in\mathcal{P}}F[\rho]+\frac{1}{2h}W_{2}^{2}(p_{k},\rho)," text="p _ (k + 1) = argument@((minimum _ (rho element-of P))@(F)) * delimited-[]@(rho) + (1 / (2 * h)) * (W _ 2) ^ 2 * open-interval@(p _ k, rho)" xml:id="S2.E5.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S2.E5.m1.3"/>
              <XMWrap>
                <XMApp xml:id="S2.E5.m1.3">
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok meaning="argument" role="OPFUNCTION">arg</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                              <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">P</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">F</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S2.E5.m1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" name="rho" role="UNKNOWN" xml:id="S2.E5.m1.1">ρ</XMTok>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">W</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S2.E5.m1.3.1"/>
                          <XMRef idref="S2.E5.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S2.E5.m1.3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" name="rho" role="UNKNOWN" xml:id="S2.E5.m1.2">ρ</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>where <Math class="ltx_math_unparsed" mode="inline" tex="F[\rho]:={\rm KL}(\rho||p_{Z})" xml:id="S2.p3.m9">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">F</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">[</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN" xml:id="S2.p3.m9.1">ρ</XMTok>
              <XMTok role="CLOSE" stretchy="false">]</XMTok>
            </XMWrap>
            <XMTok meaning="assign" role="RELOP">:=</XMTok>
            <XMTok role="UNKNOWN">KL</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
              <XMTok role="VERTBAR" stretchy="false">|</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMWrap>
          </XMath>
        </Math>.
It was proved in <cite class="ltx_citemacro_cite"><bibref bibrefs="jordan1998variational" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> that as <Math mode="inline" tex="h\to 0" text="h to 0" xml:id="S2.p3.m10">
          <XMath>
            <XMApp>
              <XMTok name="to" role="ARROW">→</XMTok>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math>,
the solution <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S2.p3.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
            </XMApp>
          </XMath>
        </Math> converges to the solution <Math mode="inline" tex="\rho(\cdot,kh)" text="rho * open-interval@(cdot, k * h)" xml:id="S2.p3.m12">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p3.m12.1"/>
                  <XMRef idref="S2.p3.m12.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok name="cdot" role="MULOP" xml:id="S2.p3.m12.1">⋅</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S2.p3.m12.2">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> of (<ref labelref="LABEL:eq:fokker-planck"/>) for all <Math mode="inline" tex="k" text="k" xml:id="S2.p3.m13">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math><!--  %**** JKO˙arxiv˙v4.tex Line 350 **** -->,
and the convergence <Math mode="inline" tex="\rho_{(h)}(\cdot,t)\to\rho(\cdot,t)" text="rho _ h * open-interval@(cdot, t) to rho * open-interval@(cdot, t)" xml:id="S2.p3.m14">
          <XMath>
            <XMApp>
              <XMTok name="to" role="ARROW">→</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                  <XMDual>
                    <XMRef idref="S2.p3.m14.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.p3.m14.1">h</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.p3.m14.2"/>
                    <XMRef idref="S2.p3.m14.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S2.p3.m14.2">⋅</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.p3.m14.3">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.p3.m14.4"/>
                    <XMRef idref="S2.p3.m14.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S2.p3.m14.4">⋅</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.p3.m14.5">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
is strongly in <Math mode="inline" tex="L^{1}(\mathbb{R}^{d},(0,T))" text="L ^ 1 * open-interval@(R ^ d, open-interval@(0, T))" xml:id="S2.p3.m15">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p3.m15.3"/>
                  <XMRef idref="S2.p3.m15.4"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S2.p3.m15.3">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="S2.p3.m15.4">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S2.p3.m15.1"/>
                      <XMRef idref="S2.p3.m15.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok meaning="0" role="NUMBER" xml:id="S2.p3.m15.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.p3.m15.2">T</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> for finite <Math mode="inline" tex="T" text="T" xml:id="S2.p3.m16">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">T</XMTok>
          </XMath>
        </Math>
where <Math mode="inline" tex="\rho_{(h)}" text="rho _ h" xml:id="S2.p3.m17">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
              <XMDual>
                <XMRef idref="S2.p3.m17.1"/>
                <XMWrap>
                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.p3.m17.1">h</XMTok>
                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is piece-wise constant interpolated from <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S2.p3.m18">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
  </section>
  <section inlist="toc" labels="LABEL:sec:mtd" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>JKO scheme by neural ODE</title>
    <para xml:id="S3.p1">
      <p>Given i.i.d. observed data samples <Math mode="inline" tex="X_{i}\in\mathbb{R}^{d}" text="X _ i element-of R ^ d" xml:id="S3.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="i=1,\ldots,N" text="i = list@(1, ldots, N)" xml:id="S3.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.p1.m2.1"/>
                  <XMRef idref="S3.p1.m2.2"/>
                  <XMRef idref="S3.p1.m2.3"/>
                </XMApp>
                <XMWrap>
                  <XMTok meaning="1" role="NUMBER" xml:id="S3.p1.m2.1">1</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S3.p1.m2.2">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.p1.m2.3">N</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, drawn from some unknown density <Math mode="inline" tex="p_{X}" text="p _ X" xml:id="S3.p1.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
            </XMApp>
          </XMath>
        </Math>,
the goal is to train an invertible neural network to transport the density <Math mode="inline" tex="p_{X}" text="p _ X" xml:id="S3.p1.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
            </XMApp>
          </XMath>
        </Math> to an <text font="italic">a priori</text> specified density <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.p1.m5">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> in <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="S3.p1.m6">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
            </XMApp>
          </XMath>
        </Math>, where each data sample <Math mode="inline" tex="X_{i}" text="X _ i" xml:id="S3.p1.m7">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">X</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math> is mapped to a code <Math mode="inline" tex="Z_{i}" text="Z _ i" xml:id="S3.p1.m8">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">Z</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math>. A prototypical choice of <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.p1.m9">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> is the standard multivariate Gaussian <Math mode="inline" tex="\mathcal{N}(0,I_{d})" text="N * open-interval@(0, I _ d)" xml:id="S3.p1.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.p1.m10.1"/>
                  <XMRef idref="S3.p1.m10.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.p1.m10.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.p1.m10.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>.
In this work, we leave the potential of <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.p1.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> abstract and denote by <Math mode="inline" tex="V" text="V" xml:id="S3.p1.m12">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">V</XMTok>
          </XMath>
        </Math>, that is, <Math mode="inline" tex="p_{Z}\propto e^{-V}" text="p _ Z proportional-to e ^ (- V)" xml:id="S3.p1.m13">
          <XMath>
            <XMApp>
              <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
and <Math mode="inline" tex="V(x)=|x|^{2}/2" text="V * x = (absolute-value@(x)) ^ 2 / 2" xml:id="S3.p1.m14">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
                <XMDual>
                  <XMRef idref="S3.p1.m14.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.p1.m14.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S3.p1.m14.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.p1.m14.2">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> for normal <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.p1.m15">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math>.
By a slight abuse of notation, we denote by <Math mode="inline" tex="p_{X}" text="p _ X" xml:id="S3.p1.m16">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.p1.m17">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
            </XMApp>
          </XMath>
        </Math> both the distributions and the density functions of data <Math mode="inline" tex="X" text="X" xml:id="S3.p1.m18">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">X</XMTok>
          </XMath>
        </Math> and code <Math mode="inline" tex="Z" text="Z" xml:id="S3.p1.m19">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">Z</XMTok>
          </XMath>
        </Math> respectively.</p>
    </para>
    <subsection inlist="toc" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Objective of JKO step</title>
      <para xml:id="S3.SS1.p1">
        <p>We are to specify <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p1.m1.1"/>
                    <XMRef idref="S3.SS1.p1.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m1.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m1.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> in the ODE (<ref labelref="LABEL:eq:ode-Xt"/>), to be parametrized and learned by a neural ODE,
such that the induced density evolution of <Math mode="inline" tex="p(x,t)" text="p * open-interval@(x, t)" xml:id="S3.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p1.m2.1"/>
                    <XMRef idref="S3.SS1.p1.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m2.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m2.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> converges to <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math> as <Math mode="inline" tex="t" text="t" xml:id="S3.SS1.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> increases.
We start by dividing the time horizon <Math mode="inline" tex="[0,T]" text="closed-interval@(0, T)" xml:id="S3.SS1.p1.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S3.SS1.p1.m5.1"/>
                  <XMRef idref="S3.SS1.p1.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.p1.m5.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m5.2">T</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> into finite subintervals with step size <Math mode="inline" tex="h" text="h" xml:id="S3.SS1.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math>,
let <Math mode="inline" tex="t_{k}=kh" text="t _ k = k * h" xml:id="S3.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="I_{k+1}:=[t_{k},t_{k+1})" text="I _ (k + 1) assign closed-open-interval@(t _ k, t _ (k + 1))" xml:id="S3.SS1.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-open-interval"/>
                    <XMRef idref="S3.SS1.p1.m8.1"/>
                    <XMRef idref="S3.SS1.p1.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m8.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p1.m8.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
Define <Math mode="inline" tex="p_{k}(x):=p(x,kh)" text="p _ k * x assign p * open-interval@(x, k * h)" xml:id="S3.SS1.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS1.p1.m9.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m9.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.SS1.p1.m9.2"/>
                      <XMRef idref="S3.SS1.p1.m9.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m9.2">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S3.SS1.p1.m9.3">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">k</XMTok>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, namely the density of <Math mode="inline" tex="x(t)" text="x * t" xml:id="S3.SS1.p1.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p1.m10.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m10.1">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> at <Math mode="inline" tex="t=kh" text="t = k * h" xml:id="S3.SS1.p1.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><!--  %**** JKO˙arxiv˙v4.tex Line 375 **** -->.
The solution of (<ref labelref="LABEL:eq:ode-Xt"/>) determined by the vector-field <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS1.p1.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p1.m12.1"/>
                    <XMRef idref="S3.SS1.p1.m12.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m12.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m12.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> on <Math mode="inline" tex="t\in I_{k+1}" text="t element-of I _ (k + 1)" xml:id="S3.SS1.p1.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
(assuming the ODE is well-posed <cite class="ltx_citemacro_citep">(<bibref bibrefs="Sideris2013OrdinaryDE" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>)
gives a one-to-one mapping <Math mode="inline" tex="T_{k+1}" text="T _ (k + 1)" xml:id="S3.SS1.p1.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> on <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="S3.SS1.p1.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMath>
          </Math>,
s.t. <Math mode="inline" tex="T_{k+1}(x(t_{k}))=x(t_{k+1})" text="T _ (k + 1) * x * t _ k = x * t _ (k + 1)" xml:id="S3.SS1.p1.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS1.p1.m16.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.p1.m16.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMDual>
                          <XMRef idref="S3.SS1.p1.m16.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S3.SS1.p1.m16.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">t</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.p1.m16.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.p1.m16.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="T_{k+1}" text="T _ (k + 1)" xml:id="S3.SS1.p1.m17">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> transports <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S3.SS1.p1.m18">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> into <Math mode="inline" tex="p_{k+1}" text="p _ (k + 1)" xml:id="S3.SS1.p1.m19">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
i.e., <Math mode="inline" tex="(T_{k})_{\#}p_{k-1}=p_{k}" text="T _ k _ # * p _ (k - 1) = p _ k" xml:id="S3.SS1.p1.m20">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMRef idref="S3.SS1.p1.m20.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.p1.m20.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
where we denote by <Math mode="inline" tex="T_{\#}p" text="T _ # * p" xml:id="S3.SS1.p1.m21">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> the push-forward of distribution <Math mode="inline" tex="p" text="p" xml:id="S3.SS1.p1.m22">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> by <Math mode="inline" tex="T" text="T" xml:id="S3.SS1.p1.m23">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math>, such that <Math mode="inline" tex="(T_{\#}p)(A)=p(T^{-1}(A))" text="T _ # * p * A = p * T ^ (- 1) * A" xml:id="S3.SS1.p1.m24">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.p1.m24.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.p1.m24.3">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMRef idref="S3.SS1.p1.m24.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m24.1">A</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.p1.m24.4"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.p1.m24.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S3.SS1.p1.m24.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p1.m24.2">A</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for a measurable set <Math mode="inline" tex="A" text="A" xml:id="S3.SS1.p1.m25">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math>.
In other words, the mapping <Math mode="inline" tex="T_{k+1}" text="T _ (k + 1)" xml:id="S3.SS1.p1.m26">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is the solution map of the ODE from time <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="S3.SS1.p1.m27">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> to <Math mode="inline" tex="t_{k+1}" text="t _ (k + 1)" xml:id="S3.SS1.p1.m28">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S3.SS1.p2">
        <p>Suppose we can find <Math mode="inline" tex="{\bf f}(\cdot,t)" text="f * open-interval@(cdot, t)" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p2.m1.1"/>
                    <XMRef idref="S3.SS1.p2.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S3.SS1.p2.m1.1">⋅</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m1.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> on <Math mode="inline" tex="I_{k+1}" text="I _ (k + 1)" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">I</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> such that the corresponding <Math mode="inline" tex="T_{k+1}" text="T _ (k + 1)" xml:id="S3.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> solves
the JKO scheme (<ref labelref="LABEL:eq:def-JKO-1"/>),
then with small <Math mode="inline" tex="h" text="h" xml:id="S3.SS1.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math>, <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S3.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> approximates the solution to the Fokker-Planck equation <ref labelref="LABEL:eq:fokker-planck"/>,
which then flows towards <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S3.SS1.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math>.
By the Monge formulation of the Wasserstein-2 distance between <Math mode="inline" tex="p" text="p" xml:id="S3.SS1.p2.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="q" text="q" xml:id="S3.SS1.p2.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> as
<Math mode="inline" tex="W_{2}^{2}(p,q)=\min_{T:T_{\#}p=q}\mathbb{E}_{x\sim p}\|x-T(x)\|^{2}" text="(W _ 2) ^ 2 * open-interval@(p, q) = (minimum _ (T colon T _ # * p = q))@(E _ (x similar-to p) * (norm@(x - T * x)) ^ 2)" xml:id="S3.SS1.p2.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.SS1.p2.m9.1"/>
                      <XMRef idref="S3.SS1.p2.m9.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m9.1">p</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m9.2">q</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post">min</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                            <XMTok fontsize="50%" role="UNKNOWN">#</XMTok>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="norm"/>
                          <XMRef idref="S3.SS1.p2.m9.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="||" role="OPEN">‖</XMTok>
                          <XMApp xml:id="S3.SS1.p2.m9.4">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">T</XMTok>
                              <XMDual>
                                <XMRef idref="S3.SS1.p2.m9.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m9.3">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok name="||" role="CLOSE">‖</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
solving for the transported density <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S3.SS1.p2.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> by (<ref labelref="LABEL:eq:def-JKO-1"/>) is equivalent to solving for the transport <Math mode="inline" tex="T_{k+1}" text="T _ (k + 1)" xml:id="S3.SS1.p2.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> by</p>
        <equation labels="LABEL:eq:def-JKO-2" xml:id="S3.E6">
          <tags>
            <tag>(6)</tag>
            <tag role="autoref">Equation 6</tag>
            <tag role="refnum">6</tag>
          </tags>
          <Math mode="display" tex="T_{k+1}=\arg\min_{T:\mathbb{R}^{d}\to\mathbb{R}^{d}}F[T]+\frac{1}{2h}\mathbb{E%&#10;}_{x\sim p_{k}}\|x-T(x)\|^{2}," text="T _ (k + 1) = argument@((minimum _ (T colon R ^ d to R ^ d))@(F)) * delimited-[]@(T) + (1 / (2 * h)) * E _ (x similar-to p _ k) * (norm@(x - T * x)) ^ 2" xml:id="S3.E6.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E6.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S3.E6.m1.3">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok meaning="argument" role="OPFUNCTION">arg</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" name="to" role="ARROW">→</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="blackboard" fontsize="70%" role="UNKNOWN">R</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="blackboard" fontsize="70%" role="UNKNOWN">R</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">F</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="delimited-[]"/>
                            <XMRef idref="S3.E6.m1.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.1">T</XMTok>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="norm"/>
                              <XMRef idref="S3.E6.m1.3.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok name="||" role="OPEN">‖</XMTok>
                              <XMApp xml:id="S3.E6.m1.3.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMRef idref="S3.E6.m1.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.2">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok name="||" role="CLOSE">‖</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math class="ltx_math_unparsed" mode="inline" tex="F[T]={\rm KL}(T_{\#}p_{k}||p_{Z})" xml:id="S3.SS1.p2.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">F</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">[</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m12.1">T</XMTok>
                <XMTok role="CLOSE" stretchy="false">]</XMTok>
              </XMWrap>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok role="UNKNOWN">KL</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMath>
          </Math>.
The equivalence between (<ref labelref="LABEL:eq:def-JKO-1"/>) and (<ref labelref="LABEL:eq:def-JKO-2"/>) is proved in Lemma <ref labelref="LABEL:lemma:JKO-by-Tk"/>.</p>
      </para>
      <para xml:id="S3.SS1.p3">
        <p>Furthermore, the following proposition gives that, once <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S3.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is determined by <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS1.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p3.m2.1"/>
                    <XMRef idref="S3.SS1.p3.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p3.m2.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p3.m2.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> for <Math mode="inline" tex="t\leq t_{k}" text="t &lt;= t _ k" xml:id="S3.SS1.p3.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><!--  %**** JKO˙arxiv˙v4.tex Line 400 **** -->,
the value of <Math mode="inline" tex="F[T]" text="F * delimited-[]@(T)" xml:id="S3.SS1.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">F</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S3.SS1.p3.m4.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p3.m4.1">T</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> can be computed from <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS1.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p3.m5.1"/>
                    <XMRef idref="S3.SS1.p3.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p3.m5.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p3.m5.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> on <Math mode="inline" tex="t\in I_{k+1}" text="t element-of I _ (k + 1)" xml:id="S3.SS1.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> only.
The counterpart for convex function-based parametrization of <Math mode="inline" tex="T_{k}" text="T _ k" xml:id="S3.SS1.p3.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> was given in Theorem 1 of <cite class="ltx_citemacro_citep">(<bibref bibrefs="mokrov2021large" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
where the computation using the change-of-variable differs as we adopt an invertible neural ODE approach here.
The proof is left to Appendix <ref labelref="LABEL:sec:proof"/>.</p>
      </para>
      <theorem class="ltx_theorem_proposition" inlist="thm theorem:proposition" labels="LABEL:prop:FT-layer-wise" xml:id="S3.Thmtheorem1">
        <tags>
          <tag>Proposition 3.1</tag>
          <tag role="autoref">3.1</tag>
          <tag role="refnum">3.1</tag>
          <tag role="typerefnum">Proposition 3.1</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Proposition 3.1</text></tag><text font="bold">.</text></title>
        <para xml:id="S3.Thmtheorem1.p1">
          <p><text font="italic">Given <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S3.Thmtheorem1.p1.m1">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok role="UNKNOWN">p</XMTok>
                    <XMTok fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMath>
              </Math>, up to a constant <Math mode="inline" tex="c" text="c" xml:id="S3.Thmtheorem1.p1.m2">
                <XMath>
                  <XMTok role="UNKNOWN">c</XMTok>
                </XMath>
              </Math> independent from <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.Thmtheorem1.p1.m3">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="bold upright" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.Thmtheorem1.p1.m3.1"/>
                        <XMRef idref="S3.Thmtheorem1.p1.m3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.Thmtheorem1.p1.m3.1">x</XMTok>
                        <XMTok font="upright" role="PUNCT">,</XMTok>
                        <XMTok role="UNKNOWN" xml:id="S3.Thmtheorem1.p1.m3.2">t</XMTok>
                        <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math> on <Math mode="inline" tex="t\in I_{k+1}" text="t element-of I _ (k + 1)" xml:id="S3.Thmtheorem1.p1.m4">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok role="UNKNOWN">t</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok role="UNKNOWN">I</XMTok>
                      <XMApp>
                        <XMTok font="upright" fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok font="upright" fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>,</text></p>
          <equation labels="LABEL:eq:FT-layer-wise" xml:id="S3.E7">
            <tags>
              <tag>(7)</tag>
              <tag role="autoref">Equation 7</tag>
              <tag role="refnum">7</tag>
            </tags>
            <Math class="ltx_math_unparsed" mode="display" tex="{\rm KL}(T_{\#}p_{k}||p_{Z})=\mathbb{E}_{x(t_{k})\sim p_{k}}\left(V(x(t_{k+1})%&#10;)-\int_{t_{k}}^{t_{k+1}}\nabla\cdot\mathbf{f}(x(s),s)ds\right)+c." xml:id="S3.E7.m1">
              <XMath>
                <XMTok role="UNKNOWN">KL</XMTok>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                    <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                  <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E7.m1.1"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E7.m1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="true">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      <XMApp>
                        <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok role="CLOSE" stretchy="true">)</XMTok>
                </XMWrap>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
                <XMTok role="PERIOD">.</XMTok>
              </XMath>
            </Math>
          </equation>
        </para>
      </theorem>
      <para xml:id="S3.SS1.p4">
        <p>By Proposition <ref labelref="LABEL:prop:FT-layer-wise"/>,
the minimization (<ref labelref="LABEL:eq:def-JKO-2"/>) is equivalent to</p>
        <equation labels="LABEL:eq:loss-block-k" xml:id="S3.E8">
          <tags>
            <tag>(8)</tag>
            <tag role="autoref">Equation 8</tag>
            <tag role="refnum">8</tag>
          </tags>
          <Math mode="display" tex="\min_{\{{\bf f}(x,t)\}_{t\in I_{k+1}}}\mathbb{E}_{x(t_{k})\sim p_{k}}\big{(}V(%&#10;x(t_{k+1}))-\int_{t_{k}}^{t_{k+1}}\nabla\cdot\mathbf{f}(x(s),s)ds+\frac{1}{2h}%&#10;\|x(t_{k+1})-x(t_{k})\|^{2}\big{)}," text="(minimum _ (set@(f * open-interval@(x, t))) _ (t element-of I _ (k + 1)))@(E _ (x * t _ k similar-to p _ k)) * ((V * x * t _ (k + 1) - ((integral _ t _ k) ^ (t _ (k + 1)))@((nabla cdot f) * open-interval@(x * s, s) * differential-d@(s))) + (1 / (2 * h)) * (norm@(x * t _ (k + 1) - x * t _ k)) ^ 2)" xml:id="S3.E8.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E8.m1.7"/>
                <XMWrap>
                  <XMApp xml:id="S3.E8.m1.7">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="S3.E8.m1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                              <XMApp xml:id="S3.E8.m1.3">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E8.m1.1"/>
                                    <XMRef idref="S3.E8.m1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E8.m1.1">x</XMTok>
                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E8.m1.2">t</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="50%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">I</XMTok>
                              <XMApp>
                                <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E8.m1.4"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E8.m1.4">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S3.E8.m1.7.1"/>
                      <XMWrap>
                        <XMTok fontsize="120%" role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E8.m1.7.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">V</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E8.m1.7.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E8.m1.7.1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="S3.E8.m1.7.1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E8.m1.7.1.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E8.m1.7.1.2"/>
                                    <XMRef idref="S3.E8.m1.6"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E8.m1.7.1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E8.m1.5"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E8.m1.5">s</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E8.m1.6">s</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="S3.E8.m1.7.1.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok name="||" role="OPEN">‖</XMTok>
                                  <XMApp xml:id="S3.E8.m1.7.1.3">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E8.m1.7.1.3.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S3.E8.m1.7.1.3.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E8.m1.7.1.3.2"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S3.E8.m1.7.1.3.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok name="||" role="CLOSE">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok fontsize="120%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p><!--  %**** JKO˙arxiv˙v4.tex Line 425 **** -->where <Math mode="inline" tex="x(t_{k+1})=x(t_{k})+\int_{t_{k}}^{t_{k+1}}\mathbf{f}(x(s),s)ds" text="x * t _ (k + 1) = x * t _ k + ((integral _ t _ k) ^ (t _ (k + 1)))@(f * open-interval@(x * s, s) * differential-d@(s))" xml:id="S3.SS1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.p4.m1.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.p4.m1.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS1.p4.m1.4"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS1.p4.m1.4">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        <XMApp>
                          <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.SS1.p4.m1.5"/>
                          <XMRef idref="S3.SS1.p4.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.SS1.p4.m1.5">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMDual>
                              <XMRef idref="S3.SS1.p4.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p4.m1.1">s</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p4.m1.2">s</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
Taking a neural ODE approach,
we parametrize <Math mode="inline" tex="\{{\bf f}(x,t)\}_{t\in I_{k+1}}" text="(set@(f * open-interval@(x, t))) _ (t element-of I _ (k + 1))" xml:id="S3.SS1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS1.p4.m2.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.SS1.p4.m2.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.SS1.p4.m2.1"/>
                          <XMRef idref="S3.SS1.p4.m2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p4.m2.1">x</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p4.m2.2">t</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">I</XMTok>
                    <XMApp>
                      <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> as a residual block with parameter <Math mode="inline" tex="\theta_{k+1}" text="theta _ (k + 1)" xml:id="S3.SS1.p4.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
and then (<ref labelref="LABEL:eq:loss-block-k"/>) is reduced to minimizing over <Math mode="inline" tex="\theta_{k+1}" text="theta _ (k + 1)" xml:id="S3.SS1.p4.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. This leads to a block-wise learning algorithm to be introduced in Section <ref labelref="LABEL:sec:algo"/>,
where we further allow the step-size <Math mode="inline" tex="h" text="h" xml:id="S3.SS1.p4.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> to vary for different <Math mode="inline" tex="k" text="k" xml:id="S3.SS1.p4.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> as well.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:subsec:optimal-f" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Infinitesimal optimal <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="bold" role="UNKNOWN">f</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.SS2.m1.1"/>
                  <XMRef idref="S3.SS2.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.m1.1">x</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.m1.2">t</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math></title>
      <para xml:id="S3.SS2.p1">
        <p>In each JKO step of (<ref labelref="LABEL:eq:loss-block-k"/>),
let <Math mode="inline" tex="p=p_{k}" text="p = p _ k" xml:id="S3.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> denote the current density, <Math mode="inline" tex="q=p_{Z}" text="q = p _ Z" xml:id="S3.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> be the target equilibrium density.
In this subsection,
we show that the optimal <Math mode="inline" tex="{\bf f}" text="f" xml:id="S3.SS2.p1.m3">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> in
(<ref labelref="LABEL:eq:loss-block-k"/>) with small <Math mode="inline" tex="h" text="h" xml:id="S3.SS2.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> reveals the difference between score functions between target and current densities.
Thus, minimizing the objective (<ref labelref="LABEL:eq:loss-block-k"/>) searches for a neural network parametrization of the score function <Math mode="inline" tex="\nabla\log\rho_{t}" text="(nabla@(logarithm))@(rho _ t)" xml:id="S3.SS2.p1.m5">
            <XMath>
              <XMApp>
                <XMApp>
                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> implicitly,
in contrast to diffusion-based models which learn the score function explicitly <cite class="ltx_citemacro_citep">(<bibref bibrefs="ho2020denoising,song2021score" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, e.g., via denoising score matching.
<text color="#000000">At infinitesimal <Math mode="inline" tex="h" text="h" xml:id="S3.SS2.p1.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
              </XMath>
            </Math>, this is equivalent to solving the FPE by learning a deterministic transport equation as in <cite class="ltx_citemacro_citep">(<bibref bibrefs="boffi2023probability,shen2022self" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite>.</text></p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p>Consider general equilibrium distribution <Math mode="inline" tex="q" text="q" xml:id="S3.SS2.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> with a differentiable potential <Math mode="inline" tex="V" text="V" xml:id="S3.SS2.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">V</XMTok>
            </XMath>
          </Math>.
To analyze the optimal pushforward mapping in the small <Math mode="inline" tex="h" text="h" xml:id="S3.SS2.p2.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> limit, we shift the time interval <Math mode="inline" tex="[kh,(k+1)h]" text="closed-interval@(k * h, (k + 1) * h)" xml:id="S3.SS2.p2.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S3.SS2.p2.m4.1"/>
                  <XMRef idref="S3.SS2.p2.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="S3.SS2.p2.m4.1">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p2.m4.2">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m4.2.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p2.m4.2.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to be <Math mode="inline" tex="[0,h]" text="closed-interval@(0, h)" xml:id="S3.SS2.p2.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S3.SS2.p2.m5.1"/>
                  <XMRef idref="S3.SS2.p2.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m5.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m5.2">h</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> to simplify the notation.
Then (<ref labelref="LABEL:eq:loss-block-k"/>) is reduced to</p>
        <equation labels="LABEL:eq:JKO-4" xml:id="S3.E9">
          <tags>
            <tag>(9)</tag>
            <tag role="autoref">Equation 9</tag>
            <tag role="refnum">9</tag>
          </tags>
          <Math mode="display" tex="\min_{\{{\bf f}(x,t)\}_{t\in[0,h)}}\mathbb{E}_{x(0)\sim p}\left(V(x(h))-\int_{%&#10;0}^{h}\nabla\cdot\mathbf{f}(x(s),s)ds+\frac{1}{2h}\|x(h)-x(0)\|^{2}\right)," text="(minimum _ (set@(f * open-interval@(x, t))) _ (t element-of closed-open-interval@(0, h)))@(E _ (x * 0 similar-to p)) * ((V * x * h - ((integral _ 0) ^ h)@((nabla cdot f) * open-interval@(x * s, s) * differential-d@(s))) + (1 / (2 * h)) * (norm@(x * h - x * 0)) ^ 2)" xml:id="S3.E9.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E9.m1.12"/>
                <XMWrap>
                  <XMApp xml:id="S3.E9.m1.12">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="S3.E9.m1.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                              <XMApp xml:id="S3.E9.m1.5">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E9.m1.3"/>
                                    <XMRef idref="S3.E9.m1.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E9.m1.3">x</XMTok>
                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E9.m1.4">t</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok fontsize="50%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="closed-open-interval"/>
                                <XMRef idref="S3.E9.m1.1"/>
                                <XMRef idref="S3.E9.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="50%" role="OPEN" stretchy="false">[</XMTok>
                                <XMTok fontsize="50%" meaning="0" role="NUMBER" xml:id="S3.E9.m1.1">0</XMTok>
                                <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.E9.m1.2">h</XMTok>
                                <XMTok fontsize="50%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
<!--  %**** JKO_arxiv_v4.tex Line 450 **** -->                        <XMApp>
                          <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E9.m1.6"/>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="S3.E9.m1.6">0</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S3.E9.m1.12.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S3.E9.m1.12.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">V</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E9.m1.12.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E9.m1.12.1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="S3.E9.m1.7"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E9.m1.7">h</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S3.E9.m1.12.1.2"/>
                                    <XMRef idref="S3.E9.m1.9"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E9.m1.12.1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E9.m1.8"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E9.m1.8">s</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E9.m1.9">s</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="norm"/>
                                  <XMRef idref="S3.E9.m1.12.1.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok name="||" role="OPEN">‖</XMTok>
                                  <XMApp xml:id="S3.E9.m1.12.1.3">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E9.m1.10"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E9.m1.10">h</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="S3.E9.m1.11"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok meaning="0" role="NUMBER" xml:id="S3.E9.m1.11">0</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok name="||" role="CLOSE">‖</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where
<Math mode="inline" tex="x(h)=x(0)+\int_{0}^{h}\mathbf{f}(x(s),s)ds" text="x * h = x * 0 + ((integral _ 0) ^ h)@(f * open-interval@(x * s, s) * differential-d@(s))" xml:id="S3.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS2.p2.m6.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m6.1">h</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m6.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m6.2">0</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.SS2.p2.m6.5"/>
                          <XMRef idref="S3.SS2.p2.m6.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.SS2.p2.m6.5">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMDual>
                              <XMRef idref="S3.SS2.p2.m6.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m6.3">s</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m6.4">s</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
In the limit of <Math mode="inline" tex="h\to 0+" text="h to limit-from@(0, +)" xml:id="S3.SS2.p2.m7">
            <XMath>
              <XMApp>
                <XMTok name="to" role="ARROW">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMApp>
                  <XMTok meaning="limit-from"/>
                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, formally,
<Math mode="inline" tex="x(h)-x(0)=h{\bf f}(x(0),0)+O(h^{2})" text="x * h - x * 0 = h * f * open-interval@(x * 0, 0) + O * h ^ 2" xml:id="S3.SS2.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m8.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m8.1">h</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m8.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m8.2">0</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p2.m8.5"/>
                        <XMRef idref="S3.SS2.p2.m8.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p2.m8.5">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMDual>
                            <XMRef idref="S3.SS2.p2.m8.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m8.3">0</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m8.4">0</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m8.6"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p2.m8.6">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
and suppose <Math mode="inline" tex="V" text="V" xml:id="S3.SS2.p2.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">V</XMTok>
            </XMath>
          </Math> of <Math mode="inline" tex="q" text="q" xml:id="S3.SS2.p2.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> is <Math mode="inline" tex="C^{2}" text="C ^ 2" xml:id="S3.SS2.p2.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math>,
<Math mode="inline" tex="V(x(h))=V(x(0))+h\nabla V(x(0))\cdot{\bf f}(x(0),0)+O(h^{2})" text="V * x * h = V * x * 0 + ((h * nabla@(V) * x * 0) cdot f) * open-interval@(x * 0, 0) + O * h ^ 2" xml:id="S3.SS2.p2.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS2.p2.m12.6"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS2.p2.m12.6">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMDual>
                          <XMRef idref="S3.SS2.p2.m12.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m12.1">h</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">V</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m12.7"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p2.m12.7">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMDual>
                            <XMRef idref="S3.SS2.p2.m12.2"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m12.2">0</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMApp>
                          <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                          <XMTok font="italic" role="UNKNOWN">V</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S3.SS2.p2.m12.8"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S3.SS2.p2.m12.8">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMDual>
                                <XMRef idref="S3.SS2.p2.m12.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m12.3">0</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.SS2.p2.m12.9"/>
                        <XMRef idref="S3.SS2.p2.m12.5"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p2.m12.9">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMDual>
                            <XMRef idref="S3.SS2.p2.m12.4"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m12.4">0</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m12.5">0</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m12.10"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.SS2.p2.m12.10">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
For any differentiable density <Math mode="inline" tex="\rho" text="rho" xml:id="S3.SS2.p2.m13">
            <XMath>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
            </XMath>
          </Math>, the (Stein) score function is defined as <Math mode="inline" tex="{\bf s}_{\rho}=\nabla\log\rho" text="s _ rho = (nabla@(logarithm))@(rho)" xml:id="S3.SS2.p2.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  </XMApp>
                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
and we have <Math mode="inline" tex="\nabla V=-{\bf s}_{q}" text="nabla@(V) = - s _ q" xml:id="S3.SS2.p2.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="bold" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
Taking the formal expansion of orders of <Math mode="inline" tex="h" text="h" xml:id="S3.SS2.p2.m16">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math>, the objective in (<ref labelref="LABEL:eq:JKO-4"/>) is written as</p>
        <equation labels="LABEL:eq:objective-expansion" xml:id="S3.E10">
          <tags>
            <tag>(10)</tag>
            <tag role="autoref">Equation 10</tag>
            <tag role="refnum">10</tag>
          </tags>
          <Math mode="display" tex="\mathbb{E}_{x\sim p}\left(V(x)+h\left(-{\bf s}_{q}(x)\cdot{\bf f}(x,0)-\nabla%&#10;\cdot\mathbf{f}(x,0)+\frac{1}{2}\|{\bf f}(x,0)\|^{2}\right)+O(h^{2})\right)." text="E _ (x similar-to p) * (V * x + h * ((- ((s _ q * x) cdot f) * open-interval@(x, 0) - (nabla cdot f) * open-interval@(x, 0)) + (1 / 2) * (norm@(f * open-interval@(x, 0))) ^ 2) + O * h ^ 2)" xml:id="S3.E10.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E10.m1.9"/>
                <XMWrap>
                  <XMApp xml:id="S3.E10.m1.9">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S3.E10.m1.9.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S3.E10.m1.9.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">V</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E10.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.1">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E10.m1.9.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="S3.E10.m1.9.1.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="bold" role="UNKNOWN">s</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMRef idref="S3.E10.m1.2"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.2">x</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="S3.E10.m1.3"/>
                                            <XMRef idref="S3.E10.m1.4"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.3">x</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok meaning="0" role="NUMBER" xml:id="S3.E10.m1.4">0</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                        <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="S3.E10.m1.5"/>
                                          <XMRef idref="S3.E10.m1.6"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.5">x</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok meaning="0" role="NUMBER" xml:id="S3.E10.m1.6">0</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="norm"/>
                                          <XMRef idref="S3.E10.m1.9.1.1.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok name="||" role="OPEN">‖</XMTok>
                                          <XMApp xml:id="S3.E10.m1.9.1.1.1">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="S3.E10.m1.7"/>
                                                <XMRef idref="S3.E10.m1.8"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.7">x</XMTok>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMTok meaning="0" role="NUMBER" xml:id="S3.E10.m1.8">0</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok name="||" role="CLOSE">‖</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E10.m1.9.1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E10.m1.9.1.2">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>Note that <Math mode="inline" tex="\mathbb{E}_{x\sim p}V(x)" text="E _ (x similar-to p) * V * x" xml:id="S3.SS2.p2.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m17.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m17.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is independent of <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS2.p2.m18">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS2.p2.m18.1"/>
                    <XMRef idref="S3.SS2.p2.m18.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m18.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m18.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>,
and the <Math mode="inline" tex="O(h)" text="O * h" xml:id="S3.SS2.p2.m19">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m19.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m19.1">h</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> order term in (<ref labelref="LABEL:eq:objective-expansion"/>) is over <Math mode="inline" tex="{\bf f}(x,0)" text="f * open-interval@(x, 0)" xml:id="S3.SS2.p2.m20">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS2.p2.m20.1"/>
                    <XMRef idref="S3.SS2.p2.m20.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m20.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS2.p2.m20.2">0</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> only,
thus the minimization of the leading term is equivalent to</p>
        <equation labels="LABEL:eq:L2-stein" xml:id="S3.E11">
          <tags>
            <tag>(11)</tag>
            <tag role="autoref">Equation 11</tag>
            <tag role="refnum">11</tag>
          </tags>
          <Math mode="display" tex="\min_{{\bf f}(\cdot)={\bf f}(\cdot,0)}\mathbb{E}_{x\sim p}\left(-T_{q}{\bf f}+%&#10;\frac{1}{2}\|{\bf f}\|^{2}\right),\quad T_{q}{\bf f}:={\bf s}_{q}\cdot{\bf f}+%&#10;\nabla\cdot{\bf f}," text="list@((minimum _ (f * cdot = f * open-interval@(cdot, 0)))@(E _ (x similar-to p)) * ((- T _ q * f) + (1 / 2) * (norm@(f)) ^ 2), T _ q * f) assign s _ q cdot f + nabla cdot f" xml:id="S3.E11.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E11.m1.5"/>
                <XMWrap>
                  <XMApp xml:id="S3.E11.m1.5">
                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E11.m1.5.1"/>
                        <XMRef idref="S3.E11.m1.5.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.E11.m1.5.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                  <XMDual>
                                    <XMRef idref="S3.E11.m1.1"/>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok fontsize="70%" name="cdot" role="MULOP" xml:id="S3.E11.m1.1">⋅</XMTok>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E11.m1.2"/>
                                      <XMRef idref="S3.E11.m1.3"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok fontsize="70%" name="cdot" role="MULOP" xml:id="S3.E11.m1.2">⋅</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER" xml:id="S3.E11.m1.3">0</XMTok>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.E11.m1.5.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S3.E11.m1.5.1.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="norm"/>
                                        <XMRef idref="S3.E11.m1.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                        <XMTok font="bold" role="UNKNOWN" xml:id="S3.E11.m1.4">f</XMTok>
                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                        <XMApp xml:id="S3.E11.m1.5.2">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          </XMApp>
                          <XMTok font="bold" role="UNKNOWN">f</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="bold" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                        </XMApp>
                        <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="T_{q}" text="T _ q" xml:id="S3.SS2.p2.m21">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> is known as the Stein operator <cite class="ltx_citemacro_citep">(<bibref bibrefs="stein1972bound" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.

The <Math mode="inline" tex="T_{q}{\bf f}" text="T _ q * f" xml:id="S3.SS2.p2.m22">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
              </XMApp>
            </XMath>
          </Math> in (<ref labelref="LABEL:eq:L2-stein"/>) echoes that the derivative of KL divergence with respect to transport map gives Stein operator <cite class="ltx_citemacro_citep">(<bibref bibrefs="liu2016stein" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. The Wasserstein-2 regularization gives an <Math mode="inline" tex="L^{2}" text="L ^ 2" xml:id="S3.SS2.p2.m23">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> regularization in (<ref labelref="LABEL:eq:L2-stein"/>).
Let <Math mode="inline" tex="L^{2}(p)" text="L ^ 2 * p" xml:id="S3.SS2.p2.m24">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m24.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m24.1">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> be the <Math mode="inline" tex="L^{2}" text="L ^ 2" xml:id="S3.SS2.p2.m25">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> space on <Math mode="inline" tex="(\mathbb{R}^{d},p(x)dx)" text="open-interval@(R ^ d, p * x * d * x)" xml:id="S3.SS2.p2.m26">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.SS2.p2.m26.2"/>
                  <XMRef idref="S3.SS2.p2.m26.3"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S3.SS2.p2.m26.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS2.p2.m26.3">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m26.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m26.1">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>,
and for vector field <Math mode="inline" tex="{\bf v}" text="v" xml:id="S3.SS2.p2.m27">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">v</XMTok>
            </XMath>
          </Math> on <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="S3.SS2.p2.m28">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="{\bf v}\in L^{2}(p)" text="v element-of L ^ 2 * p" xml:id="S3.SS2.p2.m29">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="bold" role="UNKNOWN">v</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS2.p2.m29.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m29.1">p</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> if <Math mode="inline" tex="\int|{\bf v}(x)|^{2}p(x)dx&lt;\infty" text="integral@((absolute-value@(v * x)) ^ 2 * p * x * differential-d@(x)) &lt; infinity" xml:id="S3.SS2.p2.m30">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                <XMApp>
                  <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="S3.SS2.p2.m30.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">|</XMTok>
                          <XMApp xml:id="S3.SS2.p2.m30.3">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="bold" role="UNKNOWN">v</XMTok>
                            <XMDual>
                              <XMRef idref="S3.SS2.p2.m30.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m30.1">x</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS2.p2.m30.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m30.2">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok meaning="infinity" name="infty" role="ID">∞</XMTok>
              </XMApp>
            </XMath>
          </Math>.
One can verify that, when both <Math mode="inline" tex="{\bf s}_{p}" text="s _ p" xml:id="S3.SS2.p2.m31">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold" role="UNKNOWN">s</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="{\bf s}_{q}" text="s _ q" xml:id="S3.SS2.p2.m32">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold" role="UNKNOWN">s</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> are in <Math mode="inline" tex="L^{2}(p)" text="L ^ 2 * p" xml:id="S3.SS2.p2.m33">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m33.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m33.1">p</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, the minimizer of (<ref labelref="LABEL:eq:L2-stein"/>) is</p>
        <equation xml:id="S3.Ex1">
          <Math mode="display" tex="{\bf f}^{*}(\cdot,0)={\bf s}_{q}-{\bf s}_{p}." text="f ^ * * open-interval@(cdot, 0) = s _ q - s _ p" xml:id="S3.Ex1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.Ex1.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S3.Ex1.m1.3">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold" role="UNKNOWN">f</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.Ex1.m1.1"/>
                          <XMRef idref="S3.Ex1.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok name="cdot" role="MULOP" xml:id="S3.Ex1.m1.1">⋅</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok meaning="0" role="NUMBER" xml:id="S3.Ex1.m1.2">0</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>This shows that the infinitesimal optimal <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS2.p2.m34">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS2.p2.m34.1"/>
                    <XMRef idref="S3.SS2.p2.m34.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m34.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS2.p2.m34.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> equals the difference between the score functions of the equilibrium and the current density.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:subsec:invertible-express" xml:id="S3.SS3">
      <tags>
        <tag>3.3</tag>
        <tag role="autoref">subsection 3.3</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">§3.3</tag>
      </tags>
      <title><tag close=" ">3.3</tag>Invertibility of flow model and expressiveness</title>
      <para xml:id="S3.SS3.p1">
        <p>At time <Math mode="inline" tex="t" text="t" xml:id="S3.SS3.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> the current density of <Math mode="inline" tex="x(t)" text="x * t" xml:id="S3.SS3.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS3.p1.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m2.1">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is <Math mode="inline" tex="\rho_{t}" text="rho _ t" xml:id="S3.SS3.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math>,
the analysis in Section <ref labelref="LABEL:subsec:optimal-f"/> implies that
the optimal vector field <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS3.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS3.p1.m4.1"/>
                    <XMRef idref="S3.SS3.p1.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m4.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m4.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> has the expression as</p>
        <equation labels="LABEL:eq:f(x,t)-FK" xml:id="S3.E12">
<!--  %**** JKO˙arxiv˙v4.tex Line 500 **** -->          <tags>
            <tag>(12)</tag>
            <tag role="autoref">Equation 12</tag>
            <tag role="refnum">12</tag>
          </tags>
          <Math mode="display" tex="{\bf f}(x,t)={\bf s}_{q}-{\bf s}_{\rho_{t}}=-\nabla V-\nabla\log\rho_{t}." text="f * open-interval@(x, t) = s _ q - s _ rho _ t = - nabla@(V) - (nabla@(logarithm))@(rho _ t)" xml:id="S3.E12.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E12.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S3.E12.m1.3">
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.E12.m1.1"/>
                          <XMRef idref="S3.E12.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E12.m1.1">x</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E12.m1.2">t</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="bold" role="UNKNOWN">s</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                          <XMTok font="italic" role="UNKNOWN">V</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>With this <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS3.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS3.p1.m5.1"/>
                    <XMRef idref="S3.SS3.p1.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m5.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m5.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, the Liouville equation (<ref labelref="LABEL:eq:Liouville"/>) coincides with the FPE (<ref labelref="LABEL:eq:fokker-planck"/>).
This is consistent with the JKO scheme with a small <Math mode="inline" tex="h" text="h" xml:id="S3.SS3.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> recovering the solution to the FPE.
Under proper regularity condition of <Math mode="inline" tex="V" text="V" xml:id="S3.SS3.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">V</XMTok>
            </XMath>
          </Math> and the initial density <Math mode="inline" tex="\rho_{0}" text="rho _ 0" xml:id="S3.SS3.p1.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, the r.h.s. of (<ref labelref="LABEL:eq:f(x,t)-FK"/>) is also regular over space and time.
This leads to two consequences, in approximation and in learning:
Approximation-wise, the regularity of <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S3.SS3.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS3.p1.m9.1"/>
                    <XMRef idref="S3.SS3.p1.m9.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m9.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m9.2">t</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> allows to construct a <Math mode="inline" tex="k" text="k" xml:id="S3.SS3.p1.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>-th residual block in the flow network to approximate <Math mode="inline" tex="\{{\bf f}(x,t)\}_{t\in I_{k}}" text="(set@(f * open-interval@(x, t))) _ (t element-of I _ k)" xml:id="S3.SS3.p1.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS3.p1.m11.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.SS3.p1.m11.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.SS3.p1.m11.1"/>
                          <XMRef idref="S3.SS3.p1.m11.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m11.1">x</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p1.m11.2">t</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">I</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> when there is sufficient model capacity, by classical universal approximation theory of shallow networks <cite class="ltx_citemacro_citep">(<bibref bibrefs="barron1993universal,yarotsky2017error" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
We further discuss the approximation analysis based on the proposed model in the last section.</p>
      </para>
      <para xml:id="S3.SS3.p2">
        <p>For learning, when properly trained with sufficient data, the neural ODE vector field <Math mode="inline" tex="{\bf f}(x,t;\theta_{k})" text="f * vector@(x, t, theta _ k)" xml:id="S3.SS3.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="S3.SS3.p2.m1.1"/>
                    <XMRef idref="S3.SS3.p2.m1.2"/>
                    <XMRef idref="S3.SS3.p2.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p2.m1.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p2.m1.2">t</XMTok>
                    <XMTok role="PUNCT">;</XMTok>
                    <XMApp xml:id="S3.SS3.p2.m1.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> will learn to approximate (<ref labelref="LABEL:eq:f(x,t)-FK"/>).
This can be viewed as inferring the score function of <Math mode="inline" tex="\rho_{t}" text="rho _ t" xml:id="S3.SS3.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math>, and also leads to the invertibility of the trained flow net in theory:
Suppose the trained <Math mode="inline" tex="{\bf f}(x,t;\theta_{k})" text="f * vector@(x, t, theta _ k)" xml:id="S3.SS3.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="S3.SS3.p2.m3.1"/>
                    <XMRef idref="S3.SS3.p2.m3.2"/>
                    <XMRef idref="S3.SS3.p2.m3.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p2.m3.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p2.m3.2">t</XMTok>
                    <XMTok role="PUNCT">;</XMTok>
                    <XMApp xml:id="S3.SS3.p2.m3.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is close enough to (<ref labelref="LABEL:eq:f(x,t)-FK"/>); it will also have bounded Lipschitz constant. Then the residual block is invertible as long as the step size <Math mode="inline" tex="h" text="h" xml:id="S3.SS3.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> is sufficiently small, e.g. less than <Math mode="inline" tex="1/L" text="1 / L" xml:id="S3.SS3.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="L" text="L" xml:id="S3.SS3.p2.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
            </XMath>
          </Math> is the Lipschitz bound of <Math mode="inline" tex="{\bf f}(x,t;\theta_{k})" text="f * vector@(x, t, theta _ k)" xml:id="S3.SS3.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="S3.SS3.p2.m7.1"/>
                    <XMRef idref="S3.SS3.p2.m7.2"/>
                    <XMRef idref="S3.SS3.p2.m7.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p2.m7.1">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS3.p2.m7.2">t</XMTok>
                    <XMTok role="PUNCT">;</XMTok>
                    <XMApp xml:id="S3.SS3.p2.m7.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. In practice, we typically use smaller <Math mode="inline" tex="h" text="h" xml:id="S3.SS3.p2.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> than needed merely by invertibility (allowed by the model budget) so that the flow network can more closely track the FPE of the diffusion process. The invertibility of the proposed model is numerically verified in experiments (see Table <ref labelref="LABEL:inv_err"/>).</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:algo" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Training of JKO-iFlow net</title>
    <para xml:id="S4.p1">
      <p>The proposed JKO-iFlow model allows progressive learning of the residual blocks in the neural-ODE model in a block-wise manner (Section <ref labelref="LABEL:sec:layer_wise"/>).
We also introduce two techniques to improve the training of the trajectories in probability space (Section <ref labelref="LABEL:sec:traj_prob_comp"/>),
illustrated in a vector space in Appendix <ref labelref="LABEL:app:traj_comp_detail"/>.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:layer_wise" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Block-wise training</title>
      <para xml:id="S4.SS1.p1">
        <p>Note that the training of <Math mode="inline" tex="(k+1)" text="k + 1" xml:id="S4.SS1.p1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S4.SS1.p1.m1.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.SS1.p1.m1.1">
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>-th block in (<ref labelref="LABEL:eq:loss-block-k"/>) can be conducted once the previous <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> blocks are trained.
Specifically, with finite training data <Math mode="inline" tex="\{X_{i}=x_{i}(0)\}_{i=1}^{n}" text="((set@(X _ i = x _ i * 0)) _ (i = 1)) ^ n" xml:id="S4.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S4.SS1.p1.m3.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S4.SS1.p1.m3.2">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S4.SS1.p1.m3.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S4.SS1.p1.m3.1">0</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math>, the expectation <Math mode="inline" tex="\mathbb{E}_{x(t)\sim p_{k}}" text="E _ (x * t similar-to p _ k)" xml:id="S4.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMRef idref="S4.SS1.p1.m4.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.SS1.p1.m4.1">t</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> in (<ref labelref="LABEL:eq:loss-block-k"/>) is replaced by the sample average over <Math mode="inline" tex="\{x_{i}(kh)\}_{i=1}^{n}" text="((set@(x _ i * k * h)) _ (i = 1)) ^ n" xml:id="S4.SS1.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S4.SS1.p1.m5.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S4.SS1.p1.m5.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.SS1.p1.m5.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.SS1.p1.m5.1.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
              </XMApp>
            </XMath>
          </Math> which can be computed from the previous <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> blocks.
Note that for each given <Math mode="inline" tex="x(t)=x(t_{k})" text="x * t = x * t _ k" xml:id="S4.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS1.p1.m7.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p1.m7.1">t</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS1.p1.m7.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS1.p1.m7.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
both <Math mode="inline" tex="x(t_{k+1})" text="x * t _ (k + 1)" xml:id="S4.SS1.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMDual>
                  <XMRef idref="S4.SS1.p1.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS1.p1.m8.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and the integral of <Math mode="inline" tex="\nabla\cdot{\bf f}" text="nabla cdot f" xml:id="S4.SS1.p1.m9">
            <XMath>
              <XMApp>
                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
              </XMApp>
            </XMath>
          </Math> in (<ref labelref="LABEL:eq:loss-block-k"/>) can be computed by
a numerical neural ODE integrator.
Following previous works, we use the Hutchinson trace estimator <cite class="ltx_citemacro_citep">(<bibref bibrefs="Hutchinson1989ASE,FFJORD" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> to compute the quantity <Math mode="inline" tex="\nabla\cdot{\bf f}" text="nabla cdot f" xml:id="S4.SS1.p1.m10">
            <XMath>
              <XMApp>
                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                <XMTok font="bold" role="UNKNOWN">f</XMTok>
              </XMApp>
            </XMath>
          </Math> in high dimensions, and we also propose a finite-difference approach to reduce the computational cost (details in Appendix <ref labelref="LABEL:app:finite-diff"/>).
Applying the numerical integrator in computing (<ref labelref="LABEL:eq:loss-block-k"/>),
we denote the resulting <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p1.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>-th residual block abstractly as <Math mode="inline" tex="f_{\theta_{k}}" text="f _ theta _ k" xml:id="S4.SS1.p1.m12">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> with trainable parameters <Math mode="inline" tex="\theta_{k}" text="theta _ k" xml:id="S4.SS1.p1.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p>This leads to a block-wise training of the normalizing flow network, as summarized in Algorithm <ref labelref="LABEL:block_training"/>.
The sequence of time stamps <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="S4.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is given by specifying the time steps <Math mode="inline" tex="h_{k}:=t_{k+1}-t_{k}" text="h _ k assign t _ (k + 1) - t _ k" xml:id="S4.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, which we allow to differ across <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p2.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>. The choice of the sequence <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is initialized by a geometric sequence starting from <Math mode="inline" tex="h_{0}" text="h _ 0" xml:id="S4.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> with maximum stepsize <Math mode="inline" tex="h_{\rm max}" text="h _ max" xml:id="S4.SS1.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok fontsize="70%" role="UNKNOWN">max</XMTok>
              </XMApp>
            </XMath>
          </Math>, see Appendix <ref labelref="LABEL:append:tk"/>. In the special case where the multiplying factor is one, the sequence of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS1.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> gives a constant step size. The adaptive choice of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS1.p2.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> with refinement (by adding more blocks) will be introduced in Section <ref labelref="LABEL:sec:traj_prob_comp"/>.
Regarding the termination criterion <Math mode="inline" tex="\rm{Ter}(k)" text="Ter * k" xml:id="S4.SS1.p2.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN">Ter</XMTok>
                <XMDual>
                  <XMRef idref="S4.SS1.p2.m9.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok role="UNKNOWN" xml:id="S4.SS1.p2.m9.1">k</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> in line 2 of Algorithm <ref labelref="LABEL:block_training"/>, we monitor the ratio
<Math mode="inline" tex="\mathbb{E}_{x\sim p_{k-1}}\|x-T_{k}(x)\|^{2}/\mathbb{E}_{x\sim p_{k-1}}\|T_{k}%&#10;(x)\|^{2}" text="((E _ (x similar-to p _ (k - 1)) * (norm@(x - T _ k * x)) ^ 2) / E _ (x similar-to p _ (k - 1))) * (norm@(T _ k * x)) ^ 2" xml:id="S4.SS1.p2.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                          <XMApp>
                            <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                            <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="norm"/>
                          <XMRef idref="S4.SS1.p2.m10.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok name="||" role="OPEN">‖</XMTok>
                          <XMApp xml:id="S4.SS1.p2.m10.3">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S4.SS1.p2.m10.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m10.1">x</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok name="||" role="CLOSE">‖</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                        <XMApp>
                          <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="norm"/>
                      <XMRef idref="S4.SS1.p2.m10.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="||" role="OPEN">‖</XMTok>
                      <XMApp xml:id="S4.SS1.p2.m10.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.SS1.p2.m10.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m10.2">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok name="||" role="CLOSE">‖</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
and terminate when it is below some threshold <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="S4.SS1.p2.m11">
            <XMath>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
            </XMath>
          </Math>,
set as 0.01 in all experiments.
<text color="#000000">In practice, when training the <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p2.m12">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
              </XMath>
            </Math>-th block,
both the averages of <Math mode="inline" tex="\|x-T_{k}(x)\|^{2}" text="(norm@(x - T _ k * x)) ^ 2" xml:id="S4.SS1.p2.m13">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="norm"/>
                      <XMRef idref="S4.SS1.p2.m13.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="||" role="OPEN">‖</XMTok>
                      <XMApp xml:id="S4.SS1.p2.m13.2">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMApp>
                          <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S4.SS1.p2.m13.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m13.1">x</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok name="||" role="CLOSE">‖</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math><!--  %**** JKO˙arxiv˙v4.tex Line 550 **** -->
and <Math mode="inline" tex="\|T_{k}(x)\|^{2}" text="(norm@(T _ k * x)) ^ 2" xml:id="S4.SS1.p2.m14">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="norm"/>
                      <XMRef idref="S4.SS1.p2.m14.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="||" role="OPEN">‖</XMTok>
                      <XMApp xml:id="S4.SS1.p2.m14.2">
                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.SS1.p2.m14.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m14.1">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok name="||" role="CLOSE">‖</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math> are computed by empirically averaging over the training samples (in the last epoch) at no additional computational cost.</text>
Lastly, line 5 of training a “free block” (i.e., the block without the <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S4.SS1.p2.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">W</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> regularization) is to flow the push-forward density <Math mode="inline" tex="p_{L}" text="p _ L" xml:id="S4.SS1.p2.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
              </XMApp>
            </XMath>
          </Math> closer to the target density <Math mode="inline" tex="p_{Z}" text="p _ Z" xml:id="S4.SS1.p2.m17">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math>, where the former is obtained through the first <Math mode="inline" tex="L" text="L" xml:id="S4.SS1.p2.m18">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
            </XMath>
          </Math> blocks.</p>
      </para>
      <figure float="right" xml:id="S4.SS1.fig1">
        <float class="ltx_minipage" framed="top" inlist="loa" labels="LABEL:block_training" placement="H" vattach="middle" width="433.6pt" xml:id="alg1">
          <tags>
            <tag><text font="bold">Algorithm 1</text></tag>
            <tag role="autoref">1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">Algorithm 1</tag>
          </tags>
          <toccaption><tag close=" ">1</tag>Block-wise JKO-iFlow training</toccaption>
          <caption><tag close=" "><text font="bold">Algorithm 1</text></tag> Block-wise JKO-iFlow training</caption>
          <listing>
            <listingline xml:id="alg1.l0"><tags>
                <tag><text fontsize="80%">0:</text></tag>
                <tag role="autoref">0</tag>
                <tag role="refnum">0</tag>
              </tags>  Time stamps <Math mode="inline" tex="\{t_{k}\}" text="set@(t _ k)" xml:id="alg1.l0.m1">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg1.l0.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg1.l0.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>,
training data,
termination criterion <Math mode="inline" tex="\rm{Ter}" text="Ter" xml:id="alg1.l0.m2">
                <XMath>
                  <XMTok role="UNKNOWN">Ter</XMTok>
                </XMath>
              </Math> and
tolerance level <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="alg1.l0.m3">
                <XMath>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                </XMath>
              </Math>,
maximal number of blocks <Math mode="inline" tex="L_{\max}" text="L _ maximum" xml:id="alg1.l0.m4">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                    <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                  </XMApp>
                </XMath>
              </Math>.
</listingline>
            <listingline xml:id="alg1.l1"><tags>
                <tag><text fontsize="80%">1:</text></tag>
                <tag role="autoref">1</tag>
                <tag role="refnum">1</tag>
              </tags>  Initialize <Math mode="inline" tex="k=1" text="k = 1" xml:id="alg1.l1.m1">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math>.
</listingline>
            <listingline xml:id="alg1.l2"><tags>
                <tag><text fontsize="80%">2:</text></tag>
                <tag role="autoref">2</tag>
                <tag role="refnum">2</tag>
              </tags>  <text font="bold">while</text> <Math mode="inline" tex="\rm{Ter}(k)&gt;\epsilon" text="Ter * k &gt; epsilon" xml:id="alg1.l2.m1">
                <XMath>
                  <XMApp>
                    <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">Ter</XMTok>
                      <XMDual>
                        <XMRef idref="alg1.l2.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="alg1.l2.m1.1">k</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                  </XMApp>
                </XMath>
              </Math> and <Math mode="inline" tex="k\leq L_{\max}" text="k &lt;= L _ maximum" xml:id="alg1.l2.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math> <text font="bold">do</text>


</listingline>
            <listingline xml:id="alg1.l3"><tags>
                <tag><text fontsize="80%">3:</text></tag>
                <tag role="autoref">3</tag>
                <tag role="refnum">3</tag>
              </tags>     Optimize <Math mode="inline" tex="f_{\theta_{k}}" text="f _ theta _ k" xml:id="alg1.l3.m1">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math> upon minimizing (<ref labelref="LABEL:eq:loss-block-k"/>) with mini-batch sample approximation, given <Math mode="inline" tex="\{f_{\theta_{i}}\}_{i=1}^{k-1}" text="((set@(f _ theta _ i)) _ (i = 1)) ^ (k - 1)" xml:id="alg1.l3.m2">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="set"/>
                          <XMRef idref="alg1.l3.m2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                          <XMApp xml:id="alg1.l3.m2.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>. Set <Math mode="inline" tex="k\leftarrow k+1" text="k leftarrow k + 1" xml:id="alg1.l3.m3">
                <XMath>
                  <XMApp>
                    <XMTok name="leftarrow" role="ARROW">←</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>.
</listingline>
            <listingline xml:id="alg1.l4"><tags>
                <tag><text fontsize="80%">4:</text></tag>
                <tag role="autoref">4</tag>
                <tag role="refnum">4</tag>
              </tags>  <text font="bold">end</text> <text font="bold">while</text></listingline>
            <listingline xml:id="alg1.l5"><tags>
                <tag><text fontsize="80%">5:</text></tag>
                <tag role="autoref">5</tag>
                <tag role="refnum">5</tag>
              </tags>  <Math mode="inline" tex="L\leftarrow k" text="L leftarrow k" xml:id="alg1.l5.m1">
                <XMath>
                  <XMApp>
                    <XMTok name="leftarrow" role="ARROW">←</XMTok>
                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMath>
              </Math>.
<text color="#000000">
Optional:
Optimize <Math mode="inline" tex="f_{\theta_{L+1}}" text="f _ theta _ (L + 1)" xml:id="alg1.l5.m2">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMApp>
                          <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">L</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math> without <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="alg1.l5.m3">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMath>
                </Math> regularization.</text><!--  %**** JKO˙arxiv˙v4.tex Line 575 **** -->

</listingline>
          </listing>
        </float>
      </figure>
      <para xml:id="S4.SS1.p3">
        <p>The block-wise training significantly reduces the memory and computational load since only one block is trained when optimizing (<ref labelref="LABEL:eq:loss-block-k"/>) regardless of flow depth.
Therefore, one can use larger training batches and potentially more expensive numerical integrators within a certain memory budget for higher accuracy. We also empirically observe that training each block using standard back-propagation (rather than the adjoint method in neural ODE) gives a comparable result at a lower cost.
To ensure the invertibility of the trained JKO-iFlow network, we further break the time interval <Math mode="inline" tex="[t_{k-1},t_{k})" text="closed-open-interval@(t _ (k - 1), t _ k)" xml:id="S4.SS1.p3.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-open-interval"/>
                  <XMRef idref="S4.SS1.p3.m1.1"/>
                  <XMRef idref="S4.SS1.p3.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="S4.SS1.p3.m1.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS1.p3.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> into 3 or 5 subintervals to compute the neural ODE integration, e.g., by Runge-Kutta-4.
We empirically verify small inversion errors on test samples.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:traj_prob_comp" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag>Computation of trajectories in probability space</title>
      <para xml:id="S4.SS2.p1">
        <p>We adopt two additional computational techniques to facilitate learning of the trajectories in the probability space,
represented by the sequence of densities <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="S4.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="k=1,\ldots,L" text="k = list@(1, ldots, L)" xml:id="S4.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S4.SS2.p1.m2.1"/>
                    <XMRef idref="S4.SS2.p1.m2.2"/>
                    <XMRef idref="S4.SS2.p1.m2.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok meaning="1" role="NUMBER" xml:id="S4.SS2.p1.m2.1">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S4.SS2.p1.m2.2">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p1.m2.3">L</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>,
associated with the <Math mode="inline" tex="L" text="L" xml:id="S4.SS2.p1.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
            </XMath>
          </Math> residual blocks of the proposed normalizing flow network. The two techniques are illustrated in Figure <ref labelref="LABEL:enhanced_illu"/>.
Further details and illustrations of the approach can be found in Appendix <ref labelref="LABEL:app:detail-algo"/>.</p>
      </para>
      <para xml:id="S4.SS2.p2">
        <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S4.SS2.p2.m1">
            <XMath>
              <XMTok name="bullet" role="MULOP">∙</XMTok>
            </XMath>
          </Math> <text font="italic">Trajectory reparameterization</text><!--  %**** JKO˙arxiv˙v4.tex Line 600 **** -->.
We empirically observe fast decay of the movements <Math mode="inline" tex="W_{2}^{2}(T_{\#}p_{k},p_{k})" text="(W _ 2) ^ 2 * open-interval@(T _ # * p _ k, p _ k)" xml:id="S4.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">W</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S4.SS2.p2.m2.1"/>
                    <XMRef idref="S4.SS2.p2.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.SS2.p2.m2.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">T</XMTok>
                        <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS2.p2.m2.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> when <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is set to be constant,
that is,
initial blocks transport the densities much further than the later ones.
This is consistent with the exponential convergence of the Fokker-Planck flow, see (<ref labelref="LABEL:eq:W2-convergence-FK"/>), but unwanted in the algorithm because in order to train the current block, the flow model needs to transport data through all previous blocks,
and yet the later blocks trained using constant step size barely contribute to the density transport.
Hence,
instead of having constant <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>, we <text font="italic">reparameterize</text> the values of <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="S4.SS2.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> through an adaptive procedure based on the <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S4.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">W</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> distance at each block.
The procedure uses an adaptive approach to encourage the <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S4.SS2.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">W</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> movement in each block to be more even across the <Math mode="inline" tex="L" text="L" xml:id="S4.SS2.p2.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
            </XMath>
          </Math> blocks, where the retraining of the trajectory can be potentially warm-started by the previous trajectory in iteration.</p>
      </para>
      <figure inlist="lof" labels="LABEL:enhanced_illu" placement="!t" xml:id="S4.F2">
        <tags>
          <tag><text fontsize="90%">Figure 2</text></tag>
          <tag role="autoref">Figure 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Figure 2</tag>
        </tags>
        <graphics candidates="JKO-Flow.pdf" class="ltx_centering" graphic="JKO-Flow.pdf" options="width=303.53267pt,keepaspectratio=true" xml:id="S4.F2.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>
Diagram illustrating trajectory reparameterization and refinement.
Top: the original trajectory under three blocks via Algorithm <ref labelref="LABEL:block_training"/>.
Bottom: the trajectory under six blocks after reparameterization and refinement,
which renders the <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S4.F2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">W</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> movements more even.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 2</text></tag><text fontsize="90%">
Diagram illustrating trajectory reparameterization and refinement.
Top: the original trajectory under three blocks via Algorithm <ref labelref="LABEL:block_training"/>.
Bottom: the trajectory under six blocks after reparameterization and refinement,
which renders the <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S4.F2.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">W</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math> movements more even.</text></caption>
      </figure>
      <para xml:id="S4.SS2.p3">
        <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S4.SS2.p3.m1">
            <XMath>
<!--  %**** JKO_arxiv_v4.tex Line 625 **** -->              <XMTok name="bullet" role="MULOP">∙</XMTok>
            </XMath>
          </Math> <text font="italic">Progressive refinement</text>.
The performance of CNF models is typically improved with a larger number of residual blocks, corresponding to a smaller step size.
The smallness of stepsize <Math mode="inline" tex="h" text="h" xml:id="S4.SS2.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> also ensures the invertibility of the flow model, in theory and also in practice.
However, directly training the model with a small non-adaptive stepsize <Math mode="inline" tex="h" text="h" xml:id="S4.SS2.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">h</XMTok>
            </XMath>
          </Math> may result in long computation time and convergence to the normal density <Math mode="inline" tex="q_{Z}" text="q _ Z" xml:id="S4.SS2.p3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
              </XMApp>
            </XMath>
          </Math> only after a large number of blocks, where the choice of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS2.p3.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math> is not as efficient as after adaptive reparameterization.
We introduce a refinement approach to increase the number of blocks progressively, where each time interval <Math mode="inline" tex="[t_{k-1},t_{k})" text="closed-open-interval@(t _ (k - 1), t _ k)" xml:id="S4.SS2.p3.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-open-interval"/>
                  <XMRef idref="S4.SS2.p3.m6.1"/>
                  <XMRef idref="S4.SS2.p3.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="S4.SS2.p3.m6.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS2.p3.m6.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> splits into two halves, and the number of blocks doubles after the adaptive reparameterization of the trajectory converges at the coarse level.
The new trajectory at the refined level is again trained with adaptive reparameterization, where the residual blocks can be warm-started from the coarse-level model to accelerate the convergence.
The trajectory refinement allows going to a smaller step size <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="S4.SS2.p3.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
              </XMApp>
            </XMath>
          </Math>, which benefits the accuracy of the JKO-iFlow model including the numerical accuracy in integrating each neural ODE block.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" labels="LABEL:sec:experiment" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Experiment</title>
    <para xml:id="S5.p1">
      <p>In this section, we examine the proposed JKO-iFlow model on simulated and real datasets, including both unconditional and conditional generation tasks.
Codes are available at <ref class="ltx_url" font="typewriter" href="https://github.com/hamrel-cxu/JKO-iFlow">https://github.com/hamrel-cxu/JKO-iFlow</ref>.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig_FFJORD_rose LABEL:fig_IGNN_rose LABEL:fig_JKO_rose LABEL:fig_OTflow_rose LABEL:fig_rose_full_data LABEL:fig_scoresde_rose LABEL:img1 LABEL:img2 LABEL:img3" placement="!t" xml:id="S5.F3">
      <tags>
        <tag><text fontsize="90%">Figure 3</text></tag>
        <tag role="autoref">Figure 3</tag>
        <tag role="refnum">3</tag>
        <tag role="typerefnum">Figure 3</tag>
      </tags>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="130.1pt" xml:id="S5.F3.fig1">
<!--  %**** JKO˙arxiv˙v4.tex Line 650 **** -->        <graphics candidates="img_rose_true_vs_gen.png" class="ltx_centering" graphic="img_rose_true_vs_gen.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">a</tag><!--  %“small -->
True data           JKO-iFlow<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m1">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math><text font="bold">: 2.79e-4</text>, MMD-c:   2.73e-4<break/>NLL                    2.64</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%"><!--  %“small -->
True data            JKO-iFlow<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m2">
              <XMath>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              </XMath>
            </Math><text font="bold">: 2.79e-4</text>, MMD-c:   2.73e-4<break/>NLL                      2.64</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="65.0pt" xml:id="S5.F3.fig2">
        <graphics candidates="Img_rose_FFJORD.jpg" graphic="Img_rose_FFJORD.jpg" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g2"/>
        <toccaption class="ltx_centering"><tag close=" ">b</tag>
FFJORD<break/>3.88e-4<break/>2.95
</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">
FFJORD<break/>3.88e-4<break/>2.95
</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="65.0pt" xml:id="S5.F3.fig3">
        <graphics candidates="Img_rose_OT-flow.png" graphic="Img_rose_OT-flow.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g3"/>
        <toccaption class="ltx_centering"><tag close=" ">c</tag>
OT-Flow<break/>1.42e-3<break/>3.30
</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">c</text></tag><text fontsize="90%">
OT-Flow<break/>1.42e-3<break/>3.30
</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="65.0pt" xml:id="S5.F3.fig4">
        <graphics candidates="Img_rose_IGNN.png" graphic="Img_rose_IGNN.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g4"/>
        <toccaption class="ltx_centering"><tag close=" ">d</tag>
IGNN<break/>3.14e–3 <break/>3.35
</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">d</text></tag><text fontsize="90%">
IGNN<break/>3.14e–3 <break/>3.35
</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="65.0pt" xml:id="S5.F3.fig5">
        <graphics candidates="Img_rose_ScoreSDE.png" graphic="Img_rose_ScoreSDE.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g5"/>
        <toccaption class="ltx_centering"><tag close=" ">e</tag>
ScoreSDE<break/>6.90e-4<break/>3.2
</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">e</text></tag><text fontsize="90%">
ScoreSDE<break/>6.90e-4<break/>3.2
</text></caption>
      </figure>
      <break class="ltx_break"/>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="130.1pt" xml:id="S5.F3.fig6">
<!--  %**** JKO˙arxiv˙v4.tex Line 700 **** -->        <graphics candidates="img_tree_true_vs_gen.png" class="ltx_centering" graphic="img_tree_true_vs_gen.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g6"/>
        <toccaption class="ltx_centering"><tag close=" ">f</tag>
Fractal tree <break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m3">
            <XMath>
<!--  %\small -->              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math><text font="bold">: 3.12e-4</text>, MMD-c:   2.17e-4 <break/>NLL                    2.20</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">f</text></tag><text fontsize="90%">
Fractal tree <break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m4">
              <XMath>
<!--  %\small -->                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              </XMath>
            </Math><text font="bold">: 3.12e-4</text>, MMD-c:   2.17e-4 <break/>NLL                      2.20</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="130.1pt" xml:id="S5.F3.fig7">
        <graphics candidates="img_5rings_true_vs_gen_new.png" graphic="img_5rings_true_vs_gen_new.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g7"/>
        <toccaption class="ltx_centering"><tag close=" ">g</tag>
Olympic rings<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m5">
            <XMath>
<!--  %\small -->              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math><text font="bold">: 3.16e-4</text>, MMD-c:   2.36e-4<break/>NLL                    1.66</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">g</text></tag><text fontsize="90%">
Olympic rings<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m6">
              <XMath>
<!--  %\small -->                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              </XMath>
            </Math><text font="bold">: 3.16e-4</text>, MMD-c:   2.36e-4<break/>NLL                      1.66</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="130.1pt" xml:id="S5.F3.fig8">
        <graphics candidates="img_checkerboard_true_vs_gen_new.png" graphic="img_checkerboard_true_vs_gen_new.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F3.g8"/>
        <toccaption class="ltx_centering"><tag close=" ">h</tag>
Checkerboard<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m7">
            <XMath>
<!--  %\small 
     %**** JKO_arxiv_v4.tex Line 725 **** -->              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math><text font="bold">: 3.09e-4</text>, MMD-c:   2.70e-4<break/>NLL                    3.59</toccaption>
        <caption class="ltx_centering"><tag close=" "><text fontsize="90%">h</text></tag><text fontsize="90%">
Checkerboard<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F3.m8">
              <XMath>
<!--  %\small 
     %**** JKO_arxiv_v4.tex Line 725 **** -->                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              </XMath>
            </Math><text font="bold">: 3.09e-4</text>, MMD-c:   2.70e-4<break/>NLL                      3.59</text></caption>
      </figure>
      <toccaption class="ltx_centering"><tag close=" ">3</tag>
Results on two-dimensional simulated datasets by JKO-iFlow and competitors. </toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 3</text></tag><text fontsize="90%">
Results on two-dimensional simulated datasets by JKO-iFlow and competitors. </text></caption>
    </figure>
    <table inlist="lot" labels="LABEL:inv_err" placement="!b" xml:id="S5.T1">
      <tags>
        <tag><text fontsize="90%">Table 1</text></tag>
        <tag role="autoref">Table 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Table 1</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>
Inversion error
<Math mode="inline" tex="\mathbb{E}_{x\sim p_{X}}\|{T_{\theta}^{-1}}({T_{\theta}}(x))-x\|^{2}_{2}" text="E _ (x similar-to p _ X) * ((norm@((T _ theta) ^ (- 1) * T _ theta * x - x)) ^ 2) _ 2" xml:id="S5.T1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">X</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="norm"/>
                      <XMRef idref="S5.T1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="||" role="OPEN">‖</XMTok>
                      <XMApp xml:id="S5.T1.m1.2">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">T</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S5.T1.m1.2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S5.T1.m1.2.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S5.T1.m1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.T1.m1.1">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok name="||" role="CLOSE">‖</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> of JKO-iFlow
computed via sample average on the test split of the data set,
where <Math mode="inline" tex="T_{\theta}" text="T _ theta" xml:id="S5.T1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
            </XMApp>
          </XMath>
        </Math> denotes the transport mapping over all the blocks of the trained flow network.
</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table 1</text></tag><text fontsize="90%">
Inversion error
<Math mode="inline" tex="\mathbb{E}_{x\sim p_{X}}\|{T_{\theta}^{-1}}({T_{\theta}}(x))-x\|^{2}_{2}" text="E _ (x similar-to p _ X) * ((norm@((T _ theta) ^ (- 1) * T _ theta * x - x)) ^ 2) _ 2" xml:id="S5.T1.m3">
            <XMath>
              <XMApp>
                <XMTok fontsize="111%" meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">X</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="norm"/>
                        <XMRef idref="S5.T1.m3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="||" role="OPEN">‖</XMTok>
                        <XMApp xml:id="S5.T1.m3.2">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok fontsize="111%" meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S5.T1.m3.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S5.T1.m3.2.1">
                                  <XMTok fontsize="111%" meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S5.T1.m3.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.T1.m3.1">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok name="||" role="CLOSE">‖</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> of JKO-iFlow
computed via sample average on the test split of the data set,
where <Math mode="inline" tex="T_{\theta}" text="T _ theta" xml:id="S5.T1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> denotes the transport mapping over all the blocks of the trained flow network.
</text></caption>
      <inline-block align="center" depth="0.0pt" height="30.7pt" width="433.6pt" xscale="0.85139318514428" xtranslate="-37.8pt" yscale="0.85139318514428" ytranslate="2.7pt">
        <tabular vattach="middle">
          <tr>
            <td align="center">Rose</td>
            <td align="center">Fractal tree</td>
            <td align="center">Olympic rings</td>
            <td align="center" border="r">Checkerboard</td>
            <td align="center">POWER</td>
            <td align="center">GAS</td>
            <td align="center">MINIBOONE</td>
            <td align="center" border="r">BSD300</td>
            <td align="center">MNIST</td>
          </tr>
          <tr>
            <td align="center" border="t">3.30e-6</td>
            <td align="center" border="t">3.58e-5</td>
            <td align="center" border="t">2.24e-6</td>
            <td align="center" border="r t">3.07e-5</td>
            <td align="center" border="t">1.48e-5</td>
            <td align="center" border="t">1.58e-6</td>
            <td align="center" border="t">1.09e-6</td>
            <td align="center" border="r t">1.53e-5</td>
            <td align="center" border="t">1.87e-5</td>
          </tr>
        </tabular>
      </inline-block>
    </table>
    <subsection inlist="toc" labels="LABEL:tab_high_dim" xml:id="S5.SS1">
      <tags>
        <tag>5.1</tag>
        <tag role="autoref">subsection 5.1</tag>
        <tag role="refnum">5.1</tag>
        <tag role="typerefnum">§5.1</tag>
      </tags>
      <title><tag close=" ">5.1</tag>Baselines and metrics</title>
      <para xml:id="S5.SS1.p1">
        <p>We compare five alternatives,
including four CNF models and one diffusion model.
The first two CNF models are
FFJORD <cite class="ltx_citemacro_citep">(<bibref bibrefs="FFJORD" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and OT-Flow <cite class="ltx_citemacro_citep">(<bibref bibrefs="OT-Flow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which are continuous-time flow (neural-ODE models).
The next two CNF models are
IResNet <cite class="ltx_citemacro_citep">(<bibref bibrefs="iResnet" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and IGNN <cite class="ltx_citemacro_citep">(<bibref bibrefs="xu2022invertible" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
which are discrete in time (ResNet models).
The diffusion model baseline is the score-based neural SDE <cite class="ltx_citemacro_citep">(<bibref bibrefs="song2021score" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which we call “ScoreSDE.”
Details about the experimental setup, including dataset construction and neural network architecture and training, can be found in Appendix <ref labelref="LABEL:sec:additional_results"/>.</p>
      </para>
      <para xml:id="S5.SS1.p2">
        <p>The accuracy of trained generative models is evaluated by two quantitative metrics,
the negative log-likelihood (NLL) metric,
and the kernel <text font="italic">maximum mean discrepancy</text> (MMD) <cite class="ltx_citemacro_citep">(<bibref bibrefs="Gretton2012AKT" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> metric,
including MMD-1, MMD-m, and MMD-c
for constant, median distance, and custom bandwidth, respectively.
The test threshold <Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.p2.m1">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> is computed by bootstrap, where an MMD metric less than <Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> indicates that the generated distribution is evaluated by the MMD test to be the same as the true data distribution (achieving <Math mode="inline" tex="\alpha=0.05" text="alpha = 0.05" xml:id="S5.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMTok meaning="0.05" role="NUMBER">0.05</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %**** JKO˙arxiv˙v4.tex Line 775 **** --> test level).
See details in Appendix <ref labelref="LABEL:sec:metrics"/><!--  %(e.g., batches that the model uses in training) -->.
The computational cost is measured by the number of mini-batch stochastic gradient descent steps and the training time. The performance is also reported under a fixed-budget setting to compare across models.
<text color="#000000">The numerical inversion error of the trained flow models are at the 1e-5 level or below; see Table <ref labelref="LABEL:inv_err"/>.</text></p>
      </para>
      <table placement="!t" xml:id="S5.SS1.tab1">
        <toccaption><tag close=" ">2</tag>
<text color="#000000">Results on</text> tabular datasets.
All competitors are trained in a fixed-budget setup using 10 times more mini-batches
(their performances using the same number of mini-batches are worse and not comparable to JKO-iFlow).
See the complete table in Table <ref labelref="LABEL:tab_high_dim_appendix"/>.
The results using more computation are given in Table <ref labelref="LABEL:tab_high_dim_appendix_2"/>.
</toccaption>
        <caption><tag close=": "><text fontsize="90%">Table 2</text></tag><text fontsize="90%">
<text color="#000000">Results on</text> tabular datasets.
All competitors are trained in a fixed-budget setup using 10 times more mini-batches
(their performances using the same number of mini-batches are worse and not comparable to JKO-iFlow).
See the complete table in Table <ref labelref="LABEL:tab_high_dim_appendix"/>.
The results using more computation are given in Table <ref labelref="LABEL:tab_high_dim_appendix_2"/>.
</text></caption>
        <inline-block class="ltx_figure_panel" depth="0.0pt" height="142.1pt" width="203.8pt" xscale="0.526477665690802" xtranslate="-91.7pt" yscale="0.526477665690802" ytranslate="63.9pt">
          <tabular vattach="middle">
            <tr>
              <td align="left" border="t">Data Set</td>
              <td align="left" border="t">Model</td>
              <td align="left" border="t"># Param</td>
              <td align="right" border="t">Test MMD-m</td>
              <td align="right" border="t">Test MMD-1</td>
              <td align="right" border="t">NLL</td>
            </tr>
            <tr>
              <td align="left" border="t" rowspan="7"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">POWER</text> 
<Math mode="inline" tex="d=6" text="d = 6" xml:id="S5.SS1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok meaning="6" role="NUMBER">6</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td border="t"/>
              <td border="t"/>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m2">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 1.73e-4</text></td>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m3">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 2.90e-4</text></td>
              <td border="t"/>
            </tr>
            <tr>
              <td align="left">JKO-iFlow</td>
              <td align="left">76K</td>
              <td align="right">9.86e-5</td>
              <td align="right">2.40e-4</td>
              <td align="right">-0.12</td>
            </tr>
            <tr>
              <td align="left">OT-Flow</td>
              <td align="left">76K</td>
              <td align="right">7.58e-4</td>
              <td align="right">5.35e-4</td>
              <td align="right">0.32</td>
            </tr>
            <tr>
              <td align="left">FFJORD</td>
              <td align="left">76K</td>
              <td align="right">9.89e-4</td>
              <td align="right">1.16e-3</td>
              <td align="right">0.63</td>
            </tr>
            <tr>
              <td align="left">IGNN</td>
              <td align="left">304K</td>
              <td align="right">1.93e-3</td>
              <td align="right">1.59e-3</td>
              <td align="right">0.95</td>
            </tr>
            <tr>
              <td align="left">IResNet</td>
              <td align="left">304K</td>
              <td align="right">3.92e-3</td>
              <td align="right">2.43e-2</td>
              <td align="right">3.37</td>
            </tr>
            <tr>
              <td align="left">ScoreSDE</td>
              <td align="left">76K</td>
              <td align="right">9.12e-4</td>
              <td align="right">6.08e-3</td>
              <td align="right">3.41</td>
            </tr>
            <tr>
              <td align="left" border="b t" rowspan="7"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">GAS</text> 
<Math mode="inline" tex="d=8" text="d = 8" xml:id="S5.SS1.m4">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok meaning="8" role="NUMBER">8</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td border="t"/>
              <td border="t"/>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m5">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 1.85e-4</text></td>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m6">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 2.73e-4</text></td>
              <td border="t"/>
            </tr>
            <tr>
              <td align="left">JKO-iFlow</td>
              <td align="left">76K</td>
              <td align="right">1.52e-4</td>
              <td align="right">5.00e-4</td>
              <td align="right">-7.65</td>
            </tr>
            <tr>
              <td align="left">OT-Flow</td>
              <td align="left">76K</td>
              <td align="right">1.99e-4</td>
              <td align="right">5.16e-4</td>
              <td align="right">-6.04</td>
            </tr>
            <tr>
              <td align="left">FFJORD</td>
              <td align="left">76K</td>
              <td align="right">1.87e-3</td>
              <td align="right">3.28e-3</td>
              <td align="right">-2.65</td>
            </tr>
            <tr>
              <td align="left">IGNN</td>
              <td align="left">304K</td>
              <td align="right">6.74e-3</td>
              <td align="right">1.43e-2</td>
              <td align="right">-1.65</td>
            </tr>
            <tr>
              <td align="left">IResNet</td>
              <td align="left">304K</td>
              <td align="right">3.20e-3</td>
              <td align="right">2.73e-2</td>
              <td align="right">-1.17</td>
            </tr>
            <tr>
              <td align="left" border="b">ScoreSDE</td>
              <td align="left" border="b">76K</td>
              <td align="right" border="b">1.05e-3</td>
              <td align="right" border="b">8.36e-4</td>
              <td align="right" border="b">-3.69</td>
            </tr>
          </tabular>
        </inline-block>
        <break class="ltx_break"/>
        <inline-block class="ltx_figure_panel" depth="0.0pt" height="144.7pt" width="225.5pt" xscale="0.535776899681612" xtranslate="-97.7pt" yscale="0.535776899681612" ytranslate="62.7pt">
          <tabular vattach="middle">
            <tr>
              <td align="left" border="t">Data Set</td>
              <td align="left" border="t">Model</td>
              <td align="left" border="t"># Param</td>
              <td align="right" border="t">Test MMD-m</td>
              <td align="right" border="t">Test MMD-1</td>
              <td align="right" border="t">NLL</td>
            </tr>
            <tr>
              <td align="left" border="t" rowspan="7"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">MINIBOONE</text> 
<Math mode="inline" tex="d=43" text="d = 43" xml:id="S5.SS1.m7">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok meaning="43" role="NUMBER">43</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td border="t"/>
              <td border="t"/>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR><!--  %**** JKO˙arxiv˙v4.tex Line 825 **** -->[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m8">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 2.46e-4</text></td>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m9">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 3.75e-4</text></td>
              <td border="t"/>
            </tr>
            <tr>
              <td align="left">JKO-iFlow</td>
              <td align="left">112K</td>
              <td align="right">9.66e-4</td>
              <td align="right">3.79e-4</td>
              <td align="right">12.55</td>
            </tr>
            <tr>
              <td align="left">OT-Flow</td>
              <td align="left">112K</td>
              <td align="right">6.58e-4</td>
              <td align="right">3.79e-4</td>
              <td align="right">11.44</td>
            </tr>
            <tr>
              <td align="left">FFJORD</td>
              <td align="left">112K</td>
              <td align="right">3.51e-3</td>
              <td align="right">4.12e-4</td>
              <td align="right">23.77</td>
            </tr>
            <tr>
              <td align="left">IGNN</td>
              <td align="left">448K</td>
              <td align="right">1.21e-2</td>
              <td align="right">4.01e-4</td>
              <td align="right">26.45</td>
            </tr>
            <tr>
              <td align="left">IResNet</td>
              <td align="left">448K</td>
              <td align="right">2.13e-3</td>
              <td align="right">4.16e-4</td>
              <td align="right">22.36</td>
            </tr>
            <tr>
              <td align="left">ScoreSDE</td>
              <td align="left">112K</td>
              <td align="right">5.86e-1</td>
              <td align="right">4.33e-4</td>
              <td align="right">27.38</td>
            </tr>
            <tr>
              <td align="left" border="b t" rowspan="7"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">BSDS300</text>
<Math mode="inline" tex="d=63" text="d = 63" xml:id="S5.SS1.m10">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok meaning="63" role="NUMBER">63</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td border="t"/>
              <td border="t"/>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m11">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 1.38e-4</text></td>
              <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="S5.SS1.m12">
                  <XMath>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMath>
                </Math><text font="bold">: 1.01e-4</text></td>
              <td border="t"/>
            </tr>
            <tr>
              <td align="left">JKO-iFlow</td>
              <td align="left">396K</td>
              <td align="right">2.24e-4</td>
              <td align="right">1.91e-4</td>
              <td align="right">-153.82</td>
            </tr>
            <tr>
              <td align="left">OT-Flow</td>
              <td align="left">396K</td>
              <td align="right">5.43e-1</td>
              <td align="right">6.49e-1</td>
              <td align="right">-104.62</td>
            </tr>
            <tr>
              <td align="left">FFJORD</td>
              <td align="left">396K</td>
              <td align="right">5.60e-1</td>
              <td align="right">6.76e-1</td>
              <td align="right">-37.80</td>
            </tr>
            <tr>
              <td align="left">IGNN</td>
              <td align="left">990K</td>
              <td align="right">5.64e-1</td>
              <td align="right">6.86e-1</td>
              <td align="right">-37.68</td>
            </tr>
            <tr>
              <td align="left">IResNet</td>
              <td align="left">990K</td>
              <td align="right">5.50e-1</td>
              <td align="right">5.50e-1</td>
              <td align="right">-33.11</td>
            </tr>
            <tr>
              <td align="left" border="b">ScoreSDE</td>
              <td align="left" border="b">396K</td>
              <td align="right" border="b">5.61e-1</td>
              <td align="right" border="b">6.60e-1</td>
              <td align="right" border="b">-7.55</td>
            </tr>
          </tabular>
        </inline-block>
        <subsection class="ltx_figure_panel" inlist="toc" xml:id="S5.SS2">
          <tags>
            <tag>5.2</tag>
            <tag role="autoref">subsection 5.2</tag>
            <tag role="refnum">5.2</tag>
            <tag role="typerefnum">§5.2</tag>
          </tags>
          <title><tag close=" ">5.2</tag>Two-dimensional toy data</title>
          <para xml:id="S5.SS2.p1">
            <p><!--  %**** JKO˙arxiv˙v4.tex Line 850 **** -->The results on four toy datasets are shown in Figure <ref labelref="LABEL:fig_rose_full_data"/>, where the metrics of NLL and MMD-c are reported.
Plots (a)-(e) compare JKO-iFlow with the alternative models on the dataset Rose, where both NLL and MMD-c metrics show the better performance of JKO-iFlow. Visually, the generated samples <Math mode="inline" tex="\hat{X}" text="hat@(X)" xml:id="S5.SS2.p1.m1">
                <XMath>
                  <XMApp>
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                  </XMApp>
                </XMath>
              </Math> by JKO-iFlow also more resemble the true data distribution of <Math mode="inline" tex="X" text="X" xml:id="S5.SS2.p1.m2">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                </XMath>
              </Math> than the competitors in (b)-(e).
Plots (f)-(h) show the results by JKO-iFlow on the examples of Fractal tree, Olympic rings, and Checkerboard,
<text color="#000000">where JKO-iFlow gives a satisfactory generative performance.</text>
The <text color="#000000">results of</text> JKO-iFlow in Figure <ref labelref="LABEL:fig_rose_full_data"/> are obtained after applying the trajectory improvement techniques in Section <ref labelref="LABEL:sec:traj_prob_comp"/>.
The comparison results without using the techniques are provided in Figures <ref labelref="LABEL:fig_rose_sub_reparam"/> and <ref labelref="LABEL:fig_tree_sub_reparam"/>, which show the benefit of the two techniques in learning the model.</p>
          </para>
          <subsection inlist="toc" xml:id="S5.SS3">
            <tags>
              <tag>5.3</tag>
              <tag role="autoref">subsection 5.3</tag>
              <tag role="refnum">5.3</tag>
              <tag role="typerefnum">§5.3</tag>
            </tags>
            <title><tag close=" ">5.3</tag>High-dimensional tabular data</title>
            <figure inlist="lof" labels="LABEL:fig_MINIBOONE_sub_reparam LABEL:fig_reparam" placement="!b" xml:id="S5.F4">
              <tags>
                <tag><text fontsize="90%">Figure 4</text></tag>
                <tag role="autoref">Figure 4</tag>
                <tag role="refnum">4</tag>
                <tag role="typerefnum">Figure 4</tag>
              </tags>
              <figure class="ltx_figure_panel ltx_minipage" vattach="bottom" width="208.1pt" xml:id="S5.F4.fig1">
                <graphics candidates="miniboon_reparam_W2.png" graphic="miniboon_reparam_W2.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.g1"/>
                <toccaption><tag close=" ">a</tag>Per-block <Math mode="inline" tex="W_{2}^{2}" text="(W _ 2) ^ 2" xml:id="S5.F4.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">W</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMath>
                  </Math>
over reparameterization iterations.</toccaption>
                <caption><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">Per-block <Math mode="inline" tex="W_{2}^{2}" text="(W _ 2) ^ 2" xml:id="S5.F4.m2">
                      <XMath>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">W</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMath>
                    </Math>
over reparameterization iterations.</text></caption>
              </figure>
              <figure class="ltx_figure_panel ltx_minipage" vattach="bottom" width="221.1pt" xml:id="S5.F4.fig2">
                <graphics candidates="miniboone_true_vs_gen_together.png" graphic="miniboone_true_vs_gen_together.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.g2"/>
                <toccaption><tag close=" ">b</tag>Results at initial training (middle) and Iter 7 (right).
</toccaption>
                <caption><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Results at initial training (middle) and Iter 7 (right).
</text></caption>
              </figure>
<!--  %**** JKO˙arxiv˙v4.tex Line 875 **** -->              <toccaption><tag close=" ">4</tag>
Reparametrization iterations of JKO-iFlow model on MINIBOONE.
(a) After 7 reparameterization iterations, a trajectory of more uniform <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S5.F4.m3">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMath>
                </Math> movements is obtained.
(b) Generated samples by the models before and after the moving iterations (visualized in the first two principal components computed from test data).
</toccaption>
              <caption><tag close=": "><text fontsize="90%">Figure 4</text></tag><text fontsize="90%">
Reparametrization iterations of JKO-iFlow model on MINIBOONE.
(a) After 7 reparameterization iterations, a trajectory of more uniform <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S5.F4.m4">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">W</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMath>
                  </Math> movements is obtained.
(b) Generated samples by the models before and after the moving iterations (visualized in the first two principal components computed from test data).
</text></caption>
            </figure>
            <para xml:id="S5.SS3.p1">
              <p>Table <ref labelref="LABEL:tab_high_dim"/> assesses the performance of JKO-iFlow and baseline methods on four high-dimensional tabular datasets under a fixed-budget setting:
we keep the model size of continuous flow models (OT-Flow and FFJORD) and the diffusion model (ScoreSDE) the same,
and we increase model sizes for discrete flow models (IGNN and IResNet) which can be
computed faster therein and this also improves their performances.
Except for <text color="#000000">MINIBOONE</text> dataset, JKO-iFlow yields smaller or similar <text color="#000000">quantitative</text> metrics compared to all alternatives.
The visual comparisons of generated data distributions are shown in Figure <ref labelref="LABEL:pca_projection"/>.</p>
            </para>
            <para xml:id="S5.SS3.p2">
              <p>After additional training to apply the trajectory reparametrization, the performance of JKO-iFlow is furtherly improved; see Table <ref labelref="LABEL:tab_high_dim_appendix_2"/> in comparison with additional baselines of OT-Flow and FFJORD from the original references.
The effects of trajectory reparameterization on the MINIBOONE dataset are shown in Figure <ref labelref="LABEL:fig_MINIBOONE_sub_reparam"/>,
where the <Math mode="inline" tex="W_{2}" text="W _ 2" xml:id="S5.SS3.p2.m1">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMath>
                </Math> movements across the blocks become more even as the iteration proceeds, see (a). The generative performance, as shown in (b), visually improves after the reparametrization, which is consistent with the lower NLL values in Table <ref labelref="LABEL:tab_high_dim_appendix_2"/><!--  %**** JKO˙arxiv˙v4.tex Line 900 **** --> (NLL improves from 12.55 to 10.55).
These results show that JKO-iFlow
performs <text color="#000000">comparably to the best baseline</text>,
and often better under small computational and memory budgets.</p>
            </para>
            <subsection inlist="toc" labels="LABEL:sec:img_gen" xml:id="S5.SS4">
              <tags>
                <tag>5.4</tag>
                <tag role="autoref">subsection 5.4</tag>
                <tag role="refnum">5.4</tag>
                <tag role="typerefnum">§5.4</tag>
              </tags>
              <title color="#000000"><tag close=" ">5.4</tag>Image generation</title>
              <figure inlist="lof" labels="LABEL:fig:mnist-cifar-imagenet" placement="!t" xml:id="S5.F5">
                <tags>
                  <tag><text fontsize="90%">Figure 5</text></tag>
                  <tag role="autoref">Figure 5</tag>
                  <tag role="refnum">5</tag>
                  <tag role="typerefnum">Figure 5</tag>
                </tags>
                <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="390.3pt" xml:id="S5.F5.fig1">
                  <graphics candidates="MNIST_block_6.png" graphic="MNIST_block_6.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F5.g1"/>
                  <toccaption><tag close=" "><text color="#000000">a</text></tag><text color="#000000">Generated MNIST digits. FID: 7.95.</text></toccaption>
                  <caption color="#000000"><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">Generated MNIST digits. FID: 7.95.</text></caption>
                </figure>
                <break class="ltx_break"/>
                <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="193.0pt" xml:id="S5.F5.fig2">
                  <graphics candidates="CIFAR10_final_curated_4by5.png" graphic="CIFAR10_final_curated_4by5.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F5.g2"/>
                  <toccaption><tag close=" "><text color="#000000">b</text></tag><text color="#000000">Generated CIFAR10 images. FID: 29.10.</text></toccaption>
                  <caption color="#000000"><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Generated CIFAR10 images. FID: 29.10.</text></caption>
                </figure>
                <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="193.0pt" xml:id="S5.F5.fig3">
                  <graphics candidates="ImageNet_final_curated_4by5.png" graphic="ImageNet_final_curated_4by5.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F5.g3"/>
                  <toccaption><tag close=" "><text color="#000000">c</text></tag><text color="#000000">Generated Imagenet-32 images. FID: 20.10.</text></toccaption>
                  <caption color="#000000"><tag close=" "><text fontsize="90%">c</text></tag><text fontsize="90%">Generated Imagenet-32 images. FID: 20.10.</text></caption>
                </figure>
                <toccaption><tag close=" "><text color="#000000">5</text></tag><text color="#000000">
Generated samples of MNIST, CIFAR10, and Imagenet-32 by JKO-iFlow model in latent space.
We select 2 images per class for CIFAR10 and 1 image per class for Imagenet-32. The FIDs are shown in subcaptions.
Uncurated samples are shown in Figure </text><ref color="#000000" labelref="LABEL:fig:img_uncurated"/><text color="#000000">.</text></toccaption>
                <caption color="#000000"><tag close=": "><text fontsize="90%">Figure 5</text></tag><text fontsize="90%">
Generated samples of MNIST, CIFAR10, and Imagenet-32 by JKO-iFlow model in latent space.
We select 2 images per class for CIFAR10 and 1 image per class for Imagenet-32. The FIDs are shown in subcaptions.
Uncurated samples are shown in Figure <ref labelref="LABEL:fig:img_uncurated"/>.</text></caption>
              </figure>
              <para xml:id="S5.SS4.p1">
                <p><text color="#000000">We apply the JKO-iFlow model to image generation tasks on the MNIST, CIFAR-10, and Imagenet-32 datasets. In all examples, we train JKO-iFlow in the latent space of a pre-trained variational auto-encoder (VAE) adopted from </text><cite class="ltx_citemacro_citep"><text color="#000000">(</text><bibref bibrefs="esser2021taming" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                      <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                    </bibref><text color="#000000">)</text></cite><text color="#000000">.
Training generative models in latent space have been shown to obtain state-of-the-art image generation performance, e.g., in StableDiffusion </text><cite class="ltx_citemacro_citep"><text color="#000000">(</text><bibref bibrefs="rombach2022high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                      <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                    </bibref><text color="#000000">)</text></cite><text color="#000000">.
Here we train a flow model instead of a score-based diffusion model in the latent space, and more details can be found in Appendix </text><ref color="#000000" labelref="LABEL:sec:additional_results"/><text color="#000000">.</text></p>
              </para>
              <para xml:id="S5.SS4.p2">
                <p><text color="#000000">The generated images are shown in Figure </text><ref color="#000000" labelref="LABEL:fig:mnist-cifar-imagenet"/><text color="#000000">.
The quantitative evaluation is by the Fréchet inception distance (FID) score </text><cite class="ltx_citemacro_citep"><text color="#000000">(</text><bibref bibrefs="heusel2017gans" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                      <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                    </bibref><text color="#000000">)</text></cite><text color="#000000">, which is included in the figure captions.
Comparatively, we are aware of some performance gap between our model and the state-of-the-art performance of score-based diffusion models like DDPM </text><cite class="ltx_citemacro_citep"><text color="#000000">(</text><bibref bibrefs="ho2020denoising" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                      <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                    </bibref><text color="#000000">)</text></cite><text color="#000000"> and ScoreSDE </text><cite class="ltx_citemacro_citep"><text color="#000000">(</text><bibref bibrefs="song2021score" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                      <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                    </bibref><text color="#000000">)</text></cite><!--  %**** JKO˙arxiv˙v4.tex Line 950 **** --><text color="#000000">; however, the results here are obtained with less computation.
Specifically, on a single A100 GPU, our experiments took 24 hours on CIFAR10 and 30 hours on Imagenet-32.
Meanwhile, the image generation by JKO-iFlow model here obtains visually more appealing images and achieves lower FIDs compared to most CNF baselines </text><cite class="ltx_citemacro_citep"><text color="#000000">(</text><bibref bibrefs="FFJORD,iResnet,ResFlow,finlay2020train" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                      <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                    </bibref><text color="#000000">)</text></cite><text color="#000000">.</text></p>
              </para>
              <subsection inlist="toc" labels="LABEL:sec:cond_gen" xml:id="S5.SS5">
                <tags>
                  <tag>5.5</tag>
                  <tag role="autoref">subsection 5.5</tag>
                  <tag role="refnum">5.5</tag>
                  <tag role="typerefnum">§5.5</tag>
                </tags>
                <title><tag close=" ">5.5</tag>Conditional generation</title>
                <para xml:id="S5.SS5.p1">
                  <p>The problem aims to generate input samples <Math mode="inline" tex="X" text="X" xml:id="S5.SS5.p1.m1">
                      <XMath>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                      </XMath>
                    </Math> given a label <Math mode="inline" tex="Y" text="Y" xml:id="S5.SS5.p1.m2">
                      <XMath>
                        <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                      </XMath>
                    </Math> from the conditional distribution <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.SS5.p1.m3">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                        </XMApp>
                      </XMath>
                    </Math> to be learned from data.
We follow the approach in IGNN <cite class="ltx_citemacro_citep">(<bibref bibrefs="xu2022invertible" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                        <bibrefphrase>, </bibrefphrase>
                      </bibref>)</cite>.
In this setting, the JKO-iFlow network pushes from the distribution <Math mode="inline" tex="X|Y=k" text="conditional@(X, Y) = k" xml:id="S5.SS5.p1.m4">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMath>
                    </Math> to the class-specific component in the Gaussian mixture of <Math mode="inline" tex="H|Y=k" text="conditional@(H, Y) = k" xml:id="S5.SS5.p1.m5">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMApp>
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">H</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                        </XMApp>
                      </XMath>
                    </Math>, see Figure <ref labelref="LABEL:fig_cond_gen_toy"/> and Appendix <ref labelref="LABEL:append_cond_gen"/> for more details.
We apply JKO-iFlow to the Solar ramping dataset
and compare it with the original IGNN model,
and both models use graph neural network layers in the residual blocks.
The results are shown in Figure <ref labelref="LABEL:cond_gen_solar"/>, where both the NLL and MMD-m metrics indicate the superior performance of JKO-iFlow
and is consistent with the visual comparison.</p>
                </para>
                <figure inlist="lof" labels="LABEL:cond_gen_solar" placement="!t" xml:id="S5.F6">
                  <tags>
                    <tag><text fontsize="90%">Figure 6</text></tag>
                    <tag role="autoref">Figure 6</tag>
                    <tag role="refnum">6</tag>
                    <tag role="typerefnum">Figure 6</tag>
                  </tags>
                  <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="208.1pt" xml:id="S5.F6.fig3">
                    <figure class="ltx_figure_panel ltx_minipage" vattach="middle" width="286.2pt" xml:id="S5.F6.fig1">
                      <graphics candidates="Top1_solar_Chebnet_PCA.png" graphic="Top1_solar_Chebnet_PCA.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F6.g1"/>
                      <toccaption><tag close=" ">a</tag><!--  %**** JKO˙arxiv˙v4.tex Line 975 **** -->True <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.F6.m1">
                          <XMath>
                            <XMApp>
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">X</XMTok>
                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            </XMApp>
                          </XMath>
                        </Math>             JKO-iFlow<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F6.m2">
                          <XMath>
                            <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                          </XMath>
                        </Math><text font="bold">: 2.13e-3</text>, MMD-m:    8.12e-3
<break/>NLL                       -13.60</toccaption>
                      <caption><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%"><!--  %**** JKO˙arxiv˙v4.tex Line 975 **** -->True <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.F6.m3">
                            <XMath>
                              <XMApp>
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                              </XMApp>
                            </XMath>
                          </Math>              JKO-iFlow<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F6.m4">
                            <XMath>
                              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                            </XMath>
                          </Math><text font="bold">: 2.13e-3</text>, MMD-m:    8.12e-3
<break/>NLL                         -13.60</text></caption>
                    </figure>
                    <break class="ltx_break"/>
                    <figure class="ltx_figure_panel ltx_minipage" vattach="middle" width="130.1pt" xml:id="S5.F6.fig2">
                      <graphics candidates="Top1_solar_Chebnet_PCA_IGNN.png" graphic="Top1_solar_Chebnet_PCA_IGNN.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F6.g2"/>
                      <toccaption><tag close=" ">b</tag>IGNN<break/>5.70e-2<break/>-4.55</toccaption>
                      <caption><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">IGNN<break/>5.70e-2<break/>-4.55</text></caption>
                    </figure>
                  </figure>
                  <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="208.1pt" xml:id="S5.F6.fig6">
                    <figure class="ltx_figure_panel ltx_minipage" vattach="middle" width="286.2pt" xml:id="S5.F6.fig4">
                      <graphics candidates="Top2_solar_Chebnet_PCA.png" graphic="Top2_solar_Chebnet_PCA.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F6.g3"/>
                      <toccaption><tag close=" ">c</tag>True <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.F6.m5">
                          <XMath>
                            <XMApp>
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">X</XMTok>
                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            </XMApp>
                          </XMath>
                        </Math>             JKO-iFlow<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F6.m6">
                          <XMath>
                            <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                          </XMath>
                        </Math><text font="bold">: 2.88e-3,</text> MMD-m:    4.00e-2<break/>NLL                       -4.19</toccaption>
                      <caption><tag close=" "><text fontsize="90%">c</text></tag><text fontsize="90%">True <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.F6.m7">
                            <XMath>
                              <XMApp>
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                              </XMApp>
                            </XMath>
                          </Math>              JKO-iFlow<break/><Math mode="inline" tex="\tau" text="tau" xml:id="S5.F6.m8">
                            <XMath>
                              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                            </XMath>
                          </Math><text font="bold">: 2.88e-3,</text> MMD-m:    4.00e-2<break/>NLL                         -4.19</text></caption>
                    </figure>
                    <break class="ltx_break"/>
                    <figure class="ltx_figure_panel ltx_minipage" vattach="middle" width="130.1pt" xml:id="S5.F6.fig5">
                      <graphics candidates="Top2_solar_Chebnet_PCA_IGNN.png" graphic="Top2_solar_Chebnet_PCA_IGNN.png" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F6.g4"/>
                      <toccaption><tag close=" "><!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** -->d<!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** --></tag><!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** -->IGNN<break/>7.67e-2<break/>1.53
</toccaption>
                      <caption><tag close=" "><!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** --><text fontsize="90%"><!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** -->d<!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** --></text></tag><!--  %**** JKO˙arxiv˙v4.tex Line 1000 **** 
     %**** JKO˙arxiv˙v4.tex Line 1000 **** --><text fontsize="90%">IGNN<break/>7.67e-2<break/>1.53
</text></caption>
                    </figure>
                  </figure>
                  <toccaption class="ltx_centering"><tag close=" ">6</tag>
Conditional graph nodal data generation by JKO-iFlow and iGNN on Solar ramping data.
The nodal data <Math mode="inline" tex="X\in\mathbb{R}^{10\times 2}" text="X element-of R ^ (10 * 2)" xml:id="S5.F6.m9">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                              <XMTok fontsize="70%" meaning="10" role="NUMBER">10</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math> and the nodal label <Math mode="inline" tex="Y\in\{0,1\}^{10}" text="Y element-of (set@(0, 1)) ^ 10" xml:id="S5.F6.m10">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="set"/>
                                <XMRef idref="S5.F6.m10.1"/>
                                <XMRef idref="S5.F6.m10.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">{</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="S5.F6.m10.1">0</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok meaning="1" role="NUMBER" xml:id="S5.F6.m10.2">1</XMTok>
                                <XMTok role="CLOSE" stretchy="false">}</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok fontsize="70%" meaning="10" role="NUMBER">10</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math>.
<text color="#000000">
Plots (a)(b) and (c)(d) are for two different sets of values <Math mode="inline" tex="Y" text="Y" xml:id="S5.F6.m11">
                        <XMath>
                          <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                        </XMath>
                      </Math> across all nodes respectively.
Samples <Math mode="inline" tex="X" text="X" xml:id="S5.F6.m12">
                        <XMath>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        </XMath>
                      </Math> (concatenated across all nodes) are visualized by projection to two principal components (determined by true samples <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.F6.m13">
                        <XMath>
                          <XMApp>
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                          </XMApp>
                        </XMath>
                      </Math>). </text></toccaption>
                  <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 6</text></tag><text fontsize="90%">
Conditional graph nodal data generation by JKO-iFlow and iGNN on Solar ramping data.
The nodal data <Math mode="inline" tex="X\in\mathbb{R}^{10\times 2}" text="X element-of R ^ (10 * 2)" xml:id="S5.F6.m14">
                        <XMath>
                          <XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                                <XMTok fontsize="70%" meaning="10" role="NUMBER">10</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMath>
                      </Math> and the nodal label <Math mode="inline" tex="Y\in\{0,1\}^{10}" text="Y element-of (set@(0, 1)) ^ 10" xml:id="S5.F6.m15">
                        <XMath>
                          <XMApp>
                            <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="set"/>
                                  <XMRef idref="S5.F6.m15.1"/>
                                  <XMRef idref="S5.F6.m15.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                                  <XMTok meaning="0" role="NUMBER" xml:id="S5.F6.m15.1">0</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMTok meaning="1" role="NUMBER" xml:id="S5.F6.m15.2">1</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="70%" meaning="10" role="NUMBER">10</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMath>
                      </Math>.
<text color="#000000">
Plots (a)(b) and (c)(d) are for two different sets of values <Math mode="inline" tex="Y" text="Y" xml:id="S5.F6.m16">
                          <XMath>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                          </XMath>
                        </Math> across all nodes respectively.
Samples <Math mode="inline" tex="X" text="X" xml:id="S5.F6.m17">
                          <XMath>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          </XMath>
                        </Math> (concatenated across all nodes) are visualized by projection to two principal components (determined by true samples <Math mode="inline" tex="X|Y" text="conditional@(X, Y)" xml:id="S5.F6.m18">
                          <XMath>
                            <XMApp>
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">X</XMTok>
                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            </XMApp>
                          </XMath>
                        </Math>). </text></text></caption>
                </figure>
                <section inlist="toc" labels="LABEL:sec:conclude" xml:id="S6">
                  <tags>
                    <tag>6</tag>
                    <tag role="autoref">section 6</tag>
                    <tag role="refnum">6</tag>
                    <tag role="typerefnum">§6</tag>
                  </tags>
                  <title><tag close=" ">6</tag>Discussion</title>
                  <para xml:id="S6.p1">
                    <p><!--  %**** JKO˙arxiv˙v4.tex Line 1025 **** -->The work can be extended in several directions.
The application to larger-scale image datasets
and larger graphs will enlarge the scope of usage.
To overcome the computational challenge faced by neural ODE models for high dimensional input, e.g., images of higher resolution, one would need to improve the training efficiency of the backpropagation in neural ODE in addition to the dimension reduction techniques by VAE as been explored here.
Another possibility is to combine the JKO-iFlow scheme with other backbone flow models that are more suitable for the specific tasks.
Meanwhile, it would be interesting to extend the method to other problems for which CNF models have proven to be effective.
Examples include
multi-dimensional probabilistic regression <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2018neural" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                          <bibrefphrase>, </bibrefphrase>
                        </bibref>)</cite>,
a plug-in to deep architectures such as StyleFlow <cite class="ltx_citemacro_citep">(<bibref bibrefs="abdal2021styleflow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                          <bibrefphrase>, </bibrefphrase>
                        </bibref>)</cite>,
and the application to Mean-field Games <cite class="ltx_citemacro_citep">(<bibref bibrefs="huang2023bridging" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                          <bibrefphrase>, </bibrefphrase>
                        </bibref>)</cite>.</p>
                  </para>
                  <para xml:id="S6.p2">
                    <p>Theoretically, the expressiveness of the flow model to generate a regular data distribution can be analyzed based on Section <ref labelref="LABEL:subsec:invertible-express"/>.
To sketch a road map,
a block-wise approximation guarantee of <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="S6.p2.m1">
                        <XMath>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="bold" role="UNKNOWN">f</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S6.p2.m1.1"/>
                                <XMRef idref="S6.p2.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S6.p2.m1.1">x</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S6.p2.m1.2">t</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMath>
                      </Math> as in (<ref labelref="LABEL:eq:f(x,t)-FK"/>) can lead to approximation of the Fokker-Planck flow (<ref labelref="LABEL:eq:fokker-planck"/>), which pushes forward the density to be <Math mode="inline" tex="\varepsilon" text="varepsilon" xml:id="S6.p2.m2">
                        <XMath>
                          <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                        </XMath>
                      </Math>-close to normality in <Math mode="inline" tex="T=\log(1/\varepsilon)" text="T = logarithm@(1 / varepsilon)" xml:id="S6.p2.m3">
                        <XMath>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S6.p2.m3.1"/>
                                <XMRef idref="S6.p2.m3.2"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S6.p2.m3.1">log</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S6.p2.m3.2">
                                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMath>
                      </Math> time, see (<ref labelref="LABEL:eq:W2-convergence-FK"/>).
Reversing the time of the ODE then leads to an approximation of the initial density <Math mode="inline" tex="\rho_{0}=p_{X}" text="rho _ 0 = p _ X" xml:id="S6.p2.m4">
                        <XMath>
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMath>
                      </Math> by flowing backward in time from <Math mode="inline" tex="T" text="T" xml:id="S6.p2.m5">
                        <XMath>
                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                        </XMath>
                      </Math> to zero. Further analysis under technical assumptions is left to future work. <text color="#000000">During the time that this paper was being published, the convergence analysis of the proposed model was studied in <cite class="ltx_citemacro_cite"><bibref bibrefs="cheng2023convergence" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                            <bibrefphrase>(</bibrefphrase>
                            <bibrefphrase>)</bibrefphrase>
                          </bibref></cite>.</text></p>
                  </para>
                  <section xml:id="Sx1">
                    <title>Acknowledgement</title>
                    <para xml:id="Sx1.p1">
                      <p>The authors thank Jianfeng Lu, Yulong Lu, and Yiping Lu for helpful discussions.
The work is partially supported by NSF DMS-2134037.
C.X. and Y.X. are partially supported by an NSF CAREER CCF-1650913, and NSF DMS-2134037, CMMI-2015787, CMMI-2112533, DMS-1938106, and DMS-1830210 and the Coca-Cola Foundation.
XC is also partially supported by
NSF DMS-2237842 and Simons Foundation.</p>
                    </para>
                    <bibliography citestyle="authoryear" files="JKO_references" xml:id="bib">
                      <title>References</title>
                    </bibliography>
                    <appendix inlist="toc" labels="LABEL:sec:proof" xml:id="A1">
                      <tags>
                        <tag>Appendix A</tag>
                        <tag role="autoref">Appendix A</tag>
                        <tag role="refnum">A</tag>
                        <tag role="typerefnum">Appendix A</tag>
                      </tags>
                      <title><tag close=" ">Appendix A</tag>Proofs</title>
                      <toctitle><tag close=" ">A</tag>Proofs</toctitle>
                      <subsection inlist="toc" xml:id="A1.SS1">
                        <tags>
                          <tag>A.1</tag>
                          <tag role="autoref">subsection A.1</tag>
                          <tag role="refnum">A.1</tag>
                          <tag role="typerefnum">§A.1</tag>
                        </tags>
                        <title><tag close=" ">A.1</tag>Proofs in Section </title>
                        <theorem class="ltx_theorem_lemma" inlist="thm theorem:lemma" labels="LABEL:lemma:JKO-by-Tk" xml:id="A1.Thmtheorem1">
                          <tags>
                            <tag>Lemma A.1</tag>
                            <tag role="autoref">A.1</tag>
                            <tag role="refnum">A.1</tag>
                            <tag role="typerefnum">Lemma A.1</tag>
                          </tags>
                          <title class="ltx_runin"><tag><text font="bold">Lemma A.1</text></tag><text font="bold">.</text></title>
                          <para xml:id="A1.Thmtheorem1.p1">
                            <p><text font="italic">Suppose <Math mode="inline" tex="p" text="p" xml:id="A1.Thmtheorem1.p1.m1">
                                  <XMath>
                                    <XMTok role="UNKNOWN">p</XMTok>
                                  </XMath>
                                </Math> and <Math mode="inline" tex="q" text="q" xml:id="A1.Thmtheorem1.p1.m2">
                                  <XMath>
                                    <XMTok role="UNKNOWN">q</XMTok>
                                  </XMath>
                                </Math> are two densities on <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="A1.Thmtheorem1.p1.m3">
                                  <XMath>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="blackboard upright" role="UNKNOWN">R</XMTok>
                                      <XMTok fontsize="70%" role="UNKNOWN">d</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math> in <Math mode="inline" tex="\mathcal{P}" text="P" xml:id="A1.Thmtheorem1.p1.m4">
                                  <XMath>
                                    <XMTok font="caligraphic upright" role="UNKNOWN">P</XMTok>
                                  </XMath>
                                </Math>, the following two problems</text></p>
                            <equation labels="LABEL:eq:def-JKO-1-lemma" xml:id="A1.E13">
                              <tags>
                                <tag>(13)</tag>
                                <tag role="autoref">Equation 13</tag>
                                <tag role="refnum">13</tag>
                              </tags>
                              <Math class="ltx_math_unparsed" mode="display" tex="\min_{\rho\in\mathcal{P}}L_{\rho}[\rho]={\rm KL}(\rho||q)+\frac{1}{2h}W_{2}^{2%&#10;}(p,\rho)," xml:id="A1.E13.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">P</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMTok font="italic" name="rho" role="UNKNOWN" xml:id="A1.E13.m1.1">ρ</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok role="UNKNOWN">KL</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok role="PUNCT">,</XMTok>
                                </XMath>
                              </Math>
                            </equation>
                            <equation labels="LABEL:eq:def-JKO-2-lemma" xml:id="A1.E14">
                              <tags>
                                <tag>(14)</tag>
                                <tag role="autoref">Equation 14</tag>
                                <tag role="refnum">14</tag>
                              </tags>
                              <Math class="ltx_math_unparsed" mode="display" tex="\min_{T:\mathbb{R}^{d}\to\mathbb{R}^{d}}L_{T}[T]={\rm KL}(T_{\#}p||q)+\frac{1}%&#10;{2h}\mathbb{E}_{x\sim p}\|x-T(x)\|^{2}," xml:id="A1.E14.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                    <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" name="to" role="ARROW">→</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="blackboard" fontsize="70%" role="UNKNOWN">R</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">d</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="blackboard" fontsize="70%" role="UNKNOWN">R</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">d</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E14.m1.1">T</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
<!--  %**** JKO_arxiv_v4.tex Line 1075 **** 
 %**** JKO_arxiv_v4.tex Line 1075 **** -->                                  <XMTok role="UNKNOWN">KL</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                      <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok name="||" role="VERTBAR">∥</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok name="||" role="VERTBAR">∥</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                </XMath>
                              </Math>
                            </equation>
                            <p><text font="italic">have the same minimum and</text></p>
                          </para>
                          <para xml:id="A1.Thmtheorem1.p2">
                            <p><text font="italic">(a) If <Math mode="inline" tex="T^{*}:\mathbb{R}^{d}\to\mathbb{R}^{d}" text="T ^ * colon R ^ d to R ^ d" xml:id="A1.Thmtheorem1.p2.m1">
                                  <XMath>
                                    <XMApp>
                                      <XMTok font="upright" name="colon" role="METARELOP">:</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok role="UNKNOWN">T</XMTok>
                                        <XMTok font="upright" fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok font="upright" name="to" role="ARROW">→</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="blackboard upright" role="UNKNOWN">R</XMTok>
                                          <XMTok fontsize="70%" role="UNKNOWN">d</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="blackboard upright" role="UNKNOWN">R</XMTok>
                                          <XMTok fontsize="70%" role="UNKNOWN">d</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMath>
                                </Math> is a minimizer of (<ref labelref="LABEL:eq:def-JKO-2-lemma"/>),
then <Math mode="inline" tex="\rho^{*}=(T^{*})_{\#}p" text="rho ^ * = (T ^ *) _ # * p" xml:id="A1.Thmtheorem1.p2.m2">
                                  <XMath>
                                    <XMApp>
                                      <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMTok font="upright" fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMDual>
                                            <XMRef idref="A1.Thmtheorem1.p2.m2.1"/>
                                            <XMWrap>
                                              <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.Thmtheorem1.p2.m2.1">
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMTok role="UNKNOWN">T</XMTok>
                                                <XMTok font="upright" fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                              </XMApp>
                                              <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="upright" fontsize="70%" role="UNKNOWN">#</XMTok>
                                        </XMApp>
                                        <XMTok role="UNKNOWN">p</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMath>
                                </Math> is a minimizer of (<ref labelref="LABEL:eq:def-JKO-1-lemma"/>).</text></p>
                          </para>
                          <para xml:id="A1.Thmtheorem1.p3">
                            <p><text font="italic">(b) If <Math mode="inline" tex="\rho^{*}" text="rho ^ *" xml:id="A1.Thmtheorem1.p3.m1">
                                  <XMath>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok font="upright" fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math> is a minimizer of (<ref labelref="LABEL:eq:def-JKO-1-lemma"/>),
then the optimal transport from <Math mode="inline" tex="p" text="p" xml:id="A1.Thmtheorem1.p3.m2">
                                  <XMath>
                                    <XMTok role="UNKNOWN">p</XMTok>
                                  </XMath>
                                </Math> to <Math mode="inline" tex="\rho^{*}" text="rho ^ *" xml:id="A1.Thmtheorem1.p3.m3">
                                  <XMath>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok font="upright" fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math> minimizes (<ref labelref="LABEL:eq:def-JKO-2-lemma"/>).</text></p>
                          </para>
                        </theorem>
                        <proof>
                          <title class="ltx_runin" font="italic">Proof of Lemma <ref labelref="LABEL:lemma:JKO-by-Tk"/>.</title>
                          <para xml:id="A1.SS1.p1">
                            <p>Let the minimum of (<ref labelref="LABEL:eq:def-JKO-2-lemma"/>) be <Math mode="inline" tex="L_{T}^{*}" text="(L _ T) ^ *" xml:id="A1.SS1.p1.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>, and that of (<ref labelref="LABEL:eq:def-JKO-1-lemma"/>) be <Math mode="inline" tex="L_{\rho}^{*}" text="(L _ rho) ^ *" xml:id="A1.SS1.p1.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.</p>
                          </para>
                          <para xml:id="A1.SS1.p2">
                            <p>Proof of (a):
Suppose <Math mode="inline" tex="L_{T}" text="L _ T" xml:id="A1.SS1.p2.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> achieves minimum at <Math mode="inline" tex="T^{*}" text="T ^ *" xml:id="A1.SS1.p2.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>,
then <Math mode="inline" tex="T^{*}" text="T ^ *" xml:id="A1.SS1.p2.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> is the optimal transport from <Math mode="inline" tex="p" text="p" xml:id="A1.SS1.p2.m4">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                </XMath>
                              </Math> to <Math mode="inline" tex="\rho^{*}=(T^{*})_{\#}p" text="rho ^ * = (T ^ *) _ # * p" xml:id="A1.SS1.p2.m5">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMRef idref="A1.SS1.p2.m5.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.SS1.p2.m5.1">
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                              <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> because otherwise <Math mode="inline" tex="L_{T}" text="L _ T" xml:id="A1.SS1.p2.m6">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> can be further improved.
By definition of <Math mode="inline" tex="L_{\rho}" text="L _ rho" xml:id="A1.SS1.p2.m7">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>, we have
<Math mode="inline" tex="L_{T}^{*}=L_{T}[T^{*}]=L_{\rho}[\rho^{*}]\geq L_{\rho}^{*}" text="(L _ T) ^ * = L _ T * delimited-[]@(T ^ *) = L _ rho * delimited-[]@(rho ^ *) &gt;= (L _ rho) ^ *" xml:id="A1.SS1.p2.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="multirelation"/>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p2.m8.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p2.m8.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p2.m8.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p2.m8.2">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>.
We claim that <Math mode="inline" tex="L_{T}^{*}=L_{\rho}^{*}" text="(L _ T) ^ * = (L _ rho) ^ *" xml:id="A1.SS1.p2.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>.
Otherwise, there is another <Math mode="inline" tex="\rho^{\prime}" text="rho ^ prime" xml:id="A1.SS1.p2.m10">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> such that <Math mode="inline" tex="L_{\rho}[\rho^{\prime}]&lt;L_{T}^{*}" text="L _ rho * delimited-[]@(rho ^ prime) &lt; (L _ T) ^ *" xml:id="A1.SS1.p2.m11">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p2.m11.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p2.m11.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>.
Let <Math mode="inline" tex="T^{\prime}" text="T ^ prime" xml:id="A1.SS1.p2.m12">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> be the optimal transport from <Math mode="inline" tex="p" text="p" xml:id="A1.SS1.p2.m13">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                </XMath>
                              </Math> to <Math mode="inline" tex="\rho^{\prime}" text="rho ^ prime" xml:id="A1.SS1.p2.m14">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>, and then <Math mode="inline" tex="L_{T}[T^{\prime}]=L_{\rho}[\rho^{\prime}]&lt;L_{T}^{*}" text="L _ T * delimited-[]@(T ^ prime) = L _ rho * delimited-[]@(rho ^ prime) &lt; (L _ T) ^ *" xml:id="A1.SS1.p2.m15">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="multirelation"/>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p2.m15.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p2.m15.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p2.m15.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p2.m15.2">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>,
contradicting with that <Math mode="inline" tex="L_{T}^{*}" text="(L _ T) ^ *" xml:id="A1.SS1.p2.m16">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> is the minimum of <Math mode="inline" tex="L_{T}" text="L _ T" xml:id="A1.SS1.p2.m17">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>. This also shows that <Math mode="inline" tex="L_{\rho}[\rho^{*}]=L_{T}^{*}=L_{\rho}^{*}" text="L _ rho * delimited-[]@(rho ^ *) = (L _ T) ^ * = (L _ rho) ^ *" xml:id="A1.SS1.p2.m18">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="multirelation"/>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p2.m18.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p2.m18.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>, that is, <Math mode="inline" tex="\rho^{*}" text="rho ^ *" xml:id="A1.SS1.p2.m19">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> is a minimizer of <Math mode="inline" tex="L_{\rho}" text="L _ rho" xml:id="A1.SS1.p2.m20">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.</p>
                          </para>
                          <para xml:id="A1.SS1.p3">
                            <p><!--  %**** JKO˙arxiv˙v4.tex Line 1100 **** -->Proof of (b): Suppose <Math mode="inline" tex="L_{\rho}" text="L _ rho" xml:id="A1.SS1.p3.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> achieves minimum at <Math mode="inline" tex="\rho^{*}" text="rho ^ *" xml:id="A1.SS1.p3.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>. Let <Math mode="inline" tex="T^{*}" text="T ^ *" xml:id="A1.SS1.p3.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> be the OT from <Math mode="inline" tex="p" text="p" xml:id="A1.SS1.p3.m4">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                </XMath>
                              </Math> to <Math mode="inline" tex="\rho^{*}" text="rho ^ *" xml:id="A1.SS1.p3.m5">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>, then <Math mode="inline" tex="\mathbb{E}_{x\sim p}|x-T^{*}(x)|^{2}=W_{2}(p,\rho^{*})^{2}" text="E _ (x similar-to p) * (absolute-value@(x - T ^ * * x)) ^ 2 = W _ 2 * (open-interval@(p, rho ^ *)) ^ 2" xml:id="A1.SS1.p3.m6">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="absolute-value"/>
                                            <XMRef idref="A1.SS1.p3.m6.3"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                                            <XMApp xml:id="A1.SS1.p3.m6.3">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="A1.SS1.p3.m6.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p3.m6.1">x</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A1.SS1.p3.m6.2"/>
                                            <XMRef idref="A1.SS1.p3.m6.4"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p3.m6.2">p</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.SS1.p3.m6.4">
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                              <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>, and then <Math mode="inline" tex="L_{T}[T^{*}]=L_{\rho}[\rho^{*}]=L_{\rho}^{*}" text="L _ T * delimited-[]@(T ^ *) = L _ rho * delimited-[]@(rho ^ *) = (L _ rho) ^ *" xml:id="A1.SS1.p3.m7">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="multirelation"/>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p3.m7.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p3.m7.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="delimited-[]"/>
                                          <XMRef idref="A1.SS1.p3.m7.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="A1.SS1.p3.m7.2">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> which equals <Math mode="inline" tex="L_{T}^{*}" text="(L _ T) ^ *" xml:id="A1.SS1.p3.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> as proved in (a). This shows that <Math mode="inline" tex="T^{*}" text="T ^ *" xml:id="A1.SS1.p3.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                    <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> is a minimizer of <Math mode="inline" tex="L_{T}" text="L _ T" xml:id="A1.SS1.p3.m10">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.
∎</p>
                          </para>
                        </proof>
                        <proof>
                          <title class="ltx_runin" font="italic">Proof of Proposition <ref labelref="LABEL:prop:FT-layer-wise"/>,.</title>
                          <para xml:id="A1.SS1.p4">
                            <p>Given <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="A1.SS1.p4.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> being the density of <Math mode="inline" tex="x(t)" text="x * t" xml:id="A1.SS1.p4.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.SS1.p4.m2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m2.1">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> at <Math mode="inline" tex="t=kh" text="t = k * h" xml:id="A1.SS1.p4.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>, recall that <Math mode="inline" tex="T" text="T" xml:id="A1.SS1.p4.m4">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                </XMath>
                              </Math> is the solution map from <Math mode="inline" tex="x(t)" text="x * t" xml:id="A1.SS1.p4.m5">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.SS1.p4.m5.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m5.1">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> to <Math mode="inline" tex="x(t+h)" text="x * (t + h)" xml:id="A1.SS1.p4.m6">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.SS1.p4.m6.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.SS1.p4.m6.1">
                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>.
We denote <Math mode="inline" tex="\rho_{t}:=p_{k}" text="rho _ t assign p _ k" xml:id="A1.SS1.p4.m7">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>, and <Math mode="inline" tex="\rho_{t+h}:=T_{\#}p_{k}" text="rho _ (t + h) assign T _ # * p _ k" xml:id="A1.SS1.p4.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                        <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>. By definition,</p>
                            <equation labels="LABEL:eq:KL-pf-1" xml:id="A1.E15">
                              <tags>
                                <tag>(15)</tag>
                                <tag role="autoref">Equation 15</tag>
                                <tag role="refnum">15</tag>
                              </tags>
                              <Math class="ltx_math_unparsed" mode="display" tex="{\rm KL}(T_{\#}p_{k}||p_{Z})=\mathbb{E}_{x\sim\rho_{t+h}}(\log{\rho}_{t+h}(x)-%&#10;\log p_{Z}(x))." xml:id="A1.E15.m1">
                                <XMath>
                                  <XMTok role="UNKNOWN">KL</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                      <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    <XMTok role="VERTBAR" stretchy="false">|</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok role="PERIOD">.</XMTok>
                                </XMath>
                              </Math>
                            </equation>
                            <p>Because <Math mode="inline" tex="p_{Z}\propto e^{-V}" text="p _ Z proportional-to e ^ (- V)" xml:id="A1.SS1.p4.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>, <Math mode="inline" tex="V(x)={|x|^{2}}/{2}" text="V * x = (absolute-value@(x)) ^ 2 / 2" xml:id="A1.SS1.p4.m10">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                      <XMDual>
                                        <XMRef idref="A1.SS1.p4.m10.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m10.1">x</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="divide" role="MULOP">/</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="absolute-value"/>
                                            <XMRef idref="A1.SS1.p4.m10.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m10.2">x</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>,
we have <Math mode="inline" tex="\log p_{Z}(x)=-V(x)+c_{1}" text="logarithm@(p _ Z) * x = (- V * x) + c _ 1" xml:id="A1.SS1.p4.m11">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A1.SS1.p4.m11.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m11.1">x</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                          <XMDual>
                                            <XMRef idref="A1.SS1.p4.m11.2"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m11.2">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> for some constant <Math mode="inline" tex="c_{1}" text="c _ 1" xml:id="A1.SS1.p4.m12">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.
Thus</p>
                            <equation labels="LABEL:eq:KL-pf-2" xml:id="A1.E16">
                              <tags>
                                <tag>(16)</tag>
                                <tag role="autoref">Equation 16</tag>
                                <tag role="refnum">16</tag>
                              </tags>
                              <Math mode="display" tex="\mathbb{E}_{x\sim\rho_{t+h}}\log p_{Z}(x)=\mathbb{E}_{x(t)\sim\rho_{t}}\log p_%&#10;{Z}(x(t+h))=c_{1}-\mathbb{E}_{x(t)\sim\rho_{t}}V(x(t+h))." text="E _ (x similar-to rho _ (t + h)) * logarithm@(p _ Z) * x = E _ (x * t similar-to rho _ t) * logarithm@(p _ Z) * x * (t + h) = c _ 1 - E _ (x * t similar-to rho _ t) * V * x * (t + h)" xml:id="A1.E16.m1">
                                <XMath>
                                  <XMDual>
                                    <XMRef idref="A1.E16.m1.4"/>
                                    <XMWrap>
                                      <XMApp xml:id="A1.E16.m1.4">
                                        <XMTok meaning="multirelation"/>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMApp>
                                                  <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">h</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A1.E16.m1.3"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m1.3">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A1.E16.m1.1"/>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E16.m1.1">t</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Z</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A1.E16.m1.4.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.E16.m1.4.1">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A1.E16.m1.4.1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.E16.m1.4.1.1">
                                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A1.E16.m1.2"/>
                                                    <XMWrap>
                                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E16.m1.2">t</XMTok>
                                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                            <XMDual>
                                              <XMRef idref="A1.E16.m1.4.2"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A1.E16.m1.4.2">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A1.E16.m1.4.2.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A1.E16.m1.4.2.1">
                                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PERIOD">.</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
                            </equation>
                            <p>To compute the first term in (<ref labelref="LABEL:eq:KL-pf-1"/>), note that</p>
                            <equation labels="LABEL:eq:entropy-rhot+h" xml:id="A1.E17">
                              <tags>
                                <tag>(17)</tag>
                                <tag role="autoref">Equation 17</tag>
                                <tag role="refnum">17</tag>
                              </tags>
                              <Math mode="display" tex="\mathbb{E}_{x\sim\rho_{t+h}}\log\rho_{t+h}(x)=\mathbb{E}_{x(t)\sim\rho_{t}}%&#10;\log\rho_{t+h}(x(t+h))," text="E _ (x similar-to rho _ (t + h)) * logarithm@(rho _ (t + h)) * x = E _ (x * t similar-to rho _ t) * logarithm@(rho _ (t + h)) * x * (t + h)" xml:id="A1.E17.m1">
                                <XMath>
                                  <XMDual>
                                    <XMRef idref="A1.E17.m1.3"/>
                                    <XMWrap>
                                      <XMApp xml:id="A1.E17.m1.3">
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMApp>
                                                  <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">h</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A1.E17.m1.2"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E17.m1.2">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A1.E17.m1.1"/>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E17.m1.1">t</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A1.E17.m1.3.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.E17.m1.3.1">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A1.E17.m1.3.1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.E17.m1.3.1.1">
                                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
                            </equation>
                            <p><!--  %**** JKO˙arxiv˙v4.tex Line 1125 **** -->and by the expression (called “instantaneous change-of-variable formula” in normalizing flow literature <cite class="ltx_citemacro_citep">[<bibref bibrefs="chen2018neural" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                  <bibrefphrase>, </bibrefphrase>
                                </bibref>]</cite>,
which we derive directly below)</p>
                            <equation labels="LABEL:eq:ddtlogrho(x(t),t)" xml:id="A1.E18">
                              <tags>
                                <tag>(18)</tag>
                                <tag role="autoref">Equation 18</tag>
                                <tag role="refnum">18</tag>
                              </tags>
                              <Math mode="display" tex="{\frac{d}{dt}}\log\rho(x(t),t)=-\nabla\cdot{\bf f}(x(t),t)," text="(d / (d * t)) * logarithm@(rho) * open-interval@(x * t, t) = - (nabla cdot f) * open-interval@(x * t, t)" xml:id="A1.E18.m1">
                                <XMath>
                                  <XMDual>
                                    <XMRef idref="A1.E18.m1.5"/>
                                    <XMWrap>
                                      <XMApp xml:id="A1.E18.m1.5">
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A1.E18.m1.5.1"/>
                                              <XMRef idref="A1.E18.m1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.E18.m1.5.1">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A1.E18.m1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m1.1">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m1.2">t</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                              <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                              <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="A1.E18.m1.5.2"/>
                                                <XMRef idref="A1.E18.m1.4"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A1.E18.m1.5.2">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A1.E18.m1.3"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m1.3">t</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m1.4">t</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
                            </equation>
                            <p>we have that for each value of <Math mode="inline" tex="x(t)" text="x * t" xml:id="A1.SS1.p4.m13">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.SS1.p4.m13.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m13.1">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>,</p>
                            <equationgroup class="ltx_eqn_align" xml:id="A3.EGx1">
                              <equation xml:id="A1.Ex2">
                                <MathFork>
                                  <Math tex="\displaystyle\log\rho_{t+h}(x(t+h))=\log\rho(x(t+h),t+h)=\log\rho(x(t),t)-\int%&#10;_{t}^{t+h}\nabla\cdot\mathbf{f}(x(s),s)ds." text="logarithm@(rho _ (t + h)) * x * (t + h) = logarithm@(rho) * open-interval@(x * (t + h), t + h) = logarithm@(rho) * open-interval@(x * t, t) - ((integral _ t) ^ (t + h))@((nabla cdot f) * open-interval@(x * s, s) * differential-d@(s))" xml:id="A1.Ex2.m3">
                                    <XMath>
                                      <XMDual>
                                        <XMRef idref="A1.Ex2.m3.5"/>
                                        <XMWrap>
                                          <XMApp xml:id="A1.Ex2.m3.5">
                                            <XMTok meaning="multirelation"/>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMDual>
                                                <XMRef idref="A1.Ex2.m3.5.1"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A1.Ex2.m3.5.1">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A1.Ex2.m3.5.1.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex2.m3.5.1.1">
                                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="A1.Ex2.m3.5.2"/>
                                                  <XMRef idref="A1.Ex2.m3.5.3"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A1.Ex2.m3.5.2">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A1.Ex2.m3.5.2.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex2.m3.5.2.1">
                                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A1.Ex2.m3.5.3">
                                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMApp>
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A1.Ex2.m3.5.4"/>
                                                    <XMRef idref="A1.Ex2.m3.2"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.Ex2.m3.5.4">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A1.Ex2.m3.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m3.1">t</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m3.2">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMApp>
                                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                    <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                  </XMApp>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="open-interval"/>
                                                      <XMRef idref="A1.Ex2.m3.5.5"/>
                                                      <XMRef idref="A1.Ex2.m3.4"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A1.Ex2.m3.5.5">
                                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A1.Ex2.m3.3"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m3.3">s</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m3.4">s</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMApp>
                                                    <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="PERIOD">.</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMath>
                                  </Math>
                                  <MathBranch>
                                    <td align="right"><Math mode="inline" tex="\displaystyle\log\rho_{t+h}(x(t+h))=\log\rho(x(t+h),t+h)" text="logarithm@(rho _ (t + h)) * x * (t + h) = logarithm@(rho) * open-interval@(x * (t + h), t + h)" xml:id="A1.Ex2.m1">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMDual>
                                                <XMRef idref="A1.Ex2.m1.1"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A1.Ex2.m1.1">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A1.Ex2.m1.1.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex2.m1.1.1">
                                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="A1.Ex2.m1.2"/>
                                                  <XMRef idref="A1.Ex2.m1.3"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A1.Ex2.m1.2">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A1.Ex2.m1.2.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex2.m1.2.1">
                                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A1.Ex2.m1.3">
                                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                    <td align="left"><Math mode="inline" tex="\displaystyle=\log\rho(x(t),t)-\int_{t}^{t+h}\nabla\cdot\mathbf{f}(x(s),s)ds." text="absent = logarithm@(rho) * open-interval@(x * t, t) - ((integral _ t) ^ (t + h))@((nabla cdot f) * open-interval@(x * s, s) * differential-d@(s))" xml:id="A1.Ex2.m2">
                                        <XMath>
                                          <XMDual>
                                            <XMRef idref="A1.Ex2.m2.5"/>
                                            <XMWrap>
                                              <XMApp xml:id="A1.Ex2.m2.5">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok meaning="absent"/>
                                                <XMApp>
                                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMApp>
                                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A1.Ex2.m2.5.1"/>
                                                        <XMRef idref="A1.Ex2.m2.2"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex2.m2.5.1">
                                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMDual>
                                                            <XMRef idref="A1.Ex2.m2.1"/>
                                                            <XMWrap>
                                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m2.1">t</XMTok>
                                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                            </XMWrap>
                                                          </XMDual>
                                                        </XMApp>
                                                        <XMTok role="PUNCT">,</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m2.2">t</XMTok>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMApp>
                                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                      </XMApp>
                                                      <XMApp>
                                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMApp>
                                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                        <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                      </XMApp>
                                                      <XMDual>
                                                        <XMApp>
                                                          <XMTok meaning="open-interval"/>
                                                          <XMRef idref="A1.Ex2.m2.5.2"/>
                                                          <XMRef idref="A1.Ex2.m2.4"/>
                                                        </XMApp>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMApp xml:id="A1.Ex2.m2.5.2">
                                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                            <XMDual>
                                                              <XMRef idref="A1.Ex2.m2.3"/>
                                                              <XMWrap>
                                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m2.3">s</XMTok>
                                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                          <XMTok role="PUNCT">,</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex2.m2.4">s</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                      <XMApp>
                                                        <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="PERIOD">.</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMath>
                                      </Math></td>
                                  </MathBranch>
                                </MathFork>
                              </equation>
                            </equationgroup>
                            <p>Inserting back to (<ref labelref="LABEL:eq:entropy-rhot+h"/>), we have</p>
                            <equation xml:id="A1.Ex3">
                              <Math class="ltx_math_unparsed" mode="display" tex="\mathbb{E}_{x\sim\rho_{t+h}}\log\rho_{t+h}(x)=\mathbb{E}_{x(t)\sim\rho_{t}}%&#10;\log\rho_{t}(x(t))-\mathbb{E}_{x(t)\sim\rho_{t}}\int_{t}^{t+h}\nabla\cdot%&#10;\mathbf{f}(x(s),s)ds)." xml:id="A1.Ex3.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex3.m1.3">x</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex3.m1.1"/>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex3.m1.1">t</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex3.m1.4">t</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex3.m1.2"/>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex3.m1.2">t</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex3.m1.5">s</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex3.m1.6">s</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  <XMTok role="PERIOD">.</XMTok>
                                </XMath>
                              </Math>
                            </equation>
                            <p>The first term is determined by <Math mode="inline" tex="\rho_{t}=p_{k}" text="rho _ t = p _ k" xml:id="A1.SS1.p4.m14">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>,
and thus is a constant <Math mode="inline" tex="c_{2}" text="c _ 2" xml:id="A1.SS1.p4.m15">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> independent from <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="A1.SS1.p4.m16">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.SS1.p4.m16.1"/>
                                        <XMRef idref="A1.SS1.p4.m16.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m16.1">x</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS1.p4.m16.2">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> on <Math mode="inline" tex="t\in[kh,(k+1)h]" text="t element-of closed-interval@(k * h, (k + 1) * h)" xml:id="A1.SS1.p4.m17">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="closed-interval"/>
                                        <XMRef idref="A1.SS1.p4.m17.1"/>
                                        <XMRef idref="A1.SS1.p4.m17.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                                        <XMApp xml:id="A1.SS1.p4.m17.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.SS1.p4.m17.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMDual>
                                            <XMRef idref="A1.SS1.p4.m17.2.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.SS1.p4.m17.2.1">
                                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>.
Together with (<ref labelref="LABEL:eq:KL-pf-2"/>), we have shown that</p>
                            <equation xml:id="A1.Ex4">
                              <Math class="ltx_math_unparsed" mode="display" tex="\text{r.h.s. of \eqref{eq:KL-pf-1}}=c_{2}-\mathbb{E}_{x(t)\sim\rho_{t}}\int_{t%&#10;}^{t+h}\nabla\cdot\mathbf{f}(x(s),s)ds)-c_{1}+\mathbb{E}_{x(t)\sim\rho_{t}}V(x%&#10;(t+h))," xml:id="A1.Ex4.m1">
                                <XMath>
                                  <XMText>r.h.s. of (<ref labelref="LABEL:eq:KL-pf-1"/>)</XMText>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex4.m1.1"/>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex4.m1.1">t</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex4.m1.3">s</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex4.m1.4">s</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                  <XMApp role="POSTSUBSCRIPT" scriptpos="1">
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                  <XMApp role="POSTSUBSCRIPT" scriptpos="1">
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex4.m1.2"/>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex4.m1.2">t</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                </XMath>
                              </Math>
                            </equation>
                            <p>which proves (<ref labelref="LABEL:eq:FT-layer-wise"/>).</p>
                          </para>
                          <para xml:id="A1.SS1.p5">
                            <p>Derivation of (<ref labelref="LABEL:eq:ddtlogrho(x(t),t)"/>):
by chain rule,</p>
                            <equationgroup class="ltx_eqn_align" xml:id="A3.EGx2">
                              <equation xml:id="A1.Ex5">
                                <MathFork>
                                  <Math tex="\displaystyle{\frac{d}{dt}}\log\rho(x(t),t)=\frac{\nabla\rho(x(t),t)\cdot\dot{%&#10;x}(t)+\partial_{t}\rho(x(t),t)}{\rho(x(t),t)}" text="(d / (d * t)) * logarithm@(rho) * open-interval@(x * t, t) = (((nabla@(rho) * open-interval@(x * t, t)) cdot dot@(x)) * t + (partial-differential _ t)@(rho * open-interval@(x * t, t))) / (rho * open-interval@(x * t, t))" xml:id="A1.Ex5.m3">
                                    <XMath>
                                      <XMApp>
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A1.Ex5.m3.13"/>
                                              <XMRef idref="A1.Ex5.m3.12"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A1.Ex5.m3.13">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A1.Ex5.m3.11"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.11">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.12">t</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                          <XMApp>
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMApp>
                                                    <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  </XMApp>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="open-interval"/>
                                                      <XMRef idref="A1.Ex5.m3.6"/>
                                                      <XMRef idref="A1.Ex5.m3.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A1.Ex5.m3.6">
                                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A1.Ex5.m3.1"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.1">t</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.2">t</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMDual>
                                                <XMRef idref="A1.Ex5.m3.3"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.3">t</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A1.Ex5.m3.7"/>
                                                    <XMRef idref="A1.Ex5.m3.5"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.Ex5.m3.7">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A1.Ex5.m3.4"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.4">t</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.5">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="A1.Ex5.m3.10"/>
                                                <XMRef idref="A1.Ex5.m3.9"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A1.Ex5.m3.10">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A1.Ex5.m3.8"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.8">t</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m3.9">t</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMath>
                                  </Math>
                                  <MathBranch>
                                    <td align="right"><Math mode="inline" tex="\displaystyle{\frac{d}{dt}}\log\rho(x(t),t)" text="(d / (d * t)) * logarithm@(rho) * open-interval@(x * t, t)" xml:id="A1.Ex5.m1">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="A1.Ex5.m1.3"/>
                                                <XMRef idref="A1.Ex5.m1.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A1.Ex5.m1.3">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A1.Ex5.m1.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m1.1">t</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m1.2">t</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                    <td align="left"><Math mode="inline" tex="\displaystyle=\frac{\nabla\rho(x(t),t)\cdot\dot{x}(t)+\partial_{t}\rho(x(t),t)%&#10;}{\rho(x(t),t)}" text="absent = (((nabla@(rho) * open-interval@(x * t, t)) cdot dot@(x)) * t + (partial-differential _ t)@(rho * open-interval@(x * t, t))) / (rho * open-interval@(x * t, t))" xml:id="A1.Ex5.m2">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok meaning="absent"/>
                                            <XMApp>
                                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                              <XMApp>
                                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMApp>
                                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                    <XMApp>
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMApp>
                                                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                        <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                      </XMApp>
                                                      <XMDual>
                                                        <XMApp>
                                                          <XMTok meaning="open-interval"/>
                                                          <XMRef idref="A1.Ex5.m2.6"/>
                                                          <XMRef idref="A1.Ex5.m2.2"/>
                                                        </XMApp>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMApp xml:id="A1.Ex5.m2.6">
                                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                            <XMDual>
                                                              <XMRef idref="A1.Ex5.m2.1"/>
                                                              <XMWrap>
                                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.1">t</XMTok>
                                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                          <XMTok role="PUNCT">,</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.2">t</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMDual>
                                                    <XMRef idref="A1.Ex5.m2.3"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.3">t</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A1.Ex5.m2.7"/>
                                                        <XMRef idref="A1.Ex5.m2.5"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex5.m2.7">
                                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMDual>
                                                            <XMRef idref="A1.Ex5.m2.4"/>
                                                            <XMWrap>
                                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.4">t</XMTok>
                                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                            </XMWrap>
                                                          </XMDual>
                                                        </XMApp>
                                                        <XMTok role="PUNCT">,</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.5">t</XMTok>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A1.Ex5.m2.10"/>
                                                    <XMRef idref="A1.Ex5.m2.9"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.Ex5.m2.10">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A1.Ex5.m2.8"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.8">t</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex5.m2.9">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                  </MathBranch>
                                </MathFork>
                              </equation>
                              <equation xml:id="A1.Ex6">
                                <MathFork>
                                  <Math tex="\displaystyle=\left.\frac{\nabla\rho\cdot{\bf f}-\nabla\cdot(\rho{\bf f})}{%&#10;\rho}\right|_{(x(t),t)}\quad\text{(by \eqref{eq:ode-Xt} and \eqref{eq:%&#10;Liouville})}" text="absent = list@(evaluated-at@((nabla@(rho cdot f) - nabla cdot (rho * f)) / rho, open-interval@(x * t, t)), [(by () and ())])" xml:id="A1.Ex6.m2">
                                    <XMath>
                                      <XMApp>
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok meaning="absent"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A1.Ex6.m2.8"/>
                                            <XMRef idref="A1.Ex6.m2.7"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMDual xml:id="A1.Ex6.m2.8">
                                              <XMApp>
                                                <XMTok meaning="evaluated-at"/>
                                                <XMRef idref="A1.Ex6.m2.5"/>
                                                <XMRef idref="A1.Ex6.m2.6"/>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMWrap>
                                                  <XMApp xml:id="A1.Ex6.m2.5">
                                                    <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                    <XMApp>
                                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                      <XMApp>
                                                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                        <XMApp>
                                                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                          <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                          <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                        </XMApp>
                                                      </XMApp>
                                                      <XMApp>
                                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A1.Ex6.m2.1"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMApp xml:id="A1.Ex6.m2.1">
                                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                              <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                            </XMApp>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="true">|</XMTok>
                                                </XMWrap>
                                                <XMDual xml:id="A1.Ex6.m2.6">
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A1.Ex6.m2.4"/>
                                                    <XMRef idref="A1.Ex6.m2.3"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.Ex6.m2.4">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A1.Ex6.m2.2"/>
                                                        <XMWrap>
                                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex6.m2.2">t</XMTok>
                                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex6.m2.3">t</XMTok>
                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMDual>
                                            <XMHint name="quad" role="PUNCT" width="10pt"/>
                                            <XMText xml:id="A1.Ex6.m2.7">(by (<ref labelref="LABEL:eq:ode-Xt"/>) and (<ref labelref="LABEL:eq:Liouville"/>))</XMText>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMath>
                                  </Math>
                                  <MathBranch>
                                    <td/>
                                    <td align="left"><Math mode="inline" tex="\displaystyle=\left.\frac{\nabla\rho\cdot{\bf f}-\nabla\cdot(\rho{\bf f})}{%&#10;\rho}\right|_{(x(t),t)}\quad\text{(by \eqref{eq:ode-Xt} and \eqref{eq:%&#10;Liouville})}" text="absent = list@(evaluated-at@((nabla@(rho cdot f) - nabla cdot (rho * f)) / rho, open-interval@(x * t, t)), [(by () and ())])" xml:id="A1.Ex6.m1">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok meaning="absent"/>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="list"/>
                                                <XMRef idref="A1.Ex6.m1.8"/>
                                                <XMRef idref="A1.Ex6.m1.7"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMDual xml:id="A1.Ex6.m1.8">
                                                  <XMApp>
                                                    <XMTok meaning="evaluated-at"/>
                                                    <XMRef idref="A1.Ex6.m1.5"/>
                                                    <XMRef idref="A1.Ex6.m1.6"/>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMWrap>
                                                      <XMApp xml:id="A1.Ex6.m1.5">
                                                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                        <XMApp>
                                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                          <XMApp>
                                                            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                            <XMApp>
                                                              <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                              <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                            </XMApp>
                                                          </XMApp>
                                                          <XMApp>
                                                            <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                            <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                            <XMDual>
                                                              <XMRef idref="A1.Ex6.m1.1"/>
                                                              <XMWrap>
                                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                                <XMApp xml:id="A1.Ex6.m1.1">
                                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                                </XMApp>
                                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                        </XMApp>
                                                        <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="true">|</XMTok>
                                                    </XMWrap>
                                                    <XMDual xml:id="A1.Ex6.m1.6">
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A1.Ex6.m1.4"/>
                                                        <XMRef idref="A1.Ex6.m1.3"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex6.m1.4">
                                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                          <XMDual>
                                                            <XMRef idref="A1.Ex6.m1.2"/>
                                                            <XMWrap>
                                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex6.m1.2">t</XMTok>
                                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                            </XMWrap>
                                                          </XMDual>
                                                        </XMApp>
                                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex6.m1.3">t</XMTok>
                                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMDual>
                                                <XMHint name="quad" role="PUNCT" width="10pt"/>
                                                <XMText xml:id="A1.Ex6.m1.7">(by (<ref labelref="LABEL:eq:ode-Xt"/>) and (<ref labelref="LABEL:eq:Liouville"/>))</XMText>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                  </MathBranch>
                                </MathFork>
                              </equation>
                              <equation xml:id="A1.Ex7">
                                <MathFork>
                                  <Math tex="\displaystyle=-\nabla\cdot{\bf f}(x(t),t)." text="absent = - (nabla cdot f) * open-interval@(x * t, t)" xml:id="A1.Ex7.m2">
                                    <XMath>
                                      <XMDual>
                                        <XMRef idref="A1.Ex7.m2.3"/>
                                        <XMWrap>
                                          <XMApp xml:id="A1.Ex7.m2.3">
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok meaning="absent"/>
                                            <XMApp>
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                  <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A1.Ex7.m2.3.1"/>
                                                    <XMRef idref="A1.Ex7.m2.2"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A1.Ex7.m2.3.1">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A1.Ex7.m2.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex7.m2.1">t</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex7.m2.2">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="PERIOD">.</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMath>
                                  </Math>
                                  <MathBranch>
                                    <td/>
                                    <td align="left"><Math mode="inline" tex="\displaystyle=-\nabla\cdot{\bf f}(x(t),t)." text="absent = - (nabla cdot f) * open-interval@(x * t, t)" xml:id="A1.Ex7.m1">
                                        <XMath>
                                          <XMDual>
                                            <XMRef idref="A1.Ex7.m1.3"/>
                                            <XMWrap>
                                              <XMApp xml:id="A1.Ex7.m1.3">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok meaning="absent"/>
                                                <XMApp>
                                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMApp>
                                                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                      <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A1.Ex7.m1.3.1"/>
                                                        <XMRef idref="A1.Ex7.m1.2"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A1.Ex7.m1.3.1">
                                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMDual>
                                                            <XMRef idref="A1.Ex7.m1.1"/>
                                                            <XMWrap>
                                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex7.m1.1">t</XMTok>
                                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                            </XMWrap>
                                                          </XMDual>
                                                        </XMApp>
                                                        <XMTok role="PUNCT">,</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex7.m1.2">t</XMTok>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="PERIOD">.</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMath>
                                      </Math></td>
                                  </MathBranch>
                                </MathFork>
                              </equation>
                            </equationgroup>
                            <p>∎</p>
                          </para>
                        </proof>
                      </subsection>
                    </appendix>
                    <appendix inlist="toc" labels="LABEL:app:detail-algo" xml:id="A2">
                      <tags>
                        <tag>Appendix B</tag>
                        <tag role="autoref">Appendix B</tag>
                        <tag role="refnum">B</tag>
                        <tag role="typerefnum">Appendix B</tag>
                      </tags>
                      <title><tag close=" ">Appendix B</tag>Technical details of Section <ref labelref="LABEL:sec:algo"/></title>
                      <toctitle><tag close=" ">B</tag>Technical details of Section <ref labelref="LABEL:sec:algo"/></toctitle>
                      <para xml:id="A2.p1">
                        <p>To train the proposed JKO-iFlow model by Algorithm <ref labelref="LABEL:block_training"/>, one needs to specify a sequence of <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="A2.p1.m1">
                            <XMath>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                            </XMath>
                          </Math>, where the <Math mode="inline" tex="k" text="k" xml:id="A2.p1.m2">
                            <XMath>
                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                            </XMath>
                          </Math>-th JKO block integrates from <Math mode="inline" tex="t_{k-1}" text="t _ (k - 1)" xml:id="A2.p1.m3">
                            <XMath>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMath>
                          </Math> to <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="A2.p1.m4">
                            <XMath>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                            </XMath>
                          </Math>, starting from <Math mode="inline" tex="t_{0}=0" text="t _ 0 = 0" xml:id="A2.p1.m5">
                            <XMath>
                              <XMApp>
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                                <XMTok meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                            </XMath>
                          </Math>. Denote by <Math mode="inline" tex="h_{k}:=t_{k+1}-t_{k}" text="h _ k assign t _ (k + 1) - t _ k" xml:id="A2.p1.m6">
                            <XMath>
                              <XMApp>
                                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMath>
                          </Math> the step-size for <Math mode="inline" tex="k" text="k" xml:id="A2.p1.m7">
                            <XMath>
                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                            </XMath>
                          </Math>-th step.</p>
                      </para>
                      <subsection inlist="toc" labels="LABEL:append:tk" xml:id="A2.SS1">
                        <tags>
                          <tag>B.1</tag>
                          <tag role="autoref">subsection B.1</tag>
                          <tag role="refnum">B.1</tag>
                          <tag role="typerefnum">§B.1</tag>
                        </tags>
                        <title><tag close=" ">B.1</tag>Initial choice of <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="A2.SS1.m1">
                            <XMath>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                              </XMApp>
                            </XMath>
                          </Math> in Algorithm <ref labelref="LABEL:block_training"/></title>
                        <para xml:id="A2.SS1.p1">
                          <p>We first initialize the choice by the following scheme</p>
                          <equation labels="LABEL:eq:def-hk-init" xml:id="A2.E19">
                            <tags>
                              <tag>(19)</tag>
                              <tag role="autoref">Equation 19</tag>
                              <tag role="refnum">19</tag>
                            </tags>
                            <Math mode="display" tex="h_{k}=\min\{\rho^{k}h_{0},h_{\rm max}\},\quad k=0,1,\cdots" text="formulae@(h _ k = minimum@(rho ^ k * h _ 0, h _ max), k = list@(0, 1, cdots))" xml:id="A2.E19.m1">
                              <XMath>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="formulae"/>
                                    <XMRef idref="A2.E19.m1.5"/>
                                    <XMRef idref="A2.E19.m1.6"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A2.E19.m1.5">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMRef idref="A2.E19.m1.1"/>
                                          <XMRef idref="A2.E19.m1.5.1"/>
                                          <XMRef idref="A2.E19.m1.5.2"/>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid" xml:id="A2.E19.m1.1">min</XMTok>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                                            <XMApp xml:id="A2.E19.m1.5.1">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A2.E19.m1.5.2">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                              <XMTok fontsize="70%" role="UNKNOWN">max</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                          </XMWrap>
                                        </XMApp>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                                    <XMApp xml:id="A2.E19.m1.6">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A2.E19.m1.2"/>
                                          <XMRef idref="A2.E19.m1.3"/>
                                          <XMRef idref="A2.E19.m1.4"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok meaning="0" role="NUMBER" xml:id="A2.E19.m1.2">0</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok meaning="1" role="NUMBER" xml:id="A2.E19.m1.3">1</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok name="cdots" role="ID" xml:id="A2.E19.m1.4">⋯</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMath>
                            </Math>
                          </equation>
                          <p>where the base stepsize <Math mode="inline" tex="h_{0}" text="h _ 0" xml:id="A2.SS1.p1.m1">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>,
the multiplying factor <Math mode="inline" tex="\rho\geq 1" text="rho &gt;= 1" xml:id="A2.SS1.p1.m2">
                              <XMath>
                                <XMApp>
                                  <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>,
and the maximum stepsize <Math mode="inline" tex="h_{\rm max}\geq h_{0}" text="h _ max &gt;= h _ 0" xml:id="A2.SS1.p1.m3">
                              <XMath>
                                <XMApp>
                                  <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok fontsize="70%" role="UNKNOWN">max</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math>
are three hyper-parameters to be specified by the user.
When <Math mode="inline" tex="\rho=1" text="rho = 1" xml:id="A2.SS1.p1.m4">
                              <XMath>
                                <XMApp>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>, the sequence of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A2.SS1.p1.m5">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> in (<ref labelref="LABEL:eq:def-hk-init"/>) corresponds to constant stepsize <Math mode="inline" tex="h_{k}\equiv h_{0}" text="h _ k equivalent-to h _ 0" xml:id="A2.SS1.p1.m6">
                              <XMath>
                                <XMApp>
                                  <XMTok meaning="equivalent-to" name="equiv" role="RELOP">≡</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math>.</p>
                        </para>
                        <para xml:id="A2.SS1.p2">
                          <p>Applying Algorithm <ref labelref="LABEL:block_training"/> with the initial choice of <Math mode="inline" tex="t_{k}" text="t _ k" xml:id="A2.SS1.p2.m1">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> gives <Math mode="inline" tex="L" text="L" xml:id="A2.SS1.p2.m2">
                              <XMath>
                                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                              </XMath>
                            </Math> trained residual blocks of the neural ODE model, where <Math mode="inline" tex="L" text="L" xml:id="A2.SS1.p2.m3">
                              <XMath>
                                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                              </XMath>
                            </Math> is to be determined by the stopping criterion in Section <ref labelref="LABEL:sec:layer_wise"/>.
The model is further improved by the two additional techniques in Section <ref labelref="LABEL:sec:traj_prob_comp"/>, which will adaptively specify the stepsize <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A2.SS1.p2.m4">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> and we explain in detail below.</p>
                        </para>
                      </subsection>
                      <subsection inlist="toc" labels="LABEL:app:finite-diff" xml:id="A2.SS2">
                        <tags>
                          <tag>B.2</tag>
                          <tag role="autoref">subsection B.2</tag>
                          <tag role="refnum">B.2</tag>
                          <tag role="typerefnum">§B.2</tag>
                        </tags>
                        <title color="#000000"><tag close=" ">B.2</tag><!--  %**** JKO˙arxiv˙v4.tex Line 1200 **** -->Hutchinson trace
via finite difference</title>
                        <para xml:id="A2.SS2.p1">
                          <p><text color="#000000">We propose a finite-difference estimator of </text><Math mode="inline" tex="\nabla\cdot{\bf f}(x,t)=\text{Tr}(J_{{\bf f}}(x))" text="(nabla cdot f) * open-interval@(x, t) = [Tr] * J _ f * x" xml:id="A2.SS2.p1.m1">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                      <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A2.SS2.p1.m1.1"/>
                                        <XMRef idref="A2.SS2.p1.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m1.1">x</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m1.2">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>Tr</XMText>
                                    <XMDual>
                                      <XMRef idref="A2.SS2.p1.m1.4"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A2.SS2.p1.m1.4">
                                          <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A2.SS2.p1.m1.3"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m1.3">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000">, where </text><Math class="ltx_math_unparsed" mode="inline" tex="J_{{\bf f}}(x))" xml:id="A2.SS2.p1.m2">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok color="#000000" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok color="#000000" font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m2.1">x</XMTok>
                                  <XMTok color="#000000" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                                <XMTok color="#000000" role="CLOSE" stretchy="false">)</XMTok>
                              </XMath>
                            </Math><text color="#000000"> is the Jacobian of </text><Math mode="inline" tex="\bf f" text="f" xml:id="A2.SS2.p1.m3">
                              <XMath>
                                <XMTok color="#000000" font="bold" role="UNKNOWN">f</XMTok>
                              </XMath>
                            </Math><text color="#000000"> at </text><Math mode="inline" tex="x" text="x" xml:id="A2.SS2.p1.m4">
                              <XMath>
                                <XMTok color="#000000" font="italic" role="UNKNOWN">x</XMTok>
                              </XMath>
                            </Math><text color="#000000">. This is based on the Hutchinson trace estimator </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="Hutchinson1989ASE" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                              </bibref><text color="#000000">]</text></cite><text color="#000000">, which states that </text><Math mode="inline" tex="\text{Tr}(J_{{\bf f}}(x))=\mathbb{E}_{p(\epsilon)}\left[\epsilon^{T}J_{{\bf f}%&#10;}(x)\epsilon\right]" text="[Tr] * J _ f * x = E _ (p * epsilon) * delimited-[]@(epsilon ^ T * J _ f * x * epsilon)" xml:id="A2.SS2.p1.m5">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>Tr</XMText>
                                    <XMDual>
                                      <XMRef idref="A2.SS2.p1.m5.4"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A2.SS2.p1.m5.4">
                                          <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A2.SS2.p1.m5.2"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m5.2">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                      <XMApp>
                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                        <XMDual>
                                          <XMRef idref="A2.SS2.p1.m5.1"/>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="epsilon" role="UNKNOWN" xml:id="A2.SS2.p1.m5.1">ϵ</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-[]"/>
                                        <XMRef idref="A2.SS2.p1.m5.5"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">[</XMTok>
                                        <XMApp xml:id="A2.SS2.p1.m5.5">
                                          <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A2.SS2.p1.m5.3"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m5.3">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000">. Here, </text><Math mode="inline" tex="p(\epsilon)" text="p * epsilon" xml:id="A2.SS2.p1.m6">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMDual>
                                    <XMRef idref="A2.SS2.p1.m6.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A2.SS2.p1.m6.1">ϵ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> is a distribution in </text><Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="A2.SS2.p1.m7">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> satisfying </text><Math mode="inline" tex="\mathbb{E}[\epsilon]=0" text="E * delimited-[]@(epsilon) = 0" xml:id="A2.SS2.p1.m8">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="delimited-[]"/>
                                        <XMRef idref="A2.SS2.p1.m8.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                                        <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A2.SS2.p1.m8.1">ϵ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> and </text><Math mode="inline" tex="\text{Cov}(\epsilon)=I" text="[Cov] * epsilon = I" xml:id="A2.SS2.p1.m9">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMText>Cov</XMText>
                                    <XMDual>
                                      <XMRef idref="A2.SS2.p1.m9.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A2.SS2.p1.m9.1">ϵ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> (e.g., a standard Gaussian). Existing CNF works estimate the expectation by sampling </text><Math mode="inline" tex="\epsilon\sim p(\epsilon)" text="epsilon similar-to p * epsilon" xml:id="A2.SS2.p1.m10">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                    <XMDual>
                                      <XMRef idref="A2.SS2.p1.m10.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" name="epsilon" role="UNKNOWN" xml:id="A2.SS2.p1.m10.1">ϵ</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> and computing the vector-Jacobian product </text><Math mode="inline" tex="J_{{\bf f}}(x)\epsilon" text="J _ f * x * epsilon" xml:id="A2.SS2.p1.m11">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                    <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A2.SS2.p1.m11.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m11.1">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> using reverse-mode automatic differentiation. The product </text><Math mode="inline" tex="J_{{\bf f}}(x)\epsilon" text="J _ f * x * epsilon" xml:id="A2.SS2.p1.m12">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                    <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A2.SS2.p1.m12.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p1.m12.1">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> can be computed for approximately the same cost as evaluating </text><Math mode="inline" tex="\bf f" text="f" xml:id="A2.SS2.p1.m13">
                              <XMath>
                                <XMTok color="#000000" font="bold" role="UNKNOWN">f</XMTok>
                              </XMath>
                            </Math><text color="#000000"> </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="FFJORD" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                              </bibref><text color="#000000">]</text></cite><text color="#000000">.</text></p>
                        </para>
                        <para xml:id="A2.SS2.p2">
                          <p><text color="#000000">Now, given a fixed </text><Math mode="inline" tex="\epsilon" text="epsilon" xml:id="A2.SS2.p2.m1">
                              <XMath>
                                <XMTok color="#000000" font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                              </XMath>
                            </Math><text color="#000000">,
we have </text><Math mode="inline" tex="J_{{\bf f}}(x)\epsilon=\lim_{\sigma\rightarrow 0}\frac{{\bf f}(x+\sigma%&#10;\epsilon)-{\bf f}(x)}{\sigma}" text="J _ f * x * epsilon = (limit _ (sigma rightarrow 0))@((f * (x + sigma * epsilon) - f * x) / sigma)" xml:id="A2.SS2.p2.m2">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                      <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A2.SS2.p2.m2.3"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p2.m2.3">x</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok meaning="limit" role="LIMITOP" scriptpos="post">lim</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" name="rightarrow" role="ARROW">→</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                          <XMDual>
                                            <XMRef idref="A2.SS2.p2.m2.2"/>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A2.SS2.p2.m2.2">
                                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                <XMApp>
                                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                          <XMDual>
                                            <XMRef idref="A2.SS2.p2.m2.1"/>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.SS2.p2.m2.1">x</XMTok>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" name="sigma" role="UNKNOWN">σ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000">,
which is the directional derivative of </text><Math mode="inline" tex="{\bf f}" text="f" xml:id="A2.SS2.p2.m3">
                              <XMath>
                                <XMTok color="#000000" font="bold" role="UNKNOWN">f</XMTok>
                              </XMath>
                            </Math><text color="#000000"> along the direction </text><Math mode="inline" tex="\epsilon" text="epsilon" xml:id="A2.SS2.p2.m4">
                              <XMath>
                                <XMTok color="#000000" font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                              </XMath>
                            </Math><text color="#000000">. Thus, given a fixed small </text><Math mode="inline" tex="\sigma&gt;0" text="sigma &gt; 0" xml:id="A2.SS2.p2.m5">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000">, we propose the following finite-difference estimator of </text><Math mode="inline" tex="\nabla\cdot{\bf f}(x,t)" text="(nabla cdot f) * open-interval@(x, t)" xml:id="A2.SS2.p2.m6">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A2.SS2.p2.m6.1"/>
                                      <XMRef idref="A2.SS2.p2.m6.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p2.m6.1">x</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p2.m6.2">t</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000">:</text></p>
                          <equation labels="LABEL:eq:finite_diff" xml:id="A2.E20">
                            <tags>
                              <tag>(20)</tag>
                              <tag role="autoref">Equation 20</tag>
                              <tag role="refnum">20</tag>
                            </tags>
                            <Math mode="display" tex="\nabla\cdot{\bf f}(x,t)\approx\mathbb{E}_{p(\epsilon)}\left[\epsilon^{T}\frac{%&#10;{\bf f}(x+\sigma\epsilon)-{\bf f}(x)}{\sigma}\right]." text="(nabla cdot f) * open-interval@(x, t) approximately-equals E _ (p * epsilon) * delimited-[]@(epsilon ^ T * ((f * (x + sigma * epsilon) - f * x) / sigma))" xml:id="A2.E20.m1">
                              <XMath>
                                <XMDual>
                                  <XMRef idref="A2.E20.m1.6"/>
                                  <XMWrap>
                                    <XMApp color="#000000" xml:id="A2.E20.m1.6">
                                      <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                                      <XMApp>
                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                          <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                          <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A2.E20.m1.4"/>
                                            <XMRef idref="A2.E20.m1.5"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A2.E20.m1.4">x</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A2.E20.m1.5">t</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                          <XMApp>
                                            <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                            <XMDual>
                                              <XMRef idref="A2.E20.m1.1"/>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" fontsize="70%" name="epsilon" role="UNKNOWN" xml:id="A2.E20.m1.1">ϵ</XMTok>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="delimited-[]"/>
                                            <XMRef idref="A2.E20.m1.6.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="true">[</XMTok>
                                            <XMApp xml:id="A2.E20.m1.6.1">
                                              <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                <XMApp>
                                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                  <XMApp>
                                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A2.E20.m1.3"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A2.E20.m1.3">
                                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMApp>
                                                            <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                            <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                                            <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                                          </XMApp>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A2.E20.m1.2"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.E20.m1.2">x</XMTok>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="true">]</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok color="#000000" role="PERIOD">.</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMath>
                            </Math>
                          </equation>
                          <p><text color="#000000">The finite-difference approximation of </text><Math mode="inline" tex="J_{{\bf f}}(x)\epsilon" text="J _ f * x * epsilon" xml:id="A2.SS2.p2.m7">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">J</XMTok>
                                    <XMTok font="bold" fontsize="70%" role="UNKNOWN">f</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A2.SS2.p2.m7.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS2.p2.m7.1">x</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> requires only one additional function evaluation of </text><Math mode="inline" tex="{\bf f}" text="f" xml:id="A2.SS2.p2.m8">
                              <XMath>
                                <XMTok color="#000000" font="bold" role="UNKNOWN">f</XMTok>
                              </XMath>
                            </Math><text color="#000000"> at </text><Math mode="inline" tex="x+\sigma\epsilon" text="x + sigma * epsilon" xml:id="A2.SS2.p2.m9">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMApp>
                                    <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                    <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> and avoids the computation of automatic differentiation.
We empirically found that training with (</text><ref color="#000000" labelref="LABEL:eq:finite_diff"/><text color="#000000">) on high-dimensional examples (e.g., </text><Math mode="inline" tex="d&gt;100" text="d &gt; 100" xml:id="A2.SS2.p2.m10">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMTok meaning="100" role="NUMBER">100</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> as in image examples) can be approximately 1.5</text><Math mode="inline" tex="\sim" text="similar-to" xml:id="A2.SS2.p2.m11">
                              <XMath>
                                <XMTok color="#000000" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              </XMath>
                            </Math><text color="#000000">2 times faster than existing CNF approaches relying on reverse-mode automatic differentiation.
In all experiments, we let </text><Math mode="inline" tex="\sigma=\sigma_{0}/\sqrt{d}" text="sigma = sigma _ 0 / square-root@(d)" xml:id="A2.SS2.p2.m12">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                  <XMApp>
                                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="square-root"/>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000"> with </text><Math mode="inline" tex="\sigma_{0}=0.02" text="sigma _ 0 = 0.02" xml:id="A2.SS2.p2.m13">
                              <XMath>
                                <XMApp color="#000000">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                  <XMTok meaning="0.02" role="NUMBER">0.02</XMTok>
                                </XMApp>
                              </XMath>
                            </Math><text color="#000000">.
</text></p>
                        </para>
                      </subsection>
                      <subsection inlist="toc" labels="LABEL:app:traj_comp_detail" xml:id="A2.SS3">
                        <tags>
                          <tag>B.3</tag>
                          <tag role="autoref">subsection B.3</tag>
                          <tag role="refnum">B.3</tag>
                          <tag role="typerefnum">§B.3</tag>
                        </tags>
                        <title><tag close=" ">B.3</tag>
Trajectory improvement illustrated in vector space</title>
                        <para xml:id="A2.SS3.p1">
                          <p>Section <ref labelref="LABEL:sec:traj_prob_comp"/><!--  %**** JKO˙arxiv˙v4.tex Line 1225 **** --> introduces two techniques to improve the computation of a gradient descent trajectory represented by discrete points. For illustrative purposes, we introduce the two techniques when the gradient system is in a vector space equipped with Euclidean metric.
The JKO-iFlow training applies the same technique in the gradient system
equipped with the Wasserstein-2 metric.</p>
                        </para>
                        <para xml:id="A2.SS3.p2">
                          <p>Let the space be <Math mode="inline" tex="\mathbb{R}^{d}" text="R ^ d" xml:id="A2.SS3.p2.m1">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>, and <Math mode="inline" tex="F:\mathbb{R}^{d}\to\mathbb{R}" text="F colon R ^ d to R" xml:id="A2.SS3.p2.m2">
                              <XMath>
                                <XMApp>
                                  <XMTok name="colon" role="METARELOP">:</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">F</XMTok>
                                  <XMApp>
                                    <XMTok name="to" role="ARROW">→</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                    </XMApp>
                                    <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math> be a differential landscape. Given a sequence of positive stepsize <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A2.SS3.p2.m3">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>,
one can compute a sequence of representative points <Math mode="inline" tex="x_{k}" text="x _ k" xml:id="A2.SS3.p2.m4">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> which discretizes the gradient descent trajectory of minimizing <Math mode="inline" tex="F" text="F" xml:id="A2.SS3.p2.m5">
                              <XMath>
                                <XMTok font="italic" role="UNKNOWN">F</XMTok>
                              </XMath>
                            </Math> (towards a local minimum <Math mode="inline" tex="x^{*}" text="x ^ *" xml:id="A2.SS3.p2.m6">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>). Specifically, we have</p>
                          <equation labels="LABEL:eq:vspace_opt" xml:id="A2.E21">
                            <tags>
                              <tag>(21)</tag>
                              <tag role="autoref">Equation 21</tag>
                              <tag role="refnum">21</tag>
                            </tags>
                            <Math mode="display" tex="x_{k+1}=\arg\min_{x}F(x)+\frac{1}{2h_{k}}\|x-x_{k}\|_{2}^{2}," text="x _ (k + 1) = argument@((minimum _ x)@(F)) * x + (1 / (2 * h _ k)) * ((norm@(x - x _ k)) _ 2) ^ 2" xml:id="A2.E21.m1">
                              <XMath>
                                <XMDual>
                                  <XMRef idref="A2.E21.m1.2"/>
                                  <XMWrap>
                                    <XMApp xml:id="A2.E21.m1.2">
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok meaning="argument" role="OPFUNCTION">arg</XMTok>
                                            <XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                              </XMApp>
                                              <XMTok font="italic" role="UNKNOWN">F</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A2.E21.m1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A2.E21.m1.1">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="norm"/>
                                                  <XMRef idref="A2.E21.m1.2.1"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok name="||" role="OPEN">‖</XMTok>
                                                  <XMApp xml:id="A2.E21.m1.2.1">
                                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok name="||" role="CLOSE">‖</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMath>
                            </Math>
                          </equation>
                          <p>starting from some fixed <Math mode="inline" tex="x_{0}" text="x _ 0" xml:id="A2.SS3.p2.m7">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMath>
                            </Math>.</p>
                        </para>
                        <subsubsection inlist="toc" labels="LABEL:sec:reparam_details" xml:id="A2.SS3.SSS1">
                          <tags>
                            <tag>B.3.1</tag>
                            <tag role="autoref">subsubsection B.3.1</tag>
                            <tag role="refnum">B.3.1</tag>
                            <tag role="typerefnum">§B.3.1</tag>
                          </tags>
                          <title><tag close=" ">B.3.1</tag>Trajectory reparameterization</title>
                          <para xml:id="A2.SS3.SSS1.p1">
                            <p>Starting from an initial sequence of step-size <Math mode="inline" tex="\{h_{k}\}_{k=1}^{L}" text="((set@(h _ k)) _ (k = 1)) ^ L" xml:id="A2.SS3.SSS1.p1.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="A2.SS3.SSS1.p1.m1.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                                          <XMApp xml:id="A2.SS3.SSS1.p1.m1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> as in Section <ref labelref="LABEL:append:tk"/>,
the reparameterization technique implements an iterative scheme to update the sequence of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A2.SS3.SSS1.p1.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> adaptively.
We call the <Math mode="inline" tex="j" text="j" xml:id="A2.SS3.SSS1.p1.m3">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                </XMath>
                              </Math>-th iteration ‘Iter-<Math mode="inline" tex="j" text="j" xml:id="A2.SS3.SSS1.p1.m4">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                </XMath>
                              </Math>’, and denote the sequence by <Math mode="inline" tex="\{h_{k}^{(j)}\}_{k=1}^{L}" text="((set@((h _ k) ^ j)) _ (k = 1)) ^ L" xml:id="A2.SS3.SSS1.p1.m5">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="A2.SS3.SSS1.p1.m5.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                                          <XMApp xml:id="A2.SS3.SSS1.p1.m5.2">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMRef idref="A2.SS3.SSS1.p1.m5.1"/>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.SS3.SSS1.p1.m5.1">j</XMTok>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.
The corresponding solution points <Math mode="inline" tex="x_{k}" text="x _ k" xml:id="A2.SS3.SSS1.p1.m6">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> by solving (<ref labelref="LABEL:eq:vspace_opt"/>) with <Math mode="inline" tex="h_{k}^{(j)}" text="(h _ k) ^ j" xml:id="A2.SS3.SSS1.p1.m7">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A2.SS3.SSS1.p1.m7.1"/>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.SS3.SSS1.p1.m7.1">j</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> are denoted as <Math mode="inline" tex="x_{k}^{(j)}" text="(x _ k) ^ j" xml:id="A2.SS3.SSS1.p1.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A2.SS3.SSS1.p1.m8.1"/>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.SS3.SSS1.p1.m8.1">j</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>.
In addition to the constant <Math mode="inline" tex="h_{\max}" text="h _ maximum" xml:id="A2.SS3.SSS1.p1.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>, we need another algorithmic parameter <Math mode="inline" tex="\eta\in(0,1)" text="eta element-of open-interval@(0, 1)" xml:id="A2.SS3.SSS1.p1.m10">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A2.SS3.SSS1.p1.m10.1"/>
                                        <XMRef idref="A2.SS3.SSS1.p1.m10.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok meaning="0" role="NUMBER" xml:id="A2.SS3.SSS1.p1.m10.1">0</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok meaning="1" role="NUMBER" xml:id="A2.SS3.SSS1.p1.m10.2">1</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>, and we set <Math mode="inline" tex="\eta=0.3" text="eta = 0.3" xml:id="A2.SS3.SSS1.p1.m11">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                                    <XMTok meaning="0.3" role="NUMBER">0.3</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> for the vector-space example in computation.</p>
                          </para>
                          <para xml:id="A2.SS3.SSS1.p2">
                            <p>We always have <Math mode="inline" tex="x_{0}^{(j)}=x_{0}" text="(x _ 0) ^ j = x _ 0" xml:id="A2.SS3.SSS1.p2.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMRef idref="A2.SS3.SSS1.p2.m1.1"/>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.SS3.SSS1.p2.m1.1">j</XMTok>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> for all ‘Iter-<Math mode="inline" tex="j" text="j" xml:id="A2.SS3.SSS1.p2.m2">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                </XMath>
                              </Math>’.
In the <Math mode="inline" tex="j" text="j" xml:id="A2.SS3.SSS1.p2.m3">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                </XMath>
                              </Math>-th iteration of the parametrization, we compute the following</p>
                            <enumerate xml:id="A2.I1">
                              <item xml:id="A2.I1.i1">
                                <tags>
                                  <tag>1.</tag>
                                  <tag role="autoref">item 1</tag>
                                  <tag role="refnum">1</tag>
                                  <tag role="typerefnum">item 1</tag>
                                </tags>
                                <para xml:id="A2.I1.i1.p1">
                                  <p>Compute the <text font="italic">arclength</text> as</p>
                                  <equation labels="LABEL:eq:def-Skj-arclength" xml:id="A2.E22">
                                    <tags>
                                      <tag>(22)</tag>
                                      <tag role="autoref">Equation 22</tag>
                                      <tag role="refnum">22</tag>
                                    </tags>
                                    <Math mode="display" tex="S_{k}^{(j)}:=\|x_{k-1}^{(j)}-x_{k}^{(j)}\|_{2},\quad k=1,\cdots,L." text="formulae@((S _ k) ^ j assign (norm@((x _ (k - 1)) ^ j - (x _ k) ^ j)) _ 2, k = list@(1, cdots, L))" xml:id="A2.E22.m1">
                                      <XMath>
                                        <XMDual>
                                          <XMRef idref="A2.E22.m1.7"/>
                                          <XMWrap>
                                            <XMDual xml:id="A2.E22.m1.7">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A2.E22.m1.7.1"/>
                                                <XMRef idref="A2.E22.m1.7.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A2.E22.m1.7.1">
                                                  <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="A2.E22.m1.1"/>
                                                      <XMWrap>
                                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.E22.m1.1">j</XMTok>
                                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="norm"/>
                                                        <XMRef idref="A2.E22.m1.7.1.1"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok name="||" role="OPEN">‖</XMTok>
                                                        <XMApp xml:id="A2.E22.m1.7.1.1">
                                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                          <XMApp>
                                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                              <XMApp>
                                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                              </XMApp>
                                                            </XMApp>
                                                            <XMDual>
                                                              <XMRef idref="A2.E22.m1.2"/>
                                                              <XMWrap>
                                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.E22.m1.2">j</XMTok>
                                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                          <XMApp>
                                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                            </XMApp>
                                                            <XMDual>
                                                              <XMRef idref="A2.E22.m1.3"/>
                                                              <XMWrap>
                                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.E22.m1.3">j</XMTok>
                                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                        </XMApp>
                                                        <XMTok name="||" role="CLOSE">‖</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                                                <XMApp xml:id="A2.E22.m1.7.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="list"/>
                                                      <XMRef idref="A2.E22.m1.4"/>
                                                      <XMRef idref="A2.E22.m1.5"/>
                                                      <XMRef idref="A2.E22.m1.6"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok meaning="1" role="NUMBER" xml:id="A2.E22.m1.4">1</XMTok>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMTok name="cdots" role="ID" xml:id="A2.E22.m1.5">⋯</XMTok>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A2.E22.m1.6">L</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                            <XMTok role="PERIOD">.</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMath>
                                    </Math>
                                  </equation>
                                </para>
                              </item>
                              <item xml:id="A2.I1.i2">
                                <tags>
                                  <tag>2.</tag>
                                  <tag role="autoref">item 2</tag>
                                  <tag role="refnum">2</tag>
                                  <tag role="typerefnum">item 2</tag>
                                </tags>
                                <para xml:id="A2.I1.i2.p1">
                                  <p>Compute the average arclength</p>
                                  <equation xml:id="A2.Ex8">
                                    <Math mode="display" tex="\bar{S}:=\sum_{k=1}^{L}S_{k}^{(j)}/L." text="bar@(S) assign ((sum _ (k = 1)) ^ L)@((S _ k) ^ j / L)" xml:id="A2.Ex8.m1">
                                      <XMath>
                                        <XMDual>
                                          <XMRef idref="A2.Ex8.m1.2"/>
                                          <XMWrap>
                                            <XMApp xml:id="A2.Ex8.m1.2">
                                              <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                              <XMApp>
                                                <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="A2.Ex8.m1.1"/>
                                                      <XMWrap>
                                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.Ex8.m1.1">j</XMTok>
                                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PERIOD">.</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMath>
                                    </Math>
                                  </equation>
                                </para>
                              </item>
                              <item xml:id="A2.I1.i3">
                                <tags>
                                  <tag>3.</tag>
                                  <tag role="autoref">item 3</tag>
                                  <tag role="refnum">3</tag>
                                  <tag role="typerefnum">item 3</tag>
                                </tags>
                                <para xml:id="A2.I1.i3.p1">
                                  <p>Update the stepsize for <Math mode="inline" tex="k=1,\ldots,L" text="k = list@(1, ldots, L)" xml:id="A2.I1.i3.p1.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="list"/>
                                              <XMRef idref="A2.I1.i3.p1.m1.1"/>
                                              <XMRef idref="A2.I1.i3.p1.m1.2"/>
                                              <XMRef idref="A2.I1.i3.p1.m1.3"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok meaning="1" role="NUMBER" xml:id="A2.I1.i3.p1.m1.1">1</XMTok>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok name="ldots" role="ID" xml:id="A2.I1.i3.p1.m1.2">…</XMTok>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A2.I1.i3.p1.m1.3">L</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMath>
                                    </Math> as</p>
                                  <equation xml:id="A2.Ex9">
                                    <Math mode="display" tex="h_{k}^{(j+1)}:={\min\{h_{k}^{(j)}+\eta(\bar{S}h_{k}^{(j)}/S_{k}^{(j)}-h_{k}^{(%&#10;j)}),h_{\max}\}}" text="(h _ k) ^ (j + 1) assign minimum@((h _ k) ^ j + eta * ((bar@(S) * (h _ k) ^ j) / (S _ k) ^ j - (h _ k) ^ j), h _ maximum)" xml:id="A2.Ex9.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMRef idref="A2.Ex9.m1.1"/>
                                              <XMWrap>
                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A2.Ex9.m1.1">
                                                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMRef idref="A2.Ex9.m1.6"/>
                                              <XMRef idref="A2.Ex9.m1.7"/>
                                              <XMRef idref="A2.Ex9.m1.8"/>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid" xml:id="A2.Ex9.m1.6">min</XMTok>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">{</XMTok>
                                                <XMApp xml:id="A2.Ex9.m1.7">
                                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                    </XMApp>
                                                    <XMDual>
                                                      <XMRef idref="A2.Ex9.m1.2"/>
                                                      <XMWrap>
                                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.Ex9.m1.2">j</XMTok>
                                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A2.Ex9.m1.7.1"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A2.Ex9.m1.7.1">
                                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                          <XMApp>
                                                            <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                            <XMApp>
                                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                              <XMApp>
                                                                <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                                              </XMApp>
                                                              <XMApp>
                                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                                <XMApp>
                                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                                </XMApp>
                                                                <XMDual>
                                                                  <XMRef idref="A2.Ex9.m1.3"/>
                                                                  <XMWrap>
                                                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.Ex9.m1.3">j</XMTok>
                                                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                                  </XMWrap>
                                                                </XMDual>
                                                              </XMApp>
                                                            </XMApp>
                                                            <XMApp>
                                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                              <XMApp>
                                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                              </XMApp>
                                                              <XMDual>
                                                                <XMRef idref="A2.Ex9.m1.4"/>
                                                                <XMWrap>
                                                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.Ex9.m1.4">j</XMTok>
                                                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                                </XMWrap>
                                                              </XMDual>
                                                            </XMApp>
                                                          </XMApp>
                                                          <XMApp>
                                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                            </XMApp>
                                                            <XMDual>
                                                              <XMRef idref="A2.Ex9.m1.5"/>
                                                              <XMWrap>
                                                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.Ex9.m1.5">j</XMTok>
                                                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                              </XMWrap>
                                                            </XMDual>
                                                          </XMApp>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A2.Ex9.m1.8">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                  <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                              </XMWrap>
                                            </XMApp>
                                          </XMDual>
                                        </XMApp>
                                      </XMath>
                                    </Math>
                                  </equation>
                                </para>
                              </item>
                              <item xml:id="A2.I1.i4">
                                <tags>
                                  <tag>4.</tag>
                                  <tag role="autoref">item 4</tag>
                                  <tag role="refnum">4</tag>
                                  <tag role="typerefnum">item 4</tag>
                                </tags>
                                <para xml:id="A2.I1.i4.p1">
                                  <p>Solve (<ref labelref="LABEL:eq:vspace_opt"/>) using <Math mode="inline" tex="h_{k}^{(j+1)}" text="(h _ k) ^ (j + 1)" xml:id="A2.I1.i4.p1.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A2.I1.i4.p1.m1.1"/>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A2.I1.i4.p1.m1.1">
                                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMath>
                                    </Math> to obtain <Math mode="inline" tex="x_{k}^{(j+1)}" text="(x _ k) ^ (j + 1)" xml:id="A2.I1.i4.p1.m2">
                                      <XMath>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A2.I1.i4.p1.m2.1"/>
                                            <XMWrap>
                                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A2.I1.i4.p1.m2.1">
                                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMath>
                                    </Math>.</p>
                                </para>
                              </item>
                            </enumerate>
                          </para>
                          <para xml:id="A2.SS3.SSS1.p3">
                            <p>We terminate the iteration when the arclength <Math mode="inline" tex="\{S_{k}^{(j)}\}" text="set@((S _ k) ^ j)" xml:id="A2.SS3.SSS1.p3.m1">
                                <XMath>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="set"/>
                                      <XMRef idref="A2.SS3.SSS1.p3.m1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                                      <XMApp xml:id="A2.SS3.SSS1.p3.m1.2">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="A2.SS3.SSS1.p3.m1.1"/>
                                          <XMWrap>
                                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A2.SS3.SSS1.p3.m1.1">j</XMTok>
                                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math> are approximately equal.
An illustration is given as Iter-12 in the upper panel of Figure <ref labelref="LABEL:fig_reparam_muller"/>.
After the reparameterization iterations, we solve an additional <Math mode="inline" tex="x_{L+1}" text="x _ (L + 1)" xml:id="A2.SS3.SSS1.p3.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> by minimizing <Math mode="inline" tex="F(x)" text="F * x" xml:id="A2.SS3.SSS1.p3.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">F</XMTok>
                                    <XMDual>
                                      <XMRef idref="A2.SS3.SSS1.p3.m3.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS3.SSS1.p3.m3.1">x</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> starting from <Math mode="inline" tex="x_{L}" text="x _ L" xml:id="A2.SS3.SSS1.p3.m4">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math><!--  %**** JKO˙arxiv˙v4.tex Line 1275 **** -->.
This corresponds to optimizing the “free-block” in Algorithm <ref labelref="LABEL:block_training"/>.</p>
                          </para>
                        </subsubsection>
                        <subsubsection inlist="toc" xml:id="A2.SS3.SSS2">
                          <tags>
                            <tag>B.3.2</tag>
                            <tag role="autoref">subsubsection B.3.2</tag>
                            <tag role="refnum">B.3.2</tag>
                            <tag role="typerefnum">§B.3.2</tag>
                          </tags>
                          <title><tag close=" ">B.3.2</tag> Progressive refinement</title>
                          <para xml:id="A2.SS3.SSS2.p1">
                            <p>The scheme can be computed using a positive integer refinement factor. For simplicity, we use factor 2 throughout this work.</p>
                          </para>
                          <para xml:id="A2.SS3.SSS2.p2">
                            <p>Given a sequence of <Math mode="inline" tex="\{h_{k}\}_{k=1}^{L}" text="((set@(h _ k)) _ (k = 1)) ^ L" xml:id="A2.SS3.SSS2.p2.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="A2.SS3.SSS2.p2.m1.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                                          <XMApp xml:id="A2.SS3.SSS2.p2.m1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> and the representative points <Math mode="inline" tex="\{x_{k}\}_{k=1}^{L}" text="((set@(x _ k)) _ (k = 1)) ^ L" xml:id="A2.SS3.SSS2.p2.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="A2.SS3.SSS2.p2.m2.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                                          <XMApp xml:id="A2.SS3.SSS2.p2.m2.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>,
the refinement scheme computes a refined trajectory having <Math mode="inline" tex="k=1,\cdots,2L" text="k = list@(1, cdots, 2 * L)" xml:id="A2.SS3.SSS2.p2.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="A2.SS3.SSS2.p2.m3.1"/>
                                        <XMRef idref="A2.SS3.SSS2.p2.m3.2"/>
                                        <XMRef idref="A2.SS3.SSS2.p2.m3.3"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok meaning="1" role="NUMBER" xml:id="A2.SS3.SSS2.p2.m3.1">1</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok name="cdots" role="ID" xml:id="A2.SS3.SSS2.p2.m3.2">⋯</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A2.SS3.SSS2.p2.m3.3">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>:</p>
                          </para>
                          <para xml:id="A2.SS3.SSS2.p3">
                            <enumerate xml:id="A2.I2">
                              <item xml:id="A2.I2.i1">
                                <tags>
                                  <tag>1.</tag>
                                  <tag role="autoref">item 1</tag>
                                  <tag role="refnum">1</tag>
                                  <tag role="typerefnum">item 1</tag>
                                </tags>
                                <para xml:id="A2.I2.i1.p1">
                                  <p>Compute the refined stepsizes as</p>
                                  <equation xml:id="A2.Ex10">
                                    <Math mode="display" tex="\tilde{h}_{2k-1}=\tilde{h}_{2k}=h_{k}/2,\quad k=1,\dots,L" text="formulae@((tilde@(h)) _ (2 * k - 1) = (tilde@(h)) _ (2 * k) = h _ k / 2, k = list@(1, dots, L))" xml:id="A2.Ex10.m1">
                                      <XMath>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A2.Ex10.m1.4"/>
                                            <XMRef idref="A2.Ex10.m1.5"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A2.Ex10.m1.4">
                                              <XMTok meaning="multirelation"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                  </XMApp>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                                            <XMApp xml:id="A2.Ex10.m1.5">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="A2.Ex10.m1.1"/>
                                                  <XMRef idref="A2.Ex10.m1.2"/>
                                                  <XMRef idref="A2.Ex10.m1.3"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok meaning="1" role="NUMBER" xml:id="A2.Ex10.m1.1">1</XMTok>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMTok name="dots" role="ID" xml:id="A2.Ex10.m1.2">…</XMTok>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A2.Ex10.m1.3">L</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMath>
                                    </Math>
                                  </equation>
                                </para>
                              </item>
                              <item xml:id="A2.I2.i2">
                                <tags>
                                  <tag>2.</tag>
                                  <tag role="autoref">item 2</tag>
                                  <tag role="refnum">2</tag>
                                  <tag role="typerefnum">item 2</tag>
                                </tags>
                                <para xml:id="A2.I2.i2.p1">
                                  <p>Compute the representative points <Math mode="inline" tex="\tilde{x}_{k}" text="(tilde@(x)) _ k" xml:id="A2.I2.i2.p1.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMApp>
                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math> by solving (<ref labelref="LABEL:eq:vspace_opt"/>) using <Math mode="inline" tex="\tilde{h}_{k}" text="(tilde@(h)) _ k" xml:id="A2.I2.i2.p1.m2">
                                      <XMath>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMApp>
                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math>,
possibly warm-starting by <Math mode="inline" tex="\tilde{x}_{2k}={x}_{k}" text="(tilde@(x)) _ (2 * k) = x _ k" xml:id="A2.I2.i2.p1.m3">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMath>
                                    </Math>
and <Math mode="inline" tex="\tilde{x}_{2k-1}=({x}_{k}+x_{k-1})/2" text="(tilde@(x)) _ (2 * k - 1) = (x _ k + x _ (k - 1)) / 2" xml:id="A2.I2.i2.p1.m4">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="divide" role="MULOP">/</XMTok>
                                            <XMDual>
                                              <XMRef idref="A2.I2.i2.p1.m4.1"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A2.I2.i2.p1.m4.1">
                                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMath>
                                    </Math>.</p>
                                </para>
                              </item>
                            </enumerate>
                          </para>
                          <para xml:id="A2.SS3.SSS2.p4">
                            <p>We then apply the trajectory reparameterization iterations as in Section <ref labelref="LABEL:sec:reparam_details"/><!--  %**** JKO˙arxiv˙v4.tex Line 1300 **** --> to the refined trajectory till convergence,
and the free-block ending point is also recomputed.
An illustration is given as r-Iter-10 in the upper panel of Figure <ref labelref="LABEL:fig_reparam_muller"/>.</p>
                          </para>
                        </subsubsection>
                      </subsection>
                      <subsection inlist="toc" xml:id="A2.SS4">
                        <tags>
                          <tag>B.4</tag>
                          <tag role="autoref">subsection B.4</tag>
                          <tag role="refnum">B.4</tag>
                          <tag role="typerefnum">§B.4</tag>
                        </tags>
                        <title><tag close=" ">B.4</tag>Trajectory improvement in probability space</title>
                        <para xml:id="A2.SS4.p1">
                          <p>We apply the two techniques to solve the JKO step (<ref labelref="LABEL:eq:loss-block-k"/>),
which is the counterpart of (<ref labelref="LABEL:eq:vspace_opt"/>)
as a gradient descent scheme with proximal steps.
The representative points <Math mode="inline" tex="x_{k}" text="x _ k" xml:id="A2.SS4.p1.m1">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> are replaced with transported distributions <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="A2.SS4.p1.m2">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> which form a sequence of points in <Math mode="inline" tex="\mathcal{P}" text="P" xml:id="A2.SS4.p1.m3">
                              <XMath>
                                <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                              </XMath>
                            </Math>,
and the optimization is over the parametrization of <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="A2.SS4.p1.m4">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> induced by the neural network flow mapping consisting of the first <Math mode="inline" tex="k" text="k" xml:id="A2.SS4.p1.m5">
                              <XMath>
                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                              </XMath>
                            </Math> residual blocks.</p>
                        </para>
                        <para xml:id="A2.SS4.p2">
                          <p>It remains to define the arclength in (<ref labelref="LABEL:eq:def-Skj-arclength"/>) to implement the two techniques.
Because we equip <Math mode="inline" tex="\mathcal{P}" text="P" xml:id="A2.SS4.p2.m1">
                              <XMath>
                                <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                              </XMath>
                            </Math> with the Wasserstein-2 metric, we compute (omitting the iteration index <Math mode="inline" tex="j" text="j" xml:id="A2.SS4.p2.m2">
                              <XMath>
                                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                              </XMath>
                            </Math> in the notation)</p>
                          <equation labels="LABEL:eq:def-Sk-jko" xml:id="A2.E23">
                            <tags>
                              <tag>(23)</tag>
                              <tag role="autoref">Equation 23</tag>
                              <tag role="refnum">23</tag>
                            </tags>
                            <Math mode="display" tex="S_{k}=W_{2}(p_{k-1},p_{k})=(\mathbb{E}_{x\sim p_{k-1}}\|x-T_{k}(x)\|^{2})^{1/2}," text="S _ k = W _ 2 * open-interval@(p _ (k - 1), p _ k) = (E _ (x similar-to p _ (k - 1)) * (norm@(x - T _ k * x)) ^ 2) ^ (1 / 2)" xml:id="A2.E23.m1">
                              <XMath>
                                <XMDual>
                                  <XMRef idref="A2.E23.m1.2"/>
                                  <XMWrap>
                                    <XMApp xml:id="A2.E23.m1.2">
                                      <XMTok meaning="multirelation"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">S</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A2.E23.m1.2.1"/>
                                            <XMRef idref="A2.E23.m1.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A2.E23.m1.2.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A2.E23.m1.2.2">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMRef idref="A2.E23.m1.2.3"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A2.E23.m1.2.3">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="norm"/>
                                                    <XMRef idref="A2.E23.m1.2.3.1"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok name="||" role="OPEN">‖</XMTok>
                                                    <XMApp xml:id="A2.E23.m1.2.3.1">
                                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMApp>
                                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMApp>
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                        </XMApp>
                                                        <XMDual>
                                                          <XMRef idref="A2.E23.m1.1"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A2.E23.m1.1">x</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMTok name="||" role="CLOSE">‖</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="divide" role="MULOP">/</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMath>
                            </Math>
                          </equation>
                          <p>where the transport mapping <Math mode="inline" tex="T_{k}(x)=x+\int_{t_{k-1}}^{t_{k}}f_{\theta_{k}}(x(s),s)ds" text="T _ k * x = x + ((integral _ t _ (k - 1)) ^ (t _ k))@(f _ theta _ k * open-interval@(x * s, s) * differential-d@(s))" xml:id="A2.SS4.p2.m3">
                              <XMath>
                                <XMApp>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A2.SS4.p2.m3.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS4.p2.m3.1">x</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok mathstyle="text" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A2.SS4.p2.m3.4"/>
                                            <XMRef idref="A2.SS4.p2.m3.3"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A2.SS4.p2.m3.4">
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              <XMDual>
                                                <XMRef idref="A2.SS4.p2.m3.2"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS4.p2.m3.2">s</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A2.SS4.p2.m3.3">s</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math> and can be computed from the <Math mode="inline" tex="k" text="k" xml:id="A2.SS4.p2.m4">
                              <XMath>
                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                              </XMath>
                            </Math>-th block. In practice, the expectation <Math mode="inline" tex="\mathbb{E}_{x\sim p_{k-1}}" text="E _ (x similar-to p _ (k - 1))" xml:id="A2.SS4.p2.m5">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMath>
                            </Math> in (<ref labelref="LABEL:eq:def-Sk-jko"/>) is computed by a finite-sample average on the training set.</p>
                        </para>
                        <para xml:id="A2.SS4.p3">
                          <p>At last, the optimal warm-start of <Math mode="inline" tex="p_{k}" text="p _ k" xml:id="A2.SS4.p3.m1">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> in the refinement is implemented by inheriting the parameters <Math mode="inline" tex="\theta_{k}" text="theta _ k" xml:id="A2.SS4.p3.m2">
                              <XMath>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                </XMApp>
                              </XMath>
                            </Math> of the trained blocks.</p>
                        </para>
                        <figure inlist="lof" labels="LABEL:fig_reparam_muller" placement="!b" xml:id="A2.F1">
                          <tags>
                            <tag><text fontsize="90%">Figure A.1</text></tag>
                            <tag role="autoref">Figure A.1</tag>
                            <tag role="refnum">A.1</tag>
                            <tag role="typerefnum">Figure A.1</tag>
                          </tags>
                          <graphics candidates="vector_space_reparam_and_refine.png" class="ltx_centering" graphic="vector_space_reparam_and_refine.png" options="width=433.62pt,keepaspectratio=true" xml:id="A2.F1.g1"/>
                          <toccaption class="ltx_centering"><tag close=" ">A.1</tag>The upper panel shows the arc lengths and the mean and standard deviation of arc lengths over 12 reparameterization iterations, one refinement, and an additional 10 reparameterization iterations. The lower panel visualizes the trajectory consisting of 17 solution points at “r-Iter-10”, where the free point as the 17-th point computes the approximate minimum by <Math mode="inline" tex="x_{17}=x_{L+1}=[-1.911,0.105]" text="x _ 17 = x _ (L + 1) = closed-interval@(- 1.911, 0.105)" xml:id="A2.F1.m1">
                              <XMath>
                                <XMApp>
                                  <XMTok meaning="multirelation"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMTok fontsize="70%" meaning="17" role="NUMBER">17</XMTok>
                                  </XMApp>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="closed-interval"/>
                                      <XMRef idref="A2.F1.m1.2"/>
                                      <XMRef idref="A2.F1.m1.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                                      <XMApp xml:id="A2.F1.m1.2">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok meaning="1.911" role="NUMBER">1.911</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMTok meaning="0.105" role="NUMBER" xml:id="A2.F1.m1.1">0.105</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMath>
                            </Math>.</toccaption>
                          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure A.1</text></tag><text fontsize="90%">The upper panel shows the arc lengths and the mean and standard deviation of arc lengths over 12 reparameterization iterations, one refinement, and an additional 10 reparameterization iterations. The lower panel visualizes the trajectory consisting of 17 solution points at “r-Iter-10”, where the free point as the 17-th point computes the approximate minimum by <Math mode="inline" tex="x_{17}=x_{L+1}=[-1.911,0.105]" text="x _ 17 = x _ (L + 1) = closed-interval@(- 1.911, 0.105)" xml:id="A2.F1.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="multirelation"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMTok fontsize="70%" meaning="17" role="NUMBER">17</XMTok>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="closed-interval"/>
                                        <XMRef idref="A2.F1.m2.2"/>
                                        <XMRef idref="A2.F1.m2.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                                        <XMApp xml:id="A2.F1.m2.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok meaning="1.911" role="NUMBER">1.911</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok meaning="0.105" role="NUMBER" xml:id="A2.F1.m2.1">0.105</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>.</text></caption>
                        </figure>
                      </subsection>
                    </appendix>
                    <appendix inlist="toc" xml:id="A3">
                      <tags>
                        <tag>Appendix C</tag>
                        <tag role="autoref">Appendix C</tag>
                        <tag role="refnum">C</tag>
                        <tag role="typerefnum">Appendix C</tag>
                      </tags>
                      <title><tag close=" ">Appendix C</tag>Experimental details</title>
                      <toctitle><tag close=" ">C</tag>Experimental details</toctitle>
                      <subsection inlist="toc" labels="LABEL:sec:metrics" xml:id="A3.SS1">
                        <tags>
                          <tag>C.1</tag>
                          <tag role="autoref">subsection C.1</tag>
                          <tag role="refnum">C.1</tag>
                          <tag role="typerefnum">§C.1</tag>
                        </tags>
                        <title><tag close=" ">C.1</tag>Quantitative evaluation metrics</title>
                        <para xml:id="A3.SS1.p1">
                          <p>Besides visual comparison, we adopt two quantitative metrics to evaluate the performance of generative models,
the negative log-likelihood (NLL) metric <cite class="ltx_citemacro_cite"><bibref bibrefs="FFJORD" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                                <bibrefphrase>[</bibrefphrase>
                                <bibrefphrase>]</bibrefphrase>
                              </bibref></cite>
and the maximum mean discrepancy (MMD) <cite class="ltx_citemacro_citep">[<bibref bibrefs="Gretton2012AKT" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase>, </bibrefphrase>
                              </bibref>]</cite> metric.</p>
                        </para>
                        <subsubsection inlist="toc" labels="LABEL:sec:NLL" xml:id="A3.SS1.SSS1">
                          <tags>
                            <tag>C.1.1</tag>
                            <tag role="autoref">subsubsection C.1.1</tag>
                            <tag role="refnum">C.1.1</tag>
                            <tag role="typerefnum">§C.1.1</tag>
                          </tags>
                          <title><tag close=" ">C.1.1</tag>NLL metric</title>
                          <para xml:id="A3.SS1.SSS1.p1">
                            <p>Our computation of the NLL metric follows the standard procedure for neural ODE normalizing flow models <cite class="ltx_citemacro_cite"><bibref bibrefs="chen2018neural,FFJORD" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                                  <bibrefphrase>[</bibrefphrase>
                                  <bibrefphrase>]</bibrefphrase>
                                </bibref></cite>,
where the evolution of density <Math mode="inline" tex="\rho(x(t))" text="rho * x * t" xml:id="A3.SS1.SSS1.p1.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                    <XMDual>
                                      <XMRef idref="A3.SS1.SSS1.p1.m1.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.SS1.SSS1.p1.m1.2">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                          <XMDual>
                                            <XMRef idref="A3.SS1.SSS1.p1.m1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p1.m1.1">t</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> can be computed via integrating <Math mode="inline" tex="\nabla\cdot{\bf f}(x(t),t)" text="(nabla cdot f) * open-interval@(x * t, t)" xml:id="A3.SS1.SSS1.p1.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                      <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                      <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A3.SS1.SSS1.p1.m2.3"/>
                                        <XMRef idref="A3.SS1.SSS1.p1.m2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A3.SS1.SSS1.p1.m2.3">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                          <XMDual>
                                            <XMRef idref="A3.SS1.SSS1.p1.m2.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p1.m2.1">t</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p1.m2.2">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> over time due to the instantaneous change-of-variable formula (<ref labelref="LABEL:eq:ddtlogrho(x(t),t)"/>).</p>
                          </para>
                          <para xml:id="A3.SS1.SSS1.p2">
                            <p>Specifically, our model flows from <Math mode="inline" tex="t_{0}=0" text="t _ 0 = 0" xml:id="A3.SS1.SSS1.p2.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> to <Math mode="inline" tex="t_{L+1}=T" text="t _ (L + 1) = T" xml:id="A3.SS1.SSS1.p2.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>, where <Math mode="inline" tex="x(0)\sim p_{0}" text="x * 0 similar-to p _ 0" xml:id="A3.SS1.SSS1.p2.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="A3.SS1.SSS1.p2.m3.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok meaning="0" role="NUMBER" xml:id="A3.SS1.SSS1.p2.m3.1">0</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> the data distribution,
and we train the flow model to make <Math mode="inline" tex="x(T)" text="x * T" xml:id="A3.SS1.SSS1.p2.m4">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A3.SS1.SSS1.p2.m4.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p2.m4.1">T</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> follow a normal density <Math mode="inline" tex="q" text="q" xml:id="A3.SS1.SSS1.p2.m5">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                </XMath>
                              </Math>. The model density at data sample <Math mode="inline" tex="x" text="x" xml:id="A3.SS1.SSS1.p2.m6">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                </XMath>
                              </Math> is expressed as <Math mode="inline" tex="\rho(x,0)=(T_{\theta}^{-1})_{\#}q(x)" text="rho * open-interval@(x, 0) = ((T _ theta) ^ (- 1)) _ # * q * x" xml:id="A3.SS1.SSS1.p2.m7">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A3.SS1.SSS1.p2.m7.1"/>
                                          <XMRef idref="A3.SS1.SSS1.p2.m7.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p2.m7.1">x</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMTok meaning="0" role="NUMBER" xml:id="A3.SS1.SSS1.p2.m7.2">0</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMRef idref="A3.SS1.SSS1.p2.m7.4"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A3.SS1.SSS1.p2.m7.4">
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok fontsize="70%" role="UNKNOWN">#</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                      <XMDual>
                                        <XMRef idref="A3.SS1.SSS1.p2.m7.3"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p2.m7.3">x</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> where <Math mode="inline" tex="T_{\theta}^{-1}" text="(T _ theta) ^ (- 1)" xml:id="A3.SS1.SSS1.p2.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> is the inverse model flow mapping from <Math mode="inline" tex="x(T)" text="x * T" xml:id="A3.SS1.SSS1.p2.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A3.SS1.SSS1.p2.m9.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p2.m9.1">T</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> to <Math mode="inline" tex="x(0)" text="x * 0" xml:id="A3.SS1.SSS1.p2.m10">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                    <XMDual>
                                      <XMRef idref="A3.SS1.SSS1.p2.m10.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok meaning="0" role="NUMBER" xml:id="A3.SS1.SSS1.p2.m10.1">0</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>. Thus the model log-likelihood can be expressed as</p>
                            <equation xml:id="A3.Ex11">
                              <Math mode="display" tex="\log\rho(x(0),0)=\log q(x(T),T)+\int_{0}^{T}\nabla\cdot{\bf f}(x(s),s)ds." text="logarithm@(rho) * open-interval@(x * 0, 0) = logarithm@(q) * open-interval@(x * T, T) + ((integral _ 0) ^ T)@((nabla cdot f) * open-interval@(x * s, s) * differential-d@(s))" xml:id="A3.Ex11.m1">
                                <XMath>
                                  <XMDual>
                                    <XMRef idref="A3.Ex11.m1.7"/>
                                    <XMWrap>
                                      <XMApp xml:id="A3.Ex11.m1.7">
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A3.Ex11.m1.7.1"/>
                                              <XMRef idref="A3.Ex11.m1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex11.m1.7.1">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A3.Ex11.m1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok meaning="0" role="NUMBER" xml:id="A3.Ex11.m1.1">0</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok meaning="0" role="NUMBER" xml:id="A3.Ex11.m1.2">0</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="A3.Ex11.m1.7.2"/>
                                                <XMRef idref="A3.Ex11.m1.4"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A3.Ex11.m1.7.2">
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A3.Ex11.m1.3"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex11.m1.3">T</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex11.m1.4">T</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                              </XMApp>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="open-interval"/>
                                                  <XMRef idref="A3.Ex11.m1.7.3"/>
                                                  <XMRef idref="A3.Ex11.m1.6"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A3.Ex11.m1.7.3">
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                    <XMDual>
                                                      <XMRef idref="A3.Ex11.m1.5"/>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex11.m1.5">s</XMTok>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex11.m1.6">s</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                              <XMApp>
                                                <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PERIOD">.</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
                            </equation>
                            <p>In practice, our trained flow model has <Math mode="inline" tex="L" text="L" xml:id="A3.SS1.SSS1.p2.m11">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                </XMath>
                              </Math> blocks where each block <Math mode="inline" tex="f_{\theta_{k}}" text="f _ theta _ k" xml:id="A3.SS1.SSS1.p2.m12">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> represents <Math mode="inline" tex="{\bf f}(x,t)" text="f * open-interval@(x, t)" xml:id="A3.SS1.SSS1.p2.m13">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A3.SS1.SSS1.p2.m13.1"/>
                                        <XMRef idref="A3.SS1.SSS1.p2.m13.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p2.m13.1">x</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS1.p2.m13.2">t</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> on <Math mode="inline" tex="[t_{k-1},t_{k})" text="closed-open-interval@(t _ (k - 1), t _ k)" xml:id="A3.SS1.SSS1.p2.m14">
                                <XMath>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="closed-open-interval"/>
                                      <XMRef idref="A3.SS1.SSS1.p2.m14.1"/>
                                      <XMRef idref="A3.SS1.SSS1.p2.m14.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                                      <XMApp xml:id="A3.SS1.SSS1.p2.m14.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A3.SS1.SSS1.p2.m14.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
and is parametrized by <Math mode="inline" tex="\theta_{k}" text="theta _ k" xml:id="A3.SS1.SSS1.p2.m15">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.
The log-likelihood at test sample <Math mode="inline" tex="x" text="x" xml:id="A3.SS1.SSS1.p2.m16">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                </XMath>
                              </Math> is then computed by</p>
                            <equation labels="LABEL:eq:NLL_simplified" xml:id="A3.E24">
                              <tags>
                                <tag>(24)</tag>
                                <tag role="autoref">Equation 24</tag>
                                <tag role="refnum">24</tag>
                              </tags>
                              <Math mode="display" tex="{\rm LL}(x)=-\frac{1}{2}(\|x(t_{L+1})\|^{2}_{2}+d\log(2\pi))+\sum_{k=1}^{L+1}%&#10;\int_{t_{k-1}}^{t_{k}}\nabla\cdot f_{\theta_{k}}(x(s),s)ds," text="LL * x = (- (1 / 2) * (((norm@(x * t _ (L + 1))) ^ 2) _ 2 + d * logarithm@(2 * pi))) + ((sum _ (k = 1)) ^ (L + 1))@(((integral _ t _ (k - 1)) ^ (t _ k))@((nabla cdot f _ theta _ k) * open-interval@(x * s, s) * differential-d@(s)))" xml:id="A3.E24.m1">
                                <XMath>
                                  <XMDual>
                                    <XMRef idref="A3.E24.m1.5"/>
                                    <XMWrap>
                                      <XMApp xml:id="A3.E24.m1.5">
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok role="UNKNOWN">LL</XMTok>
                                          <XMDual>
                                            <XMRef idref="A3.E24.m1.1"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A3.E24.m1.1">x</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                          <XMApp>
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMRef idref="A3.E24.m1.5.1"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="A3.E24.m1.5.1">
                                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMApp>
                                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                        <XMDual>
                                                          <XMApp>
                                                            <XMTok meaning="norm"/>
                                                            <XMRef idref="A3.E24.m1.5.1.1"/>
                                                          </XMApp>
                                                          <XMWrap>
                                                            <XMTok name="||" role="OPEN">‖</XMTok>
                                                            <XMApp xml:id="A3.E24.m1.5.1.1">
                                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                              <XMDual>
                                                                <XMRef idref="A3.E24.m1.5.1.1.1"/>
                                                                <XMWrap>
                                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                                  <XMApp xml:id="A3.E24.m1.5.1.1.1">
                                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                                    <XMApp>
                                                                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                                    </XMApp>
                                                                  </XMApp>
                                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                                </XMWrap>
                                                              </XMDual>
                                                            </XMApp>
                                                            <XMTok name="||" role="CLOSE">‖</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                      </XMApp>
                                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                      <XMDual>
                                                        <XMApp>
                                                          <XMRef idref="A3.E24.m1.2"/>
                                                          <XMRef idref="A3.E24.m1.5.1.2"/>
                                                        </XMApp>
                                                        <XMApp>
                                                          <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A3.E24.m1.2">log</XMTok>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMApp xml:id="A3.E24.m1.5.1.2">
                                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                                            </XMApp>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMApp>
                                                      </XMDual>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                  <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A3.E24.m1.5.2"/>
                                                    <XMRef idref="A3.E24.m1.4"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A3.E24.m1.5.2">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A3.E24.m1.3"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.E24.m1.3">s</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.E24.m1.4">s</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                                <XMApp>
                                                  <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
                            </equation>
                            <p>where</p>
                            <equation xml:id="A3.Ex12">
                              <Math mode="display" tex="x(t_{k})=x(t_{k-1})+\int_{t_{k-1}}^{t_{k}}f_{\theta_{k}}(x(s),s)ds" text="x * t _ k = x * t _ (k - 1) + ((integral _ t _ (k - 1)) ^ (t _ k))@(f _ theta _ k * open-interval@(x * s, s) * differential-d@(s))" xml:id="A3.Ex12.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="A3.Ex12.m1.3"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A3.Ex12.m1.3">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        <XMDual>
                                          <XMRef idref="A3.Ex12.m1.4"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A3.Ex12.m1.4">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A3.Ex12.m1.5"/>
                                              <XMRef idref="A3.Ex12.m1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMApp xml:id="A3.Ex12.m1.5">
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A3.Ex12.m1.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex12.m1.1">s</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A3.Ex12.m1.2">s</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                          <XMApp>
                                            <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math>
                            </equation>
                            <p>starting from <Math mode="inline" tex="x(0)=x" text="x * 0 = x" xml:id="A3.SS1.SSS1.p2.m17">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                      <XMDual>
                                        <XMRef idref="A3.SS1.SSS1.p2.m17.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok meaning="0" role="NUMBER" xml:id="A3.SS1.SSS1.p2.m17.1">0</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.
Both the integration of <Math mode="inline" tex="f_{\theta_{k}}" text="f _ theta _ k" xml:id="A3.SS1.SSS1.p2.m18">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> and <Math mode="inline" tex="\nabla\cdot f_{\theta_{k}}" text="nabla cdot f _ theta _ k" xml:id="A3.SS1.SSS1.p2.m19">
                                <XMath>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">k</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math><!--  %**** JKO˙arxiv˙v4.tex Line 1375 **** --> are computed using the numerical scheme of neural ODE.
We report NLL in the natural unit of information (i.e., <Math mode="inline" tex="\log" text="logarithm" xml:id="A3.SS1.SSS1.p2.m20">
                                <XMath>
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                </XMath>
                              </Math> with base <Math mode="inline" tex="e" text="e" xml:id="A3.SS1.SSS1.p2.m21">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                </XMath>
                              </Math>, known as “nats”) in all our experiments.</p>
                          </para>
                        </subsubsection>
                        <subsubsection inlist="toc" labels="LABEL:sec:MMD_metrics" xml:id="A3.SS1.SSS2">
                          <tags>
                            <tag>C.1.2</tag>
                            <tag role="autoref">subsubsection C.1.2</tag>
                            <tag role="refnum">C.1.2</tag>
                            <tag role="typerefnum">§C.1.2</tag>
                          </tags>
                          <title><tag close=" ">C.1.2</tag>MMD metrics</title>
                          <para xml:id="A3.SS1.SSS2.p1">
                            <p>Note that the normalizing flow models use NLL (on training
set) as the training objective.
In contrast, the MMD metric is an impartial evaluation metric as it is not used to train JKO-iFlow or any competing methods.
Given two set of data samples <Math mode="inline" tex="\boldsymbol{X}:=\{x_{i}\}_{i=1}^{N}" text="X assign ((set@(x _ i)) _ (i = 1)) ^ N" xml:id="A3.SS1.SSS2.p1.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="set"/>
                                            <XMRef idref="A3.SS1.SSS2.p1.m1.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                                            <XMApp xml:id="A3.SS1.SSS2.p1.m1.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> and <Math mode="inline" tex="\boldsymbol{\tilde{X}}:=\{\tilde{x}_{j}\}_{j=1}^{M}" text="tilde@(X) assign ((set@((tilde@(x)) _ j)) _ (j = 1)) ^ M" xml:id="A3.SS1.SSS2.p1.m2">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                    <XMApp>
                                      <XMTok font="bold" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="set"/>
                                            <XMRef idref="A3.SS1.SSS2.p1.m2.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                                            <XMApp xml:id="A3.SS1.SSS2.p1.m2.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                              </XMApp>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> and a kernel function <Math mode="inline" tex="k(x,\tilde{x})" text="k * open-interval@(x, tilde@(x))" xml:id="A3.SS1.SSS2.p1.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A3.SS1.SSS2.p1.m3.1"/>
                                        <XMRef idref="A3.SS1.SSS2.p1.m3.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS2.p1.m3.1">x</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A3.SS1.SSS2.p1.m3.2">
                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math>, the (squared) kernel MMD <cite class="ltx_citemacro_citep">[<bibref bibrefs="Gretton2012AKT" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                  <bibrefphrase>, </bibrefphrase>
                                </bibref>]</cite> is defined as</p>
                            <equation labels="LABEL:MMD" xml:id="A3.E25">
                              <tags>
                                <tag>(25)</tag>
                                <tag role="autoref">Equation 25</tag>
                                <tag role="refnum">25</tag>
                              </tags>
                              <Math mode="display" tex="\text{MMD}(\boldsymbol{X},\boldsymbol{\tilde{X}}):=\frac{1}{N^{2}}\sum_{i=1}^{%&#10;N}\sum_{j=1}^{N}k(x_{i},x_{j})+\frac{1}{M^{2}}\sum_{i=1}^{M}\sum_{j=1}^{M}k(%&#10;\tilde{x}_{i},\tilde{x}_{j})-\frac{2}{NM}\sum_{i=1}^{N}\sum_{j=1}^{M}k(x_{i},%&#10;\tilde{x}_{j})," text="[MMD] * open-interval@(X, tilde@(X)) assign ((1 / N ^ 2) * ((sum _ (i = 1)) ^ N)@(((sum _ (j = 1)) ^ N)@(k * open-interval@(x _ i, x _ j))) + (1 / M ^ 2) * ((sum _ (i = 1)) ^ M)@(((sum _ (j = 1)) ^ M)@(k * open-interval@((tilde@(x)) _ i, (tilde@(x)) _ j)))) - (2 / (N * M)) * ((sum _ (i = 1)) ^ N)@(((sum _ (j = 1)) ^ M)@(k * open-interval@(x _ i, (tilde@(x)) _ j)))" xml:id="A3.E25.m1">
                                <XMath>
                                  <XMDual>
                                    <XMRef idref="A3.E25.m1.3"/>
                                    <XMWrap>
                                      <XMApp xml:id="A3.E25.m1.3">
                                        <XMTok meaning="assign" role="RELOP">:=</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMText>MMD</XMText>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="open-interval"/>
                                              <XMRef idref="A3.E25.m1.1"/>
                                              <XMRef idref="A3.E25.m1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="bold italic" role="UNKNOWN" xml:id="A3.E25.m1.1">X</XMTok>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A3.E25.m1.2">
                                                <XMTok font="bold" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                      <XMApp>
                                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A3.E25.m1.3.1"/>
                                                        <XMRef idref="A3.E25.m1.3.2"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A3.E25.m1.3.1">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                        </XMApp>
                                                        <XMTok role="PUNCT">,</XMTok>
                                                        <XMApp xml:id="A3.E25.m1.3.2">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                      <XMApp>
                                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                    <XMDual>
                                                      <XMApp>
                                                        <XMTok meaning="open-interval"/>
                                                        <XMRef idref="A3.E25.m1.3.3"/>
                                                        <XMRef idref="A3.E25.m1.3.4"/>
                                                      </XMApp>
                                                      <XMWrap>
                                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                        <XMApp xml:id="A3.E25.m1.3.3">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMApp>
                                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          </XMApp>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                        </XMApp>
                                                        <XMTok role="PUNCT">,</XMTok>
                                                        <XMApp xml:id="A3.E25.m1.3.4">
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMApp>
                                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                          </XMApp>
                                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                        </XMApp>
                                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                      </XMWrap>
                                                    </XMDual>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                                    <XMApp>
                                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="open-interval"/>
                                                      <XMRef idref="A3.E25.m1.3.5"/>
                                                      <XMRef idref="A3.E25.m1.3.6"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A3.E25.m1.3.5">
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="A3.E25.m1.3.6">
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                        <XMApp>
                                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        </XMApp>
                                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>
                            </equation>
                            <p>When a generative model is trained,
we generate <Math mode="inline" tex="M" text="M" xml:id="A3.SS1.SSS2.p1.m4">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                </XMath>
                              </Math> i.i.d. data samples by the model to construct the set <Math mode="inline" tex="\boldsymbol{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS1.SSS2.p1.m5">
                                <XMath>
                                  <XMApp>
                                    <XMTok font="bold" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>,
and we form the set <Math mode="inline" tex="\boldsymbol{X}" text="X" xml:id="A3.SS1.SSS2.p1.m6">
                                <XMath>
                                  <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                </XMath>
                              </Math> using <Math mode="inline" tex="N" text="N" xml:id="A3.SS1.SSS2.p1.m7">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMath>
                              </Math> true data samples (from the test set).
MMD metrics with other choices of kernels are possible <cite class="ltx_citemacro_cite"><bibref bibrefs="gretton2012optimal,sutherland2017generative,schrab2023MMD" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                                  <bibrefphrase>[</bibrefphrase>
                                  <bibrefphrase>]</bibrefphrase>
                                </bibref></cite>.
In all experiments here, we use the Gaussian kernel
<Math mode="inline" tex="k(x,\tilde{x})=\exp\{-\|x-\tilde{x}\|^{2}/2h^{2}\}" text="k * open-interval@(x, tilde@(x)) = exponential@(- ((norm@(x - tilde@(x))) ^ 2 / 2) * h ^ 2)" xml:id="A3.SS1.SSS2.p1.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A3.SS1.SSS2.p1.m8.1"/>
                                          <XMRef idref="A3.SS1.SSS2.p1.m8.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS1.SSS2.p1.m8.1">x</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A3.SS1.SSS2.p1.m8.2">
                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A3.SS1.SSS2.p1.m8.3"/>
                                        <XMRef idref="A3.SS1.SSS2.p1.m8.4"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A3.SS1.SSS2.p1.m8.3">exp</XMTok>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">{</XMTok>
                                          <XMApp xml:id="A3.SS1.SSS2.p1.m8.4">
                                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="norm"/>
                                                      <XMRef idref="A3.SS1.SSS2.p1.m8.4.1"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok name="||" role="OPEN">‖</XMTok>
                                                      <XMApp xml:id="A3.SS1.SSS2.p1.m8.4.1">
                                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        <XMApp>
                                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                        </XMApp>
                                                      </XMApp>
                                                      <XMTok name="||" role="CLOSE">‖</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                </XMApp>
                                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                  </XMApp>
                                </XMath>
                              </Math> to stay consistent with reported baselines from <cite class="ltx_citemacro_citep">[<bibref bibrefs="OT-Flow" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                  <bibrefphrase>, </bibrefphrase>
                                </bibref>]</cite>, where <Math mode="inline" tex="h&gt;0" text="h &gt; 0" xml:id="A3.SS1.SSS2.p1.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> is the bandwidth parameter.
We use three ways of setting the bandwidth parameter <Math mode="inline" tex="h" text="h" xml:id="A3.SS1.SSS2.p1.m10">
                                <XMath>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                </XMath>
                              </Math>:</p>
                            <itemize xml:id="A3.I1">
                              <item xml:id="A3.I1.i1">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">1st item</tag>
                                </tags>
                                <para xml:id="A3.I1.i1.p1">
                                  <p>Constant bandwidth: <Math mode="inline" tex="h=h_{c}=1" text="h = h _ c = 1" xml:id="A3.I1.i1.p1.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="multirelation"/>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                          </XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math>.
The resulting MMD is denoted as ‘MMD-1’.</p>
                                </para>
                              </item>
                              <item xml:id="A3.I1.i2">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">2nd item</tag>
                                </tags>
                                <para xml:id="A3.I1.i2.p1">
                                  <p>Median bandwidth <cite class="ltx_citemacro_citep">[<bibref bibrefs="Gretton2012AKT" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                        <bibrefphrase>, </bibrefphrase>
                                      </bibref>]</cite>:
let <Math mode="inline" tex="h=h_{m}" text="h = h _ m" xml:id="A3.I1.i2.p1.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMath>
                                    </Math> be the median of <Math mode="inline" tex="\|x_{i}-x_{j}\|" text="norm@(x _ i - x _ j)" xml:id="A3.I1.i2.p1.m2">
                                      <XMath>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="norm"/>
                                            <XMRef idref="A3.I1.i2.p1.m2.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok name="||" role="OPEN">‖</XMTok>
                                            <XMApp xml:id="A3.I1.i2.p1.m2.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok name="||" role="CLOSE">‖</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMath>
                                    </Math> for all distinct <Math mode="inline" tex="i" text="i" xml:id="A3.I1.i2.p1.m3">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                      </XMath>
                                    </Math> and <Math mode="inline" tex="j" text="j" xml:id="A3.I1.i2.p1.m4">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                      </XMath>
                                    </Math>.
The median distance is computed from the dataset <Math mode="inline" tex="X" text="X" xml:id="A3.I1.i2.p1.m5">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                      </XMath>
                                    </Math>. The resulting MMD is denoted as ‘MMD-m’.</p>
                                </para>
                              </item>
                              <item xml:id="A3.I1.i3">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">3rd item</tag>
                                </tags>
                                <para xml:id="A3.I1.i3.p1">
                                  <p>Custom bandwidth: on certain datasets when we can use prior knowledge to decide on the bandwidth, we will custom the choice of <Math mode="inline" tex="h" text="h" xml:id="A3.I1.i3.p1.m1">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                      </XMath>
                                    </Math> (typically smaller than the median distance, due to that theoretically smaller bandwidth may lead to a more powerful MMD test to distinguish the difference in the underlying distributions) while ensuring that we use large enough <Math mode="inline" tex="M" text="M" xml:id="A3.I1.i3.p1.m2">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                      </XMath>
                                    </Math> and <Math mode="inline" tex="N" text="N" xml:id="A3.I1.i3.p1.m3">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMath>
                                    </Math> to compute the MMD metric.
We call the metric ‘MMD-c’.</p>
                                </para>
                              </item>
                            </itemize>
                          </para>
                          <para xml:id="A3.SS1.SSS2.p2">
                            <p><text color="#000000">On all datasets,
we use at most <Math mode="inline" tex="N=10K" text="N = 10 * K" xml:id="A3.SS1.SSS2.p2.m1">
                                  <XMath>
                                    <XMApp>
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      <XMApp>
                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok meaning="10" role="NUMBER">10</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMath>
                                </Math> test samples as <Math mode="inline" tex="\bf{X}" text="X" xml:id="A3.SS1.SSS2.p2.m2">
                                  <XMath>
                                    <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                  </XMath>
                                </Math>,
and for each trained model,
we generate <Math mode="inline" tex="M=10K" text="M = 10 * K" xml:id="A3.SS1.SSS2.p2.m3">
                                  <XMath>
                                    <XMApp>
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                      <XMApp>
                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok meaning="10" role="NUMBER">10</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMath>
                                </Math> test samples to form the dataset <Math mode="inline" tex="\bf{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS1.SSS2.p2.m4">
                                  <XMath>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math> to compute the MMD value defined as in (<ref labelref="LABEL:MMD"/>).</text>
Note that the MMD metric as a measure of distance between two distributions is significant when above a test threshold <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS1.SSS2.p2.m5">
                                <XMath>
                                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                </XMath>
                              </Math>, which is defined as the upper (<Math mode="inline" tex="1-\alpha" text="1 - alpha" xml:id="A3.SS1.SSS2.p2.m6">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>)-quantile of the distribution of the MMD statistic under the null hypothesis
(i.e., when dataset <Math mode="inline" tex="\bf{X}" text="X" xml:id="A3.SS1.SSS2.p2.m7">
                                <XMath>
                                  <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                </XMath>
                              </Math> and <Math mode="inline" tex="\bf{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS1.SSS2.p2.m8">
                                <XMath>
                                  <XMApp>
                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> observe the same distribution).
The scalar <Math mode="inline" tex="\alpha" text="alpha" xml:id="A3.SS1.SSS2.p2.m9">
                                <XMath>
                                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                </XMath>
                              </Math> is the controlled Type-I error (known as the test level), which is set to be 0.05.
<text color="#000000">
To obtain the test threshold <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS1.SSS2.p2.m10">
                                  <XMath>
                                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                  </XMath>
                                </Math> for the MMD, we adopt the bootstrap procedure <cite class="ltx_citemacro_cite"><bibref bibrefs="arcones1992bootstrap,Gretton2012AKT" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                                    <bibrefphrase>[</bibrefphrase>
                                    <bibrefphrase>]</bibrefphrase>
                                  </bibref></cite>
and compute <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS1.SSS2.p2.m11">
                                  <XMath>
                                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                  </XMath>
                                </Math> as the empirical (<Math mode="inline" tex="1-\alpha" text="1 - alpha" xml:id="A3.SS1.SSS2.p2.m12">
                                  <XMath>
                                    <XMApp>
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math>)-quantile of the simulated null distribution of the MMD from the pool of samples formed by the union of <Math mode="inline" tex="\bf{X}" text="X" xml:id="A3.SS1.SSS2.p2.m13">
                                  <XMath>
                                    <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                  </XMath>
                                </Math> and <Math mode="inline" tex="\bf{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS1.SSS2.p2.m14">
                                  <XMath>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math>,
where the set <Math mode="inline" tex="\bf{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS1.SSS2.p2.m15">
                                  <XMath>
                                    <XMApp>
                                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                      <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math> is generated by the trained JKO-iFlow model.
We use 1000 times of bootstrap in all experiments.</text>
In our usage of evaluating generative models, the threshold <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS1.SSS2.p2.m16">
                                <XMath>
                                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                </XMath>
                              </Math> can be viewed as a baseline of the MMD metric, that is, when the computed MMD values are above <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS1.SSS2.p2.m17">
                                <XMath>
                                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                </XMath>
                              </Math>, then the smaller the MMD value the better the generative performance; when the computed MMD value is below <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS1.SSS2.p2.m18">
                                <XMath>
                                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                </XMath>
                              </Math>, it means that with respect to the current MMD metric, the trained model generates a data distribution that is as good as the true distribution.</p>
                          </para>
                        </subsubsection>
                      </subsection>
                      <subsection inlist="toc" labels="LABEL:sec:additional_results" xml:id="A3.SS2">
                        <tags>
                          <tag>C.2</tag>
                          <tag role="autoref">subsection C.2</tag>
                          <tag role="refnum">C.2</tag>
                          <tag role="typerefnum">§C.2</tag>
                        </tags>
                        <title><tag close=" ">C.2</tag>Detail setup and additional results</title>
                        <para xml:id="A3.SS2.p1">
                          <p>All experiments are conducted using PyTorch <cite class="ltx_citemacro_citep">[<bibref bibrefs="NEURIPS2019_9015" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase>, </bibrefphrase>
                              </bibref>]</cite> and PyTorch Geometric <cite class="ltx_citemacro_citep">[<bibref bibrefs="Fey/Lenssen/2019" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase>, </bibrefphrase>
                              </bibref>]</cite>.
The optimizer is Adam <cite class="ltx_citemacro_citep">[<bibref bibrefs="Kingma2015AdamAM" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase>, </bibrefphrase>
                              </bibref>]</cite> with learning rates to be specified in each example. We use the neural-ODE
integrator <cite class="ltx_citemacro_citep">[<bibref bibrefs="FFJORD" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                <bibrefphrase>, </bibrefphrase>
                              </bibref>, adjoint method]</cite> on all examples.</p>
                        </para>
                        <figure inlist="lof" labels="LABEL:fig_rose_sub_reparam" placement="!t" xml:id="A3.F2">
                          <tags>
                            <tag><text fontsize="90%">Figure A.2</text></tag>
                            <tag role="autoref">Figure A.2</tag>
                            <tag role="refnum">A.2</tag>
                            <tag role="typerefnum">Figure A.2</tag>
                          </tags>
                          <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="212.5pt" xml:id="A3.F2.fig1">
                            <graphics candidates="img_rose_Prune_and_refine_5phases_eta=075.png" graphic="img_rose_Prune_and_refine_5phases_eta=075.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F2.g1"/>
                            <toccaption><tag close=" ">a</tag>Per-block <Math mode="inline" tex="W_{2}^{2}" text="(W _ 2) ^ 2" xml:id="A3.F2.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>
over reparameterization iterations.</toccaption>
                            <caption><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">Per-block <Math mode="inline" tex="W_{2}^{2}" text="(W _ 2) ^ 2" xml:id="A3.F2.m2">
                                  <XMath>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math>
over reparameterization iterations.</text></caption>
                          </figure>
                          <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="212.5pt" xml:id="A3.F2.fig2">
                            <graphics candidates="Img_rose_true_vs_gen_together.png" graphic="Img_rose_true_vs_gen_together.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F2.g2"/>
                            <toccaption><tag close=" ">b</tag>Results at initial training (middle) and Iter 3 (right). MMD and NLL values are shown in the title.</toccaption>
                            <caption><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Results at initial training (middle) and Iter 3 (right). MMD and NLL values are shown in the title.</text></caption>
                          </figure>
                          <toccaption class="ltx_centering"><tag close=" ">A.2</tag>
Same plots as in Figure <ref labelref="LABEL:fig_MINIBOONE_sub_reparam"/> for Rose data.
We observe improved generative quality on the leaves of the rose after reparameterization iterations</toccaption>
                          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure A.2</text></tag><text fontsize="90%">
Same plots as in Figure <ref labelref="LABEL:fig_MINIBOONE_sub_reparam"/> for Rose data.
We observe improved generative quality on the leaves of the rose after reparameterization iterations</text></caption>
                        </figure>
                        <figure inlist="lof" labels="LABEL:fig_tree_sub_reparam" placement="!t" xml:id="A3.F3">
                          <tags>
                            <tag><text fontsize="90%">Figure A.3</text></tag>
                            <tag role="autoref">Figure A.3</tag>
                            <tag role="refnum">A.3</tag>
                            <tag role="typerefnum">Figure A.3</tag>
                          </tags>
<!--  %**** JKO˙arxiv˙v4.tex Line 1450 **** -->                          <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="212.5pt" xml:id="A3.F3.fig1">
                            <graphics candidates="img_tree_Prune_and_refine_5phases_eta=05.png" graphic="img_tree_Prune_and_refine_5phases_eta=05.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F3.g1"/>
                            <toccaption><tag close=" ">a</tag>
Per-block <Math mode="inline" tex="W_{2}^{2}" text="(W _ 2) ^ 2" xml:id="A3.F3.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>
over reparameterization iterations and refinement
(‘r-Iter 1’ means one reparameterization iteration after refinement).</toccaption>
                            <caption><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">
Per-block <Math mode="inline" tex="W_{2}^{2}" text="(W _ 2) ^ 2" xml:id="A3.F3.m2">
                                  <XMath>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">W</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math>
over reparameterization iterations and refinement
(‘r-Iter 1’ means one reparameterization iteration after refinement).</text></caption>
                          </figure>
                          <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="212.5pt" xml:id="A3.F3.fig2">
                            <graphics candidates="Img_tree_true_vs_gen_together.png" graphic="Img_tree_true_vs_gen_together.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F3.g2"/>
                            <toccaption><tag close=" ">b</tag>Results at Iter 4 (middle) and r-Iter 1 (right).
MMD and NLL values are shown in the title.</toccaption>
                            <caption><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Results at Iter 4 (middle) and r-Iter 1 (right).
MMD and NLL values are shown in the title.</text></caption>
                          </figure>
                          <toccaption class="ltx_centering"><tag close=" ">A.3</tag>
Same plots as in Figure <ref labelref="LABEL:fig_MINIBOONE_sub_reparam"/> for Fractal tree data.
We observe improved generative quality on the edges of the tree after refinement.
</toccaption>
                          <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure A.3</text></tag><text fontsize="90%">
Same plots as in Figure <ref labelref="LABEL:fig_MINIBOONE_sub_reparam"/> for Fractal tree data.
We observe improved generative quality on the edges of the tree after refinement.
</text></caption>
                        </figure>
                        <subsubsection inlist="toc" labels="LABEL:app:2d_toy LABEL:tab_high_dim_appendix" xml:id="A3.SS2.SSS1">
                          <tags>
                            <tag>C.2.1</tag>
                            <tag role="autoref">subsubsection C.2.1</tag>
                            <tag role="refnum">C.2.1</tag>
                            <tag role="typerefnum">§C.2.1</tag>
                          </tags>
                          <title><tag close=" ">C.2.1</tag>Two-dimensional toy data</title>
                          <para class="ltx_noindent" xml:id="A3.SS2.SSS1.p1">
<!--  %**** JKO˙arxiv˙v4.tex Line 1475 **** -->                            <p><text font="italic">Training and test data: </text>
We generate <text color="#000000">8K</text> test samples for each dataset,
and for the training split,</p>
                            <itemize xml:id="A3.I2">
                              <item xml:id="A3.I2.i1">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">1st item</tag>
                                </tags>
                                <para xml:id="A3.I2.i1.p1">
                                  <p>For Rose (Figure <ref labelref="LABEL:fig_rose_full_data"/> and <ref labelref="LABEL:fig_rose_sub_reparam"/>) and Checkerboard and Olympic rings (Figure <ref labelref="LABEL:fig_rose_full_data"/>), we re-sample 10K training samples every epoch, for a total of 100 epochs per block. The batch size is 500.</p>
                                </para>
                              </item>
                              <item xml:id="A3.I2.i2">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">2nd item</tag>
                                </tags>
                                <para xml:id="A3.I2.i2.p1">
                                  <p>For Fractal tree (Figure <ref labelref="LABEL:fig_rose_full_data"/> and <ref labelref="LABEL:fig_tree_sub_reparam"/>), we use a fixed training data of 200K samples, for a total of 50 epochs per block. The batch size is 2000.</p>
                                </para>
                              </item>
                            </itemize>
                          </para>
                          <para class="ltx_noindent" xml:id="A3.SS2.SSS1.p2">
                            <p><text font="italic">Choice of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A3.SS2.SSS1.p2.m1">
                                  <XMath>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok role="UNKNOWN">h</XMTok>
                                      <XMTok fontsize="70%" role="UNKNOWN">k</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math>:</text> The initial schedule is by setting <Math mode="inline" tex="h_{0}=0.75,\rho=1.2" text="formulae@(h _ 0 = 0.75, rho = 1.2)" xml:id="A3.SS2.SSS1.p2.m2">
                                <XMath>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="formulae"/>
                                      <XMRef idref="A3.SS2.SSS1.p2.m2.1"/>
                                      <XMRef idref="A3.SS2.SSS1.p2.m2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMApp xml:id="A3.SS2.SSS1.p2.m2.1">
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                        </XMApp>
                                        <XMTok meaning="0.75" role="NUMBER">0.75</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A3.SS2.SSS1.p2.m2.2">
                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                        <XMTok meaning="1.2" role="NUMBER">1.2</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                </XMath>
                              </Math>. We set <Math mode="inline" tex="h_{\max}=5" text="h _ maximum = 5" xml:id="A3.SS2.SSS1.p2.m3">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                      <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                    </XMApp>
                                    <XMTok meaning="5" role="NUMBER">5</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> for rose, checkerboard, and Olympic rings, and <Math mode="inline" tex="h_{\max}=3" text="h _ maximum = 3" xml:id="A3.SS2.SSS1.p2.m4">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                      <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                    </XMApp>
                                    <XMTok meaning="3" role="NUMBER">3</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> for fractal tree. For reparametrization and refinement, we use <Math mode="inline" tex="\eta=0.5" text="eta = 0.5" xml:id="A3.SS2.SSS1.p2.m5">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                                    <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> in the reparameterization iterations for all examples.</p>
                            <itemize xml:id="A3.I3">
                              <item xml:id="A3.I3.i1">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">1st item</tag>
                                </tags>
                                <para xml:id="A3.I3.i1.p1">
                                  <p>For Rose, 3 reparameterization moving iteration, no refinement.</p>
                                </para>
                              </item>
                              <item xml:id="A3.I3.i2">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">2nd item</tag>
                                </tags>
                                <para xml:id="A3.I3.i2.p1">
                                  <p>For Checkerboard and Olympic rings, 4 reparameterization moving iteration, no refinement.</p>
                                </para>
                              </item>
                              <item xml:id="A3.I3.i3">
                                <tags>
                                  <tag>•</tag>
                                  <tag role="autoref">item </tag>
                                  <tag role="typerefnum">3rd item</tag>
                                </tags>
                                <para xml:id="A3.I3.i3.p1">
                                  <p>For Fractal tree, 4 reparameterization moving iteration, one refinement, and an additional reparameterization moving iteration.</p>
                                </para>
                              </item>
                            </itemize>
                            <p><text font="italic">MMD metric:</text> We use custom kernel bandwidth <Math mode="inline" tex="h=0.1h_{m}" text="h = 0.1 * h _ m" xml:id="A3.SS2.SSS1.p2.m6">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> where <Math mode="inline" tex="h_{m}" text="h _ m" xml:id="A3.SS2.SSS1.p2.m7">
                                <XMath>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math> is the median distance of dataset <Math mode="inline" tex="\bf{X}" text="X" xml:id="A3.SS2.SSS1.p2.m8">
                                <XMath>
                                  <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                </XMath>
                              </Math> with <Math mode="inline" tex="N={\color[rgb]{0,0,0}8K}" text="N = 8 * K" xml:id="A3.SS2.SSS1.p2.m9">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok color="#000000" meaning="8" role="NUMBER">8</XMTok>
                                      <XMTok color="#000000" font="italic" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> (from true data distribution).
From trained generative model, we generate <Math mode="inline" tex="M={\color[rgb]{0,0,0}10K}" text="M = 10 * K" xml:id="A3.SS2.SSS1.p2.m10">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok color="#000000" meaning="10" role="NUMBER">10</XMTok>
                                      <XMTok color="#000000" font="italic" role="UNKNOWN">K</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMath>
                              </Math> test samples as <Math mode="inline" tex="\bf{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS2.SSS1.p2.m11">
                                <XMath>
                                  <XMApp>
                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>.</p>
                          </para>
                          <para class="ltx_noindent" xml:id="A3.SS2.SSS1.p3">
                            <p><text font="italic">Network and activation:</text> Fully-connected residual blocks with two hidden layers. We use the softplus activation (<Math mode="inline" tex="\beta=20" text="beta = 20" xml:id="A3.SS2.SSS1.p3.m1">
                                <XMath>
                                  <XMApp>
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMTok meaning="20" role="NUMBER">20</XMTok>
                                  </XMApp>
                                </XMath>
                              </Math>) with 128 hidden dimensions. Before refinement, we train 9 residual blocks for rose, checkerboard, and Olympic rings, and train 6 residual blocks for fractal trees. The learning rate is 5e-3.</p>
                          </para>
                          <para class="ltx_noindent" xml:id="A3.SS2.SSS1.p4">
                            <p><text font="italic">Additional results:</text> Figure <ref labelref="LABEL:fig_rose_sub_reparam"/> and <ref labelref="LABEL:fig_tree_sub_reparam"/> illustrates the benefits of reparameterization and refinement. Specifically, the details of the generated rose around portions of leaves and of the generated tree around the smallest edges are clearer using these techniques. In terms of quantitative metrics, the NLL is also smaller, even though the MMD metric indicates there is no statistical difference between the ground truth and generated samples.</p>
                          </para>
                          <table placement="!t" xml:id="A3.SS2.SSS1.tab1">
                            <block>
                              <toccaption class="ltx_centering"><tag close=" ">A.1</tag>
<text color="#000000">
Complete results on real tabular datasets to augment Table <ref labelref="LABEL:tab_high_dim"/> under the fixed-budget setting.
<Math mode="inline" tex="L" text="L" xml:id="A3.SS2.SSS1.m1">
                                    <XMath>
                                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                    </XMath>
                                  </Math> denotes to the number of residual blocks used in each dataset; for comparison, the free block in JKO-iFlow is not used.
For fair comparison across models, the number of batches indicates how many batches pass through all residual blocks. </text>
</toccaption>
                              <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table A.1</text></tag><text fontsize="90%">
<text color="#000000">
Complete results on real tabular datasets to augment Table <ref labelref="LABEL:tab_high_dim"/> under the fixed-budget setting.
<Math mode="inline" tex="L" text="L" xml:id="A3.SS2.SSS1.m2">
                                      <XMath>
                                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                      </XMath>
                                    </Math> denotes to the number of residual blocks used in each dataset; for comparison, the free block in JKO-iFlow is not used.
For fair comparison across models, the number of batches indicates how many batches pass through all residual blocks. </text>
</text></caption>
                              <inline-block align="center" depth="0.6pt" height="399.7pt" width="411.9pt" xscale="0.60009953961262" xtranslate="-137.3pt" yscale="0.60009953961262" ytranslate="133.2pt">
                                <tabular vattach="middle">
                                  <tr>
                                    <td align="left" border="t" rowspan="2">Data Set</td>
                                    <td align="left" border="t" rowspan="2">Model</td>
                                    <td align="left" border="t" rowspan="2"># Param</td>
                                    <td align="center" border="t" colspan="4">Training</td>
                                    <td align="center" border="t" colspan="3">Testing</td>
                                  </tr>
                                  <tr>
                                    <td align="center" border="t">Time (h)</td>
                                    <td align="center" border="t"># Batches</td>
                                    <td align="center" border="t">Time/Batches (s)</td>
                                    <td align="center" border="t">Batch size</td>
                                    <td align="right" border="t">MMD-m</td>
                                    <td align="right" border="t">MMD-1</td>
                                    <td align="center" border="t">NLL</td>
                                  </tr>
                                  <tr>
                                    <td align="left" border="t" rowspan="8"><!--  %**** JKO˙arxiv˙v4.tex Line 1525 **** --><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">POWER</text> 
<Math mode="inline" tex="d=6" text="d = 6" xml:id="A3.SS2.SSS1.m3">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok meaning="6" role="NUMBER">6</XMTok>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m4">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 1.73e-4</text></td>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m5">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 2.90e-4</text></td>
                                    <td border="t"/>
                                  </tr>
                                  <tr>
                                    <td align="left">JKO-iFlow</td>
                                    <td align="left">76K, L=4</td>
                                    <td align="center">0.07</td>
                                    <td align="center">0.76K</td>
                                    <td align="center">3.51e-1</td>
                                    <td align="center">10000</td>
                                    <td align="right">9.86e-5</td>
                                    <td align="right">2.40e-4</td>
                                    <td align="center">-0.12</td>
                                  </tr>
                                  <tr>
                                    <td align="left">OT-Flow</td>
                                    <td align="left">76K</td>
                                    <td align="center">0.36</td>
                                    <td align="center">7.58K</td>
                                    <td align="center">1.71e-1</td>
                                    <td align="center">10000</td>
                                    <td align="right">7.58e-4</td>
                                    <td align="right">5.35e-4</td>
                                    <td align="center">0.32</td>
                                  </tr>
                                  <tr>
                                    <td align="left">FFJORD</td>
                                    <td align="left">76K, L=4</td>
                                    <td align="center">0.67</td>
                                    <td align="center">7.58K</td>
                                    <td align="center">3.18e-1</td>
                                    <td align="center">10000</td>
                                    <td align="right">9.89e-4</td>
                                    <td align="right">1.16e-3</td>
                                    <td align="center">0.63</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IGNN</td>
                                    <td align="left">304K, L=16</td>
                                    <td align="center">0.29</td>
                                    <td align="center">7.58K</td>
                                    <td align="center">1.38e-1</td>
                                    <td align="center">10000</td>
                                    <td align="right">1.93e-3</td>
                                    <td align="right">1.59e-3</td>
                                    <td align="center">0.95</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IResNet</td>
                                    <td align="left">304K, L=16</td>
                                    <td align="center">0.41</td>
                                    <td align="center">7.58K</td>
                                    <td align="center">1.95e-1</td>
                                    <td align="center">10000</td>
                                    <td align="right">3.92e-3</td>
                                    <td align="right">2.43e-2</td>
                                    <td align="center">3.37</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">76K</td>
                                    <td align="center">0.06</td>
                                    <td align="center">7.58K</td>
                                    <td align="center">2.85e-2</td>
                                    <td align="center">10000</td>
                                    <td align="right">9.12e-4</td>
                                    <td align="right">6.08e-3</td>
                                    <td align="center">3.41</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">76K</td>
                                    <td align="center">0.60</td>
                                    <td align="center">75.80K</td>
                                    <td align="center">2.85e-2</td>
                                    <td align="center">10000</td>
                                    <td align="right">7.12e-4</td>
                                    <td align="right">5.04e-3</td>
                                    <td align="center">3.33</td>
                                  </tr>
                                  <tr>
                                    <td/>
                                    <td align="left" border="t">JKO-iFlow</td>
                                    <td align="left" border="t">57K, L=3</td>
                                    <td align="center" border="t">0.05</td>
                                    <td align="center" border="t">0.76K</td>
                                    <td align="center" border="t">2.63e-1</td>
                                    <td align="center" border="t">10000</td>
                                    <td align="right" border="t">3.86e-4</td>
                                    <td align="right" border="t">7.20e-4</td>
                                    <td align="center" border="t">-0.06</td>
                                  </tr>
                                  <tr>
                                    <td align="left" border="t" rowspan="8"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">GAS</text> 
<Math mode="inline" tex="d=8" text="d = 8" xml:id="A3.SS2.SSS1.m6">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok meaning="8" role="NUMBER">8</XMTok>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m7">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 1.85e-4</text></td>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m8">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 2.73e-4</text></td>
                                    <td border="t"/>
                                  </tr>
                                  <tr>
                                    <td align="left">JKO-iFlow</td>
                                    <td align="left">76K, L=4</td>
                                    <td align="center">0.07</td>
                                    <td align="center">0.76K</td>
                                    <td align="center">3.32e-1</td>
                                    <td align="center">5000</td>
                                    <td align="right">1.52e-4</td>
                                    <td align="right">5.00e-4</td>
                                    <td align="center">-7.65</td>
                                  </tr>
                                  <tr>
                                    <td align="left">OT-Flow</td>
                                    <td align="left">76K</td>
                                    <td align="center">0.23</td>
                                    <td align="center">7.60K</td>
                                    <td align="center">1.09e-1</td>
                                    <td align="center">5000</td>
                                    <td align="right">1.99e-4</td>
                                    <td align="right">5.16e-4</td>
                                    <td align="center">-6.04</td>
                                  </tr>
                                  <tr>
                                    <td align="left">FFJORD</td>
                                    <td align="left">76K, L=4</td>
                                    <td align="center">0.65</td>
                                    <td align="center">7.60K</td>
                                    <td align="center">3.08e-1</td>
                                    <td align="center">5000</td>
                                    <td align="right">1.87e-3</td>
                                    <td align="right">3.28e-3</td>
                                    <td align="center">-2.65</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IGNN</td>
                                    <td align="left">304K, L=16</td>
                                    <td align="center">0.34</td>
                                    <td align="center">7.60K</td>
                                    <td align="center">1.61e-1</td>
                                    <td align="center">5000</td>
                                    <td align="right">6.74e-3</td>
                                    <td align="right">1.43e-2</td>
                                    <td align="center">-1.65</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IResNet</td>
                                    <td align="left">304K, L=16</td>
                                    <td align="center">0.46</td>
                                    <td align="center">7.60K</td>
                                    <td align="center">2.18e-1</td>
                                    <td align="center">5000</td>
                                    <td align="right">3.20e-3</td>
                                    <td align="right">2.73e-2</td>
                                    <td align="center">-1.17</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">76K</td>
                                    <td align="center">0.03</td>
                                    <td align="center">7.60K</td>
                                    <td align="center">1.42e-2</td>
                                    <td align="center">5000</td>
                                    <td align="right">1.05e-3</td>
                                    <td align="right">8.36e-4</td>
                                    <td align="center">-3.69</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">76K</td>
                                    <td align="center">0.30</td>
                                    <td align="center">76.00K</td>
                                    <td align="center">1.42e-2</td>
                                    <td align="center">5000</td>
                                    <td align="right">2.23e-4</td>
                                    <td align="right">3.38e-4</td>
                                    <td align="center">-5.58</td>
                                  </tr>
                                  <tr>
                                    <td/>
                                    <td align="left" border="t">JKO-iFlow</td>
                                    <td align="left" border="t">95K, L=5</td>
                                    <td align="center" border="t">0.09</td>
                                    <td align="center" border="t">0.76K</td>
                                    <td align="center" border="t">4.15e-1</td>
                                    <td align="center" border="t">5000</td>
                                    <td align="right" border="t">1.51e-4</td>
                                    <td align="right" border="t">3.77e-4</td>
                                    <td align="center" border="t">-7.80</td>
                                  </tr>
                                  <tr>
                                    <td align="left" border="t" rowspan="8"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">MINIBOONE</text> 
<Math mode="inline" tex="d=43" text="d = 43" xml:id="A3.SS2.SSS1.m9">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok meaning="43" role="NUMBER">43</XMTok>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m10">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 2.46e-4</text></td>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m11">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 3.75e-4</text></td>
                                    <td border="t"/>
                                  </tr>
                                  <tr>
                                    <td align="left">JKO-iFlow</td>
                                    <td align="left">112K, L=4</td>
                                    <td align="center">0.03</td>
                                    <td align="center">0.34K</td>
                                    <td align="center">3.61e-1</td>
                                    <td align="center">2000</td>
                                    <td align="right">9.66e-4</td>
                                    <td align="right">3.79e-4</td>
                                    <td align="center">12.55</td>
                                  </tr>
                                  <tr>
                                    <td align="left">OT-Flow</td>
                                    <td align="left">112K</td>
                                    <td align="center">0.21</td>
                                    <td align="center">3.39K</td>
                                    <td align="center">2.23e-1</td>
                                    <td align="center">2000</td>
                                    <td align="right">6.58e-4</td>
                                    <td align="right">3.79e-4</td>
                                    <td align="center">11.44</td>
                                  </tr>
                                  <tr>
                                    <td align="left">FFJORD</td>
                                    <td align="left">112K, L=4</td>
                                    <td align="center">0.28</td>
                                    <td align="center">3.39K</td>
                                    <td align="center">2.97e-1</td>
                                    <td align="center">2000</td>
                                    <td align="right">3.51e-3</td>
                                    <td align="right">4.12e-4</td>
                                    <td align="center">23.77</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IGNN</td>
                                    <td align="left">448K, L=16</td>
                                    <td align="center">0.63</td>
                                    <td align="center">3.39K</td>
                                    <td align="center">6.69e-1</td>
                                    <td align="center">2000</td>
                                    <td align="right">1.21e-2</td>
                                    <td align="right">4.01e-4</td>
                                    <td align="center">26.45</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IResNet</td>
                                    <td align="left">448K, L=16</td>
                                    <td align="center">0.71</td>
                                    <td align="center">3.39K</td>
                                    <td align="center">7.54e-1</td>
                                    <td align="center">2000</td>
                                    <td align="right">2.13e-3</td>
                                    <td align="right">4.16e-4</td>
                                    <td align="center">22.36</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">112K</td>
                                    <td align="center">0.01</td>
                                    <td align="center">3.39K</td>
                                    <td align="center">6.37e-3</td>
                                    <td align="center">2000</td>
                                    <td align="right">5.86e-1</td>
                                    <td align="right">4.33e-4</td>
                                    <td align="center">27.38</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">112K</td>
                                    <td align="center">0.10</td>
                                    <td align="center">33.90K</td>
                                    <td align="center">6.37e-3</td>
                                    <td align="center">2000</td>
                                    <td align="right">4.17e-3</td>
                                    <td align="right">3.87e-4</td>
                                    <td align="center">20.70</td>
                                  </tr>
                                  <tr>
                                    <td align="left" border="b t" rowspan="9"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">BSDS300</text>
<Math mode="inline" tex="d=63" text="d = 63" xml:id="A3.SS2.SSS1.m12">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMTok meaning="63" role="NUMBER">63</XMTok>
                                          </XMApp>
                                        </XMath>
                                      </Math></td>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td border="t"/>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m13">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 1.38e-4</text></td>
                                    <td align="right" border="t"><ERROR class="undefined">\makecell</ERROR>[r]<Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS1.m14">
                                        <XMath>
                                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                        </XMath>
                                      </Math><text font="bold">: 1.01e-4</text></td>
                                    <td border="t"/>
                                  </tr>
                                  <tr>
                                    <td align="left">JKO-iFlow</td>
                                    <td align="left">396K, L=4</td>
                                    <td align="center">0.05</td>
                                    <td align="center">1.03K</td>
                                    <td align="center">1.85e-1</td>
                                    <td align="center">1000</td>
                                    <td align="right">2.24e-4</td>
                                    <td align="right">1.91e-4</td>
                                    <td align="center">-153.82</td>
                                  </tr>
                                  <tr>
                                    <td align="left">OT-Flow</td>
                                    <td align="left">396K</td>
                                    <td align="center">0.62</td>
                                    <td align="center">10.29K</td>
                                    <td align="center">2.17e-1</td>
                                    <td align="center">1000</td>
                                    <td align="right">5.43e-1</td>
                                    <td align="right">6.49e-1</td>
                                    <td align="center">-104.62</td>
                                  </tr>
                                  <tr>
                                    <td align="left">FFJORD</td>
                                    <td align="left">396K, L=4</td>
                                    <td align="center">0.54</td>
                                    <td align="center">10.29K</td>
                                    <td align="center">1.89e-1</td>
                                    <td align="center">1000</td>
                                    <td align="right">5.60e-1</td>
                                    <td align="right">6.76e-1</td>
                                    <td align="center">-37.80</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IGNN</td>
                                    <td align="left">990K, L=10</td>
                                    <td align="center">1.71</td>
                                    <td align="center">10.29K</td>
                                    <td align="center">5.98e-1</td>
                                    <td align="center">1000</td>
                                    <td align="right">5.64e-1</td>
                                    <td align="right">6.86e-1</td>
                                    <td align="center">-37.68</td>
                                  </tr>
                                  <tr>
                                    <td align="left">IResNet</td>
                                    <td align="left">990K, L=10</td>
                                    <td align="center">2.05</td>
                                    <td align="center">10.29K</td>
                                    <td align="center">7.17e-1</td>
                                    <td align="center">1000</td>
                                    <td align="right">5.50e-1</td>
                                    <td align="right">5.50e-1</td>
                                    <td align="center">-33.11</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">396K</td>
                                    <td align="center">0.01</td>
                                    <td align="center">10.29K</td>
                                    <td align="center">3.50e-3</td>
                                    <td align="center">1000</td>
                                    <td align="right">5.61e-1</td>
                                    <td align="right">6.60e-1</td>
                                    <td align="center">-7.55</td>
                                  </tr>
                                  <tr>
                                    <td align="left">ScoreSDE</td>
                                    <td align="left">396K</td>
                                    <td align="center">0.10</td>
                                    <td align="center">102.90K</td>
                                    <td align="center">3.50e-3</td>
                                    <td align="center">1000</td>
                                    <td align="right">5.61e-1</td>
                                    <td align="right">6.62e-1</td>
                                    <td align="center">-7.31</td>
                                  </tr>
                                  <tr>
                                    <td align="left" border="b t">JKO-iFlow</td>
                                    <td align="left" border="b t">396K, L=4</td>
                                    <td align="center" border="b t">0.08</td>
                                    <td align="center" border="b t">1.03K</td>
                                    <td align="center" border="b t">2.76e-1</td>
                                    <td align="center" border="b t">5000</td>
                                    <td align="right" border="b t">1.41e-4</td>
                                    <td align="right" border="b t">8.83e-5</td>
                                    <td align="center" border="b t">-156.68</td>
                                  </tr>
                                </tabular>
                              </inline-block>
                              <subsubsection class="ltx_centering" inlist="toc" labels="LABEL:sec:real_data LABEL:tab_high_dim_appendix_2" xml:id="A3.SS2.SSS2">
                                <tags>
                                  <tag>C.2.2</tag>
                                  <tag role="autoref">subsubsection C.2.2</tag>
                                  <tag role="refnum">C.2.2</tag>
                                  <tag role="typerefnum">§C.2.2</tag>
                                </tags>
                                <title><tag close=" ">C.2.2</tag>Tabular datasets</title>
                                <para class="ltx_noindent" xml:id="A3.SS2.SSS2.p1">
                                  <p><text font="italic">Training and test data: </text>The four high-dimensional real datasets (POWER, GAS, MINIBOONE, BSDS300) come from the University of California Irvine (UCI) machine learning data repository, and we follow the pre-processing procedures of <cite class="ltx_citemacro_citep">[<bibref bibrefs="papamakarios2017masked" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                        <bibrefphrase>, </bibrefphrase>
                                      </bibref>]</cite>. Regarding data sizes,</p>
                                  <itemize xml:id="A3.I4">
                                    <item xml:id="A3.I4.i1">
                                      <tags>
                                        <tag>•</tag>
                                        <tag role="autoref">item </tag>
                                        <tag role="typerefnum">1st item</tag>
                                      </tags>
                                      <para xml:id="A3.I4.i1.p1">
                                        <p>POWER: 1.85M training sample and 205K test sample.</p>
                                      </para>
                                    </item>
                                    <item xml:id="A3.I4.i2">
                                      <tags>
                                        <tag>•</tag>
                                        <tag role="autoref">item </tag>
                                        <tag role="typerefnum">2nd item</tag>
                                      </tags>
                                      <para xml:id="A3.I4.i2.p1">
                                        <p>GAS: 1M training sample, 100K test sample.</p>
                                      </para>
                                    </item>
                                    <item xml:id="A3.I4.i3">
                                      <tags>
                                        <tag>•</tag>
                                        <tag role="autoref">item </tag>
                                        <tag role="typerefnum">3rd item</tag>
                                      </tags>
                                      <para xml:id="A3.I4.i3.p1">
                                        <p>MINIBOONE: 32K training sample, 3.6K test sample.</p>
                                      </para>
                                    </item>
                                    <item xml:id="A3.I4.i4">
                                      <tags>
                                        <tag>•</tag>
                                        <tag role="autoref">item </tag>
                                        <tag role="typerefnum">4th item</tag>
                                      </tags>
                                      <para xml:id="A3.I4.i4.p1">
                                        <p>BSDS300: 1.05M training sample, 250K test sample.</p>
                                      </para>
                                    </item>
                                  </itemize>
                                </para>
                                <para class="ltx_noindent" xml:id="A3.SS2.SSS2.p2">
                                  <p><text font="italic">Choice of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A3.SS2.SSS2.p2.m1">
                                        <XMath>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok role="UNKNOWN">h</XMTok>
                                            <XMTok fontsize="70%" role="UNKNOWN">k</XMTok>
                                          </XMApp>
                                        </XMath>
                                      </Math>:</text> The initial schedule is by setting <Math mode="inline" tex="h_{0}=1,\rho=1,h_{\max}=3" text="formulae@(h _ 0 = 1, formulae@(rho = 1, h _ maximum = 3))" xml:id="A3.SS2.SSS2.p2.m2">
                                      <XMath>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="formulae"/>
                                            <XMRef idref="A3.SS2.SSS2.p2.m2.1"/>
                                            <XMRef idref="A3.SS2.SSS2.p2.m2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMApp xml:id="A3.SS2.SSS2.p2.m2.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                              </XMApp>
                                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMDual xml:id="A3.SS2.SSS2.p2.m2.2">
                                              <XMApp>
                                                <XMTok meaning="formulae"/>
                                                <XMRef idref="A3.SS2.SSS2.p2.m2.2.1"/>
                                                <XMRef idref="A3.SS2.SSS2.p2.m2.2.2"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMApp xml:id="A3.SS2.SSS2.p2.m2.2.1">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A3.SS2.SSS2.p2.m2.2.2">
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                    <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                  </XMApp>
                                                  <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                </XMApp>
                                              </XMWrap>
                                            </XMDual>
                                          </XMWrap>
                                        </XMDual>
                                      </XMath>
                                    </Math>. For reparametrization and refinement, we use <Math mode="inline" tex="\eta=0.5" text="eta = 0.5" xml:id="A3.SS2.SSS2.p2.m3">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                                          <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math> in the reparameterization iterations for all datasets.</p>
                                </para>
                                <para class="ltx_noindent" xml:id="A3.SS2.SSS2.p3">
                                  <p><text font="italic">MMD metric:</text>
<text color="#000000">When the test data from the MINIBOONE dataset is less than 10K in size, we use all the test sets as <Math mode="inline" tex="\bf{X}" text="X" xml:id="A3.SS2.SSS2.p3.m1">
                                        <XMath>
                                          <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                        </XMath>
                                      </Math> and <Math mode="inline" tex="N" text="N" xml:id="A3.SS2.SSS2.p3.m2">
                                        <XMath>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        </XMath>
                                      </Math> is the size of the test data. When the test data from all three other datasets has more than 10K samples, we randomly select <Math mode="inline" tex="N=10K" text="N = 10 * K" xml:id="A3.SS2.SSS2.p3.m3">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            <XMApp>
                                              <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok meaning="10" role="NUMBER">10</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMath>
                                      </Math> samples from the entire test data,</text><!--  %**** JKO˙arxiv˙v4.tex Line 1600 **** -->
and the same random test subset is used to evaluate all models.
We use the median distance kernel bandwidth and generate <Math mode="inline" tex="M=10K" text="M = 10 * K" xml:id="A3.SS2.SSS2.p3.m4">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok meaning="10" role="NUMBER">10</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">K</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMath>
                                    </Math> test samples from each model to form <Math mode="inline" tex="\bf{\tilde{X}}" text="tilde@(X)" xml:id="A3.SS2.SSS2.p3.m5">
                                      <XMath>
                                        <XMApp>
                                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                          <XMTok font="bold" role="UNKNOWN">X</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math>.</p>
                                </para>
                                <para class="ltx_noindent" xml:id="A3.SS2.SSS2.p4">
                                  <p><text font="italic">Network and activation:</text> We use the softplus activation for all networks. Regarding the design of residual blocks, we use fully-connected residual blocks with two hidden layers. On POWER, GAS, and MINIBOONE, we use 128 hidden nodes, and on BSDS300, we use 256 hidden nodes. The number of residual blocks for four tabular datasets is described in Tables <ref labelref="LABEL:tab_high_dim_appendix"/> and <ref labelref="LABEL:tab_high_dim_appendix_2"/>. Regarding learning rate, it is 1e-3 on POWER, 2e-3 on GAS, 5e-3 on MINIBOONE, and 1.75e-3 on BSDS300.</p>
                                </para>
                                <table placement="!t" xml:id="A3.SS2.SSS2.tab1">
                                  <block>
                                    <toccaption class="ltx_centering"><tag close=" ">A.2</tag>
<text color="#000000">
The OT-Flow and FFJORD baselines marked with <sup>∗</sup> are from the original papers <cite class="ltx_citemacro_citep">[<bibref bibrefs="OT-Flow" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                            <bibrefphrase>, </bibrefphrase>
                                          </bibref>]</cite> and <cite class="ltx_citemacro_citep">[<bibref bibrefs="FFJORD" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                            <bibrefphrase>, </bibrefphrase>
                                          </bibref>]</cite>.
The results of JKO-iFlow are obtained after applying the reparameterization technique.</text>
</toccaption>
                                    <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table A.2</text></tag><text fontsize="90%">
<text color="#000000">
The OT-Flow and FFJORD baselines marked with <sup>∗</sup> are from the original papers <cite class="ltx_citemacro_citep">[<bibref bibrefs="OT-Flow" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase>, </bibrefphrase>
                                            </bibref>]</cite> and <cite class="ltx_citemacro_citep">[<bibref bibrefs="FFJORD" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase>, </bibrefphrase>
                                            </bibref>]</cite>.
The results of JKO-iFlow are obtained after applying the reparameterization technique.</text>
</text></caption>
                                    <inline-block align="center" depth="0.0pt" height="149.5pt" width="238.5pt" xscale="0.593330326031116" xtranslate="-81.7pt" yscale="0.593330326031116" ytranslate="51.2pt">
                                      <tabular vattach="middle">
                                        <tr>
                                          <td align="left" border="t">Data Set</td>
                                          <td align="left" border="t">Model</td>
                                          <td align="left" border="t"># Param</td>
                                          <td align="center" border="t" colspan="2">Training</td>
                                          <td align="center" border="t">Testing</td>
                                        </tr>
                                        <tr>
                                          <td/>
                                          <td/>
                                          <td/>
                                          <td align="center"># Batches</td>
                                          <td align="center">Batch size</td>
                                          <td align="center">NLL</td>
                                        </tr>
                                        <tr>
                                          <td align="left" border="t" rowspan="3"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">POWER</text> 
<Math mode="inline" tex="d=6" text="d = 6" xml:id="A3.SS2.SSS2.m3">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                  <XMTok meaning="6" role="NUMBER">6</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math></td>
                                          <td align="left" border="t">JKO-iFlow</td>
                                          <td align="left" border="t">95K, L=5</td>
                                          <td align="center" border="t">6.08K</td>
                                          <td align="center" border="t">10000</td>
                                          <td align="center" border="t">-0.40</td>
                                        </tr>
                                        <tr>
                                          <td align="left">OT-Flow<sup>∗</sup></td>
                                          <td align="left">18K</td>
                                          <td align="center">22K</td>
                                          <td align="center">10000</td>
                                          <td align="center">-0.30</td>
                                        </tr>
                                        <tr>
                                          <td align="left">FFJORD<sup>∗</sup></td>
                                          <td align="left">43K, L=5</td>
                                          <td align="center">-</td>
                                          <td align="center">10000</td>
                                          <td align="center">-0.46</td>
                                        </tr>
                                        <tr>
                                          <td align="left" border="t" rowspan="3"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">GAS</text> 
<Math mode="inline" tex="d=8" text="d = 8" xml:id="A3.SS2.SSS2.m6">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                  <XMTok meaning="8" role="NUMBER">8</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math></td>
                                          <td align="left" border="t">JKO-iFlow</td>
                                          <td align="left" border="t">114K, L=6</td>
                                          <td align="center" border="t">6.08K</td>
                                          <td align="center" border="t">5000</td>
                                          <td align="center" border="t">-9.43</td>
                                        </tr>
                                        <tr>
                                          <td align="left">OT-Flow<sup>∗</sup></td>
                                          <td align="left">127K</td>
                                          <td align="center">52K</td>
                                          <td align="center">2000</td>
                                          <td align="center">-9.20</td>
                                        </tr>
                                        <tr>
                                          <td align="left">FFJORD<sup>∗</sup></td>
                                          <td align="left">279K, L=5</td>
                                          <td align="center">-</td>
                                          <td align="center">1000</td>
                                          <td align="center">-8.59</td>
                                        </tr>
                                        <tr>
                                          <td align="left" border="t" rowspan="3"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">MINIBOONE</text>
<Math mode="inline" tex="d=43" text="d = 43" xml:id="A3.SS2.SSS2.m9">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                  <XMTok meaning="43" role="NUMBER">43</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math></td>
                                          <td align="left" border="t">JKO-iFlow</td>
                                          <td align="left" border="t">112K, L=4</td>
                                          <td align="center" border="t">2.72K</td>
                                          <td align="center" border="t">2000</td>
                                          <td align="center" border="t">10.55</td>
                                        </tr>
                                        <tr>
                                          <td align="left">OT-Flow<sup>∗</sup></td>
                                          <td align="left">78K</td>
                                          <td align="center">7K</td>
                                          <td align="center">2000</td>
                                          <td align="center">10.55</td>
                                        </tr>
                                        <tr>
                                          <td align="left">FFJORD<sup>∗</sup></td>
                                          <td align="left">821K, L=1</td>
                                          <td align="center">-</td>
                                          <td align="center">1000</td>
                                          <td align="center">10.43</td>
                                        </tr>
                                        <tr>
                                          <td align="left" border="b t" rowspan="3"><ERROR class="undefined">\makecell</ERROR>[l]<text font="bold">BSDS300</text>
<Math mode="inline" tex="d=63" text="d = 63" xml:id="A3.SS2.SSS2.m12">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                  <XMTok meaning="63" role="NUMBER">63</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math></td>
                                          <td align="left" border="t">JKO-iFlow</td>
                                          <td align="left" border="t">495K, L=5</td>
                                          <td align="center" border="t">2.06K</td>
                                          <td align="center" border="t">5000</td>
                                          <td align="center" border="t">-157.75</td>
                                        </tr>
                                        <tr>
                                          <td align="left">OT-Flow<sup>∗</sup></td>
                                          <td align="left">297K</td>
                                          <td align="center">37K</td>
                                          <td align="center">300</td>
                                          <td align="center">-154.20</td>
                                        </tr>
                                        <tr>
                                          <td align="left" border="b">FFJORD<sup>∗</sup></td>
                                          <td align="left" border="b">6.7M, L=2</td>
                                          <td align="center" border="b">-</td>
                                          <td align="center" border="b">10000</td>
                                          <td align="center" border="b">-157.40</td>
                                        </tr>
                                      </tabular>
                                    </inline-block>
<!--  %**** JKO˙arxiv˙v4.tex Line 1650 **** -->                                    <table align="center" inlist="lot" labels="LABEL:tab_noise_schedule" placement="!b" xml:id="A3.T3">
                                      <tags>
                                        <tag><text fontsize="90%">Table A.3</text></tag>
                                        <tag role="autoref">Table A.3</tag>
                                        <tag role="refnum">A.3</tag>
                                        <tag role="typerefnum">Table A.3</tag>
                                      </tags>
                                      <toccaption class="ltx_centering"><tag close=" ">A.3</tag>
NLL per noise scheduler and <Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.T3.m1">
                                          <XMath>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                              </XMApp>
                                              <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                            </XMApp>
                                          </XMath>
                                        </Math> combination of ScoreSDE on MINIBOONE. The three settings “linear, constant, quadratic” follow the DDPM suggestion <cite class="ltx_citemacro_citep">[<bibref bibrefs="ho2020denoising" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                            <bibrefphrase>, </bibrefphrase>
                                          </bibref>]</cite>. The mean and standard deviation are computed over three replicas of the trained model.
</toccaption>
                                      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table A.3</text></tag><text fontsize="90%">
NLL per noise scheduler and <Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.T3.m2">
                                            <XMath>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> combination of ScoreSDE on MINIBOONE. The three settings “linear, constant, quadratic” follow the DDPM suggestion <cite class="ltx_citemacro_citep">[<bibref bibrefs="ho2020denoising" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase>, </bibrefphrase>
                                            </bibref>]</cite>. The mean and standard deviation are computed over three replicas of the trained model.
</text></caption>
                                      <inline-block align="center" depth="0.0pt" height="54.0pt" width="325.2pt" xscale="0.750388876270892" xtranslate="-54.1pt" yscale="0.750388876270892" ytranslate="9.0pt">
                                        <tabular vattach="middle">
                                          <tr>
                                            <td align="left" border="t">Noise scheduler \ <Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.T3.m3">
                                                <XMath>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMApp>
                                                      <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                                    </XMApp>
                                                    <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                  </XMApp>
                                                </XMath>
                                              </Math></td>
                                            <td align="center" border="t">1</td>
                                            <td align="center" border="t">5</td>
                                            <td align="center" border="t">10</td>
                                            <td align="center" border="t">15</td>
                                            <td align="center" border="t">20</td>
                                          </tr>
                                          <tr>
                                            <td align="left" border="t">Linear</td>
                                            <td align="center" border="t">24.51 (0.24)</td>
                                            <td align="center" border="t">18.73 (0.64)</td>
                                            <td align="center" border="t">20.28 (0.38)</td>
                                            <td align="center" border="t">26.76 (1.77)</td>
                                            <td align="center" border="t">26.83 (1.23)</td>
                                          </tr>
                                          <tr>
                                            <td align="left">Constant</td>
                                            <td align="center">25.47 (0.25)</td>
                                            <td align="center">30.37 (0.84)</td>
                                            <td align="center">37.73 (0.98)</td>
                                            <td align="center">40.47 (1.27)</td>
                                            <td align="center">45.32 (0.40)</td>
                                          </tr>
                                          <tr>
                                            <td align="left" border="b">Quadratic</td>
                                            <td align="center" border="b">27.19 (0.14)</td>
                                            <td align="center" border="b">17.45 (0.17)</td>
                                            <td align="center" border="b">18.48 (0.38)</td>
                                            <td align="center" border="b">18.90 (0.48)</td>
                                            <td align="center" border="b">21.35 (0.60)</td>
                                          </tr>
                                        </tabular>
                                      </inline-block>
                                    </table>
                                    <para align="center" class="ltx_noindent" xml:id="A3.SS2.SSS2.p5">
                                      <p><text font="italic">Additional results:</text>
For experiments under the fixed-budget setting,
Table <ref labelref="LABEL:tab_high_dim_appendix"/> shows the complete results of JKO-iFlow against competitors on tabular datasets.
In the extra lines in the table,
we show the result of JKO-iFlow with <Math mode="inline" tex="L=3" text="L = 3" xml:id="A3.SS2.SSS2.p5.m1">
                                          <XMath>
                                            <XMApp>
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                              <XMTok meaning="3" role="NUMBER">3</XMTok>
                                            </XMApp>
                                          </XMath>
                                        </Math> for POWER
and <Math mode="inline" tex="L=5" text="L = 5" xml:id="A3.SS2.SSS2.p5.m2">
                                          <XMath>
                                            <XMApp>
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                              <XMTok meaning="5" role="NUMBER">5</XMTok>
                                            </XMApp>
                                          </XMath>
                                        </Math> for GAS, as these numbers of <Math mode="inline" tex="L" text="L" xml:id="A3.SS2.SSS2.p5.m3">
                                          <XMath>
                                            <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                          </XMath>
                                        </Math> are determined by the termination criterion in Algorithm <ref labelref="LABEL:block_training"/>.
(The main lines show the results with <Math mode="inline" tex="L=4" text="L = 4" xml:id="A3.SS2.SSS2.p5.m4">
                                          <XMath>
                                            <XMApp>
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                              <XMTok meaning="4" role="NUMBER">4</XMTok>
                                            </XMApp>
                                          </XMath>
                                        </Math> so that our model has the same capacity as the alternatives.)
BSDS300 has an extra line for JKO-iFlow trained with batch sizes 5000,
which improves over the result with batch size 1000.
For ScoreSDE, we use the implementation in <cite class="ltx_citemacro_citep">[<bibref bibrefs="huang2021variational" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                            <bibrefphrase>, </bibrefphrase>
                                          </bibref>]</cite>, which, during training, maximizes the evidence lower bound (ELBO) as an equivalent objective to the score-matching loss.
Although ScoreSDE is the fastest, its performance, even under 100 times more mini-batch stochastic gradient descent steps than JKO-iFlow, is still worse than JKO-iFlow in terms of both MMD-m and NLL.</p>
                                    </para>
                                    <p align="center">To visualize the generative performance, scatter plots of the generated samples by JKO-iFlow and competitors on these tabular datasets are shown in Figure <ref labelref="LABEL:pca_projection"/> after projected to 2 dimensions (determined by principal components computed from true data test samples). The plots show a closer match between those from JKO-iFlow with the ground truth in distribution.
For experiments allowing more expensive models and longer training time, Table <ref labelref="LABEL:tab_high_dim_appendix_2"/> shows the results of JKO-iFlow after additional training of trajectory reparametrization
in comparison with other baselines cited from the original papers.
We run 7 reparameterization iterations on POWER, GAS, and MINIBOONE and 1 reparameterization iteration on BSDS300. A free block is used on POWER, GAS, and BSDS300.</p>
                                    <p align="center">To ensure a fair comparison against diffusion models, we perform additional experiments using different noise schedulers <Math mode="inline" tex="\beta(t)" text="beta * t" xml:id="A3.SS2.SSS2.m15">
                                        <XMath>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                            <XMDual>
                                              <XMRef idref="A3.SS2.SSS2.m15.1"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS2.m15.1">t</XMTok>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMath>
                                      </Math> and <Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.SS2.SSS2.m16">
                                        <XMath>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                            </XMApp>
                                            <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                          </XMApp>
                                        </XMath>
                                      </Math> in ScoreSDE on MINIBOONE, following the noise scheduler suggestions in DDPM <cite class="ltx_citemacro_citep">[<bibref bibrefs="ho2020denoising" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                          <bibrefphrase>, </bibrefphrase>
                                        </bibref>]</cite>. Note that DDPM can be viewed as a discrete-time version of the variance-preserving ScoreSDE model.
As shown in Table <ref labelref="LABEL:tab_noise_schedule"/>, the performance of ScoreSDE is indeed sensitive to the noise schedule. However, the best NLL of ScoreSDE 17.45 from the table is still noticeably higher than the NLL of 12.55 obtained by JKO-iFlow on MINIBOONE in Table <ref labelref="LABEL:tab_high_dim_appendix"/>, and JKO-iFlow is trained using ten times less number of batches.
<text color="#000000">To improve the performance of ScoreSDE on this example, we use ScoreSDE without restrictions on modeling and computation. Specifically, we consider a larger network following the setup in <cite class="ltx_citemacro_citep">[<bibref bibrefs="albergo2023building" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                            <bibrefphrase>, </bibrefphrase>
                                          </bibref>]</cite>, where the network has 4 hidden layers with 512 hidden nodes per layer and consists of 831K parameters in total. We then train this larger model for 100K batches using ScoreSDE with various noise schedulers, choosing noise schedulers that performed best based on results in Table <ref labelref="LABEL:tab_noise_schedule"/>. From the results reported in Table <ref labelref="LABEL:tab_fair_diffusion"/>, we see that the testing NLL by ScoreSDE can be as low as 10.47, which is among the state-of-the-art values reported in Table <ref labelref="LABEL:tab_high_dim_appendix_2"/>. Nevertheless, we want to highlight that the proposed JKO-iFlow can obtain competitive results (i.e., 10.55 in Table <ref labelref="LABEL:tab_high_dim_appendix_2"/>) with much smaller models: each JKO-iFlow block has only 2 hidden layers with 128 hidden nodes per layer, and we trained 4 blocks that contain 112K parameters in total. We also trained JKO-iFlow for only 2.72K batches, rather than the 100K batches we used for ScoreSDE.</text></p>
                                    <table align="center" inlist="lot" labels="LABEL:tab_fair_diffusion" placement="!t" xml:id="A3.T4">
                                      <tags>
                                        <tag><text fontsize="90%">Table A.4</text></tag>
                                        <tag role="autoref">Table A.4</tag>
                                        <tag role="refnum">A.4</tag>
                                        <tag role="typerefnum">Table A.4</tag>
                                      </tags>
                                      <toccaption class="ltx_centering"><tag close=" ">A.4</tag><text color="#000000">Testing NLL per noise scheduler and <Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.T4.m1">
                                            <XMath>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> combination of ScoreSDE on MINIBOONE, using a larger network with longer training. The table format is identical to that of Table <ref labelref="LABEL:tab_noise_schedule"/>.
</text></toccaption>
                                      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Table A.4</text></tag><text color="#000000" fontsize="90%">Testing NLL per noise scheduler and <Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.T4.m2">
                                            <XMath>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMApp>
                                                  <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                                </XMApp>
                                                <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> combination of ScoreSDE on MINIBOONE, using a larger network with longer training. The table format is identical to that of Table <ref labelref="LABEL:tab_noise_schedule"/>.
</text></caption>
                                      <inline-block align="center" depth="0.0pt" height="43.6pt" width="247.2pt" xscale="0.807571142110126" xtranslate="-29.4pt" yscale="0.807571142110126" ytranslate="5.2pt">
                                        <tabular vattach="middle">
                                          <tr>
                                            <td align="left" border="t"><text color="#000000">Noise scheduler \ </text><Math mode="inline" tex="\bar{\beta}_{\max}" text="(bar@(beta)) _ maximum" xml:id="A3.T4.m3">
                                                <XMath>
                                                  <XMApp color="#000000">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMApp>
                                                      <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                                    </XMApp>
                                                    <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                  </XMApp>
                                                </XMath>
                                              </Math></td>
                                            <td align="center" border="t"><text color="#000000">5</text></td>
                                            <td align="center" border="t"><text color="#000000">10</text></td>
                                            <td align="center" border="t"><text color="#000000">15</text></td>
                                          </tr>
                                          <tr>
                                            <td align="left" border="t"><text color="#000000">Linear</text></td>
                                            <td align="center" border="t"><text color="#000000">11.33 (0.44)</text></td>
                                            <td align="center" border="t"><text color="#000000">10.84 (1.17)</text></td>
                                            <td align="center" border="t"><text color="#000000">10.47 (0.13)</text></td>
                                          </tr>
                                          <tr>
                                            <td align="left" border="b"><text color="#000000">Quadratic</text></td>
                                            <td align="center" border="b"><text color="#000000">12.88 (0.40)</text></td>
                                            <td align="center" border="b"><text color="#000000">11.11 (0.24)</text></td>
                                            <td align="center" border="b"><text color="#000000">11.05 (0.49)</text></td>
                                          </tr>
                                        </tabular>
                                      </inline-block>
                                    </table>
<!--  %**** JKO˙arxiv˙v4.tex Line 1725 **** -->                                    <figure align="center" inlist="lof" labels="LABEL:pca_projection" placement="!t" xml:id="A3.F4">
                                      <tags>
                                        <tag><text fontsize="90%">Figure A.4</text></tag>
                                        <tag role="autoref">Figure A.4</tag>
                                        <tag role="refnum">A.4</tag>
                                        <tag role="typerefnum">Figure A.4</tag>
                                      </tags>
                                      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="145.3pt" xml:id="A3.F4.fig1">
                                        <graphics candidates="power_PCA_2D_compare.png" graphic="power_PCA_2D_compare.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g1"/>
                                        <toccaption><tag close=" ">a</tag>Power</toccaption>
                                        <caption><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">Power</text></caption>
                                      </figure>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="power_PCA_2D_compare_OTFlow.png" graphic="power_PCA_2D_compare_OTFlow.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g2"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="power_PCA_2D_compare_FFJORD.png" graphic="power_PCA_2D_compare_FFJORD.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g3"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="power_PCA_2D_compare_IGNN.png" graphic="power_PCA_2D_compare_IGNN.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g4"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="69.4pt">
                                        <graphics candidates="power_PCA_2D_compare_ScoreSDE.png" graphic="power_PCA_2D_compare_ScoreSDE.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g5"/>
                                      </block>
                                      <break class="ltx_break"/>
                                      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="147.4pt" xml:id="A3.F4.fig2">
                                        <graphics candidates="gas_PCA_2D_compare.png" graphic="gas_PCA_2D_compare.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g6"/>
                                        <toccaption><tag close=" ">b</tag>Gas</toccaption>
                                        <caption><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Gas</text></caption>
                                      </figure>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="gas_PCA_2D_compare_OTFlow.png" graphic="gas_PCA_2D_compare_OTFlow.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g7"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="69.4pt">
                                        <graphics candidates="gas_PCA_2D_compare_FFJORD.png" graphic="gas_PCA_2D_compare_FFJORD.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g8"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="69.4pt">
                                        <graphics candidates="gas_PCA_2D_compare_IGNN.png" graphic="gas_PCA_2D_compare_IGNN.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g9"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="gas_PCA_2D_compare_ScoreSDE.png" graphic="gas_PCA_2D_compare_ScoreSDE.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g10"/>
                                      </block>
                                      <break class="ltx_break"/>
                                      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="145.3pt" xml:id="A3.F4.fig3">
                                        <graphics candidates="miniboone_PCA_2D_compare.png" graphic="MINIBOONE_PCA_2D_compare.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g11"/>
                                        <toccaption><tag close=" ">c</tag>MINIBOONE</toccaption>
                                        <caption><tag close=" "><text fontsize="90%">c</text></tag><text fontsize="90%">MINIBOONE</text></caption>
                                      </figure>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="69.4pt">
                                        <graphics candidates="miniboone_PCA_2D_compare_OTFlow.png" graphic="MINIBOONE_PCA_2D_compare_OTFlow.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g12"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="miniboone_PCA_2D_compare_FFJORD.png" graphic="MINIBOONE_PCA_2D_compare_FFJORD.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g13"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="69.4pt">
                                        <graphics candidates="miniboone_PCA_2D_compare_IResNet.png" graphic="MINIBOONE_PCA_2D_compare_IResNet.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g14"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="miniboone_PCA_2D_compare_ScoreSDE.png" graphic="MINIBOONE_PCA_2D_compare_ScoreSDE.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g15"/>
                                      </block>
                                      <break class="ltx_break"/>
                                      <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="140.9pt" xml:id="A3.F4.fig4">
                                        <graphics candidates="bsds300_PCA_2D_compare.png" graphic="bsds300_PCA_2D_compare.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g16"/>
                                        <toccaption><tag close=" ">d</tag>BSDS300</toccaption>
                                        <caption><tag close=" "><text fontsize="90%">d</text></tag><text fontsize="90%">BSDS300</text></caption>
                                      </figure>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="bsds300_PCA_2D_compare_OTFlow.png" graphic="bsds300_PCA_2D_compare_OTFlow.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g17"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="65.0pt">
                                        <graphics candidates="bsds300_PCA_2D_compare_FFJORD.png" graphic="bsds300_PCA_2D_compare_FFJORD.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g18"/>
                                      </block>
                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="65.0pt">
                                        <graphics candidates="bsds300_PCA_2D_compare_IGNN.png" graphic="bsds300_PCA_2D_compare_IGNN.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g19"/>
                                      </block>
<!--  %**** JKO˙arxiv˙v4.tex Line 1800 **** -->                                      <block align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="67.2pt">
                                        <graphics candidates="bsds300_PCA_2D_compare_ScoreSDE.png" graphic="bsds300_PCA_2D_compare_ScoreSDE.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F4.g20"/>
                                      </block>
                                      <toccaption class="ltx_centering"><tag close=" ">A.4</tag>Generative quality on tabular datasets via PCA projection of generated samples. The generative quality in general aligns with the quantitative metrics in Table <ref labelref="LABEL:tab_high_dim"/> and <ref labelref="LABEL:tab_high_dim_appendix"/>.</toccaption>
                                      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure A.4</text></tag><text fontsize="90%">Generative quality on tabular datasets via PCA projection of generated samples. The generative quality in general aligns with the quantitative metrics in Table <ref labelref="LABEL:tab_high_dim"/> and <ref labelref="LABEL:tab_high_dim_appendix"/>.</text></caption>
                                    </figure>
                                    <subsubsection class="ltx_centering" inlist="toc" xml:id="A3.SS2.SSS3">
                                      <tags>
                                        <tag>C.2.3</tag>
                                        <tag role="autoref">subsubsection C.2.3</tag>
                                        <tag role="refnum">C.2.3</tag>
                                        <tag role="typerefnum">§C.2.3</tag>
                                      </tags>
                                      <title color="#000000"><tag close=" ">C.2.3</tag>Image generation with pre-trained variational auto-encoder</title>
                                      <para xml:id="A3.SS2.SSS3.p1">
                                        <p><text color="#000000">We perform image generation on MNIST </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="deng2012mnist" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000">, CIFAR10 </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="krizhevsky2009learning" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000">, and Imagenet-32 </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="deng2009imagenet" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000"> datasets. We do so in the latent space of a pre-trained VAE, where we discuss the details below.</text></p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS3.p2">
                                        <p><text color="#000000" font="italic">VAE as data pre-processing:</text><text color="#000000">
We train deep VAEs in an adversarial manner following </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="esser2021taming" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000">, and use pre-trained VAEs to pre-process the input images </text><Math mode="inline" tex="X" text="X" xml:id="A3.SS2.SSS3.p2.m1">
                                            <XMath>
                                              <XMTok color="#000000" font="italic" role="UNKNOWN">X</XMTok>
                                            </XMath>
                                          </Math><text color="#000000">. Specifically, the encoder </text><Math mode="inline" tex="\mathcal{E}:X\rightarrow(\mu(X),\Sigma(X))" text="E colon X rightarrow open-interval@(mu * X, Sigma * X)" xml:id="A3.SS2.SSS3.p2.m2">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                                <XMTok font="caligraphic" role="UNKNOWN">E</XMTok>
                                                <XMApp>
                                                  <XMTok name="rightarrow" role="ARROW">→</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="open-interval"/>
                                                      <XMRef idref="A3.SS2.SSS3.p2.m2.3"/>
                                                      <XMRef idref="A3.SS2.SSS3.p2.m2.4"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A3.SS2.SSS3.p2.m2.3">
                                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A3.SS2.SSS3.p2.m2.1"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS3.p2.m2.1">X</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="A3.SS2.SSS3.p2.m2.4">
                                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A3.SS2.SSS3.p2.m2.2"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS3.p2.m2.2">X</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> of the VAE maps a RGB-image </text><Math mode="inline" tex="X" text="X" xml:id="A3.SS2.SSS3.p2.m3">
                                            <XMath>
                                              <XMTok color="#000000" font="italic" role="UNKNOWN">X</XMTok>
                                            </XMath>
                                          </Math><text color="#000000"> to parameters of a multivariate Gaussian distribution </text><Math mode="inline" tex="\mathcal{N}(\mu(X),\Sigma(X))" text="N * open-interval@(mu * X, Sigma * X)" xml:id="A3.SS2.SSS3.p2.m4">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="open-interval"/>
                                                    <XMRef idref="A3.SS2.SSS3.p2.m4.3"/>
                                                    <XMRef idref="A3.SS2.SSS3.p2.m4.4"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A3.SS2.SSS3.p2.m4.3">
                                                      <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A3.SS2.SSS3.p2.m4.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS3.p2.m4.1">X</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMApp xml:id="A3.SS2.SSS3.p2.m4.4">
                                                      <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A3.SS2.SSS3.p2.m4.2"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS3.p2.m4.2">X</XMTok>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> in a lower dimension </text><Math mode="inline" tex="\tilde{d}" text="tilde@(d)" xml:id="A3.SS2.SSS3.p2.m5">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000">. Then, given any random latent code </text><Math mode="inline" tex="\tilde{X}\sim\mathcal{N}(\mu(X),\Sigma(X))" text="tilde@(X) similar-to N * open-interval@(mu * X, Sigma * X)" xml:id="A3.SS2.SSS3.p2.m6">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                                <XMApp>
                                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="open-interval"/>
                                                      <XMRef idref="A3.SS2.SSS3.p2.m6.3"/>
                                                      <XMRef idref="A3.SS2.SSS3.p2.m6.4"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMApp xml:id="A3.SS2.SSS3.p2.m6.3">
                                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A3.SS2.SSS3.p2.m6.1"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS3.p2.m6.1">X</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="A3.SS2.SSS3.p2.m6.4">
                                                        <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                        <XMTok name="Sigma" role="UNKNOWN">Σ</XMTok>
                                                        <XMDual>
                                                          <XMRef idref="A3.SS2.SSS3.p2.m6.2"/>
                                                          <XMWrap>
                                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS3.p2.m6.2">X</XMTok>
                                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                          </XMWrap>
                                                        </XMDual>
                                                      </XMApp>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000">, the decoder </text><Math mode="inline" tex="\mathcal{D}:\tilde{X}\rightarrow\hat{X}" text="D colon tilde@(X) rightarrow hat@(X)" xml:id="A3.SS2.SSS3.p2.m7">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok name="colon" role="METARELOP">:</XMTok>
                                                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                                <XMApp>
                                                  <XMTok name="rightarrow" role="ARROW">→</XMTok>
                                                  <XMApp>
                                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> of the VAE is trained so that </text><Math mode="inline" tex="X\approx\hat{X}" text="X approximately-equals hat@(X)" xml:id="A3.SS2.SSS3.p2.m8">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                <XMApp>
                                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> for the reconstructed image </text><Math mode="inline" tex="\hat{X}=\mathcal{D}(\tilde{X})." text="hat@(X) = D * tilde@(X)" xml:id="A3.SS2.SSS3.p2.m9">
                                            <XMath>
                                              <XMDual>
                                                <XMRef idref="A3.SS2.SSS3.p2.m9.2"/>
                                                <XMWrap>
                                                  <XMApp color="#000000" xml:id="A3.SS2.SSS3.p2.m9.2">
                                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                    <XMApp>
                                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok color="#000000" meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A3.SS2.SSS3.p2.m9.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMApp xml:id="A3.SS2.SSS3.p2.m9.1">
                                                            <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                          </XMApp>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok color="#000000" role="PERIOD">.</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMath>
                                          </Math><text color="#000000"> On MNIST, we let the latent-space dimension </text><Math mode="inline" tex="\tilde{d}=20" text="tilde@(d) = 20" xml:id="A3.SS2.SSS3.p2.m10">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMApp>
                                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                </XMApp>
                                                <XMTok meaning="20" role="NUMBER">20</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000">, and on CIFAR10 and ImageNet32, we let the latent-space dimension </text><Math mode="inline" tex="\tilde{d}=192" text="tilde@(d) = 192" xml:id="A3.SS2.SSS3.p2.m11">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMApp>
                                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                                </XMApp>
                                                <XMTok meaning="192" role="NUMBER">192</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000">. There are 5.6M parameters in the VAE encoder and 8.25M parameters in the VAE decoder.
Given a trained VAE, we then train the JKO-iFlow model </text><Math mode="inline" tex="T_{\theta}" text="T _ theta" xml:id="A3.SS2.SSS3.p2.m12">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> to transport invertibly between the distribution of random latent codes </text><Math mode="inline" tex="\tilde{X}" text="tilde@(X)" xml:id="A3.SS2.SSS3.p2.m13">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> defined over all training images </text><Math mode="inline" tex="X" text="X" xml:id="A3.SS2.SSS3.p2.m14">
                                            <XMath>
                                              <XMTok color="#000000" font="italic" role="UNKNOWN">X</XMTok>
                                            </XMath>
                                          </Math><text color="#000000"> and the standard multivariate Gaussian distribution in </text><Math mode="inline" tex="\mathbb{R}^{\tilde{d}}" text="R ^ (tilde@(d))" xml:id="A3.SS2.SSS3.p2.m15">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                                                <XMApp>
                                                  <XMTok fontsize="70%" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000">.</text></p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS3.p3">
                                        <p><text color="#000000" font="italic">Training and test data:</text><text color="#000000"> Training data: 60K images in MNIST, 50K images in CIFAR10, and 1.28M images in Imagenet-32. Test data: 10K images in MNIST and CIFAR10, and 50K images in Imagenet-32.</text></p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS3.p4">
                                        <p><text color="#000000" font="italic">Choice of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A3.SS2.SSS3.p4.m1">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok role="UNKNOWN">h</XMTok>
                                                  <XMTok fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math>:</text><text color="#000000">
on MNIST, we specify </text><Math mode="inline" tex="\{h_{0}=1,\rho=1,h_{\max}=1\}" text="set@(formulae@(h _ 0 = 1, formulae@(rho = 1, h _ maximum = 1)))" xml:id="A3.SS2.SSS3.p4.m2">
                                            <XMath>
                                              <XMDual>
                                                <XMApp color="#000000">
                                                  <XMTok meaning="set"/>
                                                  <XMRef idref="A3.SS2.SSS3.p4.m2.1"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok color="#000000" role="OPEN" stretchy="false">{</XMTok>
                                                  <XMDual xml:id="A3.SS2.SSS3.p4.m2.1">
                                                    <XMApp color="#000000">
                                                      <XMTok meaning="formulae"/>
                                                      <XMRef idref="A3.SS2.SSS3.p4.m2.1.1"/>
                                                      <XMRef idref="A3.SS2.SSS3.p4.m2.1.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m2.1.1">
                                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                        <XMApp>
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                                        </XMApp>
                                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                      <XMTok color="#000000" role="PUNCT">,</XMTok>
                                                      <XMDual xml:id="A3.SS2.SSS3.p4.m2.1.2">
                                                        <XMApp color="#000000">
                                                          <XMTok meaning="formulae"/>
                                                          <XMRef idref="A3.SS2.SSS3.p4.m2.1.2.1"/>
                                                          <XMRef idref="A3.SS2.SSS3.p4.m2.1.2.2"/>
                                                        </XMApp>
                                                        <XMWrap>
                                                          <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m2.1.2.1">
                                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                          </XMApp>
                                                          <XMTok color="#000000" role="PUNCT">,</XMTok>
                                                          <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m2.1.2.2">
                                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                              <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                            </XMApp>
                                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                          </XMApp>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMTok color="#000000" role="CLOSE" stretchy="false">}</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMath>
                                          </Math><text color="#000000">.
on CIFAR10, we specify </text><Math mode="inline" tex="\{h_{0}=1,\rho=1,h_{\max}=1\}" text="set@(formulae@(h _ 0 = 1, formulae@(rho = 1, h _ maximum = 1)))" xml:id="A3.SS2.SSS3.p4.m3">
                                            <XMath>
                                              <XMDual>
                                                <XMApp color="#000000">
                                                  <XMTok meaning="set"/>
                                                  <XMRef idref="A3.SS2.SSS3.p4.m3.1"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok color="#000000" role="OPEN" stretchy="false">{</XMTok>
                                                  <XMDual xml:id="A3.SS2.SSS3.p4.m3.1">
                                                    <XMApp color="#000000">
                                                      <XMTok meaning="formulae"/>
                                                      <XMRef idref="A3.SS2.SSS3.p4.m3.1.1"/>
                                                      <XMRef idref="A3.SS2.SSS3.p4.m3.1.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m3.1.1">
                                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                        <XMApp>
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                                        </XMApp>
                                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                      <XMTok color="#000000" role="PUNCT">,</XMTok>
                                                      <XMDual xml:id="A3.SS2.SSS3.p4.m3.1.2">
                                                        <XMApp color="#000000">
                                                          <XMTok meaning="formulae"/>
                                                          <XMRef idref="A3.SS2.SSS3.p4.m3.1.2.1"/>
                                                          <XMRef idref="A3.SS2.SSS3.p4.m3.1.2.2"/>
                                                        </XMApp>
                                                        <XMWrap>
                                                          <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m3.1.2.1">
                                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                          </XMApp>
                                                          <XMTok color="#000000" role="PUNCT">,</XMTok>
                                                          <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m3.1.2.2">
                                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                              <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                            </XMApp>
                                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                          </XMApp>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMTok color="#000000" role="CLOSE" stretchy="false">}</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMath>
                                          </Math><text color="#000000">.
On Imagenet-32, we specify </text><Math mode="inline" tex="\{h_{0}=1,\rho=1.1,h_{\max}=\infty\}" text="set@(formulae@(h _ 0 = 1, formulae@(rho = 1.1, h _ maximum = infinity)))" xml:id="A3.SS2.SSS3.p4.m4">
                                            <XMath>
                                              <XMDual>
                                                <XMApp color="#000000">
                                                  <XMTok meaning="set"/>
                                                  <XMRef idref="A3.SS2.SSS3.p4.m4.1"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok color="#000000" role="OPEN" stretchy="false">{</XMTok>
                                                  <XMDual xml:id="A3.SS2.SSS3.p4.m4.1">
                                                    <XMApp color="#000000">
                                                      <XMTok meaning="formulae"/>
                                                      <XMRef idref="A3.SS2.SSS3.p4.m4.1.1"/>
                                                      <XMRef idref="A3.SS2.SSS3.p4.m4.1.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m4.1.1">
                                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                        <XMApp>
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                                        </XMApp>
                                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                      <XMTok color="#000000" role="PUNCT">,</XMTok>
                                                      <XMDual xml:id="A3.SS2.SSS3.p4.m4.1.2">
                                                        <XMApp color="#000000">
                                                          <XMTok meaning="formulae"/>
                                                          <XMRef idref="A3.SS2.SSS3.p4.m4.1.2.1"/>
                                                          <XMRef idref="A3.SS2.SSS3.p4.m4.1.2.2"/>
                                                        </XMApp>
                                                        <XMWrap>
                                                          <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m4.1.2.1">
                                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                            <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                            <XMTok meaning="1.1" role="NUMBER">1.1</XMTok>
                                                          </XMApp>
                                                          <XMTok color="#000000" role="PUNCT">,</XMTok>
                                                          <XMApp color="#000000" xml:id="A3.SS2.SSS3.p4.m4.1.2.2">
                                                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                            <XMApp>
                                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                              <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                            </XMApp>
                                                            <XMTok meaning="infinity" name="infty" role="ID">∞</XMTok>
                                                          </XMApp>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMWrap>
                                                  </XMDual>
                                                  <XMTok color="#000000" role="CLOSE" stretchy="false">}</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMath>
                                          </Math><text color="#000000">.
We train </text><Math mode="inline" tex="L=6" text="L = 6" xml:id="A3.SS2.SSS3.p4.m5">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                                <XMTok meaning="6" role="NUMBER">6</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> blocks on MNIST, and we train </text><Math mode="inline" tex="L=8" text="L = 8" xml:id="A3.SS2.SSS3.p4.m6">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                                                <XMTok meaning="8" role="NUMBER">8</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> blocks on CIFAR10 and Imagenet-32. On CIFAR10 and Imagenet-32, we also scale </text><Math mode="inline" tex="h_{k}=T\cdot h_{k}/\sum_{j}h_{j}" text="h _ k = (T cdot h _ k) / (sum _ j)@(h _ j)" xml:id="A3.SS2.SSS3.p4.m7">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                                                  <XMApp>
                                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> so </text><Math mode="inline" tex="\sum_{k}h_{k}=T" text="(sum _ k)@(h _ k) = T" xml:id="A3.SS2.SSS3.p4.m8">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000">. We let </text><Math mode="inline" tex="T=0.8" text="T = 0.8" xml:id="A3.SS2.SSS3.p4.m9">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                <XMTok meaning="0.8" role="NUMBER">0.8</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> on CIFAR10 and </text><Math mode="inline" tex="T=0.4" text="T = 0.4" xml:id="A3.SS2.SSS3.p4.m10">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                                <XMTok meaning="0.4" role="NUMBER">0.4</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> on Imagenet-32.</text></p>
                                      </para>
                                      <figure inlist="lof" labels="LABEL:fig:img_uncurated" placement="!t" xml:id="A3.F5">
                                        <tags>
                                          <tag><text fontsize="90%">Figure A.5</text></tag>
                                          <tag role="autoref">Figure A.5</tag>
                                          <tag role="refnum">A.5</tag>
                                          <tag role="typerefnum">Figure A.5</tag>
                                        </tags>
                                        <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="433.6pt" xml:id="A3.F5.fig1">
                                          <graphics candidates="CIFAR10_uncurated.png" graphic="CIFAR10_uncurated.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F5.g1"/>
                                          <toccaption><tag close=" "><text color="#000000">a</text></tag><text color="#000000">Generated CIFAR10 images</text></toccaption>
                                          <caption color="#000000"><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">Generated CIFAR10 images</text></caption>
                                        </figure>
                                        <break class="ltx_break"/>
                                        <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="middle" width="433.6pt" xml:id="A3.F5.fig2">
                                          <graphics candidates="ImageNet_uncurated.png" graphic="ImageNet_uncurated.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F5.g2"/>
                                          <toccaption><tag close=" "><text color="#000000">b</text></tag><text color="#000000">Generated Imagenet-32 images</text></toccaption>
                                          <caption color="#000000"><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Generated Imagenet-32 images</text></caption>
                                        </figure>
                                        <toccaption class="ltx_centering"><tag close=" "><text color="#000000">A.5</text></tag><text color="#000000">Uncurated generated samples of CIFAR10 and Imagenet-32 by JKO-iFlow in latent space.</text></toccaption>
                                        <caption class="ltx_centering" color="#000000"><tag close=": "><text fontsize="90%">Figure A.5</text></tag><text fontsize="90%">Uncurated generated samples of CIFAR10 and Imagenet-32 by JKO-iFlow in latent space.</text></caption>
                                      </figure>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS3.p5">
<!--  %**** JKO˙arxiv˙v4.tex Line 1850 **** -->                                        <p><text color="#000000" font="italic">Network architecture:</text><text color="#000000">
We use the softplus activation with </text><Math mode="inline" tex="\beta=20" text="beta = 20" xml:id="A3.SS2.SSS3.p5.m1">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                                <XMTok meaning="20" role="NUMBER">20</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> for all hidden layers.
On MNIST, we use fully connected residual blocks with three hidden layers at 256 hidden nodes.
On CIFAR10 and Imagenet-32, we parametrize each </text><Math mode="inline" tex="{\bf f}_{\theta_{b}}" text="f _ theta _ b" xml:id="A3.SS2.SSS3.p5.m2">
                                            <XMath>
                                              <XMApp color="#000000">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="bold" role="UNKNOWN">f</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">b</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math><text color="#000000"> as a concatenation of convolution layers and transposed convolution layers. Specifically:</text></p>
                                        <itemize xml:id="A3.I5">
                                          <item xml:id="A3.I5.i1">
                                            <tags>
                                              <tag>•</tag>
                                              <tag role="autoref">item </tag>
                                              <tag role="typerefnum">1st item</tag>
                                            </tags>
                                            <para xml:id="A3.I5.i1.p1">
                                              <p><text color="#000000">CIFAR10: convolution layers have channels </text><text color="#000000" font="typewriter">3-64-128-256-256</text><text color="#000000"> with kernel size 3 and strides </text><text color="#000000" font="typewriter">1-1-2-1</text><text color="#000000">. Transposed convolution layers have channels </text><text color="#000000" font="typewriter">256-256-128-64-3</text><text color="#000000"> with kernel size </text><text color="#000000" font="typewriter">3-4-3-3</text><text color="#000000"> and strides </text><text color="#000000" font="typewriter">1-2-1-1</text><text color="#000000">. Total 2.1M parameters.</text></p>
                                            </para>
                                          </item>
                                          <item xml:id="A3.I5.i2">
                                            <tags>
                                              <tag>•</tag>
                                              <tag role="autoref">item </tag>
                                              <tag role="typerefnum">2nd item</tag>
                                            </tags>
                                            <para xml:id="A3.I5.i2.p1">
                                              <p><text color="#000000">Imagenet-32: convolution layers have channels </text><text color="#000000" font="typewriter">3-64-128-256-512</text><text color="#000000"> with kernel size 3 and strides </text><text color="#000000" font="typewriter">1-1-2-1</text><text color="#000000">. Transposed convolution layers have channels </text><text color="#000000" font="typewriter">512-256-128-64-3</text><text color="#000000"> with kernel size </text><text color="#000000" font="typewriter">3-4-3-3</text><text color="#000000"> and strides </text><text color="#000000" font="typewriter">1-2-1-1</text><text color="#000000">. Total 3.3M parameters.</text></p>
                                            </para>
                                          </item>
                                        </itemize>
                                        <p><text color="#000000">We remark that because inputs into the JKO-iFlow blocks are latent-space codes that have much lower dimensions than the original image, our JKO-iFlow blocks are simpler and lighter in design than models in previous NeuralODE </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="FFJORD,finlay2020train" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000"> and diffusion model works </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="ho2020denoising,song2021score,boffi2023probability" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000">. For instance, the DDPM model </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="ho2020denoising" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000"> on CIFAR10 has 35.7M parameters with more sophisticated model designs.</text></p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS3.p6">
                                        <p><text color="#000000" font="italic">Training specifics:</text><text color="#000000">
On MNIST, we fix the batch size to be 2000 during training, and we train 15K batches per JKO-iFlow block. We fix the learning rate to be 1e-3.</text></p>
                                      </para>
                                      <para xml:id="A3.SS2.SSS3.p7">
                                        <p><text color="#000000">On CIFAR10 and Imagenet-32, we fix the batch size to be 512 during training, and we train 75K batches per JKO-iFlow block. The time per batch is 0.18 seconds on Imagenet-32 and 0.15 seconds on CIFA10. The total time on Imagenet-32 is 30 hours and on CIFAR10 is 24 hours.
When training the blocks, the initial learning rate </text><text class="ltx_markedasmath" color="#000000" font="typewriter">lr0</text><text color="#000000"> is decreased by a constant factor of 0.9 every 2500 batches. We let </text><text class="ltx_markedasmath" color="#000000" font="typewriter">lr0</text><text color="#000000"> be 1e-3 when training the first 5 blocks on Imagenet-32 and decrease it to be 8e-4 on blocks 6-8. We let </text><text class="ltx_markedasmath" color="#000000" font="typewriter">lr0</text><text color="#000000"> be 1e-3 when training the first 2 blocks on CIFAR10 and decrease it to be 7.5e-4 on the rest 6 blocks. Additionally, we use gradient clipping of max norm 1 after collecting gradients on each mini-batch.</text></p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS3.p8">
                                        <p><text color="#000000" font="italic">Additional results:</text><text color="#000000"> We perform the following steps to curate generated samples for CIFAR10 and Imagenet-32, which are shown in Figure </text><ref color="#000000" labelref="LABEL:fig:mnist-cifar-imagenet"/><!--  %**** JKO˙arxiv˙v4.tex Line 1875 **** --><text color="#000000">,
we first train an image classifier (i.e., VGG-16 </text><cite class="ltx_citemacro_citep"><text color="#000000">[</text><bibref bibrefs="Simonyan15" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase><text color="#000000">, </text></bibrefphrase>
                                            </bibref><text color="#000000">]</text></cite><text color="#000000">) on the training data.
Then, we generate a large number of uncurated images (200K for Imagenet-32 and 20K for CIFAR10), classify them using the pre-trained classifier, and sort them based on top-1 predicted probability.
Upon sorting the top 20K images for Imagenet-32 and the top 750 images for CIFAR10, we manually select the images that most resemble the given predicted class.
Figure </text><ref color="#000000" labelref="LABEL:fig:img_uncurated"/><text color="#000000"> further shows uncurated images on CIFAR10 and Imagenet-32 by the same JKO-iFlow model after training.</text></p>
                                      </para>
                                    </subsubsection>
                                    <subsubsection class="ltx_centering" inlist="toc" labels="LABEL:append_cond_gen" xml:id="A3.SS2.SSS4">
                                      <tags>
                                        <tag>C.2.4</tag>
                                        <tag role="autoref">subsubsection C.2.4</tag>
                                        <tag role="refnum">C.2.4</tag>
                                        <tag role="typerefnum">§C.2.4</tag>
                                      </tags>
                                      <title><tag close=" ">C.2.4</tag>Conditional generation</title>
                                      <figure inlist="lof" labels="LABEL:circle LABEL:fig_2d_full_data_append LABEL:fig_cond_gen_toy" placement="!t" xml:id="A3.F6">
                                        <tags>
                                          <tag><text fontsize="90%">Figure A.6</text></tag>
                                          <tag role="autoref">Figure A.6</tag>
                                          <tag role="refnum">A.6</tag>
                                          <tag role="typerefnum">Figure A.6</tag>
                                        </tags>
                                        <figure class="ltx_figure_panel ltx_minipage" vattach="middle" width="151.8pt" xml:id="A3.F6.fig1">
                                          <graphics candidates="_true_vs_gen.png" graphic="_true_vs_gen.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F6.g1"/>
                                          <toccaption class="ltx_centering"><tag close=" ">a</tag>Two-circles data (unconditional)</toccaption>
                                          <caption class="ltx_centering"><tag close=" "><text fontsize="90%">a</text></tag><text fontsize="90%">Two-circles data (unconditional)</text></caption>
                                        </figure>
                                        <figure class="ltx_figure_panel ltx_minipage" vattach="middle" width="273.2pt" xml:id="A3.F6.fig2">
                                          <graphics candidates="two_moon_true_vs_gen.png" graphic="two_moon_true_vs_gen.png" options="width=433.62pt,keepaspectratio=true" xml:id="A3.F6.g2"/>
                                          <toccaption class="ltx_centering"><tag close=" ">b</tag>Two-moons data (conditional)</toccaption>
                                          <caption class="ltx_centering"><tag close=" "><text fontsize="90%">b</text></tag><text fontsize="90%">Two-moons data (conditional)</text></caption>
                                        </figure>
                                        <toccaption><tag close=" ">A.6</tag>
Unconditional and conditional generation on simulated toy datasets by JKO-iFlow. We color samples in (b) by the class label <Math mode="inline" tex="Y" text="Y" xml:id="A3.F6.m1">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                            </XMath>
                                          </Math>, taking binary values.
In both (a) and (b), the generated samples are close to the true samples in distribution.
In (b), the pushforward distribution by JKO-iFlow, denoted as <Math mode="inline" tex="\hat{H}|Y" text="conditional@(hat@(H), Y)" xml:id="A3.F6.m2">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                <XMApp>
                                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                                </XMApp>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math>, is also close to the target Gaussian mixture distribution <Math mode="inline" tex="H|Y" text="conditional@(H, Y)" xml:id="A3.F6.m3">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math>.
</toccaption>
                                        <caption><tag close=": "><text fontsize="90%">Figure A.6</text></tag><text fontsize="90%">
Unconditional and conditional generation on simulated toy datasets by JKO-iFlow. We color samples in (b) by the class label <Math mode="inline" tex="Y" text="Y" xml:id="A3.F6.m4">
                                              <XMath>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMath>
                                            </Math>, taking binary values.
In both (a) and (b), the generated samples are close to the true samples in distribution.
In (b), the pushforward distribution by JKO-iFlow, denoted as <Math mode="inline" tex="\hat{H}|Y" text="conditional@(hat@(H), Y)" xml:id="A3.F6.m5">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMApp>
                                                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                                  </XMApp>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math>, is also close to the target Gaussian mixture distribution <Math mode="inline" tex="H|Y" text="conditional@(H, Y)" xml:id="A3.F6.m6">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math>.
</text></caption>
                                      </figure>
                                      <para xml:id="A3.SS2.SSS4.p1">
                                        <p>To modify the JKO-iFlow to apply to the conditional generation task,
we follow the framework in <cite class="ltx_citemacro_cite"><bibref bibrefs="xu2022invertible" separator="," show="Authors Phrase1YearPhrase2" yyseparator=",">
                                              <bibrefphrase>[</bibrefphrase>
                                              <bibrefphrase>]</bibrefphrase>
                                            </bibref></cite>,
which trains a single flow mapping from <Math mode="inline" tex="X" text="X" xml:id="A3.SS2.SSS4.p1.m1">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                            </XMath>
                                          </Math> to <Math mode="inline" tex="H" text="H" xml:id="A3.SS2.SSS4.p1.m2">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                            </XMath>
                                          </Math> that pushes to match each component of the distribution associated with a distinct output label value <Math mode="inline" tex="Y=k" text="Y = k" xml:id="A3.SS2.SSS4.p1.m3">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math>, <Math mode="inline" tex="k=1,\cdots,K" text="k = list@(1, cdots, K)" xml:id="A3.SS2.SSS4.p1.m4">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                                <XMDual>
                                                  <XMApp>
                                                    <XMTok meaning="list"/>
                                                    <XMRef idref="A3.SS2.SSS4.p1.m4.1"/>
                                                    <XMRef idref="A3.SS2.SSS4.p1.m4.2"/>
                                                    <XMRef idref="A3.SS2.SSS4.p1.m4.3"/>
                                                  </XMApp>
                                                  <XMWrap>
                                                    <XMTok meaning="1" role="NUMBER" xml:id="A3.SS2.SSS4.p1.m4.1">1</XMTok>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok name="cdots" role="ID" xml:id="A3.SS2.SSS4.p1.m4.2">⋯</XMTok>
                                                    <XMTok role="PUNCT">,</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS4.p1.m4.3">K</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math>.
Specifically, for a data-label pair <Math mode="inline" tex="\{X_{i},Y_{i}\}" text="set@(X _ i, Y _ i)" xml:id="A3.SS2.SSS4.p1.m5">
                                            <XMath>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="set"/>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m5.1"/>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m5.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                                                  <XMApp xml:id="A3.SS2.SSS4.p1.m5.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A3.SS2.SSS4.p1.m5.2">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMath>
                                          </Math>, consider the continuous ODE trajectory <Math mode="inline" tex="x(t)" text="x * t" xml:id="A3.SS2.SSS4.p1.m6">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m6.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.SS2.SSS4.p1.m6.1">t</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math> starting from <Math mode="inline" tex="x(0)=X_{i}" text="x * 0 = X _ i" xml:id="A3.SS2.SSS4.p1.m7">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                  <XMDual>
                                                    <XMRef idref="A3.SS2.SSS4.p1.m7.1"/>
                                                    <XMWrap>
                                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                      <XMTok meaning="0" role="NUMBER" xml:id="A3.SS2.SSS4.p1.m7.1">0</XMTok>
                                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMath>
                                          </Math>, the per-sample training objective is by changing the term <Math mode="inline" tex="V(x(t_{k+1}))" text="V * x * t _ (k + 1)" xml:id="A3.SS2.SSS4.p1.m8">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                                <XMDual>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m8.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A3.SS2.SSS4.p1.m8.1">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A3.SS2.SSS4.p1.m8.1.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMApp xml:id="A3.SS2.SSS4.p1.m8.1.1">
                                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                            <XMApp>
                                                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                            </XMApp>
                                                          </XMApp>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math> in (<ref labelref="LABEL:eq:loss-block-k"/>) to be <Math mode="inline" tex="V_{Y_{i}}(x(t_{k+1}))" text="V _ Y _ i * x * t _ (k + 1)" xml:id="A3.SS2.SSS4.p1.m9">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">Y</XMTok>
                                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m9.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMApp xml:id="A3.SS2.SSS4.p1.m9.1">
                                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                                                      <XMDual>
                                                        <XMRef idref="A3.SS2.SSS4.p1.m9.1.1"/>
                                                        <XMWrap>
                                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                          <XMApp xml:id="A3.SS2.SSS4.p1.m9.1.1">
                                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                                                            <XMApp>
                                                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                            </XMApp>
                                                          </XMApp>
                                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                        </XMWrap>
                                                      </XMDual>
                                                    </XMApp>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math>, where <Math mode="inline" tex="V_{k}(\cdot)" text="V _ k * cdot" xml:id="A3.SS2.SSS4.p1.m10">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m10.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok name="cdot" role="MULOP" xml:id="A3.SS2.SSS4.p1.m10.1">⋅</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math> is the potential of the Gaussian mixture component <Math mode="inline" tex="H|Y=k" text="conditional@(H, Y) = k" xml:id="A3.SS2.SSS4.p1.m11">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math>. Because the Gaussian mixture is parameterized by mean vectors (the covariance is isotropic with fixed variance) <cite class="ltx_citemacro_citep">[<bibref bibrefs="xu2022invertible" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                              <bibrefphrase>, </bibrefphrase>
                                            </bibref>]</cite>, the expression of <Math mode="inline" tex="V_{k}(\cdot)" text="V _ k * cdot" xml:id="A3.SS2.SSS4.p1.m12">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                                <XMDual>
                                                  <XMRef idref="A3.SS2.SSS4.p1.m12.1"/>
                                                  <XMWrap>
                                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                    <XMTok name="cdot" role="MULOP" xml:id="A3.SS2.SSS4.p1.m12.1">⋅</XMTok>
                                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                            </XMath>
                                          </Math> is a quadratic function with explicit expression.</p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS4.p2">
                                        <p><text font="italic">Training and test data: </text></p>
                                        <itemize xml:id="A3.I6">
                                          <item xml:id="A3.I6.i1">
                                            <tags>
                                              <tag>•</tag>
                                              <tag role="autoref">item </tag>
                                              <tag role="typerefnum">1st item</tag>
                                            </tags>
                                            <para xml:id="A3.I6.i1.p1">
                                              <p>For the simulated two-moon data, we re-sample 5K training samples every epoch, for a total of 40 epochs per block. The batch size is 1000.</p>
                                            </para>
                                          </item>
                                          <item xml:id="A3.I6.i2">
                                            <tags>
                                              <tag>•</tag>
                                              <tag role="autoref">item </tag>
                                              <tag role="typerefnum">2nd item</tag>
                                            </tags>
                                            <para xml:id="A3.I6.i2.p1">
                                              <p>The solar dataset is retrieved from the National Solar Radiation Database (NSRDB), following the data pre-processing in <cite class="ltx_citemacro_citep">[<bibref bibrefs="xu2022invertible" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                                    <bibrefphrase>, </bibrefphrase>
                                                  </bibref>]</cite>. The dataset has a 1K training samples and a 1K test samples. The batch size is 500, and each block is trained for 50 epochs.</p>
                                            </para>
                                          </item>
                                        </itemize>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS4.p3">
                                        <p><text font="italic">Choice of <Math mode="inline" tex="h_{k}" text="h _ k" xml:id="A3.SS2.SSS4.p3.m1">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                  <XMTok role="UNKNOWN">h</XMTok>
                                                  <XMTok fontsize="70%" role="UNKNOWN">k</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math>:</text>
For both datasets,
<Math mode="inline" tex="h_{0}=1,\rho=1,h_{\max}=3" text="formulae@(h _ 0 = 1, formulae@(rho = 1, h _ maximum = 3))" xml:id="A3.SS2.SSS4.p3.m2">
                                            <XMath>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="formulae"/>
                                                  <XMRef idref="A3.SS2.SSS4.p3.m2.1"/>
                                                  <XMRef idref="A3.SS2.SSS4.p3.m2.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMApp xml:id="A3.SS2.SSS4.p3.m2.1">
                                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                                    </XMApp>
                                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMDual xml:id="A3.SS2.SSS4.p3.m2.2">
                                                    <XMApp>
                                                      <XMTok meaning="formulae"/>
                                                      <XMRef idref="A3.SS2.SSS4.p3.m2.2.1"/>
                                                      <XMRef idref="A3.SS2.SSS4.p3.m2.2.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMApp xml:id="A3.SS2.SSS4.p3.m2.2.1">
                                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                        <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="A3.SS2.SSS4.p3.m2.2.2">
                                                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                        <XMApp>
                                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                          <XMTok fontsize="70%" meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                                                        </XMApp>
                                                        <XMTok meaning="3" role="NUMBER">3</XMTok>
                                                      </XMApp>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMWrap>
                                              </XMDual>
                                            </XMath>
                                          </Math>. The reparameterization and refinement techniques are not used.</p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS4.p4">
                                        <p><text font="italic">MMD metric:</text>
The MMD values are computed for each specific value of <Math mode="inline" tex="Y" text="Y" xml:id="A3.SS2.SSS4.p4.m1">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                            </XMath>
                                          </Math><!--  %**** JKO˙arxiv˙v4.tex Line 1950 **** --> (across all graph nodes).
When <Math mode="inline" tex="Y" text="Y" xml:id="A3.SS2.SSS4.p4.m2">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                            </XMath>
                                          </Math> is fixed, we retrieve test samples from true data, denoted as <Math mode="inline" tex="\boldsymbol{X}|Y" text="conditional@(X, Y)" xml:id="A3.SS2.SSS4.p4.m3">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math>,
and generate model distribution samples, denoted as <Math mode="inline" tex="\boldsymbol{\tilde{X}}|Y" text="conditional@(tilde@(X), Y)" xml:id="A3.SS2.SSS4.p4.m4">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                <XMApp>
                                                  <XMTok font="bold" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                  <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                </XMApp>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math>, and then compute the MMD values the same as in the unconditional case. <text color="#000000">Due to the relatively small sample size of <Math mode="inline" tex="\boldsymbol{X}|Y" text="conditional@(X, Y)" xml:id="A3.SS2.SSS4.p4.m5">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math> (679 and 144 respectively), we report the average values of MMD-m and threshold <Math mode="inline" tex="\tau" text="tau" xml:id="A3.SS2.SSS4.p4.m6">
                                              <XMath>
                                                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                              </XMath>
                                            </Math> over 50 replicas. In each replica, we subsample 90% observations of <Math mode="inline" tex="\boldsymbol{X}|Y" text="conditional@(X, Y)" xml:id="A3.SS2.SSS4.p4.m7">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math> and generate <Math mode="inline" tex="M=2000" text="M = 2000" xml:id="A3.SS2.SSS4.p4.m8">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">M</XMTok>
                                                  <XMTok meaning="2000" role="NUMBER">2000</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math> samples to form <Math mode="inline" tex="\boldsymbol{\tilde{X}}|Y" text="conditional@(tilde@(X), Y)" xml:id="A3.SS2.SSS4.p4.m9">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMApp>
                                                    <XMTok font="bold" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                                    <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                  </XMApp>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math>.</text>
For the results in Figure <ref labelref="LABEL:cond_gen_solar"/>,
for the <Math mode="inline" tex="Y" text="Y" xml:id="A3.SS2.SSS4.p4.m10">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                            </XMath>
                                          </Math> in plots (a)(b), <Math mode="inline" tex="N=612" text="N = 612" xml:id="A3.SS2.SSS4.p4.m11">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                                <XMTok meaning="612" role="NUMBER">612</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> samples are randomly sampled from <Math mode="inline" tex="\boldsymbol{X}|Y" text="conditional@(X, Y)" xml:id="A3.SS2.SSS4.p4.m12">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> in each replica,
and the standard deviation of MMD-m values is less than the 2e-3 level.
For the <Math mode="inline" tex="Y" text="Y" xml:id="A3.SS2.SSS4.p4.m13">
                                            <XMath>
                                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                            </XMath>
                                          </Math> in plots (c)(d), <Math mode="inline" tex="N=130" text="N = 130" xml:id="A3.SS2.SSS4.p4.m14">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                                <XMTok meaning="130" role="NUMBER">130</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> samples are randomly sampled from <Math mode="inline" tex="\boldsymbol{X}|Y" text="conditional@(X, Y)" xml:id="A3.SS2.SSS4.p4.m15">
                                            <XMath>
                                              <XMApp>
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                              </XMApp>
                                            </XMath>
                                          </Math> in each replica,
and the standard deviation of MMD-m values is less than the 5e-3 level.
The median distance kernel bandwidth <text color="#000000">computed on the entire <Math mode="inline" tex="\boldsymbol{X}|Y" text="conditional@(X, Y)" xml:id="A3.SS2.SSS4.p4.m16">
                                              <XMath>
                                                <XMApp>
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMTok font="bold italic" role="UNKNOWN">X</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                                                </XMApp>
                                              </XMath>
                                            </Math></text> is used in computing the MMD values.</p>
                                      </para>
                                      <para class="ltx_noindent" xml:id="A3.SS2.SSS4.p5">
                                        <p><text font="italic">Network and activation:</text> Regarding design of residual blocks,</p>
                                        <itemize xml:id="A3.I7">
                                          <item xml:id="A3.I7.i1">
                                            <tags>
                                              <tag>•</tag>
                                              <tag role="autoref">item </tag>
                                              <tag role="typerefnum">1st item</tag>
                                            </tags>
                                            <para xml:id="A3.I7.i1.p1">
                                              <p>On two-moon data, we use fully-connected residual blocks with two hidden layers under 128 hidden nodes. The activation is Tanh. We train four residual blocks. The learning rate is 5e-3.</p>
                                            </para>
                                          </item>
                                          <item xml:id="A3.I7.i2">
                                            <tags>
                                              <tag>•</tag>
                                              <tag role="autoref">item </tag>
                                              <tag role="typerefnum">2nd item</tag>
                                            </tags>
                                            <para xml:id="A3.I7.i2.p1">
                                              <p>On solar data, we follow the same design of residual blocks as <cite class="ltx_citemacro_citep">[<bibref bibrefs="xu2022invertible" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                                    <bibrefphrase>, </bibrefphrase>
                                                  </bibref>]</cite>. More precisely, each residual block contains one Chebnet <cite class="ltx_citemacro_citep">[<bibref bibrefs="Chebnet" separator="," show="AuthorsPhrase1Year" yyseparator=",">
                                                    <bibrefphrase>, </bibrefphrase>
                                                  </bibref>]</cite> layer with degree 3, followed by two fully-connected layers with 64 hidden nodes. The activation is ELU. We train 11 residual blocks. The learning rate is 5e-3.</p>
                                            </para>
                                          </item>
                                        </itemize>
                                      </para>
                                    </subsubsection>
                                  </block>
                                </table>
                              </subsubsection>
                            </block>
                          </table>
                        </subsubsection>
                      </subsection>
                    </appendix>
                  </section>
                </section>
              </subsection>
            </subsection>
          </subsection>
        </subsection>
      </table>
    </subsection>
  </section>
</document>
