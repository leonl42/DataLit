<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/university/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-I2nYWac2Id"?>
<?latexml class="acmart" options="sigconf,screen"?>
<!--  %% --><!--  %% Submission ID. --><!--  %% Use this when submitting an article to a sponsored event. You’ll --><!--  %% receive a unique submission ID from the organizers --><!--  %% of the event, and this ID should be used as the parameter to this command. --><!--  %%“acmSubmissionID–123-A56-BU3˝ --><!--  %% --><!--  %% For managing citations, it is recommended to use bibliography --><!--  %% files in BibTeX format. --><!--  %% --><!--  %% You can then either use BibTeX with the ACM-Reference-Format style, --><!--  %% or BibLaTeX with the acmnumeric or acmauthoryear sytles, that include --><!--  %% support for advanced citation of software artefact from the --><!--  %% biblatex-software package, also separately available on CTAN. --><!--  %% --><!--  %% Look at the sample-*-biblatex.tex files for templates showcasing --><!--  %**** paper.tex Line 100 **** --><!--  %% the biblatex styles. --><!--  %% --><!--  %% --><!--  %% For managing citations, it is recommended to use bibliography --><!--  %% files in BibTeX format. --><!--  %% --><!--  %% You can then either use BibTeX with the ACM-Reference-Format style, --><!--  %% or BibLaTeX with the acmnumeric or acmauthoryear sytles, that include --><!--  %% support for advanced citation of software artefact from the --><!--  %% biblatex-software package, also separately available on CTAN. --><!--  %% --><!--  %% Look at the sample-*-biblatex.tex files for templates showcasing --><!--  %% the biblatex styles. --><!--  %% --><!--  %% --><!--  %% The majority of ACM publications use numbered citations and --><!--  %% references.  The command “citestyle–authoryear˝ switches to the --><!--  %% ”author year” style. --><!--  %% --><!--  %% If you are preparing content for an event --><!--  %% sponsored by ACM SIGGRAPH, you must use the ”author year” style of --><!--  %% citations and references. --><!--  %% Uncommenting --><!--  %**** paper.tex Line 125 **** --><!--  %% the next command will enable that style. --><!--  %%“citestyle–acmauthoryear˝ --><?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line ltx_leqno">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <resource src="ltx-amsart.css" type="text/css"/>
<!--  %% 
     %% end of the preamble, start of the body of the document source. 
     %Optional math commands from https://github.com/goodfeli/dlbook˙notation. 
     %“input–math˙commands.tex˝ 
     %“usepackage–hyperref˝ 
     %“usepackage–url˝ 
     %“usepackage–graphicx˝ 
     %“newcommand–“fix˝–“marginpar–FIX˝˝ 
     %“newcommand–“new˝–“marginpar–NEW˝˝ -->  <title><!--  %% -->Uplift Modeling based on Graph Neural Network Combined with Causal Knowledge<!--  %% The ”title” command has an optional parameter, 
     %% allowing the author to define a ”short title” to be used in page headers. --></title>
  <creator role="author">
    <personname><!--  %% -->Haowen Wang<!--  %% The ”author” command and its associated commands are used to define 
     %% the authors and their affiliations. 
     %% Of note is the shared affiliation of the first two authors, and the 
     %% ”authornote” and ”authornotemark” commands 
     %**** paper.tex Line 150 **** 
     %% used to denote shared contribution to the research. --></personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">Alipay, AntGroup</text>
<text class="ltx_affiliation_country">China</text>
</contact>
    <contact role="email">wanghaowen@antgroup.com</contact>
  </creator>
  <creator before=", " role="author">
    <personname>Xinyan Ye</personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">Imperial College London</text>
<text class="ltx_affiliation_country">UK</text>
</contact>
    <contact role="email">xy2119@ic.ac.uk</contact>
  </creator>
  <creator before=", " role="author">
    <personname>Yikang Wang</personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">University College London</text>
<text class="ltx_affiliation_country">UK</text>
</contact>
    <contact role="email">yikang.wang.21@ucl.ac.uk</contact>
  </creator>
  <creator before=", " role="author">
    <personname>Yangze Zhou</personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">Zhejiang University</text>
<text class="ltx_affiliation_country"><!--  %**** paper.tex Line 175 **** -->China</text>
</contact>
    <contact role="email">yangze.zhou@zju.edu.cn</contact>
  </creator>
  <creator before=", " role="author">
    <personname>Zhiyi Zhang</personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">Peking University</text>
<text class="ltx_affiliation_country"/>
</contact>
    <contact role="email">emma0302@pku.edu.cn</contact>
  </creator>
  <creator before=", " role="author">
    <personname>Longhan Zhang</personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">Zhejiang Lab</text>
<text class="ltx_affiliation_country">China</text>
</contact>
    <contact role="email">longhanz@zhejianglab.com</contact>
    <contact role="email">emma0302@pku.edu.cn</contact>
  </creator>
  <creator before=" and " role="author">
    <personname>Jing Jiang</personname>
    <contact role="affiliation"><text class="ltx_affiliation_institution">Zhejiang Lab</text>
<text class="ltx_affiliation_country">China</text>
</contact>
<!--  %**** paper.tex Line 200 **** -->    <contact role="email">jiangj@zhejianglab.com</contact>
  </creator>
  <date role="copyright">2018</date>
  <abstract name="Abstract.">
    <p>Uplift modeling is a fundamental component of marketing effect modeling, which is commonly employed to evaluate the effects of treatments on outcomes. Through uplift modeling, we can identify the treatment with the greatest benefit. On the other side, we can identify clients who are likely to make favorable decisions in response to a certain treatment. In the past, uplift modeling approaches relied heavily on the difference-in-difference (DID) architecture, paired with a machine learning model as the estimation learner, while neglecting the link and confidential information between features. We proposed a framework based on graph neural networks that combine causal knowledge with an estimate of uplift value. Firstly, we presented a causal representation technique based on CATE (conditional average treatment effect) estimation and adjacency matrix structure learning. Secondly, we suggested a more scalable uplift modeling framework based on graph convolution networks for combining causal knowledge. Our findings demonstrate that this method works effectively for predicting uplift values, with small errors in typical simulated data, and its effectiveness has been verified in actual industry marketing data.</p>
  </abstract>
  <keywords><!--  %% -->Uplift Modeling, Graph Neural Network, Causal Inference<!--  %% Keywords. The author(s) should pick words that accurately describe 
     %% the work being presented. Separate the keywords with commas. 
     %**** paper.tex Line 250 **** --></keywords>
  <note class="ltx_note_frontmatter" role="copyright"><!--  %% Rights management information.  This information is sent to you -->acmcopyright<!--  %% when you complete the rights form.  These commands have SAMPLE 
     %% values in them; it is your responsibility as an author to replace 
     %% the commands and values with those provided to you when you 
     %% complete the rights form. --></note>
  <note class="ltx_note_frontmatter" role="journalyear">2018</note>
  <note class="ltx_note_frontmatter" role="doi">XXXXXXX.XXXXXXX</note>
  <note class="ltx_note_frontmatter" role="conference"><!--  %% These commands are for a PROCEEDINGS abstract or paper. -->Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</note>
  <note class="ltx_note_frontmatter" role="price"><!--  %Uncomment “acmBooktitle if th title of the proceedings is different -->15.00<!--  %**** paper.tex Line 75 **** 
     %from ‘‘Proceedings of ...’’! 
     %“acmBooktitle–Woodstock ’18: ACM Symposium on Neural Gaze Detection, 
     %June 03__05, 2018, Woodstock, NY˝ --></note>
  <note class="ltx_note_frontmatter" role="isbn">978-1-4503-XXXX-X/18/06</note>
  <note class="ltx_note_frontmatter" role="ccs">Information systems Information systems applications</note>
  <note class="ltx_note_frontmatter" role="ccs">Computing methodologies Artificial intelligence</note>
  <note class="ltx_note_frontmatter" role="ccs">Computing methodologies Machine learning</note>
<!--  %% 
     %% The code below is generated by the tool at http://dl.acm.org/ccs.cfm. 
     %% Please copy and paste the code instead of the example below. 
     %% 
     %¡ccs2012¿Ω¡concept¿Ω¡concept˙id¿10002951.10003227¡/concept˙id¿Ω¡concept˙desc¿Information systems~Information systems applications¡/concept˙desc¿Ω¡concept˙significance¿500¡/concept˙significance¿Ω¡/concept¿Ω¡concept¿Ω¡concept˙id¿10010147.10010178¡/concept˙id¿Ω¡concept˙desc¿Computing methodologies~Artificial intelligence¡/concept˙desc¿Ω¡concept˙significance¿500¡/concept˙significance¿Ω¡/concept¿Ω¡concept¿Ω¡concept˙id¿10010147.10010257¡/concept˙id¿Ω¡concept˙desc¿Computing methodologies~Machine learning¡/concept˙desc¿Ω¡concept˙significance¿500¡/concept˙significance¿Ω¡/concept¿Ω¡/ccs2012¿ -->  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=". ">1</tag>Introduction</title>
    <toctitle><tag close=" ">1</tag>Introduction</toctitle>
    <para xml:id="S1.p1">
      <p>Uplift modeling <cite class="ltx_citemacro_citep">(<bibref bibrefs="uplift_modeling" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> has traditionally relied on randomized experiments, such as randomized controlled trials (RCTs) <cite class="ltx_citemacro_citep">(<bibref bibrefs="RCT" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, in which customers are randomly allocated to either receive or not receive the intervention. In such instances, obtaining an accurate and interpretable estimate from observational data becomes critical. However, carrying out such an experiment in a business context frequently results in several challenges, including high costs in terms of time and money, uneven intervention distribution, and selection bias in the specific population.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Response modeling or outcome prediction uses supervised learning models to model the relation between features and target variables to predict response variation. Although response modeling is typically preferable to random targets, distinguishing between treatment-induced be- behavioral changes is often challenging. The population that should be targeted is the one most likely to respond positively to the intervention. As a result, a thorough knowledge of the behavioral changes that occur after the intervention is essential. Uplift modeling simulates the causal effect between the intervention and the outcomes based on response modeling. Causal inference frameworks and machine learning models are corporated to provide accurate forecasts and optimized performance on intuitive metrics.</p>
    </para>
    <para xml:id="S1.p3">
      <p>The counterfactual nature of intervention data is central to causal inference in Rubin’s Potential Outcome Framework (POF) <cite class="ltx_citemacro_citep">(<bibref bibrefs="rubin2005causal" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. This characteristic pertains to a person’s inability to both receive and refuse intervention. This means that the effects of many therapies cannot be seen in the same person. Two frameworks that have been extensively examined for causal impact estimations based on this counterfactual characteristic are the meta-learner framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="meta:Ton" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and the customised machine learning model-based framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="ML:Chen" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. The ultimate goal is to increase the accuracy of causal impact estimation through the use of feature engineering and validation approaches such as PS matching <cite class="ltx_citemacro_citep">(<bibref bibrefs="PSM:Caliendo" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, weighting <cite class="ltx_citemacro_citep">(<bibref bibrefs="weighting:Li" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, feature representation <cite class="ltx_citemacro_citep">(<bibref bibrefs="fe:Muandet" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, and so on.</p>
    </para>
    <para xml:id="S1.p4">
      <p>In the past, researchers in uplift modeling were largely concerned with how to employ unbiased data and models in the estimation framework. We increased the amount of data information by defining causal knowledge and implementing structured representation, then used a graph convolution neural network <cite class="ltx_citemacro_citep">(<bibref bibrefs="GCN:Zhang" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> to efficiently and directionally integrate feature neighborhood information, achieving excellent performance in uplift modeling and prediction tasks. The following is a description of our paper’s contribution to methodological and empirical evaluation perspectives:</p>
    </para>
    <para xml:id="S1.p5">
      <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S1.p5.m1">
          <XMath>
            <XMTok name="bullet" role="MULOP">∙</XMTok>
          </XMath>
        </Math>
First, we propose to use conditional average treatment effect (CATE) as the attribute representing the causal information of the feature and as part of uplift modeling and propose a causal network model framework to effectively calculate it based on knowledge distilling and double machine learning.</p>
    </para>
    <para xml:id="S1.p6">
      <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S1.p6.m1">
          <XMath>
            <XMTok name="bullet" role="MULOP">∙</XMTok>
          </XMath>
        </Math>
Second, we propose to learn the causal diagram structure of the data before uplift modeling and reconstruct the data according to the learned adjacency matrix.</p>
    </para>
    <para xml:id="S1.p7">
      <p><Math mode="inline" tex="\bullet" text="bullet" xml:id="S1.p7.m1">
          <XMath>
            <XMTok name="bullet" role="MULOP">∙</XMTok>
          </XMath>
        </Math>
Third, we propose an uplift modeling estimator based on graph convolution neural networks, which can integrate and characterize neighborhood feature attributes according to the cause and effect diagram structure and improve the performance of downstream tasks.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=". ">2</tag>Related Work</title>
    <toctitle><tag close=" ">2</tag>Related Work</toctitle>
    <para xml:id="S2.p1">
      <p>The estimation of the uplift value in uplift modeling is often based on the Potential Outcome Framework(POF) <cite class="ltx_citemacro_citep">(<bibref bibrefs="rubin2005causal" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. The individual treatment effect(ITE) can be expressed as:</p>
      <equation xml:id="S2.E1">
        <tags>
          <tag>(1)</tag>
          <tag role="autoref">Equation 1</tag>
          <tag role="refnum">1</tag>
        </tags>
        <Math mode="display" tex="ITE:\tau(i)=Y_{i}(1)-Y_{i}(0)" text="I * T * E colon tau * i = Y _ i * 1 - Y _ i * 0" xml:id="S2.E1.m1">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">I</XMTok>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMTok font="italic" role="UNKNOWN">E</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  <XMDual>
                    <XMRef idref="S2.E1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.1">i</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.E1.m1.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="1" role="NUMBER" xml:id="S2.E1.m1.2">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.E1.m1.3"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S2.E1.m1.3">0</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
      <p>Shere <Math mode="inline" tex="Y_{i}(1)" text="Y _ i * 1" xml:id="S2.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
              <XMDual>
                <XMRef idref="S2.p1.m1.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S2.p1.m1.1">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="Y_{i}(0)" text="Y _ i * 0" xml:id="S2.p1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
              <XMDual>
                <XMRef idref="S2.p1.m2.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m2.1">0</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> represents the result of the outcome variable under the treatment condition and control condition, respectively, for individual <Math mode="inline" tex="i" text="i" xml:id="S2.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">i</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="\tau(i)" text="tau * i" xml:id="S2.p1.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              <XMDual>
                <XMRef idref="S2.p1.m4.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S2.p1.m4.1">i</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is the ITE value.</p>
    </para>
    <para xml:id="S2.p2">
      <p>Considering that the individual effect of treatment will vary from individual and the high cost of marketing experiments in the industry, the conditional average treatment effect(CATE) is proposed as the effect of treatment on subgroups evaluated by the conditional average treatment effect (CATE), which is calculated by:</p>
      <equation xml:id="S2.E2">
        <tags>
          <tag>(2)</tag>
          <tag role="autoref">Equation 2</tag>
          <tag role="refnum">2</tag>
        </tags>
        <Math mode="display" tex="CATE:\tau_{i}=E\left[Y_{i}(1)\mid X_{i}\right]-E\left[Y_{i}(0)\mid X_{i}\right]" text="C * A * T * E colon tau _ i = E * delimited-[]@(conditional@(Y _ i * 1, X _ i)) - E * delimited-[]@(conditional@(Y _ i * 0, X _ i))" xml:id="S2.E2.m1">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMTok font="italic" role="UNKNOWN">E</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">E</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="S2.E2.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">[</XMTok>
                        <XMApp xml:id="S2.E2.m1.3">
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S2.E2.m1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="1" role="NUMBER" xml:id="S2.E2.m1.1">1</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">E</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="S2.E2.m1.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">[</XMTok>
                        <XMApp xml:id="S2.E2.m1.4">
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S2.E2.m1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok meaning="0" role="NUMBER" xml:id="S2.E2.m1.2">0</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
      <p>where <Math mode="inline" tex="X_{i}" text="X _ i" xml:id="S2.p2.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">X</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math> is the feature vector for individual <Math mode="inline" tex="i" text="i" xml:id="S2.p2.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">i</XMTok>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="S2.p3">
      <p>For the estimation of CATE and ITE, the most direct method is to make an unbiased adjustment to the regression model. Series of meta learners represented by s-learner are designed based on the concept, that is, train one or more models with y as the output training target, input T and X, and get the change of Y by changing the value of T to estimate ITE and CATE.</p>
    </para>
    <para xml:id="S2.p4">
      <equation xml:id="S2.E3">
        <tags>
          <tag>(3)</tag>
          <tag role="autoref">Equation 3</tag>
          <tag role="refnum">3</tag>
        </tags>
        <Math mode="display" tex="\tau(x)=E[Y_{i}(1)-Y_{i}(0)|X]=E[\tau_{i}|X]" text="tau * x = E * delimited-[]@(Y _ i * 1 - conditional@(Y _ i * 0, X)) = E * delimited-[]@(conditional@(tau _ i, X))" xml:id="S2.E3.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                <XMDual>
                  <XMRef idref="S2.E3.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m1.1">x</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">E</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.E3.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S2.E3.m1.4">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.E3.m1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok meaning="1" role="NUMBER" xml:id="S2.E3.m1.2">1</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S2.E3.m1.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok meaning="0" role="NUMBER" xml:id="S2.E3.m1.3">0</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">E</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.E3.m1.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S2.E3.m1.5">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="S2.p5">
      <p>Another series of methods for uplift modeling prediction is the probability score matching (PSM) <cite class="ltx_citemacro_citep">(<bibref bibrefs="PSM:Caliendo" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> method based on randomized controlled trials (RCT) <cite class="ltx_citemacro_citep">(<bibref bibrefs="RCT" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. By calculating the probability score <Math mode="inline" tex="P(t\mid x)" text="P * conditional@(t, x)" xml:id="S2.p5.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">P</XMTok>
              <XMDual>
                <XMRef idref="S2.p5.m1.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S2.p5.m1.1">
                    <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, each sample is given a different treatment object according to its similarity, so for sample <Math mode="inline" tex="i" text="i" xml:id="S2.p5.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">i</XMTok>
          </XMath>
        </Math>, we find sample <Math mode="inline" tex="j" text="j" xml:id="S2.p5.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">j</XMTok>
          </XMath>
        </Math>:</p>
    </para>
    <para xml:id="S2.p6">
      <equation xml:id="S2.E4">
        <tags>
          <tag>(4)</tag>
          <tag role="autoref">Equation 4</tag>
          <tag role="refnum">4</tag>
        </tags>
        <Math class="ltx_math_unparsed" mode="display" tex="\operatorname{argmin}_{j}\operatorname{dist}(i,j)=\left|P\left(t\mid x_{i}%&#10;\right)-P\left(t\mid x_{j}\right)\right|" xml:id="S2.E4.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok role="OPFUNCTION" scriptpos="post">argmin</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
            </XMApp>
            <XMTok role="OPFUNCTION" scriptpos="post" xml:id="S2.E4.m1.1">dist</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="false">(</XMTok>
              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E4.m1.2">i</XMTok>
              <XMTok role="PUNCT">,</XMTok>
              <XMTok font="italic" role="UNKNOWN" xml:id="S2.E4.m1.3">j</XMTok>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMWrap>
            <XMTok meaning="equals" role="RELOP">=</XMTok>
            <XMTok role="VERTBAR" stretchy="true">|</XMTok>
            <XMTok font="italic" role="UNKNOWN">P</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="true">(</XMTok>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
              <XMTok name="mid" role="VERTBAR">∣</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="true">)</XMTok>
            </XMWrap>
            <XMTok meaning="minus" role="ADDOP">-</XMTok>
            <XMTok font="italic" role="UNKNOWN">P</XMTok>
            <XMWrap>
              <XMTok role="OPEN" stretchy="true">(</XMTok>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
              <XMTok name="mid" role="VERTBAR">∣</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="true">)</XMTok>
            </XMWrap>
            <XMTok role="VERTBAR" stretchy="true">|</XMTok>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="S2.p7">
      <p><!--  %**** paper.tex Line 300 **** -->Then CATE could be calculated by:</p>
    </para>
    <para xml:id="S2.p8">
      <equation xml:id="S2.E5">
        <tags>
          <tag>(5)</tag>
          <tag role="autoref">Equation 5</tag>
          <tag role="refnum">5</tag>
        </tags>
        <Math mode="display" tex="\hat{\tau}=\frac{1}{n}\left[\sum_{i:t_{i}=1}\left(y_{i}-y_{j}\right)+\sum_{i:t%&#10;_{i}=0}\left(y_{j}-y_{i}\right)\right]" text="hat@(tau) = (1 / n) * delimited-[]@((sum _ (i colon t _ i = 1))@(y _ i - y _ j) + (sum _ (i colon t _ i = 0))@(y _ j - y _ i))" xml:id="S2.E5.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.E5.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="true">[</XMTok>
                    <XMApp xml:id="S2.E5.m1.1">
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.E5.m1.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="S2.E5.m1.1.1">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S2.E5.m1.1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="S2.E5.m1.1.2">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="true">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="S2.p9">
      <p>In addition, the industry’s research on lift modeling also includes methods based on the Covariate Balancing Method and Modeling Unobserved Confounder. Typical methods of the first category include Inverse Probability of Treatment Weighting (IPTW) <cite class="ltx_citemacro_citep">(<bibref bibrefs="IPTW:Chesnaye" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, Entropy Balancing (EB) <cite class="ltx_citemacro_citep">(<bibref bibrefs="EB:Hainmueller" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, and Approximate Residual Balancing (ARB) <cite class="ltx_citemacro_citep">(<bibref bibrefs="ARB:Athey" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, in which core is how to re-assign weights to samples. The core of the second type of method is to model the confounder. One way is to model the instrumental variable, which is represented by the two-stage least square (2SLS) method <cite class="ltx_citemacro_citep">(<bibref bibrefs="2SLS:Bollen" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. The first stage is to fit the impact of the change of I on T, and the second stage is to fit the impact of the change of T on y caused by the change of I. The other way is to use deep learning to represent the confounder, such as SITE <cite class="ltx_citemacro_citep">(<bibref bibrefs="SITE:Yao" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, Dragonnet <cite class="ltx_citemacro_citep">(<bibref bibrefs="DragonNet:Tso" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, and CEVAE <cite class="ltx_citemacro_citep">(<bibref bibrefs="CEVAE:Louizos" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="S2.p10">
      <p>The past research mainly focused on adjusting and optimizing the uplift value estimation model in a structured or unstructured way. Estimation methods based on the foundation model have shown us the importance of embedding causal structure knowledge into the estimation process. This paper will try to conduct data mining on features. On the one hand, it expands the amount of information by defining and applying causal information; on the other hand, it reconstructs structured origin data through causal diagram structural information and uses GCN to learn neighborhood information from unstructured reconstructed data to improve the performance of uplift modeling using the framework of meta learner <cite class="ltx_citemacro_citep">(<bibref bibrefs="meta:Ton" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="S2.p11">
      <p>The structure of the paper is as follows. Section II reviews the critical concepts of uplift modeling and frameworks of the learning approach. In Section III, we introduce the methodology of our causal knowledge framework. Section IV evaluates these methods with both synthetic and real-world data. Finally, Section V summarizes the findings and recommends future research for uplift modeling applications.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=". ">3</tag>Methodology</title>
    <toctitle><tag close=" ">3</tag>Methodology</toctitle>
    <para xml:id="S3.p1">
      <p>This section will introduce the calculation method and architecture of graph neural networks embedded with causal knowledge.
We propose an interpretable causal graph network representation learning framework with features as nodes. It can expand the representation of features by node embedding, mapping the originally scalar features into a high-dimension space, and then integrating the causal information and structural information into the graph features through graph convolution to achieve a more accurate estimation of uplift value.</p>
    </para>
    <subsection inlist="toc" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=". ">3.1</tag>Causal Knowledge Representation</title>
      <toctitle><tag close=" ">3.1</tag>Causal Knowledge Representation</toctitle>
      <para xml:id="S3.SS1.p1">
        <p>We propose a framework for computing causal knowledge representation. We transfer knowledge through the concept of the soft target in knowledge distillation as the estimation target of the causal estimator. We estimate each feature’s causal average treatment effect(CATE) and take it as the weight of the feature based on the causal effect. This work has been proven to obtain more information.</p>
      </para>
      <figure inlist="lof" labels="LABEL:causal_graph LABEL:causal_weighting_cal" placement="h" xml:id="S3.F2">
        <tags>
          <tag>Figure 2</tag>
          <tag role="autoref">Figure 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Figure 2</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="top" width="208.1pt" xml:id="S3.F2.fig1">
          <graphics candidates="Fig/causal_weighting.png" graphic="Fig/causal_weighting.png" options="width=170.71652pt,keepaspectratio=true" xml:id="S3.F2.g1"/>
<!--  %**** paper.tex Line 325 **** -->          <toccaption class="ltx_centering"><tag close=" ">1</tag>Causal Weighting Calculation Framework</toccaption>
          <caption class="ltx_centering"><tag close=". ">Figure 1</tag>Causal Weighting Calculation Framework</caption>
        </figure>
        <figure align="center" class="ltx_figure_panel ltx_minipage" vattach="top" width="208.1pt" xml:id="S3.F2.fig2">
          <graphics candidates="Fig/causal_graph_x1.png" graphic="Fig/causal_graph_x1.png" options="width=156.49014pt,keepaspectratio=true" xml:id="S3.F2.g2"/>
          <toccaption class="ltx_centering"><tag close=" ">2</tag>Causal Graph for Feature X1</toccaption>
          <caption class="ltx_centering"><tag close=". ">Figure 2</tag>Causal Graph for Feature X1</caption>
        </figure>
      </figure>
      <para xml:id="S3.SS1.p2">
        <p>Figure <ref labelref="LABEL:causal_weighting_cal"/> shows the architecture of the causal average treatment effect(CATE) calculation. Firstly, in the module of knowledge distillation and representation, We will build a knowledge distillation task for label Y(0/1), using the teacher model(XGBoost <cite class="ltx_citemacro_citep">(<bibref bibrefs="xgboost:Chen" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, etc. as base regressor) to get the probability <Math mode="inline" tex="\hat{Y}" text="hat@(Y)" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
              </XMApp>
            </XMath>
          </Math> as the soft label to replace Y as the target label. Secondly, in the multi-head causal weight calculation module, we establish a causal graph for each feature as shown in Figure <ref labelref="LABEL:causal_graph"/>, use the soft label <Math mode="inline" tex="\hat{Y}" text="hat@(Y)" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
              </XMApp>
            </XMath>
          </Math> got in Module 1 as a knowledge label, and estimate CATE in the framework of double machine learning (DML) <cite class="ltx_citemacro_citep">(<bibref bibrefs="DML:Chernozhukov" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Since the CATE estimation of each feature is independent, we designed a multi-head mechanism to make the calculation more efficient. Double machine learning is a classic estimator to estimate (heterogeneous) treatment effects when treatment is classified and all potential confounders/controls. DML makes the following structural equation assumptions for the data generation process:</p>
      </para>
      <para xml:id="S3.SS1.p3">
        <equation xml:id="S3.E6">
          <tags>
            <tag>(6)</tag>
            <tag role="autoref">Equation 6</tag>
            <tag role="refnum">6</tag>
          </tags>
          <Math mode="display" tex="Y=\theta(X)\cdot T+g(X,W)+\epsilon\quad\mathbb{E}[\epsilon\mid X,W]=0" text="formulae@(Y = (theta * X) cdot T + g * open-interval@(X, W) + epsilon, E * delimited-[]@(conditional@(epsilon, list@(X, W))) = 0)" xml:id="S3.E6.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S3.E6.m1.6"/>
                  <XMRef idref="S3.E6.m1.7"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.E6.m1.6">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E6.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.1">X</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">T</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S3.E6.m1.2"/>
                            <XMRef idref="S3.E6.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.2">X</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.3">W</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMHint name="quad" role="PUNCT" width="10pt"/>
                  <XMApp xml:id="S3.E6.m1.7">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S3.E6.m1.7.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S3.E6.m1.7.1">
                            <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                            <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E6.m1.4"/>
                                <XMRef idref="S3.E6.m1.5"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.4">X</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E6.m1.5">W</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS1.p4">
        <equation xml:id="S3.E7">
          <tags>
            <tag>(7)</tag>
            <tag role="autoref">Equation 7</tag>
            <tag role="refnum">7</tag>
          </tags>
          <Math mode="display" tex="T=f(X,W)+\eta\quad\mathbb{E}[\eta\mid X,W]=0" text="formulae@(T = f * open-interval@(X, W) + eta, E * delimited-[]@(conditional@(eta, list@(X, W))) = 0)" xml:id="S3.E7.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S3.E7.m1.5"/>
                  <XMRef idref="S3.E7.m1.6"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.E7.m1.5">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" role="UNKNOWN">T</XMTok>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">f</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S3.E7.m1.1"/>
                            <XMRef idref="S3.E7.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E7.m1.1">X</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E7.m1.2">W</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMHint name="quad" role="PUNCT" width="10pt"/>
                  <XMApp xml:id="S3.E7.m1.6">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S3.E7.m1.6.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S3.E7.m1.6.1">
                            <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                            <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E7.m1.3"/>
                                <XMRef idref="S3.E7.m1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E7.m1.3">X</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E7.m1.4">W</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS1.p5">
        <equation xml:id="S3.E8">
<!--  %**** paper.tex Line 350 **** -->          <tags>
            <tag>(8)</tag>
            <tag role="autoref">Equation 8</tag>
            <tag role="refnum">8</tag>
          </tags>
          <Math mode="display" tex="\mathbb{E}[\eta\cdot\epsilon\mid X,W]=0" text="E * delimited-[]@(conditional@(eta cdot epsilon, list@(X, W))) = 0" xml:id="S3.E8.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.E8.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S3.E8.m1.3">
                        <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                          <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.E8.m1.1"/>
                            <XMRef idref="S3.E8.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E8.m1.1">X</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.E8.m1.2">W</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS1.p6">
        <p>After modeling Y and T, respectively, the estimated CATE value <Math mode="inline" tex="\theta(X)" text="theta * X" xml:id="S3.SS1.p6.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p6.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p6.m1.1">X</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> satisfies the equation:</p>
      </para>
      <para xml:id="S3.SS1.p7">
        <equation xml:id="S3.E9">
          <tags>
            <tag>(9)</tag>
            <tag role="autoref">Equation 9</tag>
            <tag role="refnum">9</tag>
          </tags>
          <Math mode="display" tex="\tilde{Y}=\theta(X)\cdot\tilde{T}+\epsilon" text="tilde@(Y) = (theta * X) cdot tilde@(T) + epsilon" xml:id="S3.E9.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                  <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMDual>
                        <XMRef idref="S3.E9.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E9.m1.1">X</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>Here <Math mode="inline" tex="\tilde{Y}" text="tilde@(Y)" xml:id="S3.SS1.p7.m1">
            <XMath>
              <XMApp>
                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
              </XMApp>
            </XMath>
          </Math> is the residual of Y, <Math mode="inline" tex="\tilde{T}" text="tilde@(T)" xml:id="S3.SS1.p7.m2">
            <XMath>
              <XMApp>
                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
              </XMApp>
            </XMath>
          </Math> is the residual of T.</p>
      </para>
      <para xml:id="S3.SS1.p8">
        <p>Considering <Math mode="inline" tex="\mathbb{E}[\epsilon\cdot\eta\mid X]=0" text="E * delimited-[]@(conditional@(epsilon cdot eta, X)) = 0" xml:id="S3.SS1.p8.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.SS1.p8.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S3.SS1.p8.m1.1">
                        <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                          <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, the problem of estimating <Math mode="inline" tex="\theta(X)" text="theta * X" xml:id="S3.SS1.p8.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p8.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p8.m2.1">X</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> can be transformed into the following regression problem.</p>
      </para>
      <para xml:id="S3.SS1.p9">
        <equation xml:id="S3.E10">
          <tags>
            <tag>(10)</tag>
            <tag role="autoref">Equation 10</tag>
            <tag role="refnum">10</tag>
          </tags>
          <Math mode="display" tex="\hat{\theta}=\arg\min_{\theta\in\Theta}\mathbb{E}_{n}\left[(\tilde{Y}-\theta(X%&#10;)\cdot\tilde{T})^{2}\right]" text="hat@(theta) = argument@((minimum _ (theta element-of Theta))@(E _ n)) * delimited-[]@((tilde@(Y) - (theta * X) cdot tilde@(T)) ^ 2)" xml:id="S3.E10.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok meaning="argument" role="OPFUNCTION">arg</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok fontsize="70%" name="Theta" role="UNKNOWN">Θ</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.E10.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">[</XMTok>
                      <XMApp xml:id="S3.E10.m1.2">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMDual>
                          <XMRef idref="S3.E10.m1.2.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S3.E10.m1.2.1">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                  <XMDual>
                                    <XMRef idref="S3.E10.m1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E10.m1.1">X</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="true">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=". ">3.2</tag>Causal Graph Structure Learning</title>
      <toctitle><tag close=" ">3.2</tag>Causal Graph Structure Learning</toctitle>
      <para xml:id="S3.SS2.p1">
        <p>The graph network structure contains the dataset’s prior information. The connection relationship indicates the direction and distance of information transmission and determines the direction and degree of information sharing and transmission of nodes in the subsequent graph network characterization operation.</p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p>Here, we use the classical Bayesian network structure as the structure of the causal feature representation graph. Scoring search is a standard method to solve the problem of Bayesian network structure to evaluate the degree of fit between the Bayesian network and training data and then find the optimal Bayesian network based on the scoring function. The goal is now to solve the following task:</p>
        <equation xml:id="S3.E11">
          <tags>
            <tag>(11)</tag>
            <tag role="autoref">Equation 11</tag>
            <tag role="refnum">11</tag>
          </tags>
          <Math mode="display" tex="\underset{G\in G}{\operatorname{argmax}}\operatorname{score}(G,\mathcal{D})." text="(G element-of G)@(argmax) * score@(G, D)" xml:id="S3.E11.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E11.m1.4"/>
                <XMWrap>
                  <XMApp xml:id="S3.E11.m1.4">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMApp role="UNDERACCENT">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" role="UNKNOWN">G</XMTok>
                        <XMTok font="italic" role="UNKNOWN">G</XMTok>
                      </XMApp>
                      <XMTok role="OPFUNCTION" scriptpos="post">argmax</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMRef idref="S3.E11.m1.1"/>
                        <XMRef idref="S3.E11.m1.2"/>
                        <XMRef idref="S3.E11.m1.3"/>
                      </XMApp>
                      <XMApp>
                        <XMTok role="OPFUNCTION" scriptpos="post" xml:id="S3.E11.m1.1">score</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E11.m1.2">G</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E11.m1.3">D</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>The scoring function introduces the inductive preference of what kind of Bayesian network you want to obtain. Here we use the Bayesian Information Criterion(BIC) <cite class="ltx_citemacro_citep">(<bibref bibrefs="BIC:Neath" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> as the score function, which approximates the Bayes Dirichlet equivalent uniform(BDeu), sharing the critical property of decomposability.</p>
        <equation xml:id="S3.E12">
          <tags>
            <tag>(12)</tag>
            <tag role="autoref">Equation 12</tag>
            <tag role="refnum">12</tag>
          </tags>
          <Math mode="display" tex="\operatorname{score}(G,\mathcal{D})=\sum_{X_{i}}\operatorname{score}\left(X_{i%&#10;},\Pi_{i},\mathcal{D}\right)" text="score@(G, D) = (sum _ X _ i)@(score@(X _ i, Pi _ i, D))" xml:id="S3.E12.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMRef idref="S3.E12.m1.1"/>
                    <XMRef idref="S3.E12.m1.2"/>
                    <XMRef idref="S3.E12.m1.3"/>
                  </XMApp>
                  <XMApp>
                    <XMTok role="OPFUNCTION" scriptpos="post" xml:id="S3.E12.m1.1">score</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E12.m1.2">G</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E12.m1.3">D</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMApp>
                </XMDual>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">X</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMRef idref="S3.E12.m1.4"/>
                      <XMRef idref="S3.E12.m1.6"/>
                      <XMRef idref="S3.E12.m1.7"/>
                      <XMRef idref="S3.E12.m1.5"/>
                    </XMApp>
                    <XMApp>
                      <XMTok role="OPFUNCTION" scriptpos="post" xml:id="S3.E12.m1.4">score</XMTok>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S3.E12.m1.6">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E12.m1.7">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E12.m1.5">D</XMTok>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMApp>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S3.E13">
          <tags>
            <tag>(13)</tag>
            <tag role="autoref">Equation 13</tag>
            <tag role="refnum">13</tag>
          </tags>
          <Math class="ltx_math_unparsed" mode="display" tex="\operatorname{Score}_{bic}(g:D)=l((\hat{\theta},g):D)-\frac{\log M}{2}%&#10;\operatorname{Dim}[g]" xml:id="S3.E13.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok role="OPFUNCTION" scriptpos="post">Score</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">l</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S3.E13.m1.1">
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.E13.m1.2">g</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
              <XMTok meaning="minus" role="ADDOP">-</XMTok>
              <XMApp>
                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                <XMApp>
                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  <XMTok font="italic" role="UNKNOWN">M</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
              <XMTok role="OPFUNCTION" scriptpos="post">Dim</XMTok>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">[</XMTok>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok role="CLOSE" stretchy="false">]</XMTok>
              </XMWrap>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS2.p3">
        <p>D is the given data, M is the number of training samples, g is the given structure, Dim[g] is the number of independent parameters of model g, <Math mode="inline" tex="\hat{\theta}" text="hat@(theta)" xml:id="S3.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> is the maximum likelihood estimate of the parameter given the structure g and the data D.</p>
      </para>
      <para xml:id="S3.SS2.p4">
        <p>After determining the scoring function, here we use the hill-climbing <cite class="ltx_citemacro_citep">(<bibref bibrefs="hill:Selman" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> algorithm as the optimization algorithm for the structural learning problem. The Hill-climbing algorithm is a classical algorithm for local search based on a greedy algorithm, starting with a candidate solution and continuing to search in its neighborhood until there is no better solution. The steps of the local search algorithm are described as follows: Firstly, initialize a feasible solution X. Secondly, select a moved solution s (x) in the neighborhood of the current solution so that f (s (x)) ¡ f (x), s (x)  in S (x). If there is no such solution, X is the optimal solution, and the algorithm stops. Thirdly, make x = s (x) and repeat the second step.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S3.SS3">
      <tags>
        <tag>3.3</tag>
        <tag role="autoref">subsection 3.3</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">§3.3</tag>
      </tags>
      <title><tag close=". ">3.3</tag>GNN based uplift modeling</title>
      <toctitle><tag close=" ">3.3</tag>GNN based uplift modeling</toctitle>
      <para xml:id="S3.SS3.p1">
        <p>After Causal Knowledge Representation and Causal Graph Structure Learning, we obtained more information about the dataset and a specific relationship between features. Considering the excellent representation ability of graph neural networks, we propose a graph neural network representation framework based on causal graph representation, which can integrate this information more efficiently.</p>
      </para>
      <para xml:id="S3.SS3.p2">
        <p>GCN <cite class="ltx_citemacro_citep">(<bibref bibrefs="GCN:Zhang" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> is a multi-layer neural network that can operate directly on the graph and induce nodes to obtain information on neighborhood vectors based on the neighborhood attributes of nodes. Consider a graph G = (V, e), where V (— V — = n) and E are the sets of nodes and edges, respectively.
It is assumed that each node is connected to itself, that is, (v, v) <Math mode="inline" tex="\in E" text="absent element-of E" xml:id="S3.SS3.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok meaning="absent"/>
                <XMTok font="italic" role="UNKNOWN">E</XMTok>
              </XMApp>
            </XMath>
          </Math> for any v. Let x <Math mode="inline" tex="\in\mathbb{R}^{n\times m}" text="absent element-of R ^ (n * m)" xml:id="S3.SS3.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> be a matrix containing all N nodes and their vector features, where m is the dimension of the vector, and each row <Math mode="inline" tex="x_{v}\in\mathbb{R}^{m}" text="x _ v element-of R ^ m" xml:id="S3.SS3.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> are the vectors of V. We introduce the adjacency matrix A and its degree matrix D of G, where <Math mode="inline" tex="d_{ii}=\sum_{j}A_{ij}" text="d _ (i * i) = (sum _ j)@(A _ (i * j))" xml:id="S3.SS3.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Due to the characteristics of the self-circulation hypothesis, the diagonal element of a is set to 1. In general, GCN can only capture information about its neighbors through one layer of convolution. We can integrate information about a wider range of neighbors by stacking multiple GCN layers:</p>
      </para>
      <para xml:id="S3.SS3.p3">
        <equation xml:id="S3.E14">
          <tags>
            <tag>(14)</tag>
            <tag role="autoref">Equation 14</tag>
            <tag role="refnum">14</tag>
          </tags>
          <Math mode="display" tex="H^{(l+1)}=\sigma\left(\hat{D}^{-\frac{1}{2}}\hat{A}\hat{D}^{-\frac{1}{2}}H^{(l%&#10;)}W^{(l)}\right)" text="H ^ (l + 1) = sigma * (hat@(D)) ^ (- 1 / 2) * hat@(A) * (hat@(D)) ^ (- 1 / 2) * H ^ l * W ^ l" xml:id="S3.E14.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">H</XMTok>
                  <XMDual>
                    <XMRef idref="S3.E14.m1.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.E14.m1.1">
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                  <XMDual>
                    <XMRef idref="S3.E14.m1.4"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMApp xml:id="S3.E14.m1.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                            <XMTok font="italic" role="UNKNOWN">D</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok mathstyle="script" meaning="divide" role="FRACOP"/>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">A</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                            <XMTok font="italic" role="UNKNOWN">D</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok mathstyle="script" meaning="divide" role="FRACOP"/>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" role="UNKNOWN">H</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E14.m1.2"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E14.m1.2">l</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" role="UNKNOWN">W</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E14.m1.3"/>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E14.m1.3">l</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS3.p4">
        <p>Here <Math mode="inline" tex="H^{(l+1)}" text="H ^ (l + 1)" xml:id="S3.SS3.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">H</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS3.p4.m1.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS3.p4.m1.1">
                      <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="H^{(l)}" text="H ^ l" xml:id="S3.SS3.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">H</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS3.p4.m2.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p4.m2.1">l</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> are the output and input matrices. <Math mode="inline" tex="\hat{A}=A+I" text="hat@(A) = A + I" xml:id="S3.SS3.p4.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">A</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" role="UNKNOWN">A</XMTok>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, where A is the adjacency matrix, and I is the identity matrix. <Math mode="inline" tex="\hat{D}" text="hat@(D)" xml:id="S3.SS3.p4.m4">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMApp>
            </XMath>
          </Math> is the degree matrix of <Math mode="inline" tex="\hat{A}" text="hat@(A)" xml:id="S3.SS3.p4.m5">
            <XMath>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\hat{D}^{-\frac{1}{2}}\hat{A}\hat{D}^{-\frac{1}{2}}" text="(hat@(D)) ^ (- 1 / 2) * hat@(A) * (hat@(D)) ^ (- 1 / 2)" xml:id="S3.SS3.p4.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok mathstyle="script" meaning="divide" role="FRACOP"/>
                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">A</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok mathstyle="script" meaning="divide" role="FRACOP"/>
                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is the normalized symmetric adjacency matrix, and <Math mode="inline" tex="W^{(l)}\in\mathbb{R}^{m\times k}" text="W ^ l element-of R ^ (m * k)" xml:id="S3.SS3.p4.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">W</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS3.p4.m7.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p4.m7.1">l</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a weight matrix. <Math mode="inline" tex="\sigma" text="sigma" xml:id="S3.SS3.p4.m8">
            <XMath>
              <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
            </XMath>
          </Math> is an activation function, e.g., a <Math mode="inline" tex="\operatorname{LeakyReLU}" text="LeakyReLU" xml:id="S3.SS3.p4.m9">
            <XMath>
              <XMTok role="OPFUNCTION" scriptpos="post">LeakyReLU</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S3.SS3.p5">
        <p>Here we use GCN to extract and integrate features based on the causal neighborhood structure we learned in the previous step. We take advantage of the feature that GCN can efficiently fuse features according to the neighborhood structure to get graph embedding of each sample and then perform prediction tasks based on it. Figure <ref labelref="LABEL:uplift_GNN"/> shows that we have expanded the information on each feature. In addition to the value of each feature itself, we have also expanded the information of structural features and causal weights.</p>
      </para>
      <figure inlist="lof" labels="LABEL:uplift_GNN" placement="h" xml:id="S3.F3">
        <tags>
          <tag>Figure 3</tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <graphics candidates="Fig/GNN_uplift_modeling.png" class="ltx_centering" graphic="Fig/GNN_uplift_modeling.png" options="width=433.62pt,keepaspectratio=true" xml:id="S3.F3.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>GNN-based uplift modeling architecture.</toccaption>
        <caption class="ltx_centering"><tag close=". ">Figure 3</tag>GNN-based uplift modeling architecture.</caption>
      </figure>
      <para xml:id="S3.SS3.p6">
        <p>For the estimation of uplift value, we refer to the design method of S-learner in meta learner and use our GNN-based model as the base learner.</p>
      </para>
      <para xml:id="S3.SS3.p7">
        <equation xml:id="S3.E15">
          <tags>
            <tag>(15)</tag>
            <tag role="autoref">Equation 15</tag>
            <tag role="refnum">15</tag>
          </tags>
          <Math mode="display" tex="\mu_{0}(x)=\mathbb{E}[Y(T=0)\mid X=x]" text="mu _ 0 * x = E * delimited-[]@(conditional@(Y * (T = 0), X) = x)" xml:id="S3.E15.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.E15.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E15.m1.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.E15.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S3.E15.m1.2">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E15.m1.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E15.m1.2.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S3.E16">
          <tags>
            <tag>(16)</tag>
            <tag role="autoref">Equation 16</tag>
            <tag role="refnum">16</tag>
          </tags>
          <Math mode="display" tex="\mu_{1}(x)=\mathbb{E}[Y(T=1)\mid X=x]" text="mu _ 1 * x = E * delimited-[]@(conditional@(Y * (T = 1), X) = x)" xml:id="S3.E16.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.E16.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E16.m1.1">x</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="S3.E16.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S3.E16.m1.2">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E16.m1.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E16.m1.2.1">
                                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS3.p8">
        <p>After <Math mode="inline" tex="\mu_{0}" text="mu _ 0" xml:id="S3.SS3.p8.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\mu_{1}" text="mu _ 1" xml:id="S3.SS3.p8.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> are calculated, respectively, the uplift value for each sample can be calculated:</p>
      </para>
      <para xml:id="S3.SS3.p9">
        <equation xml:id="S3.E17">
          <tags>
            <tag>(17)</tag>
            <tag role="autoref">Equation 17</tag>
            <tag role="refnum">17</tag>
          </tags>
          <Math mode="display" tex="\tilde{D}_{i}^{1}:=Y_{i}^{1}-\hat{\mu}_{0}\left(X_{i}^{1}\right)" text="((tilde@(D)) _ i) ^ 1 assign (Y _ i) ^ 1 - (hat@(mu)) _ 0 * (X _ i) ^ 1" xml:id="S3.E17.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S3.E17.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S3.E17.m1.1">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation xml:id="S3.E18">
          <tags>
            <tag>(18)</tag>
            <tag role="autoref">Equation 18</tag>
            <tag role="refnum">18</tag>
          </tags>
          <Math mode="display" tex="\tilde{D}_{i}^{0}:=\hat{\mu}_{1}\left(X_{i}^{0}\right)-Y_{i}^{0}" text="((tilde@(D)) _ i) ^ 0 assign (hat@(mu)) _ 1 * (X _ i) ^ 0 - (Y _ i) ^ 0" xml:id="S3.E18.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S3.E18.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S3.E18.m1.1">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS3.p10">
        <p>Here <Math mode="inline" tex="\tilde{D}_{i}^{1}" text="((tilde@(D)) _ i) ^ 1" xml:id="S3.SS3.p10.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\tilde{D}_{i}^{0}" text="((tilde@(D)) _ i) ^ 0" xml:id="S3.SS3.p10.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> are the uplift values for samples in the intervention group and control group.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=". ">4</tag>Experiments</title>
    <toctitle><tag close=" ">4</tag>Experiments</toctitle>
    <subsection inlist="toc" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=". ">4.1</tag>Dataset</title>
      <toctitle><tag close=" ">4.1</tag>Dataset</toctitle>
      <subsubsection inlist="toc" xml:id="S4.SS1.SSS1">
        <tags>
          <tag>4.1.1</tag>
          <tag role="autoref">subsubsection 4.1.1</tag>
          <tag role="refnum">4.1.1</tag>
          <tag role="typerefnum">§4.1.1</tag>
        </tags>
        <title><tag close=". ">4.1.1</tag>Synthetic dataset</title>
        <toctitle><tag close=" ">4.1.1</tag>Synthetic dataset</toctitle>
        <para xml:id="S4.SS1.SSS1.p1">
          <p>We used a method to simulate the generation of a dataset containing individual treatment effects, which is available in causalml. In <cite class="ltx_citemacro_citet"><bibref bibrefs="ML:Chen" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite> research, it is used as a method to provide simulated data, which is available in Causalml. This synthetic method in the study provides the test groundings for estimating individual treatment effects and facilitating validation. The following is the generating mechanism: for different choices of X-distribution <Math mode="inline" tex="P_{d}" text="P _ d" xml:id="S4.SS1.SSS1.p1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                </XMApp>
              </XMath>
            </Math>, there is dimension <Math mode="inline" tex="d" text="d" xml:id="S4.SS1.SSS1.p1.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">d</XMTok>
              </XMath>
            </Math>, noise level <Math mode="inline" tex="\sigma" text="sigma" xml:id="S4.SS1.SSS1.p1.m3">
              <XMath>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
              </XMath>
            </Math>, propensity function <Math mode="inline" tex="e^{\ast}(\cdot)" text="e ^ ast * cdot" xml:id="S4.SS1.SSS1.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                    <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S4.SS1.SSS1.p1.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok name="cdot" role="MULOP" xml:id="S4.SS1.SSS1.p1.m4.1">⋅</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, baseline primary effect <Math mode="inline" tex="b^{\ast}(\cdot)" text="b ^ ast * cdot" xml:id="S4.SS1.SSS1.p1.m5">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S4.SS1.SSS1.p1.m5.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok name="cdot" role="MULOP" xml:id="S4.SS1.SSS1.p1.m5.1">⋅</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, and treatment effect function <Math mode="inline" tex="\tau^{\ast}(\cdot)" text="tau ^ ast * cdot" xml:id="S4.SS1.SSS1.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                    <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S4.SS1.SSS1.p1.m6.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok name="cdot" role="MULOP" xml:id="S4.SS1.SSS1.p1.m6.1">⋅</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>. The distributions and relations are mathematically expressed in terms:</p>
        </para>
        <para xml:id="S4.SS1.SSS1.p2">
          <equation xml:id="S4.E19">
            <tags>
              <tag>(19)</tag>
              <tag role="autoref">Equation 19</tag>
              <tag role="refnum">19</tag>
            </tags>
            <Math mode="display" tex="X_{i}\sim P_{d}" text="X _ i similar-to P _ d" xml:id="S4.E19.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">P</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS1.SSS1.p3">
          <equation xml:id="S4.E20">
            <tags>
              <tag>(20)</tag>
              <tag role="autoref">Equation 20</tag>
              <tag role="refnum">20</tag>
            </tags>
            <Math mode="display" tex="\varepsilon_{i}\mid X_{i}\sim N(0,1)" text="conditional@(varepsilon _ i, X _ i) similar-to N * open-interval@(0, 1)" xml:id="S4.E20.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMApp>
                    <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S4.E20.m1.1"/>
                        <XMRef idref="S4.E20.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S4.E20.m1.1">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="1" role="NUMBER" xml:id="S4.E20.m1.2">1</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS1.SSS1.p4">
          <equation xml:id="S4.E21">
            <tags>
              <tag>(21)</tag>
              <tag role="autoref">Equation 21</tag>
              <tag role="refnum">21</tag>
            </tags>
            <Math mode="display" tex="W_{i}\mid X_{i}\sim\text{ Bernoulli }\left(e^{*}\left(X_{i}\right)\right)" text="conditional@(W _ i, X _ i) similar-to [ Bernoulli ] * e ^ * * X _ i" xml:id="S4.E21.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMApp>
                    <XMTok meaning="conditional" name="mid" role="MODIFIEROP">∣</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">W</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText> Bernoulli </XMText>
                    <XMDual>
                      <XMRef idref="S4.E21.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S4.E21.m1.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">e</XMTok>
                            <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S4.E21.m1.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S4.E21.m1.1.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS1.SSS1.p5">
          <equation xml:id="S4.E22">
<!--  %**** paper.tex Line 450 **** -->            <tags>
              <tag>(22)</tag>
              <tag role="autoref">Equation 22</tag>
              <tag role="refnum">22</tag>
            </tags>
            <Math mode="display" tex="Y_{i}=b^{*}\left(X_{i}\right)+\left(W_{i}-0.5\right)\tau^{*}\left(X_{i}\right)%&#10;+\sigma\varepsilon_{i}" text="Y _ i = b ^ * * X _ i + (W _ i - 0.5) * tau ^ * * X _ i + sigma * varepsilon _ i" xml:id="S4.E22.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">Y</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">b</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S4.E22.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S4.E22.m1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMDual>
                        <XMRef idref="S4.E22.m1.2"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S4.E22.m1.2">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">W</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S4.E22.m1.3"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S4.E22.m1.3">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="varepsilon" role="UNKNOWN">ε</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS1.SSS1.p6">
          <p>The generation mechanism is featured by nuisance components and an easy treatment effect function. The initial distribution is constructed from <Math mode="inline" tex="X_{i1}\sim Unif(0,1)^{d}" text="X _ (i * 1) similar-to U * n * i * f * (open-interval@(0, 1)) ^ d" xml:id="S4.SS1.SSS1.p6.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">U</XMTok>
                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                    <XMTok font="italic" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" role="UNKNOWN">f</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.SS1.SSS1.p6.m1.1"/>
                          <XMRef idref="S4.SS1.SSS1.p6.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok meaning="0" role="NUMBER" xml:id="S4.SS1.SSS1.p6.m1.1">0</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok meaning="1" role="NUMBER" xml:id="S4.SS1.SSS1.p6.m1.2">1</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> is constructed, followed by <Math class="ltx_math_unparsed" mode="inline" tex="e^{\ast}(X_{i}=trim_{0.1}\{sin(\pi X_{i1}X_{i2})\}" xml:id="S4.SS1.SSS1.p6.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">X</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    <XMTok fontsize="70%" meaning="0.1" role="NUMBER">0.1</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" role="UNKNOWN">n</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMWrap>
              </XMath>
            </Math> and <Math mode="inline" tex="\tau^{\ast}(X_{i})=(X_{i1}+X_{i2})/2" text="tau ^ ast * X _ i = (X _ (i * 1) + X _ (i * 2)) / 2" xml:id="S4.SS1.SSS1.p6.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                      <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S4.SS1.SSS1.p6.m3.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S4.SS1.SSS1.p6.m3.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMDual>
                      <XMRef idref="S4.SS1.SSS1.p6.m3.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S4.SS1.SSS1.p6.m3.2">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">X</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> to compute propensity scores and treatment effects, respectively. The treatment <Math mode="inline" tex="W" text="W" xml:id="S4.SS1.SSS1.p6.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">W</XMTok>
              </XMath>
            </Math> is generated as a binary distribution. Eventually, interval trimming of the distribution is performed via <Math mode="inline" tex="trim(x)=max\{\eta,min(x,1-\eta)\}" text="t * r * i * m * x = m * a * x * set@(eta, m * i * n * open-interval@(x, 1 - eta))" xml:id="S4.SS1.SSS1.p6.m5">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    <XMDual>
                      <XMRef idref="S4.SS1.SSS1.p6.m5.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.SSS1.p6.m5.1">x</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S4.SS1.SSS1.p6.m5.3"/>
                        <XMRef idref="S4.SS1.SSS1.p6.m5.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMTok font="italic" name="eta" role="UNKNOWN" xml:id="S4.SS1.SSS1.p6.m5.3">η</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S4.SS1.SSS1.p6.m5.4">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">m</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S4.SS1.SSS1.p6.m5.2"/>
                              <XMRef idref="S4.SS1.SSS1.p6.m5.4.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.SSS1.p6.m5.2">x</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S4.SS1.SSS1.p6.m5.4.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" name="eta" role="UNKNOWN">η</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>. This simulation method is adpoted as a scaled version of the Friedman <cite class="ltx_citemacro_citep">(<bibref bibrefs="Friedman" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> function, where a baseline main effect is computed through <Math mode="inline" tex="b^{\ast}(X_{i})=sin(\pi X_{i1}X_{i2})+2(X_{i1}-0.5)^{2}+X_{i4}+0.5X_{i5}" text="b ^ ast * X _ i = s * i * n * pi * X _ (i * 1) * X _ (i * 2) + 2 * (X _ (i * 1) - 0.5) ^ 2 + X _ (i * 4) + 0.5 * X _ (i * 5)" xml:id="S4.SS1.SSS1.p6.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">b</XMTok>
                      <XMTok fontsize="70%" name="ast" role="MULOP">∗</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S4.SS1.SSS1.p6.m6.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S4.SS1.SSS1.p6.m6.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">X</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMDual>
                        <XMRef idref="S4.SS1.SSS1.p6.m6.2"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S4.SS1.SSS1.p6.m6.2">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">X</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">X</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMRef idref="S4.SS1.SSS1.p6.m6.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.SS1.SSS1.p6.m6.3">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">X</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">X</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">X</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          <XMTok fontsize="70%" meaning="5" role="NUMBER">5</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </subsubsection>
      <subsubsection inlist="toc" xml:id="S4.SS1.SSS2">
        <tags>
          <tag>4.1.2</tag>
          <tag role="autoref">subsubsection 4.1.2</tag>
          <tag role="refnum">4.1.2</tag>
          <tag role="typerefnum">§4.1.2</tag>
        </tags>
        <title><tag close=". ">4.1.2</tag>Real-world dataset</title>
        <toctitle><tag close=" ">4.1.2</tag>Real-world dataset</toctitle>
        <para xml:id="S4.SS1.SSS2.p1">
          <p>We use the criteo uplift dataset <cite class="ltx_citemacro_citep">(<bibref bibrefs="uplift_modeling" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> as the evaluation of the real-world dataset, which is constructed by collecting data from the incremental test. It randomly divides the people into two categories, whether it is advertised or not. The criteo uplift dataset has 25 million rows, each representing a user with 11 characteristics, a treatment indicator, and two tags (click and conversion). Here we use conversion as the tag we focus on in uplift estimation. Figure <ref labelref="LABEL:criteo_bn"/> shows the results after learning the Bayesian network structure of the dataset.</p>
        </para>
        <figure inlist="lof" labels="LABEL:criteo_bn" placement="h" xml:id="S4.F4">
          <tags>
            <tag>Figure 4</tag>
            <tag role="autoref">Figure 4</tag>
            <tag role="refnum">4</tag>
            <tag role="typerefnum">Figure 4</tag>
          </tags>
          <graphics candidates="Fig/criteo_bn.png" class="ltx_centering" graphic="Fig/criteo_bn.png" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F4.g1"/>
          <toccaption><tag close=" "><!--  %“Description–CRITEO Bayesian network˝ -->4<!--  %“Description–CRITEO Bayesian network˝ 
     %“Description–CRITEO Bayesian network˝ 
     %“Description–CRITEO Bayesian network˝ 
     %“Description–CRITEO Bayesian network˝ 
     %“Description–CRITEO Bayesian network˝ --></tag><!--  %“Description–CRITEO Bayesian network˝ -->Correlation network between confounders, treatment, and outcome from the real-world dataset, CRITEO</toccaption>
          <caption><tag close=". ">Figure 4</tag><!--  %“Description–CRITEO Bayesian network˝ 
     %“Description–CRITEO Bayesian network˝ -->Correlation network between confounders, treatment, and outcome from the real-world dataset, CRITEO<!--  %“Description–CRITEO Bayesian network˝ 
     %“Description–CRITEO Bayesian network˝ --></caption>
        </figure>
      </subsubsection>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=". ">4.2</tag>Result</title>
      <toctitle><tag close=" ">4.2</tag>Result</toctitle>
      <subsubsection inlist="toc" xml:id="S4.SS2.SSS1">
        <tags>
          <tag>4.2.1</tag>
          <tag role="autoref">subsubsection 4.2.1</tag>
          <tag role="refnum">4.2.1</tag>
          <tag role="typerefnum">§4.2.1</tag>
        </tags>
        <title><tag close=". ">4.2.1</tag>synthetic dataset</title>
        <toctitle><tag close=" ">4.2.1</tag>synthetic dataset</toctitle>
        <para xml:id="S4.SS2.SSS1.p1">
          <p>In this case, the actual causal effect of features can be calculated easily because the datasets are produced with a certain mechanism The absolute loss (<text font="italic">Abs</text>) is adopted to measure the deviation between the actual causal effect and the estimated causal effect. As for the prediction accuracy, the mean squared error (<text font="italic">MSE</text>) is adopted. The proposed method has been compared to traditional models like linear regression (LR), SVR, and XGBoost.</p>
        </para>
        <figure inlist="lof" labels="LABEL:MSE_res" placement="h" xml:id="S4.F5">
          <tags>
            <tag>Figure 5</tag>
            <tag role="autoref">Figure 5</tag>
            <tag role="refnum">5</tag>
            <tag role="typerefnum">Figure 5</tag>
          </tags>
          <graphics candidates="Fig/MSE.jpg" class="ltx_centering" graphic="Fig/MSE.jpg" options="width=204.85974pt,keepaspectratio=true" xml:id="S4.F5.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">5</tag>Mean squared error for y-prediction accuracy of base methods and ours with the numbers of confounders are 5, 9, and 20, respectively.</toccaption>
          <caption class="ltx_centering"><tag close=". ">Figure 5</tag>Mean squared error for y-prediction accuracy of base methods and ours with the numbers of confounders are 5, 9, and 20, respectively.</caption>
<!--  %**** paper.tex Line 475 **** -->        </figure>
        <figure inlist="lof" labels="LABEL:ABS_res" placement="h" xml:id="S4.F6">
          <tags>
            <tag>Figure 6</tag>
            <tag role="autoref">Figure 6</tag>
            <tag role="refnum">6</tag>
            <tag role="typerefnum">Figure 6</tag>
          </tags>
          <graphics candidates="Fig/ABS.jpg" class="ltx_centering" graphic="Fig/ABS.jpg" options="width=204.85974pt,keepaspectratio=true" xml:id="S4.F6.g1"/>
          <toccaption class="ltx_centering"><tag close=" ">6</tag>Absolute error of ITE of base methods and ours with the numbers of confounders are 5, 9 and 20, respectively.</toccaption>
          <caption class="ltx_centering"><tag close=". ">Figure 6</tag>Absolute error of ITE of base methods and ours with the numbers of confounders are 5, 9 and 20, respectively.</caption>
        </figure>
<!--  %“begin–figure˝[htbp] 
     %“centering 
     %“begin–minipage˝[t]–0.46“textwidth˝ 
     %“centering 
     %“includegraphics[width=7.2cm]–MSE.jpg˝ 
     %“caption–Mean squared error for y-prediction accuracy of base methods and ours with the numbers of confounders are 5, 9 and 20, respectively.˝ 
     %“label–MSE˙res˝ 
     %“end–minipage˝ 
     %“begin–minipage˝[t]–0.46“textwidth˝ 
     %“centering 
     %“includegraphics[width=7.2cm]–ABS.jpg˝ 
     %“caption–Absolute error of ITE of base methods and ours with the numbers of confounders are 5, 9 and 20, respectively.˝ 
     %“label–ABS˙res˝ 
     %“end–minipage˝ 
     %“end–figure˝ -->        <para xml:id="S4.SS2.SSS1.p2">
          <p>Figure <ref labelref="LABEL:MSE_res"/> shows that the origin GNN-based model performs similarly to traditional models in the traditional regression task, while the GNN-based model performs much better when combined with the causal weighting. As for uplift modeling estimation, as shown in Figure <ref labelref="LABEL:ABS_res"/>, causal weighting combined architecture has a much more apparent effect. Before combining causal weighting information, GNN based model is slightly better than LR and SVR in the estimation of uplift value but worse than xgboost while achieving a very accurate result when adopting the causal weighting combined architecture. Another result is that GNN based model can have a much more stable performance when the number of confounders increases, which means that it can have a much more robust performance when facing more complex situations.</p>
        </para>
<!--  %“begin–figure˝[h] 
     %“centering 
     %“includegraphics[width=“linewidth]–KL.jpg˝ 
     %“caption–indicates the KL divergence of basic models and ours while the numbers of confounders are 5, 9 and 20, respectively.˝ 
     %%   “Description–CRITEO Bayesian network˝ 
     %“end–figure˝ -->      </subsubsection>
      <subsubsection inlist="toc" xml:id="S4.SS2.SSS2">
        <tags>
          <tag>4.2.2</tag>
          <tag role="autoref">subsubsection 4.2.2</tag>
          <tag role="refnum">4.2.2</tag>
          <tag role="typerefnum">§4.2.2</tag>
        </tags>
        <title><tag close=". ">4.2.2</tag>Real-world dataset</title>
        <toctitle><tag close=" ">4.2.2</tag>Real-world dataset</toctitle>
        <para xml:id="S4.SS2.SSS2.p1">
          <p>In a real-world dataset, the actual causal effect of treatment remains unknown, leading to the abovementioned indicators being inapplicable. As a result, Area Under Uplift Curve (AUUC) is adopted to measure the performance of an uplifting model on the real-world dataset. AUUC can be calculated as follows:</p>
        </para>
        <para xml:id="S4.SS2.SSS2.p2">
          <equation xml:id="S4.E23">
            <tags>
              <tag>(23)</tag>
              <tag role="autoref">Equation 23</tag>
              <tag role="refnum">23</tag>
            </tags>
            <Math mode="display" tex="AUUC(f)=\int_{0}^{1}V(f,x)dx\approx\sum_{k=1}^{n}V(f,k)" text="A * U * U * C * f = ((integral _ 0) ^ 1)@(V * open-interval@(f, x) * differential-d@(x)) approximately-equals ((sum _ (k = 1)) ^ n)@(V * open-interval@(f, k))" xml:id="S4.E23.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="multirelation"/>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                    <XMTok font="italic" role="UNKNOWN">U</XMTok>
                    <XMTok font="italic" role="UNKNOWN">U</XMTok>
                    <XMTok font="italic" role="UNKNOWN">C</XMTok>
                    <XMDual>
                      <XMRef idref="S4.E23.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.E23.m1.1">f</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">V</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.E23.m1.2"/>
                          <XMRef idref="S4.E23.m1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E23.m1.2">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E23.m1.3">x</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">V</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.E23.m1.4"/>
                          <XMRef idref="S4.E23.m1.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E23.m1.4">f</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E23.m1.5">k</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS2.SSS2.p3">
          <equation xml:id="S4.E24">
            <tags>
              <tag>(24)</tag>
              <tag role="autoref">Equation 24</tag>
              <tag role="refnum">24</tag>
            </tags>
            <Math mode="display" tex="whereV(f,k)=\frac{1}{|T|}\sum_{i\in f(\mathcal{D},k)}{y_{i}^{1}}_{\left[t_{i}=%&#10;1\right]}-\frac{1}{|C|}\sum_{j\in f(\mathcal{D},k)}{y_{j}^{1}}_{\left[t_{j}=0%&#10;\right]}" text="w * h * e * r * e * V * open-interval@(f, k) = (1 / absolute-value@(T)) * (sum _ (i element-of f * open-interval@(D, k)))@(((y _ i) ^ 1) _ (delimited-[]@(t _ i = 1))) - (1 / absolute-value@(C)) * (sum _ (j element-of f * open-interval@(D, k)))@(((y _ j) ^ 1) _ (delimited-[]@(t _ j = 0)))" xml:id="S4.E24.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">w</XMTok>
                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" role="UNKNOWN">e</XMTok>
                    <XMTok font="italic" role="UNKNOWN">V</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S4.E24.m1.9"/>
                        <XMRef idref="S4.E24.m1.10"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.E24.m1.9">f</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.E24.m1.10">k</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="S4.E24.m1.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E24.m1.1">T</XMTok>
                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S4.E24.m1.2"/>
                                  <XMRef idref="S4.E24.m1.3"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN" xml:id="S4.E24.m1.2">D</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E24.m1.3">k</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">y</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S4.E24.m1.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="true">[</XMTok>
                              <XMApp xml:id="S4.E24.m1.4">
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="true">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="S4.E24.m1.5"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.E24.m1.5">C</XMTok>
                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S4.E24.m1.6"/>
                                  <XMRef idref="S4.E24.m1.7"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN" xml:id="S4.E24.m1.6">D</XMTok>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E24.m1.7">k</XMTok>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">y</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S4.E24.m1.8"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="true">[</XMTok>
                              <XMApp xml:id="S4.E24.m1.8">
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">j</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="true">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="S4.SS2.SSS2.p4">
          <p>Here <Math mode="inline" tex="f(\mathcal{D},k)" text="f * open-interval@(D, k)" xml:id="S4.SS2.SSS2.p4.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S4.SS2.SSS2.p4.m1.1"/>
                      <XMRef idref="S4.SS2.SSS2.p4.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="caligraphic" role="UNKNOWN" xml:id="S4.SS2.SSS2.p4.m1.1">D</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.SSS2.p4.m1.2">k</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> can be the k first samples of the dataset when ordered by the prediction of the model <Math mode="inline" tex="f" text="f" xml:id="S4.SS2.SSS2.p4.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
              </XMath>
            </Math>, <Math mode="inline" tex="|T|" text="absolute-value@(T)" xml:id="S4.SS2.SSS2.p4.m3">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S4.SS2.SSS2.p4.m3.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.SSS2.p4.m3.1">T</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> is the number of samples in the treatment group(t=1), and <Math mode="inline" tex="|C|" text="absolute-value@(C)" xml:id="S4.SS2.SSS2.p4.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S4.SS2.SSS2.p4.m4.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.SSS2.p4.m4.1">C</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> is the number of samples in the control group(t=0).</p>
        </para>
        <para xml:id="S4.SS2.SSS2.p5">
          <p>For certain causal relationships, the higher the AUUC is, the better the uplifting model performs. The AUUC of the baseline models and ours are listed in Table <ref labelref="LABEL:auuc_res"/>.</p>
        </para>
        <table inlist="lot" labels="LABEL:auuc_res" xml:id="S4.T1">
          <tags>
            <tag>Table 1</tag>
            <tag role="autoref">Table 1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">Table 1</tag>
          </tags>
          <toccaption class="ltx_centering"><tag close=" ">1</tag>AUUC for uplifting evaluation and MSE for y-prediction of baseline methods and proposed method</toccaption>
          <caption class="ltx_centering"><tag close=". ">Table 1</tag>AUUC for uplifting evaluation and MSE for y-prediction of baseline methods and proposed method</caption>
          <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
            <thead>
              <tr>
                <td align="center" thead="column"><text font="bold">Model</text></td>
                <td align="center" thead="column"><text font="bold">AUUC</text></td>
                <td align="center" thead="column"><text font="bold">MSE</text></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" border="t">LR</td>
                <td align="left" border="t">0.4980</td>
                <td align="left" border="t">0.0026</td>
              </tr>
              <tr>
                <td align="left">SVR</td>
                <td align="left">0.5475</td>
                <td align="left">0.0037</td>
              </tr>
              <tr>
                <td align="left">XGBoost</td>
                <td align="left">0.8756</td>
                <td align="left">0.0025</td>
              </tr>
              <tr>
                <td align="left">GCN</td>
                <td align="left">0.5443</td>
                <td align="left">0.0028</td>
              </tr>
              <tr>
                <td align="left">GCN (Causal Weighting)</td>
                <td align="left">0.8807</td>
                <td align="left">5e-06</td>
              </tr>
            </tbody>
          </tabular>
        </table>
        <para xml:id="S4.SS2.SSS2.p6">
          <p>Table <ref labelref="LABEL:auuc_res"/> shows that when estimating the uplift value in the real-world dataset, although origin GNN has a similar performance with LR and SVR, it has a better performance than XGBoost when with the causal weighting combined architecture.</p>
        </para>
      </subsubsection>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=". ">5</tag>Conclusion and Future Work</title>
    <toctitle><tag close=" ">5</tag>Conclusion and Future Work</toctitle>
    <para xml:id="S5.p1">
      <p>In this work, we investigated how to describe causal information in uplift modeling (add conditional average treatment effect (CATE) and build an adjacency matrix using Bayesian network structure learning). In addition, we addressed how to incorporate this causal information into uplift estimations by proposing a framework for uplift modeling that is based on graph neural networks.</p>
    </para>
    <para xml:id="S5.p2">
      <p>Experiments on simulated and real-world datasets reveal that while the origin graph convolutional neural network performs comparably to conventional approaches when directly predicting uplift values, when paired with causal neighbourhood features and causal representation information, it demonstrates exceptional performance in both the prediction job and the uplift estimation task of the target, owing to the GCN’s excellent neighbourhood learning features.</p>
    </para>
    <para xml:id="S5.p3">
      <p>It is worthwhile to investigate more methods of characterising causal knowledge in the future. Weighted adjacent  matrices might be seen as a means of guiding graph convolutional neural networks to provide accurate data. Alternatively, it is equally intriguing to investigate the size of the receptive domain of neighbourhood features. A wider receptive domain denotes more information, which might aid us in enhancing the performance of this job in downstream prediction.</p>
    </para>
  </section>
  <bibliography citestyle="authoryear" files="reference" xml:id="bib">
    <title>References</title>
  </bibliography>
<!--  %% 
     %% If your work has an appendix, this is the place to put it. -->  <appendix inlist="toc" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Appendix</title>
    <toctitle><tag close=" ">A</tag>Appendix</toctitle>
    <subsection inlist="toc" xml:id="A1.SS1">
      <tags>
        <tag>A.1</tag>
        <tag role="autoref">subsection A.1</tag>
        <tag role="refnum">A.1</tag>
        <tag role="typerefnum">§A.1</tag>
      </tags>
      <title><tag close=". ">A.1</tag>Code Availability</title>
      <toctitle><tag close=" ">A.1</tag>Code Availability</toctitle>
      <para xml:id="A1.SS1.p1">
        <p>The code that supports the findings of this study will be available on GitHub.</p>
      </para>
    </subsection>
  </appendix>
</document>
