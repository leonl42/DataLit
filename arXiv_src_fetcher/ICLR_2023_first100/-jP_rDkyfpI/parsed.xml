<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/university/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-jP_rDkyfpI"?>
<!--  %%%%%%%% ICML 2024 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%% --><?latexml class="article"?>
<?latexml package="microtype"?>
<?latexml package="graphicx"?>
<?latexml package="subfigure"?>
<?latexml package="booktabs"?>
<?latexml package="hyperref"?>
<!--  %Use the following line for the initial blind version submitted for review: --><!--  %“usepackage–icml2024˝ --><?latexml package="icml2024" options="accepted"?>
<?latexml package="amsmath"?>
<?latexml package="amssymb"?>
<?latexml package="mathtools"?>
<?latexml package="amsthm"?>
<?latexml package="cleveref" options="capitalize,noabbrev"?>
<?latexml package="thmtools, thm-restate"?>
<?latexml package="enumitem"?>
<?latexml package="caption" options="font=small,aboveskip=1pt,belowskip=1pt"?>
<?latexml package="microtype"?>
<?latexml package="todonotes" options="textsize=tiny"?>
<?latexml package="etoolbox"?>
<!--  %“usepackage[noend]–algorithmic˝ --><?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_pruned_first">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title><!--  %**** paper.tex Line 125 **** -->Approximate Nearest Neighbor Search with Window Filters</title>
  <creator role="author">
    <personname>Joshua Engels</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Benjamin Landrum</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Shangdi Yu</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Laxman Dhulipala</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Julian Shun</personname>
  </creator>
  <abstract name="Abstract">
    <p>We define and investigate the problem of <text font="italic">c-approximate window search</text>: approximate nearest neighbor search where each point in the dataset has a numeric label, and the goal is to find nearest neighbors to queries within arbitrary label ranges.
Many semantic search problems, such as image and document search with timestamp filters, or product search with cost filters, are natural examples of this problem.
We propose and theoretically analyze a modular tree-based framework for transforming an index that solves the traditional c-approximate nearest neighbor problem into a data structure that solves window search.
On standard nearest neighbor benchmark datasets with random label values, adversarially constructed embeddings, and image search embeddings with real timestamps, we obtain up to a <Math class="ltx_math_unparsed" mode="inline" tex="75\times" xml:id="m1">
        <XMath>
          <XMTok meaning="75" role="NUMBER">75</XMTok>
          <XMTok meaning="times" role="MULOP">×</XMTok>
        </XMath>
      </Math> speedup over existing solutions at the same level of recall.</p>
  </abstract>
  <keywords><!--  %You may provide any keywords that you -->Approximate Nearest Neighbor Search, Vector Database, Data Structure, Tree, Filtered Search, Embeddings<!--  %find helpful for describing your paper; these are used to populate 
     %the ”keywords” metadata in the PDF but will not be shown in the document --></keywords>
<!--  %**** paper.tex Line 150 **** -->  <para xml:id="p2">
    <break/>
  </para>
<!--  %this must go after the closing bracket ] following “twocolumn[ ... 
     %This command actually creates the footnote in the first column 
     %listing the affiliations and the copyright notice. 
     %The command takes one argument, which is text to display at the start of the footnote. 
     %The “icmlEqualContribution command is standard text for equal contribution. 
     %Remove it (just –˝) if you do not need this facility. 
     %leave blank if no need to mention equal contribution 
     %“printAffiliationsAndNotice–“icmlEqualContribution˝ % otherwise use the standard text. -->  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>The nearest neighbor search problem has been widely studied for more than 30 years <cite class="ltx_citemacro_citep">(<bibref bibrefs="arya1993approximate" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Given a dataset <Math mode="inline" tex="D" text="D" xml:id="S1.p1.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math>, the problem requires the construction of an index that can efficiently answer queries of the form “what is the closest vector to <Math mode="inline" tex="x" text="x" xml:id="S1.p1.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> in <Math mode="inline" tex="D" text="D" xml:id="S1.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math>?” Solving this problem exactly degrades to a brute force linear search in high dimensions <cite class="ltx_citemacro_citep">(<bibref bibrefs="rubinstein2018hardness" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, so instead both theoreticians and practitioners focus on the relaxed <Math mode="inline" tex="c" text="c" xml:id="S1.p1.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">c</XMTok>
          </XMath>
        </Math>-approximate nearest neighbor search problem (ANNS), which asks “what is a vector that is no more than <Math mode="inline" tex="c" text="c" xml:id="S1.p1.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">c</XMTok>
          </XMath>
        </Math> times farther away from <Math mode="inline" tex="x" text="x" xml:id="S1.p1.m6">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> than the closest vector to <Math mode="inline" tex="x" text="x" xml:id="S1.p1.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> in <Math mode="inline" tex="D" text="D" xml:id="S1.p1.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math>?”</p>
    </para>
    <para xml:id="S1.p2">
      <p>Recent advances in vector embeddings for text, images, and other unstructured data have led to a surge in research and industry interest in ANNS.
This trend is reflected by a proliferation of commercial vector databases: Pinecone <cite class="ltx_citemacro_citep">(<bibref bibrefs="pinecone2024overview" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, Vearch <cite class="ltx_citemacro_citep">(<bibref bibrefs="vearch2022search" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, Weaviate <cite class="ltx_citemacro_citep">(<bibref bibrefs="weaviate2022filters" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, Milvus <cite class="ltx_citemacro_citep">(<bibref bibrefs="milvus2022hybridsearch" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, and Vespa <cite class="ltx_citemacro_citep">(<bibref bibrefs="vespa2022semistructured" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, among others.
These databases offer hyper-parameter tuning, metadata storage, and solutions to a variety of related search problems. They especially tout their support of ANNS with metadata filtering as a key differentiating application.</p>
    </para>
<!--  %, where the user wishes to  “laxman–Perhaps you could mention that they drum up filtering as one of the key problems to support for real-world use cases.˝ -->    <para xml:id="S1.p3">
      <p>In this work, we are primarily interested in a difficult generalization of the <Math mode="inline" tex="c" text="c" xml:id="S1.p3.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">c</XMTok>
          </XMath>
        </Math>-approximate nearest neighbor problem that we term <text font="bold italic">Window Search</text> (see <ref labelref="LABEL:def:problem" show="creftype~refnum"/>).
Window search is similar to ANNS, except queries are accompanied by a “window filter”, and the goal is to find the nearest neighbor to the query that has a label value within the filter.
This problem has a large number of immediate applications. For instance, in document and image search, each item may be accompanied by a timestamp, and the user may wish to filter to an arbitrary time range (e.g., they may wish to search for hiking pictures, but only from last summer, or forum posts about a bug, but only in the days after a new version was released). Another application is product catalogs, where a user may wish to filter search results by cost. Finally, we note that a large class of emerging applications is large language model retrieval augmented generation, where by storing and retrieving information LLMs can reduce hallucinations and improve their reasoning <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2023check" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>;
window search may be critical when the LLM needs to recall something stored on a certain date or range of dates.</p>
    </para>
    <para xml:id="S1.p4">
      <p>Although this problem has many motivating examples, there is a dearth of papers examining it in the literature.
Some vector databases analyze window search-like problem instances as an additional feature of their system, but this analysis is typically secondary to their main approach and too slow for large-scale real-world systems; as far as we are aware, we are the first to propose, analyze, and experiment with a non-trivial solution to the window search problem.</p>
    </para>
<!--  %“cref–fig:algorithm˝ shows a summary of our solution. Each green rectangle represents a subset of $D$ that we have built a normal ANNS index for. By recursively splitting the dataset in half in order of label value and building an ANNS index for each partition, as shown in the top left of the figure, we can query a logarithmic number of indices that combined consider over every point in a query’s window filter (see the ”Tree Based Query” section of the figure for an example). We also show an alternative type of querying that we call “algname–Optimized Postfiltering˝, which entails finding the smallest indexed set that contains all points that meet the filter constraint. This can be efficient, as shown in the ”small blowup” case, or inefficient, as shown in the ”large blowup” case. Finally, the top right shows a partitioning strategy with overlaps that prevents the large blowup case from happening for all queries. “josh–I’m not 100“% convinced this is the correct place for this, what do other people think?˝“shangdi–I think we can delay this to Section 4?˝ “josh–I’ll delete it˝ -->    <para xml:id="S1.p5">
      <p>Our contributions include the following:</p>
      <enumerate xml:id="S1.I1">
        <item xml:id="S1.I1.i1">
          <tags>
            <tag>1.</tag>
            <tag role="autoref">item 1</tag>
            <tag role="creftype">Item</tag>
            <tag role="creftypecap">Item</tag>
            <tag role="creftypeplural">Items</tag>
            <tag role="creftypepluralcap">Items</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">item 1</tag>
          </tags>
          <para xml:id="S1.I1.i1.p1">
            <p>We formalize the <Math mode="inline" tex="c" text="c" xml:id="S1.I1.i1.p1.m1">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                </XMath>
              </Math>-approximate window search problem and propose and test the first non-trivial solution that uses the unique nature of numeric label based filters.</p>
          </para>
        </item>
        <item xml:id="S1.I1.i2">
          <tags>
            <tag>2.</tag>
            <tag role="autoref">item 2</tag>
            <tag role="creftype">Item</tag>
            <tag role="creftypecap">Item</tag>
            <tag role="creftypeplural">Items</tag>
            <tag role="creftypepluralcap">Items</tag>
            <tag role="refnum">2</tag>
            <tag role="typerefnum">item 2</tag>
          </tags>
          <para xml:id="S1.I1.i2.p1">
            <p>We design multiple new algorithms for window search, including a modular tree-based framework and a label-space partitioning approach.</p>
          </para>
        </item>
        <item xml:id="S1.I1.i3">
          <tags>
            <tag>3.</tag>
            <tag role="autoref">item 3</tag>
            <tag role="creftype">Item</tag>
            <tag role="creftypecap">Item</tag>
            <tag role="creftypeplural">Items</tag>
            <tag role="creftypepluralcap">Items</tag>
            <tag role="refnum">3</tag>
            <tag role="typerefnum">item 3</tag>
          </tags>
          <para xml:id="S1.I1.i3.p1">
            <p>We prove that our tree-based framework solves window search and give runtime bounds for the general case and for a specific instantiation with the Vamana ANNS algorithm <cite class="ltx_citemacro_citep">(<bibref bibrefs="diskann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>)</cite>.
We also analyze optimal partitioning strategies for the label-space partitioning approach.</p>
          </para>
        </item>
        <item xml:id="S1.I1.i4">
          <tags>
            <tag>4.</tag>
            <tag role="autoref">item 4</tag>
            <tag role="creftype">Item</tag>
            <tag role="creftypecap">Item</tag>
            <tag role="creftypeplural">Items</tag>
            <tag role="creftypepluralcap">Items</tag>
            <tag role="refnum">4</tag>
            <tag role="typerefnum">item 4</tag>
          </tags>
          <para xml:id="S1.I1.i4.p1">
            <p>We benchmark our methods against strong baselines and vector databases, achieving up to a <Math class="ltx_math_unparsed" mode="inline" tex="75\times" xml:id="S1.I1.i4.p1.m1">
                <XMath>
                  <XMTok meaning="75" role="NUMBER">75</XMTok>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                </XMath>
              </Math> speedup on real world embeddings and adversarially constructed datasets.</p>
          </para>
        </item>
      </enumerate>
    </para>
<!--  %“subsection–Contributions˝ -->  </section>
  <section inlist="toc" labels="LABEL:sec:prefiltering_and_postfiltering LABEL:sec:related" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Related Work</title>
    <para class="ltx_noindent" xml:id="S2.p1">
      <p><text font="bold"><!--  %“julian–define ”prefiltering” and ”postfiltering” first˝ -->Filtered ANNS.</text>

The two overarching naive approaches to filtered ANNS are <emph font="italic">prefiltering</emph>, where the dataset is restricted to elements matching the filter before a spatial search over the remaining elements, and <emph font="italic">postfiltering</emph>, where results from an unfiltered search are restricted to those matching the filter. Thus, one avenue for solving filtered ANNS has focused on augmenting existing ANNS algorithms with prefiltering or postfiltering strategies, resulting in solutions like VBASE <cite class="ltx_citemacro_citep">(<bibref bibrefs="vbase" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and Milvus <cite class="ltx_citemacro_citep">(<bibref bibrefs="milvus2022hybridsearch" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. VBASE, for example, performs beam search on a general purpose search graph and uses the order in which points are encountered as an approximation of relative distance to the query point, before finally postfiltering to find near points matching the predicate. Non-graph based indices can also be adapted with prefiltering and postfiltering to perform filtered search; for example, the popular Faiss library finds nearby clusters of points within an inverted file index, and then prefilters the vectors in those clusters based on an arbitrary predicate function <cite class="ltx_citemacro_citep">(<bibref bibrefs="douze2024faiss" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite><!--  %**** paper.tex Line 225 **** -->.
While these methods support arbitrary filters, they struggle when filters greatly restrict the points relevant to a query <cite class="ltx_citemacro_citep">(<bibref bibrefs="filtereddiskANN" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
<!--  %Prior work on filtered ANNS has used either prefiltering or postfiltering with a general purpose index (i.e., Faiss~“cite–douze2024faiss˝, Milvus~“cite–milvus2022hybridsearch˝, and VBASE~“cite–vbase˝) or indices constructed expressly to serve queries filtered with boolean predicates (i.e., FilteredVamana~“cite–filtereddiskANN˝ and CAPS~“cite–gupta2023caps˝). 
     %The current state of the art in ANNS is dominated by graph-based methods~“cite–dobson2023scaling˝, which are not natively compatible with prefiltering, and struggle with postfiltering when filters greatly restrict the points relevant to a query~“cite–filtereddiskANN˝ 
     %For example, the VBASE vector database performs beam search on a general purpose search graph and uses the order in which points are encountered as the beam is converging as an approximation of relative distance to the query point, before finally  postfiltering to find near points matching the predicate~“cite–vbase˝. Non-graph based indices can also be adapted to filtered search; for example, the popular Faiss library finds nearby posting lists within an inverted file index, and then prefilters the vectors in those posting lists based on an arbitrary predicate function~“cite–douze2024faiss˝. -->    <para xml:id="S2.p2">
      <p><!--  %probably good to mention NHQ but composite indices do not fit elegantly into our characterization here -->Another popular direction focuses on <text font="italic">dedicated indices</text> for filtered ANNS, which consistently outperform their general-purpose counterparts <cite class="ltx_citemacro_citep">(<bibref bibrefs="neurips23bigann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. For example, FilteredDiskANN, an adaptation of DiskANN <cite class="ltx_citemacro_citep">(<bibref bibrefs="diskann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> that supports filters that are conjunctive ORs of one or more boolean labels, builds a graph that can be traversed by a modified beam search excluding points not matching the filter <cite class="ltx_citemacro_citep">(<bibref bibrefs="filtereddiskANN" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Another approach is CAPS, which is an inverted index where each partition stores a Huffman tree dividing points by their labels <cite class="ltx_citemacro_citep">(<bibref bibrefs="gupta2023caps" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. While these methods are the state of the art, they are restricted to filtering on boolean labels; they do not support window search. Finally, recent work <cite class="ltx_citemacro_citep">(<bibref bibrefs="mohoney2023high" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> presents a tree based nearest neighbor engine for combined vector-metadata searches and show range-based filters as an application, but their partitioning requires historical queries and many of their gains come from batching queries to avoid redundant computation. Their method also only builds ANNS indices in the “leaves” of the tree, whereas we build indices at internal nodes, which is the key idea that ensures our method only needs to query a logarithmic number of ANNS indices. Thus, although their code is not open source, we do not expect their system to perform as well as ours on window search.</p>
    </para>
    <para class="ltx_noindent" xml:id="S2.p3">
      <p><text font="bold"><!--  %“subsection–Approximate Nearest Neighbor Search (ANNS)˝ -->Segment Trees.</text>
Segment trees (and the closely related Fenwick
trees <cite class="ltx_citemacro_citep">(<bibref bibrefs="fenwick1994new" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>) are tree data structures built over an
array that recursively sub-divide the array to obtain a balanced
binary tree <cite class="ltx_citemacro_citep">(<bibref bibrefs="bentley1977algorithms" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. By storing appropriate augmented values
at the internal nodes of this tree, these data structures can be
used to support a variety of queries over arbitrary intervals
in the array, e.g., computing the maximum value in any given query interval
<Math mode="inline" tex="[l,r]" text="closed-interval@(l, r)" xml:id="S2.p3.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="closed-interval"/>
                <XMRef idref="S2.p3.m1.1"/>
                <XMRef idref="S2.p3.m1.2"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">[</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S2.p3.m1.1">l</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S2.p3.m1.2">r</XMTok>
                <XMTok role="CLOSE" stretchy="false">]</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>.
Segment and Fenwick trees can be generalized to higher
fanout trees, i.e., <Math mode="inline" tex="B" text="B" xml:id="S2.p3.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>-ary segment or Fenwick trees that have a
fanout of <Math mode="inline" tex="B" text="B" xml:id="S2.p3.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math> and a height of <Math mode="inline" tex="\lceil\log_{B}n\rceil" text="ceiling@((logarithm _ B)@(n))" xml:id="S2.p3.m4">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="ceiling"/>
                <XMRef idref="S2.p3.m4.1"/>
              </XMApp>
              <XMWrap>
                <XMTok name="lceil" role="OPEN" stretchy="false">⌈</XMTok>
                <XMApp xml:id="S2.p3.m4.1">
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">B</XMTok>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                </XMApp>
                <XMTok name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="pibiri2021practical" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Our work adapts these tree structures to the window search problem by designing a similar data structure that stores ANNS indices at internal tree nodes.
<cite class="ltx_citemacro_citet"><bibref bibrefs="huang2023faster" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> use the Fenwick tree for filtered search within a clustering context, but their work only considers a prefix interval (<Math mode="inline" tex="[0,r]" text="closed-interval@(0, r)" xml:id="S2.p3.m5">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="closed-interval"/>
                <XMRef idref="S2.p3.m5.1"/>
                <XMRef idref="S2.p3.m5.2"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">[</XMTok>
                <XMTok meaning="0" role="NUMBER" xml:id="S2.p3.m5.1">0</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S2.p3.m5.2">r</XMTok>
                <XMTok role="CLOSE" stretchy="false">]</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>), and they use <Math mode="inline" tex="k" text="k" xml:id="S2.p3.m6">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math>d-trees, which are designed for low-dimensional data.</p>
    </para>
    <para class="ltx_noindent" xml:id="S2.p4">
      <p><text font="bold">Filtered Search in Relational Databases.</text>
Traditional relational database systems support arbitrary range-based queries by constructing B-trees or log-structured merge trees <cite class="ltx_citemacro_citep">(<bibref bibrefs="ilyas2008topk,qader2018comparative" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. These databases have complex query planning systems that determine during execution whether and how to query these constructed indices (see, e.g., <cite class="ltx_citemacro_citep">(<bibref bibrefs="kurc1999querying" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>), but typically do not have support for ANNS. The few that do have support for ANNS use an existing open-source ANNS implementation to perform the search (e.g., pgvector <cite class="ltx_citemacro_citep">(<bibref bibrefs="pgvector" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, an ANNS add-on for PostgreSQL, uses HNSW <cite class="ltx_citemacro_citep">(<bibref bibrefs="malkov2018efficient" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
<!--  %“josh–How does this sound? This source seems decent?˝ -->    <table inlist="lot" labels="LABEL:tab:notation" placement="t" xml:id="S2.T1">
      <tags>
        <tag>Table 1</tag>
        <tag role="autoref">Table 1</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Table 1</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>Notation used in this paper.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Table 1</tag>Notation used in this paper.
</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="center" border="tt" thead="column row"><text fontsize="90%">Symbol</text></td>
            <td align="left" border="tt" thead="column"><text fontsize="90%">Definition</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center" border="t" thead="row"><Math mode="inline" tex="D" text="D" xml:id="S2.T1.m1">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
                </XMath>
              </Math></td>
            <td align="left" border="t"><text fontsize="90%">Vectors to index</text></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="N" text="N" xml:id="S2.T1.m2">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">N</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><Math mode="inline" tex="|D|" text="absolute-value@(D)" xml:id="S2.T1.m3">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="S2.T1.m3.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S2.T1.m3.1">D</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math><text fontsize="90%">, the cardinality of </text><Math mode="inline" tex="D" text="D" xml:id="S2.T1.m4">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="V" text="V" xml:id="S2.T1.m5">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">V</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Metric space </text><Math mode="inline" tex="D" text="D" xml:id="S2.T1.m6">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
                </XMath>
              </Math><text fontsize="90%"> is in, e.g., </text><Math mode="inline" tex="R^{n}" text="R ^ n" xml:id="S2.T1.m7">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">n</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="q" text="q" xml:id="S2.T1.m8">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">q</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Query vector </text><Math mode="inline" tex="q\in V" text="q element-of V" xml:id="S2.T1.m9">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">q</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S2.T1.m10">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S2.T1.m10.1"/>
                      <XMRef idref="S2.T1.m10.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S2.T1.m10.1">a</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S2.T1.m10.2">b</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Window filter; see </text><ref fontsize="90%" labelref="LABEL:def:filtered_dataset" show="creftype~refnum"/></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="c" text="c" xml:id="S2.T1.m11">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">c</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Approximation factor for window search</text></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="\texttt{dist}_{V}" text="[dist] _ V" xml:id="S2.T1.m12">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter" fontsize="90%">dist</text></XMText>
                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Distance function between points in </text><Math mode="inline" tex="D" text="D" xml:id="S2.T1.m13">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="d" text="d" xml:id="S2.T1.m14">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">d</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Running time to evaluate </text><Math mode="inline" tex="\texttt{dist}_{V}" text="[dist] _ V" xml:id="S2.T1.m15">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter" fontsize="90%">dist</text></XMText>
                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="A" text="A" xml:id="S2.T1.m16">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">A</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Arbitrary </text><Math mode="inline" tex="c" text="c" xml:id="S2.T1.m17">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">c</XMTok>
                </XMath>
              </Math><text fontsize="90%">-ANN algorithm, e.g., Vamana</text></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="A_{q}" text="A _ q" xml:id="S2.T1.m18">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">A</XMTok>
                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">q</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Query time of </text><Math mode="inline" tex="A" text="A" xml:id="S2.T1.m19">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">A</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="\beta" text="beta" xml:id="S2.T1.m20">
                <XMath>
                  <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Split factor for a </text><Math mode="inline" tex="\beta" text="beta" xml:id="S2.T1.m21">
                <XMath>
                  <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                </XMath>
              </Math><text fontsize="90%">-WST; see </text><ref fontsize="90%" labelref="LABEL:alg:build_tree" show="creftype~refnum"/></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="\alpha" text="alpha" xml:id="S2.T1.m22">
                <XMath>
                  <XMTok font="italic" fontsize="90%" name="alpha" role="UNKNOWN">α</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Pruning parameter for Vamana</text></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="\delta" text="delta" xml:id="S2.T1.m23">
                <XMath>
                  <XMTok font="italic" fontsize="90%" name="delta" role="UNKNOWN">δ</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Doubling dimension</text></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="R" text="R" xml:id="S2.T1.m24">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">R</XMTok>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Set of closed integer ranges in </text><Math mode="inline" tex="[1,\ldots,N]" text="list@(1, ldots, N)" xml:id="S2.T1.m25">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S2.T1.m25.1"/>
                      <XMRef idref="S2.T1.m25.2"/>
                      <XMRef idref="S2.T1.m25.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                      <XMTok fontsize="90%" meaning="1" role="NUMBER" xml:id="S2.T1.m25.1">1</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok fontsize="90%" name="ldots" role="ID" xml:id="S2.T1.m25.2">…</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S2.T1.m25.3">N</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" thead="row"><Math mode="inline" tex="\mathsf{blowup}(R)" text="blowup * R" xml:id="S2.T1.m26">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="sansserif" fontsize="90%" role="UNKNOWN">blowup</XMTok>
                    <XMDual>
                      <XMRef idref="S2.T1.m26.1"/>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S2.T1.m26.1">R</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="left"><text fontsize="90%">Max ratio of superset </text><Math mode="inline" tex="\in R" text="absent element-of R" xml:id="S2.T1.m27">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok meaning="absent"/>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">R</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"> over range length</text></td>
          </tr>
          <tr>
            <td align="center" border="bb" thead="row"><Math mode="inline" tex="\mathsf{cost}(R)" text="cost * R" xml:id="S2.T1.m28">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="sansserif" fontsize="90%" role="UNKNOWN">cost</XMTok>
                    <XMDual>
                      <XMRef idref="S2.T1.m28.1"/>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S2.T1.m28.1">R</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="left" border="bb"><text fontsize="90%">Sum of lengths of ranges in </text><Math mode="inline" tex="R" text="R" xml:id="S2.T1.m29">
                <XMath>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">R</XMTok>
                </XMath>
              </Math></td>
          </tr>
        </tbody>
      </tabular>
    </table>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Definitions</title>
    <para xml:id="S3.p1">
      <p>This section lays out definitions for the main problem that we study: window search. Notation for the next three sections can be found in <ref labelref="LABEL:tab:notation" show="creftype~refnum"/>.</p>
    </para>
    <theorem class="ltx_theorem_definition" inlist="thm theorem:definition" labels="LABEL:def:labeled-dataset" xml:id="S3.Thmtheorem1">
      <tags>
        <tag>Definition 3.1</tag>
        <tag role="autoref">3.1</tag>
        <tag role="creftype">Definition</tag>
        <tag role="creftypecap">Definition</tag>
        <tag role="creftypeplural">Definitions</tag>
        <tag role="creftypepluralcap">Definitions</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">Definition 3.1</tag>
      </tags>
      <title class="ltx_runin"><tag><text font="bold">Definition 3.1</text></tag><text font="bold">.</text></title>
      <para xml:id="S3.Thmtheorem1.p1">
        <p>[Labeled Dataset]
Consider a metric space <Math mode="inline" tex="V" text="V" xml:id="S3.Thmtheorem1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">V</XMTok>
            </XMath>
          </Math> with distance function <Math mode="inline" tex="\texttt{dist}_{V}" text="[dist] _ V" xml:id="S3.Thmtheorem1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMText><text font="typewriter">dist</text></XMText>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
              </XMApp>
            </XMath>
          </Math>. Given a label function <Math mode="inline" tex="\ell:V\rightarrow\mathbb{R}" text="ell colon V rightarrow R" xml:id="S3.Thmtheorem1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok name="colon" role="METARELOP">:</XMTok>
                <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                <XMApp>
                  <XMTok name="rightarrow" role="ARROW">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and a set <Math mode="inline" tex="D\subset V" text="D subset-of V" xml:id="S3.Thmtheorem1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
              </XMApp>
            </XMath>
          </Math>, we define a <text font="bold italic">labeled dataset</text> to be the pair <Math mode="inline" tex="(D,\ell)" text="open-interval@(D, ell)" xml:id="S3.Thmtheorem1.p1.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem1.p1.m5.1"/>
                  <XMRef idref="S3.Thmtheorem1.p1.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem1.p1.m5.1">D</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ell" role="UNKNOWN" xml:id="S3.Thmtheorem1.p1.m5.2">ℓ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.</p>
      </para>
    </theorem>
    <theorem class="ltx_theorem_definition" inlist="thm theorem:definition" labels="LABEL:def:filtered_dataset" xml:id="S3.Thmtheorem2">
      <tags>
        <tag>Definition 3.2</tag>
        <tag role="autoref">3.2</tag>
        <tag role="creftype">Definition</tag>
        <tag role="creftypecap">Definition</tag>
        <tag role="creftypeplural">Definitions</tag>
        <tag role="creftypepluralcap">Definitions</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">Definition 3.2</tag>
      </tags>
      <title class="ltx_runin"><tag><text font="bold">Definition 3.2</text></tag><text font="bold">.</text></title>
      <para xml:id="S3.Thmtheorem2.p1">
        <p>[Window Filtered Dataset]
Consider a labeled dataset <Math mode="inline" tex="(D,\ell)" text="open-interval@(D, ell)" xml:id="S3.Thmtheorem2.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem2.p1.m1.1"/>
                  <XMRef idref="S3.Thmtheorem2.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m1.1">D</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ell" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m1.2">ℓ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. We define a <text font="bold italic">window filter</text> to be an open interval <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S3.Thmtheorem2.p1.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem2.p1.m2.1"/>
                  <XMRef idref="S3.Thmtheorem2.p1.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m2.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m2.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> with <Math mode="inline" tex="a,b\in\mathbb{R}" text="list@(a, b) element-of R" xml:id="S3.Thmtheorem2.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.Thmtheorem2.p1.m3.1"/>
                    <XMRef idref="S3.Thmtheorem2.p1.m3.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m3.1">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m3.2">b</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math>, and we define a <text font="bold italic">window filtered dataset</text> to be <Math mode="inline" tex="D_{(a,b)}=\{x\in D\ |\ \ell(x)\in(a,b)\}" text="D _ (open-interval@(a, b)) = conditional-set@(x element-of D, ell * x element-of open-interval@(a, b))" xml:id="S3.Thmtheorem2.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.Thmtheorem2.p1.m4.1"/>
                      <XMRef idref="S3.Thmtheorem2.p1.m4.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m4.1">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m4.2">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="conditional-set"/>
                    <XMRef idref="S3.Thmtheorem2.p1.m4.6"/>
                    <XMRef idref="S3.Thmtheorem2.p1.m4.7"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.Thmtheorem2.p1.m4.6">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMTok font="italic" role="UNKNOWN" rpadding="5.0pt">D</XMTok>
                    </XMApp>
                    <XMTok role="MIDDLE" rpadding="5.0pt" stretchy="false">|</XMTok>
                    <XMApp xml:id="S3.Thmtheorem2.p1.m4.7">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                        <XMDual>
                          <XMRef idref="S3.Thmtheorem2.p1.m4.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m4.3">x</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.Thmtheorem2.p1.m4.4"/>
                          <XMRef idref="S3.Thmtheorem2.p1.m4.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m4.4">a</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem2.p1.m4.5">b</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </theorem>
    <theorem class="ltx_theorem_definition" inlist="thm theorem:definition" labels="LABEL:def:problem" xml:id="S3.Thmtheorem3">
      <tags>
        <tag>Definition 3.3</tag>
        <tag role="autoref">3.3</tag>
        <tag role="creftype">Definition</tag>
        <tag role="creftypecap">Definition</tag>
        <tag role="creftypeplural">Definitions</tag>
        <tag role="creftypepluralcap">Definitions</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">Definition 3.3</tag>
      </tags>
      <title class="ltx_runin"><tag><text font="bold">Definition 3.3</text></tag><text font="bold">.</text></title>
      <para xml:id="S3.Thmtheorem3.p1">
        <p>[Window Search]
Given a labeled dataset <Math mode="inline" tex="(D,\ell)" text="open-interval@(D, ell)" xml:id="S3.Thmtheorem3.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem3.p1.m1.1"/>
                  <XMRef idref="S3.Thmtheorem3.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m1.1">D</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ell" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m1.2">ℓ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, we define a <text font="bold italic">query</text> to be a vector <Math mode="inline" tex="q\in V" text="q element-of V" xml:id="S3.Thmtheorem3.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
              </XMApp>
            </XMath>
          </Math> and a window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S3.Thmtheorem3.p1.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem3.p1.m3.1"/>
                  <XMRef idref="S3.Thmtheorem3.p1.m3.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m3.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m3.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, and we define the <text font="bold italic">window filtered nearest neighbor</text> to be
<Math content-tex="q^{*}=\argmin_{x\in D_{(a,b)}}\texttt{dist}_{V}(x,q)" mode="inline" tex="q^{*}=\operatorname*{arg\,min}_{x\in D_{(a,b)}}\texttt{dist}_{V}(x,q)" text="q ^ * = (argmin _ (x element-of D _ (open-interval@(a, b))))@([dist] _ V) * open-interval@(x, q)" xml:id="S3.Thmtheorem3.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">q</XMTok>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                        <XMTok role="UNKNOWN">min</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S3.Thmtheorem3.p1.m4.1"/>
                              <XMRef idref="S3.Thmtheorem3.p1.m4.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="50%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m4.1">a</XMTok>
                              <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m4.2">b</XMTok>
                              <XMTok fontsize="50%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter">dist</text></XMText>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.Thmtheorem3.p1.m4.3"/>
                      <XMRef idref="S3.Thmtheorem3.p1.m4.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m4.3">x</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem3.p1.m4.4">q</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </theorem>
    <theorem class="ltx_theorem_definition" inlist="thm theorem:definition" labels="LABEL:def:aws" xml:id="S3.Thmtheorem4">
      <tags>
        <tag>Definition 3.4</tag>
        <tag role="autoref">3.4</tag>
        <tag role="creftype">Definition</tag>
        <tag role="creftypecap">Definition</tag>
        <tag role="creftypeplural">Definitions</tag>
        <tag role="creftypepluralcap">Definitions</tag>
        <tag role="refnum">3.4</tag>
        <tag role="typerefnum">Definition 3.4</tag>
      </tags>
      <title class="ltx_runin"><tag><text font="bold">Definition 3.4</text></tag><text font="bold">.</text></title>
      <para xml:id="S3.Thmtheorem4.p1">
        <p>[Approximate Window Search]
Finally, given a labeled dataset <Math mode="inline" tex="(D,\ell)" text="open-interval@(D, ell)" xml:id="S3.Thmtheorem4.p1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem4.p1.m1.1"/>
                  <XMRef idref="S3.Thmtheorem4.p1.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m1.1">D</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ell" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m1.2">ℓ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, we define <Math mode="inline" tex="c" text="c" xml:id="S3.Thmtheorem4.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math><text font="bold italic">-approximate window search</text> to be the task of constructing a data structure that takes in a query <Math mode="inline" tex="q\in V" text="q element-of V" xml:id="S3.Thmtheorem4.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" role="UNKNOWN">V</XMTok>
              </XMApp>
            </XMath>
          </Math> with window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S3.Thmtheorem4.p1.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S3.Thmtheorem4.p1.m4.1"/>
                  <XMRef idref="S3.Thmtheorem4.p1.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m4.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m4.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> and returns a point <Math mode="inline" tex="y\in D_{(a,b)}" text="y element-of D _ (open-interval@(a, b))" xml:id="S3.Thmtheorem4.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m5.1"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m5.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m5.1">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m5.2">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> such that
<Math mode="inline" tex="\texttt{dist}_{V}(q,y)\leq c\cdot\texttt{dist}_{V}(q,q^{*})" text="[dist] _ V * open-interval@(q, y) &lt;= (c cdot [dist] _ V) * open-interval@(q, q ^ *)" xml:id="S3.Thmtheorem4.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter">dist</text></XMText>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m6.1"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m6.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m6.1">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m6.2">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter">dist</text></XMText>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m6.3"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m6.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m6.3">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S3.Thmtheorem4.p1.m6.4">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
or <Math mode="inline" tex="\emptyset" text="empty-set" xml:id="S3.Thmtheorem4.p1.m7">
            <XMath>
              <XMTok meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
            </XMath>
          </Math> if <Math mode="inline" tex="D_{(a,b)}=\emptyset" text="D _ (open-interval@(a, b)) = empty-set" xml:id="S3.Thmtheorem4.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m8.1"/>
                      <XMRef idref="S3.Thmtheorem4.p1.m8.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m8.1">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Thmtheorem4.p1.m8.2">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %“shangdi–define $“texttt–dist˝˙V$? why we can’t just use $d$?˝ “josh–Maybe using $“texttt–dist˝˙V$ makes it more clear its in relation to the metric space $V$? See Definition 3.1 (I just changed it to be $“texttt–dist˝˙V$, must have lost the underscore V at some point˝ “shangdi–I see, I got it now. ˝ -->.</p>
      </para>
    </theorem>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Window Search Algorithms</title>
    <para xml:id="S4.p1">
      <p>In this section, we describe algorithms for solving the window search problem. In <ref labelref="LABEL:sec:naive_baslines" show="creftype~refnum"/>, we examine two naive baselines for solving window search; in <ref labelref="LABEL:sec:beta_wst" show="creftype~refnum"/>, we introduce a new data structure, the <Math mode="inline" tex="\beta" text="beta" xml:id="S4.p1.m1">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math>-WST, and design an algorithm to query it; and in <ref labelref="LABEL:sec:query_methods" show="creftype~refnum"/>, we examine additional algorithms for solving window search.</p>
    </para>
    <para xml:id="S4.p2">
      <p>We note that with a fixed window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.p2.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="open-interval"/>
                <XMRef idref="S4.p2.m1.1"/>
                <XMRef idref="S4.p2.m1.2"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S4.p2.m1.1">a</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S4.p2.m1.2">b</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, a reasonable approach to solving window search is simply to index <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="S4.p2.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.p2.m2.1"/>
                  <XMRef idref="S4.p2.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.p2.m2.1">a</XMTok>
                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.p2.m2.2">b</XMTok>
                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> using an off-the-shelf ANNS algorithm and then query it with each <Math mode="inline" tex="q" text="q" xml:id="S4.p2.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">q</XMTok>
          </XMath>
        </Math>. Thus, we are interested in the more challenging problem where queries have <text font="italic">arbitrary</text> window filters.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:naive_baslines" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Naive Baselines</title>
      <para xml:id="S4.SS1.p1">
        <p>As we discuss in <ref labelref="LABEL:sec:prefiltering_and_postfiltering" show="creftype~refnum"/>, prefiltering and postfiltering are the current state of the art for filtered search. Here, we describe the specific way we implement them in more detail, as they are the main baselines that we compare against in our experiments.</p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p><Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S4.SS1.p2.m1">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
            </XMath>
          </Math> is a naive baseline that works by sorting all of the points by label ahead of time. Given a query <Math mode="inline" tex="x" text="x" xml:id="S4.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> with window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.SS1.p2.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS1.p2.m3.1"/>
                  <XMRef idref="S4.SS1.p2.m3.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m3.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m3.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, we perform binary search on the sorted labels to find the start and end of the range that meet the filter constraints, and then find the distance between <Math mode="inline" tex="x" text="x" xml:id="S4.SS1.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> and every point in the range and return the closest point.</p>
      </para>
      <para xml:id="S4.SS1.p3">
        <p><Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S4.SS1.p3.m1">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
            </XMath>
          </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="yu2023pecann,chen2020fast" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> is a second baseline that works by first building an index on all of <Math mode="inline" tex="D" text="D" xml:id="S4.SS1.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> using an ANNS algorithm <Math mode="inline" tex="A" text="A" xml:id="S4.SS1.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math>. To perform a window search, we query <Math mode="inline" tex="A" text="A" xml:id="S4.SS1.p3.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math> for <Math mode="inline" tex="k\geq 1" text="k &gt;= 1" xml:id="S4.SS1.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> points, and then repeatedly double <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p3.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> until at least one point is returned that has a label within <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.SS1.p3.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS1.p3.m7.1"/>
                  <XMRef idref="S4.SS1.p3.m7.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p3.m7.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p3.m7.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Finally, we return the closest of these points. We additionally define a hyper-parameter called <Math mode="inline" tex="\mathsf{final\_multiply}" text="final * _ * multiply" xml:id="S4.SS1.p3.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="sansserif" role="UNKNOWN">final</XMTok>
                <XMTok role="UNKNOWN">_</XMTok>
                <XMTok font="sansserif" role="UNKNOWN">multiply</XMTok>
              </XMApp>
            </XMath>
          </Math>; if this is greater than <Math mode="inline" tex="1" text="1" xml:id="S4.SS1.p3.m9">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>, then we perform a final additional search with a <Math mode="inline" tex="\mathsf{final\_multiply}" text="final * _ * multiply" xml:id="S4.SS1.p3.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="sansserif" role="UNKNOWN">final</XMTok>
                <XMTok role="UNKNOWN">_</XMTok>
                <XMTok font="sansserif" role="UNKNOWN">multiply</XMTok>
              </XMApp>
            </XMath>
          </Math> times larger value of <Math mode="inline" tex="k" text="k" xml:id="S4.SS1.p3.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:algorithm" placement="t" xml:id="S4.F1">
        <tags>
          <tag>Figure 1</tag>
          <tag role="autoref">Figure 1</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Figure 1</tag>
        </tags>
        <p align="center" class="ltx_align_center"><graphics candidates="images/wst.drawio.pdf" graphic="images/wst.drawio.pdf" options="width=241.84842pt,keepaspectratio=true" xml:id="S4.F1.g1"/></p>
        <toccaption class="ltx_centering"><tag close=" ">1</tag><text font="bold">Top left</text>: A <Math mode="inline" tex="2" text="2" xml:id="S4.F1.m1">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math>-WST. Each node of the tree in green contains a recursive partition of the entire dataset <Math mode="inline" tex="D" text="D" xml:id="S4.F1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> indexed by an ANNS algorithm (see <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>). The graph in each green node represents a graph-based ANNS index built by an algorithm like Vamana. <text font="bold">Top right</text>: the structure of an example label space partitioning method that ensures that no optimized postfiltering query will have a large blowup (see <ref labelref="LABEL:thm:betterblowup" show="creftype~refnum"/>). <text font="bold">Bottom</text>: Different query methods; from left to right: a tree-based query as in <ref labelref="LABEL:alg:query" show="creftype~refnum"/>, an optimized postfiltering query with a small blowup (see <ref labelref="LABEL:def:blowup-factor" show="creftype~refnum"/>), and an optimized postfiltering query with a large blowup (see <ref labelref="LABEL:def:blowup-factor" show="creftype~refnum"/>).
</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 1</tag><text font="bold">Top left</text>: A <Math mode="inline" tex="2" text="2" xml:id="S4.F1.m3">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math>-WST. Each node of the tree in green contains a recursive partition of the entire dataset <Math mode="inline" tex="D" text="D" xml:id="S4.F1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> indexed by an ANNS algorithm (see <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>). The graph in each green node represents a graph-based ANNS index built by an algorithm like Vamana. <text font="bold">Top right</text>: the structure of an example label space partitioning method that ensures that no optimized postfiltering query will have a large blowup (see <ref labelref="LABEL:thm:betterblowup" show="creftype~refnum"/>). <text font="bold">Bottom</text>: Different query methods; from left to right: a tree-based query as in <ref labelref="LABEL:alg:query" show="creftype~refnum"/>, an optimized postfiltering query with a small blowup (see <ref labelref="LABEL:def:blowup-factor" show="creftype~refnum"/>), and an optimized postfiltering query with a large blowup (see <ref labelref="LABEL:def:blowup-factor" show="creftype~refnum"/>).
</caption>
      </figure>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:beta_wst" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag><Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.m1">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math>-Window Search Tree</title>
<!--  %Now that we have the problem defined, we can consider algorithms to solve it. 
     %More formally, consider a class of ANN search algorithms $A$ that solve the $c$-approximate nearest neighbor ($c$-ANN) problem, and let $A(D˙–(a, b)˝)$ denote the index built from the window filtered dataset $D˙–(a,b)˝$ such that $A(D˙–(a,b)˝)(q)$ returns a $c$-ANN of $q$. 
     %If $A$ solves the traditional $c$-ANN problem, then $A(D˙–(a,b)˝)$ solves the $c$-approximate Window Search problem with the fixed window filter $(a,b)$ with the same time and space bounds. “laxman–The last few sentences could potentially be dropped? It seems like we’re just saying that any $c$-ANN solution can be used to solve the problem if the window filter is fixed up front.˝ -->      <para xml:id="S4.SS2.p1">
        <p><!--  %**** paper.tex Line 350 **** -->We now propose a data structure that we call a <!--  %A more challenging problem is one where we do not know any window filters during indexing, and during querying we receive queries with arbitrary window filters. --><Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math><text font="bold">-Window Search Tree, or <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m2">
              <XMath>
                <XMTok font="medium italic" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math>-WST</text>. This data structure with <Math mode="inline" tex="\beta=2" text="beta = 2" xml:id="S4.SS2.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> is illustrated in the top left of <ref labelref="LABEL:fig:algorithm" show="creftype~refnum"/> and the accompanying query method is illustrated in the bottom left. The overall idea to construct a <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m4">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST is to split <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p1.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> into <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m6">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> subsets, one corresponding to each child node, construct an instance of <Math mode="inline" tex="A" text="A" xml:id="S4.SS2.p1.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math> at each node, and recurse on each child. We continue this process until the subset size is less than <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p1.m8">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>, in which case we just store the points directly.</p>
      </para>
      <para xml:id="S4.SS2.p2">
        <p>More formally, let <Math mode="inline" tex="x_{1},\ldots,x_{N}" text="list@(x _ 1, ldots, x _ N)" xml:id="S4.SS2.p2.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S4.SS2.p2.m1.2"/>
                  <XMRef idref="S4.SS2.p2.m1.1"/>
                  <XMRef idref="S4.SS2.p2.m1.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S4.SS2.p2.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S4.SS2.p2.m1.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS2.p2.m1.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> be the points of <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> sorted by <Math mode="inline" tex="\ell" text="ell" xml:id="S4.SS2.p2.m3">
            <XMath>
              <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
            </XMath>
          </Math>, such that <Math mode="inline" tex="\ell(x_{1})\leq\ell(x_{2})\ldots\leq\ell(x_{n})" text="ell * x _ 1 &lt;= ell * x _ 2 * ldots &lt;= ell * x _ n" xml:id="S4.SS2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS2.p2.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS2.p2.m4.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS2.p2.m4.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS2.p2.m4.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok name="ldots" role="ID">…</XMTok>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS2.p2.m4.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS2.p2.m4.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. With a slight abuse of notation, we define the <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="S4.SS2.p2.m5">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> of an empty set to be the empty set. A <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p2.m6">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST works as follows:</p>
      </para>
      <para xml:id="S4.SS2.p3">
        <p><text font="bold">Index Construction.</text> A <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p3.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST <Math mode="inline" tex="T" text="T" xml:id="S4.SS2.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> can be constructed as shown in <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>.
In the base case, if the dataset <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> is small, we do not construct any tree node (Lines <ref labelref="LABEL:alg:build_tree:line:if"/>–<ref labelref="LABEL:alg:build_tree:line:return_null"/><!--  %Given a dataset $D$ that is larger than the base case (Line~“ref–alg:build˙tree:line:if˝), -->).
Otherwise, we construct an ANNS index of <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p3.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> (Line <ref labelref="LABEL:alg:build_tree:line:get_index"/>). On Lines <ref labelref="LABEL:alg:build_tree:line:sizes1"/>–<ref labelref="LABEL:alg:build_tree:line:sizes2"/>, we define the sizes for splitting <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p3.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> into <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p3.m6">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> partitions, all of which are equally sized except the last, which may be smaller. On Line <ref labelref="LABEL:alg:build_tree:line:initialize_children"/>, we initialize the children nodes. We then loop through every partition in parallel (Lines <ref labelref="LABEL:alg:build_tree:line:parfor"/>–<ref labelref="LABEL:alg:build_tree:line:build_tree_recursive"/>) and recursively call <text class="ltx_markedasmath" font="typewriter">BuildTree</text> on the set of points (sorted by label) corresponding to the start and end of the partition. Finally, on Line <ref labelref="LABEL:alg:build_tree:line:return_final"/><!--  %consists of either just the points $D$ if we execute the base case on line $3$, or otherwise --> we return the constructed tree, which
is a tuple consisting of an ANNS index built on <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p3.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>, the result of <text class="ltx_markedasmath" font="typewriter">BuildTree</text> called on each child along with the size of each child, and the point set <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p3.m10">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:alg:build_tree" placement="t" xml:id="alg1">
        <tags>
          <tag><text font="bold">Algorithm 1</text></tag>
          <tag role="autoref">1</tag>
          <tag role="creftype">Algorithm</tag>
          <tag role="creftypecap">Algorithm</tag>
          <tag role="creftypeplural">Algorithms</tag>
          <tag role="creftypepluralcap">Algorithms</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Algorithm 1</tag>
        </tags>
        <toccaption><tag close=" ">1</tag>BuildTree<Math mode="inline" tex="(A,\beta,(D,\ell))" text="vector@(A, beta, open-interval@(D, ell))" xml:id="alg1.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg1.m1.3"/>
                  <XMRef idref="alg1.m1.4"/>
                  <XMRef idref="alg1.m1.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg1.m1.3">A</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN" xml:id="alg1.m1.4">β</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg1.m1.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg1.m1.1"/>
                      <XMRef idref="alg1.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg1.m1.1">D</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ell" role="UNKNOWN" xml:id="alg1.m1.2">ℓ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 1</text></tag> BuildTree<Math mode="inline" tex="(A,\beta,(D,\ell))" text="vector@(A, beta, open-interval@(D, ell))" xml:id="alg1.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg1.m2.3"/>
                  <XMRef idref="alg1.m2.4"/>
                  <XMRef idref="alg1.m2.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg1.m2.3">A</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN" xml:id="alg1.m2.4">β</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg1.m2.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg1.m2.1"/>
                      <XMRef idref="alg1.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg1.m2.1">D</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ell" role="UNKNOWN" xml:id="alg1.m2.2">ℓ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></caption>
        <listing>
          <listingline labels="LABEL:alg:build_tree:line:input" xml:id="alg1.l1"><tags>
              <tag><text fontsize="80%">1:</text></tag>
              <tag role="autoref">1</tag>
              <tag role="refnum">1</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Input:</text><text fontsize="90%"> Dataset </text><Math mode="inline" tex="D" text="D" xml:id="alg1.l1.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math><text fontsize="90%"> with points </text><Math mode="inline" tex="x_{1},\ldots,x_{|D|}" text="list@(x _ 1, ldots, x _ (absolute-value@(D)))" xml:id="alg1.l1.m2">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="alg1.l1.m2.3"/>
                    <XMRef idref="alg1.l1.m2.2"/>
                    <XMRef idref="alg1.l1.m2.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="alg1.l1.m2.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                      <XMTok fontsize="63%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok fontsize="90%" name="ldots" role="ID" xml:id="alg1.l1.m2.2">…</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMApp xml:id="alg1.l1.m2.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="alg1.l1.m2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="63%" role="OPEN" stretchy="false">|</XMTok>
                          <XMTok font="italic" fontsize="63%" role="UNKNOWN" xml:id="alg1.l1.m2.1">D</XMTok>
                          <XMTok fontsize="63%" role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%"> sorted by </text><Math mode="inline" tex="\ell" text="ell" xml:id="alg1.l1.m3">
              <XMath>
                <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMath>
            </Math><text fontsize="90%">, branching factor </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg1.l1.m4">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%">, ANNS algorithm </text><Math mode="inline" tex="A" text="A" xml:id="alg1.l1.m5">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">A</XMTok>
              </XMath>
            </Math><text fontsize="90%">.

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:output" xml:id="alg1.l2"><tags>
              <tag><text fontsize="80%">2:</text></tag>
              <tag role="autoref">2</tag>
              <tag role="refnum">2</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Output:</text><text fontsize="90%"> </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg1.l2.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%">-Window Search Tree of </text><Math mode="inline" tex="D" text="D" xml:id="alg1.l2.m2">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:if" xml:id="alg1.l3"><tags>
              <tag><text fontsize="80%">3:</text></tag>
              <tag role="autoref">3</tag>
              <tag role="refnum">3</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">if</text><text fontsize="90%"> </text><Math mode="inline" tex="|D|&lt;\beta" text="absolute-value@(D) &lt; beta" xml:id="alg1.l3.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="less-than" role="RELOP">&lt;</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="alg1.l3.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">|</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l3.m1.1">D</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">  </text><text font="bold" fontsize="90%">then</text><text fontsize="90%">

 
</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:return_null" xml:id="alg1.l4"><tags>
              <tag><text fontsize="80%">4:</text></tag>
              <tag role="autoref">4</tag>
              <tag role="refnum">4</tag>
            </tags><text fontsize="90%">    </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math mode="inline" tex="(\texttt{NULL},\texttt{NULL},D)" text="vector@([NULL], [NULL], D)" xml:id="alg1.l4.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="alg1.l4.m1.1"/>
                    <XMRef idref="alg1.l4.m1.2"/>
                    <XMRef idref="alg1.l4.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMText xml:id="alg1.l4.m1.1"><text font="typewriter" fontsize="90%">NULL</text></XMText>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMText xml:id="alg1.l4.m1.2"><text font="typewriter" fontsize="90%">NULL</text></XMText>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l4.m1.3">D</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:get_index" xml:id="alg1.l5"><tags>
              <tag><text fontsize="80%">5:</text></tag>
              <tag role="autoref">5</tag>
              <tag role="refnum">5</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{index}\leftarrow A(D)" text="[index] leftarrow A * D" xml:id="alg1.l5.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">index</text></XMText>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">A</XMTok>
                    <XMDual>
                      <XMRef idref="alg1.l5.m1.1"/>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l5.m1.1">D</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">
{The next two lines define the sizes of the </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg1.l5.m2">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%"> subsets; all are equal size except the last}

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:sizes1" xml:id="alg1.l6"><tags>
              <tag><text fontsize="80%">6:</text></tag>
              <tag role="autoref">6</tag>
              <tag role="refnum">6</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{sizes}[1,\ldots,\beta-1]\leftarrow\lceil|D|/\beta\rceil" text="[sizes] * list@(1, ldots, beta - 1) leftarrow ceiling@(absolute-value@(D) / beta)" xml:id="alg1.l6.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">sizes</text></XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="alg1.l6.m1.1"/>
                        <XMRef idref="alg1.l6.m1.2"/>
                        <XMRef idref="alg1.l6.m1.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                        <XMTok fontsize="90%" meaning="1" role="NUMBER" xml:id="alg1.l6.m1.1">1</XMTok>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="90%" name="ldots" role="ID" xml:id="alg1.l6.m1.2">…</XMTok>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="alg1.l6.m1.4">
                          <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                          <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ceiling"/>
                      <XMRef idref="alg1.l6.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" name="lceil" role="OPEN" stretchy="false">⌈</XMTok>
                      <XMApp xml:id="alg1.l6.m1.5">
                        <XMTok fontsize="90%" meaning="divide" role="MULOP">/</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="alg1.l6.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok fontsize="90%" role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l6.m1.3">D</XMTok>
                            <XMTok fontsize="90%" role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                      <XMTok fontsize="90%" name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:sizes2" xml:id="alg1.l7"><tags>
              <tag><text fontsize="80%">7:</text></tag>
              <tag role="autoref">7</tag>
              <tag role="refnum">7</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{sizes}[\beta]\leftarrow|D|-(\beta-1)\cdot\lceil|D|/\beta\rceil" text="[sizes] * delimited-[]@(beta) leftarrow absolute-value@(D) - (beta - 1) cdot ceiling@(absolute-value@(D) / beta)" xml:id="alg1.l7.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">sizes</text></XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="alg1.l7.m1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                        <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN" xml:id="alg1.l7.m1.1">β</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="alg1.l7.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">|</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l7.m1.2">D</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok fontsize="90%" name="cdot" role="MULOP">⋅</XMTok>
                      <XMDual>
                        <XMRef idref="alg1.l7.m1.4"/>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="alg1.l7.m1.4">
                            <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                            <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="ceiling"/>
                          <XMRef idref="alg1.l7.m1.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" name="lceil" role="OPEN" stretchy="false">⌈</XMTok>
                          <XMApp xml:id="alg1.l7.m1.5">
                            <XMTok fontsize="90%" meaning="divide" role="MULOP">/</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="alg1.l7.m1.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="90%" role="OPEN" stretchy="false">|</XMTok>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l7.m1.3">D</XMTok>
                                <XMTok fontsize="90%" role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                          </XMApp>
                          <XMTok fontsize="90%" name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:initialize_children" xml:id="alg1.l8"><tags>
              <tag><text fontsize="80%">8:</text></tag>
              <tag role="autoref">8</tag>
              <tag role="refnum">8</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{children}[1,\ldots,\beta]\leftarrow\texttt{NULL}" text="[children] * list@(1, ldots, beta) leftarrow [NULL]" xml:id="alg1.l8.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">children</text></XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="alg1.l8.m1.1"/>
                        <XMRef idref="alg1.l8.m1.2"/>
                        <XMRef idref="alg1.l8.m1.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                        <XMTok fontsize="90%" meaning="1" role="NUMBER" xml:id="alg1.l8.m1.1">1</XMTok>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="90%" name="ldots" role="ID" xml:id="alg1.l8.m1.2">…</XMTok>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN" xml:id="alg1.l8.m1.3">β</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMText><text font="typewriter" fontsize="90%">NULL</text></XMText>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:parfor" xml:id="alg1.l9"><tags>
              <tag><text fontsize="80%">9:</text></tag>
              <tag role="autoref">9</tag>
              <tag role="refnum">9</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">for</text><text fontsize="90%"> </text><Math mode="inline" tex="i\leftarrow 1" text="i leftarrow 1" xml:id="alg1.l9.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">i</XMTok>
                  <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">to</text><text fontsize="90%"> </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg1.l9.m2">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">do in parallel</text><text fontsize="90%">

 
</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:start_calculation" xml:id="alg1.l10"><tags>
              <tag><text fontsize="80%">10:</text></tag>
              <tag role="autoref">10</tag>
              <tag role="refnum">10</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\texttt{start}\leftarrow(i-1)\cdot\lceil|D|/\beta\rceil+1" text="[start] leftarrow (i - 1) cdot ceiling@(absolute-value@(D) / beta) + 1" xml:id="alg1.l10.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">start</text></XMText>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok fontsize="90%" name="cdot" role="MULOP">⋅</XMTok>
                      <XMDual>
                        <XMRef idref="alg1.l10.m1.2"/>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="alg1.l10.m1.2">
                            <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN">i</XMTok>
                            <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="ceiling"/>
                          <XMRef idref="alg1.l10.m1.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" name="lceil" role="OPEN" stretchy="false">⌈</XMTok>
                          <XMApp xml:id="alg1.l10.m1.3">
                            <XMTok fontsize="90%" meaning="divide" role="MULOP">/</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="alg1.l10.m1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="90%" role="OPEN" stretchy="false">|</XMTok>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l10.m1.1">D</XMTok>
                                <XMTok fontsize="90%" role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
                          </XMApp>
                          <XMTok fontsize="90%" name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:end_calculation" xml:id="alg1.l11"><tags>
              <tag><text fontsize="80%">11:</text></tag>
              <tag role="autoref">11</tag>
              <tag role="refnum">11</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\texttt{end}\leftarrow\texttt{start}+\texttt{sizes}[i]" text="[end] leftarrow [start] + [sizes] * delimited-[]@(i)" xml:id="alg1.l11.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">end</text></XMText>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">start</text></XMText>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text font="typewriter" fontsize="90%">sizes</text></XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="alg1.l11.m1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l11.m1.1">i</XMTok>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:build_tree_recursive" xml:id="alg1.l12"><tags>
              <tag><text fontsize="80%">12:</text></tag>
              <tag role="autoref">12</tag>
              <tag role="refnum">12</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\texttt{children}[i]\leftarrow" text="[children] * delimited-[]@(i) leftarrow absent" xml:id="alg1.l12.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">children</text></XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="alg1.l12.m1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l12.m1.1">i</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok meaning="absent"/>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> BuildTree</text><Math mode="inline" tex="(A,\beta,(D_{(x_{\texttt{start}},x_{\texttt{end}-1})},\ell))" text="vector@(A, beta, open-interval@(D _ (open-interval@(x _ [start], x _ ([end] - 1))), ell))" xml:id="alg1.l12.m2">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="alg1.l12.m2.4"/>
                    <XMRef idref="alg1.l12.m2.5"/>
                    <XMRef idref="alg1.l12.m2.6"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l12.m2.4">A</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN" xml:id="alg1.l12.m2.5">β</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMDual xml:id="alg1.l12.m2.6">
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg1.l12.m2.6.1"/>
                        <XMRef idref="alg1.l12.m2.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg1.l12.m2.6.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="alg1.l12.m2.1"/>
                              <XMRef idref="alg1.l12.m2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="63%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="alg1.l12.m2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="63%" role="UNKNOWN">x</XMTok>
                                <XMText><text font="typewriter" fontsize="45%">start</text></XMText>
                              </XMApp>
                              <XMTok fontsize="63%" role="PUNCT">,</XMTok>
                              <XMApp xml:id="alg1.l12.m2.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="63%" role="UNKNOWN">x</XMTok>
                                <XMApp>
                                  <XMTok fontsize="45%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMText><text font="typewriter" fontsize="45%">end</text></XMText>
                                  <XMTok fontsize="45%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="63%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMTok fontsize="90%" name="ell" role="UNKNOWN" xml:id="alg1.l12.m2.3">ℓ</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
          <listingline labels="LABEL:alg:build_tree:line:return_final" xml:id="alg1.l13"><tags>
              <tag><text fontsize="80%">13:</text></tag>
              <tag role="autoref">13</tag>
              <tag role="refnum">13</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math mode="inline" tex="(\texttt{index},(\texttt{children},\texttt{sizes}),D)" text="vector@([index], open-interval@([children], [sizes]), D)" xml:id="alg1.l13.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="alg1.l13.m1.3"/>
                    <XMRef idref="alg1.l13.m1.5"/>
                    <XMRef idref="alg1.l13.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMText xml:id="alg1.l13.m1.3"><text font="typewriter" fontsize="90%">index</text></XMText>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMDual xml:id="alg1.l13.m1.5">
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg1.l13.m1.1"/>
                        <XMRef idref="alg1.l13.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                        <XMText xml:id="alg1.l13.m1.1"><text font="typewriter" fontsize="90%">children</text></XMText>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMText xml:id="alg1.l13.m1.2"><text font="typewriter" fontsize="90%">sizes</text></XMText>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg1.l13.m1.4">D</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">

</text></listingline>
        </listing>
      </float>
      <para xml:id="S4.SS2.p4">
        <p><text font="bold">Querying the Index.</text> We query a <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p4.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST using <ref labelref="LABEL:alg:query" show="creftype~refnum"/>. The input is a <Math mode="inline" tex="\beta" text="beta" xml:id="S4.SS2.p4.m2">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST <Math mode="inline" tex="T" text="T" xml:id="S4.SS2.p4.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> as built by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>, a query point <Math mode="inline" tex="q" text="q" xml:id="S4.SS2.p4.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> , and a window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.SS2.p4.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS2.p4.m5.1"/>
                  <XMRef idref="S4.SS2.p4.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p4.m5.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p4.m5.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. At a high level, <ref labelref="LABEL:alg:query" show="creftype~refnum"/> recurses through the tree constructed by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> and queries instances of <Math mode="inline" tex="A" text="A" xml:id="S4.SS2.p4.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math> that union together to equal the entire filtered dataset. If the dataset is small and the index is a leaf node <text class="ltx_markedasmath" font="typewriter">NULL</text>, we do a brute force search over <Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p4.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> (Lines <ref labelref="LABEL:alg:query:line:leaf"/>–<ref labelref="LABEL:alg:query:line:argmin1"/>). If the window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.SS2.p4.m9">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS2.p4.m9.1"/>
                  <XMRef idref="S4.SS2.p4.m9.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p4.m9.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p4.m9.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> covers all points, we query the ANNS <text class="ltx_markedasmath" font="typewriter">index</text> and return the result (Lines <ref labelref="LABEL:alg:query:line:all"/>–<ref labelref="LABEL:alg:query:line:ann"/><!--  %the algorithm first checks on line $3$ if the $index$ is $“texttt–NULL˝$. If so, this is a leaf and we do a brute force search over $D$ on line $4$. -->).
Otherwise, <!--  %Otherwise, we check on line $5$ whether all points in $D$ meet the filter constraints. If so, we just query the ANN $“texttt–index˝$ and return the result on line $6$. --><Math mode="inline" tex="D" text="D" xml:id="S4.SS2.p4.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> has some points that do not have a label in <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.SS2.p4.m12">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.SS2.p4.m12.1"/>
                  <XMRef idref="S4.SS2.p4.m12.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p4.m12.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS2.p4.m12.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, so we loop over each child (Line <ref labelref="LABEL:alg:query:line:loop"/>) and recurse into it if some of the points in the child meet the query’s window filter constraint. Finally, for each one of these children that we recurse into, we add the returned points to a candidate list <Math mode="inline" tex="\mathcal{L}_{\text{cand}}" text="L _ [cand]" xml:id="S4.SS2.p4.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                <XMText><text fontsize="70%">cand</text></XMText>
              </XMApp>
            </XMath>
          </Math>, and return the closest point from <Math mode="inline" tex="\mathcal{L}_{\text{cand}}" text="L _ [cand]" xml:id="S4.SS2.p4.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                <XMText><text fontsize="70%">cand</text></XMText>
              </XMApp>
            </XMath>
          </Math> on Line <ref labelref="LABEL:alg:query:return"/>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:query_methods" xml:id="S4.SS3">
      <tags>
        <tag>4.3</tag>
        <tag role="autoref">subsection 4.3</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.3</tag>
        <tag role="typerefnum">§4.3</tag>
      </tags>
      <title><tag close=" ">4.3</tag>Additional Query Methods</title>
      <para xml:id="S4.SS3.p1">
        <p>In addition to <ref labelref="LABEL:alg:query" show="creftype~refnum"/> above, we examine a number of additional query methods for window search that come with various trade-offs.</p>
      </para>
      <para xml:id="S4.SS3.p2">
        <itemize>
          <item xml:id="S4.I1.i1">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="S4.I1.i1.p1">
              <p><Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S4.I1.i1.p1.m1">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
                  </XMath>
                </Math> uses the index built by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> but uses a novel query algorithm, shown in <ref labelref="LABEL:alg:optimized_postfiltering" show="creftype~refnum"/>. Given a query <Math mode="inline" tex="x" text="x" xml:id="S4.I1.i1.p1.m2">
                  <XMath>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMath>
                </Math> with window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S4.I1.i1.p1.m3">
                  <XMath>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S4.I1.i1.p1.m3.1"/>
                        <XMRef idref="S4.I1.i1.p1.m3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.I1.i1.p1.m3.1">a</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S4.I1.i1.p1.m3.2">b</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>, <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S4.I1.i1.p1.m4">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
                  </XMath>
                </Math> finds the smallest subset <Math mode="inline" tex="S" text="S" xml:id="S4.I1.i1.p1.m5">
                  <XMath>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  </XMath>
                </Math> of <Math mode="inline" tex="D" text="D" xml:id="S4.I1.i1.p1.m6">
                  <XMath>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  </XMath>
                </Math> corresponding to an index that we built <Math mode="inline" tex="I=A(S)" text="I = A * S" xml:id="S4.I1.i1.p1.m7">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok font="italic" role="UNKNOWN">I</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">A</XMTok>
                        <XMDual>
                          <XMRef idref="S4.I1.i1.p1.m7.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.I1.i1.p1.m7.1">S</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math> where <Math mode="inline" tex="D_{(a,b)}\subset S" text="D _ (open-interval@(a, b)) subset-of S" xml:id="S4.I1.i1.p1.m8">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">D</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S4.I1.i1.p1.m8.1"/>
                            <XMRef idref="S4.I1.i1.p1.m8.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.I1.i1.p1.m8.1">a</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.I1.i1.p1.m8.2">b</XMTok>
                            <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    </XMApp>
                  </XMath>
                </Math>, and then queries that index using the same procedure as described in <Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S4.I1.i1.p1.m9">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
                  </XMath>
                </Math>. A “small blowup” query is one in which the smallest subset <Math mode="inline" tex="S" text="S" xml:id="S4.I1.i1.p1.m10">
                  <XMath>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  </XMath>
                </Math> is not that much larger than <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="S4.I1.i1.p1.m11">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.I1.i1.p1.m11.1"/>
                          <XMRef idref="S4.I1.i1.p1.m11.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.I1.i1.p1.m11.1">a</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.I1.i1.p1.m11.2">b</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>, whereas a “large blowup” query is one where <Math mode="inline" tex="S" text="S" xml:id="S4.I1.i1.p1.m12">
                  <XMath>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  </XMath>
                </Math> is much larger than <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="S4.I1.i1.p1.m13">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.I1.i1.p1.m13.1"/>
                          <XMRef idref="S4.I1.i1.p1.m13.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.I1.i1.p1.m13.1">a</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.I1.i1.p1.m13.2">b</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>. These small and large blowup queries are shown on the bottom right of <ref labelref="LABEL:fig:algorithm" show="creftype~refnum"/>. Blowup factor is defined formally in <ref labelref="LABEL:def:blowup-factor" show="creftype~refnum"/>.</p>
            </para>
          </item>
          <item xml:id="S4.I1.i2">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="S4.I1.i2.p1">
              <p><Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S4.I1.i2.p1.m1">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
                  </XMath>
                </Math> also uses the index built by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> and a novel querying algorithm, shown in <ref labelref="LABEL:alg:three_split" show="creftype~refnum"/>. Similar to <ref labelref="LABEL:alg:query" show="creftype~refnum"/>, a query initially finds the highest level where any partition at all is entirely contained in the window filter, and then does a query on every one of these partitions. Instead of recursing further down the tree, however, <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S4.I1.i2.p1.m2">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
                  </XMath>
                </Math> then does an <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S4.I1.i2.p1.m3">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
                  </XMath>
                </Math> call on each of the remaining label subranges on each side of the middle “covered” label portion. Because we fill in the middle first, we are guaranteed that there can be no ”large blowup” case like in <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S4.I1.i2.p1.m4">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
                  </XMath>
                </Math>.</p>
            </para>
          </item>
          <item xml:id="S4.I1.i3">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">3rd item</tag>
            </tags>
            <para xml:id="S4.I1.i3.p1">
              <p><Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S4.I1.i3.p1.m1">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
                  </XMath>
                </Math> is the same as <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S4.I1.i3.p1.m2">
                  <XMath>
                    <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
                  </XMath>
                </Math> except that it operates on an arbitrary set of indexed subsets of <Math mode="inline" tex="D" text="D" xml:id="S4.I1.i3.p1.m3">
                  <XMath>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  </XMath>
                </Math> and not necessarily the ones constructed by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>. One example of such a data structure is analyzed in <ref labelref="LABEL:thm:betterblowup" show="creftype~refnum"/> and visualized in the top right of <ref labelref="LABEL:fig:algorithm" show="creftype~refnum"/>.</p>
            </para>
          </item>
        </itemize>
      </para>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:alg:query" placement="t" xml:id="alg2">
        <tags>
          <tag><text font="bold">Algorithm 2</text></tag>
          <tag role="autoref">2</tag>
          <tag role="creftype">Algorithm</tag>
          <tag role="creftypecap">Algorithm</tag>
          <tag role="creftypeplural">Algorithms</tag>
          <tag role="creftypepluralcap">Algorithms</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Algorithm 2</tag>
        </tags>
        <toccaption><tag close=" ">2</tag>Query<Math mode="inline" tex="(T,q,(a,b))" text="vector@(T, q, open-interval@(a, b))" xml:id="alg2.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg2.m1.3"/>
                  <XMRef idref="alg2.m1.4"/>
                  <XMRef idref="alg2.m1.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m1.3">T</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m1.4">q</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg2.m1.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.m1.1"/>
                      <XMRef idref="alg2.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m1.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m1.2">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 2</text></tag> Query<Math mode="inline" tex="(T,q,(a,b))" text="vector@(T, q, open-interval@(a, b))" xml:id="alg2.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg2.m2.3"/>
                  <XMRef idref="alg2.m2.4"/>
                  <XMRef idref="alg2.m2.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m2.3">T</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m2.4">q</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg2.m2.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.m2.1"/>
                      <XMRef idref="alg2.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m2.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg2.m2.2">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></caption>
        <listing>
          <listingline xml:id="alg2.l1"><tags>
              <tag><text fontsize="80%">1:</text></tag>
              <tag role="autoref">1</tag>
              <tag role="refnum">1</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Input:</text><text fontsize="90%"> </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg2.l1.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%">-WST </text><Math mode="inline" tex="T=(\texttt{index},(\texttt{children},\texttt{sizes}),D)" text="T = vector@([index], open-interval@([children], [sizes]), D)" xml:id="alg2.l1.m2">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">T</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="alg2.l1.m2.3"/>
                      <XMRef idref="alg2.l1.m2.5"/>
                      <XMRef idref="alg2.l1.m2.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMText xml:id="alg2.l1.m2.3"><text font="typewriter" fontsize="90%">index</text></XMText>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMDual xml:id="alg2.l1.m2.5">
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="alg2.l1.m2.1"/>
                          <XMRef idref="alg2.l1.m2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMText xml:id="alg2.l1.m2.1"><text font="typewriter" fontsize="90%">children</text></XMText>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMText xml:id="alg2.l1.m2.2"><text font="typewriter" fontsize="90%">sizes</text></XMText>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l1.m2.4">D</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">, with points </text><Math mode="inline" tex="x_{1},\ldots,x_{|D|}\in D" text="list@(x _ 1, ldots, x _ (absolute-value@(D))) element-of D" xml:id="alg2.l1.m3">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="alg2.l1.m3.3"/>
                      <XMRef idref="alg2.l1.m3.2"/>
                      <XMRef idref="alg2.l1.m3.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="alg2.l1.m3.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                        <XMTok fontsize="63%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok fontsize="90%" name="ldots" role="ID" xml:id="alg2.l1.m3.2">…</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg2.l1.m3.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="alg2.l1.m3.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok fontsize="63%" role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" fontsize="63%" role="UNKNOWN" xml:id="alg2.l1.m3.1">D</XMTok>
                            <XMTok fontsize="63%" role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> sorted by </text><Math mode="inline" tex="\ell" text="ell" xml:id="alg2.l1.m4">
              <XMath>
                <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
              </XMath>
            </Math><text fontsize="90%">, query </text><Math mode="inline" tex="q" text="q" xml:id="alg2.l1.m5">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">q</XMTok>
              </XMath>
            </Math><text fontsize="90%">, window filter </text><Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="alg2.l1.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="alg2.l1.m6.1"/>
                    <XMRef idref="alg2.l1.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l1.m6.1">a</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l1.m6.2">b</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">.
</text></listingline>
          <listingline xml:id="alg2.l2"><tags>
              <tag><text fontsize="80%">2:</text></tag>
              <tag role="autoref">2</tag>
              <tag role="refnum">2</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Output:</text><text fontsize="90%"> Approximate window-filtered nearest neighbor </text><Math mode="inline" tex="y" text="y" xml:id="alg2.l2.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">y</XMTok>
              </XMath>
            </Math><text fontsize="90%">, or </text><Math mode="inline" tex="\emptyset" text="empty-set" xml:id="alg2.l2.m2">
              <XMath>
                <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
              </XMath>
            </Math><text fontsize="90%"> if no points in </text><Math mode="inline" tex="D" text="D" xml:id="alg2.l2.m3">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math><text fontsize="90%"> meet window filter constraint.
</text></listingline>
          <listingline labels="LABEL:alg:query:line:leaf" xml:id="alg2.l3"><tags>
              <tag><text fontsize="80%">3:</text></tag>
              <tag role="autoref">3</tag>
              <tag role="refnum">3</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">if</text><text fontsize="90%"> </text><Math mode="inline" tex="\texttt{index}=\texttt{NULL}" text="[index] = [NULL]" xml:id="alg2.l3.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">index</text></XMText>
                  <XMText><text font="typewriter" fontsize="90%">NULL</text></XMText>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">then</text><text fontsize="90%">


</text></listingline>
          <listingline labels="LABEL:alg:query:line:argmin1" xml:id="alg2.l4"><tags>
              <tag><text fontsize="80%">4:</text></tag>
              <tag role="autoref">4</tag>
              <tag role="refnum">4</tag>
            </tags><text fontsize="90%">    </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math content-tex="\argmin_{y\in D_{(a,b)}}\texttt{dist}_{V}(q,y)" mode="inline" tex="\operatorname*{arg\,min}_{y\in D_{(a,b)}}\texttt{dist}_{V}(q,y)" text="(argmin _ (y element-of D _ (open-interval@(a, b))))@([dist] _ V) * open-interval@(q, y)" xml:id="alg2.l4.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN">min</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="63%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">y</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">D</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="alg2.l4.m1.1"/>
                              <XMRef idref="alg2.l4.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="45%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="45%" role="UNKNOWN" xml:id="alg2.l4.m1.1">a</XMTok>
                              <XMTok fontsize="45%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="45%" role="UNKNOWN" xml:id="alg2.l4.m1.2">b</XMTok>
                              <XMTok fontsize="45%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter" fontsize="90%">dist</text></XMText>
                      <XMTok font="italic" fontsize="63%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.l4.m1.3"/>
                      <XMRef idref="alg2.l4.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l4.m1.3">q</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l4.m1.4">y</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline labels="LABEL:alg:query:line:all" xml:id="alg2.l5"><tags>
              <tag><text fontsize="80%">5:</text></tag>
              <tag role="autoref">5</tag>
              <tag role="refnum">5</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">if</text><text fontsize="90%"> </text><Math mode="inline" tex="(\ell(x_{1}),\ell(x_{|D|}))\subset(a,b)" text="open-interval@(ell * x _ 1, ell * x _ (absolute-value@(D))) subset-of open-interval@(a, b)" xml:id="alg2.l5.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.l5.m1.4"/>
                      <XMRef idref="alg2.l5.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="alg2.l5.m1.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
                        <XMDual>
                          <XMRef idref="alg2.l5.m1.4.1"/>
                          <XMWrap>
                            <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="alg2.l5.m1.4.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                              <XMTok fontsize="63%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg2.l5.m1.5">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
                        <XMDual>
                          <XMRef idref="alg2.l5.m1.5.1"/>
                          <XMWrap>
                            <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="alg2.l5.m1.5.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="absolute-value"/>
                                  <XMRef idref="alg2.l5.m1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="63%" role="OPEN" stretchy="false">|</XMTok>
                                  <XMTok font="italic" fontsize="63%" role="UNKNOWN" xml:id="alg2.l5.m1.1">D</XMTok>
                                  <XMTok fontsize="63%" role="CLOSE" stretchy="false">|</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.l5.m1.2"/>
                      <XMRef idref="alg2.l5.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l5.m1.2">a</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l5.m1.3">b</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">then</text><text fontsize="90%">


</text></listingline>
          <listingline labels="LABEL:alg:query:line:ann" xml:id="alg2.l6"><tags>
              <tag><text fontsize="80%">6:</text></tag>
              <tag role="autoref">6</tag>
              <tag role="refnum">6</tag>
            </tags><text fontsize="90%">    </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math mode="inline" tex="\texttt{index}(q)" text="[index] * q" xml:id="alg2.l6.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">index</text></XMText>
                  <XMDual>
                    <XMRef idref="alg2.l6.m1.1"/>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l6.m1.1">q</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg2.l7"><tags>
              <tag><text fontsize="80%">7:</text></tag>
              <tag role="autoref">7</tag>
              <tag role="refnum">7</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{start}\leftarrow 1" text="[start] leftarrow 1" xml:id="alg2.l7.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">start</text></XMText>
                  <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">, </text><Math mode="inline" tex="\mathcal{L}_{\text{cand}}\leftarrow\emptyset" text="L _ [cand] leftarrow empty-set" xml:id="alg2.l7.m2">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                    <XMText><text fontsize="63%">cand</text></XMText>
                  </XMApp>
                  <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">
</text></listingline>
          <listingline labels="LABEL:alg:query:line:loop" xml:id="alg2.l8"><tags>
              <tag><text fontsize="80%">8:</text></tag>
              <tag role="autoref">8</tag>
              <tag role="refnum">8</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">for</text><text fontsize="90%"> </text><Math mode="inline" tex="i\leftarrow 1" text="i leftarrow 1" xml:id="alg2.l8.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">i</XMTok>
                  <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">to</text><text fontsize="90%"> </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg2.l8.m2">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><!--  %“julian–should be parallel?˝ “josh–Maybe not, since in our implementation we parallelize over queries, not within a query. Shangdi mentioned today that arguing why parallellizing individual queries is interesting is a different setting and we would have to make an argument for why it is interesting, so maybe best not to focus on it.˝ --><text fontsize="90%">
 </text><text font="bold" fontsize="90%">do</text><text fontsize="90%">

 
</text></listingline>
          <listingline xml:id="alg2.l9"><tags>
              <tag><text fontsize="80%">9:</text></tag>
              <tag role="autoref">9</tag>
              <tag role="refnum">9</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\texttt{end}\leftarrow\texttt{start}+\texttt{sizes}[i]" text="[end] leftarrow [start] + [sizes] * delimited-[]@(i)" xml:id="alg2.l9.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">end</text></XMText>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">start</text></XMText>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text font="typewriter" fontsize="90%">sizes</text></XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="alg2.l9.m1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l9.m1.1">i</XMTok>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">
</text></listingline>
          <listingline xml:id="alg2.l10"><tags>
              <tag><text fontsize="80%">10:</text></tag>
              <tag role="autoref">10</tag>
              <tag role="refnum">10</tag>
            </tags><text fontsize="90%">    </text><text font="bold" fontsize="90%">if</text><text fontsize="90%"> </text><Math mode="inline" tex="\ell(x_{\texttt{start}}),\ell(x_{\texttt{end}-1})\cap(a,b)\neq\emptyset" text="list@(ell * x _ [start], ell * x _ ([end] - 1) intersection open-interval@(a, b)) not-equals empty-set" xml:id="alg2.l10.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="alg2.l10.m1.3"/>
                      <XMRef idref="alg2.l10.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="alg2.l10.m1.3">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
                        <XMDual>
                          <XMRef idref="alg2.l10.m1.3.1"/>
                          <XMWrap>
                            <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="alg2.l10.m1.3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                              <XMText><text font="typewriter" fontsize="63%">start</text></XMText>
                            </XMApp>
                            <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg2.l10.m1.4">
                        <XMTok fontsize="90%" meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
                          <XMDual>
                            <XMRef idref="alg2.l10.m1.4.1"/>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="alg2.l10.m1.4.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                                <XMApp>
                                  <XMTok fontsize="63%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMText><text font="typewriter" fontsize="63%">end</text></XMText>
                                  <XMTok fontsize="63%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="alg2.l10.m1.1"/>
                            <XMRef idref="alg2.l10.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l10.m1.1">a</XMTok>
                            <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l10.m1.2">b</XMTok>
                            <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">then</text><text fontsize="90%">


</text></listingline>
          <listingline labels="LABEL:alg:query:line:recurse" xml:id="alg2.l11"><tags>
              <tag><text fontsize="80%">11:</text></tag>
              <tag role="autoref">11</tag>
              <tag role="refnum">11</tag>
            </tags><text fontsize="90%">       </text><Math mode="inline" tex="\mathcal{L}_{\text{cand}}\leftarrow\mathcal{L}_{\text{cand}}\cup\text{Query}(%&#10;\texttt{children}[i],q,(a,b))" text="L _ [cand] leftarrow L _ [cand] union [Query] * vector@([children] * delimited-[]@(i), q, open-interval@(a, b))" xml:id="alg2.l11.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                    <XMText><text fontsize="63%">cand</text></XMText>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="union" name="cup" role="ADDOP">∪</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                      <XMText><text fontsize="63%">cand</text></XMText>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text fontsize="90%">Query</text></XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="alg2.l11.m1.5"/>
                          <XMRef idref="alg2.l11.m1.4"/>
                          <XMRef idref="alg2.l11.m1.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="alg2.l11.m1.5">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText><text font="typewriter" fontsize="90%">children</text></XMText>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="alg2.l11.m1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="90%" role="OPEN" stretchy="false">[</XMTok>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l11.m1.1">i</XMTok>
                                <XMTok fontsize="90%" role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l11.m1.4">q</XMTok>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMDual xml:id="alg2.l11.m1.6">
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="alg2.l11.m1.2"/>
                              <XMRef idref="alg2.l11.m1.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l11.m1.2">a</XMTok>
                              <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l11.m1.3">b</XMTok>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg2.l12"><tags>
              <tag><text fontsize="80%">12:</text></tag>
              <tag role="autoref">12</tag>
              <tag role="refnum">12</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\texttt{start}\leftarrow\texttt{end}" text="[start] leftarrow [end]" xml:id="alg2.l12.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">start</text></XMText>
                  <XMText><text font="typewriter" fontsize="90%">end</text></XMText>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">
</text></listingline>
          <listingline labels="LABEL:alg:query:return" xml:id="alg2.l13"><tags>
              <tag><text fontsize="80%">13:</text></tag>
              <tag role="autoref">13</tag>
              <tag role="refnum">13</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math content-tex="\argmin_{y\in\mathcal{L}_{\text{cand}}}\texttt{dist}_{V}(q,y)" mode="inline" tex="\operatorname*{arg\,min}_{y\in\mathcal{L}_{\text{cand}}}\texttt{dist}_{V}(q,y)" text="(argmin _ (y element-of L _ [cand]))@([dist] _ V) * open-interval@(q, y)" xml:id="alg2.l13.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN">min</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="63%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">y</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="caligraphic" fontsize="63%" role="UNKNOWN">L</XMTok>
                          <XMText><text fontsize="45%">cand</text></XMText>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter" fontsize="90%">dist</text></XMText>
                      <XMTok font="italic" fontsize="63%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.l13.m1.1"/>
                      <XMRef idref="alg2.l13.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l13.m1.1">q</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg2.l13.m1.2">y</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
        </listing>
      </float>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:alg:optimized_postfiltering" placement="t" xml:id="alg3">
        <tags>
          <tag><text font="bold">Algorithm 3</text></tag>
          <tag role="autoref">3</tag>
          <tag role="creftype">Algorithm</tag>
          <tag role="creftypecap">Algorithm</tag>
          <tag role="creftypeplural">Algorithms</tag>
          <tag role="creftypepluralcap">Algorithms</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Algorithm 3</tag>
        </tags>
        <toccaption><tag close=" ">3</tag>OptimizedPostfiltering<Math mode="inline" tex="(T,q,(a,b))" text="vector@(T, q, open-interval@(a, b))" xml:id="alg3.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg3.m1.3"/>
                  <XMRef idref="alg3.m1.4"/>
                  <XMRef idref="alg3.m1.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m1.3">T</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m1.4">q</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg3.m1.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg3.m1.1"/>
                      <XMRef idref="alg3.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m1.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m1.2">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 3</text></tag> OptimizedPostfiltering<Math mode="inline" tex="(T,q,(a,b))" text="vector@(T, q, open-interval@(a, b))" xml:id="alg3.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg3.m2.3"/>
                  <XMRef idref="alg3.m2.4"/>
                  <XMRef idref="alg3.m2.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m2.3">T</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m2.4">q</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg3.m2.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg3.m2.1"/>
                      <XMRef idref="alg3.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m2.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg3.m2.2">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></caption>
        <listing>
          <listingline xml:id="alg3.l1"><tags>
              <tag><text fontsize="80%">1:</text></tag>
              <tag role="autoref">1</tag>
              <tag role="refnum">1</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Input:</text><text fontsize="90%"> </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg3.l1.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%">-WST </text><Math mode="inline" tex="T=(\texttt{index},(\texttt{children},\texttt{sizes}),D)" text="T = vector@([index], open-interval@([children], [sizes]), D)" xml:id="alg3.l1.m2">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">T</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="alg3.l1.m2.3"/>
                      <XMRef idref="alg3.l1.m2.5"/>
                      <XMRef idref="alg3.l1.m2.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMText xml:id="alg3.l1.m2.3"><text font="typewriter" fontsize="90%">index</text></XMText>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMDual xml:id="alg3.l1.m2.5">
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="alg3.l1.m2.1"/>
                          <XMRef idref="alg3.l1.m2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMText xml:id="alg3.l1.m2.1"><text font="typewriter" fontsize="90%">children</text></XMText>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMText xml:id="alg3.l1.m2.2"><text font="typewriter" fontsize="90%">sizes</text></XMText>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l1.m2.4">D</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">, query </text><Math mode="inline" tex="q" text="q" xml:id="alg3.l1.m3">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">q</XMTok>
              </XMath>
            </Math><text fontsize="90%">, window filter </text><Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="alg3.l1.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="alg3.l1.m4.1"/>
                    <XMRef idref="alg3.l1.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l1.m4.1">a</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l1.m4.2">b</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">.
</text></listingline>
          <listingline xml:id="alg3.l2"><tags>
              <tag><text fontsize="80%">2:</text></tag>
              <tag role="autoref">2</tag>
              <tag role="refnum">2</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Output:</text><text fontsize="90%"> Approximate window-filtered nearest neighbor </text><Math mode="inline" tex="y" text="y" xml:id="alg3.l2.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">y</XMTok>
              </XMath>
            </Math><text fontsize="90%">, or </text><Math mode="inline" tex="\emptyset" text="empty-set" xml:id="alg3.l2.m2">
              <XMath>
                <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
              </XMath>
            </Math><text fontsize="90%"> if no points in </text><Math mode="inline" tex="D" text="D" xml:id="alg3.l2.m3">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math><text fontsize="90%"> meet window filter constraint. 
</text></listingline>
          <listingline xml:id="alg3.l3"><tags>
              <tag><text fontsize="80%">3:</text></tag>
              <tag role="autoref">3</tag>
              <tag role="refnum">3</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{index}\leftarrow" text="[index] leftarrow absent" xml:id="alg3.l3.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMText><text font="typewriter" fontsize="90%">index</text></XMText>
                  <XMTok meaning="absent"/>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> smallest index in </text><Math mode="inline" tex="T" text="T" xml:id="alg3.l3.m2">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">T</XMTok>
              </XMath>
            </Math><text fontsize="90%"> containing all points with labels in </text><Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="alg3.l3.m3">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="alg3.l3.m3.1"/>
                    <XMRef idref="alg3.l3.m3.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l3.m3.1">a</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l3.m3.2">b</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg3.l4"><tags>
              <tag><text fontsize="80%">4:</text></tag>
              <tag role="autoref">4</tag>
              <tag role="refnum">4</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="k\leftarrow 1" text="k leftarrow 1" xml:id="alg3.l4.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">k</XMTok>
                  <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg3.l5"><tags>
              <tag><text fontsize="80%">5:</text></tag>
              <tag role="autoref">5</tag>
              <tag role="refnum">5</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">while</text><text fontsize="90%"> </text><Math mode="inline" tex="k&lt;N" text="k &lt; N" xml:id="alg3.l5.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="less-than" role="RELOP">&lt;</XMTok>
<!--  %**** paper.tex Line 475 **** -->                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">k</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">do</text><text fontsize="90%">


</text></listingline>
          <listingline xml:id="alg3.l6"><tags>
              <tag><text fontsize="80%">6:</text></tag>
              <tag role="autoref">6</tag>
              <tag role="refnum">6</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\mathcal{L}_{\text{unfiltered}}\leftarrow\texttt{index}(q,k)" text="L _ [unfiltered] leftarrow [index] * open-interval@(q, k)" xml:id="alg3.l6.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                    <XMText><text fontsize="63%">unfiltered</text></XMText>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText><text font="typewriter" fontsize="90%">index</text></XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg3.l6.m1.1"/>
                        <XMRef idref="alg3.l6.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l6.m1.1">q</XMTok>
                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l6.m1.2">k</XMTok>
                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">
</text></listingline>
          <listingline xml:id="alg3.l7"><tags>
              <tag><text fontsize="80%">7:</text></tag>
              <tag role="autoref">7</tag>
              <tag role="refnum">7</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="\mathcal{L}_{\text{cand}}\leftarrow\{x\in\mathcal{L}_{\text{cand}}\;|\&gt;\ell(x)%&#10;\in(a,b)\}" text="L _ [cand] leftarrow conditional-set@(x element-of L _ [cand], ell * x element-of open-interval@(a, b))" xml:id="alg3.l7.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                    <XMText><text fontsize="63%">cand</text></XMText>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="conditional-set"/>
                      <XMRef idref="alg3.l7.m1.4"/>
                      <XMRef idref="alg3.l7.m1.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg3.l7.m1.4">
                        <XMTok fontsize="90%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">x</XMTok>
                        <XMApp rpadding="2.8pt">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                          <XMText><text fontsize="63%">cand</text></XMText>
                        </XMApp>
                      </XMApp>
                      <XMTok fontsize="90%" role="MIDDLE" rpadding="2.2pt" stretchy="false">|</XMTok>
                      <XMApp xml:id="alg3.l7.m1.5">
                        <XMTok fontsize="90%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok fontsize="90%" name="ell" role="UNKNOWN">ℓ</XMTok>
                          <XMDual>
                            <XMRef idref="alg3.l7.m1.1"/>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l7.m1.1">x</XMTok>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="alg3.l7.m1.2"/>
                            <XMRef idref="alg3.l7.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l7.m1.2">a</XMTok>
                            <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l7.m1.3">b</XMTok>
                            <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg3.l8"><tags>
              <tag><text fontsize="80%">8:</text></tag>
              <tag role="autoref">8</tag>
              <tag role="refnum">8</tag>
            </tags><text fontsize="90%">    </text><text font="bold" fontsize="90%">if</text><text fontsize="90%"> </text><Math mode="inline" tex="\mathcal{L}_{\text{cand}}\neq\emptyset" text="L _ [cand] not-equals empty-set" xml:id="alg3.l8.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                    <XMText><text fontsize="63%">cand</text></XMText>
                  </XMApp>
                  <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">then</text><text fontsize="90%">


</text></listingline>
          <listingline xml:id="alg3.l9"><tags>
              <tag><text fontsize="80%">9:</text></tag>
              <tag role="autoref">9</tag>
              <tag role="refnum">9</tag>
            </tags><text fontsize="90%">       </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math content-tex="\argmin_{y\in\mathcal{L}_{\text{cand}}\cap D_{(a,b)}}\texttt{dist}_{V}(q,y)" mode="inline" tex="\operatorname*{arg\,min}_{y\in\mathcal{L}_{\text{cand}}\cap D_{(a,b)}}\texttt{%&#10;dist}_{V}(q,y)" text="(argmin _ (y element-of L _ [cand] intersection D _ (open-interval@(a, b))))@([dist] _ V) * open-interval@(q, y)" xml:id="alg3.l9.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN">min</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="63%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">y</XMTok>
                        <XMApp>
                          <XMTok fontsize="63%" meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="caligraphic" fontsize="63%" role="UNKNOWN">L</XMTok>
                            <XMText><text fontsize="45%">cand</text></XMText>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="63%" role="UNKNOWN">D</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="alg3.l9.m1.1"/>
                                <XMRef idref="alg3.l9.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="45%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="45%" role="UNKNOWN" xml:id="alg3.l9.m1.1">a</XMTok>
                                <XMTok fontsize="45%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="45%" role="UNKNOWN" xml:id="alg3.l9.m1.2">b</XMTok>
                                <XMTok fontsize="45%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter" fontsize="90%">dist</text></XMText>
                      <XMTok font="italic" fontsize="63%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg3.l9.m1.3"/>
                      <XMRef idref="alg3.l9.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l9.m1.3">q</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg3.l9.m1.4">y</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg3.l10"><tags>
              <tag><text fontsize="80%">10:</text></tag>
              <tag role="autoref">10</tag>
              <tag role="refnum">10</tag>
            </tags><text fontsize="90%">    </text><Math mode="inline" tex="k\leftarrow 2k" text="k leftarrow 2 * k" xml:id="alg3.l10.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">k</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="90%" meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">k</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg3.l11"><tags>
              <tag><text fontsize="80%">11:</text></tag>
              <tag role="autoref">11</tag>
              <tag role="refnum">11</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math mode="inline" tex="\emptyset" text="empty-set" xml:id="alg3.l11.m1">
              <XMath>
                <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
        </listing>
      </float>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:alg:three_split" placement="t" xml:id="alg4">
        <tags>
          <tag><text font="bold">Algorithm 4</text></tag>
          <tag role="autoref">4</tag>
          <tag role="creftype">Algorithm</tag>
          <tag role="creftypecap">Algorithm</tag>
          <tag role="creftypeplural">Algorithms</tag>
          <tag role="creftypepluralcap">Algorithms</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Algorithm 4</tag>
        </tags>
        <toccaption><tag close=" ">4</tag>ThreeSplit<Math mode="inline" tex="(T,q,(a,b))" text="vector@(T, q, open-interval@(a, b))" xml:id="alg4.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg4.m1.3"/>
                  <XMRef idref="alg4.m1.4"/>
                  <XMRef idref="alg4.m1.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m1.3">T</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m1.4">q</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg4.m1.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg4.m1.1"/>
                      <XMRef idref="alg4.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m1.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m1.2">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 4</text></tag> ThreeSplit<Math mode="inline" tex="(T,q,(a,b))" text="vector@(T, q, open-interval@(a, b))" xml:id="alg4.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="vector"/>
                  <XMRef idref="alg4.m2.3"/>
                  <XMRef idref="alg4.m2.4"/>
                  <XMRef idref="alg4.m2.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m2.3">T</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m2.4">q</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="alg4.m2.5">
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg4.m2.1"/>
                      <XMRef idref="alg4.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m2.1">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg4.m2.2">b</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></caption>
        <listing>
          <listingline xml:id="alg4.l1"><tags>
              <tag><text fontsize="80%">1:</text></tag>
              <tag role="autoref">1</tag>
              <tag role="refnum">1</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Input:</text><text fontsize="90%"> </text><Math mode="inline" tex="\beta" text="beta" xml:id="alg4.l1.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math><text fontsize="90%">-WST </text><Math mode="inline" tex="T=(\texttt{index},(\texttt{children},\texttt{sizes}),D)" text="T = vector@([index], open-interval@([children], [sizes]), D)" xml:id="alg4.l1.m2">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">T</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="vector"/>
                      <XMRef idref="alg4.l1.m2.3"/>
                      <XMRef idref="alg4.l1.m2.5"/>
                      <XMRef idref="alg4.l1.m2.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMText xml:id="alg4.l1.m2.3"><text font="typewriter" fontsize="90%">index</text></XMText>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMDual xml:id="alg4.l1.m2.5">
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="alg4.l1.m2.1"/>
                          <XMRef idref="alg4.l1.m2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMText xml:id="alg4.l1.m2.1"><text font="typewriter" fontsize="90%">children</text></XMText>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMText xml:id="alg4.l1.m2.2"><text font="typewriter" fontsize="90%">sizes</text></XMText>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l1.m2.4">D</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%">, query </text><Math mode="inline" tex="q" text="q" xml:id="alg4.l1.m3">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">q</XMTok>
              </XMath>
            </Math><text fontsize="90%">, window filter </text><Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="alg4.l1.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="alg4.l1.m4.1"/>
                    <XMRef idref="alg4.l1.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l1.m4.1">a</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l1.m4.2">b</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">.
</text></listingline>
          <listingline xml:id="alg4.l2"><tags>
              <tag><text fontsize="80%">2:</text></tag>
              <tag role="autoref">2</tag>
              <tag role="refnum">2</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">Output:</text><text fontsize="90%"> Approximate window-filtered nearest neighbor </text><Math mode="inline" tex="y" text="y" xml:id="alg4.l2.m1">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">y</XMTok>
              </XMath>
            </Math><text fontsize="90%">, or </text><Math mode="inline" tex="\emptyset" text="empty-set" xml:id="alg4.l2.m2">
              <XMath>
                <XMTok fontsize="90%" meaning="empty-set" name="emptyset" role="ID">∅</XMTok>
              </XMath>
            </Math><text fontsize="90%"> if no points in </text><Math mode="inline" tex="D" text="D" xml:id="alg4.l2.m3">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math><text fontsize="90%"> meet window filter constraint. 
</text></listingline>
          <listingline xml:id="alg4.l3"><tags>
              <tag><text fontsize="80%">3:</text></tag>
              <tag role="autoref">3</tag>
              <tag role="refnum">3</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\texttt{index},(a^{\prime},b^{\prime})\leftarrow" text="list@([index], open-interval@(a ^ prime, b ^ prime)) leftarrow absent" xml:id="alg4.l3.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" name="leftarrow" role="ARROW">←</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="alg4.l3.m1.1"/>
                      <XMRef idref="alg4.l3.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMText xml:id="alg4.l3.m1.1"><text font="typewriter" fontsize="90%">index</text></XMText>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMDual xml:id="alg4.l3.m1.2">
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="alg4.l3.m1.2.1"/>
                          <XMRef idref="alg4.l3.m1.2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="alg4.l3.m1.2.1">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                            <XMTok fontsize="63%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMApp xml:id="alg4.l3.m1.2.2">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" fontsize="90%" role="UNKNOWN">b</XMTok>
                            <XMTok fontsize="63%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMWrap>
                  </XMDual>
                  <XMTok meaning="absent"/>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> index in </text><Math mode="inline" tex="T" text="T" xml:id="alg4.l3.m2">
              <XMath>
                <XMTok font="italic" fontsize="90%" role="UNKNOWN">T</XMTok>
              </XMath>
            </Math><text fontsize="90%"> containing the most points with labels in </text><Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="alg4.l3.m3">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="alg4.l3.m3.1"/>
                    <XMRef idref="alg4.l3.m3.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l3.m3.1">a</XMTok>
                    <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l3.m3.2">b</XMTok>
                    <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math><text fontsize="90%">, label range of points in </text><text font="typewriter" fontsize="90%">index</text><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg4.l4"><tags>
              <tag><text fontsize="80%">4:</text></tag>
              <tag role="autoref">4</tag>
              <tag role="refnum">4</tag>
            </tags><text fontsize="90%">  </text><Math mode="inline" tex="\mathcal{L}_{\text{cand}}=\text{OptimizedPostfiltering}(T,q,(a,a^{\prime}))%&#10;\cup\texttt{index}(q)\cup\text{OptimizedPostfiltering}(T,q,(b^{\prime},b))" text="L _ [cand] = [OptimizedPostfiltering] * vector@(T, q, open-interval@(a, a ^ prime)) union [index] * q union [OptimizedPostfiltering] * vector@(T, q, open-interval@(b ^ prime, b))" xml:id="alg4.l4.m1">
              <XMath>
                <XMApp>
                  <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                    <XMText><text fontsize="63%">cand</text></XMText>
                  </XMApp>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="union" name="cup" role="ADDOP">∪</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text fontsize="90%">OptimizedPostfiltering</text></XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="alg4.l4.m1.2"/>
                          <XMRef idref="alg4.l4.m1.3"/>
                          <XMRef idref="alg4.l4.m1.8"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.2">T</XMTok>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.3">q</XMTok>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMDual xml:id="alg4.l4.m1.8">
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="alg4.l4.m1.1"/>
                              <XMRef idref="alg4.l4.m1.8.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.1">a</XMTok>
                              <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                              <XMApp xml:id="alg4.l4.m1.8.1">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="63%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text font="typewriter" fontsize="90%">index</text></XMText>
                      <XMDual>
                        <XMRef idref="alg4.l4.m1.4"/>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.4">q</XMTok>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText><text fontsize="90%">OptimizedPostfiltering</text></XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="alg4.l4.m1.6"/>
                          <XMRef idref="alg4.l4.m1.7"/>
                          <XMRef idref="alg4.l4.m1.9"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.6">T</XMTok>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.7">q</XMTok>
                          <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                          <XMDual xml:id="alg4.l4.m1.9">
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="alg4.l4.m1.9.1"/>
                              <XMRef idref="alg4.l4.m1.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="alg4.l4.m1.9.1">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN">b</XMTok>
                                <XMTok fontsize="63%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                              <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l4.m1.5">b</XMTok>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
          <listingline xml:id="alg4.l5"><tags>
              <tag><text fontsize="80%">5:</text></tag>
              <tag role="autoref">5</tag>
              <tag role="refnum">5</tag>
            </tags><text fontsize="90%">  </text><text font="bold" fontsize="90%">return</text><text fontsize="90%"> </text><Math content-tex="\argmin_{y\in\mathcal{L}_{\text{cand}}\cap D_{(a,b)}}\texttt{dist}_{V}(q,y)" mode="inline" tex="\operatorname*{arg\,min}_{y\in\mathcal{L}_{\text{cand}}\cap D_{(a,b)}}\texttt{%&#10;dist}_{V}(q,y)" text="(argmin _ (y element-of L _ [cand] intersection D _ (open-interval@(a, b))))@([dist] _ V) * open-interval@(q, y)" xml:id="alg4.l5.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                        <XMTok fontsize="90%" role="UNKNOWN">min</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="63%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">y</XMTok>
                        <XMApp>
                          <XMTok fontsize="63%" meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="caligraphic" fontsize="63%" role="UNKNOWN">L</XMTok>
                            <XMText><text fontsize="45%">cand</text></XMText>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="63%" role="UNKNOWN">D</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="alg4.l5.m1.1"/>
                                <XMRef idref="alg4.l5.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="45%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="45%" role="UNKNOWN" xml:id="alg4.l5.m1.1">a</XMTok>
                                <XMTok fontsize="45%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="45%" role="UNKNOWN" xml:id="alg4.l5.m1.2">b</XMTok>
                                <XMTok fontsize="45%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter" fontsize="90%">dist</text></XMText>
                      <XMTok font="italic" fontsize="63%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg4.l5.m1.3"/>
                      <XMRef idref="alg4.l5.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l5.m1.3">q</XMTok>
                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="alg4.l5.m1.4">y</XMTok>
                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math><text fontsize="90%"> 
</text></listingline>
        </listing>
      </float>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Theoretical Analysis</title>
    <subsection inlist="toc" xml:id="S5.SS1">
      <tags>
        <tag>5.1</tag>
        <tag role="autoref">subsection 5.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">5.1</tag>
        <tag role="typerefnum">§5.1</tag>
      </tags>
      <title><tag close=" ">5.1</tag>Analysis of Building and Querying a <Math mode="inline" tex="\beta" text="beta" xml:id="S5.SS1.m1">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math>-WST</title>
      <para xml:id="S5.SS1.p1">
        <p>In our analysis in this section, we assume without loss of generality that <Math mode="inline" tex="N" text="N" xml:id="S5.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> is a power of <Math mode="inline" tex="\beta" text="beta" xml:id="S5.SS1.p1.m2">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>. Removing this assumption would lead to more floor and ceiling operators in <ref labelref="LABEL:thm:runtime" show="creftype~refnum"/> and leave our other results unchanged. We defer proofs to <ref labelref="LABEL:sec:proofs" show="creftype~refnum"/>. We will first analyze the construction time and memory of <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>, and then we will prove the correctness and analyze the query time of <ref labelref="LABEL:alg:query" show="creftype~refnum"/>.</p>
      </para>
      <para xml:id="S5.SS1.p2">
        <p>Consider some function <Math mode="inline" tex="A_{f}" text="A _ f" xml:id="S5.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
              </XMApp>
            </XMath>
          </Math> parameterized by the dataset <Math mode="inline" tex="D" text="D" xml:id="S5.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>, dataset size <Math mode="inline" tex="N" text="N" xml:id="S5.SS1.p2.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math>, and subset size <Math mode="inline" tex="m" text="m" xml:id="S5.SS1.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">m</XMTok>
            </XMath>
          </Math>. For example, <Math mode="inline" tex="A_{f}" text="A _ f" xml:id="S5.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
              </XMApp>
            </XMath>
          </Math> may be a construction time function or a memory function. This function evaluated on all nodes of a <Math mode="inline" tex="\beta" text="beta" xml:id="S5.SS1.p2.m6">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST is</p>
        <equation xml:id="S5.Ex1">
          <Math mode="display" tex="O\left(\sum_{j=0}^{\log_{\beta}N}\beta^{j}A_{f}(D,N\cdot\beta^{-j})\right)." text="O * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ j * A _ f * open-interval@(D, N cdot beta ^ (- j)))" xml:id="S5.Ex1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S5.Ex1.m1.2"/>
                <XMWrap>
                  <XMApp xml:id="S5.Ex1.m1.2">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="S5.Ex1.m1.2.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S5.Ex1.m1.2.1">
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">A</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S5.Ex1.m1.1"/>
                                <XMRef idref="S5.Ex1.m1.2.1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex1.m1.1">D</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S5.Ex1.m1.2.1.1">
                                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S5.SS1.p3">
        <p>Since we use Vamana indices in our experiments, we now apply this result to obtain the running time of <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> (the construction time) and the memory of the resulting index. We use a recent analysis for Vamana graph-based search <cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> that assumes a “slow-preprocessing” index construction with runtime <Math mode="inline" tex="O(N^{3})" text="O * N ^ 3" xml:id="S5.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p3.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS1.p3.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and memory <Math mode="inline" tex="O(N(4\alpha)^{\delta}\log\Delta)" text="O * N * (4 * alpha) ^ delta * logarithm@(Delta)" xml:id="S5.SS1.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p3.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS1.p3.m2.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMRef idref="S5.SS1.p3.m2.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S5.SS1.p3.m2.1.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="4" role="NUMBER">4</XMTok>
                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. Letting <Math mode="inline" tex="\Delta" text="Delta" xml:id="S5.SS1.p3.m3">
            <XMath>
              <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
            </XMath>
          </Math> be the <text font="italic">aspect ratio</text> of <Math mode="inline" tex="D" text="D" xml:id="S5.SS1.p3.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>, i.e., the ratio between the maximum and minimum distances between any two pairs of points, we have the following result:</p>
      </para>
      <theorem class="ltx_theorem_lemma" inlist="thm theorem:lemma" labels="LABEL:lem:existingannmemory LABEL:restatable:existingannmemory" xml:id="S5.Thmtheorem1">
        <tags>
          <tag>Lemma 5.1</tag>
          <tag role="autoref">5.1</tag>
          <tag role="creftype">Lemma</tag>
          <tag role="creftypecap">Lemma</tag>
          <tag role="creftypeplural">Lemmas</tag>
          <tag role="creftypepluralcap">Lemmas</tag>
          <tag role="refnum">5.1</tag>
          <tag role="typerefnum">Lemma 5.1</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Lemma 5.1</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem1.p1">
          <p><ref font="italic" labelref="LABEL:alg:build_tree" show="creftype~refnum"/><text font="italic"> instantiated with a “slow preprocessed” <Math mode="inline" tex="\alpha" text="alpha" xml:id="S5.Thmtheorem1.p1.m1">
                <XMath>
                  <XMTok name="alpha" role="UNKNOWN">α</XMTok>
                </XMath>
              </Math>-Vamana graph runs in time</text></p>
          <equation xml:id="S5.Ex2">
            <Math mode="display" tex="O\left(\frac{1}{1-\beta^{-2}}N^{3}\right)=O(N^{3})" text="O * (1 / (1 - beta ^ (- 2))) * N ^ 3 = O * N ^ 3" xml:id="S5.Ex2.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="S5.Ex2.m1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S5.Ex2.m1.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="S5.Ex2.m1.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S5.Ex2.m1.2">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
          </equation>
          <p><text font="italic">and returns a <Math mode="inline" tex="\beta" text="beta" xml:id="S5.Thmtheorem1.p1.m2">
                <XMath>
                  <XMTok name="beta" role="UNKNOWN">β</XMTok>
                </XMath>
              </Math>-WST of memory</text></p>
          <equation xml:id="S5.Ex3">
            <Math mode="display" tex="O\left((4\alpha)^{\delta}\log(\Delta)N\log_{\beta}N\right)." text="O * (4 * alpha) ^ delta * logarithm@(Delta) * N * (logarithm _ beta)@(N)" xml:id="S5.Ex3.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex3.m1.3"/>
                  <XMWrap>
                    <XMApp xml:id="S5.Ex3.m1.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Ex3.m1.3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S5.Ex3.m1.3.1">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMDual>
                                <XMRef idref="S5.Ex3.m1.3.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S5.Ex3.m1.3.1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok meaning="4" role="NUMBER">4</XMTok>
                                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S5.Ex3.m1.1"/>
                                <XMRef idref="S5.Ex3.m1.2"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S5.Ex3.m1.1">log</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok name="Delta" role="UNKNOWN" xml:id="S5.Ex3.m1.2">Δ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
<!--  %**** paper.tex Line 525 **** -->        </para>
      </theorem>
      <para xml:id="S5.SS1.p4">
        <p>We now move on to our main runtime theorem, which both proves that <ref labelref="LABEL:alg:query" show="creftype~refnum"/> indeed solves <Math mode="inline" tex="c" text="c" xml:id="S5.SS1.p4.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window search and upper bounds the running time for an arbitrary ANNS index <Math mode="inline" tex="A" text="A" xml:id="S5.SS1.p4.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math>:</p>
      </para>
      <theorem class="ltx_theorem_theorem" inlist="thm theorem:theorem" labels="LABEL:restatable:runtime LABEL:thm:runtime" xml:id="S5.Thmtheorem2">
        <tags>
          <tag>Theorem 5.2</tag>
          <tag role="autoref">Theorem 5.2</tag>
          <tag role="creftype">Theorem</tag>
          <tag role="creftypecap">Theorem</tag>
          <tag role="creftypeplural">Theorems</tag>
          <tag role="creftypepluralcap">Theorems</tag>
          <tag role="refnum">5.2</tag>
          <tag role="typerefnum">Theorem 5.2</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Theorem 5.2</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem2.p1">
          <p><text font="italic">If <Math mode="inline" tex="A" text="A" xml:id="S5.Thmtheorem2.p1.m1">
                <XMath>
                  <XMTok role="UNKNOWN">A</XMTok>
                </XMath>
              </Math> can build an index that answers <Math mode="inline" tex="c" text="c" xml:id="S5.Thmtheorem2.p1.m2">
                <XMath>
                  <XMTok role="UNKNOWN">c</XMTok>
                </XMath>
              </Math>-ANN queries on an arbitrary size <Math mode="inline" tex="m" text="m" xml:id="S5.Thmtheorem2.p1.m3">
                <XMath>
                  <XMTok role="UNKNOWN">m</XMTok>
                </XMath>
              </Math> subset of <Math mode="inline" tex="D" text="D" xml:id="S5.Thmtheorem2.p1.m4">
                <XMath>
                  <XMTok role="UNKNOWN">D</XMTok>
                </XMath>
              </Math> with query time <Math mode="inline" tex="O(A_{q}(D,m))" text="O * A _ q * open-interval@(D, m)" xml:id="S5.Thmtheorem2.p1.m5">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="S5.Thmtheorem2.p1.m5.3"/>
                      <XMWrap>
                        <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S5.Thmtheorem2.p1.m5.3">
                          <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok role="UNKNOWN">A</XMTok>
                            <XMTok fontsize="70%" role="UNKNOWN">q</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S5.Thmtheorem2.p1.m5.1"/>
                              <XMRef idref="S5.Thmtheorem2.p1.m5.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem2.p1.m5.1">D</XMTok>
                              <XMTok font="upright" role="PUNCT">,</XMTok>
                              <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem2.p1.m5.2">m</XMTok>
                              <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>, and a distance computation in <Math mode="inline" tex="V" text="V" xml:id="S5.Thmtheorem2.p1.m6">
                <XMath>
                  <XMTok role="UNKNOWN">V</XMTok>
                </XMath>
              </Math> takes <Math mode="inline" tex="d" text="d" xml:id="S5.Thmtheorem2.p1.m7">
                <XMath>
                  <XMTok role="UNKNOWN">d</XMTok>
                </XMath>
              </Math> work, then <ref labelref="LABEL:alg:query" show="creftype~refnum"/> solves the <Math mode="inline" tex="c" text="c" xml:id="S5.Thmtheorem2.p1.m8">
                <XMath>
                  <XMTok role="UNKNOWN">c</XMTok>
                </XMath>
              </Math>-approximate window search problem with running time</text></p>
          <equation xml:id="S5.Ex4">
            <Math mode="display" tex="O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_{q}(D,N\cdot%&#10;\beta^{-j})\right)." text="O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N cdot beta ^ (- j))))" xml:id="S5.Ex4.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex4.m1.3"/>
                  <XMWrap>
                    <XMApp xml:id="S5.Ex4.m1.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Ex4.m1.3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S5.Ex4.m1.3.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="S5.Ex4.m1.3.1.1"/>
                                  <XMRef idref="S5.Ex4.m1.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="S5.Ex4.m1.3.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex4.m1.1">N</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                      <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S5.Ex4.m1.2"/>
                                      <XMRef idref="S5.Ex4.m1.3.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex4.m1.2">D</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S5.Ex4.m1.3.1.2">
                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </para>
      </theorem>
<!--  %“shangdi–$d$ is dimension in Thm 5.1? I think $d$ is overloaded, it is also the distance metric.˝ “josh–Yes it is overloaded, Theorem 5.1 has an assumption that a distance computation in V takes O(d), while the distance metric in V is $“texttt–dist˝˙V$. Should we call one of them something else? Idk what letter to choose that would make it more clear˝ 
     %“shangdi–oh I got it know. I think it would be good to have a notation table, including $A$, $A˙q$, $d$, $V$, $“texttt–dist˝˙V$, $“beta$, and $D$. We can potentially change $“texttt–dist˝˙V$ to be $“texttt–dist˝˙V$, but not a top priority.˝ -->      <para xml:id="S5.SS1.p5">
        <p>Many theoretical ANN results in the literature have a runtime of <Math mode="inline" tex="O(N^{\rho})" text="O * N ^ rho" xml:id="S5.SS1.p5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS1.p5.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS1.p5.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> for a constant <Math mode="inline" tex="\rho" text="rho" xml:id="S5.SS1.p5.m2">
            <XMath>
              <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
            </XMath>
          </Math>, e.g., LSH <cite class="ltx_citemacro_citep">(<bibref bibrefs="andoni2008near" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and <Math mode="inline" tex="k" text="k" xml:id="S5.SS1.p5.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math>-nearest neighbor graphs <cite class="ltx_citemacro_citep">(<bibref bibrefs="prokhorenkova2020graph" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Other results have a runtime that is parameterized only with constants describing the data distribution, and have no reliance on <Math mode="inline" tex="N" text="N" xml:id="S5.SS1.p5.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math>. By applying <ref labelref="LABEL:thm:runtime" show="creftype~refnum"/>, we have the following results for these common function classes:</p>
      </para>
      <theorem class="ltx_theorem_lemma" inlist="thm theorem:lemma" labels="LABEL:lem:commonfuncclasses LABEL:restatable:commonfuncclasses" xml:id="S5.Thmtheorem3">
        <tags>
          <tag>Lemma 5.3</tag>
          <tag role="autoref">5.3</tag>
          <tag role="creftype">Lemma</tag>
          <tag role="creftypecap">Lemma</tag>
          <tag role="creftypeplural">Lemmas</tag>
          <tag role="creftypepluralcap">Lemmas</tag>
          <tag role="refnum">5.3</tag>
          <tag role="typerefnum">Lemma 5.3</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Lemma 5.3</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem3.p1">
          <p><text font="italic">If <Math mode="inline" tex="A" text="A" xml:id="S5.Thmtheorem3.p1.m1">
                <XMath>
                  <XMTok role="UNKNOWN">A</XMTok>
                </XMath>
              </Math> is a <Math mode="inline" tex="c" text="c" xml:id="S5.Thmtheorem3.p1.m2">
                <XMath>
                  <XMTok role="UNKNOWN">c</XMTok>
                </XMath>
              </Math>-ANN algorithm with <Math mode="inline" tex="A_{q}(D,m)=O(Cdm^{\rho})" text="A _ q * open-interval@(D, m) = O * C * d * m ^ rho" xml:id="S5.Thmtheorem3.p1.m3">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok role="UNKNOWN">A</XMTok>
                        <XMTok fontsize="70%" role="UNKNOWN">q</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S5.Thmtheorem3.p1.m3.1"/>
                          <XMRef idref="S5.Thmtheorem3.p1.m3.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem3.p1.m3.1">D</XMTok>
                          <XMTok font="upright" role="PUNCT">,</XMTok>
                          <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem3.p1.m3.2">m</XMTok>
                          <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Thmtheorem3.p1.m3.3"/>
                        <XMWrap>
                          <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S5.Thmtheorem3.p1.m3.3">
                            <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN">C</XMTok>
                            <XMTok role="UNKNOWN">d</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok role="UNKNOWN">m</XMTok>
                              <XMTok fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math> for <Math mode="inline" tex="\rho\in(0,1)" text="rho element-of open-interval@(0, 1)" xml:id="S5.Thmtheorem3.p1.m4">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMTok name="rho" role="UNKNOWN">ρ</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S5.Thmtheorem3.p1.m4.1"/>
                        <XMRef idref="S5.Thmtheorem3.p1.m4.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="upright" meaning="0" role="NUMBER" xml:id="S5.Thmtheorem3.p1.m4.1">0</XMTok>
                        <XMTok font="upright" role="PUNCT">,</XMTok>
                        <XMTok font="upright" meaning="1" role="NUMBER" xml:id="S5.Thmtheorem3.p1.m4.2">1</XMTok>
                        <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math> for some constant <Math mode="inline" tex="C" text="C" xml:id="S5.Thmtheorem3.p1.m5">
                <XMath>
                  <XMTok role="UNKNOWN">C</XMTok>
                </XMath>
              </Math> depending on <Math mode="inline" tex="D" text="D" xml:id="S5.Thmtheorem3.p1.m6">
                <XMath>
                  <XMTok role="UNKNOWN">D</XMTok>
                </XMath>
              </Math>, the running time of <ref labelref="LABEL:alg:query" show="creftype~refnum"/> is</text></p>
          <equation xml:id="S5.Ex5">
            <Math mode="display" tex="O\left(\frac{C\beta dN^{\rho}}{1-\beta^{-\rho}}\right)." text="O * ((C * beta * d * N ^ rho) / (1 - beta ^ (- rho)))" xml:id="S5.Ex5.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex5.m1.2"/>
                  <XMWrap>
                    <XMApp xml:id="S5.Ex5.m1.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Ex5.m1.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S5.Ex5.m1.1">
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">C</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p><text font="italic">If <Math mode="inline" tex="A" text="A" xml:id="S5.Thmtheorem3.p1.m7">
                <XMath>
                  <XMTok role="UNKNOWN">A</XMTok>
                </XMath>
              </Math> is a <Math mode="inline" tex="c" text="c" xml:id="S5.Thmtheorem3.p1.m8">
                <XMath>
                  <XMTok role="UNKNOWN">c</XMTok>
                </XMath>
              </Math>-ANN algorithm with <Math mode="inline" tex="O(A_{q}(D,m))=O(A_{q}(D))" text="O * A _ q * open-interval@(D, m) = O * A _ q * D" xml:id="S5.Thmtheorem3.p1.m9">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Thmtheorem3.p1.m9.4"/>
                        <XMWrap>
                          <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S5.Thmtheorem3.p1.m9.4">
                            <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok role="UNKNOWN">A</XMTok>
                              <XMTok fontsize="70%" role="UNKNOWN">q</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S5.Thmtheorem3.p1.m9.1"/>
                                <XMRef idref="S5.Thmtheorem3.p1.m9.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem3.p1.m9.1">D</XMTok>
                                <XMTok font="upright" role="PUNCT">,</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem3.p1.m9.2">m</XMTok>
                                <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Thmtheorem3.p1.m9.5"/>
                        <XMWrap>
                          <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S5.Thmtheorem3.p1.m9.5">
                            <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok role="UNKNOWN">A</XMTok>
                              <XMTok fontsize="70%" role="UNKNOWN">q</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S5.Thmtheorem3.p1.m9.3"/>
                              <XMWrap>
                                <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem3.p1.m9.3">D</XMTok>
                                <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>, then the running time of <ref labelref="LABEL:alg:query" show="creftype~refnum"/> is</text></p>
          <equation xml:id="S5.Ex6">
            <Math mode="display" tex="O\left(\beta\log_{\beta}(N)[d+A_{q}(D)]\right)." text="O * beta * (logarithm _ beta)@(N) * delimited-[]@(d + A _ q * D)" xml:id="S5.Ex6.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex6.m1.3"/>
                  <XMWrap>
                    <XMApp xml:id="S5.Ex6.m1.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Ex6.m1.3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S5.Ex6.m1.3.1">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S5.Ex6.m1.3.1.1"/>
                                <XMRef idref="S5.Ex6.m1.1"/>
                              </XMApp>
                              <XMApp>
                                <XMApp xml:id="S5.Ex6.m1.3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex6.m1.1">N</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S5.Ex6.m1.3.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="S5.Ex6.m1.3.1.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S5.Ex6.m1.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex6.m1.2">D</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </para>
      </theorem>
      <para xml:id="S5.SS1.p6">
        <p>We can again apply <ref labelref="LABEL:lem:commonfuncclasses" show="creftype~refnum"/> using recent <Math mode="inline" tex="c" text="c" xml:id="S5.SS1.p6.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-ANN results for Vamana graph-based search <cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite><!--  %**** paper.tex Line 550 **** -->.
We have the following result:
<!--  %Again letting $“Delta$ be the “textit–aspect ratio˝ of $D$, --></p>
      </para>
      <theorem class="ltx_theorem_lemma" inlist="thm theorem:lemma" labels="LABEL:lem:existingannruntime LABEL:restatable:existingannruntime" xml:id="S5.Thmtheorem4">
        <tags>
          <tag>Lemma 5.4</tag>
          <tag role="autoref">5.4</tag>
          <tag role="creftype">Lemma</tag>
          <tag role="creftypecap">Lemma</tag>
          <tag role="creftypeplural">Lemmas</tag>
          <tag role="creftypepluralcap">Lemmas</tag>
          <tag role="refnum">5.4</tag>
          <tag role="typerefnum">Lemma 5.4</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Lemma 5.4</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem4.p1">
          <p><ref font="italic" labelref="LABEL:alg:query" show="creftype~refnum"/><text font="italic"> instantiated with a “slow preprocessed” <Math mode="inline" tex="\alpha" text="alpha" xml:id="S5.Thmtheorem4.p1.m1">
                <XMath>
                  <XMTok name="alpha" role="UNKNOWN">α</XMTok>
                </XMath>
              </Math>-Vamana graph solves the <Math mode="inline" tex="c" text="c" xml:id="S5.Thmtheorem4.p1.m2">
                <XMath>
                  <XMTok role="UNKNOWN">c</XMTok>
                </XMath>
              </Math>-approximate window search problem in any metric space on a dataset with doubling dimension <Math mode="inline" tex="\delta" text="delta" xml:id="S5.Thmtheorem4.p1.m3">
                <XMath>
                  <XMTok name="delta" role="UNKNOWN">δ</XMTok>
                </XMath>
              </Math> and aspect ratio <Math mode="inline" tex="\Delta" text="Delta" xml:id="S5.Thmtheorem4.p1.m4">
                <XMath>
                  <XMTok font="upright" name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMath>
              </Math> in running time</text></p>
          <equation xml:id="S5.Ex7">
            <Math mode="display" tex="\leavevmode\resizebox{236.15796pt}{}{$O\left(\beta\log_{\beta}(N)\left[d+\log_%&#10;{\alpha}\left(\frac{\Delta}{(\alpha-1)(c-\frac{\alpha+1}{\alpha-1})}\right)(4%&#10;\alpha)^{\delta}\log\Delta\right]\right)$}." text="O * beta * (logarithm _ beta)@(N) * delimited-[]@(d + (logarithm _ alpha)@(Delta / ((alpha - 1) * (c - (alpha + 1) / (alpha - 1)))) * (4 * alpha) ^ delta * logarithm@(Delta))" xml:id="S5.Ex7.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex7.m1.6"/>
                  <XMWrap>
                    <XMApp depth="4.6pt" height="12.4pt" width="236.2pt" xml:id="S5.Ex7.m1.6">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Ex7.m1.5"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="S5.Ex7.m1.5">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S5.Ex7.m1.5.1"/>
                                <XMRef idref="S5.Ex7.m1.3"/>
                              </XMApp>
                              <XMApp>
                                <XMApp xml:id="S5.Ex7.m1.5.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex7.m1.3">N</XMTok>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S5.Ex7.m1.5.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">[</XMTok>
                                <XMApp xml:id="S5.Ex7.m1.5.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="S5.Ex7.m1.5.2.1"/>
                                        <XMRef idref="S5.Ex7.m1.4"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="S5.Ex7.m1.5.2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                                          <XMApp xml:id="S5.Ex7.m1.4">
                                            <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                            <XMTok fontsize="70%" name="Delta" role="UNKNOWN">Δ</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMDual>
                                                <XMRef idref="S5.Ex7.m1.1"/>
                                                <XMWrap>
                                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="S5.Ex7.m1.1">
                                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                              <XMDual>
                                                <XMRef idref="S5.Ex7.m1.2"/>
                                                <XMWrap>
                                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                                  <XMApp xml:id="S5.Ex7.m1.2">
                                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                                                    <XMApp>
                                                      <XMTok mathstyle="script" meaning="divide" role="FRACOP"/>
                                                      <XMApp>
                                                        <XMTok fontsize="50%" meaning="plus" role="ADDOP">+</XMTok>
                                                        <XMTok font="italic" fontsize="50%" name="alpha" role="UNKNOWN">α</XMTok>
                                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                      <XMApp>
                                                        <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                        <XMTok font="italic" fontsize="50%" name="alpha" role="UNKNOWN">α</XMTok>
                                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMDual>
                                        <XMRef idref="S5.Ex7.m1.5.2.2"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="S5.Ex7.m1.5.2.2">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok meaning="4" role="NUMBER">4</XMTok>
                                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </para>
      </theorem>
    </subsection>
    <subsection inlist="toc" xml:id="S5.SS2">
      <tags>
        <tag>5.2</tag>
        <tag role="autoref">subsection 5.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">5.2</tag>
        <tag role="typerefnum">§5.2</tag>
      </tags>
      <title><tag close=" ">5.2</tag>Analysis of Super Postfiltering</title>
      <para xml:id="S5.SS2.p1">
        <p><Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S5.SS2.p1.m1">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
            </XMath>
          </Math> operates on an arbitrary collection of window filtered subsets <Math mode="inline" tex="D_{(a_{i},b_{i})}" text="D _ (open-interval@(a _ i, b _ i))" xml:id="S5.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S5.SS2.p1.m2.1"/>
                    <XMRef idref="S5.SS2.p1.m2.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS2.p1.m2.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMApp xml:id="S5.SS2.p1.m2.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. A natural question is how to quantify the quality of a particular choice of subsets to index, which motivates the following definition:</p>
      </para>
<!--  %“julian–the introduction of this method is discussing the filtered $K$-NN problem, which is confusing. could we move the discussion of $K$-NN later?˝ 
     %There is another way we could use a $“beta$-WST to do queries. ANNS indices typically allow users to query for more than $1$ nearest neighbor. This inspires a “laxman–folklore?˝ simple solution (which we benchmark against in our experiments) called “textit–postfiltering˝: to do a filtered ANN query, simply do a query on a full ANN index that retrieves $k$ points, and keep exponentially increasing $k$ until enough points that meet the filter are returned. “shangdi–Maybe we can move the description of the algorithm to section 4? Then we have a clean separation between the algorithms, and their analysis˝ 
     %If the filter values and data are distributed independently, then in expectation we need to retrieve $—D— / —D˙–(a, b)˝—$ points to retrieve one that meets the filter constraint. 
     %Since most ANN algorithms take longer to retrieve more near neighbors, a possible better “shangdi–better than which algorithm?˝ approach “laxman–than postfiltering?˝ is to index many window filtered subsets $D˙–(a˙i, b˙i)˝$, and then for a query $q, (a, b)$ find and query the smallest subset containing $D˙–(a, b)˝$ (if $S$ is this smallest subset, doing this means we need to query on expectation $—D— / —S—$ times fewer points). 
     %A natural next step is how to quantify the goodness of a particular choice of ranges to index “laxman–ranges to index, to be consistent with the terminology used in the next defn? not sure label subsets is defined; maybe use ‘‘indexing ranges’’ before as well˝ “josh–I like either of those, agree we need to be careful to distinguish these ranges, as they are (inclusive) subsets of $“–1,“ldots, N“˝$ rather than window filters $(a, b)$˝, which motivates the following definition: -->      <theorem class="ltx_theorem_definition" inlist="thm theorem:definition" labels="LABEL:def:blowup-factor" xml:id="S5.Thmtheorem5">
        <tags>
          <tag>Definition 5.5</tag>
          <tag role="autoref">5.5</tag>
          <tag role="creftype">Definition</tag>
          <tag role="creftypecap">Definition</tag>
          <tag role="creftypeplural">Definitions</tag>
          <tag role="creftypepluralcap">Definitions</tag>
          <tag role="refnum">5.5</tag>
          <tag role="typerefnum">Definition 5.5</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Definition 5.5</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem5.p1">
          <p>[Blowup Factor, Cost]
Given a set of ranges <Math mode="inline" tex="R" text="R" xml:id="S5.Thmtheorem5.p1.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMath>
            </Math>, with <Math mode="inline" tex="R_{i}=[a_{i},b_{i}]" text="R _ i = closed-interval@(a _ i, b _ i)" xml:id="S5.Thmtheorem5.p1.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="closed-interval"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m2.1"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="S5.Thmtheorem5.p1.m2.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S5.Thmtheorem5.p1.m2.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">b</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> for <Math mode="inline" tex="a_{i},b_{i}\in\{1,\ldots,N\}" text="list@(a _ i, b _ i) element-of set@(1, ldots, N)" xml:id="S5.Thmtheorem5.p1.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m3.4"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m3.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S5.Thmtheorem5.p1.m3.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S5.Thmtheorem5.p1.m3.5">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">b</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m3.1"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m3.2"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m3.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="S5.Thmtheorem5.p1.m3.1">1</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="S5.Thmtheorem5.p1.m3.2">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m3.3">N</XMTok>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="a_{i}&lt;b_{i}" text="a _ i &lt; b _ i" xml:id="S5.Thmtheorem5.p1.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, we can define the <text font="italic">blowup factor</text> of a new query range <Math mode="inline" tex="[a,b]" text="closed-interval@(a, b)" xml:id="S5.Thmtheorem5.p1.m5">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m5.1"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m5.1">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m5.2">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> with <Math mode="inline" tex="a,b\in\{1,\ldots N\}" text="list@(a, b) element-of set@(1, ldots * N)" xml:id="S5.Thmtheorem5.p1.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m6.2"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m6.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m6.2">a</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m6.3">b</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m6.1"/>
                      <XMRef idref="S5.Thmtheorem5.p1.m6.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="S5.Thmtheorem5.p1.m6.1">1</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S5.Thmtheorem5.p1.m6.4">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="ldots" role="ID">…</XMTok>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> as follows:</p>
          <equation xml:id="S5.Ex8">
            <Math mode="display" tex="\mathsf{blowup}(R,[a,b])=\min_{\begin{subarray}{c}[a_{i},b_{i}]\in R_{i}\\&#10;[a_{i},b_{i}]\supset[a,b]\end{subarray}}\left(\frac{b_{i}-a_{i}}{b-a}\right)." text="blowup * open-interval@(R, closed-interval@(a, b)) = (minimum _ (list@(Array[[closed-interval@(a _ i, b _ i) element-of R _ i], [closed-interval@(a _ i, b _ i) superset-of closed-interval@(a, b)]])))@((b _ i - a _ i) / (b - a))" xml:id="S5.Ex8.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex8.m1.6"/>
                  <XMWrap>
                    <XMApp xml:id="S5.Ex8.m1.6">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="sansserif" role="UNKNOWN">blowup</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S5.Ex8.m1.4"/>
                            <XMRef idref="S5.Ex8.m1.6.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex8.m1.4">R</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMDual xml:id="S5.Ex8.m1.6.1">
                              <XMApp>
                                <XMTok meaning="closed-interval"/>
                                <XMRef idref="S5.Ex8.m1.2"/>
                                <XMRef idref="S5.Ex8.m1.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex8.m1.2">a</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex8.m1.3">b</XMTok>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="S5.Ex8.m1.6.2"/>
                          <XMRef idref="S5.Ex8.m1.5"/>
                        </XMApp>
                        <XMApp>
                          <XMApp xml:id="S5.Ex8.m1.6.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="mid">min</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S5.Ex8.m1.1"/>
                              </XMApp>
                              <XMArray rowsep="0pt" xml:id="S5.Ex8.m1.1">
                                <XMRow>
                                  <XMCell align="center">
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="S5.Ex8.m1.1.1"/>
                                          <XMRef idref="S5.Ex8.m1.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="S5.Ex8.m1.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMApp xml:id="S5.Ex8.m1.1.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                                <XMRow>
                                  <XMCell align="center">
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="superset-of" name="supset" role="RELOP">⊃</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="S5.Ex8.m1.1.5"/>
                                          <XMRef idref="S5.Ex8.m1.1.6"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                          <XMApp xml:id="S5.Ex8.m1.1.5">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMApp xml:id="S5.Ex8.m1.1.6">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="closed-interval"/>
                                          <XMRef idref="S5.Ex8.m1.1.3"/>
                                          <XMRef idref="S5.Ex8.m1.1.4"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">[</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S5.Ex8.m1.1.3">a</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S5.Ex8.m1.1.4">b</XMTok>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">]</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                              </XMArray>
                            </XMDual>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="S5.Ex8.m1.5">
                              <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                  <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>Intuitively, the blowup for <Math mode="inline" tex="[a,b]" text="closed-interval@(a, b)" xml:id="S5.Thmtheorem5.p1.m7">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m7.1"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m7.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m7.1">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m7.2">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> is the ratio between the size of <Math mode="inline" tex="[a,b]" text="closed-interval@(a, b)" xml:id="S5.Thmtheorem5.p1.m8">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m8.1"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m8.1">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m8.2">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> and the smallest range in <Math mode="inline" tex="R" text="R" xml:id="S5.Thmtheorem5.p1.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMath>
            </Math><!--  %Note that if no range $[a˙i, b˙i]$ contains $[a, b]$, we say that the blowup is equal to $“infty$. “julian–do we need $“infty$ blowup in this paper? if not, we can drop this sentence˝ --> that contains it.
We can further define the worst case blowup for a <text font="italic">set of ranges</text> (like <Math mode="inline" tex="R" text="R" xml:id="S5.Thmtheorem5.p1.m10">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMath>
            </Math>) by taking the maximum blowup over all possible query ranges <Math mode="inline" tex="[a,b]" text="closed-interval@(a, b)" xml:id="S5.Thmtheorem5.p1.m11">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m11.1"/>
                    <XMRef idref="S5.Thmtheorem5.p1.m11.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m11.1">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m11.2">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>:</p>
          <equation xml:id="S5.Ex9">
            <Math mode="display" tex="\mathsf{blowup}(R)=\max_{\begin{subarray}{c}a,b\in\{1,\ldots,N\}\\&#10;a&lt;b\end{subarray}}\mathsf{blowup}(R,[a,b])." text="blowup * R = (maximum _ (list@(Array[[list@(a, b) element-of set@(1, ldots, N)], [a &lt; b]])))@(blowup) * open-interval@(R, closed-interval@(a, b))" xml:id="S5.Ex9.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="S5.Ex9.m1.6"/>
                  <XMWrap>
                    <XMApp xml:id="S5.Ex9.m1.6">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="sansserif" role="UNKNOWN">blowup</XMTok>
                        <XMDual>
                          <XMRef idref="S5.Ex9.m1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex9.m1.2">R</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S5.Ex9.m1.1"/>
                              </XMApp>
                              <XMArray rowsep="0pt" xml:id="S5.Ex9.m1.1">
                                <XMRow>
                                  <XMCell align="center">
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="S5.Ex9.m1.1.4"/>
                                          <XMRef idref="S5.Ex9.m1.1.5"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S5.Ex9.m1.1.4">a</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S5.Ex9.m1.1.5">b</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="set"/>
                                          <XMRef idref="S5.Ex9.m1.1.1"/>
                                          <XMRef idref="S5.Ex9.m1.1.2"/>
                                          <XMRef idref="S5.Ex9.m1.1.3"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok fontsize="70%" role="OPEN" stretchy="false">{</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="S5.Ex9.m1.1.1">1</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok fontsize="70%" name="ldots" role="ID" xml:id="S5.Ex9.m1.1.2">…</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S5.Ex9.m1.1.3">N</XMTok>
                                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">}</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                                <XMRow>
                                  <XMCell align="center">
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="less-than" role="RELOP">&lt;</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                                    </XMApp>
                                  </XMCell>
                                </XMRow>
                              </XMArray>
                            </XMDual>
                          </XMApp>
                          <XMTok font="sansserif" role="UNKNOWN">blowup</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S5.Ex9.m1.5"/>
                            <XMRef idref="S5.Ex9.m1.6.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex9.m1.5">R</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMDual xml:id="S5.Ex9.m1.6.1">
                              <XMApp>
                                <XMTok meaning="closed-interval"/>
                                <XMRef idref="S5.Ex9.m1.3"/>
                                <XMRef idref="S5.Ex9.m1.4"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex9.m1.3">a</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S5.Ex9.m1.4">b</XMTok>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p><!--  %“shangdi–This definition is a little confusing for me (I got it now but took some time). Maybe it’s helpful to include an example of computing this number. We can put it in appendix and refer to it if there’s not enough space.˝ “josh–Is it clearer now?˝ -->We additionally define the <text font="italic">cost</text> of a set of ranges <Math mode="inline" tex="R" text="R" xml:id="S5.Thmtheorem5.p1.m12">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMath>
            </Math> as
<Math mode="inline" tex="\mathsf{cost}(R)=\sum_{i}(b_{i}-a_{i})" text="cost * R = (sum _ i)@(b _ i - a _ i)" xml:id="S5.Thmtheorem5.p1.m13">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="sansserif" role="UNKNOWN">cost</XMTok>
                    <XMDual>
                      <XMRef idref="S5.Thmtheorem5.p1.m13.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S5.Thmtheorem5.p1.m13.1">R</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S5.Thmtheorem5.p1.m13.2"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S5.Thmtheorem5.p1.m13.2">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">b</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
      </theorem>
      <para xml:id="S5.SS2.p2">
        <p>Intuitively, if we build an ANNS index for the points corresponding to each range, then the worst-case blowup limits how expensive a query can be, while the <Math mode="inline" tex="\mathsf{cost}" text="cost" xml:id="S5.SS2.p2.m1">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">cost</XMTok>
            </XMath>
          </Math> approximates the memory required (since most practical ANNS indices, e.g., LSH <cite class="ltx_citemacro_citep">(<bibref bibrefs="andoni2008near" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and Vamana <cite class="ltx_citemacro_citep">(<bibref bibrefs="diskann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, have memory that is approximately linear in the number of points that they index). Note that here, a range of, e.g., <Math mode="inline" tex="[17,35]" text="closed-interval@(17, 35)" xml:id="S5.SS2.p2.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S5.SS2.p2.m2.1"/>
                  <XMRef idref="S5.SS2.p2.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok meaning="17" role="NUMBER" xml:id="S5.SS2.p2.m2.1">17</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="35" role="NUMBER" xml:id="S5.SS2.p2.m2.2">35</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> corresponds to an ANNS index built on the <Math mode="inline" tex="17" text="17" xml:id="S5.SS2.p2.m3">
            <XMath>
              <XMTok meaning="17" role="NUMBER">17</XMTok>
            </XMath>
          </Math>’th point through the <Math mode="inline" tex="35" text="35" xml:id="S5.SS2.p2.m4">
            <XMath>
              <XMTok meaning="35" role="NUMBER">35</XMTok>
            </XMath>
          </Math>’th point in <Math mode="inline" tex="D" text="D" xml:id="S5.SS2.p2.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>, assuming the points are sorted by label value.</p>
      </para>
      <para xml:id="S5.SS2.p3">
        <p>As a quick warmup, we can achieve a worst-case blowup of <Math mode="inline" tex="N" text="N" xml:id="S5.SS2.p3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="\mathsf{cost}" text="cost" xml:id="S5.SS2.p3.m2">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">cost</XMTok>
            </XMath>
          </Math> of <Math mode="inline" tex="N" text="N" xml:id="S5.SS2.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> by choosing <Math mode="inline" tex="R=\{[1,N]\}" text="R = set@(closed-interval@(1, N))" xml:id="S5.SS2.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S5.SS2.p3.m4.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S5.SS2.p3.m4.3">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S5.SS2.p3.m4.1"/>
                        <XMRef idref="S5.SS2.p3.m4.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="1" role="NUMBER" xml:id="S5.SS2.p3.m4.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p3.m4.2">N</XMTok>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, and we can get a worst-case blowup of <Math mode="inline" tex="1" text="1" xml:id="S5.SS2.p3.m5">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="\mathsf{cost}" text="cost" xml:id="S5.SS2.p3.m6">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">cost</XMTok>
            </XMath>
          </Math> of <Math mode="inline" tex="O(N^{3})" text="O * N ^ 3" xml:id="S5.SS2.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="S5.SS2.p3.m7.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S5.SS2.p3.m7.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> by choosing <Math mode="inline" tex="R=\{[i,j]\ |\ i,j\in\{1,\ldots,N\},i&lt;j\}" text="R = conditional-set@(closed-interval@(i, j), formulae@(list@(i, j) element-of set@(1, ldots, N), i &lt; j))" xml:id="S5.SS2.p3.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="conditional-set"/>
                    <XMRef idref="S5.SS2.p3.m8.8"/>
                    <XMRef idref="S5.SS2.p3.m8.9"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S5.SS2.p3.m8.8">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S5.SS2.p3.m8.1"/>
                        <XMRef idref="S5.SS2.p3.m8.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p3.m8.1">i</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p3.m8.2">j</XMTok>
                        <XMTok role="CLOSE" rpadding="5.0pt" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="MIDDLE" rpadding="5.0pt" stretchy="false">|</XMTok>
                    <XMDual xml:id="S5.SS2.p3.m8.9">
                      <XMApp>
                        <XMTok meaning="formulae"/>
                        <XMRef idref="S5.SS2.p3.m8.9.1"/>
                        <XMRef idref="S5.SS2.p3.m8.9.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S5.SS2.p3.m8.9.1">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="S5.SS2.p3.m8.6"/>
                              <XMRef idref="S5.SS2.p3.m8.7"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p3.m8.6">i</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p3.m8.7">j</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="S5.SS2.p3.m8.3"/>
                              <XMRef idref="S5.SS2.p3.m8.4"/>
                              <XMRef idref="S5.SS2.p3.m8.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">{</XMTok>
                              <XMTok meaning="1" role="NUMBER" xml:id="S5.SS2.p3.m8.3">1</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok name="ldots" role="ID" xml:id="S5.SS2.p3.m8.4">…</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S5.SS2.p3.m8.5">N</XMTok>
                              <XMTok role="CLOSE" stretchy="false">}</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S5.SS2.p3.m8.9.2">
                          <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          <XMTok font="italic" role="UNKNOWN">j</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. We are interested in choices for <Math mode="inline" tex="R" text="R" xml:id="S5.SS2.p3.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">R</XMTok>
            </XMath>
          </Math> that lead to better tradeoffs.</p>
      </para>
      <para xml:id="S5.SS2.p4">
        <p>We can construct an <Math mode="inline" tex="R" text="R" xml:id="S5.SS2.p4.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">R</XMTok>
            </XMath>
          </Math> consisting of the ranges corresponding to each subset indexed in a <Math mode="inline" tex="\beta" text="beta" xml:id="S5.SS2.p4.m2">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST, so we can analyze it using <ref labelref="LABEL:def:blowup-factor" show="creftype~refnum"/>. We prove the following lemma.</p>
      </para>
      <theorem class="ltx_theorem_lemma" inlist="thm theorem:lemma" labels="LABEL:lem:wstblowup LABEL:restatable:wstblowup" xml:id="S5.Thmtheorem6">
        <tags>
          <tag>Lemma 5.6</tag>
          <tag role="autoref">5.6</tag>
          <tag role="creftype">Lemma</tag>
          <tag role="creftypecap">Lemma</tag>
          <tag role="creftypeplural">Lemmas</tag>
          <tag role="creftypepluralcap">Lemmas</tag>
          <tag role="refnum">5.6</tag>
          <tag role="typerefnum">Lemma 5.6</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Lemma 5.6</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem6.p1">
          <p><text font="italic">The ranges corresponding to a <Math mode="inline" tex="\beta" text="beta" xml:id="S5.Thmtheorem6.p1.m1">
                <XMath>
                  <XMTok name="beta" role="UNKNOWN">β</XMTok>
                </XMath>
              </Math>-WST have worst case blowup factor <Math mode="inline" tex="B=N/2=O(N)" text="B = N / 2 = O * N" xml:id="S5.Thmtheorem6.p1.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMTok role="UNKNOWN">B</XMTok>
                    <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok font="upright" meaning="divide" role="MULOP">/</XMTok>
                      <XMTok role="UNKNOWN">N</XMTok>
                      <XMTok font="upright" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Thmtheorem6.p1.m2.1"/>
                        <XMWrap>
                          <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem6.p1.m2.1">N</XMTok>
                          <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math> and <Math mode="inline" tex="cost\leq N\lceil\log_{\beta}(N)\rceil=O(N\log_{\beta}(N))" text="c * o * s * t &lt;= N * ceiling@((logarithm _ beta)@(N)) = O * N * (logarithm _ beta)@(N)" xml:id="S5.Thmtheorem6.p1.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="multirelation"/>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">c</XMTok>
                      <XMTok role="UNKNOWN">o</XMTok>
                      <XMTok role="UNKNOWN">s</XMTok>
                      <XMTok role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMTok font="upright" meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">N</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="ceiling"/>
                          <XMRef idref="S5.Thmtheorem6.p1.m3.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok font="upright" name="lceil" role="OPEN" stretchy="false">⌈</XMTok>
                          <XMDual xml:id="S5.Thmtheorem6.p1.m3.3">
                            <XMApp>
                              <XMRef idref="S5.Thmtheorem6.p1.m3.3.1"/>
                              <XMRef idref="S5.Thmtheorem6.p1.m3.1"/>
                            </XMApp>
                            <XMApp>
                              <XMApp xml:id="S5.Thmtheorem6.p1.m3.3.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="upright" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                              </XMApp>
                              <XMWrap>
                                <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem6.p1.m3.1">N</XMTok>
                                <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                          <XMTok font="upright" name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok font="upright" meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="S5.Thmtheorem6.p1.m3.4"/>
                        <XMWrap>
                          <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S5.Thmtheorem6.p1.m3.4">
                            <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok role="UNKNOWN">N</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S5.Thmtheorem6.p1.m3.4.1"/>
                                <XMRef idref="S5.Thmtheorem6.p1.m3.2"/>
                              </XMApp>
                              <XMApp>
                                <XMApp xml:id="S5.Thmtheorem6.p1.m3.4.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="upright" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMTok fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem6.p1.m3.2">N</XMTok>
                                  <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                          <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>.</text></p>
        </para>
      </theorem>
      <para xml:id="S5.SS2.p5">
        <p>Finally, we prove that we can do better than a <Math mode="inline" tex="\beta" text="beta" xml:id="S5.SS2.p5.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST.</p>
      </para>
      <theorem class="ltx_theorem_theorem" inlist="thm theorem:theorem" labels="LABEL:restatable:betterblowup LABEL:thm:betterblowup" xml:id="S5.Thmtheorem7">
        <tags>
          <tag>Theorem 5.7</tag>
          <tag role="autoref">Theorem 5.7</tag>
          <tag role="creftype">Theorem</tag>
          <tag role="creftypecap">Theorem</tag>
          <tag role="creftypeplural">Theorems</tag>
          <tag role="creftypepluralcap">Theorems</tag>
          <tag role="refnum">5.7</tag>
          <tag role="typerefnum">Theorem 5.7</tag>
        </tags>
        <title class="ltx_runin"><tag><text font="bold">Theorem 5.7</text></tag><text font="bold">.</text></title>
        <para xml:id="S5.Thmtheorem7.p1">
          <p><text font="italic"><!--  %**** paper.tex Line 600 **** -->For any <Math mode="inline" tex="N" text="N" xml:id="S5.Thmtheorem7.p1.m1">
                <XMath>
                  <XMTok role="UNKNOWN">N</XMTok>
                </XMath>
              </Math> and for any <Math mode="inline" tex="\gamma&gt;1" text="gamma &gt; 1" xml:id="S5.Thmtheorem7.p1.m2">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="greater-than" role="RELOP">&gt;</XMTok>
                    <XMTok name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok font="upright" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMath>
              </Math>, there exists an <Math mode="inline" tex="R" text="R" xml:id="S5.Thmtheorem7.p1.m3">
                <XMath>
                  <XMTok role="UNKNOWN">R</XMTok>
                </XMath>
              </Math> with worst case blowup factor <Math mode="inline" tex="2\gamma" text="2 * gamma" xml:id="S5.Thmtheorem7.p1.m4">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="upright" meaning="2" role="NUMBER">2</XMTok>
                    <XMTok name="gamma" role="UNKNOWN">γ</XMTok>
                  </XMApp>
                </XMath>
              </Math> that has cost at most <Math mode="inline" tex="N\left(2\log_{\gamma}(N)+1\right)" text="N * (2 * (logarithm _ gamma)@(N) + 1)" xml:id="S5.Thmtheorem7.p1.m5">
                <XMath>
                  <XMApp>
                    <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok role="UNKNOWN">N</XMTok>
                    <XMDual>
                      <XMRef idref="S5.Thmtheorem7.p1.m5.2"/>
                      <XMWrap>
                        <XMTok font="upright" role="OPEN" stretchy="true">(</XMTok>
                        <XMApp xml:id="S5.Thmtheorem7.p1.m5.2">
                          <XMTok font="upright" meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok font="upright" meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="upright" meaning="2" role="NUMBER">2</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S5.Thmtheorem7.p1.m5.2.1"/>
                                <XMRef idref="S5.Thmtheorem7.p1.m5.1"/>
                              </XMApp>
                              <XMApp>
                                <XMApp xml:id="S5.Thmtheorem7.p1.m5.2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="upright" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                  <XMTok fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok font="upright" role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok role="UNKNOWN" xml:id="S5.Thmtheorem7.p1.m5.1">N</XMTok>
                                  <XMTok font="upright" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                          <XMTok font="upright" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok font="upright" role="CLOSE" stretchy="true">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>.</text></p>
        </para>
      </theorem>
<!--  %Sift (1000000, 128) 
     %Glove (1183514, 100) 
     %Redcaps (11588824, 512) 
     %Deep (9990000, 96) 
     %Aversarial (1000000, 100) -->    </subsection>
  </section>
  <section inlist="toc" xml:id="S6">
    <tags>
      <tag>6</tag>
      <tag role="autoref">section 6</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">6</tag>
      <tag role="typerefnum">§6</tag>
    </tags>
    <title><tag close=" ">6</tag>Experiments</title>
    <para class="ltx_noindent" xml:id="S6.p1">
      <p><text font="bold">Experiment Setup.</text><!--  %“label–sec:experiment˙setup˝ -->
We run all query methods on all datasets and filter widths on a 2.20GHz Intel Xeon machine with <Math mode="inline" tex="40" text="40" xml:id="S6.p1.m1">
          <XMath>
            <XMTok meaning="40" role="NUMBER">40</XMTok>
          </XMath>
        </Math> cores and two-way hyper-threading, <Math mode="inline" tex="100" text="100" xml:id="S6.p1.m2">
          <XMath>
            <XMTok meaning="100" role="NUMBER">100</XMTok>
          </XMath>
        </Math> MiB L3 cache, and <Math mode="inline" tex="504" text="504" xml:id="S6.p1.m3">
          <XMath>
            <XMTok meaning="504" role="NUMBER">504</XMTok>
          </XMath>
        </Math> GB of RAM.
We run index building using all <Math mode="inline" tex="80" text="80" xml:id="S6.p1.m4">
          <XMath>
            <XMTok meaning="80" role="NUMBER">80</XMTok>
          </XMath>
        </Math> hyper-threads and restrict queries to <Math mode="inline" tex="16" text="16" xml:id="S6.p1.m5">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math><!--  %“ben–You say we run index building on your machine but do you report numbers about index building? added my stuff 2p down˝ --> threads, and parallelize across (and not within) queries.
We run index construction experiments with varying values of <!--  %We run the index scalability experiments on the same machine, and vary the number of threads as noted in~“cref–sec:varying˙index˝. --><Math mode="inline" tex="\beta" text="beta" xml:id="S6.p1.m6">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math><!--  %4 socket --> on a separate 2.10GHz Intel Xeon machine with <Math mode="inline" tex="96" text="96" xml:id="S6.p1.m7">
          <XMath>
            <XMTok meaning="96" role="NUMBER">96</XMTok>
          </XMath>
        </Math> cores and two way hyper-threading, <Math mode="inline" tex="132" text="132" xml:id="S6.p1.m8">
          <XMath>
            <XMTok meaning="132" role="NUMBER">132</XMTok>
          </XMath>
        </Math> MiB L3 cache, and <Math mode="inline" tex="1.47" text="1.47" xml:id="S6.p1.m9">
          <XMath>
            <XMTok meaning="1.47" role="NUMBER">1.47</XMTok>
          </XMath>
        </Math> TB of RAM. We use all hyper-threads on the machine for these experiments.</p>
    </para>
    <para xml:id="S6.p2">
      <p>We use a Vamana index <cite class="ltx_citemacro_citep">(<bibref bibrefs="diskann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> with <Math mode="inline" tex="\alpha=1" text="alpha = 1" xml:id="S6.p2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="\textit{degree}{}=64" text="[degree] = 64" xml:id="S6.p2.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMText><text font="italic">degree</text></XMText>
              <XMTok meaning="64" role="NUMBER">64</XMTok>
            </XMApp>
          </XMath>
        </Math>, and the construction beam search width set to <Math mode="inline" tex="500" text="500" xml:id="S6.p2.m3">
          <XMath>
            <XMTok meaning="500" role="NUMBER">500</XMTok>
          </XMath>
        </Math> for all ANNS indices, except for the <Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p2.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{VBASE}" text="VBASE" xml:id="S6.p2.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VBASE</XMTok>
          </XMath>
        </Math> baselines. Vamana allows searching for <Math mode="inline" tex="k\geq 1" text="k &gt;= 1" xml:id="S6.p2.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> nearest neighbors; for simplicity of presentation, we assume that the query beam search width is always set to <Math mode="inline" tex="k" text="k" xml:id="S6.p2.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math>. We defer a description of Vamana and its associated hyper-parameters to <ref labelref="LABEL:app:diskann" show="creftype~refnum"/>.</p>
    </para>
    <para xml:id="S6.p3">
      <p>We note that our theory focuses on the <Math mode="inline" tex="c" text="c" xml:id="S6.p3.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">c</XMTok>
          </XMath>
        </Math>-ANN problem, which only concerns whether a single <Math mode="inline" tex="c" text="c" xml:id="S6.p3.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">c</XMTok>
          </XMath>
        </Math>-approximate nearest neighbor is returned. However, as is standard in much of the ANN literature, in our experiments we report the <text font="italic">recall</text> of the top <Math mode="inline" tex="10" text="10" xml:id="S6.p3.m3">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math> filtered neighbors to the query. While our runtime proofs in
<ref labelref="LABEL:thm:runtime" show="creftype~refnum"/>, <ref labelref="LABEL:lem:commonfuncclasses" show="creftype~refnum"/>, and <ref labelref="LABEL:lem:existingannruntime" show="creftype~refnum"/>
assume that the underlying ANNS algorithm returns a single ANN, in practice, we find that Vamana has high recall for both single ANN and top-<Math mode="inline" tex="10" text="10" xml:id="S6.p3.m4">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math> ANN.
Therefore, we believe that our theoretical analyses still provide insights into our empirical results for top-<Math mode="inline" tex="10" text="10" xml:id="S6.p3.m5">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math> ANN.</p>
    </para>
<!--  %but the ideas in our arguments still work.  We assume that if the underlying ANN algorithm has high recall on on single ANN search, then it also has high recall on top-$10$ ANN searches, which we found to be true in practice. -->    <para xml:id="S6.p4">
      <p>Finally, we ensure that our smallest filter fractions are still wide enough such that there are at least <Math mode="inline" tex="10" text="10" xml:id="S6.p4.m1">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math> points that meet the filter constraint, i.e., we ensure that <Math mode="inline" tex="|D_{(a,b)}|\geq 10" text="absolute-value@(D _ (open-interval@(a, b))) &gt;= 10" xml:id="S6.p4.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="absolute-value"/>
                  <XMRef idref="S6.p4.m2.3"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S6.p4.m2.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S6.p4.m2.1"/>
                        <XMRef idref="S6.p4.m2.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S6.p4.m2.1">a</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S6.p4.m2.2">b</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                </XMWrap>
              </XMDual>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
    <para class="ltx_noindent" xml:id="S6.p5">
      <p><text font="bold">Implementation Details.</text><!--  %“shangdi–I think we can merge this section with the experiment section.˝ -->
We provide an open source C++ library and associated Python bindings.<note mark="1" role="footnote" xml:id="footnote1"><tags>
            <tag>1</tag>
            <tag role="autoref">footnote 1</tag>
            <tag role="creftype">Footnote</tag>
            <tag role="creftypecap">Footnote</tag>
            <tag role="creftypeplural">Footnotes</tag>
            <tag role="creftypepluralcap">Footnotes</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">footnote 1</tag>
          </tags><ref class="ltx_url" font="typewriter" href="https://github.com/JoshEngels/RangeFilteredANN">https://github.com/JoshEngels/RangeFilteredANN</ref></note><!--  %“footnote–https://github.com/JoshEngels/RangeFilteredANN˝ -->
Our code is built on the ParlayLib library <cite class="ltx_citemacro_citep">(<bibref bibrefs="blelloch2020parlaylib" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> for parallel programming and the recent ParlayANN suite of parallel ANNS algorithms <cite class="ltx_citemacro_citep">(<bibref bibrefs="dobson2023scaling" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
We implement a number of memory and performance optimizations, including using a larger base case of <Math mode="inline" tex="1000" text="1000" xml:id="S6.p5.m1">
          <XMath>
            <XMTok meaning="1000" role="NUMBER">1000</XMTok>
          </XMath>
        </Math> in <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> and storing the entire dataset just once across all sub-indices.</p>
    </para>
<!--  %“shangdi–I think we can probably remove this paragraph, since in general there are many performance benefits that C++ has over Python. We can probably put it in the git repo README. ˝As opposed to a Python-only framework, using C++ gives us more flexibility, allowing us to store the entire dataset just once across all sub-indices “julian–C++ is also a lot faster in general˝. This trick reduces the memory from $O(N“cdot L“cdot d + “degree–˝ “cdot N “cdot L)$, where $L$ is the number of layers, to $O(N “cdot d + “degree–˝ “cdot N “cdot L)$ in theory, and in practice reduces the memory of the index by a factor of $2$ to $5$. We also are able to parallelize across building different indices and across batches of queries. 
     %“julian–define what the ”degree” is. also, i’m not sure if we defined $d$˝ -->    <para xml:id="S6.p6">
      <p><text font="bold">Filter Fraction.</text> Answering a window filter query that matches almost the entire dataset is a substantially different problem than one that matches almost none of it. Thus, we define the <text font="bold italic">filter fraction</text> as a way of quantifying where in this filter regime we are: let a query with filter fraction <Math mode="inline" tex="2^{i}" text="2 ^ i" xml:id="S6.p6.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math> for <Math mode="inline" tex="i\leq 0" text="i &lt;= 0" xml:id="S6.p6.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
              <XMTok meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math> be a query whose window filter matches a <Math mode="inline" tex="2^{i}" text="2 ^ i" xml:id="S6.p6.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math> fraction of the points in <Math mode="inline" tex="D" text="D" xml:id="S6.p6.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math>. For example, a query with filter fraction <Math mode="inline" tex="2^{-3}" text="2 ^ (- 3)" xml:id="S6.p6.m5">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> has a window filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S6.p6.m6">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="open-interval"/>
                <XMRef idref="S6.p6.m6.1"/>
                <XMRef idref="S6.p6.m6.2"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S6.p6.m6.1">a</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S6.p6.m6.2">b</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> that matches <Math mode="inline" tex="\frac{1}{8}" text="1 / 8" xml:id="S6.p6.m7">
          <XMath>
            <XMApp>
              <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              <XMTok fontsize="70%" meaning="8" role="NUMBER">8</XMTok>
            </XMApp>
          </XMath>
        </Math> of the dataset, or in other words <Math mode="inline" tex="|D_{(a,b)}|=\frac{1}{8}|D|" text="absolute-value@(D _ (open-interval@(a, b))) = (1 / 8) * absolute-value@(D)" xml:id="S6.p6.m8">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="absolute-value"/>
                  <XMRef idref="S6.p6.m8.4"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMApp xml:id="S6.p6.m8.4">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">D</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S6.p6.m8.1"/>
                        <XMRef idref="S6.p6.m8.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S6.p6.m8.1">a</XMTok>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S6.p6.m8.2">b</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                </XMWrap>
              </XMDual>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  <XMTok fontsize="70%" meaning="8" role="NUMBER">8</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="S6.p6.m8.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S6.p6.m8.3">D</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>. Queries with a small filter fraction (e.g., <Math mode="inline" tex="2^{-15}" text="2 ^ (- 15)" xml:id="S6.p6.m9">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="15" role="NUMBER">15</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>) restrict to a small portion of the dataset, queries with a large filter fraction (e.g., <Math mode="inline" tex="2^{-2}" text="2 ^ (- 2)" xml:id="S6.p6.m10">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>) restrict to a large portion of the dataset, and queries with a medium filter fraction (e.g., <Math mode="inline" tex="2^{-8}" text="2 ^ (- 8)" xml:id="S6.p6.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="8" role="NUMBER">8</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math><!--  %**** paper.tex Line 650 **** -->) restrict somewhere in between.
A query with a random filter of fraction <!--  %“julian–is the filter fraction random too?˝ “josh–We create multiple query sets, and for each query set there is a fixed filter fraction.˝ --><Math mode="inline" tex="2^{i}" text="2 ^ i" xml:id="S6.p6.m12">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math> is a query where we randomly select the filter <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="S6.p6.m13">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="open-interval"/>
                <XMRef idref="S6.p6.m13.1"/>
                <XMRef idref="S6.p6.m13.2"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S6.p6.m13.1">a</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" role="UNKNOWN" xml:id="S6.p6.m13.2">b</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> so that all possibilities for the <Math mode="inline" tex="2^{i}*|D|" text="2 ^ i * absolute-value@(D)" xml:id="S6.p6.m14">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">∗</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
              <XMDual>
                <XMApp>
                  <XMTok meaning="absolute-value"/>
                  <XMRef idref="S6.p6.m14.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="S6.p6.m14.1">D</XMTok>
                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> filtered points are equally likely.</p>
    </para>
    <table inlist="lot" labels="LABEL:tab:dataset_sum" placement="t" xml:id="S6.T2">
      <tags>
        <tag>Table 2</tag>
        <tag role="autoref">Table 2</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Table 2</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="80%">2</text></tag><text fontsize="80%">Summary of datasets used in our experiments.</text></toccaption>
      <caption class="ltx_centering" fontsize="80%"><tag close=": ">Table 2</tag>Summary of datasets used in our experiments.</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="center" border="l r t" thead="column row"><text fontsize="80%">Dataset</text></td>
            <td align="center" border="r t" thead="column row"><text fontsize="80%">Description</text></td>
            <td align="center" border="r t" thead="column row"><text fontsize="80%">Labels</text></td>
            <td align="center" border="r t" thead="column"><text fontsize="80%">Num. dimensions</text></td>
            <td align="center" border="r t" thead="column"><text fontsize="80%">Dataset size</text></td>
            <td align="center" border="r t" thead="column"><text fontsize="80%">Num. queries</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center" border="l r t" thead="row"><text font="typewriter" fontsize="80%">SIFT</text></td>
            <td align="center" border="r t" thead="row"><text fontsize="80%">Image feature vectors</text></td>
            <td align="center" border="r t" thead="row"><text fontsize="80%">Uniform random</text></td>
            <td align="center" border="r t"><Math mode="inline" tex="128" text="128" xml:id="S6.T2.m1">
                <XMath>
                  <XMTok fontsize="80%" meaning="128" role="NUMBER">128</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="r t"><Math mode="inline" tex="1M" text="1 * M" xml:id="S6.T2.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">M</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="r t"><Math mode="inline" tex="10K" text="10 * K" xml:id="S6.T2.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="10" role="NUMBER">10</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" border="l r" thead="row"><text font="typewriter" fontsize="80%">GloVe</text></td>
            <td align="center" border="r" thead="row"><text fontsize="80%">Word embeddings</text></td>
            <td align="center" border="r" thead="row"><text fontsize="80%">Uniform random</text></td>
            <td align="center" border="r"><Math mode="inline" tex="100" text="100" xml:id="S6.T2.m4">
                <XMath>
                  <XMTok fontsize="80%" meaning="100" role="NUMBER">100</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="r"><Math mode="inline" tex="1.18M" text="1.18 * M" xml:id="S6.T2.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="1.18" role="NUMBER">1.18</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">M</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="r"><Math mode="inline" tex="10K" text="10 * K" xml:id="S6.T2.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="10" role="NUMBER">10</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" border="l r" thead="row"><text font="typewriter" fontsize="80%">Deep</text></td>
            <td align="center" border="r" thead="row"><text fontsize="80%">GoogLeNet embeddings</text></td>
            <td align="center" border="r" thead="row"><text fontsize="80%">Uniform random</text></td>
            <td align="center" border="r"><Math mode="inline" tex="96" text="96" xml:id="S6.T2.m7">
                <XMath>
                  <XMTok fontsize="80%" meaning="96" role="NUMBER">96</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="r"><Math mode="inline" tex="9.9M" text="9.9 * M" xml:id="S6.T2.m8">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="9.9" role="NUMBER">9.9</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">M</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="r"><Math mode="inline" tex="10K" text="10 * K" xml:id="S6.T2.m9">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="10" role="NUMBER">10</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" border="l r" thead="row"><text font="typewriter" fontsize="80%">Redcaps</text></td>
            <td align="center" border="r" thead="row"><text fontsize="80%">CLIP image embeddings</text></td>
            <td align="center" border="r" thead="row"><text fontsize="80%">Timestamps</text></td>
            <td align="center" border="r"><Math mode="inline" tex="512" text="512" xml:id="S6.T2.m10">
                <XMath>
                  <XMTok fontsize="80%" meaning="512" role="NUMBER">512</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="r"><Math mode="inline" tex="11.6M" text="11.6 * M" xml:id="S6.T2.m11">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="11.6" role="NUMBER">11.6</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">M</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="r"><Math mode="inline" tex="800" text="800" xml:id="S6.T2.m12">
                <XMath>
                  <XMTok fontsize="80%" meaning="800" role="NUMBER">800</XMTok>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="center" border="b l r" thead="row"><text font="typewriter" fontsize="80%">Adverse</text></td>
            <td align="center" border="b r" thead="row"><text fontsize="80%">Mixture of Gaussians</text></td>
            <td align="center" border="b r" thead="row"><text fontsize="80%">Noisy cluster ID</text></td>
            <td align="center" border="b r"><Math mode="inline" tex="100" text="100" xml:id="S6.T2.m13">
                <XMath>
                  <XMTok fontsize="80%" meaning="100" role="NUMBER">100</XMTok>
                </XMath>
              </Math></td>
            <td align="center" border="b r"><Math mode="inline" tex="1M" text="1 * M" xml:id="S6.T2.m14">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="1" role="NUMBER">1</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">M</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="b r"><Math mode="inline" tex="9.9K" text="9.9 * K" xml:id="S6.T2.m15">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="80%" meaning="9.9" role="NUMBER">9.9</XMTok>
                    <XMTok font="italic" fontsize="80%" role="UNKNOWN">K</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <para class="ltx_noindent" xml:id="S6.p7">
      <p><text font="bold">Datasets.</text><!--  %“label–sec:datasets˝ -->
The datasets that we use are listed in <ref labelref="LABEL:tab:dataset_sum" show="creftype~refnum"/> and further explained below. All datasets are available in the same repository as the code; licensing information is included in <ref labelref="LABEL:app:licensing" show="creftype~refnum"/>.</p>
    </para>
    <para xml:id="S6.p8">
      <itemize>
        <item xml:id="S6.I1.i1">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">1st item</tag>
          </tags>
          <para xml:id="S6.I1.i1.p1">
            <p><text font="typewriter">SIFT</text>, <text font="typewriter">GloVe</text>, and <text font="typewriter">Deep</text> are ANN datasets from the widely used and standardized ANN benchmarks repository <cite class="ltx_citemacro_citep">(<bibref bibrefs="aumuller2020ann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>)</cite>. To adapt them to window search, we generate a label for each point uniformly at random between <Math mode="inline" tex="0" text="0" xml:id="S6.I1.i1.p1.m1">
                <XMath>
                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                </XMath>
              </Math> and <Math mode="inline" tex="1" text="1" xml:id="S6.I1.i1.p1.m2">
                <XMath>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMath>
              </Math>. We create <Math mode="inline" tex="16" text="16" xml:id="S6.I1.i1.p1.m3">
                <XMath>
                  <XMTok meaning="16" role="NUMBER">16</XMTok>
                </XMath>
              </Math> different query sets <Math mode="inline" tex="Q_{1},\ldots,Q_{16}" text="list@(Q _ 1, ldots, Q _ 16)" xml:id="S6.I1.i1.p1.m4">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S6.I1.i1.p1.m4.2"/>
                      <XMRef idref="S6.I1.i1.p1.m4.1"/>
                      <XMRef idref="S6.I1.i1.p1.m4.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S6.I1.i1.p1.m4.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="S6.I1.i1.p1.m4.1">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S6.I1.i1.p1.m4.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                        <XMTok fontsize="70%" meaning="16" role="NUMBER">16</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>, each one using the same <Math mode="inline" tex="10000" text="10000" xml:id="S6.I1.i1.p1.m5">
                <XMath>
                  <XMTok meaning="10000" role="NUMBER">10000</XMTok>
                </XMath>
              </Math> query vectors from ANN benchmarks with random filters of fraction <Math mode="inline" tex="2^{-i}" text="2 ^ (- i)" xml:id="S6.I1.i1.p1.m6">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>.</p>
          </para>
        </item>
        <item xml:id="S6.I1.i2">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">2nd item</tag>
          </tags>
          <para xml:id="S6.I1.i2.p1">
            <p><text font="typewriter">Redcaps</text> is a dataset we created that builds on the RedCaps <cite class="ltx_citemacro_citep">(<bibref bibrefs="desai2021redcaps" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>)</cite> image and caption dataset, which consists of <Math mode="inline" tex="11.6M" text="11.6 * M" xml:id="S6.I1.i2.p1.m1">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok meaning="11.6" role="NUMBER">11.6</XMTok>
                    <XMTok font="italic" role="UNKNOWN">M</XMTok>
                  </XMApp>
                </XMath>
              </Math> Reddit, Imgur, and Flickr images and associated captions. To adapt RedCaps to window search, we use CLIP <cite class="ltx_citemacro_citep">(<bibref bibrefs="radford2021learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>)</cite> to generate an embedding for each image and use the timestamp of the image as its label. We create a set of <Math mode="inline" tex="800" text="800" xml:id="S6.I1.i2.p1.m2">
                <XMath>
                  <XMTok meaning="800" role="NUMBER">800</XMTok>
                </XMath>
              </Math> query vectors by asking ChatGPT-4 <cite class="ltx_citemacro_citep">(<bibref bibrefs="achiam2023gpt" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                  <bibrefphrase>, </bibrefphrase>
                </bibref>)</cite> to come up with queries for an image search system, which we then embed using CLIP. See <ref labelref="LABEL:app:redcaps_gpt" show="creftype~refnum"/> for full prompt details. We again create <Math mode="inline" tex="16" text="16" xml:id="S6.I1.i2.p1.m3">
                <XMath>
                  <XMTok meaning="16" role="NUMBER">16</XMTok>
                </XMath>
              </Math> different query sets <Math mode="inline" tex="Q_{1},\ldots,Q_{16}" text="list@(Q _ 1, ldots, Q _ 16)" xml:id="S6.I1.i2.p1.m4">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="S6.I1.i2.p1.m4.2"/>
                      <XMRef idref="S6.I1.i2.p1.m4.1"/>
                      <XMRef idref="S6.I1.i2.p1.m4.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S6.I1.i2.p1.m4.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="S6.I1.i2.p1.m4.1">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S6.I1.i2.p1.m4.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                        <XMTok fontsize="70%" meaning="16" role="NUMBER">16</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math> using the same <Math mode="inline" tex="800" text="800" xml:id="S6.I1.i2.p1.m5">
                <XMath>
                  <XMTok meaning="800" role="NUMBER">800</XMTok>
                </XMath>
              </Math> query vectors with random filters of fraction <Math mode="inline" tex="2^{-i}" text="2 ^ (- i)" xml:id="S6.I1.i2.p1.m6">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>.</p>
          </para>
        </item>
        <item xml:id="S6.I1.i3">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">3rd item</tag>
          </tags>
          <para xml:id="S6.I1.i3.p1">
            <p><text font="typewriter">Adverse</text> is a synthetic dataset tailored to disadvantage methods that rely on the label and point distributions being independent. The overall idea is to craft a dataset and queries where the points that meet the filter constraint are much farther away from the query than the rest of the dataset. To do this, we let <Math mode="inline" tex="D" text="D" xml:id="S6.I1.i3.p1.m1">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                </XMath>
              </Math> be a mixture of <Math mode="inline" tex="100" text="100" xml:id="S6.I1.i3.p1.m2">
                <XMath>
                  <XMTok meaning="100" role="NUMBER">100</XMTok>
                </XMath>
              </Math> Gaussians and draw <Math mode="inline" tex="10000" text="10000" xml:id="S6.I1.i3.p1.m3">
                <XMath>
                  <XMTok meaning="10000" role="NUMBER">10000</XMTok>
                </XMath>
              </Math> points from each Gaussian, where the means <Math mode="inline" tex="\mu_{i}" text="mu _ i" xml:id="S6.I1.i3.p1.m4">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMath>
              </Math> are drawn from <Math mode="inline" tex="N(0,I)" text="N * open-interval@(0, I)" xml:id="S6.I1.i3.p1.m5">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S6.I1.i3.p1.m5.1"/>
                        <XMRef idref="S6.I1.i3.p1.m5.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="S6.I1.i3.p1.m5.1">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.I1.i3.p1.m5.2">I</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math> and each Gaussian is distributed as <Math mode="inline" tex="N(\mu_{i},0.01\cdot I)" text="N * open-interval@(mu _ i, 0.01 cdot I)" xml:id="S6.I1.i3.p1.m6">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S6.I1.i3.p1.m6.1"/>
                        <XMRef idref="S6.I1.i3.p1.m6.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S6.I1.i3.p1.m6.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S6.I1.i3.p1.m6.2">
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMTok meaning="0.01" role="NUMBER">0.01</XMTok>
                          <XMTok font="italic" role="UNKNOWN">I</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math> (<Math mode="inline" tex="I" text="I" xml:id="S6.I1.i3.p1.m7">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">I</XMTok>
                </XMath>
              </Math> is the <Math mode="inline" tex="100" text="100" xml:id="S6.I1.i3.p1.m8">
                <XMath>
                  <XMTok meaning="100" role="NUMBER">100</XMTok>
                </XMath>
              </Math>-dimensional identity matrix). A point generated from the <Math mode="inline" tex="i" text="i" xml:id="S6.I1.i3.p1.m9">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                </XMath>
              </Math>’th Gaussian has a label equal to <Math mode="inline" tex="i+\mathsf{Uniform}(-0.5,0.5)" text="i + Uniform * open-interval@(- 0.5, 0.5)" xml:id="S6.I1.i3.p1.m10">
                <XMath>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" role="UNKNOWN">i</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="sansserif" role="UNKNOWN">Uniform</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S6.I1.i3.p1.m10.2"/>
                          <XMRef idref="S6.I1.i3.p1.m10.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S6.I1.i3.p1.m10.2">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok meaning="0.5" role="NUMBER" xml:id="S6.I1.i3.p1.m10.1">0.5</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>, and we generate a query for every pair <Math mode="inline" tex="i,j\in\{1,\ldots,100\}" text="list@(i, j) element-of set@(1, ldots, 100)" xml:id="S6.I1.i3.p1.m11">
                <XMath>
                  <XMApp>
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S6.I1.i3.p1.m11.4"/>
                        <XMRef idref="S6.I1.i3.p1.m11.5"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.I1.i3.p1.m11.4">i</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S6.I1.i3.p1.m11.5">j</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S6.I1.i3.p1.m11.1"/>
                        <XMRef idref="S6.I1.i3.p1.m11.2"/>
                        <XMRef idref="S6.I1.i3.p1.m11.3"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMTok meaning="1" role="NUMBER" xml:id="S6.I1.i3.p1.m11.1">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="ldots" role="ID" xml:id="S6.I1.i3.p1.m11.2">…</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok meaning="100" role="NUMBER" xml:id="S6.I1.i3.p1.m11.3">100</XMTok>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math> with <Math mode="inline" tex="i\neq j" text="i not-equals j" xml:id="S6.I1.i3.p1.m12">
                <XMath>
                  <XMApp>
                    <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                    <XMTok font="italic" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" role="UNKNOWN">j</XMTok>
                  </XMApp>
                </XMath>
              </Math> that consists of a random point drawn from Gaussian <Math mode="inline" tex="i" text="i" xml:id="S6.I1.i3.p1.m13">
                <XMath>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                </XMath>
              </Math> with window filter <Math mode="inline" tex="(j-0.5,j+0.5)" text="open-interval@(j - 0.5, j + 0.5)" xml:id="S6.I1.i3.p1.m14">
                <XMath>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S6.I1.i3.p1.m14.1"/>
                      <XMRef idref="S6.I1.i3.p1.m14.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S6.I1.i3.p1.m14.1">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                        <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S6.I1.i3.p1.m14.2">
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                        <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>. In other words, each query filters to only points from a different cluster than it itself is drawn from.</p>
          </para>
        </item>
      </itemize>
    </para>
<!--  %“shangdi–I think we can move the description of optimized postfiltering, super post filtering, and three split to section 4. Since they are part of our contribution. In section 4, we can have a query subsection, and describe different query methods. ˝ “julian–i agree˝ -->    <para class="ltx_noindent" xml:id="S6.p9">
      <p><text font="bold">Query Methods and Hyper-parameters.</text>
We run all of the query methods described in <ref labelref="LABEL:sec:naive_baslines" show="creftype~refnum"/>, <ref labelref="LABEL:sec:beta_wst" show="creftype~refnum"/>, and <ref labelref="LABEL:sec:query_methods" show="creftype~refnum"/>. For all methods that use an arbitrary index <Math mode="inline" tex="A" text="A" xml:id="S6.p9.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">A</XMTok>
          </XMath>
        </Math>, we use a Vamana index as described earlier. We run <ref labelref="LABEL:alg:query" show="creftype~refnum"/> with <Math mode="inline" tex="\beta=2" text="beta = 2" xml:id="S6.p9.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMApp>
          </XMath>
        </Math><!--  %except in~“cref–sec:varying˙beta˝, where we examine the effect of varying $“beta$; -->
unless specified otherwise;
we call this method <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p9.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math> in our experiments. We use <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p9.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> unmodified as described in <ref labelref="LABEL:sec:naive_baslines" show="creftype~refnum"/>. We expect <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p9.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> to always achieve near 100% recall; it may not be 100% exactly due to numerical precision issues. For <Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S6.p9.m6">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S6.p9.m7">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.p9.m8">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math>, and <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p9.m9">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math>, we search over initial values of <Math mode="inline" tex="k" text="k" xml:id="S6.p9.m10">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math> in <Math mode="inline" tex="[10,20,40,80,160,320,640,1280]" text="list@(10, 20, 40, 80, 160, 320, 640, 1280)" xml:id="S6.p9.m11">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="list"/>
                <XMRef idref="S6.p9.m11.1"/>
                <XMRef idref="S6.p9.m11.2"/>
                <XMRef idref="S6.p9.m11.3"/>
                <XMRef idref="S6.p9.m11.4"/>
                <XMRef idref="S6.p9.m11.5"/>
                <XMRef idref="S6.p9.m11.6"/>
                <XMRef idref="S6.p9.m11.7"/>
                <XMRef idref="S6.p9.m11.8"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">[</XMTok>
                <XMTok meaning="10" role="NUMBER" xml:id="S6.p9.m11.1">10</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="20" role="NUMBER" xml:id="S6.p9.m11.2">20</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="40" role="NUMBER" xml:id="S6.p9.m11.3">40</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="80" role="NUMBER" xml:id="S6.p9.m11.4">80</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="160" role="NUMBER" xml:id="S6.p9.m11.5">160</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="320" role="NUMBER" xml:id="S6.p9.m11.6">320</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="640" role="NUMBER" xml:id="S6.p9.m11.7">640</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="1280" role="NUMBER" xml:id="S6.p9.m11.8">1280</XMTok>
                <XMTok role="CLOSE" stretchy="false">]</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{final\_multiply}" text="final * _ * multiply" xml:id="S6.p9.m12">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="sansserif" role="UNKNOWN">final</XMTok>
              <XMTok role="UNKNOWN">_</XMTok>
              <XMTok font="sansserif" role="UNKNOWN">multiply</XMTok>
            </XMApp>
          </XMath>
        </Math> value in <Math mode="inline" tex="[1,2,3,4,8,16,32]" text="list@(1, 2, 3, 4, 8, 16, 32)" xml:id="S6.p9.m13">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="list"/>
                <XMRef idref="S6.p9.m13.1"/>
                <XMRef idref="S6.p9.m13.2"/>
                <XMRef idref="S6.p9.m13.3"/>
                <XMRef idref="S6.p9.m13.4"/>
                <XMRef idref="S6.p9.m13.5"/>
                <XMRef idref="S6.p9.m13.6"/>
                <XMRef idref="S6.p9.m13.7"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">[</XMTok>
                <XMTok meaning="1" role="NUMBER" xml:id="S6.p9.m13.1">1</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="2" role="NUMBER" xml:id="S6.p9.m13.2">2</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="3" role="NUMBER" xml:id="S6.p9.m13.3">3</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="4" role="NUMBER" xml:id="S6.p9.m13.4">4</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="8" role="NUMBER" xml:id="S6.p9.m13.5">8</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="16" role="NUMBER" xml:id="S6.p9.m13.6">16</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok meaning="32" role="NUMBER" xml:id="S6.p9.m13.7">32</XMTok>
                <XMTok role="CLOSE" stretchy="false">]</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>. We use the setting <Math mode="inline" tex="\gamma=2" text="gamma = 2" xml:id="S6.p9.m14">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMApp>
          </XMath>
        </Math> from <ref labelref="LABEL:thm:betterblowup" show="creftype~refnum"/> for <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p9.m15">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math>, which guarantees a worst case blowup factor of <Math mode="inline" tex="4" text="4" xml:id="S6.p9.m16">
          <XMath>
            <XMTok meaning="4" role="NUMBER">4</XMTok>
          </XMath>
        </Math> using in practice about <Math mode="inline" tex="1.5" text="1.5" xml:id="S6.p9.m17">
          <XMath>
            <XMTok meaning="1.5" role="NUMBER">1.5</XMTok>
          </XMath>
        </Math> times as much memory as <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p9.m18">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="S6.p10">
      <p>We also compare against <Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p10.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="milvus2022hybridsearch" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and <Math mode="inline" tex="\mathsf{VBASE}" text="VBASE" xml:id="S6.p10.m2">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VBASE</XMTok>
          </XMath>
        </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="vbase" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, two existing systems that support window search.</p>
    </para>
    <para xml:id="S6.p11">
      <p><Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p11.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math> treats window search as an instantiation of categorial filter search. Before querying the underlying ANNS index, <Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p11.m2">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math> creates a bitset that marks all of the points that meet the window filter. Then, while traversing the underlying ANNS index, Milvus ignores points that are not set in the bitset. We try all supported underlying <Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p11.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math> indices: HNSW, IVF_PQ, IVF_SQ8, SCANN, and IVF_FLAT. We search over the same beam sizes as for <Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S6.p11.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
          </XMath>
        </Math>. <Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p11.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math> does not natively support a batch query with different filters for each point in the batch, so we wrote a Python multiprocessing program that spins up many processes that query the constructed index in parallel.</p>
    </para>
    <para xml:id="S6.p12">
      <p><!--  %“julian–updated to singular, as I only see one idea for VBASE described in “cref–sec:related˝˝ -->In addition to the heuristic
described in <ref labelref="LABEL:sec:related" show="creftype~refnum"/>, <Math mode="inline" tex="\mathsf{VBASE}" text="VBASE" xml:id="S6.p12.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VBASE</XMTok>
          </XMath>
        </Math> uses a query planning step to attempt to predict how many initial results to retrieve, then filters these retrieved results, before finally applying a final top-<Math mode="inline" tex="k" text="k" xml:id="S6.p12.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">k</XMTok>
          </XMath>
        </Math> ranking to the retrieved results that meet the filter constraint. We were not able to get multiple queries to run in parallel with VBASE (and in the original paper they also only operate in the regime of a single query at a time).</p>
    </para>
<!--  %“begin–list˝–“textbullet˝–% 
     %“setlength–“leftmargin˝–0.5em˝ 
     %“setlength–“itemindent˝–0em˝ 
     %“setlength–“labelwidth˝–“itemindent˝ 
     %“setlength–“labelsep˝–0.5em˝ 
     %**** paper.tex Line 725 **** 
     %“setlength–“listparindent˝–1em˝ 
     %“setlength–“itemsep˝–0em˝ 
     %“setlength–“parsep˝–0em˝ 
     %“setlength–“topsep˝–0em˝ 
     %“setlength–“partopsep˝–0em˝ 
     %˝ 
     %“item We use “algname–Prefiltering˝ unmodified as described in “cref–sec:query˙methods˝. 
     %% is one of the main naive baselines that we compare against and does well  on queries with a small filter fraction. “algname–Prefiltering˝ works by first sorting all of the points by label ahead of time. Given a query $x$ with window filter $(a, b)$, we do binary search on the sorted labels to find the start and end of the range that meet the filter constraints, and then find the distance between $x$ and every point in the range, before finally returning the closest $10$ points to $x$ in the range. 
     %“item For “algname–Postfiltering˝, “algname–Optimized Postfiltering˝, and “algname–Super Postfiltering˝ we search over initial beam sizes in $[10, 20, 40, 80, 160, 320, 640, 1280]$ and $“mathsf–final“˙multiply˝$ in $[1, 2, 3, 4, 8, 16, 32]$. We use the setting $“beta = 2$  from “cref–thm:betterblowup˝ for “algname–Super Postfiltering˝, which guarantees a worst case blowup factor of $4$ using in practice about $1.5$ times as much memory as “algname–Vamana WST˝. 
     %“item We run “algname–Vamana WST˝ with $“beta = 2$ except in~“cref–sec:varying˙beta˝, where we examine the effect of varying $“beta$. We search over the same beam sizes as for “algname–Postfiltering˝. 
     %% “item “algname–Optimized Postfiltering˝ uses the same index as “algname–Vamana WST˝, but uses a different querying method. Given a query $x$ with window filter $(a, b)$, “algname–Optimized Postfiltering˝ finds the smallest subset $S$ of $D$ corresponding to an index we built $I = A(S)$ where $D˙–(a, b)˝ “subset S$, and then queries that index using the same procedure and hyperparameters as described in “algname–Postfiltering˝. “julian–discuss the blowup factor. does the blowup here correspond to one of the warmup cases discussed earlier?˝ 
     %“item We do the same hyperparameter search for the postfiltering subroutines in “algname–Three Split˝ as we do for “algname–Postfiltering˝, and we use the same beam search size for the center ranges. 
     %“item “algname–Milvus˝~“cite–milvus2022hybridsearch˝ is the first existing system that we compare against.  “algname–Milvus˝ treats window search as an instantiation of categorial filter search. Before querying the underlying ANN index, “algname–Milvus˝ creates a bitset that marks all of the points that meet the window filter. Then, while traversing the underlying ANN index, Milvus ignores points that are not set in the bitset. We try all supported underlying “algname–Milvus˝ indices: HNSW, IVF“˙PQ, IVF“˙SQ8, SCANN, and IVF“˙FLAT. “algname–Milvus˝ does not natively support a batch query with different filters for each point in the batch, so we write a Python multiprocessing program that spins up many processes that query the constructed index in parallel. 
     %“item “algname–VBASE˝~“cite–vbase˝ is the second existing baseline that we compare against. It uses a query planning step to attempt to predict how many initial results to retrieve, then filters these retrieved results before applying a final top-$k$ ranking to the retrieved results that meet the filter constraint. “josh–Ben is this consistent with how you describe VBASE above? I got this from their paper.˝ We were not able to get multiple queries to run in parallel with VBASE (and in the original paper they also only operate in the regime of a single query at a time). 
     %“end–list˝ -->    <figure inlist="lof" labels="LABEL:fig:deep_results" placement="t" xml:id="S6.F2">
      <tags>
        <tag>Figure 2</tag>
        <tag role="autoref">Figure 2</tag>
        <tag role="creftype">Figure</tag>
        <tag role="creftypecap">Figure</tag>
        <tag role="creftypeplural">Figures</tag>
        <tag role="creftypepluralcap">Figures</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <p align="center" class="ltx_align_center"><graphics candidates="images/deep-image-96-angular_results_vamana.pdf" graphic="images/deep-image-96-angular_results_vamana.pdf" options="width=455.24408pt,keepaspectratio=true" xml:id="S6.F2.g1"/></p>
      <toccaption class="ltx_centering"><tag close=" ">2</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">Deep</text> using 16 threads. Up and to the right is better. On medium filter fraction settings, our methods achieve orders of magnitude more queries per second than the baselines at the same recall levels. Points along the Pareto frontier are denoted by circles for baseline methods and X’s for our methods.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 2</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">Deep</text> using 16 threads. Up and to the right is better. On medium filter fraction settings, our methods achieve orders of magnitude more queries per second than the baselines at the same recall levels. Points along the Pareto frontier are denoted by circles for baseline methods and X’s for our methods.
</caption>
    </figure>
<!--  %“vspace–-30pt˝ -->    <para class="ltx_noindent" xml:id="S6.p13">
      <p><text font="bold">Tradeoff of Queries per Second vs. Recall.</text><!--  %“label–sec:qps˙v˙recall˝ -->
We plot the Pareto frontier of recall vs. queries per second of all methods on a selection of filter fractions on <text font="typewriter">Deep</text> in <ref labelref="LABEL:fig:deep_results" show="creftype~refnum"/><!--  %For a given method and filter fraction, the Pareto frontier is computed on the set of (recall, queries per second) pairs that come from running an experiment for each hyper-parameter configuration. “julian–it would be helpful to state how the different points for a given method and filter fraction are generated (i’m not sure what parameters there are to tune for the baselines)˝ --> (the indices we compute the frontier on correspond to the hyper-parameters specified in the last section).
We include plots of other datasets in <ref labelref="LABEL:sec:experiments-appendix" show="creftype~refnum"/>; the main observations are substantially the same across datasets. Overall, our methods achieve multiple orders of magnitude query speedup at fixed recall levels. <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p13.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math> does particularly well at lower recall levels of around <Math mode="inline" tex="0.9" text="0.9" xml:id="S6.p13.m2">
          <XMath>
            <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
          </XMath>
        </Math> to <Math mode="inline" tex="0.99" text="0.99" xml:id="S6.p13.m3">
          <XMath>
            <XMTok meaning="0.99" role="NUMBER">0.99</XMTok>
          </XMath>
        </Math>, while at high recall levels <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p13.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.p13.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math> are the best methods, attaining about the same performance. Additionally, for small filter fractions the <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p13.m6">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> baseline is competitive with our methods, whereas for large filter fractions the <Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S6.p13.m7">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
          </XMath>
        </Math><!--  %and it is in these domains that we see the largest speedups. --> baseline is competitive. Our methods achieve the largest speedups over baselines in the medium filter fractions.
We note that among our methods, <!--  %“laxman–The reviewers may find the terms ‘‘low’’ ‘‘middle’’ and ‘‘high’’ filter fractions confusing. I’m not sure we clearly say what low/middle/high mean either. How about calling them ‘‘small’’, vs. ‘‘large’’, where small means the filter is a small fraction of the dataset?˝ --><Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S6.p13.m8">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
          </XMath>
        </Math> performs the worst, which we explain with the high worst case blowup of a <Math mode="inline" tex="2" text="2" xml:id="S6.p13.m9">
          <XMath>
            <XMTok meaning="2" role="NUMBER">2</XMTok>
          </XMath>
        </Math>-WST (see <ref labelref="LABEL:lem:wstblowup" show="creftype~refnum"/>). Finally, we note that the two vector databases that we test against, <Math mode="inline" tex="\mathsf{VBASE}" text="VBASE" xml:id="S6.p13.m10">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VBASE</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{Milvus}" text="Milvus" xml:id="S6.p13.m11">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Milvus</XMTok>
          </XMath>
        </Math>, are completely dominated by our naive baselines <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p13.m12">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S6.p13.m13">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
          </XMath>
        </Math>.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:adversarial_results" placement="t" xml:id="S6.F3">
      <tags>
        <tag>Figure 3</tag>
        <tag role="autoref">Figure 3</tag>
        <tag role="creftype">Figure</tag>
        <tag role="creftypecap">Figure</tag>
        <tag role="creftypeplural">Figures</tag>
        <tag role="creftypepluralcap">Figures</tag>
        <tag role="refnum">3</tag>
        <tag role="typerefnum">Figure 3</tag>
      </tags>
      <p class="ltx_align_center"><graphics candidates="images/adversarial-100-angular_results_vamana.pdf" graphic="images/adversarial-100-angular_results_vamana.pdf" options="width=390.25534pt,keepaspectratio=true" xml:id="S6.F3.g1"/></p>
      <toccaption><tag close=" "><!--  %**** paper.tex Line 775 **** -->3<!--  %**** paper.tex Line 775 **** 
     %**** paper.tex Line 775 **** 
     %**** paper.tex Line 775 **** 
     %**** paper.tex Line 775 **** 
     %**** paper.tex Line 775 **** --></tag><!--  %**** paper.tex Line 775 **** -->Comparison of window search methods on <text font="typewriter">Adverse</text>. Up and to the right is better. <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.F3.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.F3.m2">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math> achieve a good recall vs. latency tradeoff, but besides the <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.F3.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> baseline all of the other methods are unable to achieve a reasonable recall. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="S6.F3.m4">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math> threads.
</toccaption>
      <caption><tag close=": ">Figure 3</tag><!--  %**** paper.tex Line 775 **** 
     %**** paper.tex Line 775 **** -->Comparison of window search methods on <!--  %**** paper.tex Line 775 **** 
     %**** paper.tex Line 775 **** --><text font="typewriter">Adverse</text>. Up and to the right is better. <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.F3.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math> and <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.F3.m6">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math> achieve a good recall vs. latency tradeoff, but besides the <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.F3.m7">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> baseline all of the other methods are unable to achieve a reasonable recall. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="S6.F3.m8">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math> threads.
</caption>
    </figure>
    <para xml:id="S6.p14">
      <p>We also plot results on <text font="typewriter">Adverse</text> in <ref labelref="LABEL:fig:adversarial_results" show="creftype~refnum"/>.
<Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p14.m1">
          <XMath>
<!--  %, with windows as described in~\cref{sec:datasets}. -->            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> does well, as expected. Furthermore, <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p14.m2">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math> offers a good tradeoff between recall and query latency, which makes sense because the query time guarantee from <ref labelref="LABEL:lem:existingannruntime" show="creftype~refnum"/> (assuming Vamana also does well for top-<Math mode="inline" tex="10" text="10" xml:id="S6.p14.m3">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math><!--  %“julian–the theory only holds for 1-NN though˝. “laxman–I think the decomposition result guarantees that we consider all points; the fact that the recall is good is due to Vamana being a good algorithm for $k$-NN empirically?˝ --> ANN) holds for any query distribution, even an adversarial one.
However, all of the methods that rely solely on postfiltering, as well as the other baselines, fail to achieve meaningful recall. For the postfiltering methods, this result is unsurprising: the index that gets selected for postfiltering has many points that do not meet the query’s filter constraints, and by construction these points are frequently closer to the query than the entire target cluster. The beam search then has to expand over many near neighbors to reach points meeting the filter constraint, at which point the accuracy of the beam search is likely low. Surprisingly, although <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.p14.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math> does use postfiltering as a subroutine, it is able to achieve similar performance to <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p14.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math>; this may be because after querying for the indices that make up the center of the label range (which is <text font="italic">not</text> postfiltering), the label ranges that are left on each side are typically much smaller.</p>
    </para>
<!--  %and so are more easily queried or searched by brute force “julian–not sure what ”more easily queried” means˝. -->    <table inlist="lot" labels="LABEL:tab:speedups" placement="t" xml:id="S6.T3">
      <tags>
        <tag>Table 3</tag>
        <tag role="autoref">Table 3</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">3</tag>
        <tag role="typerefnum">Table 3</tag>
      </tags>
      <toccaption><tag close=" "><text fontsize="80%">3</text></tag><text fontsize="80%">Speedup of our best method over the best baseline, restricted to hyper-parameter settings that yield at least </text><Math mode="inline" tex="0.95" text="0.95" xml:id="S6.T3.m1">
          <XMath>
            <XMTok fontsize="80%" meaning="0.95" role="NUMBER">0.95</XMTok>
          </XMath>
        </Math><text fontsize="80%"> recall. All methods are run with </text><Math mode="inline" tex="16" text="16" xml:id="S6.T3.m2">
          <XMath>
            <XMTok fontsize="80%" meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math><text fontsize="80%"> threads. We show a speedup across all filter fractions smaller than </text><Math mode="inline" tex="2^{-1}" text="2 ^ (- 1)" xml:id="S6.T3.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="56%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math><text fontsize="80%"> on all datasets. We show up to a </text><Math class="ltx_math_unparsed" mode="inline" tex="75\times" xml:id="S6.T3.m4">
          <XMath>
            <XMTok fontsize="80%" meaning="75" role="NUMBER">75</XMTok>
            <XMTok fontsize="80%" meaning="times" role="MULOP">×</XMTok>
          </XMath>
        </Math><text fontsize="80%"> speedup on medium filter fractions.</text></toccaption>
      <caption fontsize="80%"><tag close=": ">Table 3</tag>Speedup of our best method over the best baseline, restricted to hyper-parameter settings that yield at least <Math mode="inline" tex="0.95" text="0.95" xml:id="S6.T3.m5">
          <XMath>
            <XMTok meaning="0.95" role="NUMBER">0.95</XMTok>
          </XMath>
        </Math> recall. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="S6.T3.m6">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math> threads. We show a speedup across all filter fractions smaller than <Math mode="inline" tex="2^{-1}" text="2 ^ (- 1)" xml:id="S6.T3.m7">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> on all datasets. We show up to a <Math class="ltx_math_unparsed" mode="inline" tex="75\times" xml:id="S6.T3.m8">
          <XMath>
            <XMTok meaning="75" role="NUMBER">75</XMTok>
            <XMTok meaning="times" role="MULOP">×</XMTok>
          </XMath>
        </Math> speedup on medium filter fractions.</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="left" border="l r tt" thead="column row"><text fontsize="80%">Dataset</text></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-11}" text="2 ^ (- 11)" xml:id="S6.T3.m9">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="11" role="NUMBER">11</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-10}" text="2 ^ (- 10)" xml:id="S6.T3.m10">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="10" role="NUMBER">10</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-9}" text="2 ^ (- 9)" xml:id="S6.T3.m11">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="9" role="NUMBER">9</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-8}" text="2 ^ (- 8)" xml:id="S6.T3.m12">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="8" role="NUMBER">8</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-7}" text="2 ^ (- 7)" xml:id="S6.T3.m13">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="7" role="NUMBER">7</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-6}" text="2 ^ (- 6)" xml:id="S6.T3.m14">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="6" role="NUMBER">6</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-5}" text="2 ^ (- 5)" xml:id="S6.T3.m15">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="5" role="NUMBER">5</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-4}" text="2 ^ (- 4)" xml:id="S6.T3.m16">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="4" role="NUMBER">4</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-3}" text="2 ^ (- 3)" xml:id="S6.T3.m17">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-2}" text="2 ^ (- 2)" xml:id="S6.T3.m18">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-1}" text="2 ^ (- 1)" xml:id="S6.T3.m19">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="56%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="56%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="right" border="r tt" thead="column"><Math mode="inline" tex="2^{0}" text="2 ^ 0" xml:id="S6.T3.m20">
                <XMath>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                    <XMTok fontsize="56%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" border="l r t" thead="row"><text font="typewriter" fontsize="80%">Deep</text></td>
            <td align="right" border="t"><text fontsize="80%">10.49</text></td>
            <td align="right" border="t"><text fontsize="80%">18.46</text></td>
            <td align="right" border="t"><text fontsize="80%">35.65</text></td>
            <td align="right" border="t"><text fontsize="80%">61.21</text></td>
            <td align="right" border="t"><text fontsize="80%">77.55</text></td>
            <td align="right" border="t"><text fontsize="80%">24.28</text></td>
            <td align="right" border="t"><text fontsize="80%">9.35</text></td>
            <td align="right" border="t"><text fontsize="80%">2.67</text></td>
            <td align="right" border="t"><text fontsize="80%">1.46</text></td>
            <td align="right" border="t"><text fontsize="80%">1.39</text></td>
            <td align="right" border="t"><text fontsize="80%">0.75</text></td>
            <td align="right" border="r t"><text fontsize="80%">0.77</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">SIFT</text></td>
            <td align="right"><text fontsize="80%">1.35</text></td>
            <td align="right"><text fontsize="80%">1.88</text></td>
            <td align="right"><text fontsize="80%">3.05</text></td>
            <td align="right"><text fontsize="80%">4.87</text></td>
            <td align="right"><text fontsize="80%">8.68</text></td>
            <td align="right"><text fontsize="80%">16.51</text></td>
            <td align="right"><text fontsize="80%">11.26</text></td>
            <td align="right"><text fontsize="80%">4.46</text></td>
            <td align="right"><text fontsize="80%">2.26</text></td>
            <td align="right"><text fontsize="80%">1.28</text></td>
            <td align="right"><text fontsize="80%">0.90</text></td>
            <td align="right" border="r"><text fontsize="80%">0.92</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">GloVe</text></td>
            <td align="right"><text fontsize="80%">1.90</text></td>
            <td align="right"><text fontsize="80%">2.27</text></td>
            <td align="right"><text fontsize="80%">2.70</text></td>
            <td align="right"><text fontsize="80%">3.77</text></td>
            <td align="right"><text fontsize="80%">5.02</text></td>
            <td align="right"><text fontsize="80%">6.19</text></td>
            <td align="right"><text fontsize="80%">9.60</text></td>
            <td align="right"><text fontsize="80%">7.62</text></td>
            <td align="right"><text fontsize="80%">2.34</text></td>
            <td align="right"><text fontsize="80%">1.52</text></td>
            <td align="right"><text fontsize="80%">0.92</text></td>
            <td align="right" border="r"><text fontsize="80%">0.92</text></td>
          </tr>
          <tr>
            <td align="left" border="b l r" thead="row"><text font="typewriter" fontsize="80%">Redcaps</text></td>
            <td align="right" border="b"><text fontsize="80%">2.31</text></td>
            <td align="right" border="b"><text fontsize="80%">3.33</text></td>
            <td align="right" border="b"><text fontsize="80%">5.47</text></td>
            <td align="right" border="b"><text fontsize="80%">7.78</text></td>
            <td align="right" border="b"><text fontsize="80%">10.07</text></td>
            <td align="right" border="b"><text fontsize="80%">17.22</text></td>
            <td align="right" border="b"><text fontsize="80%">3.94</text></td>
            <td align="right" border="b"><text fontsize="80%">3.64</text></td>
            <td align="right" border="b"><text fontsize="80%">1.75</text></td>
            <td align="right" border="b"><text fontsize="80%">1.73</text></td>
            <td align="right" border="b"><text fontsize="80%">0.90</text></td>
            <td align="right" border="b r"><text fontsize="80%">0.90</text></td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <para xml:id="S6.p15">
      <p>We also include speedups of our best method (the best of <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p15.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S6.p15.m2">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p15.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math>, and <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.p15.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math>) over the best baseline method on filter fractions <Math mode="inline" tex="i=2^{0},\ldots,2^{-11}" text="i = list@(2 ^ 0, ldots, 2 ^ (- 11))" xml:id="S6.p15.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S6.p15.m5.2"/>
                  <XMRef idref="S6.p15.m5.1"/>
                  <XMRef idref="S6.p15.m5.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S6.p15.m5.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S6.p15.m5.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S6.p15.m5.3">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok fontsize="70%" meaning="11" role="NUMBER">11</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> on all datasets in <ref labelref="LABEL:tab:speedups" show="creftype~refnum"/> at a recall level of <Math mode="inline" tex="0.95" text="0.95" xml:id="S6.p15.m6">
          <XMath>
            <XMTok meaning="0.95" role="NUMBER">0.95</XMTok>
          </XMath>
        </Math>, and we include the same table at additional recall levels in <ref labelref="LABEL:sec:experiments-appendix" show="creftype~refnum"/>. These reinforce our findings in <ref labelref="LABEL:fig:deep_results" show="creftype~refnum"/> across other datasets; at a <Math mode="inline" tex="0.95" text="0.95" xml:id="S6.p15.m7">
          <XMath>
            <XMTok meaning="0.95" role="NUMBER">0.95</XMTok>
          </XMath>
        </Math> recall level, we achieve up to a <Math mode="inline" tex="75" text="75" xml:id="S6.p15.m8">
          <XMath>
            <XMTok meaning="75" role="NUMBER">75</XMTok>
          </XMath>
        </Math>X speedup on <text font="typewriter">Deep</text>, up to a <Math mode="inline" tex="16" text="16" xml:id="S6.p15.m9">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math>X speedup on <text font="typewriter">SIFT</text>, up to a <Math mode="inline" tex="9" text="9" xml:id="S6.p15.m10">
          <XMath>
            <XMTok meaning="9" role="NUMBER">9</XMTok>
          </XMath>
        </Math>X speedup on <text font="typewriter">GloVe</text>, and up to a <Math mode="inline" tex="17" text="17" xml:id="S6.p15.m11">
          <XMath>
            <XMTok meaning="17" role="NUMBER">17</XMTok>
          </XMath>
        </Math>X speedup on <text font="typewriter">Redcaps</text>.</p>
    </para>
    <table inlist="lot" labels="LABEL:table:build-times-datasets" placement="t" xml:id="S6.T4">
      <tags>
        <tag>Table 4</tag>
        <tag role="autoref">Table 4</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">4</tag>
        <tag role="typerefnum">Table 4</tag>
      </tags>
      <toccaption><tag close=" "><text fontsize="80%">4</text></tag><text fontsize="80%">Build times for different indexing methods across all datasets, rounded to the nearest unit. Index construction was done using </text><Math mode="inline" tex="80" text="80" xml:id="S6.T4.m1">
          <XMath>
            <XMTok fontsize="80%" meaning="80" role="NUMBER">80</XMTok>
          </XMath>
        </Math><text fontsize="80%"> threads.</text></toccaption>
      <caption fontsize="80%"><tag close=": ">Table 4</tag>Build times for different indexing methods across all datasets, rounded to the nearest unit. Index construction was done using <Math mode="inline" tex="80" text="80" xml:id="S6.T4.m2">
          <XMath>
            <XMTok meaning="80" role="NUMBER">80</XMTok>
          </XMath>
        </Math> threads.</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="left" border="l r t" thead="column row"><text font="bold" fontsize="80%">Dataset</text></td>
            <td align="right" border="r t" thead="column"><text font="bold" fontsize="80%">Vamana</text></td>
            <td align="right" border="r t" thead="column"><Math mode="inline" tex="2" text="2" xml:id="S6.T4.m3">
                <XMath>
                  <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                </XMath>
              </Math><text font="bold" fontsize="80%">-WST</text></td>
            <td align="right" border="r t" thead="column"><text font="bold" fontsize="80%">Super</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" border="l r t" thead="row"><text font="typewriter" fontsize="80%">SIFT</text></td>
            <td align="right" border="r t"><text fontsize="80%">1 m</text></td>
            <td align="right" border="r t"><text fontsize="80%">8 m</text></td>
            <td align="right" border="r t"><text fontsize="80%">14 m</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">GloVe</text></td>
            <td align="right" border="r"><text fontsize="80%">3 m</text></td>
            <td align="right" border="r"><text fontsize="80%">17 m</text></td>
            <td align="right" border="r"><text fontsize="80%">28 m</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">Deep</text></td>
            <td align="right" border="r"><text fontsize="80%">17 m</text></td>
            <td align="right" border="r"><text fontsize="80%">2 h</text></td>
            <td align="right" border="r"><text fontsize="80%">4 h</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">Redcaps</text></td>
            <td align="right" border="r"><text fontsize="80%">2 h</text></td>
            <td align="right" border="r"><text fontsize="80%">7 h</text></td>
            <td align="right" border="r"><text fontsize="80%">19 h</text></td>
          </tr>
          <tr>
            <td align="left" border="b l r" thead="row"><text font="typewriter" fontsize="80%">Adverse</text></td>
            <td align="right" border="b r"><text fontsize="80%">3 m</text></td>
            <td align="right" border="b r"><text fontsize="80%">23 m</text></td>
            <td align="right" border="b r"><text fontsize="80%">41 m</text></td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <table inlist="lot" labels="LABEL:table:index-sizes-datasets" placement="t" xml:id="S6.T5">
      <tags>
        <tag>Table 5</tag>
        <tag role="autoref">Table 5</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">5</tag>
        <tag role="typerefnum">Table 5</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" ">5</tag>Index sizes for different indexing methods on all datasets, rounded to the nearest <Math mode="inline" tex="10" text="10" xml:id="S6.T5.m1">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math>th of a GB. Note that prefiltering takes just the memory of the original dataset. The ”Raw” column is the size of just the dataset.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Table 5</tag>Index sizes for different indexing methods on all datasets, rounded to the nearest <Math mode="inline" tex="10" text="10" xml:id="S6.T5.m2">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math>th of a GB. Note that prefiltering takes just the memory of the original dataset. The ”Raw” column is the size of just the dataset.</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="left" border="l r t" thead="column row"><text font="bold" fontsize="80%">Dataset</text></td>
            <td align="right" border="r t" thead="column"><text font="bold" fontsize="80%">Raw</text></td>
            <td align="right" border="r t" thead="column"><text font="bold" fontsize="80%">Vamana</text></td>
            <td align="right" border="r t" thead="column"><Math mode="inline" tex="2" text="2" xml:id="S6.T5.m3">
                <XMath>
                  <XMTok fontsize="80%" meaning="2" role="NUMBER">2</XMTok>
                </XMath>
              </Math><text font="bold" fontsize="80%">-WST</text></td>
            <td align="right" border="r t" thead="column"><text font="bold" fontsize="80%">Super</text></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" border="l r t" thead="row"><text font="typewriter" fontsize="80%">SIFT</text></td>
            <td align="right" border="r t"><text fontsize="80%">0.5 GB</text></td>
            <td align="right" border="r t"><text fontsize="80%">1.0 GB</text></td>
            <td align="right" border="r t"><text fontsize="80%">4.7 GB</text></td>
            <td align="right" border="r t"><text fontsize="80%">7.6 GB</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">GloVe</text></td>
            <td align="right" border="r"><text fontsize="80%">0.5 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">1.1 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">5.6 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">9.5 GB</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">Deep</text></td>
            <td align="right" border="r"><text fontsize="80%">3.6 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">6.8 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">53.2 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">94.6 GB</text></td>
          </tr>
          <tr>
            <td align="left" border="l r" thead="row"><text font="typewriter" fontsize="80%">Redcaps</text></td>
            <td align="right" border="r"><text fontsize="80%">23 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">27.1 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">79.2 GB</text></td>
            <td align="right" border="r"><text fontsize="80%">127 GB</text></td>
          </tr>
          <tr>
            <td align="left" border="b l r" thead="row"><text font="typewriter" fontsize="80%">Adverse</text></td>
            <td align="right" border="b r"><text fontsize="80%">0.8 GB</text></td>
            <td align="right" border="b r"><text fontsize="80%">0.9 GB</text></td>
            <td align="right" border="b r"><text fontsize="80%">4.6 GB</text></td>
            <td align="right" border="b r"><text fontsize="80%">7.4 GB</text></td>
          </tr>
        </tbody>
      </tabular>
<!--  %**** paper.tex Line 850 **** -->    </table>
    <para class="ltx_noindent" xml:id="S6.p16">
      <p><text font="bold">Index Memory and Construction Time.</text>
<ref labelref="LABEL:table:build-times-datasets" show="creftype~refnum"/> and <ref labelref="LABEL:table:index-sizes-datasets" show="creftype~refnum"/> show the construction time and memory sizes for a single Vamana index (for <Math mode="inline" tex="\mathsf{Postfiltering}" text="Postfiltering" xml:id="S6.p16.m1">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Postfiltering</XMTok>
          </XMath>
        </Math>), a <Math mode="inline" tex="2" text="2" xml:id="S6.p16.m2">
          <XMath>
            <XMTok meaning="2" role="NUMBER">2</XMTok>
          </XMath>
        </Math>-WST with Vamana indices at each node (for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p16.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="\mathsf{OptimizedPostfiltering}" text="OptimizedPostfiltering" xml:id="S6.p16.m4">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">OptimizedPostfiltering</XMTok>
          </XMath>
        </Math>, and <Math mode="inline" tex="\mathsf{ThreeSplit}" text="ThreeSplit" xml:id="S6.p16.m5">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">ThreeSplit</XMTok>
          </XMath>
        </Math>), and the index for <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p16.m6">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math>. We also show the memory for just the dataset, which is exactly how much memory <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p16.m7">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> needs (the build for <Math mode="inline" tex="\mathsf{Prefiltering}" text="Prefiltering" xml:id="S6.p16.m8">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">Prefiltering</XMTok>
          </XMath>
        </Math> is just a sort and takes less than a few seconds across all datasets). We see that the <Math mode="inline" tex="2" text="2" xml:id="S6.p16.m9">
          <XMath>
            <XMTok meaning="2" role="NUMBER">2</XMTok>
          </XMath>
        </Math>-WST takes about <Math mode="inline" tex="3" text="3" xml:id="S6.p16.m10">
          <XMath>
            <XMTok meaning="3" role="NUMBER">3</XMTok>
          </XMath>
        </Math>–<Math mode="inline" tex="8" text="8" xml:id="S6.p16.m11">
          <XMath>
            <XMTok meaning="8" role="NUMBER">8</XMTok>
          </XMath>
        </Math> times as much memory as a single Vamana index, depending on the dataset, whereas the index for <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p16.m12">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math> takes about <Math mode="inline" tex="5" text="5" xml:id="S6.p16.m13">
          <XMath>
            <XMTok meaning="5" role="NUMBER">5</XMTok>
          </XMath>
        </Math>–<Math mode="inline" tex="14" text="14" xml:id="S6.p16.m14">
          <XMath>
            <XMTok meaning="14" role="NUMBER">14</XMTok>
          </XMath>
        </Math> times as much memory as a single Vamana index. The construction times show a similar increase across methods, with a <Math mode="inline" tex="5" text="5" xml:id="S6.p16.m15">
          <XMath>
            <XMTok meaning="5" role="NUMBER">5</XMTok>
          </XMath>
        </Math>–<Math mode="inline" tex="10" text="10" xml:id="S6.p16.m16">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math>X increase in build time from Vamana to <Math mode="inline" tex="2" text="2" xml:id="S6.p16.m17">
          <XMath>
            <XMTok meaning="2" role="NUMBER">2</XMTok>
          </XMath>
        </Math>-WST and a <Math mode="inline" tex="10" text="10" xml:id="S6.p16.m18">
          <XMath>
            <XMTok meaning="10" role="NUMBER">10</XMTok>
          </XMath>
        </Math>–<Math mode="inline" tex="20" text="20" xml:id="S6.p16.m19">
          <XMath>
            <XMTok meaning="20" role="NUMBER">20</XMTok>
          </XMath>
        </Math>X increase from Vamana to <Math mode="inline" tex="\mathsf{SuperPostfiltering}" text="SuperPostfiltering" xml:id="S6.p16.m20">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">SuperPostfiltering</XMTok>
          </XMath>
        </Math>. Finally, we note that while the larger datasets do take signficantly longer to build, we are using a large beam search construction buffer of <Math mode="inline" tex="500" text="500" xml:id="S6.p16.m21">
          <XMath>
            <XMTok meaning="500" role="NUMBER">500</XMTok>
          </XMath>
        </Math> in order to vary as few hyper-parameters as possible, and a smaller buffer size may give faster build times with minimal loss in recall.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:half_branching_filter_widths" xml:id="S6.F4">
      <tags>
        <tag>Figure 4</tag>
        <tag role="autoref">Figure 4</tag>
        <tag role="creftype">Figure</tag>
        <tag role="creftypecap">Figure</tag>
        <tag role="creftypeplural">Figures</tag>
        <tag role="creftypepluralcap">Figures</tag>
        <tag role="refnum">4</tag>
        <tag role="typerefnum">Figure 4</tag>
      </tags>
      <graphics candidates="images/sift-128-euclidean_branching_results_2pow-1.pdf" class="ltx_centering" graphic="images/sift-128-euclidean_branching_results_2pow-1.pdf" options="width=303.53267pt,keepaspectratio=true" xml:id="S6.F4.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">4</tag>Pareto curves of recall vs. throughput on the SIFT dataset for a filter fraction of <Math mode="inline" tex="2^{-1}" text="2 ^ (- 1)" xml:id="S6.F4.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> and varying branching factors <Math mode="inline" tex="\beta" text="beta" xml:id="S6.F4.m2">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math> for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.F4.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math>. Up and to the right is better. All trials are run with <Math mode="inline" tex="16" text="16" xml:id="S6.F4.m4">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math> threads.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 4</tag>Pareto curves of recall vs. throughput on the SIFT dataset for a filter fraction of <Math mode="inline" tex="2^{-1}" text="2 ^ (- 1)" xml:id="S6.F4.m5">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> and varying branching factors <Math mode="inline" tex="\beta" text="beta" xml:id="S6.F4.m6">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math> for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.F4.m7">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math>. Up and to the right is better. All trials are run with <Math mode="inline" tex="16" text="16" xml:id="S6.F4.m8">
          <XMath>
            <XMTok meaning="16" role="NUMBER">16</XMTok>
          </XMath>
        </Math> threads.</caption>
    </figure>
    <para class="ltx_noindent" xml:id="S6.p17">
      <p><text font="bold">Varying <Math mode="inline" tex="\beta" text="beta" xml:id="S6.p17.m1">
            <XMath>
              <XMTok font="medium italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>.</text><!--  %“label–sec:varying˙beta˝ -->
A larger branching factor <Math mode="inline" tex="\beta" text="beta" xml:id="S6.p17.m2">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math> decreases the build time and memory footprint of a <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="S6.p17.m3">
          <XMath>
            <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
          </XMath>
        </Math> index by reducing the number of levels in the tree and thus reducing the number of graphs that are built (see <ref labelref="LABEL:fig:branching_buildtime_memory" show="creftype~refnum"/> in <ref labelref="LABEL:sec:experiments-appendix" show="creftype~refnum"/> for a plot showing the exact reduction in memory and build time as we scale <Math mode="inline" tex="\beta" text="beta" xml:id="S6.p17.m4">
          <XMath>
            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
          </XMath>
        </Math>). However, as shown in <ref labelref="LABEL:fig:half_branching_filter_widths" show="creftype~refnum"/>, this comes at the cost of a reduction in recall and latency. These results are substantially the same across different filter fractions; see <ref labelref="LABEL:fig:full_branching_filter_widths" show="creftype~refnum"/> in <ref labelref="LABEL:sec:experiments-appendix" show="creftype~refnum"/> for experiments with more filter fractions.</p>
    </para>
<!--  %“includegraphics[width=“textwidth]–images/sift-128-euclidean˙results.pdf˝ 
     %“includegraphics[width=“textwidth]–images/deep-image-96-angular˙results.pdf˝ 
     %**** paper.tex Line 875 **** 
     %“includegraphics[width=“textwidth]–images/redcaps-512-angular˙results.pdf˝ 
     %“section–Conclusion˝ -->  </section>
  <section inlist="toc" xml:id="S7">
    <tags>
      <tag>7</tag>
      <tag role="autoref">section 7</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">7</tag>
      <tag role="typerefnum">§7</tag>
    </tags>
    <title><tag close=" ">7</tag>Conclusion</title>
    <para xml:id="S7.p1">
      <p>We identify window search as an important and overlooked search problem. The methods we present for solving window search give a significant speedup over the state of the art, have strong theoretical guarantees, and are an important step towards ensuring vector databases efficiently support a full range of necessary embedding search operations.</p>
    </para>
<!--  %“subsection–Limitations˝ 
     %“julian–we already discuss this earlier. i think we can remove this subsection˝ 
     %The main limitation of the methods we propose are that they require an increased index size and increased construction time over a naive “algname–Prefiltering˝ or “algname–Postfiltering˝ index. This is an example of the common memory-performance tradeoff; because the memory and construction time increases are only roughly a constant amount larger than a single index, we still expect our method to be useful. -->  </section>
  <section xml:id="Sx1">
    <title>Impact Statement</title>
    <para xml:id="Sx1.p1">
      <p>We expect the primary broader impact of our work to be general improvement of semantic vector search. Thus, we do not expect our work to have societal consequences beyond generally improving the accuracy and performance of machine learning systems. These systems have many potential societal consequences, none of which we feel must be specifically highlighted here.</p>
    </para>
  </section>
  <section xml:id="Sx2">
    <title>Acknowledgements</title>
    <para xml:id="Sx2.p1">
      <p>This research is supported by
DOE Early Career Award #DE-SC0018947,
NSF CAREER Award #CCF-1845763, NSF Award #CCF-2316235, NSF Award #CNS-2317194,
Google Faculty Research Award, Google Research Scholar Award, and
FinTech@CSAIL Initiative.</p>
    </para>
  </section>
  <bibliography citestyle="authoryear" files="paper" xml:id="bib">
    <title>References</title>
  </bibliography>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %APPENDIX 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %APPENDIX 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->  <pagination role="newpage"/>
  <appendix inlist="toc" labels="LABEL:sec:proofs" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Proofs</title>
    <toctitle><tag close=" ">A</tag>Proofs</toctitle>
    <para xml:id="A1.p1">
      <p>See <ref labelref="LABEL:restatable:existingannmemory"/></p>
    </para>
    <proof>
      <title class="ltx_runin" font="italic">Proof.</title>
      <para xml:id="A1.p2">
        <p><!--  %**** paper.tex Line 925 **** -->As stated in the main text, if we have some function parameterized by the dataset and subset size <Math mode="inline" tex="O(A_{f}(D,m))" text="O * A _ f * open-interval@(D, m)" xml:id="A1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.p2.m1.3"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.p2.m1.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">A</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.p2.m1.1"/>
                          <XMRef idref="A1.p2.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.p2.m1.1">D</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.p2.m1.2">m</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, then this function evaluated on all nodes of <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> is</p>
      </para>
      <para xml:id="A1.p3">
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx1">
          <equation labels="LABEL:eqn:helpful" xml:id="A1.E1">
            <tags>
              <tag>(1)</tag>
              <tag role="autoref">Equation 1</tag>
              <tag role="creftype">Equation</tag>
              <tag role="creftypecap">Equation</tag>
              <tag role="creftypeplural">Equations</tag>
              <tag role="creftypepluralcap">Equations</tag>
              <tag role="refnum">1</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle O\left(\sum_{j=0}^{\log_{\beta}N}\beta^{j}A_{f}(D,N\cdot\beta^{-%&#10;j})\right)." text="O * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ j * A _ f * open-interval@(D, N cdot beta ^ (- j)))" xml:id="A1.E1.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="A1.E1.m2.2"/>
                    <XMWrap>
                      <XMApp xml:id="A1.E1.m2.2">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.E1.m2.2.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.E1.m2.2.1">
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.E1.m2.1"/>
                                    <XMRef idref="A1.E1.m2.2.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E1.m2.1">D</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E1.m2.2.1.1">
                                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle O\left(\sum_{j=0}^{\log_{\beta}N}\beta^{j}A_{f}(D,N\cdot\beta^{-%&#10;j})\right)." text="O * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ j * A _ f * open-interval@(D, N cdot beta ^ (- j)))" xml:id="A1.E1.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="A1.E1.m1.2"/>
                        <XMWrap>
                          <XMApp xml:id="A1.E1.m1.2">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.E1.m1.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.E1.m1.2.1">
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.E1.m1.1"/>
                                        <XMRef idref="A1.E1.m1.2.1.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E1.m1.1">D</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E1.m1.2.1.1">
                                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                            <XMApp>
                                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="A1.p4">
        <p>If <Math mode="inline" tex="A_{f}" text="A _ f" xml:id="A1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
              </XMApp>
            </XMath>
          </Math> is of the form <Math mode="inline" tex="Cm^{\rho}" text="C * m ^ rho" xml:id="A1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> for <Math mode="inline" tex="\rho\geq 1" text="rho &gt;= 1" xml:id="A1.p4.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> and for some constant <Math mode="inline" tex="C" text="C" xml:id="A1.p4.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">C</XMTok>
            </XMath>
          </Math> depending on <Math mode="inline" tex="D" text="D" xml:id="A1.p4.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>, then this is equivalent to:</p>
        <equationgroup class="ltx_eqn_align" xml:id="A4.EGx2">
          <equation xml:id="A1.Ex10">
            <MathFork>
              <Math tex="\displaystyle=O\left(CN^{\rho}\sum_{j=0}^{\log_{\beta}N}\beta^{j-j\rho}\right)" text="absent = O * C * N ^ rho * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ (j - j * rho))" xml:id="A1.Ex10.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="A1.Ex10.m2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A1.Ex10.m2.1">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">C</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="left"><Math mode="inline" tex="\displaystyle=O\left(CN^{\rho}\sum_{j=0}^{\log_{\beta}N}\beta^{j-j\rho}\right)" text="absent = O * C * N ^ rho * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ (j - j * rho))" xml:id="A1.Ex10.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">O</XMTok>
                          <XMDual>
                            <XMRef idref="A1.Ex10.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="A1.Ex10.m1.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A1.Ex11">
            <MathFork>
              <Math tex="\displaystyle=O\left(CN^{\rho}\sum_{j=0}^{\log_{\beta}N}(\beta^{1-\rho})^{j}\right)" text="absent = O * C * N ^ rho * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ (1 - rho) ^ j)" xml:id="A1.Ex11.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="A1.Ex11.m2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A1.Ex11.m2.1">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">C</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMApp>
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMDual>
                                  <XMRef idref="A1.Ex11.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex11.m2.1.1">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="left"><Math mode="inline" tex="\displaystyle=O\left(CN^{\rho}\sum_{j=0}^{\log_{\beta}N}(\beta^{1-\rho})^{j}\right)" text="absent = O * C * N ^ rho * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(beta ^ (1 - rho) ^ j)" xml:id="A1.Ex11.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">O</XMTok>
                          <XMDual>
                            <XMRef idref="A1.Ex11.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="A1.Ex11.m1.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMDual>
                                      <XMRef idref="A1.Ex11.m1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex11.m1.1.1">
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A1.Ex12">
            <MathFork>
              <Math tex="\displaystyle=\begin{cases}O(CN^{\rho}\log_{\beta}N)&amp;\text{if $\rho=1$}\\&#10;O\left(CN^{\rho}\frac{1-N^{1-\rho}}{1-\beta^{1-\rho}}\right)=O((\frac{1}{1-%&#10;\beta^{1-\rho}})CN^{\rho})&amp;\text{if $\rho&gt;1$}\end{cases}" text="absent = cases@(O * C * N ^ rho * (logarithm _ beta)@(N), [if =ρ1], O * C * N ^ rho * ((1 - N ^ (1 - rho)) / (1 - beta ^ (1 - rho))) = O * (1 / (1 - beta ^ (1 - rho))) * C * N ^ rho, [if &gt;ρ1])" xml:id="A1.Ex12.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="cases"/>
                        <XMRef idref="A1.Ex12.m1.1.mf"/>
                        <XMRef idref="A1.Ex12.m1.2.mf"/>
                        <XMRef idref="A1.Ex12.m1.3.mf"/>
                        <XMRef idref="A1.Ex12.m1.4.mf"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="true">{</XMTok>
                        <XMArray>
                          <XMRow>
                            <XMCell align="left">
                              <XMApp xml:id="A1.Ex12.m1.1.mf">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                <XMDual>
                                  <XMRef idref="A1.Ex12.m1.1.mf.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.Ex12.m1.1.mf.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMCell>
                            <XMCell align="left">
                              <XMText xml:id="A1.Ex12.m1.2.mf">if <Math mode="inline" tex="\rho=1" text="rho = 1" xml:id="A1.Ex12.m1.m1.mf">
                                  <XMath>
                                    <XMApp>
                                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math></XMText>
                            </XMCell>
                          </XMRow>
                          <XMRow>
                            <XMCell align="left">
                              <XMApp xml:id="A1.Ex12.m1.3.mf">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                  <XMDual>
                                    <XMRef idref="A1.Ex12.m1.3.mf.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                                      <XMApp xml:id="A1.Ex12.m1.3.mf.2">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                <XMTok font="italic" fontsize="50%" name="rho" role="UNKNOWN">ρ</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                <XMTok font="italic" fontsize="50%" name="rho" role="UNKNOWN">ρ</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                  <XMDual>
                                    <XMRef idref="A1.Ex12.m1.3.mf.3"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex12.m1.3.mf.3">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex12.m1.3.mf.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.Ex12.m1.3.mf.1">
                                              <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                    <XMTok font="italic" fontsize="50%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMCell>
                            <XMCell align="left">
                              <XMText xml:id="A1.Ex12.m1.4.mf">if <Math mode="inline" tex="\rho&gt;1" text="rho &gt; 1" xml:id="A1.Ex12.m1.m2.mf">
                                  <XMath>
                                    <XMApp>
                                      <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                      <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMath>
                                </Math></XMText>
                            </XMCell>
                          </XMRow>
                        </XMArray>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="left"><Math mode="inline" tex="\displaystyle=\begin{cases}O(CN^{\rho}\log_{\beta}N)&amp;\text{if $\rho=1$}\\&#10;O\left(CN^{\rho}\frac{1-N^{1-\rho}}{1-\beta^{1-\rho}}\right)=O((\frac{1}{1-%&#10;\beta^{1-\rho}})CN^{\rho})&amp;\text{if $\rho&gt;1$}\end{cases}" text="absent = cases@(O * C * N ^ rho * (logarithm _ beta)@(N), [if =ρ1], O * C * N ^ rho * ((1 - N ^ (1 - rho)) / (1 - beta ^ (1 - rho))) = O * (1 / (1 - beta ^ (1 - rho))) * C * N ^ rho, [if &gt;ρ1])" xml:id="A1.Ex12.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="cases"/>
                            <XMRef idref="A1.Ex12.m1.1"/>
                            <XMRef idref="A1.Ex12.m1.2"/>
                            <XMRef idref="A1.Ex12.m1.3"/>
                            <XMRef idref="A1.Ex12.m1.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">{</XMTok>
                            <XMArray>
                              <XMRow>
                                <XMCell align="left">
                                  <XMApp xml:id="A1.Ex12.m1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.Ex12.m1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex12.m1.1.1">
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMCell>
                                <XMCell align="left">
                                  <XMText xml:id="A1.Ex12.m1.2">if <Math mode="inline" tex="\rho=1" text="rho = 1" xml:id="A1.Ex12.m1.m1">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math></XMText>
                                </XMCell>
                              </XMRow>
                              <XMRow>
                                <XMCell align="left">
                                  <XMApp xml:id="A1.Ex12.m1.3">
                                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                      <XMDual>
                                        <XMRef idref="A1.Ex12.m1.3.2"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                                          <XMApp xml:id="A1.Ex12.m1.3.2">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                    <XMTok font="italic" fontsize="50%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                    <XMTok font="italic" fontsize="50%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                  </XMApp>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                      <XMDual>
                                        <XMRef idref="A1.Ex12.m1.3.3"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.Ex12.m1.3.3">
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMDual>
                                              <XMRef idref="A1.Ex12.m1.3.1"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A1.Ex12.m1.3.1">
                                                  <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                  <XMApp>
                                                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                                      <XMApp>
                                                        <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                                        <XMTok font="italic" fontsize="50%" name="rho" role="UNKNOWN">ρ</XMTok>
                                                      </XMApp>
                                                    </XMApp>
                                                  </XMApp>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                            <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMCell>
                                <XMCell align="left">
                                  <XMText xml:id="A1.Ex12.m1.4">if <Math mode="inline" tex="\rho&gt;1" text="rho &gt; 1" xml:id="A1.Ex12.m1.m2">
                                      <XMath>
                                        <XMApp>
                                          <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                                          <XMTok font="italic" name="rho" role="UNKNOWN">ρ</XMTok>
                                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMath>
                                    </Math></XMText>
                                </XMCell>
                              </XMRow>
                            </XMArray>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
      </para>
      <para xml:id="A1.p5">
        <p>Determining the memory of the index returned by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> is equivalent to determining the memory of all nodes built on Line <ref labelref="LABEL:alg:build_tree:line:get_index"/> throughout the recursion. Similarly, as long as these calls take longer than constant time, they are the computational bottleneck of the recursion. Thus, we can plug the Vamana build time and memory from <cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> into these results to get the build time and memory of a Vamana WST.</p>
      </para>
      <para xml:id="A1.p6">
        <p>The slow preprocessing version of Vamana takes <Math mode="inline" tex="O(N^{3})" text="O * N ^ 3" xml:id="A1.p6.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.p6.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.p6.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> for construction time and takes up <Math mode="inline" tex="O(N(4\alpha)^{\delta}\log\Delta)" text="O * N * (4 * alpha) ^ delta * logarithm@(Delta)" xml:id="A1.p6.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.p6.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.p6.m2.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMRef idref="A1.p6.m2.1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.p6.m2.1.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="4" role="NUMBER">4</XMTok>
                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> space, so plugging into these results we have that a <Math mode="inline" tex="\beta" text="beta" xml:id="A1.p6.m3">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST tree with a slow preprocessing Vamana implementation takes <Math mode="inline" tex="O(\frac{1}{1-\beta^{-2}}N^{3})=O(N^{3})" text="O * (1 / (1 - beta ^ (- 2))) * N ^ 3 = O * N ^ 3" xml:id="A1.p6.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                  <XMDual>
                    <XMRef idref="A1.p6.m4.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.p6.m4.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                              <XMApp>
                                <XMTok fontsize="50%" meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                  <XMDual>
                    <XMRef idref="A1.p6.m4.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.p6.m4.2">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> time to build and has memory size <Math mode="inline" tex="O((4\alpha)^{\delta}\log(\Delta)N\log_{\beta}N)" text="O * (4 * alpha) ^ delta * logarithm@(Delta) * N * (logarithm _ beta)@(N)" xml:id="A1.p6.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.p6.m5.3"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.p6.m5.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMRef idref="A1.p6.m5.3.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.p6.m5.3.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="4" role="NUMBER">4</XMTok>
                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="A1.p6.m5.1"/>
                          <XMRef idref="A1.p6.m5.2"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="A1.p6.m5.1">log</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok name="Delta" role="UNKNOWN" xml:id="A1.p6.m5.2">Δ</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
∎</p>
      </para>
    </proof>
    <para xml:id="A1.p7">
      <p>See <ref labelref="LABEL:restatable:runtime"/><!--  %**** paper.tex Line 950 **** --></p>
    </para>
    <proof>
      <title class="ltx_runin" font="italic">Proof.</title>
      <para xml:id="A1.p8">
        <p>First, we will show that <ref labelref="LABEL:alg:query" show="creftype~refnum"/> solves the <Math mode="inline" tex="c" text="c" xml:id="A1.p8.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window search problem. Then, we will show that it solves it in the given running time.</p>
      </para>
    </proof>
    <subsubsection xml:id="A1.SS0.SSSx1">
      <title><ref labelref="LABEL:alg:query" show="creftype~refnum"/> solves the <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">c</XMTok>
          </XMath>
        </Math>-approximate window search problem</title>
      <para xml:id="A1.SS0.SSSx1.p1">
        <p>First, we establish correctness and completeness of the evaluated points, i.e., that every point returned has a valid label, and that all points that meet the valid label are ”evaluated” on either Line <ref labelref="LABEL:alg:query:line:argmin1"/> or Line <ref labelref="LABEL:alg:query:line:ann"/>.</p>
      </para>
      <para xml:id="A1.SS0.SSSx1.p2">
        <p>For correctness, note that if a point is returned on Line <ref labelref="LABEL:alg:query:line:argmin1"/>, by <ref labelref="LABEL:def:filtered_dataset" show="creftype~refnum"/> it has a label value in <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx1.p2.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx1.p2.m1.1"/>
                  <XMRef idref="A1.SS0.SSSx1.p2.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m1.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m1.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Similarly, since a point returned on Line <ref labelref="LABEL:alg:query:line:ann"/> is in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> and by the if statement we know that all points in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx1.p2.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> have a label in <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx1.p2.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx1.p2.m4.1"/>
                  <XMRef idref="A1.SS0.SSSx1.p2.m4.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m4.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m4.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, a point returned on Line <ref labelref="LABEL:alg:query:line:ann"/> has a label value in <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx1.p2.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx1.p2.m5.1"/>
                  <XMRef idref="A1.SS0.SSSx1.p2.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m5.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m5.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Any point returned by Line <ref labelref="LABEL:alg:query:return"/> is an <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="A1.SS0.SSSx1.p2.m6">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> over points returned in one of these two cases, so we are guaranteed that the overall point <Math mode="inline" tex="y" text="y" xml:id="A1.SS0.SSSx1.p2.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math> returned has <Math mode="inline" tex="\ell(y)\in(a,b)" text="ell * y element-of open-interval@(a, b)" xml:id="A1.SS0.SSSx1.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok name="ell" role="UNKNOWN">ℓ</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx1.p2.m8.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m8.1">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx1.p2.m8.2"/>
                    <XMRef idref="A1.SS0.SSSx1.p2.m8.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m8.2">a</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p2.m8.3">b</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS0.SSSx1.p3">
        <p>For completeness, first consider some call to <ref labelref="LABEL:alg:query" show="creftype~refnum"/> with <Math mode="inline" tex="T=(index,(children,sizes),S)" text="T = vector@(i * n * d * e * x, open-interval@(c * h * i * l * d * r * e * n, s * i * z * e * s), S)" xml:id="A1.SS0.SSSx1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m1.2"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m1.3"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx1.p3.m1.2">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" role="UNKNOWN">n</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMDual xml:id="A1.SS0.SSSx1.p3.m1.3">
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS0.SSSx1.p3.m1.3.1"/>
                        <XMRef idref="A1.SS0.SSSx1.p3.m1.3.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.SS0.SSSx1.p3.m1.3.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          <XMTok font="italic" role="UNKNOWN">l</XMTok>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" role="UNKNOWN">e</XMTok>
                          <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.SS0.SSSx1.p3.m1.3.2">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                          <XMTok font="italic" role="UNKNOWN">z</XMTok>
                          <XMTok font="italic" role="UNKNOWN">e</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m1.1">S</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math><!--  %“julian–$T$ should take 3 arguments, where the second is a pair˝ -->.
By assumption, <Math mode="inline" tex="N" text="N" xml:id="A1.SS0.SSSx1.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> is a power of <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS0.SSSx1.p3.m3">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>, so we will proceed inductively over <Math mode="inline" tex="|S|" text="absolute-value@(S)" xml:id="A1.SS0.SSSx1.p3.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="absolute-value"/>
                  <XMRef idref="A1.SS0.SSSx1.p3.m4.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">|</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m4.1">S</XMTok>
                  <XMTok role="CLOSE" stretchy="false">|</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> equal to powers of <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS0.SSSx1.p3.m5">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>. Let us first consider any <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx1.p3.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> such that <Math mode="inline" tex="|S|=1" text="absolute-value@(S) = 1" xml:id="A1.SS0.SSSx1.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m7.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m7.1">S</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>. If <Math mode="inline" tex="x\in S_{(a,b)}" text="x element-of S _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx1.p3.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p3.m8.1"/>
                      <XMRef idref="A1.SS0.SSSx1.p3.m8.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m8.1">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m8.2">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, then it will be evaluated on Line <ref labelref="LABEL:alg:query:line:argmin1"/>. Now we assume that for <Math mode="inline" tex="|S|=\beta^{n}" text="absolute-value@(S) = beta ^ n" xml:id="A1.SS0.SSSx1.p3.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m9.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m9.1">S</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, if <Math mode="inline" tex="x\in S" text="x element-of S" xml:id="A1.SS0.SSSx1.p3.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMApp>
            </XMath>
          </Math>, then a call to <Math mode="inline" tex="Query" text="Q * u * e * r * y" xml:id="A1.SS0.SSSx1.p3.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
              </XMApp>
            </XMath>
          </Math> with the tree corresponding to <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx1.p3.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> will evaluate <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx1.p3.m13">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math>. For all sets <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx1.p3.m14">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> of size <Math mode="inline" tex="\beta^{n+1}" text="beta ^ (n + 1)" xml:id="A1.SS0.SSSx1.p3.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> that contain some <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx1.p3.m16">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math>, if Line <ref labelref="LABEL:alg:query:line:argmin1"/> or Line <ref labelref="LABEL:alg:query:line:ann"/> is executed, then we evaluate <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx1.p3.m17">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math>. Otherwise, by construction (Line <ref labelref="LABEL:alg:build_tree:line:build_tree_recursive"/> in <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/>) the children subsets <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx1.p3.m18">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> completely partition <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx1.p3.m19">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math>, so <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx1.p3.m20">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> is in some <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx1.p3.m21">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> with <Math mode="inline" tex="|S_{i}|=\beta^{n}" text="absolute-value@(S _ i) = beta ^ n" xml:id="A1.SS0.SSSx1.p3.m22">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m22.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx1.p3.m22.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">S</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">n</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, and so by our inductive hypothesis <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx1.p3.m23">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
            </XMath>
          </Math> will be evaluated when we call query on <Math mode="inline" tex="children[i]" text="c * h * i * l * d * r * e * n * delimited-[]@(i)" xml:id="A1.SS0.SSSx1.p3.m24">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMTok font="italic" role="UNKNOWN">i</XMTok>
                <XMTok font="italic" role="UNKNOWN">l</XMTok>
                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">n</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="A1.SS0.SSSx1.p3.m24.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p3.m24.1">i</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS0.SSSx1.p4">
        <p>We now show that a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p4.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window-filtered nearest neighbor is returned for some (possible recursive) call to <Math mode="inline" tex="Query" text="Q * u * e * r * y" xml:id="A1.SS0.SSSx1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
              </XMApp>
            </XMath>
          </Math>. Because of our correctness guarantee, at some point <Math mode="inline" tex="q^{*}" text="q ^ *" xml:id="A1.SS0.SSSx1.p4.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> will be evaluated on Line <ref labelref="LABEL:alg:query:line:argmin1"/> or Line <ref labelref="LABEL:alg:query:line:ann"/>. If <Math mode="inline" tex="q^{*}" text="q ^ *" xml:id="A1.SS0.SSSx1.p4.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> is evaluated on Line <ref labelref="LABEL:alg:query:line:argmin1"/>, then because <Math mode="inline" tex="q^{*}" text="q ^ *" xml:id="A1.SS0.SSSx1.p4.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> is the closest point to <Math mode="inline" tex="q" text="q" xml:id="A1.SS0.SSSx1.p4.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> in all of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx1.p4.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx1.p4.m7.1"/>
                    <XMRef idref="A1.SS0.SSSx1.p4.m7.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m7.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m7.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, it will also be the closest point to <Math mode="inline" tex="q" text="q" xml:id="A1.SS0.SSSx1.p4.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> in <Math mode="inline" tex="S_{(a,b)}\subset D_{(a,b)}" text="S _ (open-interval@(a, b)) subset-of D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx1.p4.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m9.1"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m9.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m9.1">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m9.2">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m9.3"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m9.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m9.3">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m9.4">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, so it will get returned by the <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="A1.SS0.SSSx1.p4.m10">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> (and <Math mode="inline" tex="q^{*}" text="q ^ *" xml:id="A1.SS0.SSSx1.p4.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> is trivially a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p4.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor). If <Math mode="inline" tex="q^{*}" text="q ^ *" xml:id="A1.SS0.SSSx1.p4.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> is evaluated on Line <ref labelref="LABEL:alg:query:line:ann"/>, then by the guarantee of the <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p4.m14">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-ANN algorithm <Math mode="inline" tex="A" text="A" xml:id="A1.SS0.SSSx1.p4.m15">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">A</XMTok>
            </XMath>
          </Math>, some point <Math mode="inline" tex="y" text="y" xml:id="A1.SS0.SSSx1.p4.m16">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math> will be returned that is a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p4.m17">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-ANN to <Math mode="inline" tex="q" text="q" xml:id="A1.SS0.SSSx1.p4.m18">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math> on <Math mode="inline" tex="S_{(a,b)}" text="S _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx1.p4.m19">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx1.p4.m19.1"/>
                    <XMRef idref="A1.SS0.SSSx1.p4.m19.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m19.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m19.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. Because <Math mode="inline" tex="q^{*}" text="q ^ *" xml:id="A1.SS0.SSSx1.p4.m20">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
              </XMApp>
            </XMath>
          </Math> is also in <Math mode="inline" tex="S_{(a,b)}" text="S _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx1.p4.m21">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx1.p4.m21.1"/>
                    <XMRef idref="A1.SS0.SSSx1.p4.m21.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m21.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m21.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, this implies that <Math mode="inline" tex="\texttt{dist}_{V}(q,y)\leq c\cdot\texttt{dist}_{V}(q,q^{*})" text="[dist] _ V * open-interval@(q, y) &lt;= (c cdot [dist] _ V) * open-interval@(q, q ^ *)" xml:id="A1.SS0.SSSx1.p4.m22">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter">dist</text></XMText>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m22.1"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m22.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m22.1">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m22.2">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMText><text font="typewriter">dist</text></XMText>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m22.3"/>
                      <XMRef idref="A1.SS0.SSSx1.p4.m22.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p4.m22.3">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx1.p4.m22.4">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, so <Math mode="inline" tex="y" text="y" xml:id="A1.SS0.SSSx1.p4.m23">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math> is also a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p4.m24">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor.</p>
      </para>
      <para xml:id="A1.SS0.SSSx1.p5">
        <p>Finally, we show that if any instance of a call to <Math mode="inline" tex="Query" text="Q * u * e * r * y" xml:id="A1.SS0.SSSx1.p5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
              </XMApp>
            </XMath>
          </Math> finds a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p5.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor, then the overall algorithm will return a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p5.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor. Consider the case that a valid <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p5.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor <Math mode="inline" tex="y" text="y" xml:id="A1.SS0.SSSx1.p5.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
            </XMath>
          </Math> is returned by Line <ref labelref="LABEL:alg:query:line:argmin1"/> or Line <ref labelref="LABEL:alg:query:line:ann"/>. If this is not a top-level call to <Math mode="inline" tex="Query" text="Q * u * e * r * y" xml:id="A1.SS0.SSSx1.p5.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
              </XMApp>
            </XMath>
          </Math>, then <Math mode="inline" tex="Query" text="Q * u * e * r * y" xml:id="A1.SS0.SSSx1.p5.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
              </XMApp>
            </XMath>
          </Math> was called on Line <ref labelref="LABEL:alg:query:line:recurse"/>, so the point <Math mode="inline" tex="y^{\prime}" text="y ^ prime" xml:id="A1.SS0.SSSx1.p5.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> that gets returned will also be evaluated in the <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="A1.SS0.SSSx1.p5.m9">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> on Line <ref labelref="LABEL:alg:query:return"/>, and a point <Math mode="inline" tex="y^{\prime}" text="y ^ prime" xml:id="A1.SS0.SSSx1.p5.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> will be returned from Line <ref labelref="LABEL:alg:query:return"/> that is in <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx1.p5.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx1.p5.m11.1"/>
                    <XMRef idref="A1.SS0.SSSx1.p5.m11.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p5.m11.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p5.m11.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> (by our correctness result) and has <Math mode="inline" tex="d(q,y^{\prime})\leq d(q,y)\leq c\cdot d(q,q^{*})" text="d * open-interval@(q, y ^ prime) &lt;= d * open-interval@(q, y) &lt;= (c cdot d) * open-interval@(q, q ^ *)" xml:id="A1.SS0.SSSx1.p5.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p5.m12.1"/>
                      <XMRef idref="A1.SS0.SSSx1.p5.m12.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p5.m12.1">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx1.p5.m12.5">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">y</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p5.m12.2"/>
                      <XMRef idref="A1.SS0.SSSx1.p5.m12.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p5.m12.2">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p5.m12.3">y</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                    <XMTok font="italic" role="UNKNOWN">c</XMTok>
                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx1.p5.m12.4"/>
                      <XMRef idref="A1.SS0.SSSx1.p5.m12.6"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx1.p5.m12.4">q</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx1.p5.m12.6">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                        <XMTok fontsize="70%" meaning="times" role="MULOP">∗</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Thus by transitivity, <Math mode="inline" tex="y^{\prime}" text="y ^ prime" xml:id="A1.SS0.SSSx1.p5.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> is also a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p5.m14">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor for <Math mode="inline" tex="q" text="q" xml:id="A1.SS0.SSSx1.p5.m15">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math>, and inductively the point <Math mode="inline" tex="y^{\prime\prime}" text="y ^ prime2" xml:id="A1.SS0.SSSx1.p5.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                <XMTok fontsize="70%" name="prime2" role="SUPOP">′′</XMTok>
              </XMApp>
            </XMath>
          </Math> that gets returned by the original top-level <Math mode="inline" tex="Query" text="Q * u * e * r * y" xml:id="A1.SS0.SSSx1.p5.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                <XMTok font="italic" role="UNKNOWN">e</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">y</XMTok>
              </XMApp>
            </XMath>
          </Math> call will be a <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx1.p5.m18">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">c</XMTok>
            </XMath>
          </Math>-approximate window filtered nearest neighbor.</p>
      </para>
    </subsubsection>
    <subsubsection xml:id="A1.SS0.SSSx2">
      <title>Algorithm <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.m1">
          <XMath>
            <XMTok meaning="2" role="NUMBER">2</XMTok>
          </XMath>
        </Math> running time</title>
      <para xml:id="A1.SS0.SSSx2.p1">
        <p>We will examine each level of the tree built by <ref labelref="LABEL:alg:build_tree" show="creftype~refnum"/> as <ref labelref="LABEL:alg:query" show="creftype~refnum"/> traverses it, i.e., the nodes with <Math mode="inline" tex="|S|=N" text="absolute-value@(S) = N" xml:id="A1.SS0.SSSx2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A1.SS0.SSSx2.p1.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p1.m1.1">S</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="|S|=N/\beta" text="absolute-value@(S) = N / beta" xml:id="A1.SS0.SSSx2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A1.SS0.SSSx2.p1.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p1.m2.1">S</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="|S|=N/\beta^{2},\ldots,|S|=\beta,|S|=1" text="formulae@(absolute-value@(S) = list@(N / beta ^ 2, ldots), formulae@(absolute-value@(S) = beta, absolute-value@(S) = 1))" xml:id="A1.SS0.SSSx2.p1.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="A1.SS0.SSSx2.p1.m3.5"/>
                  <XMRef idref="A1.SS0.SSSx2.p1.m3.6"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p1.m3.5">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="absolute-value"/>
                        <XMRef idref="A1.SS0.SSSx2.p1.m3.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">|</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p1.m3.1">S</XMTok>
                        <XMTok role="CLOSE" stretchy="false">|</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A1.SS0.SSSx2.p1.m3.5.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p1.m3.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A1.SS0.SSSx2.p1.m3.5.1">
                          <XMTok meaning="divide" role="MULOP">/</XMTok>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p1.m3.4">…</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMDual xml:id="A1.SS0.SSSx2.p1.m3.6">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.SS0.SSSx2.p1.m3.6.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p1.m3.6.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.SS0.SSSx2.p1.m3.6.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="A1.SS0.SSSx2.p1.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p1.m3.2">S</XMTok>
                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p1.m3.6.2">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="A1.SS0.SSSx2.p1.m3.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p1.m3.3">S</XMTok>
                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> (the nodes with <Math mode="inline" tex="|S|=1" text="absolute-value@(S) = 1" xml:id="A1.SS0.SSSx2.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="absolute-value"/>
                    <XMRef idref="A1.SS0.SSSx2.p1.m4.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p1.m4.1">S</XMTok>
                    <XMTok role="CLOSE" stretchy="false">|</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> are just the <Math mode="inline" tex="index=NULL" text="i * n * d * e * x = N * U * L * L" xml:id="A1.SS0.SSSx2.p1.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  <XMTok font="italic" role="UNKNOWN">U</XMTok>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> case).</p>
      </para>
<!--  %At each level $j$, let $–R˙j˝ “subset D$ be the trees that are queried, and let $D˙0 = D$ and $D˙j = D˙–j - 1˝ - “cup –R˙j˝$. First, we note that at maximum two nodes in $–R˙j˝$ will have Query called on them -->      <para xml:id="A1.SS0.SSSx2.p2">
        <p>At a high level, this analysis is similar to <Math mode="inline" tex="B" text="B" xml:id="A1.SS0.SSSx2.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math>-ary segment or Fenwick trees <cite class="ltx_citemacro_citep">(<bibref bibrefs="pibiri2021practical" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which have <Math mode="inline" tex="O(\beta\log_{\beta}N)" text="O * beta * (logarithm _ beta)@(N)" xml:id="A1.SS0.SSSx2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.SS0.SSSx2.p2.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p2.m2.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> query time and query at most <Math mode="inline" tex="O(\beta)" text="O * beta" xml:id="A1.SS0.SSSx2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.SS0.SSSx2.p2.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" name="beta" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p2.m3.1">β</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> indices per level. The overall idea for our analysis is to show that <ref labelref="LABEL:alg:query" show="creftype~refnum"/> will run an ANN search on at most <Math mode="inline" tex="2\beta-2" text="2 * beta - 2" xml:id="A1.SS0.SSSx2.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> indices per level.</p>
      </para>
      <para xml:id="A1.SS0.SSSx2.p3">
        <p>First, we note that our algorithm has a “one time evaluation guarantee”: if we execute an ANN search (Line <ref labelref="LABEL:alg:query:line:ann"/>) or an exact search (Line <ref labelref="LABEL:alg:query:line:argmin1"/>) on some subset <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math>, then we did not execute an ANN search or exact search on any parent of <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> (since then we never would have reached it recursively), so every point in <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> (and therefore every point in <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p3.m4.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p3.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p3.m4.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p3.m4.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>) is evaluated just once.</p>
      </para>
<!--  %“julian–we should explain what the subscripts of the $S$’s mean˝ “julian–it’s not clear how these subsets are formed˝ 
     %“julian–I thought we assumed that all $S˙i$’s we consider here are a subset of $D˙–(a,b)˝$˝ “julian–we should elaborate on why this corresponds to $last - first + 1 ¿ 2“beta - 2$˝  “julian–it would be clearer to put the inductive claims in a list and reference each one when you are proving it˝  “julian–why fewer than 2?˝“josh–@Julian I combined all of your comments up here and have tried to go through and address everything, let me know if anything is still unclear. Part of the problem may be that I have a clear way in my head for how to prove this (basically show that you keep ”covering the middle” of the range, and then at each level you cover most of what is left on the left and right), but I don’t quite have the infrastructure in the analysis to make it clear that this is what I’m doing.˝ -->      <para xml:id="A1.SS0.SSSx2.p4">
        <p>Now consider the largest <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p4.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math> such that there exists some set <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p4.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> in the tree of size <Math mode="inline" tex="\beta^{j}" text="beta ^ j" xml:id="A1.SS0.SSSx2.p4.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> such that <Math mode="inline" tex="S\subset D_{(a,b)}" text="S subset-of D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p4.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx2.p4.m4.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p4.m4.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p4.m4.1">a</XMTok>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p4.m4.2">b</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. In other words, <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p4.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
            </XMath>
          </Math> is the largest set that we built an index for and that entirely consists of points within the filtered dataset corresponding to the query. There may be multiple sets of size <Math mode="inline" tex="\beta^{j}" text="beta ^ j" xml:id="A1.SS0.SSSx2.p4.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> within <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p4.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p4.m7.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p4.m7.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p4.m7.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p4.m7.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
<!--  %(we note briefly that $j$ is at least $j = “lceil“log˙“beta(N / —D˙–(a, b)˝—)“rceil + 1$) -->      <para xml:id="A1.SS0.SSSx2.p5">
        <p>Let all sets of size <Math mode="inline" tex="\beta^{j}" text="beta ^ j" xml:id="A1.SS0.SSSx2.p5.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> be ordered such that each set’s labels are strictly less than the next set, and let these sets be indexed by <Math mode="inline" tex="\{S_{i}\}" text="set@(S _ i)" xml:id="A1.SS0.SSSx2.p5.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="A1.SS0.SSSx2.p5.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p5.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Let <Math mode="inline" tex="S_{first}" text="S _ (f * i * r * s * t)" xml:id="A1.SS0.SSSx2.p5.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> be the first set in this ordering that is a subset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p5.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p5.m4.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p5.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p5.m4.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p5.m4.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="S_{last}" text="S _ (l * a * s * t)" xml:id="A1.SS0.SSSx2.p5.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> be the last set in this ordering that is a subset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p5.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p5.m6.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p5.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p5.m6.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p5.m6.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS0.SSSx2.p6">
        <p>By completeness, every point in <Math mode="inline" tex="S_{first},\ldots,S_{last}" text="list@(S _ (f * i * r * s * t), ldots, S _ (l * a * s * t))" xml:id="A1.SS0.SSSx2.p6.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m1.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m1.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m1.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p6.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p6.m1.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p6.m1.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is evaluated at some level, so the recursive traversal must go through <Math mode="inline" tex="S_{first},\ldots,S_{last}" text="list@(S _ (f * i * r * s * t), ldots, S _ (l * a * s * t))" xml:id="A1.SS0.SSSx2.p6.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m2.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m2.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m2.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p6.m2.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p6.m2.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p6.m2.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, and since each of these sets is a subset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p6.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p6.m3.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p6.m3.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p6.m3.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p6.m3.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, we will run the ANN search on Line <ref labelref="LABEL:alg:query:line:ann"/> on each of <Math mode="inline" tex="S_{first},\ldots,S_{last}" text="list@(S _ (f * i * r * s * t), ldots, S _ (l * a * s * t))" xml:id="A1.SS0.SSSx2.p6.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m4.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m4.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p6.m4.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p6.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p6.m4.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p6.m4.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS0.SSSx2.p7">
        <p>By construction, every <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS0.SSSx2.p7.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> sets in <Math mode="inline" tex="\{S_{i}\}" text="set@(S _ i)" xml:id="A1.SS0.SSSx2.p7.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> are partitions of a set from level <Math mode="inline" tex="j+1" text="j + 1" xml:id="A1.SS0.SSSx2.p7.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> (e.g., sets <Math mode="inline" tex="\{S_{1},\ldots,S_{\beta}\}" text="set@(S _ 1, ldots, S _ beta)" xml:id="A1.SS0.SSSx2.p7.m4">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m4.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m4.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m4.3"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m4.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p7.m4.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m4.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, <Math mode="inline" tex="\{S_{\beta+1},\ldots,S_{2\beta}\},\ldots" text="list@(set@(S _ (beta + 1), ldots, S _ (2 * beta)), ldots)" xml:id="A1.SS0.SSSx2.p7.m5">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m5.3"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m5.2"/>
                </XMApp>
                <XMWrap>
                  <XMDual xml:id="A1.SS0.SSSx2.p7.m5.3">
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="A1.SS0.SSSx2.p7.m5.3.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p7.m5.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p7.m5.3.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p7.m5.3.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">S</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p7.m5.1">…</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p7.m5.3.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">S</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p7.m5.2">…</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>). Thus, any subsequence of <Math mode="inline" tex="\{S_{i}\}" text="set@(S _ i)" xml:id="A1.SS0.SSSx2.p7.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m6.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m6.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> that is of length <Math mode="inline" tex="\geq 2\beta-1" text="absent &gt;= 2 * beta - 1" xml:id="A1.SS0.SSSx2.p7.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  </XMApp>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> must have at least one complete partition of a set from level <Math mode="inline" tex="j+1" text="j + 1" xml:id="A1.SS0.SSSx2.p7.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>. Since all of <Math mode="inline" tex="S_{first},\ldots,S_{last}" text="list@(S _ (f * i * r * s * t), ldots, S _ (l * a * s * t))" xml:id="A1.SS0.SSSx2.p7.m9">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m9.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m9.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m9.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m9.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p7.m9.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m9.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> are subsets of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p7.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p7.m10.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p7.m10.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p7.m10.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p7.m10.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, by the one time evaluation guarantee, we know that their parents cannot be subsets of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p7.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p7.m11.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p7.m11.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p7.m11.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p7.m11.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> (since then in the recursive traversal, we would have run an ANN search on their parent). Thus, <Math mode="inline" tex="S_{first},\ldots,S_{last}" text="list@(S _ (f * i * r * s * t), ldots, S _ (l * a * s * t))" xml:id="A1.SS0.SSSx2.p7.m12">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m12.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m12.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m12.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m12.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p7.m12.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m12.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> cannot contain a complete partition of a set from level <Math mode="inline" tex="j+1" text="j + 1" xml:id="A1.SS0.SSSx2.p7.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, so the list <Math mode="inline" tex="S_{first},\ldots,S_{last}" text="list@(S _ (f * i * r * s * t), ldots, S _ (l * a * s * t))" xml:id="A1.SS0.SSSx2.p7.m14">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m14.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m14.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p7.m14.3"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m14.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p7.m14.1">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="A1.SS0.SSSx2.p7.m14.3">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> contains fewer than <Math mode="inline" tex="2\beta-1" text="2 * beta - 1" xml:id="A1.SS0.SSSx2.p7.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> sets, or equivalently <Math mode="inline" tex="last-first+1\leq 2\beta-2" text="(l * a * s * t - f * i * r * s * t) + 1 &lt;= 2 * beta - 2" xml:id="A1.SS0.SSSx2.p7.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  </XMApp>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
<!--  %Consider the sets $S˙–first˝, “ldots, S˙–last˝$. By the one time evaluation guarantee, we know that we did not execute an ANN search in any of their parents, so the sets corresponding to their parents were not subsets of $D˙–(a, b)˝$. Thus, each set in $S˙–first˝, “ldots, S˙–last˝$ must have a sibling node that is not a subset of $D˙–(a, b)˝$, and this sibling node must be within $“beta$ sets in the ordering of $S˙i$ (since all of a node’s children are in order of label value). “julian–why do we know there are at least $“beta$ $S˙i$’s? I think there are fewer than $“beta$ $S˙i$’s.˝ 
     %Thus, in the case where there are as many sets $S˙–first˝, “ldots, S˙–last˝$ as possible “julian–which is $“beta-1$?˝, the set $S˙–first + “beta - 2˝$ “julian–this indexing is confusing.˝ can have a sibling at $S˙–first - 1˝$ that is not a subset of $D˙–(a, b)˝$, and similarly the set $S˙–last - “beta + 2˝$ can have a sibling at $S˙–last + 1˝$ that is not a subset of $D˙–(a, b)˝$. There can be no sets in between these two because such a set would be too far away from a possible sibling that was not a subset of $D˙–(a, b)˝$, so if we are maximizing $last - first$ we have that $(first + “beta - 2) + 1 = last - “beta + 2$, which implies $last - first + 1 = 2“beta - 2$. Since this represents the maximum $last - first$ can be, we have that $last - first + 1 “le 2“beta - 2$. 
     %The structure of the tree is that the sets corresponding to a nodes children are a partition of its own set into $“beta$ partitions in order of label values. -->      <para xml:id="A1.SS0.SSSx2.p8">
        <p>We also know that at level <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p8.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math>, there are at most two more sets, <Math mode="inline" tex="S_{first-1}" text="S _ (f * i * r * s * t - 1)" xml:id="A1.SS0.SSSx2.p8.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="S_{last+1}" text="S _ (l * a * s * t + 1)" xml:id="A1.SS0.SSSx2.p8.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, that have a non-empty intersection with <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p8.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p8.m4.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p8.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p8.m4.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p8.m4.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> (these are the sets that potentially contain points with labels just larger and just smaller than <Math mode="inline" tex="a" text="a" xml:id="A1.SS0.SSSx2.p8.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> and just larger and just smaller than <Math mode="inline" tex="b" text="b" xml:id="A1.SS0.SSSx2.p8.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">b</XMTok>
            </XMath>
          </Math>).</p>
      </para>
      <para xml:id="A1.SS0.SSSx2.p9">
        <p>This leads to our inductive hypothesis, which has three claims:</p>
        <enumerate xml:id="A1.I1">
          <item xml:id="A1.I1.i1">
            <tags>
              <tag>1.</tag>
              <tag role="autoref">item 1</tag>
              <tag role="creftype">Item</tag>
              <tag role="creftypecap">Item</tag>
              <tag role="creftypeplural">Items</tag>
              <tag role="creftypepluralcap">Items</tag>
              <tag role="refnum">1</tag>
              <tag role="typerefnum">item 1</tag>
            </tags>
            <para xml:id="A1.I1.i1.p1">
              <p>For all levels with <Math mode="inline" tex="j^{\prime}\leq j" text="j ^ prime &lt;= j" xml:id="A1.I1.i1.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                    </XMApp>
                  </XMath>
                </Math> (i.e., with <Math mode="inline" tex="|S|=\beta^{j^{\prime}}" text="absolute-value@(S) = beta ^ j ^ prime" xml:id="A1.I1.i1.p1.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="absolute-value"/>
                          <XMRef idref="A1.I1.i1.p1.m2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.I1.i1.p1.m2.1">S</XMTok>
                          <XMTok role="CLOSE" stretchy="false">|</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>), there can be at most two sets that have a non-empty intersection with <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.I1.i1.p1.m3">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.I1.i1.p1.m3.1"/>
                          <XMRef idref="A1.I1.i1.p1.m3.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.I1.i1.p1.m3.1">a</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.I1.i1.p1.m3.2">b</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math> that are not fully evaluated (i.e., that we recurse into).</p>
            </para>
          </item>
          <item xml:id="A1.I1.i2">
            <tags>
              <tag>2.</tag>
              <tag role="autoref">item 2</tag>
              <tag role="creftype">Item</tag>
              <tag role="creftypecap">Item</tag>
              <tag role="creftypeplural">Items</tag>
              <tag role="creftypepluralcap">Items</tag>
              <tag role="refnum">2</tag>
              <tag role="typerefnum">item 2</tag>
            </tags>
            <para xml:id="A1.I1.i2.p1">
              <p>No set that we recurse into or evaluate on level <Math mode="inline" tex="j^{\prime}\leq j" text="j ^ prime &lt;= j" xml:id="A1.I1.i2.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                    </XMApp>
                  </XMath>
                </Math> is a superset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.I1.i2.p1.m2">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">D</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.I1.i2.p1.m2.1"/>
                          <XMRef idref="A1.I1.i2.p1.m2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.I1.i2.p1.m2.1">a</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.I1.i2.p1.m2.2">b</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math><!--  %“julian–is the sign reversed?˝ -->.</p>
            </para>
          </item>
          <item xml:id="A1.I1.i3">
            <tags>
              <tag>3.</tag>
              <tag role="autoref">item 3</tag>
              <tag role="creftype">Item</tag>
              <tag role="creftypecap">Item</tag>
              <tag role="creftypeplural">Items</tag>
              <tag role="creftypepluralcap">Items</tag>
              <tag role="refnum">3</tag>
              <tag role="typerefnum">item 3</tag>
            </tags>
            <para xml:id="A1.I1.i3.p1">
              <p>We will run the ANN search on Line <ref labelref="LABEL:alg:query:line:ann"/> at most <Math mode="inline" tex="2\beta-2" text="2 * beta - 2" xml:id="A1.I1.i3.p1.m1">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMath>
                </Math> times on each level.</p>
            </para>
          </item>
        </enumerate>
      </para>
      <para xml:id="A1.SS0.SSSx2.p10">
        <p>We have just shown the base case for <Math mode="inline" tex="j^{\prime}=j" text="j ^ prime = j" xml:id="A1.SS0.SSSx2.p10.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math>. Now consider some <Math mode="inline" tex="0\leq j^{\prime}&lt;j" text="0 &lt;= j ^ prime &lt; j" xml:id="A1.SS0.SSSx2.p10.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math>. By part <Math mode="inline" tex="1" text="1" xml:id="A1.SS0.SSSx2.p10.m3">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> of the inductive hypothesis, we recurse into <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p10.m4">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math> or fewer sets on level <Math mode="inline" tex="j^{\prime}+1" text="j ^ prime + 1" xml:id="A1.SS0.SSSx2.p10.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                  <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> that have a nonempty intersection with <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m6.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m6.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m6.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. For each of these sets, at most <Math mode="inline" tex="\beta-1" text="beta - 1" xml:id="A1.SS0.SSSx2.p10.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> of its children will be a subset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m8.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m8.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m8.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> (if all <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS0.SSSx2.p10.m9">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> of its children were a subset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m10.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m10.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m10.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m10.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, then the set itself would have been a subset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m11.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m11.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m11.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m11.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and would have been fully evaluated), and thus at most <Math mode="inline" tex="2(\beta-1)=2\beta-2" text="2 * (beta - 1) = 2 * beta - 2" xml:id="A1.SS0.SSSx2.p10.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx2.p10.m12.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p10.m12.1">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  </XMApp>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> ANN searches are run on level <Math mode="inline" tex="j^{\prime}" text="j ^ prime" xml:id="A1.SS0.SSSx2.p10.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math>. This proves part <Math mode="inline" tex="3" text="3" xml:id="A1.SS0.SSSx2.p10.m14">
            <XMath>
              <XMTok meaning="3" role="NUMBER">3</XMTok>
            </XMath>
          </Math> of our inductive claim. Furthermore, since each of the at most two sets that we are recursing into are not a superset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m15.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m15.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m15.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m15.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> by inductive claim <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p10.m16">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math>, there can only be at most one side of each of their label ranges that expand beyond <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx2.p10.m17">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m17.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m17.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m17.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m17.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Thus, when we partition each of these sets, only one child of each of the sets can have a label range that overlaps <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx2.p10.m18">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m18.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m18.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m18.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m18.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>; the rest will either have labels entirely in <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx2.p10.m19">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m19.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m19.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m19.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m19.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> or entirely outside of <Math mode="inline" tex="(a,b)" text="open-interval@(a, b)" xml:id="A1.SS0.SSSx2.p10.m20">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m20.1"/>
                  <XMRef idref="A1.SS0.SSSx2.p10.m20.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m20.1">a</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m20.2">b</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math><!--  %“julian–the previous sentence implies there is at most 1?˝ “josh–I clarified it’s one per parent $S$˝ -->. Thus there will be at most two
sets that have a nonempty intersection with <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m21">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m21.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m21.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m21.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m21.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> that are not fully evaluated, proving inductive claim <Math mode="inline" tex="1" text="1" xml:id="A1.SS0.SSSx2.p10.m22">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>. Finally, because each set that we recurse into on level <Math mode="inline" tex="j^{\prime}" text="j ^ prime" xml:id="A1.SS0.SSSx2.p10.m23">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> is not a superset of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m24">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m24.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m24.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m24.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m24.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, all of the children we recurse into that are subsets of these sets are also not supersets of <Math mode="inline" tex="D_{(a,b)}" text="D _ (open-interval@(a, b))" xml:id="A1.SS0.SSSx2.p10.m25">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m25.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p10.m25.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m25.1">a</XMTok>
                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p10.m25.2">b</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, proving inductive claim <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p10.m26">
            <XMath>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS0.SSSx2.p11">
        <p>We do work in <ref labelref="LABEL:alg:query" show="creftype~refnum"/> on Line <ref labelref="LABEL:alg:query:line:ann"/>, the loop on Line <ref labelref="LABEL:alg:query:line:loop"/>, and Line <ref labelref="LABEL:alg:query:return"/> (we do not do work on Line <ref labelref="LABEL:alg:query:line:argmin1"/> because the <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="A1.SS0.SSSx2.p11.m1">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> is just over one point; the <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="A1.SS0.SSSx2.p11.m2">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> is necessary for the more general case where <Math mode="inline" tex="N" text="N" xml:id="A1.SS0.SSSx2.p11.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> is a not a power of <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p11.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math><!--  %“julian–if the argmin is over one point, why do we do an argmin?˝ --> and the leaf nodes may have more than one point).
As a direct result from the first part of our inductive claim, we have that we will only make it to the loop on Line <ref labelref="LABEL:alg:query:line:loop"/> and the <Math content-tex="\argmin" mode="inline" tex="\operatorname*{arg\,min}" text="argmin" xml:id="A1.SS0.SSSx2.p11.m5">
            <XMath>
              <XMApp name="argmin" role="OPERATOR" scriptpos="post">
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN" rpadding="1.7pt">arg</XMTok>
                <XMTok role="UNKNOWN">min</XMTok>
              </XMApp>
            </XMath>
          </Math> on Line <ref labelref="LABEL:alg:query:return"/> twice for each of the <Math mode="inline" tex="\log_{\beta}(N)" text="(logarithm _ beta)@(N)" xml:id="A1.SS0.SSSx2.p11.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMRef idref="A1.SS0.SSSx2.p11.m6.2"/>
                  <XMRef idref="A1.SS0.SSSx2.p11.m6.1"/>
                </XMApp>
                <XMApp>
                  <XMApp xml:id="A1.SS0.SSSx2.p11.m6.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p11.m6.1">N</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMApp>
              </XMDual>
            </XMath>
          </Math> levels. The time complexity for the loop is <Math mode="inline" tex="O(\beta)" text="O * beta" xml:id="A1.SS0.SSSx2.p11.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.SS0.SSSx2.p11.m7.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" name="beta" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p11.m7.1">β</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, and the time complexity for Line <ref labelref="LABEL:alg:query:return"/> is <Math mode="inline" tex="O(\beta d)" text="O * beta * d" xml:id="A1.SS0.SSSx2.p11.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.SS0.SSSx2.p11.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p11.m8.1">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> because the maximum size for the candidate list is <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS0.SSSx2.p11.m9">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>, and for each candidate in the list we spend <Math mode="inline" tex="O(d)" text="O * d" xml:id="A1.SS0.SSSx2.p11.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                <XMDual>
                  <XMRef idref="A1.SS0.SSSx2.p11.m10.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p11.m10.1">d</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> doing a distance computation. Also, from the third part of our inductive claim, we have that we call ANN search on an index of size <Math mode="inline" tex="m=\beta^{j}" text="m = beta ^ j" xml:id="A1.SS0.SSSx2.p11.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> at most <Math mode="inline" tex="2\beta-2" text="2 * beta - 2" xml:id="A1.SS0.SSSx2.p11.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> times for all <Math mode="inline" tex="j\in{1,\ldots,\log_{\beta}(N)}" text="j element-of list@(1, ldots, (logarithm _ beta)@(N))" xml:id="A1.SS0.SSSx2.p11.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A1.SS0.SSSx2.p11.m13.2"/>
                    <XMRef idref="A1.SS0.SSSx2.p11.m13.3"/>
                    <XMRef idref="A1.SS0.SSSx2.p11.m13.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok meaning="1" role="NUMBER" xml:id="A1.SS0.SSSx2.p11.m13.2">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p11.m13.3">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMDual xml:id="A1.SS0.SSSx2.p11.m13.4">
                      <XMApp>
                        <XMRef idref="A1.SS0.SSSx2.p11.m13.4.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p11.m13.1"/>
                      </XMApp>
                      <XMApp>
                        <XMApp xml:id="A1.SS0.SSSx2.p11.m13.4.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p11.m13.1">N</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. Finally, again from the third part our inductive claim, we evaluate at most <Math mode="inline" tex="2\beta-2" text="2 * beta - 2" xml:id="A1.SS0.SSSx2.p11.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> sets of size <Math mode="inline" tex="1" text="1" xml:id="A1.SS0.SSSx2.p11.m15">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>, so we evaluate Line <ref labelref="LABEL:alg:query:line:argmin1"/> a maximum of <Math mode="inline" tex="2\beta-2" text="2 * beta - 2" xml:id="A1.SS0.SSSx2.p11.m16">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> times. This gives the following total runtime for <ref labelref="LABEL:alg:query" show="creftype~refnum"/>:</p>
        <equation xml:id="A1.Ex13">
          <Math mode="display" tex="O\left(\log_{\beta}(N)*(\beta+\beta d)+(2\beta-2)*\sum_{j=0}^{\log_{\beta}(N)}%&#10;A_{q}(D,N*\beta^{-j})\right)=O\left(\beta\log_{\beta}(N)d+\beta*\sum_{j=0}^{%&#10;\log_{\beta}(N)}A_{q}(D,N*\beta^{-j})\right)." text="O * ((logarithm _ beta)@(N) * (beta + beta * d) + (2 * beta - 2) * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N * beta ^ (- j)))) = O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N * beta ^ (- j))))" xml:id="A1.Ex13.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.Ex13.m1.9"/>
                <XMWrap>
                  <XMApp xml:id="A1.Ex13.m1.9">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="A1.Ex13.m1.9.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A1.Ex13.m1.9.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">∗</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex13.m1.9.1.1"/>
                                  <XMRef idref="A1.Ex13.m1.5"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex13.m1.9.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex13.m1.5">N</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMDual>
                                <XMRef idref="A1.Ex13.m1.9.1.2"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex13.m1.9.1.2">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">∗</XMTok>
                              <XMDual>
                                <XMRef idref="A1.Ex13.m1.9.1.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex13.m1.9.1.3">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A1.Ex13.m1.2"/>
                                      <XMRef idref="A1.Ex13.m1.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp xml:id="A1.Ex13.m1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex13.m1.1">N</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex13.m1.6"/>
                                      <XMRef idref="A1.Ex13.m1.9.1.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex13.m1.6">D</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex13.m1.9.1.4">
                                        <XMTok meaning="times" role="MULOP">∗</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="A1.Ex13.m1.9.2"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A1.Ex13.m1.9.2">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex13.m1.9.2.1"/>
                                  <XMRef idref="A1.Ex13.m1.7"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex13.m1.9.2.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex13.m1.7">N</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">∗</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A1.Ex13.m1.4"/>
                                      <XMRef idref="A1.Ex13.m1.3"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp xml:id="A1.Ex13.m1.4">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.Ex13.m1.3">N</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex13.m1.8"/>
                                      <XMRef idref="A1.Ex13.m1.9.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex13.m1.8">D</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex13.m1.9.2.2">
                                        <XMTok meaning="times" role="MULOP">∗</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>∎</p>
      </para>
      <para xml:id="A1.SS0.SSSx2.p12">
        <p>See <ref labelref="LABEL:restatable:commonfuncclasses"/></p>
      </para>
      <proof>
        <title class="ltx_runin" font="italic"><!--  %First, we note that if we have a term $f(N) + b* g(N)$, and $f(N)$ is $O(g(N))$, then $a + b * f(N)$ is $O(f(N) + b * g(N))$; “julian–are $a$ and $b$ constants here? we should clarify what they are. also we should use different variable names, since we used $a$ and $b$ for something else (I’m also not sure where we used this fact below)˝ “josh–Maybe we can just leave this out entirely then? I used it on e.g. the first line to plug in the runtime for A and drop the big O˝ see~“cite–StackOverflowNestedBigO˝ for a proof of this fact. -->Proof.</title>
        <para xml:id="A1.SS0.SSSx2.p13">
          <p>For the first result, we have via substitution into <ref labelref="LABEL:thm:runtime" show="creftype~refnum"/>:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx3">
            <equation xml:id="A1.Ex14">
              <MathFork>
                <Math tex="\displaystyle O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_%&#10;{q}(D,N\cdot\beta^{-j})\right)" text="O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N cdot beta ^ (- j))))" xml:id="A1.Ex14.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="A1.Ex14.m2.3"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A1.Ex14.m2.3">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex14.m2.3.1"/>
                                  <XMRef idref="A1.Ex14.m2.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex14.m2.3.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex14.m2.1">N</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                      <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex14.m2.2"/>
                                      <XMRef idref="A1.Ex14.m2.3.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex14.m2.2">D</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex14.m2.3.2">
                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_%&#10;{q}(D,N\cdot\beta^{-j})\right)" text="O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N cdot beta ^ (- j))))" xml:id="A1.Ex14.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">O</XMTok>
                          <XMDual>
                            <XMRef idref="A1.Ex14.m1.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="A1.Ex14.m1.3">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A1.Ex14.m1.3.1"/>
                                      <XMRef idref="A1.Ex14.m1.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp xml:id="A1.Ex14.m1.3.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex14.m1.1">N</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A1.Ex14.m1.2"/>
                                          <XMRef idref="A1.Ex14.m1.3.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex14.m1.2">D</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex14.m1.3.2">
                                            <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex15">
              <MathFork>
                <Math tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}%&#10;CdN^{\rho}\cdot\beta^{-j\rho}\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@((C * d * N ^ rho) cdot beta ^ (- j * rho)))" xml:id="A1.Ex15.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex15.m2.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.Ex15.m2.2">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A1.Ex15.m2.2.1"/>
                                    <XMRef idref="A1.Ex15.m2.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp xml:id="A1.Ex15.m2.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex15.m2.1">N</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}%&#10;CdN^{\rho}\cdot\beta^{-j\rho}\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@((C * d * N ^ rho) cdot beta ^ (- j * rho)))" xml:id="A1.Ex15.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex15.m1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex15.m1.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A1.Ex15.m1.2.1"/>
                                        <XMRef idref="A1.Ex15.m1.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex15.m1.2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex15.m1.1">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                            <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex16">
              <MathFork>
                <Math class="ltx_math_unparsed" tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+C\beta dN^{\rho}\sum_{j=0}^{\log_{%&#10;\beta}{N}}\beta^{-j\rho})\right)" xml:id="A1.Ex16.m2">
                  <XMath>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">(</XMTok>
                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex16.m2.1">N</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMTok font="italic" role="UNKNOWN">C</XMTok>
                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                            <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math class="ltx_math_unparsed" mode="inline" tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+C\beta dN^{\rho}\sum_{j=0}^{\log_{%&#10;\beta}{N}}\beta^{-j\rho})\right)" xml:id="A1.Ex16.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex16.m1.1">N</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" role="UNKNOWN">C</XMTok>
                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                          <XMTok font="italic" role="UNKNOWN">d</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex17">
              <MathFork>
                <Math tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+C\beta dN^{\rho}\frac{1}{1-\beta^{-%&#10;\rho}}\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + C * beta * d * N ^ rho * (1 / (1 - beta ^ (- rho))))" xml:id="A1.Ex17.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex17.m2.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.Ex17.m2.2">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A1.Ex17.m2.2.1"/>
                                    <XMRef idref="A1.Ex17.m2.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp xml:id="A1.Ex17.m2.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex17.m2.1">N</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+C\beta dN^{\rho}\frac{1}{1-\beta^{-%&#10;\rho}}\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + C * beta * d * N ^ rho * (1 / (1 - beta ^ (- rho))))" xml:id="A1.Ex17.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex17.m1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex17.m1.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A1.Ex17.m1.2.1"/>
                                        <XMRef idref="A1.Ex17.m1.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex17.m1.2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex17.m1.1">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMApp>
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex18">
              <MathFork>
                <Math tex="\displaystyle=O\left(\frac{C\beta dN^{\rho}}{1-\beta^{-\rho}}\right)." text="absent = O * ((C * beta * d * N ^ rho) / (1 - beta ^ (- rho)))" xml:id="A1.Ex18.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex18.m2.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex18.m2.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex18.m2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex18.m2.1">
                                  <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle=O\left(\frac{C\beta dN^{\rho}}{1-\beta^{-\rho}}\right)." text="absent = O * ((C * beta * d * N ^ rho) / (1 - beta ^ (- rho)))" xml:id="A1.Ex18.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex18.m1.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex18.m1.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                <XMDual>
                                  <XMRef idref="A1.Ex18.m1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex18.m1.1">
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">C</XMTok>
                                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="rho" role="UNKNOWN">ρ</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>and for the second result, we have via substitution into <ref labelref="LABEL:thm:runtime" show="creftype~refnum"/>:</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx4">
            <equation xml:id="A1.Ex19">
              <MathFork>
                <Math tex="\displaystyle O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_%&#10;{q}(D,N\cdot\beta^{-j})\right)" text="O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N cdot beta ^ (- j))))" xml:id="A1.Ex19.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">O</XMTok>
                      <XMDual>
                        <XMRef idref="A1.Ex19.m2.3"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">(</XMTok>
                          <XMApp xml:id="A1.Ex19.m2.3">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex19.m2.3.1"/>
                                  <XMRef idref="A1.Ex19.m2.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex19.m2.3.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex19.m2.1">N</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                      <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.Ex19.m2.2"/>
                                      <XMRef idref="A1.Ex19.m2.3.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex19.m2.2">D</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex19.m2.3.2">
                                        <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_%&#10;{q}(D,N\cdot\beta^{-j})\right)" text="O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * open-interval@(D, N cdot beta ^ (- j))))" xml:id="A1.Ex19.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">O</XMTok>
                          <XMDual>
                            <XMRef idref="A1.Ex19.m1.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="A1.Ex19.m1.3">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A1.Ex19.m1.3.1"/>
                                      <XMRef idref="A1.Ex19.m1.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp xml:id="A1.Ex19.m1.3.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex19.m1.1">N</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMApp>
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A1.Ex19.m1.2"/>
                                          <XMRef idref="A1.Ex19.m1.3.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex19.m1.2">D</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.Ex19.m1.3.2">
                                            <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                              <XMApp>
                                                <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                              </XMApp>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex20">
              <MathFork>
                <Math tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_%&#10;{q}(D)\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * D))" xml:id="A1.Ex20.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex20.m2.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.Ex20.m2.3">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A1.Ex20.m2.3.1"/>
                                    <XMRef idref="A1.Ex20.m2.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp xml:id="A1.Ex20.m2.3.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex20.m2.1">N</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A1.Ex20.m2.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex20.m2.2">D</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+\beta\sum_{j=0}^{\log_{\beta}{N}}A_%&#10;{q}(D)\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + beta * ((sum _ (j = 0)) ^ ((logarithm _ beta)@(N)))@(A _ q * D))" xml:id="A1.Ex20.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex20.m1.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex20.m1.3">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A1.Ex20.m1.3.1"/>
                                        <XMRef idref="A1.Ex20.m1.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex20.m1.3.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex20.m1.1">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="mid2"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                          <XMApp>
                                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                            <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                            <XMTok fontsize="70%" meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="A1.Ex20.m1.2"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex20.m1.2">D</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex21">
              <MathFork>
                <Math tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+\beta\log_{\beta}(N)A_{q}(D)\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + beta * (logarithm _ beta)@(N) * A _ q * D)" xml:id="A1.Ex21.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex21.m2.4"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.Ex21.m2.4">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A1.Ex21.m2.4.1"/>
                                    <XMRef idref="A1.Ex21.m2.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp xml:id="A1.Ex21.m2.4.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex21.m2.1">N</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMRef idref="A1.Ex21.m2.4.2"/>
                                    <XMRef idref="A1.Ex21.m2.2"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp xml:id="A1.Ex21.m2.4.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex21.m2.2">N</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.Ex21.m2.3"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex21.m2.3">D</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle=O\left(\beta\log_{\beta}(N)d+\beta\log_{\beta}(N)A_{q}(D)\right)" text="absent = O * (beta * (logarithm _ beta)@(N) * d + beta * (logarithm _ beta)@(N) * A _ q * D)" xml:id="A1.Ex21.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex21.m1.4"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex21.m1.4">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A1.Ex21.m1.4.1"/>
                                        <XMRef idref="A1.Ex21.m1.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex21.m1.4.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex21.m1.1">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A1.Ex21.m1.4.2"/>
                                        <XMRef idref="A1.Ex21.m1.2"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex21.m1.4.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex21.m1.2">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A1.Ex21.m1.3"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex21.m1.3">D</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex22">
              <MathFork>
                <Math tex="\displaystyle=O\left(\beta\log_{\beta}(N)(d+A_{q}(D))\right)." text="absent = O * beta * (logarithm _ beta)@(N) * (d + A _ q * D)" xml:id="A1.Ex22.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex22.m2.3"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex22.m2.3">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">O</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex22.m2.3.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex22.m2.3.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMRef idref="A1.Ex22.m2.3.1.1"/>
                                      <XMRef idref="A1.Ex22.m2.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp xml:id="A1.Ex22.m2.3.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex22.m2.1">N</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMDual>
                                  <XMDual>
                                    <XMRef idref="A1.Ex22.m2.3.1.2"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex22.m2.3.1.2">
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                          </XMApp>
                                          <XMDual>
                                            <XMRef idref="A1.Ex22.m2.2"/>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex22.m2.2">D</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="left"><Math mode="inline" tex="\displaystyle=O\left(\beta\log_{\beta}(N)(d+A_{q}(D))\right)." text="absent = O * beta * (logarithm _ beta)@(N) * (d + A _ q * D)" xml:id="A1.Ex22.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex22.m1.3"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex22.m1.3">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">O</XMTok>
                                <XMDual>
                                  <XMRef idref="A1.Ex22.m1.3.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex22.m1.3.1">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMRef idref="A1.Ex22.m1.3.1.1"/>
                                          <XMRef idref="A1.Ex22.m1.1"/>
                                        </XMApp>
                                        <XMApp>
                                          <XMApp xml:id="A1.Ex22.m1.3.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                            <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex22.m1.1">N</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMApp>
                                      </XMDual>
                                      <XMDual>
                                        <XMRef idref="A1.Ex22.m1.3.1.2"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.Ex22.m1.3.1.2">
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">A</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                                              </XMApp>
                                              <XMDual>
                                                <XMRef idref="A1.Ex22.m1.2"/>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex22.m1.2">D</XMTok>
                                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
          <p>∎</p>
        </para>
      </proof>
      <para xml:id="A1.SS0.SSSx2.p14">
        <p>See <ref labelref="LABEL:restatable:existingannruntime"/></p>
      </para>
      <proof>
        <title class="ltx_runin" font="italic">Proof.</title>
        <para xml:id="A1.SS0.SSSx2.p15">
          <p><cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> consider greedy search on an <Math mode="inline" tex="\alpha" text="alpha" xml:id="A1.SS0.SSSx2.p15.m1">
              <XMath>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
              </XMath>
            </Math>-Vamana graph built on a dataset <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p15.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math> with ”slow preprocessing.” They show that the search procedure is guaranteed to return a <Math mode="inline" tex="(\frac{\alpha+1}{\alpha-1}+\epsilon)" text="(alpha + 1) / (alpha - 1) + epsilon" xml:id="A1.SS0.SSSx2.p15.m3">
              <XMath>
                <XMDual>
                  <XMRef idref="A1.SS0.SSSx2.p15.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p15.m3.1">
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                          <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>-ANN in <Math mode="inline" tex="O(\log_{\alpha}(\frac{\Delta}{(\alpha-1)\epsilon}))" text="O * (logarithm _ alpha)@(Delta / ((alpha - 1) * epsilon))" xml:id="A1.SS0.SSSx2.p15.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx2.p15.m4.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMDual xml:id="A1.SS0.SSSx2.p15.m4.3">
                        <XMApp>
                          <XMRef idref="A1.SS0.SSSx2.p15.m4.3.1"/>
                          <XMRef idref="A1.SS0.SSSx2.p15.m4.2"/>
                        </XMApp>
                        <XMApp>
                          <XMApp xml:id="A1.SS0.SSSx2.p15.m4.3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.SS0.SSSx2.p15.m4.2">
                              <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                              <XMTok fontsize="70%" name="Delta" role="UNKNOWN">Δ</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMDual>
                                  <XMRef idref="A1.SS0.SSSx2.p15.m4.1"/>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.SS0.SSSx2.p15.m4.1">
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> steps, each of which take <Math mode="inline" tex="O((4\alpha)^{\delta}\log\Delta)" text="O * (4 * alpha) ^ delta * logarithm@(Delta)" xml:id="A1.SS0.SSSx2.p15.m5">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx2.p15.m5.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p15.m5.1">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMDual>
                            <XMRef idref="A1.SS0.SSSx2.p15.m5.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.SS0.SSSx2.p15.m5.1.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="4" role="NUMBER">4</XMTok>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math> time. See <ref labelref="LABEL:app:diskann" show="creftype~refnum"/> for an explanation of <Math mode="inline" tex="\alpha" text="alpha" xml:id="A1.SS0.SSSx2.p15.m6">
              <XMath>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
              </XMath>
            </Math> and a complete overview of Vamana.</p>
        </para>
        <para xml:id="A1.SS0.SSSx2.p16">
          <p>We can multiply together these two bounds on the running times to get an upper bound on the running time of the entire procedure:</p>
          <equation xml:id="A1.Ex23">
            <Math mode="display" tex="O\left(\log_{\alpha}\left(\frac{\Delta}{\left(\alpha-1\right)\epsilon}\right)%&#10;\left(4\alpha\right)^{\delta}\log\Delta\right)=O\left(\log_{\alpha}\left(\frac%&#10;{\Delta}{\left(\alpha-1\right)(c-\frac{\alpha+1}{\alpha-1})}\right)\left(4%&#10;\alpha\right)^{\delta}\log\Delta\right)." text="O * (logarithm _ alpha)@(Delta / ((alpha - 1) * epsilon)) * (4 * alpha) ^ delta * logarithm@(Delta) = O * (logarithm _ alpha)@(Delta / ((alpha - 1) * (c - (alpha + 1) / (alpha - 1)))) * (4 * alpha) ^ delta * logarithm@(Delta)" xml:id="A1.Ex23.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A1.Ex23.m1.6"/>
                  <XMWrap>
                    <XMApp xml:id="A1.Ex23.m1.6">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex23.m1.6.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.Ex23.m1.6.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex23.m1.6.1.1"/>
                                  <XMRef idref="A1.Ex23.m1.4"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex23.m1.6.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex23.m1.4">
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex23.m1.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                                            <XMApp xml:id="A1.Ex23.m1.1">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMDual>
                                  <XMRef idref="A1.Ex23.m1.6.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex23.m1.6.1.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="4" role="NUMBER">4</XMTok>
                                      <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">O</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex23.m1.6.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                            <XMApp xml:id="A1.Ex23.m1.6.2">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex23.m1.6.2.1"/>
                                  <XMRef idref="A1.Ex23.m1.5"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex23.m1.6.2.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex23.m1.5">
                                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                      <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.Ex23.m1.2"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="true">(</XMTok>
                                            <XMApp xml:id="A1.Ex23.m1.2">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMDual>
                                          <XMRef idref="A1.Ex23.m1.3"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.Ex23.m1.3">
                                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">c</XMTok>
                                              <XMApp>
                                                <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                </XMApp>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                <XMDual>
                                  <XMRef idref="A1.Ex23.m1.6.2.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex23.m1.6.2.2">
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="4" role="NUMBER">4</XMTok>
                                      <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>Note the equality is due to the fact that <Math mode="inline" tex="c=\frac{\alpha+1}{\alpha-1}+\epsilon" text="c = (alpha + 1) / (alpha - 1) + epsilon" xml:id="A1.SS0.SSSx2.p16.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
        <para xml:id="A1.SS0.SSSx2.p17">
          <p>Now consider some <Math mode="inline" tex="S\subset D" text="S subset-of D" xml:id="A1.SS0.SSSx2.p17.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                </XMApp>
              </XMath>
            </Math>. We claim that the doubling dimension <Math mode="inline" tex="\delta" text="delta" xml:id="A1.SS0.SSSx2.p17.m2">
              <XMath>
                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
              </XMath>
            </Math> and the aspect ratio <Math mode="inline" tex="\Delta" text="Delta" xml:id="A1.SS0.SSSx2.p17.m3">
              <XMath>
                <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
              </XMath>
            </Math> for <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p17.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMath>
            </Math> are no greater than for <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>. <cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> describe doubling dimension as the the minimum value <Math mode="inline" tex="\delta" text="delta" xml:id="A1.SS0.SSSx2.p17.m6">
              <XMath>
                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
              </XMath>
            </Math> such that for any ball of radius <Math mode="inline" tex="r" text="r" xml:id="A1.SS0.SSSx2.p17.m7">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
              </XMath>
            </Math> centered at some point <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx2.p17.m8">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
              </XMath>
            </Math> in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>, <Math mode="inline" tex="2^{\delta}" text="2 ^ delta" xml:id="A1.SS0.SSSx2.p17.m10">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" fontsize="70%" name="delta" role="UNKNOWN">δ</XMTok>
                </XMApp>
              </XMath>
            </Math> balls of radius <Math mode="inline" tex="r/2" text="r / 2" xml:id="A1.SS0.SSSx2.p17.m11">
              <XMath>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMath>
            </Math> can be arranged to cover all points in <Math mode="inline" tex="D\cap B(x,r)" text="D intersection B * open-interval@(x, r)" xml:id="A1.SS0.SSSx2.p17.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">B</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS0.SSSx2.p17.m12.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p17.m12.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p17.m12.1">x</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p17.m12.2">r</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> (many previous works use the same or an extremely similar definition of doubling dimension (see, e.g., <cite class="ltx_citemacro_citep">(<bibref bibrefs="clarkson1997nearest,krauthgamer2004navigating" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite>). Because <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p17.m13">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMath>
            </Math> is a subset of <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m14">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>, any covering of <Math mode="inline" tex="D\cap B(x,r)" text="D intersection B * open-interval@(x, r)" xml:id="A1.SS0.SSSx2.p17.m15">
              <XMath>
                <XMApp>
                  <XMTok meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">B</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS0.SSSx2.p17.m15.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p17.m15.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p17.m15.1">x</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p17.m15.2">r</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> is also a covering of <Math mode="inline" tex="S\cap B(x,r)" text="S intersection B * open-interval@(x, r)" xml:id="A1.SS0.SSSx2.p17.m16">
              <XMath>
                <XMApp>
                  <XMTok meaning="intersection" name="cap" role="ADDOP">∩</XMTok>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">B</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS0.SSSx2.p17.m16.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p17.m16.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p17.m16.1">x</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p17.m16.2">r</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> for all <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx2.p17.m17">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
              </XMath>
            </Math> in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m18">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math> (and also trivially therefore all <Math mode="inline" tex="x" text="x" xml:id="A1.SS0.SSSx2.p17.m19">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">x</XMTok>
              </XMath>
            </Math> in <Math mode="inline" tex="S\subset D" text="S subset-of D" xml:id="A1.SS0.SSSx2.p17.m20">
              <XMath>
                <XMApp>
                  <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                </XMApp>
              </XMath>
            </Math>), so we know that the doubling dimension of <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p17.m21">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMath>
            </Math> is at most the doubling dimension of <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m22">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>. Similarly, <cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> use the aspect ratio of <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m23">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>, which is</p>
          <equation xml:id="A1.Ex24">
            <Math mode="display" tex="\frac{\max_{x_{1},x_{2}\in D,x_{1}\neq x_{2}}\texttt{dist}_{V}(x_{1},x_{2})}{%&#10;\min_{x_{1},x_{2}\in D,x_{1}\neq x_{2}}\texttt{dist}_{V}(x_{1},x_{2})}." text="((maximum _ (formulae@(list@(x _ 1, x _ 2) element-of D, x _ 1 not-equals x _ 2)))@([dist] _ V) * open-interval@(x _ 1, x _ 2)) / ((minimum _ (formulae@(list@(x _ 1, x _ 2) element-of D, x _ 1 not-equals x _ 2)))@([dist] _ V) * open-interval@(x _ 1, x _ 2))" xml:id="A1.Ex24.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A1.Ex24.m1.9"/>
                  <XMWrap>
                    <XMApp xml:id="A1.Ex24.m1.9">
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="post">max</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex24.m1.1"/>
                                <XMRef idref="A1.Ex24.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex24.m1.1">
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A1.Ex24.m1.1.1"/>
                                      <XMRef idref="A1.Ex24.m1.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMApp xml:id="A1.Ex24.m1.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex24.m1.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex24.m1.2">
                                  <XMTok fontsize="70%" meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMText><text font="typewriter">dist</text></XMText>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex24.m1.3"/>
                            <XMRef idref="A1.Ex24.m1.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex24.m1.3">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex24.m1.4">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok meaning="minimum" role="OPFUNCTION" scriptpos="post">min</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex24.m1.5"/>
                                <XMRef idref="A1.Ex24.m1.6"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex24.m1.5">
                                  <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A1.Ex24.m1.5.1"/>
                                      <XMRef idref="A1.Ex24.m1.5.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMApp xml:id="A1.Ex24.m1.5.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.Ex24.m1.5.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                        <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">D</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex24.m1.6">
                                  <XMTok fontsize="70%" meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">x</XMTok>
                                    <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMText><text font="typewriter">dist</text></XMText>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.Ex24.m1.7"/>
                            <XMRef idref="A1.Ex24.m1.8"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.Ex24.m1.7">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex24.m1.8">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" role="UNKNOWN">x</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>For any subset <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p17.m24">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMath>
            </Math> of <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m25">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>, let the two points corresponding to the smallest distance be <Math mode="inline" tex="x_{small}" text="x _ (s * m * a * l * l)" xml:id="A1.SS0.SSSx2.p17.m26">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="y_{small}" text="y _ (s * m * a * l * l)" xml:id="A1.SS0.SSSx2.p17.m27">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">y</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> and the two points corresponding to the largest distance be <Math mode="inline" tex="x_{large}" text="x _ (l * a * r * g * e)" xml:id="A1.SS0.SSSx2.p17.m28">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">g</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="y_{large}" text="y _ (l * a * r * g * e)" xml:id="A1.SS0.SSSx2.p17.m29">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">y</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">g</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>. Since <Math mode="inline" tex="S\subset D" text="S subset-of D" xml:id="A1.SS0.SSSx2.p17.m30">
              <XMath>
                <XMApp>
                  <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                </XMApp>
              </XMath>
            </Math>, <Math mode="inline" tex="x_{small},y_{small}" text="list@(x _ (s * m * a * l * l), y _ (s * m * a * l * l))" xml:id="A1.SS0.SSSx2.p17.m31">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A1.SS0.SSSx2.p17.m31.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p17.m31.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A1.SS0.SSSx2.p17.m31.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p17.m31.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">y</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> are also in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m32">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>, so the smallest distance in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m33">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math> is less than or equal to <Math mode="inline" tex="\texttt{dist}_{V}(x_{small},y_{small})" text="[dist] _ V * open-interval@(x _ (s * m * a * l * l), y _ (s * m * a * l * l))" xml:id="A1.SS0.SSSx2.p17.m34">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter">dist</text></XMText>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx2.p17.m34.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p17.m34.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p17.m34.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p17.m34.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">y</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, and similarly <Math mode="inline" tex="x_{large},y_{large}" text="list@(x _ (l * a * r * g * e), y _ (l * a * r * g * e))" xml:id="A1.SS0.SSSx2.p17.m35">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="A1.SS0.SSSx2.p17.m35.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p17.m35.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMApp xml:id="A1.SS0.SSSx2.p17.m35.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">x</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p17.m35.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">y</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> are also in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m36">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>, so the largest distance in <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m37">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math> is greater than or equal to <Math mode="inline" tex="\texttt{dist}_{V}(x_{large},y_{large})" text="[dist] _ V * open-interval@(x _ (l * a * r * g * e), y _ (l * a * r * g * e))" xml:id="A1.SS0.SSSx2.p17.m38">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter">dist</text></XMText>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS0.SSSx2.p17.m38.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p17.m38.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p17.m38.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">g</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p17.m38.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">y</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">g</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>. Thus compared to <Math mode="inline" tex="\Delta" text="Delta" xml:id="A1.SS0.SSSx2.p17.m39">
              <XMath>
                <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
              </XMath>
            </Math>, the numerator of <Math mode="inline" tex="\Delta_{S}" text="Delta _ S" xml:id="A1.SS0.SSSx2.p17.m40">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">S</XMTok>
                </XMApp>
              </XMath>
            </Math> is no larger and the denominator is no smaller, and so <Math mode="inline" tex="\Delta_{S}\leq\Delta" text="Delta _ S &lt;= Delta" xml:id="A1.SS0.SSSx2.p17.m41">
              <XMath>
                <XMApp>
                  <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">S</XMTok>
                  </XMApp>
                  <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
                </XMApp>
              </XMath>
            </Math>. In other words, the aspect ratio of any subset <Math mode="inline" tex="S" text="S" xml:id="A1.SS0.SSSx2.p17.m42">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMath>
            </Math> is less than the aspect ratio <Math mode="inline" tex="\Delta" text="Delta" xml:id="A1.SS0.SSSx2.p17.m43">
              <XMath>
                <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
              </XMath>
            </Math> of <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p17.m44">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>.</p>
        </para>
        <para xml:id="A1.SS0.SSSx2.p18">
          <p><!--  %**** paper.tex Line 1050 **** -->Because our running time result above is monotonic in <Math mode="inline" tex="\Delta" text="Delta" xml:id="A1.SS0.SSSx2.p18.m1">
              <XMath>
                <XMTok name="Delta" role="UNKNOWN">Δ</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="\delta" text="delta" xml:id="A1.SS0.SSSx2.p18.m2">
              <XMath>
                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
              </XMath>
            </Math>, and the other parameters <Math mode="inline" tex="\alpha" text="alpha" xml:id="A1.SS0.SSSx2.p18.m3">
              <XMath>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
              </XMath>
            </Math> and <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx2.p18.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
              </XMath>
            </Math> are constant, we have that <Math mode="inline" tex="c" text="c" xml:id="A1.SS0.SSSx2.p18.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">c</XMTok>
              </XMath>
            </Math>-ANN search on any subset <Math mode="inline" tex="S\subset D" text="S subset-of D" xml:id="A1.SS0.SSSx2.p18.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="subset-of" name="subset" role="RELOP">⊂</XMTok>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" role="UNKNOWN">D</XMTok>
                </XMApp>
              </XMath>
            </Math> is upper bounded by the running time on the entire dataset <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p18.m7">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math>. Thus, since <Math mode="inline" tex="O(A_{q}(D,m)=A_{q}(D))" text="O * (A _ q * open-interval@(D, m) = A _ q * D)" xml:id="A1.SS0.SSSx2.p18.m8">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx2.p18.m8.4"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p18.m8.4">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">A</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.SS0.SSSx2.p18.m8.1"/>
                              <XMRef idref="A1.SS0.SSSx2.p18.m8.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p18.m8.1">D</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p18.m8.2">m</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">A</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.SS0.SSSx2.p18.m8.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p18.m8.3">D</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, we can now plug in to <ref labelref="LABEL:lem:commonfuncclasses" show="creftype~refnum"/>, giving us our final result.
∎</p>
        </para>
      </proof>
      <para xml:id="A1.SS0.SSSx2.p19">
        <p>See <ref labelref="LABEL:restatable:wstblowup"/></p>
      </para>
      <proof>
        <title class="ltx_runin" font="italic">Proof.</title>
        <para xml:id="A1.SS0.SSSx2.p20">
          <p>To see that the worst case blowup factor is <Math mode="inline" tex="O(N)" text="O * N" xml:id="A1.SS0.SSSx2.p20.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">O</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx2.p20.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p20.m1.1">N</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, consider the first split of <Math mode="inline" tex="D" text="D" xml:id="A1.SS0.SSSx2.p20.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">D</XMTok>
              </XMath>
            </Math> into children <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx2.p20.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> for <Math mode="inline" tex="i=1,\ldots\beta" text="i = list@(1, ldots * beta)" xml:id="A1.SS0.SSSx2.p20.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="list"/>
                      <XMRef idref="A1.SS0.SSSx2.p20.m4.1"/>
                      <XMRef idref="A1.SS0.SSSx2.p20.m4.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok meaning="1" role="NUMBER" xml:id="A1.SS0.SSSx2.p20.m4.1">1</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p20.m4.2">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok name="ldots" role="ID">…</XMTok>
                        <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>. These <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx2.p20.m5">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> correspond to label ranges <Math mode="inline" tex="\{[a_{i},b_{i}]\}" text="set@(closed-interval@(a _ i, b _ i))" xml:id="A1.SS0.SSSx2.p20.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="A1.SS0.SSSx2.p20.m6.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="A1.SS0.SSSx2.p20.m6.1">
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="A1.SS0.SSSx2.p20.m6.1.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p20.m6.1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp xml:id="A1.SS0.SSSx2.p20.m6.1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.SS0.SSSx2.p20.m6.1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">b</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, where <Math mode="inline" tex="a_{0}=0" text="a _ 0 = 0" xml:id="A1.SS0.SSSx2.p20.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                  <XMTok meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
              </XMath>
            </Math>, <Math mode="inline" tex="b_{last}=N" text="b _ (l * a * s * t) = N" xml:id="A1.SS0.SSSx2.p20.m8">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">l</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math>, and each <Math mode="inline" tex="a_{i}=b_{i-1}+1" text="a _ i = b _ (i - 1) + 1" xml:id="A1.SS0.SSSx2.p20.m9">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">b</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>. Consider the range <Math mode="inline" tex="(b_{1},a_{2})" text="open-interval@(b _ 1, a _ 2)" xml:id="A1.SS0.SSSx2.p20.m10">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p20.m10.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p20.m10.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p20.m10.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">b</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p20.m10.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>. This range is not a subset of any <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx2.p20.m11">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>. Furthermore, because all smaller ranges further down the tree are strict subsets of some <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx2.p20.m12">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math>, this range is also not a subset of any smaller range. Thus the smallest range that <Math mode="inline" tex="S_{i}" text="S _ i" xml:id="A1.SS0.SSSx2.p20.m13">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> is a subset of is the top level range, so a <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS0.SSSx2.p20.m14">
              <XMath>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
              </XMath>
            </Math>-WST has a worst case blowup of <Math mode="inline" tex="\frac{N}{2}=O(N)" text="N / 2 = O * N" xml:id="A1.SS0.SSSx2.p20.m15">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="italic" role="UNKNOWN">O</XMTok>
                    <XMDual>
                      <XMRef idref="A1.SS0.SSSx2.p20.m15.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p20.m15.1">N</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>.</p>
        </para>
        <para xml:id="A1.SS0.SSSx2.p21">
          <p>For the cost, we note that the label ranges of each level of the tree (except possibly the last, since it might be only partially full) are a partition of <Math mode="inline" tex="\{1,\ldots,N\}" text="set@(1, ldots, N)" xml:id="A1.SS0.SSSx2.p21.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m1.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m1.2"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="A1.SS0.SSSx2.p21.m1.1">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p21.m1.2">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p21.m1.3">N</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, so the sum of <Math mode="inline" tex="b_{i}-a_{i}" text="b _ i - a _ i" xml:id="A1.SS0.SSSx2.p21.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">b</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> is equal to <Math mode="inline" tex="N" text="N" xml:id="A1.SS0.SSSx2.p21.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMath>
            </Math> for all levels but the last. There are <Math mode="inline" tex="\lfloor\log_{\beta}(N)\rfloor" text="floor@((logarithm _ beta)@(N))" xml:id="A1.SS0.SSSx2.p21.m4">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="floor"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                    <XMDual xml:id="A1.SS0.SSSx2.p21.m4.2">
                      <XMApp>
                        <XMRef idref="A1.SS0.SSSx2.p21.m4.2.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p21.m4.1"/>
                      </XMApp>
                      <XMApp>
                        <XMApp xml:id="A1.SS0.SSSx2.p21.m4.2.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p21.m4.1">N</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMApp>
                    </XMDual>
                    <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> levels, and one possibly non-full level at the bottom of the tree which is smaller than or equal to a full partition of <Math mode="inline" tex="\{1,\ldots,N\}" text="set@(1, ldots, N)" xml:id="A1.SS0.SSSx2.p21.m5">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m5.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m5.2"/>
                    <XMRef idref="A1.SS0.SSSx2.p21.m5.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="A1.SS0.SSSx2.p21.m5.1">1</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="A1.SS0.SSSx2.p21.m5.2">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p21.m5.3">N</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> and so has a cost less than or equal to <Math mode="inline" tex="N" text="N" xml:id="A1.SS0.SSSx2.p21.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMath>
            </Math>. Thus the total cost is bounded by <Math mode="inline" tex="\lceil\log_{\beta}(N)\rceil\cdot N" text="ceiling@((logarithm _ beta)@(N)) cdot N" xml:id="A1.SS0.SSSx2.p21.m7">
              <XMath>
                <XMApp>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="ceiling"/>
                      <XMRef idref="A1.SS0.SSSx2.p21.m7.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="lceil" role="OPEN" stretchy="false">⌈</XMTok>
                      <XMDual xml:id="A1.SS0.SSSx2.p21.m7.2">
                        <XMApp>
                          <XMRef idref="A1.SS0.SSSx2.p21.m7.2.1"/>
                          <XMRef idref="A1.SS0.SSSx2.p21.m7.1"/>
                        </XMApp>
                        <XMApp>
                          <XMApp xml:id="A1.SS0.SSSx2.p21.m7.2.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p21.m7.1">N</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                      <XMTok name="rceil" role="CLOSE" stretchy="false">⌉</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math><!--  %“julian–I think we should just say the cost is at most $“lceil“log˙“beta(N)“rceil “cdot N$, which will get rid of the inconsistency in the lemma statement and slightly simplify the discussion˝ -->.
∎</p>
        </para>
      </proof>
      <figure inlist="lof" labels="LABEL:fig:theory-blowup-help" placement="t" xml:id="A1.F5">
        <tags>
          <tag>Figure 5</tag>
          <tag role="autoref">Figure 5</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">5</tag>
          <tag role="typerefnum">Figure 5</tag>
        </tags>
        <p align="center" class="ltx_align_center"><graphics candidates="images/blowup-theory.pdf" graphic="images/blowup-theory.pdf" options="width=256.0748pt,keepaspectratio=true" xml:id="A1.F5.g1"/></p>
        <toccaption class="ltx_centering"><tag close=" ">5</tag>Illustration of structure of ranges for <ref labelref="LABEL:thm:betterblowup" show="creftype~refnum"/>. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 5</tag>Illustration of structure of ranges for <ref labelref="LABEL:thm:betterblowup" show="creftype~refnum"/>. </caption>
      </figure>
      <para xml:id="A1.SS0.SSSx2.p22">
        <p>See <ref labelref="LABEL:restatable:betterblowup"/></p>
      </para>
      <proof>
        <title class="ltx_runin" font="italic">Proof.</title>
        <para xml:id="A1.SS0.SSSx2.p23">
          <p>At a high level, our approach is to devise a strategy that can ensure all sets of size <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p23.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math> have a blowup factor of <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p23.m2">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math>. We will then repeat this strategy for <Math mode="inline" tex="m=\gamma^{j}" text="m = gamma ^ j" xml:id="A1.SS0.SSSx2.p23.m3">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> for all possible powers of <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p23.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMath>
            </Math>, which will ensure that all possible ranges have a small worst case blowup factor. For a diagram of this structure see <ref labelref="LABEL:fig:theory-blowup-help" show="creftype~refnum"/>.</p>
        </para>
        <para xml:id="A1.SS0.SSSx2.p24">
          <p><!--  %**** paper.tex Line 1075 **** -->First, consider the problem of choosing ranges <Math mode="inline" tex="R_{i}" text="R _ i" xml:id="A1.SS0.SSSx2.p24.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> such that every range of size <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p24.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math> is a subset of some <Math mode="inline" tex="R_{i}" text="R _ i" xml:id="A1.SS0.SSSx2.p24.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> with blowup factor equal to <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p24.m4">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math>. One approach is to choose ranges of</p>
          <equation xml:id="A1.Ex25">
            <Math mode="display" tex="cover(m)=\{[jm+1,(j+2)m]\ |\ j\in\mathbb{Z}_{\geq 0},(j+2)m\leq N\}\cup{[N-2m+%&#10;1,N]}." text="c * o * v * e * r * m = conditional-set@(closed-interval@(j * m + 1, (j + 2) * m), formulae@(j element-of Z _ (absent &gt;= 0), (j + 2) * m &lt;= N)) union closed-interval@((N - 2 * m) + 1, N)" xml:id="A1.Ex25.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A1.Ex25.m1.3"/>
                  <XMWrap>
                    <XMApp xml:id="A1.Ex25.m1.3">
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok font="italic" role="UNKNOWN">o</XMTok>
                        <XMTok font="italic" role="UNKNOWN">v</XMTok>
                        <XMTok font="italic" role="UNKNOWN">e</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMDual>
                          <XMRef idref="A1.Ex25.m1.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex25.m1.1">m</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="conditional-set"/>
                            <XMRef idref="A1.Ex25.m1.3.1"/>
                            <XMRef idref="A1.Ex25.m1.3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                            <XMDual xml:id="A1.Ex25.m1.3.1">
                              <XMApp>
                                <XMTok meaning="closed-interval"/>
                                <XMRef idref="A1.Ex25.m1.3.1.1"/>
                                <XMRef idref="A1.Ex25.m1.3.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="A1.Ex25.m1.3.1.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  </XMApp>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex25.m1.3.1.2">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMDual>
                                    <XMRef idref="A1.Ex25.m1.3.1.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.Ex25.m1.3.1.2.1">
                                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" rpadding="5.0pt" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="MIDDLE" rpadding="5.0pt" stretchy="false">|</XMTok>
                            <XMDual xml:id="A1.Ex25.m1.3.2">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.Ex25.m1.3.2.1"/>
                                <XMRef idref="A1.Ex25.m1.3.2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.Ex25.m1.3.2.1">
                                  <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="blackboard" role="UNKNOWN">Z</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                      <XMTok meaning="absent"/>
                                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex25.m1.3.2.2">
                                  <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.Ex25.m1.3.2.2.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.Ex25.m1.3.2.2.1">
                                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="A1.Ex25.m1.3.3"/>
                            <XMRef idref="A1.Ex25.m1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMApp xml:id="A1.Ex25.m1.3.3">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex25.m1.2">N</XMTok>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </para>
        <para xml:id="A1.SS0.SSSx2.p25">
          <p>The ends of the ranges start at <Math mode="inline" tex="2m" text="2 * m" xml:id="A1.SS0.SSSx2.p25.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                </XMApp>
              </XMath>
            </Math> and go until <Math mode="inline" tex="N" text="N" xml:id="A1.SS0.SSSx2.p25.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMath>
            </Math> by multiples of <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p25.m3">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math>, for a total of <Math mode="inline" tex="\lfloor\frac{N}{m}\rfloor-1" text="floor@(N / m) - 1" xml:id="A1.SS0.SSSx2.p25.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="floor"/>
                      <XMRef idref="A1.SS0.SSSx2.p25.m4.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p25.m4.1">
                        <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                      </XMApp>
                      <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math> ranges. These, plus the additional range <Math mode="inline" tex="[N-2m+1,N]" text="closed-interval@((N - 2 * m) + 1, N)" xml:id="A1.SS0.SSSx2.p25.m5">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p25.m5.2"/>
                    <XMRef idref="A1.SS0.SSSx2.p25.m5.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p25.m5.2">
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" role="UNKNOWN">m</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p25.m5.1">N</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>, lead to a total of <Math mode="inline" tex="\lfloor\frac{N}{m}\rfloor" text="floor@(N / m)" xml:id="A1.SS0.SSSx2.p25.m6">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="floor"/>
                    <XMRef idref="A1.SS0.SSSx2.p25.m6.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                    <XMApp xml:id="A1.SS0.SSSx2.p25.m6.1">
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                    </XMApp>
                    <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> ranges created using this strategy. Each range has width <Math mode="inline" tex="2m" text="2 * m" xml:id="A1.SS0.SSSx2.p25.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                </XMApp>
              </XMath>
            </Math>, so the arrangement has cost</p>
          <equation xml:id="A1.Ex26">
            <Math mode="display" tex="\left\lfloor\frac{N}{m}\right\rfloor\cdot 2m\leq 2N." text="(floor@(N / m) cdot 2) * m &lt;= 2 * N" xml:id="A1.Ex26.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A1.Ex26.m1.2"/>
                  <XMWrap>
                    <XMApp xml:id="A1.Ex26.m1.2">
                      <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="floor"/>
                              <XMRef idref="A1.Ex26.m1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok name="lfloor" role="OPEN" stretchy="true">⌊</XMTok>
                              <XMApp xml:id="A1.Ex26.m1.1">
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                              </XMApp>
                              <XMTok name="rfloor" role="CLOSE" stretchy="true">⌋</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">m</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
        </para>
<!--  %“julian–what about the last range?˝ -->        <para xml:id="A1.SS0.SSSx2.p26">
          <p><!--  %“julian–it’s not clear whether we are creating these ranges for one specific $m$, for all possible $m$’s, or some other way. can we explicitly state what the algorithm is? it may also be helpful to include a figure˝ -->We now show that these ranges <Math mode="inline" tex="R_{i}" text="R _ i" xml:id="A1.SS0.SSSx2.p26.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> do indeed cover all ranges of size <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p26.m2">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math> with blowup factor equal to <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p26.m3">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math>. Consider some range of length <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p26.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math> starting at <Math mode="inline" tex="a" text="a" xml:id="A1.SS0.SSSx2.p26.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math>. If <Math mode="inline" tex="a" text="a" xml:id="A1.SS0.SSSx2.p26.m6">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
              </XMath>
            </Math> is within the first <Math mode="inline" tex="m+1" text="m + 1" xml:id="A1.SS0.SSSx2.p26.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math> integers in a range, then it is entirely within the range. Therefore, we are interested in the union of the first <Math mode="inline" tex="m+1" text="m + 1" xml:id="A1.SS0.SSSx2.p26.m8">
              <XMath>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math> integers in all of the ranges, or</p>
          <equation xml:id="A1.Ex27">
            <Math mode="display" tex="\bigcup_{(j+2)m\leq N}\left\{[jm+1,(j+1)m+1]\right\}\bigcup[N-2m+1,N-m+1]%&#10;\supset[1,N-2m]\bigcup[N-2m+1,N-m+1]=[1,N-m+1]." text="(union _ ((j + 2) * m &lt;= N))@(set@(closed-interval@(j * m + 1, (j + 1) * m + 1)) * union@(closed-interval@((N - 2 * m) + 1, (N - m) + 1))) superset-of closed-interval@(1, N - 2 * m) * union@(closed-interval@((N - 2 * m) + 1, (N - m) + 1)) = closed-interval@(1, (N - m) + 1)" xml:id="A1.Ex27.m1">
              <XMath>
                <XMDual>
                  <XMRef idref="A1.Ex27.m1.4"/>
                  <XMWrap>
                    <XMApp xml:id="A1.Ex27.m1.4">
                      <XMTok meaning="multirelation"/>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="union" name="bigcup" role="SUMOP" scriptpos="mid">⋃</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMRef idref="A1.Ex27.m1.1"/>
                                <XMWrap>
                                  <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex27.m1.1">
                                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">m</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="set"/>
                              <XMRef idref="A1.Ex27.m1.4.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">{</XMTok>
                              <XMDual xml:id="A1.Ex27.m1.4.1">
                                <XMApp>
                                  <XMTok meaning="closed-interval"/>
                                  <XMRef idref="A1.Ex27.m1.4.1.1"/>
                                  <XMRef idref="A1.Ex27.m1.4.1.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                                  <XMApp xml:id="A1.Ex27.m1.4.1.1">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                    </XMApp>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.Ex27.m1.4.1.2">
                                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMDual>
                                        <XMRef idref="A1.Ex27.m1.4.1.2.1"/>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMApp xml:id="A1.Ex27.m1.4.1.2.1">
                                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">j</XMTok>
                                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                    </XMApp>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok role="CLOSE" stretchy="true">}</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="union" name="bigcup" role="SUMOP" scriptpos="mid">⋃</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="closed-interval"/>
                                <XMRef idref="A1.Ex27.m1.4.2"/>
                                <XMRef idref="A1.Ex27.m1.4.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">[</XMTok>
                                <XMApp xml:id="A1.Ex27.m1.4.2">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.Ex27.m1.4.3">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  </XMApp>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="superset-of" name="supset" role="RELOP">⊃</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="A1.Ex27.m1.2"/>
                            <XMRef idref="A1.Ex27.m1.4.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMTok meaning="1" role="NUMBER" xml:id="A1.Ex27.m1.2">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.Ex27.m1.4.4">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                                <XMTok font="italic" role="UNKNOWN">m</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="union" name="bigcup" role="SUMOP" scriptpos="mid">⋃</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="closed-interval"/>
                              <XMRef idref="A1.Ex27.m1.4.5"/>
                              <XMRef idref="A1.Ex27.m1.4.6"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMApp xml:id="A1.Ex27.m1.4.5">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.Ex27.m1.4.6">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                </XMApp>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="closed-interval"/>
                          <XMRef idref="A1.Ex27.m1.3"/>
                          <XMRef idref="A1.Ex27.m1.4.7"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMTok meaning="1" role="NUMBER" xml:id="A1.Ex27.m1.3">1</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex27.m1.4.7">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              <XMTok font="italic" role="UNKNOWN">m</XMTok>
                            </XMApp>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="PERIOD">.</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
          </equation>
          <p>This is all possible starting points for a range of length <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p26.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math>, so <Math mode="inline" tex="R_{i}" text="R _ i" xml:id="A1.SS0.SSSx2.p26.m10">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMath>
            </Math> does indeed cover all ranges of size <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p26.m11">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math>. Furthermore, each range is of size <Math mode="inline" tex="2m" text="2 * m" xml:id="A1.SS0.SSSx2.p26.m12">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                </XMApp>
              </XMath>
            </Math>, so the blowup factor for these ranges of size <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p26.m13">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math> is <Math mode="inline" tex="2" text="2" xml:id="A1.SS0.SSSx2.p26.m14">
              <XMath>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMath>
            </Math>.</p>
        </para>
<!--  %Note that as a followup, this also shows that any range of size $m / C$ is a subset of some $R˙i$ with a blowup factor equal to $2C$. “julian–since we removed $C$ from the theorem, do we still need this statement?˝ 
     %“julian–it seems that we are doing the process above for all values of $m$ that are powers of $(C“gamma)^j$?˝ -->        <para xml:id="A1.SS0.SSSx2.p27">
          <p>Now consider <Math mode="inline" tex="R=\{cover(\gamma^{j})\ |\ j\in\mathbb{Z}_{\geq 0},\gamma^{j}&lt;N\}\cup{(0,N)}" text="R = conditional-set@(c * o * v * e * r * gamma ^ j, formulae@(j element-of Z _ (absent &gt;= 0), gamma ^ j &lt; N)) union open-interval@(0, N)" xml:id="A1.SS0.SSSx2.p27.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="conditional-set"/>
                        <XMRef idref="A1.SS0.SSSx2.p27.m1.3"/>
                        <XMRef idref="A1.SS0.SSSx2.p27.m1.4"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="A1.SS0.SSSx2.p27.m1.3">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok font="italic" role="UNKNOWN">o</XMTok>
                          <XMTok font="italic" role="UNKNOWN">v</XMTok>
                          <XMTok font="italic" role="UNKNOWN">e</XMTok>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMDual>
                            <XMRef idref="A1.SS0.SSSx2.p27.m1.3.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.SS0.SSSx2.p27.m1.3.1">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" rpadding="5.0pt" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok role="MIDDLE" rpadding="5.0pt" stretchy="false">|</XMTok>
                        <XMDual xml:id="A1.SS0.SSSx2.p27.m1.4">
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="A1.SS0.SSSx2.p27.m1.4.1"/>
                            <XMRef idref="A1.SS0.SSSx2.p27.m1.4.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A1.SS0.SSSx2.p27.m1.4.1">
                              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                              <XMTok font="italic" role="UNKNOWN">j</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="blackboard" role="UNKNOWN">Z</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.SS0.SSSx2.p27.m1.4.2">
                              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="A1.SS0.SSSx2.p27.m1.1"/>
                        <XMRef idref="A1.SS0.SSSx2.p27.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="A1.SS0.SSSx2.p27.m1.1">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p27.m1.2">N</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math><!--  %“julian–unclear what the two cases on the first line below means˝ “josh–The idea is that the additional set in the union only matters if $N$ is not a power of $“gamma$, but I can remove it since it may be needlessly confusing˝ -->. We have that</p>
          <equationgroup class="ltx_eqn_align" xml:id="A4.EGx5">
            <equation xml:id="A1.Ex28">
              <MathFork>
                <Math tex="\displaystyle cost=\lfloor\log_{\gamma}(N)\rfloor\cdot 2N+N" text="c * o * s * t = (floor@((logarithm _ gamma)@(N)) cdot 2) * N + N" xml:id="A1.Ex28.m3">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="equals" role="RELOP">=</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">c</XMTok>
                        <XMTok font="italic" role="UNKNOWN">o</XMTok>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok name="cdot" role="MULOP">⋅</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="floor"/>
                                <XMRef idref="A1.Ex28.m3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                                <XMDual xml:id="A1.Ex28.m3.2">
                                  <XMApp>
                                    <XMRef idref="A1.Ex28.m3.2.1"/>
                                    <XMRef idref="A1.Ex28.m3.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp xml:id="A1.Ex28.m3.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex28.m3.1">N</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMDual>
                                <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td align="right"><Math mode="inline" tex="\displaystyle cost" text="c * o * s * t" xml:id="A1.Ex28.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">c</XMTok>
                          <XMTok font="italic" role="UNKNOWN">o</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle=\lfloor\log_{\gamma}(N)\rfloor\cdot 2N+N" text="absent = (floor@((logarithm _ gamma)@(N)) cdot 2) * N + N" xml:id="A1.Ex28.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="floor"/>
                                    <XMRef idref="A1.Ex28.m2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                                    <XMDual xml:id="A1.Ex28.m2.2">
                                      <XMApp>
                                        <XMRef idref="A1.Ex28.m2.2.1"/>
                                        <XMRef idref="A1.Ex28.m2.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex28.m2.2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex28.m2.1">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                    <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex29">
              <MathFork>
                <Math tex="\displaystyle\leq 2N\log_{\gamma}(N)+N" text="absent &lt;= 2 * N * (logarithm _ gamma)@(N) + N" xml:id="A1.Ex29.m2">
                  <XMath>
                    <XMApp>
                      <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                      <XMTok meaning="absent"/>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok meaning="2" role="NUMBER">2</XMTok>
                          <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="A1.Ex29.m2.2"/>
                              <XMRef idref="A1.Ex29.m2.1"/>
                            </XMApp>
                            <XMApp>
                              <XMApp xml:id="A1.Ex29.m2.2">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex29.m2.1">N</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">N</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle\leq 2N\log_{\gamma}(N)+N" text="absent &lt;= 2 * N * (logarithm _ gamma)@(N) + N" xml:id="A1.Ex29.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok meaning="2" role="NUMBER">2</XMTok>
                              <XMTok font="italic" role="UNKNOWN">N</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="A1.Ex29.m1.2"/>
                                  <XMRef idref="A1.Ex29.m1.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp xml:id="A1.Ex29.m1.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex29.m1.1">N</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
            <equation xml:id="A1.Ex30">
              <MathFork>
                <Math tex="\displaystyle=N\left(2\log_{\gamma}(N)+1\right)." text="absent = N * (2 * (logarithm _ gamma)@(N) + 1)" xml:id="A1.Ex30.m2">
                  <XMath>
                    <XMDual>
                      <XMRef idref="A1.Ex30.m2.2"/>
                      <XMWrap>
                        <XMApp xml:id="A1.Ex30.m2.2">
                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">N</XMTok>
                            <XMDual>
                              <XMRef idref="A1.Ex30.m2.2.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">(</XMTok>
                                <XMApp xml:id="A1.Ex30.m2.2.1">
                                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="A1.Ex30.m2.2.1.1"/>
                                        <XMRef idref="A1.Ex30.m2.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp xml:id="A1.Ex30.m2.2.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex30.m2.1">N</XMTok>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PERIOD">.</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math>
                <MathBranch>
                  <td/>
                  <td align="left"><Math mode="inline" tex="\displaystyle=N\left(2\log_{\gamma}(N)+1\right)." text="absent = N * (2 * (logarithm _ gamma)@(N) + 1)" xml:id="A1.Ex30.m1">
                      <XMath>
                        <XMDual>
                          <XMRef idref="A1.Ex30.m1.2"/>
                          <XMWrap>
                            <XMApp xml:id="A1.Ex30.m1.2">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                                <XMDual>
                                  <XMRef idref="A1.Ex30.m1.2.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.Ex30.m1.2.1">
                                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok meaning="2" role="NUMBER">2</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMRef idref="A1.Ex30.m1.2.1.1"/>
                                            <XMRef idref="A1.Ex30.m1.1"/>
                                          </XMApp>
                                          <XMApp>
                                            <XMApp xml:id="A1.Ex30.m1.2.1.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="gamma" role="UNKNOWN">γ</XMTok>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.Ex30.m1.1">N</XMTok>
                                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                            </XMWrap>
                                          </XMApp>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PERIOD">.</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMath>
                    </Math></td>
                </MathBranch>
              </MathFork>
            </equation>
          </equationgroup>
        </para>
<!--  %“julian–why does the $C$ go from the base of the log to the denominator?˝ -->        <para xml:id="A1.SS0.SSSx2.p28">
          <p>Furthermore, we now show that <Math mode="inline" tex="R" text="R" xml:id="A1.SS0.SSSx2.p28.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMath>
            </Math> has worst case blowup factor <Math mode="inline" tex="2\gamma" text="2 * gamma" xml:id="A1.SS0.SSSx2.p28.m2">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                </XMApp>
              </XMath>
            </Math><!--  %on $[N]$ “julian–not sure what ”on $[N]$” means˝. -->.
Consider some range <!--  %**** paper.tex Line 1100 **** --><Math mode="inline" tex="r_{q}" text="r _ q" xml:id="A1.SS0.SSSx2.p28.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMath>
            </Math> of size <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p28.m4">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math>. Consider the minimum <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p28.m5">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMath>
            </Math> such that <Math mode="inline" tex="\gamma^{j}" text="gamma ^ j" xml:id="A1.SS0.SSSx2.p28.m6">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
              </XMath>
            </Math> is greater than <Math mode="inline" tex="m" text="m" xml:id="A1.SS0.SSSx2.p28.m7">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">m</XMTok>
              </XMath>
            </Math>. Let us first consider the case when <Math mode="inline" tex="\gamma^{j}" text="gamma ^ j" xml:id="A1.SS0.SSSx2.p28.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
              </XMath>
            </Math> is less than <Math mode="inline" tex="N" text="N" xml:id="A1.SS0.SSSx2.p28.m9">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMath>
            </Math>. Consider some range <Math mode="inline" tex="r" text="r" xml:id="A1.SS0.SSSx2.p28.m10">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
              </XMath>
            </Math> of size <Math mode="inline" tex="\gamma^{j}" text="gamma ^ j" xml:id="A1.SS0.SSSx2.p28.m11">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
              </XMath>
            </Math> that contains <Math mode="inline" tex="r_{q}" text="r _ q" xml:id="A1.SS0.SSSx2.p28.m12">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMath>
            </Math>. By the definition of <Math mode="inline" tex="cover(\gamma^{j})" text="c * o * v * e * r * gamma ^ j" xml:id="A1.SS0.SSSx2.p28.m13">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">c</XMTok>
                  <XMTok font="italic" role="UNKNOWN">o</XMTok>
                  <XMTok font="italic" role="UNKNOWN">v</XMTok>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMDual>
                    <XMRef idref="A1.SS0.SSSx2.p28.m13.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS0.SSSx2.p28.m13.1">
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, there is some range of size <Math mode="inline" tex="2\gamma^{j}" text="2 * gamma ^ j" xml:id="A1.SS0.SSSx2.p28.m14">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> that contains <Math mode="inline" tex="r" text="r" xml:id="A1.SS0.SSSx2.p28.m15">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
              </XMath>
            </Math> and that therefore contains <Math mode="inline" tex="r_{q}" text="r _ q" xml:id="A1.SS0.SSSx2.p28.m16">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMath>
            </Math>. Furthermore, since this <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p28.m17">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMath>
            </Math> is the minimum <Math mode="inline" tex="j" text="j" xml:id="A1.SS0.SSSx2.p28.m18">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMath>
            </Math> such that <Math mode="inline" tex="\gamma^{j}&gt;m" text="gamma ^ j &gt; m" xml:id="A1.SS0.SSSx2.p28.m19">
              <XMath>
                <XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                </XMApp>
              </XMath>
            </Math>, we have that <Math mode="inline" tex="m&gt;\gamma^{j-1}" text="m &gt; gamma ^ (j - 1)" xml:id="A1.SS0.SSSx2.p28.m20">
              <XMath>
                <XMApp>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>. Thus the maximum blowup factor for <Math mode="inline" tex="r_{q}" text="r _ q" xml:id="A1.SS0.SSSx2.p28.m21">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMath>
            </Math> is less than <Math mode="inline" tex="2\gamma^{j}/\gamma^{j-1}=2\gamma" text="(2 * gamma ^ j) / gamma ^ (j - 1) = 2 * gamma" xml:id="A1.SS0.SSSx2.p28.m22">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok meaning="2" role="NUMBER">2</XMTok>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>. In the case where <Math mode="inline" tex="\gamma^{j}\geq N" text="gamma ^ j &gt;= N" xml:id="A1.SS0.SSSx2.p28.m23">
              <XMath>
                <XMApp>
                  <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMath>
            </Math>, the smallest containing range is <Math mode="inline" tex="(0,N)" text="open-interval@(0, N)" xml:id="A1.SS0.SSSx2.p28.m24">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.SS0.SSSx2.p28.m24.1"/>
                    <XMRef idref="A1.SS0.SSSx2.p28.m24.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="A1.SS0.SSSx2.p28.m24.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS0.SSSx2.p28.m24.2">N</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>. We have that <Math mode="inline" tex="m&gt;\gamma^{j-1}\geq N/\gamma" text="m &gt; gamma ^ (j - 1) &gt;= N / gamma" xml:id="A1.SS0.SSSx2.p28.m25">
              <XMath>
                <XMApp>
                  <XMTok meaning="multirelation"/>
                  <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  <XMTok meaning="greater-than" role="RELOP">&gt;</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, so <Math mode="inline" tex="N/m&lt;\gamma" text="N / m &lt; gamma" xml:id="A1.SS0.SSSx2.p28.m26">
              <XMath>
                <XMApp>
                  <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                  <XMApp>
                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                    <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                  </XMApp>
                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                </XMApp>
              </XMath>
            </Math> and thus the blowup factor for <Math mode="inline" tex="r_{q}" text="r _ q" xml:id="A1.SS0.SSSx2.p28.m27">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">q</XMTok>
                </XMApp>
              </XMath>
            </Math> is less than <Math mode="inline" tex="\gamma" text="gamma" xml:id="A1.SS0.SSSx2.p28.m28">
              <XMath>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              </XMath>
            </Math> (and also less than <Math mode="inline" tex="2\gamma" text="2 * gamma" xml:id="A1.SS0.SSSx2.p28.m29">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok meaning="2" role="NUMBER">2</XMTok>
                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                </XMApp>
              </XMath>
            </Math>).</p>
        </para>
        <para xml:id="A1.SS0.SSSx2.p29">
          <p>∎</p>
        </para>
      </proof>
    </subsubsection>
  </appendix>
  <appendix inlist="toc" labels="LABEL:app:redcaps_gpt" xml:id="A2">
    <tags>
      <tag>Appendix B</tag>
      <tag role="autoref">Appendix B</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">B</tag>
      <tag role="typerefnum">Appendix B</tag>
    </tags>
    <title><tag close=" ">Appendix B</tag>ChatGPT Queries for RedCaps Query Generation</title>
    <toctitle><tag close=" ">B</tag>ChatGPT Queries for RedCaps Query Generation</toctitle>
    <para xml:id="A2.p1">
      <p>Queries were generated in two sessions with ChatGPT-4. The first consisted of the first query and the second query repeated 4 times. The second consisted of 100 examples copied from the first session and the third and four query. The first query:</p>
    </para>
    <para xml:id="A2.p2">
      <quote>
        <p><text fontsize="90%">I wish to run an experiment where I generate many possible text queries for my image search system. Can you help me generate queries? I want you to make the queries casual, and be as varied and creative as possible. To the best of your ability, don’t repeat yourself! Here are a few example queries:
”Funny cat memes”
”C++ coding joke”
”Vegan recipe with blueberries”.</text></p>
      </quote>
      <p>Repeated second query:</p>
    </para>
    <para xml:id="A2.p3">
      <quote>
        <p><text fontsize="90%">Can you generate 100 more? And still make sure to be as creative and casual as possible, and don’t repeat things you’ve already said! Additionally, try to use unique semantic and syntactic structure where possible.</text></p>
      </quote>
      <p>Third and fourth queries:</p>
    </para>
    <para xml:id="A2.p4">
      <quote>
        <p><text fontsize="90%">Try not to generate queries with locations in them, because I already have lot’s of those. Thank you!</text></p>
      </quote>
      <p>and</p>
    </para>
    <para xml:id="A2.p5">
      <quote>
        <p><!--  %**** paper.tex Line 1125 **** --><text fontsize="90%">Great, now I just need 100 more, again as little repeats as possible, be creative! These can be more ”internet” language, so things like, e.g., ”funny cat memes.”</text></p>
      </quote>
    </para>
  </appendix>
  <appendix inlist="toc" labels="LABEL:app:diskann" xml:id="A3">
    <tags>
      <tag>Appendix C</tag>
      <tag role="autoref">Appendix C</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">C</tag>
      <tag role="typerefnum">Appendix C</tag>
    </tags>
    <title><tag close=" ">Appendix C</tag>Vamana Primer</title>
    <toctitle><tag close=" ">C</tag>Vamana Primer</toctitle>
    <para xml:id="A3.p1">
      <p>Vamana <cite class="ltx_citemacro_citep">(<bibref bibrefs="diskann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> is an approximate nearest neighbor algorithm that builds a graph on the input dataset <Math mode="inline" tex="D" text="D" xml:id="A3.p1.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">D</XMTok>
          </XMath>
        </Math>. The entire system from <cite class="ltx_citemacro_citep">(<bibref bibrefs="diskann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, including checkpointing and error recovery, is called DiskANN; Vamana is solely the in-memory ANNS component.</p>
    </para>
    <para xml:id="A3.p2">
      <p>To construct the “slow-preproccessing” variant, which is the variant with theoretical guarantees from <cite class="ltx_citemacro_citep">(<bibref bibrefs="indyk2023worst" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, for each point <Math mode="inline" tex="x" text="x" xml:id="A3.p2.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>, we first connect <Math mode="inline" tex="x" text="x" xml:id="A3.p2.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> to all points. We then sort all other points in the graph in terms of increasing distance from <Math mode="inline" tex="x" text="x" xml:id="A3.p2.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>. Starting from the first point <Math mode="inline" tex="y" text="y" xml:id="A3.p2.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">y</XMTok>
          </XMath>
        </Math> in the list, we prune edges from <Math mode="inline" tex="x" text="x" xml:id="A3.p2.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> to all other points <Math mode="inline" tex="y^{\prime}" text="y ^ prime" xml:id="A3.p2.m6">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">y</XMTok>
              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
            </XMApp>
          </XMath>
        </Math> where <Math mode="inline" tex="\alpha\cdot\texttt{dist}_{V}(y,y^{\prime})\leq\texttt{dist}_{V}(x,y)" text="(alpha cdot [dist] _ V) * open-interval@(y, y ^ prime) &lt;= [dist] _ V * open-interval@(x, y)" xml:id="A3.p2.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="cdot" role="MULOP">⋅</XMTok>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText><text font="typewriter">dist</text></XMText>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A3.p2.m7.1"/>
                    <XMRef idref="A3.p2.m7.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.p2.m7.1">y</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A3.p2.m7.4">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">y</XMTok>
                      <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText><text font="typewriter">dist</text></XMText>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A3.p2.m7.2"/>
                    <XMRef idref="A3.p2.m7.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.p2.m7.2">x</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A3.p2.m7.3">y</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>. We repeat this pruning process with the next closest unpruned point until we reach the end of the list; the unpruned points are the neighbors of <Math mode="inline" tex="x" text="x" xml:id="A3.p2.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="A3.p3">
      <p>To construct the “fast-preprocessing” variant, which is the variant used in practice, we start with an empty graph. We then do a beam search query for the nearest neighbor for all points <Math mode="inline" tex="x\in D" text="x element-of D" xml:id="A3.p3.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">x</XMTok>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMApp>
          </XMath>
        </Math>, twice, building up the graph as we go. For each search, we record all points traversed in the beam search, along with the nearest neighbor if it was not found, and then add these as neighbors to <Math mode="inline" tex="x" text="x" xml:id="A3.p3.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>. We then prune this list using the same heuristic we use for the “slow-preprocessing” variant, and also enforce with a hard cutoff that there are at maximum <text class="ltx_markedasmath" font="italic">degree</text> number of neighbors.</p>
    </para>
    <para xml:id="A3.p4">
      <p>A beam search of size <Math mode="inline" tex="B" text="B" xml:id="A3.p4.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math> is a generalization of a greedy search. Given a query <Math mode="inline" tex="x" text="x" xml:id="A3.p4.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>, we start at a start node <Math mode="inline" tex="s" text="s" xml:id="A3.p4.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> and “explore” <Math mode="inline" tex="s" text="s" xml:id="A3.p4.m4">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> by adding neighbors of <Math mode="inline" tex="s" text="s" xml:id="A3.p4.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">s</XMTok>
          </XMath>
        </Math> to a queue. This queue consists of the closest <Math mode="inline" tex="B" text="B" xml:id="A3.p4.m6">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math> points to <Math mode="inline" tex="x" text="x" xml:id="A3.p4.m7">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> we have seen so far, explored or unexplored. We continually explore the closest unexplored node from the queue to <Math mode="inline" tex="x" text="x" xml:id="A3.p4.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math> until all nodes in the queue are explored. By increasing <Math mode="inline" tex="B" text="B" xml:id="A3.p4.m9">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>, the beam search explores more points and is more likely to find a better nearest neighbor of <Math mode="inline" tex="x" text="x" xml:id="A3.p4.m10">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">x</XMTok>
          </XMath>
        </Math>. We do beam searches for “fast preprorocessing” index construction and for approximate nearest neighbor queries.</p>
    </para>
  </appendix>
  <appendix inlist="toc" labels="LABEL:sec:experiments-appendix" xml:id="A4">
    <tags>
      <tag>Appendix D</tag>
      <tag role="autoref">Appendix D</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">D</tag>
      <tag role="typerefnum">Appendix D</tag>
    </tags>
    <title><tag close=" ">Appendix D</tag>Experiments</title>
    <toctitle><tag close=" ">D</tag>Experiments</toctitle>
    <subsection inlist="toc" labels="LABEL:app:licensing" xml:id="A4.SS1">
      <tags>
        <tag>D.1</tag>
        <tag role="autoref">subsection D.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">D.1</tag>
        <tag role="typerefnum">§D.1</tag>
      </tags>
      <title><tag close=" ">D.1</tag>Dataset License Information</title>
      <para xml:id="A4.SS1.p1">
        <p><text font="typewriter">SIFT</text>, <text font="typewriter">GloVE</text>, and <text font="typewriter">DEEP</text> are released under an MIT license by the ANN benchmarks repository <cite class="ltx_citemacro_citep">(<bibref bibrefs="aumuller2020ann" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. The original RedCaps license has a
restriction to non-commercial use, so our modified <text font="typewriter">Redcaps</text> dataset
is released under the same restriction. Since we generated the <text font="typewriter">Adverse</text> dataset ourselves, we release it under an MIT license.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:pareto" xml:id="A4.SS2">
      <tags>
        <tag>D.2</tag>
        <tag role="autoref">subsection D.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">D.2</tag>
        <tag role="typerefnum">§D.2</tag>
      </tags>
      <title><tag close=" ">D.2</tag>Pareto Frontiers</title>
      <para xml:id="A4.SS2.p1">
        <p><!--  %**** paper.tex Line 1150 **** -->See <ref labelref="LABEL:fig:glove_results" show="creftype~refnum"/>, <ref labelref="LABEL:fig:sift_results" show="creftype~refnum"/>, and <ref labelref="LABEL:fig:redcaps_results" show="creftype~refnum"/> for full Pareto frontier plots for a representative sample of filter widths on all datasets not included in the main text.</p>
      </para>
<!--  %“julian–this is just for glove and sift. we don’t have redcaps?˝ “josh–Just running VBASE on redcaps overnight, I’ll add in the morning˝. -->      <figure inlist="lof" labels="LABEL:fig:glove_results" placement="t" xml:id="A4.F6">
        <tags>
          <tag>Figure 6</tag>
          <tag role="autoref">Figure 6</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Figure 6</tag>
        </tags>
        <p align="center" class="ltx_align_center"><graphics candidates="images/glove-100-angular_results_vamana.pdf" graphic="images/glove-100-angular_results_vamana.pdf" options="width=455.24408pt,keepaspectratio=true" xml:id="A4.F6.g1"/></p>
        <toccaption class="ltx_centering"><tag close=" ">6</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">GloVe</text>. Up and to the right is better. On the medium filter fraction settings, our methods achieve multiple orders of magnitude more
queries per second than the baselines at the same recall levels. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="A4.F6.m1">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> threads.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 6</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">GloVe</text>. Up and to the right is better. On the medium filter fraction settings, our methods achieve multiple orders of magnitude more
queries per second than the baselines at the same recall levels. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="A4.F6.m2">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> threads.</caption>
      </figure>
      <figure inlist="lof" labels="LABEL:fig:sift_results" placement="t" xml:id="A4.F7">
        <tags>
          <tag>Figure 7</tag>
          <tag role="autoref">Figure 7</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">7</tag>
          <tag role="typerefnum">Figure 7</tag>
        </tags>
        <p align="center" class="ltx_align_center"><graphics candidates="images/sift-128-euclidean_results_vamana.pdf" graphic="images/sift-128-euclidean_results_vamana.pdf" options="width=455.24408pt,keepaspectratio=true" xml:id="A4.F7.g1"/></p>
        <toccaption class="ltx_centering"><tag close=" ">7</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">SIFT</text>. Up and to the right is better. On the medium filter fraction settings, our methods achieve multiple orders of magnitude more
queries per second than the baselines at the same recall levels. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="A4.F7.m1">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> threads. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 7</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">SIFT</text>. Up and to the right is better. On the medium filter fraction settings, our methods achieve multiple orders of magnitude more
queries per second than the baselines at the same recall levels. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="A4.F7.m2">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> threads. </caption>
      </figure>
      <figure inlist="lof" labels="LABEL:fig:redcaps_results" placement="t" xml:id="A4.F8">
        <tags>
          <tag>Figure 8</tag>
          <tag role="autoref">Figure 8</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">8</tag>
          <tag role="typerefnum">Figure 8</tag>
        </tags>
        <p align="center" class="ltx_align_center"><graphics candidates="images/redcaps-512-angular_results_vamana.pdf" graphic="images/redcaps-512-angular_results_vamana.pdf" options="width=455.24408pt,keepaspectratio=true" xml:id="A4.F8.g1"/></p>
        <break class="ltx_break"/>
<!--  %**** paper.tex Line 1175 **** -->        <toccaption class="ltx_centering"><tag close=" ">8</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">Redcaps</text>. Up and to the right is better. On the medium filter fraction settings, our methods achieve multiple orders of magnitude more
queries per second than the baselines at the same recall levels. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="A4.F8.m1">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> threads. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 8</tag>Comparison of Pareto frontiers of all methods on window search with different filter fractions on <text font="typewriter">Redcaps</text>. Up and to the right is better. On the medium filter fraction settings, our methods achieve multiple orders of magnitude more
queries per second than the baselines at the same recall levels. All methods are run with <Math mode="inline" tex="16" text="16" xml:id="A4.F8.m2">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> threads. </caption>
      </figure>
    </subsection>
    <subsection inlist="toc" xml:id="A4.SS3">
      <tags>
        <tag>D.3</tag>
        <tag role="autoref">subsection D.3</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">D.3</tag>
        <tag role="typerefnum">§D.3</tag>
      </tags>
      <title><tag close=" ">D.3</tag>Comments on Memory and Performance</title>
      <para xml:id="A4.SS3.p1">
        <p>We expect our method to scale well to larger datasets because our theory predicts only a <Math mode="inline" tex="\log_{\beta}N" text="(logarithm _ beta)@(N)" xml:id="A4.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
              </XMApp>
            </XMath>
          </Math> factor increase in memory cost over a single Vamana index constructed on <Math mode="inline" tex="D" text="D" xml:id="A4.SS3.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>. Our implementation also addresses memory size further by not constructing tree nodes that represent subsets smaller than <Math mode="inline" tex="1000" text="1000" xml:id="A4.SS3.p1.m3">
            <XMath>
              <XMTok meaning="1000" role="NUMBER">1000</XMTok>
            </XMath>
          </Math> points and only storing the dataset <Math mode="inline" tex="D" text="D" xml:id="A4.SS3.p1.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> once. <ref labelref="LABEL:fig:branching_buildtime_memory" show="creftype~refnum"/> shows the memory and construction time of a <Math mode="inline" tex="\beta" text="beta" xml:id="A4.SS3.p1.m5">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST tree constructed for SIFT as we increase <Math mode="inline" tex="\beta" text="beta" xml:id="A4.SS3.p1.m6">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>. For large <Math mode="inline" tex="\beta" text="beta" xml:id="A4.SS3.p1.m7">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>, a <Math mode="inline" tex="\beta" text="beta" xml:id="A4.SS3.p1.m8">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>-WST tree has an only slightly larger memory footprint (about 2X) than a single ANN
index, and for the theoretical and implementation reasons above we expect this trend to hold for larger
datasets.</p>
      </para>
      <para xml:id="A4.SS3.p2">
        <p>Finally, we run additional performance experiments. See <ref labelref="LABEL:fig:full_branching_filter_widths" show="creftype~refnum"/> for comparisons of varying <Math mode="inline" tex="\beta" text="beta" xml:id="A4.SS3.p2.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> on <text font="typewriter">SIFT</text> across all filter fractions, and see <ref labelref="LABEL:tab:all_speedups" show="creftype~refnum"/> for speedups of our best method over the best baseline across recall levels <Math mode="inline" tex="0.8" text="0.8" xml:id="A4.SS3.p2.m2">
            <XMath>
              <XMTok meaning="0.8" role="NUMBER">0.8</XMTok>
            </XMath>
          </Math>, <Math mode="inline" tex="0.9" text="0.9" xml:id="A4.SS3.p2.m3">
            <XMath>
              <XMTok meaning="0.9" role="NUMBER">0.9</XMTok>
            </XMath>
          </Math>, <Math mode="inline" tex="0.99" text="0.99" xml:id="A4.SS3.p2.m4">
            <XMath>
              <XMTok meaning="0.99" role="NUMBER">0.99</XMTok>
            </XMath>
          </Math>, and <Math mode="inline" tex="0.995" text="0.995" xml:id="A4.SS3.p2.m5">
            <XMath>
              <XMTok meaning="0.995" role="NUMBER">0.995</XMTok>
            </XMath>
          </Math>.</p>
      </para>
<!--  %“begin–table˝[h] 
     %“centering 
     %“begin–tabular˝–—c—c—˝ 
     %“hline 
     %Method &amp; Memory ““ 
     %“hline 
     %$2$-WST tree &amp; 4.8 GB ““ 
     %**** paper.tex Line 1200 **** 
     %$4$-WST tree &amp; 3.3 GB ““ 
     %$8$-WST tree &amp; 2.9 GB ““ 
     %$16$-WST tree &amp; 2.6 GB ““ 
     %$32$-WST tree &amp; 2.4 GB ““ 
     %$64$-WST tree &amp; 2.3 GB ““ 
     %Single DiskANN index &amp; 1.0 GB ““ 
     %“hline 
     %“end–tabular˝ 
     %“caption–Memory usage of $“beta$-WST tree for SIFT as $“beta$ increases. 
     %“julian–can we reference this figure in body? or if it’s redundant with Figure 9 we can remove it)˝ 
     %˝ 
     %“label–tab:memory˝ 
     %“end–table˝ -->      <figure inlist="lof" labels="LABEL:fig:branching_buildtime_memory" xml:id="A4.F9">
        <tags>
          <tag>Figure 9</tag>
          <tag role="autoref">Figure 9</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">9</tag>
          <tag role="typerefnum">Figure 9</tag>
        </tags>
        <graphics candidates="images/vamana_memory_build_time.pdf" class="ltx_centering" graphic="images/vamana_memory_build_time.pdf" options="width=284.52756pt,keepaspectratio=true" xml:id="A4.F9.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">9</tag>Plots of index size and build time for varying branching factors <Math mode="inline" tex="\beta" text="beta" xml:id="A4.F9.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="A4.F9.m2">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
            </XMath>
          </Math> on <text font="typewriter">SIFT</text>. The indices were built using 96 threads. Smaller values are better. </toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 9</tag>Plots of index size and build time for varying branching factors <Math mode="inline" tex="\beta" text="beta" xml:id="A4.F9.m3">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="A4.F9.m4">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
            </XMath>
          </Math> on <text font="typewriter">SIFT</text>. The indices were built using 96 threads. Smaller values are better. </caption>
      </figure>
      <figure inlist="lof" labels="LABEL:fig:full_branching_filter_widths" xml:id="A4.F10">
        <tags>
          <tag>Figure 10</tag>
          <tag role="autoref">Figure 10</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">10</tag>
          <tag role="typerefnum">Figure 10</tag>
        </tags>
        <graphics candidates="images/sift-128-euclidean_branching_results.pdf" class="ltx_centering" graphic="images/sift-128-euclidean_branching_results.pdf" options="width=455.24408pt,keepaspectratio=true" xml:id="A4.F10.g1"/>
        <toccaption class="ltx_centering"><tag close=" "><!--  %**** paper.tex Line 1225 **** -->10<!--  %**** paper.tex Line 1225 **** 
     %**** paper.tex Line 1225 **** 
     %**** paper.tex Line 1225 **** 
     %**** paper.tex Line 1225 **** 
     %**** paper.tex Line 1225 **** --></tag><!--  %**** paper.tex Line 1225 **** -->Pareto curves of recall vs. throughput on <text font="typewriter">SIFT</text> for varying window sizes and branching factors <Math mode="inline" tex="\beta" text="beta" xml:id="A4.F10.m1">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="A4.F10.m2">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
            </XMath>
          </Math>. The experiment was run using 16 threads. Up and to the right is better.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 10</tag><!--  %**** paper.tex Line 1225 **** 
     %**** paper.tex Line 1225 **** -->Pareto curves of recall vs. throughput on <!--  %**** paper.tex Line 1225 **** 
     %**** paper.tex Line 1225 **** --><text font="typewriter">SIFT</text> for varying window sizes and branching factors <Math mode="inline" tex="\beta" text="beta" xml:id="A4.F10.m3">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> for <Math mode="inline" tex="\mathsf{VamanaWST}" text="VamanaWST" xml:id="A4.F10.m4">
            <XMath>
              <XMTok font="sansserif" role="UNKNOWN">VamanaWST</XMTok>
            </XMath>
          </Math>. The experiment was run using 16 threads. Up and to the right is better.</caption>
      </figure>
      <table inlist="lot" labels="LABEL:tab:all_speedups" xml:id="A4.T6">
        <tags>
          <tag>Table 6</tag>
          <tag role="autoref">Table 6</tag>
          <tag role="creftype">Table</tag>
          <tag role="creftypecap">Table</tag>
          <tag role="creftypeplural">Tables</tag>
          <tag role="creftypepluralcap">Tables</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Table 6</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" ">6</tag>Speedup of our best method over the best baseline, restricted to hyper-parameter settings that yield the recall in parenthesis in the dataset column. N/A means that none of our methods achieved that recall (on <text font="typewriter">Redcaps</text> this is due to poor Vamana graph quality).</toccaption>
        <caption class="ltx_centering"><tag close=": ">Table 6</tag>Speedup of our best method over the best baseline, restricted to hyper-parameter settings that yield the recall in parenthesis in the dataset column. N/A means that none of our methods achieved that recall (on <text font="typewriter">Redcaps</text> this is due to poor Vamana graph quality).</caption>
        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <thead>
            <tr>
              <td align="left" border="l r tt" thead="column row">Dataset</td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-11}" text="2 ^ (- 11)" xml:id="A4.T6.m1">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="11" role="NUMBER">11</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-10}" text="2 ^ (- 10)" xml:id="A4.T6.m2">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="10" role="NUMBER">10</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-9}" text="2 ^ (- 9)" xml:id="A4.T6.m3">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="9" role="NUMBER">9</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-8}" text="2 ^ (- 8)" xml:id="A4.T6.m4">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="8" role="NUMBER">8</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-7}" text="2 ^ (- 7)" xml:id="A4.T6.m5">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-6}" text="2 ^ (- 6)" xml:id="A4.T6.m6">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-5}" text="2 ^ (- 5)" xml:id="A4.T6.m7">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="5" role="NUMBER">5</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-4}" text="2 ^ (- 4)" xml:id="A4.T6.m8">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-3}" text="2 ^ (- 3)" xml:id="A4.T6.m9">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-2}" text="2 ^ (- 2)" xml:id="A4.T6.m10">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="tt" thead="column"><Math mode="inline" tex="2^{-1}" text="2 ^ (- 1)" xml:id="A4.T6.m11">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMath>
                </Math></td>
              <td align="right" border="r tt" thead="column"><Math mode="inline" tex="2^{0}" text="2 ^ 0" xml:id="A4.T6.m12">
                  <XMath>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="2" role="NUMBER">2</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMath>
                </Math></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" border="l r t" thead="row"><text font="typewriter">Deep</text> (0.8)</td>
              <td align="right" border="t">10.49</td>
              <td align="right" border="t">18.46</td>
              <td align="right" border="t">35.65</td>
              <td align="right" border="t">65.40</td>
              <td align="right" border="t">84.88</td>
              <td align="right" border="t">26.23</td>
              <td align="right" border="t">10.23</td>
              <td align="right" border="t">4.59</td>
              <td align="right" border="t">2.37</td>
              <td align="right" border="t">1.33</td>
              <td align="right" border="t">0.78</td>
              <td align="right" border="r t">0.79</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">SIFT</text> (0.8)</td>
              <td align="right">1.35</td>
              <td align="right">1.88</td>
              <td align="right">3.05</td>
              <td align="right">4.87</td>
              <td align="right">8.68</td>
              <td align="right">16.51</td>
              <td align="right">11.26</td>
              <td align="right">4.92</td>
              <td align="right">2.47</td>
              <td align="right">1.39</td>
              <td align="right">0.91</td>
              <td align="right" border="r">0.94</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">GloVe</text> (0.8)</td>
              <td align="right">1.90</td>
              <td align="right">2.56</td>
              <td align="right">3.29</td>
              <td align="right">4.90</td>
              <td align="right">8.82</td>
              <td align="right">16.37</td>
              <td align="right">10.57</td>
              <td align="right">4.77</td>
              <td align="right">1.49</td>
              <td align="right">0.90</td>
              <td align="right">0.90</td>
              <td align="right" border="r">0.92</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">Redcaps</text> (0.8)</td>
              <td align="right">5.10</td>
              <td align="right">7.95</td>
              <td align="right">11.86</td>
              <td align="right">29.94</td>
              <td align="right">36.46</td>
              <td align="right">20.69</td>
              <td align="right">5.89</td>
              <td align="right">2.59</td>
              <td align="right">3.27</td>
              <td align="right">1.14</td>
              <td align="right">0.88</td>
              <td align="right" border="r">0.88</td>
            </tr>
            <tr>
              <td align="left" border="l r t" thead="row"><text font="typewriter">Deep</text> (0.9)</td>
              <td align="right" border="t">10.49</td>
              <td align="right" border="t">18.46</td>
              <td align="right" border="t">35.65</td>
              <td align="right" border="t">65.40</td>
              <td align="right" border="t">84.88</td>
              <td align="right" border="t">26.23</td>
              <td align="right" border="t">10.23</td>
              <td align="right" border="t">4.26</td>
              <td align="right" border="t">2.18</td>
              <td align="right" border="t">1.23</td>
              <td align="right" border="t">0.75</td>
              <td align="right" border="r t">0.76</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">SIFT</text> (0.9)</td>
              <td align="right">1.35</td>
              <td align="right">1.88</td>
              <td align="right">3.05</td>
              <td align="right">4.87</td>
              <td align="right">8.68</td>
              <td align="right">16.51</td>
              <td align="right">11.26</td>
              <td align="right">4.92</td>
              <td align="right">2.47</td>
              <td align="right">1.39</td>
              <td align="right">0.91</td>
              <td align="right" border="r">0.94</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">GloVe</text> (0.9)</td>
              <td align="right">1.90</td>
              <td align="right">2.56</td>
              <td align="right">3.29</td>
              <td align="right">4.46</td>
              <td align="right">5.38</td>
              <td align="right">9.97</td>
              <td align="right">6.96</td>
              <td align="right">4.04</td>
              <td align="right">1.87</td>
              <td align="right">1.57</td>
              <td align="right">0.90</td>
              <td align="right" border="r">0.90</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">Redcaps</text> (0.9)</td>
              <td align="right">3.18</td>
              <td align="right">5.38</td>
              <td align="right">8.92</td>
              <td align="right">18.55</td>
              <td align="right">19.94</td>
              <td align="right">10.46</td>
              <td align="right">4.33</td>
              <td align="right">1.87</td>
              <td align="right">1.70</td>
              <td align="right">1.55</td>
              <td align="right">0.89</td>
              <td align="right" border="r">0.89</td>
            </tr>
            <tr>
              <td align="left" border="l r t" thead="row"><text font="typewriter">Deep</text> (0.99)</td>
              <td align="right" border="t">6.80</td>
              <td align="right" border="t">11.77</td>
              <td align="right" border="t">22.05</td>
              <td align="right" border="t">40.06</td>
              <td align="right" border="t">50.55</td>
              <td align="right" border="t">9.86</td>
              <td align="right" border="t">4.33</td>
              <td align="right" border="t">3.70</td>
              <td align="right" border="t">1.58</td>
              <td align="right" border="t">1.47</td>
              <td align="right" border="t">0.75</td>
              <td align="right" border="r t">0.75</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">SIFT</text> (0.99)</td>
              <td align="right">1.35</td>
              <td align="right">1.79</td>
              <td align="right">2.88</td>
              <td align="right">4.53</td>
              <td align="right">8.04</td>
              <td align="right">10.10</td>
              <td align="right">6.73</td>
              <td align="right">2.88</td>
              <td align="right">1.61</td>
              <td align="right">1.01</td>
              <td align="right">0.88</td>
              <td align="right" border="r">0.91</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">GloVe</text> (0.99)</td>
              <td align="right">1.90</td>
              <td align="right">1.99</td>
              <td align="right">2.13</td>
              <td align="right">1.96</td>
              <td align="right">3.03</td>
              <td align="right">4.02</td>
              <td align="right">6.00</td>
              <td align="right">5.71</td>
              <td align="right">4.66</td>
              <td align="right">2.67</td>
              <td align="right">0.95</td>
              <td align="right" border="r">0.92</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">Redcaps</text> (0.99)</td>
              <td align="right">1.30</td>
              <td align="right">1.08</td>
              <td align="right">1.50</td>
              <td align="right">1.32</td>
              <td align="right">1.36</td>
              <td align="right">1.87</td>
              <td align="right">3.11</td>
              <td align="right">0.86</td>
              <td align="right">1.82</td>
              <td align="right">3.75</td>
              <td align="right">N/A</td>
              <td align="right" border="r">N/A</td>
            </tr>
            <tr>
              <td align="left" border="l r t" thead="row"><text font="typewriter">Deep</text> (0.995)</td>
              <td align="right" border="t">6.80</td>
              <td align="right" border="t">11.77</td>
              <td align="right" border="t">22.05</td>
              <td align="right" border="t">26.07</td>
              <td align="right" border="t">32.98</td>
              <td align="right" border="t">11.31</td>
              <td align="right" border="t">9.91</td>
              <td align="right" border="t">2.41</td>
              <td align="right" border="t">1.98</td>
              <td align="right" border="t">1.49</td>
              <td align="right" border="t">0.75</td>
              <td align="right" border="r t">0.78</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">SIFT</text> (0.995)</td>
              <td align="right">1.35</td>
              <td align="right">1.79</td>
              <td align="right">2.88</td>
              <td align="right">3.20</td>
              <td align="right">5.51</td>
              <td align="right">10.10</td>
              <td align="right">6.73</td>
              <td align="right">2.16</td>
              <td align="right">1.98</td>
              <td align="right">0.96</td>
              <td align="right">0.89</td>
              <td align="right" border="r">0.88</td>
            </tr>
            <tr>
              <td align="left" border="l r" thead="row"><text font="typewriter">GloVe</text> (0.995)</td>
              <td align="right">1.90</td>
              <td align="right">1.99</td>
              <td align="right">1.63</td>
              <td align="right">1.96</td>
              <td align="right">2.56</td>
              <td align="right">3.28</td>
              <td align="right">3.93</td>
              <td align="right">4.64</td>
              <td align="right">4.58</td>
              <td align="right">2.97</td>
              <td align="right">0.94</td>
              <td align="right" border="r">0.93</td>
            </tr>
            <tr>
              <td align="left" border="b l r" thead="row"><text font="typewriter">Redcaps</text> (0.995)</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">0.30</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b">N/A</td>
              <td align="right" border="b r">N/A</td>
            </tr>
          </tbody>
        </tabular>
      </table>
    </subsection>
  </appendix>
</document>
