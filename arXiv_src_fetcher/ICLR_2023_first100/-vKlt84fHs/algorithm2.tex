
\begin{algorithm}
\caption{\textit{\approach$((x^{\mathcal{s}},y^{\mathcal{s}}), X^{\mathcal{u}}, F)$}}\label{alg_albif}
\KwData{labeled point $(x^{\mathcal{s}},y^{\mathcal{s}})$, unlabeled dataset $X^{\mathcal{u}}$, forest $F$}
\KwResult{updated forest $F$, query point $x^{\mathcal{s}}$} 
 $F \gets$ \textit{LeafDepthUpdate}$((x^{\mathcal{s}},y^{\mathcal{s}})$, $F)$\;
     $H \gets$ \textit{GetDepthMatrix}$(X^{\mathcal{u}}$, $F)$\;
    $x^{\mathcal{s}} \gets$ \textit{GetQuery}$(H)$

\end{algorithm}

\begin{algorithm}
\caption{\textit{LeafDepthUpdate$((x^{\mathcal{s}},y^{\mathcal{s}})$, $F)$}}\label{alg_leafDepth}
\KwData{labeled point $(x^{\mathcal{s}},y^{\mathcal{s}})$, unlabeled dataset $X^{\mathcal{u}}$, forest $F$}
\KwResult{updated leaf $L$} 
\For{$T_t$ \text{in} $F$}{
        $L \gets \lambda_{T_t}(x^{\mathcal{s}})$ \;
        \If{$y_{\mathcal{s}}==$ \text{anomaly}}{$L_\mathcal{o} \gets L_\mathcal{o} + 1$ \;}
        \Else{$L_\mathcal{i} \gets L_\mathcal{i} + 1$ \;}
        $L_\mathcal{h} \gets  h^\mathcal{s}(k(L))$
}
\end{algorithm}


\begin{algorithm}
\caption{\textit{GetDepthMatrix$(X^{\mathcal{u}}, F)$}}\label{alg_DepthMatrix}
\KwData{unlabeled dataset $X^{\mathcal{u}}$, forest $F$}
\KwResult{updated leaf $L$} 
\For{$T_t$ \text{in} $F$}{
    \For{$x^{\mathcal{u}}_j$ \text{in} $X^{\mathcal{u}}$}{
            $L \gets \lambda_{T_t}(x^{\mathcal{u}}_j)$ \;
            $H_{jt} \gets  h^\mathcal{s}(k(L))$
    }
}
\end{algorithm}
