<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-Y34L45JR6z"?>
<?latexml class="article"?>
<?latexml package="iclr2023_conference,times"?>
<!--  %%%%% NEW MATH DEFINITIONS %%%%% --><?latexml package="amsmath,amsfonts,bm"?>
<!--  %Laplace distribution --><!--  %See usage in notation.tex. Chosen to match Daphne’s book. --><?latexml package="hyperref"?>
<?latexml package="url"?>
<?latexml package="inputenc" options="utf8"?>
<?latexml package="fontenc" options="T1"?>
<?latexml package="hyperref"?>
<?latexml package="url"?>
<?latexml package="booktabs"?>
<?latexml package="amsfonts"?>
<?latexml package="nicefrac"?>
<?latexml package="microtype"?>
<?latexml package="xcolor"?>
<?latexml package="epsfig"?>
<?latexml package="graphicx"?>
<?latexml package="amsmath"?>
<?latexml package="amssymb"?>
<?latexml package="overpic"?>
<?latexml package="datetime"?>
<?latexml package="mathtools"?>
<?latexml package="algorithm"?>
<?latexml package="algorithmic"?>
<?latexml package="bbm"?>
<?latexml package="wrapfig"?>
<?latexml package="arydshln"?>
<?latexml package="mathtools"?>
<?latexml package="enumitem"?>
<?latexml package="pgfplots"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<?latexml package="tikz"?>
<?latexml package="pgfplots"?>
<?latexml package="adjustbox" options="export"?>
<?latexml package="multirow"?>
<?latexml package="pifont"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <para xml:id="p1">
    <ERROR class="undefined">\pgfplotsset</ERROR>
    <p>compat=newest















<ERROR class="undefined">\iclrfinalcopy</ERROR></p>
  </para>
  <title>Policy Expansion for Bridging Offline-to-Online Reinforcement Learning</title>
  <creator role="author">
    <personname>Haichao Zhang  Wei Xu  Haonan Yu <break/>Horizon Robotics, Cupertino CA 95014 <break/><text font="typewriter">{haichao.zhang, wei.xu, haonan.yu}@horizon.ai</text></personname>
  </creator>
  <abstract name="Abstract">
    <p>Pre-training with offline data and online fine-tuning using reinforcement learning is a promising strategy for learning control policies by leveraging the best of both worlds in terms of sample efficiency and performance. One natural approach is to initialize the policy for online learning with the one trained offline.
In this work, we introduce a policy expansion scheme for this task. After learning the offline policy, we use it as one candidate policy in a policy set. We then expand the policy set with another policy which will be responsible for further learning. The two policies will be composed in an adaptive manner for interacting with the environment. With this approach, the policy previously learned offline is fully retained during online learning, thus mitigating the potential issues such as destroying the useful behaviors of the offline policy in the initial stage of online learning while allowing the offline policy participate in the exploration naturally in an adaptive manner. Moreover, new useful behaviors can potentially be captured by the newly added policy through learning.
Experiments are conducted on a number of tasks and the results demonstrate the effectiveness of the proposed approach.
Code is
available: <ref class="ltx_url" font="typewriter" href="https://github.com/Haichao-Zhang/PEX">https://github.com/Haichao-Zhang/PEX</ref>.</p>
  </abstract>
  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>Reinforcement learning (RL) has shown great potential in various fields, reaching or even surpassing human-level performances on many tasks <cite class="ltx_citemacro_citep">(e.g. <bibref bibrefs="mnih2015humanlevel,alphago,muzero,human_level_planning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
However, since the policy is learned from scratch for a given task in the standard setting, the number of samples required by RL for successfully solving a task is usually large, which limits its applicability in many practical scenarios such as robotics, where physical interaction and data collection has a non-trivial cost.</p>
    </para>
    <para xml:id="S1.p2">
      <p>In many cases, there is a good amount of offline data that has already been available <cite class="ltx_citemacro_citep">(<bibref bibrefs="rl_in_robotics,data_driven_driving,data_driven_robotics" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, e.g., collected during previous iterations of experiments or from human (e.g. for the task of driving).
Instead of ab initio learning as in the common RL setting, how to effectively leverage the already available offline data for helping with online policy learning is an interesting and open problem <cite class="ltx_citemacro_citep">(<bibref bibrefs="use_offline_buffer,dqn_demo,sac_bc" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="S1.p3">
      <p>Offline RL is an active recent direction that aims to learn a policy by purely using the offline data,
without any further online interactions <cite class="ltx_citemacro_citep">(<bibref bibrefs="BCQ,cql,td3bc,offline_rl,offline_rl_adaptive,DT,TT,yang21,Lu22,zheng22" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
It holds the promise of learning from suboptimal data and improving over the behavior policy that generates the dataset <cite class="ltx_citemacro_citep">(<bibref bibrefs="kumar2022should" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, but its performance could still be limited because of its full reliance on the provided offline data.</p>
    </para>
    <para xml:id="S1.p4">
      <p>To benefit from further online learning, one possible way is to pre-train with offline RL, and warm start the policy of an online RL algorithm to help with learning and exploration when learning online.
While this pre-training + fine-tuning paradigm is natural and intuitive, and has received great success in many fields like computer vision <cite class="ltx_citemacro_citep">(<bibref bibrefs="finetune_cv,imagenet_transfer" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and natural language processing <cite class="ltx_citemacro_citep">(<bibref bibrefs="bert,gpt1,gpt3" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>,
it is less widely used in RL.
Many early attempts in RL community report a number of negative results along this direction.
For example, it has been observed that initializing the policy with offline pre-training and then fine-tuning the policy with standard online RL algorithms (e.g. SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>) sometimes suffers from non-recoverable performance drop under certain settings <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC,jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, potentially due to the distribution shift between offline and online stages and the change of learning dynamics because of the algorithmic switch.</p>
    </para>
    <para xml:id="S1.p5">
      <p><!--  %****␣PEX_arxiv.tex␣Line␣125␣**** -->Another possible way is to use the same offline RL algorithm for online learning. However, it has been observed that
standard offline RL methods generally are not effective in fine-tuning with online data, due to reasons such as conservativeness of the method <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Some recent works in offline RL also start to focus on the offline-pre-training + online fine-tuning paradigm <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC,iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
For this purpose, they share the common philosophy of designing an RL algorithm that is suitable for both offline and online phases.
Because of the unified algorithm across phases, the network parameters (including those for both critics and actor) trained in the offline phase can be reused for further learning in the online phase.</p>
    </para>
    <para xml:id="S1.p6">
      <p>Our work shares the same objective of designing effective offline-to-online training schemes.
However, we take a different perspective by focusing on how to bridge offline-online learning, and not on developing yet another offline or online RL method, which is orthogonal to the focus of this work.
We will illustrate the idea concretely by instantiating our proposed scheme by applying it on existing RL algorithms <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql,sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
The contributions of this work are:</p>
      <itemize xml:id="S1.I1">
        <item xml:id="S1.I1.i1">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">1st item</tag>
          </tags>
          <para xml:id="S1.I1.i1.p1">
            <p>we highlight the value of <emph font="italic">properly connecting</emph> existing offline and online RL methods in order to enjoy the best of both worlds, a perspective that is alternative and orthogonal to developing completely new RL algorithms;</p>
          </para>
        </item>
        <item xml:id="S1.I1.i2">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">2nd item</tag>
          </tags>
          <para xml:id="S1.I1.i2.p1">
            <p>we propose a simple scheme termed as <emph font="italic">policy expansion</emph> for bridging offline and online reinforcement learning. The proposed approach is not only able to preserve the behavior learned in the offline stage, but can also leverage it adaptively during online exploration and along the process of learning;</p>
          </para>
        </item>
        <item xml:id="S1.I1.i3">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">3rd item</tag>
          </tags>
          <para xml:id="S1.I1.i3.p1">
            <p>we verify the effectiveness of the proposed approach by conducting extensive experiments on various tasks and settings, with comparison to a number of baseline methods.</p>
          </para>
        </item>
      </itemize>
    </para>
  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Preliminaries</title>
    <para xml:id="S2.p1">
      <p>We briefly review some related basics in this section, first on
model-free RL for online policy learning, and then on policy learning from offline dataset.</p>
    </para>
    <subsection inlist="toc" xml:id="S2.SS1">
      <tags>
        <tag>2.1</tag>
        <tag role="autoref">subsection 2.1</tag>
        <tag role="refnum">2.1</tag>
        <tag role="typerefnum">§2.1</tag>
      </tags>
      <title><tag close=" ">2.1</tag>Online Reinforcement Learning</title>
      <para xml:id="S2.SS1.p1">
        <p><!--  %****␣PEX_arxiv.tex␣Line␣150␣**** -->Standard model-free RL methods learn a policy
that maps the current state <Math mode="inline" tex="s" text="s" xml:id="S2.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> to a distribution of action <Math mode="inline" tex="a" text="a" xml:id="S2.SS1.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> as <Math mode="inline" tex="\pi(s)" text="pi * s" xml:id="S2.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMDual>
                  <XMRef idref="S2.SS1.p1.m3.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m3.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
The policy is typically modeled with a neural network <Math mode="inline" tex="\pi_{\theta}(s)" text="pi _ theta * s" xml:id="S2.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S2.SS1.p1.m4.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m4.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> with <Math mode="inline" tex="\theta" text="theta" xml:id="S2.SS1.p1.m5">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> denoting the learnable parameters.
To train this policy, there are different approaches including on-policy <cite class="ltx_citemacro_citep">(<bibref bibrefs="pg,ppo" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and off-policy RL methods <cite class="ltx_citemacro_citep">(<bibref bibrefs="ddpg,sac,TD3,GPM" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
In this work, we mainly focus on off-policy RL for online learning because of its higher sample efficiency.
Standard off-policy RL methods rely on the state-action value function <Math mode="inline" tex="Q(s,a)" text="Q * open-interval@(s, a)" xml:id="S2.SS1.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p1.m6.1"/>
                    <XMRef idref="S2.SS1.p1.m6.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m6.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m6.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> using TD-learning:</p>
        <equation labels="LABEL:eq:Q" xml:id="S2.Ex1">
          <Math mode="display" tex="Q(s,a)=r(s,a)+\gamma\mathbb{E}_{s^{\prime}\sim T(s,a),a^{\prime}\sim\pi_{%&#10;\theta}(s^{\prime})}\big{[}Q(s^{\prime},a^{\prime})\big{]}," text="Q * open-interval@(s, a) = r * open-interval@(s, a) + gamma * E _ (formulae@(s ^ prime similar-to T * open-interval@(s, a), a ^ prime similar-to pi _ theta * s ^ prime)) * delimited-[]@(Q * open-interval@(s ^ prime, a ^ prime))" xml:id="S2.Ex1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S2.Ex1.m1.9"/>
                <XMWrap>
                  <XMApp xml:id="S2.Ex1.m1.9">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S2.Ex1.m1.5"/>
                          <XMRef idref="S2.Ex1.m1.6"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex1.m1.5">s</XMTok>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex1.m1.6">a</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.Ex1.m1.7"/>
                            <XMRef idref="S2.Ex1.m1.8"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex1.m1.7">s</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.Ex1.m1.8">a</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="S2.Ex1.m1.3"/>
                              <XMRef idref="S2.Ex1.m1.4"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S2.Ex1.m1.3">
                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S2.Ex1.m1.1"/>
                                      <XMRef idref="S2.Ex1.m1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.Ex1.m1.1">s</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.Ex1.m1.2">a</XMTok>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMApp xml:id="S2.Ex1.m1.4">
                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S2.Ex1.m1.4.1"/>
                                    <XMWrap>
                                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S2.Ex1.m1.4.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                        <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="delimited-[]"/>
                            <XMRef idref="S2.Ex1.m1.9.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok fontsize="120%" role="OPEN" stretchy="false">[</XMTok>
                            <XMApp xml:id="S2.Ex1.m1.9.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="S2.Ex1.m1.9.1.1"/>
                                  <XMRef idref="S2.Ex1.m1.9.1.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S2.Ex1.m1.9.1.1">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S2.Ex1.m1.9.1.2">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok fontsize="120%" role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="T(s,a)" text="T * open-interval@(s, a)" xml:id="S2.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">T</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p1.m7.1"/>
                    <XMRef idref="S2.SS1.p1.m7.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m7.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m7.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> denotes the dynamics function and <Math mode="inline" tex="r(s,a)" text="r * open-interval@(s, a)" xml:id="S2.SS1.p1.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p1.m8.1"/>
                    <XMRef idref="S2.SS1.p1.m8.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m8.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m8.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> the reward.
<Math mode="inline" tex="\gamma\in(0,1)" text="gamma element-of open-interval@(0, 1)" xml:id="S2.SS1.p1.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p1.m9.1"/>
                    <XMRef idref="S2.SS1.p1.m9.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S2.SS1.p1.m9.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S2.SS1.p1.m9.2">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is a discount factor.
By definition, <Math mode="inline" tex="Q(s,a)" text="Q * open-interval@(s, a)" xml:id="S2.SS1.p1.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p1.m10.1"/>
                    <XMRef idref="S2.SS1.p1.m10.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m10.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p1.m10.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> represents the accumulated discounted future reward starting from <Math mode="inline" tex="s" text="s" xml:id="S2.SS1.p1.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math>, taking action <Math mode="inline" tex="a" text="a" xml:id="S2.SS1.p1.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math>, and then following policy <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S2.SS1.p1.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> thereafter.</p>
      </para>
      <para xml:id="S2.SS1.p2">
        <p>The optimization of <Math mode="inline" tex="\theta" text="theta" xml:id="S2.SS1.p2.m1">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> is achieved by maximizing
the following function:</p>
        <equation labels="LABEL:eq:policy_update_online" xml:id="S2.E1">
          <tags>
            <tag>(1)</tag>
            <tag role="autoref">Equation 1</tag>
            <tag role="refnum">1</tag>
          </tags>
          <Math mode="display" tex="\max_{\theta}\mathbb{E}_{s\sim\mathcal{D}}\mathbb{E}_{a\sim\pi_{\theta}}Q(s,a)." text="(maximum _ theta)@(E _ (s similar-to D) * E _ (a similar-to pi _ theta) * Q) * open-interval@(s, a)" xml:id="S2.E1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S2.E1.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S2.E1.m1.3">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                            <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S2.E1.m1.1"/>
                        <XMRef idref="S2.E1.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.1">s</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMTok font="italic" role="UNKNOWN" xml:id="S2.E1.m1.2">a</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S2.SS1.p2.m2">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> denotes replay buffer for storing online trajectories.
In the typical RL setting, learning is conducted from scratch by initializing all
parameters randomly and interacting with the world with the randomly policy.
<Math mode="inline" tex="Q(s,a)" text="Q * open-interval@(s, a)" xml:id="S2.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p2.m3.1"/>
                    <XMRef idref="S2.SS1.p2.m3.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p2.m3.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p2.m3.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> can be implemented as a neural network <Math mode="inline" tex="Q_{\phi}(s,a)" text="Q _ phi * open-interval@(s, a)" xml:id="S2.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                  <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS1.p2.m4.1"/>
                    <XMRef idref="S2.SS1.p2.m4.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p2.m4.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS1.p2.m4.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> with parameter <Math mode="inline" tex="\phi" text="phi" xml:id="S2.SS1.p2.m5">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S2.SS2">
      <tags>
        <tag>2.2</tag>
        <tag role="autoref">subsection 2.2</tag>
        <tag role="refnum">2.2</tag>
        <tag role="typerefnum">§2.2</tag>
      </tags>
      <title><tag close=" ">2.2</tag>Policy Learning from Offline Dataset</title>
      <para xml:id="S2.SS2.p1">
        <p>Policy learning from offline datasets has been investigated from different perspectives.
Given expert-level demonstration data, behavior cloning (BC) <cite class="ltx_citemacro_citep">(<bibref bibrefs="ALVINN,bc" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> is an effective approach for offline policy learning because of its simplicity and effectiveness.
In fact, in some recent work, BC has shown to perform competitively with some offline RL methods <cite class="ltx_citemacro_citep">(<bibref bibrefs="td3bc,DT" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Given a dataset <Math mode="inline" tex="\mathcal{D}_{\rm offline}=\{(s_{i},a_{i})\}" text="D _ offline = set@(open-interval@(s _ i, a _ i))" xml:id="S2.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S2.SS2.p1.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMDual xml:id="S2.SS2.p1.m1.1">
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S2.SS2.p1.m1.1.1"/>
                        <XMRef idref="S2.SS2.p1.m1.1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.SS2.p1.m1.1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S2.SS2.p1.m1.1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> consisting of expert’s state action pairs <Math mode="inline" tex="(s_{i},a_{i})" text="open-interval@(s _ i, a _ i)" xml:id="S2.SS2.p1.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.SS2.p1.m2.1"/>
                  <XMRef idref="S2.SS2.p1.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S2.SS2.p1.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S2.SS2.p1.m2.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>,
BC trains the policy with maximum likelihood over the data:</p>
        <equation labels="LABEL:eq:bc" xml:id="S2.E2">
          <tags>
            <tag>(2)</tag>
            <tag role="autoref">Equation 2</tag>
            <tag role="refnum">2</tag>
          </tags>
          <Math mode="display" tex="\max_{\theta}\mathbb{E}_{(s,a)\sim\mathcal{D}_{\rm offline}}\log\pi_{\theta}(a%&#10;|s)." text="(maximum _ theta)@(E _ (open-interval@(s, a) similar-to D _ offline) * logarithm@(pi _ theta)) * conditional@(a, s)" xml:id="S2.E2.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S2.E2.m1.3"/>
                <XMWrap>
                  <XMApp xml:id="S2.E2.m1.3">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S2.E2.m1.1"/>
                                <XMRef idref="S2.E2.m1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E2.m1.1">s</XMTok>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E2.m1.2">a</XMTok>
                                <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                              <XMTok fontsize="50%" role="UNKNOWN">offline</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.E2.m1.3.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.E2.m1.3.1">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>Although BC has the benefits of reducing the policy learning task to an ordinary supervised learning task,
it suffers from the well-known distributional shift issue <cite class="ltx_citemacro_citep">(<bibref bibrefs="BC_carla,off_road,causal_confusion,copycat" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Another limitation is that BC has a relatively strong requirements on the data quality, and is not good at learning
from suboptimal data.</p>
      </para>
      <para xml:id="S2.SS2.p2">
        <p>Offline RL is a category of methods that are more suitable for policy learning from noisy and suboptimal offline data <cite class="ltx_citemacro_citep">(<bibref bibrefs="kumar2022should" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
When focusing on offline learning only, the core challenge is how to address the extrapolation error due to
querying the critic function with out-of-distribution actions <cite class="ltx_citemacro_citep">(<bibref bibrefs="BCQ,cql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Common strategies include constraining the actions to be close to dataset actions <cite class="ltx_citemacro_citep">(<bibref bibrefs="BCQ,td3bc" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, and constraining the critic to be conservative for out of data distribution actions <cite class="ltx_citemacro_citep">(<bibref bibrefs="cql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
The recent implicit Q-learning (IQL) method <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> addresses this issue by learning a value network to match the expectile of the critic network, thus avoiding querying the critic with the actions not in the offline dataset.
For policy update, IQL use a weighted BC formulation</p>
        <equation labels="LABEL:eq:awac" xml:id="S2.E3">
          <tags>
            <tag>(3)</tag>
            <tag role="autoref">Equation 3</tag>
            <tag role="refnum">3</tag>
          </tags>
          <Math mode="display" tex="\max_{\theta}\mathbb{E}_{(s,a)\sim\mathcal{D}_{\rm offline}}w(s,a)\cdot\log\pi%&#10;_{\theta}(a|s)," text="(((maximum _ theta)@(E _ (open-interval@(s, a) similar-to D _ offline) * w) * open-interval@(s, a)) cdot logarithm@(pi _ theta)) * conditional@(a, s)" xml:id="S2.E3.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S2.E3.m1.5"/>
                <XMWrap>
                  <XMApp xml:id="S2.E3.m1.5">
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok name="cdot" role="MULOP">⋅</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok meaning="maximum" role="OPFUNCTION" scriptpos="mid">max</XMTok>
<!--  %**** PEX_arxiv.tex Line 200 **** -->                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S2.E3.m1.1"/>
                                    <XMRef idref="S2.E3.m1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E3.m1.1">s</XMTok>
                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S2.E3.m1.2">a</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                                  <XMTok fontsize="50%" role="UNKNOWN">offline</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">w</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="S2.E3.m1.3"/>
                            <XMRef idref="S2.E3.m1.4"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m1.3">s</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S2.E3.m1.4">a</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S2.E3.m1.5.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S2.E3.m1.5.1">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="w(s,a)" text="w * open-interval@(s, a)" xml:id="S2.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S2.SS2.p2.m1.1"/>
                    <XMRef idref="S2.SS2.p2.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS2.p2.m1.1">s</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S2.SS2.p2.m1.2">a</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> denotes a data dependent weight, typically calculated based on the estimated advantages <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC,weighted_bc,iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Offline and Online RL Revisited: Connections and Gaps</title>
    <para xml:id="S3.p1">
      <p align="left"><text font="bold">Connections between Offline and Online RL.</text></p>
    </para>
    <para xml:id="S3.p2">
      <p>Offline RL and online RL are closely connected in many aspects.
Historically, many offline RL approaches are branched off from off-policy RL algorithms to the full offline setting <cite class="ltx_citemacro_citep">(<bibref bibrefs="BCQ,td3bc" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Algorithms more specific to offline setting are then further developed, motivated by the challenges residing in the offline setting <cite class="ltx_citemacro_citep">(<bibref bibrefs="offline_rl,cql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Besides algorithmic connections, offline and online RL are also complementary to each other
in terms of strengths and weaknesses.
Offline RL is sample efficient since
no online interactions are required, but the performance is bounded by the fixed data set.
Online RL enjoys more opportunities for performance improvement, but is comparatively
much less sample efficient.
Because of the connections and complementary strengths, instead of treating
them as two isolated topics, it is more natural to connect both
in pursuit of a performant policy in practice.</p>
    </para>
    <para xml:id="S3.p3">
      <p align="left"><text font="bold">The Direct Offline-Online Approach.</text></p>
    </para>
    <para xml:id="S3.p4">
      <p><!--  %****␣PEX_arxiv.tex␣Line␣225␣**** -->Because of the above mentioned connections, it is tempting to directly use the same algorithm (thus the same network architectures as well)
for both phases.
Unfortunately, this is ineffective in <emph font="italic">either directions</emph>: either directly using offline RL algorithms for online learning (<emph font="italic">forward</emph> direction), or directly using online RL algorithms for offline learning (<emph font="italic">reverse</emph> direction).
The reverse direction has been explored extensively in the offline RL community.
The current wisdom is that instead of directly using an existing online RL algorithm (e.g. TD3 <cite class="ltx_citemacro_citep">(<bibref bibrefs="TD3" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>),
special treatments need to be incorporated into the algorithm (e.g. incorporating BC into TD3 <cite class="ltx_citemacro_citep">(<bibref bibrefs="td3bc" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>) for handling the challenges arising
in offline learning, due to issues such as querying the critic function with out-of-distribution actions.</p>
    </para>
    <para xml:id="S3.p5">
      <p>In the <emph font="italic">forward</emph> direction, as noted in previous work <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, it is exceptionally difficult to
first train a policy using offline data and then further improve it using online RL.
There are some efforts in the literature on directly transferring the parameters learned offline for online fine-tuning, <emph font="italic">i.e.</emph>,
by initializing the policy in Eqn.(<ref labelref="LABEL:eq:policy_update_online"/>) with parameters learned offline.
This scheme is illustrated in Figure <ref labelref="LABEL:fig:training_schemes"/> as the <emph font="italic">Direct</emph> approach for Offline-to-Online RL.
While simple, this approach has several potential issues as noted in the literature.
For example, one common issue is that the behavior of the offline policy can be compromised or even destroyed
at the initial phase of online training, e.g. because of the noisy gradient for policy update due to
cold start learning of critic network <cite class="ltx_citemacro_citep">(<bibref bibrefs="jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> (as in the case of reward-free pre-training)
or distribution shift between offline and online dataset <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Another issue is the conservativeness of the offline RL algorithms. While this is a desirable feature
when considering only offline training, it is not preferred for online learning,
where exploration is valuable for a further improvement <cite class="ltx_citemacro_citep">(<bibref bibrefs="anti_exploration" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
This is a phenomenon that is commonly observed and reported in the literature <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay,behavior_transfer,jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Bridging Offline and Online RL via Policy Expansion</title>
    <para xml:id="S4.p1">
      <p>In this section, we will introduce a simple scheme called Policy Expansion for bridging offline and online training.
It is worthwhile to note that the proposed scheme is orthogonal to specific off/online RL algorithms and is
compatible to be used with different value-based offline and online algorithms. The final performance of such a combination may vary depend on the selection of methods.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:training_schemes" placement="t" xml:id="S4.F1">
      <tags>
        <tag>Figure 1</tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <picture class="ltx_centering ltx_figure_panel" fill="none" height="113.5pt" stroke="none" tex="\begin{overpic}[height=113.81102pt]{imgs/offline_and_online}&#10;\put(36.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{Offline RL}%&#10;}}}}&#10;\put(35.0,42.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{Online RL}}%&#10;}}}&#10;\end{overpic}" width="112.0pt" xml:id="S4.F1.pic1"/>
      <picture class="ltx_centering ltx_figure_panel" fill="none" height="113.5pt" stroke="none" tex="\begin{overpic}[height=113.81102pt]{imgs/offline_to_online}&#10;\put(39.5,39.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{Offline-to-%&#10;Online RL}}}}}&#10;\put(46.5,35.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{Direct}}}}}&#10;\put(42.0,18.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{Policy %&#10;Expansion}}}}}&#10;\end{overpic}" width="271.0pt" xml:id="S4.F1.pic2"/>
      <toccaption class="ltx_centering"><tag close=" "><!--  %****␣PEX_arxiv.tex␣Line␣275␣**** -->1<!--  %****␣PEX_arxiv.tex␣Line␣275␣**** 
     %****␣PEX_arxiv.tex␣Line␣275␣**** 
     %****␣PEX_arxiv.tex␣Line␣275␣**** 
     %****␣PEX_arxiv.tex␣Line␣275␣**** 
     %****␣PEX_arxiv.tex␣Line␣275␣**** --></tag><text font="bold"><!--  %****␣PEX_arxiv.tex␣Line␣275␣**** -->Illustration of Different Training Schemes</text>. Offline training and online RL have been developed within their own training stages. Direct Offline-Online learning approach continues the online training stage after the offline stage is finished, updating the same policy network.
The proposed Policy Expansion approach bridges offline and online training by retaining the policy after offline learning (<Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.F1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
            </XMApp>
          </XMath>
        </Math>), and expand the policy set with another learnable policy (<Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S4.F1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
            </XMApp>
          </XMath>
        </Math>) for capturing further performance improvements.
The two policies both participate in interactions with environment and learning in an adaptive fashion.
</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 1</tag><!--  %****␣PEX_arxiv.tex␣Line␣275␣**** 
     %****␣PEX_arxiv.tex␣Line␣275␣**** --><text font="bold"><!--  %****␣PEX_arxiv.tex␣Line␣275␣**** -->Illustration of Different Training Schemes<!--  %****␣PEX_arxiv.tex␣Line␣275␣**** --></text>. Offline training and online RL have been developed within their own training stages. Direct Offline-Online learning approach continues the online training stage after the offline stage is finished, updating the same policy network.
The proposed Policy Expansion approach bridges offline and online training by retaining the policy after offline learning (<Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.F1.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
            </XMApp>
          </XMath>
        </Math>), and expand the policy set with another learnable policy (<Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S4.F1.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
            </XMApp>
          </XMath>
        </Math>) for capturing further performance improvements.
The two policies both participate in interactions with environment and learning in an adaptive fashion.
</caption>
    </figure>
    <subsection inlist="toc" labels="LABEL:alg:algo" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Policy Expansion and Adaptive Composition</title>
      <para xml:id="S4.SS1.p1">
        <p align="left"><text font="bold">Policy Expansion.</text></p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p>To mitigate the above mentioned issues, we propose an alternative scheme that can be readily combined with existing algorithms. The proposed approach is illustrated in Figure <ref labelref="LABEL:fig:training_schemes"/>.
Given a policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> obtained from offline training phase, instead of
directly fine-tuning the parameters,
we freeze <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and add it into a policy set <Math mode="inline" tex="\Pi=[\pi_{\beta}]" text="Pi = delimited-[]@(pi _ beta)" xml:id="S4.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S4.SS1.p2.m3.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S4.SS1.p2.m3.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
To enable further learning, instead of directly modifying <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> as in the <emph font="italic">Direct</emph> method, which has
the potential of destroying useful behaviors learned offline,
we freeze <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and expand the policy set <Math mode="inline" tex="\Pi" text="Pi" xml:id="S4.SS1.p2.m6">
            <XMath>
              <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
            </XMath>
          </Math> with another learnable policy <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S4.SS1.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> as</p>
        <equation labels="LABEL:eq:expand" xml:id="S4.E4">
          <tags>
            <tag>(4)</tag>
            <tag role="autoref">Equation 4</tag>
            <tag role="refnum">4</tag>
          </tags>
          <Math mode="display" tex="\Pi=[\pi_{\beta},\pi_{\theta}]" text="Pi = closed-interval@(pi _ beta, pi _ theta)" xml:id="S4.E4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S4.E4.m1.1"/>
                    <XMRef idref="S4.E4.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S4.E4.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.E4.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>which is responsible for a further performance improvement during online training.
We refer this type of policy construction as Policy Expansion (PEX).
It is intuitive to understand that the behavior of offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS1.p2.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> is free from being
negatively impacted, while the newly added policy can be updated.
The policies in the policy set <Math mode="inline" tex="\Pi" text="Pi" xml:id="S4.SS1.p2.m9">
            <XMath>
              <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
            </XMath>
          </Math><!--  %****␣PEX_arxiv.tex␣Line␣300␣**** --> will all get involved into exploration and learning
in an collaborative and adaptive manner as detailed in the following.</p>
        <p align="left"><text font="bold">Adaptive Policy Composition.</text></p>
        <p>Both policies in the policy set <Math mode="inline" tex="\Pi" text="Pi" xml:id="S4.SS1.p2.m10">
            <XMath>
              <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
            </XMath>
          </Math> will form a single composite policy <Math mode="inline" tex="\tilde{\pi}" text="tilde@(pi)" xml:id="S4.SS1.p2.m11">
            <XMath>
              <XMApp>
                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMApp>
            </XMath>
          </Math>, which will
be used in both exploration and learning.
More specifically, given the current state <Math mode="inline" tex="s" text="s" xml:id="S4.SS1.p2.m12">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math>,
we first sample actions for each member of the policy set <Math mode="inline" tex="\Pi" text="Pi" xml:id="S4.SS1.p2.m13">
            <XMath>
              <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
            </XMath>
          </Math> and form a proposal
actions set <Math mode="inline" tex="\mathbb{A}=\{a_{i}\!\sim\!\pi_{i}(s)|\pi_{i}\in\Pi\}" text="A = conditional-set@(a _ i similar-to pi _ i * s, pi _ i element-of Pi)" xml:id="S4.SS1.p2.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">A</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="conditional-set"/>
                    <XMRef idref="S4.SS1.p2.m14.2"/>
                    <XMRef idref="S4.SS1.p2.m14.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S4.SS1.p2.m14.2">
                      <XMTok meaning="similar-to" name="sim" role="RELOP" rpadding="-1.7pt">∼</XMTok>
                      <XMApp rpadding="-1.7pt">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="S4.SS1.p2.m14.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m14.1">s</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMTok role="MIDDLE" stretchy="false">|</XMTok>
                    <XMApp xml:id="S4.SS1.p2.m14.3">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>.
Then all the action proposals will be taken into consideration and they will be selected
with the probability related to their potential utilities (e.g. values).
For example, we can compute their values at the current state <Math mode="inline" tex="\mathbf{Q}_{\phi}\!\!=\!\![Q_{\phi}(s,a_{i})|a_{i}\in\mathbb{A}]\in\mathbb{R}^%&#10;{K}" text="Q _ phi = delimited-[]@(conditional@(Q _ phi * open-interval@(s, a _ i), a _ i) element-of A) element-of R ^ K" xml:id="S4.SS1.p2.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="multirelation"/>
                <XMApp rpadding="-3.3pt">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="bold" role="UNKNOWN">Q</XMTok>
                  <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                </XMApp>
                <XMTok meaning="equals" role="RELOP" rpadding="-3.3pt">=</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S4.SS1.p2.m15.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S4.SS1.p2.m15.2">
                      <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                      <XMApp>
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                            <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="S4.SS1.p2.m15.1"/>
                              <XMRef idref="S4.SS1.p2.m15.2.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.SS1.p2.m15.1">s</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S4.SS1.p2.m15.2.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="blackboard" role="UNKNOWN">A</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, with <Math mode="inline" tex="K" text="K" xml:id="S4.SS1.p2.m16">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> denotes the cardinality of <Math mode="inline" tex="\Pi" text="Pi" xml:id="S4.SS1.p2.m17">
            <XMath>
              <XMTok name="Pi" role="UNKNOWN">Π</XMTok>
            </XMath>
          </Math> (here <Math mode="inline" tex="K\!=\!2" text="K = 2" xml:id="S4.SS1.p2.m18">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP" rpadding="-1.7pt">=</XMTok>
                <XMTok font="italic" role="UNKNOWN" rpadding="-1.7pt">K</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math>), and construct a categorical distribution for selecting the final action:</p>
        <equation labels="LABEL:eq:w_net" xml:id="S4.E5">
          <tags>
            <tag>(5)</tag>
            <tag role="autoref">Equation 5</tag>
            <tag role="refnum">5</tag>
          </tags>
          <Math mode="display" tex="P_{{\mathbf{w}}}[i]=\frac{\exp(Q_{\phi}(s,a_{i})/\alpha)}{\sum_{j}\exp(Q_{\phi%&#10;}(s,a_{j})/\alpha)},\quad\forall i\in[1,\cdots K]" text="formulae@(P _ w * delimited-[]@(i) = exponential@((Q _ phi * open-interval@(s, a _ i)) / alpha) / (sum _ j)@(exponential@((Q _ phi * open-interval@(s, a _ j)) / alpha)), for-all@(i) element-of closed-interval@(1, cdots * K))" xml:id="S4.E5.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S4.E5.m1.9"/>
                  <XMRef idref="S4.E5.m1.10"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S4.E5.m1.9">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">P</XMTok>
                        <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S4.E5.m1.7"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m1.7">i</XMTok>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMDual>
                        <XMApp>
                          <XMRef idref="S4.E5.m1.2"/>
                          <XMRef idref="S4.E5.m1.3"/>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S4.E5.m1.2">exp</XMTok>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E5.m1.3">
                              <XMTok meaning="divide" role="MULOP">/</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S4.E5.m1.1"/>
                                    <XMRef idref="S4.E5.m1.3.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m1.1">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S4.E5.m1.3.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMApp>
                      </XMDual>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="S4.E5.m1.5"/>
                            <XMRef idref="S4.E5.m1.6"/>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="exponential" role="OPFUNCTION" xml:id="S4.E5.m1.5">exp</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S4.E5.m1.6">
                                <XMTok meaning="divide" role="MULOP">/</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S4.E5.m1.4"/>
                                      <XMRef idref="S4.E5.m1.6.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E5.m1.4">s</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S4.E5.m1.6.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                  <XMApp xml:id="S4.E5.m1.10">
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMApp>
                      <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="closed-interval"/>
                        <XMRef idref="S4.E5.m1.8"/>
                        <XMRef idref="S4.E5.m1.10.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMTok meaning="1" role="NUMBER" xml:id="S4.E5.m1.8">1</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S4.E5.m1.10.1">
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok name="cdots" role="ID">⋯</XMTok>
                          <XMTok font="italic" role="UNKNOWN">K</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="\alpha" text="alpha" xml:id="S4.SS1.p2.m19">
            <XMath>
              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
            </XMath>
          </Math> is temperature.
Then we can sample <Math mode="inline" tex="{\mathbf{w}}" text="w" xml:id="S4.SS1.p2.m20">
            <XMath>
              <XMTok font="bold" role="UNKNOWN">w</XMTok>
            </XMath>
          </Math> from it for selecting the actions <Math mode="inline" tex="{\mathbf{w}}\sim P_{{\mathbf{w}}}" text="w similar-to P _ w" xml:id="S4.SS1.p2.m21">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="bold" role="UNKNOWN">w</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> to decide which
action will be used during unroll for interacting with environment.
Using value for policy composition has been used in different contexts in the literature <cite class="ltx_citemacro_citep">(<bibref bibrefs="taac,VFS" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</p>
      </para>
      <para xml:id="S4.SS1.p3">
        <p>Conceptually, the composite policy <Math mode="inline" tex="\tilde{\pi}" text="tilde@(pi)" xml:id="S4.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMApp>
            </XMath>
          </Math> can be represented as follows:</p>
        <equation labels="LABEL:eq:rex_policy" xml:id="S4.E6">
          <tags>
            <tag>(6)</tag>
            <tag role="autoref">Equation 6</tag>
            <tag role="refnum">6</tag>
          </tags>
          <Math mode="display" tex="\vspace{-0.08in}\tilde{\pi}(a|s)=[\delta_{a\sim\pi_{\beta}(s)},\delta_{a\sim%&#10;\pi_{\theta}(s)}]{\mathbf{w}},\quad{\mathbf{w}}\sim P_{{\mathbf{w}}}\vspace{-0%&#10;.055in}" text="formulae@(tilde@(pi) * conditional@(a, s) = closed-interval@(delta _ (a similar-to pi _ beta * s), delta _ (a similar-to pi _ theta * s)) * w, w similar-to P _ w)" xml:id="S4.E6.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="formulae"/>
                  <XMRef idref="S4.E6.m1.3"/>
                  <XMRef idref="S4.E6.m1.4"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S4.E6.m1.3">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                        <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S4.E6.m1.3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S4.E6.m1.3.1">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="closed-interval"/>
                          <XMRef idref="S4.E6.m1.3.2"/>
                          <XMRef idref="S4.E6.m1.3.3"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S4.E6.m1.3.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                  <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S4.E6.m1.1"/>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E6.m1.1">s</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S4.E6.m1.3.3">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                  <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S4.E6.m1.2"/>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E6.m1.2">s</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok font="bold" role="UNKNOWN">w</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                  <XMApp xml:id="S4.E6.m1.4">
                    <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok font="bold" role="UNKNOWN">w</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">P</XMTok>
                      <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                    </XMApp>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="{\mathbf{w}}\!\in\!\mathbb{R}^{K}" text="w element-of R ^ K" xml:id="S4.SS1.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP" rpadding="-1.7pt">∈</XMTok>
                <XMTok font="bold" role="UNKNOWN" rpadding="-1.7pt">w</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">K</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> a one-hot vector, indicating the policy that is selected for the current state <Math mode="inline" tex="s" text="s" xml:id="S4.SS1.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math>.
<Math mode="inline" tex="\delta_{a\sim\pi}" text="delta _ (a similar-to pi)" xml:id="S4.SS1.p3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
<!--  %**** PEX_arxiv.tex Line 325 **** -->                <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> denotes the Dirac delta distribution centered at <Math mode="inline" tex="a" text="a" xml:id="S4.SS1.p3.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">a</XMTok>
            </XMath>
          </Math> which is sampled from <Math mode="inline" tex="\pi" text="pi" xml:id="S4.SS1.p3.m6">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S4.SS1.p4">
        <p>By allowing only the newly added policy (<Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S4.SS1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> in this case) to be fine-tuned while freezing all others (<Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS1.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math>),
we can avoid the problem of compromising (e.g.
destroying or forgetting) the behavior of offline policy.
At the same time, we have the advantage of adaptiveness in the sense of allowing learning of new abilities.
From this perspective, the policy expansion plays the role of bridging the offline and online learning phases, while
mitigating commonly encountered issues.
It is interesting to note that a similar compositional form of policy has appeared in DAgger <cite class="ltx_citemacro_citep">(<bibref bibrefs="dagger" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, although with a uniform weight across states and under a different context of imitation learning. Here our compositional weight is state adaptive and the compositional policy is used for bridging offline-to-online reinforcement learning.</p>
      </para>
      <para xml:id="S4.SS1.p5">
        <p>PEX has several advantages compared to direct offline-online learning (illustrated in Figure <ref labelref="LABEL:fig:training_schemes"/>):</p>
        <enumerate xml:id="S4.I1">
          <item xml:id="S4.I1.i1">
            <tags>
              <tag>1.</tag>
              <tag role="autoref">item 1</tag>
              <tag role="refnum">1</tag>
              <tag role="typerefnum">item 1</tag>
            </tags>
            <para xml:id="S4.I1.i1.p1">
              <p><emph font="italic">offline policy preservation</emph>: it can retain the useful behaviors learned during offline training phase by retaining the policy and avoid it being destroyed in the initial online training phase;</p>
            </para>
          </item>
          <item xml:id="S4.I1.i2">
            <tags>
              <tag>2.</tag>
              <tag role="autoref">item 2</tag>
              <tag role="refnum">2</tag>
              <tag role="typerefnum">item 2</tag>
            </tags>
            <para xml:id="S4.I1.i2.p1">
              <p><emph font="italic">flexibility in policy form</emph>: the offline policy does not need to be of the same form with the online policy (e.g. same network structure) as in the direct offline-online approach, offering more flexibilities in design;</p>
            </para>
          </item>
          <item xml:id="S4.I1.i3">
            <tags>
              <tag>3.</tag>
              <tag role="autoref">item 3</tag>
              <tag role="refnum">3</tag>
              <tag role="typerefnum">item 3</tag>
            </tags>
            <para xml:id="S4.I1.i3.p1">
              <p><emph font="italic">adaptive behavior selection</emph>: both the behavior of the offline policy and the
online learning policy are used in interacting with the environment and they are involved
in an adaptive manner, e.g., according to their respective expertise in handling different states.</p>
            </para>
          </item>
        </enumerate>
      </para>
      <para xml:id="S4.SS1.p6">
        <ERROR class="undefined">{algorithm}</ERROR>
        <p>[h]
<text align="center" class="ltx_caption">PEX: Policy Expansion for Offline-to-Online RL</text>

<ERROR class="ltx_centering undefined">\lx@orig@algorithmic</ERROR>
<ERROR class="ltx_centering undefined">\STATE</ERROR><text align="center" font="bold">Input:</text> offline RL algorithm <Math class="ltx_centering" mode="inline" tex="\{L^{Q_{\phi}}_{\rm offline},L_{\rm offline}^{\pi_{\beta}}\}" text="set@((L ^ (Q _ phi)) _ offline, (L _ offline) ^ (pi _ beta))" xml:id="S4.SS1.p6.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="S4.SS1.p6.m1.1"/>
                  <XMRef idref="S4.SS1.p6.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp xml:id="S4.SS1.p6.m1.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                        <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS1.p6.m1.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>, online RL algorithm <Math class="ltx_centering" mode="inline" tex="\{L^{Q_{\phi}}_{\rm online},L_{\rm online}^{\pi_{\theta}}\}" text="set@((L ^ (Q _ phi)) _ online, (L _ online) ^ (pi _ theta))" xml:id="S4.SS1.p6.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="S4.SS1.p6.m2.1"/>
                  <XMRef idref="S4.SS1.p6.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp xml:id="S4.SS1.p6.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                        <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok fontsize="70%" role="UNKNOWN">online</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.SS1.p6.m2.2">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok fontsize="70%" role="UNKNOWN">online</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math><note class="ltx_centering" mark="1" role="footnote" xml:id="footnote1"><tags>
              <tag>1</tag>
              <tag role="autoref">footnote 1</tag>
              <tag role="refnum">1</tag>
              <tag role="typerefnum">footnote 1</tag>
            </tags>We represent a value-based RL algorithm succinctly with a pair of value and policy losses as <Math mode="inline" tex="\{L^{Q},L^{\pi}\}" text="set@(L ^ Q, L ^ pi)" xml:id="footnotex1.m1a">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="footnotex1.m1a.1"/>
                    <XMRef idref="footnotex1.m1a.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="footnotex1.m1a.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="footnotex1.m1a.2">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>.</note><ERROR class="ltx_centering undefined">\STATE</ERROR><text align="center" font="bold">Initialize:</text> network parameters <Math class="ltx_centering" mode="inline" tex="\phi" text="phi" xml:id="S4.SS1.p6.m3">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math>, <Math class="ltx_centering" mode="inline" tex="\beta" text="beta" xml:id="S4.SS1.p6.m4">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math>, <Math class="ltx_centering" mode="inline" tex="\theta" text="theta" xml:id="S4.SS1.p6.m5">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math>,   offline replay buffer <Math class="ltx_centering" mode="inline" tex="\mathcal{D}_{\rm offline}" text="D _ offline" xml:id="S4.SS1.p6.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
              </XMApp>
            </XMath>
          </Math><break class="ltx_centering"/><ERROR class="ltx_centering undefined">\WHILE</ERROR>in <emph class="ltx_centering" font="italic">offline training phase</emph>
<ERROR class="ltx_centering undefined">\STATE</ERROR>% offline policy training using batches from the offline replay buffer <Math class="ltx_centering" mode="inline" tex="\mathcal{D}_{\rm offline}" text="D _ offline" xml:id="S4.SS1.p6.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
              </XMApp>
            </XMath>
          </Math>
<ERROR class="ltx_centering undefined">\STATE</ERROR><Math class="ltx_centering" mode="inline" tex="\phi\leftarrow\phi-\lambda_{Q}\nabla_{\phi}L^{Q}_{\rm offline}(\phi)" text="phi leftarrow phi - lambda _ Q * (nabla _ phi)@((L ^ Q) _ offline) * phi" xml:id="S4.SS1.p6.m8">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">L</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S4.SS1.p6.m8.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S4.SS1.p6.m8.1">ϕ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,  <Math class="ltx_centering" mode="inline" tex="\beta\leftarrow\beta-\lambda_{\pi}\nabla_{\beta}L_{\rm offline}^{\pi_{\beta}}(\beta)" text="beta leftarrow beta - lambda _ pi * (nabla _ beta)@((L _ offline) ^ (pi _ beta)) * beta" xml:id="S4.SS1.p6.m9">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">L</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S4.SS1.p6.m9.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="beta" role="UNKNOWN" xml:id="S4.SS1.p6.m9.1">β</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
<ERROR class="ltx_centering undefined">\ENDWHILE</ERROR><ERROR class="ltx_centering undefined">\STATE</ERROR>Policy Expansion: <Math class="ltx_centering" mode="inline" tex="\tilde{\pi}=[\pi_{\beta},\pi_{\theta}]" text="tilde@(pi) = closed-interval@(pi _ beta, pi _ theta)" xml:id="S4.SS1.p6.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="closed-interval"/>
                    <XMRef idref="S4.SS1.p6.m10.1"/>
                    <XMRef idref="S4.SS1.p6.m10.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S4.SS1.p6.m10.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S4.SS1.p6.m10.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>; transfer <Math class="ltx_centering" mode="inline" tex="Q_{\phi}" text="Q _ phi" xml:id="S4.SS1.p6.m11">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
              </XMApp>
            </XMath>
          </Math>
<ERROR class="ltx_centering undefined">\WHILE</ERROR>in <emph class="ltx_centering" font="italic">online training phase</emph>
<ERROR class="ltx_centering undefined">\FOR</ERROR>each environment step
<ERROR class="ltx_centering undefined">\STATE</ERROR><Math class="ltx_centering" mode="inline" tex="a_{t}\sim\tilde{\pi}(a_{t}|s_{t})" text="a _ t similar-to tilde@(pi) * conditional@(a _ t, s _ t)" xml:id="S4.SS1.p6.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S4.SS1.p6.m12.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS1.p6.m12.1">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> according to (<ref class="ltx_centering" labelref="LABEL:eq:rex_policy"/>),   <Math class="ltx_centering" mode="inline" tex="s_{t+1}\sim T(s_{t+1}|s_{t},a_{t})" text="s _ (t + 1) similar-to T * conditional@(s _ (t + 1), list@(s _ t, a _ t))" xml:id="S4.SS1.p6.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">T</XMTok>
                  <XMDual>
                    <XMRef idref="S4.SS1.p6.m13.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S4.SS1.p6.m13.1">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S4.SS1.p6.m13.1.1"/>
                            <XMRef idref="S4.SS1.p6.m13.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S4.SS1.p6.m13.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="S4.SS1.p6.m13.1.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,   <Math class="ltx_centering" mode="inline" tex="\mathcal{D}\leftarrow\mathcal{D}\cup\{(s_{t},a_{t},r(s_{t},a_{t}),s_{t+1})\}" text="D leftarrow D union set@(vector@(s _ t, a _ t, r * open-interval@(s _ t, a _ t), s _ (t + 1)))" xml:id="S4.SS1.p6.m14">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S4.SS1.p6.m14.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMDual xml:id="S4.SS1.p6.m14.1">
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="S4.SS1.p6.m14.1.1"/>
                          <XMRef idref="S4.SS1.p6.m14.1.2"/>
                          <XMRef idref="S4.SS1.p6.m14.1.3"/>
                          <XMRef idref="S4.SS1.p6.m14.1.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S4.SS1.p6.m14.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S4.SS1.p6.m14.1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S4.SS1.p6.m14.1.3">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="S4.SS1.p6.m14.1.3.1"/>
                                <XMRef idref="S4.SS1.p6.m14.1.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S4.SS1.p6.m14.1.3.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="S4.SS1.p6.m14.1.3.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S4.SS1.p6.m14.1.4">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
<ERROR class="ltx_centering undefined">\ENDFOR</ERROR><ERROR class="ltx_centering undefined">\FOR</ERROR>each gradient step
<ERROR class="ltx_centering undefined">\STATE</ERROR>% online training using batches from both <Math class="ltx_centering" mode="inline" tex="\mathcal{D}_{\rm offline}" text="D _ offline" xml:id="S4.SS1.p6.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math class="ltx_centering" mode="inline" tex="\mathcal{D}" text="D" xml:id="S4.SS1.p6.m16">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>
<ERROR class="ltx_centering undefined">\STATE</ERROR><Math class="ltx_centering" mode="inline" tex="\phi\leftarrow\phi-\lambda_{Q}\nabla_{\phi}L^{Q}_{\rm online}(\phi)" text="phi leftarrow phi - lambda _ Q * (nabla _ phi)@((L ^ Q) _ online) * phi" xml:id="S4.SS1.p6.m17">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">L</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="UNKNOWN">online</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S4.SS1.p6.m17.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S4.SS1.p6.m17.1">ϕ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,  <Math class="ltx_centering" mode="inline" tex="\theta\leftarrow\theta-\lambda_{\pi}\nabla_{\theta}L_{\rm online}^{\pi_{\theta%&#10;}}(\theta)" text="theta leftarrow theta - lambda _ pi * (nabla _ theta)@((L _ online) ^ (pi _ theta)) * theta" xml:id="S4.SS1.p6.m18">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="nabla" role="OPERATOR">∇</XMTok>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">L</XMTok>
                          <XMTok fontsize="70%" role="UNKNOWN">online</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="S4.SS1.p6.m18.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.SS1.p6.m18.1">θ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
<ERROR class="ltx_centering undefined">\ENDFOR</ERROR><ERROR class="ltx_centering undefined">\ENDWHILE</ERROR><!--  %****␣PEX_arxiv.tex␣Line␣375␣**** -->


</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag>Bridged Offline-Online Training with Policy Expansion</title>
      <para xml:id="S4.SS2.p1">
        <p>We focus on value-based RL algorithms for both stages in this work.
For <emph font="italic">offline-training</emph>, we conduct offline RL with an offline RL algorithm (e.g. IQL) on the offline dataset to obtain the offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S4.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math>.
Then we can construct policy expansion following Eqn.(<ref labelref="LABEL:eq:expand"/>) before entering the online phase.
And we also transfer the Q function (critic) learned in the offline stage to online stage for further learning.
We also transfer the offline buffer to online stage as an additional buffer, as shown in Figure <ref labelref="LABEL:fig:training_schemes"/>.</p>
      </para>
      <para xml:id="S4.SS2.p2">
        <p>For <emph font="italic">online training</emph>, we use the policy adaptively composed from the policy set as in Eqn.(<ref labelref="LABEL:eq:rex_policy"/>),
and then conduct online training by interleaving environmental interaction and
gradient update.
The newly collected transitions are stored into the online replay buffer <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S4.SS2.p2.m1">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>.
For training, batches randomly sampled from both <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="S4.SS2.p2.m2">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="\mathcal{D}_{\rm offline}" text="D _ offline" xml:id="S4.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
              </XMApp>
            </XMath>
          </Math>
are used.
The value loss and policy loss are calculated based on the losses corresponding to the chosen algorithm.
The proposed scheme can be used together with different existing RL algorithms.
The complete procedure is summarized in Algorithm <ref labelref="LABEL:alg:algo"/>, taking an offline RL and online RL algorithm as inputs.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Related Work</title>
    <para xml:id="S5.p1">
      <p align="left"><text font="bold">Pre-Training in RL.</text></p>
    </para>
    <para xml:id="S5.p2">
      <p>A number of different directions have been explored in RL pre-training, including representation pre-training and policy pre-training.
Note that for RL, pre-training can be either offline or online.
Representative works include pre-training of the feature representation using standard representation learning methods (e.g. contrastive learning <cite class="ltx_citemacro_citep">(<bibref bibrefs="offlne_rl_pretrain" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>), dynamics learning-based representation learning <cite class="ltx_citemacro_citep">(e.g. <bibref bibrefs="repr_pre_training,APV" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, unsupervised RL driven by intrinsic rewards in reward-free environments <cite class="ltx_citemacro_citep">(e.g. <bibref bibrefs="behavior_from_void" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, or directly using ImageNet pre-training for visual RL tasks <cite class="ltx_citemacro_citep">(e.g. <bibref bibrefs="resnet_pretrain,imagenet_pretrain" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Apart from representation pre-training,
another category of work is on policy pre-training, with the goal of acquiring behaviors
during the pre-training phase that are useful for the online phase.
When the downstream task is unknown, there are approaches for unsupervised pre-training, e.g.,
maximizing behavior diversity <cite class="ltx_citemacro_citep">(<bibref bibrefs="DIAYN" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or converting the action space <cite class="ltx_citemacro_cite"><bibref bibrefs="parrot" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>, with the hope of discovering some behaviors that are useful for the downstream task.
When the offline-online task is more aligned, there are some early attempts on directly transferring policy parameters <cite class="ltx_citemacro_citep">(<bibref bibrefs="DAPG" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, based on the intuition that a policy initialized this way can produce more meaningful behaviors than randomly initialized networks.
Some recent work focuses on behavior transferring, <emph font="italic">i.e.</emph>, leveraging the offline trained policy for exploration during online training <cite class="ltx_citemacro_citep">(<bibref bibrefs="behavior_transfer,jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Our work falls into this latter category of methods. One notable difference compared to <cite class="ltx_citemacro_cite"><bibref bibrefs="behavior_transfer,jump_start_RL" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> is that for the proposed approach, the offline policy is one part of the final policy,
and with its role been determined adaptively.</p>
      <p align="left"><text font="bold">Data-Driven RL and Offline RL.</text></p>
      <p>Training a policy by leveraging a large amount of existing data (<emph font="italic">i.e.</emph><!--  %****␣PEX_arxiv.tex␣Line␣425␣**** --> data-driven RL) is a promising
approach that is valuable to many real-world scenarios, where offline data is abundant.
Offline RL is one active topic towards this direction. The main motivation of
offline RL is to train a policy by leveraging a pre-collected dataset, without requiring additional environmental interactions <cite class="ltx_citemacro_citep">(<bibref bibrefs="offline_rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Many research works in this direction focus on addressing the special challenges brought by offline learning, including out-of-distribution value issue <cite class="ltx_citemacro_citep">(<bibref bibrefs="cql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Common strategies include constraining the value <cite class="ltx_citemacro_citep">(<bibref bibrefs="cql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> to be small for out of distribution actions or the policy to be close to the action distribution of dataset <cite class="ltx_citemacro_citep">(<bibref bibrefs="BCQ,td3bc" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Recently, <cite class="ltx_citemacro_cite"><bibref bibrefs="iql" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> proposes an implicit Q-learning (IQL) method as an alternative way
to handle this issue. It learns a value function that predicts a certain expectile of the values for state-action pairs from the dataset, which can be used for computing the value target
without querying the critic with out-of-distribution actions.</p>
      <p align="left"><text font="bold">Offline Training with Online Fine-tuning.</text></p>
      <p>Combining offline data with online learning is an effective approach that have been demonstrated by several early attempts with demonstration data <cite class="ltx_citemacro_citep">(<bibref bibrefs="use_offline_buffer,dqn_demo,sac_bc,DAPG" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Traditionally, the offline RL methods are purely focused on the offline training setting.
However, the offline learned policy could be limited in performance given a fixed dataset.
In the case when further online interaction is allowed, it would be natural to fine-tune
the policy further with data collected online.
This paradigm of two-stage policy training is related to the iterative interleaved policy and data collection schemes used in imitation learning <cite class="ltx_citemacro_citep">(<bibref bibrefs="dagger,agnoistic_system_id_mbrl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Several different approaches have been explored towards online fine-tuning of a offline pre-trained policy, including balancing offline-online replay data <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, parameter transferring <cite class="ltx_citemacro_citep">(<bibref bibrefs="DAPG,policy_finetuing" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, policy regularization <cite class="ltx_citemacro_citep">(<bibref bibrefs="KL_RL,behavior_prior" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>
and guided exploration <cite class="ltx_citemacro_citep">(<bibref bibrefs="behavior_transfer,jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
It has been observed that directly applying some offline RL methods does not
benefit from online interactions <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC,jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, potentially due to the conservative nature of the offline policy <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Based on this observation, there are some recent efforts on developing algorithms
that are not only suitable for offline training, but also can leverage online interactions for further learning.
<cite class="ltx_citemacro_cite"><bibref bibrefs="AWAC" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> shows that an advantage-weighted form of actor-critic method is suitable for this purpose.
IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite><!--  %****␣PEX_arxiv.tex␣Line␣450␣**** --> also leverages a similar form for policy learning and shows that it can benefit from online fine-tuning.
Our work falls into this category and we provide an alternative approach for leveraging
offline pre-training for helping with online training.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:d4rl_results" placement="t" xml:id="S5.F2">
      <tags>
        <tag>Figure 2</tag>
        <tag role="autoref">Figure 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <picture class="ltx_centering" fill="none" height="243.5pt" stroke="none" tex="\begin{overpic}[width=398.33858pt]{imgs/figure2}&#10;\end{overpic}" width="397.5pt" xml:id="S5.F2.pic1"/>
      <toccaption class="ltx_centering"><tag close=" ">2</tag><text font="bold">Normalized Return Curves</text> of different methods on benchmark tasks from D4RL <cite class="ltx_citemacro_citep">(<bibref bibrefs="d4rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. IQL is used as the backbone apart from the AWAC baseline <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 2</tag><text font="bold">Normalized Return Curves</text> of different methods on benchmark tasks from D4RL <cite class="ltx_citemacro_citep">(<bibref bibrefs="d4rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. IQL is used as the backbone apart from the AWAC baseline <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</caption>
    </figure>
  </section>
  <section inlist="toc" xml:id="S6">
    <tags>
      <tag>6</tag>
      <tag role="autoref">section 6</tag>
      <tag role="refnum">6</tag>
      <tag role="typerefnum">§6</tag>
    </tags>
    <title><tag close=" ">6</tag>Experiments</title>
    <para xml:id="S6.p1">
      <p>In this section, we first evaluate the effectiveness of the proposed approach on various types of benchmark tasks with comparison to a number of baseline methods.
Then we further show a number of extensions where the proposed approach can also be applied.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:offline_to_online" xml:id="S6.SS1">
      <tags>
        <tag>6.1</tag>
        <tag role="autoref">subsection 6.1</tag>
        <tag role="refnum">6.1</tag>
        <tag role="typerefnum">§6.1</tag>
      </tags>
      <title><tag close=" ">6.1</tag>Offline-to-Online RL Experiments</title>
      <para xml:id="S6.SS1.p1">
        <p><text font="bold">Tasks and Settings.</text>
We use the standard D4RL benchmark which has been widely used in offline RL community <cite class="ltx_citemacro_citep">(<bibref bibrefs="d4rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite><!--  %****␣PEX_arxiv.tex␣Line␣475␣**** -->.
For offline learning, we use the provided dataset for training. For online learning, we
use the accompanied simulator for interaction and training.
For offline phase, 1M training steps are used for training.
Then we run online fine-tuning for another 1M environmental steps.
Here we use IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> as the backbone algorithm for all methods listed below.
The training is repeated with 5 different random seeds.</p>
      </para>
      <para xml:id="S6.SS1.p2">
        <p align="left"><text font="bold">Baselines.</text></p>
      </para>
      <para xml:id="S6.SS1.p3">
        <p>We compare the proposed approach with the following baselines:
<emph font="bold italic">(i)</emph> <text font="typewriter bold">Offline</text>: offline training using IQL, without online fine-tuning;
<emph font="bold italic">(ii)</emph> <text font="typewriter bold">Scratch</text>: train IQL online from scratch, without offline-pre-training.
<emph font="bold italic">(iii)</emph> <text font="typewriter bold">Buffer</text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="use_offline_buffer" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>: train IQL online without offline pre-training, but has access to the offline buffer during online training, <emph font="italic">i.e.</emph> using a buffer as <Math mode="inline" tex="\mathcal{D}\cup\mathcal{D}_{\rm offline}" text="D union D _ offline" xml:id="S6.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="union" name="cup" role="ADDOP">∪</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
<emph font="bold italic">(iv)</emph> <text font="typewriter bold">Direct</text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>: a direct offline-to-online approach by directly transferring parameters trained offline to online stage using IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which is a recent and representative RL algorithm that shows state-of-the-art performance on offline RL while allows online fine-tuning;
<emph font="bold italic">(v)</emph> <text font="typewriter bold">AWAC</text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="AWAC" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>: an approach that uses an advantage-weighted form of actor-critic method for offline-to-online RL;
<emph font="bold italic">(vi)</emph> <text font="typewriter bold">Off2On</text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>: a recent offline-to-online RL method that uses an ensemble of offline trained value and policies together with a balanced offline-online replay scheme;
<emph font="bold italic">(vii)</emph> <text font="typewriter bold">BT</text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="behavior_transfer" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>: Behavior Transfer which is an approach that
leverages an offline learned policy in exploration, where the offline policy is used
for exploration for a consecutive number of steps sampled from a distribution once activated;
<emph font="bold italic">(viii)</emph> <text font="typewriter bold">JSRL</text> <cite class="ltx_citemacro_citep">(<bibref bibrefs="jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>: Jump Start RL, which divides the rollout of a trajectory into two parts, using the offline learned policy for the first part and then unrolling with the online learning policy for the rest of trajectory.
<text font="typewriter bold">PEX</text> denotes the proposed approach, which has the same offline and online RL algorithms as <text font="typewriter bold">Direct</text>, and is only different in using <emph font="italic">Policy Expansion</emph> for connecting the two stages. More resources are available on the project page. <note mark="2" role="footnote" xml:id="footnote2"><tags>
              <tag>2</tag>
              <tag role="autoref">footnote 2</tag>
              <tag role="refnum">2</tag>
              <tag role="typerefnum">footnote 2</tag>
            </tags><ref class="ltx_url" font="typewriter" fontsize="70%" href="https://sites.google.com/site/hczhang1/projects/pex">https://sites.google.com/site/hczhang1/projects/pex</ref></note></p>
      </para>
      <figure float="right" inlist="lof" labels="LABEL:fig:curve_agg_iql" xml:id="S6.F3">
        <tags>
          <tag>Figure 3</tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <picture fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[viewport=0.0pt 0.0pt 301.125pt 240.9pt,clip={true},width=113.8%&#10;1102pt]{imgs/curve_agg.pdf}&#10;\put(93.0,8.0){\includegraphics[viewport=306.14374pt 120.45pt 384.43625pt 260.%&#10;97499pt,clip={true},height=79.6678pt,cfbox=black 0.3pt 0.3pt]{imgs/curve_agg.%&#10;pdf}}&#10;\end{overpic}" width="113.5pt" xml:id="S6.F3.pic1"/>
        <toccaption><tag close=" ">3</tag><text font="bold">Aggregated Return Curves</text> across tasks (IQL-based).</toccaption>
        <caption><tag close=": ">Figure 3</tag><text font="bold">Aggregated Return Curves</text> across tasks (IQL-based).</caption>
      </figure>
      <para xml:id="S6.SS1.p4">
        <p>The return curves for all the tasks are shown in Figure <ref labelref="LABEL:fig:d4rl_results"/>.
The aggregated return across all tasks is shown in Figure <ref labelref="LABEL:fig:curve_agg_iql"/>.
The returns are first averaged across task and then across runs.
It can be observed that all methods show some improvements after online training in general, compared to the initial performance before online training.
<text font="typewriter bold">Scratch</text> has the lowest overall performance across all tasks.
On the challenging sparse reward antmaze tasks, <text font="typewriter bold">Scratch</text> cannot learn a meaningful policy at all.
<text font="typewriter bold">Buffer</text> has better performance than <text font="typewriter bold">Scratch</text> when incorporating the offline buffer, indicating
that the offline buffer has some benefits in helping with learning.
Notably, on the previously zero-performance antmaze tasks, <text font="typewriter bold">Buffer</text> achieves reasonable performance
with the help of the offline buffer, leading to a large overall improvement over <text font="typewriter bold">Scratch</text>, (<emph font="italic">c.f.</emph> Figure <ref labelref="LABEL:fig:curve_agg_iql"/>).
<text font="typewriter bold">Direct</text> (IQL-based) shows large improvements over <text font="typewriter bold">Offline</text> on average as shown in Figure <ref labelref="LABEL:fig:curve_agg_iql"/>, implying the benefits brought by the the additional online training over pure offline training.
<text font="typewriter bold">Off2On</text> also shows large improvement during fine-tuning and achieves strong overall performance (Figure <ref labelref="LABEL:fig:curve_agg_iql"/>).
<text font="typewriter bold">BT</text> shows some improvements over <text font="typewriter bold">IQL</text> on some tasks such as <text font="typewriter" fontsize="80%">antmaze-medium-play</text> and <text font="typewriter" fontsize="80%">antmaze-large-diverse</text>, with an overall performance comparable to that of <text font="typewriter bold">Direct</text>.
<text font="typewriter bold">JSRL</text> outperforms <text font="typewriter bold">Direct</text> and <text font="typewriter bold">BT</text> on some tasks (e.g. <text font="typewriter" fontsize="80%">hopper-medium</text>, <text font="typewriter" fontsize="80%">hopper-medium-replay</text>), potentially due to its different way of leveraging
the offline policy, and its overall performance is similar to <text font="typewriter bold">BT</text>.
The proposed <text font="typewriter bold">PEX</text> approach performs comparably to other baselines on some tasks while outperforming all baseline methods on most of the other tasks (<emph font="italic">c.f.</emph> Figure <ref labelref="LABEL:fig:d4rl_results"/>), and outperforms baselines methods overall (<emph font="italic">c.f.</emph> Figure <ref labelref="LABEL:fig:curve_agg_iql"/><!--  %****␣PEX_arxiv.tex␣Line␣525␣**** -->),
demonstrating its effectiveness.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S6.SS2">
      <tags>
        <tag>6.2</tag>
        <tag role="autoref">subsection 6.2</tag>
        <tag role="refnum">6.2</tag>
        <tag role="typerefnum">§6.2</tag>
      </tags>
      <title><tag close=" ">6.2</tag>Heterogeneous Offline-Online RL Bridging via Policy-Expansion</title>
      <figure float="right" inlist="lof" labels="LABEL:fig:curve_agg_sac" xml:id="S6.F4">
        <tags>
          <tag>Figure 4</tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <picture fill="none" height="114.9pt" stroke="none" tex="\begin{overpic}[viewport=0.0pt 0.0pt 301.125pt 271.0125pt,clip={true},width=12%&#10;8.0374pt]{imgs/curve_agg_sac_w_iql.pdf}&#10;\put(58.0,13.0){\includegraphics[viewport=301.125pt 125.46873pt 386.44374pt 24%&#10;0.9pt,clip={true},width=36.98866pt,cfbox=black 0.3pt 0.3pt]{imgs/curve_agg_sac%&#10;_w_iql.pdf}}&#10;\end{overpic}" width="127.9pt" xml:id="S6.F4.pic1"/>
        <toccaption><tag close=" ">4</tag><text font="bold">Aggregated Return Curves</text> across benchmark tasks (SAC-based).</toccaption>
        <caption><tag close=": ">Figure 4</tag><text font="bold">Aggregated Return Curves</text> across benchmark tasks (SAC-based).</caption>
      </figure>
      <para xml:id="S6.SS2.p1">
        <p>We have shown the application of <text font="typewriter bold">PEX</text> to the case where both the offline and online algorithms are the same (referred to as <text font="typewriter bold">PEX-IQL</text> here since both are IQL) in Section <ref labelref="LABEL:sec:offline_to_online"/><!--  %****␣PEX_arxiv.tex␣Line␣550␣**** -->.
In this section, we further show the applicability of the proposed scheme in
bridging heterogeneous RL algorithms, <emph font="italic">i.e.</emph> different RL methods are used for the offline and online stages.
As an example, here we use IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> for offline and online RL stages respectively.
We compare with <text font="typewriter bold">Scratch</text> (vanilla SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>), <text font="typewriter bold">Buffer</text> (SAC with additional offline replay buffer)
as well as <text font="typewriter bold">Direct</text> (directly transferring policy and critic parameters learned with offline IQL to SAC for further online learning).
Again <text font="typewriter bold">PEX</text> uses the same offline and online algorithms as in <text font="typewriter bold">Direct</text> but uses policy expansion instead of the direct transferring approach.
The normalized return curves aggregated across tasks are shown in Figure <ref labelref="LABEL:fig:curve_agg_sac"/>.
Individual return curves are shown in Appendix <ref labelref="LABEL:app:heterogeneous_results"/>.
It can be observed that there is an overall improvement by simply applying <text font="typewriter bold">PEX</text> to the heterogeneous offline-online RL setting as well.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:ablations" xml:id="S6.SS3">
      <tags>
        <tag>6.3</tag>
        <tag role="autoref">subsection 6.3</tag>
        <tag role="refnum">6.3</tag>
        <tag role="typerefnum">§6.3</tag>
      </tags>
      <title><tag close=" ">6.3</tag>Ablation Studies</title>
      <para xml:id="S6.SS3.p1">
        <p>We will inspect the impact of several factors on the performance of the proposed method in the sequel.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:ablation" placement="h" xml:id="S6.F5">
        <tags>
          <tag>Figure 5</tag>
          <tag role="autoref">Figure 5</tag>
          <tag role="refnum">5</tag>
          <tag role="typerefnum">Figure 5</tag>
        </tags>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[height=91.04872pt]{imgs/curve_ablation_exp_no_offline_buffer_%&#10;agg.pdf}&#10;\put(35.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{Offline %&#10;Buffer}}}}}&#10;\put(5.0,0.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{(a)}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="S6.F5.pic1"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[height=91.04872pt]{imgs/curve_ablation_exp_critic_warmup_agg.%&#10;pdf}&#10;\put(32.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{Critic %&#10;Transfer}}}}}&#10;\put(5.0,0.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{(b)}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="S6.F5.pic2"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[height=91.04872pt]{imgs/curve_ablation_exp_critic_transfer_agg%&#10;.pdf}&#10;\put(31.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{Policy %&#10;Transfer}}}}}&#10;\put(5.0,0.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{(c)}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="S6.F5.pic3"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[height=91.04872pt]{imgs/curve_ablation_exp_offline_policy_%&#10;freeze_agg.pdf}&#10;\put(23.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{Offline %&#10;Policy Freeze}}}}}&#10;\put(5.0,0.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{(d)}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="S6.F5.pic4"/>
        <toccaption class="ltx_centering"><tag close=" ">5</tag><text font="bold">Ablation Results</text> on a number of factors. Orange curves correspond to ablation variants.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 5</tag><text font="bold">Ablation Results</text> on a number of factors. Orange curves correspond to ablation variants.</caption>
      </figure>
      <para xml:id="S6.SS3.p2">
        <p align="left"><text font="bold">Offline-Buffer.</text></p>
      </para>
      <para xml:id="S6.SS3.p3">
        <p>This experiment investigates the impacts of including the
offline replay buffer in online training stage. The results are shown in Figure <ref labelref="LABEL:fig:ablation"/>(a).
As can be observed, the inclusion of the offline replay buffer helps with the performance, but the performance drop
caused by disabling offline replay buffer is smaller than the change of other algorithmic components (<emph font="italic">c.f.</emph> Figure <ref labelref="LABEL:fig:ablation"/>(b)<Math mode="inline" tex="\sim" text="similar-to" xml:id="S6.SS3.p3.m1">
            <XMath>
              <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
            </XMath>
          </Math><!--  %****␣PEX_arxiv.tex␣Line␣600␣**** -->(d)).</p>
        <p align="left"><text font="bold">Critic Transfer.</text></p>
        <p>This experiment studies the impacts of transferring the critic parameters trained
from offline to online stage. As can be observed from Figure <ref labelref="LABEL:fig:ablation"/>(b), disabling
critic transferring will also greatly decrease the performance both in terms of sample efficiency as well as final
performance.</p>
        <p align="left"><text font="bold">Policy Transfer.</text></p>
        <p>This experiment examines the impacts of transferring the offline pre-trained policy in the online training stage.
When policy transferring is disabled, there is no need to use policy expansion in the online training stage.
The results are shown in Figure <ref labelref="LABEL:fig:ablation"/>(c).
It can be observed that there is a clear performance drop when policy transferring is disabled.</p>
        <p align="left"><text font="bold">Offline Policy Freeze.</text></p>
        <p>The offline learned <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S6.SS3.p3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> is freezed during the online learning stage in <text font="typewriter bold">PEX</text>. This experiment investigates the impact of this factor.
If disabled, <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S6.SS3.p3.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> will be trained in the same way as <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S6.SS3.p3.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> during online learning. It is observed from Figure <ref labelref="LABEL:fig:ablation"/>(d) that freezing the offline policy is important. Training by disabling policy freezing has a clear performance drop. This is consistent with the intuition on the usefulness of offline policy preservation, which is one advantage of our approach.
Another set of ablation results are deferred to Appendix <ref labelref="LABEL:app:addtional_ablations"/>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:fig:tsne_d4rl" xml:id="S6.SS4">
      <tags>
        <tag>6.4</tag>
        <tag role="autoref">subsection 6.4</tag>
        <tag role="refnum">6.4</tag>
        <tag role="typerefnum">§6.4</tag>
      </tags>
      <title><tag close=" ">6.4</tag>Visualization and Analysis</title>
      <para xml:id="S6.SS4.p1">
        <p><text font="bold">Policy Composition Probability.</text>
Since a composite policy is involved in the proposed approach, it is interesting to
inspect the participation of each member policy from the policy set <Math mode="inline" tex="\Pi\!=\!\{\pi_{\beta},\pi_{\theta}\}" text="Pi = set@(pi _ beta, pi _ theta)" xml:id="S6.SS4.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP" rpadding="-1.7pt">=</XMTok>
                <XMTok name="Pi" role="UNKNOWN" rpadding="-1.7pt">Π</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S6.SS4.p1.m1.1"/>
                    <XMRef idref="S6.SS4.p1.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S6.SS4.p1.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S6.SS4.p1.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math><!--  %****␣PEX_arxiv.tex␣Line␣625␣**** --> when interacting with the
environment.
We visualize the policy compositional probability <Math mode="inline" tex="P_{{\mathbf{w}}}" text="P _ w" xml:id="S6.SS4.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
              </XMApp>
            </XMath>
          </Math> during the rollout within a trajectory after training, as shown in Figure <ref labelref="LABEL:fig:viz_composition_traj"/>.
It can be observed that composition probability for each member policy is state-adaptive
and is changing along the progress of a trajectory, implying that both policies contribute to the final policy in an adaptive manner.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:viz_composition_traj" placement="h" xml:id="S6.F6">
        <tags>
          <tag>Figure 6</tag>
          <tag role="autoref">Figure 6</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Figure 6</tag>
        </tags>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="96.8pt" stroke="none" tex="\begin{overpic}[width=184.9429pt]{imgs/antmaze_umaze_diverse.png}&#10;\put(30.0,52.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{antmaze-%&#10;umaze-diverse}}}}}&#10;\put(-5.0,17.5){{\color[rgb]{0,0,0}\rotatebox{0.0}{\scalebox{0.8}{$P_{{\mathbf%&#10;{w}}}$}}}}&#10;\put(18.0,11.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{$\pi_{\beta}$}}}}&#10;\put(18.0,7.5){{\color[rgb]{0,0,0}{\scalebox{0.7}{$\pi_{\theta}$}}}}&#10;\put(10.0,7.0){\includegraphics[height=9.95863pt]{imgs/policy_usage_legend.png%&#10;}}&#10;\put(37.0,-2.5){{\color[rgb]{0,0,0}{\scalebox{0.7}{Environment Step}}}}&#10;\put(-1.0,-1.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{(a)}}}}}&#10;\end{overpic}" width="184.3pt" xml:id="S6.F6.pic1"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="95.4pt" stroke="none" tex="\begin{overpic}[width=184.9429pt]{imgs/antmaze_medium_diverse.png}&#10;\put(27.0,52.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{antmaze-%&#10;medium-diverse}}}}}&#10;\put(-5.0,17.5){{\color[rgb]{0,0,0}\rotatebox{0.0}{\scalebox{0.8}{$P_{{\mathbf%&#10;{w}}}$}}}}&#10;\put(18.0,11.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{$\pi_{\beta}$}}}}&#10;\put(18.0,7.5){{\color[rgb]{0,0,0}{\scalebox{0.7}{$\pi_{\theta}$}}}}&#10;\put(10.0,7.0){\includegraphics[height=9.95863pt]{imgs/policy_usage_legend.png%&#10;}}&#10;\put(37.0,-2.5){{\color[rgb]{0,0,0}{\scalebox{0.7}{Environment Step}}}}&#10;\put(-1.0,-1.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{\rotatebox{0.0}{(b)}}}}}&#10;\end{overpic}" width="184.3pt" xml:id="S6.F6.pic2"/>
        <toccaption class="ltx_centering"><tag close=" ">6</tag><text font="bold">Visualization of Policy Composition Probability</text> during the rollout of one trajectory.
The probability curves are smoothed for visualization purpose.
</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 6</tag><text font="bold">Visualization of Policy Composition Probability</text> during the rollout of one trajectory.
The probability curves are smoothed for visualization purpose.
</caption>
      </figure>
      <figure float="right" xml:id="S6.SS4.fig1">
        <picture fill="none" height="85.3pt" stroke="none" tex="\begin{overpic}[height=85.35826pt]{imgs/tsne_medium_diverse_4.png}&#10;\put(25.0,17.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{$\pi_{\beta}$}}}}&#10;\put(25.0,10.0){{\color[rgb]{0,0,0}{\scalebox{0.7}{$\pi_{\theta}$}}}}&#10;\put(15.0,10.0){\includegraphics[viewport=0.0pt 0.0pt 40.15pt 80.29999pt,clip=%&#10;{true},height=9.95863pt]{imgs/policy_usage_legend.png}}&#10;\end{overpic}" width="88.2pt" xml:id="S6.SS4.pic1"/>
      </figure>
      <para xml:id="S6.SS4.p2">
        <p><text font="bold">State Space Associations of Member Policies.</text><!--  %****␣PEX_arxiv.tex␣Line␣675␣**** -->
To get a better understand of the role of the member policies in the policy set, we visualize the association between
the states and its selected policy.
For this purpose, we embed a set of states into a 2D space using t-SNE <cite class="ltx_citemacro_citep">(<bibref bibrefs="tsne" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
and then visualize the association of offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S6.SS4.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and the newly expanded policy <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S6.SS4.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> to states in the projected space. States that select the offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="S6.SS4.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> are colored with blue and states that select <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S6.SS4.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> are colored with red.
It can be observed that <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S6.SS4.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S6.SS4.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> cover different parts of the state space, indicating that
they have some complementary functionalities and are preferred differently at different states.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S7">
    <tags>
      <tag>7</tag>
      <tag role="autoref">section 7</tag>
      <tag role="refnum">7</tag>
      <tag role="typerefnum">§7</tag>
    </tags>
    <title><tag close=" ">7</tag>Conclusions, Limitations and Future Work</title>
    <para xml:id="S7.p1">
      <p>We highlight the usefulness of properly connecting offline and online stages of reinforcement learning to gain the benefits of both worlds
and present a policy expansion scheme as an attempt toward this direction. This scheme is an instance in the direction orthogonal to developing completely new offline-to-online RL algorithms.
The proposed approach is simple and can be combined with existing RL algorithms, and is illustrated with two different
combinations in this work.
Experiments demonstrate the effectiveness of the proposed approach on a number of benchmark tasks.</p>
    </para>
    <para xml:id="S7.p2">
      <p>While achieving promising performance, the proposed approach also has some limitations.
One limitation is that the number of parameters grows with the number of policies in the policy set.
While this might not be an issue when the policy set is small as the case in this work, it will
be less parameter efficient in the presence of a large policy set.
One possible way to address this issue is by introducing a distillation stage <cite class="ltx_citemacro_citep">(<bibref bibrefs="policy_distillation" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, by
consolidating the multiple policies into a network with a smaller number of parameters.
Generalizing the proposed scheme to the case with a set of pre-trained skill policies is an interesting direction <cite class="ltx_citemacro_citep">(<bibref bibrefs="DIAYN,MTRL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite><!--  %****␣PEX_arxiv.tex␣Line␣700␣**** -->.
For offline learning, we have built upon the strong IQL method.
It would be interesting to see how much we can gain by upgrading it with more recently developed offline RL methods together with different online methods.
The idea of using a policy set itself can potentially be applied to other cases beyond offline to online RL. We leave the exploration of its generalization and application as an interesting future work.</p>
    </para>
    <pagination role="newpage"/>
  </section>
  <bibliography citestyle="authoryear" files="PEX" xml:id="bib">
    <title>References</title>
  </bibliography>
  <appendix inlist="toc" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Appendix</title>
    <toctitle><tag close=" ">A</tag>Appendix</toctitle>
    <subsection inlist="toc" xml:id="A1.SS1">
      <tags>
        <tag>A.1</tag>
        <tag role="autoref">subsection A.1</tag>
        <tag role="refnum">A.1</tag>
        <tag role="typerefnum">§A.1</tag>
      </tags>
      <title><tag close=" ">A.1</tag>Details on Baselines</title>
      <para xml:id="A1.SS1.p1">
        <p>In this section, we provide more details on the baseline methods.</p>
      </para>
      <para xml:id="A1.SS1.p2">
        <p align="left"><text font="bold">Behavior Transfer (<text font="typewriter">BT</text>).</text></p>
      </para>
      <para xml:id="A1.SS1.p3">
        <p><!--  %****␣PEX_arxiv.tex␣Line␣725␣**** -->This approach is originally proposed for the case of pre-training using unsupervised
reinforcement learning and then transfers the learned behaviors for later learning.
It is also originally used in discrete action cases. Here we adapt this idea to build a
baseline in our setting based on the approach of transferring behaviors in <cite class="ltx_citemacro_citep">(<bibref bibrefs="behavior_transfer" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
Following <cite class="ltx_citemacro_citep">(<bibref bibrefs="behavior_transfer" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, a Zeta distribution with parameter <Math mode="inline" tex="a=2" text="a = 2" xml:id="A1.SS1.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> is used for determining the number of steps of
persistent unroll using the offline policy.
The number of persistent unroll steps is re-sampled when currently not in the middle of a persistent unroll and with a random number sampled from <Math mode="inline" tex="[0,1]" text="closed-interval@(0, 1)" xml:id="A1.SS1.p3.m2">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="A1.SS1.p3.m2.1"/>
                  <XMRef idref="A1.SS1.p3.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="A1.SS1.p3.m2.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="A1.SS1.p3.m2.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is smaller than a threshold <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="A1.SS1.p3.m3">
            <XMath>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
            </XMath>
          </Math>. <Math mode="inline" tex="\epsilon=0.1" text="epsilon = 0.1" xml:id="A1.SS1.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                <XMTok meaning="0.1" role="NUMBER">0.1</XMTok>
              </XMApp>
            </XMath>
          </Math> is used in experiments.</p>
      </para>
      <para xml:id="A1.SS1.p4">
        <p align="left"><text font="bold">Jump Start RL (<text font="typewriter">JSRL</text>).</text></p>
      </para>
      <para xml:id="A1.SS1.p5">
        <p><text font="typewriter bold">JSRL</text> divides the complete unroll of one trajectory into two parts, with the first part
obtained with the offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS1.p5.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math>, while the second part is obtained with the
current learning policy <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS1.p5.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math>. The core idea of <text font="typewriter bold">JSRL</text> is to initially
make the first part longer, and then progressively reducing the length of the first part,
thus forming a type of curriculum to help with exploration and learning.
We follow this core idea by using
a linear scheduler that anneals from the max episode length to 0 for
progressively decreasing the first stage of unroll using the prior policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS1.p5.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS1.p6">
        <p align="left"><text font="bold">Offline-to-Online RL (<text font="typewriter">Off2On</text>).</text></p>
      </para>
      <para xml:id="A1.SS1.p7">
        <p><text font="typewriter bold">Off2On</text> is an approach that aims to improve offline to online RL performance <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
It incorporates two components to cope with the challenges of offline-to-online RL:
1) an ensemble of critic networks and policy networks are trained during offline training stage, in contrast to typical offline RL, which only learns one policy network and critic network. <note mark="3" role="footnote" xml:id="footnote3"><tags>
              <tag>3</tag>
              <tag role="autoref">footnote 3</tag>
              <tag role="refnum">3</tag>
              <tag role="typerefnum">footnote 3</tag>
            </tags>Here we refer the commonly used double critic replica to reduce value overestimation as in SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> and TD3 <cite class="ltx_citemacro_citep">(<bibref bibrefs="TD3" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
                <bibrefphrase>, </bibrefphrase>
              </bibref>)</cite> as a single critic network. The ensemble used in <cite class="ltx_citemacro_cite"><bibref bibrefs="balanced_replay" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                <bibrefphrase>(</bibrefphrase>
                <bibrefphrase>)</bibrefphrase>
              </bibref></cite> is applied on top of this.</note>
Following the setting in <cite class="ltx_citemacro_cite"><bibref bibrefs="balanced_replay" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, ensemble size of <Math mode="inline" tex="5" text="5" xml:id="A1.SS1.p7.m1">
            <XMath>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMath>
          </Math><!--  %****␣PEX_arxiv.tex␣Line␣750␣**** --> is used.
2) balanced replay: a balanced offline-online replay scheme to properly trade off between the usage of offline and online samples.
We used the code released by the authors of <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. <note mark="4" role="footnote" xml:id="footnote4"><tags>
              <tag>4</tag>
              <tag role="autoref">footnote 4</tag>
              <tag role="refnum">4</tag>
              <tag role="typerefnum">footnote 4</tag>
            </tags><ref class="ltx_url" font="typewriter" fontsize="70%" href="https://github.com/shlee94/Off2OnRL">https://github.com/shlee94/Off2OnRL</ref></note></p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS2">
      <tags>
        <tag>A.2</tag>
        <tag role="autoref">subsection A.2</tag>
        <tag role="refnum">A.2</tag>
        <tag role="typerefnum">§A.2</tag>
      </tags>
      <title><tag close=" ">A.2</tag>Implementation Details on Policy Expansion</title>
      <para xml:id="A1.SS2.p1">
        <p align="left"><text font="bold">Policy Expansion</text> (<text font="typewriter bold">PEX</text> with IQL-backbone).</p>
      </para>
      <para xml:id="A1.SS2.p2">
        <p>The proposed scheme can be combined with many different existing RL methods.
Here we illustrate with an concrete instantiation using IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
For pre-training, we conduct offline RL with IQL on the offline dataset to obtain the offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math>.
Then we conduct policy expansion as Eqn.(<ref labelref="LABEL:eq:rex_policy"/>) before switching to online phase.</p>
      </para>
      <para xml:id="A1.SS2.p3">
        <p>For <emph font="italic">offline training</emph>, we follow IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> to train the parameters of the value function using the TD-learning approach as follows:</p>
        <equation labels="LABEL:eq:Q_rex" xml:id="A1.E7">
          <tags>
            <tag>(7)</tag>
            <tag role="autoref">Equation 7</tag>
            <tag role="refnum">7</tag>
          </tags>
          <Math mode="display" tex="L_{Q}(\phi)=\mathbb{E}_{(s,a,r,s^{\prime})\sim\mathcal{D}_{\rm offline}}\|Q_{%&#10;\phi}(s,a)-(r+\gamma V(s^{\prime}))\|^{2}" text="L _ Q * phi = E _ (vector@(s, a, r, s ^ prime) similar-to D _ offline) * (norm@(Q _ phi * open-interval@(s, a) - (r + gamma * V * s ^ prime))) ^ 2" xml:id="A1.E7.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.E7.m1.5"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="A1.E7.m1.5">ϕ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="vector"/>
                          <XMRef idref="A1.E7.m1.1"/>
                          <XMRef idref="A1.E7.m1.2"/>
                          <XMRef idref="A1.E7.m1.3"/>
                          <XMRef idref="A1.E7.m1.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E7.m1.1">s</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E7.m1.2">a</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E7.m1.3">r</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.E7.m1.4">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                            <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                        <XMTok fontsize="50%" role="UNKNOWN">offline</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="norm"/>
                        <XMRef idref="A1.E7.m1.8"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok name="||" role="OPEN">‖</XMTok>
                        <XMApp xml:id="A1.E7.m1.8">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                              <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.E7.m1.6"/>
                                <XMRef idref="A1.E7.m1.7"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E7.m1.6">s</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E7.m1.7">a</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.E7.m1.8.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.E7.m1.8.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                  <XMDual>
                                    <XMRef idref="A1.E7.m1.8.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.E7.m1.8.1.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMTok name="||" role="CLOSE">‖</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <equation labels="LABEL:eq:V_rex" xml:id="A1.E8">
          <tags>
            <tag>(8)</tag>
            <tag role="autoref">Equation 8</tag>
            <tag role="refnum">8</tag>
          </tags>
          <Math mode="display" tex="L_{V}(\psi)=\mathbb{E}_{(s,a)\sim\mathcal{D}_{\rm offline}}L_{2}^{\tau}[Q_{%&#10;\bar{\phi}}(s,a)-V_{\psi}(s)]" text="L _ V * psi = E _ (open-interval@(s, a) similar-to D _ offline) * (L _ 2) ^ tau * delimited-[]@(Q _ (bar@(phi)) * open-interval@(s, a) - V _ psi * s)" xml:id="A1.E8.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">L</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">V</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.E8.m1.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" name="psi" role="UNKNOWN" xml:id="A1.E8.m1.3">ψ</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.E8.m1.1"/>
                          <XMRef idref="A1.E8.m1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E8.m1.1">s</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E8.m1.2">a</XMTok>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                        <XMTok fontsize="50%" role="UNKNOWN">offline</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="delimited-[]"/>
                      <XMRef idref="A1.E8.m1.7"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMApp xml:id="A1.E8.m1.7">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                              <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.E8.m1.4"/>
                              <XMRef idref="A1.E8.m1.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E8.m1.4">s</XMTok>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E8.m1.5">a</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">V</XMTok>
                            <XMTok font="italic" fontsize="70%" name="psi" role="UNKNOWN">ψ</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.E8.m1.6"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E8.m1.6">s</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p><!--  %****␣PEX_arxiv.tex␣Line␣775␣**** -->where <Math mode="inline" tex="L_{2}^{\tau}(u)=|\tau-\mathbbm{1}(u&lt;0)|u^{2}" text="(L _ 2) ^ tau * u = absolute-value@(tau - 1 * (u &lt; 0)) * u ^ 2" xml:id="A1.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" name="tau" role="UNKNOWN">τ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.SS2.p3.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p3.m1.1">u</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="absolute-value"/>
                      <XMRef idref="A1.SS2.p3.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">|</XMTok>
                      <XMApp xml:id="A1.SS2.p3.m1.2">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="blackboard" meaning="1" role="NUMBER">1</XMTok>
                          <XMDual>
                            <XMRef idref="A1.SS2.p3.m1.2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.SS2.p3.m1.2.1">
                                <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                                <XMTok font="italic" role="UNKNOWN">u</XMTok>
                                <XMTok meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">|</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">u</XMTok>
                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, with <Math mode="inline" tex="\tau" text="tau" xml:id="A1.SS2.p3.m2">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math> denotes the expectile value <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.
<Math mode="inline" tex="\bar{\phi}" text="bar@(phi)" xml:id="A1.SS2.p3.m3">
            <XMath>
              <XMApp>
                <XMTok name="bar" role="OVERACCENT" stretchy="false">¯</XMTok>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
              </XMApp>
            </XMath>
          </Math> denotes a set of target parameters that are periodically copied from <Math mode="inline" tex="{\phi}" text="phi" xml:id="A1.SS2.p3.m4">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math>.
The policy network <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS2.p3.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> can be further updated by leveraging the updated critic network.
Here we again follow IQL <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and use the weighted form for actor training:</p>
        <equation labels="LABEL:eq:pi_rex" xml:id="A1.E9">
          <tags>
            <tag>(9)</tag>
            <tag role="autoref">Equation 9</tag>
            <tag role="refnum">9</tag>
          </tags>
          <Math mode="display" tex="L_{\pi}(\beta)=\mathbb{E}_{(s,a)\sim\mathcal{D}_{\rm offline}}-\lfloor w(s,a)%&#10;\rfloor\cdot\log\pi_{\beta}(a|s)," text="L _ pi * beta = E _ (open-interval@(s, a) similar-to D _ offline) - (floor@(w * open-interval@(s, a)) cdot logarithm@(pi _ beta)) * conditional@(a, s)" xml:id="A1.E9.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.E9.m1.6"/>
                <XMWrap>
                  <XMApp xml:id="A1.E9.m1.6">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                        <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A1.E9.m1.3"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="beta" role="UNKNOWN" xml:id="A1.E9.m1.3">β</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="open-interval"/>
                              <XMRef idref="A1.E9.m1.1"/>
                              <XMRef idref="A1.E9.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E9.m1.1">s</XMTok>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E9.m1.2">a</XMTok>
                              <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                            <XMTok fontsize="50%" role="UNKNOWN">offline</XMTok>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="floor"/>
                              <XMRef idref="A1.E9.m1.6.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                              <XMApp xml:id="A1.E9.m1.6.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.E9.m1.4"/>
                                    <XMRef idref="A1.E9.m1.5"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E9.m1.4">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E9.m1.5">a</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E9.m1.6.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E9.m1.6.2">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>with <Math mode="inline" tex="w(s,a)=\exp((Q(s,a)-V(s))/\alpha)" text="w * open-interval@(s, a) = exponential@((Q * open-interval@(s, a) - V * s) / alpha)" xml:id="A1.SS2.p3.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">w</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS2.p3.m6.1"/>
                      <XMRef idref="A1.SS2.p3.m6.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p3.m6.1">s</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p3.m6.2">a</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMRef idref="A1.SS2.p3.m6.6"/>
                    <XMRef idref="A1.SS2.p3.m6.7"/>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.SS2.p3.m6.6">exp</XMTok>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS2.p3.m6.7">
                        <XMTok meaning="divide" role="MULOP">/</XMTok>
                        <XMDual>
                          <XMRef idref="A1.SS2.p3.m6.7.1"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.SS2.p3.m6.7.1">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.SS2.p3.m6.3"/>
                                    <XMRef idref="A1.SS2.p3.m6.4"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p3.m6.3">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p3.m6.4">a</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">V</XMTok>
                                <XMDual>
                                  <XMRef idref="A1.SS2.p3.m6.5"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p3.m6.5">s</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMApp>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\lfloor\cdot\rfloor" text="floor@(cdot)" xml:id="A1.SS2.p3.m7">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="floor"/>
                  <XMRef idref="A1.SS2.p3.m7.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                  <XMTok name="cdot" role="MULOP" xml:id="A1.SS2.p3.m7.1">⋅</XMTok>
                  <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> denotes the gradient stopping operator.</p>
      </para>
      <para xml:id="A1.SS2.p4">
        <p>For <emph font="italic">online training</emph>, we first expand the policy set as in Eqn.(<ref labelref="LABEL:eq:expand"/>),
and then conduct online training by interleaving environmental interaction and
gradient update.
The newly collected transitions are saved into replay buffer <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="A1.SS2.p4.m1">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math>.
For training, batches randomly sampled from both <Math mode="inline" tex="\mathcal{D}" text="D" xml:id="A1.SS2.p4.m2">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="\mathcal{D}_{\rm offline}" text="D _ offline" xml:id="A1.SS2.p4.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">D</XMTok>
                <XMTok fontsize="70%" role="UNKNOWN">offline</XMTok>
              </XMApp>
            </XMath>
          </Math>
are used. The values losses are the same as the offline phase, and the policy loss is computed against <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS2.p4.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math>:</p>
        <equation labels="LABEL:eq:pi_rex_online" xml:id="A1.E10">
          <tags>
            <tag>(10)</tag>
            <tag role="autoref">Equation 10</tag>
            <tag role="refnum">10</tag>
          </tags>
          <Math mode="display" tex="L_{\pi}(\theta)=\mathbb{E}_{s\sim\mathcal{D}_{\rm offline}\cup\mathcal{D},a%&#10;\sim\tilde{\pi}(s)}-\lfloor w(s,a)\rfloor\cdot\log\pi_{\theta}(a|s)," text="L _ pi * theta = E _ (formulae@(s similar-to D _ offline union D, a similar-to tilde@(pi) * s)) - (floor@(w * open-interval@(s, a)) cdot logarithm@(pi _ theta)) * conditional@(a, s)" xml:id="A1.E10.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.E10.m1.7"/>
                <XMWrap>
                  <XMApp xml:id="A1.E10.m1.7">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">L</XMTok>
                        <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A1.E10.m1.4"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A1.E10.m1.4">θ</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="A1.E10.m1.2"/>
                            <XMRef idref="A1.E10.m1.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A1.E10.m1.2">
                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="union" name="cup" role="ADDOP">∪</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                                  <XMTok fontsize="50%" role="UNKNOWN">offline</XMTok>
                                </XMApp>
                                <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.E10.m1.3">
                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok fontsize="70%" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.E10.m1.1"/>
                                  <XMWrap>
                                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.E10.m1.1">s</XMTok>
                                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok name="cdot" role="MULOP">⋅</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="floor"/>
                              <XMRef idref="A1.E10.m1.7.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                              <XMApp xml:id="A1.E10.m1.7.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.E10.m1.5"/>
                                    <XMRef idref="A1.E10.m1.6"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E10.m1.5">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E10.m1.6">a</XMTok>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E10.m1.7.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E10.m1.7.2">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="A1.SS2.p5">
        <p>For <Math mode="inline" tex="a_{0}\sim\pi_{\beta}(s_{t})" text="a _ 0 similar-to pi _ beta * s _ t" xml:id="A1.SS2.p5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.SS2.p5.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.SS2.p5.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, in practice, we simply take the greedy action from the policy.
Following <cite class="ltx_citemacro_cite"><bibref bibrefs="iql" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, we model the policy using a non-squashed Gaussian distribution with mean squashed to action range, and use state independent standard deviations.</p>
      </para>
      <para xml:id="A1.SS2.p6">
        <p align="left"><text font="bold">Policy Expansion</text> (<text font="typewriter bold">PEX</text> with with SAC as online backbone)</p>
      </para>
      <para xml:id="A1.SS2.p7">
        <p><!--  %****␣PEX_arxiv.tex␣Line␣800␣**** -->.
The main procedure of online training is the same as SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
with an adaptation for the actor training by changing the part of the loss based on Q-function from <Math mode="inline" tex="\mathbb{E}_{s\sim\mathcal{D}}\mathbb{E}_{a\sim\pi_{\theta}}\left\|\lfloor\frac%&#10;{\partial Q(s,a)}{\partial a}+a\rfloor-a\right\|^{2}" text="E _ (s similar-to D) * E _ (a similar-to pi _ theta) * (norm@(floor@(partial-differential@(Q * open-interval@(s, a)) / partial-differential@(a) + a) - a)) ^ 2" xml:id="A1.SS2.p7.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                    <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="norm"/>
                      <XMRef idref="A1.SS2.p7.m1.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">‖</XMTok>
                      <XMApp xml:id="A1.SS2.p7.m1.3">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="floor"/>
                            <XMRef idref="A1.SS2.p7.m1.3.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                            <XMApp xml:id="A1.SS2.p7.m1.3.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.SS2.p7.m1.1"/>
                                        <XMRef idref="A1.SS2.p7.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS2.p7.m1.1">s</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS2.p7.m1.2">a</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            </XMApp>
                            <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> (which is an equivalent form of loss to <Math mode="inline" tex="\mathbb{E}_{s\sim\mathcal{D}}\mathbb{E}_{a\sim\pi_{\theta}}-Q(s,a)" text="E _ (s similar-to D) * E _ (a similar-to pi _ theta) - Q * open-interval@(s, a)" xml:id="A1.SS2.p7.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                    <XMApp>
                      <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                        <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="A1.SS2.p7.m2.1"/>
                      <XMRef idref="A1.SS2.p7.m2.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p7.m2.1">s</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS2.p7.m2.2">a</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>) to
<Math mode="inline" tex="\mathbb{E}_{s\sim\mathcal{D}}\mathbb{E}_{a\sim\tilde{\pi},a_{0}\sim\pi_{\theta%&#10;}}\left\|\lfloor\frac{\partial Q(s,a)}{\partial a}+a\rfloor-a_{0}\right\|^{2}" text="E _ (s similar-to D) * E _ (formulae@(a similar-to tilde@(pi), a _ 0 similar-to pi _ theta)) * (norm@(floor@(partial-differential@(Q * open-interval@(s, a)) / partial-differential@(a) + a) - a _ 0)) ^ 2" xml:id="A1.SS2.p7.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                    <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">D</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.SS2.p7.m3.1"/>
                      <XMRef idref="A1.SS2.p7.m3.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.SS2.p7.m3.1">
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                          <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.SS2.p7.m3.2">
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="50%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="norm"/>
                      <XMRef idref="A1.SS2.p7.m3.5"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="true">‖</XMTok>
                      <XMApp xml:id="A1.SS2.p7.m3.5">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="floor"/>
                            <XMRef idref="A1.SS2.p7.m3.5.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="lfloor" role="OPEN" stretchy="false">⌊</XMTok>
                            <XMApp xml:id="A1.SS2.p7.m3.5.1">
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.SS2.p7.m3.3"/>
                                        <XMRef idref="A1.SS2.p7.m3.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS2.p7.m3.3">s</XMTok>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="A1.SS2.p7.m3.4">a</XMTok>
                                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok fontsize="70%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            </XMApp>
                            <XMTok name="rfloor" role="CLOSE" stretchy="false">⌋</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="true">‖</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS3">
      <tags>
        <tag>A.3</tag>
        <tag role="autoref">subsection A.3</tag>
        <tag role="refnum">A.3</tag>
        <tag role="typerefnum">§A.3</tag>
      </tags>
      <title><tag close=" ">A.3</tag>Theoretical Justification of PEX</title>
      <para xml:id="A1.SS3.p1">
        <p>Here we provide some theoretical justification of the proposed form of adaptive policy compostional distribution <Math mode="inline" tex="P_{\mathbf{w}}" text="P _ w" xml:id="A1.SS3.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
              </XMApp>
            </XMath>
          </Math> in Eqn.(<ref labelref="LABEL:eq:w_net"/>):</p>
        <equation xml:id="A1.E11">
<!--  %P_{\w}␣=␣{\rm␣Cat}((\mathbf{Q}␣-␣V(s))/\alpha), -->          <tags>
            <tag>(11)</tag>
            <tag role="autoref">Equation 11</tag>
            <tag role="refnum">11</tag>
          </tags>
          <Math mode="display" tex="P_{{\mathbf{w}}}[i]=\frac{\exp(Q_{\phi}(s,a_{i})/\alpha)}{\sum_{j}\exp(Q_{\phi%&#10;}(s,a_{j})/\alpha)},\quad\forall i\in[1,\cdots K]," text="formulae@(P _ w * delimited-[]@(i) = exponential@((Q _ phi * open-interval@(s, a _ i)) / alpha) / (sum _ j)@(exponential@((Q _ phi * open-interval@(s, a _ j)) / alpha)), for-all@(i) element-of closed-interval@(1, cdots * K))" xml:id="A1.E11.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.E11.m1.9"/>
                <XMWrap>
                  <XMDual xml:id="A1.E11.m1.9">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.E11.m1.9.1"/>
                      <XMRef idref="A1.E11.m1.9.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.E11.m1.9.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="A1.E11.m1.7"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E11.m1.7">i</XMTok>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="A1.E11.m1.2"/>
                              <XMRef idref="A1.E11.m1.3"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E11.m1.2">exp</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E11.m1.3">
                                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.E11.m1.1"/>
                                        <XMRef idref="A1.E11.m1.3.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E11.m1.1">s</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E11.m1.3.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="A1.E11.m1.5"/>
                                <XMRef idref="A1.E11.m1.6"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E11.m1.5">exp</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.E11.m1.6">
                                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A1.E11.m1.4"/>
                                          <XMRef idref="A1.E11.m1.6.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.E11.m1.4">s</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E11.m1.6.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                      <XMApp xml:id="A1.E11.m1.9.2">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="A1.E11.m1.8"/>
                            <XMRef idref="A1.E11.m1.9.2.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMTok meaning="1" role="NUMBER" xml:id="A1.E11.m1.8">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.E11.m1.9.2.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok name="cdots" role="ID">⋯</XMTok>
                              <XMTok font="italic" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="K" text="K" xml:id="A1.SS3.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">K</XMTok>
            </XMath>
          </Math> denotes the number of actions and in our case <Math mode="inline" tex="K=2" text="K = 2" xml:id="A1.SS3.p1.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" role="UNKNOWN">K</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="A1.SS3.p2">
        <p><Math mode="inline" tex="P_{\mathbf{w}}" text="P _ w" xml:id="A1.SS3.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
              </XMApp>
            </XMath>
          </Math> can be viewed as a discrete policy with action dimension of two, which selects between two candidate actions <Math mode="inline" tex="a_{1}" text="a _ 1" xml:id="A1.SS3.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="a_{2}" text="a _ 2" xml:id="A1.SS3.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math>, one from offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS3.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and the other from <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS3.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math>, i.e., <Math mode="inline" tex="a_{1}\sim\pi_{\beta}" text="a _ 1 similar-to pi _ beta" xml:id="A1.SS3.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="a_{2}\sim\pi_{\theta}" text="a _ 2 similar-to pi _ theta" xml:id="A1.SS3.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
Ideally, it assigns a higher probability to actions with higher values at the current state <Math mode="inline" tex="s" text="s" xml:id="A1.SS3.p2.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math>.
The definition of <Math mode="inline" tex="P_{{\mathbf{w}}}" text="P _ w" xml:id="A1.SS3.p2.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
              </XMApp>
            </XMath>
          </Math> essentially a reflection of this intuition, Actually, it can also be derived as shown below.</p>
      </para>
      <para xml:id="A1.SS3.p3">
        <p>By definition, we have the following form for the compositional policy <Math mode="inline" tex="\tilde{\pi}" text="tilde@(pi)" xml:id="A1.SS3.p3.m1">
            <XMath>
              <XMApp>
                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMApp>
            </XMath>
          </Math>:</p>
        <equation labels="LABEL:eq:policy_def" xml:id="A1.E12">
          <tags>
            <tag>(12)</tag>
            <tag role="autoref">Equation 12</tag>
            <tag role="refnum">12</tag>
          </tags>
          <Math mode="display" tex="{\tilde{\pi}(a|s)}=\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}(a_{2}|s)%&#10;\sum_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\delta(a=a_{i})da_{1}da_{2}" text="tilde@(pi) * conditional@(a, s) = (integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * delta * (a = a _ i) * d * a _ 1 * d * a _ 2))" xml:id="A1.E12.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.E12.m1.4"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.E12.m1.4">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="A1.E12.m1.1"/>
                        <XMRef idref="A1.E12.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="A1.E12.m1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                        <XMApp xml:id="A1.E12.m1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A1.E12.m1.5"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.E12.m1.5">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="A1.E12.m1.6"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="A1.E12.m1.6">
                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">P</XMTok>
                          <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E12.m1.7"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E12.m1.7">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">i</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="list"/>
                                  <XMRef idref="A1.E12.m1.3"/>
                                  <XMRef idref="A1.E12.m1.7.1"/>
                                  <XMRef idref="A1.E12.m1.7.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.E12.m1.3">s</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.E12.m1.7.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.E12.m1.7.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                        <XMDual>
                          <XMRef idref="A1.E12.m1.8"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E12.m1.8">
                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>which is essentially another form of Eqn.(<ref labelref="LABEL:eq:rex_policy"/>).</p>
      </para>
      <para xml:id="A1.SS3.p4">
        <p><!--  %****␣PEX_arxiv.tex␣Line␣825␣**** -->For V-value, we can have the following derivations</p>
        <equationgroup class="ltx_eqn_eqnarray" xml:id="A1.EGx1">
          <equation xml:id="A1.E14">
            <tags>
              <tag>(14)</tag>
              <tag role="autoref">Equation 14</tag>
              <tag role="refnum">14</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle V(s)=\int_{a}\tilde{\pi}(a|s)Q_{\phi}(s,a)da\text{(plug in the %&#10;definition of policy in Eqn.(\ref{eq:policy_def}))}" text="V * s = (integral _ a)@(tilde@(pi) * conditional@(a, s) * Q _ phi * open-interval@(s, a) * differential-d@(a) * [(plug in the definition of policy in Eqn.())])" xml:id="A1.E14.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">V</XMTok>
                      <XMDual>
                        <XMRef idref="A1.E14.m2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.E14.m2.1">s</XMTok>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E14.m2.4"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E14.m2.4">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                          <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.E14.m2.2"/>
                            <XMRef idref="A1.E14.m2.3"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E14.m2.2">s</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E14.m2.3">a</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        </XMApp>
                        <XMText class="ltx_markedasmath">(plug in the definition of policy in Eqn.(<ref labelref="LABEL:eq:policy_def"/>))</XMText>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <tr>
                  <td align="right"><Math mode="inline" tex="\displaystyle V(s)" text="V * s" xml:id="A1.E13.m1">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" role="UNKNOWN">V</XMTok>
                          <XMDual>
                            <XMRef idref="A1.E13.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E13.m1.1">s</XMTok>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                  <td align="center"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A1.E13.m2">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\int_{a}\tilde{\pi}(a|s)Q_{\phi}(s,a)da" text="(integral _ a)@(tilde@(pi) * conditional@(a, s) * Q _ phi * open-interval@(s, a) * differential-d@(a))" xml:id="A1.E13.m3">
                      <XMath>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E13.m3.3"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E13.m3.3">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                              <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.E13.m3.1"/>
                                <XMRef idref="A1.E13.m3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E13.m3.1">s</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E13.m3.2">a</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
                <tr>
                  <td/>
                  <td/>
                  <td align="left"><text class="ltx_markedasmath">(plug in the definition of policy in Eqn.(<ref labelref="LABEL:eq:policy_def"/>))</text></td>
                </tr>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A1.E15">
            <tags>
              <tag>(15)</tag>
              <tag role="autoref">Equation 15</tag>
              <tag role="refnum">15</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle=\int_{a}\left[\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}%&#10;(a_{2}|s)\sum_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\delta(a=a_{i})da_{1}da_{2}%&#10;\right]Q_{\phi}(s,a)da" text="absent = (integral _ a)@(delimited-[]@((integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * delta * (a = a _ i) * d * a _ 1 * d * a _ 2))) * Q _ phi * open-interval@(s, a) * differential-d@(a))" xml:id="A1.E15.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="delimited-[]"/>
                            <XMRef idref="A1.E15.m3.6"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">[</XMTok>
                            <XMApp xml:id="A1.E15.m3.6">
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="A1.E15.m3.1"/>
                                    <XMRef idref="A1.E15.m3.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMApp xml:id="A1.E15.m3.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E15.m3.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.E15.m3.6.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.E15.m3.6.1">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.E15.m3.6.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.E15.m3.6.2">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                      <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A1.E15.m3.6.3"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.E15.m3.6.3">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="list"/>
                                              <XMRef idref="A1.E15.m3.3"/>
                                              <XMRef idref="A1.E15.m3.6.3.1"/>
                                              <XMRef idref="A1.E15.m3.6.3.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E15.m3.3">s</XMTok>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.E15.m3.6.3.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.E15.m3.6.3.2">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.E15.m3.6.4"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.E15.m3.6.4">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">]</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                          <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="open-interval"/>
                            <XMRef idref="A1.E15.m3.4"/>
                            <XMRef idref="A1.E15.m3.5"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E15.m3.4">s</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E15.m3.5">a</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <tr>
                  <td/>
                  <td align="center"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A1.E15.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\int_{a}\left[\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}(%&#10;a_{2}|s)\sum_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\delta(a=a_{i})da_{1}da_{2}%&#10;\right]Q_{\phi}(s,a)da" text="(integral _ a)@(delimited-[]@((integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * delta * (a = a _ i) * d * a _ 1 * d * a _ 2))) * Q _ phi * open-interval@(s, a) * differential-d@(a))" xml:id="A1.E15.m2">
                      <XMath>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A1.E15.m2.6"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">[</XMTok>
                                <XMApp xml:id="A1.E15.m2.6">
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="A1.E15.m2.1"/>
                                        <XMRef idref="A1.E15.m2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMApp xml:id="A1.E15.m2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E15.m2.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                          <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A1.E15.m2.6.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.E15.m2.6.1">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A1.E15.m2.6.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.E15.m2.6.2">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                          <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="A1.E15.m2.6.3"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.E15.m2.6.3">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="A1.E15.m2.3"/>
                                                  <XMRef idref="A1.E15.m2.6.3.1"/>
                                                  <XMRef idref="A1.E15.m2.6.3.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.E15.m2.3">s</XMTok>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A1.E15.m2.6.3.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A1.E15.m2.6.3.2">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.E15.m2.6.4"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.E15.m2.6.4">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                              <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.E15.m2.4"/>
                                <XMRef idref="A1.E15.m2.5"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E15.m2.4">s</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E15.m2.5">a</XMTok>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A1.E16">
            <tags>
              <tag>(16)</tag>
              <tag role="autoref">Equation 16</tag>
              <tag role="refnum">16</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle=\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}(a_{2}|s)\sum_%&#10;{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\left[\int_{a}\delta(a=a_{i})Q_{\phi}(s,a)da%&#10;\right]da_{1}da_{2}" text="absent = (integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * delimited-[]@((integral _ a)@(delta * (a = a _ i) * Q _ phi * open-interval@(s, a) * differential-d@(a))) * d * a _ 1 * d * a _ 2))" xml:id="A1.E16.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A1.E16.m3.1"/>
                            <XMRef idref="A1.E16.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A1.E16.m3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.E16.m3.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E16.m3.6"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E16.m3.6">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E16.m3.7"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E16.m3.7">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">P</XMTok>
                              <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E16.m3.8"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E16.m3.8">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A1.E16.m3.3"/>
                                      <XMRef idref="A1.E16.m3.8.1"/>
                                      <XMRef idref="A1.E16.m3.8.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m3.3">s</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E16.m3.8.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E16.m3.8.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A1.E16.m3.9"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">[</XMTok>
                                <XMApp xml:id="A1.E16.m3.9">
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                    <XMDual>
                                      <XMRef idref="A1.E16.m3.9.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.E16.m3.9.1">
                                          <XMTok meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.E16.m3.4"/>
                                        <XMRef idref="A1.E16.m3.5"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m3.4">s</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m3.5">a</XMTok>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMApp>
                                      <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">]</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <tr>
                  <td/>
                  <td align="center"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A1.E16.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}(a_{2}|s)\sum_{%&#10;i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\left[\int_{a}\delta(a=a_{i})Q_{\phi}(s,a)da%&#10;\right]da_{1}da_{2}" text="(integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * delimited-[]@((integral _ a)@(delta * (a = a _ i) * Q _ phi * open-interval@(s, a) * differential-d@(a))) * d * a _ 1 * d * a _ 2))" xml:id="A1.E16.m2">
                      <XMath>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A1.E16.m2.1"/>
                                <XMRef idref="A1.E16.m2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.E16.m2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.E16.m2.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E16.m2.6"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E16.m2.6">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E16.m2.7"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E16.m2.7">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.E16.m2.8"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.E16.m2.8">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A1.E16.m2.3"/>
                                          <XMRef idref="A1.E16.m2.8.1"/>
                                          <XMRef idref="A1.E16.m2.8.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m2.3">s</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E16.m2.8.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E16.m2.8.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="A1.E16.m2.9"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">[</XMTok>
                                    <XMApp xml:id="A1.E16.m2.9">
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" name="delta" role="UNKNOWN">δ</XMTok>
                                        <XMDual>
                                          <XMRef idref="A1.E16.m2.9.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.E16.m2.9.1">
                                              <XMTok meaning="equals" role="RELOP">=</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A1.E16.m2.4"/>
                                            <XMRef idref="A1.E16.m2.5"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m2.4">s</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E16.m2.5">a</XMTok>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                        <XMApp>
                                          <XMTok font="italic" meaning="differential-d" role="DIFFOP">d</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        </XMApp>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">]</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A1.E17">
            <tags>
              <tag>(17)</tag>
              <tag role="autoref">Equation 17</tag>
              <tag role="refnum">17</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle=\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}(a_{2}|s)\sum_%&#10;{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})Q(s,a_{i})da_{1}da_{2}" text="absent = (integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * Q * open-interval@(s, a _ i) * d * a _ 1 * d * a _ 2))" xml:id="A1.E17.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="A1.E17.m3.1"/>
                            <XMRef idref="A1.E17.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A1.E17.m3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.E17.m3.2">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E17.m3.5"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E17.m3.5">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.E17.m3.6"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="A1.E17.m3.6">
                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">P</XMTok>
                              <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E17.m3.7"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E17.m3.7">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="A1.E17.m3.3"/>
                                      <XMRef idref="A1.E17.m3.7.1"/>
                                      <XMRef idref="A1.E17.m3.7.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E17.m3.3">s</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E17.m3.7.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E17.m3.7.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                      </XMApp>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="open-interval"/>
                                <XMRef idref="A1.E17.m3.4"/>
                                <XMRef idref="A1.E17.m3.8"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E17.m3.4">s</XMTok>
                                <XMTok role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.E17.m3.8">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMTok font="italic" role="UNKNOWN">d</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <tr>
                  <td/>
                  <td align="center"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A1.E17.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\int_{a_{1},a_{2}}\pi_{\beta}(a_{1}|s)\pi_{\theta}(a_{2}|s)\sum_{%&#10;i}P_{\mathbf{w}}(i|s,a_{1},a_{2})Q(s,a_{i})da_{1}da_{2}" text="(integral _ (list@(a _ 1, a _ 2)))@(pi _ beta * conditional@(a _ 1, s) * pi _ theta * conditional@(a _ 2, s) * (sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * Q * open-interval@(s, a _ i) * d * a _ 1 * d * a _ 2))" xml:id="A1.E17.m2">
                      <XMath>
                        <XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok mathstyle="display" meaning="integral" name="int" role="INTOP">∫</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="A1.E17.m2.1"/>
                                <XMRef idref="A1.E17.m2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.E17.m2.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.E17.m2.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E17.m2.5"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E17.m2.5">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="A1.E17.m2.6"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E17.m2.6">
                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.E17.m2.7"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.E17.m2.7">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A1.E17.m2.3"/>
                                          <XMRef idref="A1.E17.m2.7.1"/>
                                          <XMRef idref="A1.E17.m2.7.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.E17.m2.3">s</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E17.m2.7.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E17.m2.7.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="A1.E17.m2.4"/>
                                    <XMRef idref="A1.E17.m2.8"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E17.m2.4">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E17.m2.8">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMTok font="italic" role="UNKNOWN">d</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="A1.E18">
            <tags>
              <tag>(18)</tag>
              <tag role="autoref">Equation 18</tag>
              <tag role="refnum">18</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle=\mathbb{E}_{a_{1}\sim\pi_{\beta},a_{2}\sim\pi_{\theta}}\left[%&#10;\sum_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})Q_{\phi}(s,a_{i})\right]" text="absent = E _ (formulae@(a _ 1 similar-to pi _ beta, a _ 2 similar-to pi _ theta)) * delimited-[]@((sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * Q _ phi * open-interval@(s, a _ i)))" xml:id="A1.E18.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok meaning="absent"/>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="A1.E18.m3.1"/>
                            <XMRef idref="A1.E18.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="A1.E18.m3.1">
                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.E18.m3.2">
                              <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="A1.E18.m3.5"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="true">[</XMTok>
                          <XMApp xml:id="A1.E18.m3.5">
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="A1.E18.m3.5.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.E18.m3.5.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="list"/>
                                        <XMRef idref="A1.E18.m3.3"/>
                                        <XMRef idref="A1.E18.m3.5.1.1"/>
                                        <XMRef idref="A1.E18.m3.5.1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m3.3">s</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E18.m3.5.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E18.m3.5.1.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                        </XMApp>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.E18.m3.4"/>
                                  <XMRef idref="A1.E18.m3.5.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m3.4">s</XMTok>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.E18.m3.5.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="true">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <tr>
                  <td/>
                  <td align="center"><Math mode="inline" tex="\displaystyle=" text="=" xml:id="A1.E18.m1">
                      <XMath>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                      </XMath>
                    </Math></td>
                  <td align="left"><Math mode="inline" tex="\displaystyle\mathbb{E}_{a_{1}\sim\pi_{\beta},a_{2}\sim\pi_{\theta}}\left[\sum%&#10;_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})Q_{\phi}(s,a_{i})\right]" text="E _ (formulae@(a _ 1 similar-to pi _ beta, a _ 2 similar-to pi _ theta)) * delimited-[]@((sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * Q _ phi * open-interval@(s, a _ i)))" xml:id="A1.E18.m2">
                      <XMath>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="A1.E18.m2.1"/>
                                <XMRef idref="A1.E18.m2.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="A1.E18.m2.1">
                                  <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                <XMApp xml:id="A1.E18.m2.2">
                                  <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                    <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="A1.E18.m2.5"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="true">[</XMTok>
                              <XMApp xml:id="A1.E18.m2.5">
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                    <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="A1.E18.m2.5.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="A1.E18.m2.5.1">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="list"/>
                                            <XMRef idref="A1.E18.m2.3"/>
                                            <XMRef idref="A1.E18.m2.5.1.1"/>
                                            <XMRef idref="A1.E18.m2.5.1.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m2.3">s</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.E18.m2.5.1.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.E18.m2.5.1.2">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                              <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                            </XMApp>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.E18.m2.4"/>
                                      <XMRef idref="A1.E18.m2.5.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E18.m2.4">s</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E18.m2.5.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="true">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMath>
                    </Math></td>
                </tr>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Applying entropy regularization term for policy learning, we have</p>
        <equationgroup class="ltx_eqn_eqnarray" xml:id="A1.EGx2">
          <equation xml:id="A1.E19">
            <tags>
              <tag>(19)</tag>
              <tag role="autoref">Equation 19</tag>
              <tag role="refnum">19</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\mathbb{E}_{a_{1}\sim\pi_{\beta},a_{2}\sim\pi_{\theta}}\left[\sum%&#10;_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\left(Q_{\phi}(s,a_{i})-\alpha\log P_{%&#10;\mathbf{w}}(i|s,a_{1},a_{2})\right)\right]." text="E _ (formulae@(a _ 1 similar-to pi _ beta, a _ 2 similar-to pi _ theta)) * delimited-[]@((sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * (Q _ phi * open-interval@(s, a _ i) - alpha * logarithm@(P _ w) * conditional@(i, list@(s, a _ 1, a _ 2)))))" xml:id="A1.E19.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="A1.E19.m2.6"/>
                    <XMWrap>
                      <XMApp xml:id="A1.E19.m2.6">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="A1.E19.m2.1"/>
                              <XMRef idref="A1.E19.m2.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="A1.E19.m2.1">
                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                  <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                              <XMApp xml:id="A1.E19.m2.2">
                                <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                  <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                  <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="delimited-[]"/>
                            <XMRef idref="A1.E19.m2.6.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="true">[</XMTok>
                            <XMApp xml:id="A1.E19.m2.6.1">
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                  <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="A1.E19.m2.6.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="A1.E19.m2.6.1.1">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="A1.E19.m2.3"/>
                                          <XMRef idref="A1.E19.m2.6.1.1.1"/>
                                          <XMRef idref="A1.E19.m2.6.1.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.E19.m2.3">s</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E19.m2.6.1.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                          </XMApp>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E19.m2.6.1.1.2">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                          </XMApp>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                                <XMDual>
                                  <XMRef idref="A1.E19.m2.6.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="true">(</XMTok>
                                    <XMApp xml:id="A1.E19.m2.6.1.2">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                        </XMApp>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="A1.E19.m2.4"/>
                                            <XMRef idref="A1.E19.m2.6.1.2.1"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.E19.m2.4">s</XMTok>
                                            <XMTok role="PUNCT">,</XMTok>
                                            <XMApp xml:id="A1.E19.m2.6.1.2.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                        <XMApp>
                                          <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="A1.E19.m2.6.1.2.2"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="A1.E19.m2.6.1.2.2">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                              <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                              <XMDual>
                                                <XMApp>
                                                  <XMTok meaning="list"/>
                                                  <XMRef idref="A1.E19.m2.5"/>
                                                  <XMRef idref="A1.E19.m2.6.1.2.2.1"/>
                                                  <XMRef idref="A1.E19.m2.6.1.2.2.2"/>
                                                </XMApp>
                                                <XMWrap>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="A1.E19.m2.5">s</XMTok>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A1.E19.m2.6.1.2.2.1">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                  </XMApp>
                                                  <XMTok role="PUNCT">,</XMTok>
                                                  <XMApp xml:id="A1.E19.m2.6.1.2.2.2">
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                    <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                  </XMApp>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="true">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="PERIOD">.</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\mathbb{E}_{a_{1}\sim\pi_{\beta},a_{2}\sim\pi_{\theta}}\left[\sum%&#10;_{i}P_{\mathbf{w}}(i|s,a_{1},a_{2})\left(Q_{\phi}(s,a_{i})-\alpha\log P_{%&#10;\mathbf{w}}(i|s,a_{1},a_{2})\right)\right]." text="E _ (formulae@(a _ 1 similar-to pi _ beta, a _ 2 similar-to pi _ theta)) * delimited-[]@((sum _ i)@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) * (Q _ phi * open-interval@(s, a _ i) - alpha * logarithm@(P _ w) * conditional@(i, list@(s, a _ 1, a _ 2)))))" xml:id="A1.E19.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="A1.E19.m1.6"/>
                        <XMWrap>
                          <XMApp xml:id="A1.E19.m1.6">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="formulae"/>
                                  <XMRef idref="A1.E19.m1.1"/>
                                  <XMRef idref="A1.E19.m1.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMApp xml:id="A1.E19.m1.1">
                                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.E19.m1.2">
                                    <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="theta" role="UNKNOWN">θ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="A1.E19.m1.6.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="true">[</XMTok>
                                <XMApp xml:id="A1.E19.m1.6.1">
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid2"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                      <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="A1.E19.m1.6.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="A1.E19.m1.6.1.1">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                          <XMDual>
                                            <XMApp>
                                              <XMTok meaning="list"/>
                                              <XMRef idref="A1.E19.m1.3"/>
                                              <XMRef idref="A1.E19.m1.6.1.1.1"/>
                                              <XMRef idref="A1.E19.m1.6.1.1.2"/>
                                            </XMApp>
                                            <XMWrap>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E19.m1.3">s</XMTok>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.E19.m1.6.1.1.1">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                              </XMApp>
                                              <XMTok role="PUNCT">,</XMTok>
                                              <XMApp xml:id="A1.E19.m1.6.1.1.2">
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                              </XMApp>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMRef idref="A1.E19.m1.6.1.2"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="true">(</XMTok>
                                        <XMApp xml:id="A1.E19.m1.6.1.2">
                                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                            </XMApp>
                                            <XMDual>
                                              <XMApp>
                                                <XMTok meaning="open-interval"/>
                                                <XMRef idref="A1.E19.m1.4"/>
                                                <XMRef idref="A1.E19.m1.6.1.2.1"/>
                                              </XMApp>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMTok font="italic" role="UNKNOWN" xml:id="A1.E19.m1.4">s</XMTok>
                                                <XMTok role="PUNCT">,</XMTok>
                                                <XMApp xml:id="A1.E19.m1.6.1.2.1">
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                            <XMApp>
                                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                                                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMDual>
                                              <XMRef idref="A1.E19.m1.6.1.2.2"/>
                                              <XMWrap>
                                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                                <XMApp xml:id="A1.E19.m1.6.1.2.2">
                                                  <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                                  <XMDual>
                                                    <XMApp>
                                                      <XMTok meaning="list"/>
                                                      <XMRef idref="A1.E19.m1.5"/>
                                                      <XMRef idref="A1.E19.m1.6.1.2.2.1"/>
                                                      <XMRef idref="A1.E19.m1.6.1.2.2.2"/>
                                                    </XMApp>
                                                    <XMWrap>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E19.m1.5">s</XMTok>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="A1.E19.m1.6.1.2.2.1">
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                                      </XMApp>
                                                      <XMTok role="PUNCT">,</XMTok>
                                                      <XMApp xml:id="A1.E19.m1.6.1.2.2.2">
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                                      </XMApp>
                                                    </XMWrap>
                                                  </XMDual>
                                                </XMApp>
                                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="true">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="true">]</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="PERIOD">.</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Solving for <Math mode="inline" tex="P_{\mathbf{w}}" text="P _ w" xml:id="A1.SS3.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
              </XMApp>
            </XMath>
          </Math> given <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS3.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS3.p4.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math>, we have</p>
        <equation xml:id="A1.E20">
          <tags>
            <tag>(20)</tag>
            <tag role="autoref">Equation 20</tag>
            <tag role="refnum">20</tag>
          </tags>
          <Math mode="display" tex="P_{\mathbf{w}}(i|s,a_{1},a_{2})\propto\exp(Q_{\phi}(s,a_{i})/\alpha),\quad%&#10;\forall i\in[1,2]." text="formulae@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) proportional-to exponential@((Q _ phi * open-interval@(s, a _ i)) / alpha), for-all@(i) element-of closed-interval@(1, 2))" xml:id="A1.E20.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.E20.m1.6"/>
                <XMWrap>
                  <XMDual xml:id="A1.E20.m1.6">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.E20.m1.6.1"/>
                      <XMRef idref="A1.E20.m1.6.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.E20.m1.6.1">
                        <XMTok meaning="proportional-to" name="propto" role="RELOP">∝</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.E20.m1.6.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.E20.m1.6.1.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="A1.E20.m1.1"/>
                                    <XMRef idref="A1.E20.m1.6.1.1.1"/>
                                    <XMRef idref="A1.E20.m1.6.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E20.m1.1">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E20.m1.6.1.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E20.m1.6.1.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMRef idref="A1.E20.m1.3"/>
                            <XMRef idref="A1.E20.m1.6.1.2"/>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E20.m1.3">exp</XMTok>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.E20.m1.6.1.2">
                                <XMTok meaning="divide" role="MULOP">/</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.E20.m1.2"/>
                                      <XMRef idref="A1.E20.m1.6.1.2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E20.m1.2">s</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E20.m1.6.1.2.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMDual>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                      <XMApp xml:id="A1.E20.m1.6.2">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="A1.E20.m1.4"/>
                            <XMRef idref="A1.E20.m1.5"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMTok meaning="1" role="NUMBER" xml:id="A1.E20.m1.4">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="A1.E20.m1.5">2</XMTok>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
<!--  %for␣each␣state␣$s$␣and␣sampled␣action␣␣$a_1$,␣$a_2$. -->      <para xml:id="A1.SS3.p5">
        <p>Therefore, for the case of two actions, we have</p>
        <equation xml:id="A1.E21">
          <tags>
            <tag>(21)</tag>
            <tag role="autoref">Equation 21</tag>
            <tag role="refnum">21</tag>
          </tags>
          <Math mode="display" tex="P_{\mathbf{w}}(i|s,a_{1},a_{2})=\frac{\exp(Q_{\phi}(s,a_{i})/\alpha)}{\sum_{j}%&#10;\exp(Q_{\phi}(s,a_{j})/\alpha)},\quad\forall i\in[1,2]." text="formulae@(P _ w * conditional@(i, list@(s, a _ 1, a _ 2)) = exponential@((Q _ phi * open-interval@(s, a _ i)) / alpha) / (sum _ j)@(exponential@((Q _ phi * open-interval@(s, a _ j)) / alpha)), for-all@(i) element-of closed-interval@(1, 2))" xml:id="A1.E21.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.E21.m1.10"/>
                <XMWrap>
                  <XMDual xml:id="A1.E21.m1.10">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.E21.m1.10.1"/>
                      <XMRef idref="A1.E21.m1.10.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.E21.m1.10.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="A1.E21.m1.10.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="A1.E21.m1.10.1.1">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                <XMTok font="italic" role="UNKNOWN">i</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="list"/>
                                    <XMRef idref="A1.E21.m1.7"/>
                                    <XMRef idref="A1.E21.m1.10.1.1.1"/>
                                    <XMRef idref="A1.E21.m1.10.1.1.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.E21.m1.7">s</XMTok>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E21.m1.10.1.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="A1.E21.m1.10.1.1.2">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                    </XMApp>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="A1.E21.m1.2"/>
                              <XMRef idref="A1.E21.m1.3"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E21.m1.2">exp</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E21.m1.3">
                                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.E21.m1.1"/>
                                        <XMRef idref="A1.E21.m1.3.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E21.m1.1">s</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E21.m1.3.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="A1.E21.m1.5"/>
                                <XMRef idref="A1.E21.m1.6"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E21.m1.5">exp</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.E21.m1.6">
                                    <XMTok meaning="divide" role="MULOP">/</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                        <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                      </XMApp>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="A1.E21.m1.4"/>
                                          <XMRef idref="A1.E21.m1.6.1"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.E21.m1.4">s</XMTok>
                                          <XMTok role="PUNCT">,</XMTok>
                                          <XMApp xml:id="A1.E21.m1.6.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                      <XMApp xml:id="A1.E21.m1.10.2">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="A1.E21.m1.8"/>
                            <XMRef idref="A1.E21.m1.9"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMTok meaning="1" role="NUMBER" xml:id="A1.E21.m1.8">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMTok meaning="2" role="NUMBER" xml:id="A1.E21.m1.9">2</XMTok>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:app:addtional_ablations" xml:id="A1.SS4">
      <tags>
        <tag>A.4</tag>
        <tag role="autoref">subsection A.4</tag>
        <tag role="refnum">A.4</tag>
        <tag role="typerefnum">§A.4</tag>
      </tags>
      <title><tag close=" ">A.4</tag>Additional Ablation Results</title>
      <para xml:id="A1.SS4.p1">
        <p>We provide more ablations experiments and results in this section.</p>
        <p align="left"><text font="bold">Double Parameters.</text></p>
        <p>Since there are two member policies in the proposed approach. A natural question to ask is whether properly doubling the number of parameters of a policy could achieve similar performance.</p>
      </para>
      <figure float="right" xml:id="A1.SS4.fig1">
        <picture fill="none" height="113.5pt" stroke="none" tex="\begin{overpic}[height=113.81102pt]{imgs/curve_ablation_exp_double_param_agg.%&#10;pdf}&#10;\put(30.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{Double %&#10;Parameters}}}}}&#10;\end{overpic}" width="117.8pt" xml:id="A1.SS4.pic1"/>
      </figure>
      <para xml:id="A1.SS4.p2">
        <p>To verify this, we construct a type of policy network with (roughly) doubled number of parameters as
<Math mode="inline" tex="\pi_{\theta}(s)\!=\!g_{\theta_{g}}\!\circ\!f_{\theta_{f}}(s)" text="pi _ theta * s = (g _ theta _ g compose f _ theta _ f) * s" xml:id="A1.SS4.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP" rpadding="-1.7pt">=</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.SS4.p2.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS4.p2.m1.1">s</XMTok>
                      <XMTok role="CLOSE" rpadding="-1.7pt" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMApp>
                    <XMTok meaning="compose" name="circ" role="MULOP" rpadding="-1.7pt">∘</XMTok>
                    <XMApp rpadding="-1.7pt">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">g</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">f</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">f</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="A1.SS4.p2.m1.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS4.p2.m1.2">s</XMTok>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>,
where <Math mode="inline" tex="f_{\theta_{f}}(s)" text="f _ theta _ f * s" xml:id="A1.SS4.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">f</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">f</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMRef idref="A1.SS4.p2.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS4.p2.m2.1">s</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> encodes the observation <Math mode="inline" tex="s" text="s" xml:id="A1.SS4.p2.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math> into a feature vector and <Math mode="inline" tex="g" text="g" xml:id="A1.SS4.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">g</XMTok>
            </XMath>
          </Math> maps the feature vector to
the action distribution.
To (approximately) double the number of parameters, we implement <Math mode="inline" tex="f_{\theta_{f}}" text="f _ theta _ f" xml:id="A1.SS4.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">f</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> as
<Math mode="inline" tex="f_{\theta_{f}}(s)\!\triangleq\!f_{\theta_{1}}(s)\!+\!f_{\theta_{2}}(s)." text="f _ theta _ f * s triangleq f _ theta _ 1 * s + f _ theta _ 2 * s" xml:id="A1.SS4.p2.m6">
            <XMath>
              <XMDual>
                <XMRef idref="A1.SS4.p2.m6.4"/>
                <XMWrap>
                  <XMApp xml:id="A1.SS4.p2.m6.4">
                    <XMTok name="triangleq" role="RELOP" rpadding="-1.7pt">≜</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">f</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">f</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="A1.SS4.p2.m6.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS4.p2.m6.1">s</XMTok>
                          <XMTok role="CLOSE" rpadding="-1.7pt" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="plus" role="ADDOP" rpadding="-1.7pt">+</XMTok>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.SS4.p2.m6.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS4.p2.m6.2">s</XMTok>
                            <XMTok role="CLOSE" rpadding="-1.7pt" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">f</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMDual>
                          <XMRef idref="A1.SS4.p2.m6.3"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMTok font="italic" role="UNKNOWN" xml:id="A1.SS4.p2.m6.3">s</XMTok>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
<Math mode="inline" tex="f_{\theta_{1}}" text="f _ theta _ 1" xml:id="A1.SS4.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">f</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is initialized by transferring parameters <Math mode="inline" tex="\theta" text="theta" xml:id="A1.SS4.p2.m8">
            <XMath>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
            </XMath>
          </Math> learned in the pre-train stage. The aggregated return
curves are shown on the right, for doubling the number of policy parameters as described above (<text font="typewriter bold" fontsize="90%">Double-Param</text>), and the proposed approach. It can be observed that by comparison that simply increasing the number of parameters cannot help much with the performance, implying the importance of the proposed structure in <text font="typewriter bold">PEX</text>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS5">
      <tags>
        <tag>A.5</tag>
        <tag role="autoref">subsection A.5</tag>
        <tag role="refnum">A.5</tag>
        <tag role="typerefnum">§A.5</tag>
      </tags>
      <title><tag close=" ">A.5</tag>More Details on Tasks</title>
      <para xml:id="A1.SS5.p1">
        <p><!--  %****␣PEX_arxiv.tex␣Line␣875␣**** -->We summarized the tasks used for experiments and their corresponding D4RL environment names in Table <ref labelref="LABEL:tab:gym_env"/>.</p>
      </para>
      <table inlist="lot" labels="LABEL:tab:gym_env" placement="h" xml:id="A1.T1">
        <tags>
          <tag>Table 1</tag>
          <tag role="autoref">Table 1</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Table 1</tag>
        </tags>
        <inline-block align="center" depth="0.0pt" height="289.3pt" width="256.1pt" xscale="1.00434458867226" xtranslate="0.6pt" yscale="1.00434458867226" ytranslate="-0.6pt">
          <tabular class="ltx_guessed_headers" vattach="middle">
            <thead>
              <tr>
                <td align="center" border="l r t" thead="column">Task</td>
                <td align="center" border="r t" thead="column">D4RL Environment Name</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center" border="l r tt"><text font="typewriter bold" fontsize="90%">antmaze-umaze</text></td>
                <td align="center" border="r tt"><text font="typewriter bold" fontsize="90%">antmaze-umaze-v0</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">antmaze-umaze-diverse</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">antmaze-umaze-diverse-v0</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">antmaze-medium-play</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">antmaze-medium-play-v0</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">antmaze-medium-diverse</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">antmaze-medium-diverse-v0</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">antmaze-large-play</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">antmaze-large-play-v0</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">antmaze-large-diverse</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">antmaze-large-diverse-v0</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">halfcheetah-random</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">halfcheetah-random-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">hopper-random</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">hopper-random-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">walker-random</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">walker-random-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">halfcheetah-medium</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">halfcheetah-medium-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">hopper-medium</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">hopper-medium-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">walker-medium</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">walker-medium-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">halfcheetah-medium-replay</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">halfcheetah-medium-replay-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="l r"><text font="typewriter bold" fontsize="90%">hopper-medium-replay</text></td>
                <td align="center" border="r"><text font="typewriter bold" fontsize="90%">hopper-medium-replay-v2</text></td>
              </tr>
              <tr>
                <td align="center" border="b l r"><text font="typewriter bold" fontsize="90%">walker-medium-replay</text></td>
                <td align="center" border="b r"><text font="typewriter bold" fontsize="90%">walker-medium-replay-v2</text></td>
              </tr>
            </tbody>
          </tabular>
        </inline-block>
        <toccaption class="ltx_centering"><tag close=" ">1</tag><text font="bold">Tasks and the corresponding environment names in D4RL</text>.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Table 1</tag><text font="bold">Tasks and the corresponding environment names in D4RL</text>.</caption>
      </table>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS6">
      <tags>
        <tag>A.6</tag>
        <tag role="autoref">subsection A.6</tag>
        <tag role="refnum">A.6</tag>
        <tag role="typerefnum">§A.6</tag>
      </tags>
      <title><tag close=" ">A.6</tag>Hyper-parameters</title>
      <para xml:id="A1.SS6.p1">
        <p>The hyper-parameters and values are summarized in Table <ref labelref="LABEL:tab:hyperparameters"/>.
There are two algorithmic related hyper-parameters inherited from IQL since we instantiate PEX based on it: temperature
<Math mode="inline" tex="\alpha" text="alpha" xml:id="A1.SS6.p1.m1">
            <XMath>
              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
            </XMath>
          </Math> (corresponding to <Math mode="inline" tex="\beta^{-1}" text="beta ^ (- 1)" xml:id="A1.SS6.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> in IQL paper <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>) and expectile value <Math mode="inline" tex="\tau" text="tau" xml:id="A1.SS6.p1.m3">
            <XMath>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
            </XMath>
          </Math>.
The rest of the hyper-parameters are common ones in RL algorithms, including for example batch size, network structure and size, target update etc.
We use the hyper-parameter values from the IQL paper <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> in our experiments.</p>
      </para>
      <table inlist="lot" labels="LABEL:tab:hyperparameters" placement="h" xml:id="A1.T2">
        <tags>
          <tag>Table 2</tag>
          <tag role="autoref">Table 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Table 2</tag>
        </tags>
        <inline-block align="center" depth="0.0pt" height="225.4pt" width="256.1pt" xscale="0.834764457011972" xtranslate="-25.3pt" yscale="0.834764457011972" ytranslate="22.3pt">
          <tabular class="ltx_guessed_headers" colsep="25.6pt" vattach="middle">
            <thead>
              <tr>
                <td align="left" border="r t" thead="column row">        Hyper-parameters</td>
                <td align="center" border="t" thead="column">        Values</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" border="r tt" thead="row">        number of parallel env</td>
                <td align="center" border="tt">        1</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        discount</td>
                <td align="center">        0.99</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        replay buffer size</td>
                <td align="center">        1e6</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        batch size</td>
                <td align="center">        256</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        MLP hidden layer size</td>
                <td align="center">        [256, 256]</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        learning rate</td>
                <td align="center">        3e-4</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        initial collection steps</td>
                <td align="center">        5000</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        target update speed</td>
                <td align="center">        5e-3</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        expectile value <Math mode="inline" tex="\tau" text="tau" xml:id="A1.T2.m1">
                    <XMath>
                      <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                    </XMath>
                  </Math></td>
                <td align="center">        0.9 (0.7)</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        inverse temperature <Math mode="inline" tex="\alpha^{-1}" text="alpha ^ (- 1)" xml:id="A1.T2.m2">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="center">        10 (3)</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        number of offline iterations</td>
                <td align="center">        1M</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        number of online iterations</td>
                <td align="center">        1M</td>
              </tr>
              <tr>
                <td align="left" border="r" thead="row">        number of iteration per rollout step</td>
                <td align="center">        1</td>
              </tr>
              <tr>
                <td align="left" border="b r" thead="row">        target entropy (SAC)</td>
                <td align="center" border="b">        <Math mode="inline" tex="-d" text="- d" xml:id="A1.T2.m3">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">d</XMTok>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </tr>
            </tbody>
          </tabular>
        </inline-block>
        <toccaption class="ltx_centering"><tag close=" ">2</tag>Hyper-parameter values. Values in brackets are used for locomotion tasks. The rest of the hyper-parameter values are shared across all tasks. <Math mode="inline" tex="d" text="d" xml:id="A1.T2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">d</XMTok>
            </XMath>
          </Math> denotes the action dimension.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Table 2</tag>Hyper-parameter values. Values in brackets are used for locomotion tasks. The rest of the hyper-parameter values are shared across all tasks. <Math mode="inline" tex="d" text="d" xml:id="A1.T2.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">d</XMTok>
            </XMath>
          </Math> denotes the action dimension.</caption>
      </table>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS7">
      <tags>
        <tag>A.7</tag>
        <tag role="autoref">subsection A.7</tag>
        <tag role="refnum">A.7</tag>
        <tag role="typerefnum">§A.7</tag>
      </tags>
      <title><tag close=" ">A.7</tag>Hyper-parameter Ablations</title>
      <para xml:id="A1.SS7.p1">
        <p><text font="bold">Impact of <Math mode="inline" tex="\alpha" text="alpha" xml:id="A1.SS7.p1.m1">
              <XMath>
                <XMTok font="medium italic" name="alpha" role="UNKNOWN">α</XMTok>
              </XMath>
            </Math></text>.
<Math mode="inline" tex="\alpha" text="alpha" xml:id="A1.SS7.p1.m2">
            <XMath>
<!--  %**** PEX_arxiv.tex Line 950 **** -->              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
            </XMath>
          </Math> scales the Q values before constructing <Math mode="inline" tex="P_{{\mathbf{w}}}" text="P _ w" xml:id="A1.SS7.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
                <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
              </XMApp>
            </XMath>
          </Math>:</p>
        <equation xml:id="A1.E22">
          <tags>
            <tag>(22)</tag>
            <tag role="autoref">Equation 22</tag>
            <tag role="refnum">22</tag>
          </tags>
          <Math mode="display" tex="P_{{\mathbf{w}}}[i]=\frac{\exp(\alpha^{-1}Q_{\phi}(s,a_{i}))}{\sum_{j}\exp(%&#10;\alpha^{-1}Q_{\phi}(s,a_{j}))},\quad\forall i\in[1,\cdots K]." text="formulae@(P _ w * delimited-[]@(i) = exponential@(alpha ^ (- 1) * Q _ phi * open-interval@(s, a _ i)) / (sum _ j)@(exponential@(alpha ^ (- 1) * Q _ phi * open-interval@(s, a _ j))), for-all@(i) element-of closed-interval@(1, cdots * K))" xml:id="A1.E22.m1">
            <XMath>
              <XMDual>
                <XMRef idref="A1.E22.m1.9"/>
                <XMWrap>
                  <XMDual xml:id="A1.E22.m1.9">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.E22.m1.9.1"/>
                      <XMRef idref="A1.E22.m1.9.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.E22.m1.9.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            <XMTok font="bold" fontsize="70%" role="UNKNOWN">w</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="A1.E22.m1.7"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">[</XMTok>
                              <XMTok font="italic" role="UNKNOWN" xml:id="A1.E22.m1.7">i</XMTok>
                              <XMTok role="CLOSE" stretchy="false">]</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMDual>
                            <XMApp>
                              <XMRef idref="A1.E22.m1.2"/>
                              <XMRef idref="A1.E22.m1.3"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E22.m1.2">exp</XMTok>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="A1.E22.m1.3">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                    <XMApp>
                                      <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                    <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="A1.E22.m1.1"/>
                                      <XMRef idref="A1.E22.m1.3.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="A1.E22.m1.1">s</XMTok>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="A1.E22.m1.3.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMDual>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="A1.E22.m1.5"/>
                                <XMRef idref="A1.E22.m1.6"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="exponential" role="OPFUNCTION" xml:id="A1.E22.m1.5">exp</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.E22.m1.6">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="A1.E22.m1.4"/>
                                        <XMRef idref="A1.E22.m1.6.1"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="A1.E22.m1.4">s</XMTok>
                                        <XMTok role="PUNCT">,</XMTok>
                                        <XMApp xml:id="A1.E22.m1.6.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT" rpadding="10.0pt">,</XMTok>
                      <XMApp xml:id="A1.E22.m1.9.2">
                        <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                        <XMApp>
                          <XMTok meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" role="UNKNOWN">i</XMTok>
                        </XMApp>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="closed-interval"/>
                            <XMRef idref="A1.E22.m1.8"/>
                            <XMRef idref="A1.E22.m1.9.2.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">[</XMTok>
                            <XMTok meaning="1" role="NUMBER" xml:id="A1.E22.m1.8">1</XMTok>
                            <XMTok role="PUNCT">,</XMTok>
                            <XMApp xml:id="A1.E22.m1.9.2.1">
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok name="cdots" role="ID">⋯</XMTok>
                              <XMTok font="italic" role="UNKNOWN">K</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">]</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="A1.SS7.p2">
        <p>We show the impacts of its value on performance in Figure <ref labelref="LABEL:fig:alpha"/>.
We have use a fixed value (<Math mode="inline" tex="\alpha^{-1}\!=\!10" text="alpha ^ (- 1) = 10" xml:id="A1.SS7.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP" rpadding="-1.7pt">=</XMTok>
                <XMApp rpadding="-1.7pt">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
              </XMApp>
            </XMath>
          </Math> for all antmaze tasks and <Math mode="inline" tex="\alpha^{-1}\!=\!3" text="alpha ^ (- 1) = 3" xml:id="A1.SS7.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP" rpadding="-1.7pt">=</XMTok>
                <XMApp rpadding="-1.7pt">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> for all locomotion tasks according to the IQL paper <cite class="ltx_citemacro_citep">(<bibref bibrefs="iql" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> (the <Math mode="inline" tex="\beta" text="beta" xml:id="A1.SS7.p2.m3">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> parameter of IQL).
Here we show the impacts of different values for <Math mode="inline" tex="\alpha^{-1}" text="alpha ^ (- 1)" xml:id="A1.SS7.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> by setting the inverse temperature
as <Math mode="inline" tex="0.5\alpha^{-1}" text="0.5 * alpha ^ (- 1)" xml:id="A1.SS7.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="1\alpha^{-1}" text="1 * alpha ^ (- 1)" xml:id="A1.SS7.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="2\alpha^{-1}" text="2 * alpha ^ (- 1)" xml:id="A1.SS7.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.
We note that other values are possible for different environments.
While it is impractical to tune this parameter for each task, it is possible to make it more adaptive
by auto-tuning in a way similar to the temperature turning scheme used in SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:alpha" placement="h" xml:id="A1.F7">
        <tags>
          <tag>Figure 7</tag>
          <tag role="autoref">Figure 7</tag>
          <tag role="refnum">7</tag>
          <tag role="typerefnum">Figure 7</tag>
        </tags>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_temperature_antmaze-%&#10;umaze-diverse}&#10;\put(25.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{antmaze-%&#10;umaze-diverse}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F7.pic1"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="89.6pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_temperature_agg-antmaze-%&#10;medium-play}&#10;\put(22.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{antmaze-%&#10;medium-play}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F7.pic2"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_temperature_halfcheetah-%&#10;medium}&#10;\put(25.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{halfcheetah%&#10;-medium}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F7.pic3"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_temperature_hopper-%&#10;medium}&#10;\put(30.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{hopper-%&#10;medium}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F7.pic4"/>
        <toccaption class="ltx_centering"><tag close=" ">7</tag>Impact of inverse temperature <Math mode="inline" tex="\alpha^{-1}" text="alpha ^ (- 1)" xml:id="A1.F7.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Results with inverse temperature as <Math mode="inline" tex="0.5\alpha^{-1}" text="0.5 * alpha ^ (- 1)" xml:id="A1.F7.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="1\alpha^{-1}" text="1 * alpha ^ (- 1)" xml:id="A1.F7.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="2\alpha^{-1}" text="2 * alpha ^ (- 1)" xml:id="A1.F7.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> respectively.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 7</tag>Impact of inverse temperature <Math mode="inline" tex="\alpha^{-1}" text="alpha ^ (- 1)" xml:id="A1.F7.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Results with inverse temperature as <Math mode="inline" tex="0.5\alpha^{-1}" text="0.5 * alpha ^ (- 1)" xml:id="A1.F7.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="1\alpha^{-1}" text="1 * alpha ^ (- 1)" xml:id="A1.F7.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="2\alpha^{-1}" text="2 * alpha ^ (- 1)" xml:id="A1.F7.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> respectively.</caption>
      </figure>
      <para xml:id="A1.SS7.p3">
        <p><text font="bold">Impact of Policy Entropy</text>.
The entropy of <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS7.p3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> is auto-tuned to match a target entropy <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>,
which is empirically set as <Math mode="inline" tex="e_{\rm target}\triangleq-d" text="e _ target triangleq - d" xml:id="A1.SS7.p3.m2">
            <XMath>
              <XMApp>
                <XMTok name="triangleq" role="RELOP">≜</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok font="italic" role="UNKNOWN">d</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="d" text="d" xml:id="A1.SS7.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">d</XMTok>
            </XMath>
          </Math> denotes the dimensionality of action.
This is inherited from SAC and the same setting (<Math mode="inline" tex="-d" text="- d" xml:id="A1.SS7.p3.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                <XMTok font="italic" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMath>
          </Math>) is applied to all tasks.
To show the impact of different target entropy values, we experiment with three different
settings: <Math mode="inline" tex="0.5e_{\rm target}" text="0.5 * e _ target" xml:id="A1.SS7.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="1\cdot e_{\rm target}" text="1 cdot e _ target" xml:id="A1.SS7.p3.m6">
            <XMath>
              <XMApp>
                <XMTok name="cdot" role="MULOP">⋅</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="2e_{\rm target}" text="2 * e _ target" xml:id="A1.SS7.p3.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> on several tasks.
The results are summarized in Figure <ref labelref="LABEL:fig:entropy"/>.
It can be observed that overly small or large target entropy values could decrease the performance on some tasks.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:entropy" placement="h" xml:id="A1.F8">
        <tags>
          <tag>Figure 8</tag>
          <tag role="autoref">Figure 8</tag>
          <tag role="refnum">8</tag>
          <tag role="typerefnum">Figure 8</tag>
        </tags>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_entropy_antmaze-umaze-%&#10;diverse}&#10;\put(20.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{antmaze-%&#10;umaze-diverse}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F8.pic1"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_entropy_antmaze-medium-%&#10;play.pdf}&#10;\put(22.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{antmaze-%&#10;medium-play}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F8.pic2"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="91.1pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_entropy_halfcheetah-%&#10;medium.pdf}&#10;\put(25.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{halfcheetah%&#10;-medium}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F8.pic3"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="89.6pt" stroke="none" tex="\begin{overpic}[width=93.89418pt]{imgs/curve_ablation_entropy_hopper-medium.%&#10;pdf}&#10;\put(30.0,95.0){{\color[rgb]{0,0,0}{\scalebox{0.6}{\rotatebox{0.0}{hopper-%&#10;medium}}}}}&#10;\end{overpic}" width="94.0pt" xml:id="A1.F8.pic4"/>
        <toccaption class="ltx_centering"><tag close=" ">8</tag>Impact of policy entropy (SAC-based online stage). Results with target entropy as <Math mode="inline" tex="0.5e_{\rm target}" text="0.5 * e _ target" xml:id="A1.F8.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="1e_{\rm target}" text="1 * e _ target" xml:id="A1.F8.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="2e_{\rm target}" text="2 * e _ target" xml:id="A1.F8.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> respectively.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 8</tag>Impact of policy entropy (SAC-based online stage). Results with target entropy as <Math mode="inline" tex="0.5e_{\rm target}" text="0.5 * e _ target" xml:id="A1.F8.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="0.5" role="NUMBER">0.5</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="1e_{\rm target}" text="1 * e _ target" xml:id="A1.F8.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="2e_{\rm target}" text="2 * e _ target" xml:id="A1.F8.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                  <XMTok fontsize="70%" role="UNKNOWN">target</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> respectively.</caption>
      </figure>
    </subsection>
    <subsection inlist="toc" labels="LABEL:app:heterogeneous_results" xml:id="A1.SS8">
      <tags>
        <tag>A.8</tag>
        <tag role="autoref">subsection A.8</tag>
        <tag role="refnum">A.8</tag>
        <tag role="typerefnum">§A.8</tag>
      </tags>
      <title><tag close=" ">A.8</tag>More Results on Heterogeneous Offline-Online RL</title>
      <para xml:id="A1.SS8.p1">
        <p>Here we show detailed return curves for each task when using SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> as the backbone online RL algorithm.
The results are shown in Figure <ref labelref="LABEL:fig:d4rl_results_sac"/>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:d4rl_results_sac" placement="h" xml:id="A1.F9">
        <tags>
          <tag>Figure 9</tag>
          <tag role="autoref">Figure 9</tag>
          <tag role="refnum">9</tag>
          <tag role="typerefnum">Figure 9</tag>
        </tags>
        <picture class="ltx_centering" fill="none" height="242.8pt" stroke="none" tex="\begin{overpic}[width=398.33858pt]{imgs/figure9}&#10;\put(36.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{antmaze-%&#10;umaze}}}}}&#10;\end{overpic}" width="397.5pt" xml:id="A1.F9.pic1"/>
        <toccaption class="ltx_centering"><tag close=" ">9</tag><text font="bold">Return Curves</text> of different methods using SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> as the online RL backbone algorithm, including the Off2On method <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. The returns are normalized according to D4RL benchmark <cite class="ltx_citemacro_citep">(<bibref bibrefs="d4rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 9</tag><text font="bold">Return Curves</text> of different methods using SAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="sac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> as the online RL backbone algorithm, including the Off2On method <cite class="ltx_citemacro_citep">(<bibref bibrefs="balanced_replay" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. The returns are normalized according to D4RL benchmark <cite class="ltx_citemacro_citep">(<bibref bibrefs="d4rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>.</caption>
      </figure>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS9">
      <tags>
        <tag>A.9</tag>
        <tag role="autoref">subsection A.9</tag>
        <tag role="refnum">A.9</tag>
        <tag role="typerefnum">§A.9</tag>
      </tags>
      <title><tag close=" ">A.9</tag>Offline-Online Training with Reward-Free Offline Setting</title>
      <para xml:id="A1.SS9.p1">
        <p><!--  %****␣PEX_arxiv.tex␣Line␣1050␣**** -->We have shown using policy expansion for bridging offline IQL with online IQL/SAC in the main paper.
Here we further demonstrate the applicability of the proposed approach by using BC as the offline learning
module. We use IQL as the online module for illustration.
In this section, we further demonstrate the applicability of the proposed approach
to the setting with offline dataset without reward annotations.
This is sometimes an encountered setting in practice, where
plenty of offline data exist (e.g. from previous iteration of experiments or other agents),
but without reward annotations.
Since the offline dataset is only broadly related to the task and could potentially contain
irrelevant or noisy data (<emph font="italic">w.r.t.</emph> the current task in consideration), direct behavior cloning
could be sub-optimal.</p>
      </para>
      <para xml:id="A1.SS9.p2">
        <p>Standard offline RL methods are inapplicable for offline pre-training in this case.
We therefore use behavior cloning (<text font="typewriter bold">BC</text>) <cite class="ltx_citemacro_citep">(<bibref bibrefs="ALVINN" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which is a simple and widely used
approach for imitation learning.
After offline pre-training using <text font="typewriter bold">BC</text>, the offline policy <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS9.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> is obtained and
transferred to the second stage of online training.
In terms of Algorithm <ref labelref="LABEL:alg:algo"/>, only the policy loss <Math mode="inline" tex="L_{\pi_{\beta}}" text="L _ pi _ beta" xml:id="A1.SS9.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok font="italic" fontsize="50%" name="beta" role="UNKNOWN">β</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is present
in the offline training phase. The offline datasets not used
in online training since it has no rewards.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:d4rl_results_reward_free" placement="h" xml:id="A1.F10">
        <tags>
          <tag>Figure 10</tag>
          <tag role="autoref">Figure 10</tag>
          <tag role="refnum">10</tag>
          <tag role="typerefnum">Figure 10</tag>
        </tags>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="88.2pt" stroke="none" tex="\begin{overpic}[width=91.04872pt]{imgs/curve_bc_antmaze-umaze-v0.pdf}&#10;\put(36.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{antmaze-%&#10;umaze}}}}}&#10;\end{overpic}" width="91.1pt" xml:id="A1.F10.pic1"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="87.4pt" stroke="none" tex="\begin{overpic}[width=91.04872pt]{imgs/curve_bc_antmaze-umaze-diverse-v0.pdf}&#10;\put(28.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{antmaze-%&#10;umaze-diverse}}}}}&#10;\end{overpic}" width="91.1pt" xml:id="A1.F10.pic2"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="87.4pt" stroke="none" tex="\begin{overpic}[width=91.04872pt]{imgs/curve_bc_hopper-medium-v2.pdf}&#10;\put(33.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{hopper-%&#10;medium}}}}}&#10;\end{overpic}" width="91.1pt" xml:id="A1.F10.pic3"/>
        <picture class="ltx_centering ltx_figure_panel" fill="none" height="87.4pt" stroke="none" tex="\begin{overpic}[width=91.04872pt]{imgs/curve_bc_walker2d-medium-v2.pdf}&#10;\put(33.0,94.0){{\color[rgb]{0,0,0}{\scalebox{0.5}{\rotatebox{0.0}{walker2d-%&#10;medium}}}}}&#10;\end{overpic}" width="91.1pt" xml:id="A1.F10.pic4"/>
        <toccaption class="ltx_centering"><tag close=" ">10</tag><text font="bold">Return Curves</text> for reward-free offline pre-training setting.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 10</tag><text font="bold">Return Curves</text> for reward-free offline pre-training setting.</caption>
      </figure>
      <para xml:id="A1.SS9.p3">
        <p>We use subset of tasks from D4RL <cite class="ltx_citemacro_citep">(<bibref bibrefs="d4rl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> where <text font="typewriter bold">BC</text> has non-trivial performances.
The results are shown in Figure <ref labelref="LABEL:fig:d4rl_results_reward_free"/>.
It can be observed that <text font="typewriter bold">JSRL</text>, which performs well under the case of having offline rewards,
performs less well in the reward-free case.
One potential reason is that it hinges on the offline policy to induce the state distribution <cite class="ltx_citemacro_citep">(<bibref bibrefs="jump_start_RL" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. In the case where the offline policy is not highly performant, as the
case here obtained from <text font="typewriter bold">BC</text>, its effectiveness could be compromised.
<text font="typewriter bold">BT</text> performs comparable to or better than <text font="typewriter bold">Direct</text> online fine-tuning with IQL, potentially due to the fact that <text font="typewriter bold">BT</text> leverage the <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS9.p3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math><!--  %****␣PEX_arxiv.tex␣Line␣1100␣**** --> in a way that has a shorter
commitment length for each time the offline policy is selected.
The proposed approach also shows similar online improvements comparable or sometimes better than the best performing methods.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A1.SS10">
      <tags>
        <tag>A.10</tag>
        <tag role="autoref">subsection A.10</tag>
        <tag role="refnum">A.10</tag>
        <tag role="typerefnum">§A.10</tag>
      </tags>
      <title><tag close=" ">A.10</tag>Policy Usage</title>
      <para xml:id="A1.SS10.p1">
        <p>We show the policy usage of <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.SS10.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.SS10.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> during online unroll along the process of one training session for <text font="typewriter bold">BT</text> and <text font="typewriter bold">JSRL</text> as well as <text font="typewriter bold">BC-PEX</text> (pre-trained with BC) and <text font="typewriter bold">IQL-PEX</text> (pre-trained with IQL) in Figure <ref labelref="LABEL:fig:policy_usage"/>.
The return curves of <text font="typewriter bold">BC-PEX</text> are shown in Figure <ref labelref="LABEL:fig:d4rl_results_reward_free"/>.
The corresponding return curves of <text font="typewriter bold">IQL-PEX</text> are shown in Figure <ref labelref="LABEL:fig:d4rl_results"/>.
As can be observed, the usage of offline policy is changing along the course of training, and the dynamics of the usage evolution is different for different tasks.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:policy_usage" placement="h" xml:id="A1.F11">
        <tags>
          <tag>Figure 11</tag>
          <tag role="autoref">Figure 11</tag>
          <tag role="refnum">11</tag>
          <tag role="typerefnum">Figure 11</tag>
        </tags>
        <picture class="ltx_centering" fill="none" height="366.4pt" stroke="none" tex="\begin{overpic}[width=398.33858pt]{imgs/figure11}&#10;\end{overpic}" width="397.5pt" xml:id="A1.F11.pic1"/>
<!--  %****␣PEX_arxiv.tex␣Line␣1125␣**** -->        <toccaption class="ltx_centering"><tag close=" ">11</tag><text font="bold">Policy Usage</text> of <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.F11.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.F11.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> along the process of online training for different methods.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 11</tag><text font="bold">Policy Usage</text> of <Math mode="inline" tex="\pi_{\beta}" text="pi _ beta" xml:id="A1.F11.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="beta" role="UNKNOWN">β</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="A1.F11.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
              </XMApp>
            </XMath>
          </Math> along the process of online training for different methods.</caption>
      </figure>
    </subsection>
  </appendix>
</document>
