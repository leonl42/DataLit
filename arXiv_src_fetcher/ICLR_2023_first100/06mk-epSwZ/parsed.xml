<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/DataLit/arXiv_src_fetcher/ICLR_2023_first100/06mk-epSwZ"?>
<?latexml class="article"?>
<?latexml package="iclr2023_conference,times"?>
<?latexml package="amsmath,amsfonts,bm"?>
<?latexml package="graphicx"?>
<?latexml package="wrapfig"?>
<?latexml package="makecell"?>
<?latexml package="caption"?>
<?latexml package="subcaption"?>
<?latexml package="booktabs"?>
<?latexml package="amssymb"?>
<?latexml package="algorithm"?>
<?latexml package="algpseudocode"?>
<?latexml package="algorithmicx"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<?latexml package="hyperref"?>
<?latexml package="url"?>
<?latexml package="xcolor"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <para xml:id="p1">
    <ERROR class="undefined">\definecolor</ERROR>
    <p>myredHTMLA23216
<ERROR class="undefined">\definecolor</ERROR>mygreenHTML1E7167

















































































<ERROR class="undefined">\iclrfinalcopy</ERROR></p>
  </para>
  <title>DiffMimic: Efficient Motion Mimicking with Differentiable Physics</title>
  <creator role="author">
    <personname>
Jiawei Ren<Math mode="inline" tex="\hskip 3.80005pt{}^{1}" text="^1" xml:id="m1">
        <XMath>
          <XMApp lpadding="3.8pt" role="FLOATSUPERSCRIPT" scriptpos="1">
            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
          </XMApp>
        </XMath>
      </Math>
 Cunjun Yu<sup><text font="italic">∗2</text></sup>
 Siwei Chen<sup><text font="italic">2</text></sup>
 Xiao Ma<sup><text font="italic">3</text></sup><!--  %**** main.tex Line 25 **** -->
 Liang Pan<sup><text font="italic">1</text></sup>
 Ziwei Liu<sup><text font="italic">1</text></sup> <break/><sup>1</sup> S-Lab, Nanyang Technological University <break/><sup>2</sup> School of Computing, National University of Singapore<break/><sup>3</sup> SEA AI Lab</personname>
    <contact role="thanks">Equal contribution, listed in alphabetical order.
</contact>
  </creator>
  <abstract name="Abstract">
    <p>Motion mimicking is a foundational task in physics-based character animation. However, most existing motion mimicking methods are built upon reinforcement learning (RL) and suffer from heavy reward engineering, high variance, and slow convergence with hard explorations. Specifically, they usually take tens of hours or even days of training to mimic a simple motion sequence, resulting in poor scalability. In this work, we leverage differentiable physics simulators (DPS) and propose an efficient motion mimicking method dubbed <text class="ltx_markedasmath" font="bold">DiffMimic</text>. Our key insight is that DPS casts a complex policy learning task to a much simpler state matching problem. In particular, DPS learns a stable policy by analytical gradients with ground-truth physical priors hence leading to significantly faster and stabler convergence than RL-based methods. Moreover, to escape from local optima, we utilize an <text font="italic">Demonstration Replay</text> mechanism to enable stable gradient backpropagation in a long horizon. Extensive experiments on standard benchmarks show that DiffMimic has a better sample efficiency and time efficiency than existing methods (<emph font="italic">e.g.</emph>, DeepMimic). Notably, DiffMimic allows a physically simulated character to learn Backflip after 10 minutes of training and be able to cycle it after 3 hours of training, while the existing approach may require about a day of training to cycle Backflip. More importantly, we hope DiffMimic can benefit more differentiable animation systems with techniques like differentiable clothes simulation in future research.
<note mark="1" role="footnote" xml:id="footnote1"><tags>
          <tag>1</tag>
          <tag role="autoref">footnote 1</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">footnote 1</tag>
        </tags>Our code is available at <ref class="ltx_href" href="https://github.com/jiawei-ren/diffmimic">https://github.com/jiawei-ren/diffmimic</ref>.</note>
<note mark="2" role="footnote" xml:id="footnote2"><tags>
          <tag>2</tag>
          <tag role="autoref">footnote 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">footnote 2</tag>
        </tags>Qualitative results can be viewed at <ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlitapp.com/">https://diffmimic-demo-main-g7h0i8.streamlitapp.com/</ref>.</note></p>
  </abstract>
  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>Motion mimicking aims to find a policy to generate control signals for recovering demonstrated motion trajectories, which plays a fundamental role in physics-based character animation, and also serves as a prerequisite for many applications such as control stylization and skill composition.
Although tremendous progress in motion mimicking has been witnessed in recent years, existing methods <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic,peng2021amp" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> mostly adopt reinforcement learning (RL) schemes, which require alternatively learning a reward function and a control policy.
Consequently, RL-based methods often take tens of hours or even days to imitate one single motion sequence, making their scalability notoriously challenging.
In addition, RL-based motion mimicking highly relies on the quality of its designed  <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or learned <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2021amp" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> reward functions, which further burdens its generalization for complex real-world applications.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Recently, differential physics simulator (DPS) has achieved impressive results in many research fields, such as robot control <cite class="ltx_citemacro_citep">(<bibref bibrefs="xu2022accelerated" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and graphics <cite class="ltx_citemacro_citep">(<bibref bibrefs="li2022diffcloth" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Specifically, DPS treats physics operators as differentiable computational graphs, and therefore gradients from objectives (<text font="italic">i.e.</text>, rewards) can be directly propagated through the environment dynamics to control policy functions.
Instead of alternatively learning between reward functions and control policies, the control policy learning tasks can be resolved in a straightforward and efficient optimization manner with the help of DPS.
However, despite their analytical environment gradients, optimization with DPS could easily get into local optima, particularly in contact-rich physical systems that often yield stiff and discontinuous gradients <cite class="ltx_citemacro_citep">(<bibref bibrefs="freeman2021brax,suh2022does,zhong2022differentiable" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.
Besides, numerical gradients could also vanish/explode along the backward path for long trajectories.</p>
    </para>
    <para xml:id="S1.p3">
      <p><!--  %**** 1˙introduction.tex Line 25 **** -->In this work, we propose DiffMimic, a fast and stable motion mimicking method with the help of DPS.
Different from RL-based methods that require heavy reward engineering and poor sample efficiency, DiffMimic reformulates motion mimicking as a state matching problem, which could directly minimize the distance between a rollout trajectory generated by the current learning policy and the demonstrated trajectory.
Thanks to the differentiable DPS dynamics, gradients of the trajectory distance can be directly propagated to optimize the control policy.
As a result, DiffMimic could significantly improve the sample efficiency with the first-order gradients.</p>
    </para>
    <para xml:id="S1.p4">
      <p>However, simply utilizing DPS could not guarantee global optimal solutions.
In particular, the rollout trajectory tends to gradually deviate from the expert demonstration and could produce a large accumulative error for long motion sequences, due to the distributional shift between the learning policy and expert policy.
To address these problems, we introduce the <text font="italic">Demonstration Replay</text> training strategy, which randomly inserts reference states into the rollout trajectory as anchor states to guide the exploration of the policy.
Empirically, Demonstration Replay gives a smoother gradient estimation, which significantly stabilizes the policy learning of DiffMimic.</p>
    </para>
    <para xml:id="S1.p5">
      <p>To the best of our knowledge, DiffMimic is the first to utilize DPS for motion mimicking. We show that DiffMimic outperforms several commonly used RL-based methods for motion mimicking on a variety of tasks with high accuracy, stability, and efficiency. In particular, DiffMimic allows learning a challenging <text font="italic">Backflip</text> motion in only 10 minutes on a single V100 GPU.
In addition, we release the DiffMimic simulator as a standard benchmark to encourage future research for motion mimicking.</p>
    </para>
    <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:teaser" placement="t" xml:id="S1.F1">
      <graphics candidates="figures/teaser.pdf" class="ltx_figure_panel" graphic="figures/teaser.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S1.g1"/>
      <tags>
        <tag><text fontsize="90%">Figure 1</text></tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <toccaption><tag close=" ">1</tag>Overview of our method. <text font="bold">Left:</text> DiffMimic formulates motion mimicking as a straightforward state matching problem and uses analytical gradients to optimize it with off-the-shelf differentiable physics simulators. The formulation results in a simple optimization objective compared to heavy reward engineering in RL-based methods. <text font="bold">Middle:</text> DiffMimic is able to mimic highly dynamic skills, <emph font="italic">e.g.</emph>, Side-Flip. <text font="bold">Right:</text> DiffMimic has a significantly better sample efficiency and time efficiency than state-of-the-art motion mimicking methods. Our approach usually achieves high-quality motion (pose error <Math mode="inline" tex="&lt;" text="&lt;" xml:id="S1.F1.m1">
          <XMath>
            <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
          </XMath>
        </Math> 0.15 meter) using less than <Math mode="inline" tex="2\times 10^{7}" text="2 * 10 ^ 7" xml:id="S1.F1.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">×</XMTok>
              <XMTok meaning="2" role="NUMBER">2</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMTok fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> samples. </toccaption>
      <caption><tag close=": "><text fontsize="90%">Figure 1</text></tag><text fontsize="90%">Overview of our method. <text font="bold">Left:</text> DiffMimic formulates motion mimicking as a straightforward state matching problem and uses analytical gradients to optimize it with off-the-shelf differentiable physics simulators. The formulation results in a simple optimization objective compared to heavy reward engineering in RL-based methods. <text font="bold">Middle:</text> DiffMimic is able to mimic highly dynamic skills, <emph font="italic">e.g.</emph>, Side-Flip. <text font="bold">Right:</text> DiffMimic has a significantly better sample efficiency and time efficiency than state-of-the-art motion mimicking methods. Our approach usually achieves high-quality motion (pose error <Math mode="inline" tex="&lt;" text="&lt;" xml:id="S1.F1.m3">
            <XMath>
              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
            </XMath>
          </Math> 0.15 meter) using less than <Math mode="inline" tex="2\times 10^{7}" text="2 * 10 ^ 7" xml:id="S1.F1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> samples. </text></caption>
    </figure>
  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Related Work</title>
    <para xml:id="S2.p1">
      <p><text font="bold">Motion Mimicking.</text>
Motion mimicking is a technique used to produce realistic animations in physics-based characters by learning skills from motion captures <cite class="ltx_citemacro_citep">(<bibref bibrefs="hong2019physics,peng2018deepmimic,peng2018sfv,lee2019scalable" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. This approach has been applied to various downstream tasks in physics-based animation, including generating new motions by recombining primitive actions <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2019mcp,luo2020carl" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, achieving specific goals <cite class="ltx_citemacro_citep">(<bibref bibrefs="bergamin2019drecon,park2019learning,peng2021amp" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, and as a pre-training method for general-purpose motor skills <cite class="ltx_citemacro_citep">(<bibref bibrefs="merel2018hierarchical,hasenclever2020comic,peng2022ase,won2022physics" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. The scalability of these tasks can be limited by the motion mimicking process, which is a key part of the pipeline in approaches like ScaDiver <cite class="ltx_citemacro_citep">(<bibref bibrefs="won2020scalable" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. In this work, we demonstrate that the problem of scalability can be addressed using differentiable dynamics.</p>
    </para>
    <para xml:id="S2.p2">
      <p><text font="bold">Speeding Up Motion Mimicking</text>
Most motion mimicking works are based on a DRL framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic,bergamin2019drecon" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, whose optimization is expensive. Several recent works speed up the DRL process by hyper-parameter searching <cite class="ltx_citemacro_citep">(<bibref bibrefs="yang2021efficient" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and constraint relaxation <cite class="ltx_citemacro_citep">(<bibref bibrefs="ma2021learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Another line of work learns world models to achieve end-to-end gradient optimization <cite class="ltx_citemacro_citep">(<bibref bibrefs="won2022physics,fussell2021supertrack" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. However, learning world models requires extra training and introduces the risk of error accumulation. We are the first to use the off-the-shelf DPS for motion mimicking, which achieves better sample efficiency than optimized DRL frameworks and requires no additional world models.</p>
    </para>
    <para xml:id="S2.p3">
      <p><text font="bold">Differentiable Physics.</text>
Differentiable physics gains traction recently with the emerging differentiable physics simulators (DPS) <cite class="ltx_citemacro_citep">(<bibref bibrefs="hu2019chainqueen,hu2019difftaichi,huang2021plasticinelab,qiao2021differentiable" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. It has brought success in many domains and provides a distinctly new approach to control tasks. Supertrack <cite class="ltx_citemacro_citep">(<bibref bibrefs="fussell2021supertrack" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> proposes to learn a world model to approximate the differentiable physics and has achieved promising results. However, its policy horizon is limited during training due to the accumulation of errors in the world model.
Various applications stem from DPS like system identification <cite class="ltx_citemacro_citep">(<bibref bibrefs="gradsim" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, continuous controls <cite class="ltx_citemacro_citep">(<bibref bibrefs="lin2022diffskill,xu2022accelerated" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> in the past few years and demonstrate promising results. Compared to black-box counterparts which learn the dynamics with neural networks <cite class="ltx_citemacro_citep">(<bibref bibrefs="fussell2021supertrack,li2020visual" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, differentiable simulations utilize physical models to provide more reliable gradients with better interpretability. On the other hand, the analytical gradient from DPS suffers from noise or can sometimes be wrong <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhong2022differentiable,suh2022does" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> in a contact-rich environment. Non-smoothness or discontinuity in the contact event requires specific techniques to compute the gradient. However, they often introduce noise into the gradient <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhong2022differentiable" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Thus, in this work, we empirically show how to handle the noise in the gradient in a contact-rich environment for motion mimicking.</p>
    </para>
    <para xml:id="S2.p4">
      <p><text font="bold">Policy Optimization with Differentiable Physics Simulators.</text> The integration of differentiable simulators in policy optimization has been a significant advancement in reinforcement learning. With analytical gradient calculation, the sample efficiency of policy learning is significantly improved <cite class="ltx_citemacro_citep">(<bibref bibrefs="Mozer1989AFB,pmlr-v139-mora21a,xu2022accelerated" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. However, the implementation is challenged by the presence of noisy gradients and the risk of exploding or vanishing gradients <cite class="ltx_citemacro_citep">(<bibref bibrefs="Degrave2017ADP" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. The policy may also get stuck at sub-optimal points due to the local nature of the gradient. To address these issues, various approaches have been proposed. SHAC <cite class="ltx_citemacro_citep">(<bibref bibrefs="xu2022accelerated" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> truncates trajectories into smaller segments to prevent exploding or vanishing gradients, but this requires careful design. On the other hand, PODS <cite class="ltx_citemacro_citep">(<bibref bibrefs="pmlr-v139-mora21a" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> utilizes second-order gradients, leading to monotonic policy improvement and faster convergence compared to first-order methods. However, it relies on strong assumptions about the second-order derivatives of the differentiable simulator and is sensitive to their accuracy. An alternative approach is the Imitation Learning framework with DPS proposed by ILD <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2022imitation" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Although it is simple and effective for robot control, it struggles with the exploration of highly dynamic motions. To tackle these challenges, we introduce a replay mechanism to enhance its performance.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Methodology</title>
    <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:computation_graph" placement="t" xml:id="S3.F2">
      <graphics candidates="figures/Demo_Replay.pdf" class="ltx_figure_panel" graphic="figures/Demo_Replay.pdf" options="width=390.25534pt,keepaspectratio=true" xml:id="S3.g1"/>
      <tags>
        <tag><text fontsize="90%">Figure 2</text></tag>
        <tag role="autoref">Figure 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <toccaption><tag close=" ">2</tag>Computation graph of DiffMimic. An example of demonstration replay during the third step is demonstrated. The demonstration state in the third step is used to replace the simulated state.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Figure 2</text></tag><text fontsize="90%">Computation graph of DiffMimic. An example of demonstration replay during the third step is demonstrated. The demonstration state in the third step is used to replace the simulated state.</text></caption>
    </figure>
    <subsection inlist="toc" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>A Motion Mimicking Environment in Differentiable Physics Engine.</title>
      <para xml:id="S3.SS1.p1">
        <p><text font="bold">Environment.</text> We build our environment in Brax <cite class="ltx_citemacro_citep">(<bibref bibrefs="freeman2021brax" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. We design our simulated character following DeepMimic <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. The humanoid character has 13 links and 34 degrees of freedom. The character has a weight of 45 kg and a height of 1.62m. Contact is applied to all links with the floor. The environment is accelerated by GPU parallelization. The physics simulator updates at a rate of 480 FPS. The joint limits of the character are relaxed to allow smoother gradient propagation. We keep the system configurations like friction coefficients consistent with DeepMimic.</p>
      </para>
      <para xml:id="S3.SS1.p2">
        <p><text font="bold">State and Action.</text> States include the position <Math mode="inline" tex="p" text="p" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
            </XMath>
          </Math>, rotation <Math mode="inline" tex="q" text="q" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math>, linear velocity <Math mode="inline" tex="\dot{p}" text="dot@(p)" xml:id="S3.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> and angular velocity <Math mode="inline" tex="\dot{q}" text="dot@(q)" xml:id="S3.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> of all links in the local coordinate. Additionally, following <cite class="ltx_citemacro_citet"><bibref bibrefs="peng2018deepmimic" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, a phase variable <Math mode="inline" tex="\phi" text="phi" xml:id="S3.SS1.p2.m5">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math> in the range <Math mode="inline" tex="[0,1]" text="closed-interval@(0, 1)" xml:id="S3.SS1.p2.m6">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S3.SS1.p2.m6.1"/>
                  <XMRef idref="S3.SS1.p2.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.p2.m6.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S3.SS1.p2.m6.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> is included in the state to serve as a timestamp. Thus, the state of the environment, <Math mode="inline" tex="s" text="s" xml:id="S3.SS1.p2.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
            </XMath>
          </Math>, contains the aforementioned information, <Math mode="inline" tex="s:=\{p,q,\dot{p},\dot{q},\phi\}" text="s assign set@(p, q, dot@(p), dot@(q), phi)" xml:id="S3.SS1.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="assign" role="RELOP">:=</XMTok>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS1.p2.m8.1"/>
                    <XMRef idref="S3.SS1.p2.m8.2"/>
                    <XMRef idref="S3.SS1.p2.m8.3"/>
                    <XMRef idref="S3.SS1.p2.m8.4"/>
                    <XMRef idref="S3.SS1.p2.m8.5"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m8.1">p</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.SS1.p2.m8.2">q</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p2.m8.3">
                      <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS1.p2.m8.4">
                      <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.SS1.p2.m8.5">ϕ</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. We follow the common practice and use PD controllers to drive the character. Given the current joint angle <Math mode="inline" tex="q" text="q" xml:id="S3.SS1.p2.m9">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">q</XMTok>
            </XMath>
          </Math>, angular velocity <Math mode="inline" tex="\dot{q}" text="dot@(q)" xml:id="S3.SS1.p2.m10">
            <XMath>
              <XMApp>
                <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math> and a target angle <Math mode="inline" tex="\tilde{q}" text="tilde@(q)" xml:id="S3.SS1.p2.m11">
            <XMath>
              <XMApp>
                <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
              </XMApp>
            </XMath>
          </Math>, the torque on the actuator of the joint will be computed as:</p>
        <equationgroup class="ltx_eqn_align" xml:id="A12.EGx1">
          <equation xml:id="S3.E1">
            <tags>
              <tag>(3.1)</tag>
              <tag role="autoref">Equation 3.1</tag>
              <tag role="refnum">3.1</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\tau=k_{p}(\tilde{q}-q)+k_{d}(\tilde{\dot{q}}-\dot{q})," text="tau = k _ p * (tilde@(q) - q) + k _ d * (tilde@(dot@(q)) - dot@(q))" xml:id="S3.E1.m2">
                <XMath>
                  <XMDual>
                    <XMRef idref="S3.E1.m2.1"/>
                    <XMWrap>
                      <XMApp xml:id="S3.E1.m2.1">
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                        <XMApp>
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S3.E1.m2.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E1.m2.1.1">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                  <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">k</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S3.E1.m2.1.2"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E1.m2.1.2">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMApp>
                                    <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                    <XMApp>
                                      <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle\tau=k_{p}(\tilde{q}-q)+k_{d}(\tilde{\dot{q}}-\dot{q})," text="tau = k _ p * (tilde@(q) - q) + k _ d * (tilde@(dot@(q)) - dot@(q))" xml:id="S3.E1.m1">
                    <XMath>
                      <XMDual>
                        <XMRef idref="S3.E1.m1.1"/>
                        <XMWrap>
                          <XMApp xml:id="S3.E1.m1.1">
                            <XMTok meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                            <XMApp>
                              <XMTok meaning="plus" role="ADDOP">+</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.E1.m1.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E1.m1.1.1">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">k</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.E1.m1.1.2"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E1.m1.1.2">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMApp>
                                        <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                                        <XMApp>
                                          <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\tilde{\dot{q}}=0" text="tilde@(dot@(q)) = 0" xml:id="S3.SS1.p2.m12">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok name="tilde" role="OVERACCENT" stretchy="false">~</XMTok>
                  <XMApp>
                    <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                    <XMTok font="italic" role="UNKNOWN">q</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="k_{p}" text="k _ p" xml:id="S3.SS1.p2.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="k_{d}" text="k _ d" xml:id="S3.SS1.p2.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMath>
          </Math> are manually-specified gains of the PD controller. We keep <Math mode="inline" tex="k_{p}" text="k _ p" xml:id="S3.SS1.p2.m15">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="k_{d}" text="k _ d" xml:id="S3.SS1.p2.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">k</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">d</XMTok>
              </XMApp>
            </XMath>
          </Math> identical to the PD controller used in DeepMimic. A policy network predicts the target angle for the PD controller at each joint. The control policy operates at 30 FPS.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Motion Mimicking with Differentiable Physics</title>
      <para xml:id="S3.SS2.p1">
        <ERROR class="undefined">\algdef</ERROR>
        <p>SE[SUBALG]IndentEndIndent<ERROR class="undefined">\algorithmicend</ERROR> <ERROR class="undefined">\algtext</ERROR>*Indent
<ERROR class="undefined">\algtext</ERROR>*EndIndent</p>
      </para>
      <figure class="ltx_minipage" float="right" inlist="lof" labels="LABEL:alg:DIL" vattach="middle" width="238.5pt" xml:id="S3.F3.fig1">
        <tags>
          <tag><text fontsize="90%">Figure 3</text></tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <ERROR class="ltx_figure_panel undefined">{algorithm}</ERROR>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">[H]
<ERROR class="undefined">\lx@orig@algorithmic</ERROR><text fontsize="90%">[1]
<ERROR class="undefined">\State</ERROR><text font="bold">Input:</text> Optimization Iteration I, Episode Length T, Reference States <Math mode="inline" tex="\hat{S}=\{\hat{s}_{1},\hat{s}_{2},\cdots,\hat{s}_{t}\}" text="hat@(S) = set@((hat@(s)) _ 1, (hat@(s)) _ 2, cdots, (hat@(s)) _ t)" xml:id="S3.F3.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" role="UNKNOWN">S</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S3.F3.m1.2"/>
                      <XMRef idref="S3.F3.m1.3"/>
                      <XMRef idref="S3.F3.m1.1"/>
                      <XMRef idref="S3.F3.m1.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S3.F3.m1.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S3.F3.m1.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok name="cdots" role="ID" xml:id="S3.F3.m1.1">⋯</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S3.F3.m1.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMath>
            </Math>, Error Threshold <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="S3.F3.m2">
              <XMath>
                <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
              </XMath>
            </Math>.
<ERROR class="undefined">\State</ERROR><text font="bold">Output:</text> Optimized policy
<ERROR class="undefined">\State</ERROR>Initialize the stochastic policy as <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S3.F3.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
              </XMath>
            </Math>.
<ERROR class="undefined">\For</ERROR> optimization iteration <Math mode="inline" tex="i=1\cdots I" text="i = 1 * cdots * I" xml:id="S3.F3.m4">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">i</XMTok>
                  <XMApp>
                    <XMTok fontsize="111%" meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                    <XMTok name="cdots" role="ID">⋯</XMTok>
                    <XMTok font="italic" role="UNKNOWN">I</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
<ERROR class="undefined">\State</ERROR># Roll out trajectories with Expert Replay
<ERROR class="undefined">\State</ERROR>Initialize <Math mode="inline" tex="s_{1}\leftarrow\hat{s}_{1}" text="s _ 1 leftarrow (hat@(s)) _ 1" xml:id="S3.F3.m5">
              <XMath>
                <XMApp>
                  <XMTok name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
<ERROR class="undefined">\For</ERROR> step <Math mode="inline" tex="t=1\cdots T-1" text="t = 1 * cdots * T - 1" xml:id="S3.F3.m6">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMApp>
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok fontsize="111%" meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                      <XMTok name="cdots" role="ID">⋯</XMTok>
                      <XMTok font="italic" role="UNKNOWN">T</XMTok>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></text></p>
        <toccaption><tag close=" "><text fontsize="90%">3</text></tag><text fontsize="90%">DiffMimic</text></toccaption>
        <caption fontsize="90%"><tag close=": ">Figure 3</tag>DiffMimic</caption>
        <equation class="ltx_figure_panel" xml:id="S3.Ex1">
          <Math mode="display" tex="s_{t+1}=\begin{cases}\mathcal{T}(s_{t},a_{t}),\;a_{t}\sim\pi_{\theta}(a|s_{t})%&#10;&amp;\text{if}\;\|s_{t}-\hat{s}_{t}\|_{2}^{2}&lt;\epsilon\\&#10;\mathcal{T}(\hat{s}_{t},a_{t}),\;a_{t}\sim\pi_{\theta}(a|\hat{s}_{t})&amp;\text{%&#10;otherwise.}\end{cases}" text="s _ (t + 1) = cases@(list@(T * open-interval@(s _ t, a _ t), a _ t) similar-to pi _ theta * conditional@(a, s _ t), [if] * ((norm@(s _ t - (hat@(s)) _ t)) _ 2) ^ 2 &lt; epsilon, list@(T * open-interval@((hat@(s)) _ t, a _ t), a _ t) similar-to pi _ theta * conditional@(a, (hat@(s)) _ t), [otherwise.])" xml:id="S3.Ex1.m1">
            <XMath>
              <XMApp>
                <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="63%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="63%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="cases"/>
                    <XMRef idref="S3.Ex1.m1.1"/>
                    <XMRef idref="S3.Ex1.m1.2"/>
                    <XMRef idref="S3.Ex1.m1.3"/>
                    <XMRef idref="S3.Ex1.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok fontsize="90%" role="OPEN" stretchy="true">{</XMTok>
                    <XMArray>
                      <XMRow>
                        <XMCell align="left">
                          <XMApp xml:id="S3.Ex1.m1.1">
                            <XMTok fontsize="90%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.Ex1.m1.1.1"/>
                                <XMRef idref="S3.Ex1.m1.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.Ex1.m1.1.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.Ex1.m1.1.1.1"/>
                                      <XMRef idref="S3.Ex1.m1.1.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.Ex1.m1.1.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.Ex1.m1.1.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok fontsize="90%" role="PUNCT" rpadding="2.8pt">,</XMTok>
                                <XMApp xml:id="S3.Ex1.m1.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                <XMTok font="italic" fontsize="90%" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="63%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.Ex1.m1.1.3"/>
                                <XMWrap>
                                  <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.Ex1.m1.1.3">
                                    <XMTok fontsize="90%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                      <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMApp xml:id="S3.Ex1.m1.2">
                            <XMTok fontsize="90%" meaning="less-than" role="RELOP">&lt;</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText rpadding="2.8pt"><text fontsize="90%">if</text></XMText>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="norm"/>
                                      <XMRef idref="S3.Ex1.m1.2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="90%" name="||" role="OPEN">‖</XMTok>
                                      <XMApp xml:id="S3.Ex1.m1.2.1">
                                        <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                          <XMApp>
                                            <XMTok fontsize="90%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                            <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok fontsize="90%" name="||" role="CLOSE">‖</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="63%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok fontsize="63%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" fontsize="90%" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                          </XMApp>
                        </XMCell>
                      </XMRow>
                      <XMRow>
                        <XMCell align="left">
                          <XMApp xml:id="S3.Ex1.m1.3">
                            <XMTok fontsize="90%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.Ex1.m1.3.1"/>
                                <XMRef idref="S3.Ex1.m1.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.Ex1.m1.3.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.Ex1.m1.3.1.1"/>
                                      <XMRef idref="S3.Ex1.m1.3.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.Ex1.m1.3.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMApp>
                                          <XMTok fontsize="90%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.Ex1.m1.3.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok fontsize="90%" role="PUNCT" rpadding="2.8pt">,</XMTok>
                                <XMApp xml:id="S3.Ex1.m1.3.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                <XMTok font="italic" fontsize="90%" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="63%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.Ex1.m1.3.3"/>
                                <XMWrap>
                                  <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.Ex1.m1.3.3">
                                    <XMTok fontsize="90%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                      <XMApp>
                                        <XMTok fontsize="90%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMText xml:id="S3.Ex1.m1.4"><text fontsize="90%">otherwise.</text></XMText>
                        </XMCell>
                      </XMRow>
                    </XMArray>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <break class="ltx_break"/>
        <ERROR class="ltx_figure_panel undefined">\EndFor</ERROR>
<!--  %**** algo.tex Line 25 **** -->        <ERROR class="ltx_figure_panel undefined">\State</ERROR>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><text fontsize="90%">Compute loss
<Math mode="inline" tex="\mathcal{L}=\sum_{t=1}^{T}\|s_{t}-\hat{s}_{t}\|_{2}^{2}" text="L = ((sum _ (t = 1)) ^ T)@(((norm@(s _ t - (hat@(s)) _ t)) _ 2) ^ 2)" xml:id="S3.F3.m7">
              <XMath>
                <XMApp>
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="norm"/>
                            <XMRef idref="S3.F3.m7.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok name="||" role="OPEN">‖</XMTok>
                            <XMApp xml:id="S3.F3.m7.1">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMApp>
                                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok name="||" role="CLOSE">‖</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></text></p>
        <break class="ltx_break"/>
        <ERROR class="ltx_figure_panel undefined">\State</ERROR>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><text fontsize="90%">Update the policy <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S3.F3.m8">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                </XMApp>
              </XMath>
            </Math> with analytical gradient <Math mode="inline" tex="\bigtriangledown_{\theta}\mathcal{L}" text="bigtriangledown _ theta L" xml:id="S3.F3.m9">
              <XMath>
                <XMApp>
                  <XMApp role="ADDOP">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok name="bigtriangledown" role="ADDOP">▽</XMTok>
                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                  <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                </XMApp>
              </XMath>
            </Math>.</text></p>
        <break class="ltx_break"/>
        <ERROR class="ltx_figure_panel undefined">\EndFor</ERROR>
        <ERROR class="ltx_figure_panel undefined">\State</ERROR>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><text font="bold" fontsize="90%">Return<text font="medium"> the policy <Math mode="inline" tex="\pi_{\theta}" text="pi _ theta" xml:id="S3.F3.m10">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                  </XMApp>
                </XMath>
              </Math>.


</text></text></p>
      </figure>
      <para xml:id="S3.SS2.p2">
        <p>Motion Mimicking is about matching the policy rollout with the reference motion. While it has a straightforward objective, considering human action can be rich and highly flexible, designing a reward to incentivize and guide policy learning is not easy. For example, reward functions that are tailored to guide a policy to learn to walk or learn to backflip can be different and this makes reward engineering difficult. We reveal that the mimicking task can be surprisingly easy when analytical gradients can be obtained through DPS.</p>
      </para>
      <para xml:id="S3.SS2.p3">
        <p>The underlying idea of DiffMimic is to allow the gradient to directly flow back from the distance between reference motion and policy rollout to the policy through an off-the-shelf DPS. We show the computation graph of DiffMimic in Fig. <ref labelref="LABEL:fig:computation_graph"/><!--  %**** 3˙method.tex Line 25 **** -->.
Compared with existing RL-based approaches, DiffMimic directly optimizes the policy with supervised state-matching signals and largely eases the reward engineering.
Thanks to the analytical gradient, such an approach has a very high sample efficiency.
Prior works <cite class="ltx_citemacro_citep">(<bibref bibrefs="fussell2021supertrack" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> explored analytic gradients with a learned differentiable world model which describes the dynamics in latent space. However, the learned world model reveals no underlying physics of the system. Consequently, they undermine the effectiveness, generality, and interpretability of the learning with physics-based analytic gradients from DPS, as in DiffMimic. In addition, online learning and inference with learned world models remain computationally expensive when compared with DPS.</p>
      </para>
      <para xml:id="S3.SS2.p4">
        <p>We show in detail how to train the policy with DPS. For each iteration, we initialize the state to the first reference state and then roll out to the maximum episode length in a batch of parallel environments. Then we compute the step-wise L2 distance between the rollout trajectory and the reference trajectory in terms of positions and rotations:</p>
        <equation labels="LABEL:eq:reward" xml:id="S3.E2">
          <tags>
            <tag>(3.2)</tag>
            <tag role="autoref">Equation 3.2</tag>
            <tag role="refnum">3.2</tag>
          </tags>
          <Math mode="display" tex="\begin{gathered}\tiny\mathcal{L}=\sum_{t=1}^{T}\|s_{t}-\hat{s}_{t}\|_{2}^{2},%&#10;\\&#10;\|s_{t}-\hat{s}_{t}\|_{2}^{2}\triangleq\frac{1}{\|J\|}\sum_{j\in J}w_{p}(p^{j}%&#10;-\hat{p}^{j})^{2}+w_{r}(q^{j}-\hat{q}^{j})^{2}+w_{v}(\dot{p}^{j}-\hat{\dot{p}}%&#10;^{j})^{2}+w_{a}(\dot{q}^{j}-\hat{\dot{q}}^{j})^{2},\end{gathered}" text="formulae@(L = ((sum _ (t = 1)) ^ T)@(((delimited-∥∥@(s _ t - (hat@(s)) _ t)) _ 2) ^ 2), ((delimited-∥∥@(s _ t - (hat@(s)) _ t)) _ 2) ^ 2 triangleq (1 / norm@(J)) * (sum _ (j element-of J))@(w _ p * (p ^ j - (hat@(p)) ^ j) ^ 2) + w _ r * (q ^ j - (hat@(q)) ^ j) ^ 2 + w _ v * ((dot@(p)) ^ j - (hat@(dot@(p))) ^ j) ^ 2 + w _ a * ((dot@(q)) ^ j - (hat@(dot@(q))) ^ j) ^ 2)" xml:id="S3.E2.m1">
            <XMath>
              <XMDual>
                <XMDual>
                  <XMRef idref="S3.E2.m1.73"/>
                  <XMWrap>
                    <XMDual xml:id="S3.E2.m1.73">
                      <XMApp>
                        <XMTok meaning="formulae"/>
                        <XMRef idref="S3.E2.m1.73.1"/>
                        <XMRef idref="S3.E2.m1.73.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMApp xml:id="S3.E2.m1.73.1">
                          <XMRef idref="S3.E2.m1.2"/>
                          <XMRef idref="S3.E2.m1.1"/>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                <XMRef idref="S3.E2.m1.3"/>
                                <XMRef idref="S3.E2.m1.4.1"/>
                              </XMApp>
                              <XMRef idref="S3.E2.m1.5.1"/>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-∥∥"/>
                                    <XMRef idref="S3.E2.m1.73.1.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMRef idref="S3.E2.m1.6" role="OPEN">
‖                                    </XMRef>
                                    <XMApp xml:id="S3.E2.m1.73.1.1">
                                      <XMRef idref="S3.E2.m1.9"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.7"/>
                                        <XMRef idref="S3.E2.m1.8.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.10"/>
                                        <XMRef idref="S3.E2.m1.11.1"/>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E2.m1.12" role="CLOSE">
‖                                    </XMRef>
                                  </XMWrap>
                                </XMDual>
                                <XMRef idref="S3.E2.m1.13.1"/>
                              </XMApp>
                              <XMRef idref="S3.E2.m1.14.1"/>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT"/>
                        <XMApp xml:id="S3.E2.m1.73.2">
                          <XMRef idref="S3.E2.m1.25"/>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-∥∥"/>
                                  <XMRef idref="S3.E2.m1.73.2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMRef idref="S3.E2.m1.16" role="OPEN">
‖                                  </XMRef>
                                  <XMApp xml:id="S3.E2.m1.73.2.1">
                                    <XMRef idref="S3.E2.m1.19"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S3.E2.m1.17"/>
                                      <XMRef idref="S3.E2.m1.18.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S3.E2.m1.20"/>
                                      <XMRef idref="S3.E2.m1.21.1"/>
                                    </XMApp>
                                  </XMApp>
                                  <XMRef idref="S3.E2.m1.22" role="CLOSE">
‖                                  </XMRef>
                                </XMWrap>
                              </XMDual>
                              <XMRef idref="S3.E2.m1.23.1"/>
                            </XMApp>
                            <XMRef idref="S3.E2.m1.24.1"/>
                          </XMApp>
                          <XMApp>
                            <XMRef idref="S3.E2.m1.39"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMRef idref="S3.E2.m1.26"/>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                  <XMRef idref="S3.E2.m1.27"/>
                                  <XMRef idref="S3.E2.m1.28.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E2.m1.29"/>
                                    <XMRef idref="S3.E2.m1.30.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                    <XMDual>
                                      <XMRef idref="S3.E2.m1.73.2.2"/>
                                      <XMWrap>
                                        <XMRef idref="S3.E2.m1.31"/>
                                        <XMApp xml:id="S3.E2.m1.73.2.2">
                                          <XMRef idref="S3.E2.m1.34"/>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                            <XMRef idref="S3.E2.m1.32"/>
                                            <XMRef idref="S3.E2.m1.33.1"/>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                            <XMRef idref="S3.E2.m1.35"/>
                                            <XMRef idref="S3.E2.m1.36.1"/>
                                          </XMApp>
                                        </XMApp>
                                        <XMRef idref="S3.E2.m1.37"/>
                                      </XMWrap>
                                    </XMDual>
                                    <XMRef idref="S3.E2.m1.38.1"/>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S3.E2.m1.40"/>
                                <XMRef idref="S3.E2.m1.41.1"/>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMDual>
                                  <XMRef idref="S3.E2.m1.73.2.3"/>
                                  <XMWrap>
                                    <XMRef idref="S3.E2.m1.42"/>
                                    <XMApp xml:id="S3.E2.m1.73.2.3">
                                      <XMRef idref="S3.E2.m1.45"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.43"/>
                                        <XMRef idref="S3.E2.m1.44.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.46"/>
                                        <XMRef idref="S3.E2.m1.47.1"/>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E2.m1.48"/>
                                  </XMWrap>
                                </XMDual>
                                <XMRef idref="S3.E2.m1.49.1"/>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S3.E2.m1.51"/>
                                <XMRef idref="S3.E2.m1.52.1"/>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMDual>
                                  <XMRef idref="S3.E2.m1.73.2.4"/>
                                  <XMWrap>
                                    <XMRef idref="S3.E2.m1.53"/>
                                    <XMApp xml:id="S3.E2.m1.73.2.4">
                                      <XMRef idref="S3.E2.m1.56"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.54"/>
                                        <XMRef idref="S3.E2.m1.55.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.57"/>
                                        <XMRef idref="S3.E2.m1.58.1"/>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E2.m1.59"/>
                                  </XMWrap>
                                </XMDual>
                                <XMRef idref="S3.E2.m1.60.1"/>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S3.E2.m1.62"/>
                                <XMRef idref="S3.E2.m1.63.1"/>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMDual>
                                  <XMRef idref="S3.E2.m1.73.2.5"/>
                                  <XMWrap>
                                    <XMRef idref="S3.E2.m1.64"/>
                                    <XMApp xml:id="S3.E2.m1.73.2.5">
                                      <XMRef idref="S3.E2.m1.67"/>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.65"/>
                                        <XMRef idref="S3.E2.m1.66.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.68"/>
                                        <XMRef idref="S3.E2.m1.69.1"/>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E2.m1.70"/>
                                  </XMWrap>
                                </XMDual>
                                <XMRef idref="S3.E2.m1.71.1"/>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMWrap>
                    </XMDual>
                    <XMTok role="PUNCT"/>
                  </XMWrap>
                </XMDual>
                <XMArray name="gathered" vattach="middle">
                  <XMRow>
                    <XMCell align="center">
                      <XMWrap>
                        <XMApp xml:id="S3.E2.m1.74">
                          <XMTok fontsize="50%" meaning="equals" role="RELOP" xml:id="S3.E2.m1.2">=</XMTok>
                          <XMTok font="caligraphic" fontsize="50%" role="UNKNOWN" xml:id="S3.E2.m1.1">L</XMTok>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                <XMTok fontsize="50%" mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E2.m1.3">∑</XMTok>
                                <XMApp xml:id="S3.E2.m1.4.1">
                                  <XMTok fontsize="35%" meaning="equals" role="RELOP">=</XMTok>
                                  <XMTok font="italic" fontsize="35%" role="UNKNOWN">t</XMTok>
                                  <XMTok fontsize="35%" meaning="1" role="NUMBER">1</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="italic" fontsize="35%" role="UNKNOWN" xml:id="S3.E2.m1.5.1">T</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMWrap>
                                  <XMTok fontsize="50%" name="||" role="OPEN" xml:id="S3.E2.m1.6">‖</XMTok>
                                  <XMApp xml:id="S3.E2.m1.74.1">
                                    <XMTok fontsize="50%" meaning="minus" role="ADDOP" xml:id="S3.E2.m1.9">-</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.E2.m1.7">s</XMTok>
                                      <XMTok font="italic" fontsize="35%" role="UNKNOWN" xml:id="S3.E2.m1.8.1">t</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMApp xml:id="S3.E2.m1.10">
                                        <XMTok fontsize="50%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">s</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="35%" role="UNKNOWN" xml:id="S3.E2.m1.11.1">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok fontsize="50%" name="||" role="CLOSE" xml:id="S3.E2.m1.12">‖</XMTok>
                                </XMWrap>
                                <XMTok fontsize="35%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.13.1">2</XMTok>
                              </XMApp>
                              <XMTok fontsize="35%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.14.1">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok fontsize="50%" role="PUNCT" xml:id="S3.E2.m1.15">,</XMTok>
                      </XMWrap>
                    </XMCell>
                  </XMRow>
                  <XMRow>
                    <XMCell align="center">
                      <XMWrap>
                        <XMApp xml:id="S3.E2.m1.75">
                          <XMTok name="triangleq" role="RELOP" xml:id="S3.E2.m1.25">≜</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMWrap>
                                <XMTok name="||" role="OPEN" xml:id="S3.E2.m1.16">‖</XMTok>
                                <XMApp xml:id="S3.E2.m1.75.1">
                                  <XMTok meaning="minus" role="ADDOP" xml:id="S3.E2.m1.19">-</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.17">s</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.18.1">t</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMApp xml:id="S3.E2.m1.20">
                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.21.1">t</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok name="||" role="CLOSE" xml:id="S3.E2.m1.22">‖</XMTok>
                              </XMWrap>
                              <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.23.1">2</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.24.1">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP" xml:id="S3.E2.m1.39">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp xml:id="S3.E2.m1.26">
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="norm"/>
                                    <XMRef idref="S3.E2.m1.26.1"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok name="||" role="OPEN">‖</XMTok>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.26.1">J</XMTok>
                                    <XMTok name="||" role="CLOSE">‖</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E2.m1.27">∑</XMTok>
                                  <XMApp xml:id="S3.E2.m1.28.1">
                                    <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">J</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.29">w</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.30.1">p</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.31">(</XMTok>
                                      <XMApp xml:id="S3.E2.m1.75.2">
                                        <XMTok meaning="minus" role="ADDOP" xml:id="S3.E2.m1.34">-</XMTok>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.32">p</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.33.1">j</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMApp xml:id="S3.E2.m1.35">
                                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.36.1">j</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.37">)</XMTok>
                                    </XMWrap>
                                    <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.38.1">2</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.40">w</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.41.1">r</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.42">(</XMTok>
                                  <XMApp xml:id="S3.E2.m1.75.3">
                                    <XMTok meaning="minus" role="ADDOP" xml:id="S3.E2.m1.45">-</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.43">q</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.44.1">j</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMApp xml:id="S3.E2.m1.46">
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.47.1">j</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.48">)</XMTok>
                                </XMWrap>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.49.1">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.51">w</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.52.1">v</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.53">(</XMTok>
                                  <XMApp xml:id="S3.E2.m1.75.4">
                                    <XMTok meaning="minus" role="ADDOP" xml:id="S3.E2.m1.56">-</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMApp xml:id="S3.E2.m1.54">
                                        <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.55.1">j</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMApp xml:id="S3.E2.m1.57">
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMApp>
                                          <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">p</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.58.1">j</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.59">)</XMTok>
                                </XMWrap>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.60.1">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="italic" role="UNKNOWN" xml:id="S3.E2.m1.62">w</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.63.1">a</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.64">(</XMTok>
                                  <XMApp xml:id="S3.E2.m1.75.5">
                                    <XMTok meaning="minus" role="ADDOP" xml:id="S3.E2.m1.67">-</XMTok>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMApp xml:id="S3.E2.m1.65">
                                        <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.66.1">j</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMApp xml:id="S3.E2.m1.68">
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMApp>
                                          <XMTok name="dot" role="OVERACCENT">˙</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">q</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.69.1">j</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.70">)</XMTok>
                                </XMWrap>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER" xml:id="S3.E2.m1.71.1">2</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT" xml:id="S3.E2.m1.72">,</XMTok>
                      </XMWrap>
                    </XMCell>
                  </XMRow>
                </XMArray>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="p^{j}" text="p ^ j" xml:id="S3.SS2.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\hat{p}^{j}" text="(hat@(p)) ^ j" xml:id="S3.SS2.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> are the global positions of the <Math mode="inline" tex="j" text="j" xml:id="S3.SS2.p4.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math>-th joint from rollout and reference, <Math mode="inline" tex="q^{j}" text="q ^ j" xml:id="S3.SS2.p4.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">q</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\hat{q}^{j}" text="(hat@(q)) ^ j" xml:id="S3.SS2.p4.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">q</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math> are the global rotation of the <Math mode="inline" tex="j" text="j" xml:id="S3.SS2.p4.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math>-th joint from rollout and reference in 6D rotation representation. The weights <Math mode="inline" tex="w_{p}" text="w _ p" xml:id="S3.SS2.p4.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="w_{r}" text="w _ r" xml:id="S3.SS2.p4.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="w_{v}" text="w _ v" xml:id="S3.SS2.p4.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
              </XMApp>
            </XMath>
          </Math>, and <Math mode="inline" tex="w_{a}" text="w _ a" xml:id="S3.SS2.p4.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">w</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
              </XMApp>
            </XMath>
          </Math> only need to be approximately tuned to roughly equalize their magnitudes. Note that we use 6D rotation in loss computation since it is advantageous over quaternions in gradient-based optimization <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhou2019continuity" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Without loss of generality, we denote the transition function in the dynamic system as <Math mode="inline" tex="\mathcal{T}" text="T" xml:id="S3.SS2.p4.m11">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> and the next state of the system can be obtained from the transition function given the current action <Math mode="inline" tex="a_{t}" text="a _ t" xml:id="S3.SS2.p4.m12">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> and character state <Math mode="inline" tex="s_{t}" text="s _ t" xml:id="S3.SS2.p4.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="s_{t+1}=\mathcal{T}(s_{t},a_{t})" text="s _ (t + 1) = T * open-interval@(s _ t, a _ t)" xml:id="S3.SS2.p4.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="S3.SS2.p4.m14.1"/>
                      <XMRef idref="S3.SS2.p4.m14.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS2.p4.m14.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="S3.SS2.p4.m14.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. In DiffMimic, DPS serves as a transition function <Math mode="inline" tex="\mathcal{T}" text="T" xml:id="S3.SS2.p4.m15">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> that is fully differentiable. Thus, from the loss function, we can directly derive the gradient with respect to both the current action <Math mode="inline" tex="a_{t}" text="a _ t" xml:id="S3.SS2.p4.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> and state <Math mode="inline" tex="s_{t}" text="s _ t" xml:id="S3.SS2.p4.m17">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math></p>
        <equation xml:id="S3.E3">
          <tags>
            <tag>(3.3)</tag>
            <tag role="autoref">Equation 3.3</tag>
            <tag role="refnum">3.3</tag>
          </tags>
          <Math mode="display" tex="\small\frac{\partial\mathcal{L}}{\partial a_{t}}=\left(\frac{\partial\mathcal{%&#10;L}}{\partial\mathcal{T}(s_{t},a_{t})}\right)\left(\frac{\partial\mathcal{T}(s_%&#10;{t},a_{t})}{\partial a_{t}}\right),\quad\frac{\partial\mathcal{L}}{\partial s_%&#10;{t}}=\left(\frac{\partial\mathcal{L}}{\partial\mathcal{T}(s_{t},a_{t})}\right)%&#10;\left(\frac{\partial\mathcal{T}(s_{t},a_{t})}{\partial s_{t}}\right)." text="formulae@(partial-differential@(L) / partial-differential@(a _ t) = (partial-differential@(L) / partial-differential@(T * open-interval@(s _ t, a _ t))) * (partial-differential@(T * open-interval@(s _ t, a _ t)) / partial-differential@(a _ t)), partial-differential@(L) / partial-differential@(s _ t) = (partial-differential@(L) / partial-differential@(T * open-interval@(s _ t, a _ t))) * (partial-differential@(T * open-interval@(s _ t, a _ t)) / partial-differential@(s _ t)))" xml:id="S3.E3.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E3.m1.13"/>
                <XMWrap>
                  <XMDual xml:id="S3.E3.m1.13">
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="S3.E3.m1.13.1"/>
                      <XMRef idref="S3.E3.m1.13.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="S3.E3.m1.13.1">
                        <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E3.m1.9"/>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S3.E3.m1.9">
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">T</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E3.m1.1"/>
                                        <XMRef idref="S3.E3.m1.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E3.m1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E3.m1.2">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMRef idref="S3.E3.m1.10"/>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S3.E3.m1.10">
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">T</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E3.m1.3"/>
                                        <XMRef idref="S3.E3.m1.4"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E3.m1.3">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E3.m1.4">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok fontsize="90%" role="PUNCT" rpadding="9.0pt">,</XMTok>
                      <XMApp xml:id="S3.E3.m1.13.2">
                        <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                          <XMApp>
                            <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMRef idref="S3.E3.m1.11"/>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S3.E3.m1.11">
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">L</XMTok>
                                </XMApp>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">T</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E3.m1.5"/>
                                        <XMRef idref="S3.E3.m1.6"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E3.m1.5">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E3.m1.6">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMDual>
                            <XMRef idref="S3.E3.m1.12"/>
                            <XMWrap>
                              <XMTok fontsize="90%" role="OPEN" stretchy="true">(</XMTok>
                              <XMApp xml:id="S3.E3.m1.12">
                                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="caligraphic" fontsize="90%" role="UNKNOWN">T</XMTok>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S3.E3.m1.7"/>
                                        <XMRef idref="S3.E3.m1.8"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.E3.m1.7">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                                        <XMApp xml:id="S3.E3.m1.8">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                          <XMTok font="italic" fontsize="90%" role="UNKNOWN">a</XMTok>
                                          <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok fontsize="90%" meaning="partial-differential" name="partial" role="DIFFOP">∂</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">s</XMTok>
                                    <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                              <XMTok fontsize="90%" role="CLOSE" stretchy="true">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                  <XMTok fontsize="90%" role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>By doing this recursively, the gradient can be propagated through the whole trajectory.</p>
      </para>
      <figure inlist="lof" placement="t!" xml:id="S3.F4">
        <tags>
          <tag><text fontsize="90%">Figure 4</text></tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <graphics candidates="figures/qp/expert_replay5.pdf" graphic="figures/qp/expert_replay5.pdf" options="width=346.89731pt,keepaspectratio=true" xml:id="S3.F4.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>Illustration of Demonstration Replay, which happens when t=4 where the character is about to fall. The rollout state (in blue) is replaced by the reference state (in red) for the next step.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 4</text></tag><text fontsize="90%">Illustration of Demonstration Replay, which happens when t=4 where the character is about to fall. The rollout state (in blue) is replaced by the reference state (in red) for the next step.</text></caption>
      </figure>
    </subsection>
    <subsection inlist="toc" xml:id="S3.SS3">
      <tags>
        <tag>3.3</tag>
        <tag role="autoref">subsection 3.3</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">§3.3</tag>
      </tags>
      <title><tag close=" ">3.3</tag>Demonstration Replay</title>
      <para xml:id="S3.SS3.p1">
        <p>Although mimicking with DPS results in a succinct learning framework, there are three well-known challenges in policy learning with DPS: 1) Exploding/vanishing gradients with the long horizon; 2) Local minima may cause gradient-based optimization methods to stall; 3) Noisy or wrong gradients.</p>
      </para>
      <para xml:id="S3.SS3.p2">
        <p>We observe that the high non-convexity in the motion mimicking task poses severe challenges to analytical gradient-based optimization. Due to the local nature of the analytical gradients, the policy can be easily stuck at suboptimal points. As shown <ref class="ltx_refmacro_autoref" labelref="LABEL:fig:vis_ablation" show="autoref"/>, when trying to mimic the <text font="italic">Backflip</text> skill, the character learns to use arms to support itself instead of exploring a more dynamic jumping move.
In practical implementations, dividing the whole trajectory into smaller sub-trajectories for truncated Back-Propagation-Through-Time (BPTT) further exacerbates the issue.
As shown in <ref class="ltx_refmacro_autoref" labelref="LABEL:tab:ablation" show="autoref"/> (a)-(b), a 10-step gradient truncation leads the policy to a less favorable local optimal.</p>
      </para>
      <para xml:id="S3.SS3.p3">
        <p>Teacher forcing <cite class="ltx_citemacro_citep">(<bibref bibrefs="williams1989learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> is a common remedy to escape the local minimum in gradient-based sequential modeling. Teacher forcing randomly replace the states in rollout by the reference states.
Given a teacher forcing ratio <Math mode="inline" tex="\gamma" text="gamma" xml:id="S3.SS3.p3.m1">
            <XMath>
              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
            </XMath>
          </Math>:</p>
        <equation xml:id="S3.E4">
          <tags>
            <tag>(3.4)</tag>
            <tag role="autoref">Equation 3.4</tag>
            <tag role="refnum">3.4</tag>
          </tags>
          <Math mode="display" tex="s_{t+1}=\begin{cases}\mathcal{T}(s_{t},a_{t}),\;a_{t}\sim\pi_{\theta}(a|s_{t})%&#10;&amp;\text{if}\;b=0,b\sim\textrm{Bernoulli}(\gamma)\\&#10;\mathcal{T}(\hat{s}_{t},a_{t}),\;a_{t}\sim\pi_{\theta}(a|\hat{s}_{t})&amp;\text{%&#10;otherwise.}\end{cases}" text="s _ (t + 1) = cases@(list@(T * open-interval@(s _ t, a _ t), a _ t) similar-to pi _ theta * conditional@(a, s _ t), formulae@([if] * b = 0, b similar-to [Bernoulli] * gamma), list@(T * open-interval@((hat@(s)) _ t, a _ t), a _ t) similar-to pi _ theta * conditional@(a, (hat@(s)) _ t), [otherwise.])" xml:id="S3.E4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="cases"/>
                    <XMRef idref="S3.E4.m1.1"/>
                    <XMRef idref="S3.E4.m1.2"/>
                    <XMRef idref="S3.E4.m1.3"/>
                    <XMRef idref="S3.E4.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="true">{</XMTok>
                    <XMArray>
                      <XMRow>
                        <XMCell align="left">
                          <XMApp xml:id="S3.E4.m1.1">
                            <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E4.m1.1.1"/>
                                <XMRef idref="S3.E4.m1.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E4.m1.1.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E4.m1.1.1.1"/>
                                      <XMRef idref="S3.E4.m1.1.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E4.m1.1.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.E4.m1.1.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT" rpadding="2.8pt">,</XMTok>
                                <XMApp xml:id="S3.E4.m1.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E4.m1.1.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E4.m1.1.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMDual xml:id="S3.E4.m1.2">
                            <XMApp>
                              <XMTok meaning="formulae"/>
                              <XMRef idref="S3.E4.m1.2.2"/>
                              <XMRef idref="S3.E4.m1.2.3"/>
                            </XMApp>
                            <XMWrap>
                              <XMApp xml:id="S3.E4.m1.2.2">
                                <XMTok meaning="equals" role="RELOP">=</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText rpadding="2.8pt">if</XMText>
                                  <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                </XMApp>
                                <XMTok meaning="0" role="NUMBER">0</XMTok>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.E4.m1.2.3">
                                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                                <XMTok font="italic" role="UNKNOWN">b</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>Bernoulli</XMText>
                                  <XMDual>
                                    <XMRef idref="S3.E4.m1.2.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMTok font="italic" name="gamma" role="UNKNOWN" xml:id="S3.E4.m1.2.1">γ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                            </XMWrap>
                          </XMDual>
                        </XMCell>
                      </XMRow>
                      <XMRow>
                        <XMCell align="left">
                          <XMApp xml:id="S3.E4.m1.3">
                            <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E4.m1.3.1"/>
                                <XMRef idref="S3.E4.m1.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E4.m1.3.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E4.m1.3.1.1"/>
                                      <XMRef idref="S3.E4.m1.3.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E4.m1.3.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMApp>
                                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.E4.m1.3.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT" rpadding="2.8pt">,</XMTok>
                                <XMApp xml:id="S3.E4.m1.3.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E4.m1.3.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E4.m1.3.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                      <XMApp>
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMText xml:id="S3.E4.m1.4">otherwise.</XMText>
                        </XMCell>
                      </XMRow>
                    </XMArray>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS3.p4">
        <p>However, although the mechanism leads to a better global optimal overall, it does not guarantee the character to faithfully mimic the reference motion in each frame. As shown in <ref class="ltx_refmacro_autoref" labelref="LABEL:fig:vis_ablation" show="autoref"/>, although the character’s overall trajectory matches the reference, several frames suffer from awkward poses. <ref class="ltx_refmacro_autoref" labelref="LABEL:fig:frame_loss" show="autoref"/> shows that a few frames have significantly larger pose errors than other frames.</p>
      </para>
      <para xml:id="S3.SS3.p5">
        <p>We propose demonstration-guided exploration to mitigate these challenges in DPS for policy learning to help exploration and encourage faithfully mimicking at the same time. The main idea of demonstration-guided exploration is to replace states in the policy rollout with the corresponding demonstration states when the states are too far away from the reference. For a threshold <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="S3.SS3.p5.m1">
            <XMath>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
            </XMath>
          </Math>:</p>
        <equation xml:id="S3.E5">
          <tags>
            <tag>(3.5)</tag>
            <tag role="autoref">Equation 3.5</tag>
            <tag role="refnum">3.5</tag>
          </tags>
          <Math mode="display" tex="s_{t+1}=\begin{cases}\mathcal{T}(s_{t},a_{t}),\;a_{t}\sim\pi_{\theta}(a|s_{t})%&#10;&amp;\text{if}\;\|s_{t}-\hat{s}_{t}\|_{2}^{2}&lt;\epsilon\\&#10;\mathcal{T}(\hat{s}_{t},a_{t}),\;a_{t}\sim\pi_{\theta}(a|\hat{s}_{t})&amp;\text{%&#10;otherwise.}\end{cases}" text="s _ (t + 1) = cases@(list@(T * open-interval@(s _ t, a _ t), a _ t) similar-to pi _ theta * conditional@(a, s _ t), [if] * ((norm@(s _ t - (hat@(s)) _ t)) _ 2) ^ 2 &lt; epsilon, list@(T * open-interval@((hat@(s)) _ t, a _ t), a _ t) similar-to pi _ theta * conditional@(a, (hat@(s)) _ t), [otherwise.])" xml:id="S3.E5.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="cases"/>
                    <XMRef idref="S3.E5.m1.1"/>
                    <XMRef idref="S3.E5.m1.2"/>
                    <XMRef idref="S3.E5.m1.3"/>
                    <XMRef idref="S3.E5.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="true">{</XMTok>
                    <XMArray>
                      <XMRow>
                        <XMCell align="left">
                          <XMApp xml:id="S3.E5.m1.1">
                            <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E5.m1.1.1"/>
                                <XMRef idref="S3.E5.m1.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E5.m1.1.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E5.m1.1.1.1"/>
                                      <XMRef idref="S3.E5.m1.1.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E5.m1.1.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.E5.m1.1.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT" rpadding="2.8pt">,</XMTok>
                                <XMApp xml:id="S3.E5.m1.1.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E5.m1.1.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E5.m1.1.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMApp xml:id="S3.E5.m1.2">
                            <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText rpadding="2.8pt">if</XMText>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post5"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="norm"/>
                                      <XMRef idref="S3.E5.m1.2.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok name="||" role="OPEN">‖</XMTok>
                                      <XMApp xml:id="S3.E5.m1.2.1">
                                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                          <XMApp>
                                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                          </XMApp>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok name="||" role="CLOSE">‖</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                                </XMApp>
                                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
                          </XMApp>
                        </XMCell>
                      </XMRow>
                      <XMRow>
                        <XMCell align="left">
                          <XMApp xml:id="S3.E5.m1.3">
                            <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="list"/>
                                <XMRef idref="S3.E5.m1.3.1"/>
                                <XMRef idref="S3.E5.m1.3.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E5.m1.3.1">
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S3.E5.m1.3.1.1"/>
                                      <XMRef idref="S3.E5.m1.3.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.E5.m1.3.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMApp>
                                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                          <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="PUNCT">,</XMTok>
                                      <XMApp xml:id="S3.E5.m1.3.1.2">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="PUNCT" rpadding="2.8pt">,</XMTok>
                                <XMApp xml:id="S3.E5.m1.3.2">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E5.m1.3.3"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E5.m1.3.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post5"/>
                                      <XMApp>
                                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                        <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMText xml:id="S3.E5.m1.4">otherwise.</XMText>
                        </XMCell>
                      </XMRow>
                    </XMArray>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>
        </equation>
        <p>Since the criterion for choosing which states to replace is based on the performance of the current rollout, the replacing frequency dynamic adjusts itself during the model training.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Experiments</title>
    <subsection inlist="toc" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Experiment Setup</title>
      <para xml:id="S4.SS1.p1">
        <p>For all the experiments, we run the algorithm with one single GPU (NVIDIA Tesla V100) and CPU (Intel Xeon E5-2680).
Following  <cite class="ltx_citemacro_citet"><bibref bibrefs="peng2021amp" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, we use the average pose error as the main metric. The average pose error over the whole trajectory of length <Math mode="inline" tex="T" text="T" xml:id="S4.SS1.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">T</XMTok>
            </XMath>
          </Math> with <Math mode="inline" tex="J" text="J" xml:id="S4.SS1.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">J</XMTok>
            </XMath>
          </Math> joints is computed between the pose of the simulated character and the reference motion using the relative positions of each joint with respect to the root joint (in units of meters):</p>
        <equation xml:id="S4.E1">
          <tags>
            <tag>(4.1)</tag>
            <tag role="autoref">Equation 4.1</tag>
            <tag role="refnum">4.1</tag>
          </tags>
          <Math mode="display" tex="\small e=\frac{1}{T}\sum_{t\in T}\frac{1}{\lVert J\rVert}\sum_{j\in J}\lVert(p%&#10;^{j}_{t}-p_{t}^{root})-(\hat{p}^{j}_{t}-\hat{p}_{t}^{root})\rVert_{2}," text="e = (1 / T) * (sum _ (t element-of T))@((1 / delimited-∥∥@(J)) * (sum _ (j element-of J))@((delimited-∥∥@((p ^ j) _ t - (p _ t) ^ (r * o * o * t) - ((hat@(p)) ^ j) _ t - ((hat@(p)) _ t) ^ (r * o * o * t))) _ 2))" xml:id="S4.E1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S4.E1.m1.2"/>
                <XMWrap>
                  <XMApp xml:id="S4.E1.m1.2">
                    <XMTok fontsize="90%" meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="italic" fontsize="90%" role="UNKNOWN">e</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                        <XMTok font="italic" fontsize="90%" role="UNKNOWN">T</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok fontsize="90%" mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="63%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                            <XMTok font="italic" fontsize="63%" role="UNKNOWN">T</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok fontsize="90%" meaning="1" role="NUMBER">1</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-∥∥"/>
                                <XMRef idref="S4.E1.m1.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok fontsize="90%" name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                <XMTok font="italic" fontsize="90%" role="UNKNOWN" xml:id="S4.E1.m1.1">J</XMTok>
                                <XMTok fontsize="90%" name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok fontsize="90%" mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="63%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="italic" fontsize="63%" role="UNKNOWN">j</XMTok>
                                <XMTok font="italic" fontsize="63%" role="UNKNOWN">J</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-∥∥"/>
                                  <XMRef idref="S4.E1.m1.2.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok fontsize="90%" name="lVert" role="OPEN" stretchy="false">∥</XMTok>
                                  <XMApp xml:id="S4.E1.m1.2.1">
                                    <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                                    <XMDual>
                                      <XMRef idref="S4.E1.m1.2.1.1"/>
                                      <XMWrap>
                                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S4.E1.m1.2.1.1">
                                          <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">p</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMTok font="italic" fontsize="90%" role="UNKNOWN">p</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">r</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">o</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">o</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMRef idref="S4.E1.m1.2.1.2"/>
                                      <XMWrap>
                                        <XMTok fontsize="90%" role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S4.E1.m1.2.1.2">
                                          <XMTok fontsize="90%" meaning="minus" role="ADDOP">-</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok fontsize="90%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                <XMTok font="italic" fontsize="90%" role="UNKNOWN">p</XMTok>
                                              </XMApp>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">j</XMTok>
                                            </XMApp>
                                            <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok fontsize="90%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                                <XMTok font="italic" fontsize="90%" role="UNKNOWN">p</XMTok>
                                              </XMApp>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">r</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">o</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">o</XMTok>
                                              <XMTok font="italic" fontsize="63%" role="UNKNOWN">t</XMTok>
                                            </XMApp>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok fontsize="90%" role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok fontsize="90%" name="rVert" role="CLOSE" stretchy="false">∥</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMTok fontsize="63%" meaning="2" role="NUMBER">2</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok fontsize="90%" role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="p^{j}_{t}" text="(p ^ j) _ t" xml:id="S4.SS1.p1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\hat{p}^{j}_{t}" text="((hat@(p)) ^ j) _ t" xml:id="S4.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> are the position of <Math mode="inline" tex="j" text="j" xml:id="S4.SS1.p1.m5">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math>-th joint of the simulated motion and reference motion at timestamp <Math mode="inline" tex="t" text="t" xml:id="S4.SS1.p1.m6">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> in the 3D cartesian space and <Math mode="inline" tex="root" text="r * o * o * t" xml:id="S4.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">o</XMTok>
                <XMTok font="italic" role="UNKNOWN">o</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math> refers to the root joint.
We mainly compare with DeepMimic <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, Spacetime Bound <cite class="ltx_citemacro_citep">(<bibref bibrefs="ma2021learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, and Adversarial Motion Prior (AMP) <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2021amp" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Dynamic Time Warping <cite class="ltx_citemacro_citep">(<bibref bibrefs="sakoe1978dynamic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> is applied to synchronize the simulated motion and the reference motion following the convention.</p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p><text font="bold">Cyclic Motions.</text> Besides mimicking a single motion clip, a popular benchmark for motion mimicking is to imitate cyclic motions like walking and running, where a single cycle of the motion is provided as the reference motion and the character learns to repeat the motion for 20 seconds.
Typically, a curriculum is designed to gradually increase the maximum rollout episode to 20 seconds during training <cite class="ltx_citemacro_citep">(<bibref bibrefs="yang2021efficient,peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. In our experiment, we remove all bells and whistles and fix the maximum rollout episode to 4 seconds during the training. DiffMimic can produce a 20-second long cyclic rollout even though it only sees 4-second rollouts in training. The motion clips are directly borrowed from AMP <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2021amp" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, which are originally collected from a combination of public mocap libraries, custom recorded mocap clips, and artist-authored keyframe animations.</p>
      </para>
      <table xml:id="S4.SS1.tab1">
        <tabular class="ltx_figure_panel" vattach="middle">
          <tr>
            <td align="center"><graphics candidates="figures/mixed_backflip.png" graphic="figures/mixed_backflip.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g1"/></td>
            <td align="center"><graphics candidates="figures/mixed_cartwheel.png" graphic="figures/mixed_cartwheel.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g2"/></td>
            <td align="center"><graphics candidates="figures/mixed_sideflip.png" graphic="figures/mixed_sideflip.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g3"/></td>
            <td align="center"><graphics candidates="figures/mixed_run.png" graphic="figures/mixed_run.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g4"/></td>
          </tr>
          <tr>
            <td align="center"><graphics candidates="figures/mixed_walk.png" graphic="figures/mixed_walk.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g5"/></td>
            <td align="center"><graphics candidates="figures/mixed_zombie.png" graphic="figures/mixed_zombie.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g6"/></td>
            <td align="center"><graphics candidates="figures/mixed_jump.png" graphic="figures/mixed_jump.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g7"/></td>
            <td align="center"><graphics candidates="figures/mixed_spinkick_legend.png" graphic="figures/mixed_spinkick_legend.png" options="width=99.73074pt,keepaspectratio=true" xml:id="S4.SS1.g8"/></td>
          </tr>
        </tabular>
        <break class="ltx_break"/>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:imitate_one" xml:id="S4.F5">
          <tags>
            <tag><text fontsize="90%">Figure 5</text></tag>
            <tag role="autoref">Figure 5</tag>
            <tag role="refnum">5</tag>
            <tag role="typerefnum">Figure 5</tag>
          </tags>
          <toccaption><tag close=" ">5</tag>Pose error versus the number of samples. DiffMimic (4s): rollout 4 seconds of Diffmimic for evaluation. DiffMimic (20s): rollout 20 seconds of Diffmimic for evaluation. In general, DiffMimic allows the policy to generate high-quality motions with less than <Math mode="inline" tex="3.5\times 10^{7}" text="3.5 * 10 ^ 7" xml:id="S4.F5.m1">
              <XMath>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok meaning="3.5" role="NUMBER">3.5</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMTok fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> samples.
We refer the readers for more results to the appendix.</toccaption>
          <caption><tag close=": "><text fontsize="90%">Figure 5</text></tag><text fontsize="90%">Pose error versus the number of samples. DiffMimic (4s): rollout 4 seconds of Diffmimic for evaluation. DiffMimic (20s): rollout 20 seconds of Diffmimic for evaluation. In general, DiffMimic allows the policy to generate high-quality motions with less than <Math mode="inline" tex="3.5\times 10^{7}" text="3.5 * 10 ^ 7" xml:id="S4.F5.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">×</XMTok>
                    <XMTok meaning="3.5" role="NUMBER">3.5</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="70%" meaning="7" role="NUMBER">7</XMTok>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math> samples.
We refer the readers for more results to the appendix.</text></caption>
        </figure>
      </table>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag>Comparison on Motion Mimicking</title>
      <para xml:id="S4.SS2.p1">
        <p>In this section, we aim to understand 1) efficiency; 2) the quality of the learned policy of DiffMimic. Following the conventions of previous works <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic,peng2021amp,ma2021learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, we count the number of samples required to train the policy to rollout for 20 seconds without falling. The pose error is calculated over the horizon of 20 seconds.</p>
      </para>
      <para xml:id="S4.SS2.p2">
        <p><text font="bold">Analytical gradients enhance the sample efficiency in motion mimicking.</text> We show the comparison between DiffMimic, DeepMimic, and Spacetime Bound on sample efficiency in Table <ref labelref="LABEL:sampleeff"/>. DeepMimic is an RL-based algorithm with a careful reward design. Spacetime Bound performs hyperparameter searching for DeepMimic to further enhance the sample efficiency. Our results show that DiffMimic constantly outperforms DeepMimic in terms of sample efficiency. The analytical gradients provided by the differentiable simulation allow us to compute policy gradient with a small number of samples while the RL-based algorithm requires a large batch to have a decent estimate. Compared with Spacetime Bound, DiffMimic is much more stable and consistent over various tasks. We notice that Spacetime Bound may require more samples than DeepMimic even for simple tasks like <text font="italic">Jump</text>. We show the learning curve of DiffMimic over eight different tasks in Fig. <ref labelref="LABEL:fig:imitate_one"/>. It shows that DiffMimic generally learns high-quality motions (pose error <Math mode="inline" tex="&lt;" text="&lt;" xml:id="S4.SS2.p2.m1">
            <XMath>
              <XMTok meaning="less-than" role="RELOP">&lt;</XMTok>
            </XMath>
          </Math> 0.15) with less than 2e7 samples, even for challenging tasks like <text font="italic">Backflip</text>. In terms of the wallclock time, DiffMimic learns to perform <text font="italic">Backflip</text> in 10 minutes and learns to cycle it in 3 hours (<Math mode="inline" tex="14.88\times 10^{6}" text="14.88 * 10 ^ 6" xml:id="S4.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="14.88" role="NUMBER">14.88</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> samples), which can be found in our qualitative results.</p>
      </para>
      <figure float="right" inlist="lof" labels="LABEL:fig:Wallclock_time" xml:id="S4.F6">
        <tags>
          <tag><text fontsize="90%">Figure 6</text></tag>
          <tag role="autoref">Figure 6</tag>
          <tag role="refnum">6</tag>
          <tag role="typerefnum">Figure 6</tag>
        </tags>
        <graphics candidates="figures/wallclock_sword.pdf" class="ltx_centering" graphic="figures/wallclock_sword.pdf" options="width=164.77771pt,keepaspectratio=true" xml:id="S4.F6.g1"/>
        <toccaption class="ltx_centering"><tag close=" "><!--  %**** 4˙experiments.tex Line 50 **** -->6<!--  %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** --></tag><!--  %**** 4˙experiments.tex Line 50 **** -->Wallclock training time versus pose error for DiffMimic and AMP. DiffMimic takes half of the training time required by AMP to have a comparable result.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 6</text></tag><!--  %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** 
     %**** 4˙experiments.tex Line 50 **** --><text fontsize="90%">Wallclock training time versus pose error for DiffMimic and AMP. DiffMimic takes half of the training time required by AMP to have a comparable result.</text></caption>
      </figure>
      <para xml:id="S4.SS2.p3">
        <p><text font="bold">DiffMimic can learn high-quality motions.</text> The average pose error for 12 different motion tasks is shown in Table <ref labelref="LABEL:poseerror"/>. DiffMimic outperforms AMP consistently and has comparable performance to DeepMimic.
Noticeably, DiffMimic only needs to see the demonstrations of 4 seconds to achieve a similar performance of DeepMimic with 20 seconds cyclic rollout, which indicates stable and faithful recovery of the reference motion. This further corroborates the efficacy of DiffMimic.</p>
      </para>
      <para xml:id="S4.SS2.p4">
        <p><text font="bold">Analytical gradients accelerate the learning speed in motion mimicking.</text> As it generally takes more time to compute analytical gradients than the estimated one, it is natural to compare the wall-clock time for each algorithm. Since the implementation of DeepMimic does not utilize GPU for parallelization, we choose to compare DiffMimic with AMP. The implementation of AMP utilizes the highly parallelized environment, IsaacGym <cite class="ltx_citemacro_citep">(<bibref bibrefs="makoviychuk2021isaac" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Both approaches do not require manual reward design and utilize GPU for acceleration. We compare DiffMimic and AMP on a task where a humanoid character is wielding a sword and a shield to perform a 3.2-second attack move (shown in Appendix Fig. <ref labelref="LABEL:fig:sword"/>). The hyperparameter of AMP is from its official release of code.
We show the comparison with respect to wallclock time in Fig. <ref labelref="LABEL:fig:Wallclock_time"/>. DiffMimic takes half of the training time required by AMP to have a comparable result.</p>
      </para>
      <table inlist="lot" labels="LABEL:poseerror" placement="t" xml:id="S4.T1">
        <tags>
          <tag><text fontsize="90%">Table 1</text></tag>
          <tag role="autoref">Table 1</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Table 1</tag>
        </tags>
        <toccaption><tag close=" ">1</tag>Pose error comparison in meters. <Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="S4.T1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMText>T</XMText>
                <XMText><text fontsize="70%">cycle</text></XMText>
              </XMApp>
            </XMath>
          </Math> is the length of the reference motion for a single cycle. The error is averaged on 32 rollout episodes with a maximum length of 20 seconds.</toccaption>
        <caption><tag close=": "><text fontsize="90%">Table 1</text></tag><text fontsize="90%">Pose error comparison in meters. <Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="S4.T1.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText>T</XMText>
                  <XMText><text fontsize="70%">cycle</text></XMText>
                </XMApp>
              </XMath>
            </Math> is the length of the reference motion for a single cycle. The error is averaged on 32 rollout episodes with a maximum length of 20 seconds.</text></caption>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="left" border="tt">Motion</td>
            <td align="center" border="tt"><Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="S4.T1.m3">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText>T</XMText>
                    <XMText><text fontsize="70%">cycle</text></XMText>
                  </XMApp>
                </XMath>
              </Math>(s)</td>
            <td align="center" border="tt">DeepMimic</td>
            <td align="center" border="tt">AMP</td>
            <td align="center" border="tt">Ours</td>
          </tr>
          <tr>
            <td align="left" border="t">Back-Flip</td>
            <td align="center" border="t">1.75</td>
            <td align="center" border="t">0.076 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m4">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.021</td>
            <td align="center" border="t">0.150 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m5">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.028</td>
            <td align="center" border="t">0.097 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m6">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
          </tr>
          <tr>
            <td align="left">Cartwheel</td>
            <td align="center">2.72</td>
            <td align="center">0.039 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m7">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.011</td>
            <td align="center">0.067 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m8">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.014</td>
            <td align="center">0.040 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m9">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.007</td>
          </tr>
          <tr>
            <td align="left">Crawl</td>
            <td align="center">2.93</td>
            <td align="center">0.044 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m10">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.049 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m11">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.007</td>
            <td align="center">0.037 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m12">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
          </tr>
          <tr>
            <td align="left">Dance</td>
            <td align="center">1.62</td>
            <td align="center">0.038 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m13">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.055 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m14">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.015</td>
            <td align="center">0.070 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m15">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.003</td>
          </tr>
          <tr>
            <td align="left">Jog</td>
            <td align="center">0.83</td>
            <td align="center">0.029 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m16">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.056 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m17">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.031 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m18">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.002</td>
          </tr>
          <tr>
            <td align="left">Jump</td>
            <td align="center">1.77</td>
            <td align="center">0.033 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m19">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.083 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m20">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.022</td>
            <td align="center">0.025 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m21">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.000</td>
          </tr>
          <tr>
            <td align="left">Roll</td>
            <td align="center">2.02</td>
            <td align="center">0.072 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m22">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.018</td>
            <td align="center">0.088 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m23">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.008</td>
            <td align="center">0.061 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m24">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.007</td>
          </tr>
          <tr>
            <td align="left">Run</td>
            <td align="center">0.80</td>
            <td align="center">0.028 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m25">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.002</td>
            <td align="center">0.075 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m26">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.015</td>
            <td align="center">0.039 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m27">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.000</td>
          </tr>
          <tr>
            <td align="left">Side-Flip</td>
            <td align="center">2.44</td>
            <td align="center">0.191 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m28">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.043</td>
            <td align="center">0.124 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m29">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.012</td>
            <td align="center">0.069 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m30">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
          </tr>
          <tr>
            <td align="left">Spin-Kick</td>
            <td align="center">1.28</td>
            <td align="center">0.042 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m31">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.058 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m32">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.012</td>
            <td align="center">0.056 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m33">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.000</td>
          </tr>
          <tr>
            <td align="left">Walk</td>
            <td align="center">1.30</td>
            <td align="center">0.018 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m34">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.005</td>
            <td align="center">0.030 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m35">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.001</td>
            <td align="center">0.017 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m36">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.000</td>
          </tr>
          <tr>
            <td align="left" border="bb">Zombie</td>
            <td align="center" border="bb">1.68</td>
            <td align="center" border="bb">0.049 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m37">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.013</td>
            <td align="center" border="bb">0.058 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m38">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.014</td>
            <td align="center" border="bb">0.037 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m39">
                <XMath>
                  <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math> 0.002</td>
          </tr>
        </tabular>
      </table>
<!--  %**** 4˙comparison.tex Line 25 **** -->      <table inlist="lot" placement="t" xml:id="S4.T2">
        <tags>
          <tag><text fontsize="90%">Table 2</text></tag>
          <tag role="autoref">Table 2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Table 2</tag>
        </tags>
        <toccaption><tag close=" ">2</tag>Number of samples required to roll out 20 seconds without falling in <Math mode="inline" tex="(10^{6})" text="10 ^ 6" xml:id="S4.T2.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S4.T2.m1.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.T2.m1.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>. Percentage: change in the fraction of the DeepMimic samples.</toccaption>
        <caption><tag close=": "><text fontsize="90%">Table 2</text></tag><text fontsize="90%">Number of samples required to roll out 20 seconds without falling in <Math mode="inline" tex="(10^{6})" text="10 ^ 6" xml:id="S4.T2.m2">
              <XMath>
                <XMDual>
                  <XMRef idref="S4.T2.m2.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S4.T2.m2.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok meaning="10" role="NUMBER">10</XMTok>
                      <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>. Percentage: change in the fraction of the DeepMimic samples.</text></caption>
        <tabular class="ltx_centering" vattach="middle">
          <tr>
            <td align="left" border="tt">Motion</td>
            <td align="center" border="tt"><Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="S4.T2.m3">
                <XMath>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMText>T</XMText>
                    <XMText><text fontsize="70%">cycle</text></XMText>
                  </XMApp>
                </XMath>
              </Math>(s)</td>
            <td align="right" border="r tt">DeepMimic</td>
            <td align="right" border="r tt">Spacetime Bound</td>
            <td align="right" border="tt">Ours</td>
          </tr>
          <tr>
            <td align="left" border="t">Back-Flip</td>
            <td align="center" border="t">1.75</td>
            <td align="right" border="r t">31.18</td>
            <td align="right" border="r t">41.20 <text fontsize="90%">+32.1%</text></td>
            <td align="right" border="t">14.88 <text fontsize="90%">-52.2%</text></td>
          </tr>
          <tr>
            <td align="left">Cartwheel</td>
            <td align="center">2.72</td>
            <td align="right" border="r">30.45</td>
            <td align="right" border="r">17.35 <text fontsize="90%">-43.0%</text></td>
            <td align="right">13.92 <text fontsize="90%">-54.2%</text></td>
          </tr>
          <tr>
            <td align="left">Walk</td>
            <td align="center">1.25</td>
            <td align="right" border="r">23.80</td>
            <td align="right" border="r">4.08 <text fontsize="90%">-79.5%</text></td>
            <td align="right">7.92 <text fontsize="90%">-66.7%</text></td>
          </tr>
          <tr>
            <td align="left">Run</td>
            <td align="center">0.80</td>
            <td align="right" border="r">19.31</td>
            <td align="right" border="r">4.11 <text fontsize="90%">-78.7%</text></td>
            <td align="right">8.16 <text fontsize="90%">-57.7%</text></td>
          </tr>
          <tr>
            <td align="left">Jump</td>
            <td align="center">1.77</td>
            <td align="right" border="r">25.65</td>
            <td align="right" border="r">41.63 <text fontsize="90%">+77.8%</text></td>
            <td align="right">5.28 <text fontsize="90%">-79.4%</text></td>
          </tr>
          <tr>
            <td align="left" border="bb">Dance</td>
            <td align="center" border="bb">1.62</td>
            <td align="right" border="bb r">24.59</td>
            <td align="right" border="bb r">10.00 <text fontsize="90%">-59.3%</text></td>
            <td align="right" border="bb">16.56 <text fontsize="90%">-32.6%</text></td>
          </tr>
        </tabular>
      </table>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS3">
      <tags>
        <tag>4.3</tag>
        <tag role="autoref">subsection 4.3</tag>
        <tag role="refnum">4.3</tag>
        <tag role="typerefnum">§4.3</tag>
      </tags>
      <title><tag close=" ">4.3</tag>Ablation on Truncation length</title>
      <para xml:id="S4.SS3.p1">
        <p>Training the policy with DPS would suffer from the vanishing/exploding gradients and local optimal. Recent research <cite class="ltx_citemacro_citep">(<bibref bibrefs="xu2022accelerated" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> points out that such a problem can be mitigated by a truncated learning window, which splits the entire trajectory into segments with shorter horizons. we carried out experiments to validate whether such an idea can be directly applied in motion mimicking with DPS. Truncation length refers to the horizon over which the gradient is calculated. The quantitative results are shown in Fig. <ref labelref="LABEL:tab:ablation"/>. Indeed, it is difficult to learn a good policy by propagating the gradient through a whole trajectory that is long. In addition, simply splitting the whole trajectory into segments would worsen the final performance. We hypothesize the naive truncation of the trajectory creates discontinuities in the whole trajectory whereas motions in the trajectory are highly interdependent. For example, how to flip in mid-air closely relates to how the character jumps. We see this as a strong call for a better strategy to handle these two challenges in motion mimicking with DPS.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S4.SS4">
      <tags>
        <tag>4.4</tag>
        <tag role="autoref">subsection 4.4</tag>
        <tag role="refnum">4.4</tag>
        <tag role="typerefnum">§4.4</tag>
      </tags>
      <title><tag close=" ">4.4</tag>Ablation on Demonstration Replay</title>
      <table placement="t" xml:id="S4.SS4.tab1">
        <tabular class="ltx_figure_panel" vattach="middle">
          <tr>
            <td align="center"><graphics candidates="figures/qp/backflip_demo.png" graphic="figures/qp/backflip_demo.png" options="width=173.44534pt,keepaspectratio=true" xml:id="S4.SS4.g1"/></td>
            <td align="center"><graphics candidates="figures/qp/backflip_trunc1000.png" graphic="figures/qp/backflip_trunc1000.png" options="width=173.44534pt,keepaspectratio=true" xml:id="S4.SS4.g2"/></td>
          </tr>
          <tr>
            <td align="center">(a) Reference motion.</td>
            <td align="center">(b) Full Horizon Gradient.</td>
          </tr>
          <tr>
            <td align="center"><graphics candidates="figures/qp/backflip_random.png" graphic="figures/qp/backflip_random.png" options="width=173.44534pt,keepaspectratio=true" xml:id="S4.SS4.g3"/></td>
            <td align="center"><graphics candidates="figures/qp/backflip_err0.4.png" graphic="figures/qp/backflip_err0.4.png" options="width=173.44534pt,keepaspectratio=true" xml:id="S4.SS4.g4"/></td>
          </tr>
          <tr>
            <td align="center">(c) Demonstration Replay (Random).</td>
            <td align="center">(d) Demonstration Replay (Threshold).</td>
          </tr>
        </tabular>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:vis_ablation" xml:id="S4.F7">
          <tags>
            <tag><text fontsize="90%">Figure 7</text></tag>
            <tag role="autoref">Figure 7</tag>
            <tag role="refnum">7</tag>
            <tag role="typerefnum">Figure 7</tag>
          </tags>
          <toccaption><tag close=" ">7</tag>Qualitative results of three variants of DiffMimic with respect to demonstration replay. The policy trained with full horizon gradient fails to jump up. The policy trained with Demonstration Replay (Random) fails to recover the reference motion faithfully. </toccaption>
          <caption><tag close=": "><text fontsize="90%">Figure 7</text></tag><text fontsize="90%">Qualitative results of three variants of DiffMimic with respect to demonstration replay. The policy trained with full horizon gradient fails to jump up. The policy trained with Demonstration Replay (Random) fails to recover the reference motion faithfully. </text></caption>
        </figure>
      </table>
      <table xml:id="S4.SS4.tab2">
<!--  %**** 4˙experiments.tex Line 100 **** -->        <tabular class="ltx_centering ltx_figure_panel" vattach="middle">
          <tr>
            <td align="center"><graphics candidates="figures/trunc_backflip.pdf" graphic="figures/trunc_backflip.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="S4.SS4.g5"/></td>
            <td align="center"><graphics candidates="figures/rand_backflip.pdf" graphic="figures/rand_backflip.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="S4.SS4.g6"/></td>
            <td align="center"><graphics candidates="figures/err_backflip.pdf" graphic="figures/err_backflip.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="S4.SS4.g7"/></td>
          </tr>
          <tr>
            <td align="center">(a)</td>
            <td align="center">(c)</td>
            <td align="center">(e)</td>
          </tr>
          <tr>
            <td align="center"><graphics candidates="figures/trunc_cartwheel.pdf" graphic="figures/trunc_cartwheel.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="S4.SS4.g8"/></td>
            <td align="center"><graphics candidates="figures/rand_cartwheel.pdf" graphic="figures/rand_cartwheel.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="S4.SS4.g9"/></td>
            <td align="center"><graphics candidates="figures/err_cartwheel.pdf" graphic="figures/err_cartwheel.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="S4.SS4.g10"/></td>
          </tr>
          <tr>
            <td align="center">(b)</td>
            <td align="center">(d)</td>
            <td align="center">(f)</td>
          </tr>
        </tabular>
        <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:tab:ablation" xml:id="S4.F8">
          <tags>
            <tag><text fontsize="90%">Figure 8</text></tag>
            <tag role="autoref">Figure 8</tag>
            <tag role="refnum">8</tag>
            <tag role="typerefnum">Figure 8</tag>
          </tags>
          <toccaption><tag close=" ">8</tag>(a)-(b) Comparison between Full Horizon Gradient and truncation length of 10.
(c)-(d) Comparison between Demonstration Replay (Random) and Full Horizon Gradient.
(e)-(f) Comparison between Demonstration Replay (Random) and Demonstration Replay (Threshold). The blue dotted line denotes 10 minutes in the corresponding wallclock time.</toccaption>
          <caption><tag close=": "><text fontsize="90%">Figure 8</text></tag><text fontsize="90%">(a)-(b) Comparison between Full Horizon Gradient and truncation length of 10.
(c)-(d) Comparison between Demonstration Replay (Random) and Full Horizon Gradient.
(e)-(f) Comparison between Demonstration Replay (Random) and Demonstration Replay (Threshold). The blue dotted line denotes 10 minutes in the corresponding wallclock time.</text></caption>
        </figure>
      </table>
      <para xml:id="S4.SS4.p1">
        <p>To understand how demonstration replay affects the policy learning of DiffMimic, we compare three different variants of DiffMimic, namely, Demonstration Replay (Random) and Demonstration Replay (Threshold), and Full Horizon Gradient on <text font="italic">Backflip</text> and <text font="italic">Cartwheel</text>. Demonstration Replay (Random) randomly replaces a state in the rollout of the policy with the demonstration state at the same timestamp similar to the teacher forcing <cite class="ltx_citemacro_citep">(<bibref bibrefs="williams1989learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Demonstration Replay (Threshold) inserts the demonstration state based on the pose error. If the pose error between the demonstration state and the simulated state exceeds a threshold <Math mode="inline" tex="\epsilon" text="epsilon" xml:id="S4.SS4.p1.m1">
            <XMath>
              <XMTok font="italic" name="epsilon" role="UNKNOWN">ϵ</XMTok>
            </XMath>
          </Math>, the simulated state will be replaced by the demonstration state.
The Full Horizon Gradient variant backpropagates the gradient through the full horizon without any additional operation. We show the quantitative result in Fig. <ref labelref="LABEL:tab:ablation"/>, and the qualitative result in Fig. <ref labelref="LABEL:fig:vis_ablation"/>.</p>
      </para>
      <para xml:id="S4.SS4.p2">
        <p><text font="bold">Demonstration replay helps stabilize policy learning and leads to better performance.</text> Compared with the Full Horizon Gradient without demonstration replay, the learning curve with demonstration replay is much smoother and finally converges to a lower pose error as shown in Fig. <ref labelref="LABEL:tab:ablation"/> (c)-(d). We show in Fig. <ref labelref="LABEL:fig:vis_ablation"/> (b), this vanilla version of DiffMimic can easily get stuck into a local minimum. Instead of learning to backflip, the policy learns to bend down and use arms to support itself instead of jumping up. The other two variants, by contrast, both learn to jump and backflip in mid-air successfully.</p>
      </para>
      <figure float="right" inlist="lof" labels="LABEL:fig:frame_loss" xml:id="S4.F9">
        <tags>
          <tag><text fontsize="90%">Figure 9</text></tag>
          <tag role="autoref">Figure 9</tag>
          <tag role="refnum">9</tag>
          <tag role="typerefnum">Figure 9</tag>
        </tags>
        <graphics candidates="figures/frame_backflip.pdf" class="ltx_centering" graphic="figures/frame_backflip.pdf" options="width=164.77771pt,keepaspectratio=true" xml:id="S4.F9.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">9</tag>L2 error per frame in the rollout of the final policy. Although Demonstration Replay (Random) reduces the overall pose error compared to full-horizon optimization, the per-frame loss remains large in certain time steps due to the lack of a constraint. Demonstration Replay (Threshold) alleviates the issue.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 9</text></tag><text fontsize="90%">L2 error per frame in the rollout of the final policy. Although Demonstration Replay (Random) reduces the overall pose error compared to full-horizon optimization, the per-frame loss remains large in certain time steps due to the lack of a constraint. Demonstration Replay (Threshold) alleviates the issue.</text></caption>
      </figure>
      <para xml:id="S4.SS4.p3">
        <p><text font="bold">Policy-aware demonstration replay leads to a more faithful recovery of demonstration.</text>
We compare Demonstration Replay (Threshold) with Demonstration Replay (Random) in Fig. <ref labelref="LABEL:tab:ablation"/> (e)-(f). Quantitatively, both variants yield similar results if the hyperparameter is properly tuned. However, the behavior of policies trained with these two strategies can be significantly different. In Fig. <ref labelref="LABEL:fig:vis_ablation"/> (c) and (d), though both policies learn to backflip successfully, the policy trained with Demonstration Replay (Random) fails to recover the motion frame by frame.
We show in Fig. <ref labelref="LABEL:fig:frame_loss"/> the per-frame pose error. Even though the average error over the whole trajectory for both variants is similar, Demonstration Replay (Threshold) gives a lower maximum per-frame error, which indicates a faithful recovery of the demonstration. This implies that simply minimizing the pose error may not suffice to learn a policy that tracks the demonstration closely. Finer-grained guidance based on the current performance of the policy is required.</p>
      </para>
<!--  %**** main.tex Line 50 **** -->    </subsection>
  </section>
  <section inlist="toc" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Conclusion &amp; Future works</title>
    <para xml:id="S5.p1">
      <p>In summary, we present DiffMimic utilizes differentiable physics simulators (DPS) for motion mimicking and outperforms several commonly used RL-based methods in various tasks with high accuracy, stability, and efficiency. We believe DiffMimic can serve as a starting point for motion mimicking with DPS and that our simulation environments provide exciting opportunities for future research.</p>
    </para>
    <para xml:id="S5.p2">
      <p>While there are many exciting directions to explore, there are also various challenges. One such challenge is to enable motion mimicking within minutes given any arbitrary demonstration. With differentiable physics, this would greatly accelerate downstream tasks. In our work, we demonstrate that DiffMimic can learn challenging motions in just 10 minutes. However, the tasks we evaluated were relatively short and did not involve any interactions with other objects. As the dynamic system becomes more complex with multiple objects, we leave these challenges for future work.</p>
    </para>
    <pagination role="newpage"/>
  </section>
  <section xml:id="Sx1">
    <title>Ethics Statements</title>
    <para xml:id="Sx1.p1">
      <p>We have carefully reviewed and adhered to the ICLR Code of Ethics. DiffMimic conducts experiments exclusively on humanoid characters, and no experiments involve human subjects. Additionally, all experiments are performed using open-sourced materials and are properly cited.</p>
    </para>
  </section>
  <section xml:id="Sx2">
    <title>Reproducibility Statements</title>
    <para xml:id="Sx2.p1">
      <p>Our code is easily accessible and openly available for review at <ref idref="https://github.com/diffmimic/diffmimic">https://github.com/diffmimic/diffmimic</ref>. Additionally, the reported results can be easily reproduced using the provided code.</p>
    </para>
  </section>
  <section xml:id="Sx3">
    <title>Acknowledgment</title>
    <para xml:id="Sx3.p1">
      <p>This research is supported by the National Research Foundation, Singapore under its AI Singapore Programme (AISG Award No: AISG2-PhD-2022-01-036T, AISG2-PhD-2021-08-015T and AISG2-PhD-2021-08-018), NTU NAP, MOE AcRF Tier 2 (T2EP20221-0012), and under the RIE2020 Industry Alignment Fund - Industry Collaboration Projects
(IAF-ICP) Funding Initiative, as well as cash and in-kind contribution from the industry partner(s).</p>
    </para>
  </section>
  <bibliography xml:id="bib">
    <title>References</title>
    <biblist>
      <bibitem key="bergamin2019drecon" xml:id="bib.bib1">
        <tags>
          <tag role="number">1</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Bergamin et al.</tag>
          <tag role="fullauthors">Bergamin, Clavet, Holden, and
Forbes</tag>
          <tag role="refnum">Bergamin et al. (2019)</tag>
          <tag role="key">bergamin2019drecon</tag>
        </tags>
        <bibblock>
Kevin Bergamin, Simon Clavet, Daniel Holden, and James Richard Forbes.
</bibblock>
        <bibblock>Drecon: data-driven responsive control of physics-based characters.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions On Graphics (TOG)</emph>, 2019.
</bibblock>
      </bibitem>
      <bibitem key="chen2022imitation" xml:id="bib.bib2">
        <tags>
          <tag role="number">2</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Chen et al.</tag>
          <tag role="fullauthors">Chen, Ma, and Xu</tag>
          <tag role="refnum">Chen et al. (2022)</tag>
          <tag role="key">chen2022imitation</tag>
        </tags>
        <bibblock>
Siwei Chen, Xiao Ma, and Zhongwen Xu.
</bibblock>
        <bibblock>Imitation learning via differentiable physics.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:2206.04873</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="Degrave2017ADP" xml:id="bib.bib3">
        <tags>
          <tag role="number">3</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Degrave et al.</tag>
          <tag role="fullauthors">Degrave, Hermans, Dambre, and
Wyffels</tag>
          <tag role="refnum">Degrave et al. (2017)</tag>
          <tag role="key">Degrave2017ADP</tag>
        </tags>
        <bibblock>
Jonas Degrave, Michiel Hermans, Joni Dambre, and Francis Wyffels.
</bibblock>
        <bibblock>A differentiable physics engine for deep learning in robotics.
</bibblock>
        <bibblock><emph font="italic">Frontiers in Neurorobotics</emph><!--  %**** main.bbl Line 25 **** -->, 2017.
</bibblock>
      </bibitem>
      <bibitem key="freeman2021brax" xml:id="bib.bib4">
        <tags>
          <tag role="number">4</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Freeman et al.</tag>
          <tag role="fullauthors">Freeman, Frey, Raichuk, Girgin, Mordatch, and
Bachem</tag>
          <tag role="refnum">Freeman et al. (2021)</tag>
          <tag role="key">freeman2021brax</tag>
        </tags>
        <bibblock>
C Daniel Freeman, Erik Frey, Anton Raichuk, Sertan Girgin, Igor Mordatch, and
Olivier Bachem.
</bibblock>
        <bibblock>Brax–a differentiable physics engine for large scale rigid body
simulation.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:2106.13281</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="fussell2021supertrack" xml:id="bib.bib5">
        <tags>
          <tag role="number">5</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Fussell et al.</tag>
          <tag role="fullauthors">Fussell, Bergamin, and
Holden</tag>
          <tag role="refnum">Fussell et al. (2021)</tag>
          <tag role="key">fussell2021supertrack</tag>
        </tags>
        <bibblock>
Levi Fussell, Kevin Bergamin, and Daniel Holden.
</bibblock>
        <bibblock>Supertrack: Motion tracking for physically simulated characters using
supervised learning.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions on Graphics (TOG)</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="hasenclever2020comic" xml:id="bib.bib6">
        <tags>
          <tag role="number">6</tag>
          <tag role="year">2020</tag>
          <tag role="authors">Hasenclever et al.</tag>
          <tag role="fullauthors">Hasenclever, Pardo, Hadsell, Heess, and
Merel</tag>
          <tag role="refnum">Hasenclever et al. (2020)</tag>
          <tag role="key">hasenclever2020comic</tag>
        </tags>
        <bibblock>
Leonard Hasenclever, Fabio Pardo, Raia Hadsell, Nicolas Heess, and Josh Merel.
</bibblock>
        <bibblock>Comic: Complementary task learning &amp; mimicry for reusable skills.
</bibblock>
        <bibblock>In <emph font="italic">International Conference on Machine Learning</emph>, 2020.
</bibblock>
      </bibitem>
      <bibitem key="hong2019physics" xml:id="bib.bib7">
        <tags>
          <tag role="number">7</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Hong et al.</tag>
          <tag role="fullauthors">Hong, Han, Cho, Shin, and Noh</tag>
          <tag role="refnum">Hong et al. (2019)</tag>
          <tag role="key">hong2019physics</tag>
        </tags>
        <bibblock>
Seokpyo Hong, Daseong Han, Kyungmin Cho, Joseph S Shin, and Junyong Noh.
</bibblock>
        <bibblock>Physics-based full-body soccer motion control for dribbling and
shooting.
</bibblock>
        <bibblock><!--  %**** main.bbl Line 50 **** --><emph font="italic">ACM Transactions on Graphics (TOG)</emph>, 2019.
</bibblock>
      </bibitem>
      <bibitem key="hu2019chainqueen" xml:id="bib.bib8">
        <tags>
          <tag role="number">8</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Hu et al.</tag>
          <tag role="fullauthors">Hu, Liu, Spielberg, Tenenbaum, Freeman, Wu, Rus, and
Matusik</tag>
          <tag role="refnum">Hu et al. (2019)</tag>
          <tag role="key">hu2019chainqueen</tag>
        </tags>
        <bibblock>
Yuanming Hu, Jiancheng Liu, Andrew Spielberg, Joshua B Tenenbaum, William T
Freeman, Jiajun Wu, Daniela Rus, and Wojciech Matusik.
</bibblock>
        <bibblock>Chainqueen: A real-time differentiable physical simulator for soft
robotics.
</bibblock>
        <bibblock><emph font="italic">Proceedings of IEEE International Conference on Robotics and
Automation (ICRA)</emph>, 2019.
</bibblock>
      </bibitem>
      <bibitem key="hu2019difftaichi" xml:id="bib.bib9">
        <tags>
          <tag role="number">9</tag>
          <tag role="year">2020</tag>
          <tag role="authors">Hu et al.</tag>
          <tag role="fullauthors">Hu, Anderson, Li, Sun, Carr, Ragan-Kelley, and
Durand</tag>
          <tag role="refnum">Hu et al. (2020)</tag>
          <tag role="key">hu2019difftaichi</tag>
        </tags>
        <bibblock>
Yuanming Hu, Luke Anderson, Tzu-Mao Li, Qi Sun, Nathan Carr, Jonathan
Ragan-Kelley, and Frédo Durand.
</bibblock>
        <bibblock>Difftaichi: Differentiable programming for physical simulation.
</bibblock>
        <bibblock><emph font="italic">ICLR</emph>, 2020.
</bibblock>
      </bibitem>
      <bibitem key="huang2021plasticinelab" xml:id="bib.bib10">
        <tags>
          <tag role="number">10</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Huang et al.</tag>
          <tag role="fullauthors">Huang, Hu, Du, Zhou, Su, Tenenbaum, and
Gan</tag>
          <tag role="refnum">Huang et al. (2021)</tag>
          <tag role="key">huang2021plasticinelab</tag>
        </tags>
        <bibblock>
Zhiao Huang, Yuanming Hu, Tao Du, Siyuan Zhou, Hao Su, Joshua B. Tenenbaum, and
Chuang Gan.
</bibblock>
        <bibblock>Plasticinelab: A soft-body manipulation benchmark with differentiable
physics.
</bibblock>
        <bibblock>In <emph font="italic">International Conference on Learning Representations</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="gradsim" xml:id="bib.bib11">
        <tags>
          <tag role="number">11</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Jatavallabhula et al.</tag>
          <tag role="fullauthors">Jatavallabhula, Macklin, Golemo, Voleti,
Petrini, Weiss, Considine, Parent-Levesque, Xie, Erleben, Paull, Shkurti,
Nowrouzezahrai, and Fidler</tag>
          <tag role="refnum">Jatavallabhula et al. (2021)</tag>
          <tag role="key">gradsim</tag>
        </tags>
        <bibblock>
Krishna Murthy Jatavallabhula, Miles Macklin, Florian Golemo, Vikram Voleti,
Linda Petrini, Martin Weiss, Breandan Considine, Jerome Parent-Levesque,
Kevin Xie, Kenny Erleben, Liam Paull, Florian Shkurti, Derek Nowrouzezahrai,
and Sanja Fidler.
</bibblock>
        <bibblock>gradsim: Differentiable simulation for system identification and
visuomotor control.
</bibblock>
        <bibblock><emph font="italic">International Conference on Learning Representations (ICLR)</emph>,
2021.
</bibblock>
      </bibitem>
      <bibitem key="kingma2014adam" xml:id="bib.bib12">
        <tags>
          <tag role="number">12</tag>
          <tag role="year">2014</tag>
          <tag role="authors">Kingma &amp; Ba</tag>
          <tag role="fullauthors">Kingma and Ba</tag>
          <tag role="refnum">Kingma &amp; Ba (2014)</tag>
          <tag role="key">kingma2014adam</tag>
        </tags>
        <bibblock>
Diederik P Kingma and Jimmy Ba.
</bibblock>
        <bibblock>Adam: A method for stochastic optimization.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:1412.6980</emph>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="lee2019scalable" xml:id="bib.bib13">
        <tags>
          <tag role="number">13</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Lee et al.</tag>
          <tag role="fullauthors">Lee, Park, Lee, and Lee</tag>
          <tag role="refnum">Lee et al. (2019)</tag>
          <tag role="key">lee2019scalable</tag>
        </tags>
        <bibblock>
Seunghwan Lee, Moonseok Park, Kyoungmin Lee, and Jehee Lee.
</bibblock>
        <bibblock>Scalable muscle-actuated human simulation and control.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions On Graphics (TOG)</emph>, 2019.
</bibblock>
      </bibitem>
      <bibitem key="li2022diffcloth" xml:id="bib.bib14">
        <tags>
          <tag role="number">14</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Li et al.</tag>
          <tag role="fullauthors">Li, Du, Wu, Xu, and Matusik</tag>
          <tag role="refnum">Li et al. (2022)</tag>
          <tag role="key">li2022diffcloth</tag>
        </tags>
        <bibblock>
Yifei Li, Tao Du, Kui Wu, Jie Xu, and Wojciech Matusik.
</bibblock>
        <bibblock><!--  %**** main.bbl Line 100 **** -->Diffcloth: Differentiable cloth simulation with dry frictional
contact.
</bibblock>
        <bibblock><emph font="italic">ACM Trans. Graph.</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="li2020visual" xml:id="bib.bib15">
        <tags>
          <tag role="number">15</tag>
          <tag role="year">2020</tag>
          <tag role="authors">Li et al.</tag>
          <tag role="fullauthors">Li, Lin, Yi, Bear, Yamins, Wu, Tenenbaum, and
Torralba</tag>
          <tag role="refnum">Li et al. (2020)</tag>
          <tag role="key">li2020visual</tag>
        </tags>
        <bibblock>
Yunzhu Li, Toru Lin, Kexin Yi, Daniel Bear, Daniel L.K. Yamins, Jiajun Wu,
Joshua B. Tenenbaum, and Antonio Torralba.
</bibblock>
        <bibblock>Visual grounding of learned physical models.
</bibblock>
        <bibblock>In <emph font="italic">International Conference on Machine Learning</emph>, 2020.
</bibblock>
      </bibitem>
      <bibitem key="lin2022diffskill" xml:id="bib.bib16">
        <tags>
          <tag role="number">16</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Lin et al.</tag>
          <tag role="fullauthors">Lin, Huang, Li, Tenenbaum, Held, and
Gan</tag>
          <tag role="refnum">Lin et al. (2022)</tag>
          <tag role="key">lin2022diffskill</tag>
        </tags>
        <bibblock>
Xingyu Lin, Zhiao Huang, Yunzhu Li, Joshua B. Tenenbaum, David Held, and Chuang
Gan.
</bibblock>
        <bibblock>Diffskill: Skill abstraction from differentiable physics for
deformable object manipulations with tools.
</bibblock>
        <bibblock>2022.
</bibblock>
      </bibitem>
      <bibitem key="luo2020carl" xml:id="bib.bib17">
        <tags>
          <tag role="number">17</tag>
          <tag role="year">2020</tag>
          <tag role="authors">Luo et al.</tag>
          <tag role="fullauthors">Luo, Soeseno, Chen, and Chen</tag>
          <tag role="refnum">Luo et al. (2020)</tag>
          <tag role="key">luo2020carl</tag>
        </tags>
        <bibblock>
Ying-Sheng Luo, Jonathan Hans Soeseno, Trista Pei-Chun Chen, and Wei-Chao Chen.
</bibblock>
        <bibblock>Carl: Controllable agent with reinforcement learning for quadruped
locomotion.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions on Graphics (TOG)</emph><!--  %**** main.bbl Line 125 **** -->, 2020.
</bibblock>
      </bibitem>
      <bibitem key="ma2021learning" xml:id="bib.bib18">
        <tags>
          <tag role="number">18</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Ma et al.</tag>
          <tag role="fullauthors">Ma, Yang, Tong, Guo, and Yin</tag>
          <tag role="refnum">Ma et al. (2021)</tag>
          <tag role="key">ma2021learning</tag>
        </tags>
        <bibblock>
Li-Ke Ma, Zeshi Yang, Xin Tong, Baining Guo, and KangKang Yin.
</bibblock>
        <bibblock>Learning and exploring motor skills with spacetime bounds.
</bibblock>
        <bibblock>In <emph font="italic">Computer Graphics Forum</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="makoviychuk2021isaac" xml:id="bib.bib19">
        <tags>
          <tag role="number">19</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Makoviychuk et al.</tag>
          <tag role="fullauthors">Makoviychuk, Wawrzyniak, Guo, Lu, Storey,
Macklin, Hoeller, Rudin, Allshire, Handa, and State</tag>
          <tag role="refnum">Makoviychuk et al. (2021)</tag>
          <tag role="key">makoviychuk2021isaac</tag>
        </tags>
        <bibblock>
Viktor Makoviychuk, Lukasz Wawrzyniak, Yunrong Guo, Michelle Lu, Kier Storey,
Miles Macklin, David Hoeller, Nikita Rudin, Arthur Allshire, Ankur Handa, and
Gavriel State.
</bibblock>
        <bibblock>Isaac gym: High performance GPU based physics simulation for robot
learning.
</bibblock>
        <bibblock>In <emph font="italic">Thirty-fifth Conference on Neural Information Processing
Systems Datasets and Benchmarks Track (Round 2)</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="merel2018hierarchical" xml:id="bib.bib20">
        <tags>
          <tag role="number">20</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Merel et al.</tag>
          <tag role="fullauthors">Merel, Ahuja, Pham, Tunyasuvunakool, Liu, Tirumala,
Heess, and Wayne</tag>
          <tag role="refnum">Merel et al. (2018)</tag>
          <tag role="key">merel2018hierarchical</tag>
        </tags>
        <bibblock>
Josh Merel, Arun Ahuja, Vu Pham, Saran Tunyasuvunakool, Siqi Liu, Dhruva
Tirumala, Nicolas Heess, and Greg Wayne.
</bibblock>
        <bibblock>Hierarchical visuomotor control of humanoids.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:1811.09656</emph>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="pmlr-v139-mora21a" xml:id="bib.bib21">
        <tags>
          <tag role="number">21</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Mora et al.</tag>
          <tag role="fullauthors">Mora, Peychev, Ha, Vechev, and
Coros</tag>
          <tag role="refnum">Mora et al. (2021)</tag>
          <tag role="key">pmlr-v139-mora21a</tag>
        </tags>
        <bibblock><!--  %**** main.bbl Line 150 **** -->
Miguel Angel Zamora Mora, Momchil Peychev, Sehoon Ha, Martin Vechev, and
Stelian Coros.
</bibblock>
        <bibblock>Pods: Policy optimization via differentiable simulation.
</bibblock>
        <bibblock>In <emph font="italic">Proceedings of the 38th International Conference on Machine
Learning</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="Mozer1989AFB" xml:id="bib.bib22">
        <tags>
          <tag role="number">22</tag>
          <tag role="year">1989</tag>
          <tag role="authors">Mozer</tag>
          <tag role="refnum">Mozer (1989)</tag>
          <tag role="key">Mozer1989AFB</tag>
        </tags>
        <bibblock>
Michael C. Mozer.
</bibblock>
        <bibblock>A focused backpropagation algorithm for temporal pattern recognition.
</bibblock>
        <bibblock><emph font="italic">Complex Syst.</emph>, 1989.
</bibblock>
      </bibitem>
      <bibitem key="park2019learning" xml:id="bib.bib23">
        <tags>
          <tag role="number">23</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Park et al.</tag>
          <tag role="fullauthors">Park, Ryu, Lee, Lee, and Lee</tag>
          <tag role="refnum">Park et al. (2019)</tag>
          <tag role="key">park2019learning</tag>
        </tags>
        <bibblock>
Soohwan Park, Hoseok Ryu, Seyoung Lee, Sunmin Lee, and Jehee Lee.
</bibblock>
        <bibblock>Learning predict-and-simulate policies from unorganized human motion
data.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions on Graphics (TOG)</emph>, 2019.
</bibblock>
      </bibitem>
      <bibitem key="peng2018deepmimic" xml:id="bib.bib24">
        <tags>
          <tag role="number">24</tag>
          <tag role="year">2018a</tag>
          <tag role="authors">Peng et al.</tag>
          <tag role="fullauthors">Peng, Abbeel, Levine, and Van de
Panne</tag>
          <tag role="refnum">Peng et al. (2018a)</tag>
          <tag role="key">peng2018deepmimic</tag>
        </tags>
        <bibblock>
Xue Bin Peng, Pieter Abbeel, Sergey Levine, and Michiel Van de Panne.
</bibblock>
        <bibblock>Deepmimic: Example-guided deep reinforcement learning of
physics-based character skills.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions On Graphics (TOG)</emph>, 2018a.
</bibblock>
      </bibitem>
      <bibitem key="peng2018sfv" xml:id="bib.bib25">
        <tags>
          <tag role="number">25</tag>
          <tag role="year">2018b</tag>
          <tag role="authors">Peng et al.</tag>
          <tag role="fullauthors">Peng, Kanazawa, Malik, Abbeel, and
Levine</tag>
          <tag role="refnum">Peng et al. (2018b)</tag>
          <tag role="key">peng2018sfv</tag>
        </tags>
        <bibblock><!--  %**** main.bbl Line 175 **** -->
Xue Bin Peng, Angjoo Kanazawa, Jitendra Malik, Pieter Abbeel, and Sergey
Levine.
</bibblock>
        <bibblock>Sfv: Reinforcement learning of physical skills from videos.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions On Graphics (TOG)</emph>, 2018b.
</bibblock>
      </bibitem>
      <bibitem key="peng2019mcp" xml:id="bib.bib26">
        <tags>
          <tag role="number">26</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Peng et al.</tag>
          <tag role="fullauthors">Peng, Chang, Zhang, Abbeel, and Levine</tag>
          <tag role="refnum">Peng et al. (2019)</tag>
          <tag role="key">peng2019mcp</tag>
        </tags>
        <bibblock>
Xue Bin Peng, Michael Chang, Grace Zhang, Pieter Abbeel, and Sergey Levine.
</bibblock>
        <bibblock>Mcp: Learning composable hierarchical control with multiplicative
compositional policies.
</bibblock>
        <bibblock><emph font="italic">Advances in Neural Information Processing Systems</emph>, 2019.
</bibblock>
      </bibitem>
      <bibitem key="peng2021amp" xml:id="bib.bib27">
        <tags>
          <tag role="number">27</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Peng et al.</tag>
          <tag role="fullauthors">Peng, Ma, Abbeel, Levine, and Kanazawa</tag>
          <tag role="refnum">Peng et al. (2021)</tag>
          <tag role="key">peng2021amp</tag>
        </tags>
        <bibblock>
Xue Bin Peng, Ze Ma, Pieter Abbeel, Sergey Levine, and Angjoo Kanazawa.
</bibblock>
        <bibblock>Amp: Adversarial motion priors for stylized physics-based character
control.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions on Graphics (TOG)</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="peng2022ase" xml:id="bib.bib28">
        <tags>
          <tag role="number">28</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Peng et al.</tag>
          <tag role="fullauthors">Peng, Guo, Halper, Levine, and Fidler</tag>
          <tag role="refnum">Peng et al. (2022)</tag>
          <tag role="key">peng2022ase</tag>
        </tags>
        <bibblock>
Xue Bin Peng, Yunrong Guo, Lina Halper, Sergey Levine, and Sanja Fidler.
</bibblock>
        <bibblock>Ase: Large-scale reusable adversarial skill embeddings for physically
simulated characters.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:2205.01906</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="qiao2021differentiable" xml:id="bib.bib29">
        <tags>
          <tag role="number">29</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Qiao et al.</tag>
          <tag role="fullauthors">Qiao, Liang, Koltun, and Lin</tag>
          <tag role="refnum">Qiao et al. (2021)</tag>
          <tag role="key">qiao2021differentiable</tag>
        </tags>
        <bibblock>
Yi-Ling Qiao, Junbang Liang, Vladlen Koltun, and Ming Lin.
</bibblock>
        <bibblock><!--  %**** main.bbl Line 200 **** -->Differentiable simulation of soft multi-body systems.
</bibblock>
        <bibblock>In <emph font="italic">Advances in Neural Information Processing Systems</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="ramachandran2017searching" xml:id="bib.bib30">
        <tags>
          <tag role="number">30</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Ramachandran et al.</tag>
          <tag role="fullauthors">Ramachandran, Zoph, and
Le</tag>
          <tag role="refnum">Ramachandran et al. (2017)</tag>
          <tag role="key">ramachandran2017searching</tag>
        </tags>
        <bibblock>
Prajit Ramachandran, Barret Zoph, and Quoc V Le.
</bibblock>
        <bibblock>Searching for activation functions.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:1710.05941</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="Reallusion" xml:id="bib.bib31">
        <tags>
          <tag role="number">31</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Reallusion</tag>
          <tag role="refnum">Reallusion (2022)</tag>
          <tag role="key">Reallusion</tag>
        </tags>
        <bibblock>
Reallusion.
</bibblock>
        <bibblock>3d animation and 2d cartoons made simple, 2022.
</bibblock>
      </bibitem>
      <bibitem key="sakoe1978dynamic" xml:id="bib.bib32">
        <tags>
          <tag role="number">32</tag>
          <tag role="year">1978</tag>
          <tag role="authors">Sakoe &amp; Chiba</tag>
          <tag role="fullauthors">Sakoe and Chiba</tag>
          <tag role="refnum">Sakoe &amp; Chiba (1978)</tag>
          <tag role="key">sakoe1978dynamic</tag>
        </tags>
        <bibblock>
Hiroaki Sakoe and Seibi Chiba.
</bibblock>
        <bibblock>Dynamic programming algorithm optimization for spoken word
recognition.
</bibblock>
        <bibblock><emph font="italic">IEEE transactions on acoustics, speech, and signal processing</emph>,
1978.
</bibblock>
      </bibitem>
      <bibitem key="schulman2017proximal" xml:id="bib.bib33">
        <tags>
          <tag role="number">33</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Schulman et al.</tag>
          <tag role="fullauthors">Schulman, Wolski, Dhariwal, Radford, and
Klimov</tag>
          <tag role="refnum">Schulman et al. (2017)</tag>
          <tag role="key">schulman2017proximal</tag>
        </tags>
        <bibblock>
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
</bibblock>
        <bibblock>Proximal policy optimization algorithms.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:1707.06347</emph>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="suh2022does" xml:id="bib.bib34">
        <tags>
          <tag role="number">34</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Suh et al.</tag>
          <tag role="fullauthors">Suh, Simchowitz, Zhang, and Tedrake</tag>
          <tag role="refnum">Suh et al. (2022)</tag>
          <tag role="key">suh2022does</tag>
        </tags>
        <bibblock>
Hyung Ju Suh, Max Simchowitz, Kaiqing Zhang, and Russ Tedrake.
</bibblock>
        <bibblock>Do differentiable simulators give better policy gradients?
</bibblock>
        <bibblock>In <emph font="italic">Proceedings of the 39th International Conference on Machine
Learning</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="wagener2022mocapact" xml:id="bib.bib35">
        <tags>
          <tag role="number">35</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Wagener et al.</tag>
          <tag role="fullauthors">Wagener, Kolobov, Frujeri, Loynd, Cheng, and
Hausknecht</tag>
          <tag role="refnum">Wagener et al. (2022)</tag>
          <tag role="key">wagener2022mocapact</tag>
        </tags>
        <bibblock>
Nolan Wagener, Andrey Kolobov, Felipe Vieira Frujeri, Ricky Loynd, Ching-An
Cheng, and Matthew Hausknecht.
</bibblock>
        <bibblock>Mocapact: A multi-task dataset for simulated humanoid control.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:2208.07363</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="williams1989learning" xml:id="bib.bib36">
        <tags>
          <tag role="number">36</tag>
          <tag role="year">1989</tag>
          <tag role="authors">Williams &amp; Zipser</tag>
          <tag role="fullauthors">Williams and Zipser</tag>
          <tag role="refnum">Williams &amp; Zipser (1989)</tag>
          <tag role="key">williams1989learning</tag>
        </tags>
        <bibblock>
Ronald J Williams and David Zipser.
</bibblock>
        <bibblock>A learning algorithm for continually running fully recurrent neural
networks.
</bibblock>
        <bibblock><emph font="italic">Neural computation</emph>, 1989.
</bibblock>
      </bibitem>
      <bibitem key="won2020scalable" xml:id="bib.bib37">
        <tags>
          <tag role="number">37</tag>
          <tag role="year">2020</tag>
          <tag role="authors">Won et al.</tag>
          <tag role="fullauthors">Won, Gopinath, and Hodgins</tag>
          <tag role="refnum">Won et al. (2020)</tag>
          <tag role="key">won2020scalable</tag>
        </tags>
        <bibblock>
Jungdam Won, Deepak Gopinath, and Jessica Hodgins.
</bibblock>
        <bibblock>A scalable approach to control diverse behaviors for physically
simulated characters.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions on Graphics (TOG)</emph>, 2020.
</bibblock>
      </bibitem>
      <bibitem key="won2022physics" xml:id="bib.bib38">
        <tags>
          <tag role="number">38</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Won et al.</tag>
          <tag role="fullauthors">Won, Gopinath, and Hodgins</tag>
          <tag role="refnum">Won et al. (2022)</tag>
          <tag role="key">won2022physics</tag>
        </tags>
        <bibblock>
Jungdam Won, Deepak Gopinath, and Jessica Hodgins.
</bibblock>
        <bibblock>Physics-based character controllers using conditional vaes.
</bibblock>
        <bibblock><emph font="italic">ACM Transactions on Graphics (TOG)</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="xu2022accelerated" xml:id="bib.bib39">
        <tags>
          <tag role="number">39</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Xu et al.</tag>
          <tag role="fullauthors">Xu, Makoviychuk, Narang, Ramos, Matusik, Garg, and
Macklin</tag>
          <tag role="refnum">Xu et al. (2022)</tag>
          <tag role="key">xu2022accelerated</tag>
        </tags>
        <bibblock>
Jie Xu, Viktor Makoviychuk, Yashraj Narang, Fabio Ramos, Wojciech Matusik,
Animesh Garg, and Miles Macklin.
</bibblock>
        <bibblock>Accelerated policy learning with parallel differentiable simulation.
</bibblock>
        <bibblock><emph font="italic">arXiv preprint arXiv:2204.07137</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="yang2021efficient" xml:id="bib.bib40">
        <tags>
          <tag role="number">40</tag>
          <tag role="year">2021</tag>
          <tag role="authors">Yang &amp; Yin</tag>
          <tag role="fullauthors">Yang and Yin</tag>
          <tag role="refnum">Yang &amp; Yin (2021)</tag>
          <tag role="key">yang2021efficient</tag>
        </tags>
        <bibblock>
Zeshi Yang and Zhiqi Yin.
</bibblock>
        <bibblock>Efficient hyperparameter optimization for physics-based character
animation.
</bibblock>
        <bibblock><emph font="italic">Proceedings of the ACM on Computer Graphics and Interactive
Techniques</emph>, 2021.
</bibblock>
      </bibitem>
      <bibitem key="zhong2022differentiable" xml:id="bib.bib41">
        <tags>
          <tag role="number">41</tag>
          <tag role="year">2022</tag>
          <tag role="authors">Zhong et al.</tag>
          <tag role="fullauthors">Zhong, Han, and Brikis</tag>
          <tag role="refnum">Zhong et al. (2022)</tag>
          <tag role="key">zhong2022differentiable</tag>
        </tags>
        <bibblock>
Yaofeng Desmond Zhong, Jiequn Han, and Georgia Olympia Brikis.
</bibblock>
        <bibblock>Differentiable physics simulations with contacts: Do they have
correct gradients w.r.t. position, velocity and control?
</bibblock>
        <bibblock>In <emph font="italic">ICML 2022 2nd AI for Science Workshop</emph>, 2022.
</bibblock>
      </bibitem>
      <bibitem key="zhou2019continuity" xml:id="bib.bib42">
        <tags>
          <tag role="number">42</tag>
          <tag role="year">2019</tag>
          <tag role="authors">Zhou et al.</tag>
          <tag role="fullauthors">Zhou, Barnes, Lu, Yang, and Li</tag>
          <tag role="refnum">Zhou et al. (2019)</tag>
          <tag role="key">zhou2019continuity</tag>
        </tags>
        <bibblock>
Yi Zhou, Connelly Barnes, Jingwan Lu, Jimei Yang, and Hao Li.
</bibblock>
        <bibblock>On the continuity of rotation representations in neural networks.
</bibblock>
        <bibblock>In <emph font="italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</emph>, 2019.
</bibblock>
      </bibitem>
    </biblist>
  </bibliography>
  <pagination role="newpage"/>
  <TOC lists="toc" scope="global" select="ltx:part | ltx:chapter | ltx:section | ltx:subsection | ltx:subsubsection | ltx:appendix | ltx:index | ltx:bibliography">
    <title>Contents</title>
  </TOC>
  <appendix inlist="toc" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Qualitative Results</title>
    <toctitle><tag close=" ">A</tag>Qualitative Results</toctitle>
    <para xml:id="A1.p1">
      <p>We present our qualitative results in the following website:
<ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlitapp.com/">https://diffmimic-demo-main-g7h0i8.streamlitapp.com/</ref>.</p>
    </para>
    <para xml:id="A1.p2">
      <p>It contains the following qualitative results:</p>
      <itemize xml:id="A1.I1">
        <item xml:id="A1.I1.i1">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">1st item</tag>
          </tags>
          <para xml:id="A1.I1.i1.p1">
            <p>Back-Flip 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i2">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">2nd item</tag>
          </tags>
          <para xml:id="A1.I1.i2.p1">
            <p>Cartwheel 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i3">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">3rd item</tag>
          </tags>
          <para xml:id="A1.I1.i3.p1">
            <p>Crawl 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i4">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">4th item</tag>
          </tags>
          <para xml:id="A1.I1.i4.p1">
            <p>Dance 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i5">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">5th item</tag>
          </tags>
          <para xml:id="A1.I1.i5.p1">
            <p>Jog 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i6">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">6th item</tag>
          </tags>
          <para xml:id="A1.I1.i6.p1">
            <p>Jump 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i7">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">7th item</tag>
          </tags>
          <para xml:id="A1.I1.i7.p1">
            <p>Roll 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i8">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">8th item</tag>
          </tags>
          <para xml:id="A1.I1.i8.p1">
            <p>Side-Flip 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i9">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">9th item</tag>
          </tags>
          <para xml:id="A1.I1.i9.p1">
            <p>Spin-Kick 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i10">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">10th item</tag>
          </tags>
          <para xml:id="A1.I1.i10.p1">
            <p>Walk 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i11">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">11st item</tag>
          </tags>
          <para xml:id="A1.I1.i11.p1">
            <p>Zombie 20-second rollout.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i12">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">12nd item</tag>
          </tags>
          <para xml:id="A1.I1.i12.p1">
            <p>Back-Flip 20-second rollout, trained for 2.5 hours.</p>
          </para>
        </item>
        <item xml:id="A1.I1.i13">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">13rd item</tag>
          </tags>
          <para xml:id="A1.I1.i13.p1">
            <p><!--  %**** appendix.tex Line 25 **** -->Back-Flip single cycle rollout, trained for 10 minutes.</p>
          </para>
        </item>
      </itemize>
    </para>
  </appendix>
  <appendix inlist="toc" xml:id="A2">
    <tags>
      <tag>Appendix B</tag>
      <tag role="autoref">Appendix B</tag>
      <tag role="refnum">B</tag>
      <tag role="typerefnum">Appendix B</tag>
    </tags>
    <title><tag close=" ">Appendix B</tag>Policy Network</title>
    <toctitle><tag close=" ">B</tag>Policy Network</toctitle>
    <para xml:id="A2.p1">
      <p>We use an MLP for the policy network. The network has two hidden layers with sizes 512 and 256. We use Swish <cite class="ltx_citemacro_citep">(<bibref bibrefs="ramachandran2017searching" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> for the activation function.</p>
    </para>
  </appendix>
  <appendix inlist="toc" xml:id="A3">
    <tags>
      <tag>Appendix C</tag>
      <tag role="autoref">Appendix C</tag>
      <tag role="refnum">C</tag>
      <tag role="typerefnum">Appendix C</tag>
    </tags>
    <title><tag close=" ">Appendix C</tag>Hyper-parameters</title>
    <toctitle><tag close=" ">C</tag>Hyper-parameters</toctitle>
    <para xml:id="A3.p1">
      <p>We use Adam optimizer <cite class="ltx_citemacro_citep">(<bibref bibrefs="kingma2014adam" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> in training, with a learning rate of 3e-4 that linearly decreases with training iterations. We apply gradient clipping and set the maximum gradient norm to 0.3. We set the batch size to the same as the number of parallel environments.</p>
    </para>
    <para xml:id="A3.p2">
      <p><text font="bold">Cyclic motions.</text> We set the maximum iterations to 5000. The number of environments is set to 200.</p>
    </para>
    <para xml:id="A3.p3">
      <p><text font="bold">Acyclic motions.</text> We set the maximum iterations to 1000. The number of environments is set to 300.</p>
    </para>
    <para xml:id="A3.p4">
      <p><text font="bold">Expert Replay.</text> We run experiments with two error thresholds, 0.2 and 0.4, and report the better of the two.</p>
    </para>
  </appendix>
  <appendix inlist="toc" xml:id="A4">
    <tags>
      <tag>Appendix D</tag>
      <tag role="autoref">Appendix D</tag>
      <tag role="refnum">D</tag>
      <tag role="typerefnum">Appendix D</tag>
    </tags>
    <title><tag close=" ">Appendix D</tag>State and Action Space</title>
    <toctitle><tag close=" ">D</tag>State and Action Space</toctitle>
    <para xml:id="A4.p1">
      <p><text font="bold">Humanoid.</text>
We use 6d rotation representation <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhou2019continuity" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> in the state feature. The humanoid has an action size of 28 and a state feature size of 193.</p>
    </para>
    <para xml:id="A4.p2">
      <p><text font="bold">Humanoid with Sword and Shield.</text>
We set up the Sword and Shield character following ASE <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2022ase" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Compared to the default humanoid, the new character has 3 additional DOF on the right hand. A sword is attached to its right hand and a shield is attached to its left lower arm. The character has an action size of 31. The state feature size is 208.</p>
    </para>
    <pagination role="newpage"/>
  </appendix>
  <appendix inlist="toc" xml:id="A5">
    <tags>
      <tag>Appendix E</tag>
      <tag role="autoref">Appendix E</tag>
      <tag role="refnum">E</tag>
      <tag role="typerefnum">Appendix E</tag>
    </tags>
    <title><tag close=" ">Appendix E</tag>Learning Curves</title>
    <toctitle><tag close=" ">E</tag>Learning Curves</toctitle>
    <table placement="h!" xml:id="A5.tab1">
      <tabular class="ltx_figure_panel" vattach="middle">
        <tr>
          <td align="center"><graphics candidates="figures/mixed_backflip_legend.png" graphic="figures/mixed_backflip_legend.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g1"/></td>
          <td align="center"><graphics candidates="figures/mixed_cartwheel.png" graphic="figures/mixed_cartwheel.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g2"/></td>
          <td align="center"><graphics candidates="figures/mixed_sideflip.png" graphic="figures/mixed_sideflip.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g3"/></td>
        </tr>
        <tr>
          <td align="center"><graphics candidates="figures/mixed_run.png" graphic="figures/mixed_run.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g4"/></td>
          <td align="center"><graphics candidates="figures/mixed_walk.png" graphic="figures/mixed_walk.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g5"/></td>
          <td align="center"><graphics candidates="figures/mixed_zombie.png" graphic="figures/mixed_zombie.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g6"/></td>
        </tr>
        <tr>
          <td align="center"><graphics candidates="figures/mixed_jump.png" graphic="figures/mixed_jump.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g7"/></td>
          <td align="center"><graphics candidates="figures/mixed_spinkick_legend.png" graphic="figures/mixed_spinkick_legend.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g8"/></td>
          <td align="center"><graphics candidates="figures/mixed_jog.png" graphic="figures/mixed_jog.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g9"/></td>
        </tr>
        <tr>
          <td align="center"><graphics candidates="figures/mixed_crawl.png" graphic="figures/mixed_crawl.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g10"/></td>
          <td align="center"><graphics candidates="figures/mixed_roll.png" graphic="figures/mixed_roll.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g11"/></td>
          <td align="center"><graphics candidates="figures/mixed_dance.png" graphic="figures/mixed_dance.png" options="width=134.42113pt,keepaspectratio=true" xml:id="A5.g12"/></td>
        </tr>
      </tabular>
      <break class="ltx_break"/>
      <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:imitate_one_full" xml:id="A5.F10">
        <tags>
          <tag><text fontsize="90%">Figure 10</text></tag>
          <tag role="autoref">Figure 10</tag>
          <tag role="refnum">10</tag>
          <tag role="typerefnum">Figure 10</tag>
        </tags>
        <toccaption><tag close=" ">10</tag>Pose error versus the number of samples. DiffMimic (4s): rollout 4 seconds of Diffmimic for evaluation. DiffMimic (20s): rollout 20 seconds of Diffmimic for evaluation.</toccaption>
        <caption><tag close=": "><text fontsize="90%">Figure 10</text></tag><text fontsize="90%">Pose error versus the number of samples. DiffMimic (4s): rollout 4 seconds of Diffmimic for evaluation. DiffMimic (20s): rollout 20 seconds of Diffmimic for evaluation.</text></caption>
      </figure>
    </table>
    <pagination role="newpage"/>
  </appendix>
  <appendix inlist="toc" xml:id="A6">
    <tags>
      <tag>Appendix F</tag>
      <tag role="autoref">Appendix F</tag>
      <tag role="refnum">F</tag>
      <tag role="typerefnum">Appendix F</tag>
    </tags>
    <title><tag close=" ">Appendix F</tag>New Character</title>
    <toctitle><tag close=" ">F</tag>New Character</toctitle>
    <para xml:id="A6.p1">
      <p>We include Ant as a new character. We use the trajectory in ILD <cite class="ltx_citemacro_citep">(<bibref bibrefs="chen2022imitation" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> as the reference motion, which is obtained from a PPO <cite class="ltx_citemacro_citep">(<bibref bibrefs="schulman2017proximal" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> agent that learns to move forward as fast as possible. We achieve a 0.059 meter final pose error. We show the training curve in Figure <ref labelref="LABEL:fig:ant"/>. and the qualitative result on the <ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlit.app/">demo website</ref> under the tab ”New Character”.</p>
    </para>
    <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:ant" placement="h" xml:id="A6.F11">
      <graphics candidates="figures/Ant.pdf" class="ltx_figure_panel" graphic="figures/Ant.pdf" options="width=173.44534pt,keepaspectratio=true" xml:id="A6.g1"/>
      <tags>
        <tag><text fontsize="90%">Figure 11</text></tag>
        <tag role="autoref">Figure 11</tag>
        <tag role="refnum">11</tag>
        <tag role="typerefnum">Figure 11</tag>
      </tags>
      <toccaption><tag close=" ">11</tag>Pose error versus the number of samples for the new character, Ant.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Figure 11</text></tag><text fontsize="90%">Pose error versus the number of samples for the new character, Ant.</text></caption>
    </figure>
  </appendix>
  <appendix inlist="toc" xml:id="A7">
    <tags>
      <tag>Appendix G</tag>
      <tag role="autoref">Appendix G</tag>
      <tag role="refnum">G</tag>
      <tag role="typerefnum">Appendix G</tag>
    </tags>
    <title><tag close=" ">Appendix G</tag>New Skill</title>
    <toctitle><tag close=" ">G</tag>New Skill</toctitle>
    <para xml:id="A7.p1">
      <p>We run DiffMimic on a new skill, <emph font="italic">360-degree Jump</emph>, from the CMU Mocap Dataset (motion sequence CMU_075_09). The skill has been reported to be challenging for a RL-based method CoMic <cite class="ltx_citemacro_citep">(<bibref bibrefs="hasenclever2020comic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> in a recent dataset paper <cite class="ltx_citemacro_citep">(<bibref bibrefs="wagener2022mocapact" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. DiffMimic is able to spin in the air and achieve a 0.020 meter final pose error. We show the training curve in Figure <ref labelref="LABEL:fig:360-degree_Jump"/> and the qualitative result on the <ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlit.app/">demo website</ref> under the tab ”New Skill”.</p>
    </para>
    <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:fig:360-degree_Jump" placement="h" xml:id="A7.F12">
      <graphics candidates="figures/rebuttal/360-degree-Jump.pdf" class="ltx_figure_panel" graphic="figures/rebuttal/360-degree-Jump.pdf" options="width=173.44534pt,keepaspectratio=true" xml:id="A7.g1"/>
      <tags>
        <tag><text fontsize="90%">Figure 12</text></tag>
        <tag role="autoref">Figure 12</tag>
        <tag role="refnum">12</tag>
        <tag role="typerefnum">Figure 12</tag>
      </tags>
      <toccaption><tag close=" ">12</tag>Pose error versus the number of samples for the new skill, <emph font="italic">360-degree Jump</emph>.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Figure 12</text></tag><text fontsize="90%">Pose error versus the number of samples for the new skill, <emph font="italic">360-degree Jump</emph>.</text></caption>
    </figure>
  </appendix>
  <appendix inlist="toc" xml:id="A8">
    <tags>
      <tag>Appendix H</tag>
      <tag role="autoref">Appendix H</tag>
      <tag role="refnum">H</tag>
      <tag role="typerefnum">Appendix H</tag>
    </tags>
    <title><tag close=" ">Appendix H</tag>New Training Strategy</title>
    <toctitle><tag close=" ">H</tag>New Training Strategy</toctitle>
    <para xml:id="A8.p1">
      <p>We additionally include the Reference State Initialization (RSI) technique <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> into the DiffMimic training. RSI starts the training rollout from a random reference frame instead of the first reference frame. We observe a substantial empirical improvement after employing the new training strategy. The samples required are consistently around 90% less than DeepMimic <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> as shown in <ref class="ltx_refmacro_autoref" labelref="LABEL:tab:_rsi_sampleeff" show="autoref"/>. The final pose error has also been slightly improved as shown in <ref class="ltx_refmacro_autoref" labelref="LABEL:tab:_rsi_poseerror" show="autoref"/>. We show the qualitative results on the <ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlit.app/">demo website</ref> under the tab ”New Training”. Notably, using RSI alone or RSI+Early Termination (ET) <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> does not converge as shown in Figure <ref labelref="LABEL:tab:rsi-curve"/>.</p>
    </para>
    <table inlist="lot" labels="LABEL:tab:_rsi_sampleeff" placement="h" xml:id="A8.T3">
      <tags>
        <tag><text fontsize="90%">Table 3</text></tag>
        <tag role="autoref">Table 3</tag>
        <tag role="refnum">3</tag>
        <tag role="typerefnum">Table 3</tag>
      </tags>
      <toccaption><tag close=" ">3</tag> Number of samples required to roll out 20 seconds without falling in <Math mode="inline" tex="(10^{6})" text="10 ^ 6" xml:id="A8.T3.m1">
          <XMath>
            <XMDual>
              <XMRef idref="A8.T3.m1.1"/>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp xml:id="A8.T3.m1.1">
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> with Reference State Initialization (RSI) <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Percentage: change in the fraction of the DeepMimic samples.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Table 3</text></tag><text fontsize="90%"> Number of samples required to roll out 20 seconds without falling in <Math mode="inline" tex="(10^{6})" text="10 ^ 6" xml:id="A8.T3.m2">
            <XMath>
              <XMDual>
                <XMRef idref="A8.T3.m2.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="A8.T3.m2.1">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok meaning="10" role="NUMBER">10</XMTok>
                    <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math> with Reference State Initialization (RSI) <cite class="ltx_citemacro_citep">(<bibref bibrefs="peng2018deepmimic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Percentage: change in the fraction of the DeepMimic samples.</text></caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="tt">Motion</td>
          <td align="center" border="tt"><Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="A8.T3.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText>T</XMText>
                  <XMText><text fontsize="70%">cycle</text></XMText>
                </XMApp>
              </XMath>
            </Math>(s)</td>
          <td align="center" border="tt">DeepMimic</td>
          <td align="center" border="tt">Spacetime Bound</td>
          <td align="center" border="tt">Ours</td>
          <td align="center" border="tt">Ours w/ RSI</td>
        </tr>
        <tr>
          <td align="left" border="t">Back-Flip</td>
          <td align="center" border="t">1.75</td>
          <td align="center" border="t">31.18</td>
          <td align="center" border="t">41.20 <text fontsize="90%">+32.1%</text></td>
          <td align="center" border="t">14.88 <text fontsize="90%">-52.2%</text></td>
          <td align="center" border="t">3.82 <text fontsize="90%">-87.7%</text></td>
        </tr>
        <tr>
          <td align="left">Cartwheel</td>
          <td align="center">2.72</td>
          <td align="center">30.45</td>
          <td align="center">17.35 <text fontsize="90%">-43.0%</text></td>
          <td align="center">13.92 <text fontsize="90%">-54.2%</text></td>
          <td align="center">4.72 <text fontsize="90%">-84.5%</text></td>
        </tr>
        <tr>
          <td align="left">Walk</td>
          <td align="center">1.25</td>
          <td align="center">23.80</td>
          <td align="center">4.08 <text fontsize="90%">-79.5%</text></td>
          <td align="center">7.92 <text fontsize="90%">-66.7%</text></td>
          <td align="center">1.55 <text fontsize="90%">-93.5%</text></td>
        </tr>
        <tr>
          <td align="left">Run</td>
          <td align="center">0.80</td>
          <td align="center">19.31</td>
          <td align="center">4.11 <text fontsize="90%">-78.7%</text></td>
          <td align="center">8.16 <text fontsize="90%">-57.7%</text></td>
          <td align="center">1.41 <text fontsize="90%">-92.7%</text></td>
        </tr>
        <tr>
          <td align="left">Jump</td>
          <td align="center">1.77</td>
          <td align="center">25.65</td>
          <td align="center">41.63 <text fontsize="90%">+77.8%</text></td>
          <td align="center">5.28 <text fontsize="90%">-79.4%</text></td>
          <td align="center">2.12 <text fontsize="90%">-91.7%</text></td>
        </tr>
        <tr>
          <td align="left" border="bb">Dance</td>
          <td align="center" border="bb">1.62</td>
          <td align="center" border="bb">24.59</td>
          <td align="center" border="bb">10.00 <text fontsize="90%">-59.3%</text></td>
          <td align="center" border="bb">16.56 <text fontsize="90%">-32.6%</text></td>
          <td align="center" border="bb">2.19 <text fontsize="90%">-91.1%</text></td>
        </tr>
      </tabular>
    </table>
    <table inlist="lot" labels="LABEL:tab:_rsi_poseerror" placement="h" xml:id="A8.T4">
      <tags>
        <tag><text fontsize="90%">Table 4</text></tag>
        <tag role="autoref">Table 4</tag>
        <tag role="refnum">4</tag>
        <tag role="typerefnum">Table 4</tag>
      </tags>
      <toccaption><tag close=" ">4</tag>Pose error comparison in meters. <Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="A8.T4.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMText>T</XMText>
              <XMText><text fontsize="70%">cycle</text></XMText>
            </XMApp>
          </XMath>
        </Math> is the length of the reference motion for a single cycle. The error is averaged on 32 rollout episodes with a maximum length of 20 seconds. The result of Ours+RSI is obtained without DTW.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Table 4</text></tag><text fontsize="90%">Pose error comparison in meters. <Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="A8.T4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMText>T</XMText>
                <XMText><text fontsize="70%">cycle</text></XMText>
              </XMApp>
            </XMath>
          </Math> is the length of the reference motion for a single cycle. The error is averaged on 32 rollout episodes with a maximum length of 20 seconds. The result of Ours+RSI is obtained without DTW.</text></caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="tt">Motion</td>
          <td align="center" border="tt"><Math mode="inline" tex="\textrm{T}_{\textrm{cycle}}" text="[T] _ [cycle]" xml:id="A8.T4.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText>T</XMText>
                  <XMText><text fontsize="70%">cycle</text></XMText>
                </XMApp>
              </XMath>
            </Math>(s)</td>
          <td align="center" border="tt">DeepMimic</td>
          <td align="center" border="tt">AMP</td>
          <td align="center" border="tt">Ours</td>
          <td align="center" border="tt">Ours w/o DTW</td>
          <td align="center" border="tt">Ours w/ RSI</td>
        </tr>
        <tr>
          <td align="left" border="t">Back-Flip</td>
          <td align="center" border="t">1.75</td>
          <td align="center" border="t">0.076 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m4">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.021</td>
          <td align="center" border="t">0.150 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m5">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.028</td>
          <td align="center" border="t">0.097 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m6">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center" border="t">0.105 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m7">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.022</td>
          <td align="center" border="t">0.058<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m8">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.015</td>
        </tr>
        <tr>
          <td align="left">Cartwheel</td>
          <td align="center">2.72</td>
          <td align="center">0.039 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m9">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.011</td>
          <td align="center">0.067 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m10">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.014</td>
          <td align="center">0.040 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m11">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.007</td>
          <td align="center">0.040 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m12">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.007</td>
          <td align="center">0.027<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m13">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
        </tr>
        <tr>
          <td align="left">Crawl</td>
          <td align="center">2.93</td>
          <td align="center">0.044 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m14">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.049 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m15">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.007</td>
          <td align="center">0.037 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m16">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.037 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m17">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.035<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m18">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.003</td>
        </tr>
        <tr>
          <td align="left">Dance</td>
          <td align="center">1.62</td>
          <td align="center">0.038 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m19">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.055 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m20">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.015</td>
          <td align="center">0.070 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m21">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.003</td>
          <td align="center">0.072 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m22">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.014</td>
          <td align="center">0.042<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m23">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
        </tr>
        <tr>
          <td align="left">Jog</td>
          <td align="center">0.83</td>
          <td align="center">0.029 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m24">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.056 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m25">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.031 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m26">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
          <td align="center">0.031 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m27">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
          <td align="center">0.012<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m28">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
        </tr>
        <tr>
          <td align="left">Jump</td>
          <td align="center">1.77</td>
          <td align="center">0.033 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m29">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.083 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m30">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.022</td>
          <td align="center">0.025 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m31">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.031 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m32">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
          <td align="center">0.015<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m33">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
        </tr>
        <tr>
          <td align="left">Roll</td>
          <td align="center">2.02</td>
          <td align="center">0.072 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m34">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.018</td>
          <td align="center">0.088 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m35">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.008</td>
          <td align="center">0.061 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m36">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.007</td>
          <td align="center">0.083 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m37">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.046<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m38">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.005</td>
        </tr>
        <tr>
          <td align="left">Run</td>
          <td align="center">0.80</td>
          <td align="center">0.028 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m39">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
          <td align="center">0.075 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m40">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.015</td>
          <td align="center">0.039 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m41">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.046 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m42">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.019<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m43">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
        </tr>
        <tr>
          <td align="left">Side-Flip</td>
          <td align="center">2.44</td>
          <td align="center">0.191 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m44">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.043</td>
          <td align="center">0.124 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m45">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.012</td>
          <td align="center">0.069 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m46">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.121 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m47">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.009</td>
          <td align="center">0.035<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m48">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
        </tr>
        <tr>
          <td align="left">Spin-Kick</td>
          <td align="center">1.28</td>
          <td align="center">0.042 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m49">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.058 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m50">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.012</td>
          <td align="center">0.056 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m51">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.056 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m52">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.036<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m53">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
        </tr>
        <tr>
          <td align="left">Walk</td>
          <td align="center">1.30</td>
          <td align="center">0.018 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m54">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.005</td>
          <td align="center">0.030 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m55">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.001</td>
          <td align="center">0.017 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m56">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.017 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m57">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
          <td align="center">0.012<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m58">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.000</td>
        </tr>
        <tr>
          <td align="left" border="bb">Zombie</td>
          <td align="center" border="bb">1.68</td>
          <td align="center" border="bb">0.049 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m59">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.013</td>
          <td align="center" border="bb">0.058 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m60">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.014</td>
          <td align="center" border="bb">0.037 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m61">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
          <td align="center" border="bb">0.037 <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m62">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.002</td>
          <td align="center" border="bb">0.033<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A8.T4.m63">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.009</td>
        </tr>
      </tabular>
    </table>
<!--  %**** RSI˙comparison.tex Line 25 **** -->    <table xml:id="A8.tab1">
      <tabular class="ltx_figure_panel" vattach="middle">
        <tr>
          <td align="center"><graphics candidates="figures/rebuttal/DiffMimic_RSI.pdf" graphic="figures/rebuttal/DiffMimic_RSI.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="A8.g1"/></td>
          <td align="center"><graphics candidates="figures/rebuttal/RSI.pdf" graphic="figures/rebuttal/RSI.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="A8.g2"/></td>
          <td align="center"><graphics candidates="figures/rebuttal/RSI_ET.pdf" graphic="figures/rebuttal/RSI_ET.pdf" options="width=130.08731pt,keepaspectratio=true" xml:id="A8.g3"/></td>
          <td/>
        </tr>
        <tr>
          <td align="center">(a)</td>
          <td align="center">(b)</td>
          <td align="center">(c)</td>
          <td/>
        </tr>
      </tabular>
      <break class="ltx_break"/>
      <figure align="center" class="ltx_figure_panel" inlist="lof" labels="LABEL:tab:rsi-curve" xml:id="A8.F13">
        <tags>
          <tag><text fontsize="90%">Figure 13</text></tag>
          <tag role="autoref">Figure 13</tag>
          <tag role="refnum">13</tag>
          <tag role="typerefnum">Figure 13</tag>
        </tags>
        <toccaption><tag close=" ">13</tag>Pose error versus the number of samples on <emph font="italic">Back-Flip</emph> using (a) DiffMimic+RSI (b) standalone RSI (c) RSI+ET.
</toccaption>
        <caption><tag close=": "><text fontsize="90%">Figure 13</text></tag><text fontsize="90%">Pose error versus the number of samples on <emph font="italic">Back-Flip</emph> using (a) DiffMimic+RSI (b) standalone RSI (c) RSI+ET.
</text></caption>
      </figure>
    </table>
  </appendix>
  <appendix inlist="toc" xml:id="A9">
    <tags>
      <tag>Appendix I</tag>
      <tag role="autoref">Appendix I</tag>
      <tag role="refnum">I</tag>
      <tag role="typerefnum">Appendix I</tag>
    </tags>
    <title><tag close=" ">Appendix I</tag>Analysis on Robustness</title>
    <toctitle><tag close=" ">I</tag>Analysis on Robustness</toctitle>
    <para xml:id="A9.p1">
      <p>We further evaluate DiffMimic’s robustness to external forces. A force is applied to the pelvis of the character halfway through a motion cycle for 0.2 seconds, and we measure the maximum forwards and sideways push each policy can tolerate before falling. DiffMimic achieves comparable robustness to DeepMimic. We show the results in Table  <ref labelref="LABEL:tab:robustness"/> and the qualitative results on the <ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlit.app/">demo website</ref> under the tab ”Robustness”.</p>
    </para>
    <table inlist="lot" labels="LABEL:tab:robustness" placement="h" xml:id="A9.T5">
      <tags>
        <tag><text fontsize="90%">Table 5</text></tag>
        <tag role="autoref">Table 5</tag>
        <tag role="refnum">5</tag>
        <tag role="typerefnum">Table 5</tag>
      </tags>
      <toccaption><tag close=" ">5</tag> Maximum forwards and sideways push each policy can tolerate before falling. Each push is applied halfway through a motion cycle to the character’s pelvis for 0.2s. F: Forwards push. S: Sideways push. The unit is in Newton.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Table 5</text></tag><text fontsize="90%"> Maximum forwards and sideways push each policy can tolerate before falling. Each push is applied halfway through a motion cycle to the character’s pelvis for 0.2s. F: Forwards push. S: Sideways push. The unit is in Newton.</text></caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="r tt">Motion</td>
          <td align="right" border="tt">DeepMimic (F)</td>
          <td align="right" border="r tt">Ours (F)</td>
          <td align="right" border="tt">DeepMimic (S)</td>
          <td align="right" border="tt">Ours (S)</td>
        </tr>
        <tr>
          <td align="left" border="r t">Back-Flip</td>
          <td align="right" border="t">440</td>
          <td align="right" border="r t"><text font="bold">750</text></td>
          <td align="right" border="t">100</td>
          <td align="right" border="t"><text font="bold">310</text></td>
        </tr>
        <tr>
          <td align="left" border="r">Cartwheel</td>
          <td align="right">200</td>
          <td align="right" border="r"><text font="bold">350</text></td>
          <td align="right">470</td>
          <td align="right"><text font="bold">690</text></td>
        </tr>
        <tr>
          <td align="left" border="r">Run</td>
          <td align="right"><text font="bold">720</text></td>
          <td align="right" border="r">500</td>
          <td align="right"><text font="bold">300</text></td>
          <td align="right">270</td>
        </tr>
        <tr>
          <td align="left" border="r">Spin-Kick</td>
          <td align="right"><text font="bold">690</text></td>
          <td align="right" border="r">630</td>
          <td align="right">600</td>
          <td align="right"><text font="bold">730</text></td>
        </tr>
        <tr>
          <td align="left" border="bb r">Walk</td>
          <td align="right" border="bb">240</td>
          <td align="right" border="bb r"><text font="bold">250</text></td>
          <td align="right" border="bb"><text font="bold">300</text></td>
          <td align="right" border="bb">220</td>
        </tr>
      </tabular>
    </table>
  </appendix>
  <appendix inlist="toc" xml:id="A10">
    <tags>
      <tag>Appendix J</tag>
      <tag role="autoref">Appendix J</tag>
      <tag role="refnum">J</tag>
      <tag role="typerefnum">Appendix J</tag>
    </tags>
    <title><tag close=" ">Appendix J</tag>Analysis on Sensitivity</title>
    <toctitle><tag close=" ">J</tag>Analysis on Sensitivity</toctitle>
    <para xml:id="A10.p1">
      <p>DiffMimic with inaccurate estimates of physical parameters. Briefly speaking, DiffMimic is able to learn the control policy well even though the friction coefficient deviates from the original parameters. We show the results in Table <ref labelref="LABEL:tab:friction"/> and the qualitative results on the <ref class="ltx_href" href="https://diffmimic-demo-main-g7h0i8.streamlit.app/">demo website</ref> under the tab ”Sensitivity”.</p>
    </para>
    <table inlist="lot" labels="LABEL:tab:friction" placement="!h" xml:id="A10.T6">
      <tags>
        <tag><text fontsize="90%">Table 6</text></tag>
        <tag role="autoref">Table 6</tag>
        <tag role="refnum">6</tag>
        <tag role="typerefnum">Table 6</tag>
      </tags>
      <toccaption><tag close=" ">6</tag> Sensitivity to the friction coefficient <Math mode="inline" tex="\mu" text="mu" xml:id="A10.T6.m1">
          <XMath>
            <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
          </XMath>
        </Math>, a system parameter. The evaluation is conducted on Zombie Walk, a motion heavily impacted by the friction coefficient. <Math mode="inline" tex="\mu=1.0" text="mu = 1.0" xml:id="A10.T6.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              <XMTok meaning="1.0" role="NUMBER">1.0</XMTok>
            </XMApp>
          </XMath>
        </Math> is the standard setting, we additionally evaluate when <Math mode="inline" tex="\mu=0.8" text="mu = 0.8" xml:id="A10.T6.m3">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              <XMTok meaning="0.8" role="NUMBER">0.8</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="\mu=1.2" text="mu = 1.2" xml:id="A10.T6.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              <XMTok meaning="1.2" role="NUMBER">1.2</XMTok>
            </XMApp>
          </XMath>
        </Math>.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Table 6</text></tag><text fontsize="90%"> Sensitivity to the friction coefficient <Math mode="inline" tex="\mu" text="mu" xml:id="A10.T6.m5">
            <XMath>
              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
            </XMath>
          </Math>, a system parameter. The evaluation is conducted on Zombie Walk, a motion heavily impacted by the friction coefficient. <Math mode="inline" tex="\mu=1.0" text="mu = 1.0" xml:id="A10.T6.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                <XMTok meaning="1.0" role="NUMBER">1.0</XMTok>
              </XMApp>
            </XMath>
          </Math> is the standard setting, we additionally evaluate when <Math mode="inline" tex="\mu=0.8" text="mu = 0.8" xml:id="A10.T6.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                <XMTok meaning="0.8" role="NUMBER">0.8</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\mu=1.2" text="mu = 1.2" xml:id="A10.T6.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                <XMTok meaning="1.2" role="NUMBER">1.2</XMTok>
              </XMApp>
            </XMath>
          </Math>.</text></caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="r tt">Friction</td>
          <td align="right" border="tt">Pose Error (m)</td>
        </tr>
        <tr>
          <td align="left" border="r t"><Math mode="inline" tex="\mu" text="mu" xml:id="A10.T6.m9">
              <XMath>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              </XMath>
            </Math>=0.8</td>
          <td align="right" border="t">0.047<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A10.T6.m10">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.009</td>
        </tr>
        <tr>
          <td align="left" border="r"><Math mode="inline" tex="\mu" text="mu" xml:id="A10.T6.m11">
              <XMath>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              </XMath>
            </Math>=1.0</td>
          <td align="right">0.032<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A10.T6.m12">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.009</td>
        </tr>
        <tr>
          <td align="left" border="bb r"><Math mode="inline" tex="\mu" text="mu" xml:id="A10.T6.m13">
              <XMath>
                <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              </XMath>
            </Math>=1.2</td>
          <td align="right" border="bb">0.028<Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="A10.T6.m14">
              <XMath>
                <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
              </XMath>
            </Math> 0.007</td>
        </tr>
      </tabular>
    </table>
  </appendix>
  <appendix inlist="toc" xml:id="A11">
    <tags>
      <tag>Appendix K</tag>
      <tag role="autoref">Appendix K</tag>
      <tag role="refnum">K</tag>
      <tag role="typerefnum">Appendix K</tag>
    </tags>
    <title><tag close=" ">Appendix K</tag>Analysis on Motion Quality</title>
    <toctitle><tag close=" ">K</tag>Analysis on Motion Quality</toctitle>
    <para xml:id="A11.p1">
      <p>Motion quality can be severely affected by a small number of large error poses, which can not be reflected by the existing average pose error metric. We propose a Pose Absurdity metric to quantify large-error poses. L2@0.01, 0.05, and 0.1 measure the average L2 pose error on the worst 1%, 5%, and 10% frames
respectively. Full Horizon Gradient, Demonstration Replay (Random) ratio <Math mode="inline" tex="\lambda" text="lambda" xml:id="A11.p1.m1">
          <XMath>
            <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
          </XMath>
        </Math>, and Demonstration Replay (Threshold) threshold <Math mode="inline" tex="\gamma" text="gamma" xml:id="A11.p1.m2">
          <XMath>
            <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
          </XMath>
        </Math> are studied. Demonstration Replay (Threshold) outperforms other baselines by a large margin. We show the results in Table  <ref labelref="LABEL:tab:metric"/></p>
    </para>
    <table inlist="lot" labels="LABEL:tab:metric" placement="h" xml:id="A11.T7">
      <tags>
        <tag><text fontsize="90%">Table 7</text></tag>
        <tag role="autoref">Table 7</tag>
        <tag role="refnum">7</tag>
        <tag role="typerefnum">Table 7</tag>
      </tags>
      <toccaption><tag close=" ">7</tag> Ablation experiment on Full Horizon Gradient, Demonstration Replay (Random) ratio <Math mode="inline" tex="\lambda" text="lambda" xml:id="A11.T7.m1">
          <XMath>
            <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
          </XMath>
        </Math>, and Demonstration Replay (Threshold) threshold <Math mode="inline" tex="\gamma" text="gamma" xml:id="A11.T7.m2">
          <XMath>
            <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
          </XMath>
        </Math> with the new Pose Absurdity metric on <emph font="italic">Back-Flip</emph>. L2@0.01, 0.05 and 0.1 measure the average L2 pose error on the worst 1%, 5% and 10% frames respectively. Demonstration Replay (Threshold) significantly improves on the Pose Absurdity metric.</toccaption>
      <caption><tag close=": "><text fontsize="90%">Table 7</text></tag><text fontsize="90%"> Ablation experiment on Full Horizon Gradient, Demonstration Replay (Random) ratio <Math mode="inline" tex="\lambda" text="lambda" xml:id="A11.T7.m3">
            <XMath>
              <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
            </XMath>
          </Math>, and Demonstration Replay (Threshold) threshold <Math mode="inline" tex="\gamma" text="gamma" xml:id="A11.T7.m4">
            <XMath>
              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
            </XMath>
          </Math> with the new Pose Absurdity metric on <emph font="italic">Back-Flip</emph>. L2@0.01, 0.05 and 0.1 measure the average L2 pose error on the worst 1%, 5% and 10% frames respectively. Demonstration Replay (Threshold) significantly improves on the Pose Absurdity metric.</text></caption>
      <tabular class="ltx_centering" vattach="middle">
        <tr>
          <td align="left" border="r tt">Method</td>
          <td align="right" border="tt">L2@0.01</td>
          <td align="right" border="tt">L2@0.05</td>
          <td align="right" border="tt">L2@0.1</td>
        </tr>
        <tr>
          <td align="left" border="r t">full horizon</td>
          <td align="right" border="t">0.357</td>
          <td align="right" border="t">0.343</td>
          <td align="right" border="t">0.323</td>
        </tr>
        <tr>
          <td align="left" border="r t"><Math mode="inline" tex="\lambda" text="lambda" xml:id="A11.T7.m5">
              <XMath>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
              </XMath>
            </Math> = 0.01</td>
          <td align="right" border="t">0.379</td>
          <td align="right" border="t">0.341</td>
          <td align="right" border="t">0.318</td>
        </tr>
        <tr>
          <td align="left" border="r"><Math mode="inline" tex="\lambda" text="lambda" xml:id="A11.T7.m6">
              <XMath>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
              </XMath>
            </Math> = 0.05</td>
          <td align="right">0.195</td>
          <td align="right">0.177</td>
          <td align="right">0.135</td>
        </tr>
        <tr>
          <td align="left" border="r"><Math mode="inline" tex="\lambda" text="lambda" xml:id="A11.T7.m7">
              <XMath>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
              </XMath>
            </Math> = 0.10</td>
          <td align="right">0.359</td>
          <td align="right">0.332</td>
          <td align="right">0.262</td>
        </tr>
        <tr>
          <td align="left" border="r t"><Math mode="inline" tex="\gamma" text="gamma" xml:id="A11.T7.m8">
              <XMath>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              </XMath>
            </Math> = 0.1</td>
          <td align="right" border="t">0.111</td>
          <td align="right" border="t">0.107</td>
          <td align="right" border="t">0.095</td>
        </tr>
        <tr>
          <td align="left" border="r"><Math mode="inline" tex="\gamma" text="gamma" xml:id="A11.T7.m9">
              <XMath>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              </XMath>
            </Math> = 0.2</td>
          <td align="right">0.113</td>
          <td align="right">0.107</td>
          <td align="right"><text font="bold">0.093</text></td>
        </tr>
        <tr>
          <td align="left" border="bb r"><Math mode="inline" tex="\gamma" text="gamma" xml:id="A11.T7.m10">
              <XMath>
                <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              </XMath>
            </Math> = 0.4</td>
          <td align="right" border="bb"><text font="bold">0.110</text></td>
          <td align="right" border="bb"><text font="bold">0.103</text></td>
          <td align="right" border="bb">0.095</td>
        </tr>
      </tabular>
    </table>
  </appendix>
  <appendix inlist="toc" xml:id="A12">
    <tags>
      <tag>Appendix L</tag>
      <tag role="autoref">Appendix L</tag>
      <tag role="refnum">L</tag>
      <tag role="typerefnum">Appendix L</tag>
    </tags>
    <title><tag close=" ">Appendix L</tag>Swording Character</title>
    <toctitle><tag close=" ">L</tag>Swording Character</toctitle>
    <figure inlist="lof" labels="LABEL:fig:sword" placement="h" xml:id="A12.F14">
      <tags>
        <tag><text fontsize="90%">Figure 14</text></tag>
        <tag role="autoref">Figure 14</tag>
        <tag role="refnum">14</tag>
        <tag role="typerefnum">Figure 14</tag>
      </tags>
      <graphics candidates="figures/qp/sword_shield.png" class="ltx_centering" graphic="figures/qp/sword_shield.png" options="width=433.62pt,keepaspectratio=true" xml:id="A12.F14.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">14</tag>Character performing attack move with a sword and a shield. The reference motion clip is from Reallusion <cite class="ltx_citemacro_citep">(<bibref bibrefs="Reallusion" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite></toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 14</text></tag><text fontsize="90%">Character performing attack move with a sword and a shield. The reference motion clip is from Reallusion <cite class="ltx_citemacro_citep">(<bibref bibrefs="Reallusion" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite></text></caption>
    </figure>
  </appendix>
</document>
