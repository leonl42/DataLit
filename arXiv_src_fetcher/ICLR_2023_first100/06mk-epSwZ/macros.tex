\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{makecell}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{amssymb}

\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{algorithmicx}

\numberwithin{equation}{section}

\newcommand\Mark[1]{\textsuperscript#1}


\definecolor{myred}{HTML}{A23216}
\definecolor{mygreen}{HTML}{1E7167}

\newcommand{\plusstyle}[1]{{\small\color{myred}{#1}}}

\newcommand{\minusstyle}[1]{{\small\color{mygreen}{#1}}}


\def\equationautorefname~#1\null{Eq.~#1\null}
\def\figureautorefname~#1\null{Fig.~#1\null}
\def\tableautorefname~#1\null{Tab.~#1\null}
\def\sectionautorefname~#1\null{Sect.~#1\null}
\def\subsectionautorefname~#1\null{Sect.~#1\null}
\def\subsubsectionautorefname~#1\null{Sect.~#1\null}

\newcommand{\eg}{\emph{e.g.}}
\newcommand{\Eg}{\emph{E.g.}}
\newcommand{\ie}{\emph{i.e.}}

\newcommand{\Tau}{\mathrm{T}}

\newcommand{\ourmethod}{Demonstration Replay}

\newcommand{\threesubsection}[1]{\textbf{#1}.~}

\def\shownotes{1} 
 \ifnum\shownotes=1
\newcommand{\authnote}[2]{{[#1: #2]}}
\else 
\newcommand{\authnote}[2]{{}}
\fi
\newcommand{\zwnote}[1]{{\color{orange}\authnote{ZW}{#1}}}
\newcommand{\jwnote}[1]{{\color{red}\authnote{JW}{#1}}}

\newcommand{\upd}[1]{\textcolor{blue}{#1}}

\newcommand{\ev}{\mathbb{E}}
\newcommand{\rspace}{\mathbb{R}}
\newcommand{\gau}{\mathcal{N}}
\newcommand{\dy}{dy}
\newcommand{\dyprime}{dy^\prime}
\newcommand{\eq}{Eqn.}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\trans}{\textrm{T}}

\newcommand{\softmaxinline}{\textrm{exp}(\eta)/\sum_{j=1}^k\textrm{exp}(\eta_j)}


\newcommand{\py}{p(y)}
\newcommand{\px}{p(x)}
\newcommand{\pxy}{p(x|y)}
\newcommand{\pyx}{p(y|x)}
\newcommand{\pyix}{p(y=i|x)}
\newcommand{\pyjx}{p(y=j|x)}
\newcommand{\pyxparam}{p(y|x;f, g)}
\newcommand{\pyxparambal}{p_{\textrm{bal}}(y|x;f, g)}
\newcommand{\pytrain}{p_{\textrm{train}}(y)}
\newcommand{\pyitrain}{p_{\textrm{train}}(y=i)}
\newcommand{\pyjtrain}{p_{\textrm{train}}(y=j)}
\newcommand{\pxtrain}{p_{\textrm{train}}(x)}
\newcommand{\pyxtrain}{p_{\textrm{train}}(y|x)}
\newcommand{\pyixtrain}{p_{\textrm{train}}(y=i|x)}
\newcommand{\pyjxtrain}{p_{\textrm{train}}(y=j|x)}
\newcommand{\pybal}{p_{\textrm{bal}}(y)}
\newcommand{\pyibal}{p_{\textrm{bal}}(y=i)}
\newcommand{\pyjbal}{p_{\textrm{bal}}(y=j)}
\newcommand{\pxbal}{p_{\textrm{bal}}(x)}
\newcommand{\pyxbal}{p_{\textrm{bal}}(y|x)}
\newcommand{\pyixbal}{p_{\textrm{bal}}(y=i|x)}
\newcommand{\pyjxbal}{p_{\textrm{bal}}(y=j|x)}

\newcommand{\yprime}{y^\prime}
\newcommand{\pyprimetrain}{p_{\textrm{train}}(\yprime)}
\newcommand{\pyprimextrain}{p_{\textrm{train}}(\yprime|x)}
\newcommand{\pyprimebal}{p_{\textrm{bal}}(\yprime)}
\newcommand{\pyprimexbal}{p_{\textrm{bal}}(\yprime|x)}

\newcommand{\yhat}{\hat{y}}


\newcommand{\ytarget}{y_\textrm{target}}
\newcommand{\pytargettrain}{p_{\textrm{train}}(y=\ytarget)}
\newcommand{\pytargetxtrain}{p_{\textrm{train}}(y=\ytarget|x)}


\newcommand{\ypred}{y_\textrm{pred}}
\newcommand{\sigmapred}{\sigma_\textrm{pred}}
\newcommand{\sigmatildepred}{\tilde{\sigma}_\textrm{pred}}
\newcommand{\Sigmapred}{\sigmapred^2 \textrm{I}}
\newcommand{\Sigmatildepred}{\tilde{\Sigma}_\textrm{pred}}
\newcommand{\Sigmanoise}{\Sigma_\textrm{noise}}

\newcommand{\pysampletrain}{p_{\textrm{train}}(y=y_{(i)})}
\newcommand{\pysamplextrain}{p_{\textrm{train}}(y=y_{(i)}|x)}
\newcommand{\pysamplebal}{p_{\textrm{bal}}(y=y_{(i)})}
\newcommand{\pysamplexbal}{p_{\textrm{bal}}(y=y_{(i)}|x)}

\newcommand{\pyprimesampletrain}{p_{\textrm{train}}(y=\yprime_{(i)})}
\newcommand{\pyprimesamplextrain}{p_{\textrm{train}}(y=\yprime_{(i)}|x)}
\newcommand{\pyprimesamplebal}{p_{\textrm{bal}}(y=\yprime_{(i)})}
\newcommand{\pyprimesamplexbal}{p_{\textrm{bal}}(y=\yprime_{(i)}|x)}

\newcommand{\dtrain}{D_{\textrm{train}}}
\newcommand{\btrain}{B_{\textrm{train}}}
