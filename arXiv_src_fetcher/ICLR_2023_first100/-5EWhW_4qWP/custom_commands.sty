\usepackage{mathtools}
\usepackage{textcomp}

\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}[theorem]
\newtheorem{lemma}{Lemma}
\newtheorem{assumption}{Assumption}
\newtheorem{definition}{Definition}
\DeclareMathAlphabet{\mathpzc}{OT1}{pzc}{m}{it}
% \newcommand{\Tr}{\text{Tr}}
% Define task generator
\newcommand{\G}{\mathcal{G}}
% Define x,X,y,Y font style for NTK. s means small.
\newcommand{\sx}{x}
% \newcommand{\sX}{X}
\newcommand{\sy}{y}
% \newcommand{\sY}{Y}
\newcommand{\diag}[1]{\mathrm{diag}\left(#1\right)}
\newcommand{\poly}{\mathrm{poly}}
\newcommand{\eval}{\sigma}
\newcommand{\evec}{v}
\newcommand{\wx}{\widetilde{X}}
\newcommand{\wy}{\widetilde{Y}}
\newcommand{\wX}{\widetilde{\X}}
\newcommand{\wY}{\widetilde{\Y}}
\newcommand{\wF}{\widetilde{F}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\B}{B}
\newcommand{\cF}{\mathcal{F}}
\newcommand{\wt}{\widetilde}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\task}{\mathcal{T}}
\newcommand{\loss}{\mathcal{L}}
\newcommand{\Lf}{\mathscr{L}}
\newcommand{\mean}{\frac{1}{N} \sum_{i=1}^N}
\newcommand{\Sum}{\sum_{i=1}^N}
\newcommand{\lev}{\sigma_{\text{min}}}
\newcommand{\Lev}{\sigma_{\text{max}}}
\newcommand{\inp}{\mathbf{x}}
\newcommand{\learner}{f}
\newcommand{\K}{\mathbf{K}}
\newcommand{\lossi}{\loss_{\task_i}}
\newcommand{\cD}{\mathcal{D}}
% \newcommand{\D}{\mathcal{D}}
% \newcommand{\E}{\mathbb{E}}
\newcommand{\T}{T}
% \newcommand{\X}{\mathcal{X}}
% \newcommand{\Y}{\mathcal{Y}}
\newcommand{\cK}{\mathcal{K}}
\newcommand{\Expect}{\mathbb{E}}
% \newcommand{\Id}{\mathbb{I}}
% \newcommand{\metaNTK}{\mathcal{\Theta}}
% \newcommand{\sbs}{\sigma_b^2}
% \newcommand{\sws}{\sigma_w^2}
\newcommand{\D}{D}
\newcommand{\dis}{\mathcal{D}}
% \newcommand{\valid}{\mathcal{D_{\mathrm{valid}}}}
% \newcommand{\test}{\mathcal{D_{\mathrm{test}}}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}
% \newcommand{\T}{\mathcal{T}}
% \newcommand{\K}{\mathcal{K}}
\newcommand{\bbE}{\mathbb{E}}
\newcommand{\bR}{\mathbb{R}}
\newcommand{\flin}{f^{\textrm{lin}}}
\newcommand{\glin}{g^{\textrm{lin}}}
\newcommand{\dflin}{{{\dot f}_t^{\textrm {lin}}}}
\newcommand{\dglin}{{{\dot g}_t^{\textrm {lin}}}}
\newcommand{\Llin}{L^{\textrm{lin}}}
\newcommand{\Flin}{F^{\textrm{lin}}}
\newcommand{\fntk}{f^{\text{base}}}
\newcommand{\ly}{{\ell_{\hat y}}} 


\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}
\newcommand{\nin}{n_{in}}
\newcommand{\nout}{n_{out}}
\newcommand{\dotphi}{\dot\phi}
\newcommand{\Id}{\bf Id} 
\newcommand{\sw}{\sigma_\omega}
\newcommand{\sws}{\sigma_\omega^2}
\newcommand{\sbb}{\sigma_b}
\newcommand{\sbs}{\sigma_b^2}
% \newcommand{\E}{\mathbb{E}}
\newcommand{\norm}[1]{\lVert #1 \rVert}
% \newcommand{\norm}[1]{\left|\left| #1 \right|\right|}
\newcommand{\dd}{{\mathrm{d}}}
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\pdn}[3]{\frac{\partial^#1 #2}{\partial #3^#1}}
\newcommand{\od}[2]{\frac{\dd #1}{\dd #2}}
\newcommand{\odn}[3]{\frac{\dd^#1 #2}{\dd #3^#1}}
\newcommand{\avg}[1]{\left< #1 \right>}
\newcommand{\pp}[1]{\left( #1 \right)}
\newcommand{\mb}{\mathbf}
\newcommand{\mx}{\mathbf x}
\newcommand{\mc}{\mathcal}
%\newcommand{\argmin}{\operatornamewithlimits{argmin}}
%\newcommand{\argmax}{\operatornamewithlimits{argmax}}
\newcommand{\median}{\operatornamewithlimits{median}}
\newcommand{\expect}[2]{\mathbbm{E}_{#1}\left[ #2 \right]}
% \newcommand{\metantk}{\hat\Phi}
\newcommand{\ntk}{\hat{\Theta}}
\newcommand{\conjntk}{H}
\newcommand{\NTK}{\Theta}
\newcommand{\NNGP}{\mathcal{K}}
% \newcommand{\metaNTK}{\Phi}
\newcommand{\metantk}{\hat{\Phi}}
\newcommand{\metaNTK}{\Phi}
\newcommand{\SingleTaskmetantk}{\hat{\phi}}
\newcommand{\SingleTaskmetaNTK}{\phi}
\newcommand{\infnngp}{\mathcal K}
\newcommand{\finnngp}{\hat {\mathcal K}}
% \newcommand{\xxy}{x,x',y'}
\newcommand{\Kl}{\mathcal K^{(l)}}
\newcommand{\Kll}{\mathcal K^{(l+1)}}
\newcommand{\Thetal}{ \Theta^{(l)}}
\newcommand{\Thetall}{\Theta^{(l+1)}} 
\newcommand{\el}{\epsilon^{(l)}} 
\newcommand{\elll}{\epsilon^{(l+1)}} 
\newcommand{\dll}{\delta^{(l+1)}} 
\newcommand{\dl}{\delta^{(l)}} 
\newcommand{\pab}{p^*_{ab}}
\newcommand{\qab}{q^*_{ab}}
\newcommand{\op}{\rm{op}}
\newcommand{\mins}{\sigma_{\rm{min}}}
\newcommand{\maxs}{\sigma_{\rm{max}}}
\newcommand{\q}{\quad}
\newcommand{\lss}{R_0}
\newcommand{\GP}{\mc {GP}}
\newcommand{\relu}{{$\operatorname{ReLU}$}}
\newcommand{\erf}{$\operatorname{erf}$ }
\newcommand{\critical}{\eta_{{\rm critical}} }

\newcommand{\activation}{\sigma}
\newcommand{\lin}{\text{lin}}
\newcommand{\dFlin}{\dot{F}^{\text{lin}}}
\newcommand{\XXY}{\mathcal{X},\mathcal{X'},\mathcal{Y'}}
\newcommand{\XX}{\mathcal{X},\mathcal{X}'}
\newcommand{\xxy}{\sX,\sX',\sY'}
\newcommand{\xxyTr}{\sX_i,\sX_i',\sY_i'}
\newcommand{\xx}{\sX,\sX'}
\newcommand{\xxi}{\sX_i,\sX_i'}
\newcommand{\xxj}{\sX_j,\sX_j'}
\newcommand{\xyxy}{\sX,\sY,\sX',\sY'}
\newcommand{\xyxyi}{\sX_i,\sY_i,\sX_i',\sY_i'}
\newcommand{\xxyi}{\sX_i,\sX_i',\sY_i'}
\newcommand{\xxyj}{\sX_j,\sX_j',\sY_j'}
\newcommand{\XYXY}{\X,\Y,\X',\Y'}
\newenvironment{proofsketch}{%
  \renewcommand{\proofname}{Proof Sketch}\proof}{\endproof}
\ifx\proposition\undefined
\newtheorem{proposition}[theorem]{Proposition}
\fi
\ifx\remark\undefined
\newtheorem{remark}[theorem]{Remark}
\fi
\ifx\corollary\undefined
\newtheorem{corollary}[theorem]{Corollary}
\fi
% \ifx\definition\undefined
% \newtheorem{definition}[definition]{Definition}
\ifx\assumption\undefined
\newtheorem{assumption}[theorem]{Assumption}
\fi
\newenvironment{newalign}
 {\par$\!\aligned}
 {\endaligned$\par} 
 
% \DeclareMathOperator*{\argmax}{argmax}
% \DeclareMathOperator*{\argmin}{argmin}
