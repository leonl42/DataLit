<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/university/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-5fSvp1ofdd"?>
<!--  %%%% ijcai19-multiauthor.tex --><!--  %These are the instructions for authors for IJCAI-19. --><?latexml class="article"?>
<?latexml package="ijcai19"?>
<?latexml package="times"?>
<?latexml package="soul"?>
<?latexml package="url"?>
<?latexml package="hyperref" options="hidelinks"?>
<?latexml package="inputenc" options="utf8"?>
<?latexml package="caption" options="small"?>
<?latexml package="graphicx"?>
<?latexml package="amsmath"?>
<?latexml package="booktabs"?>
<?latexml package="amssymb"?>
<?latexml package="algorithmic,algorithm"?>
<?latexml package="subcaption"?>
<?latexml package="bm"?>
<!--  %the following package is optional: --><!--  %“usepackage–latexsym˝ --><!--  %Following comment is from ijcai97-submit.tex: --><!--  %The preparation of these files was supported by Schlumberger Palo Alto --><!--  %Research, AT“&amp;T Bell Laboratories, and Morgan Kaufmann Publishers. --><!--  %Shirley Jowell, of Morgan Kaufmann Publishers, and Peter F. --><!--  %Patel-Schneider, of AT“&amp;T Bell Laboratories collaborated on their --><!--  %preparation. --><!--  %These instructions can be modified and used in other conferences as long --><!--  %as credit to the authors and supporting agencies is retained, this notice --><!--  %is not changed, and further modification or reuse is not restricted. --><!--  %Neither Shirley Jowell nor Peter F. Patel-Schneider can be listed as --><!--  %contacts for providing assistance without their prior permission. --><!--  %To use for other conferences, change references to files and the --><!--  %conference appropriate and use other authors, contacts, publishers, and --><!--  %organizations. --><!--  %Also change the deadline and address for returning papers and the length and --><!--  %page charge instructions. --><!--  %Put where the files are available in the appropriate places. --><?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_authors_1line">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title>Experience Replay Optimization</title>
  <creator role="author">
    <personname>
Daochen Zha</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Kwei-Herng Lai</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Kaixiong Zhou &amp;Xia Hu
Department of Computer Science and Engineering, Texas A&amp;M University
{daochen.zha, khlai037, zkxiong, xiahu}@tamu.edu</personname>
  </creator>
  <abstract name="Abstract">
    <p>Experience replay enables reinforcement learning agents to memorize and reuse past experiences, just as humans replay memories for the situation at hand. Contemporary off-policy algorithms either replay past experiences uniformly or utilize a rule-based replay strategy, which may be sub-optimal. In this work, we consider <emph font="italic">learning</emph> a replay policy to optimize the cumulative reward. Replay learning is challenging because the replay memory is noisy and large, and the cumulative reward is unstable. To address these issues, we propose a novel experience replay optimization (ERO) framework which alternately updates two policies: the agent policy, and the replay policy. The agent is updated to maximize the cumulative reward based on the replayed data, while the replay policy is updated to provide the agent with the most useful experiences. The conducted experiments on various continuous control tasks demonstrate the effectiveness of ERO, empirically showing promise in experience replay learning to improve the performance of off-policy reinforcement learning algorithms.</p>
  </abstract>
<!--  %**** main.tex Line 75 **** -->  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <para xml:id="S1.p1">
      <p>Experience replay mechanism <cite class="ltx_citemacro_cite"><bibref bibrefs="lin1992self,lin1993reinforcement" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> plays a significant role in deep reinforcement learning, enabling the agent to memorize and reuse past experiences. It is demonstrated that experience replay greatly stabilizes the training process and improves the sample efficiency by breaking the temporal correlations <cite class="ltx_citemacro_cite"><bibref bibrefs="mnih2013playing,mnih2015human,wang2016sample,van2016deep,andrychowicz2017hindsight,pan2018organizing,sutton2018reinforcement" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. Current off-policy algorithms usually adopt a uniform sampling strategy which replays past experiences with equal frequency. However, the uniform sampling cannot reflect the different importance of past experiences: the agent can usually learn more efficiently from some experiences than from others, just as humans tend to replay crucial experiences and generalize them to the situation at hand <cite class="ltx_citemacro_cite"><bibref bibrefs="shohamy2015integrating" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Recently, some rule-based replay strategies have been studied to prioritize important experiences. One approach is to directly prioritize the transitions<note mark="1" role="footnote" xml:id="footnote1"><tags>
            <tag>1</tag>
            <tag role="autoref">footnote 1</tag>
            <tag role="refnum">1</tag>
            <tag role="typerefnum">footnote 1</tag>
          </tags>Transition and experience are considered exchangeable in this work when the context has no ambiguity.</note> with higher temporal difference (TD) errors <cite class="ltx_citemacro_cite"><bibref bibrefs="schaul2016prioritized" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. This simple replay rule is shown to improve the performance of deep Q-network on Atari environments and is demonstrated to be a useful ingredient in Rainbow <cite class="ltx_citemacro_cite"><bibref bibrefs="hessel2018rainbow" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. Other studies indirectly prioritize experiences through managing the replay memory. Adopting different sizes of the replay memory <cite class="ltx_citemacro_cite"><bibref bibrefs="zhang2017deeper,liu2017effects" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> and selectively remembering/forgetting some experiences with simple rules <cite class="ltx_citemacro_cite"><bibref bibrefs="novati2018remember" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> are shown to affect the performance greatly. However, the rule-based replay strategies may be sub-optimal and may not be able to adapt to different tasks or reinforcement learning algorithms. We are thus interested in studying how we can optimize the replay strategy towards more efficient use of the replay memory.</p>
    </para>
    <para xml:id="S1.p3">
      <p>In the neuroscience domain, the recently proposed normative theory for memory access suggests that a rational agent ought to replay the memories that lead to the most rewarding future decisions <cite class="ltx_citemacro_cite"><bibref bibrefs="mattar2018prioritized" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. For instance, when a human being learns to run, she tends to utilize the memories that can mostly accelerate the learning process; in this context, the memories could relate to walking. We are thus motivated to use the feedback from the environment as a rewarding signal to adjust the replay strategy. Specifically, apart from the agent policy, we consider learning an additional replay policy, aiming at sampling the most useful experiences for the agent to maximize the cumulative reward. A learning-based replay policy is promising because it can potentially find more useful experiences to train the agent and may better adapt to different tasks and algorithms.</p>
    </para>
    <para xml:id="S1.p4">
      <p>However, it is nontrivial to model the replay policy for several challenges. First, transitions in the memory are quite noisy due to the randomness of the environment. Second, the replay memory is typically large. For example, the common memory size for the benchmark off-policy algorithm deep deterministic policy gradient (DDPG) <cite class="ltx_citemacro_cite"><bibref bibrefs="lillicrap2016continuous" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> can reach <Math mode="inline" tex="10^{6}" text="10 ^ 6" xml:id="S1.p4.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
              <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
            </XMApp>
          </XMath>
        </Math>. The replay policy needs to properly filter out the most useful ones among all the transitions in the memory. Third, the cumulative reward is unstable, also due to the environmental randomness. Therefore, it is challenging to effectively and efficiently learn the replay policy.</p>
    </para>
    <para xml:id="S1.p5">
      <p>To address the above issues, in this paper, we propose experience replay optimization (ERO) framework, which alternately updates two policies: the agent policy, and the replay policy. Specifically, we investigate how to efficiently replay the most useful experiences from the replay buffer, and how we can make use of the environmental feedback to update the replay policy. The main contributions of this work are summarized as follows:</p>
    </para>
    <para xml:id="S1.p6">
      <itemize xml:id="S1.I1">
        <item xml:id="S1.I1.i1">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">1st item</tag>
          </tags>
          <para xml:id="S1.I1.i1.p1">
            <p>Formulate experience replay as a learning problem.</p>
          </para>
        </item>
        <item xml:id="S1.I1.i2">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">2nd item</tag>
          </tags>
          <para xml:id="S1.I1.i2.p1">
            <p>Propose ERO, a general framework for effective and efficient use of replay memory. A priority vector is maintained to sample subsets of transitions for efficient replaying. The replay policy is updated based on the improvement of cumulative reward.</p>
          </para>
        </item>
        <item xml:id="S1.I1.i3">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">3rd item</tag>
          </tags>
          <para xml:id="S1.I1.i3.p1">
            <p>Develop an instance of ERO by applying it to the benchmark off-policy algorithm DDPG.</p>
          </para>
        </item>
        <item xml:id="S1.I1.i4">
          <tags>
            <tag>•</tag>
            <tag role="autoref">item </tag>
            <tag role="typerefnum">4th item</tag>
          </tags>
          <para xml:id="S1.I1.i4.p1">
            <p>Conduct experiments on <Math mode="inline" tex="8" text="8" xml:id="S1.I1.i4.p1.m1">
                <XMath>
                  <XMTok meaning="8" role="NUMBER">8</XMTok>
                </XMath>
              </Math> continuous control tasks from OpenAI Gym to evaluate our framework. Empirical results show promise in experience replay learning to improve the performance of off-policy algorithms.</p>
          </para>
        </item>
      </itemize>
    </para>
  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Problem Statement</title>
    <para xml:id="S2.p1">
      <p>We consider standard reinforcement learning (RL) which is represented by a sextuple <Math mode="inline" tex="(\mathcal{S},\mathcal{A},\mathcal{P}_{T},\mathcal{R},\gamma,p_{0})" text="vector@(S, A, P _ T, R, gamma, p _ 0)" xml:id="S2.p1.m1">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="vector"/>
                <XMRef idref="S2.p1.m1.1"/>
                <XMRef idref="S2.p1.m1.2"/>
                <XMRef idref="S2.p1.m1.5"/>
                <XMRef idref="S2.p1.m1.3"/>
                <XMRef idref="S2.p1.m1.4"/>
                <XMRef idref="S2.p1.m1.6"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.p1.m1.1">S</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.p1.m1.2">A</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m1.5">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S2.p1.m1.3">R</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok font="italic" name="gamma" role="UNKNOWN" xml:id="S2.p1.m1.4">γ</XMTok>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m1.6">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">p</XMTok>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, where <Math mode="inline" tex="\mathcal{S}" text="S" xml:id="S2.p1.m2">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
          </XMath>
        </Math> is the set of states, <Math mode="inline" tex="\mathcal{A}" text="A" xml:id="S2.p1.m3">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">A</XMTok>
          </XMath>
        </Math> is the set of actions, <Math mode="inline" tex="\mathcal{P}_{T}:\mathcal{S}\times\mathcal{A}\to\mathcal{S}" text="P _ T colon S * A to S" xml:id="S2.p1.m4">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">T</XMTok>
              </XMApp>
              <XMApp>
                <XMTok name="to" role="ARROW">→</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">A</XMTok>
                </XMApp>
                <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> is the state transition function, <Math mode="inline" tex="\mathcal{R}:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\to\mathbb{R}" text="R colon S * A * S to R" xml:id="S2.p1.m5">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMTok font="caligraphic" role="UNKNOWN">R</XMTok>
              <XMApp>
                <XMTok name="to" role="ARROW">→</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">×</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">A</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
                </XMApp>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> is the reward function, <Math mode="inline" tex="\gamma\in(0,1)" text="gamma element-of open-interval@(0, 1)" xml:id="S2.p1.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S2.p1.m6.1"/>
                  <XMRef idref="S2.p1.m6.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S2.p1.m6.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S2.p1.m6.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is the discount factor, and <Math mode="inline" tex="p_{0}" text="p _ 0" xml:id="S2.p1.m7">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math> is the distribution of the initial state. At each timestep <Math mode="inline" tex="t" text="t" xml:id="S2.p1.m8">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">t</XMTok>
          </XMath>
        </Math>, an agent takes action <Math mode="inline" tex="a_{t}\in\mathcal{A}" text="a _ t element-of A" xml:id="S2.p1.m9">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMTok font="caligraphic" role="UNKNOWN">A</XMTok>
            </XMApp>
          </XMath>
        </Math> in state <Math mode="inline" tex="s_{t}\in\mathcal{S}" text="s _ t element-of S" xml:id="S2.p1.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">s</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
            </XMApp>
          </XMath>
        </Math> and observes the next state <Math mode="inline" tex="s_{t+1}" text="s _ (t + 1)" xml:id="S2.p1.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">s</XMTok>
              <XMApp>
                <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> with a scalar reward <Math mode="inline" tex="r_{t}" text="r _ t" xml:id="S2.p1.m12">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">r</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math>, which results in a quadruple <Math mode="inline" tex="(s_{t},a_{t},r_{t},s_{t+1})" text="vector@(s _ t, a _ t, r _ t, s _ (t + 1))" xml:id="S2.p1.m13">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="vector"/>
                <XMRef idref="S2.p1.m13.1"/>
                <XMRef idref="S2.p1.m13.2"/>
                <XMRef idref="S2.p1.m13.3"/>
                <XMRef idref="S2.p1.m13.4"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp xml:id="S2.p1.m13.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m13.2">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m13.3">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m13.4">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>, also called <emph font="italic">transition</emph>. This also leads to a <emph font="italic">trajectory</emph> of states, actions and rewards <Math mode="inline" tex="(s_{1},a_{1},r_{1},s_{2},a_{2},r_{2},...)" text="vector@(s _ 1, a _ 1, r _ 1, s _ 2, a _ 2, r _ 2, ldots)" xml:id="S2.p1.m14">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="vector"/>
                <XMRef idref="S2.p1.m14.2"/>
                <XMRef idref="S2.p1.m14.3"/>
                <XMRef idref="S2.p1.m14.4"/>
                <XMRef idref="S2.p1.m14.5"/>
                <XMRef idref="S2.p1.m14.6"/>
                <XMRef idref="S2.p1.m14.7"/>
                <XMRef idref="S2.p1.m14.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp xml:id="S2.p1.m14.2">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m14.3">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m14.4">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m14.5">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m14.6">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m14.7">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMTok name="ldots" role="ID" xml:id="S2.p1.m14.1">…</XMTok>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>. The objective is to learn a policy <Math mode="inline" tex="\pi:\mathcal{S}\to\mathcal{A}" text="pi colon S to A" xml:id="S2.p1.m15">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              <XMApp>
                <XMTok name="to" role="ARROW">→</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">S</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">A</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> that maximizes the cumulative reward <Math mode="inline" tex="R=\mathbb{E}[\sum_{t=1}^{\infty}\gamma^{t}r_{t}]" text="R = E * delimited-[]@(((sum _ (t = 1)) ^ infinity)@(gamma ^ t * r _ t))" xml:id="S2.p1.m16">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">R</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="S2.p1.m16.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="S2.p1.m16.1">
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok mathstyle="text" meaning="sum" role="SUMOP" scriptpos="post">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="infinity" name="infty" role="ID">∞</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>. An off-policy agent makes use of an experience replay buffer, denoted as <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S2.p1.m17">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>. At each timestep <Math mode="inline" tex="t" text="t" xml:id="S2.p1.m18">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">t</XMTok>
          </XMath>
        </Math>, the agent interacts with the environment and stores transition <Math mode="inline" tex="(s_{t},a_{t},r_{t},s_{t+1})" text="vector@(s _ t, a _ t, r _ t, s _ (t + 1))" xml:id="S2.p1.m19">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="vector"/>
                <XMRef idref="S2.p1.m19.1"/>
                <XMRef idref="S2.p1.m19.2"/>
                <XMRef idref="S2.p1.m19.3"/>
                <XMRef idref="S2.p1.m19.4"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">(</XMTok>
                <XMApp xml:id="S2.p1.m19.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m19.2">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m19.3">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
                <XMApp xml:id="S2.p1.m19.4">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">)</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> into <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S2.p1.m20">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>. Let <Math mode="inline" tex="\mathcal{B}_{i}" text="B _ i" xml:id="S2.p1.m21">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math> denote the transition in <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S2.p1.m22">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math> at position <Math mode="inline" tex="i" text="i" xml:id="S2.p1.m23">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">i</XMTok>
          </XMath>
        </Math>. Then for each training step, the agent is updated by using a batch of transitions <Math mode="inline" tex="\{\mathcal{B}_{i}\}" text="set@(B _ i)" xml:id="S2.p1.m24">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="set"/>
                <XMRef idref="S2.p1.m24.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">{</XMTok>
                <XMApp xml:id="S2.p1.m24.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">}</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> sampled from the buffer.</p>
    </para>
    <para xml:id="S2.p2">
      <p>Based on the notations defined above, we formulate the problem of learning a replay policy as follows. Given a task <Math mode="inline" tex="\mathcal{T}" text="T" xml:id="S2.p2.m1">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
          </XMath>
        </Math>, an off-policy agent <Math mode="inline" tex="\Lambda" text="Lambda" xml:id="S2.p2.m2">
          <XMath>
            <XMTok name="Lambda" role="UNKNOWN">Λ</XMTok>
          </XMath>
        </Math> and the experience replay buffer <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S2.p2.m3">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math>, we aim at learning a replay policy <Math mode="inline" tex="\phi" text="phi" xml:id="S2.p2.m4">
          <XMath>
            <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
          </XMath>
        </Math> which at each training step samples a batch of transitions <Math mode="inline" tex="\{\mathcal{B}_{i}\}" text="set@(B _ i)" xml:id="S2.p2.m5">
          <XMath>
            <XMDual>
              <XMApp>
                <XMTok meaning="set"/>
                <XMRef idref="S2.p2.m5.1"/>
              </XMApp>
              <XMWrap>
                <XMTok role="OPEN" stretchy="false">{</XMTok>
                <XMApp xml:id="S2.p2.m5.1">
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok role="CLOSE" stretchy="false">}</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math> from <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S2.p2.m6">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
          </XMath>
        </Math> to train agent <Math mode="inline" tex="\Lambda" text="Lambda" xml:id="S2.p2.m7">
          <XMath>
            <XMTok name="Lambda" role="UNKNOWN">Λ</XMTok>
          </XMath>
        </Math>, i.e., learning the mapping <Math mode="inline" tex="\phi:\mathcal{B}\to\{\mathcal{B}_{i}\}" text="phi colon B to set@(B _ i)" xml:id="S2.p2.m8">
          <XMath>
            <XMApp>
              <XMTok name="colon" role="METARELOP">:</XMTok>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
              <XMApp>
                <XMTok name="to" role="ARROW">→</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S2.p2.m8.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S2.p2.m8.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, such that better performance can be achieved by <Math mode="inline" tex="\Lambda" text="Lambda" xml:id="S2.p2.m9">
          <XMath>
            <XMTok name="Lambda" role="UNKNOWN">Λ</XMTok>
          </XMath>
        </Math> on task <Math mode="inline" tex="\mathcal{T}" text="T" xml:id="S2.p2.m10">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">T</XMTok>
          </XMath>
        </Math> in terms of cumulative reward and efficiency.</p>
    </para>
    <figure inlist="lof" labels="LABEL:label:fig1" placement="t" xml:id="S2.F1">
      <tags>
        <tag><text fontsize="90%">Figure 1</text></tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <graphics candidates="fig1.pdf" class="ltx_centering" graphic="fig1.pdf" options="width=241.84842pt,keepaspectratio=true" xml:id="S2.F1.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>An overview of experience replay optimization (ERO). The reinforcement learning agent interacts with the environment and stores the transition into the buffer. In training, the replay policy generates a vector to sample a subset of transitions <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="S2.F1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
            </XMApp>
          </XMath>
        </Math> from the buffer, where <Math mode="inline" tex="1" text="1" xml:id="S2.F1.m2">
          <XMath>
            <XMTok meaning="1" role="NUMBER">1</XMTok>
          </XMath>
        </Math> indicates that the corresponding transition is selected. The sampled transitions are then used to update the agent.</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 1</text></tag><text fontsize="90%">An overview of experience replay optimization (ERO). The reinforcement learning agent interacts with the environment and stores the transition into the buffer. In training, the replay policy generates a vector to sample a subset of transitions <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="S2.F1.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
              </XMApp>
            </XMath>
          </Math> from the buffer, where <Math mode="inline" tex="1" text="1" xml:id="S2.F1.m4">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> indicates that the corresponding transition is selected. The sampled transitions are then used to update the agent.</text></caption>
    </figure>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Methodology</title>
    <para xml:id="S3.p1">
      <p>Figure <ref labelref="LABEL:label:fig1"/> shows an overview of the ERO framework. The core idea of the proposed framework is to use a replay policy to sample a subset of transitions from the buffer, for updating the reinforcement learning agent. Here, the replay policy generates a 0-1 boolean vector to guide subset sampling, where <Math mode="inline" tex="1" text="1" xml:id="S3.p1.m1">
          <XMath>
            <XMTok meaning="1" role="NUMBER">1</XMTok>
          </XMath>
        </Math> indicates that the corresponding transition is selected (detailed in Section <ref labelref="LABEL:label:sec3-1"/>). The replay policy indirectly teaches the agent by controlling what historical transitions are used, and is adjusted according to the feedback which is defined as the improvement of the performance (detailed in Section <ref labelref="LABEL:label:sec3-2"/>). Our framework is general and can be applied to contemporary off-policy algorithms. Next, we elaborate the details of the proposed ERO framework.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:label:sec3-1" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>Sampling with Replay Policy</title>
      <para xml:id="S3.SS1.p1">
        <p>In this subsection, we formulate a learning-based replay policy to sample transitions from the buffer.</p>
      </para>
      <para xml:id="S3.SS1.p2">
        <p><!--  %**** main.tex Line 125 **** -->Let <Math mode="inline" tex="\mathcal{B}_{i}" text="B _ i" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> be a transition in buffer <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math> with a associated feature vector <Math mode="inline" tex="\textbf{f}_{\mathcal{B}_{i}}" text="[f] _ B _ i" xml:id="S3.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMText><text font="bold">f</text></XMText>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">B</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> (we empirically select some features, detailed in Section <ref labelref="LABEL:label:sec_exp"/>), where <Math mode="inline" tex="i" text="i" xml:id="S3.SS1.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math> denotes the index. In ERO, the replay policy is described as a priority score function <Math mode="inline" tex="\phi(\textbf{f}_{\mathcal{B}_{i}}|\theta^{\phi})\in(0,1)" text="phi * conditional@([f] _ B _ i, theta ^ phi) element-of open-interval@(0, 1)" xml:id="S3.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                  <XMDual>
                    <XMRef idref="S3.SS1.p2.m5.3"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.SS1.p2.m5.3">
                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMText><text font="bold">f</text></XMText>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">B</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS1.p2.m5.1"/>
                    <XMRef idref="S3.SS1.p2.m5.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.p2.m5.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS1.p2.m5.2">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, in which higher value indicates higher probability of a transition being replayed, <Math mode="inline" tex="\phi" text="phi" xml:id="S3.SS1.p2.m6">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math> denotes a function approximator which is a deep neural network, and <Math mode="inline" tex="\theta^{\phi}" text="theta ^ phi" xml:id="S3.SS1.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
              </XMApp>
            </XMath>
          </Math> are the corresponding parameters. For each <Math mode="inline" tex="\mathcal{B}_{i}" text="B _ i" xml:id="S3.SS1.p2.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math>, a score is calculated by the replay policy <Math mode="inline" tex="\phi" text="phi" xml:id="S3.SS1.p2.m9">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math>. We further maintain a vector <Math mode="inline" tex="\bm{\lambda}" text="lambda" xml:id="S3.SS1.p2.m10">
            <XMath>
              <XMTok font="bold italic" name="lambda" role="UNKNOWN">λ</XMTok>
            </XMath>
          </Math> to store these scores:</p>
        <equation xml:id="S3.E1">
          <tags>
            <tag>(1)</tag>
            <tag role="autoref">Equation 1</tag>
            <tag role="refnum">1</tag>
          </tags>
          <Math mode="display" tex="\bm{\lambda}=\{\phi(\textbf{f}_{\mathcal{B}_{i}}|\theta^{\phi})|\mathcal{B}_{i%&#10;}\in\mathcal{B}\}\in\mathbb{R}^{N}," text="lambda = set@(conditional@(phi * conditional@([f] _ B _ i, theta ^ phi), B _ i) element-of B) element-of R ^ N" xml:id="S3.E1.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E1.m1.1"/>
                <XMWrap>
                  <XMApp xml:id="S3.E1.m1.1">
                    <XMTok meaning="multirelation"/>
                    <XMTok font="bold italic" name="lambda" role="UNKNOWN">λ</XMTok>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="set"/>
                        <XMRef idref="S3.E1.m1.1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">{</XMTok>
                        <XMApp xml:id="S3.E1.m1.1.1">
                          <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                          <XMApp>
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E1.m1.1.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E1.m1.1.1.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMText><text font="bold">f</text></XMText>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                        <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">B</XMTok>
                                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">}</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="N" text="N" xml:id="S3.SS1.p2.m11">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> is the number of transitions in <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S3.SS1.p2.m12">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math>, element <Math mode="inline" tex="\bm{\lambda}_{i}" text="lambda _ i" xml:id="S3.SS1.p2.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="bold italic" name="lambda" role="UNKNOWN">λ</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> is the priority score of the corresponding transition <Math mode="inline" tex="\mathcal{B}_{i}" text="B _ i" xml:id="S3.SS1.p2.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math>. Note that it is infeasible to keep all the priority scores up-to-date because the buffer size is usually large. To avoid expensive sweeps over the entire buffer, we adopt an updating strategy similar to <cite class="ltx_citemacro_cite"><bibref bibrefs="schaul2016prioritized" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. Specifically, a score is updated only when the corresponding transition is replayed. With this approximation, some transitions with very low scores could remain almost never sampled. However, we have to consider the efficiency issue when developing replay policy. In our preliminary experiments, we find this approximation works well and significantly accelerates the sampling. Given the scores vector <Math mode="inline" tex="\bm{\lambda}" text="lambda" xml:id="S3.SS1.p2.m15">
            <XMath>
              <XMTok font="bold italic" name="lambda" role="UNKNOWN">λ</XMTok>
            </XMath>
          </Math>, we then sample <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="S3.SS1.p2.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
              </XMApp>
            </XMath>
          </Math> according to</p>
        <equationgroup class="ltx_eqn_align" xml:id="Sx1.EGx1">
          <equation labels="LABEL:label:eqn2" xml:id="S3.E2">
            <tags>
              <tag>(2)</tag>
              <tag role="autoref">Equation 2</tag>
              <tag role="refnum">2</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\begin{split}\textbf{I}&amp;\sim\mathrm{Bernoulli}(\bm{\lambda}),\\&#10;\mathcal{B}^{s}&amp;=\{\mathcal{B}_{i}|\mathcal{B}_{i}\in\mathcal{B}\wedge\textbf{%&#10;I}_{i}=1\},\end{split}" text="formulae@([I] similar-to Bernoulli * lambda, B ^ s = conditional-set@(B _ i, B _ i element-of B and [I] _ i = 1))" xml:id="S3.E2.m2">
                <XMath>
                  <XMDual>
                    <XMDual>
                      <XMRef idref="S3.E2.m2.1"/>
                      <XMWrap>
                        <XMDual xml:id="S3.E2.m2.1">
                          <XMApp>
                            <XMTok meaning="formulae"/>
                            <XMRef idref="S3.E2.m2.1.1"/>
                            <XMRef idref="S3.E2.m2.1.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMApp xml:id="S3.E2.m2.1.1">
                              <XMRef idref="S3.E2.m1.2.mf"/>
                              <XMRef idref="S3.E2.m1.1.mf"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMRef idref="S3.E2.m1.3.mf"/>
                                <XMRef idref="S3.E2.m1.5.mf"/>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT"/>
                            <XMApp xml:id="S3.E2.m2.1.2">
                              <XMRef idref="S3.E2.m1.10.mf"/>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S3.E2.m1.8.mf"/>
                                <XMRef idref="S3.E2.m1.9.mf.1"/>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="conditional-set"/>
                                  <XMRef idref="S3.E2.m2.1.2.1"/>
                                  <XMRef idref="S3.E2.m2.1.2.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMRef idref="S3.E2.m1.11.mf"/>
                                  <XMApp xml:id="S3.E2.m2.1.2.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E2.m1.12.mf"/>
                                    <XMRef idref="S3.E2.m1.13.mf.1"/>
                                  </XMApp>
                                  <XMRef idref="S3.E2.m1.14.mf" role="MIDDLE">
|                                  </XMRef>
                                  <XMApp xml:id="S3.E2.m2.1.2.2">
                                    <XMTok meaning="multirelation"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S3.E2.m1.15.mf"/>
                                      <XMRef idref="S3.E2.m1.16.mf.1"/>
                                    </XMApp>
                                    <XMRef idref="S3.E2.m1.17.mf"/>
                                    <XMApp>
                                      <XMRef idref="S3.E2.m1.19.mf"/>
                                      <XMRef idref="S3.E2.m1.18.mf"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.20.mf"/>
                                        <XMRef idref="S3.E2.m1.21.mf.1"/>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E2.m1.22.mf"/>
                                    <XMRef idref="S3.E2.m1.23.mf"/>
                                  </XMApp>
                                  <XMRef idref="S3.E2.m1.24.mf"/>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMWrap>
                        </XMDual>
                        <XMTok role="PUNCT"/>
                      </XMWrap>
                    </XMDual>
                    <XMArray colsep="0pt" name="aligned">
                      <XMRow>
                        <XMCell align="right">
                          <XMText xml:id="S3.E2.m1.1.mf"><text font="bold">I</text></XMText>
                        </XMCell>
                        <XMCell align="left">
                          <XMWrap>
                            <XMApp xml:id="S3.E2.m2.2">
                              <XMTok meaning="similar-to" name="sim" role="RELOP" xml:id="S3.E2.m1.2.mf">∼</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok role="UNKNOWN" xml:id="S3.E2.m1.3.mf">Bernoulli</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.4.mf">(</XMTok>
                                  <XMTok font="bold italic" name="lambda" role="UNKNOWN" xml:id="S3.E2.m1.5.mf">λ</XMTok>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.6.mf">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" xml:id="S3.E2.m1.7.mf">,</XMTok>
                          </XMWrap>
                        </XMCell>
                      </XMRow>
                      <XMRow>
                        <XMCell align="right">
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                            <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.8.mf">B</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.9.mf.1">s</XMTok>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMWrap>
                            <XMApp xml:id="S3.E2.m2.3">
                              <XMTok meaning="equals" role="RELOP" xml:id="S3.E2.m1.10.mf">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.11.mf">{</XMTok>
                                <XMApp xml:id="S3.E2.m2.3.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.12.mf">B</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.13.mf.1">i</XMTok>
                                </XMApp>
                                <XMTok role="MIDDLE" stretchy="false" xml:id="S3.E2.m1.14.mf">|</XMTok>
                                <XMApp xml:id="S3.E2.m2.3.2">
                                  <XMTok meaning="multirelation"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.15.mf">B</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.16.mf.1">i</XMTok>
                                  </XMApp>
                                  <XMTok meaning="element-of" name="in" role="RELOP" xml:id="S3.E2.m1.17.mf">∈</XMTok>
                                  <XMApp>
                                    <XMTok meaning="and" name="wedge" role="ADDOP" xml:id="S3.E2.m1.19.mf">∧</XMTok>
                                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.18.mf">B</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMText xml:id="S3.E2.m1.20.mf"><text font="bold">I</text></XMText>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.21.mf.1">i</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok meaning="equals" role="RELOP" xml:id="S3.E2.m1.22.mf">=</XMTok>
                                  <XMTok meaning="1" role="NUMBER" xml:id="S3.E2.m1.23.mf">1</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.24.mf">}</XMTok>
                              </XMWrap>
                            </XMApp>
                            <XMTok role="PUNCT" xml:id="S3.E2.m1.25.mf">,</XMTok>
                          </XMWrap>
                        </XMCell>
                      </XMRow>
                    </XMArray>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="center" colspan="2"><Math mode="inline" tex="\displaystyle\begin{split}\textbf{I}&amp;\sim\mathrm{Bernoulli}(\bm{\lambda}),\\&#10;\mathcal{B}^{s}&amp;=\{\mathcal{B}_{i}|\mathcal{B}_{i}\in\mathcal{B}\wedge\textbf{%&#10;I}_{i}=1\},\end{split}" text="formulae@([I] similar-to Bernoulli * lambda, B ^ s = conditional-set@(B _ i, B _ i element-of B and [I] _ i = 1))" xml:id="S3.E2.m1">
                    <XMath>
                      <XMDual>
                        <XMDual>
                          <XMRef idref="S3.E2.m1.26"/>
                          <XMWrap>
                            <XMDual xml:id="S3.E2.m1.26">
                              <XMApp>
                                <XMTok meaning="formulae"/>
                                <XMRef idref="S3.E2.m1.26.1"/>
                                <XMRef idref="S3.E2.m1.26.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMApp xml:id="S3.E2.m1.26.1">
                                  <XMRef idref="S3.E2.m1.2"/>
                                  <XMRef idref="S3.E2.m1.1"/>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMRef idref="S3.E2.m1.3"/>
                                    <XMRef idref="S3.E2.m1.5"/>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT"/>
                                <XMApp xml:id="S3.E2.m1.26.2">
                                  <XMRef idref="S3.E2.m1.10"/>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E2.m1.8"/>
                                    <XMRef idref="S3.E2.m1.9.1"/>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="conditional-set"/>
                                      <XMRef idref="S3.E2.m1.26.2.1"/>
                                      <XMRef idref="S3.E2.m1.26.2.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMRef idref="S3.E2.m1.11"/>
                                      <XMApp xml:id="S3.E2.m1.26.2.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E2.m1.12"/>
                                        <XMRef idref="S3.E2.m1.13.1"/>
                                      </XMApp>
                                      <XMRef idref="S3.E2.m1.14" role="MIDDLE">
|                                      </XMRef>
                                      <XMApp xml:id="S3.E2.m1.26.2.2">
                                        <XMTok meaning="multirelation"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S3.E2.m1.15"/>
                                          <XMRef idref="S3.E2.m1.16.1"/>
                                        </XMApp>
                                        <XMRef idref="S3.E2.m1.17"/>
                                        <XMApp>
                                          <XMRef idref="S3.E2.m1.19"/>
                                          <XMRef idref="S3.E2.m1.18"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMRef idref="S3.E2.m1.20"/>
                                            <XMRef idref="S3.E2.m1.21.1"/>
                                          </XMApp>
                                        </XMApp>
                                        <XMRef idref="S3.E2.m1.22"/>
                                        <XMRef idref="S3.E2.m1.23"/>
                                      </XMApp>
                                      <XMRef idref="S3.E2.m1.24"/>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMWrap>
                            </XMDual>
                            <XMTok role="PUNCT"/>
                          </XMWrap>
                        </XMDual>
                        <XMArray colsep="0pt" name="aligned">
                          <XMRow>
                            <XMCell align="right">
                              <XMText xml:id="S3.E2.m1.1"><text font="bold">I</text></XMText>
                            </XMCell>
                            <XMCell align="left">
                              <XMWrap>
                                <XMApp xml:id="S3.E2.m1.27">
                                  <XMTok meaning="similar-to" name="sim" role="RELOP" xml:id="S3.E2.m1.2">∼</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok role="UNKNOWN" xml:id="S3.E2.m1.3">Bernoulli</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.4">(</XMTok>
                                      <XMTok font="bold italic" name="lambda" role="UNKNOWN" xml:id="S3.E2.m1.5">λ</XMTok>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.6">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT" xml:id="S3.E2.m1.7">,</XMTok>
                              </XMWrap>
                            </XMCell>
                          </XMRow>
                          <XMRow>
                            <XMCell align="right">
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.8">B</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.9.1">s</XMTok>
                              </XMApp>
                            </XMCell>
                            <XMCell align="left">
                              <XMWrap>
                                <XMApp xml:id="S3.E2.m1.28">
                                  <XMTok meaning="equals" role="RELOP" xml:id="S3.E2.m1.10">=</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false" xml:id="S3.E2.m1.11">{</XMTok>
                                    <XMApp xml:id="S3.E2.m1.28.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.12">B</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.13.1">i</XMTok>
                                    </XMApp>
                                    <XMTok role="MIDDLE" stretchy="false" xml:id="S3.E2.m1.14">|</XMTok>
                                    <XMApp xml:id="S3.E2.m1.28.2">
                                      <XMTok meaning="multirelation"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.15">B</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.16.1">i</XMTok>
                                      </XMApp>
                                      <XMTok meaning="element-of" name="in" role="RELOP" xml:id="S3.E2.m1.17">∈</XMTok>
                                      <XMApp>
                                        <XMTok meaning="and" name="wedge" role="ADDOP" xml:id="S3.E2.m1.19">∧</XMTok>
                                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E2.m1.18">B</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMText xml:id="S3.E2.m1.20"><text font="bold">I</text></XMText>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E2.m1.21.1">i</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok meaning="equals" role="RELOP" xml:id="S3.E2.m1.22">=</XMTok>
                                      <XMTok meaning="1" role="NUMBER" xml:id="S3.E2.m1.23">1</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false" xml:id="S3.E2.m1.24">}</XMTok>
                                  </XMWrap>
                                </XMApp>
                                <XMTok role="PUNCT" xml:id="S3.E2.m1.25">,</XMTok>
                              </XMWrap>
                            </XMCell>
                          </XMRow>
                        </XMArray>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\mathrm{Bernoulli}(\cdot)" text="Bernoulli * cdot" xml:id="S3.SS1.p2.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok role="UNKNOWN">Bernoulli</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS1.p2.m17.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok name="cdot" role="MULOP" xml:id="S3.SS1.p2.m17.1">⋅</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> denotes the Bernoulli distribution, <text class="ltx_markedasmath" font="bold">I</text> is an N-dimensional vector with element <Math mode="inline" tex="\textbf{I}_{i}\in\{0,1\}" text="[I] _ i element-of set@(0, 1)" xml:id="S3.SS1.p2.m19">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText><text font="bold">I</text></XMText>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS1.p2.m19.1"/>
                    <XMRef idref="S3.SS1.p2.m19.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMTok meaning="0" role="NUMBER" xml:id="S3.SS1.p2.m19.1">0</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok meaning="1" role="NUMBER" xml:id="S3.SS1.p2.m19.2">1</XMTok>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. That is, <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="S3.SS1.p2.m20">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
              </XMApp>
            </XMath>
          </Math> is the subset of <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S3.SS1.p2.m21">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math> such that the transition is selected when the corresponding value in <text font="bold">I</text> is <Math mode="inline" tex="1" text="1" xml:id="S3.SS1.p2.m22">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>.
In this sense, if transition <Math mode="inline" tex="\mathcal{B}_{i}" text="B _ i" xml:id="S3.SS1.p2.m23">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> has higher priority, it will be more likely to have <Math mode="inline" tex="\textbf{I}_{i}=1" text="[I] _ i = 1" xml:id="S3.SS1.p2.m24">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMText><text font="bold">I</text></XMText>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, hence being more likely to be in the subset <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="S3.SS1.p2.m25">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
              </XMApp>
            </XMath>
          </Math>. Then <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="S3.SS1.p2.m26">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
              </XMApp>
            </XMath>
          </Math> is used to update the agent with standard procedures, i.e., mini-batch updates with uniform sampling. The binary vector <text font="bold">I</text>, which serves as a “mask” to narrow down all the transitions to a smaller subset of transitions, indirectly affects the relaying.</p>
      </para>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:label:alg1" placement="t" xml:id="alg1">
        <tags>
          <tag><text font="bold">Algorithm 1</text></tag>
          <tag role="autoref">1</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Algorithm 1</tag>
        </tags>
        <toccaption><tag close=" ">1</tag>ERO enhanced DDPG</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 1</text></tag> ERO enhanced DDPG</caption>
        <listing>
          <listingline xml:id="alg1.l1"><tags>
              <tag><text fontsize="80%">1:</text></tag>
              <tag role="autoref">1</tag>
              <tag role="refnum">1</tag>
            </tags>  Initialize policy <Math mode="inline" tex="\pi" text="pi" xml:id="alg1.l1.m1">
              <XMath>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMath>
            </Math>, replay policy <Math mode="inline" tex="\phi" text="phi" xml:id="alg1.l1.m2">
              <XMath>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
              </XMath>
            </Math>, buffer <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="alg1.l1.m3">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l2"><tags>
              <tag><text fontsize="80%">2:</text></tag>
              <tag role="autoref">2</tag>
              <tag role="refnum">2</tag>
            </tags>  <text font="bold">for</text> each iteration <text font="bold">do</text>


</listingline>
          <listingline xml:id="alg1.l3"><tags>
              <tag><text fontsize="80%">3:</text></tag>
              <tag role="autoref">3</tag>
              <tag role="refnum">3</tag>
            </tags>     <text font="bold">for</text> each timestep <Math mode="inline" tex="t" text="t" xml:id="alg1.l3.m1">
              <XMath>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
              </XMath>
            </Math> <text font="bold">do</text>


</listingline>
          <listingline xml:id="alg1.l4"><tags>
              <tag><text fontsize="80%">4:</text></tag>
              <tag role="autoref">4</tag>
              <tag role="refnum">4</tag>
            </tags>        Select action <Math mode="inline" tex="a_{t}" text="a _ t" xml:id="alg1.l4.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMath>
            </Math> according to <Math mode="inline" tex="\pi" text="pi" xml:id="alg1.l4.m2">
              <XMath>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMath>
            </Math> and state <Math mode="inline" tex="s_{t}" text="s _ t" xml:id="alg1.l4.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l5"><tags>
              <tag><text fontsize="80%">5:</text></tag>
              <tag role="autoref">5</tag>
              <tag role="refnum">5</tag>
            </tags>        Execute action <Math mode="inline" tex="a_{t}" text="a _ t" xml:id="alg1.l5.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMath>
            </Math> and observe <Math mode="inline" tex="s_{t+1}" text="s _ (t + 1)" xml:id="alg1.l5.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">s</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> and <Math mode="inline" tex="r_{t}" text="r _ t" xml:id="alg1.l5.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l6"><tags>
              <tag><text fontsize="80%">6:</text></tag>
              <tag role="autoref">6</tag>
              <tag role="refnum">6</tag>
            </tags>        Store transition <Math mode="inline" tex="(s_{t},a_{t},r_{t},s_{t+1})" text="vector@(s _ t, a _ t, r _ t, s _ (t + 1))" xml:id="alg1.l6.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="vector"/>
                    <XMRef idref="alg1.l6.m1.1"/>
                    <XMRef idref="alg1.l6.m1.2"/>
                    <XMRef idref="alg1.l6.m1.3"/>
                    <XMRef idref="alg1.l6.m1.4"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="alg1.l6.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="alg1.l6.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="alg1.l6.m1.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="alg1.l6.m1.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> into <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="alg1.l6.m2">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l7"><tags>
              <tag><text fontsize="80%">7:</text></tag>
              <tag role="autoref">7</tag>
              <tag role="refnum">7</tag>
            </tags>        <text font="bold">if</text><!--  %**** main.tex Line 150 **** --> episode is done <text font="bold">then</text>


</listingline>
          <listingline xml:id="alg1.l8"><tags>
              <tag><text fontsize="80%">8:</text></tag>
              <tag role="autoref">8</tag>
              <tag role="refnum">8</tag>
            </tags>           Calculate the cumulative reward <Math mode="inline" tex="r^{c}_{\pi}" text="(r ^ c) _ pi" xml:id="alg1.l8.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                </XMApp>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l9"><tags>
              <tag><text fontsize="80%">9:</text></tag>
              <tag role="autoref">9</tag>
              <tag role="refnum">9</tag>
            </tags>           <text font="bold">if</text> <Math mode="inline" tex="r^{c}_{\pi^{\prime}}" text="(r ^ c) _ (pi ^ prime)" xml:id="alg1.l9.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math> <Math mode="inline" tex="\neq" text="not-equals" xml:id="alg1.l9.m2">
              <XMath>
                <XMTok meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
              </XMath>
            </Math> null <text font="bold">then</text>


</listingline>
          <listingline xml:id="alg1.l10"><tags>
              <tag><text fontsize="80%">10:</text></tag>
              <tag role="autoref">10</tag>
              <tag role="refnum">10</tag>
            </tags>              <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="alg1.l10.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                </XMApp>
              </XMath>
            </Math> = UpdateReplayPolicy(<Math mode="inline" tex="r^{c}_{\pi}" text="(r ^ c) _ pi" xml:id="alg1.l10.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                </XMApp>
              </XMath>
            </Math>, <Math mode="inline" tex="r^{c}_{\pi^{\prime}}" text="(r ^ c) _ (pi ^ prime)" xml:id="alg1.l10.m3">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                    <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>, <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="alg1.l10.m4">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              </XMath>
            </Math>)
</listingline>
          <listingline xml:id="alg1.l11"><tags>
              <tag><text fontsize="80%">11:</text></tag>
              <tag role="autoref">11</tag>
              <tag role="refnum">11</tag>
            </tags>           <text font="bold">end</text> <text font="bold">if</text></listingline>
          <listingline xml:id="alg1.l12"><tags>
              <tag><text fontsize="80%">12:</text></tag>
              <tag role="autoref">12</tag>
              <tag role="refnum">12</tag>
            </tags>           Set <Math mode="inline" tex="r^{c}_{\pi^{\prime}}\leftarrow r^{c}_{\pi}" text="(r ^ c) _ (pi ^ prime) leftarrow (r ^ c) _ pi" xml:id="alg1.l12.m1">
              <XMath>
                <XMApp>
                  <XMTok name="leftarrow" role="ARROW">←</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l13"><tags>
              <tag><text fontsize="80%">13:</text></tag>
              <tag role="autoref">13</tag>
              <tag role="refnum">13</tag>
            </tags>        <text font="bold">end</text> <text font="bold">if</text></listingline>
          <listingline xml:id="alg1.l14"><tags>
              <tag><text fontsize="80%">14:</text></tag>
              <tag role="autoref">14</tag>
              <tag role="refnum">14</tag>
            </tags>     <text font="bold">end</text> <text font="bold">for</text></listingline>
          <listingline xml:id="alg1.l15"><tags>
              <tag><text fontsize="80%">15:</text></tag>
              <tag role="autoref">15</tag>
              <tag role="refnum">15</tag>
            </tags>     <text font="bold">for</text> each training step <text font="bold">do</text>


</listingline>
          <listingline xml:id="alg1.l16"><tags>
              <tag><text fontsize="80%">16:</text></tag>
              <tag role="autoref">16</tag>
              <tag role="refnum">16</tag>
            </tags>        Uniformly sample a batch <Math mode="inline" tex="\{\mathcal{B}^{s}_{i}\}" text="set@((B ^ s) _ i)" xml:id="alg1.l16.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="alg1.l16.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="alg1.l16.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> from <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="alg1.l16.m2">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                </XMApp>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l17"><tags>
              <tag><text fontsize="80%">17:</text></tag>
              <tag role="autoref">17</tag>
              <tag role="refnum">17</tag>
            </tags>        Update the critic of <Math mode="inline" tex="\pi" text="pi" xml:id="alg1.l17.m1">
              <XMath>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMath>
            </Math> with Eq. (<ref labelref="LABEL:label:eqn9"/>) and (<ref labelref="LABEL:label:eqn10"/>)
</listingline>
          <listingline xml:id="alg1.l18"><tags>
              <tag><text fontsize="80%">18:</text></tag>
              <tag role="autoref">18</tag>
              <tag role="refnum">18</tag>
            </tags>        Update the actor of <Math mode="inline" tex="\pi" text="pi" xml:id="alg1.l18.m1">
              <XMath>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
              </XMath>
            </Math> with Eq. (<ref labelref="LABEL:label:eqn11"/>)
</listingline>
          <listingline xml:id="alg1.l19"><tags>
              <tag><text fontsize="80%">19:</text></tag>
              <tag role="autoref">19</tag>
              <tag role="refnum">19</tag>
            </tags>        Update target networks with Eq. (<ref labelref="LABEL:label:eqn12"/>) and (<ref labelref="LABEL:label:eqn13"/>)
</listingline>
          <listingline xml:id="alg1.l20"><tags>
              <tag><text fontsize="80%">20:</text></tag>
              <tag role="autoref">20</tag>
              <tag role="refnum">20</tag>
            </tags>        Update <Math mode="inline" tex="{\lambda}" text="lambda" xml:id="alg1.l20.m1">
              <XMath>
                <XMTok font="italic" name="lambda" role="UNKNOWN">λ</XMTok>
              </XMath>
            </Math> for each transition in <Math mode="inline" tex="\{\mathcal{B}_{i}\}" text="set@(B _ i)" xml:id="alg1.l20.m2">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="alg1.l20.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="alg1.l20.m2.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
</listingline>
          <listingline xml:id="alg1.l21"><tags>
              <tag><text fontsize="80%">21:</text></tag>
              <tag role="autoref">21</tag>
              <tag role="refnum">21</tag>
            </tags>     <text font="bold">end</text> <text font="bold">for</text></listingline>
          <listingline xml:id="alg1.l22"><tags>
              <tag><text fontsize="80%">22:</text></tag>
              <tag role="autoref">22</tag>
              <tag role="refnum">22</tag>
            </tags>  <text font="bold">end</text> <text font="bold">for</text></listingline>
        </listing>
      </float>
    </subsection>
    <subsection inlist="toc" labels="LABEL:label:sec3-2" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Training with Policy Gradient</title>
      <para xml:id="S3.SS2.p1">
        <p>This subsection describes how the replay policy is updated in ERO framework.</p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p>From the perspective of reinforcement learning, the binary vector <text font="bold">I</text> can be regarded as the “action” taken by the replay policy. The replay-reward is defined as</p>
        <equation labels="LABEL:label:eqn3" xml:id="S3.E3">
          <tags>
            <tag>(3)</tag>
            <tag role="autoref">Equation 3</tag>
            <tag role="refnum">3</tag>
          </tags>
          <Math mode="display" tex="r^{r}=r^{c}_{\pi}-r^{c}_{\pi^{\prime}}," text="r ^ r = (r ^ c) _ pi - (r ^ c) _ (pi ^ prime)" xml:id="S3.E3.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E3.m1.1"/>
                <XMWrap>
                  <XMApp xml:id="S3.E3.m1.1">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="r^{c}_{\pi^{\prime}}" text="(r ^ c) _ (pi ^ prime)" xml:id="S3.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="r^{c}_{\pi}" text="(r ^ c) _ pi" xml:id="S3.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
              </XMApp>
            </XMath>
          </Math> are the cumulative reward of the previous agent policy <Math mode="inline" tex="\pi^{\prime}" text="pi ^ prime" xml:id="S3.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> and the agent policy <Math mode="inline" tex="\pi" text="pi" xml:id="S3.SS2.p2.m4">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math> updated based on <text font="bold">I</text>, respectively. The cumulative reward of <Math mode="inline" tex="\pi" text="pi" xml:id="S3.SS2.p2.m5">
            <XMath>
              <XMTok font="italic" name="pi" role="UNKNOWN">π</XMTok>
            </XMath>
          </Math> is estimated by the recent episodes it performs<note mark="2" role="footnote" xml:id="footnote2"><tags>
              <tag>2</tag>
              <tag role="autoref">footnote 2</tag>
              <tag role="refnum">2</tag>
              <tag role="typerefnum">footnote 2</tag>
            </tags>In our implementation, a replay-reward is computed and used to update the replay policy when one episode is finished. <Math mode="inline" tex="r^{c}_{\pi}" text="(r ^ c) _ pi" xml:id="footnote2.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                </XMApp>
              </XMath>
            </Math> is estimated by the mean of recent <Math mode="inline" tex="100" text="100" xml:id="footnote2.m2">
              <XMath>
                <XMTok meaning="100" role="NUMBER">100</XMTok>
              </XMath>
            </Math> episodes.</note>. The replay-reward can be interpreted as how much the action <text font="bold">I</text> helps the learning of the agent. The objective of the replay policy is to maximize the improvement:</p>
        <equation xml:id="S3.E4">
          <tags>
            <tag>(4)</tag>
            <tag role="autoref">Equation 4</tag>
            <tag role="refnum">4</tag>
          </tags>
          <Math mode="display" tex="\mathcal{J}=\mathbb{E}_{\textbf{I}}[r^{r}]." text="J = E _ [I] * delimited-[]@(r ^ r)" xml:id="S3.E4.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E4.m1.1"/>
                <XMWrap>
                  <XMApp xml:id="S3.E4.m1.1">
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">J</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                        <XMText><text font="bold" fontsize="70%">I</text></XMText>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S3.E4.m1.1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S3.E4.m1.1.1">
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>By using the REINFORCE trick <cite class="ltx_citemacro_cite"><bibref bibrefs="williams1992simple" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, we can calculate the gradient of <Math mode="inline" tex="\mathcal{J}" text="J" xml:id="S3.SS2.p2.m6">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">J</XMTok>
            </XMath>
          </Math> w.r.t <Math mode="inline" tex="\theta^{\phi}" text="theta ^ phi" xml:id="S3.SS2.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
              </XMApp>
            </XMath>
          </Math>:</p>
        <equationgroup class="ltx_eqn_align" xml:id="Sx1.EGx2">
          <equation xml:id="S3.E5">
            <tags>
              <tag>(5)</tag>
              <tag role="autoref">Equation 5</tag>
              <tag role="refnum">5</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\begin{split}\bigtriangledown_{\theta^{\phi}}\mathcal{J}&amp;=%&#10;\bigtriangledown_{\theta^{\phi}}\mathbb{E}_{\textbf{I}}[r^{r}]\\&#10;&amp;=\mathbb{E}_{\textbf{I}}[r^{r}\bigtriangledown_{\theta^{\phi}}\log\mathcal{P}%&#10;(\textbf{I}|\phi)],\end{split}" text="bigtriangledown _ (theta ^ phi) J = bigtriangledown _ (theta ^ phi) E _ [I] * delimited-[]@(r ^ r) = E _ [I] * delimited-[]@(r ^ r bigtriangledown _ (theta ^ phi) logarithm@(P) * conditional@([I], phi))" xml:id="S3.E5.m2">
                <XMath>
                  <XMDual>
                    <XMDual>
                      <XMRef idref="S3.E5.m2.1"/>
                      <XMWrap>
                        <XMApp xml:id="S3.E5.m2.1">
                          <XMTok meaning="multirelation"/>
                          <XMApp>
                            <XMApp role="ADDOP">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMRef idref="S3.E5.m1.1.mf"/>
                              <XMRef idref="S3.E5.m1.2.mf.1"/>
                            </XMApp>
                            <XMRef idref="S3.E5.m1.3.mf"/>
                          </XMApp>
                          <XMRef idref="S3.E5.m1.4.mf"/>
                          <XMApp>
                            <XMApp role="ADDOP">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMRef idref="S3.E5.m1.5.mf"/>
                              <XMRef idref="S3.E5.m1.6.mf.1"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S3.E5.m1.7.mf"/>
                                <XMRef idref="S3.E5.m1.8.mf.1"/>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-[]"/>
                                  <XMRef idref="S3.E5.m2.1.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMRef idref="S3.E5.m1.9.mf"/>
                                  <XMApp xml:id="S3.E5.m2.1.1">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E5.m1.10.mf"/>
                                    <XMRef idref="S3.E5.m1.11.mf.1"/>
                                  </XMApp>
                                  <XMRef idref="S3.E5.m1.12.mf"/>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMRef idref="S3.E5.m1.13.mf"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMRef idref="S3.E5.m1.14.mf"/>
                              <XMRef idref="S3.E5.m1.15.mf.1"/>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S3.E5.m2.1.2"/>
                              </XMApp>
                              <XMWrap>
                                <XMRef idref="S3.E5.m1.16.mf"/>
                                <XMApp xml:id="S3.E5.m2.1.2">
                                  <XMApp role="ADDOP">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E5.m1.19.mf"/>
                                    <XMRef idref="S3.E5.m1.20.mf.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E5.m1.17.mf"/>
                                    <XMRef idref="S3.E5.m1.18.mf.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMRef idref="S3.E5.m1.21.mf"/>
                                      <XMRef idref="S3.E5.m1.22.mf"/>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.E5.m2.1.2.1"/>
                                      <XMWrap>
                                        <XMRef idref="S3.E5.m1.23.mf"/>
                                        <XMApp xml:id="S3.E5.m2.1.2.1">
                                          <XMRef idref="S3.E5.m1.25.mf" meaning="conditional" role="MODIFIEROP"/>
                                          <XMRef idref="S3.E5.m1.24.mf"/>
                                          <XMRef idref="S3.E5.m1.26.mf"/>
                                        </XMApp>
                                        <XMRef idref="S3.E5.m1.27.mf"/>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMRef idref="S3.E5.m1.28.mf"/>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT"/>
                      </XMWrap>
                    </XMDual>
                    <XMArray colsep="0pt" name="aligned">
                      <XMRow>
                        <XMCell align="right">
                          <XMApp>
                            <XMApp role="ADDOP">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMTok name="bigtriangledown" role="ADDOP" xml:id="S3.E5.m1.1.mf">▽</XMTok>
                              <XMApp xml:id="S3.E5.m1.2.mf.1">
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E5.m1.3.mf">J</XMTok>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP" xml:id="S3.E5.m1.4.mf">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMApp role="ADDOP">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok name="bigtriangledown" role="ADDOP" xml:id="S3.E5.m1.5.mf">▽</XMTok>
                                <XMApp xml:id="S3.E5.m1.6.mf.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                  <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMTok font="blackboard" role="UNKNOWN" xml:id="S3.E5.m1.7.mf">E</XMTok>
                                  <XMText xml:id="S3.E5.m1.8.mf.1"><text font="bold" fontsize="70%">I</text></XMText>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E5.m1.9.mf">[</XMTok>
                                  <XMApp xml:id="S3.E5.m2.2">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                    <XMTok font="italic" role="UNKNOWN" xml:id="S3.E5.m1.10.mf">r</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E5.m1.11.mf.1">r</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E5.m1.12.mf">]</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                      </XMRow>
                      <XMRow>
                        <XMCell/>
                        <XMCell align="left">
                          <XMWrap>
                            <XMApp xml:id="S3.E5.m2.3">
                              <XMTok meaning="equals" role="RELOP" xml:id="S3.E5.m1.13.mf">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMTok font="blackboard" role="UNKNOWN" xml:id="S3.E5.m1.14.mf">E</XMTok>
                                  <XMText xml:id="S3.E5.m1.15.mf.1"><text font="bold" fontsize="70%">I</text></XMText>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E5.m1.16.mf">[</XMTok>
                                  <XMApp xml:id="S3.E5.m2.3.1">
                                    <XMApp role="ADDOP">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok name="bigtriangledown" role="ADDOP" xml:id="S3.E5.m1.19.mf">▽</XMTok>
                                      <XMApp xml:id="S3.E5.m1.20.mf.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S3.E5.m1.17.mf">r</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E5.m1.18.mf.1">r</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E5.m1.21.mf">log</XMTok>
                                        <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E5.m1.22.mf">P</XMTok>
                                      </XMApp>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false" xml:id="S3.E5.m1.23.mf">(</XMTok>
                                        <XMApp xml:id="S3.E5.m2.3.1.1">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S3.E5.m1.25.mf">|</XMTok>
                                          <XMText xml:id="S3.E5.m1.24.mf"><text font="bold">I</text></XMText>
                                          <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E5.m1.26.mf">ϕ</XMTok>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false" xml:id="S3.E5.m1.27.mf">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E5.m1.28.mf">]</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" xml:id="S3.E5.m1.29.mf">,</XMTok>
                          </XMWrap>
                        </XMCell>
                      </XMRow>
                    </XMArray>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="center" colspan="2"><Math mode="inline" tex="\displaystyle\begin{split}\bigtriangledown_{\theta^{\phi}}\mathcal{J}&amp;=%&#10;\bigtriangledown_{\theta^{\phi}}\mathbb{E}_{\textbf{I}}[r^{r}]\\&#10;&amp;=\mathbb{E}_{\textbf{I}}[r^{r}\bigtriangledown_{\theta^{\phi}}\log\mathcal{P}%&#10;(\textbf{I}|\phi)],\end{split}" text="bigtriangledown _ (theta ^ phi) J = bigtriangledown _ (theta ^ phi) E _ [I] * delimited-[]@(r ^ r) = E _ [I] * delimited-[]@(r ^ r bigtriangledown _ (theta ^ phi) logarithm@(P) * conditional@([I], phi))" xml:id="S3.E5.m1">
                    <XMath>
                      <XMDual>
                        <XMDual>
                          <XMRef idref="S3.E5.m1.30"/>
                          <XMWrap>
                            <XMApp xml:id="S3.E5.m1.30">
                              <XMTok meaning="multirelation"/>
                              <XMApp>
                                <XMApp role="ADDOP">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMRef idref="S3.E5.m1.1"/>
                                  <XMRef idref="S3.E5.m1.2.1"/>
                                </XMApp>
                                <XMRef idref="S3.E5.m1.3"/>
                              </XMApp>
                              <XMRef idref="S3.E5.m1.4"/>
                              <XMApp>
                                <XMApp role="ADDOP">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMRef idref="S3.E5.m1.5"/>
                                  <XMRef idref="S3.E5.m1.6.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S3.E5.m1.7"/>
                                    <XMRef idref="S3.E5.m1.8.1"/>
                                  </XMApp>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="delimited-[]"/>
                                      <XMRef idref="S3.E5.m1.30.1"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMRef idref="S3.E5.m1.9"/>
                                      <XMApp xml:id="S3.E5.m1.30.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E5.m1.10"/>
                                        <XMRef idref="S3.E5.m1.11.1"/>
                                      </XMApp>
                                      <XMRef idref="S3.E5.m1.12"/>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMRef idref="S3.E5.m1.13"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMRef idref="S3.E5.m1.14"/>
                                  <XMRef idref="S3.E5.m1.15.1"/>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="S3.E5.m1.30.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMRef idref="S3.E5.m1.16"/>
                                    <XMApp xml:id="S3.E5.m1.30.2">
                                      <XMApp role="ADDOP">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E5.m1.19"/>
                                        <XMRef idref="S3.E5.m1.20.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S3.E5.m1.17"/>
                                        <XMRef idref="S3.E5.m1.18.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMRef idref="S3.E5.m1.21"/>
                                          <XMRef idref="S3.E5.m1.22"/>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="S3.E5.m1.30.2.1"/>
                                          <XMWrap>
                                            <XMRef idref="S3.E5.m1.23"/>
                                            <XMApp xml:id="S3.E5.m1.30.2.1">
                                              <XMRef idref="S3.E5.m1.25" meaning="conditional" role="MODIFIEROP"/>
                                              <XMRef idref="S3.E5.m1.24"/>
                                              <XMRef idref="S3.E5.m1.26"/>
                                            </XMApp>
                                            <XMRef idref="S3.E5.m1.27"/>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E5.m1.28"/>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT"/>
                          </XMWrap>
                        </XMDual>
                        <XMArray colsep="0pt" name="aligned">
                          <XMRow>
                            <XMCell align="right">
                              <XMApp>
                                <XMApp role="ADDOP">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMTok name="bigtriangledown" role="ADDOP" xml:id="S3.E5.m1.1">▽</XMTok>
                                  <XMApp xml:id="S3.E5.m1.2.1">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E5.m1.3">J</XMTok>
                              </XMApp>
                            </XMCell>
                            <XMCell align="left">
                              <XMApp>
                                <XMTok meaning="equals" role="RELOP" xml:id="S3.E5.m1.4">=</XMTok>
                                <XMTok meaning="absent"/>
                                <XMApp>
                                  <XMApp role="ADDOP">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok name="bigtriangledown" role="ADDOP" xml:id="S3.E5.m1.5">▽</XMTok>
                                    <XMApp xml:id="S3.E5.m1.6.1">
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="blackboard" role="UNKNOWN" xml:id="S3.E5.m1.7">E</XMTok>
                                      <XMText xml:id="S3.E5.m1.8.1"><text font="bold" fontsize="70%">I</text></XMText>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S3.E5.m1.9">[</XMTok>
                                      <XMApp xml:id="S3.E5.m1.31">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMTok font="italic" role="UNKNOWN" xml:id="S3.E5.m1.10">r</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E5.m1.11.1">r</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S3.E5.m1.12">]</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMCell>
                          </XMRow>
                          <XMRow>
                            <XMCell/>
                            <XMCell align="left">
                              <XMWrap>
                                <XMApp xml:id="S3.E5.m1.32">
                                  <XMTok meaning="equals" role="RELOP" xml:id="S3.E5.m1.13">=</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="blackboard" role="UNKNOWN" xml:id="S3.E5.m1.14">E</XMTok>
                                      <XMText xml:id="S3.E5.m1.15.1"><text font="bold" fontsize="70%">I</text></XMText>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S3.E5.m1.16">[</XMTok>
                                      <XMApp xml:id="S3.E5.m1.32.1">
                                        <XMApp role="ADDOP">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMTok name="bigtriangledown" role="ADDOP" xml:id="S3.E5.m1.19">▽</XMTok>
                                          <XMApp xml:id="S3.E5.m1.20.1">
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                            <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                            <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S3.E5.m1.17">r</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E5.m1.18.1">r</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E5.m1.21">log</XMTok>
                                            <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E5.m1.22">P</XMTok>
                                          </XMApp>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false" xml:id="S3.E5.m1.23">(</XMTok>
                                            <XMApp xml:id="S3.E5.m1.32.1.1">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S3.E5.m1.25">|</XMTok>
                                              <XMText xml:id="S3.E5.m1.24"><text font="bold">I</text></XMText>
                                              <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E5.m1.26">ϕ</XMTok>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false" xml:id="S3.E5.m1.27">)</XMTok>
                                          </XMWrap>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S3.E5.m1.28">]</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT" xml:id="S3.E5.m1.29">,</XMTok>
                              </XMWrap>
                            </XMCell>
                          </XMRow>
                        </XMArray>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="\mathcal{P}(\textbf{I}|\phi)" text="P * conditional@([I], phi)" xml:id="S3.SS2.p2.m8">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m8.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m8.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMText><text font="bold">I</text></XMText>
                      <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> is the probability of generating binary vector <text font="bold">I</text> given <Math mode="inline" tex="\phi" text="phi" xml:id="S3.SS2.p2.m9">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math>, and <Math mode="inline" tex="\phi" text="phi" xml:id="S3.SS2.p2.m10">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math> is the abbreviation for <Math mode="inline" tex="\phi(\textbf{f}_{\mathcal{B}_{i}}|\theta^{\phi})" text="phi * conditional@([f] _ B _ i, theta ^ phi)" xml:id="S3.SS2.p2.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m11.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m11.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMText><text font="bold">f</text></XMText>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">B</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMTok font="italic" fontsize="70%" name="phi" role="UNKNOWN">ϕ</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. Since each entry of <text font="bold">I</text> is sampled independently based on <Math mode="inline" tex="\bm{\lambda}" text="lambda" xml:id="S3.SS2.p2.m12">
            <XMath>
              <XMTok font="bold italic" name="lambda" role="UNKNOWN">λ</XMTok>
            </XMath>
          </Math>, the term <Math mode="inline" tex="\log\mathcal{P}(\textbf{I}|\phi)" text="logarithm@(P) * conditional@([I], phi)" xml:id="S3.SS2.p2.m13">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS2.p2.m13.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m13.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMText><text font="bold">I</text></XMText>
                      <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> can be factorized as:</p>
        <equationgroup class="ltx_eqn_align" xml:id="Sx1.EGx3">
          <equation xml:id="S3.E6">
            <tags>
              <tag>(6)</tag>
              <tag role="autoref">Equation 6</tag>
              <tag role="refnum">6</tag>
            </tags>
            <MathFork>
              <Math tex="\displaystyle\begin{split}\log\mathcal{P}(\textbf{I}|\phi)&amp;=\sum_{i=1}^{N}\log%&#10;\mathcal{P}(\textbf{I}_{i}|\phi)\\&#10;&amp;=\sum_{i=1}^{N}[\textbf{I}_{i}\log\phi+(1-\textbf{I}_{i})\log(1-\phi)],\end{split}" text="logarithm@(P) * conditional@([I], phi) = ((sum _ (i = 1)) ^ N)@(logarithm@(P) * conditional@([I] _ i, phi)) = ((sum _ (i = 1)) ^ N)@(delimited-[]@([I] _ i * logarithm@(phi) + (1 - [I] _ i) * logarithm@(1 - phi)))" xml:id="S3.E6.m2">
                <XMath>
                  <XMDual>
                    <XMDual>
                      <XMRef idref="S3.E6.m2.1"/>
                      <XMWrap>
                        <XMApp xml:id="S3.E6.m2.1">
                          <XMTok meaning="multirelation"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMRef idref="S3.E6.m1.1.mf"/>
                              <XMRef idref="S3.E6.m1.2.mf"/>
                            </XMApp>
                            <XMDual>
                              <XMRef idref="S3.E6.m2.1.1"/>
                              <XMWrap>
                                <XMRef idref="S3.E6.m1.3.mf"/>
                                <XMApp xml:id="S3.E6.m2.1.1">
                                  <XMRef idref="S3.E6.m1.5.mf" meaning="conditional" role="MODIFIEROP"/>
                                  <XMRef idref="S3.E6.m1.4.mf"/>
                                  <XMRef idref="S3.E6.m1.6.mf"/>
                                </XMApp>
                                <XMRef idref="S3.E6.m1.7.mf"/>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMRef idref="S3.E6.m1.8.mf"/>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                <XMRef idref="S3.E6.m1.9.mf"/>
                                <XMRef idref="S3.E6.m1.10.mf.1"/>
                              </XMApp>
                              <XMRef idref="S3.E6.m1.11.mf.1"/>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMRef idref="S3.E6.m1.12.mf"/>
                                <XMRef idref="S3.E6.m1.13.mf"/>
                              </XMApp>
                              <XMDual>
                                <XMRef idref="S3.E6.m2.1.2"/>
                                <XMWrap>
                                  <XMRef idref="S3.E6.m1.14.mf"/>
                                  <XMApp xml:id="S3.E6.m2.1.2">
                                    <XMRef idref="S3.E6.m1.17.mf" meaning="conditional" role="MODIFIEROP"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S3.E6.m1.15.mf"/>
                                      <XMRef idref="S3.E6.m1.16.mf.1"/>
                                    </XMApp>
                                    <XMRef idref="S3.E6.m1.18.mf"/>
                                  </XMApp>
                                  <XMRef idref="S3.E6.m1.19.mf"/>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMRef idref="S3.E6.m1.20.mf"/>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                <XMRef idref="S3.E6.m1.21.mf"/>
                                <XMRef idref="S3.E6.m1.22.mf.1"/>
                              </XMApp>
                              <XMRef idref="S3.E6.m1.23.mf.1"/>
                            </XMApp>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="delimited-[]"/>
                                <XMRef idref="S3.E6.m2.1.3"/>
                              </XMApp>
                              <XMWrap>
                                <XMRef idref="S3.E6.m1.24.mf"/>
                                <XMApp xml:id="S3.E6.m2.1.3">
                                  <XMRef idref="S3.E6.m1.29.mf"/>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S3.E6.m1.25.mf"/>
                                      <XMRef idref="S3.E6.m1.26.mf.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMRef idref="S3.E6.m1.27.mf"/>
                                      <XMRef idref="S3.E6.m1.28.mf"/>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMDual>
                                      <XMRef idref="S3.E6.m2.1.3.1"/>
                                      <XMWrap>
                                        <XMRef idref="S3.E6.m1.30.mf"/>
                                        <XMApp xml:id="S3.E6.m2.1.3.1">
                                          <XMRef idref="S3.E6.m1.32.mf"/>
                                          <XMRef idref="S3.E6.m1.31.mf"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMRef idref="S3.E6.m1.33.mf"/>
                                            <XMRef idref="S3.E6.m1.34.mf.1"/>
                                          </XMApp>
                                        </XMApp>
                                        <XMRef idref="S3.E6.m1.35.mf"/>
                                      </XMWrap>
                                    </XMDual>
                                    <XMDual>
                                      <XMApp>
                                        <XMRef idref="S3.E6.m1.36.mf"/>
                                        <XMRef idref="S3.E6.m2.1.3.2"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMRef idref="S3.E6.m1.36.mf"/>
                                        <XMWrap>
                                          <XMRef idref="S3.E6.m1.37.mf"/>
                                          <XMApp xml:id="S3.E6.m2.1.3.2">
                                            <XMRef idref="S3.E6.m1.39.mf"/>
                                            <XMRef idref="S3.E6.m1.38.mf"/>
                                            <XMRef idref="S3.E6.m1.40.mf"/>
                                          </XMApp>
                                          <XMRef idref="S3.E6.m1.41.mf"/>
                                        </XMWrap>
                                      </XMApp>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMRef idref="S3.E6.m1.42.mf"/>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT"/>
                      </XMWrap>
                    </XMDual>
                    <XMArray colsep="0pt" name="aligned">
                      <XMRow>
                        <XMCell align="right">
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.1.mf">log</XMTok>
                              <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E6.m1.2.mf">P</XMTok>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.3.mf">(</XMTok>
                              <XMApp xml:id="S3.E6.m2.2">
                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S3.E6.m1.5.mf">|</XMTok>
                                <XMText xml:id="S3.E6.m1.4.mf"><text font="bold">I</text></XMText>
                                <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.6.mf">ϕ</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.7.mf">)</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMCell>
                        <XMCell align="left">
                          <XMApp>
                            <XMTok meaning="equals" role="RELOP" xml:id="S3.E6.m1.8.mf">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                  <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E6.m1.9.mf">∑</XMTok>
                                  <XMApp xml:id="S3.E6.m1.10.mf.1">
                                    <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.11.mf.1">N</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.12.mf">log</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E6.m1.13.mf">P</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.14.mf">(</XMTok>
                                  <XMApp xml:id="S3.E6.m2.3">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S3.E6.m1.17.mf">|</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMText xml:id="S3.E6.m1.15.mf"><text font="bold">I</text></XMText>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.16.mf.1">i</XMTok>
                                    </XMApp>
                                    <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.18.mf">ϕ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.19.mf">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMCell>
                      </XMRow>
                      <XMRow>
                        <XMCell/>
                        <XMCell align="left">
                          <XMWrap>
                            <XMApp xml:id="S3.E6.m2.4">
                              <XMTok meaning="equals" role="RELOP" xml:id="S3.E6.m1.20.mf">=</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                    <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E6.m1.21.mf">∑</XMTok>
                                    <XMApp xml:id="S3.E6.m1.22.mf.1">
                                      <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.23.mf.1">N</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.24.mf">[</XMTok>
                                  <XMApp xml:id="S3.E6.m2.4.1">
                                    <XMTok meaning="plus" role="ADDOP" xml:id="S3.E6.m1.29.mf">+</XMTok>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMText xml:id="S3.E6.m1.25.mf"><text font="bold">I</text></XMText>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.26.mf.1">i</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.27.mf">log</XMTok>
                                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.28.mf">ϕ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.30.mf">(</XMTok>
                                        <XMApp xml:id="S3.E6.m2.4.1.1">
                                          <XMTok meaning="minus" role="ADDOP" xml:id="S3.E6.m1.32.mf">-</XMTok>
                                          <XMTok meaning="1" role="NUMBER" xml:id="S3.E6.m1.31.mf">1</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMText xml:id="S3.E6.m1.33.mf"><text font="bold">I</text></XMText>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.34.mf.1">i</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.35.mf">)</XMTok>
                                      </XMWrap>
                                      <XMApp>
                                        <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.36.mf">log</XMTok>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.37.mf">(</XMTok>
                                          <XMApp xml:id="S3.E6.m2.4.1.2">
                                            <XMTok meaning="minus" role="ADDOP" xml:id="S3.E6.m1.39.mf">-</XMTok>
                                            <XMTok meaning="1" role="NUMBER" xml:id="S3.E6.m1.38.mf">1</XMTok>
                                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.40.mf">ϕ</XMTok>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.41.mf">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.42.mf">]</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT" xml:id="S3.E6.m1.43.mf">,</XMTok>
                          </XMWrap>
                        </XMCell>
                      </XMRow>
                    </XMArray>
                  </XMDual>
                </XMath>
              </Math>
              <MathBranch>
                <td align="center" colspan="2"><Math mode="inline" tex="\displaystyle\begin{split}\log\mathcal{P}(\textbf{I}|\phi)&amp;=\sum_{i=1}^{N}\log%&#10;\mathcal{P}(\textbf{I}_{i}|\phi)\\&#10;&amp;=\sum_{i=1}^{N}[\textbf{I}_{i}\log\phi+(1-\textbf{I}_{i})\log(1-\phi)],\end{split}" text="logarithm@(P) * conditional@([I], phi) = ((sum _ (i = 1)) ^ N)@(logarithm@(P) * conditional@([I] _ i, phi)) = ((sum _ (i = 1)) ^ N)@(delimited-[]@([I] _ i * logarithm@(phi) + (1 - [I] _ i) * logarithm@(1 - phi)))" xml:id="S3.E6.m1">
                    <XMath>
                      <XMDual>
                        <XMDual>
                          <XMRef idref="S3.E6.m1.44"/>
                          <XMWrap>
                            <XMApp xml:id="S3.E6.m1.44">
                              <XMTok meaning="multirelation"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMRef idref="S3.E6.m1.1"/>
                                  <XMRef idref="S3.E6.m1.2"/>
                                </XMApp>
                                <XMDual>
                                  <XMRef idref="S3.E6.m1.44.1"/>
                                  <XMWrap>
                                    <XMRef idref="S3.E6.m1.3"/>
                                    <XMApp xml:id="S3.E6.m1.44.1">
                                      <XMRef idref="S3.E6.m1.5" meaning="conditional" role="MODIFIEROP"/>
                                      <XMRef idref="S3.E6.m1.4"/>
                                      <XMRef idref="S3.E6.m1.6"/>
                                    </XMApp>
                                    <XMRef idref="S3.E6.m1.7"/>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMRef idref="S3.E6.m1.8"/>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                    <XMRef idref="S3.E6.m1.9"/>
                                    <XMRef idref="S3.E6.m1.10.1"/>
                                  </XMApp>
                                  <XMRef idref="S3.E6.m1.11.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMRef idref="S3.E6.m1.12"/>
                                    <XMRef idref="S3.E6.m1.13"/>
                                  </XMApp>
                                  <XMDual>
                                    <XMRef idref="S3.E6.m1.44.2"/>
                                    <XMWrap>
                                      <XMRef idref="S3.E6.m1.14"/>
                                      <XMApp xml:id="S3.E6.m1.44.2">
                                        <XMRef idref="S3.E6.m1.17" meaning="conditional" role="MODIFIEROP"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S3.E6.m1.15"/>
                                          <XMRef idref="S3.E6.m1.16.1"/>
                                        </XMApp>
                                        <XMRef idref="S3.E6.m1.18"/>
                                      </XMApp>
                                      <XMRef idref="S3.E6.m1.19"/>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMRef idref="S3.E6.m1.20"/>
                              <XMApp>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                    <XMRef idref="S3.E6.m1.21"/>
                                    <XMRef idref="S3.E6.m1.22.1"/>
                                  </XMApp>
                                  <XMRef idref="S3.E6.m1.23.1"/>
                                </XMApp>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="delimited-[]"/>
                                    <XMRef idref="S3.E6.m1.44.3"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMRef idref="S3.E6.m1.24"/>
                                    <XMApp xml:id="S3.E6.m1.44.3">
                                      <XMRef idref="S3.E6.m1.29"/>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S3.E6.m1.25"/>
                                          <XMRef idref="S3.E6.m1.26.1"/>
                                        </XMApp>
                                        <XMApp>
                                          <XMRef idref="S3.E6.m1.27"/>
                                          <XMRef idref="S3.E6.m1.28"/>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMDual>
                                          <XMRef idref="S3.E6.m1.44.3.1"/>
                                          <XMWrap>
                                            <XMRef idref="S3.E6.m1.30"/>
                                            <XMApp xml:id="S3.E6.m1.44.3.1">
                                              <XMRef idref="S3.E6.m1.32"/>
                                              <XMRef idref="S3.E6.m1.31"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                <XMRef idref="S3.E6.m1.33"/>
                                                <XMRef idref="S3.E6.m1.34.1"/>
                                              </XMApp>
                                            </XMApp>
                                            <XMRef idref="S3.E6.m1.35"/>
                                          </XMWrap>
                                        </XMDual>
                                        <XMDual>
                                          <XMApp>
                                            <XMRef idref="S3.E6.m1.36"/>
                                            <XMRef idref="S3.E6.m1.44.3.2"/>
                                          </XMApp>
                                          <XMApp>
                                            <XMRef idref="S3.E6.m1.36"/>
                                            <XMWrap>
                                              <XMRef idref="S3.E6.m1.37"/>
                                              <XMApp xml:id="S3.E6.m1.44.3.2">
                                                <XMRef idref="S3.E6.m1.39"/>
                                                <XMRef idref="S3.E6.m1.38"/>
                                                <XMRef idref="S3.E6.m1.40"/>
                                              </XMApp>
                                              <XMRef idref="S3.E6.m1.41"/>
                                            </XMWrap>
                                          </XMApp>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMRef idref="S3.E6.m1.42"/>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="PUNCT"/>
                          </XMWrap>
                        </XMDual>
                        <XMArray colsep="0pt" name="aligned">
                          <XMRow>
                            <XMCell align="right">
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.1">log</XMTok>
                                  <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E6.m1.2">P</XMTok>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.3">(</XMTok>
                                  <XMApp xml:id="S3.E6.m1.45">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S3.E6.m1.5">|</XMTok>
                                    <XMText xml:id="S3.E6.m1.4"><text font="bold">I</text></XMText>
                                    <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.6">ϕ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.7">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMCell>
                            <XMCell align="left">
                              <XMApp>
                                <XMTok meaning="equals" role="RELOP" xml:id="S3.E6.m1.8">=</XMTok>
                                <XMTok meaning="absent"/>
                                <XMApp>
                                  <XMApp>
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E6.m1.9">∑</XMTok>
                                      <XMApp xml:id="S3.E6.m1.10.1">
                                        <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.11.1">N</XMTok>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.12">log</XMTok>
                                      <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.E6.m1.13">P</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.14">(</XMTok>
                                      <XMApp xml:id="S3.E6.m1.46">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S3.E6.m1.17">|</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMText xml:id="S3.E6.m1.15"><text font="bold">I</text></XMText>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.16.1">i</XMTok>
                                        </XMApp>
                                        <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.18">ϕ</XMTok>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.19">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMApp>
                              </XMApp>
                            </XMCell>
                          </XMRow>
                          <XMRow>
                            <XMCell/>
                            <XMCell align="left">
                              <XMWrap>
                                <XMApp xml:id="S3.E6.m1.47">
                                  <XMTok meaning="equals" role="RELOP" xml:id="S3.E6.m1.20">=</XMTok>
                                  <XMTok meaning="absent"/>
                                  <XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="mid6"/>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="mid6"/>
                                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid" xml:id="S3.E6.m1.21">∑</XMTok>
                                        <XMApp xml:id="S3.E6.m1.22.1">
                                          <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.23.1">N</XMTok>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.24">[</XMTok>
                                      <XMApp xml:id="S3.E6.m1.47.1">
                                        <XMTok meaning="plus" role="ADDOP" xml:id="S3.E6.m1.29">+</XMTok>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMText xml:id="S3.E6.m1.25"><text font="bold">I</text></XMText>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.26.1">i</XMTok>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.27">log</XMTok>
                                            <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.28">ϕ</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.30">(</XMTok>
                                            <XMApp xml:id="S3.E6.m1.47.1.1">
                                              <XMTok meaning="minus" role="ADDOP" xml:id="S3.E6.m1.32">-</XMTok>
                                              <XMTok meaning="1" role="NUMBER" xml:id="S3.E6.m1.31">1</XMTok>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                <XMText xml:id="S3.E6.m1.33"><text font="bold">I</text></XMText>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.E6.m1.34.1">i</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.35">)</XMTok>
                                          </XMWrap>
                                          <XMApp>
                                            <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E6.m1.36">log</XMTok>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false" xml:id="S3.E6.m1.37">(</XMTok>
                                              <XMApp xml:id="S3.E6.m1.47.1.2">
                                                <XMTok meaning="minus" role="ADDOP" xml:id="S3.E6.m1.39">-</XMTok>
                                                <XMTok meaning="1" role="NUMBER" xml:id="S3.E6.m1.38">1</XMTok>
                                                <XMTok font="italic" name="phi" role="UNKNOWN" xml:id="S3.E6.m1.40">ϕ</XMTok>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.41">)</XMTok>
                                            </XMWrap>
                                          </XMApp>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S3.E6.m1.42">]</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="PUNCT" xml:id="S3.E6.m1.43">,</XMTok>
                              </XMWrap>
                            </XMCell>
                          </XMRow>
                        </XMArray>
                      </XMDual>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>where <Math mode="inline" tex="N" text="N" xml:id="S3.SS2.p2.m14">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> is the number of the transitions in <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S3.SS2.p2.m15">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math>, and <Math mode="inline" tex="\textbf{I}_{i}" text="[I] _ i" xml:id="S3.SS2.p2.m16">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMText><text font="bold">I</text></XMText>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> is the binary selector for transition <Math mode="inline" tex="\mathcal{B}_{i}" text="B _ i" xml:id="S3.SS2.p2.m17">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math>. The resulting policy gradient can be written as:</p>
        <equation labels="LABEL:label:eqn7" xml:id="S3.E7">
          <tags>
            <tag>(7)</tag>
            <tag role="autoref">Equation 7</tag>
            <tag role="refnum">7</tag>
          </tags>
          <Math mode="display" tex="\bigtriangledown_{\theta^{\phi}}\mathcal{J}\approx r^{r}\sum_{i=1}^{N}%&#10;\bigtriangledown_{\theta^{\phi}}[\textbf{I}_{i}\log\phi+(1-\textbf{I}_{i})\log%&#10;(1-\phi)]." text="bigtriangledown _ (theta ^ phi) J approximately-equals r ^ r * (sum _ (i = 1)) ^ N bigtriangledown _ (theta ^ phi) delimited-[]@([I] _ i * logarithm@(phi) + (1 - [I] _ i) * logarithm@(1 - phi))" xml:id="S3.E7.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E7.m1.2"/>
                <XMWrap>
                  <XMApp xml:id="S3.E7.m1.2">
                    <XMTok meaning="approximately-equals" name="approx" role="RELOP">≈</XMTok>
                    <XMApp>
                      <XMApp role="ADDOP">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="bigtriangledown" role="ADDOP">▽</XMTok>
<!--  %**** main.tex Line 200 **** -->                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok font="caligraphic" role="UNKNOWN">J</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp role="ADDOP">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok name="bigtriangledown" role="ADDOP">▽</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="mid1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                            <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="equals" role="RELOP">=</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">N</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="delimited-[]"/>
                          <XMRef idref="S3.E7.m1.2.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="S3.E7.m1.2.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMText><text font="bold">I</text></XMText>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                                <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMRef idref="S3.E7.m1.2.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E7.m1.2.1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMText><text font="bold">I</text></XMText>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMDual>
                                <XMApp>
                                  <XMRef idref="S3.E7.m1.1"/>
                                  <XMRef idref="S3.E7.m1.2.1.2"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E7.m1.1">log</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.E7.m1.2.1.2">
                                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                                      <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="PERIOD">.</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>If we regard <text font="bold">I</text> as “labels”, then Eq. (<ref labelref="LABEL:label:eqn7"/>) can be viewed as cross-entropy loss of the replay policy <Math mode="inline" tex="\phi" text="phi" xml:id="S3.SS2.p2.m18">
            <XMath>
              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
            </XMath>
          </Math>, scaled by <Math mode="inline" tex="r^{r}" text="r ^ r" xml:id="S3.SS2.p2.m19">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
              </XMApp>
            </XMath>
          </Math>. Intuitively, a current positive (negative) reward will encourage (discourage) the next action to be similar to the current action <text font="bold">I</text>. Thus, the replay policy is updated to maximize the replay-reward. At each replay updating step, the gradient of Eq. (<ref labelref="LABEL:label:eqn7"/>) can be approximated by sub-sample a mini-batch of transitions from <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S3.SS2.p2.m20">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math> to efficiently update the replay policy:</p>
      </para>
      <para xml:id="S3.SS2.p3">
        <equation labels="LABEL:label:eqn8" xml:id="S3.E8">
          <tags>
            <tag>(8)</tag>
            <tag role="autoref">Equation 8</tag>
            <tag role="refnum">8</tag>
          </tags>
          <Math mode="display" tex="\sum_{j:\mathcal{B}_{j}\in\mathcal{B}^{batch}}r^{r}\bigtriangledown_{\theta^{%&#10;\phi}}[\textbf{I}_{j}\log\phi+(1-\textbf{I}_{j})\log(1-\phi)]," text="(sum _ (j colon B _ j element-of B ^ (b * a * t * c * h)))@(r ^ r) bigtriangledown _ (theta ^ phi) delimited-[]@([I] _ j * logarithm@(phi) + (1 - [I] _ j) * logarithm@(1 - phi))" xml:id="S3.E8.m1">
            <XMath>
              <XMDual>
                <XMRef idref="S3.E8.m1.2"/>
                <XMWrap>
                  <XMApp xml:id="S3.E8.m1.2">
                    <XMApp role="ADDOP">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok name="bigtriangledown" role="ADDOP">▽</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMTok font="italic" fontsize="50%" name="phi" role="UNKNOWN">ϕ</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMApp>
                          <XMTok fontsize="70%" name="colon" role="METARELOP">:</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">B</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">B</XMTok>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">b</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">a</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">c</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">h</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="delimited-[]"/>
                        <XMRef idref="S3.E8.m1.2.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">[</XMTok>
                        <XMApp xml:id="S3.E8.m1.2.1">
                          <XMTok meaning="plus" role="ADDOP">+</XMTok>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMText><text font="bold">I</text></XMText>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="logarithm" role="OPFUNCTION">log</XMTok>
                              <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMDual>
                              <XMRef idref="S3.E8.m1.2.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.E8.m1.2.1.1">
                                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMText><text font="bold">I</text></XMText>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                            <XMDual>
                              <XMApp>
                                <XMRef idref="S3.E8.m1.1"/>
                                <XMRef idref="S3.E8.m1.2.1.2"/>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="logarithm" role="OPFUNCTION" xml:id="S3.E8.m1.1">log</XMTok>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.E8.m1.2.1.2">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" name="phi" role="UNKNOWN">ϕ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMDual>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">]</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>
        </equation>
        <p>where <Math mode="inline" tex="\mathcal{B}^{batch}" text="B ^ (b * a * t * c * h)" xml:id="S3.SS2.p3.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">b</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">h</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> denotes a mini-batch of transitions sampled from <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="S3.SS2.p3.m2">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math>. Note that the replay policy is updated only at the end of each episode. When an episode is finished, the replay-reward for the current action <text font="bold">I</text> is used to update the replay policy. The updates of the replay policy rely on the cumulative rewards of the recent episodes in the training process, but do not require generating new episodes.</p>
      </para>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:label:alg2" placement="t" xml:id="alg2">
        <tags>
          <tag><text font="bold">Algorithm 2</text></tag>
          <tag role="autoref">2</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Algorithm 2</tag>
        </tags>
        <toccaption><tag close=" ">2</tag>UpdateReplayPolicy</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 2</text></tag> UpdateReplayPolicy</caption>
        <p class="ltx_figure_panel"><text font="bold">Input:<break/></text>   Cumulative reward of current policy <Math mode="inline" tex="r^{c}_{\pi}" text="(r ^ c) _ pi" xml:id="alg2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
              </XMApp>
            </XMath>
          </Math><break/>   Cumulative reward of previous policy <Math mode="inline" tex="r^{c}_{\pi^{\prime}}" text="(r ^ c) _ (pi ^ prime)" xml:id="alg2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">c</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" name="pi" role="UNKNOWN">π</XMTok>
                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math><break/>   Buffer <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="alg2.m3">
            <XMath>
              <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
            </XMath>
          </Math> <break/><text font="bold">Output:</text> <break/>   Sampled subset <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="alg2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <listing class="ltx_figure_panel">
          <listingline xml:id="alg2.l1"><tags>
              <tag><text fontsize="80%">1:</text></tag>
              <tag role="autoref">1</tag>
              <tag role="refnum">1</tag>
            </tags>  Calculate replay-reward based on Eq. (<ref labelref="LABEL:label:eqn3"/>)
</listingline>
          <listingline xml:id="alg2.l2"><tags>
              <tag><text fontsize="80%">2:</text></tag>
              <tag role="autoref">2</tag>
              <tag role="refnum">2</tag>
            </tags>  <text font="bold">for</text> each replay updating step <text font="bold">do</text>


</listingline>
          <listingline xml:id="alg2.l3"><tags>
              <tag><text fontsize="80%">3:</text></tag>
              <tag role="autoref">3</tag>
              <tag role="refnum">3</tag>
            </tags>     Randomly sample a batch <Math mode="inline" tex="\{\mathcal{B}_{i}\}" text="set@(B _ i)" xml:id="alg2.l3.m1">
              <XMath>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="alg2.l3.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="alg2.l3.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math> from <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="alg2.l3.m2">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              </XMath>
            </Math><!--  %**** main.tex Line 225 **** -->
</listingline>
          <listingline xml:id="alg2.l4"><tags>
              <tag><text fontsize="80%">4:</text></tag>
              <tag role="autoref">4</tag>
              <tag role="refnum">4</tag>
            </tags>     Update replay policy based on Eq. (<ref labelref="LABEL:label:eqn8"/>)
</listingline>
          <listingline xml:id="alg2.l5"><tags>
              <tag><text fontsize="80%">5:</text></tag>
              <tag role="autoref">5</tag>
              <tag role="refnum">5</tag>
            </tags>  <text font="bold">end</text> <text font="bold">for</text></listingline>
          <listingline xml:id="alg2.l6"><tags>
              <tag><text fontsize="80%">6:</text></tag>
              <tag role="autoref">6</tag>
              <tag role="refnum">6</tag>
            </tags>  Sample a subset <Math mode="inline" tex="\mathcal{B}^{s}" text="B ^ s" xml:id="alg2.l6.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                </XMApp>
              </XMath>
            </Math> from <Math mode="inline" tex="\mathcal{B}" text="B" xml:id="alg2.l6.m2">
              <XMath>
                <XMTok font="caligraphic" role="UNKNOWN">B</XMTok>
              </XMath>
            </Math> using Eq. (<ref labelref="LABEL:label:eqn2"/>)
</listingline>
        </listing>
      </float>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Application to Off-policy Algorithms</title>
    <para xml:id="S4.p1">
      <p>In this section, we use the benchmark off-policy algorithm DDPG <cite class="ltx_citemacro_cite"><bibref bibrefs="lillicrap2016continuous" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> as an example to show how ERO is applied. Note that ERO could also be applied to other off-policy algorithms by using similar procedures.</p>
    </para>
    <para xml:id="S4.p2">
      <p>DDPG is a model-free actor-critic algorithm consisting of an actor function <Math mode="inline" tex="\mu(s|\theta^{\mu})" text="mu * conditional@(s, theta ^ mu)" xml:id="S4.p2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              <XMDual>
                <XMRef idref="S4.p2.m1.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.p2.m1.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> that specifies the current policy and a critic function <Math mode="inline" tex="Q(s_{t},a_{t}|\theta^{Q})" text="Q * open-interval@(s _ t, conditional@(a _ t, theta ^ Q))" xml:id="S4.p2.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-interval"/>
                  <XMRef idref="S4.p2.m2.1"/>
                  <XMRef idref="S4.p2.m2.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S4.p2.m2.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">s</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S4.p2.m2.2">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">a</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. Here, <Math mode="inline" tex="\theta^{\mu}" text="theta ^ mu" xml:id="S4.p2.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="\theta^{Q}" text="theta ^ Q" xml:id="S4.p2.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
            </XMApp>
          </XMath>
        </Math> are approximated by deep neural networks. In training, DDPG optimizes <Math mode="inline" tex="\theta^{Q}" text="theta ^ Q" xml:id="S4.p2.m5">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
            </XMApp>
          </XMath>
        </Math> by minimizing the following loss w.r.t <Math mode="inline" tex="\theta^{Q}" text="theta ^ Q" xml:id="S4.p2.m6">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
            </XMApp>
          </XMath>
        </Math>:</p>
      <equation labels="LABEL:label:eqn9" xml:id="S4.E9">
        <tags>
          <tag>(9)</tag>
          <tag role="autoref">Equation 9</tag>
          <tag role="refnum">9</tag>
        </tags>
        <Math mode="display" tex="\mathcal{L}(\theta^{Q})=\frac{1}{N}\sum_{t}(y_{t}-Q(s_{t},a_{t}|\theta^{Q}))^{%&#10;2}," text="L * theta ^ Q = (1 / N) * (sum _ t)@((y _ t - Q * open-interval@(s _ t, conditional@(a _ t, theta ^ Q))) ^ 2)" xml:id="S4.E9.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S4.E9.m1.1"/>
              <XMWrap>
                <XMApp xml:id="S4.E9.m1.1">
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                    <XMDual>
                      <XMRef idref="S4.E9.m1.1.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S4.E9.m1.1.1">
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                      <XMTok font="italic" role="UNKNOWN">N</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                        <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMRef idref="S4.E9.m1.1.2"/>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                            <XMApp xml:id="S4.E9.m1.1.2">
                              <XMTok meaning="minus" role="ADDOP">-</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">y</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                                <XMDual>
                                  <XMApp>
                                    <XMTok meaning="open-interval"/>
                                    <XMRef idref="S4.E9.m1.1.2.1"/>
                                    <XMRef idref="S4.E9.m1.1.2.2"/>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S4.E9.m1.1.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT">,</XMTok>
                                    <XMApp xml:id="S4.E9.m1.1.2.2">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                      <XMApp>
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PUNCT">,</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>where</p>
      <equation labels="LABEL:label:eqn10" xml:id="S4.E10">
        <tags>
          <tag>(10)</tag>
          <tag role="autoref">Equation 10</tag>
          <tag role="refnum">10</tag>
        </tags>
        <Math mode="display" tex="y_{t}=r(s_{t},a_{t})+\gamma Q(s_{t+1},\mu(s_{t+1}|\theta^{\mu})|\theta^{Q})." text="y _ t = r * open-interval@(s _ t, a _ t) + gamma * Q * open-interval@(s _ (t + 1), conditional@(mu * conditional@(s _ (t + 1), theta ^ mu), theta ^ Q))" xml:id="S4.E10.m1">
          <XMath>
            <XMDual>
              <XMRef idref="S4.E10.m1.1"/>
              <XMWrap>
                <XMApp xml:id="S4.E10.m1.1">
                  <XMTok meaning="equals" role="RELOP">=</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">y</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="plus" role="ADDOP">+</XMTok>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.E10.m1.1.1"/>
                          <XMRef idref="S4.E10.m1.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S4.E10.m1.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S4.E10.m1.1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">a</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMTok font="italic" name="gamma" role="UNKNOWN">γ</XMTok>
                      <XMTok font="italic" role="UNKNOWN">Q</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S4.E10.m1.1.3"/>
                          <XMRef idref="S4.E10.m1.1.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S4.E10.m1.1.3">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">s</XMTok>
                            <XMApp>
                              <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S4.E10.m1.1.4">
                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMDual>
                                <XMRef idref="S4.E10.m1.1.4.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E10.m1.1.4.1">
                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">s</XMTok>
                                      <XMApp>
                                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok role="PERIOD">.</XMTok>
              </XMWrap>
            </XMDual>
          </XMath>
        </Math>
      </equation>
      <p>The actor network can be updated by applying chain rules to <Math mode="inline" tex="\mathcal{J}" text="J" xml:id="S4.p2.m7">
          <XMath>
            <XMTok font="caligraphic" role="UNKNOWN">J</XMTok>
          </XMath>
        </Math>, the expected return over the state distribution, w.r.t <Math mode="inline" tex="\theta^{\mu}" text="theta ^ mu" xml:id="S4.p2.m8">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
            </XMApp>
          </XMath>
        </Math> <cite class="ltx_citemacro_cite"><bibref bibrefs="silver2014deterministic" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>:</p>
    </para>
<!--  %**** main.tex Line 250 **** -->    <para xml:id="S4.p3">
      <equationgroup class="ltx_eqn_align" xml:id="Sx1.EGx4">
        <equation labels="LABEL:label:eqn11" xml:id="S4.E11">
          <tags>
            <tag>(11)</tag>
            <tag role="autoref">Equation 11</tag>
            <tag role="refnum">11</tag>
          </tags>
          <MathFork>
            <Math tex="\displaystyle\begin{split}\bigtriangledown_{\theta^{\mu}}\mathcal{J}&amp;\approx%&#10;\mathbb{E}_{s_{t}}[\bigtriangledown_{\theta^{\mu}}Q(s_{t},\mu(s_{t}|\theta^{%&#10;\mu})|\theta^{Q})]\\&#10;&amp;=\mathbb{E}_{s_{t}}[\bigtriangledown_{\mu}Q(s_{t},\mu(s_{t}|\theta_{\mu})|%&#10;\theta^{Q})\bigtriangledown_{\theta_{\mu}}\mu(s_{t}|\theta^{\mu})].\end{split}" text="bigtriangledown _ (theta ^ mu) J approximately-equals E _ s _ t * delimited-[]@(bigtriangledown _ (theta ^ mu) Q * open-interval@(s _ t, conditional@(mu * conditional@(s _ t, theta ^ mu), theta ^ Q))) = E _ s _ t * delimited-[]@(bigtriangledown _ mu Q * open-interval@(s _ t, conditional@(mu * conditional@(s _ t, theta _ mu), theta ^ Q)) bigtriangledown _ theta _ mu mu * conditional@(s _ t, theta ^ mu))" xml:id="S4.E11.m2">
              <XMath>
                <XMDual>
                  <XMDual>
                    <XMRef idref="S4.E11.m2.1"/>
                    <XMWrap>
                      <XMApp xml:id="S4.E11.m2.1">
                        <XMTok meaning="multirelation"/>
                        <XMApp>
                          <XMApp role="ADDOP">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                            <XMRef idref="S4.E11.m1.1.mf"/>
                            <XMRef idref="S4.E11.m1.2.mf.1"/>
                          </XMApp>
                          <XMRef idref="S4.E11.m1.3.mf"/>
                        </XMApp>
                        <XMRef idref="S4.E11.m1.4.mf"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                            <XMRef idref="S4.E11.m1.5.mf"/>
                            <XMRef idref="S4.E11.m1.6.mf.1"/>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S4.E11.m2.1.1"/>
                            </XMApp>
                            <XMWrap>
                              <XMRef idref="S4.E11.m1.7.mf"/>
                              <XMApp xml:id="S4.E11.m2.1.1">
                                <XMApp role="ADDOP">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMRef idref="S4.E11.m1.8.mf"/>
                                  <XMRef idref="S4.E11.m1.9.mf.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMRef idref="S4.E11.m1.10.mf"/>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="open-interval"/>
                                      <XMRef idref="S4.E11.m2.1.1.1"/>
                                      <XMRef idref="S4.E11.m2.1.1.2"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMRef idref="S4.E11.m1.11.mf"/>
                                      <XMApp xml:id="S4.E11.m2.1.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S4.E11.m1.12.mf"/>
                                        <XMRef idref="S4.E11.m1.13.mf.1"/>
                                      </XMApp>
                                      <XMRef idref="S4.E11.m1.14.mf"/>
                                      <XMApp xml:id="S4.E11.m2.1.1.2">
                                        <XMRef idref="S4.E11.m1.23.mf" meaning="conditional" role="MODIFIEROP"/>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMRef idref="S4.E11.m1.15.mf"/>
                                          <XMDual>
                                            <XMRef idref="S4.E11.m2.1.1.2.1"/>
                                            <XMWrap>
                                              <XMRef idref="S4.E11.m1.16.mf"/>
                                              <XMApp xml:id="S4.E11.m2.1.1.2.1">
                                                <XMRef idref="S4.E11.m1.19.mf" meaning="conditional" role="MODIFIEROP"/>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                  <XMRef idref="S4.E11.m1.17.mf"/>
                                                  <XMRef idref="S4.E11.m1.18.mf.1"/>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                  <XMRef idref="S4.E11.m1.20.mf"/>
                                                  <XMRef idref="S4.E11.m1.21.mf.1"/>
                                                </XMApp>
                                              </XMApp>
                                              <XMRef idref="S4.E11.m1.22.mf"/>
                                            </XMWrap>
                                          </XMDual>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S4.E11.m1.24.mf"/>
                                          <XMRef idref="S4.E11.m1.25.mf.1"/>
                                        </XMApp>
                                      </XMApp>
                                      <XMRef idref="S4.E11.m1.26.mf"/>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMRef idref="S4.E11.m1.27.mf"/>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                        <XMRef idref="S4.E11.m1.28.mf"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                            <XMRef idref="S4.E11.m1.29.mf"/>
                            <XMRef idref="S4.E11.m1.30.mf.1"/>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="delimited-[]"/>
                              <XMRef idref="S4.E11.m2.1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMRef idref="S4.E11.m1.31.mf"/>
                              <XMApp xml:id="S4.E11.m2.1.2">
                                <XMApp role="ADDOP">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMRef idref="S4.E11.m1.51.mf"/>
                                  <XMRef idref="S4.E11.m1.52.mf.1"/>
                                </XMApp>
                                <XMApp>
                                  <XMApp role="ADDOP">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMRef idref="S4.E11.m1.32.mf"/>
                                    <XMRef idref="S4.E11.m1.33.mf.1"/>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMRef idref="S4.E11.m1.34.mf"/>
                                    <XMDual>
                                      <XMApp>
                                        <XMTok meaning="open-interval"/>
                                        <XMRef idref="S4.E11.m2.1.2.1"/>
                                        <XMRef idref="S4.E11.m2.1.2.2"/>
                                      </XMApp>
                                      <XMWrap>
                                        <XMRef idref="S4.E11.m1.35.mf"/>
                                        <XMApp xml:id="S4.E11.m2.1.2.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S4.E11.m1.36.mf"/>
                                          <XMRef idref="S4.E11.m1.37.mf.1"/>
                                        </XMApp>
                                        <XMRef idref="S4.E11.m1.38.mf"/>
                                        <XMApp xml:id="S4.E11.m2.1.2.2">
                                          <XMRef idref="S4.E11.m1.47.mf" meaning="conditional" role="MODIFIEROP"/>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMRef idref="S4.E11.m1.39.mf"/>
                                            <XMDual>
                                              <XMRef idref="S4.E11.m2.1.2.2.1"/>
                                              <XMWrap>
                                                <XMRef idref="S4.E11.m1.40.mf"/>
                                                <XMApp xml:id="S4.E11.m2.1.2.2.1">
                                                  <XMRef idref="S4.E11.m1.43.mf" meaning="conditional" role="MODIFIEROP"/>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                    <XMRef idref="S4.E11.m1.41.mf"/>
                                                    <XMRef idref="S4.E11.m1.42.mf.1"/>
                                                  </XMApp>
                                                  <XMApp>
                                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                    <XMRef idref="S4.E11.m1.44.mf"/>
                                                    <XMRef idref="S4.E11.m1.45.mf.1"/>
                                                  </XMApp>
                                                </XMApp>
                                                <XMRef idref="S4.E11.m1.46.mf"/>
                                              </XMWrap>
                                            </XMDual>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                            <XMRef idref="S4.E11.m1.48.mf"/>
                                            <XMRef idref="S4.E11.m1.49.mf.1"/>
                                          </XMApp>
                                        </XMApp>
                                        <XMRef idref="S4.E11.m1.50.mf"/>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMRef idref="S4.E11.m1.53.mf"/>
                                  <XMDual>
                                    <XMRef idref="S4.E11.m2.1.2.3"/>
                                    <XMWrap>
                                      <XMRef idref="S4.E11.m1.54.mf"/>
                                      <XMApp xml:id="S4.E11.m2.1.2.3">
                                        <XMRef idref="S4.E11.m1.57.mf" meaning="conditional" role="MODIFIEROP"/>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S4.E11.m1.55.mf"/>
                                          <XMRef idref="S4.E11.m1.56.mf.1"/>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMRef idref="S4.E11.m1.58.mf"/>
                                          <XMRef idref="S4.E11.m1.59.mf.1"/>
                                        </XMApp>
                                      </XMApp>
                                      <XMRef idref="S4.E11.m1.60.mf"/>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMRef idref="S4.E11.m1.61.mf"/>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PERIOD"/>
                    </XMWrap>
                  </XMDual>
                  <XMArray colsep="0pt" name="aligned">
                    <XMRow>
                      <XMCell align="right">
                        <XMApp>
                          <XMApp role="ADDOP">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                            <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.1.mf">▽</XMTok>
                            <XMApp xml:id="S4.E11.m1.2.mf.1">
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                              <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                              <XMTok font="italic" fontsize="50%" name="mu" role="UNKNOWN">μ</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok font="caligraphic" role="UNKNOWN" xml:id="S4.E11.m1.3.mf">J</XMTok>
                        </XMApp>
                      </XMCell>
                      <XMCell align="left">
                        <XMApp>
                          <XMTok meaning="approximately-equals" name="approx" role="RELOP" xml:id="S4.E11.m1.4.mf">≈</XMTok>
                          <XMTok meaning="absent"/>
                          <XMApp>
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                              <XMTok font="blackboard" role="UNKNOWN" xml:id="S4.E11.m1.5.mf">E</XMTok>
                              <XMApp xml:id="S4.E11.m1.6.mf.1">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.7.mf">[</XMTok>
                              <XMApp xml:id="S4.E11.m2.2">
                                <XMApp role="ADDOP">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.8.mf">▽</XMTok>
                                  <XMApp xml:id="S4.E11.m1.9.mf.1">
                                    <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                    <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                    <XMTok font="italic" fontsize="50%" name="mu" role="UNKNOWN">μ</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.10.mf">Q</XMTok>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.11.mf">(</XMTok>
                                    <XMApp xml:id="S4.E11.m2.2.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.12.mf">s</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.13.mf.1">t</XMTok>
                                    </XMApp>
                                    <XMTok role="PUNCT" xml:id="S4.E11.m1.14.mf">,</XMTok>
                                    <XMApp xml:id="S4.E11.m2.2.2">
                                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.23.mf">|</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.15.mf">μ</XMTok>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.16.mf">(</XMTok>
                                          <XMApp xml:id="S4.E11.m2.2.2.1">
                                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.19.mf">|</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.17.mf">s</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.18.mf.1">t</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                              <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.20.mf">θ</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.21.mf.1">μ</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.22.mf">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.24.mf">θ</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.25.mf.1">Q</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.26.mf">)</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.27.mf">]</XMTok>
                            </XMWrap>
                          </XMApp>
                        </XMApp>
                      </XMCell>
                    </XMRow>
                    <XMRow>
                      <XMCell/>
                      <XMCell align="left">
                        <XMWrap>
                          <XMApp xml:id="S4.E11.m2.3">
                            <XMTok meaning="equals" role="RELOP" xml:id="S4.E11.m1.28.mf">=</XMTok>
                            <XMTok meaning="absent"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok font="blackboard" role="UNKNOWN" xml:id="S4.E11.m1.29.mf">E</XMTok>
                                <XMApp xml:id="S4.E11.m1.30.mf.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.31.mf">[</XMTok>
                                <XMApp xml:id="S4.E11.m2.3.1">
                                  <XMApp role="ADDOP">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.51.mf">▽</XMTok>
                                    <XMApp xml:id="S4.E11.m1.52.mf.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                      <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                      <XMTok font="italic" fontsize="50%" name="mu" role="UNKNOWN">μ</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMApp role="ADDOP">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.32.mf">▽</XMTok>
                                      <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.33.mf.1">μ</XMTok>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.34.mf">Q</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.35.mf">(</XMTok>
                                        <XMApp xml:id="S4.E11.m2.3.1.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.36.mf">s</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.37.mf.1">t</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT" xml:id="S4.E11.m1.38.mf">,</XMTok>
                                        <XMApp xml:id="S4.E11.m2.3.1.2">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.47.mf">|</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.39.mf">μ</XMTok>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.40.mf">(</XMTok>
                                              <XMApp xml:id="S4.E11.m2.3.1.2.1">
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.43.mf">|</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.41.mf">s</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.42.mf.1">t</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.44.mf">θ</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.45.mf.1">μ</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.46.mf">)</XMTok>
                                            </XMWrap>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                            <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.48.mf">θ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.49.mf.1">Q</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.50.mf">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp>
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.53.mf">μ</XMTok>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.54.mf">(</XMTok>
                                      <XMApp xml:id="S4.E11.m2.3.1.3">
                                        <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.57.mf">|</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.55.mf">s</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.56.mf.1">t</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.58.mf">θ</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.59.mf.1">μ</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.60.mf">)</XMTok>
                                    </XMWrap>
                                  </XMApp>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.61.mf">]</XMTok>
                              </XMWrap>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD" xml:id="S4.E11.m1.62.mf">.</XMTok>
                        </XMWrap>
                      </XMCell>
                    </XMRow>
                  </XMArray>
                </XMDual>
              </XMath>
            </Math>
            <MathBranch>
              <td align="center" colspan="2"><Math mode="inline" tex="\displaystyle\begin{split}\bigtriangledown_{\theta^{\mu}}\mathcal{J}&amp;\approx%&#10;\mathbb{E}_{s_{t}}[\bigtriangledown_{\theta^{\mu}}Q(s_{t},\mu(s_{t}|\theta^{%&#10;\mu})|\theta^{Q})]\\&#10;&amp;=\mathbb{E}_{s_{t}}[\bigtriangledown_{\mu}Q(s_{t},\mu(s_{t}|\theta_{\mu})|%&#10;\theta^{Q})\bigtriangledown_{\theta_{\mu}}\mu(s_{t}|\theta^{\mu})].\end{split}" text="bigtriangledown _ (theta ^ mu) J approximately-equals E _ s _ t * delimited-[]@(bigtriangledown _ (theta ^ mu) Q * open-interval@(s _ t, conditional@(mu * conditional@(s _ t, theta ^ mu), theta ^ Q))) = E _ s _ t * delimited-[]@(bigtriangledown _ mu Q * open-interval@(s _ t, conditional@(mu * conditional@(s _ t, theta _ mu), theta ^ Q)) bigtriangledown _ theta _ mu mu * conditional@(s _ t, theta ^ mu))" xml:id="S4.E11.m1">
                  <XMath>
                    <XMDual>
                      <XMDual>
                        <XMRef idref="S4.E11.m1.63"/>
                        <XMWrap>
                          <XMApp xml:id="S4.E11.m1.63">
                            <XMTok meaning="multirelation"/>
                            <XMApp>
                              <XMApp role="ADDOP">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S4.E11.m1.1"/>
                                <XMRef idref="S4.E11.m1.2.1"/>
                              </XMApp>
                              <XMRef idref="S4.E11.m1.3"/>
                            </XMApp>
                            <XMRef idref="S4.E11.m1.4"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S4.E11.m1.5"/>
                                <XMRef idref="S4.E11.m1.6.1"/>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-[]"/>
                                  <XMRef idref="S4.E11.m1.63.1"/>
                                </XMApp>
                                <XMWrap>
                                  <XMRef idref="S4.E11.m1.7"/>
                                  <XMApp xml:id="S4.E11.m1.63.1">
                                    <XMApp role="ADDOP">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S4.E11.m1.8"/>
                                      <XMRef idref="S4.E11.m1.9.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMRef idref="S4.E11.m1.10"/>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="open-interval"/>
                                          <XMRef idref="S4.E11.m1.63.1.1"/>
                                          <XMRef idref="S4.E11.m1.63.1.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMRef idref="S4.E11.m1.11"/>
                                          <XMApp xml:id="S4.E11.m1.63.1.1">
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                            <XMRef idref="S4.E11.m1.12"/>
                                            <XMRef idref="S4.E11.m1.13.1"/>
                                          </XMApp>
                                          <XMRef idref="S4.E11.m1.14"/>
                                          <XMApp xml:id="S4.E11.m1.63.1.2">
                                            <XMRef idref="S4.E11.m1.23" meaning="conditional" role="MODIFIEROP"/>
                                            <XMApp>
                                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                              <XMRef idref="S4.E11.m1.15"/>
                                              <XMDual>
                                                <XMRef idref="S4.E11.m1.63.1.2.1"/>
                                                <XMWrap>
                                                  <XMRef idref="S4.E11.m1.16"/>
                                                  <XMApp xml:id="S4.E11.m1.63.1.2.1">
                                                    <XMRef idref="S4.E11.m1.19" meaning="conditional" role="MODIFIEROP"/>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                      <XMRef idref="S4.E11.m1.17"/>
                                                      <XMRef idref="S4.E11.m1.18.1"/>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                      <XMRef idref="S4.E11.m1.20"/>
                                                      <XMRef idref="S4.E11.m1.21.1"/>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMRef idref="S4.E11.m1.22"/>
                                                </XMWrap>
                                              </XMDual>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                              <XMRef idref="S4.E11.m1.24"/>
                                              <XMRef idref="S4.E11.m1.25.1"/>
                                            </XMApp>
                                          </XMApp>
                                          <XMRef idref="S4.E11.m1.26"/>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMRef idref="S4.E11.m1.27"/>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                            <XMRef idref="S4.E11.m1.28"/>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMRef idref="S4.E11.m1.29"/>
                                <XMRef idref="S4.E11.m1.30.1"/>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="delimited-[]"/>
                                  <XMRef idref="S4.E11.m1.63.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMRef idref="S4.E11.m1.31"/>
                                  <XMApp xml:id="S4.E11.m1.63.2">
                                    <XMApp role="ADDOP">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMRef idref="S4.E11.m1.51"/>
                                      <XMRef idref="S4.E11.m1.52.1"/>
                                    </XMApp>
                                    <XMApp>
                                      <XMApp role="ADDOP">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMRef idref="S4.E11.m1.32"/>
                                        <XMRef idref="S4.E11.m1.33.1"/>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMRef idref="S4.E11.m1.34"/>
                                        <XMDual>
                                          <XMApp>
                                            <XMTok meaning="open-interval"/>
                                            <XMRef idref="S4.E11.m1.63.2.1"/>
                                            <XMRef idref="S4.E11.m1.63.2.2"/>
                                          </XMApp>
                                          <XMWrap>
                                            <XMRef idref="S4.E11.m1.35"/>
                                            <XMApp xml:id="S4.E11.m1.63.2.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                              <XMRef idref="S4.E11.m1.36"/>
                                              <XMRef idref="S4.E11.m1.37.1"/>
                                            </XMApp>
                                            <XMRef idref="S4.E11.m1.38"/>
                                            <XMApp xml:id="S4.E11.m1.63.2.2">
                                              <XMRef idref="S4.E11.m1.47" meaning="conditional" role="MODIFIEROP"/>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMRef idref="S4.E11.m1.39"/>
                                                <XMDual>
                                                  <XMRef idref="S4.E11.m1.63.2.2.1"/>
                                                  <XMWrap>
                                                    <XMRef idref="S4.E11.m1.40"/>
                                                    <XMApp xml:id="S4.E11.m1.63.2.2.1">
                                                      <XMRef idref="S4.E11.m1.43" meaning="conditional" role="MODIFIEROP"/>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                        <XMRef idref="S4.E11.m1.41"/>
                                                        <XMRef idref="S4.E11.m1.42.1"/>
                                                      </XMApp>
                                                      <XMApp>
                                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                        <XMRef idref="S4.E11.m1.44"/>
                                                        <XMRef idref="S4.E11.m1.45.1"/>
                                                      </XMApp>
                                                    </XMApp>
                                                    <XMRef idref="S4.E11.m1.46"/>
                                                  </XMWrap>
                                                </XMDual>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                <XMRef idref="S4.E11.m1.48"/>
                                                <XMRef idref="S4.E11.m1.49.1"/>
                                              </XMApp>
                                            </XMApp>
                                            <XMRef idref="S4.E11.m1.50"/>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMRef idref="S4.E11.m1.53"/>
                                      <XMDual>
                                        <XMRef idref="S4.E11.m1.63.2.3"/>
                                        <XMWrap>
                                          <XMRef idref="S4.E11.m1.54"/>
                                          <XMApp xml:id="S4.E11.m1.63.2.3">
                                            <XMRef idref="S4.E11.m1.57" meaning="conditional" role="MODIFIEROP"/>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                              <XMRef idref="S4.E11.m1.55"/>
                                              <XMRef idref="S4.E11.m1.56.1"/>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                              <XMRef idref="S4.E11.m1.58"/>
                                              <XMRef idref="S4.E11.m1.59.1"/>
                                            </XMApp>
                                          </XMApp>
                                          <XMRef idref="S4.E11.m1.60"/>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMRef idref="S4.E11.m1.61"/>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PERIOD"/>
                        </XMWrap>
                      </XMDual>
                      <XMArray colsep="0pt" name="aligned">
                        <XMRow>
                          <XMCell align="right">
                            <XMApp>
                              <XMApp role="ADDOP">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.1">▽</XMTok>
                                <XMApp xml:id="S4.E11.m1.2.1">
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                  <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                  <XMTok font="italic" fontsize="50%" name="mu" role="UNKNOWN">μ</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok font="caligraphic" role="UNKNOWN" xml:id="S4.E11.m1.3">J</XMTok>
                            </XMApp>
                          </XMCell>
                          <XMCell align="left">
                            <XMApp>
                              <XMTok meaning="approximately-equals" name="approx" role="RELOP" xml:id="S4.E11.m1.4">≈</XMTok>
                              <XMTok meaning="absent"/>
                              <XMApp>
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                  <XMTok font="blackboard" role="UNKNOWN" xml:id="S4.E11.m1.5">E</XMTok>
                                  <XMApp xml:id="S4.E11.m1.6.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.7">[</XMTok>
                                  <XMApp xml:id="S4.E11.m1.64">
                                    <XMApp role="ADDOP">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                      <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.8">▽</XMTok>
                                      <XMApp xml:id="S4.E11.m1.9.1">
                                        <XMTok role="SUPERSCRIPTOP" scriptpos="post7"/>
                                        <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                        <XMTok font="italic" fontsize="50%" name="mu" role="UNKNOWN">μ</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMApp>
                                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.10">Q</XMTok>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.11">(</XMTok>
                                        <XMApp xml:id="S4.E11.m1.64.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.12">s</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.13.1">t</XMTok>
                                        </XMApp>
                                        <XMTok role="PUNCT" xml:id="S4.E11.m1.14">,</XMTok>
                                        <XMApp xml:id="S4.E11.m1.64.2">
                                          <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.23">|</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.15">μ</XMTok>
                                            <XMWrap>
                                              <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.16">(</XMTok>
                                              <XMApp xml:id="S4.E11.m1.64.2.1">
                                                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.19">|</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                  <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.17">s</XMTok>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.18.1">t</XMTok>
                                                </XMApp>
                                                <XMApp>
                                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.20">θ</XMTok>
                                                  <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.21.1">μ</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.22">)</XMTok>
                                            </XMWrap>
                                          </XMApp>
                                          <XMApp>
                                            <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                            <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.24">θ</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.25.1">Q</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.26">)</XMTok>
                                      </XMWrap>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.27">]</XMTok>
                                </XMWrap>
                              </XMApp>
                            </XMApp>
                          </XMCell>
                        </XMRow>
                        <XMRow>
                          <XMCell/>
                          <XMCell align="left">
                            <XMWrap>
                              <XMApp xml:id="S4.E11.m1.65">
                                <XMTok meaning="equals" role="RELOP" xml:id="S4.E11.m1.28">=</XMTok>
                                <XMTok meaning="absent"/>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                    <XMTok font="blackboard" role="UNKNOWN" xml:id="S4.E11.m1.29">E</XMTok>
                                    <XMApp xml:id="S4.E11.m1.30.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">s</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.31">[</XMTok>
                                    <XMApp xml:id="S4.E11.m1.65.1">
                                      <XMApp role="ADDOP">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                        <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.51">▽</XMTok>
                                        <XMApp xml:id="S4.E11.m1.52.1">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post7"/>
                                          <XMTok font="italic" fontsize="70%" name="theta" role="UNKNOWN">θ</XMTok>
                                          <XMTok font="italic" fontsize="50%" name="mu" role="UNKNOWN">μ</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMApp role="ADDOP">
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                          <XMTok name="bigtriangledown" role="ADDOP" xml:id="S4.E11.m1.32">▽</XMTok>
                                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.33.1">μ</XMTok>
                                        </XMApp>
                                        <XMApp>
                                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                          <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.34">Q</XMTok>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.35">(</XMTok>
                                            <XMApp xml:id="S4.E11.m1.65.1.1">
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.36">s</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.37.1">t</XMTok>
                                            </XMApp>
                                            <XMTok role="PUNCT" xml:id="S4.E11.m1.38">,</XMTok>
                                            <XMApp xml:id="S4.E11.m1.65.1.2">
                                              <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.47">|</XMTok>
                                              <XMApp>
                                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                                <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.39">μ</XMTok>
                                                <XMWrap>
                                                  <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.40">(</XMTok>
                                                  <XMApp xml:id="S4.E11.m1.65.1.2.1">
                                                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.43">|</XMTok>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                      <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.41">s</XMTok>
                                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.42.1">t</XMTok>
                                                    </XMApp>
                                                    <XMApp>
                                                      <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                                      <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.44">θ</XMTok>
                                                      <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.45.1">μ</XMTok>
                                                    </XMApp>
                                                  </XMApp>
                                                  <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.46">)</XMTok>
                                                </XMWrap>
                                              </XMApp>
                                              <XMApp>
                                                <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                                <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.48">θ</XMTok>
                                                <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.49.1">Q</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.50">)</XMTok>
                                          </XMWrap>
                                        </XMApp>
                                      </XMApp>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.53">μ</XMTok>
                                        <XMWrap>
                                          <XMTok role="OPEN" stretchy="false" xml:id="S4.E11.m1.54">(</XMTok>
                                          <XMApp xml:id="S4.E11.m1.65.1.3">
                                            <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false" xml:id="S4.E11.m1.57">|</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post6"/>
                                              <XMTok font="italic" role="UNKNOWN" xml:id="S4.E11.m1.55">s</XMTok>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S4.E11.m1.56.1">t</XMTok>
                                            </XMApp>
                                            <XMApp>
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post6"/>
                                              <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S4.E11.m1.58">θ</XMTok>
                                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN" xml:id="S4.E11.m1.59.1">μ</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.60">)</XMTok>
                                        </XMWrap>
                                      </XMApp>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false" xml:id="S4.E11.m1.61">]</XMTok>
                                  </XMWrap>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PERIOD" xml:id="S4.E11.m1.62">.</XMTok>
                            </XMWrap>
                          </XMCell>
                        </XMRow>
                      </XMArray>
                    </XMDual>
                  </XMath>
                </Math></td>
            </MathBranch>
          </MathFork>
        </equation>
      </equationgroup>
      <p>To learn the non-linear function approximators in a stable manner, DDPG uses two corresponding target networks to update slowly:</p>
      <equationgroup class="ltx_eqn_align" xml:id="Sx1.EGx5">
        <equation labels="LABEL:label:eqn12" xml:id="S4.E12">
          <tags>
            <tag>(12)</tag>
            <tag role="autoref">Equation 12</tag>
            <tag role="refnum">12</tag>
          </tags>
          <MathFork>
            <Math tex="\displaystyle\theta^{Q^{\prime}}\leftarrow\tau\theta^{Q}+(1-\tau)\theta^{Q^{%&#10;\prime}}," text="theta ^ Q ^ prime leftarrow tau * theta ^ Q + (1 - tau) * theta ^ Q ^ prime" xml:id="S4.E12.m2">
              <XMath>
                <XMDual>
                  <XMRef idref="S4.E12.m2.1"/>
                  <XMWrap>
                    <XMApp xml:id="S4.E12.m2.1">
                      <XMTok name="leftarrow" role="ARROW">←</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMRef idref="S4.E12.m2.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S4.E12.m2.1.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
            <MathBranch>
              <td align="right"><Math mode="inline" tex="\displaystyle\theta^{Q^{\prime}}\leftarrow\tau\theta^{Q}+(1-\tau)\theta^{Q^{%&#10;\prime}}," text="theta ^ Q ^ prime leftarrow tau * theta ^ Q + (1 - tau) * theta ^ Q ^ prime" xml:id="S4.E12.m1">
                  <XMath>
                    <XMDual>
                      <XMRef idref="S4.E12.m1.1"/>
                      <XMWrap>
                        <XMApp xml:id="S4.E12.m1.1">
                          <XMTok name="leftarrow" role="ARROW">←</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMRef idref="S4.E12.m1.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E12.m1.1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">Q</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math></td>
            </MathBranch>
          </MathFork>
        </equation>
        <equation labels="LABEL:label:eqn13" xml:id="S4.E13">
          <tags>
            <tag>(13)</tag>
            <tag role="autoref">Equation 13</tag>
            <tag role="refnum">13</tag>
          </tags>
          <MathFork>
            <Math tex="\displaystyle\theta^{\mu^{\prime}}\leftarrow\tau\theta^{\mu}+(1-\tau)\theta^{%&#10;\mu^{\prime}}," text="theta ^ mu ^ prime leftarrow tau * theta ^ mu + (1 - tau) * theta ^ mu ^ prime" xml:id="S4.E13.m2">
              <XMath>
                <XMDual>
                  <XMRef idref="S4.E13.m2.1"/>
                  <XMWrap>
                    <XMApp xml:id="S4.E13.m2.1">
                      <XMTok name="leftarrow" role="ARROW">←</XMTok>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp>
                        <XMTok meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMDual>
                            <XMRef idref="S4.E13.m2.1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S4.E13.m2.1.1">
                                <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                <XMTok meaning="1" role="NUMBER">1</XMTok>
                                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                  </XMWrap>
                </XMDual>
              </XMath>
            </Math>
            <MathBranch>
              <td align="right"><Math mode="inline" tex="\displaystyle\theta^{\mu^{\prime}}\leftarrow\tau\theta^{\mu}+(1-\tau)\theta^{%&#10;\mu^{\prime}}," text="theta ^ mu ^ prime leftarrow tau * theta ^ mu + (1 - tau) * theta ^ mu ^ prime" xml:id="S4.E13.m1">
                  <XMath>
                    <XMDual>
                      <XMRef idref="S4.E13.m1.1"/>
                      <XMWrap>
                        <XMApp xml:id="S4.E13.m1.1">
                          <XMTok name="leftarrow" role="ARROW">←</XMTok>
                          <XMApp>
                            <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp>
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMDual>
                                <XMRef idref="S4.E13.m1.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S4.E13.m1.1.1">
                                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                                    <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                              <XMApp>
                                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" name="mu" role="UNKNOWN">μ</XMTok>
                                  <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                </XMApp>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMath>
                </Math></td>
            </MathBranch>
          </MathFork>
        </equation>
      </equationgroup>
      <p>where <Math mode="inline" tex="\tau\in(0,1]" text="tau element-of open-closed-interval@(0, 1)" xml:id="S4.p3.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="open-closed-interval"/>
                  <XMRef idref="S4.p3.m1.1"/>
                  <XMRef idref="S4.p3.m1.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S4.p3.m1.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S4.p3.m1.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="Q^{\prime}" text="Q ^ prime" xml:id="S4.p3.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">Q</XMTok>
              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
            </XMApp>
          </XMath>
        </Math> and <Math mode="inline" tex="\mu^{\prime}" text="mu ^ prime" xml:id="S4.p3.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" name="mu" role="UNKNOWN">μ</XMTok>
              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
            </XMApp>
          </XMath>
        </Math> are the target critic network and target actor network, respectively. DDPG maintains an experience replay buffer. For each training step, the critic and the actor are updated by using a randomly sampled batch of transitions from the buffer.</p>
    </para>
    <para xml:id="S4.p4">
      <p>To apply ERO framework to DDPG, we first sample a subset of the transitions from the buffer according to the replay policy, and then feed this subset of transitions to DDPG algorithm. The ERO enhanced DDPG is summarized in Algorithm <ref labelref="LABEL:label:alg1"/>, where Line 20 updates the transition priority scores with the replay policy, and Algorithm <ref labelref="LABEL:label:alg2"/> serves for replay learning purpose.</p>
    </para>
    <figure inlist="lof" labels="LABEL:label:performance" xml:id="S4.F2">
      <tags>
        <tag><text fontsize="90%">Figure 2</text></tag>
        <tag role="autoref">Figure 2</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Figure 2</tag>
      </tags>
      <figure align="center" class="ltx_figure_panel" placement="b" xml:id="S4.F2.fig1">
        <graphics candidates="legend.pdf" graphic="legend.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.g1"/>
      </figure>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf1">
        <tags>
          <tag><text fontsize="90%">(a)</text></tag>
          <tag role="autoref">2(a)</tag>
          <tag role="refnum">2(a)</tag>
        </tags>
        <graphics candidates="HalfCheetah-v2.pdf" graphic="HalfCheetah-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf1.g1"/>
        <toccaption><tag close=" ">(a)</tag>HalfCheetah</toccaption>
        <caption><tag close=" "><text fontsize="90%">(a)</text></tag><text fontsize="90%">HalfCheetah</text></caption>
      </figure>
      <break class="ltx_break"/>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf2">
        <tags>
          <tag><text fontsize="90%">(b)</text></tag>
          <tag role="autoref">2(b)</tag>
          <tag role="refnum">2(b)</tag>
        </tags>
        <graphics candidates="InvertedPendulum-v2.pdf" graphic="InvertedPendulum-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf2.g1"/>
        <toccaption><tag close=" ">(b)</tag>InvertedPendulum</toccaption>
        <caption><tag close=" "><text fontsize="90%">(b)</text></tag><text fontsize="90%">InvertedPendulum</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf3">
        <tags>
          <tag><text fontsize="90%">(c)</text></tag>
          <tag role="autoref">2(c)</tag>
          <tag role="refnum">2(c)</tag>
        </tags>
        <graphics candidates="InvertedDoublePendulum-v2.pdf" graphic="InvertedDoublePendulum-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf3.g1"/>
        <toccaption><tag close=" ">(c)</tag>InvertedDoublePendulum</toccaption>
        <caption><tag close=" "><text fontsize="90%">(c)</text></tag><text fontsize="90%">InvertedDoublePendulum</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf4">
        <tags>
          <tag><text fontsize="90%">(d)</text></tag>
          <tag role="autoref">2(d)</tag>
          <tag role="refnum">2(d)</tag>
        </tags>
        <graphics candidates="Reacher-v2.pdf" graphic="Reacher-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf4.g1"/>
        <toccaption><tag close=" ">(d)</tag>Reacher</toccaption>
        <caption><tag close=" "><text fontsize="90%">(d)</text></tag><text fontsize="90%">Reacher</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf5">
        <tags>
          <tag><text fontsize="90%">(e)</text></tag>
          <tag role="autoref">2(e)</tag>
          <tag role="refnum">2(e)</tag>
        </tags>
        <graphics candidates="Hopper-v2.pdf" graphic="Hopper-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf5.g1"/>
        <toccaption><tag close=" ">(e)</tag>Hopper</toccaption>
        <caption><tag close=" "><text fontsize="90%">(e)</text></tag><text fontsize="90%">Hopper</text></caption>
      </figure>
      <break class="ltx_break"/>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf6">
        <tags>
          <tag><text fontsize="90%">(f)</text></tag>
          <tag role="autoref">2(f)</tag>
          <tag role="refnum">2(f)</tag>
        </tags>
        <graphics candidates="Pendulum-v0.pdf" graphic="Pendulum-v0.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf6.g1"/>
        <toccaption><tag close=" ">(f)</tag>Pendulum</toccaption>
        <caption><tag close=" "><text fontsize="90%">(f)</text></tag><text fontsize="90%">Pendulum</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf7">
        <tags>
          <tag><text fontsize="90%">(g)</text></tag>
          <tag role="autoref">2(g)</tag>
          <tag role="refnum">2(g)</tag>
        </tags>
        <graphics candidates="Humanoid-v2.pdf" graphic="Humanoid-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf7.g1"/>
        <toccaption><tag close=" ">(g)</tag>Humanoid</toccaption>
        <caption><tag close=" "><text fontsize="90%">(g)</text></tag><text fontsize="90%">Humanoid</text></caption>
      </figure>
      <figure align="center" class="ltx_figure_panel" inlist="lof" placement="b" xml:id="S4.F2.sf8">
        <tags>
          <tag><text fontsize="90%">(h)</text></tag>
          <tag role="autoref">2(h)</tag>
          <tag role="refnum">2(h)</tag>
        </tags>
        <graphics candidates="HumanoidStandup-v2.pdf" graphic="HumanoidStandup-v2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S4.F2.sf8.g1"/>
        <toccaption><tag close=" ">(h)</tag>HumanoidStandup</toccaption>
        <caption><tag close=" "><text fontsize="90%">(h)</text></tag><text fontsize="90%">HumanoidStandup</text></caption>
      </figure>
      <toccaption class="ltx_centering"><tag close=" ">2</tag>Performance comparison of ERO against baselines on 8 continuous control tasks. The shaded area represents mean <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.F2.m1">
          <XMath>
            <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
          </XMath>
        </Math> standard deviation. ERO outperforms baselines on most of the continuous control tasks.</toccaption>
      <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 2</text></tag><text fontsize="90%">Performance comparison of ERO against baselines on 8 continuous control tasks. The shaded area represents mean <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.F2.m2">
            <XMath>
              <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
            </XMath>
          </Math> standard deviation. ERO outperforms baselines on most of the continuous control tasks.</text></caption>
    </figure>
  </section>
  <section inlist="toc" labels="LABEL:label:sec_exp" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Experiments</title>
    <para xml:id="S5.p1">
      <p><!--  %**** main.tex Line 325 **** -->In this section, we conduct experiments to evaluate ERO. We mainly focus on the following questions: <text font="bold">Q1:</text> How effective and efficient is our ERO compared with the uniform replay strategy as well as the rule-based alternatives? <text font="bold">Q2:</text> What kind of transitions could be beneficial based on the learned replay policy?</p>
    </para>
    <subsection inlist="toc" xml:id="S5.SS1">
      <tags>
        <tag>5.1</tag>
        <tag role="autoref">subsection 5.1</tag>
        <tag role="refnum">5.1</tag>
        <tag role="typerefnum">§5.1</tag>
      </tags>
      <title><tag close=" ">5.1</tag>Experimental Setting</title>
      <para xml:id="S5.SS1.p1">
        <p>Our experiments are conducted on the following continuous control tasks from OpenAI Gym<note mark="3" role="footnote" xml:id="footnote3"><tags>
              <tag>3</tag>
              <tag role="autoref">footnote 3</tag>
              <tag role="refnum">3</tag>
              <tag role="typerefnum">footnote 3</tag>
            </tags>https://gym.openai.com/</note>: HalfCheetah-v2, InvertedDoublePendulum-v2, Hopper-v2, InvertedPendulum-v2, HumanoidStandup-v2, Reacher-v2, Humanoid-v2, Pendulum-v0 <cite class="ltx_citemacro_cite"><bibref bibrefs="todorov2012mujoco,brockman2016openai" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. We apply ERO to the benchmark off-policy algorithm DDPG <cite class="ltx_citemacro_cite"><bibref bibrefs="lillicrap2016continuous" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> for the evaluation purpose. Our ERO is compared against the following baselines:</p>
        <itemize xml:id="S5.I1">
          <item xml:id="S5.I1.i1">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">1st item</tag>
            </tags>
            <para xml:id="S5.I1.i1.p1">
              <p><text font="bold">Vanilla-DDPG:</text> DDPG with uniform sampling.</p>
            </para>
          </item>
          <item xml:id="S5.I1.i2">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">2nd item</tag>
            </tags>
            <para xml:id="S5.I1.i2.p1">
              <p><text font="bold">PER-<emph font="italic">prop</emph>:</text> Proportional prioritized experience replay <cite class="ltx_citemacro_cite"><bibref bibrefs="schaul2016prioritized" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                    <bibrefphrase>(</bibrefphrase>
                    <bibrefphrase>)</bibrefphrase>
                  </bibref></cite>, which prioritizes transitions with high temporal difference errors with rules.</p>
            </para>
          </item>
          <item xml:id="S5.I1.i3">
            <tags>
              <tag>•</tag>
              <tag role="autoref">item </tag>
              <tag role="typerefnum">3rd item</tag>
            </tags>
            <para xml:id="S5.I1.i3.p1">
              <p><text font="bold">PER-<emph font="italic">rank</emph>:</text> Rank-based prioritized experience replay <cite class="ltx_citemacro_cite"><bibref bibrefs="schaul2016prioritized" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
                    <bibrefphrase>(</bibrefphrase>
                    <bibrefphrase>)</bibrefphrase>
                  </bibref></cite>, a variant of PER-<emph font="italic">prop</emph> which adopts a binary heap for the ranking purpose.</p>
            </para>
          </item>
        </itemize>
        <p>For a fair comparison, PER-<emph font="italic">prop</emph>, PER-<emph font="italic">rank</emph> and ERO are all implemented on the identical Vanilla-DDPG.</p>
      </para>
      <para class="ltx_noindent" xml:id="S5.SS1.p2">
        <p><text font="bold">Implementation details </text> Our implementations are based on OpenAI DDPG baseline <note mark="4" role="footnote" xml:id="footnote4"><tags>
              <tag>4</tag>
              <tag role="autoref">footnote 4</tag>
              <tag role="refnum">4</tag>
              <tag role="typerefnum">footnote 4</tag>
            </tags>https://github.com/openai/baselines</note>. For Vanilla-DDPG, we follow all the settings described as in the original work <cite class="ltx_citemacro_cite"><bibref bibrefs="lillicrap2016continuous" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. Specifically, <Math mode="inline" tex="\tau=0.001" text="tau = 0.001" xml:id="S5.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="tau" role="UNKNOWN">τ</XMTok>
                <XMTok meaning="0.001" role="NUMBER">0.001</XMTok>
              </XMApp>
            </XMath>
          </Math> is used for soft target updates, learning rates of <Math mode="inline" tex="10^{-4}" text="10 ^ (- 4)" xml:id="S5.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="10^{-3}" text="10 ^ (- 3)" xml:id="S5.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> are adopted for actor and critic respectively, the Ornstein-Uhlenbeck noise with <Math mode="inline" tex="\theta=0.15" text="theta = 0.15" xml:id="S5.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="theta" role="UNKNOWN">θ</XMTok>
                <XMTok meaning="0.15" role="NUMBER">0.15</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\sigma=0.2" text="sigma = 0.2" xml:id="S5.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="italic" name="sigma" role="UNKNOWN">σ</XMTok>
                <XMTok meaning="0.2" role="NUMBER">0.2</XMTok>
              </XMApp>
            </XMath>
          </Math> is used for exploration, the mini-batch size is <Math mode="inline" tex="64" text="64" xml:id="S5.SS1.p2.m6">
            <XMath>
              <XMTok meaning="64" role="NUMBER">64</XMTok>
            </XMath>
          </Math>, the replay buffer size is <Math mode="inline" tex="10^{6}" text="10 ^ 6" xml:id="S5.SS1.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
              </XMApp>
            </XMath>
          </Math>, the number of rollout steps is <Math mode="inline" tex="100" text="100" xml:id="S5.SS1.p2.m8">
            <XMath>
              <XMTok meaning="100" role="NUMBER">100</XMTok>
            </XMath>
          </Math>, and the number of training steps is <Math mode="inline" tex="50" text="50" xml:id="S5.SS1.p2.m9">
            <XMath>
              <XMTok meaning="50" role="NUMBER">50</XMTok>
            </XMath>
          </Math>. For other hyperparameters and the network architecture, we use the default setting as in the OpenAI baseline. For the two prioritized experience replay methods PER-<emph font="italic">prop</emph> and PER-<emph font="italic">rank</emph>, we search the combinations of <Math mode="inline" tex="\alpha" text="alpha" xml:id="S5.SS1.p2.m10">
            <XMath>
              <XMTok font="italic" name="alpha" role="UNKNOWN">α</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="\beta" text="beta" xml:id="S5.SS1.p2.m11">
            <XMath>
              <XMTok font="italic" name="beta" role="UNKNOWN">β</XMTok>
            </XMath>
          </Math> and report the best results. For our ERO, we empirically use three features for each transition: the reward of the transition, the temporal difference (TD) error, and the current timestep. TD error is updated only when a transition is replayed. We implement the replay policy by using MLP with two hidden layers (64-64). The number of replay updating steps is set to <Math mode="inline" tex="1" text="1" xml:id="S5.SS1.p2.m12">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> with mini-batch size 64. Adam optimizer is used with a learning rate of <Math mode="inline" tex="10^{-4}" text="10 ^ (- 4)" xml:id="S5.SS1.p2.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok meaning="10" role="NUMBER">10</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Our experiments are performed on a server with 24 Intel(R) Xeon(R) CPU E5-2650 v4 @ 2.2GHz processors and 4 GeForce GTX-1080 Ti 12 GB GPU.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S5.SS2">
      <tags>
        <tag>5.2</tag>
        <tag role="autoref">subsection 5.2</tag>
        <tag role="refnum">5.2</tag>
        <tag role="typerefnum">§5.2</tag>
      </tags>
      <title><tag close=" ">5.2</tag>Performance Comparison</title>
      <para xml:id="S5.SS2.p1">
        <p>The learning curves on 8 classical control tasks are shown in Figure <ref labelref="LABEL:label:performance"/>. Each task is run for <Math mode="inline" tex="5" text="5" xml:id="S5.SS2.p1.m1">
            <XMath>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMath>
          </Math> times with <Math mode="inline" tex="2\times 10^{6}" text="2 * 10 ^ 6" xml:id="S5.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> timesteps using different random seeds, and the average return over episodes is reported. We make the following observations.</p>
      </para>
      <para xml:id="S5.SS2.p2">
        <p>First, the proposed ERO consistently outperforms all the baselines on most of the continuous control tasks in terms of sample efficiency. On HalfCheetah, InvertedPendulum, and InvertedDoublePendulum, ERO performs clearly better than Vanilla-DDPG. On Hopper, Pendulum, and Humanmoid, faster learning speed with a higher return is observed. The intuition of our superior performance on various environments is that the replay policy of ERO is updated to replay the most suitable transitions during training. This also demonstrates that exploiting the improvement of the policy as a reward to update the replay policy is promising.</p>
      </para>
      <para xml:id="S5.SS2.p3">
        <p>Second, rule-based prioritized replay strategies do not provide clear benefits to DDPG on the <Math mode="inline" tex="8" text="8" xml:id="S5.SS2.p3.m1">
            <XMath>
              <XMTok meaning="8" role="NUMBER">8</XMTok>
            </XMath>
          </Math> continuous control tasks, which can also be verified from the results in <cite class="ltx_citemacro_cite"><bibref bibrefs="novati2018remember" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. Specifically, PER-<emph font="italic">prop</emph> only provides a very slight improvement on <Math mode="inline" tex="5" text="5" xml:id="S5.SS2.p3.m2">
            <XMath>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMath>
          </Math> out of <Math mode="inline" tex="8" text="8" xml:id="S5.SS2.p3.m3">
            <XMath>
              <XMTok meaning="8" role="NUMBER">8</XMTok>
            </XMath>
          </Math> tasks, and shows no clear improvement on the others. An interesting observation is that PER-<emph font="italic">rank</emph> even worsens the performance on <Math mode="inline" tex="4" text="4" xml:id="S5.SS2.p3.m4">
            <XMath>
              <XMTok meaning="4" role="NUMBER">4</XMTok>
            </XMath>
          </Math> out of <Math mode="inline" tex="8" text="8" xml:id="S5.SS2.p3.m5">
            <XMath>
              <XMTok meaning="8" role="NUMBER">8</XMTok>
            </XMath>
          </Math> continuous control tasks. A possible explanation is that the rank-based prioritization samples transitions based on a power-law distribution. When the buffer size is large, the transitions near the tail are barely selected, which may lead to significant bias in the learning process<note mark="5" role="footnote" xml:id="footnote5"><tags>
              <tag>5</tag>
              <tag role="autoref">footnote 5</tag>
              <tag role="refnum">5</tag>
              <tag role="typerefnum">footnote 5</tag>
            </tags>We have tuned the hyperparameters of the importance sampling trying to correct the potential bias, but we did not observe better performance.</note>. Recall that the two rule-based strategies prioritize the transitions with high temporal difference (TD) errors. A potential concern is that a transition with high TD error may substantially deviate from the current policy, hence introducing noise to the training, especially in the later training stages when the agent focuses on a preferred state space. This may partly explain why the two PER methods do not show significant improvement over Vanilla-DDPG. The results further suggest that rule-based replay strategies may be sensitive to different agents or environments. By contrary, the replay policy of ERO is updated based on the feedback from the environment, and consistent improvement is observed in various tasks.</p>
      </para>
      <para class="ltx_noindent" xml:id="S5.SS2.p4">
        <p><text font="bold">Comparison of running time </text> Table <ref labelref="LABEL:label:time"/> shows the average running time in seconds of ERO enhanced DDPG and Vanilla-DDPG on the 8 continuous control tasks for <Math mode="inline" tex="2\times 10^{6}" text="2 * 10 ^ 6" xml:id="S5.SS2.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">×</XMTok>
                <XMTok meaning="2" role="NUMBER">2</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok meaning="10" role="NUMBER">10</XMTok>
                  <XMTok fontsize="70%" meaning="6" role="NUMBER">6</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> timesteps. We observe that ERO requires slightly more running time than Vanilla-DDPG. It is expected because ERO requires additional computation for replay policy update. Note that the interactions with the environment usually dominate the cost of RL algorithms. In practice, the slightly more computational resources of ERO, which are often much cheaper than the interactions with the environment, are greatly outweighed by the sample efficiency it provides.</p>
      </para>
      <figure inlist="lof" labels="LABEL:label:time" placement="t" xml:id="S5.F3">
        <tags>
          <tag><text fontsize="90%">Figure 3</text></tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <graphics candidates="time.pdf" class="ltx_centering" graphic="time.pdf" options="width=195.12767pt,keepaspectratio=true" xml:id="S5.F3.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>Comparison of running time in seconds for ERO and Vanilla-DDPG. ERO requires only slightly more running time compared with Vanilla-DDPG.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 3</text></tag><text fontsize="90%">Comparison of running time in seconds for ERO and Vanilla-DDPG. ERO requires only slightly more running time compared with Vanilla-DDPG.</text></caption>
      </figure>
      <figure inlist="lof" labels="LABEL:label:transition" placement="t" xml:id="S5.F4">
        <tags>
          <tag><text fontsize="90%">Figure 4</text></tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <figure align="center" class="ltx_figure_panel" placement="b" xml:id="S5.F4.fig1">
          <graphics candidates="legend2.pdf" graphic="legend2.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.g1"/>
        </figure>
        <figure align="center" class="ltx_figure_panel" placement="b" xml:id="S5.F4.fig2">
          <graphics candidates="td.pdf" graphic="td.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.g2"/>
        </figure>
<!--  %“caption–temporal difference error˝ -->        <break class="ltx_break"/>
        <figure align="center" class="ltx_figure_panel" placement="b" xml:id="S5.F4.fig3">
          <graphics candidates="timestep.pdf" graphic="timestep.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.g3"/>
        </figure>
<!--  %“caption–timestep difference˝ 
     %**** main.tex Line 375 **** -->        <figure align="center" class="ltx_figure_panel" placement="b" xml:id="S5.F4.fig4">
          <graphics candidates="reward.pdf" graphic="reward.pdf" options="width=433.62pt,keepaspectratio=true" xml:id="S5.F4.g4"/>
        </figure>
<!--  %“caption–reward˝ -->        <toccaption class="ltx_centering"><tag close=" ">4</tag>The evolution of TD error (top), timestep difference (middle), and reward of the transition (bottom) with respect to timestep. Timestep difference is the difference between the training timestep and the timestep at which the transition is obtained (that is, low timestep difference means that the agent tends to use recent transitions for the updates). The average values over transitions are plotted for clearer visualization.</toccaption>
        <caption class="ltx_centering"><tag close=": "><text fontsize="90%">Figure 4</text></tag><text fontsize="90%">The evolution of TD error (top), timestep difference (middle), and reward of the transition (bottom) with respect to timestep. Timestep difference is the difference between the training timestep and the timestep at which the transition is obtained (that is, low timestep difference means that the agent tends to use recent transitions for the updates). The average values over transitions are plotted for clearer visualization.</text></caption>
      </figure>
    </subsection>
    <subsection inlist="toc" xml:id="S5.SS3">
      <tags>
        <tag>5.3</tag>
        <tag role="autoref">subsection 5.3</tag>
        <tag role="refnum">5.3</tag>
        <tag role="typerefnum">§5.3</tag>
      </tags>
      <title><tag close=" ">5.3</tag>Analysis of the Sampled Transitions</title>
      <para xml:id="S5.SS3.p1">
        <p>For further understanding the learned replay policy, we record the transition features through the entire training process of one trial on HalfCheetah to analyze the characteristics of the sampled transitions. Figure <ref labelref="LABEL:label:transition"/> plots the average values for the three features: temporal difference (TD) error, timestep difference between the training timestep and the timestep at which the transition is obtained, and reward of the transition. We may empirically find some insights of the replay policy.</p>
      </para>
      <para xml:id="S5.SS3.p2">
        <p>As expected, PER-<emph font="italic">prop</emph> tends to sample transitions with high TD errors. Interestingly, the learned replay policy of ERO samples more transitions with low TD errors, which are even lower than Vanilla-DDPG. It contradicts to our belief that the transitions with low TD errors are well-known by the agent, which could cause catastrophic forgetting problem. It also contradicts to the central idea of prioritized replay which prioritizes “unexpected” transitions. We hypothesize this task may not necessarily contain catastrophic states, and the transitions with slightly low TD errors may align better with the current policy and could be more suitable for training in this specific task. The unsatisfactory performance of PER methods also suggests that prioritizing transions with high TD errors may not help in this task. We believe more studies are needed to understand this aspect in the future work. We observe that both PER-<emph font="italic">prop</emph> and ERO sample more recent transitions than Vanilla-DDPG. This is also expected for PER-<emph font="italic">prop</emph>, because newly added transitions usually have higher TD errors. Although ERO tends to sample transitions with low TD errors, it also favors recent transitions. This suggests that recent transitions may be more helpful in this specific task. For the transition reward, all the three methods tend to sample transitions with higher rewards as timestep increases. It is reasonable since more transitions with higher rewards are stored into the buffer in the later training stages.</p>
      </para>
      <para xml:id="S5.SS3.p3">
        <p>Overall, we find that it is nontrivial to heuristically use rules to define a proper replay strategy, which may depend on a lot of factors from both the algorithm and the environment. A simple rule may not be able to identify the most useful transitions and could be sensitive to different tasks or different reinforcement learning algorithms. For example, the prioritized experience replay shows no clear benefit to DDPG on the above continuous control tasks from OpenAI gym. A learning-based replay policy will be more desirable because it is optimized based on different tasks and algorithms.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S6">
    <tags>
      <tag>6</tag>
      <tag role="autoref">section 6</tag>
      <tag role="refnum">6</tag>
      <tag role="typerefnum">§6</tag>
    </tags>
    <title><tag close=" ">6</tag>Discussion and Extension</title>
    <para xml:id="S6.p1">
      <p>Replay learning can be regarded as a kind of meta-learning. There are several analogous studies in the context of RL: learning to generate data for exploration <cite class="ltx_citemacro_cite"><bibref bibrefs="xu2018learning" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>, learning intrinsic reward to maximize the extrinsic reward on the environment <cite class="ltx_citemacro_cite"><bibref bibrefs="zheng2018learning" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>, adapting discount factor <cite class="ltx_citemacro_cite"><bibref bibrefs="xu2018meta" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. Different from these studies, we focus on how reinforcement learning agents can benefit from learning-based replay policy.</p>
    </para>
    <para xml:id="S6.p2">
      <p>Our ERO can also be viewed as a teacher-student framework, where the replay policy (teacher) provides past experiences to the agent (student) for training. Our work has similarity to learning a teaching strategy in the context of supervised learning <cite class="ltx_citemacro_cite"><bibref bibrefs="fan2018learning,wu2018learning" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. However, replay learning differs from teaching a supervised classifier. It is much more challenging due to the large and noisy replay memory, and the unstable learning signal. Our framework could be extended to teach the agent when to remember/forget experiences, or what buffer size to adopt.</p>
    </para>
    <para xml:id="S6.p3">
      <p>ERO could potentially motivate the research of continual (lifelong) learning. Experience replay is shown to effectively transfer knowledge and mitigate forgetting <cite class="ltx_citemacro_cite"><bibref bibrefs="yin2017knowledge,isele2018selective" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. While existing studies selectively store/replay experiences with rules, it is possible to extend ERO to a learning-based experience replay in the context of continual learning.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S7">
    <tags>
      <tag>7</tag>
      <tag role="autoref">section 7</tag>
      <tag role="refnum">7</tag>
      <tag role="typerefnum">§7</tag>
    </tags>
    <title><tag close=" ">7</tag>Conclusion and Future Work</title>
    <para xml:id="S7.p1">
      <p>In this paper, we identify the problem of experience replay learning for off-policy algorithms. We introduce a simple and general framework ERO, which efficiently replays the useful experiences to accelerate the learning process. We develop an instance of our framework by applying it to DDPG. Experimental results suggest that ERO consistently improves the sample efficiency compared with Vanilla-DDPG and rule-based strategies. While more studies are needed to understand experience replay, we believe our results empirically show that it is promising to learn experience replay for off-policy algorithms. The direct future work is to extend our framework to learn which transitions should be stored/removed from the buffer and how we can adjust the buffer size in different training stages. We are also interested in studying learning-based experience replay in the context of continual learning. We will investigate the effectiveness of more features, such as signals from the agent, to study which features are important. Finally, since our framework is general, we would like to test it on other off-policy algorithms.</p>
    </para>
  </section>
  <section xml:id="Sx1">
    <title>Acknowledgements</title>
    <para xml:id="Sx1.p1">
      <p>This work is, in part, supported by NSF (#IIS-1718840 and #IIS-1750074). The views and conclusions contained in this paper are those of the authors and should not be interpreted as representing any funding agencies.</p>
    </para>
  </section>
  <bibliography xml:id="bib">
    <title>References</title>
    <biblist>
      <bibitem key="andrychowicz2017hindsight" xml:id="bib.bib1">
        <tags>
          <tag role="number">1</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Andrychowicz <text font="italic">et al.</text></tag>
          <tag role="refnum">Andrychowicz <text font="italic">et al.</text> [2017]</tag>
          <tag role="key">andrychowicz2017hindsight</tag>
        </tags>
        <bibblock>
Marcin Andrychowicz, Filip Wolski, Alex Ray, Jonas Schneider, Rachel Fong,
Peter Welinder, Bob McGrew, Josh Tobin, OpenAI Pieter Abbeel, and Wojciech
Zaremba.
</bibblock>
        <bibblock>Hindsight experience replay.
</bibblock>
        <bibblock>In <text font="italic">NeurIPS</text>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="brockman2016openai" xml:id="bib.bib2">
        <tags>
          <tag role="number">2</tag>
          <tag role="year">2016</tag>
          <tag role="authors">Brockman <text font="italic">et al.</text></tag>
          <tag role="refnum">Brockman <text font="italic">et al.</text> [2016]</tag>
          <tag role="key">brockman2016openai</tag>
        </tags>
        <bibblock>
Greg Brockman, Vicki Cheung, Ludwig Pettersson, Jonas Schneider, John Schulman,
Jie Tang, and Wojciech Zaremba.
</bibblock>
        <bibblock>Openai gym.
</bibblock>
        <bibblock><text font="italic">arXiv preprint arXiv:1606.01540</text>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="fan2018learning" xml:id="bib.bib3">
        <tags>
          <tag role="number">3</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Fan <text font="italic">et al.</text></tag>
          <tag role="refnum">Fan <text font="italic">et al.</text> [2018]</tag>
          <tag role="key">fan2018learning</tag>
        </tags>
        <bibblock>
Yang Fan, Fei Tian, Tao Qin, Xiang-Yang Li, and Tie-Yan Liu.
</bibblock>
        <bibblock>Learning to teach.
</bibblock>
        <bibblock>In <text font="italic">ICLR</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="hessel2018rainbow" xml:id="bib.bib4">
        <tags>
          <tag role="number">4</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Hessel <text font="italic">et al.</text></tag>
          <tag role="refnum"><!--  %**** main.bbl Line 25 **** -->Hessel <text font="italic">et al.</text><!--  %**** main.bbl Line 25 **** --> [2018]</tag>
          <tag role="key">hessel2018rainbow</tag>
        </tags>
        <bibblock>
Matteo Hessel, Joseph Modayil, Hado Van Hasselt, Tom Schaul, Georg Ostrovski,
Will Dabney, Dan Horgan, Bilal Piot, Mohammad Azar, and David Silver.
</bibblock>
        <bibblock>Rainbow: Combining improvements in deep reinforcement learning.
</bibblock>
        <bibblock>In <text font="italic">AAAI</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="isele2018selective" xml:id="bib.bib5">
        <tags>
          <tag role="number">5</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Isele and Cosgun</tag>
          <tag role="refnum">Isele and Cosgun [2018]</tag>
          <tag role="key">isele2018selective</tag>
        </tags>
        <bibblock>
David Isele and Akansel Cosgun.
</bibblock>
        <bibblock>Selective experience replay for lifelong learning.
</bibblock>
        <bibblock>In <text font="italic">AAAI</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="lillicrap2016continuous" xml:id="bib.bib6">
        <tags>
          <tag role="number">6</tag>
          <tag role="year">2016</tag>
          <tag role="authors">Lillicrap <text font="italic">et al.</text></tag>
          <tag role="refnum">Lillicrap <text font="italic">et al.</text> [2016]</tag>
          <tag role="key">lillicrap2016continuous</tag>
        </tags>
        <bibblock>
Timothy P Lillicrap, Jonathan J Hunt, Alexander Pritzel, Nicolas Heess, Tom
Erez, Yuval Tassa, David Silver, and Daan Wierstra.
</bibblock>
        <bibblock>Continuous control with deep reinforcement learning.
</bibblock>
        <bibblock>In <text font="italic">ICLR</text>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="lin1992self" xml:id="bib.bib7">
        <tags>
          <tag role="number">7</tag>
          <tag role="year">1992</tag>
          <tag role="authors">Lin</tag>
          <tag role="refnum">Lin [1992]</tag>
          <tag role="key">lin1992self</tag>
        </tags>
        <bibblock>
Long-Ji Lin.
</bibblock>
        <bibblock>Self-improving reactive agents based on reinforcement learning,
planning and teaching.
</bibblock>
        <bibblock><text font="italic">Machine learning</text>, 8(3-4):293–321, 1992.
</bibblock>
      </bibitem>
      <bibitem key="lin1993reinforcement" xml:id="bib.bib8">
        <tags>
          <tag role="number">8</tag>
          <tag role="year">1993</tag>
          <tag role="authors">Lin</tag>
          <tag role="refnum">Lin [1993]</tag>
          <tag role="key">lin1993reinforcement</tag>
        </tags>
        <bibblock><!--  %**** main.bbl Line 50 **** -->
Long-Ji Lin.
</bibblock>
        <bibblock>Reinforcement learning for robots using neural networks.
</bibblock>
        <bibblock>Technical report, Carnegie-Mellon Univ Pittsburgh PA School of
Computer Science, 1993.
</bibblock>
      </bibitem>
      <bibitem key="liu2017effects" xml:id="bib.bib9">
        <tags>
          <tag role="number">9</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Liu and Zou</tag>
          <tag role="refnum">Liu and Zou [2017]</tag>
          <tag role="key">liu2017effects</tag>
        </tags>
        <bibblock>
Ruishan Liu and James Zou.
</bibblock>
        <bibblock>The effects of memory replay in reinforcement learning.
</bibblock>
        <bibblock><text font="italic">arXiv preprint arXiv:1710.06574</text>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="mattar2018prioritized" xml:id="bib.bib10">
        <tags>
          <tag role="number">10</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Mattar and Daw</tag>
          <tag role="refnum">Mattar and Daw [2018]</tag>
          <tag role="key">mattar2018prioritized</tag>
        </tags>
        <bibblock>
Marcelo Gomes Mattar and Nathaniel D Daw.
</bibblock>
        <bibblock>Prioritized memory access explains planning and hippocampal replay.
</bibblock>
        <bibblock><text font="italic">bioRxiv</text>, page 225664, 2018.
</bibblock>
      </bibitem>
      <bibitem key="mnih2013playing" xml:id="bib.bib11">
        <tags>
          <tag role="number">11</tag>
          <tag role="year">2013</tag>
          <tag role="authors">Mnih <text font="italic">et al.</text></tag>
          <tag role="refnum">Mnih <text font="italic">et al.</text> [2013]</tag>
          <tag role="key">mnih2013playing</tag>
        </tags>
        <bibblock>
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Alex Graves, Ioannis
Antonoglou, Daan Wierstra, and Martin Riedmiller.
</bibblock>
        <bibblock>Playing atari with deep reinforcement learning.
</bibblock>
        <bibblock>In <text font="italic">NIPS Deep Learning Workshop</text>, 2013.
</bibblock>
      </bibitem>
      <bibitem key="mnih2015human" xml:id="bib.bib12">
        <tags>
          <tag role="number">12</tag>
          <tag role="year">2015</tag>
          <tag role="authors">Mnih <text font="italic">et al.</text></tag>
          <tag role="refnum">Mnih <text font="italic">et al.</text> [2015]</tag>
          <tag role="key">mnih2015human</tag>
        </tags>
        <bibblock><!--  %**** main.bbl Line 75 **** -->
Volodymyr Mnih, Koray Kavukcuoglu, David Silver, Andrei A Rusu, Joel Veness,
Marc G Bellemare, Alex Graves, Martin Riedmiller, Andreas K Fidjeland, Georg
Ostrovski, et al.
</bibblock>
        <bibblock>Human-level control through deep reinforcement learning.
</bibblock>
        <bibblock><text font="italic">Nature</text>, 518(7540):529, 2015.
</bibblock>
      </bibitem>
      <bibitem key="novati2018remember" xml:id="bib.bib13">
        <tags>
          <tag role="number">13</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Novati and
Koumoutsakos</tag>
          <tag role="refnum">Novati and
Koumoutsakos [2018]</tag>
          <tag role="key">novati2018remember</tag>
        </tags>
        <bibblock>
Guido Novati and Petros Koumoutsakos.
</bibblock>
        <bibblock>Remember and forget for experience replay.
</bibblock>
        <bibblock><text font="italic">arXiv preprint arXiv:1807.05827</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="pan2018organizing" xml:id="bib.bib14">
        <tags>
          <tag role="number">14</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Pan <text font="italic">et al.</text></tag>
          <tag role="refnum">Pan <text font="italic">et al.</text> [2018]</tag>
          <tag role="key">pan2018organizing</tag>
        </tags>
        <bibblock>
Yangchen Pan, Muhammad Zaheer, Adam White, Andrew Patterson, and Martha White.
</bibblock>
        <bibblock>Organizing experience: a deeper look at replay mechanisms for
sample-based planning in continuous state domains.
</bibblock>
        <bibblock>In <text font="italic">IJCAI</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="schaul2016prioritized" xml:id="bib.bib15">
        <tags>
          <tag role="number">15</tag>
          <tag role="year">2016</tag>
          <tag role="authors">Schaul <text font="italic">et al.</text></tag>
          <tag role="refnum">Schaul <text font="italic">et al.</text> [2016]</tag>
          <tag role="key">schaul2016prioritized</tag>
        </tags>
        <bibblock>
Tom Schaul, John Quan, Ioannis Antonoglou, and David Silver.
</bibblock>
        <bibblock>Prioritized experience replay.
</bibblock>
        <bibblock>In <text font="italic">ICML</text>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="shohamy2015integrating" xml:id="bib.bib16">
        <tags>
          <tag role="number">16</tag>
          <tag role="year">2015</tag>
          <tag role="authors"><!--  %**** main.bbl Line 100 **** -->Shohamy and
Daw</tag>
          <tag role="refnum"><!--  %**** main.bbl Line 100 **** -->Shohamy and
Daw [2015]</tag>
          <tag role="key">shohamy2015integrating</tag>
        </tags>
        <bibblock>
Daphna Shohamy and Nathaniel D Daw.
</bibblock>
        <bibblock>Integrating memories to guide decisions.
</bibblock>
        <bibblock><text font="italic">Current Opinion in Behavioral Sciences</text>, 5:85–90, 2015.
</bibblock>
      </bibitem>
      <bibitem key="silver2014deterministic" xml:id="bib.bib17">
        <tags>
          <tag role="number">17</tag>
          <tag role="year">2014</tag>
          <tag role="authors">Silver <text font="italic">et al.</text></tag>
          <tag role="refnum">Silver <text font="italic">et al.</text> [2014]</tag>
          <tag role="key">silver2014deterministic</tag>
        </tags>
        <bibblock>
David Silver, Guy Lever, Nicolas Heess, Thomas Degris, Daan Wierstra, and
Martin Riedmiller.
</bibblock>
        <bibblock>Deterministic policy gradient algorithms.
</bibblock>
        <bibblock>In <text font="italic">ICML</text>, 2014.
</bibblock>
      </bibitem>
      <bibitem key="sutton2018reinforcement" xml:id="bib.bib18">
        <tags>
          <tag role="number">18</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Sutton and
Barto</tag>
          <tag role="refnum">Sutton and
Barto [2018]</tag>
          <tag role="key">sutton2018reinforcement</tag>
        </tags>
        <bibblock>
Richard S Sutton and Andrew G Barto.
</bibblock>
        <bibblock><text font="italic">Reinforcement learning: An introduction</text>.
</bibblock>
        <bibblock>MIT press, 2018.
</bibblock>
      </bibitem>
      <bibitem key="todorov2012mujoco" xml:id="bib.bib19">
        <tags>
          <tag role="number">19</tag>
          <tag role="year">2012</tag>
          <tag role="authors">Todorov <text font="italic">et al.</text></tag>
          <tag role="refnum">Todorov <text font="italic">et al.</text> [2012]</tag>
          <tag role="key">todorov2012mujoco</tag>
        </tags>
        <bibblock>
Emanuel Todorov, Tom Erez, and Yuval Tassa.
</bibblock>
        <bibblock>Mujoco: A physics engine for model-based control.
</bibblock>
        <bibblock>In <text font="italic">IROS</text>, 2012.
</bibblock>
      </bibitem>
      <bibitem key="van2016deep" xml:id="bib.bib20">
        <tags>
          <tag role="number">20</tag>
          <tag role="year">2016</tag>
          <tag role="authors">Van Hasselt <text font="italic">et al.</text></tag>
          <tag role="refnum"><!--  %**** main.bbl Line 125 **** -->Van Hasselt <text font="italic">et al.</text><!--  %**** main.bbl Line 125 **** --> [2016]</tag>
          <tag role="key">van2016deep</tag>
        </tags>
        <bibblock>
Hado Van Hasselt, Arthur Guez, and David Silver.
</bibblock>
        <bibblock>Deep reinforcement learning with double q-learning.
</bibblock>
        <bibblock>In <text font="italic">AAAI</text>, 2016.
</bibblock>
      </bibitem>
      <bibitem key="wang2016sample" xml:id="bib.bib21">
        <tags>
          <tag role="number">21</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Wang <text font="italic">et al.</text></tag>
          <tag role="refnum">Wang <text font="italic">et al.</text> [2017]</tag>
          <tag role="key">wang2016sample</tag>
        </tags>
        <bibblock>
Ziyu Wang, Victor Bapst, Nicolas Heess, Volodymyr Mnih, Remi Munos, Koray
Kavukcuoglu, and Nando de Freitas.
</bibblock>
        <bibblock>Sample efficient actor-critic with experience replay.
</bibblock>
        <bibblock>In <text font="italic">ICLR</text>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="williams1992simple" xml:id="bib.bib22">
        <tags>
          <tag role="number">22</tag>
          <tag role="year">1992</tag>
          <tag role="authors">Williams</tag>
          <tag role="refnum">Williams [1992]</tag>
          <tag role="key">williams1992simple</tag>
        </tags>
        <bibblock>
Ronald J Williams.
</bibblock>
        <bibblock>Simple statistical gradient-following algorithms for connectionist
reinforcement learning.
</bibblock>
        <bibblock><text font="italic">Machine learning</text>, 8(3-4):229–256, 1992.
</bibblock>
      </bibitem>
      <bibitem key="wu2018learning" xml:id="bib.bib23">
        <tags>
          <tag role="number">23</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Wu <text font="italic">et al.</text></tag>
          <tag role="refnum">Wu <text font="italic">et al.</text> [2018]</tag>
          <tag role="key">wu2018learning</tag>
        </tags>
        <bibblock>
Lijun Wu, Fei Tian, Yingce Xia, Yang Fan, Tao Qin, Lai Jian-Huang, and Tie-Yan
Liu.
</bibblock>
        <bibblock>Learning to teach with dynamic loss functions.
</bibblock>
        <bibblock>In <text font="italic">NeurIPS</text><!--  %**** main.bbl Line 150 **** -->, 2018.
</bibblock>
      </bibitem>
      <bibitem key="xu2018learning" xml:id="bib.bib24">
        <tags>
          <tag role="number">24</tag>
          <tag role="year">2018a</tag>
          <tag role="authors">Xu <text font="italic">et al.</text></tag>
          <tag role="refnum">Xu <text font="italic">et al.</text> [2018a]</tag>
          <tag role="key">xu2018learning</tag>
        </tags>
        <bibblock>
Tianbing Xu, Qiang Liu, Liang Zhao, Wei Xu, and Jian Peng.
</bibblock>
        <bibblock>Learning to explore with meta-policy gradient.
</bibblock>
        <bibblock>In <text font="italic">ICML</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="xu2018meta" xml:id="bib.bib25">
        <tags>
          <tag role="number">25</tag>
          <tag role="year">2018b</tag>
          <tag role="authors">Xu <text font="italic">et al.</text></tag>
          <tag role="refnum">Xu <text font="italic">et al.</text> [2018b]</tag>
          <tag role="key">xu2018meta</tag>
        </tags>
        <bibblock>
Zhongwen Xu, Hado van Hasselt, and David Silver.
</bibblock>
        <bibblock>Meta-gradient reinforcement learning.
</bibblock>
        <bibblock>In <text font="italic">NeurIPS</text>, 2018.
</bibblock>
      </bibitem>
      <bibitem key="yin2017knowledge" xml:id="bib.bib26">
        <tags>
          <tag role="number">26</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Yin and Pan</tag>
          <tag role="refnum">Yin and Pan [2017]</tag>
          <tag role="key">yin2017knowledge</tag>
        </tags>
        <bibblock>
Haiyan Yin and Sinno Jialin Pan.
</bibblock>
        <bibblock>Knowledge transfer for deep reinforcement learning with hierarchical
experience replay.
</bibblock>
        <bibblock>In <text font="italic">AAAI</text>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="zhang2017deeper" xml:id="bib.bib27">
        <tags>
          <tag role="number">27</tag>
          <tag role="year">2017</tag>
          <tag role="authors">Zhang and Sutton</tag>
          <tag role="refnum">Zhang and Sutton [2017]</tag>
          <tag role="key">zhang2017deeper</tag>
        </tags>
        <bibblock>
Shangtong Zhang and Richard S Sutton.
</bibblock>
        <bibblock>A deeper look at experience replay.
</bibblock>
        <bibblock><text font="italic">NIPS Deep Reinforcement Learning Symposium</text>, 2017.
</bibblock>
      </bibitem>
      <bibitem key="zheng2018learning" xml:id="bib.bib28">
        <tags>
          <tag role="number">28</tag>
          <tag role="year">2018</tag>
          <tag role="authors">Zheng <text font="italic">et al.</text></tag>
          <tag role="refnum">Zheng <text font="italic">et al.</text> [2018]</tag>
          <tag role="key">zheng2018learning</tag>
        </tags>
        <bibblock><!--  %**** main.bbl Line 175 **** -->
Zeyu Zheng, Junhyuk Oh, and Satinder Singh.
</bibblock>
        <bibblock>On learning intrinsic rewards for policy gradient methods.
</bibblock>
        <bibblock>In <text font="italic">NeurIPS</text>, 2018.
</bibblock>
      </bibitem>
    </biblist>
  </bibliography>
</document>
