<?xml version="1.0" encoding="UTF-8"?>
<?latexml searchpaths="/home/miri/Documents/university/DataLit/arXiv_src_fetcher/ICLR_2023_first100/-XC_lMynIT"?>
<!--  %%%%%%%% ICML 2024 EXAMPLE LATEX SUBMISSION FILE %%%%%%%%%%%%%%%%% --><?latexml class="article"?>
<?latexml package="microtype"?>
<?latexml package="graphicx"?>
<?latexml package="subfigure"?>
<?latexml package="booktabs"?>
<?latexml package="multirow"?>
<?latexml package="hyperref"?>
<!--  %Attempt to make hyperref and algorithmic work together better: --><!--  %“newcommand–“theHalgorithm˝–“arabic–algorithm˝˝ --><!--  %Use the following line for the initial blind version submitted for review: --><!--  %**** main.tex Line 25 **** --><!--  %“usepackage–icml2024˝ --><?latexml package="icml2024" options="accepted"?>
<?latexml package="amsmath"?>
<?latexml package="amssymb"?>
<?latexml package="mathtools"?>
<?latexml package="amsthm"?>
<?latexml package="cleveref" options="capitalize,noabbrev"?>
<!--  %**** main.tex Line 50 **** --><?latexml package="todonotes" options="textsize=tiny"?>
<?latexml RelaxNGSchema="LaTeXML"?>
<document xmlns="http://dlmf.nist.gov/LaTeXML" class="ltx_pruned_first">
  <resource src="LaTeXML.css" type="text/css"/>
  <resource src="ltx-article.css" type="text/css"/>
  <title>RNAFlow: RNA Structure &amp; Sequence Design via <break/>Inverse Folding-Based Flow Matching</title>
  <creator role="author">
    <personname>Divya Nori</personname>
  </creator>
  <creator before="  " role="author">
    <personname>Wengong Jin</personname>
  </creator>
  <abstract name="Abstract">
    <p>The growing significance of RNA engineering in diverse biological applications has spurred interest in developing AI methods for structure-based RNA design. While diffusion models have excelled in protein design, adapting them for RNA presents new challenges due to RNA’s conformational flexibility and the computational cost of fine-tuning large structure prediction models. To this end, we propose RNAFlow, a flow matching model for protein-conditioned RNA sequence-structure design. Its denoising network integrates an RNA inverse folding model and a pre-trained RosettaFold2NA network for generation of RNA sequences and structures. The integration of inverse folding in the structure denoising process allows us to simplify training by fixing the structure prediction network. We further enhance the inverse folding model by conditioning it on inferred conformational ensembles to model dynamic RNA conformations. Evaluation on protein-conditioned RNA structure and sequence generation tasks demonstrates RNAFlow’s advantage over existing RNA design methods.</p>
  </abstract>
  <keywords><!--  %You may provide any keywords that you -->Machine Learning, ICML<!--  %find helpful for describing your paper; these are used to populate 
     %the ”keywords” metadata in the PDF but will not be shown in the document --></keywords>
<!--  %“icmlauthor–˝–sch˝ 
     %“icmlauthor–˝–sch˝ -->  <para xml:id="p2">
    <break/>
  </para>
<!--  %this must go after the closing bracket ] following “twocolumn[ ... 
     %This command actually creates the footnote in the first column 
     %listing the affiliations and the copyright notice. 
     %The command takes one argument, which is text to display at the start of the footnote. 
     %The “icmlEqualContribution command is standard text for equal contribution. 
     %Remove it (just –˝) if you do not need this facility. 
     %otherwise use the standard text. -->  <section inlist="toc" xml:id="S1">
    <tags>
      <tag>1</tag>
      <tag role="autoref">section 1</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">1</tag>
      <tag role="typerefnum">§1</tag>
    </tags>
    <title><tag close=" ">1</tag>Introduction</title>
    <figure inlist="lof" labels="LABEL:fig:1" placement="ht" xml:id="S1.F1">
      <tags>
        <tag>Figure 1</tag>
        <tag role="autoref">Figure 1</tag>
        <tag role="creftype">Figure</tag>
        <tag role="creftypecap">Figure</tag>
        <tag role="creftypeplural">Figures</tag>
        <tag role="creftypepluralcap">Figures</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Figure 1</tag>
      </tags>
      <graphics candidates="if-flow-match.png" class="ltx_centering" graphic="if-flow-match.png" options="width=867.23999pt,keepaspectratio=true" xml:id="S1.F1.g1"/>
      <toccaption class="ltx_centering"><tag close=" ">1</tag>One forward pass in RNAFlow training, during which an inverse folding model is finetuned to be the flow matching score prediction network. The inverse folding model predicts a denoised RNA sequence from a noised complex backbone graph. The predicted sequence is folded by RF2NA for sequence and structure supervision.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 1</tag>One forward pass in RNAFlow training, during which an inverse folding model is finetuned to be the flow matching score prediction network. The inverse folding model predicts a denoised RNA sequence from a noised complex backbone graph. The predicted sequence is folded by RF2NA for sequence and structure supervision.</caption>
    </figure>
    <para xml:id="S1.p1">
      <p>In recent years, RNA molecules have been engineered for versatile and controllable functions in biological systems <cite class="ltx_citemacro_citep">(<bibref bibrefs="dykstra2022engineering" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, ranging from synthetic riboswitch sensors that modulate gene expression to aptamers that bind with protein targets  <cite class="ltx_citemacro_citep">(<bibref bibrefs="thavarajah2021rna,vezeau2023automated,keefe2010aptamers" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. However, experimental methods for high-throughput RNA selection like SELEX <cite class="ltx_citemacro_citep">(<bibref bibrefs="gold2015selex" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> remain time-consuming and labor-intensive. To unlock the full potential of RNA therapeutics, there is a pressing need for developing deep learning models to automatically design RNAs that bind with a protein of interest <cite class="ltx_citemacro_citep">(<bibref bibrefs="sanchez2019rna" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="S1.p2">
      <p>Current state-of-the-art biomolecular structure design methods are based on diffusion models <cite class="ltx_citemacro_citep">(<bibref bibrefs="ho2020denoising,yim2023se" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or flow matching <cite class="ltx_citemacro_citep">(<bibref bibrefs="lipman2022flow,bose2023se" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. For example, RFDiffusion <cite class="ltx_citemacro_citep">(<bibref bibrefs="watson2023novo" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> fine-tuned RoseTTAFold <cite class="ltx_citemacro_citep">(<bibref bibrefs="baek2021accurate" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> to generate novel protein structures that meet complex constraints, including conditional generation of protein binders. While we can adopt a similar approach for conditional RNA structure generation by fine-tuning a protein-nucleic acid structure prediction network like RoseTTAFold2NA (RF2NA) <cite class="ltx_citemacro_citep">(<bibref bibrefs="baek2023accurate" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, there are two major caveats. First, RNAs exhibit a high degree of conformational flexibility, which is often the key to their biological function <cite class="ltx_citemacro_citep">(<bibref bibrefs="ganser2019roles" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. A generative model that outputs a single static structure may bottleneck the downstream sequence generation process, since an ideal sequence should account for desired RNA dynamics. Second, fine-tuning a large structure prediction network is computationally expensive, motivating a method that applies a pre-trained model like RF2NA directly.</p>
    </para>
    <para xml:id="S1.p3">
      <p>In this paper, we propose RNAFlow, a flow matching model for RNA sequence-structure design. The denoising network in RNAFlow is composed of an RNA inverse folding model and a pre-trained RF2NA network. In each iteration, RNAFlow first generates a RNA sequence given a noisy protein-RNA complex and then uses RF2NA to fold into a denoised RNA structure. For computational efficiency, we train the inverse folding model to minimize the flow matching objective while keeping RF2NA fixed. RNAFlow offers three advantages over previous methods like RFDiffusion. First, RNAFlow generates an RNA sequence and its structure simultaneously. Second, it is much easier to train because we do not fine-tune a large structure prediction network. Third, our framework enables us to model the dynamic nature of RNA structures for inverse folding. Specifically, we utilize the final few structure predictions from inference trajectories as an effective approximation of an RNA conformational ensemble and enhance our inverse folding model to condition on dynamic RNA conformations.</p>
    </para>
    <para xml:id="S1.p4">
      <p>We evaluate our method on the task of protein-conditioned RNA structure and sequence generation. RNAFlow outperforms a standard sequence-only approach and a recent diffusion model <cite class="ltx_citemacro_citep">(<bibref bibrefs="morehead2023towards" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> for nucleic acid sequence-structure generation in terms of native sequence recovery, RMSD, and lDDT. Additionally, we show that RNAFlow can be used in the motif-scaffolding setting to generate plausible RNA aptamers for G-protein-coupled receptor kinase 2 (GRK2), a target with known sequence motif for GRK2 binding.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S2">
    <tags>
      <tag>2</tag>
      <tag role="autoref">section 2</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">2</tag>
      <tag role="typerefnum">§2</tag>
    </tags>
    <title><tag close=" ">2</tag>Related Work</title>
    <para xml:id="S2.p1">
      <p><text font="bold">Protein-Conditioned RNA Design.</text> Early methods for computational design of protein-binding RNAs involved generating a large number of RNA sequences and selecting by desired secondary structure motifs <cite class="ltx_citemacro_citep">(<bibref bibrefs="kim2010computational" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or molecular dynamics <cite class="ltx_citemacro_citep">(<bibref bibrefs="zhou2015searching,buglak2020methods" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. These approaches are computationally expensive and require specifying design constraints a priori, which are often unknown for new protein targets. More recently, generative sequence-based approaches based on LSTMs and VAEs have been trained on SELEX data <cite class="ltx_citemacro_citep">(<bibref bibrefs="im2019generative,iwano2022generative" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. However, these methods can only be trained for one protein at a time and cannot be applied to proteins where SELEX data does not exist.</p>
    </para>
    <para xml:id="S2.p2">
      <p><text font="bold">Unconditional RNA Design.</text> Computational methods have been developed for RNA structure design, including classical algorithmic approaches <cite class="ltx_citemacro_citep">(<bibref bibrefs="yesselman2019computational" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> and generative modeling methods. In particular, <cite class="ltx_citemacro_citet"><bibref bibrefs="morehead2023towards" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> recently proposed an <Math mode="inline" tex="SE(3)" text="S * E * 3" xml:id="S2.p2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
              <XMTok font="italic" role="UNKNOWN">E</XMTok>
              <XMDual>
                <XMRef idref="S2.p2.m1.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="3" role="NUMBER" xml:id="S2.p2.m1.1">3</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>-discrete diffusion model (MMDiff) for joint generation of nucleic acid sequences and structures. While MMDiff can generate short micro-RNA molecules, it has trouble conditionally generating protein-binding RNAs and samples of longer sequence length.</p>
    </para>
    <para xml:id="S2.p3">
      <p>Deep learning methods for inverse folding generally apply graph-based encoders for a single RNA structure <cite class="ltx_citemacro_citep">(<bibref bibrefs="tan2023hierarchical" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite> or several conformers <cite class="ltx_citemacro_citep">(<bibref bibrefs="joshi2023multi" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. We adapt an inverse folding model to accept protein information as a condition and train on a denoising objective.</p>
    </para>
    <para xml:id="S2.p4">
      <p><text font="bold">Protein Structure Design.</text> Deep generative methods for protein design have demonstrated that realistic protein backbones can be generated efficiently via flow matching <cite class="ltx_citemacro_citep">(<bibref bibrefs="yim2023fast,bose2023se" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. Prior work has also shown that diffusion models can be conditioned on a target protein to generate functional protein binders <cite class="ltx_citemacro_citep">(<bibref bibrefs="ingraham2023illuminating,watson2023novo" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. We apply a similar approach within the flow matching framework. Our work is also related to sequence-structure co-design methods where the outputs are iteratively refined <cite class="ltx_citemacro_citep">(<bibref bibrefs="jin2021iterative,stark2023harmonic" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
  </section>
  <section inlist="toc" xml:id="S3">
    <tags>
      <tag>3</tag>
      <tag role="autoref">section 3</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">3</tag>
      <tag role="typerefnum">§3</tag>
    </tags>
    <title><tag close=" ">3</tag>Methods</title>
    <para xml:id="S3.p1">
      <p><text font="bold">Problem Formulation.</text> As input, RNAFlow receives the protein backbone atom structure <Math mode="inline" tex="\vec{P}\in\mathbb{R}^{L_{p}\times 3\times 3}" text="vec@(P) element-of R ^ (L _ p * 3 * 3)" xml:id="S3.p1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">p</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, where <Math mode="inline" tex="L_{p}" text="L _ p" xml:id="S3.p1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
            </XMApp>
          </XMath>
        </Math> is the number of residues, and each residue contains backbone atoms <Math mode="inline" tex="N" text="N" xml:id="S3.p1.m3">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">N</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="S3.p1.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">C</XMTok>
              <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
            </XMApp>
          </XMath>
        </Math>, and <Math mode="inline" tex="C" text="C" xml:id="S3.p1.m5">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">C</XMTok>
          </XMath>
        </Math>. The protein sequence is also given as input where a single token is <Math mode="inline" tex="p_{i}" text="p _ i" xml:id="S3.p1.m6">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="i\in\{0,1,2,\ldots,L_{p}-1\}" text="i element-of set@(0, 1, 2, ldots, L _ p - 1)" xml:id="S3.p1.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="S3.p1.m7.1"/>
                  <XMRef idref="S3.p1.m7.2"/>
                  <XMRef idref="S3.p1.m7.3"/>
                  <XMRef idref="S3.p1.m7.4"/>
                  <XMRef idref="S3.p1.m7.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.p1.m7.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S3.p1.m7.2">1</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="2" role="NUMBER" xml:id="S3.p1.m7.3">2</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S3.p1.m7.4">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.p1.m7.5">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. The model is trained to predict RNA sequence with tokens <Math mode="inline" tex="r_{i}" text="r _ i" xml:id="S3.p1.m8">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">r</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="i\in\{0,1,2,\ldots,L_{r}-1\}" text="i element-of set@(0, 1, 2, ldots, L _ r - 1)" xml:id="S3.p1.m9">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="set"/>
                  <XMRef idref="S3.p1.m9.1"/>
                  <XMRef idref="S3.p1.m9.2"/>
                  <XMRef idref="S3.p1.m9.3"/>
                  <XMRef idref="S3.p1.m9.4"/>
                  <XMRef idref="S3.p1.m9.5"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.p1.m9.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S3.p1.m9.2">1</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="2" role="NUMBER" xml:id="S3.p1.m9.3">2</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S3.p1.m9.4">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.p1.m9.5">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                    </XMApp>
                    <XMTok meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. The model also predicts RNA backbone structure <Math mode="inline" tex="R\in\mathbb{R}^{L_{r}\times 3\times 3}" text="R element-of R ^ (L _ r * 3 * 3)" xml:id="S3.p1.m10">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">R</XMTok>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                <XMApp>
                  <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                  <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>, where <Math mode="inline" tex="L_{r}" text="L _ r" xml:id="S3.p1.m11">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
            </XMApp>
          </XMath>
        </Math> is the number of nucleotides, and each nucleotide contains backbone atoms <Math mode="inline" tex="P" text="P" xml:id="S3.p1.m12">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">P</XMTok>
          </XMath>
        </Math>, <Math mode="inline" tex="C_{4}^{\prime}" text="(C _ 4) ^ prime" xml:id="S3.p1.m13">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
              </XMApp>
              <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
            </XMApp>
          </XMath>
        </Math>, and <Math mode="inline" tex="N_{1}/N_{9}" text="N _ 1 / N _ 9" xml:id="S3.p1.m14">
          <XMath>
            <XMApp>
              <XMTok meaning="divide" role="MULOP">/</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">N</XMTok>
                <XMTok fontsize="70%" meaning="9" role="NUMBER">9</XMTok>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> (pyrimidine/purine) <cite class="ltx_citemacro_citep">(<bibref bibrefs="wadley2007evaluating" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>.</p>
    </para>
    <para xml:id="S3.p2">
      <p><text font="bold">Background: Conditional Flow Matching.</text> By the flow matching framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="lipman2022flow" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, consider data distribution <Math mode="inline" tex="p_{1}" text="p _ 1" xml:id="S3.p2.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> of RNA backbone structures and a prior distribution <Math mode="inline" tex="p_{0}(\vec{R}|\vec{R}_{1})" text="p _ 0 * conditional@(vec@(R), (vec@(R)) _ 1)" xml:id="S3.p2.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
              <XMDual>
                <XMRef idref="S3.p2.m2.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S3.p2.m2.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, where <Math mode="inline" tex="\vec{R}_{1}" text="(vec@(R)) _ 1" xml:id="S3.p2.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> is a sample from <Math mode="inline" tex="p_{1}" text="p _ 1" xml:id="S3.p2.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math>. A <text font="italic">flow</text> transforms <Math mode="inline" tex="p_{0}" text="p _ 0" xml:id="S3.p2.m5">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math> to <Math mode="inline" tex="p_{1}" text="p _ 1" xml:id="S3.p2.m6">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math>, and this flow can be parameterized by a sequence of time-dependent conditional probability paths <Math mode="inline" tex="p_{t}(\vec{R}_{t}|\vec{R}_{1})" text="p _ t * conditional@((vec@(R)) _ t, (vec@(R)) _ 1)" xml:id="S3.p2.m7">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMDual>
                <XMRef idref="S3.p2.m7.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="S3.p2.m7.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>, <Math mode="inline" tex="t\in[0,1]" text="t element-of closed-interval@(0, 1)" xml:id="S3.p2.m8">
          <XMath>
            <XMApp>
              <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="S3.p2.m8.1"/>
                  <XMRef idref="S3.p2.m8.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMTok meaning="0" role="NUMBER" xml:id="S3.p2.m8.1">0</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok meaning="1" role="NUMBER" xml:id="S3.p2.m8.2">1</XMTok>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. A sample from <Math mode="inline" tex="p_{t}" text="p _ t" xml:id="S3.p2.m9">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> can be computed by linear interpolation, as given by Equation <ref labelref="LABEL:interpolation">1</ref>, where <Math mode="inline" tex="\vec{R}_{0}" text="(vec@(R)) _ 0" xml:id="S3.p2.m10">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math> is a sample from the prior distribution.</p>
    </para>
    <para xml:id="S3.p3">
      <equation labels="LABEL:interpolation" xml:id="S3.E1">
        <tags>
          <tag>(1)</tag>
          <tag role="autoref">Equation 1</tag>
          <tag role="creftype">Equation</tag>
          <tag role="creftypecap">Equation</tag>
          <tag role="creftypeplural">Equations</tag>
          <tag role="creftypepluralcap">Equations</tag>
          <tag role="refnum">1</tag>
        </tags>
        <Math mode="display" tex="\vec{R}_{t}|\vec{R}_{1}=(1-t)*\vec{R}_{0}+t*\vec{R}_{1}" text="conditional@((vec@(R)) _ t, (vec@(R)) _ 1) = (1 - t) * (vec@(R)) _ 0 + t * (vec@(R)) _ 1" xml:id="S3.E1.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">∗</XMTok>
                  <XMDual>
                    <XMRef idref="S3.E1.m1.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="S3.E1.m1.1">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">∗</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="S3.p4">
      <p>This probability path is generated by a marginal vector field that defines how individual samples are transported. We can define this vector field as given in Equation <ref labelref="LABEL:vecfield">2</ref>, and we can integrate over the field from time <Math mode="inline" tex="0" text="0" xml:id="S3.p4.m1">
          <XMath>
            <XMTok meaning="0" role="NUMBER">0</XMTok>
          </XMath>
        </Math> to time <Math mode="inline" tex="1" text="1" xml:id="S3.p4.m2">
          <XMath>
            <XMTok meaning="1" role="NUMBER">1</XMTok>
          </XMath>
        </Math> to generate samples from <Math mode="inline" tex="p_{1}" text="p _ 1" xml:id="S3.p4.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> given a noise sample from <Math mode="inline" tex="p_{0}" text="p _ 0" xml:id="S3.p4.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">p</XMTok>
              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="S3.p5">
      <equation labels="LABEL:vecfield" xml:id="S3.E2">
        <tags>
          <tag>(2)</tag>
          <tag role="autoref">Equation 2</tag>
          <tag role="creftype">Equation</tag>
          <tag role="creftypecap">Equation</tag>
          <tag role="creftypeplural">Equations</tag>
          <tag role="creftypepluralcap">Equations</tag>
          <tag role="refnum">2</tag>
        </tags>
        <Math mode="display" tex="\hat{v}(\vec{R}_{t};\theta)=\frac{\hat{R}_{1}(\vec{R}_{t};\theta)-\vec{R}_{t}}%&#10;{1-t}" text="hat@(v) * list@((vec@(R)) _ t, theta) = ((hat@(R)) _ 1 * list@((vec@(R)) _ t, theta) - (vec@(R)) _ t) / (1 - t)" xml:id="S3.E2.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">v</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                    <XMRef idref="S3.E2.m1.4"/>
                    <XMRef idref="S3.E2.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="S3.E2.m1.4">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">;</XMTok>
                    <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E2.m1.3">θ</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="list"/>
                        <XMRef idref="S3.E2.m1.2"/>
                        <XMRef idref="S3.E2.m1.1"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E2.m1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMApp>
                            <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                            <XMTok font="italic" role="UNKNOWN">R</XMTok>
                          </XMApp>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">;</XMTok>
                        <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="S3.E2.m1.1">θ</XMTok>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="minus" role="ADDOP">-</XMTok>
                  <XMTok meaning="1" role="NUMBER">1</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="S3.p6">
      <p>We aim to learn this vector field by approximating <Math mode="inline" tex="\hat{R}_{1}" text="(hat@(R)) _ 1" xml:id="S3.p6.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> with a neural network trained with the reparameterized conditional flow matching objective. Particularly, as with diffusion, the neural network can conveniently be trained to predict samples from the data distribution given noised sample <Math mode="inline" tex="\vec{R}_{t}" text="(vec@(R)) _ t" xml:id="S3.p6.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="S3.p7">
      <p>We choose to employ flow matching rather than the related diffusion framework <cite class="ltx_citemacro_citep">(<bibref bibrefs="ho2020denoising" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>, primarily due to computational efficiency. Diffusion inference often requires thousands of forward passes to generate quality samples. Since our score model involves a large structure prediction network, RNAFlow inference time would be much slower in a diffusion setting <cite class="ltx_citemacro_citep">(<bibref bibrefs="yim2023fast" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. In contrast, quality samples can be generated by flow matching with a much fewer number of passes.</p>
    </para>
    <subsection inlist="toc" xml:id="S3.SS1">
      <tags>
        <tag>3.1</tag>
        <tag role="autoref">subsection 3.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">3.1</tag>
        <tag role="typerefnum">§3.1</tag>
      </tags>
      <title><tag close=" ">3.1</tag>RNAFlow Algorithm: Overview</title>
      <para xml:id="S3.SS1.p1">
        <p>We generate RNA sequences and structures using a conditional flow matching model where the score predictor is an inverse folding denoiser and pre-trained folding network. The inverse folding denoiser, which we refer to as <text font="bold">Noise-to-Seq</text>, is a geometric graph neural network conditioned on protein structure and sequence. Noise-to-Seq is pre-trained on the RNA inverse folding task and subsequently fine-tuned on the flow matching objective. It follows the RNA inverse folding architecture presented by <cite class="ltx_citemacro_citet"><bibref bibrefs="joshi2023multi" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, which is detailed in section <ref labelref="LABEL:sec:3.2">3.2</ref>.</p>
      </para>
      <para xml:id="S3.SS1.p2">
        <p><text font="bold"><!--  %**** method.tex Line 25 **** -->Initialization</text>. As our prior distribution, we choose a unit Gaussian on <Math mode="inline" tex="\mathbb{R}^{3}" text="R ^ 3" xml:id="S3.SS1.p2.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> centered at zero, from which we sample <Math mode="inline" tex="\vec{R}_{0}" text="(vec@(R)) _ 0" xml:id="S3.SS1.p2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math>. We also translate the true protein-RNA complex [<Math mode="inline" tex="\vec{P}_{1}" text="(vec@(P)) _ 1" xml:id="S3.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\vec{R}_{1}" text="(vec@(R)) _ 1" xml:id="S3.SS1.p2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>] such that the center of mass of <Math mode="inline" tex="\vec{R}_{1}" text="(vec@(R)) _ 1" xml:id="S3.SS1.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> is zero. As shown in Algorithm <ref labelref="LABEL:rnaflow:train">1</ref>, we Kabsch align <cite class="ltx_citemacro_citep">(<bibref bibrefs="kabsch1976solution" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> the sampled noise <Math mode="inline" tex="\vec{R}_{0}" text="(vec@(R)) _ 0" xml:id="S3.SS1.p2.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> with the true RNA <Math mode="inline" tex="\vec{R}_{1}" text="(vec@(R)) _ 1" xml:id="S3.SS1.p2.m7">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> to eliminate global rotations, leading to faster training convergence <cite class="ltx_citemacro_citep">(<bibref bibrefs="klein2023equivariant" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. By this approach, we train with the ground-truth pose of the protein relative to the RNA centroid, though this is not leaked at inference time.</p>
      </para>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:rnaflow:train" placement="t" xml:id="alg1">
        <tags>
          <tag><text font="bold">Algorithm 1</text></tag>
          <tag role="autoref">1</tag>
          <tag role="creftype">Algorithm</tag>
          <tag role="creftypecap">Algorithm</tag>
          <tag role="creftypeplural">Algorithms</tag>
          <tag role="creftypepluralcap">Algorithms</tag>
          <tag role="refnum">1</tag>
          <tag role="typerefnum">Algorithm 1</tag>
        </tags>
        <toccaption><tag close=" ">1</tag>RNAFlow: Train</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 1</text></tag> RNAFlow: Train</caption>
        <p class="ltx_figure_panel"><text font="bold">Require:<Math mode="inline" tex="\{p_{i}\}_{\forall i}" text="(set@(p _ i)) _ (for-all@(i))" xml:id="alg1.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg1.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="medium" role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg1.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="medium italic" role="UNKNOWN">p</XMTok>
                        <XMTok font="medium italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok font="medium" role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok font="medium" fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                    <XMTok font="medium italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></text>, <Math mode="inline" tex="\{r_{i}\}_{\forall i}" text="(set@(r _ i)) _ (for-all@(i))" xml:id="alg1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="alg1.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="alg1.m2.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="[\vec{P}_{1},\vec{R}_{1}]" text="closed-interval@((vec@(P)) _ 1, (vec@(R)) _ 1)" xml:id="alg1.m3">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="closed-interval"/>
                  <XMRef idref="alg1.m3.1"/>
                  <XMRef idref="alg1.m3.2"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">[</XMTok>
                  <XMApp xml:id="alg1.m3.1">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">P</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="alg1.m3.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">]</XMTok>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Sample prior <Math mode="inline" tex="\vec{R}_{0}\sim\mathcal{N}(0,I_{3})^{L_{r}}" text="(vec@(R)) _ 0 similar-to N * (open-interval@(0, I _ 3)) ^ (L _ r)" xml:id="alg1.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg1.m4.1"/>
                        <XMRef idref="alg1.m4.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="alg1.m4.1">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="alg1.m4.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">I</XMTok>
                          <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Kabsch align noise <Math mode="inline" tex="\vec{R}_{0}" text="(vec@(R)) _ 0" xml:id="alg1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> with true backbone <Math mode="inline" tex="\vec{R}_{1}" text="(vec@(R)) _ 1" xml:id="alg1.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Sample timestep <Math mode="inline" tex="t\sim\text{Uniform}[0,1]" text="t similar-to [Uniform] * closed-interval@(0, 1)" xml:id="alg1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Uniform</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="closed-interval"/>
                      <XMRef idref="alg1.m7.1"/>
                      <XMRef idref="alg1.m7.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">[</XMTok>
                      <XMTok meaning="0" role="NUMBER" xml:id="alg1.m7.1">0</XMTok>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok meaning="1" role="NUMBER" xml:id="alg1.m7.2">1</XMTok>
                      <XMTok role="CLOSE" stretchy="false">]</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Interpolate <Math mode="inline" tex="\vec{R}_{t}\leftarrow t*\vec{R}_{1}+(1-t)*\vec{R}_{0}" text="(vec@(R)) _ t leftarrow t * (vec@(R)) _ 1 + (1 - t) * (vec@(R)) _ 0" xml:id="alg1.m8">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">∗</XMTok>
                    <XMTok font="italic" role="UNKNOWN">t</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">∗</XMTok>
                    <XMDual>
                      <XMRef idref="alg1.m8.1"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg1.m8.1">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMTok meaning="1" role="NUMBER">1</XMTok>
                          <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Predict <Math mode="inline" tex="\{\hat{r}_{i}\}_{\forall i}\leftarrow\text{{Noise-to-Seq}}\{[\vec{P}_{1},\vec{%&#10;R}_{t}],\{p_{i}\}_{\forall i},t\}" text="(set@((hat@(r)) _ i)) _ (for-all@(i)) leftarrow [Noise-to-Seq] * set@(closed-interval@((vec@(P)) _ 1, (vec@(R)) _ t), (set@(p _ i)) _ (for-all@(i)), t)" xml:id="alg1.m9">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg1.m9.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg1.m9.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText><text font="bold">Noise-to-Seq</text></XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg1.m9.3"/>
                      <XMRef idref="alg1.m9.4"/>
                      <XMRef idref="alg1.m9.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMDual xml:id="alg1.m9.3">
                        <XMApp>
                          <XMTok meaning="closed-interval"/>
                          <XMRef idref="alg1.m9.3.1"/>
                          <XMRef idref="alg1.m9.3.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="alg1.m9.3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                              <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="alg1.m9.3.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg1.m9.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="set"/>
                            <XMRef idref="alg1.m9.4.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                            <XMApp xml:id="alg1.m9.4.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMTok font="italic" role="UNKNOWN" xml:id="alg1.m9.1">t</XMTok>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Predict <Math mode="inline" tex="\hat{R}_{1}\leftarrow\text{RF2NA}\{\{\hat{r}_{i}\}_{\forall i}\}" text="(hat@(R)) _ 1 leftarrow [RF2NA] * set@((set@((hat@(r)) _ i)) _ (for-all@(i)))" xml:id="alg1.m10">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>RF2NA</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg1.m10.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg1.m10.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="set"/>
                            <XMRef idref="alg1.m10.1.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                            <XMApp xml:id="alg1.m10.1.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                              </XMApp>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
      </float>
<!--  %**** method.tex Line 50 **** -->      <para xml:id="S3.SS1.p3">
        <p><text font="bold">Training</text>. During training, we sample a timestep <Math mode="inline" tex="t" text="t" xml:id="S3.SS1.p3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">t</XMTok>
            </XMath>
          </Math> and interpolate the true RNA backbone with the sampled prior to arrive at noised backbone <Math mode="inline" tex="\vec{R}_{t}" text="(vec@(R)) _ t" xml:id="S3.SS1.p3.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
            </XMath>
          </Math>. The true protein backbone, noised RNA backbone, and protein sequence are given as input to Noise-to-Seq which predicts a denoised RNA sequence. RF2NA folds the predicted RNA sequence into predicted structure <Math mode="inline" tex="\hat{R}_{1}" text="(hat@(R)) _ 1" xml:id="S3.SS1.p3.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>. This process is shown in Figure <ref labelref="LABEL:fig:1"/>.</p>
      </para>
      <para xml:id="S3.SS1.p4">
        <p>The outputs of an RNAFlow training pass are an RNA sequence and its structure. The reparameterized flow matching objective gives that the score model should be trained with a standard <Math mode="inline" tex="L_{2}" text="L _ 2" xml:id="S3.SS1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">L</XMTok>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math> loss. Therefore, as given in Equation <ref labelref="LABEL:loss">3</ref>, we compute the MSE between all predicted and true RNA backbone coordinates. Before MSE computation, we Kabsch align the two RNA backbones, since we are optimizing for RNA structure design rather than docking accuracy. Additionally, we supervise the sequence with a cross entropy loss between predicted and true nucleotide types.</p>
      </para>
      <para xml:id="S3.SS1.p5">
        <equation labels="LABEL:loss" xml:id="S3.E3">
          <tags>
            <tag>(3)</tag>
            <tag role="autoref">Equation 3</tag>
            <tag role="creftype">Equation</tag>
            <tag role="creftypecap">Equation</tag>
            <tag role="creftypeplural">Equations</tag>
            <tag role="creftypepluralcap">Equations</tag>
            <tag role="refnum">3</tag>
          </tags>
          <Math mode="display" tex="\mathcal{L}=\text{MSE}(\hat{R}_{1},\vec{R}_{1})+\sum_{i}\text{CE}(\hat{r}_{i},%&#10;r_{i})" text="L = [MSE] * open-interval@((hat@(R)) _ 1, (vec@(R)) _ 1) + (sum _ i)@([CE] * open-interval@((hat@(r)) _ i, r _ i))" xml:id="S3.E3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMText>MSE</XMText>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="S3.E3.m1.1"/>
                        <XMRef idref="S3.E3.m1.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="S3.E3.m1.1">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                            <XMTok font="italic" role="UNKNOWN">R</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="S3.E3.m1.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                            <XMTok font="italic" role="UNKNOWN">R</XMTok>
                          </XMApp>
                          <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                      <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>CE</XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="S3.E3.m1.3"/>
                          <XMRef idref="S3.E3.m1.4"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.E3.m1.3">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            </XMApp>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="S3.E3.m1.4">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">r</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>
        </equation>
      </para>
      <para xml:id="S3.SS1.p6">
        <p>The sequence output from Noise-to-Seq is used as input to RF2NA, and the resulting structure is supervised to update the weights of the model. Since gradients must propagate between Noise-to-Seq and RF2NA, we apply the Gumbel-Softmax estimator to differentiably sample from the predicted logits <cite class="ltx_citemacro_citep">(<bibref bibrefs="jang2016categorical" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Further justification of this objective is given in the Appendix.</p>
      </para>
      <para xml:id="S3.SS1.p7">
        <p><text font="bold">Inference: RNAFlow-Base</text>. As shown in Algorithm <ref labelref="LABEL:rnaflow:inference">2</ref>, we begin by generating a “pose guess” using RF2NA. Specifically, we fold the protein MSA with a mock RNA sequence consisting of all adenines, of the same length as the true RNA sequence. The predicted complex is used as an initial guess of protein pose with respect to the RNA centroid. <Math mode="inline" tex="\vec{P}_{0}" text="(vec@(P)) _ 0" xml:id="S3.SS1.p7.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> is the true protein backbone Kabsch-aligned onto the predicted protein pose, and <Math mode="inline" tex="\vec{R}_{0}" text="(vec@(R)) _ 0" xml:id="S3.SS1.p7.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> is drawn from the prior distribution. RNAFlow refines its predictions over multiple steps, predicting the true complex [<Math mode="inline" tex="\hat{P}_{1}" text="(hat@(P)) _ 1" xml:id="S3.SS1.p7.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\hat{R}_{1}" text="(hat@(R)) _ 1" xml:id="S3.SS1.p7.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>] on each iteration. The final outputs of RNAFlow inference are a predicted RNA sequence and structure.</p>
      </para>
      <para xml:id="S3.SS1.p8">
        <p><text font="bold">Inference: RNAFlow-Traj</text>. In standard RNAFlow inference, Noise-to-Seq predicts a sequence based on a single RNA structure. However, an RNA backbone structure can adopt multiple conformations, and it is important that the final RNA sequence reflects this conformational diversity <cite class="ltx_citemacro_citep">(<bibref bibrefs="ganser2019roles" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Indeed, <cite class="ltx_citemacro_citet"><bibref bibrefs="joshi2023multi" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> demonstrates that inverse folding on a set of RNA conformations improves the native sequence recovery rate compared to single-structure model.
To this end, we propose to generate a final RNA sequence by conditioning on multiple RNA structures generated over the course of flow matching inference. This inverse folding model, referred to as <text font="bold">Trajectory-to-Seq (Traj-to-Seq)</text>, is a multi-graph neural network which can handle multiple RNA conformation inputs. Its architecture is detailed in section <ref labelref="LABEL:sec:3.3">3.3</ref>.</p>
      </para>
      <float class="ltx_float_algorithm" framed="top" inlist="loa" labels="LABEL:rnaflow:inference" placement="h" xml:id="alg2">
        <tags>
          <tag><text font="bold">Algorithm 2</text></tag>
          <tag role="autoref">2</tag>
          <tag role="creftype">Algorithm</tag>
          <tag role="creftypecap">Algorithm</tag>
          <tag role="creftypeplural">Algorithms</tag>
          <tag role="creftypepluralcap">Algorithms</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Algorithm 2</tag>
        </tags>
        <toccaption><tag close=" ">2</tag>RNAFlow-Traj: Inference</toccaption>
        <caption><tag close=" "><text font="bold">Algorithm 2</text></tag> RNAFlow-Traj: Inference</caption>
        <p class="ltx_figure_panel"><text font="bold">Require:<Math mode="inline" tex="\{p_{i}\}_{\forall i}" text="(set@(p _ i)) _ (for-all@(i))" xml:id="alg2.m1">
              <XMath>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg2.m1.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok font="medium" role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg2.m1.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="medium italic" role="UNKNOWN">p</XMTok>
                        <XMTok font="medium italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok font="medium" role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok font="medium" fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                    <XMTok font="medium italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
              </XMath>
            </Math></text>, <Math mode="inline" tex="\vec{P}_{1}" text="(vec@(P)) _ 1" xml:id="alg2.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Position <Math mode="inline" tex="\vec{P}_{0}" text="(vec@(P)) _ 0" xml:id="alg2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
            </XMath>
          </Math> by aligning <Math mode="inline" tex="\vec{P}_{1}" text="(vec@(P)) _ 1" xml:id="alg2.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> with RF2NA pose guess</p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Sample prior <Math mode="inline" tex="\vec{R}_{0}\sim\mathcal{N}(0,I_{3})^{L_{r}}" text="(vec@(R)) _ 0 similar-to N * (open-interval@(0, I _ 3)) ^ (L _ r)" xml:id="alg2.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="caligraphic" role="UNKNOWN">N</XMTok>
                  <XMApp>
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMDual>
                      <XMApp>
                        <XMTok meaning="open-interval"/>
                        <XMRef idref="alg2.m5.1"/>
                        <XMRef idref="alg2.m5.2"/>
                      </XMApp>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMTok meaning="0" role="NUMBER" xml:id="alg2.m5.1">0</XMTok>
                        <XMTok role="PUNCT">,</XMTok>
                        <XMApp xml:id="alg2.m5.2">
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">I</XMTok>
                          <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Initialize <Math mode="inline" tex="traj\leftarrow[]" text="t * r * a * j leftarrow list@()" xml:id="alg2.m6">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok font="italic" role="UNKNOWN">r</XMTok>
                  <XMTok font="italic" role="UNKNOWN">a</XMTok>
                  <XMTok font="italic" role="UNKNOWN">j</XMTok>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="list"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><text font="bold">for<Math mode="inline" tex="n\leftarrow 1" text="n leftarrow 1" xml:id="alg2.m7">
              <XMath>
                <XMApp>
                  <XMTok font="medium" name="leftarrow" role="ARROW">←</XMTok>
                  <XMTok font="medium italic" role="UNKNOWN">n</XMTok>
                  <XMTok font="medium" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMath>
            </Math></text> <text font="bold">to</text> <Math mode="inline" tex="N" text="N" xml:id="alg2.m8">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Let <Math mode="inline" tex="t_{2}\leftarrow n/N" text="t _ 2 leftarrow n / N" xml:id="alg2.m9">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMTok font="italic" role="UNKNOWN">n</XMTok>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="t_{1}\leftarrow(n-1)/N" text="t _ 1 leftarrow (n - 1) / N" xml:id="alg2.m10">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok meaning="divide" role="MULOP">/</XMTok>
                  <XMDual>
                    <XMRef idref="alg2.m10.1"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="alg2.m10.1">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok font="italic" role="UNKNOWN">n</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><Math mode="inline" tex="\{\hat{r}_{i}\}_{\forall i}\leftarrow\text{{Noise-to-Seq}}\{[\vec{P}_{t_{1}},%&#10;\vec{R}_{t_{1}}],\{p_{i}\}_{\forall i},t_{1}\}" text="(set@((hat@(r)) _ i)) _ (for-all@(i)) leftarrow [Noise-to-Seq] * set@(closed-interval@((vec@(P)) _ t _ 1, (vec@(R)) _ t _ 1), (set@(p _ i)) _ (for-all@(i)), t _ 1)" xml:id="alg2.m11">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg2.m11.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg2.m11.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText><text font="bold">Noise-to-Seq</text></XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg2.m11.2"/>
                      <XMRef idref="alg2.m11.3"/>
                      <XMRef idref="alg2.m11.4"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMDual xml:id="alg2.m11.2">
                        <XMApp>
                          <XMTok meaning="closed-interval"/>
                          <XMRef idref="alg2.m11.2.1"/>
                          <XMRef idref="alg2.m11.2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">[</XMTok>
                          <XMApp xml:id="alg2.m11.2.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                              <XMTok font="italic" role="UNKNOWN">P</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="alg2.m11.2.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">]</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg2.m11.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="set"/>
                            <XMRef idref="alg2.m11.3.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">{</XMTok>
                            <XMApp xml:id="alg2.m11.3.1">
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">p</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                            <XMTok role="CLOSE" stretchy="false">}</XMTok>
                          </XMWrap>
                        </XMDual>
                        <XMApp>
                          <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg2.m11.4">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Predict [<Math mode="inline" tex="\hat{P}_{1}" text="(hat@(P)) _ 1" xml:id="alg2.m12">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math class="ltx_math_unparsed" mode="inline" tex="\hat{R}_{1}]\leftarrow\text{RF2NA}\{\{\hat{r}_{i}\}_{\forall i},\text{protein %&#10;MSA}\}" xml:id="alg2.m13">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMTok role="CLOSE" stretchy="false">]</XMTok>
              <XMTok name="leftarrow" role="ARROW">←</XMTok>
              <XMText>RF2NA</XMText>
              <XMTok role="OPEN" stretchy="false">{</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">{</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                      <XMTok font="italic" role="UNKNOWN">r</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">}</XMTok>
                </XMWrap>
                <XMApp>
                  <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
              <XMTok role="PUNCT">,</XMTok>
              <XMText>protein MSA</XMText>
              <XMTok role="CLOSE" stretchy="false">}</XMTok>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Append <Math mode="inline" tex="\hat{R}_{1}" text="(hat@(R)) _ 1" xml:id="alg2.m14">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
            </XMath>
          </Math> to <Math mode="inline" tex="traj" text="t * r * a * j" xml:id="alg2.m15">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Interpolate <Math mode="inline" tex="\vec{R}_{t_{2}}\leftarrow\vec{R}_{t_{1}}+\frac{(\hat{R}_{1}-\vec{R}_{t_{1}})}{%&#10;(1-t_{1})}*(t_{2}-t_{1})" text="(vec@(R)) _ t _ 2 leftarrow (vec@(R)) _ t _ 1 + (((hat@(R)) _ 1 - (vec@(R)) _ t _ 1) / (1 - t _ 1)) * (t _ 2 - t _ 1)" xml:id="alg2.m16">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="plus" role="ADDOP">+</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">∗</XMTok>
                    <XMApp>
                      <XMTok mathstyle="text" meaning="divide" role="FRACOP"/>
                      <XMDual>
                        <XMRef idref="alg2.m16.1"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="alg2.m16.1">
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMApp>
                                <XMTok fontsize="70%" name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                              </XMApp>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMApp>
                                <XMTok fontsize="70%" name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                              </XMApp>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                                <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                              </XMApp>
                            </XMApp>
                          </XMApp>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMDual>
                        <XMRef idref="alg2.m16.2"/>
                        <XMWrap>
                          <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="alg2.m16.2">
                            <XMTok fontsize="70%" meaning="minus" role="ADDOP">-</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                              <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMDual>
                      <XMRef idref="alg2.m16.3"/>
                      <XMWrap>
                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                        <XMApp xml:id="alg2.m16.3">
                          <XMTok meaning="minus" role="ADDOP">-</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                            <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                          </XMApp>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">t</XMTok>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
<!--  %**** method.tex Line 100 **** -->        <p class="ltx_figure_panel">Align <Math mode="inline" tex="\vec{P}_{t_{2}}\leftarrow\text{Kabsch}(\vec{P}_{1},\hat{P}_{1})" text="(vec@(P)) _ t _ 2 leftarrow [Kabsch] * open-interval@((vec@(P)) _ 1, (hat@(P)) _ 1)" xml:id="alg2.m17">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">P</XMTok>
                  </XMApp>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    <XMTok fontsize="50%" meaning="2" role="NUMBER">2</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText>Kabsch</XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="open-interval"/>
                      <XMRef idref="alg2.m17.1"/>
                      <XMRef idref="alg2.m17.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="alg2.m17.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                          <XMTok font="italic" role="UNKNOWN">P</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="PUNCT">,</XMTok>
                      <XMApp xml:id="alg2.m17.2">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">P</XMTok>
                        </XMApp>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><text font="bold">end</text> <text font="bold">for</text></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel">Predict <Math mode="inline" tex="\{\hat{r}_{i}\}_{\forall i}\leftarrow\text{{Traj-to-Seq}}\{traj\}" text="(set@((hat@(r)) _ i)) _ (for-all@(i)) leftarrow [Traj-to-Seq] * set@(t * r * a * j)" xml:id="alg2.m18">
            <XMath>
              <XMApp>
                <XMTok name="leftarrow" role="ARROW">←</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg2.m18.1"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg2.m18.1">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                          <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMText><text font="bold">Traj-to-Seq</text></XMText>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="alg2.m18.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="alg2.m18.2">
                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                        <XMTok font="italic" role="UNKNOWN">a</XMTok>
                        <XMTok font="italic" role="UNKNOWN">j</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math></p>
        <break class="ltx_break"/>
        <p class="ltx_figure_panel"><text font="bold">Outputs:</text> <Math mode="inline" tex="\{\hat{r}_{i}\}_{\forall i}" text="(set@((hat@(r)) _ i)) _ (for-all@(i))" xml:id="alg2.m19">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="alg2.m19.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="alg2.m19.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="traj[-1]" text="t * r * a * j * delimited-[]@(- 1)" xml:id="alg2.m20">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">t</XMTok>
                <XMTok font="italic" role="UNKNOWN">r</XMTok>
                <XMTok font="italic" role="UNKNOWN">a</XMTok>
                <XMTok font="italic" role="UNKNOWN">j</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="alg2.m20.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="alg2.m20.1">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMTok meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math></p>
      </float>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:3.2" xml:id="S3.SS2">
      <tags>
        <tag>3.2</tag>
        <tag role="autoref">subsection 3.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">3.2</tag>
        <tag role="typerefnum">§3.2</tag>
      </tags>
      <title><tag close=" ">3.2</tag>Noise-to-Seq Module</title>
      <para xml:id="S3.SS2.p1">
        <p>Noise-to-Seq is a graph-based RNA inverse folding model, fine-tuned to predict RNA sequences autoregressively from noised structures. As in <cite class="ltx_citemacro_citet"><bibref bibrefs="ingraham2019generative" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite> and <cite class="ltx_citemacro_citet"><bibref bibrefs="jing2021equivariant" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, the model applies an encoder-decoder architecture where the encoder learns a representation of the protein-RNA complex structure and the decoder predicts a distribution over nucleotides at each position <Math mode="inline" tex="i" text="i" xml:id="S3.SS2.p1.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math>, given sequence information of all positions before <Math mode="inline" tex="i" text="i" xml:id="S3.SS2.p1.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S3.SS2.p2">
        <p><text font="bold">Graph Representation.</text> We represent each backbone 3D point cloud [<Math mode="inline" tex="\vec{P}" text="vec@(P)" xml:id="S3.SS2.p2.m1">
            <XMath>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
              </XMApp>
            </XMath>
          </Math>, <Math mode="inline" tex="\vec{R}" text="vec@(R)" xml:id="S3.SS2.p2.m2">
            <XMath>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math>] as a graph <Math mode="inline" tex="\mathcal{G}=(\mathcal{V},\mathcal{E})" text="G = open-interval@(V, E)" xml:id="S3.SS2.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="S3.SS2.p2.m3.1"/>
                    <XMRef idref="S3.SS2.p2.m3.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.SS2.p2.m3.1">V</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.SS2.p2.m3.2">E</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. Each amino acid <Math mode="inline" tex="i" text="i" xml:id="S3.SS2.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math> is assigned a node at <Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="S3.SS2.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
              </XMApp>
            </XMath>
          </Math> coordinate <Math mode="inline" tex="\vec{x_{i}}\in\vec{P}" text="vec@(x _ i) element-of vec@(P)" xml:id="S3.SS2.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, and each nucleotide <Math mode="inline" tex="j" text="j" xml:id="S3.SS2.p2.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math> is assigned a node at <Math mode="inline" tex="C_{4}^{\prime}" text="(C _ 4) ^ prime" xml:id="S3.SS2.p2.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> coordinate <Math mode="inline" tex="\vec{x_{j}}\in\vec{R}" text="vec@(x _ j) element-of vec@(R)" xml:id="S3.SS2.p2.m9">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Node features are denoted as <Math mode="inline" tex="\mathcal{V}=\{v_{1},\ldots,v_{L_{p}+L_{r}}\}" text="V = set@(v _ 1, ldots, v _ (L _ p + L _ r))" xml:id="S3.SS2.p2.m10">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">V</XMTok>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS2.p2.m10.2"/>
                    <XMRef idref="S3.SS2.p2.m10.1"/>
                    <XMRef idref="S3.SS2.p2.m10.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m10.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">v</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMTok name="ldots" role="ID" xml:id="S3.SS2.p2.m10.1">…</XMTok>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m10.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">v</XMTok>
                      <XMApp>
                        <XMTok fontsize="70%" meaning="plus" role="ADDOP">+</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">p</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>. As shown in Figure <ref labelref="LABEL:fig:1">1</ref>, for all nodes <Math mode="inline" tex="\vec{x}_{i}\in\vec{P}" text="(vec@(x)) _ i element-of vec@(P)" xml:id="S3.SS2.p2.m11">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we draw edges to <Math mode="inline" tex="10" text="10" xml:id="S3.SS2.p2.m12">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> nearest neighbor nodes whose 3D coordinates are also in <Math mode="inline" tex="\vec{P}" text="vec@(P)" xml:id="S3.SS2.p2.m13">
            <XMath>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">P</XMTok>
              </XMApp>
            </XMath>
          </Math>. Likewise for all nodes <Math mode="inline" tex="\vec{x}_{i}\in\vec{R}" text="(vec@(x)) _ i element-of vec@(R)" xml:id="S3.SS2.p2.m14">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we draw edges to <Math mode="inline" tex="10" text="10" xml:id="S3.SS2.p2.m15">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> nearest neighbor nodes whose 3D coordinates are also in <Math mode="inline" tex="\vec{R}" text="vec@(R)" xml:id="S3.SS2.p2.m16">
            <XMath>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
            </XMath>
          </Math>. For all nodes <Math mode="inline" tex="\vec{x}_{i}\in\vec{P}" text="(vec@(x)) _ i element-of vec@(P)" xml:id="S3.SS2.p2.m17">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">P</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we additionally draw edges to <Math mode="inline" tex="5" text="5" xml:id="S3.SS2.p2.m18">
            <XMath>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMath>
          </Math> nearest neighbor nodes <Math mode="inline" tex="\vec{x}_{j}\in\vec{R}" text="(vec@(x)) _ j element-of vec@(R)" xml:id="S3.SS2.p2.m19">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. Nearest neighbors are computed by <Math mode="inline" tex="\|\vec{x}_{i}-\vec{x}_{j}\|_{2}" text="(norm@((vec@(x)) _ i - (vec@(x)) _ j)) _ 2" xml:id="S3.SS2.p2.m20">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="norm"/>
                    <XMRef idref="S3.SS2.p2.m20.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok name="||" role="OPEN">‖</XMTok>
                    <XMApp xml:id="S3.SS2.p2.m20.1">
                      <XMTok meaning="minus" role="ADDOP">-</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                          <XMTok font="italic" role="UNKNOWN">x</XMTok>
                        </XMApp>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok name="||" role="CLOSE">‖</XMTok>
                  </XMWrap>
                </XMDual>
                <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
              </XMApp>
            </XMath>
          </Math>. Edge features are denoted as <Math mode="inline" tex="\mathcal{E}=\{e_{i,j}\}_{i\neq j}" text="E = (set@(e _ (list@(i, j)))) _ (i not-equals j)" xml:id="S3.SS2.p2.m21">
            <XMath>
              <XMApp>
                <XMTok meaning="equals" role="RELOP">=</XMTok>
                <XMTok font="caligraphic" role="UNKNOWN">E</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="set"/>
                      <XMRef idref="S3.SS2.p2.m21.3"/>
                    </XMApp>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">{</XMTok>
                      <XMApp xml:id="S3.SS2.p2.m21.3">
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">e</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.SS2.p2.m21.1"/>
                            <XMRef idref="S3.SS2.p2.m21.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p2.m21.1">i</XMTok>
                            <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p2.m21.2">j</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">}</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S3.SS2.p3">
        <p><text font="bold">Node &amp; Edge Features</text>. We compute node features and edge features as follows. Node vector features include unit vectors to neighboring nodes on the backbone chain and unit vectors to the remaining two atoms of the nucleotide (<Math mode="inline" tex="P" text="P" xml:id="S3.SS2.p3.m1">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">P</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="N_{1}/N_{9}" text="N _ 1 / N _ 9" xml:id="S3.SS2.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">N</XMTok>
                  <XMTok fontsize="70%" meaning="9" role="NUMBER">9</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>) or amino acid (<Math mode="inline" tex="N" text="N" xml:id="S3.SS2.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">N</XMTok>
            </XMath>
          </Math> and <Math mode="inline" tex="C" text="C" xml:id="S3.SS2.p3.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">C</XMTok>
            </XMath>
          </Math>). Node scalar features include magnitudes of all vector features, encoded by radial basis functions, and a one hot encoding of residue identity for the protein chain. Edge vector features include a unit vector from the source node to the destination node, and its magnitude encoded by radial basis functions is a scalar feature. Edge scalar features also include distance along the backbone between the source and destination, encoded with a sinusoidal embedding. If the edge connects nodes in two different chains, the encoded number is equal to <Math mode="inline" tex="L_{p}+L_{r}" text="L _ p + L _ r" xml:id="S3.SS2.p3.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:2" placement="ht" xml:id="S3.F2">
        <tags>
          <tag>Figure 2</tag>
          <tag role="autoref">Figure 2</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">2</tag>
          <tag role="typerefnum">Figure 2</tag>
        </tags>
        <graphics candidates="traj-to-seq.png" class="ltx_centering" graphic="traj-to-seq.png" options="width=867.23999pt,keepaspectratio=true" xml:id="S3.F2.g1"/>
        <toccaption class="ltx_centering"><tag close=" "><!--  %**** method.tex Line 125 **** -->2<!--  %**** method.tex Line 125 **** 
     %**** method.tex Line 125 **** 
     %**** method.tex Line 125 **** 
     %**** method.tex Line 125 **** 
     %**** method.tex Line 125 **** --></tag><!--  %**** method.tex Line 125 **** -->One forward pass during Traj-to-Seq inference. A subset of structures from a flow matching trajectory are encoded by a multi-GNN and pooled in an order-invariant manner to predict an RNA sequence.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 2</tag><!--  %**** method.tex Line 125 **** 
     %**** method.tex Line 125 **** -->One forward pass during Traj-to-Seq inference. A subset of structures from a flow matching trajectory are encoded by a multi-GNN and pooled in an order-invariant manner to predict an RNA sequence.<!--  %**** method.tex Line 125 **** 
     %**** method.tex Line 125 **** --></caption>
      </figure>
      <para xml:id="S3.SS2.p4">
        <p><text font="bold">Model Architecture.</text> Noise-to-Seq contains a message-passing encoder consisting of GVP-GNN layers <cite class="ltx_citemacro_citep">(<bibref bibrefs="jing2020learning" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. First, input node features <Math mode="inline" tex="v_{i}" text="v _ i" xml:id="S3.SS2.p4.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">v</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
              </XMApp>
            </XMath>
          </Math> and edge features <Math mode="inline" tex="\{e_{i,j}\}_{i\neq j}" text="(set@(e _ (list@(i, j)))) _ (i not-equals j)" xml:id="S3.SS2.p4.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S3.SS2.p4.m2.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S3.SS2.p4.m2.3">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="list"/>
                          <XMRef idref="S3.SS2.p4.m2.1"/>
                          <XMRef idref="S3.SS2.p4.m2.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p4.m2.1">i</XMTok>
                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS2.p4.m2.2">j</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="not-equals" name="neq" role="RELOP">≠</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> are encoded by GVPs.</p>
        <equationgroup class="ltx_eqn_align" xml:id="A3.EGx1">
          <equation xml:id="S3.Ex1">
            <MathFork>
              <Math tex="\displaystyle h_{v_{i}}=g_{v}(\text{LayerNorm}(v_{i}))" text="h _ v _ i = g _ v * [LayerNorm] * v _ i" xml:id="S3.Ex1.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S3.Ex1.m3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.Ex1.m3.1">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>LayerNorm</XMText>
                            <XMDual>
                              <XMRef idref="S3.Ex1.m3.1.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.Ex1.m3.1.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">v</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle h_{v_{i}}" text="h _ v _ i" xml:id="S3.Ex1.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=g_{v}(\text{LayerNorm}(v_{i}))" text="absent = g _ v * [LayerNorm] * v _ i" xml:id="S3.Ex1.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.Ex1.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.Ex1.m2.1">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>LayerNorm</XMText>
                                <XMDual>
                                  <XMRef idref="S3.Ex1.m2.1.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.Ex1.m2.1.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">v</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation xml:id="S3.Ex2">
            <MathFork>
              <Math tex="\displaystyle h_{e_{i,j}}=g_{e}(\text{LayerNorm}(e_{i,j}))" text="h _ e _ (list@(i, j)) = g _ e * [LayerNorm] * e _ (list@(i, j))" xml:id="S3.Ex2.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">h</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="list"/>
                            <XMRef idref="S3.Ex2.m3.1"/>
                            <XMRef idref="S3.Ex2.m3.2"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex2.m3.1">i</XMTok>
                            <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex2.m3.2">j</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">g</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                      </XMApp>
                      <XMDual>
                        <XMRef idref="S3.Ex2.m3.5"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.Ex2.m3.5">
                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                            <XMText>LayerNorm</XMText>
                            <XMDual>
                              <XMRef idref="S3.Ex2.m3.5.1"/>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">(</XMTok>
                                <XMApp xml:id="S3.Ex2.m3.5.1">
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="S3.Ex2.m3.3"/>
                                      <XMRef idref="S3.Ex2.m3.4"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Ex2.m3.3">i</XMTok>
                                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Ex2.m3.4">j</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                                <XMTok role="CLOSE" stretchy="false">)</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle h_{e_{i,j}}" text="h _ e _ (list@(i, j))" xml:id="S3.Ex2.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="list"/>
                              <XMRef idref="S3.Ex2.m1.1"/>
                              <XMRef idref="S3.Ex2.m1.2"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex2.m1.1">i</XMTok>
                              <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex2.m1.2">j</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=g_{e}(\text{LayerNorm}(e_{i,j}))" text="absent = g _ e * [LayerNorm] * e _ (list@(i, j))" xml:id="S3.Ex2.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                          </XMApp>
                          <XMDual>
                            <XMRef idref="S3.Ex2.m2.3"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.Ex2.m2.3">
                                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                <XMText>LayerNorm</XMText>
                                <XMDual>
                                  <XMRef idref="S3.Ex2.m2.3.1"/>
                                  <XMWrap>
                                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                                    <XMApp xml:id="S3.Ex2.m2.3.1">
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">e</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="S3.Ex2.m2.1"/>
                                          <XMRef idref="S3.Ex2.m2.2"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Ex2.m2.1">i</XMTok>
                                          <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.Ex2.m2.2">j</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                  </XMWrap>
                                </XMDual>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p>Node embedding GVP <Math mode="inline" tex="g_{v}" text="g _ v" xml:id="S3.SS2.p4.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
              </XMApp>
            </XMath>
          </Math> and edge embedding GVP <Math mode="inline" tex="g_{e}" text="g _ e" xml:id="S3.SS2.p4.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
              </XMApp>
            </XMath>
          </Math> apply the vector gating strategy proposed by <cite class="ltx_citemacro_citet"><bibref bibrefs="jing2021equivariant" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. If the input structure is noised, we add a timestep embedding to the node features, encoded by random Fourier features of size <Math mode="inline" tex="256" text="256" xml:id="S3.SS2.p4.m5">
            <XMath>
              <XMTok meaning="256" role="NUMBER">256</XMTok>
            </XMath>
          </Math> <cite class="ltx_citemacro_citep">(<bibref bibrefs="tancik2020fourier" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> and concatenated onto the scalar component of <Math mode="inline" tex="h_{v_{i}}" text="h _ v _ i" xml:id="S3.SS2.p4.m6">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. For every position <Math mode="inline" tex="i" text="i" xml:id="S3.SS2.p4.m7">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">i</XMTok>
            </XMath>
          </Math>, <Math mode="inline" tex="h_{v_{i}}" text="h _ v _ i" xml:id="S3.SS2.p4.m8">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is residually updated by a sequence of three message-passing layers where each layer has the following architecture:</p>
        <equationgroup class="ltx_eqn_align" xml:id="A3.EGx2">
          <equation xml:id="S3.Ex3">
            <MathFork>
              <Math tex="\displaystyle m_{v_{i}}=\frac{1}{|\mathcal{N}|}\sum_{j\in\mathcal{N}}g_{MSG}(h%&#10;_{v_{i}},h_{v_{j}},h_{e_{i,j}})" text="m _ v _ i = (1 / absolute-value@(N)) * (sum _ (j element-of N))@(g _ (M * S * G) * vector@(h _ v _ i, h _ v _ j, h _ e _ (list@(i, j))))" xml:id="S3.Ex3.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">m</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                        <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMApp>
                        <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMDual>
                          <XMApp>
                            <XMTok meaning="absolute-value"/>
                            <XMRef idref="S3.Ex3.m3.1"/>
                          </XMApp>
                          <XMWrap>
                            <XMTok role="OPEN" stretchy="false">|</XMTok>
                            <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.Ex3.m3.1">N</XMTok>
                            <XMTok role="CLOSE" stretchy="false">|</XMTok>
                          </XMWrap>
                        </XMDual>
                      </XMApp>
                      <XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                          <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                          <XMApp>
                            <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                            <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">N</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">g</XMTok>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">S</XMTok>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">G</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMDual>
                            <XMApp>
                              <XMTok meaning="vector"/>
                              <XMRef idref="S3.Ex3.m3.4"/>
                              <XMRef idref="S3.Ex3.m3.5"/>
                              <XMRef idref="S3.Ex3.m3.6"/>
                            </XMApp>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.Ex3.m3.4">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.Ex3.m3.5">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">j</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMTok role="PUNCT">,</XMTok>
                              <XMApp xml:id="S3.Ex3.m3.6">
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                                  <XMDual>
                                    <XMApp>
                                      <XMTok meaning="list"/>
                                      <XMRef idref="S3.Ex3.m3.2"/>
                                      <XMRef idref="S3.Ex3.m3.3"/>
                                    </XMApp>
                                    <XMWrap>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex3.m3.2">i</XMTok>
                                      <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex3.m3.3">j</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle m_{v_{i}}" text="m _ v _ i" xml:id="S3.Ex3.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">m</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=\frac{1}{|\mathcal{N}|}\sum_{j\in\mathcal{N}}g_{MSG}(h_{v_{i}},h%&#10;_{v_{j}},h_{e_{i,j}})" text="absent = (1 / absolute-value@(N)) * (sum _ (j element-of N))@(g _ (M * S * G) * vector@(h _ v _ i, h _ v _ j, h _ e _ (list@(i, j))))" xml:id="S3.Ex3.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMApp>
                            <XMTok mathstyle="display" meaning="divide" role="FRACOP"/>
                            <XMTok meaning="1" role="NUMBER">1</XMTok>
                            <XMDual>
                              <XMApp>
                                <XMTok meaning="absolute-value"/>
                                <XMRef idref="S3.Ex3.m2.1"/>
                              </XMApp>
                              <XMWrap>
                                <XMTok role="OPEN" stretchy="false">|</XMTok>
                                <XMTok font="caligraphic" role="UNKNOWN" xml:id="S3.Ex3.m2.1">N</XMTok>
                                <XMTok role="CLOSE" stretchy="false">|</XMTok>
                              </XMWrap>
                            </XMDual>
                          </XMApp>
                          <XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="mid1"/>
                              <XMTok mathstyle="display" meaning="sum" role="SUMOP" scriptpos="mid">∑</XMTok>
                              <XMApp>
                                <XMTok fontsize="70%" meaning="element-of" name="in" role="RELOP">∈</XMTok>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                                <XMTok font="caligraphic" fontsize="70%" role="UNKNOWN">N</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">S</XMTok>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">G</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="vector"/>
                                  <XMRef idref="S3.Ex3.m2.4"/>
                                  <XMRef idref="S3.Ex3.m2.5"/>
                                  <XMRef idref="S3.Ex3.m2.6"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.Ex3.m2.4">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S3.Ex3.m2.5">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">j</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="S3.Ex3.m2.6">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">e</XMTok>
                                      <XMDual>
                                        <XMApp>
                                          <XMTok meaning="list"/>
                                          <XMRef idref="S3.Ex3.m2.2"/>
                                          <XMRef idref="S3.Ex3.m2.3"/>
                                        </XMApp>
                                        <XMWrap>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex3.m2.2">i</XMTok>
                                          <XMTok fontsize="50%" role="PUNCT">,</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN" xml:id="S3.Ex3.m2.3">j</XMTok>
                                        </XMWrap>
                                      </XMDual>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
          <equation labels="LABEL:update" xml:id="S3.Ex4">
            <MathFork>
              <Math tex="\displaystyle h_{v_{i}}^{{}^{\prime}}=\text{LayerNorm}(h_{v_{i}}+\text{Dropout%&#10;}(m_{v_{i}}))" text="(h _ v _ i) ^ ^prime = [LayerNorm] * (h _ v _ i + [Dropout] * m _ v _ i)" xml:id="S3.Ex4.m3">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                        <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>LayerNorm</XMText>
                      <XMDual>
                        <XMRef idref="S3.Ex4.m3.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.Ex4.m3.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                              <XMTok font="italic" role="UNKNOWN">h</XMTok>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>Dropout</XMText>
                              <XMDual>
                                <XMRef idref="S3.Ex4.m3.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.Ex4.m3.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle h_{v_{i}}^{{}^{\prime}}" text="(h _ v _ i) ^ ^prime" xml:id="S3.Ex4.m1">
                    <XMath>
                      <XMApp>
                        <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                          <XMTok font="italic" role="UNKNOWN">h</XMTok>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                            <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                          <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
                <td align="left"><Math mode="inline" tex="\displaystyle=\text{LayerNorm}(h_{v_{i}}+\text{Dropout}(m_{v_{i}}))" text="absent = [LayerNorm] * (h _ v _ i + [Dropout] * m _ v _ i)" xml:id="S3.Ex4.m2">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMTok meaning="absent"/>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText>LayerNorm</XMText>
                          <XMDual>
                            <XMRef idref="S3.Ex4.m2.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.Ex4.m2.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>Dropout</XMText>
                                  <XMDual>
                                    <XMRef idref="S3.Ex4.m2.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.Ex4.m2.1.1">
                                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                        <XMTok font="italic" role="UNKNOWN">m</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                        </XMApp>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p><Math mode="inline" tex="g_{MSG}" text="g _ (M * S * G)" xml:id="S3.SS2.p4.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">M</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">S</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">G</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a sequence of three GVPs with vector gating and ReLU activation on the scalar features. After each message-passing layer, we also apply pointwise feedforward updates to the node embedding.</p>
        <equationgroup class="ltx_eqn_align" xml:id="A3.EGx3">
          <equation xml:id="S3.Ex5">
            <MathFork>
              <Math tex="\displaystyle h_{v_{i}}^{{}^{\prime}}=\text{LayerNorm}(h_{v_{i}}^{{}^{\prime}}%&#10;+\text{Dropout}(g_{FF}(h_{v_{i}}^{{}^{\prime}})))" text="(h _ v _ i) ^ ^prime = [LayerNorm] * ((h _ v _ i) ^ ^prime + [Dropout] * g _ (F * F) * (h _ v _ i) ^ ^prime)" xml:id="S3.Ex5.m2">
                <XMath>
                  <XMApp>
                    <XMTok meaning="equals" role="RELOP">=</XMTok>
                    <XMApp>
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">h</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                        <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>LayerNorm</XMText>
                      <XMDual>
                        <XMRef idref="S3.Ex5.m2.1"/>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="S3.Ex5.m2.1">
                            <XMTok meaning="plus" role="ADDOP">+</XMTok>
                            <XMApp>
                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                              <XMApp>
                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                <XMApp>
                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                </XMApp>
                              </XMApp>
                              <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                              </XMApp>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>Dropout</XMText>
                              <XMDual>
                                <XMRef idref="S3.Ex5.m2.1.1"/>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="S3.Ex5.m2.1.1">
                                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                      <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                      <XMApp>
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                      </XMApp>
                                    </XMApp>
                                    <XMDual>
                                      <XMRef idref="S3.Ex5.m2.1.1.1"/>
                                      <XMWrap>
                                        <XMTok role="OPEN" stretchy="false">(</XMTok>
                                        <XMApp xml:id="S3.Ex5.m2.1.1.1">
                                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                          <XMApp>
                                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                            <XMApp>
                                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                            </XMApp>
                                          </XMApp>
                                          <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                                            <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                      </XMWrap>
                                    </XMDual>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                </XMath>
              </Math>
              <MathBranch>
                <td align="right"><Math mode="inline" tex="\displaystyle h_{v_{i}}^{{}^{\prime}}=\text{LayerNorm}(h_{v_{i}}^{{}^{\prime}}%&#10;+\text{Dropout}(g_{FF}(h_{v_{i}}^{{}^{\prime}})))" text="(h _ v _ i) ^ ^prime = [LayerNorm] * ((h _ v _ i) ^ ^prime + [Dropout] * g _ (F * F) * (h _ v _ i) ^ ^prime)" xml:id="S3.Ex5.m1">
                    <XMath>
                      <XMApp>
                        <XMTok meaning="equals" role="RELOP">=</XMTok>
                        <XMApp>
                          <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                          <XMApp>
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMTok font="italic" role="UNKNOWN">h</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                              <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                            <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                          </XMApp>
                        </XMApp>
                        <XMApp>
                          <XMTok meaning="times" role="MULOP">⁢</XMTok>
                          <XMText>LayerNorm</XMText>
                          <XMDual>
                            <XMRef idref="S3.Ex5.m1.1"/>
                            <XMWrap>
                              <XMTok role="OPEN" stretchy="false">(</XMTok>
                              <XMApp xml:id="S3.Ex5.m1.1">
                                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                                <XMApp>
                                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                  <XMApp>
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                    <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                    <XMApp>
                                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                    </XMApp>
                                  </XMApp>
                                  <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                                    <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                  </XMApp>
                                </XMApp>
                                <XMApp>
                                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                  <XMText>Dropout</XMText>
                                  <XMDual>
                                    <XMRef idref="S3.Ex5.m1.1.1"/>
                                    <XMWrap>
                                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                                      <XMApp xml:id="S3.Ex5.m1.1.1">
                                        <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                        <XMApp>
                                          <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                          <XMTok font="italic" role="UNKNOWN">g</XMTok>
                                          <XMApp>
                                            <XMTok meaning="times" role="MULOP">⁢</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                            <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                                          </XMApp>
                                        </XMApp>
                                        <XMDual>
                                          <XMRef idref="S3.Ex5.m1.1.1.1"/>
                                          <XMWrap>
                                            <XMTok role="OPEN" stretchy="false">(</XMTok>
                                            <XMApp xml:id="S3.Ex5.m1.1.1.1">
                                              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                                              <XMApp>
                                                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                                                <XMTok font="italic" role="UNKNOWN">h</XMTok>
                                                <XMApp>
                                                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                                                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                                                </XMApp>
                                              </XMApp>
                                              <XMApp role="FLOATSUPERSCRIPT" scriptpos="2">
                                                <XMTok fontsize="50%" name="prime" role="SUPOP">′</XMTok>
                                              </XMApp>
                                            </XMApp>
                                            <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                          </XMWrap>
                                        </XMDual>
                                      </XMApp>
                                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                    </XMWrap>
                                  </XMDual>
                                </XMApp>
                              </XMApp>
                              <XMTok role="CLOSE" stretchy="false">)</XMTok>
                            </XMWrap>
                          </XMDual>
                        </XMApp>
                      </XMApp>
                    </XMath>
                  </Math></td>
              </MathBranch>
            </MathFork>
          </equation>
        </equationgroup>
        <p><Math mode="inline" tex="g_{FF}" text="g _ (F * F)" xml:id="S3.SS2.p4.m10">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">g</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">⁢</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">F</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> is a sequence of two GVPs with vector gating and the ReLU activation on the scalar features. We then encode protein and RNA sequence information with an embedding layer and concatenate these features onto the edge scalar features. By the autoregressive scheme, we mask out sequence features for edges where the source node’s position is greater than the destination node’s position. The protein nodes are always positioned before RNA nodes, so protein sequence context is always present during decoding. Our decoder’s architecture is identical to the encoder, except that messages are aggregated by a sum instead of a mean. Finally, we apply a GVP layer and softmax to predict probabilities of the <Math mode="inline" tex="4" text="4" xml:id="S3.SS2.p4.m11">
            <XMath>
              <XMTok meaning="4" role="NUMBER">4</XMTok>
            </XMath>
          </Math> nucleotide classes at each position. The model is supervised by a cross entropy loss between the true RNA sequence and predicted nucleotide probabilities.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:3.3" xml:id="S3.SS3">
      <tags>
        <tag>3.3</tag>
        <tag role="autoref">subsection 3.3</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">3.3</tag>
        <tag role="typerefnum">§3.3</tag>
      </tags>
      <title><tag close=" ">3.3</tag>Traj-to-Seq Module</title>
      <para xml:id="S3.SS3.p1">
        <p>As shown in Figure <ref labelref="LABEL:fig:2">2</ref>, the flow matching inference loop generates a trajectory of RNA structures over iterative refinement steps. Traj-to-Seq is a graph-based inverse folding model that predicts RNA sequences based on the output trajectory of a single RNAFlow inference pass. At the final stages of the trajectory, the structures have a high degree of secondary structure similarity while displaying variation in tertiary structure, qualitatively resembling a conformational ensemble <cite class="ltx_citemacro_citep">(<bibref bibrefs="fornili2013specialized" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Therefore, we can leverage the outputs of a single flow matching inference pass as a conformational ensemble approximation.</p>
      </para>
      <para xml:id="S3.SS3.p2">
        <p><text font="bold">Model Inputs.</text> We represent a trajectory of RNA backbones as a set of independent graphs {<Math mode="inline" tex="\mathcal{G}^{(1)},...,\mathcal{G}^{(k)}" text="list@(G ^ 1, ldots, G ^ k)" xml:id="S3.SS3.p2.m1">
            <XMath>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="S3.SS3.p2.m1.4"/>
                  <XMRef idref="S3.SS3.p2.m1.3"/>
                  <XMRef idref="S3.SS3.p2.m1.5"/>
                </XMApp>
                <XMWrap>
                  <XMApp xml:id="S3.SS3.p2.m1.4">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS3.p2.m1.1"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER" xml:id="S3.SS3.p2.m1.1">1</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMTok name="ldots" role="ID" xml:id="S3.SS3.p2.m1.3">…</XMTok>
                  <XMTok role="PUNCT">,</XMTok>
                  <XMApp xml:id="S3.SS3.p2.m1.5">
                    <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
                    <XMDual>
                      <XMRef idref="S3.SS3.p2.m1.2"/>
                      <XMWrap>
                        <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p2.m1.2">k</XMTok>
                        <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                      </XMWrap>
                    </XMDual>
                  </XMApp>
                </XMWrap>
              </XMDual>
            </XMath>
          </Math>} where <Math mode="inline" tex="k" text="k" xml:id="S3.SS3.p2.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> is the number of conformers. Traj-to-Seq does not accept protein information as input, so each node in <Math mode="inline" tex="\mathcal{G}^{(n)}" text="G ^ n" xml:id="S3.SS3.p2.m3">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMTok font="caligraphic" role="UNKNOWN">G</XMTok>
                <XMDual>
                  <XMRef idref="S3.SS3.p2.m3.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p2.m3.1">n</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math> corresponds to a nucleotide <Math mode="inline" tex="j" text="j" xml:id="S3.SS3.p2.m4">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">j</XMTok>
            </XMath>
          </Math> at <Math mode="inline" tex="C_{4}^{\prime}" text="(C _ 4) ^ prime" xml:id="S3.SS3.p2.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> coordinate <Math mode="inline" tex="\vec{x_{j}}\in\vec{R}^{(n)}" text="vec@(x _ j) element-of (vec@(R)) ^ n" xml:id="S3.SS3.p2.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post3"/>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS3.p2.m6.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p2.m6.1">n</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. For all nodes <Math mode="inline" tex="\vec{x}_{j}\in\vec{R}^{(n)}" text="(vec@(x)) _ j element-of (vec@(R)) ^ n" xml:id="S3.SS3.p2.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">x</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">j</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMDual>
                    <XMRef idref="S3.SS3.p2.m7.1"/>
                    <XMWrap>
                      <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p2.m7.1">n</XMTok>
                      <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, we draw edges to <Math mode="inline" tex="10" text="10" xml:id="S3.SS3.p2.m8">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> nearest neighbor nodes whose 3D coordinates are also in <Math mode="inline" tex="\vec{R}^{(n)}" text="(vec@(R)) ^ n" xml:id="S3.SS3.p2.m9">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMDual>
                  <XMRef idref="S3.SS3.p2.m9.1"/>
                  <XMWrap>
                    <XMTok fontsize="70%" role="OPEN" stretchy="false">(</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN" xml:id="S3.SS3.p2.m9.1">n</XMTok>
                    <XMTok fontsize="70%" role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>, so edges are not drawn between conformers. Instead, Traj-to-Seq is designed to operate on “multi-graphs.” As introduced by <cite class="ltx_citemacro_citet"><bibref bibrefs="joshi2023multi" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, a multi-graph is constructed by stacking each RNA graph’s scalar and vector features and building a joint adjacency matrix, computed as the union of each individual graph’s adjacency matrix.</p>
      </para>
      <para xml:id="S3.SS3.p3">
        <p><text font="bold">Architecture.</text> Traj-to-Seq employs the same encoder-decoder architecture as Noise-to-Seq. The GVP encoder processes each structure independently, such that <Math mode="inline" tex="h_{v_{i}}\in\mathbb{R}^{k\times f}" text="h _ v _ i element-of R ^ (k * f)" xml:id="S3.SS3.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="element-of" name="in" role="RELOP">∈</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">h</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">v</XMTok>
                    <XMTok font="italic" fontsize="50%" role="UNKNOWN">i</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="times" role="MULOP">×</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">k</XMTok>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">f</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> where <Math mode="inline" tex="k" text="k" xml:id="S3.SS3.p3.m2">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">k</XMTok>
            </XMath>
          </Math> is the number of conformers and <Math mode="inline" tex="f" text="f" xml:id="S3.SS3.p3.m3">
            <XMath>
              <XMTok font="italic" role="UNKNOWN">f</XMTok>
            </XMath>
          </Math> is the feature dimension. A merged representation is computed by a structure order-invariant mean. Finally, a decoder identical to Noise-to-Seq is employed to predict RNA sequence.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="S3.SS4">
      <tags>
        <tag>3.4</tag>
        <tag role="autoref">subsection 3.4</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">3.4</tag>
        <tag role="typerefnum">§3.4</tag>
      </tags>
      <title><tag close=" ">3.4</tag>Output Rescoring Model</title>
      <para xml:id="S3.SS4.p1">
        <p>Since RNAFlow can be sampled many times to obtain several RNA designs, we train an <text font="italic">output rescoring model</text> to select from amongst the samples based on predicted recovery rate. For training, we generate 6 mutated RNA sequences for each ground-truth protein-RNA complex. Binary labels are generated based on whether or not a generated RNA sequence has a recovery rate <Math mode="inline" tex="\geq 30\%" text="absent &gt;= 30percent" xml:id="S3.SS4.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                  <XMTok meaning="30" role="NUMBER">30</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>. At test time, we evaluate many RNAFlow output samples for a single protein and make selections based on the highest predicted probability of a positive outcome, prioritizing designs with the greatest likelihood of achieving a recovery rate of at least <Math mode="inline" tex="30\%" text="30percent" xml:id="S3.SS4.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="30" role="NUMBER">30</XMTok>
              </XMApp>
            </XMath>
          </Math>.</p>
      </para>
      <para xml:id="S3.SS4.p2">
        <p>The inputs to the output scoring model are protein sequence, protein structure, RNA sequence, and RF2NA-folded RNA structure. The protein and RNA are each encoded by a GVP model with the same architecture as the Noise-to-Seq encoder, and the resulting node-level representations are averaged and processed by a feed-forward network. The output is supervised by a binary cross entropy loss. Hyperparameter and training details are included in the Appendix.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S4">
    <tags>
      <tag>4</tag>
      <tag role="autoref">section 4</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">4</tag>
      <tag role="typerefnum">§4</tag>
    </tags>
    <title><tag close=" ">4</tag>Experiments</title>
    <table inlist="lot" labels="LABEL:tab:1" placement="t!" xml:id="S4.T1">
      <tags>
        <tag>Table 1</tag>
        <tag role="autoref">Table 1</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">1</tag>
        <tag role="typerefnum">Table 1</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">1</text></tag><text fontsize="90%">Structure generation results. We report Mean </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m1">
          <XMath>
            <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
          </XMath>
        </Math><text fontsize="90%"> SEM for RMSD and lDDT. RMSD is computed after Kabsch alignment with the true RNA. lDDT is computed on </text><Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="S4.T1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" fontsize="90%" role="UNKNOWN">C</XMTok>
              <XMTok font="italic" fontsize="63%" name="alpha" role="UNKNOWN">α</XMTok>
            </XMApp>
          </XMath>
        </Math><text fontsize="90%"> atoms.</text></toccaption>
      <caption class="ltx_centering" fontsize="90%"><tag close=": ">Table 1</tag>Structure generation results. We report Mean <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m3">
          <XMath>
            <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
          </XMath>
        </Math> SEM for RMSD and lDDT. RMSD is computed after Kabsch alignment with the true RNA. lDDT is computed on <Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="S4.T1.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">C</XMTok>
              <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
            </XMApp>
          </XMath>
        </Math> atoms.</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <thead>
          <tr>
            <td align="left" border="t" rowspan="2" thead="column row"><text fontsize="90%">Method</text></td>
            <td align="center" border="t" colspan="2" thead="column"><text font="italic" fontsize="90%">RF2NA Pre-Training Split</text></td>
            <td align="center" border="t" colspan="2" thead="column"><text font="italic" fontsize="90%">Sequence Similarity Split</text></td>
          </tr>
          <tr>
            <td align="center" thead="column"><text fontsize="90%">RMSD</text></td>
            <td align="center" thead="column"><text fontsize="90%">lDDT</text></td>
            <td align="center" thead="column"><text fontsize="90%">RMSD</text></td>
            <td align="center" class="ltx_nopad_l" thead="column"><text fontsize="90%">lDDT</text></td>
          </tr>
          <tr>
            <td align="left" border="t" thead="column row"><text fontsize="90%">Conditional MMDiff</text></td>
            <td align="center" border="t" thead="column"><Math mode="inline" tex="14.82\pm 1.01" text="14.82 plus-or-minus 1.01" xml:id="S4.T1.m5">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="14.82" role="NUMBER">14.82</XMTok>
                    <XMTok fontsize="90%" meaning="1.01" role="NUMBER">1.01</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="t" thead="column"><Math mode="inline" tex="0.34\pm 0.02" text="0.34 plus-or-minus 0.02" xml:id="S4.T1.m6">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.34" role="NUMBER">0.34</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="t" thead="column"><Math mode="inline" tex="17.42\pm 0.86" text="17.42 plus-or-minus 0.86" xml:id="S4.T1.m7">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="17.42" role="NUMBER">17.42</XMTok>
                    <XMTok fontsize="90%" meaning="0.86" role="NUMBER">0.86</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
            <td align="center" border="t" class="ltx_nopad_l" thead="column"><Math mode="inline" tex="0.38\pm 0.01" text="0.38 plus-or-minus 0.01" xml:id="S4.T1.m8">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.38" role="NUMBER">0.38</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left" border="t" thead="row"><text fontsize="90%">RNAFlow-Base</text></td>
            <td align="center" border="t"><Math mode="inline" tex="12.85\pm 0.63" text="12.85 plus-or-minus 0.63" xml:id="S4.T1.m9">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="12.85" role="NUMBER">12.85</XMTok>
                    <XMTok fontsize="90%" meaning="0.63" role="NUMBER">0.63</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="t"><Math mode="inline" tex="0.51\pm 0.01" text="0.51 plus-or-minus 0.01" xml:id="S4.T1.m10">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.51" role="NUMBER">0.51</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="t"><Math mode="inline" tex="14.77\pm 0.34" text="14.77 plus-or-minus 0.34" xml:id="S4.T1.m11">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="14.77" role="NUMBER">14.77</XMTok>
                    <XMTok fontsize="90%" meaning="0.34" role="NUMBER">0.34</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
            <td align="center" border="t" class="ltx_nopad_l"><text font="bold" fontsize="90%">0.57</text><text fontsize="90%"> </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m12">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">0.01</text></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">RNAFlow-Traj</text></td>
            <td align="center"><Math mode="inline" tex="13.12\pm 0.64" text="13.12 plus-or-minus 0.64" xml:id="S4.T1.m13">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="13.12" role="NUMBER">13.12</XMTok>
                    <XMTok fontsize="90%" meaning="0.64" role="NUMBER">0.64</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><text fontsize="90%">0.52 </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m14">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> 0.01</text></td>
            <td align="center"><Math mode="inline" tex="15.11\pm 0.33" text="15.11 plus-or-minus 0.33" xml:id="S4.T1.m15">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="15.11" role="NUMBER">15.11</XMTok>
                    <XMTok fontsize="90%" meaning="0.33" role="NUMBER">0.33</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
            <td align="center" class="ltx_nopad_l"><Math mode="inline" tex="0.57\pm 0.00" text="0.57 plus-or-minus 0.00" xml:id="S4.T1.m16">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.57" role="NUMBER">0.57</XMTok>
                    <XMTok fontsize="90%" meaning="0.00" role="NUMBER">0.00</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">RNAFlow-Base + Rescore</text></td>
            <td align="center"><text font="bold" fontsize="90%">10.61</text><text fontsize="90%"> </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m17">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">1.73</text></td>
            <td align="center"><text font="bold" fontsize="90%">0.53</text><text fontsize="90%"> </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m18">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">0.03</text></td>
            <td align="center"><text font="bold" fontsize="90%">14.60</text><text fontsize="90%"> </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T1.m19">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">1.05</text><text fontsize="90%"></text></td>
            <td align="center" class="ltx_nopad_l"><Math mode="inline" tex="0.56\pm 0.02" text="0.56 plus-or-minus 0.02" xml:id="S4.T1.m20">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.56" role="NUMBER">0.56</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">RNAFlow-Traj + Rescore</text></td>
            <td align="center"><Math mode="inline" tex="15.30\pm 1.89" text="15.30 plus-or-minus 1.89" xml:id="S4.T1.m21">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="15.30" role="NUMBER">15.30</XMTok>
                    <XMTok fontsize="90%" meaning="1.89" role="NUMBER">1.89</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="0.52\pm 0.03" text="0.52 plus-or-minus 0.03" xml:id="S4.T1.m22">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.52" role="NUMBER">0.52</XMTok>
                    <XMTok fontsize="90%" meaning="0.03" role="NUMBER">0.03</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="15.31\pm 0.93" text="15.31 plus-or-minus 0.93" xml:id="S4.T1.m23">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="15.31" role="NUMBER">15.31</XMTok>
                    <XMTok fontsize="90%" meaning="0.93" role="NUMBER">0.93</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
            <td align="center" class="ltx_nopad_l"><Math mode="inline" tex="0.56\pm 0.02" text="0.56 plus-or-minus 0.02" xml:id="S4.T1.m24">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.56" role="NUMBER">0.56</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
          <tr>
            <td align="left" border="b t" thead="row"><text fontsize="90%">RF2NA [Upper Bound]</text></td>
            <td align="center" border="b t"><Math mode="inline" tex="4.67\pm 1.29" text="4.67 plus-or-minus 1.29" xml:id="S4.T1.m25">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="4.67" role="NUMBER">4.67</XMTok>
                    <XMTok fontsize="90%" meaning="1.29" role="NUMBER">1.29</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="b t"><Math mode="inline" tex="0.76\pm 0.04" text="0.76 plus-or-minus 0.04" xml:id="S4.T1.m26">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.76" role="NUMBER">0.76</XMTok>
                    <XMTok fontsize="90%" meaning="0.04" role="NUMBER">0.04</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="b t"><Math mode="inline" tex="9.83\pm 1.69" text="9.83 plus-or-minus 1.69" xml:id="S4.T1.m27">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="9.83" role="NUMBER">9.83</XMTok>
                    <XMTok fontsize="90%" meaning="1.69" role="NUMBER">1.69</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
            <td align="center" border="b t" class="ltx_nopad_l"><Math mode="inline" tex="0.79\pm 0.02" text="0.79 plus-or-minus 0.02" xml:id="S4.T1.m28">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.79" role="NUMBER">0.79</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
          </tr>
        </tbody>
      </tabular>
<!--  %**** experiments.tex Line 25 **** -->    </table>
    <table inlist="lot" labels="LABEL:tab:2" placement="h" xml:id="S4.T2">
      <tags>
        <tag>Table 2</tag>
        <tag role="autoref">Table 2</tag>
        <tag role="creftype">Table</tag>
        <tag role="creftypecap">Table</tag>
        <tag role="creftypeplural">Tables</tag>
        <tag role="creftypepluralcap">Tables</tag>
        <tag role="refnum">2</tag>
        <tag role="typerefnum">Table 2</tag>
      </tags>
      <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">2</text></tag><text fontsize="90%">Sequence generation results. We report Mean </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T2.m1">
          <XMath>
            <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
          </XMath>
        </Math><text fontsize="90%"> SEM for native sequence recovery.</text></toccaption>
      <caption class="ltx_centering" fontsize="90%"><tag close=": ">Table 2</tag>Sequence generation results. We report Mean <Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T2.m2">
          <XMath>
            <XMTok meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
          </XMath>
        </Math> SEM for native sequence recovery.</caption>
      <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
        <tbody>
          <tr>
            <td align="left" border="t" rowspan="2" thead="row"><text fontsize="90%">Method</text></td>
            <td align="center" border="t"><text font="italic" fontsize="90%">RF2NA Pre-Training Split</text></td>
            <td align="center" border="t"><text font="italic" fontsize="90%">Sequence Similarity Split</text></td>
          </tr>
          <tr>
            <td align="center"><text fontsize="90%">Recovery</text></td>
            <td align="center"><text fontsize="90%">Recovery</text></td>
          </tr>
          <tr>
            <td align="left" border="t" thead="row"><text fontsize="90%">Random</text></td>
            <td align="center" border="t"><Math mode="inline" tex="0.25\pm 0.00" text="0.25 plus-or-minus 0.00" xml:id="S4.T2.m3">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.25" role="NUMBER">0.25</XMTok>
                    <XMTok fontsize="90%" meaning="0.00" role="NUMBER">0.00</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="t"><Math mode="inline" tex="0.25\pm 0.00" text="0.25 plus-or-minus 0.00" xml:id="S4.T2.m4">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.25" role="NUMBER">0.25</XMTok>
                    <XMTok fontsize="90%" meaning="0.00" role="NUMBER">0.00</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">LSTM</text></td>
            <td align="center"><Math mode="inline" tex="0.27\pm 0.01" text="0.27 plus-or-minus 0.01" xml:id="S4.T2.m5">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.27" role="NUMBER">0.27</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="0.24\pm 0.01" text="0.24 plus-or-minus 0.01" xml:id="S4.T2.m6">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.24" role="NUMBER">0.24</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">Conditional MMDiff</text></td>
            <td align="center"><Math mode="inline" tex="0.24\pm 0.02" text="0.24 plus-or-minus 0.02" xml:id="S4.T2.m7">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.24" role="NUMBER">0.24</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="0.22\pm 0.02" text="0.22 plus-or-minus 0.02" xml:id="S4.T2.m8">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.22" role="NUMBER">0.22</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" border="t" thead="row"><text fontsize="90%">RNAFlow-Base</text></td>
            <td align="center" border="t"><Math mode="inline" tex="0.30\pm 0.02" text="0.30 plus-or-minus 0.02" xml:id="S4.T2.m9">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.30" role="NUMBER">0.30</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="t"><Math mode="inline" tex="0.30\pm 0.01" text="0.30 plus-or-minus 0.01" xml:id="S4.T2.m10">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.30" role="NUMBER">0.30</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">RNAFlow-Traj</text></td>
            <td align="center"><Math mode="inline" tex="0.31\pm 0.01" text="0.31 plus-or-minus 0.01" xml:id="S4.T2.m11">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.31" role="NUMBER">0.31</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><Math mode="inline" tex="0.28\pm 0.01" text="0.28 plus-or-minus 0.01" xml:id="S4.T2.m12">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.28" role="NUMBER">0.28</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">RNAFlow-Base + Rescoring</text></td>
            <td align="center"><Math mode="inline" tex="0.33\pm 0.02" text="0.33 plus-or-minus 0.02" xml:id="S4.T2.m13">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.33" role="NUMBER">0.33</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center"><text font="bold" fontsize="90%">0.32</text><text fontsize="90%"> </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T2.m14">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">0.03</text><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" thead="row"><text fontsize="90%">RNAFlow-Traj + Rescoring</text></td>
            <td align="center"><text font="bold" fontsize="90%">0.37</text><text fontsize="90%"> </text><Math mode="inline" tex="\pm" text="plus-or-minus" xml:id="S4.T2.m15">
                <XMath>
                  <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                </XMath>
              </Math><text fontsize="90%"> </text><text font="bold" fontsize="90%">0.05</text></td>
            <td align="center"><Math mode="inline" tex="0.29\pm 0.02" text="0.29 plus-or-minus 0.02" xml:id="S4.T2.m16">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.29" role="NUMBER">0.29</XMTok>
                    <XMTok fontsize="90%" meaning="0.02" role="NUMBER">0.02</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
          <tr>
            <td align="left" border="b t" thead="row"><text fontsize="90%">Inverse Folding [Upper Bound]</text></td>
            <td align="center" border="b t"><Math mode="inline" tex="0.46\pm 0.01" text="0.46 plus-or-minus 0.01" xml:id="S4.T2.m17">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.46" role="NUMBER">0.46</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math></td>
            <td align="center" border="b t"><Math mode="inline" tex="0.35\pm 0.01" text="0.35 plus-or-minus 0.01" xml:id="S4.T2.m18">
                <XMath>
                  <XMApp>
                    <XMTok fontsize="90%" meaning="plus-or-minus" name="pm" role="ADDOP">±</XMTok>
                    <XMTok fontsize="90%" meaning="0.35" role="NUMBER">0.35</XMTok>
                    <XMTok fontsize="90%" meaning="0.01" role="NUMBER">0.01</XMTok>
                  </XMApp>
                </XMath>
              </Math><text fontsize="90%"></text></td>
          </tr>
        </tbody>
      </tabular>
    </table>
    <para xml:id="S4.p1">
      <p>We evaluate RNAFlow in two experimental settings. First, we evaluate RNA sequence and structure prediction error with respect to existing protein-RNA complexes. Dataset construction and results are described in Section <ref labelref="LABEL:sec:exp1">4.1</ref>. We additionally evaluate the novelty of RNA designs in Section <ref labelref="LABEL:sec:4.2">4.2</ref>. In Section <ref labelref="LABEL:sec:4.3">4.3</ref>, we perform an ablation study to determine how modeling choices affect structure and sequence generation.</p>
    </para>
    <para xml:id="S4.p2">
      <p>Second, we evaluate whether RNAFlow can design RNA aptamers for the GRK2 protein, a target of interest for the treatment of chronic heart failure <cite class="ltx_citemacro_citep">(<bibref bibrefs="tesmer2012molecular" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
            <bibrefphrase>, </bibrefphrase>
          </bibref>)</cite>. <cite class="ltx_citemacro_citet"><bibref bibrefs="mayer2008rna" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> discovered an RNA aptamer that interacts strongly with the GRK2 kinase domain, and <cite class="ltx_citemacro_citet"><bibref bibrefs="lennarz2015rna" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite> identified <Math mode="inline" tex="4" text="4" xml:id="S4.p2.m1">
          <XMath>
            <XMTok meaning="4" role="NUMBER">4</XMTok>
          </XMath>
        </Math> nucleotides that are critical for binding. In Section <ref labelref="LABEL:sec:4.4">4.4</ref>, we investigate whether RNAFlow can design realistic RNAs for GRK2 binding given this binding site sequence motif.</p>
    </para>
    <subsection inlist="toc" labels="LABEL:sec:exp1" xml:id="S4.SS1">
      <tags>
        <tag>4.1</tag>
        <tag role="autoref">subsection 4.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.1</tag>
        <tag role="typerefnum">§4.1</tag>
      </tags>
      <title><tag close=" ">4.1</tag>Structure &amp; Sequence Accuracy</title>
      <figure inlist="lof" labels="LABEL:fig:3" placement="ht" xml:id="S4.F3">
        <tags>
          <tag>Figure 3</tag>
          <tag role="autoref">Figure 3</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Figure 3</tag>
        </tags>
        <graphics candidates="fig3ab_updated.png" class="ltx_centering" graphic="fig3ab_updated.png" options="width=867.23999pt,keepaspectratio=true" xml:id="S4.F3.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">3</tag>(A) Top: Structure and sequence design of RNA for interaction with a viral RNA-dependent RNA polymerase (PDB ID: 4K4X). Bottom: Design of RNA for interaction with HIV-1 Rev protein (PDB ID: 4PMI). (B) Ablation study of RNAFlow components. We report RMSD and sequence recovery on the sequence similarity split.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 3</tag>(A) Top: Structure and sequence design of RNA for interaction with a viral RNA-dependent RNA polymerase (PDB ID: 4K4X). Bottom: Design of RNA for interaction with HIV-1 Rev protein (PDB ID: 4PMI). (B) Ablation study of RNAFlow components. We report RMSD and sequence recovery on the sequence similarity split.</caption>
      </figure>
      <para xml:id="S4.SS1.p1">
        <p>As mentioned, we evaluate two variants of our method: <text font="italic">RNAFlow-Base</text> which is based on Noise-to-Seq and <text font="italic">RNAFlow-Trajectory</text> which additionally applies Traj-to-Seq. For both methods, we begin by generating <Math mode="inline" tex="10" text="10" xml:id="S4.SS1.p1.m1">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> structure-sequence pairs per protein in the test set. From amongst the <Math mode="inline" tex="10" text="10" xml:id="S4.SS1.p1.m2">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> designs, we additionally report the performance when <Math mode="inline" tex="1" text="1" xml:id="S4.SS1.p1.m3">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> sample is selected by the output rescoring model. All samples are generated with <Math mode="inline" tex="5" text="5" xml:id="S4.SS1.p1.m4">
            <XMath>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMath>
          </Math> integration steps.</p>
      </para>
      <para xml:id="S4.SS1.p2">
        <p><text font="bold">Dataset.</text> Protein-RNA complexes from the PDBBind dataset (2020 version) were used for training and evaluation <cite class="ltx_citemacro_citep">(<bibref bibrefs="liu2017forging" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. Dataset preparation details are described in the Appendix. We perform all experiments on two splits. The first accounts for RF2NA pre-training – all examples from complexes in the RF2NA validation or test sets were assigned to the test split, and remaining examples were randomly split into training and validation in a <Math mode="inline" tex="9" text="9" xml:id="S4.SS1.p2.m1">
            <XMath>
              <XMTok meaning="9" role="NUMBER">9</XMTok>
            </XMath>
          </Math>:<Math mode="inline" tex="1" text="1" xml:id="S4.SS1.p2.m2">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> ratio. To measure how well our model can generalize to dissimilar RNAs, we also evaluate on an RNA sequence similarity split. All RNA chains were clustered using CD-HIT <cite class="ltx_citemacro_citep">(<bibref bibrefs="fu2012cd" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite> where two sequences are in the same cluster if they share <Math mode="inline" tex="\geq 80\%" text="absent &gt;= 80percent" xml:id="S4.SS1.p2.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                  <XMTok meaning="80" role="NUMBER">80</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> sequence identity, following the clustering protocol of <cite class="ltx_citemacro_citet"><bibref bibrefs="joshi2023multi" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. The clusters were randomly split into train, validation, and test in an <Math mode="inline" tex="8" text="8" xml:id="S4.SS1.p2.m4">
            <XMath>
              <XMTok meaning="8" role="NUMBER">8</XMTok>
            </XMath>
          </Math>:<Math mode="inline" tex="1" text="1" xml:id="S4.SS1.p2.m5">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>:<Math mode="inline" tex="1" text="1" xml:id="S4.SS1.p2.m6">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> ratio. We pre-train Noise-to-Seq on clean protein-RNA complexes before fine-tuning on noised complexes as part of the RNAFlow training loop. Further details are included in the Appendix.</p>
      </para>
      <para xml:id="S4.SS1.p3">
        <p>Traj-to-Seq was trained separately on RNASolo <cite class="ltx_citemacro_citep">(<bibref bibrefs="adamczyk2022rnasolo" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, a dataset of RNA sequences and structures where many of the sequences are associated with multiple structure conformers. On average, the dataset contains <Math mode="inline" tex="3" text="3" xml:id="S4.SS1.p3.m1">
            <XMath>
              <XMTok meaning="3" role="NUMBER">3</XMTok>
            </XMath>
          </Math> structures per sequence. Following <cite class="ltx_citemacro_citet"><bibref bibrefs="joshi2023multi" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, we filtered to structures with resolution <Math mode="inline" tex="\leq 3" text="absent &lt;= 3" xml:id="S4.SS1.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok meaning="absent"/>
                <XMTok meaning="3" role="NUMBER">3</XMTok>
              </XMApp>
            </XMath>
          </Math> Å. For the RF2NA split, we curate the Traj-to-Seq training set such that RNAs in our validation and test sets are not used for training. For the sequence similarity split, we remove RNAs that have <Math mode="inline" tex="\geq 80\%" text="absent &gt;= 80percent" xml:id="S4.SS1.p3.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok meaning="absent"/>
                <XMApp>
                  <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                  <XMTok meaning="80" role="NUMBER">80</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> similarity with data points in validation/test. Traj-to-Seq inference was run on the final <Math mode="inline" tex="3" text="3" xml:id="S4.SS1.p3.m4">
            <XMath>
              <XMTok meaning="3" role="NUMBER">3</XMTok>
            </XMath>
          </Math> structures in the flow matching trajectory which yields optimal performance.</p>
      </para>
      <para xml:id="S4.SS1.p4">
        <p><text font="bold">Baselines.</text> For structure generation, we compare our method to two baselines. To our knowledge, the only existing structure generative model for nucleic acids is MMDiff <cite class="ltx_citemacro_citep">(<bibref bibrefs="morehead2023towards" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>, an <Math mode="inline" tex="SE(3)" text="S * E * 3" xml:id="S4.SS1.p4.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
                <XMTok font="italic" role="UNKNOWN">E</XMTok>
                <XMDual>
                  <XMRef idref="S4.SS1.p4.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMTok meaning="3" role="NUMBER" xml:id="S4.SS1.p4.m1.1">3</XMTok>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMath>
          </Math>-discrete diffusion model that jointly designs nucleic acid sequences and structures. We sample <Math mode="inline" tex="10" text="10" xml:id="S4.SS1.p4.m2">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> RNA designs of the ground-truth RNA’s length per protein-RNA complex in our test set, conditioned on the protein backbone structure and sequence. As an upper bound, we compare against RNA structures folded by RF2NA, given the ground-truth protein MSA and RNA sequence. This baseline captures the structure prediction error inherent to our score prediction model.</p>
      </para>
      <para xml:id="S4.SS1.p5">
        <p>For sequence generation, we compare our method to four baselines. First, we compare to a random baseline where RNA sequences of specified length are generated by randomly selecting a nucleotide for each position, from a uniform distribution over {A, C, G, U}. Next, we compare against sequences designed by MMDiff. Our third baseline is a standard sequence-only model, consisting of an LSTM layer to encode protein sequence <Math mode="inline" tex="\{p_{i}\}_{\forall i}" text="(set@(p _ i)) _ (for-all@(i))" xml:id="S4.SS1.p5.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S4.SS1.p5.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S4.SS1.p5.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">p</XMTok>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math> and an autoregressive LSTM decoder layer to predict RNA sequence <Math mode="inline" tex="\{\hat{r}_{i}\}_{\forall i}" text="(set@((hat@(r)) _ i)) _ (for-all@(i))" xml:id="S4.SS1.p5.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="set"/>
                    <XMRef idref="S4.SS1.p5.m2.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">{</XMTok>
                    <XMApp xml:id="S4.SS1.p5.m2.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">r</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">}</XMTok>
                  </XMWrap>
                </XMDual>
                <XMApp>
                  <XMTok fontsize="70%" meaning="for-all" name="forall" role="BIGOP">∀</XMTok>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">i</XMTok>
                </XMApp>
              </XMApp>
            </XMath>
          </Math>, matching the architecture in <cite class="ltx_citemacro_citet"><bibref bibrefs="im2019generative" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>. Finally, we establish an upper bound by comparing against results from our pre-trained inverse folding model, which takes the ground-truth protein-RNA backbone complex as input.</p>
      </para>
      <para xml:id="S4.SS1.p6">
        <p><text font="bold">Metrics.</text> For structure generation, we report root mean square deviation (RMSD) between predicted RNA structure and ground-truth structure, computed on all backbone atoms. Before RMSD calculation, the RNA structures are aligned by the Kabsch algorithm. For RNAFlow-Trajectory, we report the average RMSD across structures in the trajectory. We also report lDDT computed on <Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="S4.SS1.p6.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
              </XMApp>
            </XMath>
          </Math> atoms. For sequence generation, we report recovery rate which is the percentage of correctly recovered nucleotides in a sampled sequence.</p>
      </para>
      <para xml:id="S4.SS1.p7">
        <p><text font="bold">Results.</text> As shown in Table <ref labelref="LABEL:tab:1">1</ref>, RNAFlow significantly outperforms the baseline on the structure generation task. On the RF2NA and sequence similarity splits respectively, the best RNAFlow model gives a <Math mode="inline" tex="28\%" text="28percent" xml:id="S4.SS1.p7.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="16\%" text="16percent" xml:id="S4.SS1.p7.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="16" role="NUMBER">16</XMTok>
              </XMApp>
            </XMath>
          </Math> reduction in RMSD relative to MMDiff. We also observe a <Math mode="inline" tex="56\%" text="56percent" xml:id="S4.SS1.p7.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="56" role="NUMBER">56</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="50\%" text="50percent" xml:id="S4.SS1.p7.m4">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="50" role="NUMBER">50</XMTok>
              </XMApp>
            </XMath>
          </Math> increase in lDDT. Without rescoring, RNAFlow still gives a <Math mode="inline" tex="13\%" text="13percent" xml:id="S4.SS1.p7.m5">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="13" role="NUMBER">13</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="15\%" text="15percent" xml:id="S4.SS1.p7.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
              </XMApp>
            </XMath>
          </Math> reduction in RMSD. However, there is a large gap between the structural accuracy of RNAFlow and RF2NA, given the complexity of the <text font="italic">de novo</text> design task in comparison to folding. We note that RNAFlow-Trajectory consistently has a higher RMSD than RNAFlow-Base, likely because trajectory structures are taken from earlier points in flow matching inference. We show two examples of generated outputs in Figure <ref labelref="LABEL:fig:3">3a</ref>, where it is evident that the designed RNA matches the ground truth structure well.</p>
      </para>
      <para xml:id="S4.SS1.p8">
        <p>As shown in Table <ref labelref="LABEL:tab:2">2</ref>, RNAFlow outperforms all baselines on the sequence generation task. On the RF2NA split, the best RNAFlow model gives a <Math mode="inline" tex="48\%" text="48percent" xml:id="S4.SS1.p8.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="48" role="NUMBER">48</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement over random generation and a <Math mode="inline" tex="37\%" text="37percent" xml:id="S4.SS1.p8.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="37" role="NUMBER">37</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement over the LSTM baseline. RNAFlow-Trajectory outperforms RNAFlow-Base, suggesting that flow matching trajectories provide useful RNA dynamics information that is not present in a single structure. The output rescoring model improves the mean recovery, indicating that while RNAFlow samples can be variable, we learn to select quality samples. Without rescoring, we see a <Math mode="inline" tex="15\%" text="15percent" xml:id="S4.SS1.p8.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="15" role="NUMBER">15</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement in recovery relative to the best baseline.</p>
      </para>
      <figure inlist="lof" labels="LABEL:fig:4" placement="ht" xml:id="S4.F4">
        <tags>
          <tag>Figure 4</tag>
          <tag role="autoref">Figure 4</tag>
          <tag role="creftype">Figure</tag>
          <tag role="creftypecap">Figure</tag>
          <tag role="creftypeplural">Figures</tag>
          <tag role="creftypepluralcap">Figures</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Figure 4</tag>
        </tags>
        <graphics candidates="grk2.png" class="ltx_centering" graphic="grk2.png" options="width=867.23999pt,keepaspectratio=true" xml:id="S4.F4.g1"/>
        <toccaption class="ltx_centering"><tag close=" ">4</tag>Structure and sequence RNAs designed by RNAFlow for GRK2 binding in motif-scaffolded setting. The predicted structure is Kabsch aligned onto the ground-truth for visualization. In the sequence designs, green-colored characters show nucleotides that are correctly recovered from the ground-truth. Underlined nucleotides are part of the given binding motif.</toccaption>
        <caption class="ltx_centering"><tag close=": ">Figure 4</tag>Structure and sequence RNAs designed by RNAFlow for GRK2 binding in motif-scaffolded setting. The predicted structure is Kabsch aligned onto the ground-truth for visualization. In the sequence designs, green-colored characters show nucleotides that are correctly recovered from the ground-truth. Underlined nucleotides are part of the given binding motif.</caption>
      </figure>
      <para xml:id="S4.SS1.p9">
        <p>On the sequence similarity split, the best RNAFlow model gives a <Math mode="inline" tex="28\%" text="28percent" xml:id="S4.SS1.p9.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="28" role="NUMBER">28</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement over random generation and a <Math mode="inline" tex="33\%" text="33percent" xml:id="S4.SS1.p9.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="33" role="NUMBER">33</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement over LSTM. Without rescoring, we see a <Math mode="inline" tex="20\%" text="20percent" xml:id="S4.SS1.p9.m3">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="20" role="NUMBER">20</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement in recovery relative to the best baseline. We find that while the LSTM’s performance degrades on the sequence similarity split, RNAFlow’s performance is consistent. RNAFlow-Trajectory does not improve recovery, indicating that the generated trajectories may not approximate conformational ensembles as effectively when trying to generalize to biologically dissimilar RNAs. While the RNAFlow recovery rate does not reach the upper bound established by the inverse folding model, we note that for some proteins, our model designs new sequences that fold into the desired structure. For example, as shown Figure <ref labelref="LABEL:fig:3">3a</ref>, RNAFlow can design molecules that match the ground-truth structure with a relatively dissimilar sequence composition.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:4.2" xml:id="S4.SS2">
      <tags>
        <tag>4.2</tag>
        <tag role="autoref">subsection 4.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.2</tag>
        <tag role="typerefnum">§4.2</tag>
      </tags>
      <title><tag close=" ">4.2</tag>Structure &amp; Sequence Novelty</title>
      <para xml:id="S4.SS2.p1">
        <p>We then evaluate the novelty of RNAs designed by RNAFlow-Base. Sequence novelty is quantified as <Math mode="inline" tex="1-" text="limit-from@(1, -)" xml:id="S4.SS2.p1.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="limit-from"/>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
              </XMApp>
            </XMath>
          </Math> sequence recovery of each generated sample to its most similar RNA sequence in the training set. Similarly, structure novelty is <Math mode="inline" tex="1-" text="limit-from@(1, -)" xml:id="S4.SS2.p1.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="limit-from"/>
                <XMTok meaning="1" role="NUMBER">1</XMTok>
                <XMTok meaning="minus" role="ADDOP">-</XMTok>
              </XMApp>
            </XMath>
          </Math> TM-score between a generated sample and its most similar RNA structure in the training set. We observe that the majority of sequence content in the generated RNAs is not observed in the training set, showing that RNAFlow can generalize and design novel RNAs. The generated structures are also reasonably novel.</p>
      </para>
      <table inlist="lot" labels="LABEL:tab:3" placement="h" xml:id="S4.T3">
        <tags>
          <tag>Table 3</tag>
          <tag role="autoref">Table 3</tag>
          <tag role="creftype">Table</tag>
          <tag role="creftypecap">Table</tag>
          <tag role="creftypeplural">Tables</tag>
          <tag role="creftypepluralcap">Tables</tag>
          <tag role="refnum">3</tag>
          <tag role="typerefnum">Table 3</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">3</text></tag><text fontsize="90%">Structure and sequence novelty of RNAs generated by RNAFlow-Base.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">Table 3</tag>Structure and sequence novelty of RNAs generated by RNAFlow-Base.</caption>
        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <thead>
            <tr>
              <td border="t" thead="row"/>
              <td align="center" border="t" thead="column"><text fontsize="90%">Sequence Novelty</text></td>
              <td align="center" border="t" thead="column"><text fontsize="90%">Structure Novelty</text></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" border="t" thead="row"><text fontsize="90%">RF2NA Split</text></td>
              <td align="center" border="t"><Math mode="inline" tex="0.55" text="0.55" xml:id="S4.T3.m1">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.55" role="NUMBER">0.55</XMTok>
                  </XMath>
                </Math></td>
              <td align="center" border="t"><Math mode="inline" tex="0.63" text="0.63" xml:id="S4.T3.m2">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.63" role="NUMBER">0.63</XMTok>
                  </XMath>
                </Math><text fontsize="90%"></text></td>
            </tr>
            <tr>
              <td align="left" border="b" thead="row"><text fontsize="90%">Seq Sim Split</text></td>
              <td align="center" border="b"><Math mode="inline" tex="0.63" text="0.63" xml:id="S4.T3.m3">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.63" role="NUMBER">0.63</XMTok>
                  </XMath>
                </Math></td>
              <td align="center" border="b"><Math mode="inline" tex="0.64" text="0.64" xml:id="S4.T3.m4">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.64" role="NUMBER">0.64</XMTok>
                  </XMath>
                </Math><text fontsize="90%"></text></td>
            </tr>
          </tbody>
        </tabular>
      </table>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:4.3" xml:id="S4.SS3">
      <tags>
        <tag>4.3</tag>
        <tag role="autoref">subsection 4.3</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.3</tag>
        <tag role="typerefnum">§4.3</tag>
      </tags>
      <title><tag close=" ">4.3</tag>Ablation Study</title>
      <para xml:id="S4.SS3.p1">
        <p>We conduct an ablation study to determine which components of our model contribute to its performance. As shown in Figure <ref labelref="LABEL:fig:3">3b</ref>, we report recovery rate and RMSD on the sequence similarity split under various conditions, since the sequence split is more general to a design setting. First, we fine-tune Noise-to-Seq on sequence cross-entropy only, removing the structure MSE loss. When this denoiser is used in the standard five-step inference loop, the RMSD increases by <Math mode="inline" tex="1.25" text="1.25" xml:id="S4.SS3.p1.m1">
            <XMath>
              <XMTok meaning="1.25" role="NUMBER">1.25</XMTok>
            </XMath>
          </Math> compared to RNAFlow-Base, and recovery rate decreases by <Math mode="inline" tex="1" text="1" xml:id="S4.SS3.p1.m2">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> percentage point. Next, we remove protein conditioning and find that RMSD increases by <Math mode="inline" tex="2.52" text="2.52" xml:id="S4.SS3.p1.m3">
            <XMath>
              <XMTok meaning="2.52" role="NUMBER">2.52</XMTok>
            </XMath>
          </Math>, and recovery drops by <Math mode="inline" tex="7" text="7" xml:id="S4.SS3.p1.m4">
            <XMath>
              <XMTok meaning="7" role="NUMBER">7</XMTok>
            </XMath>
          </Math> percentage points, showing that providing protein information is important.</p>
      </para>
      <para xml:id="S4.SS3.p2">
        <p>We assess the effect of our “pose guess” complex alignment method by performing inference with the true RNA centroid and protein orientation. While the recovery is not affected, the RMSD is <Math mode="inline" tex="0.67" text="0.67" xml:id="S4.SS3.p2.m1">
            <XMath>
              <XMTok meaning="0.67" role="NUMBER">0.67</XMTok>
            </XMath>
          </Math> better than our method. This shows that our initial pose prediction method does not degrade performance significantly. Finally, we show the performance when inference is performed with ten flow matching steps rather than five. While RMSD is better than our method by <Math mode="inline" tex="0.25" text="0.25" xml:id="S4.SS3.p2.m2">
            <XMath>
              <XMTok meaning="0.25" role="NUMBER">0.25</XMTok>
            </XMath>
          </Math>, recovery is not affected. Given the insignificant impact on performance, we choose to use <Math mode="inline" tex="5" text="5" xml:id="S4.SS3.p2.m3">
            <XMath>
              <XMTok meaning="5" role="NUMBER">5</XMTok>
            </XMath>
          </Math> integration steps in favor of inference time speed-up.</p>
      </para>
    </subsection>
    <subsection inlist="toc" labels="LABEL:sec:4.4" xml:id="S4.SS4">
      <tags>
        <tag>4.4</tag>
        <tag role="autoref">subsection 4.4</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">4.4</tag>
        <tag role="typerefnum">§4.4</tag>
      </tags>
      <title><tag close=" ">4.4</tag>Motif-Scaffolded Design of RNAs for GRK2</title>
      <para xml:id="S4.SS4.p1">
        <p><text font="bold">Design Procedure.</text> For this task, we train RNAFlow on all protein-RNA examples except the ground-truth GRK2-C28 protein-aptamer complex (PDB ID: 3UZS). Comparing against an LSTM and MMDiff, we evaluate the structure and sequence accuracy of GRK2-conditioned RNA design given a <Math mode="inline" tex="4" text="4" xml:id="S4.SS4.p1.m1">
            <XMath>
              <XMTok meaning="4" role="NUMBER">4</XMTok>
            </XMath>
          </Math>-nucleotide binding site sequence motif. For all methods, we sample <Math mode="inline" tex="10" text="10" xml:id="S4.SS4.p1.m2">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> RNA designs and select <Math mode="inline" tex="1" text="1" xml:id="S4.SS4.p1.m3">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math> top design by the output rescoring model. We report the recovery rate with respect to the true aptamer sequence of length <Math mode="inline" tex="28" text="28" xml:id="S4.SS4.p1.m4">
            <XMath>
              <XMTok meaning="28" role="NUMBER">28</XMTok>
            </XMath>
          </Math> and the RMSD with respect to its crystal structure.</p>
      </para>
      <para xml:id="S4.SS4.p2">
        <p><text font="bold">Results.</text> As shown in Table <ref labelref="LABEL:tab:3">3</ref>, RNAFlow outperforms the baselines in terms of both RMSD and recovery. Compared to MMDiff, RNAFlow-Base gives an <Math mode="inline" tex="8.16\%" text="8.16percent" xml:id="S4.SS4.p2.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="8.16" role="NUMBER">8.16</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement in RMSD and <Math mode="inline" tex="34.38\%" text="34.38percent" xml:id="S4.SS4.p2.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="34.38" role="NUMBER">34.38</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement in recovery. As shown in Figure <ref labelref="LABEL:fig:4">4</ref>, the predicted structure resembles the ground-truth aptamer closer to the binding site, though the structure deviates when further away from the protein.</p>
      </para>
      <table inlist="lot" labels="LABEL:tab:3" placement="h" xml:id="S4.T4">
        <tags>
          <tag>Table 4</tag>
          <tag role="autoref">Table 4</tag>
          <tag role="creftype">Table</tag>
          <tag role="creftypecap">Table</tag>
          <tag role="creftypeplural">Tables</tag>
          <tag role="creftypepluralcap">Tables</tag>
          <tag role="refnum">4</tag>
          <tag role="typerefnum">Table 4</tag>
        </tags>
        <toccaption class="ltx_centering"><tag close=" "><text fontsize="90%">4</text></tag><text fontsize="90%">GRK2 binder metrics.</text></toccaption>
        <caption class="ltx_centering" fontsize="90%"><tag close=": ">Table 4</tag>GRK2 binder metrics.</caption>
        <tabular class="ltx_centering ltx_guessed_headers" vattach="middle">
          <thead>
            <tr>
              <td border="t" thead="row"/>
              <td align="center" border="t" thead="column"><text fontsize="90%">RMSD</text></td>
              <td align="center" border="t" thead="column"><text fontsize="90%">Recovery</text></td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" border="t" thead="row"><text fontsize="90%">LSTM</text></td>
              <td align="center" border="t"><text fontsize="90%">-</text></td>
              <td align="center" border="t"><Math mode="inline" tex="0.29" text="0.29" xml:id="S4.T4.m1">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.29" role="NUMBER">0.29</XMTok>
                  </XMath>
                </Math><text fontsize="90%"></text></td>
            </tr>
            <tr>
              <td align="left" thead="row"><text fontsize="90%">MMDiff</text></td>
              <td align="center"><Math mode="inline" tex="9.19" text="9.19" xml:id="S4.T4.m2">
                  <XMath>
                    <XMTok fontsize="90%" meaning="9.19" role="NUMBER">9.19</XMTok>
                  </XMath>
                </Math></td>
              <td align="center"><Math mode="inline" tex="0.32" text="0.32" xml:id="S4.T4.m3">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.32" role="NUMBER">0.32</XMTok>
                  </XMath>
                </Math><text fontsize="90%"></text></td>
            </tr>
            <tr>
              <td align="left" border="t" thead="row"><text fontsize="90%">RNAFlow-Base</text></td>
              <td align="center" border="t"><Math mode="inline" tex="8.44" text="8.44" xml:id="S4.T4.m4">
                  <XMath>
                    <XMTok fontsize="90%" meaning="8.44" role="NUMBER">8.44</XMTok>
                  </XMath>
                </Math></td>
              <td align="center" border="t"><Math mode="inline" tex="0.43" text="0.43" xml:id="S4.T4.m5">
                  <XMath>
                    <XMTok fontsize="90%" meaning="0.43" role="NUMBER">0.43</XMTok>
                  </XMath>
                </Math><text fontsize="90%"></text></td>
            </tr>
            <tr>
              <td align="left" border="b" thead="row"><text fontsize="90%">RNAFlow-Trajectory</text></td>
              <td align="center" border="b"><text class="ltx_markedasmath" font="bold" fontsize="90%">7.09</text></td>
              <td align="center" border="b"><text class="ltx_markedasmath" font="bold" fontsize="90%">0.54</text><text fontsize="90%"></text></td>
            </tr>
          </tbody>
        </tabular>
      </table>
      <para xml:id="S4.SS4.p3">
        <p>Moreover, RNAFlow-Trajectory gives an <Math mode="inline" tex="22.85\%" text="22.85percent" xml:id="S4.SS4.p3.m1">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="22.85" role="NUMBER">22.85</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement in RMSD and a <Math mode="inline" tex="68.75\%" text="68.75percent" xml:id="S4.SS4.p3.m2">
            <XMath>
              <XMApp>
                <XMTok meaning="percent" role="POSTFIX">%</XMTok>
                <XMTok meaning="68.75" role="NUMBER">68.75</XMTok>
              </XMApp>
            </XMath>
          </Math> improvement in recovery. Figure <ref labelref="LABEL:fig:4">4</ref> shows the predicted structural trajectory. One of the intermediate trajectory structures shown in green has a lower RMSD (<Math mode="inline" tex="6.42" text="6.42" xml:id="S4.SS4.p3.m3">
            <XMath>
              <XMTok meaning="6.42" role="NUMBER">6.42</XMTok>
            </XMath>
          </Math>) than the final structure. However, inverse folding the intermediate structure alone yields a significantly lower recovery (<Math mode="inline" tex="0.44" text="0.44" xml:id="S4.SS4.p3.m4">
            <XMath>
              <XMTok meaning="0.44" role="NUMBER">0.44</XMTok>
            </XMath>
          </Math>) than applying Traj-to-Seq (<Math class="ltx_math_unparsed" mode="inline" tex="0.54)" xml:id="S4.SS4.p3.m5">
            <XMath>
              <XMTok meaning="0.54" role="NUMBER">0.54</XMTok>
              <XMTok role="CLOSE" stretchy="false">)</XMTok>
            </XMath>
          </Math>. Crucially, we observe that the sequence predicted by RNAFlow-Trajectory recovers nucleotides on either end of the aptamer, far away from the given binding motif. As noted by <cite class="ltx_citemacro_citet"><bibref bibrefs="tesmer2012molecular" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
              <bibrefphrase>(</bibrefphrase>
              <bibrefphrase>)</bibrefphrase>
            </bibref></cite>, these stem regions are critical for the aptamer’s high affinity because they “limit the number of possible conformations for the selected RNA.” Thus, we argue that having conformational information is important to design these regions.</p>
      </para>
    </subsection>
  </section>
  <section inlist="toc" xml:id="S5">
    <tags>
      <tag>5</tag>
      <tag role="autoref">section 5</tag>
      <tag role="creftype">Section</tag>
      <tag role="creftypecap">Section</tag>
      <tag role="creftypeplural">Sections</tag>
      <tag role="creftypepluralcap">Sections</tag>
      <tag role="refnum">5</tag>
      <tag role="typerefnum">§5</tag>
    </tags>
    <title><tag close=" ">5</tag>Conclusion</title>
    <para xml:id="S5.p1">
      <p>In this paper, we present RNAFlow, the first protein-conditioned generative model for RNA structure and sequence design. We show that an inverse folding model is an effective score prediction network within the flow matching framework, enabling the design of RNAs that outperform the baselines in terms of structure and sequence accuracy. Additionally, we show that by inverse folding over an inferred conformational ensemble, we can design plausible aptamers for GRK2 binding.</p>
    </para>
    <para xml:id="S5.p2">
      <p>While RNAFlow shows an empirical advantage over existing methods, there is still a large gap to reach the level of accuracy achieved in <text font="italic">de novo</text> protein design. We observe that currently, RNAFlow tends to achieve lower RMSD and higher recovery when the ground-truth RNA is more structurally stable (i.e. more base pairing). This suggests that RNAFlow is practically useful for aptamer design. On the other hand, when the RNA is very conformationally diverse (i.e. short single-stranded RNAs), RNAFlow often does not outperform a random sequence. In this setting, a pure language approach may be desired as structural supervision is less relevant.</p>
    </para>
    <para xml:id="S5.p3">
      <p>To improve performance on this task, one major bottleneck is accuracy and efficiency of protein-RNA folding and docking models. This would allow us to supervise docked full-atom complexes and better model protein-RNA structural interaction, which is essential for designing RNAs that rely heavily on side chains for their function (i.e. ribozymes).</p>
    </para>
    <para xml:id="S5.p4">
      <p>Code is available at <ref class="ltx_url" font="typewriter" href="https://github.com/divnori/rnaflow">https://github.com/divnori/rnaflow</ref>.</p>
    </para>
  </section>
  <section xml:id="Sx1">
    <title>Impact Statement</title>
    <para xml:id="Sx1.p1">
      <p>This paper presents work whose goal is to advance machine learning applications for structural biology and drug discovery. There are many potential societal consequences of our work, including application of our model for discovery of an RNA drug candidate. We highlight that molecules designed by RNAFlow have not been tested experimentally which is critical for any biological application.</p>
    </para>
  </section>
  <bibliography citestyle="authoryear" files="main" xml:id="bib">
    <title>References</title>
  </bibliography>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %APPENDIX 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->  <pagination role="newpage"/>
  <appendix inlist="toc" xml:id="A1">
    <tags>
      <tag>Appendix A</tag>
      <tag role="autoref">Appendix A</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">A</tag>
      <tag role="typerefnum">Appendix A</tag>
    </tags>
    <title><tag close=" ">Appendix A</tag>Flow Matching on RNA Structures</title>
    <toctitle><tag close=" ">A</tag>Flow Matching on RNA Structures</toctitle>
    <para xml:id="A1.p1">
      <p>We justify the main RNAFlow objective given in Equation <ref labelref="LABEL:loss">3</ref>, following much of the theory given by <cite class="ltx_citemacro_citet"><bibref bibrefs="jing2023alphafold" separator=";" show="Authors Phrase1YearPhrase2" yyseparator=",">
            <bibrefphrase>(</bibrefphrase>
            <bibrefphrase>)</bibrefphrase>
          </bibref></cite>. By the standard formulation of flow matching in Euclidean space <Math mode="inline" tex="\mathbb{R}^{3L_{r}}" text="R ^ (3 * L _ r)" xml:id="A1.p1.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> (<Math mode="inline" tex="L_{r}" text="L _ r" xml:id="A1.p1.m2">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">L</XMTok>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">r</XMTok>
            </XMApp>
          </XMath>
        </Math> is RNA length), we expect to supervise with the reparameterized denoising objective (MSE).</p>
    </para>
    <para xml:id="A1.p2">
      <equation xml:id="A1.Ex6">
        <Math mode="display" tex="\mathcal{L}=\mathbb{E}_{R_{1}\sim p_{1},R_{t}\sim p_{t}}[{||\hat{R}_{1}-\vec{R%&#10;}_{1}||}^{2}]" text="L = E _ (formulae@(R _ 1 similar-to p _ 1, R _ t similar-to p _ t)) * delimited-[]@((norm@((hat@(R)) _ 1 - (vec@(R)) _ 1)) ^ 2)" xml:id="A1.Ex6.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMDual>
                    <XMApp>
                      <XMTok meaning="formulae"/>
                      <XMRef idref="A1.Ex6.m1.1"/>
                      <XMRef idref="A1.Ex6.m1.2"/>
                    </XMApp>
                    <XMWrap>
                      <XMApp xml:id="A1.Ex6.m1.1">
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                          <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                        </XMApp>
                      </XMApp>
                      <XMTok fontsize="70%" role="PUNCT">,</XMTok>
                      <XMApp xml:id="A1.Ex6.m1.2">
                        <XMTok fontsize="70%" meaning="similar-to" name="sim" role="RELOP">∼</XMTok>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                        <XMApp>
                          <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                          <XMTok font="italic" fontsize="70%" role="UNKNOWN">p</XMTok>
                          <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                        </XMApp>
                      </XMApp>
                    </XMWrap>
                  </XMDual>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="A1.Ex6.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A1.Ex6.m1.3">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="norm"/>
                          <XMRef idref="A1.Ex6.m1.3.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN">‖</XMTok>
                          <XMApp xml:id="A1.Ex6.m1.3.1">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMApp>
                                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMApp>
                                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE">‖</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="A1.p3">
      <p><Math mode="inline" tex="\hat{R}_{1}" text="(hat@(R)) _ 1" xml:id="A1.p3.m1">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> is predicted by neural network <Math mode="inline" tex="\hat{R}_{1}(\vec{R}_{t};\theta)" text="(hat@(R)) _ 1 * list@((vec@(R)) _ t, theta)" xml:id="A1.p3.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.p3.m2.2"/>
                  <XMRef idref="A1.p3.m2.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="A1.p3.m2.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">;</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A1.p3.m2.1">θ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> which accepts noised input <Math mode="inline" tex="\vec{R}_{t}" text="(vec@(R)) _ t" xml:id="A1.p3.m3">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
            </XMApp>
          </XMath>
        </Math> and a timestep embedding. While <Math mode="inline" tex="\hat{R}_{1}" text="(hat@(R)) _ 1" xml:id="A1.p3.m4">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMApp>
                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
              </XMApp>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math> is composed of an inverse folding model and pre-trained folding model, the denoised sequence can simply be thought of as an intermediate representation from which we predict the clean structure.</p>
    </para>
    <para xml:id="A1.p4">
      <p>However, <Math mode="inline" tex="\hat{R}_{1}(\vec{R}_{t};\theta)" text="(hat@(R)) _ 1 * list@((vec@(R)) _ t, theta)" xml:id="A1.p4.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                  <XMTok font="italic" role="UNKNOWN">R</XMTok>
                </XMApp>
                <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
              </XMApp>
              <XMDual>
                <XMApp>
                  <XMTok meaning="list"/>
                  <XMRef idref="A1.p4.m1.2"/>
                  <XMRef idref="A1.p4.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="A1.p4.m1.2">
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMApp>
                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    </XMApp>
                    <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                  </XMApp>
                  <XMTok role="PUNCT">;</XMTok>
                  <XMTok font="italic" name="theta" role="UNKNOWN" xml:id="A1.p4.m1.1">θ</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math> is <Math mode="inline" tex="SE(3)" text="S * E * 3" xml:id="A1.p4.m2">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
              <XMTok font="italic" role="UNKNOWN">E</XMTok>
              <XMDual>
                <XMRef idref="A1.p4.m2.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="3" role="NUMBER" xml:id="A1.p4.m2.1">3</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>-invariant given that RF2NA is trained with <Math mode="inline" tex="SE(3)" text="S * E * 3" xml:id="A1.p4.m3">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMTok font="italic" role="UNKNOWN">S</XMTok>
              <XMTok font="italic" role="UNKNOWN">E</XMTok>
              <XMDual>
                <XMRef idref="A1.p4.m3.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="3" role="NUMBER" xml:id="A1.p4.m3.1">3</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>-invariant FAPE loss. We are thus flow matching over the Riemannian manifold given by quotient space <Math mode="inline" tex="\mathbb{R}^{3L_{r}}/SE(3)" text="(R ^ (3 * L _ r) / S) * E * 3" xml:id="A1.p4.m4">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok meaning="divide" role="MULOP">/</XMTok>
                <XMApp>
                  <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
                  <XMApp>
                    <XMTok meaning="times" role="MULOP">⁢</XMTok>
                    <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMTok font="italic" role="UNKNOWN">S</XMTok>
              </XMApp>
              <XMTok font="italic" role="UNKNOWN">E</XMTok>
              <XMDual>
                <XMRef idref="A1.p4.m4.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMTok meaning="3" role="NUMBER" xml:id="A1.p4.m4.1">3</XMTok>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. To flow match in this new space, we must define a conditional probability path <Math mode="inline" tex="p_{t}(\vec{R}_{t}|\vec{R}_{1})" text="p _ t * conditional@((vec@(R)) _ t, (vec@(R)) _ 1)" xml:id="A1.p4.m5">
          <XMath>
            <XMApp>
              <XMTok meaning="times" role="MULOP">⁢</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">p</XMTok>
                <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
              </XMApp>
              <XMDual>
                <XMRef idref="A1.p4.m5.1"/>
                <XMWrap>
                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                  <XMApp xml:id="A1.p4.m5.1">
                    <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>. We can generalize linear interpolation in the Euclidean case to interpolant <Math mode="inline" tex="\vec{R}_{t}|\vec{R}_{1}=\psi(R_{0}|R_{1})" text="conditional@((vec@(R)) _ t, (vec@(R)) _ 1) = psi * conditional@(R _ 0, R _ 1)" xml:id="A1.p4.m6">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">t</XMTok>
                </XMApp>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMApp>
                    <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                  </XMApp>
                  <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                </XMApp>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                <XMDual>
                  <XMRef idref="A1.p4.m6.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.p4.m6.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math> defined as the geodesic path from <Math mode="inline" tex="R_{0}" text="R _ 0" xml:id="A1.p4.m7">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">R</XMTok>
              <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
            </XMApp>
          </XMath>
        </Math> to <Math mode="inline" tex="R_{1}" text="R _ 1" xml:id="A1.p4.m8">
          <XMath>
            <XMApp>
              <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
              <XMTok font="italic" role="UNKNOWN">R</XMTok>
              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
            </XMApp>
          </XMath>
        </Math>, where the geodesic path is Kabsch alignment followed by linear interpolation in <Math mode="inline" tex="\mathbb{R}^{3L_{r}}" text="R ^ (3 * L _ r)" xml:id="A1.p4.m9">
          <XMath>
            <XMApp>
              <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
              <XMTok font="blackboard" role="UNKNOWN">R</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok fontsize="70%" meaning="3" role="NUMBER">3</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                  <XMTok font="italic" fontsize="70%" role="UNKNOWN">L</XMTok>
                  <XMTok font="italic" fontsize="50%" role="UNKNOWN">r</XMTok>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>.</p>
    </para>
    <para xml:id="A1.p5">
      <equation xml:id="A1.Ex7">
        <Math mode="display" tex="R_{0}=\text{Kabsch}(R_{0},R_{1})" text="R _ 0 = [Kabsch] * open-interval@(R _ 0, R _ 1)" xml:id="A1.Ex7.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
              </XMApp>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMText>Kabsch</XMText>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.Ex7.m1.1"/>
                    <XMRef idref="A1.Ex7.m1.2"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.Ex7.m1.1">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.Ex7.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="A1.p6">
      <equation xml:id="A1.Ex8">
        <Math mode="display" tex="\psi(R_{0}|R_{1})=(1-t)*R_{0}+t*R_{1}" text="psi * conditional@(R _ 0, R _ 1) = (1 - t) * R _ 0 + t * R _ 1" xml:id="A1.Ex8.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMTok font="italic" name="psi" role="UNKNOWN">ψ</XMTok>
                <XMDual>
                  <XMRef idref="A1.Ex8.m1.1"/>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.Ex8.m1.1">
                      <XMTok meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                        <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                      </XMApp>
                      <XMApp>
                        <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                        <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                      </XMApp>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMApp>
                <XMTok meaning="plus" role="ADDOP">+</XMTok>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">∗</XMTok>
                  <XMDual>
                    <XMRef idref="A1.Ex8.m1.2"/>
                    <XMWrap>
                      <XMTok role="OPEN" stretchy="false">(</XMTok>
                      <XMApp xml:id="A1.Ex8.m1.2">
                        <XMTok meaning="minus" role="ADDOP">-</XMTok>
                        <XMTok meaning="1" role="NUMBER">1</XMTok>
                        <XMTok font="italic" role="UNKNOWN">t</XMTok>
                      </XMApp>
                      <XMTok role="CLOSE" stretchy="false">)</XMTok>
                    </XMWrap>
                  </XMDual>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok fontsize="70%" meaning="0" role="NUMBER">0</XMTok>
                  </XMApp>
                </XMApp>
                <XMApp>
                  <XMTok meaning="times" role="MULOP">∗</XMTok>
                  <XMTok font="italic" role="UNKNOWN">t</XMTok>
                  <XMApp>
                    <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                    <XMTok font="italic" role="UNKNOWN">R</XMTok>
                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                  </XMApp>
                </XMApp>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="A1.p7">
      <p>We define a distance metric <Math mode="inline" tex="d" text="d" xml:id="A1.p7.m1">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">d</XMTok>
          </XMath>
        </Math> on the manifold correspondingly, where <Math mode="inline" tex="d" text="d" xml:id="A1.p7.m2">
          <XMath>
            <XMTok font="italic" role="UNKNOWN">d</XMTok>
          </XMath>
        </Math> is a valid metric because it is defined for all points on the manifold.</p>
    </para>
    <para xml:id="A1.p8">
      <equation xml:id="A1.Ex9">
        <Math mode="display" tex="d=||\hat{R}_{1}-\text{Kabsch}(\vec{R}_{1},\hat{R}_{1})||" text="d = norm@((hat@(R)) _ 1 - [Kabsch] * open-interval@((vec@(R)) _ 1, (hat@(R)) _ 1))" xml:id="A1.Ex9.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMTok font="italic" role="UNKNOWN">d</XMTok>
              <XMDual>
                <XMApp>
                  <XMTok meaning="norm"/>
                  <XMRef idref="A1.Ex9.m1.1"/>
                </XMApp>
                <XMWrap>
                  <XMTok role="OPEN">‖</XMTok>
                  <XMApp xml:id="A1.Ex9.m1.1">
                    <XMTok meaning="minus" role="ADDOP">-</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>Kabsch</XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.Ex9.m1.1.1"/>
                          <XMRef idref="A1.Ex9.m1.1.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="A1.Ex9.m1.1.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex9.m1.1.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                  </XMApp>
                  <XMTok role="CLOSE">‖</XMTok>
                </XMWrap>
              </XMDual>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="A1.p9">
      <p>We can thus plug this expression into our original flow matching objective,</p>
    </para>
    <para xml:id="A1.p10">
      <equation xml:id="A1.Ex10">
        <Math mode="display" tex="\mathcal{L}=\mathbb{E}_{\vec{R}_{1}|\vec{R}_{t}}[{||\hat{R}_{1}-\text{Kabsch}(%&#10;\vec{R}_{1},\hat{R}_{1})||}^{2}]=\text{MSE}(\hat{R}_{1},\text{Kabsch}(\vec{R}_%&#10;{1},\hat{R}_{1}))" text="L = E _ (conditional@((vec@(R)) _ 1, (vec@(R)) _ t)) * delimited-[]@((norm@((hat@(R)) _ 1 - [Kabsch] * open-interval@((vec@(R)) _ 1, (hat@(R)) _ 1))) ^ 2) = [MSE] * open-interval@((hat@(R)) _ 1, [Kabsch] * open-interval@((vec@(R)) _ 1, (hat@(R)) _ 1))" xml:id="A1.Ex10.m1">
          <XMath>
            <XMApp>
              <XMTok meaning="multirelation"/>
              <XMTok font="caligraphic" role="UNKNOWN">L</XMTok>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="blackboard" role="UNKNOWN">E</XMTok>
                  <XMApp>
                    <XMTok fontsize="70%" meaning="conditional" role="MODIFIEROP" stretchy="false">|</XMTok>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMApp>
                        <XMTok fontsize="70%" name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="50%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMApp>
                      <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                      <XMApp>
                        <XMTok fontsize="70%" name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                        <XMTok font="italic" fontsize="70%" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok font="italic" fontsize="50%" role="UNKNOWN">t</XMTok>
                    </XMApp>
                  </XMApp>
                </XMApp>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="delimited-[]"/>
                    <XMRef idref="A1.Ex10.m1.1"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">[</XMTok>
                    <XMApp xml:id="A1.Ex10.m1.1">
                      <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="norm"/>
                          <XMRef idref="A1.Ex10.m1.1.1"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN">‖</XMTok>
                          <XMApp xml:id="A1.Ex10.m1.1.1">
                            <XMTok meaning="minus" role="ADDOP">-</XMTok>
                            <XMApp>
                              <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                              <XMApp>
                                <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                <XMTok font="italic" role="UNKNOWN">R</XMTok>
                              </XMApp>
                              <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                            </XMApp>
                            <XMApp>
                              <XMTok meaning="times" role="MULOP">⁢</XMTok>
                              <XMText>Kabsch</XMText>
                              <XMDual>
                                <XMApp>
                                  <XMTok meaning="open-interval"/>
                                  <XMRef idref="A1.Ex10.m1.1.1.1"/>
                                  <XMRef idref="A1.Ex10.m1.1.1.2"/>
                                </XMApp>
                                <XMWrap>
                                  <XMTok role="OPEN" stretchy="false">(</XMTok>
                                  <XMApp xml:id="A1.Ex10.m1.1.1.1">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMApp>
                                      <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="PUNCT">,</XMTok>
                                  <XMApp xml:id="A1.Ex10.m1.1.1.2">
                                    <XMTok role="SUBSCRIPTOP" scriptpos="post2"/>
                                    <XMApp>
                                      <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                                      <XMTok font="italic" role="UNKNOWN">R</XMTok>
                                    </XMApp>
                                    <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                                  </XMApp>
                                  <XMTok role="CLOSE" stretchy="false">)</XMTok>
                                </XMWrap>
                              </XMDual>
                            </XMApp>
                          </XMApp>
                          <XMTok role="CLOSE">‖</XMTok>
                        </XMWrap>
                      </XMDual>
                      <XMTok fontsize="70%" meaning="2" role="NUMBER">2</XMTok>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">]</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
              <XMTok meaning="equals" role="RELOP">=</XMTok>
              <XMApp>
                <XMTok meaning="times" role="MULOP">⁢</XMTok>
                <XMText>MSE</XMText>
                <XMDual>
                  <XMApp>
                    <XMTok meaning="open-interval"/>
                    <XMRef idref="A1.Ex10.m1.2"/>
                    <XMRef idref="A1.Ex10.m1.3"/>
                  </XMApp>
                  <XMWrap>
                    <XMTok role="OPEN" stretchy="false">(</XMTok>
                    <XMApp xml:id="A1.Ex10.m1.2">
                      <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                      <XMApp>
                        <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                        <XMTok font="italic" role="UNKNOWN">R</XMTok>
                      </XMApp>
                      <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                    </XMApp>
                    <XMTok role="PUNCT">,</XMTok>
                    <XMApp xml:id="A1.Ex10.m1.3">
                      <XMTok meaning="times" role="MULOP">⁢</XMTok>
                      <XMText>Kabsch</XMText>
                      <XMDual>
                        <XMApp>
                          <XMTok meaning="open-interval"/>
                          <XMRef idref="A1.Ex10.m1.3.1"/>
                          <XMRef idref="A1.Ex10.m1.3.2"/>
                        </XMApp>
                        <XMWrap>
                          <XMTok role="OPEN" stretchy="false">(</XMTok>
                          <XMApp xml:id="A1.Ex10.m1.3.1">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="vec" role="OVERACCENT" stretchy="false">→</XMTok>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="PUNCT">,</XMTok>
                          <XMApp xml:id="A1.Ex10.m1.3.2">
                            <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                            <XMApp>
                              <XMTok name="hat" role="OVERACCENT" stretchy="false">^</XMTok>
                              <XMTok font="italic" role="UNKNOWN">R</XMTok>
                            </XMApp>
                            <XMTok fontsize="70%" meaning="1" role="NUMBER">1</XMTok>
                          </XMApp>
                          <XMTok role="CLOSE" stretchy="false">)</XMTok>
                        </XMWrap>
                      </XMDual>
                    </XMApp>
                    <XMTok role="CLOSE" stretchy="false">)</XMTok>
                  </XMWrap>
                </XMDual>
              </XMApp>
            </XMApp>
          </XMath>
        </Math>
      </equation>
    </para>
    <para xml:id="A1.p11">
      <p>which is equivalent to the structure loss expression in Equation <ref labelref="LABEL:loss">3</ref>. The cross entropy term simply exerts auxiliary sequence supervision.</p>
    </para>
    <figure inlist="lof" labels="LABEL:fig:lengths LABEL:fig:lengths2" placement="t!" xml:id="A1.F6">
      <tags>
        <tag>Figure 6</tag>
        <tag role="autoref">Figure 6</tag>
        <tag role="creftype">Figure</tag>
        <tag role="creftypecap">Figure</tag>
        <tag role="creftypeplural">Figures</tag>
        <tag role="creftypepluralcap">Figures</tag>
        <tag role="refnum">6</tag>
        <tag role="typerefnum">Figure 6</tag>
      </tags>
      <graphics candidates="rna_sequence_lengths_histogram.png" class="ltx_figure_panel" graphic="rna_sequence_lengths_histogram.png" options="width=260.17464pt,keepaspectratio=true" xml:id="A1.F6.g1"/>
      <toccaption><tag close=" ">5</tag>Distribution of RNA lengths in processed PDBBind dataset.</toccaption>
      <caption><tag close=": ">Figure 5</tag>Distribution of RNA lengths in processed PDBBind dataset.</caption>
      <graphics candidates="rnasolo_histogram.png" class="ltx_centering ltx_figure_panel" graphic="rnasolo_histogram.png" options="width=260.17464pt,keepaspectratio=true" xml:id="A1.F6.g2"/>
      <toccaption class="ltx_centering"><tag close=" ">6</tag>Distribution of RNA lengths in processed RNASolo dataset.</toccaption>
      <caption class="ltx_centering"><tag close=": ">Figure 6</tag>Distribution of RNA lengths in processed RNASolo dataset.</caption>
    </figure>
  </appendix>
  <appendix inlist="toc" xml:id="A2">
    <tags>
      <tag>Appendix B</tag>
      <tag role="autoref">Appendix B</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">B</tag>
      <tag role="typerefnum">Appendix B</tag>
    </tags>
    <title><tag close=" ">Appendix B</tag>Dataset Details</title>
    <toctitle><tag close=" ">B</tag>Dataset Details</toctitle>
    <subsection inlist="toc" xml:id="A2.SS1">
      <tags>
        <tag>B.1</tag>
        <tag role="autoref">subsection B.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">B.1</tag>
        <tag role="typerefnum">§B.1</tag>
      </tags>
      <title><tag close=" ">B.1</tag>PDBBind</title>
      <para xml:id="A2.SS1.p1">
        <p>We filter PDBBind to complexes where at least one protein <Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="A2.SS1.p1.m1">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
              </XMApp>
            </XMath>
          </Math> atom and RNA <Math mode="inline" tex="C_{4}^{\prime}" text="(C _ 4) ^ prime" xml:id="A2.SS1.p1.m2">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> atom were within <Math mode="inline" tex="7" text="7" xml:id="A2.SS1.p1.m3">
            <XMath>
              <XMTok meaning="7" role="NUMBER">7</XMTok>
            </XMath>
          </Math> Å, a threshold that has been used to perform alanine scans for protein-RNA interaction site analysis <cite class="ltx_citemacro_citep">(<bibref bibrefs="kruger2018protein" separator=";" show="AuthorsPhrase1Year" yyseparator=",">
              <bibrefphrase>, </bibrefphrase>
            </bibref>)</cite>. For complexes containing many protein-RNA interaction sites, we use the interaction with least distance between the protein <Math mode="inline" tex="C_{\alpha}" text="C _ alpha" xml:id="A2.SS1.p1.m4">
            <XMath>
              <XMApp>
                <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                <XMTok font="italic" role="UNKNOWN">C</XMTok>
                <XMTok font="italic" fontsize="70%" name="alpha" role="UNKNOWN">α</XMTok>
              </XMApp>
            </XMath>
          </Math> atom and RNA <Math mode="inline" tex="C_{4}^{\prime}" text="(C _ 4) ^ prime" xml:id="A2.SS1.p1.m5">
            <XMath>
              <XMApp>
                <XMTok role="SUPERSCRIPTOP" scriptpos="post1"/>
                <XMApp>
                  <XMTok role="SUBSCRIPTOP" scriptpos="post1"/>
                  <XMTok font="italic" role="UNKNOWN">C</XMTok>
                  <XMTok fontsize="70%" meaning="4" role="NUMBER">4</XMTok>
                </XMApp>
                <XMTok fontsize="70%" name="prime" role="SUPOP">′</XMTok>
              </XMApp>
            </XMath>
          </Math> atom. We filter to RNA chains of length <Math mode="inline" tex="\geq 6" text="absent &gt;= 6" xml:id="A2.SS1.p1.m6">
            <XMath>
              <XMApp>
                <XMTok meaning="greater-than-or-equals" name="geq" role="RELOP">≥</XMTok>
                <XMTok meaning="absent"/>
                <XMTok meaning="6" role="NUMBER">6</XMTok>
              </XMApp>
            </XMath>
          </Math> and <Math mode="inline" tex="\leq 96" text="absent &lt;= 96" xml:id="A2.SS1.p1.m7">
            <XMath>
              <XMApp>
                <XMTok meaning="less-than-or-equals" name="leq" role="RELOP">≤</XMTok>
                <XMTok meaning="absent"/>
                <XMTok meaning="96" role="NUMBER">96</XMTok>
              </XMApp>
            </XMath>
          </Math>, and protein chains are contiguously cropped to length <Math mode="inline" tex="50" text="50" xml:id="A2.SS1.p1.m8">
            <XMath>
              <XMTok meaning="50" role="NUMBER">50</XMTok>
            </XMath>
          </Math>. As shown in Figure <ref labelref="LABEL:fig:lengths">5</ref>, while there are many examples of short RNAs, the model is also exposed to several longer RNA examples.</p>
      </para>
      <para xml:id="A2.SS1.p2">
        <p>In the sequence similarity split, there are <Math mode="inline" tex="1015" text="1015" xml:id="A2.SS1.p2.m1">
            <XMath>
              <XMTok meaning="1015" role="NUMBER">1015</XMTok>
            </XMath>
          </Math> complexes in train, <Math mode="inline" tex="105" text="105" xml:id="A2.SS1.p2.m2">
            <XMath>
              <XMTok meaning="105" role="NUMBER">105</XMTok>
            </XMath>
          </Math> in validation, and <Math mode="inline" tex="72" text="72" xml:id="A2.SS1.p2.m3">
            <XMath>
              <XMTok meaning="72" role="NUMBER">72</XMTok>
            </XMath>
          </Math> in test. The RF2NA split has <Math mode="inline" tex="1059" text="1059" xml:id="A2.SS1.p2.m4">
            <XMath>
              <XMTok meaning="1059" role="NUMBER">1059</XMTok>
            </XMath>
          </Math> complexes in train, <Math mode="inline" tex="117" text="117" xml:id="A2.SS1.p2.m5">
            <XMath>
              <XMTok meaning="117" role="NUMBER">117</XMTok>
            </XMath>
          </Math> in validation, and <Math mode="inline" tex="16" text="16" xml:id="A2.SS1.p2.m6">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> in test.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A2.SS2">
      <tags>
        <tag>B.2</tag>
        <tag role="autoref">subsection B.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">B.2</tag>
        <tag role="typerefnum">§B.2</tag>
      </tags>
      <title><tag close=" ">B.2</tag>RNASolo</title>
      <para xml:id="A2.SS2.p1">
        <p>As mentioned, we use the RNASolo dataset for Traj-to-Seq training. The dataset consists of RNAs from apo RNA structures, protein-RNA complexes, and RNA-DNA complexes. As shown in Figure <ref labelref="LABEL:fig:lengths2">6</ref>, the distribution of RNA lengths in the dataset is somewhat bimodal, with many sequences around length <Math mode="inline" tex="10" text="10" xml:id="A2.SS2.p1.m1">
            <XMath>
              <XMTok meaning="10" role="NUMBER">10</XMTok>
            </XMath>
          </Math> and around length <Math mode="inline" tex="75" text="75" xml:id="A2.SS2.p1.m2">
            <XMath>
              <XMTok meaning="75" role="NUMBER">75</XMTok>
            </XMath>
          </Math>. In the sequence similarity split, there are <Math mode="inline" tex="2314" text="2314" xml:id="A2.SS2.p1.m3">
            <XMath>
              <XMTok meaning="2314" role="NUMBER">2314</XMTok>
            </XMath>
          </Math> distinct RNA sequences in train, <Math mode="inline" tex="106" text="106" xml:id="A2.SS2.p1.m4">
            <XMath>
              <XMTok meaning="106" role="NUMBER">106</XMTok>
            </XMath>
          </Math> in validation, and <Math mode="inline" tex="78" text="78" xml:id="A2.SS2.p1.m5">
            <XMath>
              <XMTok meaning="78" role="NUMBER">78</XMTok>
            </XMath>
          </Math> in test. In the RF2NA split, there are <Math mode="inline" tex="2370" text="2370" xml:id="A2.SS2.p1.m6">
            <XMath>
              <XMTok meaning="2370" role="NUMBER">2370</XMTok>
            </XMath>
          </Math> distinct RNA sequences in train, <Math mode="inline" tex="110" text="110" xml:id="A2.SS2.p1.m7">
            <XMath>
              <XMTok meaning="110" role="NUMBER">110</XMTok>
            </XMath>
          </Math> in validation, and <Math mode="inline" tex="16" text="16" xml:id="A2.SS2.p1.m8">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math> in test.</p>
      </para>
    </subsection>
  </appendix>
  <appendix inlist="toc" xml:id="A3">
    <tags>
      <tag>Appendix C</tag>
      <tag role="autoref">Appendix C</tag>
      <tag role="creftype">Appendix</tag>
      <tag role="creftypecap">Appendix</tag>
      <tag role="creftypeplural">Appendices</tag>
      <tag role="creftypepluralcap">Appendices</tag>
      <tag role="refnum">C</tag>
      <tag role="typerefnum">Appendix C</tag>
    </tags>
    <title><tag close=" ">Appendix C</tag>Training and Architecture Details</title>
    <toctitle><tag close=" ">C</tag>Training and Architecture Details</toctitle>
    <subsection inlist="toc" xml:id="A3.SS1">
      <tags>
        <tag>C.1</tag>
        <tag role="autoref">subsection C.1</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">C.1</tag>
        <tag role="typerefnum">§C.1</tag>
      </tags>
      <title><tag close=" ">C.1</tag>Noise-to-Seq</title>
      <para xml:id="A3.SS1.p1">
        <p>For both splits, the Noise-to-Seq encoder and decoder GVP layers use a node scalar feature dimension of <Math mode="inline" tex="128" text="128" xml:id="A3.SS1.p1.m1">
            <XMath>
              <XMTok meaning="128" role="NUMBER">128</XMTok>
            </XMath>
          </Math>, node vector feature dimension of <Math mode="inline" tex="16" text="16" xml:id="A3.SS1.p1.m2">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math>, edge scalar feature dimension of <Math mode="inline" tex="32" text="32" xml:id="A3.SS1.p1.m3">
            <XMath>
              <XMTok meaning="32" role="NUMBER">32</XMTok>
            </XMath>
          </Math>, and edge vector feature dimension of <Math mode="inline" tex="1" text="1" xml:id="A3.SS1.p1.m4">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>. On both splits, the model was pre-trained for <Math mode="inline" tex="100" text="100" xml:id="A3.SS1.p1.m5">
            <XMath>
              <XMTok meaning="100" role="NUMBER">100</XMTok>
            </XMath>
          </Math> epochs using an Adam optimizer with a learning rate of <Math mode="inline" tex="0.001" text="0.001" xml:id="A3.SS1.p1.m6">
            <XMath>
              <XMTok meaning="0.001" role="NUMBER">0.001</XMTok>
            </XMath>
          </Math>, which takes a few hours on an NVIDIA A5000-24GB GPU.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS2">
      <tags>
        <tag>C.2</tag>
        <tag role="autoref">subsection C.2</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">C.2</tag>
        <tag role="typerefnum">§C.2</tag>
      </tags>
      <title><tag close=" ">C.2</tag>Traj-to-Seq</title>
      <para xml:id="A3.SS2.p1">
        <p>For both splits, the Traj-to-Seq encoder and decoder GVP layers use a node scalar feature dimension of <Math mode="inline" tex="128" text="128" xml:id="A3.SS2.p1.m1">
            <XMath>
              <XMTok meaning="128" role="NUMBER">128</XMTok>
            </XMath>
          </Math>, node vector feature dimension of <Math mode="inline" tex="16" text="16" xml:id="A3.SS2.p1.m2">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math>, edge scalar feature dimension of <Math mode="inline" tex="64" text="64" xml:id="A3.SS2.p1.m3">
            <XMath>
              <XMTok meaning="64" role="NUMBER">64</XMTok>
            </XMath>
          </Math>, and edge vector feature dimension of <Math mode="inline" tex="4" text="4" xml:id="A3.SS2.p1.m4">
            <XMath>
              <XMTok meaning="4" role="NUMBER">4</XMTok>
            </XMath>
          </Math>. The model was trained for <Math mode="inline" tex="100" text="100" xml:id="A3.SS2.p1.m5">
            <XMath>
              <XMTok meaning="100" role="NUMBER">100</XMTok>
            </XMath>
          </Math> epochs by an Adam optimizer with a learning rate of <Math mode="inline" tex="0.001" text="0.001" xml:id="A3.SS2.p1.m6">
            <XMath>
              <XMTok meaning="0.001" role="NUMBER">0.001</XMTok>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS3">
      <tags>
        <tag>C.3</tag>
        <tag role="autoref">subsection C.3</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">C.3</tag>
        <tag role="typerefnum">§C.3</tag>
      </tags>
      <title><tag close=" ">C.3</tag>RNAFlow</title>
      <para xml:id="A3.SS3.p1">
        <p>We fine-tune RNAFlow for <Math mode="inline" tex="100" text="100" xml:id="A3.SS3.p1.m1">
            <XMath>
              <XMTok meaning="100" role="NUMBER">100</XMTok>
            </XMath>
          </Math> epochs which takes one day on an NVIDIA A5000-24GB GPU, and we use the Adam optimizer with a learning rate of <Math mode="inline" tex="0.001" text="0.001" xml:id="A3.SS3.p1.m2">
            <XMath>
              <XMTok meaning="0.001" role="NUMBER">0.001</XMTok>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS4">
      <tags>
        <tag>C.4</tag>
        <tag role="autoref">subsection C.4</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">C.4</tag>
        <tag role="typerefnum">§C.4</tag>
      </tags>
      <title><tag close=" ">C.4</tag>LSTM</title>
      <para xml:id="A3.SS4.p1">
        <p>For both splits, the encoder’s hidden dimension is <Math mode="inline" tex="128" text="128" xml:id="A3.SS4.p1.m1">
            <XMath>
              <XMTok meaning="128" role="NUMBER">128</XMTok>
            </XMath>
          </Math> which was selected by a hyperparameter sweep, and the model was trained by an Adam optimizer with a learning rate of <Math mode="inline" tex="0.001" text="0.001" xml:id="A3.SS4.p1.m2">
            <XMath>
              <XMTok meaning="0.001" role="NUMBER">0.001</XMTok>
            </XMath>
          </Math>.</p>
      </para>
    </subsection>
    <subsection inlist="toc" xml:id="A3.SS5">
      <tags>
        <tag>C.5</tag>
        <tag role="autoref">subsection C.5</tag>
        <tag role="creftype">Section</tag>
        <tag role="creftypecap">Section</tag>
        <tag role="creftypeplural">Sections</tag>
        <tag role="creftypepluralcap">Sections</tag>
        <tag role="refnum">C.5</tag>
        <tag role="typerefnum">§C.5</tag>
      </tags>
      <title><tag close=" ">C.5</tag>Output Rescoring Model</title>
      <para xml:id="A3.SS5.p1">
        <p>Following Noise-to-Seq, the encoder and decoder GVP layers use a node scalar feature dimension of <Math mode="inline" tex="128" text="128" xml:id="A3.SS5.p1.m1">
            <XMath>
              <XMTok meaning="128" role="NUMBER">128</XMTok>
            </XMath>
          </Math>, node vector feature dimension of <Math mode="inline" tex="16" text="16" xml:id="A3.SS5.p1.m2">
            <XMath>
              <XMTok meaning="16" role="NUMBER">16</XMTok>
            </XMath>
          </Math>, edge scalar feature dimension of <Math mode="inline" tex="32" text="32" xml:id="A3.SS5.p1.m3">
            <XMath>
              <XMTok meaning="32" role="NUMBER">32</XMTok>
            </XMath>
          </Math>, and edge vector feature dimension of <Math mode="inline" tex="1" text="1" xml:id="A3.SS5.p1.m4">
            <XMath>
              <XMTok meaning="1" role="NUMBER">1</XMTok>
            </XMath>
          </Math>. The node output feature dimension is <Math mode="inline" tex="256" text="256" xml:id="A3.SS5.p1.m5">
            <XMath>
              <XMTok meaning="256" role="NUMBER">256</XMTok>
            </XMath>
          </Math>, and the final feedforward network consists of three fully connected layers with ReLU activation. The model was trained for <Math mode="inline" tex="50" text="50" xml:id="A3.SS5.p1.m6">
            <XMath>
              <XMTok meaning="50" role="NUMBER">50</XMTok>
            </XMath>
          </Math> epochs using an Adam optimizer with a learning rate of <Math mode="inline" tex="0.01" text="0.01" xml:id="A3.SS5.p1.m7">
            <XMath>
              <XMTok meaning="0.01" role="NUMBER">0.01</XMTok>
            </XMath>
          </Math>.</p>
      </para>
<!--  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% -->    </subsection>
  </appendix>
</document>
