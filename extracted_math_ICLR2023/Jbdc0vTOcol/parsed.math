L
N
L=336
96
L
N
96
L
N
862
O(N^{2})
N
N
L
N
N\approx L/S
P=16
S=8
L=336
22
L
96
336
0.518
0.397
L
L=380
4
N=96
0.447
96
0.518
0.397
0.367
L=336
0.349
\times
L:({\bm{x}}_{1},...,{\bm{x}}_{L})
{\bm{x}}_{t}
t
M
T
({\bm{x}}_{L+1},...,{\bm{x}}_{L+T})
i
L
1
{\bm{x}}^{(i)}_{1:L}=(x_{1}^{(i)},...,x_{L}^{(i)})
i=1,...,M
({\bm{x}}_{1},...,{\bm{x}}_{L})
M
{\bm{x}}^{(i)}\in\mathbb{R}^{1\times L}
\hat{{\bm{x}}}^{(i)}=(\hat{x}^{(i)}_{L+1},...,\hat{x}^{(i)}_{L+T})\in\mathbb{R%
}^{1\times T}
{\bm{x}}^{(i)}
P
S
{\bm{x}}^{(i)}_{p}\in\mathbb{R}^{P\times N}
N
N=\lfloor\frac{(L-P)}{S}\rfloor+2
S
x_{L}^{(i)}\in\mathbb{R}
L
L/S
S
D
\mathbf{W}_{p}\in\mathbb{R}^{D\times P}
\mathbf{W}_{\text{pos}}\in\mathbb{R}^{D\times N}
{\bm{x}}^{(i)}_{d}=\mathbf{W}_{p}{\bm{x}}^{(i)}_{p}+\mathbf{W}_{\text{pos}}
{\bm{x}}^{(i)}_{d}\in\mathbb{R}^{D\times N}
h=1,...,H
Q^{(i)}_{h}=({\bm{x}}^{(i)}_{d})^{T}\mathbf{W}^{Q}_{h}
K^{(i)}_{h}=({\bm{x}}^{(i)}_{d})^{T}\mathbf{W}^{K}_{h}
V^{(i)}_{h}=({\bm{x}}^{(i)}_{d})^{T}\mathbf{W}^{V}_{h}
\mathbf{W}^{Q}_{h},\mathbf{W}^{K}_{h}\in\mathbb{R}^{D\times d_{k}}
\mathbf{W}^{V}_{h}\in\mathbb{R}^{D\times D}
\mathbf{O}^{(i)}_{h}\in\mathbb{R}^{D\times N}
(\mathbf{O}^{(i)}_{h})^{T}=\text{Attention}(Q^{(i)}_{h},K^{(i)}_{h},V^{(i)}_{h%
})=\text{Softmax}(\frac{{Q^{(i)}_{h}}{K^{(i)}_{h}}^{T}}{\sqrt{d_{k}}})V^{(i)}_%
{h}
{\bm{z}}^{(i)}\in\mathbb{R}^{D\times N}
\hat{{\bm{x}}}^{(i)}=(\hat{x}^{(i)}_{L+1},...,\hat{x}^{(i)}_{L+T})\in\mathbb{R%
}^{1\times T}
M
\mathcal{L}=\mathbb{E}_{{\bm{x}}}\frac{1}{M}\sum_{i=1}^{M}\|\hat{{\bm{x}}}^{(i%
)}_{L+1:L+T}-{\bm{x}}^{(i)}_{L+1:L+T}\|_{2}^{2}.
{\bm{x}}^{(i)}
{\bm{x}}^{(i)}
{\bm{x}}_{i}
i
{\bm{z}}_{t}\in\mathbb{R}^{D}
L
M
T
\mathbf{W}
(L\cdot D)\times(M\cdot T)
D\times P
8
T\in\{24,36,48,60\}
T\in\{96,192,336,720\}
L=96
L=336
L\in\{24,48,96,192,336,720\}
L=512
L=336
P=16
S=8
\mathbf{21.0\%}
\mathbf{16.7\%}
\mathbf{20.2\%}
\mathbf{16.4\%}
T\in\{24,36,48,60\}
T\in\{96,192,336,720\}
T\in\{24,36,48,60\}
T\in\{96,192,336,720\}
512
12
42
40\%
100
20
10
20
T\in\{96,192,336,720\}
T\in\{96,192,336,720\}
\%
\%
\%
\%
\%
34.5\%
48.8\%
34.5\%
48.8\%
L
3
L=24,48,96,192,336,720
T=96,720
3
L=24,48,96,192,336,720
T=96,720
8
x_{t}
x_{t-1}
L=96
L=336
L\in\{24,48,96,192,336,720\}
L=36
L=104
L\in\{24,36,48,60,104,144\}
3
H=16
D=128
D=128
F=256
D=128
H=4,D=16
F=128
0.2
{\bm{x}}\in\mathbb{R}^{M\times L}
B\times M\times L
4D
B\times M\times P\times N
{\bm{x}}^{(i)}_{p}\in\mathbb{R}^{P\times N}
M
3D
(B\cdot M)\times P\times N
192
60
192
L=336
60
L=104
192
L=336
60
L=104
T\in\{96,192,336,720\}
T\in\{96,192,336,720\}
336
P=[4,8,16,24,32,40]
96
P
P
\{8,16\}
P=[2,4,8,12,16,24,32,40]
336
96
P=[2,4,8,12,16,24,32,40]
336
96
L
L
L
P
S
1
D
B\times M\times P\times N
(B\cdot M)\times P\times N
B\times(M\cdot P)\times N
L
L=\{3,4,5\}
D=\{128,256\}
F=2D
(L,D)=(3,128)
(3,256)
(4,128)
(4,256)
(5,128)
(5,256)
96
(L,D)=(3,128)
(3,256)
(4,128)
(4,256)
(5,128)
(5,256)
96
96
\{2019,2020,2021,2022,2023\}
96
\{2019,2020,2021,2022,2023\}
