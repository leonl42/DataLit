\textbf{{C}}=\{\mathcal{C}_{1},\mathcal{C}_{2},...,\mathcal{C}_{n}\}
n
\mathcal{C}_{k}
\mathcal{D}_{k}
\mathcal{T}_{k}
\bm{\theta_{g}}
\mathcal{L}_{k}
\mathcal{T}_{k}
\textbf{{D}}=\{\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{m}\}
\mathcal{D}^{i}
\mathcal{T}^{i}
\mathcal{Y}^{i}
\mathcal{T}^{t}
\{\mathcal{D}^{i}|i<t\}
\mathcal{D}^{t}
m
\textit{{D}}=\{\mathcal{D}^{1},\mathcal{D}^{2},...,\mathcal{D}^{m}\}
\mathcal{Y}^{1}\cup\mathcal{Y}^{2}...\cup\mathcal{Y}^{m}
\mathcal{C}_{i}
m
\textbf{{T}}_{i}=\{\mathcal{T}_{i}^{1},\mathcal{T}_{i}^{2},...,\mathcal{T}_{i}%
^{m}\}
z
c
\mathcal{L}_{\text{gen}}=\min_{\theta^{\mathrm{G}}}\left(\mathcal{L}_{\mathrm{%
gan}}^{\mathrm{G}}(\theta,X)+\mathcal{L}_{\mathrm{ce}}^{\mathrm{G}}(\theta,X)%
\right),
\mathcal{L}_{\mathrm{gan}}^{\mathrm{G}}(\theta,X)=-\mathbb{E}_{z\sim p_{z},c%
\sim p_{c}}\left[\log(D_{\theta^{\mathrm{D}}}\left(G_{\theta^{\mathrm{G}}}(z,c%
)\right))\right],
\mathcal{L}_{\mathrm{ce}}^{\mathrm{G}}(\theta,X)=-\mathbb{E}_{z\sim p_{z},c%
\sim p_{c}}\left[y_{c}\log(C_{\theta^{\mathrm{C}}}\left(G_{\theta^{\mathrm{G}}%
}(z,c))\right)\right],
C
D
G
C
D
\mathcal{L}_{\mathrm{ce}}^{G}(\theta,X)
\mathcal{L}_{\mathrm{gan}}^{G}(\theta,X)
X
\theta
\theta^{\mathrm{C}}
\theta^{\mathrm{D}}
\theta^{\mathrm{G}}
p_{c}
p_{z}
y_{c}
\mathcal{L}_{\text{dis}}=\min_{\theta^{\mathrm{D}},\theta^{\mathrm{C}}}\left(%
\mathcal{L}_{\mathrm{gan}}^{\mathrm{D}}(\theta,X)+\mathcal{L}_{\mathrm{ce}}^{%
\mathrm{D}}(\theta,X)\right),
\mathcal{L}_{\mathrm{gan}}^{\mathrm{D}}(\theta,X)=-\mathbb{E}_{(x,c)\sim X}%
\left[\log(D_{\theta^{\mathrm{D}}}(x))\right]-\mathbb{E}_{z\sim p_{z},c\sim p_%
{\mathrm{c}}}\left[\log(1-D_{\theta^{\mathrm{D}}}\left(G_{\theta^{\mathrm{G}}}%
(z,c)\right)\right)],
\displaystyle\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)=-\mathbb{E}_{(x,%
c)\sim X}\left[y_{c}\log(C_{\theta^{\mathrm{C}}}\left(x\right)\right)]-\mathbb%
{E}_{z\sim p_{z},c\sim p_{c}}\left[y_{c}\log(C_{\theta^{\mathrm{C}}}\left(G_{%
\theta^{\mathrm{G}}}(z,c))\right)\right].
\displaystyle\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)=-\mathbb{E}_{(x,%
c)\sim X}\left[y_{c}\log(C_{\theta^{\mathrm{C}}}\left(x\right)\right)]-\mathbb%
{E}_{z\sim p_{z},c\sim p_{c}}\left[y_{c}\log(C_{\theta^{\mathrm{C}}}\left(G_{%
\theta^{\mathrm{G}}}(z,c))\right)\right].
\mathcal{L}_{acgan}(\theta,X)=\mathcal{L}_{\text{gen}}+\mathcal{L}_{\text{dis}}.
\mathcal{L}_{\mathrm{ce}}=-\mathbb{E}_{x\sim X}[\log(\frac{\exp(F(x)^{\top}w_{%
y})}{\sum_{j=1}^{c}\exp\left(F\left(x\right)^{\top}w_{j}\right)})]
x
X
\bm{y}
F
W=\{w_{1},...,w_{c}\}
c
w_{k\in\{1,2,...,c\}}
\frac{\partial\mathcal{L}_{\mathrm{CE}}}{\partial w_{k}}=-\mathbb{E}_{x\sim X}%
[F(x)(\mathbf{1}_{y=k}-\log(\frac{\exp(F((x,y))^{\top}w_{k})}{\sum_{j=1}^{c}%
\exp\left(F\left(x\right)^{\top}w_{j}\right)}))]
\mathbf{1}_{y=k}
1
y=k
0
\mathcal{L}_{\mathrm{ce}}
F(x)
\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)
\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)
\mathcal{L}_{\mathrm{gan}}^{\mathrm{D}}(\theta,X)
\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)
T=400
\mathcal{C}_{i}
\theta_{i}
\mathcal{G}
\theta_{global}
\theta_{1},\theta_{2},...
C_{selected}={\{\mathcal{C}_{1},\mathcal{C}_{2},...\}}
\mathcal{L}_{acgan}
\mathcal{L}_{server}=\mathcal{L}_{acgan}(\theta_{global},X^{g}),
X^{g}
\theta_{global}
G_{\theta^{G}}^{t-1}
G_{\theta^{G}_{global}}
\theta_{global}
G_{\theta^{G}}^{t-1}
X^{g}_{t-1}
X
\mathcal{L}_{local}=\mathcal{L}_{acgan}(\theta,X^{g}_{t-1}\cup X),
X^{g}_{t-1}
X_{\textbf{g}}^{g}
X
X^{g}_{t-1}
X_{\textbf{g}}^{g}
X
\displaystyle\mathcal{L}_{\mathrm{c1}}=\min_{\theta^{C}}(-\mathbb{E}_{x^{g}_{t%
-1}\sim X^{g}_{t-1},x_{\textbf{g}}^{g}\sim X_{\textbf{g}}^{g}}[D_{KL}(f(\theta%
^{C},x^{g}_{t-1})\;||\;f(\theta^{C},x_{\textbf{g}}^{g}))])
\displaystyle\mathcal{L}_{\mathrm{c1}}=\min_{\theta^{C}}(-\mathbb{E}_{x^{g}_{t%
-1}\sim X^{g}_{t-1},x_{\textbf{g}}^{g}\sim X_{\textbf{g}}^{g}}[D_{KL}(f(\theta%
^{C},x^{g}_{t-1})\;||\;f(\theta^{C},x_{\textbf{g}}^{g}))])
\displaystyle\mathcal{L}_{\mathrm{c2}}=\min_{\theta^{C}}(-\mathbb{E}_{x\sim X,%
x_{\textbf{g}}^{g}\sim X_{\textbf{g}}^{g}}[D_{KL}(f(\theta^{C},x)\;||\;f(%
\theta^{C},x_{\textbf{g}}^{g}))]),
\displaystyle\mathcal{L}_{\mathrm{c2}}=\min_{\theta^{C}}(-\mathbb{E}_{x\sim X,%
x_{\textbf{g}}^{g}\sim X_{\textbf{g}}^{g}}[D_{KL}(f(\theta^{C},x)\;||\;f(%
\theta^{C},x_{\textbf{g}}^{g}))]),
\displaystyle\mathcal{L}_{\mathrm{c3}}=\min_{\theta^{C}}(-\mathbb{E}_{x^{g}_{%
\textbf{g}}\sim x^{g}_{\textbf{g}},y(x^{g}_{\textbf{g}})\sim Y}[D_{KL}(f(%
\theta^{C},x^{g}_{\textbf{g}})\;||\;y(x^{g}_{\textbf{g}}))]),
\displaystyle\mathcal{L}_{\mathrm{c3}}=\min_{\theta^{C}}(-\mathbb{E}_{x^{g}_{%
\textbf{g}}\sim x^{g}_{\textbf{g}},y(x^{g}_{\textbf{g}})\sim Y}[D_{KL}(f(%
\theta^{C},x^{g}_{\textbf{g}})\;||\;y(x^{g}_{\textbf{g}}))]),
\mathcal{L}_{\mathrm{c}}=\mathcal{L}_{\mathrm{c1}}+\mathcal{L}_{\mathrm{c2}}+%
\mathcal{L}_{\mathrm{c3}},
\mathcal{L}_{client}=\mathcal{L}_{local}+\mathcal{L}_{c},
D_{KL}(P\;||\;Q)
\theta^{C}
f(\theta^{C},x)
X_{global}^{g}
T=400
R=200
B=32
B=100
72.28\pm 0.82
19.36\pm 0.95
17.25\pm 0.25
27.21\pm 2.39
72.84\pm 0.73
19.69\pm 0.75
17.74\pm 0.55
27.43\pm 2.46
75.61\pm 0.93
23.91\pm 0.78
17.22\pm 0.90
27.02\pm 2.38
97.46\pm 0.51
71.92\pm 0.74
63.55\pm 0.46
37.93\pm 2.27
97.55\pm 0.48
71.83\pm 0.65
63.55\pm 0.27
37.87\pm 2.47
97.13\pm 0.35
73.85\pm 0.17
66.87\pm 0.79
38.31\pm 2.64
97.38\pm 0.63
73.91\pm 0.29
66.19\pm 0.92
38.34\pm 2.55
\textbf{99.13}\pm\textbf{0.34}
\textbf{78.15}\pm\textbf{0.30}
\textbf{73.12}\pm\textbf{0.47}
\textbf{45.27}\pm\textbf{2.42}
n
x
\textbf{78.15}\pm\textbf{0.30}
75.02\pm{0.41}
73.91\pm{0.29}
19.36\pm{0.95}
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
t
\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)
\mathcal{L}_{\mathrm{gan}}^{\mathrm{D}}(\theta,X)
\mathcal{L}_{\mathrm{ce}}^{\mathrm{D}}(\theta,X)
63.55
66.19
65.87
85.97
86.40
