{\mathcal{F}}_{\boldsymbol{\theta}}:\mathbb{R}^{D}\rightarrow\mathbb{R}^{L}
{\boldsymbol{\theta}}
L
D
K
{\mathcal{F}}_{\boldsymbol{\theta}}
K
{\boldsymbol{\phi}}=(\boldsymbol{w}_{k}\in\mathbb{R}^{L},b_{k}\in\mathbb{R})_{%
k=1}^{K}
\displaystyle\boldsymbol{p}^{(k)}(\boldsymbol{x};\boldsymbol{\Theta})=\frac{%
\exp{\left(\boldsymbol{w}_{k}^{\top}{\mathcal{F}}_{\boldsymbol{\theta}}(%
\boldsymbol{x})+b_{k}\right)}}{\sum_{j=1}^{K}\exp{\left(\boldsymbol{w}_{j}^{%
\top}{\mathcal{F}}_{\boldsymbol{\theta}}(\boldsymbol{x})+b_{j}\right)}},\quad%
\text{for }k=1,...,K,
\displaystyle\boldsymbol{p}^{(k)}(\boldsymbol{x};\boldsymbol{\Theta})=\frac{%
\exp{\left(\boldsymbol{w}_{k}^{\top}{\mathcal{F}}_{\boldsymbol{\theta}}(%
\boldsymbol{x})+b_{k}\right)}}{\sum_{j=1}^{K}\exp{\left(\boldsymbol{w}_{j}^{%
\top}{\mathcal{F}}_{\boldsymbol{\theta}}(\boldsymbol{x})+b_{j}\right)}},\quad%
\text{for }k=1,...,K,
\boldsymbol{\Theta}=({\boldsymbol{\theta}},{\boldsymbol{\phi}})
{\mathcal{D}}
\boldsymbol{x}\in\mathbb{R}^{D}
y\in\{1,\dots,K\}
\boldsymbol{\Theta}
{\mathcal{D}}
\displaystyle\boldsymbol{\Theta}^{\ast}=({\boldsymbol{\theta}}^{\ast},{%
\boldsymbol{\phi}}^{\ast})=\operatorname*{arg\,min}_{\boldsymbol{\Theta}}%
\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{D}}}\left[-\log{\boldsymbol{p}^{(y%
)}(\boldsymbol{x};\boldsymbol{\Theta})}\right].
\displaystyle\boldsymbol{\Theta}^{\ast}=({\boldsymbol{\theta}}^{\ast},{%
\boldsymbol{\phi}}^{\ast})=\operatorname*{arg\,min}_{\boldsymbol{\Theta}}%
\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{D}}}\left[-\log{\boldsymbol{p}^{(y%
)}(\boldsymbol{x};\boldsymbol{\Theta})}\right].
{\mathcal{F}}_{\boldsymbol{\theta}}
{\boldsymbol{\theta}}
{\boldsymbol{\phi}}
{\boldsymbol{\theta}}^{\ast}
\displaystyle{\boldsymbol{\phi}}^{\ast\ast}=\operatorname*{arg\,min}_{{%
\boldsymbol{\phi}}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{%
CB}}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{%
\ast},{\boldsymbol{\phi}}))}\right],
\displaystyle{\boldsymbol{\phi}}^{\ast\ast}=\operatorname*{arg\,min}_{{%
\boldsymbol{\phi}}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{%
CB}}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{%
\ast},{\boldsymbol{\phi}}))}\right],
{\mathcal{D}}_{\text{CB}}
(\boldsymbol{x},y)
p_{{\mathcal{D}}_{\text{CB}}}((\boldsymbol{x},y))=1/(K\times n_{y})
n_{y}
y
{\mathcal{F}}_{{\boldsymbol{\theta}}^{\ast}}
{\mathcal{L}}(\Theta)
\eta
\displaystyle\boldsymbol{\Theta}_{t}=\boldsymbol{\Theta}_{t-1}-\eta\nabla_{%
\boldsymbol{\Theta}}{\mathcal{L}}(\boldsymbol{\Theta})\rvert_{\boldsymbol{%
\Theta}=\boldsymbol{\Theta}_{t-1}},
\displaystyle\boldsymbol{\Theta}_{t}=\boldsymbol{\Theta}_{t-1}-\eta\nabla_{%
\boldsymbol{\Theta}}{\mathcal{L}}(\boldsymbol{\Theta})\rvert_{\boldsymbol{%
\Theta}=\boldsymbol{\Theta}_{t-1}},
\{\boldsymbol{\Theta}_{t}\}_{t\geq 1}
\boldsymbol{\Theta}_{\text{SWA}}=\boldsymbol{0}
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}=(n\boldsymbol{\Theta}_{\text{SWA%
}}+\boldsymbol{\Theta}_{n})/(n+1),
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}=(n\boldsymbol{\Theta}_{\text{SWA%
}}+\boldsymbol{\Theta}_{n})/(n+1),
\boldsymbol{\Theta}_{n}
75\%
\smash{\boldsymbol{\Theta}^{2}}
\boldsymbol{\Theta}_{\text{SWA}}^{\prime}=\boldsymbol{0}
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}^{\prime}=(n\boldsymbol{\Theta}_{%
\text{SWA}}^{\prime}+\boldsymbol{\Theta}_{n}^{2})/(n+1),
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}^{\prime}=(n\boldsymbol{\Theta}_{%
\text{SWA}}^{\prime}+\boldsymbol{\Theta}_{n}^{2})/(n+1),
\boldsymbol{\Sigma}_{\text{SWAG}}=\operatorname{diag}(\boldsymbol{\Theta}_{%
\text{SWA}}^{\prime}-\boldsymbol{\Theta}_{\text{SWA}}^{2})
q(\boldsymbol{\Theta})={\mathcal{N}}(\boldsymbol{\Theta};\boldsymbol{\Theta}_{%
\text{SWA}},\boldsymbol{\Sigma}_{\text{SWAG}})
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.24}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.22}
\scriptstyle{\pm 0.52}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.57}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.28}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.73}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.15}
{\boldsymbol{\theta}}_{\text{SWA}}
{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}
\displaystyle{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}=\operatorname*{arg\,min}_%
{\boldsymbol{\phi}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{%
CB}}}}\Big{[}-\log\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}_{%
\text{SWA}},{\boldsymbol{\phi}}))\Big{]}.
\displaystyle{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}=\operatorname*{arg\,min}_%
{\boldsymbol{\phi}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{%
CB}}}}\Big{[}-\log\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}_{%
\text{SWA}},{\boldsymbol{\phi}}))\Big{]}.
({\boldsymbol{\theta}}_{\text{SWA}},{\boldsymbol{\phi}}_{\text{SWA}}^{\ast})
{\boldsymbol{\theta}}
{\boldsymbol{\theta}}
q({\boldsymbol{\theta}}|{\mathcal{D}}):={\mathcal{N}}({\boldsymbol{\theta}}|{%
\boldsymbol{\theta}}_{\text{SWA}},\boldsymbol{\Sigma}_{\text{SWA}})
q({\boldsymbol{\theta}}|{\mathcal{D}})
\boldsymbol{x}
\displaystyle p(y|\boldsymbol{x},{\mathcal{D}};{\boldsymbol{\phi}}_{\text{SWA}%
}^{\ast})\approx\int\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}%
,{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}))q({\boldsymbol{\theta}}|{\mathcal{D}%
})\mathrm{d}{\boldsymbol{\theta}}\approx\frac{1}{M}\sum_{m=1}^{M}\boldsymbol{p%
}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}_{m},{\boldsymbol{\phi}}_{\text{%
SWA}}^{\ast})),
\displaystyle p(y|\boldsymbol{x},{\mathcal{D}};{\boldsymbol{\phi}}_{\text{SWA}%
}^{\ast})\approx\int\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}%
,{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}))q({\boldsymbol{\theta}}|{\mathcal{D}%
})\mathrm{d}{\boldsymbol{\theta}}\approx\frac{1}{M}\sum_{m=1}^{M}\boldsymbol{p%
}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}_{m},{\boldsymbol{\phi}}_{\text{%
SWA}}^{\ast})),
{\boldsymbol{\theta}}_{1},\dots,{\boldsymbol{\theta}}_{M}\overset{\mathrm{i.i.%
d.}}{\sim}q({\boldsymbol{\theta}}|{\mathcal{D}})
({\boldsymbol{\theta}}_{m})_{m=1}^{M}
\boldsymbol{x}
\displaystyle{\mathcal{F}}_{m}(\boldsymbol{x}):={\mathcal{F}}_{{\boldsymbol{%
\theta}}_{m}}(\boldsymbol{x}),\quad\text{for }m=1,\dots,M.
\displaystyle{\mathcal{F}}_{m}(\boldsymbol{x}):={\mathcal{F}}_{{\boldsymbol{%
\theta}}_{m}}(\boldsymbol{x}),\quad\text{for }m=1,\dots,M.
\boldsymbol{x}
\boldsymbol{x}
L
\boldsymbol{x}
\displaystyle\operatorname{Dispersion}\big{(}\boldsymbol{x};\{{\boldsymbol{%
\theta}}_{m}\}_{m=1}^{M}\big{)}\coloneqq\frac{1}{M}\sum_{m=1}^{M}\left[1-\frac%
{\overline{{\mathcal{F}}}(\boldsymbol{x})^{\top}{\mathcal{F}}_{{\boldsymbol{%
\theta}}_{m}}(\boldsymbol{x})}{\left\lVert\overline{{\mathcal{F}}}(\boldsymbol%
{x})\right\rVert_{2}\left\lVert{\mathcal{F}}_{{\boldsymbol{\theta}}_{m}}(%
\boldsymbol{x})\right\rVert_{2}}\right],
\displaystyle\operatorname{Dispersion}\big{(}\boldsymbol{x};\{{\boldsymbol{%
\theta}}_{m}\}_{m=1}^{M}\big{)}\coloneqq\frac{1}{M}\sum_{m=1}^{M}\left[1-\frac%
{\overline{{\mathcal{F}}}(\boldsymbol{x})^{\top}{\mathcal{F}}_{{\boldsymbol{%
\theta}}_{m}}(\boldsymbol{x})}{\left\lVert\overline{{\mathcal{F}}}(\boldsymbol%
{x})\right\rVert_{2}\left\lVert{\mathcal{F}}_{{\boldsymbol{\theta}}_{m}}(%
\boldsymbol{x})\right\rVert_{2}}\right],
\overline{{\mathcal{F}}}(\boldsymbol{x})\coloneqq\sum_{m=1}^{M}{\mathcal{F}}_{%
{\boldsymbol{\theta}}_{m}}(\boldsymbol{x})/M
M
\{{\mathcal{F}}_{{\boldsymbol{\theta}}_{m}}(\boldsymbol{x})\}_{m=1}^{M}
\boldsymbol{x}
\{\boldsymbol{p}(\boldsymbol{x};({\boldsymbol{\theta}}_{m},{\boldsymbol{\phi}}%
_{\text{SWA}}^{*}))\}_{m=1}^{M}
\displaystyle\operatorname{Dispersion}\left(\boldsymbol{x};\{({\boldsymbol{%
\theta}}_{m},{\boldsymbol{\phi}}_{\text{SWA}^{*}})\}_{m=1}^{M}\right)\coloneqq%
\operatorname{JSD}\left(\{\boldsymbol{p}(\boldsymbol{x};({\boldsymbol{\theta}}%
_{m},{\boldsymbol{\phi}}_{\text{SWA}}^{*}))\}_{m=1}^{M}\right),
\displaystyle\operatorname{Dispersion}\left(\boldsymbol{x};\{({\boldsymbol{%
\theta}}_{m},{\boldsymbol{\phi}}_{\text{SWA}^{*}})\}_{m=1}^{M}\right)\coloneqq%
\operatorname{JSD}\left(\{\boldsymbol{p}(\boldsymbol{x};({\boldsymbol{\theta}}%
_{m},{\boldsymbol{\phi}}_{\text{SWA}}^{*}))\}_{m=1}^{M}\right),
\boldsymbol{x}
0.233
0.385
{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}
{\boldsymbol{\theta}}_{\text{SWA}}
({\boldsymbol{\theta}}_{m})_{m=1}^{M}
{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}
({\boldsymbol{\theta}}_{m})_{m=1}^{M}
\boldsymbol{x}
{\boldsymbol{\phi}}_{\text{SWA}}^{\ast}
{\boldsymbol{\theta}}_{m}
\displaystyle{\boldsymbol{\phi}}^{*}=\operatorname*{arg\,min}_{\boldsymbol{%
\phi}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}\Big{[}%
\mathbb{E}_{{\boldsymbol{\theta}}\sim q({\boldsymbol{\theta}}|{\mathcal{D}})}[%
-\log p^{(y)}_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{x})]\Big%
{]}\approx\operatorname*{arg\,min}_{\boldsymbol{\phi}}\mathbb{E}_{(\boldsymbol%
{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}\Big{[}\hat{\mathcal{L}}_{\text{CE}}(%
\boldsymbol{x},y)\Big{]},
\displaystyle{\boldsymbol{\phi}}^{*}=\operatorname*{arg\,min}_{\boldsymbol{%
\phi}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}\Big{[}%
\mathbb{E}_{{\boldsymbol{\theta}}\sim q({\boldsymbol{\theta}}|{\mathcal{D}})}[%
-\log p^{(y)}_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{x})]\Big%
{]}\approx\operatorname*{arg\,min}_{\boldsymbol{\phi}}\mathbb{E}_{(\boldsymbol%
{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}\Big{[}\hat{\mathcal{L}}_{\text{CE}}(%
\boldsymbol{x},y)\Big{]},
\boldsymbol{p}^{(y)}_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{x%
}):=\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}},{\boldsymbol{%
\phi}}))
{\boldsymbol{\theta}}_{1},\dots,{\boldsymbol{\theta}}_{M}\overset{\mathrm{i.i.%
d.}}{\sim}q({\boldsymbol{\theta}}|{\mathcal{D}})
\displaystyle\hat{\mathcal{L}}_{\text{CE}}(\boldsymbol{x},y):=-\frac{1}{M}\sum%
_{m=1}^{M}\log\boldsymbol{p}^{(y)}_{{\boldsymbol{\theta}}_{m},{\boldsymbol{%
\phi}}}(\boldsymbol{x}).
\displaystyle\hat{\mathcal{L}}_{\text{CE}}(\boldsymbol{x},y):=-\frac{1}{M}\sum%
_{m=1}^{M}\log\boldsymbol{p}^{(y)}_{{\boldsymbol{\theta}}_{m},{\boldsymbol{%
\phi}}}(\boldsymbol{x}).
\{\boldsymbol{p}_{{\boldsymbol{\theta}}_{m},{\boldsymbol{\phi}}}(\boldsymbol{x%
})\}_{m=1}^{M}
\smash{\{{\mathcal{F}}_{{\boldsymbol{\theta}}_{m}}(\boldsymbol{x})\}_{m=1}^{M}}
{\boldsymbol{\phi}}
M
\smash{({\boldsymbol{\theta}}_{m})_{m=1}^{M}}
m^{\text{th}}
{\mathcal{T}}_{m}
\boldsymbol{x}
\boldsymbol{p}_{{\mathcal{T}}_{m}}(\boldsymbol{x}):=\boldsymbol{p}_{{%
\boldsymbol{\theta}}_{m},{\boldsymbol{\phi}}}(\boldsymbol{x})
{\boldsymbol{\theta}}_{m}\sim q({\boldsymbol{\theta}}|{\mathcal{D}})
{\boldsymbol{\theta}}_{\text{SWA}}
q({\boldsymbol{\theta}}|{\mathcal{D}})
{\boldsymbol{\theta}}_{\text{SWA}}
{\boldsymbol{\phi}}
\boldsymbol{p}_{{\boldsymbol{\theta}}_{\text{SWA}},{\boldsymbol{\phi}}}(%
\boldsymbol{x})
(\boldsymbol{p}_{{\mathcal{T}}_{m}}(\boldsymbol{x}))_{m=1}^{M}
\boldsymbol{p}_{\mathcal{T}}(\boldsymbol{x}):=\sum_{m}\boldsymbol{p}_{{%
\mathcal{T}}_{m}}(\boldsymbol{x})/M
(\boldsymbol{p}_{{\mathcal{T}}_{m}}(\boldsymbol{x}))_{m=1}^{M}
{\boldsymbol{\beta}}(\boldsymbol{x})
\displaystyle\boldsymbol{p}_{{\mathcal{T}}_{1}}(\boldsymbol{x}),\dots,%
\boldsymbol{p}_{{\mathcal{T}}_{M}}(\boldsymbol{x})\overset{\mathrm{i.i.d.}}{%
\sim}\mathrm{Dir}({\boldsymbol{\beta}}(\boldsymbol{x})).
\displaystyle\boldsymbol{p}_{{\mathcal{T}}_{1}}(\boldsymbol{x}),\dots,%
\boldsymbol{p}_{{\mathcal{T}}_{M}}(\boldsymbol{x})\overset{\mathrm{i.i.d.}}{%
\sim}\mathrm{Dir}({\boldsymbol{\beta}}(\boldsymbol{x})).
{\boldsymbol{\beta}}(\boldsymbol{x})
\displaystyle{\boldsymbol{\beta}}^{(k)}(\boldsymbol{x})\coloneqq\boldsymbol{p}%
_{{\mathcal{T}}}^{(k)}(\boldsymbol{x})\frac{(K-1)/2}{\sum_{j=1}^{K}\left[%
\boldsymbol{p}_{{\mathcal{T}}}^{(j)}(\boldsymbol{x})\left(\log{\boldsymbol{p}_%
{{\mathcal{T}}}^{(j)}(\boldsymbol{x})}-\frac{1}{M}\sum_{m=1}^{M}\log{%
\boldsymbol{p}_{{\mathcal{T}}_{m}}^{(j)}(\boldsymbol{x})}\right)\right]},
\displaystyle{\boldsymbol{\beta}}^{(k)}(\boldsymbol{x})\coloneqq\boldsymbol{p}%
_{{\mathcal{T}}}^{(k)}(\boldsymbol{x})\frac{(K-1)/2}{\sum_{j=1}^{K}\left[%
\boldsymbol{p}_{{\mathcal{T}}}^{(j)}(\boldsymbol{x})\left(\log{\boldsymbol{p}_%
{{\mathcal{T}}}^{(j)}(\boldsymbol{x})}-\frac{1}{M}\sum_{m=1}^{M}\log{%
\boldsymbol{p}_{{\mathcal{T}}_{m}}^{(j)}(\boldsymbol{x})}\right)\right]},
k=1,...,K
{\boldsymbol{\beta}}(\boldsymbol{x})
{\boldsymbol{\alpha}}(\boldsymbol{x})
1
{\boldsymbol{\beta}}\leftarrow{\boldsymbol{\beta}}+\boldsymbol{1}
{\boldsymbol{\alpha}}\leftarrow{\boldsymbol{\alpha}}+\boldsymbol{1}
D_{\mathrm{KL}}[\mathrm{Dir}({\boldsymbol{\alpha}})\|\mathrm{Dir}({\boldsymbol%
{\beta}})]
\displaystyle\hat{{\mathcal{L}}}_{\text{KD}}(\boldsymbol{x},y)=\mathbb{E}_{%
\boldsymbol{p}\sim\mathrm{Dir}({\boldsymbol{\alpha}})}\left[-\sum_{k=1}^{K}%
\boldsymbol{p}_{{\mathcal{T}}}^{(k)}(\boldsymbol{x})\log{\boldsymbol{p}^{(k)}}%
\right]+\frac{1}{\sum_{j=1}^{K}{\boldsymbol{\beta}}^{(j)}}D_{\mathrm{KL}}\left%
[\mathrm{Dir}({\boldsymbol{\alpha}})\|\mathrm{Dir}(\boldsymbol{1})\right],
\displaystyle\hat{{\mathcal{L}}}_{\text{KD}}(\boldsymbol{x},y)=\mathbb{E}_{%
\boldsymbol{p}\sim\mathrm{Dir}({\boldsymbol{\alpha}})}\left[-\sum_{k=1}^{K}%
\boldsymbol{p}_{{\mathcal{T}}}^{(k)}(\boldsymbol{x})\log{\boldsymbol{p}^{(k)}}%
\right]+\frac{1}{\sum_{j=1}^{K}{\boldsymbol{\beta}}^{(j)}}D_{\mathrm{KL}}\left%
[\mathrm{Dir}({\boldsymbol{\alpha}})\|\mathrm{Dir}(\boldsymbol{1})\right],
{\boldsymbol{\alpha}}(\boldsymbol{x})\in\mathbb{R}_{+}^{K}
{\boldsymbol{\phi}}=(\boldsymbol{w}_{k},b_{k})_{k=1}^{K}
\displaystyle{\boldsymbol{\alpha}}^{(k)}(\boldsymbol{x})\coloneqq\exp{\left(%
\boldsymbol{w}_{k}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}_{\text{SWA}}}(%
\boldsymbol{x})+b_{k}\right)}\quad\text{for }k=1,...,K.
\displaystyle{\boldsymbol{\alpha}}^{(k)}(\boldsymbol{x})\coloneqq\exp{\left(%
\boldsymbol{w}_{k}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}_{\text{SWA}}}(%
\boldsymbol{x})+b_{k}\right)}\quad\text{for }k=1,...,K.
{\boldsymbol{\alpha}}(\boldsymbol{x})
\boldsymbol{x}
\boldsymbol{p}_{{\boldsymbol{\theta}}_{\text{SWA}},{\boldsymbol{\phi}}}(%
\boldsymbol{x})
\mathbb{E}_{\boldsymbol{p}\sim\mathrm{Dir}({\boldsymbol{\alpha}}(\boldsymbol{x%
}))}\left[\boldsymbol{p}^{(k)}\right]={\boldsymbol{\alpha}}^{(k)}(\boldsymbol{%
x})/\sum_{j=1}^{K}{\boldsymbol{\alpha}}^{(j)}(\boldsymbol{x})=\boldsymbol{p}^{%
(k)}_{{\boldsymbol{\theta}}_{\text{SWA}},{\boldsymbol{\phi}}}(\boldsymbol{x}).
\hat{\mathcal{L}}_{\text{CE}}
\hat{\mathcal{L}}_{\text{KD}}
\text{Avg.}\scriptstyle{\pm\text{std.}}
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.008}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\uparrow
\downarrow
\downarrow
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.005}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.007}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.20}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.014}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.06}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.002}
\uparrow
k
1/K
K
{\mathcal{D}}_{\text{CB}}
\displaystyle\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}%
\left[-\log{\frac{\exp{\left(\boldsymbol{w}_{y}^{\top}{\mathcal{F}}_{{%
\boldsymbol{\theta}}}(\boldsymbol{x})+b_{y}\right)}}{\sum_{j=1}^{K}\exp{\left(%
\boldsymbol{w}_{j}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(\boldsymbol{x})%
+b_{j}\right)}}}\right],
\displaystyle\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}%
\left[-\log{\frac{\exp{\left(\boldsymbol{w}_{y}^{\top}{\mathcal{F}}_{{%
\boldsymbol{\theta}}}(\boldsymbol{x})+b_{y}\right)}}{\sum_{j=1}^{K}\exp{\left(%
\boldsymbol{w}_{j}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(\boldsymbol{x})%
+b_{j}\right)}}}\right],
(\boldsymbol{x},y)
p_{{\mathcal{D}}_{\text{CB}}}((\boldsymbol{x},y))=1/(K\times n_{y})
n_{y}
y
\{\pi_{k}\}_{k=1}^{K}
{\mathcal{D}}
\displaystyle\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{D}}}\left[-\frac{(1/%
\pi_{y})^{\rho}}{\sum_{j=1}^{K}(1/\pi_{j})^{\rho}}\log{\frac{\exp{\left(%
\boldsymbol{w}_{y}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(\boldsymbol{x})%
+b_{y}\right)}}{\sum_{j=1}^{K}\exp{\left(\boldsymbol{w}_{j}^{\top}{\mathcal{F}%
}_{{\boldsymbol{\theta}}}(\boldsymbol{x})+b_{j}\right)}}}\right],
\displaystyle\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{D}}}\left[-\frac{(1/%
\pi_{y})^{\rho}}{\sum_{j=1}^{K}(1/\pi_{j})^{\rho}}\log{\frac{\exp{\left(%
\boldsymbol{w}_{y}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(\boldsymbol{x})%
+b_{y}\right)}}{\sum_{j=1}^{K}\exp{\left(\boldsymbol{w}_{j}^{\top}{\mathcal{F}%
}_{{\boldsymbol{\theta}}}(\boldsymbol{x})+b_{j}\right)}}}\right],
\rho\geq 0
\rho=0.0
\rho=1.0
\rho=1.0
\{\pi_{k}\}_{k=1}^{K}
{\mathcal{D}}
\displaystyle\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{D}}}\left[-\log{\frac%
{\exp{\left(\boldsymbol{w}_{y}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(%
\boldsymbol{x})+b_{y}+\rho\log{\pi_{y}}\right)}}{\sum_{j=1}^{K}\exp{\left(%
\boldsymbol{w}_{j}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(\boldsymbol{x})%
+b_{j}+\rho\log{\pi_{j}}\right)}}}\right],
\displaystyle\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{D}}}\left[-\log{\frac%
{\exp{\left(\boldsymbol{w}_{y}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(%
\boldsymbol{x})+b_{y}+\rho\log{\pi_{y}}\right)}}{\sum_{j=1}^{K}\exp{\left(%
\boldsymbol{w}_{j}^{\top}{\mathcal{F}}_{{\boldsymbol{\theta}}}(\boldsymbol{x})%
+b_{j}+\rho\log{\pi_{j}}\right)}}}\right],
\rho\geq 0
\rho=1.0
\boldsymbol{\Theta}^{\ast}=({\boldsymbol{\theta}}^{\ast},{\boldsymbol{\phi}}^{%
\ast})
{\boldsymbol{\phi}}^{\ast\ast}=(\boldsymbol{w}_{k}^{\ast\ast},b_{k}^{\ast\ast}%
)_{k=1}^{K}
{\boldsymbol{\theta}}^{\ast}
{\boldsymbol{\phi}}
{\mathcal{D}}_{\text{CB}}
\displaystyle{\boldsymbol{\phi}}^{\ast\ast}=\operatorname*{arg\,min}_{{%
\boldsymbol{\phi}}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{%
CB}}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{%
\ast},{\boldsymbol{\phi}}))}\right].
\displaystyle{\boldsymbol{\phi}}^{\ast\ast}=\operatorname*{arg\,min}_{{%
\boldsymbol{\phi}}}\mathbb{E}_{(\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{%
CB}}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{%
\ast},{\boldsymbol{\phi}}))}\right].
(\boldsymbol{w}_{k}^{\ast})_{k=1}^{K}
\tau\in\mathbb{R}
\displaystyle{\boldsymbol{\phi}}(\tau)=(\boldsymbol{w}_{k}^{\ast}/\left\lVert%
\boldsymbol{w}_{k}^{\ast}\right\rVert^{\tau},b_{k}^{\ast})_{k=1}^{K}.
\displaystyle{\boldsymbol{\phi}}(\tau)=(\boldsymbol{w}_{k}^{\ast}/\left\lVert%
\boldsymbol{w}_{k}^{\ast}\right\rVert^{\tau},b_{k}^{\ast})_{k=1}^{K}.
{\boldsymbol{\phi}}^{\ast\ast}={\boldsymbol{\phi}}(\tau^{\ast})
{\mathcal{D}}_{\text{CB}}
\displaystyle\tau^{\ast}=\operatorname*{arg\,min}_{\tau}\mathbb{E}_{(%
\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}\left[-\log{\boldsymbol{p}%
^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{\ast},{\boldsymbol{\phi}}(\tau))%
)}\right].
\displaystyle\tau^{\ast}=\operatorname*{arg\,min}_{\tau}\mathbb{E}_{(%
\boldsymbol{x},y)\sim p_{{\mathcal{D}}_{\text{CB}}}}\left[-\log{\boldsymbol{p}%
^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{\ast},{\boldsymbol{\phi}}(\tau))%
)}\right].
{\boldsymbol{\phi}}^{\ast}
\{\alpha_{k}\in\mathbb{R},\beta_{k}\in\mathbb{R}\}_{k=1}^{K}\cup\{{\boldsymbol%
{\gamma}}\in\mathbb{R}^{K},\delta\in\mathbb{R}\}
\displaystyle z_{k}(\boldsymbol{x})\leftarrow{\boldsymbol{w}_{k}^{\ast}}^{\top%
}{\mathcal{F}}_{{\boldsymbol{\theta}}^{\ast}}(\boldsymbol{x})+b_{k}^{\ast},
\displaystyle z_{k}(\boldsymbol{x})
\displaystyle\leftarrow{\boldsymbol{w}_{k}^{\ast}}^{\top}{\mathcal{F}}_{{%
\boldsymbol{\theta}}^{\ast}}(\boldsymbol{x})+b_{k}^{\ast},
\displaystyle\sigma(\boldsymbol{x})\leftarrow\operatorname{Sigmoid}({%
\boldsymbol{\gamma}}^{\top}z_{k}(\boldsymbol{x})+\delta),
\displaystyle\sigma(\boldsymbol{x})
\displaystyle\leftarrow\operatorname{Sigmoid}({\boldsymbol{\gamma}}^{\top}z_{k%
}(\boldsymbol{x})+\delta),
\displaystyle\hat{z}_{k}(\boldsymbol{x})\leftarrow\sigma(\boldsymbol{x})\cdot(%
\alpha_{k}z_{k}(\boldsymbol{x})+\beta_{k})+(1-\sigma(\boldsymbol{x}))\cdot z_{%
k}(\boldsymbol{x}),\quad\text{for }k=1,...,K,
\displaystyle\hat{z}_{k}(\boldsymbol{x})
\displaystyle\leftarrow\sigma(\boldsymbol{x})\cdot(\alpha_{k}z_{k}(\boldsymbol%
{x})+\beta_{k})+(1-\sigma(\boldsymbol{x}))\cdot z_{k}(\boldsymbol{x}),\quad%
\text{for }k=1,...,K,
z_{k}
\hat{z}_{k}
{\boldsymbol{\theta}}^{\ast}
{\boldsymbol{\phi}}^{\ast}
\{\alpha_{k},\beta_{k}\}_{k=1}^{K}\cup\{{\boldsymbol{\gamma}},\delta\}=\{%
\alpha_{k}^{\ast},\beta_{k}^{\ast}\}_{k=1}^{K}\cup\{{\boldsymbol{\gamma}}^{%
\ast},\delta^{\ast}\}
{\mathcal{D}}
K
{\mathcal{P}}:\boldsymbol{x}\mapsto\boldsymbol{p}
\boldsymbol{p}\in[0,1]^{K}
\boldsymbol{x}
\displaystyle\mathrm{ACC}({\mathcal{P}},{\mathcal{D}})=\mathbb{E}_{(%
\boldsymbol{x},y)\in{\mathcal{D}}}\left[\left[y=\operatorname*{arg\,max}_{k}{%
\mathcal{P}}^{(k)}(\boldsymbol{x})\right]\right],
\displaystyle\mathrm{ACC}({\mathcal{P}},{\mathcal{D}})=\mathbb{E}_{(%
\boldsymbol{x},y)\in{\mathcal{D}}}\left[\left[y=\operatorname*{arg\,max}_{k}{%
\mathcal{P}}^{(k)}(\boldsymbol{x})\right]\right],
[\cdot]
\displaystyle\mathrm{NLL}({\mathcal{P}},{\mathcal{D}})=\mathbb{E}_{(%
\boldsymbol{x},y)\in{\mathcal{D}}}\left[-\log{{\mathcal{P}}^{(y)}(\boldsymbol{%
x})}\right],
\displaystyle\mathrm{NLL}({\mathcal{P}},{\mathcal{D}})=\mathbb{E}_{(%
\boldsymbol{x},y)\in{\mathcal{D}}}\left[-\log{{\mathcal{P}}^{(y)}(\boldsymbol{%
x})}\right],
\displaystyle\mathrm{ECE}({\mathcal{P}},{\mathcal{D}};N)=\sum_{n=1}^{N}\delta_%
{n}\left(|{\mathcal{B}}_{n}|/|{\mathcal{D}}|\right),
\displaystyle\mathrm{ECE}({\mathcal{P}},{\mathcal{D}};N)=\sum_{n=1}^{N}\delta_%
{n}\left(|{\mathcal{B}}_{n}|/|{\mathcal{D}}|\right),
\{{\mathcal{B}}_{1},...,{\mathcal{B}}_{N}\}
{\mathcal{D}}
\displaystyle{\mathcal{B}}_{n}=\Bigg{\{}(\boldsymbol{x},y)\in{\mathcal{D}}\;%
\Big{|}\;\max_{k}{\mathcal{P}}^{(k)}(\boldsymbol{x})\in\bigg{(}\frac{n-1}{N},%
\frac{n}{N}\bigg{]}\Bigg{\}},\quad\text{for }n=1,...,N,
\displaystyle{\mathcal{B}}_{n}=\Bigg{\{}(\boldsymbol{x},y)\in{\mathcal{D}}\;%
\Big{|}\;\max_{k}{\mathcal{P}}^{(k)}(\boldsymbol{x})\in\bigg{(}\frac{n-1}{N},%
\frac{n}{N}\bigg{]}\Bigg{\}},\quad\text{for }n=1,...,N,
\delta_{n}
n
{\mathcal{B}}_{n}
\displaystyle\delta_{n}=\Bigg{\lvert}\mathrm{ACC}({\mathcal{P}},{\mathcal{B}}_%
{n})-\mathbb{E}_{(\boldsymbol{x},\cdot)\in{\mathcal{B}}_{n}}\left[\max_{k}{%
\mathcal{P}}^{(k)}(\boldsymbol{x})\right]\Bigg{\rvert},\quad\text{for }n=1,...%
,N.
\displaystyle\delta_{n}=\Bigg{\lvert}\mathrm{ACC}({\mathcal{P}},{\mathcal{B}}_%
{n})-\mathbb{E}_{(\boldsymbol{x},\cdot)\in{\mathcal{B}}_{n}}\left[\max_{k}{%
\mathcal{P}}^{(k)}(\boldsymbol{x})\right]\Bigg{\rvert},\quad\text{for }n=1,...%
,N.
N=15
M=10
\displaystyle\underbrace{0.5\hat{{\mathcal{L}}}_{\text{CE}}}_{\begin{subarray}%
{c}\text{cross-entropy}\\
\text{term}\end{subarray}}+\underbrace{0.5\hat{{\mathcal{L}}}_{\text{KD}}}_{%
\begin{subarray}{c}\text{self-distillation}\\
\text{term}\end{subarray}}.
\displaystyle\underbrace{0.5\hat{{\mathcal{L}}}_{\text{CE}}}_{\begin{subarray}%
{c}\text{cross-entropy}\\
\text{term}\end{subarray}}+\underbrace{0.5\hat{{\mathcal{L}}}_{\text{KD}}}_{%
\begin{subarray}{c}\text{self-distillation}\\
\text{term}\end{subarray}}.
{\boldsymbol{\beta}}
\hat{{\mathcal{L}}}_{\text{KD}}
\displaystyle\boldsymbol{p}_{{\boldsymbol{\theta}}}^{(k)}(\boldsymbol{x})%
\leftarrow\frac{\exp{\left((\boldsymbol{w}_{k}^{\top}{\mathcal{F}}_{{%
\boldsymbol{\theta}}}^{(k)}(\boldsymbol{x})+b_{k})/\tau_{\text{KD}}\right)}}{%
\sum_{j=1}^{K}\exp{\left((\boldsymbol{w}_{j}^{\top}{\mathcal{F}}_{{\boldsymbol%
{\theta}}}^{(j)}(\boldsymbol{x})+b_{j})/\tau_{\text{KD}}\right)}},\quad\text{%
for }k=1,...,K.
\displaystyle\boldsymbol{p}_{{\boldsymbol{\theta}}}^{(k)}(\boldsymbol{x})%
\leftarrow\frac{\exp{\left((\boldsymbol{w}_{k}^{\top}{\mathcal{F}}_{{%
\boldsymbol{\theta}}}^{(k)}(\boldsymbol{x})+b_{k})/\tau_{\text{KD}}\right)}}{%
\sum_{j=1}^{K}\exp{\left((\boldsymbol{w}_{j}^{\top}{\mathcal{F}}_{{\boldsymbol%
{\theta}}}^{(j)}(\boldsymbol{x})+b_{j})/\tau_{\text{KD}}\right)}},\quad\text{%
for }k=1,...,K.
\tau_{\text{KD}}\in\{1,2,5,10,20\}
\tau\in\{1,2,5\}
\tau_{\text{KD}}=20
\tau_{\text{KD}}
\tau_{\text{KD}}
\uparrow
\downarrow
\downarrow
\tau_{\text{KD}}=1.0
\tau_{\text{KD}}=2.0
\tau_{\text{KD}}=5.0
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.001}
\tau_{\text{KD}}=10.0
\scriptstyle{\pm 0.22}
\scriptstyle{\pm 0.14}
\scriptstyle{\pm 0.38}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.000}
\tau_{\text{KD}}=20.0
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.14}
\scriptstyle{\pm 0.49}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.049}
\scriptstyle{\pm 0.005}
{\mathcal{D}}=\{(\boldsymbol{x}_{i},y_{i})\}_{i=1}^{N}
{\mathcal{F}}
{\boldsymbol{\theta}}
{\boldsymbol{\phi}}=(\boldsymbol{w}_{k},b_{k})_{k=1}^{K}
T_{1}
T_{2}
\eta_{t}
T_{\text{SWA}}
f_{\text{SWA}}
({\boldsymbol{\theta}}^{\ast},{\boldsymbol{\phi}}^{\ast\ast})
\boldsymbol{\Theta}_{0}=({\boldsymbol{\theta}}_{0},{\boldsymbol{\phi}}_{0})
\boldsymbol{\Theta}_{\text{SWA}}=\boldsymbol{0}
\boldsymbol{\Theta}_{\text{SWA}}^{\prime}=\boldsymbol{0}
n_{\text{SWA}}=0
t\in\{1,...,T_{1}\}
{\mathcal{B}}\subset{\mathcal{D}}
\displaystyle\boldsymbol{\Theta}_{t}\leftarrow\boldsymbol{\Theta}_{t-1}-\eta_{%
t}\nabla_{\boldsymbol{\Theta}}{\mathcal{L}}(\boldsymbol{\Theta})\big{\rvert}_{%
\boldsymbol{\Theta}=\boldsymbol{\Theta}_{t-1}},
\displaystyle\boldsymbol{\Theta}_{t}\leftarrow\boldsymbol{\Theta}_{t-1}-\eta_{%
t}\nabla_{\boldsymbol{\Theta}}{\mathcal{L}}(\boldsymbol{\Theta})\big{\rvert}_{%
\boldsymbol{\Theta}=\boldsymbol{\Theta}_{t-1}},
\displaystyle{\mathcal{L}}(\boldsymbol{\Theta})=\mathbb{E}_{(\boldsymbol{x},y)%
\sim{\mathcal{B}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};\boldsymbol{%
\Theta})}\right].
\displaystyle{\mathcal{L}}(\boldsymbol{\Theta})=\mathbb{E}_{(\boldsymbol{x},y)%
\sim{\mathcal{B}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};\boldsymbol{%
\Theta})}\right].
t>T_{\text{SWA}}
\texttt{MOD}(t,f)=0
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}\leftarrow(n_{\text{SWA}}%
\boldsymbol{\Theta}_{\text{SWA}}+\boldsymbol{\Theta}_{t})/(n_{\text{SWA}}+1),
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}
\displaystyle\leftarrow(n_{\text{SWA}}\boldsymbol{\Theta}_{\text{SWA}}+%
\boldsymbol{\Theta}_{t})/(n_{\text{SWA}}+1),
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}^{\prime}\leftarrow(n_{\text{SWA}%
}\boldsymbol{\Theta}_{\text{SWA}}^{\prime}+\boldsymbol{\Theta}_{t}^{2})/(n_{%
\text{SWA}}+1),
\displaystyle\boldsymbol{\Theta}_{\text{SWA}}^{\prime}
\displaystyle\leftarrow(n_{\text{SWA}}\boldsymbol{\Theta}_{\text{SWA}}^{\prime%
}+\boldsymbol{\Theta}_{t}^{2})/(n_{\text{SWA}}+1),
\displaystyle n_{\text{SWA}}\leftarrow n_{\text{SWA}}+1.
\displaystyle n_{\text{SWA}}
\displaystyle\leftarrow n_{\text{SWA}}+1.
\boldsymbol{\Theta}_{T_{1}}
\boldsymbol{\Theta}_{T_{1}}\leftarrow\boldsymbol{\Theta}_{\text{SWA}}
\displaystyle q({\boldsymbol{\theta}}|{\mathcal{D}})={\mathcal{N}}({%
\boldsymbol{\theta}}|{\boldsymbol{\theta}}_{\text{SWA}},\boldsymbol{\Sigma}_{%
\text{SWAG}}),\text{ where }\boldsymbol{\Sigma}_{\text{SWAG}}=\mathrm{diag}({%
\boldsymbol{\theta}}_{\text{SWA}}^{\prime}-{\boldsymbol{\theta}}_{\text{SWA}}^%
{2}).
\displaystyle q({\boldsymbol{\theta}}|{\mathcal{D}})={\mathcal{N}}({%
\boldsymbol{\theta}}|{\boldsymbol{\theta}}_{\text{SWA}},\boldsymbol{\Sigma}_{%
\text{SWAG}}),\text{ where }\boldsymbol{\Sigma}_{\text{SWAG}}=\mathrm{diag}({%
\boldsymbol{\theta}}_{\text{SWA}}^{\prime}-{\boldsymbol{\theta}}_{\text{SWA}}^%
{2}).
t\in\{T_{1}+1,...,T_{1}+T_{2}\}
{\mathcal{B}}\subset{\mathcal{D}}
\displaystyle{\boldsymbol{\phi}}_{t}\leftarrow{\boldsymbol{\phi}}_{t-1}-\eta_{%
t}\nabla_{{\boldsymbol{\phi}}}{\mathcal{L}}({\boldsymbol{\phi}})\big{\rvert}_{%
{\boldsymbol{\phi}}={\boldsymbol{\phi}}_{t-1}},
\displaystyle{\boldsymbol{\phi}}_{t}\leftarrow{\boldsymbol{\phi}}_{t-1}-\eta_{%
t}\nabla_{{\boldsymbol{\phi}}}{\mathcal{L}}({\boldsymbol{\phi}})\big{\rvert}_{%
{\boldsymbol{\phi}}={\boldsymbol{\phi}}_{t-1}},
\displaystyle{\mathcal{L}}({\boldsymbol{\phi}})=\mathbb{E}_{(\boldsymbol{x},y)%
\sim{\mathcal{B}}}\left[-\log{\boldsymbol{p}^{(y)}(\boldsymbol{x};({%
\boldsymbol{\theta}}^{\ast},{\boldsymbol{\phi}}))}\right],
\displaystyle{\mathcal{L}}({\boldsymbol{\phi}})
\displaystyle=\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{B}}}\left[-\log{%
\boldsymbol{p}^{(y)}(\boldsymbol{x};({\boldsymbol{\theta}}^{\ast},{\boldsymbol%
{\phi}}))}\right],
\displaystyle\color[rgb]{0,0.5,1}\text{or }{\mathcal{L}}({\boldsymbol{\phi}})%
\color[rgb]{0,0.5,1}=\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{B}}}\left[0.5%
\hat{{\mathcal{L}}}_{\text{CE}}+0.5\hat{{\mathcal{L}}}_{\text{KD}}\right],%
\text{ if we applied SRepr}.
\displaystyle\color[rgb]{0,0.5,1}\text{or }{\mathcal{L}}({\boldsymbol{\phi}})
\displaystyle\color[rgb]{0,0.5,1}=\mathbb{E}_{(\boldsymbol{x},y)\sim{\mathcal{%
B}}}\left[0.5\hat{{\mathcal{L}}}_{\text{CE}}+0.5\hat{{\mathcal{L}}}_{\text{KD}%
}\right],\text{ if we applied SRepr}.
\displaystyle\hat{{\mathcal{L}}}_{\text{CE}}=\mathbb{E}_{(\boldsymbol{x},y)%
\sim q({\boldsymbol{\theta}}|{\mathcal{D}})}\left[-\log{\boldsymbol{p}^{(y)}(%
\boldsymbol{x};({\boldsymbol{\theta}},{\boldsymbol{\phi}}))}\right].
\displaystyle\hat{{\mathcal{L}}}_{\text{CE}}=\mathbb{E}_{(\boldsymbol{x},y)%
\sim q({\boldsymbol{\theta}}|{\mathcal{D}})}\left[-\log{\boldsymbol{p}^{(y)}(%
\boldsymbol{x};({\boldsymbol{\theta}},{\boldsymbol{\phi}}))}\right].
{\boldsymbol{\theta}}^{\ast}={\boldsymbol{\theta}}_{T_{1}}
{\boldsymbol{\phi}}^{\ast\ast}={\boldsymbol{\phi}}_{T_{1}+T_{2}}
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.22}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.008}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.007}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.010}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.008}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.005}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.004}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.06}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.001}
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.24}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.22}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.008}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.24}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.007}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.20}
\scriptstyle{\pm 0.14}
\scriptstyle{\pm 0.34}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.004}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.39}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.45}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.28}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.012}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.30}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.45}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.007}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.03}
\scriptstyle{\pm 0.34}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.20}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.43}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.014}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.26}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.41}
\scriptstyle{\pm 0.06}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.001}
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.52}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.57}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.43}
\scriptstyle{\pm 0.34}
\scriptstyle{\pm 0.40}
\scriptstyle{\pm 0.08}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.50}
\scriptstyle{\pm 0.14}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.005}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.31}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.39}
\scriptstyle{\pm 0.21}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.005}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.73}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.45}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.67}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.68}
\scriptstyle{\pm 0.20}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.57}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.10}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.31}
\scriptstyle{\pm 0.20}
\scriptstyle{\pm 0.32}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.002}
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.31}
\scriptstyle{\pm 0.103}
\scriptstyle{\pm 0.005}
\scriptstyle{\pm 0.03}
\scriptstyle{\pm 0.017}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.14}
\scriptstyle{\pm 0.071}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.025}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.23}
\scriptstyle{\pm 0.083}
\scriptstyle{\pm 0.007}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.006}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.005}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.008}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.011}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.010}
\scriptstyle{\pm 0.001}
\uparrow
\downarrow
\downarrow
\scriptstyle{\pm 0.38}
\scriptstyle{\pm 0.29}
\scriptstyle{\pm 0.57}
\scriptstyle{\pm 0.32}
\scriptstyle{\pm 0.080}
\scriptstyle{\pm 0.010}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.22}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.010}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.16}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.004}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.08}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.12}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.004}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.19}
\scriptstyle{\pm 0.21}
\scriptstyle{\pm 0.71}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.030}
\scriptstyle{\pm 0.007}
\scriptstyle{\pm 0.20}
\scriptstyle{\pm 0.35}
\scriptstyle{\pm 0.33}
\scriptstyle{\pm 0.09}
\scriptstyle{\pm 0.004}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.15}
\scriptstyle{\pm 0.04}
\scriptstyle{\pm 0.003}
\scriptstyle{\pm 0.001}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.24}
\scriptstyle{\pm 0.07}
\scriptstyle{\pm 0.020}
\scriptstyle{\pm 0.002}
\scriptstyle{\pm 0.22}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.40}
\scriptstyle{\pm 0.05}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.000}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.01}
\scriptstyle{\pm 0.11}
\scriptstyle{\pm 0.02}
\scriptstyle{\pm 0.009}
\scriptstyle{\pm 0.002}
\left\lVert\boldsymbol{w}_{y}\right\rVert
y=1,...,K
\smash{p(y)=\mathbb{E}_{(\boldsymbol{x},\cdot)\sim{\mathcal{D}}_{\text{test}}}%
[\boldsymbol{p}^{(y)}_{{\boldsymbol{\theta}},{\boldsymbol{\phi}}}(\boldsymbol{%
x})]}
y=1,...,K
{\mathcal{D}}_{\text{test}}
M
M
10
{\mathcal{F}}_{m}(\boldsymbol{x})
m^{\text{th}}
\boldsymbol{x}
{\mathcal{F}}_{m}(\boldsymbol{x})
m^{\text{th}}
\boldsymbol{x}
{\mathcal{F}}_{m}(\boldsymbol{x})={\mathcal{F}}_{{\boldsymbol{\theta}}_{m}}(%
\boldsymbol{x})
{\boldsymbol{\theta}}_{1},...,{\boldsymbol{\theta}}_{M}\overset{\mathrm{i.i.d.%
}}{\sim}q({\boldsymbol{\theta}})
{\mathcal{F}}_{m}(\boldsymbol{x})={\mathcal{F}}_{{\boldsymbol{\theta}}_{\text{%
SWA}}}(\boldsymbol{x}_{m})
\boldsymbol{x}_{m}
m^{\text{th}}
\boldsymbol{x}
\checkmark
\checkmark
\checkmark
\checkmark
224\times 224\times 3
(0.485,0.456,0.406)
(0.229,0.224,0.225)
0.01
(0.4914,0.4822,0.4465)
(0.2023,0.1994,0.2010)
256
0.9
0.1
128
0.5
\lambda_{\text{wd}}\left\lVert\boldsymbol{\Theta}\right\rVert_{2}^{2}
\lambda_{\text{wd}}>0
\lambda_{\text{wd}}\in\{0.0001,0.0002,0.0003,0.0004,0.0005\}
\lambda_{\text{wd}}=0.0003
\lambda_{\text{wd}}=0.0001
\lambda_{\text{wd}}=0.0005
\lambda_{\text{wd}}
\lambda_{\text{wd}}
\lambda_{\text{wd}}=0.0001
\scriptstyle{\pm 0.52}
\scriptstyle{\pm 0.18}
\scriptstyle{\pm 0.17}
\scriptstyle{\pm 0.05}
\lambda_{\text{wd}}=0.0002
\scriptstyle{\pm 0.39}
\scriptstyle{\pm 0.14}
\scriptstyle{\pm 0.38}
\scriptstyle{\pm 0.17}
\lambda_{\text{wd}}=0.0003
\scriptstyle{\pm 0.36}
\scriptstyle{\pm 0.35}
\scriptstyle{\pm 0.52}
\scriptstyle{\pm 0.22}
\lambda_{\text{wd}}=0.0004
\lambda_{\text{wd}}=0.0005
\eta_{\text{SWA}}
\eta_{\text{SWA}}\in\{0.001,0.005,0.010,0.020\}
\eta_{\text{SWA}}=0.010
\eta_{\text{SWA}}=0.005
\eta_{\text{SWA}}=0.1
\eta_{\text{SWA}}
\eta_{\text{SWA}}
\eta_{\text{SWA}}=0.020
\eta_{\text{SWA}}=0.010
\scriptstyle{\pm 0.49}
\scriptstyle{\pm 0.34}
\scriptstyle{\pm 0.28}
\scriptstyle{\pm 0.22}
\eta_{\text{SWA}}=0.005
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.25}
\scriptstyle{\pm 0.13}
\scriptstyle{\pm 0.10}
\eta_{\text{SWA}}=0.001
