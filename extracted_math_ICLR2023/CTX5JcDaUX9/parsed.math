K
\mathcal{D}
(\mathbf{x},y_{\tt task})\in\mathcal{D}
\mathbf{x}=[x_{1},\ldots,x_{L}]
x_{i}
y_{\tt task}
f_{\theta}:=W_{\tt task}\circ g_{\phi}
g_{\phi}
W_{\tt task}
\mathcal{L}_{\tt task}
p(\mathbf{x})=\text{Softmax}\big{(}f_{\theta}(\mathbf{x})\big{)}
(\mathbf{x}^{0},\mathbf{x}^{1})
y_{\tt task}
y_{\tt pref}
y_{\tt task}
y_{\tt pref}\in\{0,1,0.5\}
\mathbf{x}^{1}\succ\mathbf{x}^{0}
\mathbf{x}^{1}
\mathbf{x}^{0}
\mathbf{x}^{0}\succ\mathbf{x}^{1}
\mathcal{D}
(\mathbf{x}^{0},\mathbf{x}^{1},y_{\tt task},y_{\tt pref})
{h}_{\psi}
\displaystyle{\small P_{\psi}[\mathbf{x}^{1}\succ\mathbf{x}^{0};y_{\tt task}]=%
\frac{\exp\big{(}{h}_{\psi}(\mathbf{x}^{1},y_{\tt task})\big{)}}{\sum_{i\in\{0%
,1\}}\exp\big{(}{h}_{\psi}(\mathbf{x}^{i},y_{\tt task})\big{)}}}
\displaystyle{\small P_{\psi}[\mathbf{x}^{1}\succ\mathbf{x}^{0};y_{\tt task}]=%
\frac{\exp\big{(}{h}_{\psi}(\mathbf{x}^{1},y_{\tt task})\big{)}}{\sum_{i\in\{0%
,1\}}\exp\big{(}{h}_{\psi}(\mathbf{x}^{i},y_{\tt task})\big{)}}}
\mathbf{x}^{i}\succ\mathbf{x}^{j}
i
j
{h}_{\psi}
\displaystyle\mathcal{L}_{\tt pref}=-\mathop{\mathbb{E}}_{\begin{subarray}{c}(%
\mathbf{x}^{0},\mathbf{x}^{1},y_{\tt task}\\
,y_{\tt pref})\sim\mathcal{D}\end{subarray}}\Big{[}y_{\tt pref}\log P_{\psi}[%
\mathbf{x}^{1}\succ\mathbf{x}^{0};y_{\tt task}]
\displaystyle\mathcal{L}_{\tt pref}=
\displaystyle-\mathop{\mathbb{E}}_{\begin{subarray}{c}(\mathbf{x}^{0},\mathbf{%
x}^{1},y_{\tt task}\\
,y_{\tt pref})\sim\mathcal{D}\end{subarray}}\Big{[}y_{\tt pref}\log P_{\psi}[%
\mathbf{x}^{1}\succ\mathbf{x}^{0};y_{\tt task}]
\displaystyle+(1-y_{\tt pref})\log P_{\psi}[\mathbf{x}^{0}\succ\mathbf{x}^{1};%
y_{\tt task}]\Big{]}
\displaystyle+(1-y_{\tt pref})\log P_{\psi}[\mathbf{x}^{0}\succ\mathbf{x}^{1};%
y_{\tt task}]\Big{]}
y_{\tt pref}
y_{\tt task}
f_{\theta}
{h}_{\psi}
f_{\theta}
W_{\tt task}
W_{\tt pref}
g_{\phi}(\mathbf{x})
y_{\tt task}
h_{\psi}(\mathbf{x},y_{\tt task})=W_{\tt pref}\circ[g_{\phi}(\mathbf{x});y_{%
\tt task}]
[A;B]
A
B
f_{\theta}(\mathbf{x})=W_{\tt task}\circ g_{\phi}(\mathbf{x})
\{W_{\tt pref}^{(t)}\}_{t=1}^{T}
\mathcal{L}_{\tt pref}
\{W_{\tt pref}^{(t)}\}_{t=1}^{T}
\mathcal{L}_{\tt div}
\displaystyle\mathcal{L}_{\tt div}=\frac{-1}{T-1}\sum_{j=1,j\neq i}^{T}D_{\tt
KL%
}\big{(}P_{\psi^{(i)}}(\mathbf{x}^{1},\mathbf{x}^{0};y_{\tt task})||
\displaystyle\mathcal{L}_{\tt div}=\frac{-1}{T-1}\sum_{j=1,j\neq i}^{T}D_{\tt
KL%
}\big{(}
\displaystyle P_{\psi^{(i)}}(\mathbf{x}^{1},\mathbf{x}^{0};y_{\tt task})||
\displaystyle P_{\psi^{(j)}}(\mathbf{x}^{1},\mathbf{x}^{0};y_{\tt task})\big{)}
\displaystyle P_{\psi^{(j)}}(\mathbf{x}^{1},\mathbf{x}^{0};y_{\tt task})\big{)}
P_{\psi}(\mathbf{x}^{1},\mathbf{x}^{0};y_{\tt task})
{h}_{\psi}
P_{\psi}(\mathbf{x}^{1},\mathbf{x}^{0};y_{\tt task})=\big{[}P_{\psi}[\mathbf{x%
}^{1}\succ\mathbf{x}^{0};y_{\tt task}],P_{\psi}[\mathbf{x}^{0}\succ\mathbf{x}^%
{1};y_{\tt task}]\big{]}
\mathcal{L_{\tt multi}}
\lambda_{\tt div}
\mathcal{L}_{\tt multi}=\mathcal{L}_{\tt task}+{\mathcal{L}^{\text{all}}_{\tt
pref%
}}+\lambda_{\tt div}\mathcal{L}_{\tt div}
\mathcal{L}^{\psi^{(t)}}_{\tt pref}
\psi^{(t)}
\mathcal{L}^{\text{all}}_{\tt pref}=\sum_{t=1}^{T}\mathcal{L}^{\psi^{(t)}}_{%
\tt pref}
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
p_{y}(\mathbf{x}^{1})>p_{y}(\mathbf{x}^{0})
\mathbf{x}^{1}\succ\mathbf{x}^{0}
y
\displaystyle\mathcal{L}_{\tt cons}=y_{\tt pref}\max\{0,p_{y}(\mathbf{x}^{1})-%
p_{y}(\mathbf{x}^{0})\}
\displaystyle\mathcal{L}_{\tt cons}
\displaystyle=y_{\tt pref}\max\{0,p_{y}(\mathbf{x}^{1})-p_{y}(\mathbf{x}^{0})\}
\displaystyle+(1-y_{\tt pref})\max\{0,p_{y}(\mathbf{x}^{0})-p_{y}(\mathbf{x}^{%
1})\}
\displaystyle+(1-y_{\tt pref})\max\{0,p_{y}(\mathbf{x}^{0})-p_{y}(\mathbf{x}^{%
1})\}
y_{\tt pref}\in[0,1]
y_{\tt pref}\in\{0,1,0.5\}
m
\displaystyle\mathcal{L}_{\tt cons}=y_{\tt pref}\max\{0,m-\Delta p_{y}(\mathbf%
{x}^{1},\mathbf{x}^{0})\}
\displaystyle\mathcal{L}_{\tt cons}
\displaystyle=y_{\tt pref}\max\{0,m-\Delta p_{y}(\mathbf{x}^{1},\mathbf{x}^{0})\}
\displaystyle+(1-y_{\tt pref})\max\{0,\Delta p_{y}(\mathbf{x}^{1},\mathbf{x}^{%
0})-m\}
\displaystyle+(1-y_{\tt pref})\max\{0,\Delta p_{y}(\mathbf{x}^{1},\mathbf{x}^{%
0})-m\}
\Delta p_{y}(\mathbf{x}^{1},\mathbf{x}^{0})=p_{y}(\mathbf{x}^{0})-p_{y}(%
\mathbf{x}^{1})
m=0
\mathcal{L}_{\tt train}=\mathcal{L}_{\tt multi}+\lambda_{\tt cons}\mathcal{L}_%
{\tt cons}
\lambda_{\tt cons}
(\mathbf{x}^{0},\mathbf{x}^{1})
\{{h}_{\psi^{(i)}}\}_{i=1}^{T}
\mathcal{L_{\tt cons}}
N
N
N
N^{2}
\text{Mcc}(\uparrow)
\text{ECE}(\downarrow)
\text{bAcc}(\uparrow)
(\uparrow)
\text{ECE}(\downarrow)
(\uparrow)
(\uparrow)
\text{ECE}(\downarrow)
(\uparrow)
(\uparrow)
\text{ECE}(\downarrow)
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
T=3
\{W_{\tt pref}^{(i)}\}_{i=1}^{T}
W_{\tt pref}
\lambda_{\tt cons},\lambda_{\tt div}\in\{1.0,0.1\}
m
K
K=0,5,20
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\downarrow
\downarrow
\diagup
\diagup
\downarrow
\downarrow
\downarrow
\diagup
\downarrow
\downarrow
\diagup
\downarrow
T
\mathcal{L}_{\tt task}
\mathcal{L}_{\tt pref}
\mathcal{L}_{\tt div}
\mathcal{L}_{\tt cons}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N_{\tt task}
N_{\tt pref}
\text{d}_{\tt hard}
\text{d}_{\tt easy}
l_{1}
N_{\tt task}
N_{\tt pref}
\text{d}_{\tt hard}
\text{d}_{\tt easy}
l_{1}
N_{\tt task}
N_{\tt pref}
\text{Acc}_{\tt avg}(\uparrow)
\text{Acc}_{\tt hard}
\text{Acc}_{\tt easy}(\uparrow)
\text{ECE}(\downarrow)
\text{d}_{\tt hard}
\text{d}_{\tt easy}(\downarrow)
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{Acc}_{\tt avg}
\text{Acc}_{\tt hard}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
L
\mathbf{x}
n_{y}(\mathbf{x})\in\mathbb{N}^{K}
K
n_{\tt vote}(\mathbf{x})=\sum_{y}n_{y}(\mathbf{x})
n_{\tt vote}=5
y_{\tt task}(\mathbf{x})=\arg\max_{y}n_{\tt vote}(\mathbf{x})
y_{\tt task}
f_{\theta}:=W_{\tt task}\circ g_{\phi}
g_{\phi}
W_{\tt task}
\mathbf{x}
p(\mathbf{x})={\tt Softmax}\big{(}f_{\theta}(\mathbf{x})\big{)}
f_{\theta}
\mathcal{L}_{\tt train}=\ell_{\tt xe}(p(\mathbf{x}),y_{\tt task})
y_{\tt task}
q(\mathbf{x})=n_{y}(\mathbf{x})/n_{\tt vote}(\mathbf{x})
\mathcal{L}_{\tt train}=\ell_{\tt xe}(p(\mathbf{x}),q(\mathbf{x}))=\sum_{y}-q_%
{y}(\mathbf{x})\log p_{y}(\mathbf{x})
q(\mathbf{x})
\mathcal{L}_{\tt train}=\sum_{y}\max\{0,q_{y}(\mathbf{x})-p_{y}(\mathbf{x})\}
n_{y_{\tt task}}=3
\mathcal{L}_{\tt train}=\mathbbm{1}[n_{y_{\tt task}}(\boldsymbol{x})>3]~{}\ell%
_{\tt xe}(p(\mathbf{x}),y_{\tt task})
\mathcal{L}_{\tt train}=\mathbf{w}(\mathbf{x})~{}\ell_{\tt xe}(p(\mathbf{x}),y%
_{\tt task})
\mathbf{w}(\mathbf{x})=n_{y_{\tt task}}(\mathbf{x})/n_{\tt vote}(\mathbf{x})
W^{(t)}_{\tt task}
y^{(t)}_{\tt task}
n_{\tt vote}(\mathbf{x})
t=1,\dots,n_{\tt vote}
\mathcal{L}_{\tt train}=\frac{1}{n_{\tt vote}(\mathbf{x})}\sum_{t}~{}\ell_{\tt
xe%
}(p^{(t)}(\mathbf{x}),y^{(t)}_{\tt task})
p^{(t)}(\mathbf{x})=W^{(t)}_{\tt task}\circ g_{\phi}(\mathbf{x})
\mathbf{x}
\widehat{\mathbf{x}}
y_{\tt task}
\tau
\tau=4
\mathcal{L}_{\tt train}=\ell_{\tt xe}(p(\mathbf{x}),y_{\tt task})+\ell_{\tt xe%
}(\widetilde{p}(\mathbf{x}),\widetilde{p}(\widehat{\mathbf{x}}))
\widetilde{p}(\mathbf{x})={\tt Softmax}(f_{\theta}(\mathbf{x})/\tau)
y_{\tt task}
q(\mathbf{x})
\tau
y_{\tt task}
\tau/(K-1)
\tau
[0.05,0.1,0.15]
q(\mathbf{x})
\mathcal{L}_{\tt train}=\ell_{\tt xe}(p(\mathbf{x}),q(\mathbf{x}))=\sum_{y}-q_%
{y}(\mathbf{x})\log p_{y}(\mathbf{x})
y_{\tt task}
p(\mathbf{x})
\lambda
\lambda
[0.1,0.5,1.0]
\mathcal{L}_{\tt train}=\ell_{\tt xe}(p(\mathbf{x}),y_{\tt task})+\lambda\sum_%
{y}p_{y}(\mathbf{x})\log p_{y}(\mathbf{x})
\mathtt{Prefer{\text{-}}to{\text{-}}Classify~{}(P2C)~{}with~{}extractive~{}%
preference~{}labels}
\mathtt{Prefer{\text{-}}to{\text{-}}Classify~{}(P2C)~{}with~{}extractive~{}%
preference~{}labels}
f_{\theta}
\mathcal{D}
\{(\mathbf{x}^{0},\mathbf{x}^{1},y_{\tt task},y_{\tt pref})|\mathbf{x}^{0},%
\mathbf{x}^{1}\in\mathcal{D}\}
\{{h}_{\psi^{(t)}}\}_{t=1}^{T}
B
\lambda_{\tt cons}
\mathcal{B}=\{(\mathbf{x}_{i},y_{{\tt task},i})_{i=1}^{B}\}
\widetilde{\mathcal{B}}=\{(\widetilde{\mathbf{x}}_{i},y_{{\tt pref},i})_{i=1}^%
{B}\}
\mathcal{D}
f_{\theta}(\mathbf{x})
\mathcal{B}
\mathcal{L}_{\tt multi}
h_{\psi}(\mathbf{x})
\mathcal{B}
\widetilde{\mathcal{B}}
\mathcal{L}_{\tt cons}
\theta
\psi^{(t)}
\mathcal{L}_{\tt train}=\mathcal{L}_{\tt multi}+\lambda_{\tt cons}\mathcal{L}_%
{\tt cons}
\mathtt{Prefer{\text{-}}to{\text{-}}Classify~{}(P2C)~{}with~{}subjective/%
generative~{}preference~{}labels}
\mathtt{Prefer{\text{-}}to{\text{-}}Classify~{}(P2C)~{}with~{}subjective/%
generative~{}preference~{}labels}
f_{\theta}
\mathcal{D}=\{(\mathbf{x}_{i},y_{i})\}
\widetilde{\mathcal{D}}
\{(\mathbf{x}^{0},\mathbf{x}^{1},y_{\tt task},y_{\tt pref})|\mathbf{x}^{0},%
\mathbf{x}^{1}\in\mathcal{D}\}
|\widetilde{\mathcal{D}}|=N_{\tt pref}
\{{h}_{\psi^{(t)}}\}_{t=1}^{T}
B
\lambda_{\tt cons}
\mathcal{B}=\{(\mathbf{x}_{i},y_{{\tt task},i})_{i=1}^{B}\}
\mathcal{D}
\widetilde{\mathcal{B}}=\{(\mathbf{x}_{i},\widetilde{\mathbf{x}}_{i},y_{{\tt
task%
},i},y_{{\tt pref},i})_{i=1}^{B}\}
\widetilde{\mathcal{D}}
f_{\theta}(\mathbf{x})
\mathcal{B}
\mathcal{L}_{\tt multi}
h_{\psi}(\mathbf{x})
\widetilde{\mathcal{B}}
\mathcal{L}_{\tt cons}
\theta
\psi^{(t)}
\mathcal{L}_{\tt train}=\mathcal{L}_{\tt multi}+\lambda_{\tt cons}\mathcal{L}_%
{\tt cons}
T=3
\{W_{\tt pref}^{(i)}\}_{i=1}^{T}
{\tt tanh}
W_{\tt pref}
\lambda_{\tt pref},\lambda_{\tt div}\in\{1.0,0.1\}
m
y
\mathbf{x}^{1}
\mathbf{x}^{0}
m_{y}=q_{y}(\mathbf{x}^{1})-q_{y}(\mathbf{x}^{0})
y\in[0,1]^{K}
y_{\tt pref}
n_{y_{\tt task}}(\mathbf{x})
y_{\tt task}
n_{y_{\tt task}}(\mathbf{x}^{1})>n_{y_{\tt task}}(\mathbf{x}^{0})
y_{\tt pref}=1
\mathbf{x}^{1}\succ\mathbf{x}^{0}
y_{\tt pref}=0
n_{y_{\tt task}}(\mathbf{x}^{1})<n_{y_{\tt task}}(\mathbf{x}^{0})
y_{\tt pref}=0.5
n_{y_{\tt task}}(\mathbf{x}^{1})=n_{y_{\tt task}}(\mathbf{x}^{0})
y_{\tt task}(\mathbf{x}^{1})=y_{\tt task}(\mathbf{x}^{0})
i
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\succ
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathcal{L}_{\tt div}
\mathcal{L}_{\tt div}
\lambda_{\tt div}
\mathcal{L}_{\tt div}
\lambda_{\tt div}
\lambda_{\tt div}
\lambda_{\tt div}=10
\lambda_{\tt div}
\lambda_{\tt div}
\lambda_{\tt div}
\lambda_{\tt div}=0
\lambda_{\tt div}=1
\lambda_{\tt div}=2
\lambda_{\tt div}=10
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
N
N=250
N=4000
N=250
N=500
N=1000
N=2000
N=4000
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
