K
\sim 10\%
{\bm{w}}
\psi
\mathcal{D}
p({\bm{w}})
{\bm{w}}
p(\mathcal{D}|{\bm{w}},\psi)
\mathcal{D}
\psi
p({\bm{w}}|\mathcal{D},\psi)=p(\mathcal{D}|{\bm{w}},\psi)p({\bm{w}})/p(%
\mathcal{D}|\psi)
p(\mathcal{D}|\psi)
\psi
{\bm{w}}
p(\mathcal{D}|\psi)=\int p({\bm{w}})p(\mathcal{D}|{\bm{w}},\psi)d{\bm{w}}
\mathcal{D}
\psi
\displaystyle\log p(\mathcal{D}|\psi)=\sum_{k}\log\mathbb{E}_{p({\bm{w}}|%
\mathcal{D}_{1:k-1},\psi)}\left[p(\mathcal{D}_{k}|{\bm{w}},\psi)\right]\geq%
\sum_{k}\mathbb{E}_{p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}\left[\log p(\mathcal%
{D}_{k}|{\bm{w}},\psi)\right]
\displaystyle\log p(\mathcal{D}|\psi)
\displaystyle=\sum_{k}\log\mathbb{E}_{p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}%
\left[p(\mathcal{D}_{k}|{\bm{w}},\psi)\right]\geq\sum_{k}\mathbb{E}_{p({\bm{w}%
}|\mathcal{D}_{1:k-1},\psi)}\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right]
(\mathcal{D}_{1},\dots,\mathcal{D}_{C})
\mathcal{D}
C
p({\bm{w}}|\mathcal{D}_{1:k},\psi)
f_{\bm{w}}:{\mathcal{X}}\to{\mathcal{Y}}
{\mathcal{X}}
{\mathcal{Y}}
1
k
\mathcal{D}_{k}
\mathcal{D}_{1:k-1}
\psi
{\bm{w}}
f_{\bm{w}}
p({\bm{w}}|\mathcal{D}_{1:k},\psi)
{\bm{w}}
\mathcal{D}_{1:k}
p({\bm{w}}|\mathcal{D}_{1:k},\psi)
1
1
q_{k}({\bm{w}})=\delta({\bm{w}}=\hat{{\bm{w}}}_{k})
p({\bm{w}}|\mathcal{D}_{1:k},\psi)
\mathcal{D}_{1:k}
\displaystyle\mathcal{L}_{\mathrm{ML}}\left(\mathcal{D},\psi\right)=\sum_{k=1}%
^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right]
\displaystyle\mathcal{L}_{\mathrm{ML}}\left(\mathcal{D},\psi\right)
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(%
\mathcal{D}_{k}|{\bm{w}},\psi)\right]
\psi
\mathcal{D}_{1:k}
k
\{q_{k}({\bm{w}})\}_{k=1}^{C}
{\bm{w}}\in\mathbb{R}^{N}
\left(({\bm{w}}_{1},\dots,{\bm{w}}_{C}),P\right)
C
{\bm{w}}=P\operatorname{concat}({\bm{w}}_{1},\dots,{\bm{w}}_{C})
P\in\{0,1\}^{N\times N}
P
{\bm{w}}
P
P=I_{N\times N}
\left({\bm{w}}_{1},\dots,{\bm{w}}_{C}\right)
C
{\bm{w}}_{s}^{(1)},\dots,{\bm{w}}_{s}^{(C)}
{\bm{w}}_{s}^{(k)}=\operatorname{concat}({\bm{w}}_{1},\dots,{\bm{w}}_{k},\hat{%
{\bm{w}}}_{k+1},\dots,\hat{{\bm{w}}}_{C})
\hat{{\bm{w}}}_{i}
\hat{{\bm{w}}}_{i}
\hat{{\bm{w}}}_{i}=\bm{0}
k
{\bm{w}}_{s}^{k}
k
\hat{{\bm{w}}}_{k+1:C}
{\bm{w}}_{k}
\mathcal{D}_{1:k}
{\bm{w}}_{s}^{(k)}
\mathcal{D}_{1:k}
{\bm{w}}_{s}^{(k)}
q_{k}({\bm{w}})
{\bm{w}}_{s}^{(k)}
\mathcal{D}_{1:k}
\mathcal{D}
C
(\mathcal{D}_{1},\dots,\mathcal{D}_{k})
{\bm{w}}_{k}
\log p({\bm{w}}_{s}^{(k)})
\mathcal{D}_{1:k}
{\bm{w}}_{s}^{(k)}
\nabla_{{\bm{w}}_{k}}\mathcal{L}\left(\mathcal{D}_{1:k},{\bm{w}}_{s}^{(k)}%
\right)=\sum_{({\bm{x}},y)\in\mathcal{D}_{1:k}}\nabla_{{\bm{w}}_{k}}\log p%
\left(y\middle|{\bm{x}};{\bm{w}}_{s}^{(k)},\psi\right).
\psi
\mathcal{L}_{\mathrm{ML}}
\nabla_{\psi}\mathcal{L}_{\mathrm{ML}}\left(\mathcal{D},\psi\right)\approx\sum%
_{k=2}^{C}\sum_{({\bm{x}},y)\in\mathcal{D}_{k}}\nabla_{\psi}\log p\left(y%
\middle|{\bm{x}},{\bm{w}}_{s}^{(k-1)},\psi\right).
{\bm{w}}^{(k)}_{s}
\mathbb{E}_{q_{0}({\bm{w}})}[\log p(\mathcal{D}_{1}|{\bm{w}},\psi)]
\log p\left(\mathcal{D}_{2:C}\middle|\mathcal{D}_{1},\psi\right)
\vdots
{\bm{w}}=\left({\color[rgb]{0.08984375,0.375,0.7890625}{\bm{w}}_{1}},{\color[%
rgb]{0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}},{\color[rgb]{%
0.1640625,0.6171875,0.5625}{\bm{w}}_{3}}\right)
\displaystyle\log p\big{(}\mathcal{D}_{1}\hskip 5.97527pt|\underbrace{\left({%
\color[rgb]{0.08984375,0.375,0.7890625}{\bm{w}}_{1}},\hat{{\bm{w}}}_{2},\hat{{%
\bm{w}}}_{3}\right)}_{\text{Subnet. 1}},\psi\big{)}\text{w.r.t. }{\color[rgb]{%
0.08984375,0.375,0.7890625}{\bm{w}}_{1}}
\displaystyle\log p\big{(}\mathcal{D}_{1}\hskip 5.97527pt|\underbrace{\left({%
\color[rgb]{0.08984375,0.375,0.7890625}{\bm{w}}_{1}},\hat{{\bm{w}}}_{2},\hat{{%
\bm{w}}}_{3}\right)}_{\text{Subnet. 1}},\psi\big{)}
\displaystyle\text{w.r.t. }{\color[rgb]{0.08984375,0.375,0.7890625}{\bm{w}}_{1}}
\displaystyle\log p\big{(}\mathcal{D}_{1:2}|\underbrace{\left({\color[rgb]{%
0.08984375,0.375,0.7890625}{\bm{w}}_{1}},{\color[rgb]{%
0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}},\hat{{\bm{w}}}_{3}\right)}_{\text%
{Subnet. 2}},\psi\big{)}\text{w.r.t. }{\color[rgb]{%
0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}}
\displaystyle\log p\big{(}\mathcal{D}_{1:2}|\underbrace{\left({\color[rgb]{%
0.08984375,0.375,0.7890625}{\bm{w}}_{1}},{\color[rgb]{%
0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}},\hat{{\bm{w}}}_{3}\right)}_{\text%
{Subnet. 2}},\psi\big{)}
\displaystyle\text{w.r.t. }{\color[rgb]{0.9140625,0.76953125,0.4140625}{\bm{w}%
}_{2}}
\displaystyle\log p\big{(}\mathcal{D}_{1:3}|\underbrace{\left({\color[rgb]{%
0.08984375,0.375,0.7890625}{\bm{w}}_{1}},{\color[rgb]{%
0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}},{\color[rgb]{%
0.1640625,0.6171875,0.5625}{\bm{w}}_{3}}\right)}_{\text{Subnet. 3}},\psi\big{)%
}\text{w.r.t. }{\color[rgb]{0.1640625,0.6171875,0.5625}{\bm{w}}_{3}}
\displaystyle\log p\big{(}\mathcal{D}_{1:3}|\underbrace{\left({\color[rgb]{%
0.08984375,0.375,0.7890625}{\bm{w}}_{1}},{\color[rgb]{%
0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}},{\color[rgb]{%
0.1640625,0.6171875,0.5625}{\bm{w}}_{3}}\right)}_{\text{Subnet. 3}},\psi\big{)}
\displaystyle\text{w.r.t. }{\color[rgb]{0.1640625,0.6171875,0.5625}{\bm{w}}_{3}}
\psi
\log p\big{(}\mathcal{D}_{2}|\underbrace{\left({\color[rgb]{%
0.08984375,0.375,0.7890625}{\bm{w}}_{1}},\hat{{\bm{w}}}_{2},\hat{{\bm{w}}}_{3}%
\right)}_{\text{Subnet. 1}},\psi\big{)}+\log p\big{(}\mathcal{D}_{3}|%
\underbrace{\left({\color[rgb]{0.08984375,0.375,0.7890625}{\bm{w}}_{1}},{%
\color[rgb]{0.9140625,0.76953125,0.4140625}{\bm{w}}_{2}},\hat{{\bm{w}}}_{3}%
\right)}_{\text{Subnet. 2}},\psi\big{)}
C=3
C=3
\mathcal{L}_{\mathrm{ML}}
15
\mathcal{L}_{\mathrm{ML}}
15
\mathcal{L}_{\mathrm{ML}}
15
15
\displaystyle y\sim\operatorname{Bern}\left(\frac{1}{2}\right)
\displaystyle y
\displaystyle\sim\operatorname{Bern}\left(\frac{1}{2}\right)
\displaystyle{\bm{x}}=\big{[}\underbrace{y+\epsilon_{1},\dots,y+\epsilon_{15}}%
_{\text{Informative}},\underbrace{\epsilon_{16},\dots,\epsilon_{30}}_{\text{%
Spurious}}\big{]}^{\intercal}\epsilon_{1},\dots,\epsilon_{30}\overset{\text{%
iid}}{\sim}\mathcal{N}(0,1).
\displaystyle{\bm{x}}=\big{[}\underbrace{y+\epsilon_{1},\dots,y+\epsilon_{15}}%
_{\text{Informative}},\underbrace{\epsilon_{16},\dots,\epsilon_{30}}_{\text{%
Spurious}}\big{]}^{\intercal}
\displaystyle\epsilon_{1},\dots,\epsilon_{30}\overset{\text{iid}}{\sim}%
\mathcal{N}(0,1).
K
1000
\mathcal{L}_{\mathrm{ML}}
\mathcal{L}_{\text{ML}}
15
15
[-\pi,\pi]
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
54.2_{\pm 0.4}
75.4_{\pm 0.2}
\mathbf{79.5_{\pm 0.6}}
\mathbf{79.1_{\pm 0.0}}
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
74.1_{\pm 0.5}
79.0_{\pm 1.0}
84.2_{\pm 0.8}
\mathbf{86.1_{\pm 0.4}}
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
79.5_{\pm 0.3}
83.0_{\pm 0.1}
88.1_{\pm 0.2}
\mathbf{89.1_{\pm 0.8}}
31.5_{\pm 0.6}
\mathbf{44.5_{\pm 0.2}}
43.9_{\pm 0.3}
44.2_{\pm 0.5}
41.1_{\pm 0.2}
\mathbf{48.6_{\pm 0.0}}
C
k
\mathcal{D}_{1:k}
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
20k
\mathcal{L}_{\mathrm{ML}}
20
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
20k
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
20k
[0.3,0.7]
[0.5,0.5]
[0.7,0.3]
[0.8,0.2]
[0.9,0.1]
\mathbf{82.9\%_{\pm 0.3}}
\mathbf{83.0\%_{\pm 0.01}}
\mathbf{83.7\%_{\pm 0.2}}
\mathbf{84.0\%_{\pm 0.6}}
\mathbf{84.6\%_{\pm 0.05}}
78.9\%_{\pm 0.04}
81.5\%_{\pm 0.2}
82.6\%_{\pm 0.1}
83.4\%_{\pm 0.1}
\textSFii\textSFx
81.3\%_{\pm 0.09}
82.5\%_{\pm 0.2}
83.5\%_{\pm 0.1}
83.8\%_{\pm 0.3}
2
3
2
3
[0.9,0.1]
59.6\%_{\pm 0.6}
[0.1,0.8,0.1]
\mathbf{87.3\%_{\pm 0.8}}
90
10
10\%
6
10\%
N
C
k
{\bm{w}}_{k:C}
{\bm{w}}_{s}^{(k:C)}
\psi
{\bm{w}}_{1:k}
10
10
4
10
10
4
\uparrow
\uparrow
\downarrow
1.25k
5k
50k
1.25k
5k
50k
\%
95.4\%_{\pm 0.1}
97.4\%_{\pm 0.1}
99.0\%_{\pm 0.1}
80.5\%_{\pm 0.0}
90.4\%_{\pm 0.5}
96.8\%_{\pm 0.1}
100
94.2\%_{\pm 0.5}
96.4\%_{\pm 0.1}
99.1\%_{\pm 0.0}
79.5\%_{\pm 0.3}
89.0\%_{\pm 2.0}
95.3\%_{\pm 0.2}
100
\mathbf{97.0\%_{\pm 0.1}}
\mathbf{98.3\%_{\pm 0.0}}
99.2\%_{\pm 0.1}
\mathbf{85.7\%_{\pm 0.9}}
\mathbf{93.5\%_{\pm 0.6}}
\mathbf{97.8\%_{\pm 0.1}}
77
\uparrow
\uparrow
\downarrow
1.25k
5k
45k
1.25k
5k
45k
\%
50.2\%_{\pm 0.4}
64.5\%_{\pm 0.3}
79.2\%_{\pm 0.7}
35.6\%_{\pm 0.3}
45.2\%_{\pm 0.1}
53.9\%_{\pm 1.1}
100
49.9\%_{\pm 0.8}
65.0\%_{\pm 0.2}
79.9\%_{\pm 0.4}
36.1\%_{\pm 0.2}
45.0\%_{\pm 0.2}
56.4\%_{\pm 0.7}
100
50.8\%_{\pm 1.0}
64.8\%_{\pm 0.4}
\mathbf{81.5\%_{\pm 0.5}}
\mathbf{37.1\%_{\pm 0.2}}
45.3\%_{\pm 0.3}
\mathbf{60.6\%_{\pm 0.2}}
91
\mathcal{L}_{\mathrm{ML}}
\mathcal{L}_{\mathrm{ML}}
q_{k}({\bm{w}})
\displaystyle\log p(\mathcal{D}|\psi)=\sum_{k=1}^{C}\log p(\mathcal{D}_{k}|%
\mathcal{D}_{1:k-1},\psi)
\displaystyle\log p(\mathcal{D}|\psi)=\sum_{k=1}^{C}\log p(\mathcal{D}_{k}|%
\mathcal{D}_{1:k-1},\psi)
\displaystyle\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(\mathcal%
{D}_{k}|{\bm{w}},\psi)\right]
\displaystyle\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(\mathcal%
{D}_{k}|{\bm{w}},\psi)\right]
\displaystyle\mathrm{gap}=\sum_{k=1}^{C}\log p(\mathcal{D}_{k}|\mathcal{D}_{1:%
k-1},\psi)-\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(\mathcal{D%
}_{k}|{\bm{w}},\psi)\right]
\displaystyle\mathrm{gap}
\displaystyle=\sum_{k=1}^{C}\log p(\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)-%
\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(\mathcal{D}_{k}|{\bm{%
w}},\psi)\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(%
\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)-\log p(\mathcal{D}_{k}|{\bm{w}},\psi%
)\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log p(%
\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)-\log p(\mathcal{D}_{k}|{\bm{w}},\psi%
)\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log\frac{p(%
\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)}{p(\mathcal{D}_{k}|{\bm{w}},\psi)}\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log\frac{p(%
\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)}{p(\mathcal{D}_{k}|{\bm{w}},\psi)}\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log\frac{{%
\overbrace{{\color[rgb]{0.90625,0.43359375,0.31640625}p({\bm{w}}|\mathcal{D}_{%
1:k},\psi)}p(\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)}^{p({\bm{w}},\mathcal{D%
}_{k}|\mathcal{D}_{1:k-1})}}{\color[rgb]{0.08984375,0.375,0.7890625}p({\bm{w}}%
|\mathcal{D}_{1:k-1},\psi)}}{{\color[rgb]{0.90625,0.43359375,0.31640625}p({\bm%
{w}}|\mathcal{D}_{1:k},\psi)}{\underbrace{p(\mathcal{D}_{k}|{\bm{w}},\psi){%
\color[rgb]{0.08984375,0.375,0.7890625}p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}}_%
{p({\bm{w}},\mathcal{D}_{k}|\mathcal{D}_{1:k-1})}}}\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log\frac{{%
\overbrace{{\color[rgb]{0.90625,0.43359375,0.31640625}p({\bm{w}}|\mathcal{D}_{%
1:k},\psi)}p(\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)}^{p({\bm{w}},\mathcal{D%
}_{k}|\mathcal{D}_{1:k-1})}}{\color[rgb]{0.08984375,0.375,0.7890625}p({\bm{w}}%
|\mathcal{D}_{1:k-1},\psi)}}{{\color[rgb]{0.90625,0.43359375,0.31640625}p({\bm%
{w}}|\mathcal{D}_{1:k},\psi)}{\underbrace{p(\mathcal{D}_{k}|{\bm{w}},\psi){%
\color[rgb]{0.08984375,0.375,0.7890625}p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}}_%
{p({\bm{w}},\mathcal{D}_{k}|\mathcal{D}_{1:k-1})}}}\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log\frac{%
\color[rgb]{0.08984375,0.375,0.7890625}p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}{%
\color[rgb]{0.90625,0.43359375,0.31640625}p({\bm{w}}|\mathcal{D}_{1:k},\psi)}\right]
\displaystyle=\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({\bm{w}})}\left[\log\frac{%
\color[rgb]{0.08984375,0.375,0.7890625}p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}{%
\color[rgb]{0.90625,0.43359375,0.31640625}p({\bm{w}}|\mathcal{D}_{1:k},\psi)}\right]
\displaystyle=\sum_{k=1}^{C}D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm{w}}%
|\mathcal{D}_{1:k},\psi)\right]-D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm%
{w}}|\mathcal{D}_{1:k-1},\psi)\right]
\displaystyle=\sum_{k=1}^{C}D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm{w}}%
|\mathcal{D}_{1:k},\psi)\right]-D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm%
{w}}|\mathcal{D}_{1:k-1},\psi)\right]
D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm{w}}|\mathcal{D}_{1:k},\psi)%
\right]\geq D_{\mathrm{KL}}\left[q_{k}({\bm{w}})\|p({\bm{w}}|\mathcal{D}_{1:k}%
,\psi)\right]
q_{k}({\bm{w}})
\mathcal{D}_{1:k}
p({\bm{w}}|\mathcal{D}_{1:k})
q_{k-1}({\bm{w}})
\mathcal{D}_{1:k-1}
D_{\mathrm{KL}}\left[q_{C-1}({\bm{w}})\|p({\bm{w}}|\mathcal{D}_{1:C},\psi)%
\right]\geq D_{\mathrm{KL}}\left[q_{0}({\bm{w}})\|p({\bm{w}})\right]
q_{0}({\bm{w}})
p({\bm{w}})
\displaystyle\mathrm{gap}=-D_{\mathrm{KL}}\left[q_{0}({\bm{w}})\|p({\bm{w}})%
\right]+D_{\mathrm{KL}}\left[q_{C-1}({\bm{w}})\|p({\bm{w}}|\mathcal{D}_{1:C},%
\psi)\right]+
\displaystyle\mathrm{gap}
\displaystyle=-D_{\mathrm{KL}}\left[q_{0}({\bm{w}})\|p({\bm{w}})\right]+D_{%
\mathrm{KL}}\left[q_{C-1}({\bm{w}})\|p({\bm{w}}|\mathcal{D}_{1:C},\psi)\right]+
\displaystyle\sum_{k=1}^{C}D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm{w}}|%
\mathcal{D}_{1:k},\psi)\right]-D_{\mathrm{KL}}\left[q_{k}({\bm{w}})\|p({\bm{w}%
}|\mathcal{D}_{1:k},\psi)\right]\geq 0,
\displaystyle\sum_{k=1}^{C}D_{\mathrm{KL}}\left[q_{k-1}({\bm{w}})\|p({\bm{w}}|%
\mathcal{D}_{1:k},\psi)\right]-D_{\mathrm{KL}}\left[q_{k}({\bm{w}})\|p({\bm{w}%
}|\mathcal{D}_{1:k},\psi)\right]\geq 0,
\displaystyle\log p(\mathcal{D}|\psi)\geq\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({%
\bm{w}})}\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right].
\displaystyle\log p(\mathcal{D}|\psi)\geq\sum_{k=1}^{C}\mathbb{E}_{q_{k-1}({%
\bm{w}})}\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right].
\mathcal{D}
C
\mathcal{D}=(\mathcal{D}_{1},\dots,\mathcal{D}_{C})
{\bm{w}}\in\mathbb{R}^{D_{w}}
p({\bm{w}})=\prod_{j=1}^{D_{w}}\mathcal{N}({\bm{w}}_{j}|0,\lambda)
p(\mathcal{D}|{\bm{w}},\psi)
\psi
\displaystyle\log p(\mathcal{D}|\psi)=\sum_{k}\log p(\mathcal{D}_{k}|\mathcal{%
D}_{1:k-1},\psi)=\sum_{k}\log\mathbb{E}_{p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}%
\left[p(\mathcal{D}_{k}|{\bm{w}},\psi)\right]
\displaystyle\log p(\mathcal{D}|\psi)
\displaystyle=\sum_{k}\log p(\mathcal{D}_{k}|\mathcal{D}_{1:k-1},\psi)=\sum_{k%
}\log\mathbb{E}_{p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}\left[p(\mathcal{D}_{k}|%
{\bm{w}},\psi)\right]
\displaystyle\geq\sum_{k}\mathbb{E}_{p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}%
\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right].
\displaystyle\geq\sum_{k}\mathbb{E}_{p({\bm{w}}|\mathcal{D}_{1:k-1},\psi)}%
\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right].
p({\bm{w}}|\mathcal{D}_{1:j},\psi)
j\in\{1,\dots,C\}
q_{\phi_{j}}({\bm{w}})
j\in\{1,\dots,C\}
\phi_{j}
j
q_{\phi_{j}}({\bm{w}})
p({\bm{w}}|\mathcal{D}_{1:j},\psi)
\displaystyle\log p(\mathcal{D}|\psi)\geq\sum_{k}\mathbb{E}_{q_{\phi_{k-1}}({%
\bm{w}})}\left[\log p(\mathcal{D}_{k}|{\bm{w}},\psi)\right].
\displaystyle\log p(\mathcal{D}|\psi)
\displaystyle\geq\sum_{k}\mathbb{E}_{q_{\phi_{k-1}}({\bm{w}})}\left[\log p(%
\mathcal{D}_{k}|{\bm{w}},\psi)\right].
q_{\phi_{k}}({\bm{w}})
{\bm{w}}
C
{\bm{w}}_{k}\in\mathbb{R}^{D_{wk}}
\sum_{k}D_{wk}=D_{w}
{\bm{w}}_{k}
\mathcal{D}_{k}
r_{\phi_{k}}({\bm{w}}_{k})
{\bm{w}}_{k}
\phi_{k}
q_{\phi_{k}}({\bm{w}})
\displaystyle q_{\phi_{k}}({\bm{w}})=\left(\prod_{j=1}^{k-1}r_{\phi_{j}}({\bm{%
w}}_{j})\right)r_{\phi_{k}}({\bm{w}}_{k})\left(\prod_{m=k+1}^{K}r_{0}({\bm{w}}%
_{m})\right)
\displaystyle q_{\phi_{k}}({\bm{w}})
\displaystyle=\left(\prod_{j=1}^{k-1}r_{\phi_{j}}({\bm{w}}_{j})\right)r_{\phi_%
{k}}({\bm{w}}_{k})\left(\prod_{m=k+1}^{K}r_{0}({\bm{w}}_{m})\right)
r_{0}(\cdot)
q_{\phi_{k}}({\bm{w}})
p({\bm{w}}|\mathcal{D}_{1:k},\psi)
k
\displaystyle D_{\mathrm{KL}}\left[q_{\phi_{k}}({\bm{w}})\|p({\bm{w}}|\mathcal%
{D}_{1:k},\psi)\right]=-\mathbb{E}_{q_{\phi_{k}}({\bm{w}})}[\log p(\mathcal{D}%
_{1:k}|{\bm{w}},\psi)]+D_{\mathrm{KL}}\left[q_{\phi_{k}}({\bm{w}})\|p({\bm{w}}%
)\right]
\displaystyle D_{\mathrm{KL}}\left[q_{\phi_{k}}({\bm{w}})\|p({\bm{w}}|\mathcal%
{D}_{1:k},\psi)\right]=
\displaystyle-\mathbb{E}_{q_{\phi_{k}}({\bm{w}})}[\log p(\mathcal{D}_{1:k}|{%
\bm{w}},\psi)]+D_{\mathrm{KL}}\left[q_{\phi_{k}}({\bm{w}})\|p({\bm{w}})\right]
\displaystyle+\log p(\mathcal{D}_{1:k}|\psi)
\displaystyle+\log p(\mathcal{D}_{1:k}|\psi)
\phi_{k}
\displaystyle\operatorname*{arg\,min}_{\phi_{k}}\enskip D_{\mathrm{KL}}\left[q%
_{\phi_{k}}({\bm{w}})\|p({\bm{w}}|\mathcal{D}_{1:k},\psi)\right]=
\displaystyle\operatorname*{arg\,min}_{\phi_{k}}
\displaystyle\enskip D_{\mathrm{KL}}\left[q_{\phi_{k}}({\bm{w}})\|p({\bm{w}}|%
\mathcal{D}_{1:k},\psi)\right]=
\displaystyle=\operatorname*{arg\,min}_{\phi_{k}}-\mathbb{E}_{q_{\phi_{k}}({%
\bm{w}})}[\log p(\mathcal{D}_{1:k}|{\bm{w}},\psi)]+D_{\mathrm{KL}}\left[q_{%
\phi_{k}}({\bm{w}})\|p({\bm{w}})\right]
\displaystyle=
\displaystyle\operatorname*{arg\,min}_{\phi_{k}}-\mathbb{E}_{q_{\phi_{k}}({\bm%
{w}})}[\log p(\mathcal{D}_{1:k}|{\bm{w}},\psi)]+D_{\mathrm{KL}}\left[q_{\phi_{%
k}}({\bm{w}})\|p({\bm{w}})\right]
\displaystyle=\operatorname*{arg\,min}_{\phi_{k}}-\mathbb{E}_{q_{\phi_{k}}({%
\bm{w}})}[\log p(\mathcal{D}_{1:k}|{\bm{w}},\psi)]
\displaystyle=
\displaystyle\operatorname*{arg\,min}_{\phi_{k}}-\mathbb{E}_{q_{\phi_{k}}({\bm%
{w}})}[\log p(\mathcal{D}_{1:k}|{\bm{w}},\psi)]
\displaystyle+D_{\mathrm{KL}}\left[\left(\prod_{j=1}^{k-1}r_{\phi_{j}}({\bm{w}%
}_{j})\right)r_{\phi_{k}}({\bm{w}}_{k})\left(\prod_{m=k+1}^{K}r_{0}({\bm{w}}_{%
m})\right)\|\prod_{i}^{K}p({\bm{w}}_{i})\right]
\displaystyle+D_{\mathrm{KL}}\left[\left(\prod_{j=1}^{k-1}r_{\phi_{j}}({\bm{w}%
}_{j})\right)r_{\phi_{k}}({\bm{w}}_{k})\left(\prod_{m=k+1}^{K}r_{0}({\bm{w}}_{%
m})\right)\|\prod_{i}^{K}p({\bm{w}}_{i})\right]
\displaystyle=\operatorname*{arg\,min}_{\phi_{k}}-\mathbb{E}_{q_{\phi_{k}}({%
\bm{w}})}[\log p(\mathcal{D}_{1:k}|{\bm{w}},\psi)]+D_{\mathrm{KL}}\left[r_{%
\phi_{k}}({\bm{w}}_{k})\|p({\bm{w}}_{k})\right].
\displaystyle=
\displaystyle\operatorname*{arg\,min}_{\phi_{k}}-\mathbb{E}_{q_{\phi_{k}}({\bm%
{w}})}[\log p(\mathcal{D}_{1:k}|{\bm{w}},\psi)]+D_{\mathrm{KL}}\left[r_{\phi_{%
k}}({\bm{w}}_{k})\|p({\bm{w}}_{k})\right].
r_{\phi_{k}}({\bm{w}}_{k})=\mathcal{N}({\bm{w}}_{k}|\phi_{k},\nu\mathbf{I})
k\in\{1,\dots,C\}
r_{0}({\mathbf{w}})=\mathcal{N}({\bm{w}}|\hat{{\bm{w}}},\nu\mathbf{I})
\hat{{\bm{w}}}
\nu\rightarrow 0
\phi_{k}
k
\phi_{k}
p({\mathbf{w}}_{k})
\lambda\rightarrow\infty
p({\mathbf{w}})
{\bm{w}}
{\bm{w}}^{(k)}_{s}
\begin{bmatrix}\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{%
0,0,0}{w_{11}}&\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{%
0,0,0}{w_{12}}&\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{%
0,0,0}w_{13}&\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0%
}w_{14}&\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{1%
5}\\
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{21}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{22}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{23}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{24}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{25}\\
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{31}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{32}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{33}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{34}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{35}\\
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{41}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{42}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{43}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{44}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{45}\\
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{51}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{52}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{53}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{54}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{55}\\
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{61}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{62}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{63}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{64}&%
\pgfmathrandomitem{\RandomColor}{MyRandomColors}\color[rgb]{0,0,0}w_{65}\end{bmatrix}
\begin{matrix}\hskip 38.0pt\color[rgb]{.5,.5,.5}\overbrace{\color[rgb]{0,0,0}%
\begin{matrix}\hskip 5.0pt\tikz\draw[pastel-blue,fill=pastel-blue](0,0)circle(%
.5ex);\hskip 5.0pt&\hskip 5.0pt\tikz\draw[pastel-blue,fill=pastel-blue](0,0)%
circle(.5ex);\hskip 5.0pt&\hskip 5.0pt\tikz\draw[pastel-blue,fill=pastel-blue]%
(0,0)circle(.5ex);\hskip 5.0pt&\hskip 5.0pt\tikz\draw[pastel-yellow,fill=%
pastel-yellow](0,0)circle(.5ex);\hskip 5.0pt&\hskip 5.0pt\tikz\draw[pastel-%
teal,fill=pastel-teal](0,0)circle(.5ex);\end{matrix}}^{\tiny\text{In node %
assignment}}\\
\color[rgb]{.5,.5,.5}\begin{subarray}{c}\scriptsize\text{Out}\\
\text{node}\\
\text{assignment}\end{subarray}\left\{\color[rgb]{0,0,0}\par\begin{matrix}%
\tikz\draw[pastel-blue,fill=pastel-blue](0,0)circle(.5ex);\\
\tikz\draw[pastel-blue,fill=pastel-blue](0,0)circle(.5ex);\\
\tikz\draw[pastel-blue,fill=pastel-blue](0,0)circle(.5ex);\\
\tikz\draw[pastel-yellow,fill=pastel-yellow](0,0)circle(.5ex);\\
\tikz\draw[pastel-yellow,fill=pastel-yellow](0,0)circle(.5ex);\\
\tikz\draw[pastel-teal,fill=pastel-teal](0,0)circle(.5ex);\\
\end{matrix}\par\begin{bmatrix}\color[rgb]{0.08984375,0.375,0.7890625}{w_{11}}%
&\color[rgb]{0.08984375,0.375,0.7890625}{w_{12}}&\color[rgb]{%
0.08984375,0.375,0.7890625}w_{13}&\color[rgb]{0.9140625,0.76953125,0.4140625}w%
_{14}&\color[rgb]{0.1640625,0.6171875,0.5625}w_{15}\\
\color[rgb]{0.08984375,0.375,0.7890625}w_{21}&\color[rgb]{%
0.08984375,0.375,0.7890625}w_{22}&\color[rgb]{0.08984375,0.375,0.7890625}w_{23%
}&\color[rgb]{0.9140625,0.76953125,0.4140625}w_{24}&\color[rgb]{%
0.1640625,0.6171875,0.5625}w_{25}\\
\color[rgb]{0.08984375,0.375,0.7890625}w_{31}&\color[rgb]{%
0.08984375,0.375,0.7890625}w_{32}&\color[rgb]{0.08984375,0.375,0.7890625}w_{33%
}&\color[rgb]{0.9140625,0.76953125,0.4140625}w_{34}&\color[rgb]{%
0.1640625,0.6171875,0.5625}w_{35}\\
\color[rgb]{0.9140625,0.76953125,0.4140625}w_{41}&\color[rgb]{%
0.9140625,0.76953125,0.4140625}w_{42}&\color[rgb]{%
0.9140625,0.76953125,0.4140625}w_{43}&\color[rgb]{%
0.9140625,0.76953125,0.4140625}w_{44}&\color[rgb]{0.1640625,0.6171875,0.5625}w%
_{45}\\
\color[rgb]{0.9140625,0.76953125,0.4140625}w_{51}&\color[rgb]{%
0.9140625,0.76953125,0.4140625}w_{52}&\color[rgb]{%
0.9140625,0.76953125,0.4140625}w_{53}&\color[rgb]{%
0.9140625,0.76953125,0.4140625}w_{54}&\color[rgb]{0.1640625,0.6171875,0.5625}w%
_{55}\\
\color[rgb]{0.1640625,0.6171875,0.5625}w_{61}&\color[rgb]{%
0.1640625,0.6171875,0.5625}w_{62}&\color[rgb]{0.1640625,0.6171875,0.5625}w_{63%
}&\color[rgb]{0.1640625,0.6171875,0.5625}w_{64}&\color[rgb]{%
0.1640625,0.6171875,0.5625}w_{65}\end{bmatrix}\right.\end{matrix}
W\in\mathbb{R}^{6\times 5}
W\in\mathbb{R}^{6\times 5}
L
D
D_{\ell}
\ell\in[L]
D=\max_{\ell}D_{\ell}
S
S
1
N
\mathcal{D}
N_{B}
S
C
D
L
P
{\mathcal{O}}(P)={\mathcal{O}}(LD^{2}+DC)
C<D
C
D
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS)
{\mathcal{O}}(N_{B}PS{\color[rgb]{0.08984375,0.375,0.7890625}+NCP}
{\color[rgb]{0.08984375,0.375,0.7890625}+NCDLS+LD^{3}})
{\mathcal{O}}(NPS+NCP
+NCDLS+LD^{3})
{\mathcal{O}}(N_{B}SLD^{2}+P)
256
{\mathcal{O}}(N_{B}SLD+P)
{\mathcal{O}}(N_{B}SLD+P)
{\mathcal{O}}(N_{B}SD+P)
{\mathcal{O}}(N_{B}SLD+P)
{\mathcal{O}}(N_{B}SLD+P)
{\mathcal{O}}(N_{B}SD+P)
{\mathcal{O}}(N_{B}SLD+P)
{\mathcal{O}}(N_{B}SLD^{\color[rgb]{0.8671875,0.140625,0.1015625}2}+P)
{\mathcal{O}}(N_{B}S{\color[rgb]{0.8671875,0.140625,0.1015625}L}D^{\color[rgb]%
{0.8671875,0.140625,0.1015625}2}+P)
{\mathcal{O}}
250
200
20
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\times 1
\times 1
\times 1
\times 1
\times 1
\times 1
\times 2015.6
\times 18.2
\times 1.08
\times 1.17
\times 1.21
\times 1.08
\times 1.08
\times 1.09
\dagger
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\dagger
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\log C
C
C<2^{8}
25\%
32
\hat{\bm{w}}_{i}
0
0
\overset{\mathrm{fix}}{{}_{\mathrm{up}}}
\lambda>0
\lambda
\lambda
l_{\infty}
x
y-
x
y-
x
y-
x
y-
C
C
{\bm{w}}_{k}
[1,8]
8\times
x
y-
x
y-
x
y-
x
y-
\operatorname{Uniform}(0,\pi)
\operatorname{Uniform}(0,\frac{1}{2})
x-
y-
x-
y-
{\bm{w}}_{s}^{(k)}
({\bm{x}},y)\in\mathcal{D}_{1:k}
k
\mathcal{D}
C
[u_{1},\dots,u_{C}]
k\sim\text{Cat}(u_{1},\dots,u_{C})
\tilde{\mathcal{D}}
\mathcal{D}_{1:k}
\log p(\tilde{\mathcal{D}}|{\bm{w}}_{s}^{(k)},\psi)
{\bm{w}}_{s}^{(k)}
{\bm{w}}_{k}
{\bm{w}}_{k}
({\bm{x}},y)\in\mathcal{D}_{k}
k
\propto\sum_{i\leq k}u_{i}
{\bm{w}}_{k}
\mathcal{D}_{1:k}
{\bm{w}}_{k}
[u_{1},\dots,u_{C}]
{\bm{w}}_{k}
{\bm{w}}_{s}^{(k)},{\bm{w}}_{s}^{(k+1)},\dots,{\bm{w}}_{s}^{(C)}
\mathcal{L}_{\mathrm{ML}}
\psi
k\sim\text{Cat}(\frac{u_{2}}{Z},\dots,\frac{u_{C}}{Z})
\mathcal{D}_{1}
\tilde{\mathcal{D}}
\mathcal{D}_{k}
\mathcal{D}_{k}
\mathcal{D}_{1:k}
\log p(\tilde{\mathcal{D}}|{\bm{w}}_{s}^{(k-1)},\psi)
{\bm{w}}_{s}^{(k-1)}
\psi
\psi
\psi
{\bm{w}}_{k}
\psi)
{\bm{h}}
{\bm{s}}
{\bm{b}}
{\bm{o}}={\bm{h}}*{\bm{s}}+{\bm{b}}
\{{\bm{s}}_{1},\dots,{\bm{s}}_{C}\}
\{{\bm{b}}_{1},\dots,{\bm{b}}_{C}\}
{\bm{w}}^{(k)}_{s}
{\bm{s}}_{s}^{(k)}=\prod_{i\in\{1,\dots,k\}}s_{i}
{\bm{b}}_{s}^{(k)}=\sum_{i\in\{1,\dots,k\}}b_{i}
{\bm{w}}^{(k)}_{s}
[1,\dots,k-1]
k
\mathcal{D}_{k}
2
[256,256]
3
(16,32,64)
3
(16D,32D,64D)
2
D=1
8
20
(5,5)
2
(2,2)
2
50
2
(2,2)
2
500
50
10
0.001
256
10000
\mathcal{L}_{\mathrm{ML}}
0.0003
8
3
30000
0.001
4
0.001
200
20
0.001
0.01
0.05
3
[80\%,10\%,10\%]
0.1
100\times
0.9
250
0.001
[2400,8000,12000,20000,40000]
[1000,5000,10000,20000,50000]
1e-4
3
[80\%,10\%,10\%]
64x64
200
100000
[10000,50000,100000]
[80000,80000,40000]
120000
[80\%,20\%]
2
[80\%,10\%,10\%]
3
20000
80000
60000
0.01
0.01
0.001
70\%
3000
1000
12000
60000
\mathcal{D}_{k}
{\bm{w}}_{k}
\mathcal{D}_{1:k}
{\bm{w}}_{k}
\mathcal{D}_{k}
\mathcal{D}_{k}
{\bm{w}}_{k:C}
{\bm{w}}_{s}^{(k)}
{\bm{w}}_{s}^{(C)}
\mathcal{D}_{k}
{\bm{w}}_{k:C}
{\bm{w}}_{k}
{\bm{w}}_{s}^{(k+1)}
{\bm{w}}_{s}^{(C)}
k
C
t
D_{i,k}
i
k
k
{\bm{w}}_{j,i}^{t+1}
{\bm{w}}_{j}^{t}
i
D_{i,k}
\displaystyle{\bm{w}}_{j,i}^{t+1}=\operatorname*{arg\,max}_{{\bm{w}}_{j}}\log p%
\left(D_{i,k}|({\bm{w}}_{1}^{t},\dots,{\bm{w}}_{j}^{t},\hat{{\bm{w}}}_{j+1}^{t%
},\dots,\hat{{\bm{w}}}_{j+C}^{t}),\psi\right)\quad\forall j\in[k,C],
\displaystyle{\bm{w}}_{j,i}^{t+1}=\operatorname*{arg\,max}_{{\bm{w}}_{j}}\log p%
\left(D_{i,k}|({\bm{w}}_{1}^{t},\dots,{\bm{w}}_{j}^{t},\hat{{\bm{w}}}_{j+1}^{t%
},\dots,\hat{{\bm{w}}}_{j+C}^{t}),\psi\right)\quad\forall j\in[k,C],
{\bm{w}}_{.,i}^{t+1}=\text{concat}({\bm{w}}_{k,i}^{t+1},\dots,{\bm{w}}_{C,i}^{%
t+1})
({\bm{w}}_{1}^{t},\dots,{\bm{w}}_{k-1}^{t})
{\bm{w}}_{.,i}^{t+1}
t
i
\psi
\displaystyle\nabla_{\psi}\mathcal{L}_{\mathrm{ML}}\left(D_{i,k},\psi\right)%
\approx\nabla_{\psi}\log p\left(D_{i,k}|{\bm{w}}_{s,i}^{(t+1),(k-1)},\psi%
\right),
\displaystyle\nabla_{\psi}\mathcal{L}_{\mathrm{ML}}\left(D_{i,k},\psi\right)%
\approx\nabla_{\psi}\log p\left(D_{i,k}|{\bm{w}}_{s,i}^{(t+1),(k-1)},\psi%
\right),
D_{i,k}
i
k
{\bm{w}}_{s}^{(t+1),(k-1)}
(k-1)
{\bm{w}}_{s,i}^{(t+1),(k-1)}=\text{concat}({\bm{w}}_{1}^{t},\dots,{\bm{w}}_{k-%
1}^{t},{\bm{w}}_{k,i}^{t+1},\dots,{\bm{w}}_{C,i}^{t+1})
\psi
\psi
50k
45k
100
\alpha=1.0
\alpha=0.1
\alpha=0.1
10
\alpha=0.1
10k
5k
3
[0.7,0.2,0.1]
[0.9,0.1]
2
\psi
2k
5k
1.25k
5k
1.25k
10
5k
50
64
64
5e-2
1e-3
3e-3
10\%
10\%
30\%
32
5k
\mathcal{L}_{ML}
1e-2
1e-3
\epsilon=1e-7
10^{-0.5}
10
10
1.25k
5k
50k
1.25k
5k
50k
