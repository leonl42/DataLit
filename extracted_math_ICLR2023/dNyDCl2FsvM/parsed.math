{{100}\choose{5}}\times 5!
\mathcal{G}
\mathcal{M}
\mathcal{D}
\mathcal{G}
\mathcal{M}
\mathcal{G}
\mathcal{D}
\mathbb{D}
\mathcal{G}
\small\min_{\thetab_{\mathcal{G}},\thetab_{\mathcal{M}},\thetab_{\mathcal{D}}}%
\mathbb{E}_{\mathcal{T}\sim p(\mathcal{T}),(\xb,\yb)\sim\mathbb{D}}[J(\mathcal%
{L}_{\mathcal{T}}(\thetab_{\mathcal{M}},\thetab_{\mathcal{G}}),\mathcal{L}_{(%
\xb,\yb)}(\thetab_{\mathcal{D}},\thetab_{\mathcal{G}}))],
\thetab_{\mathcal{G}},\thetab_{\mathcal{M}}
\thetab_{\mathcal{D}}
\mathcal{T}
p(\mathcal{T})
(\xb,\yb)
\mathbb{D}
J
\mathcal{L}_{\mathcal{T}}(\thetab_{\mathcal{M}},\thetab_{\mathcal{G}})
\mathcal{L}_{(\xb,\yb)}(\thetab_{\mathcal{D}},\thetab_{\mathcal{G}})
p(\mathcal{T})
\mathbb{D}
\beta
\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\thetab_{\mathcal{M}}
\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\thetab_{\mathcal{M}}
B_{t}
B_{i}
\mathcal{L}_{B_{t}}(\thetab_{\mathcal{M}},\thetab_{\mathcal{G}})
\mathcal{L}_{B_{i}}(\thetab_{\mathcal{D}},\thetab_{\mathcal{G}})
(\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\thetab_{\mathcal{M}})\leftarrow(%
\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\thetab_{\mathcal{M}})
-\beta\nabla\Big{[}J(\mathcal{L}_{B_{t}}(\thetab_{\mathcal{M}},\thetab_{%
\mathcal{G}}),\mathcal{L}_{B_{i}}(\thetab_{\mathcal{D}},\thetab_{\mathcal{G}})%
)\Big{]};
\mathcal{M}\circ\mathcal{G}
p(\mathcal{T})
\mathcal{T}
\mathrm{train}(\mathcal{T})
\mathrm{test}(\mathcal{T})
\mathcal{D}\circ\mathcal{G}
\mathbb{D}
\mathcal{G}
\thetab_{\mathcal{G}}
\mathcal{D}
\thetab_{\mathcal{D}}
\mathcal{G}
\mathcal{M}
\thetab_{\mathcal{M}}
\mathcal{T}
\mathrm{train}(\mathcal{T})
\mathcal{T}
\mathrm{train}(\mathcal{T})
\mathcal{G}
\mathcal{D}
\mathcal{M}
\mathcal{D}\circ\mathcal{G}
\mathcal{L}_{(\xb,\yb)}(\thetab_{\mathcal{D}},\thetab_{\mathcal{G}})=\ell(%
\mathcal{D}\circ\mathcal{G}(\xb),\yb),
\ell
\mathcal{M}\circ\mathcal{G}
\mathcal{T}
\mathcal{M}
\mathcal{M}:\mathcal{T}\rightarrow f_{\mathcal{T}}
\mathcal{M}
f_{\mathcal{T}}
\mathcal{T}
\mathcal{L}_{\mathcal{T}}(\thetab_{\mathcal{M}},\thetab_{\mathcal{G}})=\frac{1%
}{|\mathrm{test}(\mathcal{T})|}\sum_{(\xb,\yb)\in\mathrm{test}(\mathcal{T})}%
\ell(f_{\mathcal{T}}\circ\mathcal{G}(\xb),\yb).
f_{\mathcal{T}}\circ\mathcal{G}(\xb)
f_{\mathcal{T}}\circ\mathcal{G}(\xb)=\sum_{(\xb^{\prime},\yb^{\prime})\in%
\mathrm{train}(\mathcal{T})}a(\mathcal{G}(\xb),\mathcal{G}(\xb^{\prime}))\yb^{%
\prime},
a(\mathcal{G}(\xb),\mathcal{G}(\xb^{\prime}))=\frac{\mathrm{e}^{c(g(\mathcal{G%
}(\xb)),g(\mathcal{G}(\xb^{\prime})))}}{\sum_{(\xb^{\prime},\yb^{\prime})\in%
\mathrm{train}(\mathcal{T})}\mathrm{e}^{c(g(\mathcal{G}(\xb)),g(\mathcal{G}(%
\xb^{\prime})))}}
c
g
\thetab_{\mathcal{M}}
f_{\mathcal{T}}\circ\mathcal{G}(\xb)=f_{\thetab_{\mathcal{M}}-\alpha\nabla_{%
\thetab_{\mathcal{M}}}\mathcal{L}_{\mathrm{train}(\mathcal{T})}(\thetab_{%
\mathcal{M}},\thetab_{\mathcal{G}})}(\mathcal{G}(\xb))
\small\mathcal{L}_{\mathrm{train}(\mathcal{T})}(\thetab_{\mathcal{M}},\thetab_%
{\mathcal{G}})=\frac{1}{|\mathrm{train}(\mathcal{T})|}\sum\limits_{(\xb,\yb)%
\in\mathrm{train}(\mathcal{T})}\ell(f_{\thetab_{\mathcal{M}}}(\mathcal{G}(\xb)%
),\yb),
\alpha
\mathcal{M}
\thetab_{\mathcal{M}}=\{\phib,\alphab\}
\mathcal{M}
\phib
\phib^{\prime}=\phib-\alphab\circ\nabla_{\phib}\mathcal{L}_{\mathrm{train}(%
\mathcal{T})}(\phib,\thetab_{\mathcal{G}}).
\mathrm{test}(\mathcal{T})
\mathcal{L}_{\mathrm{test}(\mathcal{T})}(\phib^{\prime},\thetab_{\mathcal{G}})%
=\frac{1}{|\mathrm{test}(\mathcal{T})|}\sum\limits_{(\xb,\yb)\in\mathrm{test}(%
\mathcal{T})}\ell(f_{\phib^{\prime}}(\mathcal{G}(\xb)),\yb).
\min_{\thetab_{\mathcal{G}},\thetab_{\mathcal{M}}=\{\phib,\alphab\},\thetab_{%
\mathcal{D}}}\mathbb{E}_{\mathcal{T}\sim p(\mathcal{T}),(\xb,\yb)\sim\mathbb{D%
}}[\mathcal{L}_{\mathrm{test}(\mathcal{T})}(\phib^{\prime},\thetab_{\mathcal{G%
}})\\
+\lambda~{}\ell(\mathcal{D}(\mathcal{G}(\xb)),\yb)],
\phib^{\prime}=\phib-\alphab\circ\nabla_{\phib}\mathcal{L}_{\mathrm{train}(%
\mathcal{T})}(\phib,\thetab_{\mathcal{G}})
\lambda
p(\mathcal{T})
\mathbb{D}
n
m
\beta
\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\thetab_{\mathcal{M}}=\{\phib,\alphab\}
\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\phib,\alphab
n
\mathcal{T}_{i}\sim p(\mathcal{T})
m
(\xb_{j},\yb_{j})\sim\mathbb{D}
\mathcal{T}_{i}
\mathcal{L}_{\mathrm{train}(\mathcal{T}_{i})}(\phib,\thetab_{\mathcal{G}})%
\leftarrow\frac{1}{|\mathrm{train}(\mathcal{T}_{i})|}\sum\limits_{(\xb,\yb)\in%
\mathrm{train}(\mathcal{T}_{i})}\ell(f_{\phib}(\mathcal{G}(\xb)),\yb)
\phib^{\prime}_{i}\leftarrow\phib-\alphab\circ\nabla_{\phib}\mathcal{L}_{%
\mathrm{train}(\mathcal{T}_{i})}(\phib,\thetab_{\mathcal{G}})
\mathcal{L}_{\mathrm{test}(\mathcal{T}_{i})}(\phib_{i}^{\prime},\thetab_{%
\mathcal{G}})\leftarrow\frac{1}{|\mathrm{test}(\mathcal{T}_{i})|}\sum\limits_{%
(\xb,\yb)\in\mathrm{test}(\mathcal{T}_{i})}\ell(f_{\phib_{i}^{\prime}}(%
\mathcal{G}(\xb)),\yb)
(\thetab_{\mathcal{G}},\thetab_{\mathcal{D}},\phib,\alphab)\leftarrow(\thetab_%
{\mathcal{G}},\thetab_{\mathcal{D}},\phib,\alphab)-\beta\nabla\Big{[}\frac{1}{%
n}\sum\limits_{i=1}^{n}\mathcal{L}_{\mathrm{test}(\mathcal{T}_{i})}(\phib_{i}^%
{\prime},\thetab_{\mathcal{G}})
+\lambda~{}\frac{1}{m}\sum\limits_{j=1}^{m}\ell(\mathcal{D}(\mathcal{G}(\xb_{j%
})),\yb_{j})\Big{]}
90\%
32\times 32
32\times 32
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathcal{D}\circ\mathcal{G}
\mathcal{M}\circ\mathcal{G}
K\in\{1,5\}
\lambda
K\in\{1,5\}
95\%
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathcal{D}\circ\mathcal{G}
\mathcal{G}
\mathcal{G}
\mathcal{G}
\lambda
\lambda
\lambda
\lambda
\lambda
