\,\,{}^{,1}
\mathbf{y}=\{y_{1},\ldots,y_{T}\}
\mathbf{x}=\{x_{1},\ldots,x_{T^{\prime}}\}
P_{\theta}(\mathbf{y}|\mathbf{x})
\theta
\mathbf{x}
\mathbf{y}
\mathbf{z}
\mathbf{x}
\mathbf{y}
\mathbf{z}
P_{\theta}(\mathbf{y}|\mathbf{x})
P_{\theta}(\mathbf{y}|\mathbf{x})=\prod\limits_{t=1}^{T}P_{\theta}(y_{t}|y_{<t%
},\mathbf{x}).
P_{\theta}(y_{t}|y_{<t},\mathbf{x})
\mathbf{y}
y_{t}
P_{\theta}(\mathbf{y}|\mathbf{x})
P_{\theta}(\mathbf{y}|\mathbf{x})=\prod\limits_{t=1}^{T}P_{\theta}(y_{t}|%
\mathbf{x}).\vspace{-1mm}
\mathbf{z}
P_{\theta}(\mathbf{y}|\mathbf{x})=\int_{\mathbf{z}}P_{\theta}(\mathbf{y}|%
\mathbf{z},\mathbf{x})p_{\theta}(\mathbf{z}|\mathbf{x})d\mathbf{z},\vspace{-2mm}
p_{\theta}(\mathbf{z}|\mathbf{x})
\mathbf{z}
P_{\theta}(\mathbf{y}|\mathbf{z},\mathbf{x})
P_{\theta}(\mathbf{y}|\mathbf{z},\mathbf{x})=\prod\limits_{t=1}^{T}P_{\theta}(%
y_{t}|\mathbf{z},\mathbf{x}).\vspace{-2mm}
\mathbf{z}
p_{\theta}(\mathbf{z}|\mathbf{x})
\mathbf{z}
\mathbf{z}
p_{\theta}(\mathbf{z}|\mathbf{x})
\mathbf{z}
\bm{\upsilon}\in\Upsilon
p_{\Upsilon}(\upsilon)
f:\mathcal{Z}\rightarrow\Upsilon
g=f^{-1}
\mathbf{z}
\begin{array}[]{rcl}\bm{\upsilon}&\sim&p_{\Upsilon}(\bm{\upsilon})\\
\mathbf{z}&=&g_{\theta}(\bm{\upsilon}).\end{array}\vspace{-2mm}
\mathbf{z}\in\mathcal{Z}
p_{\theta}(\mathbf{z})=p_{\Upsilon}(f_{\theta}(\mathbf{z}))\left|\det(\frac{%
\partial f_{\theta}(\mathbf{z})}{\partial\mathbf{z}})\right|.\vspace{-2mm}
\frac{\partial f_{\theta}(\mathbf{z})}{\partial\mathbf{z}}
f_{\theta}
\mathbf{z}
\mathbf{z}
\upsilon
\mathbf{z}
\upsilon
f_{\theta}
g_{\theta}
\mathbf{z}\underset{g_{1}}{\overset{f_{1}}{\longleftrightarrow}}H_{1}\underset%
{g_{2}}{\overset{f_{2}}{\longleftrightarrow}}H2\underset{g_{3}}{\overset{f_{3}%
}{\longleftrightarrow}}\cdots\underset{g_{K}}{\overset{f_{K}}{%
\longleftrightarrow}}\bm{\upsilon},
f=f_{1}\circ f_{2}\circ\cdots\circ f_{K}
K
\theta
\min\limits_{\theta\in\Theta}\frac{1}{N}\sum\limits_{i=1}^{N}-\log P_{\theta}(%
\mathbf{y}^{i}|\mathbf{x}^{i}),
D=\{(\mathbf{x}^{i},\mathbf{y}^{i})\}_{i=1}^{N}
P_{\theta}(\mathbf{y}|\mathbf{x})
\mathbf{z}
q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})
\mathbf{z}
\log P_{\theta}(\mathbf{y}|\mathbf{z},\mathbf{x})
\displaystyle\log P_{\theta}(\mathbf{y}|\mathbf{x})\geq\mathrm{E}_{q_{\phi}(%
\mathbf{z}|\mathbf{y},\mathbf{x})}[\log P_{\theta}(\mathbf{y}|\mathbf{z},%
\mathbf{x})]
\displaystyle\log P_{\theta}(\mathbf{y}|\mathbf{x})
\displaystyle\geq\mathrm{E}_{q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})}[\log P%
_{\theta}(\mathbf{y}|\mathbf{z},\mathbf{x})]
\displaystyle-\mathrm{KL}(q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})||p_{%
\theta}(\mathbf{z}|\mathbf{x})).
\displaystyle-\mathrm{KL}(q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})||p_{%
\theta}(\mathbf{z}|\mathbf{x})).
\phi
\theta
\mathbf{x}
\mathbf{z}
q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})
\mathbf{z}
P_{\theta}(\mathbf{y}|\mathbf{z},\mathbf{x})
p_{\theta}(\mathbf{z}|\mathbf{x})
\mathbf{z}
\mathbf{z}
\mathbf{y}
P_{\theta}(\mathbf{y}|\mathbf{z},\mathbf{x})
\mathbf{z}
\mathbf{z}=\{\mathbf{z}_{1},\ldots,\mathbf{z}_{T}\}
\mathbf{y}
\mathbf{z}_{t}
d_{\mathrm{z}}
d_{\mathrm{z}}
q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})
\mathbf{z}_{t}
q_{\phi}(\mathbf{z}|\mathbf{y},\mathbf{x})=\prod\limits_{t=1}^{T}\mathcal{N}(%
\mathbf{z}_{t}|\mu_{t}(\mathbf{x},\mathbf{y}),\sigma_{t}^{2}(\mathbf{x},%
\mathbf{y}))
\mu_{t}(\cdot)
\sigma_{t}(\cdot)
\mu
\log\sigma^{2}
\mathbf{z}
\mathbf{z}
\mathbf{y}
\mathbf{z}_{t}
y_{t}
t
\mathbf{z}_{t}
\mathbf{z}
\mathbf{y}
\mathbf{z}_{a}
zv_{b}
\mathbf{z}_{a}
zv_{b}
\mathbf{z}_{t}^{\prime}=\mathbf{s}\odot\mathbf{z}_{t}+\mathbf{b}.
\mathbf{z}
\mathbf{z}^{\prime}
[T\times d_{\mathrm{z}}]
t
d_{\mathrm{z}}
\mathbf{z}_{t}^{\prime}
1\times 1
\mathbf{z}_{t}^{\prime}=\mathbf{z}_{t}\mathbf{W},
\mathbf{W}
[d_{\mathrm{z}}\times d_{\mathrm{z}}]
\log\left|\mathrm{det}\left(\frac{\partial\mathrm{linear}(\mathbf{z};\mathbf{W%
})}{\partial\mathbf{z}}\right)\right|=T\cdot\log|\mathrm{det}(\mathbf{W})|
\mathrm{det}(\mathbf{W})
O(d_{\mathrm{z}}^{3})
d_{\mathrm{z}}
512
\mathrm{det}(\mathbf{W})
d_{\mathrm{z}}
h
d_{h}=d_{\mathrm{z}}/h
d_{h}\times d_{h}
\mathbf{W}
\begin{array}[]{rcl}\mathbf{z}_{a},\mathbf{z}_{b}&=&\mathrm{split}(\mathbf{z})%
\\
\mathbf{z}_{a}^{\prime}&=&\mathbf{z}_{a}\\
\mathbf{z}_{b}^{\prime}&=&\mathrm{s}(\mathbf{z}_{a},\mathbf{x})\odot\mathbf{z}%
_{b}+\mathrm{b}(\mathbf{z}_{a},\mathbf{x})\\
\mathbf{z}^{\prime}&=&\mathrm{concat}(\mathbf{z}_{a}^{\prime},\mathbf{z}_{b}^{%
\prime}),\end{array}
\mathrm{s}(\mathbf{z}_{a},\mathbf{x})
\mathrm{b}(\mathbf{z}_{a},\mathbf{x})
\mathbf{z}_{a}
\mathbf{x}
\mathrm{s}(\cdot)
\mathrm{b}(\cdot)
\mathbf{z}_{a}
\mathbf{x}
\mathbf{z}_{a}
\mathrm{split}()
\mathbf{z}
\mathrm{concat}
\mathbf{z}
\mathbf{z}_{a}
\mathbf{z}_{b}
[T\times\frac{d}{2}]
T\times\frac{d}{2}
\frac{T}{2}\times d
T
2
\mathbf{z}
[-20,20]
\mathbf{z}
\begin{array}[]{rcl}\mathbf{z}^{*}&=&\operatornamewithlimits{argmax}\limits_{%
\mathbf{z}\in\mathcal{Z}}p_{\theta}(\mathbf{z}|\mathbf{x})\\
\mathbf{y}^{*}&=&\operatornamewithlimits{argmax}\limits_{\mathbf{y}}P_{\theta}%
(\mathbf{y}|\mathbf{z}^{*},\mathbf{x})\end{array}\vspace{-2mm}
\mathbf{y}^{*}
l
r
l\times r
K
\begin{array}[]{rcl}\mathbf{z}_{i}&\sim&p_{\theta}(\mathbf{z}|\mathbf{x}),%
\forall i=1,\ldots,N\\
\hat{\mathbf{y}}_{i}&=&\operatornamewithlimits{argmax}\limits_{\mathbf{y}}P_{%
\theta}(\mathbf{y}|\mathbf{z}_{i},\mathbf{x})\\
\mathbf{z}_{i}^{(k)}&\sim&q_{\phi}(\mathbf{z}|\hat{\mathbf{y}}_{i},\mathbf{x})%
,\forall k=1,\ldots,K\\
P(\hat{\mathbf{y}}_{i}|\mathbf{x})&\approx&\frac{1}{K}\sum\limits_{k=1}^{K}%
\frac{P_{\theta}(\hat{\mathbf{y}}_{i}|\mathbf{z}_{i}^{(k)},\mathbf{x})p_{%
\theta}(\mathbf{z}_{i}^{(k)}|\mathbf{x})}{q_{\phi}(\mathbf{z}_{i}^{(k)}|\hat{%
\mathbf{y}}_{i},\mathbf{x})}\end{array}
80
60
n=15
n=15
n=30
n=15
n=15
n=30
n=10
n=9
n=15
n=15
n=30
n=15
n=15
n=30
n=l\times r
n=l\times r
[48,48,16]
d_{model}/d_{hidden}=256/512
d_{model}/d_{hidden}=512/1024
\beta=(0.9,0.999)
\epsilon=1e^{-8}
2048
5e-4
0.999995
1.0
0.1
\mathrm{KL}
\mathrm{KL}
9
3
\{0.1,0.2,0.3,0.4,0.5,1.0\}
10
\{1,4,8,32,64,128\}
l
r
l
r
r
\mathbf{z}_{t}^{\prime}=\mathbf{s}\odot\mathbf{z}_{t}+\mathbf{b}.
T\cdot\mathrm{sum}(\log|\mathbf{s}|)
\mathbf{z}_{t}^{\prime}=\mathbf{z}_{t}\mathbf{W},
T\cdot h\cdot\log|\mathrm{det}(\mathbf{W})|
h
\begin{array}[]{rcl}\mathbf{z}_{a},\mathbf{z}_{b}&=&\mathrm{split}(\mathbf{z})%
\\
\mathbf{z}_{a}^{\prime}&=&\mathbf{z}_{a}\\
\mathbf{z}_{b}^{\prime}&=&\mathrm{s}(\mathbf{z}_{a},\mathbf{x})\odot\mathbf{z}%
_{b}+\mathrm{b}(\mathbf{z}_{a},\mathbf{x})\\
\mathbf{z}^{\prime}&=&\mathrm{concat}(\mathbf{z}_{a}^{\prime},\mathbf{z}_{b}^{%
\prime}),\end{array}
\mathrm{sum}(\log|\mathbf{s}|)
\mathbf{z}
l=3,r=10,\tau=0.4
l=3,r=10,\tau=0.4
l
\tau
r
\tau
