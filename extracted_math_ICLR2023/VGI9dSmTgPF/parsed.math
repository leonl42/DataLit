k
X
X
16\times 16
X\in\mathbb{R}^{(n+\zeta)\times d}
n
\zeta
d
\mathrm{MHSA}(X)=\sum_{h=1}^{H}\tilde{\Psi}_{h}XW_{h}
\tilde{\Psi}_{h}\in\mathbb{R}^{(n+\zeta)\times(n+\zeta)}
h\in\{1,\ldots,H\}
W_{h}\in\mathbb{R}^{d\times d}
\bar{\Psi}
\Psi
\Psi=(\bar{\Psi}+{\bar{\Psi}}^{\top})/2
\Psi
\Psi=\begin{bmatrix}\Psi^{*}&\Psi^{A}\\
{\Psi^{A}}^{\top}&\Psi^{V}\end{bmatrix}\text{,}
\Psi^{A}\in\mathbb{R}^{\zeta\times n}
\Psi^{V}\in\mathbb{R}^{n\times n}
\Psi^{*}\in\mathbb{R}^{\zeta\times\zeta}
\psi^{\text{CLS}}\in\mathbb{R}^{n}
\Psi^{A}
X
G
X
G=(E,V)
V
E
\lambda\in\mathbb{R}_{+}
\varLambda\in\mathbb{R}_{+}^{|V|}=\{\lambda_{i}\}_{i=1}^{|V|}
i
j
e_{i,j}\in\mathbb{R}_{+}
E\in\mathbb{R}_{+}^{|V|\times|V|}
\hat{\mathcal{G}}
C
\hat{G}_{c}=(\hat{E}_{c},\hat{V}_{c})
c
\hat{\varLambda}_{c}
\hat{E}_{c}
\Omega=\{\omega_{i}\}_{i=1}^{M}
\omega_{i}\in\mathbb{R}^{d}
M
k
\mathbb{X}
D
\mathbb{X}
n\times D
X
x
\mathrm{Ingredient}(x)=\mathop{\arg\min}_{i\in\{1,\ldots,M\}}\|x-\omega_{i}\|_%
{2}\text{.}
\omega
\mathbb{M}=\{1,\ldots,M\}
\tilde{X}=(\tilde{x}_{1},\ldots,\tilde{x}_{n})
\tilde{x}_{i}\in\mathbb{M}
M
\tilde{X}
V=\mathrm{Unique}(\tilde{X})
v\in\mathbb{M}
\lambda_{v}=\alpha_{1}\lambda_{v}^{\text{CLS}}+\alpha_{2}\lambda_{v}^{\text{%
bag}}=\alpha_{1}\sum_{i\in\varXi(v|\tilde{X})}\psi^{\text{CLS}}_{i}+\alpha_{2}%
|\varXi(v|\tilde{X})|\text{,}
\varXi(v|\tilde{X})
v
\tilde{X}
\psi^{\text{CLS}}_{i}
i
\alpha_{1,2}\geq 0
\alpha_{1}=0
\varLambda
\Psi^{V}
u,v\in V
\varPi[(u,v)|\tilde{X}]
e^{\text{attn}}_{u,v}=\frac{1}{|\varPi[(u,v)|\tilde{X}]|}\sum_{(i,j)\in\varPi[%
(u,v)|\tilde{X}]}\Psi^{V}_{i,j}\text{,}
\varPi[(u,v)|\tilde{X}]
\varXi(u|\tilde{X})
\varXi(v|\tilde{X})
\Psi^{C}_{i,j}
i
j
e^{\text{adj}}_{u,v}=\frac{1}{|\varPi[(u,v)|\tilde{X}]|}\sum_{(i,j)\in\varPi[(%
u,v)|\tilde{X}]}\frac{1}{\epsilon+\|\mathrm{Pos}(i)-\mathrm{Pos}(j)\|_{2}}%
\text{,}
\mathrm{Pos}(\cdot)
u
v
\beta_{1,2}
e_{u,v}=\beta_{1}e^{\text{attn}}_{u,v}+\beta_{2}e^{\text{adj}}_{u,v}\text{.}
u
v
m\in\mathbb{M}
d_{G}
\mathcal{N}(\bm{0},I_{d_{G}})
F\in\mathbb{R}^{|V|\times d_{G}}
\mathrm{GraphConv}(F)=\mathrm{Norm}\left(\sigma\left((I_{d_{G}}+E)FW\right)%
\right)\text{,}
\sigma
\mathrm{Norm}
W\in\mathbb{R}^{d_{G}\times d_{G}}
L_{\text{G}}
F^{(L_{G})}
\varLambda
z=\varLambda F^{(L_{G})}
z
G
\hat{Z}\in\mathbb{R}^{C\times d_{G}}=(\hat{z}_{1},\ldots,\hat{z}_{C})
\hat{\mathcal{G}}
y=\hat{Z}z^{\top}
G
\hat{G}
s=\hat{z}z^{\top}
z=\varLambda F^{(L_{G})}
\hat{z}=\hat{\varLambda}\hat{F}^{(L_{G})}
f_{v}^{(l)}
v
l
\lambda_{v}^{(l)}
v
f_{v}^{(0)}
\Phi=V\cap\hat{V}
G
\hat{G}
s
s=\sum_{(u,v)\in\hat{V}\times V}\hat{\lambda}_{u}\lambda_{v}\hat{f}_{u}^{(L_{G%
})}{f_{v}^{(L_{G})}}^{\top}\text{.}
s=\sum_{\phi\in\Phi}\hat{\lambda}_{\phi}\lambda_{\phi}\hat{f}_{\phi}^{(L_{G})}%
{f_{\phi}^{(L_{G})}}^{\top}\text{.}
L_{G}=0
\alpha_{1}=0
\phi
\Phi
\phi
\mathcal{L}_{CE}
\mathcal{L}_{v}=\frac{1}{C}\sum_{c=1}^{C}\mathcal{H}(\hat{\varLambda}_{c}),%
\quad\mathcal{L}_{e}=\frac{1}{C|\hat{V}|}\sum_{c=1}^{C}\sum_{u\in\hat{V}}%
\mathcal{H}(\hat{E}_{c,u})\text{,}
\mathcal{H}(x)
x\in\mathbb{R}_{+}^{k}
k
\hat{E}_{c,u}
u
\hat{G}_{c}
c
\mathcal{L}=\mathcal{L}_{CE}+\gamma_{v}\mathcal{L}_{v}+\gamma_{e}\mathcal{L}_{%
e}\text{,}
\gamma_{v}
\gamma_{e}
\mathcal{O}(C|V|^{2})
\delta_{t}=0.01
\lambda_{v,e}
\lambda_{v}=0.5
\lambda_{e}=0.75
\alpha_{1,2}
\beta_{1,2}
0.5
\phi^{\text{CLS}}
+
-
+
-
\mathcal{O}(C)
s=\sum_{\phi\in\Phi}\hat{\lambda}_{\phi}\lambda_{\phi}\hat{f}_{\phi}^{(L_{G})}%
{f_{\phi}^{(L_{G})}}^{\top}\text{.}
L_{G}=0
\alpha_{1}=0
f
g\in\mathbb{R}^{d_{G}}
\mathcal{N}(\bm{0},I)
\displaystyle\mathbb{E}_{f,g}\left[fW^{\top}Wg^{\top}\right]=0
\displaystyle\mathbb{E}_{f,g}\left[fW^{\top}Wg^{\top}\right]
\displaystyle=0
\displaystyle\mathbb{E}_{f}\left[fW^{\top}Wf^{\top}\right]=\|W\|_{F}^{2}\text{,}
\displaystyle\mathbb{E}_{f}\left[fW^{\top}Wf^{\top}\right]
\displaystyle=\|W\|_{F}^{2}\text{,}
\|\cdot\|_{F}
W\in\mathbb{R}^{d_{G}\times d_{G}}
fW^{\top}Wg^{\top}
fW^{\top}Wg^{\top}=\sum_{r=1}^{d_{G}}\sum_{s=1}^{d_{G}}\sum_{t=1}^{d_{G}}f_{s}%
g_{t}w_{r,s}w_{r,t}\text{.}
\mathbb{E}_{f,g}\left[fW^{\top}Wg^{\top}\right]=\sum_{r=1}^{d_{G}}\sum_{s=1}^{%
d_{G}}\sum_{t=1}^{d_{G}}w_{r,s}w_{r,t}\mathbb{E}_{f_{s}}\left[f_{s}\right]%
\mathbb{E}_{g_{t}}\left[g_{t}\right]=0\text{,}
\displaystyle\mathbb{E}_{f}\left[fW^{\top}Wf^{\top}\right]=\sum_{r=1}^{d_{G}}%
\mathbb{E}_{f}\left[\sum_{s=1}^{d_{G}}\sum_{t=1}^{d_{G}}w_{r,s}w_{r,t}f_{s}f_{%
t}\right]
\displaystyle\mathbb{E}_{f}\left[fW^{\top}Wf^{\top}\right]
\displaystyle=\sum_{r=1}^{d_{G}}\mathbb{E}_{f}\left[\sum_{s=1}^{d_{G}}\sum_{t=%
1}^{d_{G}}w_{r,s}w_{r,t}f_{s}f_{t}\right]
\displaystyle=\sum_{r=1}^{d_{G}}\mathbb{E}_{f}\left[\sum_{s=1}^{d_{G}}w_{r,s}^%
{2}f_{s}^{2}\right]
\displaystyle=\sum_{r=1}^{d_{G}}\mathbb{E}_{f}\left[\sum_{s=1}^{d_{G}}w_{r,s}^%
{2}f_{s}^{2}\right]
\displaystyle=\sum_{r=1}^{d_{G}}\sum_{s=1}^{d_{G}}w_{r,s}^{2}=\|W\|_{F}^{2}%
\text{.}
\displaystyle=\sum_{r=1}^{d_{G}}\sum_{s=1}^{d_{G}}w_{r,s}^{2}=\|W\|_{F}^{2}%
\text{.}
W
\mathbb{E}_{f}\left[fW^{\top}Wf^{\top}\right]=d_{G}\text{.}
W
\mathcal{N}(0,1)
f
\mathbb{E}_{f,W}\left[fW^{\top}Wf^{\top}\right]=d_{G}^{2}\text{.}
G
\hat{G}
s=\sum_{(u,v)\in\hat{V}\times V}\hat{\lambda_{u}}\lambda_{v}\hat{f}_{u}^{(0)}{%
f_{v}^{(0)}}^{\top}=\sum_{(u,v)\in\hat{V}\times V}\hat{\lambda_{u}}\lambda_{v}%
f_{u}^{(0)}{f_{v}^{(0)}}^{\top}\text{.}
v
u
v
u
\mathbb{E}\left[ff^{\top}\right]=d_{G}
\hat{\lambda_{u}}\lambda_{v}f_{u}^{(0)}{f_{v}^{(0)}}^{\top}
u\neq v
G
\hat{G}
f_{u}^{(0)}{f_{v}^{(0)}}^{\top}
L_{G}=0
s=\sum_{\phi\in\Phi}\hat{\lambda}_{\phi}\lambda_{\phi}\|f_{\phi}^{(0)}\|_{2}^{%
2}\text{,}
\Phi=V\cap\hat{V}
G
\hat{G}
\alpha_{1}=0
\lambda_{\phi}
\phi
\hat{\lambda}_{\phi}\|f_{\phi}^{(0)}\|_{2}^{2}
w_{\phi}
y=\varLambda W_{\text{FC}}\text{,}
W_{\text{FC}}\in\mathbb{R}^{|V|\times C}
u\in\hat{V}
v\in V
s_{u,v}=\hat{\lambda}_{u}\lambda_{v}\hat{f}_{u}^{(L_{G})}{f_{v}^{(L_{G})}}^{\top}
(L_{G}-1)
s_{u,v}=\hat{\lambda}_{u}\lambda_{v}\sum_{(i,j)\in\dot{\mathcal{N}}_{\hat{G}}(%
u)\times\dot{\mathcal{N}}_{G}(v)}\hat{e}_{u,i}e_{v,j}\hat{f}_{i}^{(L_{G}-1)}W^%
{(L_{G})}{W^{(L_{G})}}^{\top}{f_{j}^{(L_{G}-1)}}^{\top}\text{,}
\dot{\mathcal{N}}_{\hat{G}}(u)
u
\hat{G}
u
e_{u,u}=1
\hat{f}_{i}^{(L_{G}-1)}
f_{j}^{(L_{G}-1)}
x\in\mathbb{R}^{d}
\hat{f}_{i}^{(L_{G}-1)}W^{(L_{G})}{W^{(L_{G})}}^{\top}{f_{j}^{(L_{G}-1)}}^{\top}
i=j
\hat{f}_{u}^{(L_{G})}{f_{v}^{(L_{G})}}^{\top}
u=v
s_{u,v}
\dot{\mathcal{N}}_{\hat{G}}(u)
\dot{\mathcal{N}}_{G}(v)
\hat{e}_{u,i}e_{v,j}
\hat{\lambda}_{u}\lambda_{v}
u
v
u
v
\Phi=\hat{V}\cap V
G
\hat{G}
\mathcal{D}=\{(x_{i},y_{i})\}_{i=1}^{D}
D
\hat{\mathcal{G}}=\{\hat{G}_{c}\}_{c=1}^{C}
\mathrm{Backbone}(\cdot)
\mathrm{Matcher}(\cdot,\cdot)
\Omega
\Theta
\delta_{t}
\mathcal{D}
\Omega
\tilde{\mathcal{D}}\subset\mathcal{D}
S_{1},\ldots,S_{C}\leftarrow\varnothing
\hat{\mathcal{G}}\leftarrow\varnothing
(x,y)\in\tilde{\mathcal{D}}
G\leftarrow
\mathrm{Backbone}(x)
\Omega
S_{y}\leftarrow S_{y}\cup{G}
c=1,\ldots,C
\hat{\mathcal{G}}\leftarrow
S_{c}
\hat{\mathcal{G}}
\hat{\mathcal{G}}
\mathcal{D}
\Omega
(x,y)\in\mathcal{D}
\hat{e}_{i,j}\in\hat{E}
\hat{\lambda}_{i}<\delta_{t}
\hat{\lambda}_{j}<\delta_{t}
\hat{e}_{i,j}\leftarrow
G\leftarrow
\mathrm{Backbone}(x)
\Omega
\hat{y}\leftarrow\mathrm{Matcher}(G,\hat{\mathcal{G}})
\nabla_{\Theta}
\Theta
\Theta
\hat{\mathcal{G}}\leftarrow
\mathcal{D}
\Omega
\hat{\mathcal{G}}
\mathcal{D}
\Omega
64
224\times 224
96\times 96
64
224\times 224
96\times 96
X\in\mathbb{R}^{n\times d}
N
x_{*}
X
\varepsilon\in\mathbb{R}^{d}
\mathcal{N}(0,I)
y
x_{*}
x_{*}
y
\hat{y}=y+\epsilon
x_{*}
\delta_{r}>0
224\times 224
25
50\times 50
M
M
10\times C
M
G
\hat{G}
\varLambda
\varLambda
\varLambda_{\text{norm}}=\frac{\varLambda}{\sum_{i=1}^{|V|}\lambda_{i}}\text{.}
E
E_{\text{norm}}=\begin{bmatrix}\frac{E_{1,:}}{\sum_{i=1}^{|V|}e_{1,i}}\\
\vdots\\
\frac{E_{|V|,:}}{\sum_{i=1}^{|V|}e_{|V|,i}}\\
\end{bmatrix}\text{.}
E_{\text{sym}}
E_{\text{sym}}=\frac{1}{2}(E_{\text{norm}}+E_{\text{norm}}^{\top})
\mathrm{Norm}(\cdot)
d_{G}
10^{-3}
5\times 10^{-4}
64
224\times 224
C
M
M
L_{G}
L_{G}
M=256
M=2048
L_{G}
\alpha_{1,2}
\beta_{1,2}
\alpha_{1,2}
\beta_{1,2}
\alpha_{1,2}
\beta_{1,2}
\alpha_{1}=0
\alpha_{2}=1
\alpha_{1}=1
\alpha_{2}=0
\beta_{1}=0
\beta_{2}=1
\beta_{1}=1
\beta_{2}=0
\alpha_{1,2}=\beta_{1,2}=0.5
\lambda^{\text{CLS}}
\lambda^{\text{bag}}
e^{\text{attn}}
e^{\text{adj}}
\alpha_{1,2}
\beta_{1,2}
\lambda^{\text{bag}}
\alpha_{2}
\lambda_{v}^{\text{CLS}}
\delta_{t}
\delta_{t}
\delta_{t}
\delta_{t}
\delta_{t}
\lambda_{v}
\lambda_{e}
\lambda_{v}
\lambda_{e}
k
50\times 50
