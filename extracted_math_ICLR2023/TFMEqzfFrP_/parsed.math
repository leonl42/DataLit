\times
\boldsymbol{x}_{0}
T
\boldsymbol{x}_{0},...,\boldsymbol{x}_{t},...,\boldsymbol{x}_{T}
\mu(\cdot)
\hat{\boldsymbol{x}}_{t-1}=\mu(\boldsymbol{x}_{t},t)
\hat{\boldsymbol{x}}_{t-1}=\mu(\hat{\boldsymbol{x}}_{t},t)
T
T
\mu(\cdot)
T
\mu(\cdot)
(\boldsymbol{x}_{t},\boldsymbol{x}_{t-1})
\boldsymbol{x}_{t}
\boldsymbol{x}_{t-1}
\mu(\boldsymbol{x}_{t},t)
\mu(\cdot)
\boldsymbol{x}_{t}
\hat{\boldsymbol{x}}_{t}
\mu(\hat{\boldsymbol{x}}_{t},t)
\mu(\boldsymbol{x}_{t},t)
\mu(\hat{\boldsymbol{x}}_{t},t)
T
T^{\prime}<T
\boldsymbol{x}_{t}
\mu(\cdot)
\boldsymbol{x}_{t}
\boldsymbol{x}_{1}
\boldsymbol{x}_{2}
\mu(\boldsymbol{x}_{1},t)
\mu(\boldsymbol{x}_{2},t)
\mu(\cdot)
\mu(\cdot)
\mu(\cdot)
\times
\times
\times
12.5\times
\cdot
T
\boldsymbol{x}_{0},...,\boldsymbol{x}_{T}
\mu(\cdot)
t
\mu(\cdot)
[-1,1]
\boldsymbol{x}_{0}
q(\boldsymbol{x}_{0})
\beta_{1},...,\beta_{T}
\boldsymbol{x}_{0}\sim q(\boldsymbol{x}_{0})
T
q(\boldsymbol{x}_{t}|\boldsymbol{x}_{t-1})={\cal N}(\boldsymbol{x}_{t};\sqrt{1%
-\beta_{t}}\boldsymbol{x}_{t-1},\beta_{t}\boldsymbol{I}),
q(\boldsymbol{x}_{1:T}|\boldsymbol{x}_{0})=\prod_{t=1}^{T}q(\boldsymbol{x}_{t}%
|\boldsymbol{x}_{t-1}),
\boldsymbol{x}_{T}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{\theta}
p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x}_{t})={\cal N}(%
\boldsymbol{x}_{t-1};\mu_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t),\sigma_{t%
}\boldsymbol{I}),
\sigma_{t}=\frac{1-\bar{\alpha}_{t-1}}{1-\bar{\alpha}_{t}}\beta_{t}
\bar{\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i}
\alpha_{i}=1-\beta_{i}
\boldsymbol{x}_{0}
\boldsymbol{x}_{t}
\boldsymbol{x}_{t}=\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0}+\sqrt{1-\bar{%
\alpha}_{t}}\boldsymbol{\epsilon},
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\hat{\boldsymbol{x}}_{t-1}=\mu_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
L_{2}
L(\boldsymbol{\theta})=\mathbb{E}_{\boldsymbol{x}_{0}\sim q(\boldsymbol{x}_{0}%
),\boldsymbol{\epsilon}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I}),t\sim%
\mathbb{U}(\{1,...,T\})}[||\boldsymbol{\epsilon}-\boldsymbol{\epsilon}_{%
\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)||^{2}].
\boldsymbol{x}_{t}
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)
\boldsymbol{x}_{0}\sim q(\boldsymbol{x}_{0})
t\sim\mathbb{U}(\{1,...,T\})
\boldsymbol{\epsilon}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{x}_{t}
\text{take a gradient descent step on}\>\nabla_{\boldsymbol{\theta}}||%
\boldsymbol{\epsilon}-\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{%
x}_{t},t)||^{2}
\hat{\boldsymbol{x}}_{T}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
t:=T,...,1
t>1
\boldsymbol{z}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{z}=\boldsymbol{0}
\hat{\boldsymbol{x}}_{t-1}=\frac{1}{\sqrt{\alpha_{t}}}(\hat{\boldsymbol{x}}_{t%
}-\frac{1-\alpha_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\boldsymbol{\epsilon}_{%
\boldsymbol{\theta}}(\hat{\boldsymbol{x}}_{t},t))+\sigma_{t}\boldsymbol{z}
\hat{\boldsymbol{x}}_{0}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)
\boldsymbol{x}_{t}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\hat{\boldsymbol{x}}_{t},t))
\hat{\boldsymbol{x}}_{t}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
+
\boldsymbol{x}_{0}
\boldsymbol{x}_{t}
\boldsymbol{x}_{t}
\boldsymbol{x}_{T}
t
\boldsymbol{x}_{0}
t
q(\boldsymbol{x}_{0})
q(\hat{\boldsymbol{x}}_{0})
T=1,000
\times
t
\times
\times
[100,300]
t+1
\boldsymbol{x}_{t}
\boldsymbol{\xi}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{y}_{t}
\boldsymbol{x}_{t}
\boldsymbol{y}_{t}=\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0}+\sqrt{1-\bar{%
\alpha}_{t}}(\boldsymbol{\epsilon}+\gamma_{t}\boldsymbol{\xi}).
\boldsymbol{\xi}
\gamma_{0}=...=\gamma_{T}=\gamma
\beta_{1},...,\beta_{T}
\gamma_{0},...,\gamma_{T}
\gamma_{t}
t
\boldsymbol{x}_{t}
\boldsymbol{y}_{t}
\boldsymbol{x}_{0}\sim q(\boldsymbol{x}_{0})
t\sim\mathbb{U}(\{1,...,T\})
\boldsymbol{\epsilon}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{\xi}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{y}_{t}
\text{take a gradient descent step on}\>\nabla_{\boldsymbol{\theta}}||%
\boldsymbol{\epsilon}-\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{%
y}_{t},t)||^{2}
\boldsymbol{y}_{t}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\boldsymbol{\epsilon}
\boldsymbol{\xi}
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}
(\boldsymbol{x}_{t},\boldsymbol{\epsilon})
(\boldsymbol{y}_{t},\boldsymbol{\epsilon})
y
\boldsymbol{y}_{t}
\boldsymbol{y}_{t}
q(\boldsymbol{y}_{t}|\boldsymbol{x}_{0})={\cal N}(\boldsymbol{y}_{t};\sqrt{%
\bar{\alpha}_{t}}\boldsymbol{x}_{0},(1-\bar{\alpha}_{t})(1+\gamma^{2})%
\boldsymbol{I}).
\boldsymbol{\epsilon^{\prime}}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{y}_{t}=\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0}+\sqrt{1-\bar{%
\alpha}_{t}}\sqrt{1+\gamma^{2}}\boldsymbol{\epsilon^{\prime}}.
y
y
\boldsymbol{x}_{t}
\boldsymbol{y}_{t}
\boldsymbol{\epsilon}
\boldsymbol{\epsilon^{\prime}}
\boldsymbol{y}_{t}
\boldsymbol{\xi}\neq\boldsymbol{0}
\boldsymbol{\epsilon}\neq\boldsymbol{\epsilon^{\prime}}
y
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
y
\boldsymbol{\epsilon^{\prime}}
\boldsymbol{y}_{t}
\boldsymbol{\epsilon}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{y}_{t},t)
y
y
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\gamma
\times
t
\hat{\boldsymbol{\epsilon}}=\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\hat{%
\boldsymbol{x}}_{t},t)
\boldsymbol{\epsilon}
\hat{\boldsymbol{\epsilon}}
\hat{\boldsymbol{x}}_{0}
t
\boldsymbol{e}_{t}=\hat{\boldsymbol{x}}_{0}-\boldsymbol{x}_{0}
\hat{\boldsymbol{x}}_{0}
\boldsymbol{x}_{0}
\hat{\boldsymbol{x}}_{t}
\boldsymbol{x}_{t}
\sqrt{1-\bar{\alpha}_{t}}
t
\{1,...,T\}
t
\boldsymbol{e}_{t}
\boldsymbol{e}_{t}\sim{\cal N}(\boldsymbol{0},\nu_{t}^{2}\boldsymbol{I})
\nu_{t}
\nu_{t}
t
\gamma_{t}=\nu_{t}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
\nu_{t}
t
\gamma_{t}
\gamma
t
\times
\nu_{t}\in[0,\mathbb{E}_{t}[\nu_{t}]]=[0,0.2]
\gamma=0.1
\gamma=0.1
\gamma
\nu_{t}
t
\nu_{t}
t
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)
\boldsymbol{x}_{t}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
||\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x},t)-\boldsymbol{%
\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{y},t)||\leq K||\boldsymbol{x}-%
\boldsymbol{y}||,\>\>\>\forall(\boldsymbol{x},\boldsymbol{y})
K
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\cdot)
L_{2}
L_{GP}(\boldsymbol{\theta})=||\boldsymbol{\epsilon}-\boldsymbol{\epsilon}_{%
\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)||^{2}+\lambda_{GP}\left\|\frac{%
\partial\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)}{%
\partial\boldsymbol{x}}\right\|^{2}_{F},
\lambda_{GP}
L_{WD}(\boldsymbol{\theta})=||\boldsymbol{\epsilon}-\boldsymbol{\epsilon}_{%
\boldsymbol{\theta}}(\boldsymbol{x}_{t},t)||^{2}+\lambda_{WD}||\boldsymbol{%
\theta}||^{2},
\lambda_{WD}
\gamma=0.1
\lambda_{GP}=1e-6
\lambda_{WD}=0.03
T=1,000
T=1,000
\times
T=1,000
T^{\prime}\leq T
T=1,000
T^{\prime}\leq T
T^{\prime}
\times
\times
\times
\times
T=1,000
T^{\prime}<T
\gamma=0.1
T^{\prime}\leq T
T^{\prime}=80
\times
T^{\prime}=1,000
T^{\prime}=900
\times
T^{\prime}<T
T^{\prime}\in[100,300]
\gamma
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
T^{\prime}=1,000
T^{\prime}=100
T^{\prime}=1,000
T^{\prime}=100
\gamma
T^{\prime}=100
\gamma
T^{\prime}=100
T=1,000
\eta=0
\eta=0.5
\eta
\gamma=0.1
\eta
\eta=0.5
\eta=0
T=1,000
T^{\prime}\leq T
T=1,000
T^{\prime}\leq T
\eta
T^{\prime}
\times
T=1,000
\times
\boldsymbol{x}_{0}
\hat{\boldsymbol{x}}_{0}
\boldsymbol{x}_{0}
\boldsymbol{x}_{t}
\boldsymbol{\epsilon}_{\boldsymbol{\theta}}
t
\sigma_{t}\boldsymbol{z}
\boldsymbol{x}_{0}
L_{1}
\boldsymbol{x}_{0}
\hat{\boldsymbol{x}}_{0}
t
[-1,1]
\delta_{t}=0
n_{t}=0
\forall t\in\{1,...,T\}
\boldsymbol{x}_{0}\sim q(\boldsymbol{x}_{0})
t\sim\mathbb{U}(\{1,...,T\})
\boldsymbol{\epsilon}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I})
\boldsymbol{x}_{t}
\tau:=t,...,1
\hat{\boldsymbol{x}}_{\tau-1}=\frac{1}{\sqrt{\alpha_{\tau}}}(\hat{\boldsymbol{%
x}}_{\tau}-\frac{1-\alpha_{\tau}}{\sqrt{1-\bar{\alpha}_{\tau}}}\boldsymbol{%
\epsilon}_{\boldsymbol{\theta}}(\hat{\boldsymbol{x}}_{\tau},\tau))
\delta_{t}=\delta_{t}+||\boldsymbol{x}_{0}-\hat{\boldsymbol{x}}_{0}||_{1}/M
M
\boldsymbol{x}_{0}
n_{t}=n_{t}+1
N
n_{t}\neq 0
\bar{\delta_{t}}=\frac{\delta_{t}}{n_{t}}
\forall t\in\{1,...,T\}
\bar{\delta_{t}}
t
(\boldsymbol{x}_{0},\hat{\boldsymbol{x}}_{0})
t
\bar{\delta_{t}}
\bar{\delta_{t}}
\boldsymbol{y}_{t}
A\sim{\cal N}(\mu_{A},\sigma_{A}^{2})
B\sim{\cal N}(\mu_{B},\sigma_{B}^{2})
S=aA+bB
a,b
S\sim{\cal N}(a\mu_{A}+b\mu_{B},a^{2}\sigma_{A}^{2}+b^{2}\sigma_{B}^{2}).
\boldsymbol{x}_{0}
\boldsymbol{y}_{t}
\boldsymbol{x}_{t}
\boldsymbol{\xi}
\displaystyle q(\boldsymbol{x}_{t}|\boldsymbol{x}_{0})={\cal N}(\boldsymbol{x}%
_{t};\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0},(1-\bar{\alpha}_{t})\boldsymbol%
{I}),
\displaystyle q(\boldsymbol{x}_{t}|\boldsymbol{x}_{0})={\cal N}(\boldsymbol{x}%
_{t};\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0},(1-\bar{\alpha}_{t})\boldsymbol%
{I}),
\displaystyle\boldsymbol{\xi}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I}),
\displaystyle\boldsymbol{\xi}\sim{\cal N}(\boldsymbol{0},\boldsymbol{I}),
\displaystyle\boldsymbol{y}_{t}=\boldsymbol{x}_{t}+\sqrt{1-\bar{\alpha}_{t}}%
\gamma\boldsymbol{\xi}.
\displaystyle\boldsymbol{y}_{t}=\boldsymbol{x}_{t}+\sqrt{1-\bar{\alpha}_{t}}%
\gamma\boldsymbol{\xi}.
S
\boldsymbol{y}_{t}
A
\boldsymbol{x}_{t}
B
\boldsymbol{\xi}
a=1
b=\sqrt{1-\bar{\alpha}_{t}}\gamma
\displaystyle q(\boldsymbol{y}_{t}|\boldsymbol{x}_{0})={\cal N}(\boldsymbol{y}%
_{t};\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0},(1-\bar{\alpha}_{t})\boldsymbol%
{I}+\gamma^{2}(1-\bar{\alpha}_{t})\boldsymbol{I})=
\displaystyle q(\boldsymbol{y}_{t}|\boldsymbol{x}_{0})={\cal N}(\boldsymbol{y}%
_{t};\sqrt{\bar{\alpha}_{t}}\boldsymbol{x}_{0},(1-\bar{\alpha}_{t})\boldsymbol%
{I}+\gamma^{2}(1-\bar{\alpha}_{t})\boldsymbol{I})=
\displaystyle={\cal N}(\boldsymbol{y}_{t};\sqrt{\bar{\alpha}_{t}}\boldsymbol{x%
}_{0},(1-\bar{\alpha}_{t})(1+\gamma^{2})\boldsymbol{I}).
\displaystyle={\cal N}(\boldsymbol{y}_{t};\sqrt{\bar{\alpha}_{t}}\boldsymbol{x%
}_{0},(1-\bar{\alpha}_{t})(1+\gamma^{2})\boldsymbol{I}).
y
\boldsymbol{y}_{t}
y
y
y
\boldsymbol{x}_{t}
\boldsymbol{\epsilon}
y
\boldsymbol{y}_{t}
\boldsymbol{\epsilon^{\prime}}
\boldsymbol{y}_{t}
\boldsymbol{\epsilon}
\times
\times
\times
\times
\times
\times
\times
\times
\boldsymbol{e}_{t}\sim{\cal N}(\boldsymbol{0},\nu_{t}^{2}\boldsymbol{I})
t
i\in\{1,...,M\}
e_{t}^{i}
e_{t}^{i}\sim{\cal N}(0,\nu_{t}^{2})
t
\{1,...,T\}
t
\mu_{t}
\nu_{t}^{2}
e_{t}^{i}
\bar{e}_{t}^{i}=\frac{e_{t}^{i}-\mu_{t}}{\nu_{t}^{2}}
i
\bar{e}_{t}^{i}
\boldsymbol{e}_{t}
e_{t}^{i}
e_{t}^{i}
t=300,i=1
e_{t}^{i}
t=300,i=1
e_{t}^{i}
t=300,i=1025
e_{t}^{i}
t=300,i=1025
e_{t}^{i}
t=300,i=2049
e_{t}^{i}
t=300,i=2049
e_{t}^{i}
t=600,i=528
e_{t}^{i}
t=600,i=528
e_{t}^{i}
t=600,i=1552
e_{t}^{i}
t=600,i=1552
e_{t}^{i}
t=600,i=2576
e_{t}^{i}
t=600,i=2576
e_{t}^{i}
t=900,i=1024
e_{t}^{i}
t=900,i=1024
e_{t}^{i}
t=900,i=2048
e_{t}^{i}
t=900,i=2048
e_{t}^{i}
t=900,i=3072
e_{t}^{i}
t=900,i=3072
e_{t}^{i}
t
i
e_{t}^{i}
t
i
\left\|f_{w}(x_{1})-f_{w}(x_{2})\right\|
\left\|x_{1}-x_{2}\right\|
K
\left\|f_{w}(x_{1})-f_{w}(x_{2})\right\|\leq K\cdot\left\|x_{1}-x_{2}\right\|.
f(x)=ReLU(Wx+b)
\left\|f(Wx_{1}+b)-f(Wx_{2}+b)\right\|\leq K\cdot\left\|x_{1}-x_{2}\right\|.
\left\|\frac{\partial f}{\partial y}\cdot W(x_{1}-x_{2})\right\|\leq K\cdot%
\left\|x_{1}-x_{2}\right\|,
y=Wx+b
f(y)
y=0
f(y)\approx f(0)+f^{\prime}(0)(y-0)f(y)\approx f(0)+f^{\prime}(0)(y-0)
y
y_{1}
y_{2}
y_{1}=Wx_{1}+b,y_{2}=Wx_{2}+b
f(y_{1})-f(y_{2})\approx f(0)+f^{\prime}(0)y_{1}-f(0)-f^{\prime}(0)y_{2}=f^{%
\prime}(0)(y_{1}-y{2})=f^{\prime}(0)W(x_{1}-x_{2})
\frac{\partial f}{\partial y}
f=ReLU
\left\|W(x_{1}-x_{2})\right\|\leq K\left\|x_{1}-x_{2}\right\|.
\left\|W\right\|_{2}
\left\|W\right\|_{2}=\displaystyle\max_{x\neq 0}\frac{\left\|Wx\right\|}{\left%
\|x\right\|}
\left\|W(x_{1}-x_{2})\right\|\leq\left\|W\right\|_{2}\cdot\left\|x_{1}-x_{2}%
\right\|.
\left\|W\right\|_{2}
K
\left\|W\right\|_{F}
\left\|W\right\|_{2}
\left\|Wx\right\|\leq\left\|W\right\|_{F}\cdot\left\|x\right\|,
\left\|W\right\|_{F}=\sqrt{\sum_{i,j}w_{i,j}^{2}}
\left\|W\right\|_{F}
K
\lambda\left\|W\right\|_{F}^{2}
\left\|W\right\|_{F}=\sqrt{\sum_{i,j}w_{i,j}^{2}}
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\boldsymbol{x}_{T}
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
