10^{60}
{\bm{x}}
t=0,\dots,T
{\bm{z}}_{t}
q({\bm{z}}_{t}|{\bm{z}}_{t-1})=\mathcal{N}({\bm{z}}_{t};\overline{\alpha}_{t}{%
\bm{z}}_{t-1},\overline{\sigma}_{t}^{2}{\bm{I}}),
\overline{\alpha}_{t}\in\mathbb{R}^{+}
\overline{\sigma}_{t}\in\mathbb{R}^{+}
q({\bm{z}}_{0},{\bm{z}}_{1},\dots,{\bm{z}}_{T}|{\bm{x}})=q({\bm{z}}_{0}|{\bm{x%
}})\prod_{t=1}^{T}q({\bm{z}}_{t}|{\bm{z}}_{t-1}).
q
{\bm{z}}_{t}
{\bm{x}}
q({\bm{z}}_{t}|{\bm{x}})=\mathcal{N}({\bm{z}}_{t}|\alpha_{t}{\bm{x}},\sigma_{t%
}^{2}{\bm{I}}),
\overline{\alpha}_{t}=\alpha_{t}/\alpha_{t-1}
\overline{\sigma}_{t}^{2}=\sigma_{t}^{2}-\overline{\alpha}_{t}^{2}\sigma_{t-1}%
^{2}
{\bm{x}}
{\bm{z}}_{t}
{\bm{x}}
q({\bm{z}}_{t-1}|{\bm{x}},{\bm{z}}_{t})=\mathcal{N}({\bm{z}}_{t-1};\bm{\mu}_{t%
}({\bm{x}},{\bm{z}}_{t}),\varsigma_{t}^{2}{\bm{I}}),
\bm{\mu}_{t}({\bm{x}},{\bm{z}}_{t})=\frac{\overline{\alpha}_{t}\sigma_{t-1}^{2%
}}{\sigma_{t}^{2}}{\bm{z}}_{t}+\frac{\alpha_{s}\overline{\sigma}_{t}^{2}}{%
\sigma_{t}^{2}}{\bm{x}}\ \ \text{and}\ \ \varsigma_{t}=\frac{\overline{\sigma}%
_{t}\sigma_{t-1}}{\sigma_{t}}.
{\bm{x}}
{\bm{z}}_{T}
{\bm{x}}
{\bm{z}}_{T}
{\bm{x}}
p({\bm{z}}_{t-1}|{\bm{z}}_{t})=q({\bm{z}}_{t-1}|\hat{{\bm{x}}},{\bm{z}}_{t}),
\hat{{\bm{x}}}
{\bm{x}}
\varphi
\hat{\bm{\epsilon}_{t}}=\varphi({\bm{z}}_{t},t)
\hat{{\bm{x}}}
\hat{{\bm{x}}}=(1/\alpha_{t}){\bm{z}}_{t}-(\sigma_{t}/\alpha_{t})\hat{\bm{%
\epsilon}}_{t}.
t
\mathcal{L}(t)=||\bm{\epsilon}-\hat{\bm{\epsilon}}_{t}||^{2}
\mathbb{E}_{t\sim\mathcal{U}(0,\dots,T)}[T\cdot\mathcal{L}(t)]
{\bm{z}}_{T}\sim\mathcal{N}(0,{\bm{I}})
t=T,\dots,1
{\bm{z}}_{t-1}\sim p({\bm{z}}_{t-1}|\bm{z_{t}})
{\bm{x}}\sim p({\bm{x}}|{\bm{z}}_{0})
\bm{x}
M
\bm{r}=(\bm{r}_{1},\dots,\bm{r}_{M})\in\mathbb{R}^{M\times 3}
\bm{h}=(\bm{h}_{1},\dots,\bm{h}_{M})\in\mathbb{R}^{M\times\text{nf}}
\bm{x}
\bm{x}=[\bm{r},\bm{h}]
{\bm{z}}_{0}
{\bm{z}}_{0}
{\bm{x}}
p({\bm{x}}|{\bm{z}}_{0})
\mathbb{R}^{3}
\mathbb{R}^{3}
f:\mathbb{R}^{3}\to\mathbb{R}^{3}
f({\bm{R}}{\bm{x}}+{\bm{t}})={\bm{R}}f({\bm{x}})+{\bm{t}}
{\bm{R}}\in\mathbb{R}^{3\times 3}
\det{\bm{R}}=\pm 1
{\bm{t}}\in\mathbb{R}^{3}
{\bm{x}}\in\mathbb{R}^{3}
{\bm{R}}{\bm{x}}=({\bm{R}}{\bm{x}}_{1},\dots,{\bm{R}}{\bm{x}}_{M})^{\top}
p({\bm{x}}|{\bm{y}})
{p({\bm{R}}{\bm{x}}+{\bm{t}}|{\bm{R}}{\bm{y}}+{\bm{t}})=p({\bm{x}}|{\bm{y}})}
{\bm{x}},{\bm{y}}\in\mathbb{R}^{3}
f
p
f({\bm{R}}{\bm{x}})={\bm{R}}f({\bm{x}})
p({\bm{R}}{\bm{x}}|{\bm{R}}{\bm{y}})=p({\bm{x}}|{\bm{y}})
f
f({\bm{x}}+{\bm{t}})=f({\bm{x}})
\bm{x}
{\bm{u}}
\bm{x}
p(\bm{z}_{t-1}|\bm{z}_{t},\bm{u})=q(\bm{z}_{t-1}|\hat{\bm{x}},\bm{z}_{t}),\ \ %
\text{where}\ \ \ \hat{{\bm{x}}}=(1/\alpha_{t}){\bm{z}}_{t}-(\sigma_{t}/\alpha%
_{t})\varphi({\bm{z}}_{t},{\bm{u}},t).
p(\bm{z}_{T}|\bm{u})=\mathcal{N}(\bm{z}_{T};f(\bm{u}),{\bm{I}})
p(\bm{z}_{t-1}|\bm{z}_{t},\bm{u})=q(\bm{z}_{t-1}|\hat{\bm{x}},\bm{z}_{t})
q
{f:\mathbb{R}^{M\times 3}\to\mathbb{R}^{3}}
\hat{{\bm{x}}}
\varphi
p
p(\bm{z}_{0},\bm{z}_{1},\dots,\bm{z}_{T}|\bm{u})=p(\bm{z}_{T}|\bm{u})\prod_{t=%
1}^{T}p(\bm{z}_{t-1}|\bm{z}_{t},\bm{u}).
f
\varphi
{\bm{z}}_{t}
{\bm{u}}
p(\bm{z}_{0}|\bm{u})
f
f(\bm{u})
f(\bm{u})
\bm{u}
p
\varphi
\mathcal{N}(f(\bm{u}),{\bm{I}})
f(\bm{u})
\mathcal{N}(0,{\bm{I}})
\varphi
\bm{z}_{t}
t
\bm{u}
\bm{r}
\bm{h}
t
\hat{\bm{\epsilon}}
\hat{\bm{\epsilon}}=[\hat{\bm{\epsilon}}^{r},\hat{\bm{\epsilon}}^{h}]
\varphi
\displaystyle\hat{\bm{\epsilon}}=[\hat{\bm{\epsilon}}^{r},\hat{\bm{\epsilon}}^%
{h}]=\varphi(\bm{z}_{t},\bm{u},t)=\text{EGNN}(\bm{z}_{t},\bm{u},t)-[\bm{z}_{t}%
^{r},0].
\displaystyle\hat{\bm{\epsilon}}=[\hat{\bm{\epsilon}}^{r},\hat{\bm{\epsilon}}^%
{h}]=\varphi(\bm{z}_{t},\bm{u},t)=\text{EGNN}(\bm{z}_{t},\bm{u},t)-[\bm{z}_{t}%
^{r},0].
\bm{r}^{l+1},\bm{h}^{l+1}=\text{EGCL}[\bm{r}^{l},\bm{h}^{l}]
\displaystyle\bm{m}_{ij}=\phi_{e}(\bm{h}^{l}_{i},\bm{h}^{l}_{j},d^{2}_{ij}),\ %
\ \ \bm{h}_{i}^{l+1}=\phi_{h}(\bm{h}_{i}^{l},\sum_{j\neq i}\bm{m}_{ij}),\ \ \ %
\bm{r}_{i}^{l+1}=\bm{r}_{i}^{l}+\phi_{vel}(\bm{r}^{l},\bm{h}^{l},i),
\displaystyle\bm{m}_{ij}=\phi_{e}(\bm{h}^{l}_{i},\bm{h}^{l}_{j},d^{2}_{ij}),\ %
\ \ \bm{h}_{i}^{l+1}=\phi_{h}(\bm{h}_{i}^{l},\sum_{j\neq i}\bm{m}_{ij}),\ \ \ %
\bm{r}_{i}^{l+1}=\bm{r}_{i}^{l}+\phi_{vel}(\bm{r}^{l},\bm{h}^{l},i),
d_{ij}=\|\bm{r}_{i}^{l}-\bm{r}_{j}^{l}\|
\phi_{e}
\phi_{h}
\phi_{vel}
\bm{z}_{t}
\bm{u}
\varphi
\bm{z}_{t}
\displaystyle\phi_{vel}(\bm{r}^{l},\bm{h}^{l},i)=\begin{cases}\sum_{j\neq i}%
\frac{\bm{r}_{i}^{l}-\bm{r}_{j}^{l}}{d_{ij}+1}\phi_{r}(\bm{h}_{i}^{l},\bm{h}_{%
j}^{l},d_{ij}^{2})&\text{if node}\ i\ \text{belongs to the point cloud}\ \bm{z%
}_{t},\\
0&\text{if node}\ i\ \text{belongs to the context}\ \bm{u},\end{cases}
\displaystyle\phi_{vel}(\bm{r}^{l},\bm{h}^{l},i)=\begin{cases}\sum_{j\neq i}%
\frac{\bm{r}_{i}^{l}-\bm{r}_{j}^{l}}{d_{ij}+1}\phi_{r}(\bm{h}_{i}^{l},\bm{h}_{%
j}^{l},d_{ij}^{2})&\text{if node}\ i\ \text{belongs to the point cloud}\ \bm{z%
}_{t},\\
0&\text{if node}\ i\ \text{belongs to the context}\ \bm{u},\end{cases}
\phi_{r}
\phi_{e}
\phi_{h}
\phi_{vel}
\bm{r}^{l}_{i}
\bm{r}^{l}_{j}
\hat{\bm{r}}=[\bm{u}^{r},\hat{\bm{z}}^{r}_{t}]
\hat{\bm{h}}=[\hat{\bm{u}}^{h},\hat{\bm{z}}^{h}_{t}]
[\hat{\bm{z}}^{r}_{t},\hat{\bm{z}}^{h}_{t}]
\bm{u}
{\bm{z}}_{t}
{\bm{u}}
\varphi
\text{SC}_{\text{RDKit}}
\text{SC}_{\text{RDKit}}
\uparrow
\downarrow
\uparrow
\text{SC}_{\text{RDKit}}
\downarrow
>0.7
>0.8
>0.9
\uparrow
\text{SC}_{\text{RDKit}}
\bm{x}
\bm{u}
\varphi
t\sim\mathcal{U}(0,\dots,T),\ \bm{\epsilon}_{t}\sim\mathcal{N}(0,\textbf{I})
\bm{z}_{t}\leftarrow\alpha_{t}\bm{x}+\sigma_{t}\bm{\epsilon}_{t}
\hat{\bm{\epsilon}}_{t}\leftarrow\varphi(\bm{z}_{t},\bm{u},t)
\|\bm{\epsilon}-\hat{\bm{\epsilon}}_{t}\|^{2}
\bm{u}
\varphi
\bm{u}
f(\bm{u})
\bm{z}_{T}\sim\mathcal{N}(0,{\bm{I}})
t
T,\ T-1,\ \dots\ 1
\bm{\epsilon}_{t}\sim\mathcal{N}(0,{\bm{I}})
\hat{\bm{\epsilon}}_{t}\leftarrow\varphi(\bm{z}_{t},\bm{u},t)
\bm{z}_{t-1}\leftarrow(1/\overline{\alpha}_{t})\cdot\bm{z}_{t}-\overline{%
\sigma}^{2}_{t}/(\overline{\alpha}_{t}\sigma_{t})\cdot\hat{\bm{\epsilon}}_{t}+%
\varsigma_{t}\cdot\bm{\epsilon}
\bm{x}\sim p(\bm{x}|\bm{z}_{0},\bm{u})
f
q
p({\bm{R}}\bm{z}_{T}|{\bm{R}}\bm{u})=\mathcal{N}({\bm{R}}\bm{z}_{T}|f({\bm{R}}%
\bm{u}),{\bm{I}})=\mathcal{N}({\bm{R}}\bm{z}_{T}|{\bm{R}}f(\bm{u}))=\mathcal{N%
}(\bm{z}_{T}|f(\bm{u}))=p(\bm{z}_{T}|\bm{u}).
\varphi
p(\bm{z}_{t-1}|\bm{z}_{t},\bm{u})
p(\bm{z}_{0}|\bm{u})
\bm{z}_{0}
p(\bm{z}_{0},\bm{z}_{1},\dots,\bm{z}_{T}|\bm{u})
\bm{z}_{1\dots T}
p(\bm{z}_{0}|\bm{u})=\int p(\bm{z}_{0},\bm{z}_{1},\dots,\bm{z}_{T}|\bm{u})d\bm%
{z}_{1\dots T}=\int p(\bm{z}_{T}|\bm{u})\prod_{t=0}^{T-1}p(\bm{z}_{t}|\bm{z}_{%
t+1},\bm{u})d\bm{z}_{1\dots T}.
p(\bm{z}_{0}|\bm{u})
\displaystyle p({\bm{R}}\bm{z}_{0}|{\bm{R}}\bm{u})=\int p({\bm{R}}\bm{z}_{T}|{%
\bm{R}}\bm{u})\prod_{t=0}^{T-1}p({\bm{R}}\bm{z}_{t}|{\bm{R}}\bm{z}_{t+1},{\bm{%
R}}\bm{u})d\bm{z}_{1\dots T}
\displaystyle p({\bm{R}}\bm{z}_{0}|{\bm{R}}\bm{u})
\displaystyle=\int p({\bm{R}}\bm{z}_{T}|{\bm{R}}\bm{u})\prod_{t=0}^{T-1}p({\bm%
{R}}\bm{z}_{t}|{\bm{R}}\bm{z}_{t+1},{\bm{R}}\bm{u})d\bm{z}_{1\dots T}
\displaystyle=\int p(\bm{z}_{T}|\bm{u})\prod_{t=0}^{T-1}p({\bm{R}}\bm{z}_{t}|{%
\bm{R}}\bm{z}_{t+1},{\bm{R}}\bm{u})d\bm{z}_{1\dots T}\ \ \left(\text{%
equivariant prior $p(\bm{z}_{T}|\bm{u})$}\right)
p(\bm{z}_{T}|\bm{u})
\displaystyle=\int p(\bm{z}_{T}|\bm{u})\prod_{t=0}^{T-1}p({\bm{R}}\bm{z}_{t}|{%
\bm{R}}\bm{z}_{t+1},{\bm{R}}\bm{u})d\bm{z}_{1\dots T}\ \ \left(\text{%
equivariant prior $p(\bm{z}_{T}|\bm{u})$}\right)
p(\bm{z}_{T}|\bm{u})
\displaystyle=\int p(\bm{z}_{T}|\bm{u})\prod_{t=0}^{T-1}p(\bm{z}_{t}|\bm{z}_{t%
+1},\bm{u})d\bm{z}_{1\dots T}\ \ \left(\text{equivariant transition kernels $p%
(\bm{z}_{t}|\bm{z}_{t+1},\bm{u})$}\right)
p(\bm{z}_{t}|\bm{z}_{t+1},\bm{u})
\displaystyle=\int p(\bm{z}_{T}|\bm{u})\prod_{t=0}^{T-1}p(\bm{z}_{t}|\bm{z}_{t%
+1},\bm{u})d\bm{z}_{1\dots T}\ \ \left(\text{equivariant transition kernels $p%
(\bm{z}_{t}|\bm{z}_{t+1},\bm{u})$}\right)
p(\bm{z}_{t}|\bm{z}_{t+1},\bm{u})
\displaystyle=\int p(\bm{z}_{0},\bm{z}_{1},\dots,\bm{z}_{T}|\bm{u})d\bm{z}_{1%
\dots T}=p(\bm{z}_{0}|\bm{u}).
\displaystyle=\int p(\bm{z}_{0},\bm{z}_{1},\dots,\bm{z}_{T}|\bm{u})d\bm{z}_{1%
\dots T}=p(\bm{z}_{0}|\bm{u}).
p(\bm{z}_{t-1}|\bm{z}_{t},\bm{u})=q(\bm{z}_{t-1}|\hat{\bm{x}},\bm{z}_{t})
p(\bm{z}_{t-1}|\bm{z}_{t},\bm{u})
p(\bm{z}_{t-1}+{\bm{t}}|\bm{z}_{t}+{\bm{t}},\bm{u}+{\bm{t}})=p(\bm{z}_{t-1}|%
\bm{z}_{t},\bm{u})\ \ \forall{\bm{t}}\in\mathbb{R}^{3}.
\mathcal{N}(\bm{z}_{t-1}+{\bm{t}};\hat{\bm{\mu}}_{t}(\bm{z_{t}}+{\bm{t}},\bm{u%
}+{\bm{t}}),\varsigma_{t}^{2}{\bm{I}})=\mathcal{N}(\bm{z}_{t-1};\hat{\bm{\mu}}%
_{t}(\bm{z_{t}},\bm{u}),\varsigma_{t}^{2}{\bm{I}}),
\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})=\bm{\mu}_{t}(\hat{\bm{x}},\bm{z_{t}})=%
\frac{\overline{\alpha}_{t}\sigma_{t-1}^{2}}{\sigma_{t}^{2}}\bm{z}_{t}+\frac{%
\alpha_{t-1}\overline{\sigma}_{t}^{2}}{\sigma_{t}^{2}}\hat{\bm{x}},
\hat{\bm{x}}=\frac{1}{\alpha_{t}}\bm{z}_{t}-\frac{\sigma_{t}}{\alpha_{t}}%
\varphi(\bm{z_{t}},\bm{u},t).
\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})=\frac{1}{\overline{\alpha}_{t}}\bm{z_{t}%
}-\frac{\overline{\sigma}^{2}_{t}}{\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm%
{z_{t}},\bm{u},t).
\varphi
\varphi(\bm{z}_{t}+{\bm{t}},\bm{u}+{\bm{t}},t)=\varphi(\bm{z}_{t},\bm{u},t)
\displaystyle\hat{\bm{\mu}}_{t}(\bm{z_{t}}+{\bm{t}},\bm{u}+\bm{t})=\frac{1}{%
\overline{\alpha}_{t}}(\bm{z_{t}}+{\bm{t}})-\frac{\overline{\sigma}^{2}_{t}}{%
\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm{z_{t}}+\bm{t},\bm{u}+\bm{t},t)
\displaystyle\hat{\bm{\mu}}_{t}(\bm{z_{t}}+{\bm{t}},\bm{u}+\bm{t})
\displaystyle=\frac{1}{\overline{\alpha}_{t}}(\bm{z_{t}}+{\bm{t}})-\frac{%
\overline{\sigma}^{2}_{t}}{\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm{z_{t}}+%
\bm{t},\bm{u}+\bm{t},t)
\displaystyle=\frac{1}{\overline{\alpha}_{t}}(\bm{z_{t}}+\bm{t})-\frac{%
\overline{\sigma}^{2}_{t}}{\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm{z_{t}},%
\bm{u},t)
\displaystyle=\frac{1}{\overline{\alpha}_{t}}(\bm{z_{t}}+\bm{t})-\frac{%
\overline{\sigma}^{2}_{t}}{\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm{z_{t}},%
\bm{u},t)
\displaystyle=\frac{1}{\overline{\alpha}_{t}}\bm{z_{t}}-\frac{\overline{\sigma%
}^{2}_{t}}{\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm{z_{t}},\bm{u},t)+\frac{%
1}{\overline{\alpha}_{t}}\bm{t}
\displaystyle=\frac{1}{\overline{\alpha}_{t}}\bm{z_{t}}-\frac{\overline{\sigma%
}^{2}_{t}}{\overline{\alpha}_{t}\sigma_{t}}\varphi(\bm{z_{t}},\bm{u},t)+\frac{%
1}{\overline{\alpha}_{t}}\bm{t}
\displaystyle=\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})+\frac{1}{\overline{\alpha}%
_{t}}\bm{t}
\displaystyle=\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})+\frac{1}{\overline{\alpha}%
_{t}}\bm{t}
\displaystyle=\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})+\lambda_{t}\bm{t}.
\displaystyle=\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})+\lambda_{t}\bm{t}.
\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})
\lambda\neq 1
\displaystyle p(\bm{z}_{t-1}+\bm{t}|\bm{z}_{t}+\bm{t},\bm{u}+\bm{t})=\mathcal{%
N}\left(\bm{z}_{t-1}+\bm{t};\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{u})+\lambda\bm{t%
},\varsigma_{t}^{2}{\bm{I}}\right)
\displaystyle p(\bm{z}_{t-1}+\bm{t}|\bm{z}_{t}+\bm{t},\bm{u}+\bm{t})
\displaystyle=\mathcal{N}\left(\bm{z}_{t-1}+\bm{t};\hat{\bm{\mu}}_{t}(\bm{z_{t%
}},\bm{u})+\lambda\bm{t},\varsigma_{t}^{2}{\bm{I}}\right)
\displaystyle=\mathcal{N}\left(\bm{z}_{t-1};\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{%
u})+(\lambda-1)\bm{t},\varsigma_{t}^{2}{\bm{I}}\right)
\displaystyle=\mathcal{N}\left(\bm{z}_{t-1};\hat{\bm{\mu}}_{t}(\bm{z_{t}},\bm{%
u})+(\lambda-1)\bm{t},\varsigma_{t}^{2}{\bm{I}}\right)
\displaystyle\neq\mathcal{N}\left(\bm{z}_{t-1};\hat{\bm{\mu}}_{t}(\bm{z_{t}},%
\bm{u}),\varsigma_{t}^{2}{\bm{I}}\right).
\displaystyle\neq\mathcal{N}\left(\bm{z}_{t-1};\hat{\bm{\mu}}_{t}(\bm{z_{t}},%
\bm{u}),\varsigma_{t}^{2}{\bm{I}}\right).
p(\bm{z}_{t-1}+\bm{t}|\bm{z}_{t}+\bm{t},\bm{u}+\bm{t})=p\left(\bm{z}_{t-1}+(1-%
\lambda)\bm{t}|\bm{z}_{t},\bm{u}\right)\neq p\left(\bm{z}_{t-1}|\bm{z}_{t},\bm%
{u}\right).
T=500
\alpha_{t}=(1-2s)\cdot(1-(t/T)^{2}),
s=10^{-5}
{\bm{z}}_{t}
{\bm{u}}
{\bm{h}}_{i}\in\mathbb{R}^{\text{in}}
{\bm{r}}_{i}\in\mathbb{R}^{3}
{\bm{h}}_{i}
t
{\bm{h}}_{i}
\rightarrow
\rightarrow
{\bm{h}}_{i}^{0}
L
\phi_{e},\ \phi_{h},\phi_{r}
\phi_{e}
{\bm{h}}_{i}^{l}
{\bm{h}}_{j}^{l}
d_{ij}^{2}=\|{\bm{r}}_{i}-{\bm{r}}_{j}\|^{2}
{\bm{m}}_{ij}\in\mathbb{R}^{\text{nf}}
{\bm{h}}^{l}_{i}
{\bm{h}}^{l}_{j}
d_{ij}^{2}
\rightarrow
\cdot
\rightarrow
\rightarrow
\rightarrow
\rightarrow
{\bm{m}}_{ij}
\phi_{h}
{\bm{h}}_{i}^{l}
{\bm{m}}_{i}=\sum_{j}{\bm{m}}_{ij}
{\bm{h}}_{i}^{l}
{\bm{m}}_{i}
\rightarrow
\cdot
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
{\bm{h}}_{i}^{l}
\rightarrow
{\bm{h}}_{i}^{l+1}
\phi_{r}
\phi_{e}
{\bm{h}}^{l}_{i}
{\bm{h}}^{l}_{j}
d_{ij}^{2}
\rightarrow
\cdot
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
2\cdot 10^{-5}
10^{-13}
L
{\bm{h}}_{i}\in\mathbb{R}^{\text{in}}
d_{ij}^{2}=\|{\bm{r}}_{i}-{\bm{r}}_{j}\|^{2}
{\bm{p}}\in[0,1]^{\text{out}}
{\bm{h}}_{i}
\rightarrow
\rightarrow
{\bm{h}}_{i}^{0}
L
\phi_{e},\ \phi_{h}
{\bm{h}}_{i}^{L}
\mathbb{R}^{\text{out}}
{\bm{h}}_{i}^{L}
\rightarrow
\rightarrow
\rightarrow
\rightarrow
{\bm{p}}
10^{-4}
10^{-13}
L
\text{SC}_{\text{RDKit}}
\uparrow
\downarrow
\uparrow
\text{SC}_{\text{RDKit}}
\downarrow
>0.7
>0.8
>0.9
\uparrow
