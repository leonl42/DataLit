f
f
g\circ f
g
f
g
g
\{{\bm{X}}_{1}^{1},\dots,{\bm{X}}_{1}^{N}\},\{{\bm{X}}_{2}^{1},\dots,{\bm{X}}_%
{2}^{N}\},{\bm{X}}_{1}^{i}\in\mathbb{R}^{M},{\bm{X}}_{2}^{i}\in\mathbb{R}^{M}
X_{1}
X_{2}
\sup_{f_{1}\in\mathcal{F}_{1},f_{2}\in\mathcal{F}_{2}}\mathrm{Corr}\langle f_{%
1}(X_{1}),f_{2}(X_{2})\rangle,
f_{1},f_{2}
\mathrm{Cov}
\mathrm{Corr}
X_{1}
X_{2}
\mathcal{F}_{1},\mathcal{F}_{2}
\mathcal{F}_{1}
\mathcal{F}_{2}
X_{1}
X_{2}
{\bm{X}}_{1}
{\bm{X}}_{2}\in\mathbb{R}^{N\times M}
\mathrm{HSIC}({\bm{X}}_{1},{\bm{X}}_{2}):=\frac{1}{(N-1)^{2}}\operatorname{Tr}%
({\bm{K}}_{1}{\bm{H}}{\bm{K}}_{2}{\bm{H}}),
{\bm{H}}
{\bm{I}}-\mathbf{1}\mathbf{1}^{T}\frac{1}{N}
({\bm{K}}_{1})_{i,j}=k_{1}({\bm{X}}_{1}^{i},{\bm{X}}_{1}^{j})
({\bm{K}}_{2})_{i,j}=k_{2}({\bm{X}}_{2}^{i},{\bm{X}}_{2}^{j})
{\bm{X}}_{1}
{\bm{X}}_{2}
k_{1}
k_{2}
\mathcal{F}_{1},\mathcal{F}_{2}
\mathrm{HSIC}(X_{1},X_{2})\geq\sup_{f_{1}\in\mathcal{F}_{1},f_{2}\in\mathcal{F%
}_{2}}\mathrm{Cov}\langle f_{1}(X_{1}),g(X_{2})\rangle,
\mathrm{HSIC}(X_{1},X_{2})=0
X_{1}
X_{2}
D
M
X_{1},\dots,X_{D}
(X_{1},\dots,X_{D})
\mu
\mathcal{F}
\|\mu(\mathbb{P}^{X_{1}}\otimes\dots\otimes\mathbb{P}^{X_{D}})-\mu(\mathbb{P}^%
{X_{1},\dots,X_{D}})\|_{\mathcal{F}}.
\text{dHSIC}=0
{\bm{X}}_{1},\dots,{\bm{X}}_{D}
\mathbb{R}^{N\times M}
D
{\bm{X}}\in\mathbb{R}^{N\times D}
D
M=1
N
\mathcal{O}(N^{2})
\mathcal{O}(DN^{2})
D
\mathcal{O}(D^{2}N^{2})
N\geq 2D
D=2048
{\bm{S}}\in\mathbb{R}^{N\times W\times H}
{\bm{S}}_{\rm left}
{\bm{S}}_{\rm right}
f
{\bm{X}}_{\rm left}
{\bm{X}}_{\rm right}\in\mathbb{R}^{N\times D}
g
{\bm{Z}}_{\rm left}
{\bm{Z}}_{\rm right}\in\mathbb{R}^{N\times P}
{\bm{Z}}_{\rm left}
{\bm{Z}}_{\rm right}
f
(2N,P)
{\bm{Z}}_{\rm total}\triangleq[{\bm{Z}}_{\rm left}^{T},{\bm{Z}}_{\rm right}^{T%
}]^{T}
\mathcal{L}_{\rm VC}
\mathcal{L}_{\rm VIC}
\displaystyle\mathcal{L}_{\rm VC}=\sum_{k=1}^{P}\max\left(0,1-\sqrt{\mathrm{%
Cov}({\bm{Z}}_{\rm total})_{k,k}}\right)
\displaystyle\mathcal{L}_{\rm VC}=\sum_{k=1}^{P}\max\left(0,1-\sqrt{\mathrm{%
Cov}({\bm{Z}}_{\rm total})_{k,k}}\right)
\displaystyle+\alpha\sum_{j=1,j\not=k}^{P}\mathrm{Cov}({\bm{Z}}_{\rm total})^{%
2}_{k,j},
\displaystyle+\alpha\sum_{j=1,j\not=k}^{P}\mathrm{Cov}({\bm{Z}}_{\rm total})^{%
2}_{k,j},
\displaystyle\mathcal{L}_{\rm VIC}=\frac{1}{N}\sum_{n=1}^{N}\|({\bm{Z}}_{\rm
left%
})_{n,.}-({\bm{Z}}_{\rm right})_{n,.}\|_{2}^{2}+\mathcal{L}_{\rm VC},
\displaystyle\mathcal{L}_{\rm VIC}=\frac{1}{N}\sum_{n=1}^{N}\|({\bm{Z}}_{\rm
left%
})_{n,.}-({\bm{Z}}_{\rm right})_{n,.}\|_{2}^{2}+\mathcal{L}_{\rm VC},
\mathcal{L}_{\rm VC}
{\bm{Z}}_{\rm total}
{\bm{Z}}_{\rm total}
\mathcal{L}_{\rm VC}
\mathcal{L}_{\rm VIC}
\alpha
f
{\bm{X}}\in\mathbb{R}^{N\times D}
D
f
N
{\bm{X}}
g
{\bm{Z}}=g({\bm{X}})=[g{\bm{X}}_{1},\dots,g{\bm{X}}_{P}]\in\mathbb{R}^{N\times
P}
{\bm{Z}}
{\bm{Z}}_{\rm left}
{\bm{Z}}_{\rm right}
g:\mathbb{R}\mapsto\mathbb{R}^{L}
{\bm{Z}}=g({\bm{X}})=[g({\bm{X}}_{:,1}),\dots,g({\bm{X}}_{:,P})]
g:\mathbb{R}\mapsto\mathbb{R}^{L}
{\bm{Z}}
f
{\bm{X}}
{\bm{K}}_{i}=g({\bm{X}}_{:,i})g({\bm{X}}_{:,i})^{T}
N
i^{\rm th}
{\bm{X}}_{:,i}
g
{\bm{Z}}=[g({\bm{X}}_{:,1}),\dots,g({\bm{X}}_{:,D})]\in\mathbb{R}^{N\times DL}
\displaystyle\mathrm{HSIC}({\bm{X}}_{:,i},{\bm{X}}_{:,j})=
\displaystyle\mathrm{HSIC}(
\displaystyle{\bm{X}}_{:,i},{\bm{X}}_{:,j})=
\displaystyle\;\;\;\;\frac{\operatorname{Tr}(g({\bm{X}}_{:,i})g({\bm{X}}_{:,i}%
)^{T}{\bm{H}}g({\bm{X}}_{:,j})g({\bm{X}}_{:,j})^{T}{\bm{H}})}{(N-1)^{2}}
\displaystyle\;\;\;\;\frac{\operatorname{Tr}(g({\bm{X}}_{:,i})g({\bm{X}}_{:,i}%
)^{T}{\bm{H}}g({\bm{X}}_{:,j})g({\bm{X}}_{:,j})^{T}{\bm{H}})}{(N-1)^{2}}
\displaystyle=\frac{1}{(N-1)^{2}}\left\|g({\bm{X}}_{:,i})^{T}{\bm{H}}g({\bm{X}%
}_{:,j})\right\|_{F}^{2}
\displaystyle=\frac{1}{(N-1)^{2}}\left\|g({\bm{X}}_{:,i})^{T}{\bm{H}}g({\bm{X}%
}_{:,j})\right\|_{F}^{2}
\displaystyle=\left\|\mathrm{Cov}\left(g({\bm{X}}_{:,i}),g({\bm{X}}_{:,j}%
\right)\right\|_{F}^{2}
\displaystyle=\left\|\mathrm{Cov}\left(g({\bm{X}}_{:,i}),g({\bm{X}}_{:,j}%
\right)\right\|_{F}^{2}
\displaystyle=\left\|\mathrm{Cov}\left({\bm{Z}}\right)_{1+iL:1+(i+1)L,1+jl:1+(%
j+1)L}\right\|_{F}^{2}
\displaystyle=\left\|\mathrm{Cov}\left({\bm{Z}}\right)_{1+iL:1+(i+1)L,1+jl:1+(%
j+1)L}\right\|_{F}^{2}
\displaystyle\sum_{i\not=j}\mathrm{HSIC}({\bm{X}}_{:,i},{\bm{X}}_{:,j})=\left%
\|\mathrm{Cov}\left({\bm{Z}}\right)\odot\left((1-{\bm{I}}_{D})\otimes\mathbf{1%
}_{L}\mathbf{1}_{L}^{T}\right)\right\|_{F}^{2},
\displaystyle\sum_{i\not=j}\mathrm{HSIC}({\bm{X}}_{:,i},{\bm{X}}_{:,j})=\left%
\|\mathrm{Cov}\left({\bm{Z}}\right)\odot\left((1-{\bm{I}}_{D})\otimes\mathbf{1%
}_{L}\mathbf{1}_{L}^{T}\right)\right\|_{F}^{2},
L=1
\mathbf{1}_{L}\mathbf{1}_{L}^{T}=1
\sum_{i\not=j}\mathrm{HSIC}({\bm{X}}_{:,i},{\bm{X}}_{:,j})=\sum_{i\not=j}%
\mathrm{Cov}\left({\bm{Z}}\right)^{2}_{i,j}
{\bm{K}}_{i}
L
L
{\bm{X}}
{\bm{X}}
g
{\bm{W}}
{\bm{X}}
{\bm{Z}}=g({\bm{X}})={\bm{X}}{\bm{W}}
f
{\bm{X}}
{\bm{X}}
g
{\bm{W}}
{\bm{W}}^{T}{\bm{W}}={\bm{I}}
\mathcal{U}(-\nicefrac{{1}}{{\sqrt{D}}},\nicefrac{{1}}{{\sqrt{D}}})
P
g
P
0
\mathcal{O}(\nicefrac{{1}}{{\sqrt{P}}})
\mathcal{U}(-\nicefrac{{1}}{{\sqrt{D}}},\nicefrac{{1}}{{\sqrt{D}}})
{\bm{Z}}
{\bm{X}}
{\bm{Z}}
\downarrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
10
10
1000
\alpha=0.5
P
Z=g(X)=(X_{1},0,\dots,0)
D=2048
P=8192
P=8192
\downarrow
\pm
\pm
\pm
\uparrow
\pm
\pm
\pm
=0.008
{\bm{S}}\in\mathbb{R}^{N\times D}
{\bm{Y}}={\bm{S}}{\bm{A}}\in\mathbb{R}^{N\times D}
{\bm{M}}
{\bm{Y}}{\bm{M}}
{\bm{S}}
{\bm{S}}
{\bm{Y}}
f
f
{\bm{M}}
{\bm{X}}=f({\bm{Y}})
g
{\bm{Z}}=g({\bm{X}})
M
{\bm{X}}
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
f
g
\uparrow
g
\uparrow
{\bm{X}}
{\bm{Y}}
{\bm{Z}}
{\bm{X}}
{\bm{Z}}
48\%
68
50\%
68\%
{\bm{C}}
P\times P
{\bm{Z}}_{\rm left}
{\bm{Z}}_{\rm right}
\displaystyle\mathcal{L}_{\rm BT}=\sum_{k=1}^{K}(({\bm{C}})_{k,k}-1)^{2}+%
\alpha\sum_{k^{\prime}\not=k}({\bm{C}})_{k,k^{\prime}}^{2}\;.
\displaystyle\mathcal{L}_{\rm BT}=\sum_{k=1}^{K}(({\bm{C}})_{k,k}-1)^{2}+%
\alpha\sum_{k^{\prime}\not=k}({\bm{C}})_{k,k^{\prime}}^{2}\;.
({\bm{C}})_{i,j}
i^{\rm th}
{\bm{Z}}_{\rm left}
j^{\rm th}
{\bm{Z}}_{\rm right}
({\bm{C}})_{i,j}=\frac{\langle({\bm{Z}}_{\rm left})_{.,i},({\bm{Z}}_{\rm right%
})_{.,j}\rangle}{\|({\bm{Z}}_{\rm left})_{.,i}\|_{2}\|({\bm{Z}}_{\rm right})_{%
.,j}\|_{2}}
\displaystyle\min\;2-2\frac{\langle{\bm{Z}}_{\rm left},{\bm{Z}}_{\rm right}%
\rangle}{\|{\bm{Z}}_{\rm left}\|_{2}\dot{\|}{\bm{Z}}_{\rm right}\|_{2}}\;
\displaystyle\min\;
\displaystyle 2-2\frac{\langle{\bm{Z}}_{\rm left},{\bm{Z}}_{\rm right}\rangle}%
{\|{\bm{Z}}_{\rm left}\|_{2}\dot{\|}{\bm{Z}}_{\rm right}\|_{2}}\;
\displaystyle\text{s.t. }\mathrm{Cov}({\bm{Z}}_{\rm left})=Id,\mathrm{Cov}({%
\bm{Z}}_{\rm right})=Id.
\displaystyle\text{s.t. }\mathrm{Cov}({\bm{Z}}_{\rm left})=Id,\mathrm{Cov}({%
\bm{Z}}_{\rm right})=Id.
{\bm{Y}}
{\bm{Y}}
N
D
{\bm{Y}}\in\mathbb{R}^{N\times D}
{\bm{S}}
{\bm{Y}}={\bm{S}}{\bm{A}}
{\bm{A}}\in\mathbb{R}^{D\times D}
{\bm{M}}\in\mathbb{R}^{D\times D}
{\bm{Y}}{\bm{M}}={\bm{S}}
{\bm{Y}}{\bm{M}}
{\bm{S}}
g(({\bm{X}})_{:,i})=({\bm{X}})_{:,i}{\bm{w}}^{T}_{i}
\langle{\bm{w}}_{i},{\bm{w}}_{j}\rangle=1_{\{i=j\}}
{\bm{w}}\in\mathbb{R}^{K}
K
\displaystyle\sum_{i\not=j}\mathrm{HSIC}(({\bm{X}})_{:,i},({\bm{X}})_{:,j})=%
\frac{1}{(N-1)^{2}}\sum_{i\not=j}\operatorname{Tr}(g(({\bm{X}})_{:,i})g(({\bm{%
X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})_{:,j})g(({\bm{X}})_{:,j})^{T}{\bm{H}})
\displaystyle\sum_{i\not=j}\mathrm{HSIC}(({\bm{X}})_{:,i},({\bm{X}})_{:,j})=
\displaystyle\frac{1}{(N-1)^{2}}\sum_{i\not=j}\operatorname{Tr}(g(({\bm{X}})_{%
:,i})g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})_{:,j})g(({\bm{X}})_{:,j})^{T}%
{\bm{H}})
\displaystyle=\frac{1}{(N-1)^{2}}\sum_{i\not=j}\|g(({\bm{X}})_{:,i})^{T}{\bm{H%
}}g(({\bm{X}})_{:,j})\|_{F}^{2},
\displaystyle=
\displaystyle\frac{1}{(N-1)^{2}}\sum_{i\not=j}\|g(({\bm{X}})_{:,i})^{T}{\bm{H}%
}g(({\bm{X}})_{:,j})\|_{F}^{2},
\displaystyle\|\sum_{i\not=j}f(i,j)\|_{F}^{2}=\sum_{i\not=j}\|f(i,j)\|_{F}^{2}%
+\sum_{i\not=j}\sum_{k\not=\ell,(i,j)\not=(k,\ell)}\operatorname{Tr}\left(f(i,%
j)^{T}f(k,\ell)\right)=\sum_{i\not=j}\|f(i,j)\|_{F}^{2},
\displaystyle\|\sum_{i\not=j}f(i,j)\|_{F}^{2}=
\displaystyle\sum_{i\not=j}\|f(i,j)\|_{F}^{2}+\sum_{i\not=j}\sum_{k\not=\ell,(%
i,j)\not=(k,\ell)}\operatorname{Tr}\left(f(i,j)^{T}f(k,\ell)\right)=\sum_{i%
\not=j}\|f(i,j)\|_{F}^{2},
\displaystyle f(i,j)=g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})_{:,j})={\bm{w%
}}_{i}({\bm{X}})_{:,i}^{T}{\bm{H}}({\bm{X}})_{:,j}{\bm{w}}_{j}^{T},
\displaystyle f(i,j)
\displaystyle=g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})_{:,j})={\bm{w}}_{i}(%
{\bm{X}})_{:,i}^{T}{\bm{H}}({\bm{X}})_{:,j}{\bm{w}}_{j}^{T},
\displaystyle f(i,j)^{T}f(k,\ell)={\bm{w}}_{j}({\bm{X}})_{:,j}^{T}{\bm{H}}({%
\bm{X}})_{:,i}{\bm{w}}_{i}^{T}{\bm{w}}_{k}({\bm{X}})_{:,k}^{T}{\bm{H}}({\bm{X}%
})_{:,\ell}{\bm{w}}_{\ell}^{T},
\displaystyle f(i,j)^{T}f(k,\ell)
\displaystyle={\bm{w}}_{j}({\bm{X}})_{:,j}^{T}{\bm{H}}({\bm{X}})_{:,i}{\bm{w}}%
_{i}^{T}{\bm{w}}_{k}({\bm{X}})_{:,k}^{T}{\bm{H}}({\bm{X}})_{:,\ell}{\bm{w}}_{%
\ell}^{T},
\displaystyle\operatorname{Tr}(f(i,j)^{T}f(k,\ell))=1_{\{i=k\wedge j=\ell\}}({%
\bm{X}})_{:,j}^{T}{\bm{H}}({\bm{X}})_{:,i}({\bm{X}})_{:,k}^{T}{\bm{H}}({\bm{X}%
})_{:,\ell},
\displaystyle\operatorname{Tr}(f(i,j)^{T}f(k,\ell))
\displaystyle=1_{\{i=k\wedge j=\ell\}}({\bm{X}})_{:,j}^{T}{\bm{H}}({\bm{X}})_{%
:,i}({\bm{X}})_{:,k}^{T}{\bm{H}}({\bm{X}})_{:,\ell},
\displaystyle\sum_{i\not=j}\mathrm{HSIC}(({\bm{X}})_{:,i},({\bm{X}})_{:,j})=%
\frac{1}{(N-1)^{2}}\|\sum_{i\not=j}g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})%
_{:,j})\|_{F}^{2}
\displaystyle\sum_{i\not=j}\mathrm{HSIC}(({\bm{X}})_{:,i},({\bm{X}})_{:,j})=
\displaystyle\frac{1}{(N-1)^{2}}\|\sum_{i\not=j}g(({\bm{X}})_{:,i})^{T}{\bm{H}%
}g(({\bm{X}})_{:,j})\|_{F}^{2}
\displaystyle=\frac{1}{(N-1)^{2}}\|(\sum_{i}g(({\bm{X}})_{:,i}))^{T}{\bm{H}}(%
\sum_{j}g(({\bm{X}})_{:,j}))-\sum_{i}g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}%
})_{:,i})\|_{F}^{2}
\displaystyle=\frac{1}{(N-1)^{2}}\|(\sum_{i}g(({\bm{X}})_{:,i}))^{T}{\bm{H}}(%
\sum_{j}g(({\bm{X}})_{:,j}))-\sum_{i}g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}%
})_{:,i})\|_{F}^{2}
\displaystyle=\|\frac{1}{N-1}(\sum_{i}g(({\bm{X}})_{:,i}))^{T}{\bm{H}}(\sum_{j%
}g(({\bm{X}})_{:,j}))-\operatorname{diag}(\mathrm{Cov}({\bm{X}}{\bm{W}}))\|_{F%
}^{2}
\displaystyle=
\displaystyle\|\frac{1}{N-1}(\sum_{i}g(({\bm{X}})_{:,i}))^{T}{\bm{H}}(\sum_{j}%
g(({\bm{X}})_{:,j}))-\operatorname{diag}(\mathrm{Cov}({\bm{X}}{\bm{W}}))\|_{F}%
^{2}
\displaystyle=\|\mathrm{Cov}({\bm{X}}{\bm{W}})-\operatorname{diag}(\mathrm{Cov%
}({\bm{X}}{\bm{W}}))\|_{F}^{2}
\displaystyle=
\displaystyle\|\mathrm{Cov}({\bm{X}}{\bm{W}})-\operatorname{diag}(\mathrm{Cov}%
({\bm{X}}{\bm{W}}))\|_{F}^{2}
\displaystyle=\sum_{i\not=j}\mathrm{Cov}({\bm{X}}{\bm{W}})_{i,j}^{2},
\displaystyle=
\displaystyle\sum_{i\not=j}\mathrm{Cov}({\bm{X}}{\bm{W}})_{i,j}^{2},
{\bm{X}}
{\bm{W}}
\displaystyle\frac{1}{N-1}\sum_{i}g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})_%
{:,i})=\mathrm{Var}(({\bm{X}})_{:,1})\sum_{i}{\bm{w}}_{i}{\bm{w}}_{i}^{T}=%
\mathrm{Var}(({\bm{X}})_{:,1}),
\displaystyle\frac{1}{N-1}\sum_{i}g(({\bm{X}})_{:,i})^{T}{\bm{H}}g(({\bm{X}})_%
{:,i})=\mathrm{Var}(({\bm{X}})_{:,1})\sum_{i}{\bm{w}}_{i}{\bm{w}}_{i}^{T}=%
\mathrm{Var}(({\bm{X}})_{:,1}),
g
\sum_{i}g(({\bm{X}})_{:,i})=\sum_{i}({\bm{X}})_{:,i}{\bm{w}}_{i}^{T}={\bm{X}}{%
\bm{W}}
{\bm{W}}=[{\bm{w}}_{1},\dots,{\bm{w}}_{K}]^{T}
\displaystyle\min\sum_{k=1}^{K}(\mathrm{Cov}({\bm{Z}}_{\rm left},{\bm{Z}}_{\rm
right%
})_{k,k}-1)^{2}+\alpha\sum_{k^{\prime}\not=k}\mathrm{Cov}({\bm{Z}}_{\rm left},%
{\bm{Z}}_{\rm right})_{k,k^{\prime}}^{2}\;
\displaystyle\min
\displaystyle\sum_{k=1}^{K}(\mathrm{Cov}({\bm{Z}}_{\rm left},{\bm{Z}}_{\rm
right%
})_{k,k}-1)^{2}+\alpha\sum_{k^{\prime}\not=k}\mathrm{Cov}({\bm{Z}}_{\rm left},%
{\bm{Z}}_{\rm right})_{k,k^{\prime}}^{2}\;
\displaystyle\text{s.t. }\mathrm{Cov}({\bm{Z}}_{\rm left})={\bm{I}},\mathrm{%
Cov}({\bm{Z}}_{\rm right})={\bm{I}}.
\displaystyle\text{s.t. }\mathrm{Cov}({\bm{Z}}_{\rm left})={\bm{I}},\mathrm{%
Cov}({\bm{Z}}_{\rm right})={\bm{I}}.
{\bm{Z}}_{\rm left}^{T}{\bm{Z}}_{\rm left}={\bm{I}},{\bm{Z}}_{\rm right}^{T}{%
\bm{Z}}_{\rm right}={\bm{I}}
\displaystyle C_{i,j}=\frac{\langle({\bm{Z}}_{\rm left})_{:,i},({\bm{Z}}_{\rm
left%
})_{:,j}\rangle}{\|({\bm{Z}}_{\rm left})_{:,i}\|_{2}\|({\bm{Z}}_{\rm left})_{:%
,j}\|_{2}}=\frac{1}{2}\langle({\bm{Z}}_{\rm left})_{:,i},({\bm{Z}}_{\rm right}%
)_{:,j}\rangle=-\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z}}_{\rm right})_{:,j}\|_{%
2}^{2}-1,
\displaystyle C_{i,j}=
\displaystyle\frac{\langle({\bm{Z}}_{\rm left})_{:,i},({\bm{Z}}_{\rm left})_{:%
,j}\rangle}{\|({\bm{Z}}_{\rm left})_{:,i}\|_{2}\|({\bm{Z}}_{\rm left})_{:,j}\|%
_{2}}=\frac{1}{2}\langle({\bm{Z}}_{\rm left})_{:,i},({\bm{Z}}_{\rm right})_{:,%
j}\rangle=-\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2%
}-1,
\displaystyle\sum_{i}(C_{i,i}-1)^{2}=\sum_{i}\|({\bm{Z}}_{\rm left})_{:,i}-({%
\bm{Z}}_{\rm right})_{:,i}\|_{2}^{4}=\|{\bm{Z}}_{\rm left}-{\bm{Z}}_{\rm right%
}\|_{F}^{4}\propto I({\bm{Z}}_{\rm left},{\bm{Z}}_{\rm right}),
\displaystyle\sum_{i}(C_{i,i}-1)^{2}=\sum_{i}\|({\bm{Z}}_{\rm left})_{:,i}-({%
\bm{Z}}_{\rm right})_{:,i}\|_{2}^{4}=\|{\bm{Z}}_{\rm left}-{\bm{Z}}_{\rm right%
}\|_{F}^{4}\propto I({\bm{Z}}_{\rm left},{\bm{Z}}_{\rm right}),
\displaystyle\sum_{i\not=j}C_{i,j}^{2}=\sum_{i\not=j}(1-\frac{1}{2}\|({\bm{Z}}%
_{\rm left})_{:,i}-({\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2})^{2}
\displaystyle\sum_{i\not=j}C_{i,j}^{2}=
\displaystyle\sum_{i\not=j}(1-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z%
}}_{\rm right})_{:,j}\|_{2}^{2})^{2}
\displaystyle=\sum_{i\not=j}(1-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{%
Z}}_{\rm left})_{:,j}+({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}%
\|_{2}^{2})^{2}
\displaystyle=
\displaystyle\sum_{i\not=j}(1-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z%
}}_{\rm left})_{:,j}+({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}%
\|_{2}^{2})^{2}
\displaystyle=\sum_{i\not=j}\Big{(}1-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,i}-%
({\bm{Z}}_{\rm left})_{:,j}\|_{2}^{2}-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}%
-({\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}
\displaystyle=
\displaystyle\sum_{i\not=j}\Big{(}1-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,i}-(%
{\bm{Z}}_{\rm left})_{:,j}\|_{2}^{2}-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}-%
({\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}
\displaystyle-\langle({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z}}_{\rm left})_{:,j},(%
{\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}\rangle\Big{)}^{2}
\displaystyle-\langle({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z}}_{\rm left})_{:,j},(%
{\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}\rangle\Big{)}^{2}
\displaystyle=\sum_{i\not=j}\Big{(}-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}-(%
{\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}-\langle({\bm{Z}}_{\rm left})_{:,i}-({\bm%
{Z}}_{\rm left})_{:,j},({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j%
}\rangle\Big{)}^{2}
\displaystyle=
\displaystyle\sum_{i\not=j}\Big{(}-\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}-({%
\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}-\langle({\bm{Z}}_{\rm left})_{:,i}-({\bm{%
Z}}_{\rm left})_{:,j},({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}%
\rangle\Big{)}^{2}
\displaystyle=\sum_{i\not=j}\Big{(}\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}-({%
\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}+\langle({\bm{Z}}_{\rm left})_{:,i}-({\bm{%
Z}}_{\rm left})_{:,j},({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}%
\rangle\Big{)}^{2}
\displaystyle=
\displaystyle\sum_{i\not=j}\Big{(}\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}-({%
\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}+\langle({\bm{Z}}_{\rm left})_{:,i}-({\bm{%
Z}}_{\rm left})_{:,j},({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})_{:,j}%
\rangle\Big{)}^{2}
\displaystyle\leq\sum_{i\not=j}\Big{(}\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}%
-({\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}+\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z}%
}_{\rm left})_{:,j}\|_{2}^{2}\|({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right%
})_{:,j}\|_{2}^{2}\Big{)}^{2}
\displaystyle\leq
\displaystyle\sum_{i\not=j}\Big{(}\frac{1}{2}\|({\bm{Z}}_{\rm left})_{:,j}-({%
\bm{Z}}_{\rm right})_{:,j}\|_{2}^{2}+\|({\bm{Z}}_{\rm left})_{:,i}-({\bm{Z}}_{%
\rm left})_{:,j}\|_{2}^{2}\|({\bm{Z}}_{\rm left})_{:,j}-({\bm{Z}}_{\rm right})%
_{:,j}\|_{2}^{2}\Big{)}^{2}
\displaystyle=\frac{25(K-1)}{4}\|{\bm{Z}}_{\rm left}-{\bm{Z}}_{\rm right}\|_{2%
}^{4},
\displaystyle=
\displaystyle\frac{25(K-1)}{4}\|{\bm{Z}}_{\rm left}-{\bm{Z}}_{\rm right}\|_{2}%
^{4},
8192
8192
8192
8192
\downarrow
\uparrow
\sigma
{\bm{X}}_{1},\dots,{\bm{X}}_{d}
{\bm{K}}_{1},\dots,{\bm{K}}_{d}
\displaystyle\mathrm{dHSIC}({\bm{X}}_{1},\dots,{\bm{X}}_{d})=\frac{1}{N^{2}}%
\sum_{i,j}(\bigodot_{k=1}^{d}{\bm{K}}_{k})_{i,j}+\frac{1}{N^{2d}}\prod_{k=1}^{%
d}\sum_{i,j}({\bm{K}}_{k})_{i,j}-\frac{2}{N^{d+1}}\sum_{i}\bigodot_{k=1}^{d}%
\sum_{j}({\bm{K}}_{k})_{i,j}.
\displaystyle\mathrm{dHSIC}({\bm{X}}_{1},\dots,{\bm{X}}_{d})=
\displaystyle\frac{1}{N^{2}}\sum_{i,j}(\bigodot_{k=1}^{d}{\bm{K}}_{k})_{i,j}+%
\frac{1}{N^{2d}}\prod_{k=1}^{d}\sum_{i,j}({\bm{K}}_{k})_{i,j}-\frac{2}{N^{d+1}%
}\sum_{i}\bigodot_{k=1}^{d}\sum_{j}({\bm{K}}_{k})_{i,j}.
d=2
\mathrm{HSIC}
100
0.3
1024
8192-8192-8192
0.0051
8192-8192-8192
25
25
1
2048
0.15
8
4
2048-2048-2048-256-65536
160
(5,9)
(0.1,2)
224
100
64
[1.0,10.0,100.0]
\frac{lr\times batchsize}{256}
1024
8192
[1,10,100]
f
3
128
h
3
16
[1,3,10,30,100]
