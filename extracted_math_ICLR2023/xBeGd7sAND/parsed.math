\{0\}
\mathcal{F}
L_{2}(\mathbb{R}^{p}\rightarrow\mathbb{R}^{d})
\mathcal{L}:\mathcal{F}\rightarrow\mathbb{R}
\mathcal{L}(f)=\operatorname*{\mathbb{E}}_{({\bm{x}},{\bm{y}})\sim\mathcal{D}}%
\Big{[}\ell(f({\bm{x}}),{\bm{y}})\Big{]}
\ell
\mathcal{D}
\{(\displaystyle{\bm{x}}_{1},\displaystyle{\bm{y}}_{1}),...,(\displaystyle{\bm%
{x}}_{N},\displaystyle{\bm{y}}_{N})\}
\displaystyle{\bm{x}}_{i}\in\mathbb{R}^{p}
\displaystyle{\bm{y}}_{i}\in\mathbb{R}^{d}
f_{\theta}:\mathbb{R}^{p}\rightarrow\mathbb{R}^{d}
L
{\bm{W}}_{l}
\sigma_{l}
\sigma_{l}(0)=0
\theta:=(\displaystyle{\bm{W}}_{l})_{l=1\dots L}
\;\;\;\;\;\;{\bm{b}}_{0}({\bm{x}})\;=\;\begin{pmatrix}{\bm{x}}\\
1\end{pmatrix}
\forall l\in[1,L],\;\;\begin{cases}{\bm{a}}_{l}({\bm{x}})&=\;{\bm{W}}_{l}\,{%
\bm{b}}_{l-1}({\bm{x}})\\
{\bm{b}}_{l}({\bm{x}})&=\;\begin{pmatrix}\sigma_{l}({\bm{a}}_{l}({\bm{x}}))\\
1\end{pmatrix}\end{cases}
\hskip 42.67912ptf_{\theta}({\bm{x}})\;=\;\sigma_{L}({\bm{a}}_{L}({\bm{x}}))
\displaystyle{\bm{t}}({\bm{x}})
\displaystyle{\bm{X}}:=[{\bm{x}}_{1},...,{\bm{x}}_{n}]
\displaystyle{\bm{T}}({\bm{X}}):=\begin{pmatrix}\displaystyle{\bm{t}}({\bm{x}}%
_{1})&...&\displaystyle{\bm{t}}({\bm{x}}_{n})\end{pmatrix}\in\mathbb{R}^{|{\bm%
{t}}(.)|\times n}
l
{\bm{X}}
\displaystyle{\bm{A}}_{l}({\bm{X}})=\begin{pmatrix}\displaystyle{\bm{a}}_{l}({%
\bm{x}}_{1})&...&\displaystyle{\bm{a}}_{l}({\bm{x}}_{n})\end{pmatrix}
\displaystyle{\bm{B}}_{l}({\bm{X}})=\begin{pmatrix}\displaystyle{\bm{b}}_{l}({%
\bm{x}}_{1})&...&\displaystyle{\bm{b}}_{l}({\bm{x}}_{n})\end{pmatrix}
{\bm{b}}_{l}^{c}({\bm{x}})
f:\mathbb{R}^{p}\rightarrow\mathbb{R}^{d}
\mathcal{L}
\frac{\partial f}{\partial t}=-\nabla_{\!f}\mathcal{L}(f)
\mathcal{F}
{L}_{2}(\mathbb{R}^{p}\rightarrow\mathbb{R}^{d})
\nabla_{\!f}
t
\mathcolor{teal}{{\bm{{v_{\text{goal}}}}}}:=-\nabla_{\!f}\mathcal{L}(f)
f
{\bm{x}}
\displaystyle\mathcolor{teal}{{\bm{{v_{\text{goal}}}}}({\bm{x}})}=-\left(%
\nabla_{\!f}\mathcal{L}(f)\right)({\bm{x}})=-\nabla_{{\bm{u}}}\ell({\bm{u}},{%
\bm{y}}({\bm{x}}))\big{|}_{{\bm{u}}=f({\bm{x}})}
\mathcolor{teal}{{\bm{{v_{\text{goal}}}}}}
\mathcal{F}
f
\mathcal{L}
\mathcal{F}
\mathcal{A}
\theta\in\Theta_{\!\mathcal{A}}
\mathcal{F}_{\!\!\mathcal{A}}
f_{\theta}
\theta
\frac{\partial\theta}{\partial t}=-\nabla_{\!\theta}\mathcal{L}(f_{\theta})=-%
\!\!\!\!\operatorname*{\mathbb{E}}_{({\bm{x}},{\bm{y}})\sim\mathcal{D}}\Big{[}%
\nabla_{\!\theta}\ell(f_{\theta}({\bm{x}}),{\bm{y}})\Big{]}\,.
\bm{v}_{\text{GD}}\;:=\;\frac{\partial f_{\theta}}{\partial t}\;=\;\frac{%
\partial f_{\theta}}{\partial\theta}\;\frac{\partial\theta}{\partial t}\;=\;%
\frac{\partial f_{\theta}}{\partial\theta}\;\operatorname*{\mathbb{E}}_{({\bm{%
x}},{\bm{y}})\sim\mathcal{D}}\left[\frac{\partial f_{\theta}}{\partial\theta}^%
{T}\!\!({\bm{x}})\;{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}({\bm{x}})}\right]
\mathcal{T}_{\!\mathcal{A}}^{f_{\theta}}
\mathcal{T}_{\!\mathcal{A}}
\mathcal{F}_{\!\!\mathcal{A}}
f_{\theta}
f_{\theta}
\mathcal{T}_{\!\mathcal{A}}^{f_{\theta}}:=\left\{\left.\frac{\partial f_{%
\theta}}{\partial\theta}\;\delta\theta\;\right|\;\text{s.t.}\;\delta\theta\in%
\Theta_{\!\mathcal{A}}\right\}
f_{\theta}
\mathcal{F}_{\!\!\mathcal{A}}
\bm{v}_{\text{GD}}
\mathcal{T}_{\!\mathcal{A}}
\bm{v}^{*}
{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}:=-\nabla_{f_{\theta}}\mathcal{L%
}(f_{\theta})
\mathcal{T}_{\!\mathcal{A}}
\delta\theta^{*}
\bm{v}^{*}=\frac{\partial f_{\theta}}{\partial\theta}\,\delta\theta^{*}
-\nabla_{\theta}^{\mathcal{T}_{\!\mathcal{A}}}\mathcal{L}(f_{\theta})
\mathcal{L}\circ f_{\theta}
\theta
L_{2}
\|\frac{\partial f_{\theta}}{\partial\theta}\,\delta\theta\|_{L_{2}(\mathcal{T%
}_{\!\mathcal{A}})}
\nabla_{\!\theta}\mathcal{L}(f_{\theta})
L_{2}
\|\delta\theta\|_{L_{2}(\mathbb{R}^{|\Theta_{\!\mathcal{A}}|})}
\bm{v}^{*}\,=\,\operatorname*{arg\,min}_{\bm{v}\in\mathcal{T}_{\!\mathcal{A}}}%
\|\bm{v}-{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}\|^{2}\,=\,%
\operatorname*{arg\,min}_{\bm{v}\in\mathcal{T}_{\!\mathcal{A}}}\left\{D_{f}%
\mathcal{L}(f)(\bm{v})+\frac{1}{2}\|\bm{v}\|^{2}\right\}
D
\delta\theta^{*}\;=\;\operatorname*{arg\,min}_{\delta\theta\in\Theta_{\!%
\mathcal{A}}}\left\|\frac{\partial f_{\theta}}{\partial\theta}\,\delta\theta-{%
\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}\right\|^{2}\;=\;\operatorname*{%
arg\,min}_{\delta\theta\in\Theta_{\!\mathcal{A}}}\left\{D_{\theta}\mathcal{L}(%
f_{\theta})(\delta\theta)+\frac{1}{2}\left\|\frac{\partial f_{\theta}}{%
\partial\theta}\,\delta\theta\right\|^{2}\right\}=:-\nabla_{\theta}^{\mathcal{%
T}_{\!\mathcal{A}}}\mathcal{L}(f_{\theta})\,.
{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}
\mathcal{T}_{\!\mathcal{A}}
\mathcal{A}
\|\bm{v}^{*}-{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}\|
{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}
\bm{v}^{*}
\mathcal{A}
{\bm{a}}_{l}
l
{\bm{a}}_{l}:{\bm{x}}\in\mathbb{R}^{p}\mapsto{\bm{a}}_{l}({\bm{x}})\in\mathbb{%
R}^{d_{l}}
l
-\nabla_{{\bm{a}}_{l}}\mathcal{L}(f_{\theta})
{\bm{a}}_{l}
\mathcal{T}_{\!\mathcal{A}}^{\displaystyle{\bm{a}}_{l}}
({\bm{x}},{\bm{y}})\in\mathcal{D}
{\color[rgb]{0,.5,.5}{\bm{v}^{l}_{\text{goal}}}({\bm{x}})}:=-\left(\nabla_{{%
\bm{a}}_{l}}\mathcal{L}(f_{\theta})\right)({\bm{x}})=-\left.\nabla_{{\bm{u}}}%
\ell\left(\sigma_{L}(\displaystyle{\bm{W}}_{L}\,\sigma_{L-1}({\bm{W}}_{L-1}\,.%
..\,\sigma_{l}({\bm{u}}))),\,{\bm{y}}\right)\right|_{{\bm{u}}={\bm{a}}_{l}({%
\bm{x}})}
\ell(f_{\theta}({\bm{x}}),{\bm{y}})
{\bm{u}}={\bm{a}}_{l}({\bm{x}})
{\bm{W}}_{l}
\,\nabla_{{\bm{W}}_{l}}\ell(f_{\theta}({\bm{x}}),{\bm{y}})\;=\;\frac{\partial{%
\bm{a}}_{l}({\bm{x}})}{\partial{W}_{l}}\;\nabla_{{\bm{a}}_{l}}\ell(f_{\theta}(%
{\bm{x}}),{\bm{y}})
{\color[rgb]{0,.5,.5}{\bm{v}^{l}_{\text{goal}}}({\bm{x}})}:=-\left(\nabla_{{%
\bm{a}}_{l}}\mathcal{L}(f_{\theta})\right)({\bm{x}})
{\bm{a}}_{l}({\bm{x}})
{\bm{x}}
({\bm{x}}_{i})
\delta\theta
\displaystyle{\bm{x}}_{i}
\theta
\displaystyle{\bm{a}}_{l}
\tilde{\theta}
\tilde{\theta}={\bm{W}}_{l}
\delta\tilde{\theta}
\delta\tilde{\theta}=-\eta\sum_{({\bm{x}},{\bm{y}})\in\text{minibatch}}\nabla_%
{\tilde{\theta}}\ell(f_{\theta}({\bm{x}}),{\bm{y}})
\eta
\delta\tilde{\theta}
{\bm{a}}_{l}
l
\delta\tilde{\theta}
\displaystyle{\color[rgb]{1,0,1}{\bm{v}}^{l}({\bm{x}}_{i},\delta{\tilde{\theta%
}})}:=\frac{\partial{\bm{a}}_{l}({\bm{x}})}{\partial\tilde{\theta}}\;\delta%
\tilde{\theta}
\eta
{\color[rgb]{0,.5,.5}{\bm{v}^{l}_{\text{goal}}}({\bm{x}})}:=-\eta\nabla_{{\bm{%
a}}_{l}}\mathcal{L}(f_{\theta})({\bm{x}})
l
{\color[rgb]{0,.5,.5}{\bm{v}^{l}_{\text{goal}}}(.)}
{\color[rgb]{1,0,1}{\bm{v}}^{l}(.)}
f_{\theta}
{\bm{X}}=\{({\bm{x}}_{i},{\bm{y}}_{i})\}_{i=1}^{n}
l
{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}=({\bm{v}^{l}_{\text{goal}}}(%
{\bm{x}}_{1}),{\bm{v}^{l}_{\text{goal}}}({\bm{x}}_{2}),...)}
{\color[rgb]{1,0,1}V^{l}=({\bm{v}}^{l}({\bm{x}}_{1}),{\bm{v}}^{l}({\bm{x}}_{2}%
),...)}
\delta\theta
\Psi^{l}:=\underset{{\bm{v}}^{l}\in\mathcal{T}_{\!\mathcal{A}}^{{\bm{a}}_{l}}}%
{\min}\;\frac{1}{n}\sum_{i=1}^{n}\left\|{\color[rgb]{1,0,1}{\bm{v}}^{l}({\bm{x%
}}_{i})}-{\color[rgb]{0,.5,.5}{\bm{v}^{l}_{\text{goal}}}({\bm{x}}_{i})}\right%
\|^{2}={\min_{\delta\theta}}\;\frac{1}{n}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l%
}({\bm{X}},\delta\theta)}-{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}({%
\bm{X}})}\right\|^{2}_{\operatorname{Tr}}
||.||
{L}_{2}
||.||_{\operatorname{Tr}}
{\color[rgb]{1,0,1}{\bm{V}}^{l}({\bm{X}},\delta\theta)}
\delta\theta
{\bm{X}}
{\bm{X}}
\delta{\bm{W}}_{l}^{*}
\delta\theta
l
{{\bm{W}}}_{l}
\displaystyle\delta{\bm{W}}_{l}^{*}=\underset{{\mathbf{\delta W}_{\!l}}}{%
\operatorname*{arg\,min}}\frac{1}{n}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}({%
\mathbf{\delta W}_{\!l}})}-{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}}%
\right\|_{\operatorname{Tr}}^{2}
\displaystyle\delta{\bm{W}}_{l}^{*}
\displaystyle=\underset{{\mathbf{\delta W}_{\!l}}}{\operatorname*{arg\,min}}%
\frac{1}{n}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}({\mathbf{\delta W}_{\!l}})}-%
{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}}\right\|_{\operatorname{Tr}}%
^{2}
\displaystyle\delta{\bm{W}}_{l}^{*}=\frac{1}{n}{\bm{V}^{l}_{\!\text{goal}}}{%
\bm{B}}_{l-1}^{T}(\frac{1}{n}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T})^{+}
\displaystyle\delta{\bm{W}}_{l}^{*}=\frac{1}{n}{\bm{V}^{l}_{\!\text{goal}}}{%
\bm{B}}_{l-1}^{T}(\frac{1}{n}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T})^{+}
P^{+}
P
\delta{\bm{W}}_{l}^{*}
\delta{\bm{W}}_{l}^{\text{GD}}\propto{{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!%
\text{goal}}}}}{\bm{B}}_{l-1}^{T}
\delta{\bm{W}}_{l}^{*}{\bm{B}}_{l-1}
{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}}
l-1
\frac{1}{n}{\bm{B}}_{l-1}^{T}(\frac{1}{n}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T})^{+}%
{\bm{B}}_{l-1}
\delta{\bm{W}}_{l}^{*}
{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}}{\bm{B}}_{l-1}^{T}
{\bm{V}^{l}_{\!\text{goal}}}
l\!-\!1
K
n_{1},...,n_{K}
{\bm{\alpha}}_{1},...,{\bm{\alpha}}_{k}
{\bm{\omega}}_{1},...,{\bm{\omega}}_{K}
{\bm{W}}_{l-1}^{T}\leftarrow\begin{pmatrix}{\bm{W}}_{l-1}^{T}&{\bm{\alpha}}_{1%
}&...&{\bm{\alpha}}_{K}\end{pmatrix}
{\bm{W}}_{l}\leftarrow\begin{pmatrix}{\bm{W}}_{l}&{\bm{\omega}}_{1}&...&{\bm{%
\omega}}_{K}\end{pmatrix}
l
(K=1)
{\bm{\alpha}}\in\mathrm{R}^{5}
{\bm{\omega}}\in\mathrm{R}^{3}
l
(K=1)
{\bm{\alpha}}\in\mathrm{R}^{5}
{\bm{\omega}}\in\mathrm{R}^{3}
\theta\leftarrow\theta\oplus\theta_{\leftrightarrow}^{K}
\oplus
\theta_{\leftrightarrow}^{K}:=({\bm{\alpha}}_{k},{\bm{\omega}}_{k})_{k=1}^{K}
K
({\bm{\alpha}}_{k})_{k=1}^{K}
({\bm{\omega}}_{k})_{k=1}^{K}
f_{\theta}(.)
\theta
\theta\leftarrow\theta\oplus\theta_{\leftrightarrow}^{K}
\theta_{\leftrightarrow}^{K}
{\mathbf{\delta W}_{\!l}}
\displaystyle\underset{\theta_{\leftrightarrow}^{K},\;{\mathbf{\delta W}_{\!l}%
}}{\operatorname*{arg\,min}}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}({\mathbf{%
\delta W}_{\!l}}\oplus\theta_{\leftrightarrow}^{K})}-{\color[rgb]{0,.5,.5}{\bm%
{V}^{l}_{\!\text{goal}}}}\right\|^{2}_{\operatorname{Tr}}
\displaystyle\underset{\theta_{\leftrightarrow}^{K},\;{\mathbf{\delta W}_{\!l}%
}}{\operatorname*{arg\,min}}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}({\mathbf{%
\delta W}_{\!l}}\oplus\theta_{\leftrightarrow}^{K})}-{\color[rgb]{0,.5,.5}{\bm%
{V}^{l}_{\!\text{goal}}}}\right\|^{2}_{\operatorname{Tr}}
{\bm{V}}^{l}
l
{\mathbf{\delta W}_{\!l}}
\theta_{\leftrightarrow}^{K}
\displaystyle\underset{\theta_{\leftrightarrow}^{K},\;{\mathbf{\delta W}_{\!l}%
}}{\operatorname*{arg\,min}}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}(\theta_{%
\leftrightarrow}^{K})}+{\color[rgb]{1,0,1}{\bm{V}}^{l}({\mathbf{\delta W}_{\!l%
}})}-{\color[rgb]{0,.5,.5}{\bm{{V_{\text{goal}}}}}^{l}}\right\|_{\operatorname%
{Tr}}^{2}
\displaystyle\underset{\theta_{\leftrightarrow}^{K},\;{\mathbf{\delta W}_{\!l}%
}}{\operatorname*{arg\,min}}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}(\theta_{%
\leftrightarrow}^{K})}+{\color[rgb]{1,0,1}{\bm{V}}^{l}({\mathbf{\delta W}_{\!l%
}})}-{\color[rgb]{0,.5,.5}{\bm{{V_{\text{goal}}}}}^{l}}\right\|_{\operatorname%
{Tr}}^{2}
{\color[rgb]{1,0,1}{\bm{v}}^{l}({\bm{x}},\theta_{\leftrightarrow}^{K})}:=\sum_%
{k=1}^{K}{\bm{\omega}}_{k}\;(b_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k})
{\mathbf{\delta W}_{\!l}}
{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}_{proj}}:={\color[rgb]{%
0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}}-{\color[rgb]{1,0,1}{\bm{V}}^{l}({\mathbf%
{\delta W}_{\!l}}^{*})}
\big{(}K^{*},{\theta}^{K*}_{\leftrightarrow}\big{)}
\displaystyle\underset{K,\;\theta^{K}_{\leftrightarrow}}{\operatorname*{arg\,%
min}}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})}-{%
\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}_{proj}}\right\|_{%
\operatorname{Tr}}^{2}\;.
\displaystyle\underset{K,\;\theta^{K}_{\leftrightarrow}}{\operatorname*{arg\,%
min}}\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})}-{%
\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}_{proj}}\right\|_{%
\operatorname{Tr}}^{2}\;.
{\bm{N}}:=\frac{1}{n}{\bm{B}}_{l-2}\big{(}{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!%
\text{goal}}}_{proj}}\big{)}^{T}
{\bm{S}}:=\frac{1}{n}{\bm{B}}_{l-2}{\bm{B}}_{l-2}^{T}
{\bm{S}}
{\bm{S}}={\bm{U}}\Sigma{\bm{U}}^{T}
S^{-\frac{1}{2}}:={\bm{U}}\sqrt{\Sigma}^{-1}{\bm{U}}^{T}
S^{-\frac{1}{2}}{\bm{N}}=\sum_{k=1}^{R}\lambda_{k}{\bm{u}}_{k}{\bm{v}}_{k}^{T}
R
S^{-\frac{1}{2}}{\bm{N}}
K^{*}=R
\theta_{\leftrightarrow}^{K^{*}}=({{\bm{\alpha}}}_{k}^{*},{{\bm{\omega}}}_{k}^%
{*})_{k}^{K^{*}}=\left(\mathrm{sign}(\lambda_{k})\sqrt{|\lambda_{k}|}S^{-\frac%
{1}{2}}{\bm{u}}_{k},\;\sqrt{|\lambda_{k}|}{\bm{v}}_{k}\right)_{k}^{K^{*}}\;
K\leqslant R
{\theta}^{K,*}_{\leftrightarrow}
\eta
K
\lambda_{k}
\Psi^{l}_{\theta\oplus{\theta}^{K,*}_{\leftrightarrow}}=\Psi^{l}_{\theta}-{%
\color[rgb]{1,0,0}\sum_{k=1}^{K}\lambda_{k}^{2}}\;\;\;\;\;\;\;\text{and}\;\;\;%
\;\;\;\mathcal{L}(f_{\theta\oplus{\theta}^{K,*}_{\leftrightarrow}})=\mathcal{L%
}(f_{\theta})+\frac{\sigma_{l}^{\prime}(0)}{\eta}{\color[rgb]{1,0,0}\sum_{k=1}%
^{K}\lambda_{k}^{2}}+o(||{\theta}^{K,*}_{\leftrightarrow}||^{2})
{\bm{S}}
{\bm{\omega}}_{k}={\bm{N}}{\bm{\alpha}}_{k}
K
{\bm{\alpha}}_{k}
K
\lambda
\displaystyle{\bm{N}}{\bm{N}}^{T}{\bm{\alpha}}_{k}=\lambda{\bm{S}}{\bm{\alpha}%
}_{k}
\displaystyle{\bm{N}}{\bm{N}}^{T}{\bm{\alpha}}_{k}=\lambda{\bm{S}}{\bm{\alpha}%
}_{k}
m,m^{\prime}
m+m^{\prime}\leqslant R
\eta
m+m^{\prime}
m
m^{\prime}
{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}}
{\color[rgb]{1,0,1}{\bm{V}}^{l}}
\mathcal{L}
{\color[rgb]{1,0,1}{\bm{V}}^{l}}
\displaystyle\mathcal{L}(f_{\theta\oplus\theta_{\leftrightarrow}^{K}})\approx%
\mathcal{L}(f_{\theta})-\frac{\sigma_{l-1}^{\prime}(0)}{\eta\;n}\Big{\langle}{%
\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}},\;{\color[rgb]{1,0,1}{\bm{V}%
}^{l}}\Big{\rangle}_{\operatorname{Tr}}
\displaystyle\mathcal{L}(f_{\theta\oplus\theta_{\leftrightarrow}^{K}})
\displaystyle\approx\mathcal{L}(f_{\theta})-\frac{\sigma_{l-1}^{\prime}(0)}{%
\eta\;n}\Big{\langle}{\color[rgb]{0,.5,.5}{\bm{V}^{l}_{\!\text{goal}}}},\;{%
\color[rgb]{1,0,1}{\bm{V}}^{l}}\Big{\rangle}_{\operatorname{Tr}}
\{{\bm{V}}^{l+1}(({\bm{\alpha}}_{k},{\bm{\omega}}_{k}))\}_{k=1}^{K}
{\theta}^{K,*}_{\leftrightarrow}
(\alpha,\omega)
\gamma
(\sqrt{\gamma}\alpha,\sqrt{\gamma}\omega
k
\gamma\lambda_{k}^{2}
\gamma
f^{*}
\inf_{f}\sum_{x\in\mathcal{D}}\|f(x)-f^{*}(x)\|^{2}
f(x)
\mathcal{D}
f
f^{*}
f^{\prime}
f
f
f^{*}
f^{\prime}
f
f
f
\varepsilon
\sigma(\varepsilon{\bm{\alpha}}\cdot{\bm{x}})\simeq\sigma(0)+\sigma^{\prime}(0%
)\varepsilon{\bm{\alpha}}\cdot{\bm{x}}+\frac{1}{2}\sigma^{\prime\prime}(0)%
\varepsilon^{2}({\bm{\alpha}}\cdot{\bm{x}})^{2}+O(\varepsilon^{3})
{\bm{\alpha}}\cdot{\bm{x}}
\operatorname*{\mathbb{E}}_{{\bm{x}}\sim\mathcal{D}}[{\bm{\alpha}}\cdot{\bm{x}%
}]=0
({\bm{\alpha}}\cdot{\bm{x}})^{2}
({\bm{\alpha}}\cdot{\bm{x}})
p
p
p+1
{v_{\text{goal}}}
\text{ResNet18}_{s}
s=1/4
s=1/64
\Delta t=1
\Delta t=0.25
\text{ResNet}_{s}
\text{ResNet}_{1/4}
\text{ResNet}_{1/64}
\Delta t
\text{ResNet}_{s}
\text{ResNet}_{1/4}
\text{ResNet}_{1/64}
\Delta t
s
\Delta t
\mathcolor{black!50}{67.0\pm 0.1}
\mathcolor{black!50}{71.0\pm 0.1}
\mathcolor{black!50}{65.0\pm 0.1}
\mathcolor{black!50}{69.0\pm 0.1}
72.9
\mathcolor{black}{70.0\pm 0.2}^{\;5*}
\mathcolor{black}{\textbf{71.0}\pm\textbf{0.2}}^{\;5*}
\mathcolor{black}{67.0\pm 0.2}^{\;5*}
\mathcolor{black}{69.0\pm 0.1}^{\;5*}
\pm
\mathcolor{black!50}{66.0\pm 0.1}
\mathcolor{black!50}{68.0\pm 0.4}
\mathcolor{black!50}{45.0\pm 0.2}
\mathcolor{black!50}{57.0\pm 0.2}
0.1^{\;5*}
\mathcolor{black}{69.0\pm 0.1}^{\;5*}
\mathcolor{black}{\textbf{69.0}\pm\textbf{0.6}}^{\;5*}
\mathcolor{black}{57.0\pm 0.3}^{\;10*}
\mathcolor{black}{59.0\pm 0.1}^{\;10*}
\text{ResNet}_{1/64}
\Delta t=0.25
\mathcolor{black!50}{66.0\pm 0.1}
\mathcolor{black}{69.0\pm 0.1}^{\;5*}
5*:=5\times 50
\text{ResNet}_{1/64}
\Delta t=0.25
\mathcolor{black!50}{66.0\pm 0.1}
\mathcolor{black}{69.0\pm 0.1}^{\;5*}
5*:=5\times 50
\Delta t=1
s=1/64
\Delta t=1
s=1/64
\Delta t=1
s=1/64
\Delta t=1
s=1/64
s=1/64
\text{ResNet}_{1/64}
s=1/4
s=1/64,\Delta t=1
s=1/64,\Delta t=0.25
(\alpha_{k}^{*},\omega_{k}^{*})_{k=1}^{K}\sim\mathcal{N}(0,Id)
\theta_{\leftrightarrow}^{K}\leftarrow\gamma^{*}\theta_{\leftrightarrow}^{K}
\gamma^{*}\in\mathbb{R}
\displaystyle\gamma^{*}:=\operatorname*{arg\,min}_{\gamma\in[-L,L]}\sum_{i}%
\mathcal{L}(f_{\theta\oplus\gamma\theta_{\leftrightarrow}^{K}}({\bm{x}}_{i}),{%
\bm{y}}_{i})\hskip 42.67912pt\text{with}\;\;\gamma\theta_{\leftrightarrow}^{K^%
{*}}=(\gamma\alpha^{*}_{k},\gamma\omega^{*}_{k})_{k}^{K}
\displaystyle\gamma^{*}:=\operatorname*{arg\,min}_{\gamma\in[-L,L]}\sum_{i}%
\mathcal{L}(f_{\theta\oplus\gamma\theta_{\leftrightarrow}^{K}}({\bm{x}}_{i}),{%
\bm{y}}_{i})\hskip 42.67912pt\text{with}\;\;\gamma\theta_{\leftrightarrow}^{K^%
{*}}=(\gamma\alpha^{*}_{k},\gamma\omega^{*}_{k})_{k}^{K}
L
\text{ResNet}_{1/64}
\text{ResNet}_{18}
\text{ResNet}_{1/64}
\text{ResNet}_{18}
{\bm{v}}(X),{\bm{{v_{\text{goal}}}}}(X)
\mathcal{N}(0_{d},I_{d}\frac{1}{\sqrt{d}})
d
{\bm{{v_{\text{goal}}}}}
{\bm{v}}
\langle{\bm{V}}(X),{\bm{{V_{\text{goal}}}}}(X)\rangle:=\frac{1}{n}\sum_{i}{\bm%
{{v_{\text{goal}}}}}({\bm{x}}_{i})^{T}{\bm{v}}({\bm{x}}_{i})
\frac{1}{\sqrt{d}}
\frac{1}{\sqrt{64}}
\frac{1}{\sqrt{512}}
[0,L]
{\bm{V}}^{*}
\alpha_{k}\leftarrow 0
||\omega_{k}||=\varepsilon
\gamma^{*}
\mathcal{L}
f\in\mathcal{F}
\mathcal{L}:\;f\in\mathcal{F}\;\mapsto\;\mathcal{L}(f)=\operatorname*{\mathbb{%
E}}_{({\bm{x}},{\bm{y}})\sim\mathcal{D}}\Big{[}\ell(f({\bm{x}}),{\bm{y}})\Big{%
]}\;\in\mathbb{R}\;.
\mathcal{F}
L_{2}(\mathbb{R}^{p}\rightarrow\mathbb{R}^{d})
\mathcal{L}
f
v
D\mathcal{L}(f)(v)=\lim_{{\varepsilon}\rightarrow 0}\frac{\mathcal{L}(f+{%
\varepsilon}v)-\mathcal{L}(f)}{{\varepsilon}}
v
\mathcal{F}
f
{\varepsilon}
f+{\varepsilon}v
v\in\mathcal{F}
v
v^{*}\in\mathcal{F}
\forall v\in\mathcal{F},\;\;D\mathcal{L}(f)(v)=\langle v^{*},v\rangle\;.
v^{*}
\mathcal{L}
f
\nabla_{\!f}\mathcal{L}(f)
\langle,\rangle
L_{2}
H^{1}
\nabla_{\!f}\mathcal{L}(F)
\nabla_{\!f}^{L_{2}}\mathcal{L}(f)
\mathbb{R}^{p}
\mathbb{R}^{d}
C^{\infty}
L_{2}(\mathbb{R}^{p}\rightarrow\mathbb{R}^{d})
\mathcal{L}(f)=\operatorname*{\mathbb{E}}_{({\bm{x}},{\bm{y}})\sim\mathcal{D}}%
\Big{[}\ell(f({\bm{x}}),{\bm{y}})\Big{]}
\ell
v\in\mathcal{F}
{\varepsilon}\in\mathbb{R}
\mathcal{L}(f+{\varepsilon}v)-\mathcal{L}(f)=\operatorname*{\mathbb{E}}_{({\bm%
{x}},{\bm{y}})\sim\mathcal{D}}\Big{[}\ell(f({\bm{x}})+{\varepsilon}v({\bm{x}})%
,{\bm{y}})-\ell(f({\bm{x}}),{\bm{y}})\Big{]}
=\operatorname*{\mathbb{E}}_{({\bm{x}},{\bm{y}})\sim\mathcal{D}}\Big{[}\nabla_%
{\bm{u}}\ell({\bm{u}},{\bm{y}})\big{|}_{{\bm{u}}=f({\bm{x}})}\cdot{\varepsilon%
}v({\bm{x}})+O({\varepsilon}^{2}\|v({\bm{x}})\|^{2})\Big{]}
\ell
({\bm{u}}=f({\bm{x}}),{\bm{y}})
{\bm{u}}
\cdot
\mathbb{R}^{p}
D\mathcal{L}(f)(v)=\operatorname*{\mathbb{E}}_{({\bm{x}},{\bm{y}})\sim\mathcal%
{D}}\Big{[}\nabla_{\bm{u}}\ell({\bm{u}},{\bm{y}})\big{|}_{{\bm{u}}=f({\bm{x}})%
}\cdot v({\bm{x}})\Big{]}=\operatorname*{\mathbb{E}}_{{\bm{x}}\sim\mathcal{D}}%
\Big{[}\operatorname*{\mathbb{E}}_{{\bm{y}}\sim\mathcal{D}|{\bm{x}}}\Big{[}%
\nabla_{\bm{u}}\ell({\bm{u}},{\bm{y}})\big{|}_{{\bm{u}}=f({\bm{x}})}\Big{]}%
\cdot v({\bm{x}})\Big{]}
\langle v,v^{\prime}\rangle_{\operatorname*{\mathbb{E}}}:=\operatorname*{%
\mathbb{E}}_{{\bm{x}}\sim\mathcal{D}}\Big{[}v({\bm{x}})\cdot v^{\prime}({\bm{x%
}})\Big{]}
\nabla_{\!f}^{\operatorname*{\mathbb{E}}}\mathcal{L}(f):{\bm{x}}\mapsto%
\operatorname*{\mathbb{E}}_{{\bm{y}}\sim\mathcal{D}|{\bm{x}}}\Big{[}\nabla_{%
\bm{u}}\ell({\bm{u}},{\bm{y}})\big{|}_{{\bm{u}}=f({\bm{x}})}\Big{]}
\nabla_{\!f}^{\operatorname*{\mathbb{E}}}\mathcal{L}(f):{\bm{x}}\mapsto\nabla_%
{\bm{u}}\ell({\bm{u}},{\bm{y}}({\bm{x}}))\big{|}_{{\bm{u}}=f({\bm{x}})}
{\bm{x}}
{\bm{y}}({\bm{x}})
L_{2}(\mathbb{R}^{p}\rightarrow\mathbb{R}^{d})
\int v\cdot v^{\prime}
{\nabla_{\!f}^{L_{2}}\mathcal{L}(f):{\bm{x}}\mapsto p_{\mathcal{D}}({\bm{x}})%
\operatorname*{\mathbb{E}}_{{\bm{y}}\sim\mathcal{D}|{\bm{x}}}\Big{[}\nabla_{%
\bm{u}}\ell({\bm{u}},{\bm{y}})\big{|}_{{\bm{u}}=f({\bm{x}})}\Big{]}}
\nabla_{\!f}^{L_{2}}\mathcal{L}(f):{\bm{x}}\mapsto p_{\mathcal{D}}({\bm{x}})\,%
\nabla_{\bm{u}}\ell({\bm{u}},{\bm{y}}({\bm{x}}))\big{|}_{{\bm{u}}=f({\bm{x}})}
p_{\mathcal{D}}({\bm{x}})
{\bm{x}}
({\bm{x}},{\bm{y}})
X
\mathbb{R}
\Omega
f:X\times\Omega\xrightarrow[]{}\mathbb{R}
f(x,\omega)
\omega
x\in X
\omega\in\Omega
f_{x}
f
x
x\in X
\theta:\Omega\xrightarrow[]{}\mathbb{R}
|f_{x}(x,\omega)|\leq\theta(\omega)
x\in X
\omega\in\Omega
x\in X
\frac{d}{dx}\int_{\Omega}f(x,\omega)\,d\omega=\int_{\Omega}f_{x}(x,\omega)\,d\omega
\widetilde{\mathcal{L}}:\theta\in\Theta_{\!\mathcal{A}}\mapsto\widetilde{%
\mathcal{L}}(\theta)=\mathcal{L}(f_{\theta})\in\mathbb{R}
\cdot
\Theta_{\!\mathcal{A}}
\theta
\nabla_{\theta}\widetilde{\mathcal{L}}(\theta)
\bm{\tau}\in\Theta_{\!\mathcal{A}}
\forall\delta\theta\in\Theta_{\!\mathcal{A}},\;\;\;\;\bm{\tau}\cdot\delta%
\theta=D_{\theta}\widetilde{\mathcal{L}}(\theta)(\delta\theta)
D_{\theta}\widetilde{\mathcal{L}}(\theta)(\delta\theta)
\widetilde{\mathcal{L}}
\theta
\delta\theta
-\nabla_{\theta}\widetilde{\mathcal{L}}(\theta)
\operatorname*{arg\,min}_{\delta\theta\in\Theta_{\!\mathcal{A}}}\left\{D_{%
\theta}\widetilde{\mathcal{L}}(\theta)(\delta\theta)+\frac{1}{2}\left\|\delta%
\theta\right\|^{2}_{P}\right\}
\|\;\;\|_{P}
\delta\theta
\delta\theta
\left\|\delta\theta-\left(-\nabla_{\theta}\widetilde{\mathcal{L}}(\theta)%
\right)\right\|^{2}\;=\;\left\|\delta\theta\right\|^{2}+2\,\delta\theta\cdot%
\nabla_{\theta}\widetilde{\mathcal{L}}(\theta)+\left\|\nabla_{\theta}%
\widetilde{\mathcal{L}}(\theta)\right\|^{2}
=2\left(\frac{1}{2}\left\|\delta\theta\right\|^{2}+D_{\theta}\widetilde{%
\mathcal{L}}(\theta)(\delta\theta)\right)+K
K
\delta\theta
\delta\theta
\Theta_{\!\mathcal{A}}
\left\|\delta\theta\right\|_{P}\;:=\;\left\|\frac{\partial f_{\theta}}{%
\partial\theta}\,\delta\theta\right\|
\left\|\delta\theta\right\|
\frac{\partial f_{\theta}}{\partial\theta}\frac{\partial f_{\theta}}{\partial%
\theta}^{T}
\mathcal{L}
\bm{v}^{*}\,=\,\operatorname*{arg\,min}_{\bm{v}\in\mathcal{T}_{\!\mathcal{A}}}%
\|\bm{v}-{\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}\|^{2}\,=\,%
\operatorname*{arg\,min}_{\bm{v}\in\mathcal{T}_{\!\mathcal{A}}}\left\{D_{f}%
\mathcal{L}(f)(\bm{v})+\frac{1}{2}\|\bm{v}\|^{2}\right\}
\delta\theta^{*}\;=\;\operatorname*{arg\,min}_{\delta\theta\in\Theta_{\!%
\mathcal{A}}}\left\|\frac{\partial f_{\theta}}{\partial\theta}\,\delta\theta-{%
\color[rgb]{0,.5,.5}{\bm{{v_{\text{goal}}}}}}\right\|^{2}\;=\;\operatorname*{%
arg\,min}_{\delta\theta\in\Theta_{\!\mathcal{A}}}\left\{D_{\theta}\mathcal{L}(%
f_{\theta})(\delta\theta)+\frac{1}{2}\left\|\frac{\partial f_{\theta}}{%
\partial\theta}\,\delta\theta\right\|^{2}\right\}=:-\nabla_{\theta}^{\mathcal{%
T}_{\!\mathcal{A}}}\mathcal{L}(f_{\theta})
y={\color[rgb]{1,0,0}f_{\text{true}}}(x)=2\sin(x)+x
{\color[rgb]{0,0,1}f_{\text{predict}}}(x)=\displaystyle ax+\displaystyle b
(\displaystyle a,\displaystyle b)=(1,0)
\mathcal{L}
(x_{0},x_{1},x_{2},x_{3})=(0,\frac{\pi}{2},\pi,\frac{3\pi}{2})
\delta a,\delta b
x_{0},x_{1},x_{2}
x_{3}
\{f:x\rightarrow ax+b\hskip 7.11317pt|\hskip 7.11317pt\displaystyle a,%
\displaystyle b\in\mathbb{R}\}
x_{0},x_{1},x_{2}
x_{3}
i=0,1,2,3
\Delta f(x_{i}):=f^{t+1}(x_{i})-f^{t}(x_{i})
{\color[rgb]{0,.5,.5}\displaystyle{\bm{{v_{\text{goal}}}}}(x_{i})}:=-\nabla_{f%
(x_{i})}\mathcal{L}(f(x_{i}),y_{i})=-2(f(x_{i})-y_{i})
y_{i}=f_{\text{true}}(x_{i})
K
\theta_{\leftrightarrow}^{K}:=({\bm{\alpha}}_{k},{\bm{\omega}}_{k})_{k=1}^{K}
l-1
{\bm{a}}_{l}
{\bm{\alpha}}_{k}
{\bm{\omega}}_{k}
K
\theta_{\leftrightarrow}^{K}:=({\bm{\alpha}}_{k},{\bm{\omega}}_{k})_{k=1}^{K}
{\bm{a}}_{l}
\delta{\bm{a}}_{l}\;\;=\;\;\sum_{k=1}^{K}{\bm{\omega}}_{k}\;\sigma({\bm{b}}_{l%
-2}({\bm{x}})^{T}{\bm{\alpha}}_{k})
\alpha_{k}
\sigma^{\prime}(0)\;\sum_{k=1}^{K}{\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T%
}{\bm{\alpha}}_{k}
\|{\bm{\alpha}}_{k}\|
\sigma^{\prime}(0)
\alpha_{k}
{\bm{\omega}}_{k}
\displaystyle{\bm{v}}^{l}({\bm{x}},({\bm{\alpha}}_{k})_{k=1}^{K})=\frac{%
\partial{\bm{a}}_{l}({\bm{x}})}{\partial(\;({\bm{\alpha}}_{k})_{k=1}^{K}\;)}_{%
|({\bm{\alpha}}_{k})_{k=1}^{K}=0}({\bm{\alpha}}_{k})_{k=1}^{K}=\sum_{k=1}^{K}{%
\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
\displaystyle{\bm{v}}^{l}({\bm{x}},({\bm{\alpha}}_{k})_{k=1}^{K})=\frac{%
\partial{\bm{a}}_{l}({\bm{x}})}{\partial(\;({\bm{\alpha}}_{k})_{k=1}^{K}\;)}_{%
|({\bm{\alpha}}_{k})_{k=1}^{K}=0}({\bm{\alpha}}_{k})_{k=1}^{K}=\sum_{k=1}^{K}{%
\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
\displaystyle{\bm{v}}^{l}({\bm{x}},({\bm{\omega}}_{k})_{k=1}^{K})=\frac{%
\partial{\bm{a}}_{l}({\bm{x}})}{\partial(\;({\bm{\omega}}_{k})_{k=1}^{K}\;)}_{%
|({\bm{\omega}}_{k})_{k=1}^{K}=0}({\bm{\omega}}_{k})_{k=1}^{K}=\sum_{k=1}^{K}{%
\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
\displaystyle{\bm{v}}^{l}({\bm{x}},({\bm{\omega}}_{k})_{k=1}^{K})=\frac{%
\partial{\bm{a}}_{l}({\bm{x}})}{\partial(\;({\bm{\omega}}_{k})_{k=1}^{K}\;)}_{%
|({\bm{\omega}}_{k})_{k=1}^{K}=0}({\bm{\omega}}_{k})_{k=1}^{K}=\sum_{k=1}^{K}{%
\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
\displaystyle{\bm{v}}^{l}({\bm{x}},\theta_{\leftrightarrow}^{K})=\sum_{k=1}^{K%
}{\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
\displaystyle{\bm{v}}^{l}({\bm{x}},\theta_{\leftrightarrow}^{K})=\sum_{k=1}^{K%
}{\bm{\omega}}_{k}{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
{\bm{\alpha}}_{k}
{\bm{\omega}}_{k}
\theta_{\leftrightarrow}^{K}=({\bm{\alpha}}_{k},{\bm{\omega}}_{k})
0\times 0
\left.\frac{\partial{\bm{a}}_{l}({\bm{x}})}{\partial\theta_{\leftrightarrow}^{%
K}}\right|_{\theta_{\leftrightarrow}^{K}=0}
{\bm{b}}_{l-2}({\bm{x}})^{T}{\bm{\alpha}}_{k}
{\bm{\omega}}_{k}
{\bm{\omega}}_{k}\;{\bm{b}}_{l-2}({\bm{x}})^{T}
{\bm{a}}_{k}
{\bm{a}}_{k}
{\bm{\omega}}_{k}
{\bm{a}}_{k}
{\bm{\omega}}_{k}
{\bm{a}}_{k}
{\bm{\omega}}_{k}
({\bm{\omega}}_{k})_{k=1}^{K}
{\bm{a}}_{l}
({\bm{\alpha}}_{k})_{k=1}^{K}
\mathcal{T}_{\mathcal{A}}^{{\bm{a}}_{l}}:=\{\frac{\partial{\bm{a}}_{l}}{%
\partial({\bm{\alpha}}_{k})_{k=1}^{K}}_{|({\bm{\alpha}}_{k})_{k=1}^{K}=0}(.)({%
\bm{\alpha}}_{k})_{k=1}^{K}|({\bm{\alpha}}_{k})_{k=1}^{K}\in\big{(}\mathbb{R}^%
{|{\bm{b}}_{l-2}({\bm{x}})|}\big{)}^{K}\}
({\bm{\omega}}_{k})_{k=1}^{K}
\mathcal{T}_{\mathcal{A}}^{a_{l}}:=\mathcal{T}_{\mathcal{A}}^{a_{l}}(({\bm{%
\omega}}_{k})_{k=1}^{K})
{\bm{\omega}}_{k}
{\bm{\alpha}}_{k}
{\bm{\alpha}}_{k}
{\bm{\omega}}_{k}
({\bm{\omega}}_{k})_{k=1}^{K}
({\bm{\omega}}_{k})_{k=1}^{K}
{\bm{a}}_{l}
{\bm{b}}_{l}=\sigma({\bm{a}}_{l})
\sigma
{\bm{\omega}}_{k}
{\bm{\omega}}_{k}
{\bm{\omega}}_{k}
\sigma^{\prime}({\bm{a}}_{l})
l-1
l-1
l
t
\Omega
t\rightarrow t+1
\mathcal{L}^{t+1}\approx\mathcal{L}^{t}-||\nabla_{\theta}\mathcal{L}||^{2}-||%
\nabla_{\Omega}\mathcal{L}||^{2}
\displaystyle({\bm{\omega}}_{1}^{*},...,{\bm{\omega}}_{K}^{*}):=\Omega^{*}=%
\operatorname*{arg\,max}_{\Omega}||\nabla_{\Omega}\mathcal{L}||^{2}
\displaystyle({\bm{\omega}}_{1}^{*},...,{\bm{\omega}}_{K}^{*}):=\Omega^{*}
\displaystyle=\operatorname*{arg\,max}_{\Omega}||\nabla_{\Omega}\mathcal{L}||^%
{2}
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<c
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<c
\displaystyle=\operatorname*{arg\,max}_{\Omega}||\sum_{i}{\bm{b}}_{l-2}({\bm{x%
}}_{i}){\bm{v}^{l+1}_{\!\text{goal}}}^{T}(x_{i})\Omega||_{F}^{2}
\displaystyle=\operatorname*{arg\,max}_{\Omega}||\sum_{i}{\bm{b}}_{l-2}({\bm{x%
}}_{i}){\bm{v}^{l+1}_{\!\text{goal}}}^{T}(x_{i})\Omega||_{F}^{2}
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<c
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<c
\displaystyle:=\operatorname*{arg\,max}_{\Omega}||{\bm{B}}_{l-2}{\bm{V}^{l+1}_%
{\!\text{goal}}}^{T}\Omega||^{2}_{F}
\displaystyle:=\operatorname*{arg\,max}_{\Omega}||{\bm{B}}_{l-2}{\bm{V}^{l+1}_%
{\!\text{goal}}}^{T}\Omega||^{2}_{F}
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<c
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<c
:=\operatorname*{arg\,max}_{\Omega}\operatorname{Tr}\big{(}\Omega^{T}\tilde{{%
\bm{N}}}^{T}\tilde{{\bm{N}}}\Omega\big{)}\;\;\;\;\;s.t.\;\;||\Omega||_{F}^{2}<c
c
\displaystyle({\bm{\omega}}_{1}^{*},...,{\bm{\omega}}_{K}^{*})=\Omega^{*}=%
\operatorname*{arg\,max}_{\Omega}||\sum_{i}{\bm{b}}_{l-2}(x_{i}){\bm{{v_{\text%
{goal}}}}}_{proj}^{l+1\;T}(x_{i})\Omega||_{F}^{2}
\displaystyle({\bm{\omega}}_{1}^{*},...,{\bm{\omega}}_{K}^{*})=\Omega^{*}
\displaystyle=\operatorname*{arg\,max}_{\Omega}||\sum_{i}{\bm{b}}_{l-2}(x_{i})%
{\bm{{v_{\text{goal}}}}}_{proj}^{l+1\;T}(x_{i})\Omega||_{F}^{2}
\displaystyle s.t.\;\;||{\bm{B}}_{l-1}\Omega||_{F}^{2}<c
\displaystyle s.t.\;\;||{\bm{B}}_{l-1}\Omega||_{F}^{2}<c
\displaystyle=\operatorname*{arg\,max}_{\Omega}||{\bm{B}}_{l-2}{\bm{{V_{\text{%
goal}}}}}_{proj}^{l\;T}\Omega||_{F}^{2}
\displaystyle=\operatorname*{arg\,max}_{\Omega}||{\bm{B}}_{l-2}{\bm{{V_{\text{%
goal}}}}}_{proj}^{l\;T}\Omega||_{F}^{2}
\displaystyle s.t.\;\;||{\bm{B}}_{l-1}\Omega||_{F}^{2}<c
\displaystyle s.t.\;\;||{\bm{B}}_{l-1}\Omega||_{F}^{2}<c
\displaystyle=\operatorname*{arg\,max}_{\hat{\Omega}}\operatorname{Tr}\big{(}%
\tilde{\Omega}^{T}{\bm{S}}^{-\frac{1}{2}}{\bm{N}}^{T}{\bm{N}}{\bm{S}}^{-\frac{%
1}{2}}\tilde{\Omega}\big{)}
\displaystyle=\operatorname*{arg\,max}_{\hat{\Omega}}\operatorname{Tr}\big{(}%
\tilde{\Omega}^{T}{\bm{S}}^{-\frac{1}{2}}{\bm{N}}^{T}{\bm{N}}{\bm{S}}^{-\frac{%
1}{2}}\tilde{\Omega}\big{)}
\displaystyle s.t.\;\;||\tilde{\Omega}||_{F}^{2}<c,\;\tilde{\Omega}:={\bm{S}}^%
{\frac{1}{2}}\Omega
\displaystyle s.t.\;\;||\tilde{\Omega}||_{F}^{2}<c,\;\tilde{\Omega}:={\bm{S}}^%
{\frac{1}{2}}\Omega
\displaystyle=\operatorname*{arg\,max}_{\Omega}\operatorname{Tr}\big{(}\Omega{%
\bm{S}}^{-1}{\bm{N}}^{T}{\bm{N}}{\bm{S}}^{-1}\Omega\big{)}
\displaystyle=\operatorname*{arg\,max}_{\Omega}\operatorname{Tr}\big{(}\Omega{%
\bm{S}}^{-1}{\bm{N}}^{T}{\bm{N}}{\bm{S}}^{-1}\Omega\big{)}
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<\tilde{c}
\displaystyle s.t.\;\;||\Omega||_{F}^{2}<\tilde{c}
\tilde{{\bm{N}}}
{\bm{{V_{\text{goal}}}}}_{proj}^{l+1}
{\bm{\alpha}}_{i}={\bm{S}}^{-1}{\bm{B}}_{l-1}\mathbf{V}_{\mathbf{Z}_{l}}^{T}r_%
{i}
r_{i}
\mathbf{V}_{\mathbf{Z}_{l}}\in\mathcal{M}(|Ker({\bm{B}}_{l-1}^{T})|,|{\bm{b}}_%
{l-1}({\bm{x}})|)
{\bm{B}}_{l}
\{z\;|\;{\bm{B}}_{l}^{T}z=0\}
{\bm{\alpha}}_{i}={\bm{S}}^{-1}{\bm{B}}_{l-1}{\bm{{V_{\text{goal}}}}}_{proj}^{%
T}{\bm{v}}_{i}={\bm{S}}^{-1}{\bm{B}}_{l-1}{\bm{{V_{\text{goal}}}}}^{T}\mathbf{%
V}_{\mathbf{Z}_{l}}\mathbf{V}_{\mathbf{Z}_{l}}^{T}{\bm{v}}_{i}
{\bm{v}}_{i}
{\bm{S}}^{-\frac{1}{2}}{\bm{N}}
{\bm{v}}_{i}
r_{i}
r_{i}
{\mathbf{\delta W}_{\!l}}^{+}
{\mathbf{\delta W}_{\!l}}
\delta{{\bm{W}}_{l}^{*}}=\frac{1}{n}{\bm{{V_{\text{goal}}}}}^{l}{\bm{B}}_{l-1}%
^{T}\\
\big{(}\frac{1}{n}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T}\big{)}^{+}\;\text{and}\;{%
\bm{V}}_{0}^{l}=\frac{1}{n}{\bm{{V_{\text{goal}}}}}^{l}{\bm{B}}_{l-1}^{T}\big{%
(}\frac{1}{n}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T}\big{)}^{+}{\bm{B}}_{l-1}
g({\mathbf{\delta W}_{\!l}})=||{\bm{{V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}%
_{\!l}}{\bm{B}}_{l-1}||_{\operatorname{Tr}}^{2}
\displaystyle g({\mathbf{\delta W}_{\!l}}+{\bm{H}})=||{\bm{{V_{\text{goal}}}}}%
^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1}-{\bm{H}}{\bm{B}}_{l-1}||^{2}_{%
\operatorname{Tr}}
\displaystyle g({\mathbf{\delta W}_{\!l}}+{\bm{H}})
\displaystyle=||{\bm{{V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}%
_{l-1}-{\bm{H}}{\bm{B}}_{l-1}||^{2}_{\operatorname{Tr}}
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\langle{\bm{{V_{\text{goal}}}}}^{l%
}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1},{\bm{H}}{\bm{B}}_{l-1}\rangle_{%
\operatorname{Tr}}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\langle{\bm{{V_{\text{goal}}}}}^{l%
}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1},{\bm{H}}{\bm{B}}_{l-1}\rangle_{%
\operatorname{Tr}}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\operatorname{Tr}\big{(}\big{(}{%
\bm{{V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1}\big{)}^{T}%
{\bm{H}}{\bm{B}}_{l-1}\big{)}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\operatorname{Tr}\big{(}\big{(}{%
\bm{{V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1}\big{)}^{T}%
{\bm{H}}{\bm{B}}_{l-1}\big{)}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\operatorname{Tr}\big{(}{\bm{B}}_{%
l-1}\big{(}{\bm{{V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1%
}\big{)}^{T}{\bm{H}}\big{)}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\operatorname{Tr}\big{(}{\bm{B}}_{%
l-1}\big{(}{\bm{{V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1%
}\big{)}^{T}{\bm{H}}\big{)}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\langle\big{(}{\bm{{V_{\text{goal}%
}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1}\big{)}{\bm{B}}_{l-1}^{T},{\bm%
{H}}\rangle_{\operatorname{Tr}}+o(||{\bm{H}}||)
\displaystyle=g({\mathbf{\delta W}_{\!l}})-2\langle\big{(}{\bm{{V_{\text{goal}%
}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1}\big{)}{\bm{B}}_{l-1}^{T},{\bm%
{H}}\rangle_{\operatorname{Tr}}+o(||{\bm{H}}||)
\nabla_{{\mathbf{\delta W}_{\!l}}}g({\mathbf{\delta W}_{\!l}})=-2\big{(}{\bm{{%
V_{\text{goal}}}}}^{l}-{\mathbf{\delta W}_{\!l}}{\bm{B}}_{l-1}\big{)}{\bm{B}}_%
{l-1}^{T}
\displaystyle\nabla_{{\mathbf{\delta W}_{\!l}}}g({\mathbf{\delta W}_{\!l}})=0%
\implies{\bm{{V_{\text{goal}}}}}^{l}{\bm{B}}_{l-1}^{T}={\mathbf{\delta W}_{\!l%
}}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T}
\displaystyle\nabla_{{\mathbf{\delta W}_{\!l}}}g({\mathbf{\delta W}_{\!l}})=0%
\implies{\bm{{V_{\text{goal}}}}}^{l}{\bm{B}}_{l-1}^{T}={\mathbf{\delta W}_{\!l%
}}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T}
M^{+}
\delta{{\bm{W}}_{l}^{*}}=\frac{1}{n}{\bm{{V_{\text{goal}}}}}^{l}{\bm{B}}_{l-1}%
^{T}\big{(}\frac{1}{n}{\bm{B}}_{l-1}{\bm{B}}_{l-1}^{T}\big{)}^{+}
b_{i}^{c}
a_{l}(X_{i})\in\mathbb{R}^{k,p,p}
Conv
W
\displaystyle Conv(a_{l}(X_{i}))=B_{i}^{c}\;vect(W)
\displaystyle Conv(a_{l}(X_{i}))=B_{i}^{c}\;vect(W)
Conv
(2,2)
{\bm{b}}_{i}^{k}=\begin{pmatrix}b_{i}^{1,k}&b_{i}^{2,k}&.&b_{i}^{p,k}\\
b_{i}^{p+1,k}&b_{i}^{p+2,k}&.&b_{i}^{2p,k}\\
.&.&.&.\\
b_{i}^{p(p-1)+1,k}&.&.&b_{i}^{p^{2},k}\end{pmatrix}
\displaystyle{\bm{B}}^{c}_{i}=\begin{pmatrix}b_{i}^{1,1}&b_{i}^{2,1}&b_{i}^{p+%
1,1}&b_{i}^{p+2,1}&b_{i}^{1,2}&b_{i}^{2,2}&b_{i}^{p+1,2}&b_{i}^{p+2,2}&b_{i}^{%
1,3}&.\\
b_{i}^{2,1}&b_{i}^{3,1}&b_{i}^{p+2,1}&b_{i}^{p+3,1}&b_{i}^{2,2}&b_{i}^{3,2}&b_%
{i}^{p+2,2}&b_{i}^{p+3,2}&b_{i}^{2,3}&.\\
.&.&.&.&.&.&.&.&.&.\end{pmatrix}
\displaystyle{\bm{B}}^{c}_{i}
\displaystyle=\begin{pmatrix}b_{i}^{1,1}&b_{i}^{2,1}&b_{i}^{p+1,1}&b_{i}^{p+2,%
1}&b_{i}^{1,2}&b_{i}^{2,2}&b_{i}^{p+1,2}&b_{i}^{p+2,2}&b_{i}^{1,3}&.\\
b_{i}^{2,1}&b_{i}^{3,1}&b_{i}^{p+2,1}&b_{i}^{p+3,1}&b_{i}^{2,2}&b_{i}^{3,2}&b_%
{i}^{p+2,2}&b_{i}^{p+3,2}&b_{i}^{2,3}&.\\
.&.&.&.&.&.&.&.&.&.\end{pmatrix}
\displaystyle g({\mathbf{\delta W}_{\!l}})=||{\bm{{V_{\text{goal}}}}}^{l}-{\bm%
{B}}^{c}{\mathbf{\delta W}_{\!l}}||_{\operatorname{Tr}}^{2}
\displaystyle g({\mathbf{\delta W}_{\!l}})=||{\bm{{V_{\text{goal}}}}}^{l}-{\bm%
{B}}^{c}{\mathbf{\delta W}_{\!l}}||_{\operatorname{Tr}}^{2}
{\bm{B}}^{c}:=\begin{pmatrix}{\bm{B}}^{c}_{1}&...&{\bm{B}}^{c}_{n}\end{pmatrix}
{\bm{N}}:=\frac{1}{n}{\bm{B}}_{l-2}\big{(}{\color[rgb]{0,.5,.5}{\bm{{V_{\text{%
goal}}}}}_{proj}^{l}}\big{)}^{T}
{\bm{S}}:=\frac{1}{n}{\bm{B}}_{l-2}{\bm{B}}_{l-2}^{T}
{\bm{S}}={\bm{U}}\Sigma{\bm{U}}^{T}
S^{-\frac{1}{2}}:={\bm{U}}\sqrt{\Sigma}^{-1}{\bm{U}}^{T}
S^{-\frac{1}{2}}{\bm{N}}=\sum_{k=1}^{R}\lambda_{k}{\bm{u}}_{k}{\bm{v}}_{k}^{T}
\lambda_{1}\geq...\geq\lambda_{R}\geq 0
R
{\bm{N}}
K^{*}=R
({{\bm{\alpha}}}_{k}^{*},{{\bm{\omega}}}_{k}^{*})=(sign(\lambda_{k})\sqrt{%
\lambda_{k}}S^{-\frac{1}{2}}{\bm{u}}_{k},\sqrt{\lambda_{k}}{\bm{v}}_{k})
k=1,...,R
K\leqslant R
{\theta}^{K,*}_{\leftrightarrow}
\eta
K
\lambda_{k}
\displaystyle\Psi^{l}_{\theta\oplus{\theta}^{K,*}_{\leftrightarrow}}=\Psi^{l}_%
{\theta}-{\color[rgb]{1,0,0}\sum_{k=1}^{K}\lambda_{k}^{2}}
\displaystyle\Psi^{l}_{\theta\oplus{\theta}^{K,*}_{\leftrightarrow}}=\Psi^{l}_%
{\theta}-{\color[rgb]{1,0,0}\sum_{k=1}^{K}\lambda_{k}^{2}}
\displaystyle\mathcal{L}(f_{\theta\oplus{\theta}^{K,*}_{\leftrightarrow}})=%
\mathcal{L}(f_{\theta})+\frac{\sigma_{l}^{\prime}(0)}{\eta}{\color[rgb]{1,0,0}%
\sum_{k=1}^{K}\lambda_{k}^{2}}+o(||{\theta}^{K,*}_{\leftrightarrow}||^{2})
\displaystyle\mathcal{L}(f_{\theta\oplus{\theta}^{K,*}_{\leftrightarrow}})=%
\mathcal{L}(f_{\theta})+\frac{\sigma_{l}^{\prime}(0)}{\eta}{\color[rgb]{1,0,0}%
\sum_{k=1}^{K}\lambda_{k}^{2}}+o(||{\theta}^{K,*}_{\leftrightarrow}||^{2})
n_{1},...,n_{K}
n_{i}:=({\bm{\alpha}}_{i},{\bm{\omega}}_{i})
\operatorname*{arg\,min}_{\delta{\bm{W}}_{l},\delta\theta_{l-1\leftrightarrow l%
}^{K}}\big{|}\big{|}\overbrace{{\bm{V}^{l}_{\!\text{goal}}}-{\color[rgb]{%
.75,0,.25}\delta{\bm{W}}_{l}{\bm{B}}_{l-1}}}^{{\bm{V}^{l}_{\!\text{goal}}}_{%
proj}}-{\color[rgb]{1,0,0}\bm{\Omega}{\bm{A}}^{T}{\bm{B}}_{l-2}}\big{|}\big{|}%
^{2}_{\operatorname{Tr}}
\text{where }\bm{\Omega}:=\begin{pmatrix}{\bm{\omega}}_{1}&...&{\bm{\omega}}_{%
K}\end{pmatrix}\;\;\text{and}\;\;{\bm{A}}:=\begin{pmatrix}{\bm{\alpha}}_{1}&..%
.&{\bm{\alpha}}_{K}\end{pmatrix}
\operatorname*{arg\,min}_{{\bm{C}}=\bm{\Omega}{\bm{A}}^{T}}\big{|}\big{|}%
\overbrace{{\bm{V}^{l}_{\!\text{goal}}}-{\color[rgb]{.75,0,.25}\delta{\bm{W}}_%
{l}{\bm{B}}_{l-1}}}^{{\bm{V}^{l}_{\!\text{goal}}}_{proj}}-{\color[rgb]{1,0,0}{%
\bm{C}}{\bm{B}}_{l-2}}\big{|}\big{|}^{2}_{\operatorname{Tr}}
{\bm{C}}^{*}={\bm{S}}^{+}{\bm{N}}
R=rank({\bm{S}}^{+}{\bm{N}})
({\bm{\alpha}}_{k},{\bm{\omega}}_{k})_{1,...,K}
\bm{\Omega}{\bm{A}}^{T}=\sum_{k}{\bm{\omega}}_{k}\alpha_{k}^{T}={\bm{S}}^{+}{%
\bm{N}}
K<R
\displaystyle\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\Big{\{}%
\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{%
\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}=\operatorname*{arg\,min}_{%
{\theta}^{K}_{\leftrightarrow}}\Big{\{}-\frac{2}{n}\Big{\langle}{\bm{{V_{\text%
{goal}}}}}_{proj}^{l},{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})\Big{\rangle%
}_{\operatorname{Tr}}+\frac{1}{n}||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow}%
)||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\Big{\{}%
\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{%
\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\Big{\{%
}-\frac{2}{n}\Big{\langle}{\bm{{V_{\text{goal}}}}}_{proj}^{l},{\bm{V}}^{l}({%
\theta}^{K}_{\leftrightarrow})\Big{\rangle}_{\operatorname{Tr}}+\frac{1}{n}||{%
\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\frac{1%
}{n}g({\theta}^{K}_{\leftrightarrow})
\displaystyle=\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\frac{1%
}{n}g({\theta}^{K}_{\leftrightarrow})
\displaystyle\frac{1}{n}g({\theta}^{K}_{\leftrightarrow})=-\frac{2}{n}\sum_{i}%
^{n}\sum_{k}{\bm{{v_{\text{goal}}}}}_{proj}^{l}({\bm{x}}_{i})^{T}\Big{(}{\bm{%
\alpha}}_{k}^{T}{\bm{b}}_{l-2}({\bm{x}}_{i})\Big{)}{\bm{\omega}}_{k}
\displaystyle\frac{1}{n}g({\theta}^{K}_{\leftrightarrow})
\displaystyle=-\frac{2}{n}\sum_{i}^{n}\sum_{k}{\bm{{v_{\text{goal}}}}}_{proj}^%
{l}({\bm{x}}_{i})^{T}\Big{(}{\bm{\alpha}}_{k}^{T}{\bm{b}}_{l-2}({\bm{x}}_{i})%
\Big{)}{\bm{\omega}}_{k}
\displaystyle\hskip 85.35826pt+\frac{1}{n}\sum_{k,j}^{K}\sum_{i}^{n}\Big{(}{%
\bm{\alpha}}_{k}^{T}{\bm{b}}_{l-2}({\bm{x}}_{i})\Big{)}{\bm{\omega}}_{k}^{T}{%
\bm{\omega}}_{j}\Big{(}{\bm{\alpha}}_{j}^{T}{\bm{b}}_{l-2}({\bm{x}}_{i})\Big{)}
\displaystyle\hskip 85.35826pt+\frac{1}{n}\sum_{k,j}^{K}\sum_{i}^{n}\Big{(}{%
\bm{\alpha}}_{k}^{T}{\bm{b}}_{l-2}({\bm{x}}_{i})\Big{)}{\bm{\omega}}_{k}^{T}{%
\bm{\omega}}_{j}\Big{(}{\bm{\alpha}}_{j}^{T}{\bm{b}}_{l-2}({\bm{x}}_{i})\Big{)}
\displaystyle=-2\sum_{k}^{K}{\bm{\alpha}}_{k}^{T}\Big{(}\frac{1}{n}\sum_{i}^{n%
}{\bm{b}}_{l-2}({\bm{x}}_{i}){\bm{{v_{\text{goal}}}}}_{proj}^{l}({\bm{x}}_{i})%
^{T}\Big{)}{\bm{\omega}}_{k}
\displaystyle=-2\sum_{k}^{K}{\bm{\alpha}}_{k}^{T}\Big{(}\frac{1}{n}\sum_{i}^{n%
}{\bm{b}}_{l-2}({\bm{x}}_{i}){\bm{{v_{\text{goal}}}}}_{proj}^{l}({\bm{x}}_{i})%
^{T}\Big{)}{\bm{\omega}}_{k}
\displaystyle\hskip 85.35826pt+\sum_{k,j}^{K}{\bm{\omega}}_{k}^{T}{\bm{\omega}%
}_{j}{\bm{\alpha}}_{k}^{T}\Big{(}\frac{1}{n}\sum_{i}^{n}{\bm{b}}_{l-2}({\bm{x}%
}_{i}){\bm{b}}_{l-2}({\bm{x}}_{i})^{T}\Big{)}{\bm{\alpha}}_{j}
\displaystyle\hskip 85.35826pt+\sum_{k,j}^{K}{\bm{\omega}}_{k}^{T}{\bm{\omega}%
}_{j}{\bm{\alpha}}_{k}^{T}\Big{(}\frac{1}{n}\sum_{i}^{n}{\bm{b}}_{l-2}({\bm{x}%
}_{i}){\bm{b}}_{l-2}({\bm{x}}_{i})^{T}\Big{)}{\bm{\alpha}}_{j}
\displaystyle=-2\sum_{k}^{K}{\bm{\alpha}}_{k}^{T}{\bm{N}}{\bm{\omega}}_{k}+%
\sum_{k,j}^{K}{\bm{\omega}}_{k}^{T}{\bm{\omega}}_{j}{\bm{\alpha}}_{k}^{T}{\bm{%
S}}{\bm{\alpha}}_{j}
\displaystyle=-2\sum_{k}^{K}{\bm{\alpha}}_{k}^{T}{\bm{N}}{\bm{\omega}}_{k}+%
\sum_{k,j}^{K}{\bm{\omega}}_{k}^{T}{\bm{\omega}}_{j}{\bm{\alpha}}_{k}^{T}{\bm{%
S}}{\bm{\alpha}}_{j}
{\bm{N}}:=\frac{1}{n}{\bm{B}}_{l-2}\big{(}{\bm{{V_{\text{goal}}}}}_{proj}^{l}%
\big{)}^{T}
{\bm{S}}:=\frac{1}{n}{\bm{B}}_{l-2}{\bm{B}}_{l-2}^{T}
{\bm{S}}={\bm{U}}\Sigma{\bm{U}}^{T}
{\bm{S}}^{\frac{1}{2}}:={\bm{U}}\sqrt{\Sigma}{\bm{U}}
{\bm{S}}^{-\frac{1}{2}}:={\bm{U}}\sqrt{\Sigma}^{-1}{\bm{U}}^{T}
{\bm{S}}^{-\frac{1}{2}}{\bm{N}}=\sum_{r=1}^{R}\lambda_{r}{\bm{v}}_{r}{\bm{e}}_%
{r}^{T}
{\bm{\beta}}_{k}:={{\bm{S}}^{\frac{1}{2}}}{\bm{\alpha}}_{k}
\displaystyle-\sum_{k=1}^{K}{\bm{\alpha}}_{k}^{T}N{\bm{\omega}}_{k}=-\sum_{k}{%
\bm{\beta}}_{k}^{T}{\bm{S}}^{-\frac{1}{2}}N{\bm{\omega}}_{k}
\displaystyle-\sum_{k=1}^{K}{\bm{\alpha}}_{k}^{T}N{\bm{\omega}}_{k}
\displaystyle=-\sum_{k}{\bm{\beta}}_{k}^{T}{\bm{S}}^{-\frac{1}{2}}N{\bm{\omega%
}}_{k}
\displaystyle=-\operatorname{Tr}\Big{(}\sum_{k}\sum_{r}\lambda_{r}\Big{(}{\bm{%
\beta}}_{k}^{T}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{)}{\bm{\omega}}_{k}\Big{)}
\displaystyle=-\operatorname{Tr}\Big{(}\sum_{k}\sum_{r}\lambda_{r}\Big{(}{\bm{%
\beta}}_{k}^{T}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{)}{\bm{\omega}}_{k}\Big{)}
\operatorname{Tr}(AB)=\operatorname{Tr}(BA)
\displaystyle-\sum_{k=1}^{K}{\bm{\alpha}}_{k}^{T}N{\bm{\omega}}_{k}=-%
\operatorname{Tr}\Big{(}\sum_{k}\sum_{r}\lambda_{r}{\bm{\omega}}_{k}{\bm{\beta%
}}_{k}^{T}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{)}
\displaystyle-\sum_{k=1}^{K}{\bm{\alpha}}_{k}^{T}N{\bm{\omega}}_{k}
\displaystyle=-\operatorname{Tr}\Big{(}\sum_{k}\sum_{r}\lambda_{r}{\bm{\omega}%
}_{k}{\bm{\beta}}_{k}^{T}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{)}
\displaystyle=-\operatorname{Tr}\Big{(}\sum_{k}{\bm{\omega}}_{k}{\bm{\beta}}_{%
k}^{T}\sum_{r}\lambda_{r}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{)}
\displaystyle=-\operatorname{Tr}\Big{(}\sum_{k}{\bm{\omega}}_{k}{\bm{\beta}}_{%
k}^{T}\sum_{r}\lambda_{r}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{)}
\displaystyle=-\Big{\langle}\sum_{k}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T},\sum%
_{r}\lambda_{r}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{\rangle}_{\operatorname{Tr}}\;%
\text{with}\;\langle{\bm{A}},{\bm{B}}\rangle_{\operatorname{Tr}}=\operatorname%
{Tr}({\bm{A}}^{T}{\bm{B}})
\displaystyle=-\Big{\langle}\sum_{k}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T},\sum%
_{r}\lambda_{r}{\bm{v}}_{r}{\bm{e}}_{r}^{T}\Big{\rangle}_{\operatorname{Tr}}\;%
\text{with}\;\langle{\bm{A}},{\bm{B}}\rangle_{\operatorname{Tr}}=\operatorname%
{Tr}({\bm{A}}^{T}{\bm{B}})
\displaystyle\sum_{k,j}^{K}{\bm{\omega}}_{k}^{T}{\bm{\omega}}_{j}{\bm{\alpha}}%
_{k}^{T}S{\bm{\alpha}}_{j}=\sum_{k,j}\Big{(}{\bm{\omega}}_{k}^{T}{\bm{\omega}}%
_{j}\Big{)}\Big{(}{\bm{\beta}}_{j}^{T}{\bm{\beta}}_{k}\Big{)}
\displaystyle\sum_{k,j}^{K}{\bm{\omega}}_{k}^{T}{\bm{\omega}}_{j}{\bm{\alpha}}%
_{k}^{T}S{\bm{\alpha}}_{j}
\displaystyle=\sum_{k,j}\Big{(}{\bm{\omega}}_{k}^{T}{\bm{\omega}}_{j}\Big{)}%
\Big{(}{\bm{\beta}}_{j}^{T}{\bm{\beta}}_{k}\Big{)}
\displaystyle=\operatorname{Tr}\Big{(}\sum_{k,j}\Big{(}({\bm{\omega}}_{k}^{T}{%
\bm{\omega}}_{j}){\bm{\beta}}_{j}^{T}\Big{)}{\bm{\beta}}_{k}\Big{)}\Big{)}
\displaystyle=\operatorname{Tr}\Big{(}\sum_{k,j}\Big{(}({\bm{\omega}}_{k}^{T}{%
\bm{\omega}}_{j}){\bm{\beta}}_{j}^{T}\Big{)}{\bm{\beta}}_{k}\Big{)}\Big{)}
\displaystyle=\operatorname{Tr}(\Big{(}\sum_{k,j}{\bm{\beta}}_{k}{\bm{\omega}}%
_{k}^{T}{\bm{\omega}}_{j}{\bm{\beta}}_{j}^{T}\Big{)}
\displaystyle=\operatorname{Tr}(\Big{(}\sum_{k,j}{\bm{\beta}}_{k}{\bm{\omega}}%
_{k}^{T}{\bm{\omega}}_{j}{\bm{\beta}}_{j}^{T}\Big{)}
\displaystyle=||\sum_{k}{\bm{\omega}}_{k}{\bm{\beta}}_{k}^{T}||_{\operatorname%
{Tr}}^{2}\;\;\text{with}\;||{\bm{A}}||_{\operatorname{Tr}}=\sqrt{\operatorname%
{Tr}({\bm{A}}^{T}{\bm{A}})}
\displaystyle=||\sum_{k}{\bm{\omega}}_{k}{\bm{\beta}}_{k}^{T}||_{\operatorname%
{Tr}}^{2}\;\;\text{with}\;||{\bm{A}}||_{\operatorname{Tr}}=\sqrt{\operatorname%
{Tr}({\bm{A}}^{T}{\bm{A}})}
\displaystyle=||\sum_{k}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}||_{\operatorname%
{Tr}}^{2}
\displaystyle=||\sum_{k}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}||_{\operatorname%
{Tr}}^{2}
\displaystyle\underset{K,{\theta}_{\leftrightarrow}}{\operatorname*{arg\,min}}%
\;\;\frac{1}{n}g({\bm{\alpha}},{\bm{\omega}})\;\;=\operatorname*{arg\,min}_{K,%
{\bm{\alpha}}={{\bm{S}}^{-1/2}}{\bm{\gamma}},{\bm{\omega}}}\left\|{\bm{S}}^{-1%
/2}{\bm{N}}-\sum_{k=1}^{K}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}\right\|_{%
\operatorname{Tr}}^{2}
\displaystyle\underset{K,{\theta}_{\leftrightarrow}}{\operatorname*{arg\,min}}%
\;\;\frac{1}{n}g({\bm{\alpha}},{\bm{\omega}})\;\;
\displaystyle=\operatorname*{arg\,min}_{K,{\bm{\alpha}}={{\bm{S}}^{-1/2}}{\bm{%
\gamma}},{\bm{\omega}}}\left\|{\bm{S}}^{-1/2}{\bm{N}}-\sum_{k=1}^{K}{\bm{\beta%
}}_{k}{\bm{\omega}}_{k}^{T}\right\|_{\operatorname{Tr}}^{2}
K\leq R:=\text{rank}({\bm{S}}^{-1/2}{\bm{N}})
\sum_{k=1}^{K}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}=\sum_{r=1}^{K}\lambda_{r}{%
\bm{v}}_{r}{\bm{e}}_{r}^{T}
\sum_{k}^{R}{\bm{\omega}}_{k}{\bm{\alpha}}_{k}^{T}={\bm{S}}^{-1/2}\sum_{k}^{R}%
\lambda_{k}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}={\bm{S}}^{-1}{\bm{N}}
{\bm{S}}^{-1/2}{\bm{N}}
\textbf{for}\;k\neq j,\;\;\;\;\langle{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T},{%
\bm{\beta}}_{j}{\bm{\omega}}_{j}^{T}\rangle_{\operatorname{Tr}}=0
\displaystyle||{\bm{S}}^{-1/2}{\bm{N}}-\sum_{k=1}^{K}{\bm{\beta}}_{k}{\bm{%
\omega}}_{k}^{T}||_{\operatorname{Tr}}^{2}=\sum_{r=K+1}^{R}\lambda_{r}^{2}
\displaystyle||{\bm{S}}^{-1/2}{\bm{N}}-\sum_{k=1}^{K}{\bm{\beta}}_{k}{\bm{%
\omega}}_{k}^{T}||_{\operatorname{Tr}}^{2}
\displaystyle=\sum_{r=K+1}^{R}\lambda_{r}^{2}
\displaystyle=||{\bm{S}}^{-1/2}{\bm{N}}||_{\operatorname{Tr}}^{2}-||\sum_{k=1}%
^{K}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}||_{\operatorname{Tr}}^{2}
\displaystyle=||{\bm{S}}^{-1/2}{\bm{N}}||_{\operatorname{Tr}}^{2}-||\sum_{k=1}%
^{K}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}||_{\operatorname{Tr}}^{2}
\displaystyle\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}({\theta%
}_{\leftrightarrow}^{K,*})||^{2}_{\operatorname{Tr}}=\frac{1}{n}||{\bm{{V_{%
\text{goal}}}}}_{proj}^{l}||^{2}_{\operatorname{Tr}}+||{\bm{S}}^{-\frac{1}{2}}%
{\bm{N}}-\sum_{k}{\bm{\beta}}_{k}{\bm{\omega}}_{k}^{T}||^{2}-||{\bm{S}}^{-%
\frac{1}{2}}{\bm{N}}||^{2}_{\operatorname{Tr}}
\displaystyle\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}({\theta%
}_{\leftrightarrow}^{K,*})||^{2}_{\operatorname{Tr}}
\displaystyle=\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}||^{2}_{%
\operatorname{Tr}}+||{\bm{S}}^{-\frac{1}{2}}{\bm{N}}-\sum_{k}{\bm{\beta}}_{k}{%
\bm{\omega}}_{k}^{T}||^{2}-||{\bm{S}}^{-\frac{1}{2}}{\bm{N}}||^{2}_{%
\operatorname{Tr}}
\displaystyle=\sum_{r=K+1}^{R}\lambda_{r}^{2}+\frac{1}{n}||{\bm{{V_{\text{goal%
}}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}-||{\bm{S}}^{-\frac{1}{2}}{\bm{N}}||%
_{\operatorname{Tr}}^{2}
\displaystyle=\sum_{r=K+1}^{R}\lambda_{r}^{2}+\frac{1}{n}||{\bm{{V_{\text{goal%
}}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}-||{\bm{S}}^{-\frac{1}{2}}{\bm{N}}||%
_{\operatorname{Tr}}^{2}
\displaystyle=-\sum_{r=1}^{K}\lambda_{r}^{2}+\frac{1}{n}||{\bm{{V_{\text{goal}%
}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}
\displaystyle=-\sum_{r=1}^{K}\lambda_{r}^{2}+\frac{1}{n}||{\bm{{V_{\text{goal}%
}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}
{\bm{{V_{\text{goal}}}}}_{proj}^{l}(\delta{\bm{W}}_{l}^{*}):={\bm{{V_{\text{%
goal}}}}}_{proj}^{l}
{\bm{B}}_{l-1}
{\bm{B}}_{l-2}
\displaystyle\mathcal{L}(f_{\theta\oplus\theta_{\leftrightarrow}^{K}})=\frac{1%
}{n}\sum_{i=1}^{n}L(f_{\theta}({\bm{x}}_{i}),{\bm{y}}_{i})-\frac{\gamma}{\eta}%
\frac{1}{n}\sigma_{l}^{\prime}(0)\Big{\langle}{\bm{V}}^{l}(\theta_{%
\leftrightarrow}^{K,*}),{\bm{{V_{\text{goal}}}}}_{proj}^{l}\Big{\rangle}_{%
\operatorname{Tr}}+o(1)
\displaystyle\mathcal{L}(f_{\theta\oplus\theta_{\leftrightarrow}^{K}})=\frac{1%
}{n}\sum_{i=1}^{n}L(f_{\theta}({\bm{x}}_{i}),{\bm{y}}_{i})-\frac{\gamma}{\eta}%
\frac{1}{n}\sigma_{l}^{\prime}(0)\Big{\langle}{\bm{V}}^{l}(\theta_{%
\leftrightarrow}^{K,*}),{\bm{{V_{\text{goal}}}}}_{proj}^{l}\Big{\rangle}_{%
\operatorname{Tr}}+o(1)
\displaystyle\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\Big{\{}%
\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{%
\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle\operatorname*{arg\,min}_{{\theta}^{K}_{\leftrightarrow}}\Big{\{}%
\frac{1}{n}||{\bm{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{%
\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}=H}\Big{\{}\frac{1}{n}||{\bm{{V_{\text{goal}}}}}^{l}_{proj%
}-{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}=H}\Big{\{}\frac{1}{n}||{\bm{{V_{\text{goal}}}}}^{l}_{proj%
}-{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}=H}\Big{\{}-\frac{2}{n}\Big{\langle}{\bm{{V_{\text{goal}}}%
}}^{l}_{proj},{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})\Big{\rangle}_{%
\operatorname{Tr}}+\frac{1}{n}||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}=H}\Big{\{}-\frac{2}{n}\Big{\langle}{\bm{{V_{\text{goal}}}%
}}^{l}_{proj},{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})\Big{\rangle}_{%
\operatorname{Tr}}+\frac{1}{n}||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}=H}\Big{\{}-\frac{2}{n}\Big{\langle}{\bm{{V_{\text{goal}}}%
}}^{l}_{proj},{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})\Big{\rangle}_{%
\operatorname{Tr}}+\frac{1}{n}H^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})||%
_{\operatorname{Tr}}=H}\Big{\{}-\frac{2}{n}\Big{\langle}{\bm{{V_{\text{goal}}}%
}}^{l}_{proj},{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})\Big{\rangle}_{%
\operatorname{Tr}}+\frac{1}{n}H^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow})^%
{*}||_{\operatorname{Tr}}=1}\Big{\{}-H\Big{\langle}{\bm{{V_{\text{goal}}}}}^{l%
}_{proj},{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow})^{*}\Big{\rangle}_{%
\operatorname{Tr}}+\frac{1}{2}H^{2}\Big{\}}
\displaystyle=\operatorname*{arg\,min}_{H\geq 0}\operatorname*{arg\,min}_{{%
\theta}^{K}_{\leftrightarrow},||{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow})^%
{*}||_{\operatorname{Tr}}=1}\Big{\{}-H\Big{\langle}{\bm{{V_{\text{goal}}}}}^{l%
}_{proj},{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow})^{*}\Big{\rangle}_{%
\operatorname{Tr}}+\frac{1}{2}H^{2}\Big{\}}
{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})^{*}
\operatorname*{arg\,min}
H=1
\displaystyle H^{*}=\Big{\langle}{\bm{{V_{\text{goal}}}}}^{l}_{proj},{\bm{V}}^%
{l}({\theta}^{K}_{\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr}}
\displaystyle H^{*}
\displaystyle=\Big{\langle}{\bm{{V_{\text{goal}}}}}^{l}_{proj},{\bm{V}}^{l}({%
\theta}^{K}_{\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr}}
\displaystyle\min_{{\theta}^{K}_{l\leftrightarrow l}}\Big{\{}\frac{1}{n}||{\bm%
{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow l}%
)||_{\operatorname{Tr}}^{2}\Big{\}}=-\sum_{r=1}^{K}\lambda_{r}^{2}+\frac{1}{n}%
||{\bm{{V_{\text{goal}}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}
\displaystyle\min_{{\theta}^{K}_{l\leftrightarrow l}}\Big{\{}\frac{1}{n}||{\bm%
{{V_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow l}%
)||_{\operatorname{Tr}}^{2}\Big{\}}=-\sum_{r=1}^{K}\lambda_{r}^{2}+\frac{1}{n}%
||{\bm{{V_{\text{goal}}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}
\displaystyle\min_{{\theta}^{K}_{\leftrightarrow}}\Big{\{}\frac{1}{n}||{\bm{{V%
_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow l})||%
_{\operatorname{Tr}}^{2}\Big{\}}=-\frac{1}{n}H^{*^{2}}+\frac{1}{n}||{\bm{{V_{%
\text{goal}}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}
\displaystyle\min_{{\theta}^{K}_{\leftrightarrow}}\Big{\{}\frac{1}{n}||{\bm{{V%
_{\text{goal}}}}}_{proj}^{l}-{\bm{V}}^{l}({\theta}^{K}_{l\leftrightarrow l})||%
_{\operatorname{Tr}}^{2}\Big{\}}=-\frac{1}{n}H^{*^{2}}+\frac{1}{n}||{\bm{{V_{%
\text{goal}}}}}^{l}_{proj}||_{\operatorname{Tr}}^{2}
\displaystyle\implies H^{*}=\Big{\langle}{\bm{{V_{\text{goal}}}}}^{l}_{proj},{%
\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr%
}}=\sqrt{\sum_{r=1}^{K}\lambda_{r}^{2}}\times\sqrt{n}
\displaystyle\implies H^{*}=\Big{\langle}{\bm{{V_{\text{goal}}}}}^{l}_{proj},{%
\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr%
}}=\sqrt{\sum_{r=1}^{K}\lambda_{r}^{2}}\times\sqrt{n}
\displaystyle{\bm{V}}^{l}({\theta}_{\leftrightarrow}^{K,*})=H^{*}{\bm{V}}^{l}(%
{\theta}^{K}_{\leftrightarrow})^{*}
\displaystyle{\bm{V}}^{l}({\theta}_{\leftrightarrow}^{K,*})=H^{*}{\bm{V}}^{l}(%
{\theta}^{K}_{\leftrightarrow})^{*}
\displaystyle\Big{\langle}{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K,*}),{\bm{{V%
_{\text{goal}}}}}_{proj}^{l}\Big{\rangle}_{\operatorname{Tr}}=H^{*}\times\Big{%
\langle}{\bm{{V_{\text{goal}}}}}^{l}_{proj},{\bm{V}}^{l}({\theta}^{K}_{%
\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr}}={H^{*}}^{2}
\displaystyle\Big{\langle}{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K,*}),{\bm{{V%
_{\text{goal}}}}}_{proj}^{l}\Big{\rangle}_{\operatorname{Tr}}=H^{*}\times\Big{%
\langle}{\bm{{V_{\text{goal}}}}}^{l}_{proj},{\bm{V}}^{l}({\theta}^{K}_{%
\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr}}={H^{*}}^{2}
||{\bm{S}}^{-\frac{1}{2}}{\bm{N}}-\sum_{k=1}^{K}{\bm{u}}_{k}{\bm{\omega}}_{k}^%
{T}||_{\operatorname{Tr}}^{2}
-\Big{\langle}{\bm{{V_{\text{goal}}}}}_{proj}^{l}(\delta{\bm{W}}_{l}^{*}),{\bm%
{V}}^{l}({\theta}^{K}_{\leftrightarrow})^{*}\Big{\rangle}_{\operatorname{Tr}}
{\bm{V}}^{l}({\theta}^{K}_{\leftrightarrow})
||{\bm{{V_{\text{goal}}}}}_{proj}^{l}(\delta{\bm{W}}_{l}^{*})-{\bm{V}}^{l}({%
\theta}^{K}_{\leftrightarrow})||_{\operatorname{Tr}}^{2}
\displaystyle\mathcal{L}(f_{\theta\oplus\theta_{\leftrightarrow}^{K}})=\frac{1%
}{n}\sum_{i=1}^{n}\mathcal{L}(f_{\theta}({\bm{x}}_{i}),{\bm{y}}_{i})-\frac{1}{%
\eta}\sigma_{l}^{\prime}(0)\sum_{r=1}^{K}\lambda_{k}^{2}+o(1)
\displaystyle\mathcal{L}(f_{\theta\oplus\theta_{\leftrightarrow}^{K}})=\frac{1%
}{n}\sum_{i=1}^{n}\mathcal{L}(f_{\theta}({\bm{x}}_{i}),{\bm{y}}_{i})-\frac{1}{%
\eta}\sigma_{l}^{\prime}(0)\sum_{r=1}^{K}\lambda_{k}^{2}+o(1)
K=1
{\bm{B}}^{c}_{i}
{\bm{T}}_{j}
j-
\displaystyle g(\theta_{\leftrightarrow}^{1})=\sum_{m}^{\text{out channels}}%
\sum_{i}^{\text{examples}}\sum_{j=1}^{\text{preactivity size}}({\bm{\omega}}_{%
m}^{T}{\bm{T}}_{j}{\bm{B}}^{c}{\bm{\alpha}}-{\bm{{V_{\text{goal}}}}}_{j,m}^{i}%
)^{2}
\displaystyle g(\theta_{\leftrightarrow}^{1})
\displaystyle=\sum_{m}^{\text{out channels}}\sum_{i}^{\text{examples}}\sum_{j=%
1}^{\text{preactivity size}}({\bm{\omega}}_{m}^{T}{\bm{T}}_{j}{\bm{B}}^{c}{\bm%
{\alpha}}-{\bm{{V_{\text{goal}}}}}_{j,m}^{i})^{2}
\displaystyle=\sum_{m}\sum_{i}\sum_{j=1}({\bm{\omega}}_{m}^{T}{\bm{T}}_{j}{\bm%
{B}}^{c}_{i}{\bm{\alpha}})^{2}-2{\bm{\omega}}_{m}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_%
{i}{\bm{\alpha}}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}+C
\displaystyle=\sum_{m}\sum_{i}\sum_{j=1}({\bm{\omega}}_{m}^{T}{\bm{T}}_{j}{\bm%
{B}}^{c}_{i}{\bm{\alpha}})^{2}-2{\bm{\omega}}_{m}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_%
{i}{\bm{\alpha}}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}+C
\displaystyle=\sum_{m}\sum_{i}\sum_{j=1}\operatorname{Tr}({\bm{\omega}}_{m}^{T%
}{\bm{T}}_{j}{\bm{B}}^{c}_{i}{\bm{\alpha}})^{2}-2{\bm{\omega}}_{m}^{T}{\bm{T}}%
_{j}{\bm{B}}^{c}_{i}{\bm{\alpha}}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}+C
\displaystyle=\sum_{m}\sum_{i}\sum_{j=1}\operatorname{Tr}({\bm{\omega}}_{m}^{T%
}{\bm{T}}_{j}{\bm{B}}^{c}_{i}{\bm{\alpha}})^{2}-2{\bm{\omega}}_{m}^{T}{\bm{T}}%
_{j}{\bm{B}}^{c}_{i}{\bm{\alpha}}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}+C
\displaystyle=\sum_{m}\sum_{i}\sum_{j=1}\operatorname{Tr}({\bm{T}}_{j}{\bm{B}}%
^{c}_{i}{\bm{\alpha}}{\bm{\omega}}_{m}^{T})^{2}-2{\bm{\omega}}_{m}^{T}{\bm{T}}%
_{j}{\bm{B}}^{c}_{i}{\bm{\alpha}}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}+C
\displaystyle=\sum_{m}\sum_{i}\sum_{j=1}\operatorname{Tr}({\bm{T}}_{j}{\bm{B}}%
^{c}_{i}{\bm{\alpha}}{\bm{\omega}}_{m}^{T})^{2}-2{\bm{\omega}}_{m}^{T}{\bm{T}}%
_{j}{\bm{B}}^{c}_{i}{\bm{\alpha}}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}+C
C
\langle{\bm{T}}_{j}^{T},{\bm{B}}^{c}_{i}{\bm{\alpha}}{\bm{\omega}}_{m}^{T}%
\rangle_{\operatorname{Tr}}^{2}=\operatorname{Tr}({\bm{T}}_{j}{\bm{B}}^{c}_{i}%
{\bm{\alpha}}{\bm{\omega}}_{m}^{T})^{2}=||{\bm{T}}_{j}{\bm{B}}^{c}_{i}{\bm{%
\alpha}}{\bm{\omega}}_{m}^{T}||_{\operatorname{Tr}}^{2}
C
\displaystyle g(\theta_{\leftrightarrow}^{1})=\sum_{m}\operatorname{Tr}({\bm{%
\omega}}_{m}{\bm{\alpha}}^{T}\Big{(}\sum_{i}{{\bm{B}}^{c}_{i}}^{T}\sum_{j}{\bm%
{T}}_{j}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_{i}\Big{)}{\bm{\alpha}}{\bm{\omega}}_{m}^%
{T})-2{\bm{\omega}}_{m}^{T}\sum_{i,j}{\bm{T}}_{j}{\bm{B}}^{c}_{i}{\bm{{V_{%
\text{goal}}}}}_{j,m}^{i}{\bm{\alpha}}
\displaystyle g(\theta_{\leftrightarrow}^{1})
\displaystyle=\sum_{m}\operatorname{Tr}({\bm{\omega}}_{m}{\bm{\alpha}}^{T}\Big%
{(}\sum_{i}{{\bm{B}}^{c}_{i}}^{T}\sum_{j}{\bm{T}}_{j}^{T}{\bm{T}}_{j}{\bm{B}}^%
{c}_{i}\Big{)}{\bm{\alpha}}{\bm{\omega}}_{m}^{T})-2{\bm{\omega}}_{m}^{T}\sum_{%
i,j}{\bm{T}}_{j}{\bm{B}}^{c}_{i}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}{\bm{\alpha}}
\displaystyle=\sum_{m}{\bm{\alpha}}^{T}\Big{(}\sum_{i}{{\bm{B}}^{c}_{i}}^{T}%
\sum_{j}{\bm{T}}_{j}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_{i}\Big{)}{\bm{\alpha}}{\bm{%
\omega}}_{m}^{T}{\bm{\omega}}_{m}-2{\bm{\omega}}_{m}^{T}\sum_{i,j}{\bm{T}}_{j}%
{\bm{B}}^{c}_{i}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}{\bm{\alpha}}
\displaystyle=\sum_{m}{\bm{\alpha}}^{T}\Big{(}\sum_{i}{{\bm{B}}^{c}_{i}}^{T}%
\sum_{j}{\bm{T}}_{j}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_{i}\Big{)}{\bm{\alpha}}{\bm{%
\omega}}_{m}^{T}{\bm{\omega}}_{m}-2{\bm{\omega}}_{m}^{T}\sum_{i,j}{\bm{T}}_{j}%
{\bm{B}}^{c}_{i}{\bm{{V_{\text{goal}}}}}_{j,m}^{i}{\bm{\alpha}}
\displaystyle={\bm{\alpha}}^{T}\Big{(}\sum_{i}{{\bm{B}}^{c}_{i}}^{T}\sum_{j}{%
\bm{T}}_{j}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_{i}\Big{)}{\bm{\alpha}}{\bm{\omega}}^{%
T}{\bm{\omega}}-2\sum_{m}{\bm{\omega}}_{m}^{T}\sum_{i,j}{\bm{T}}_{j}1_{full}^{%
T}{\bm{{V_{\text{goal}}}}}^{i}1_{j,m}{\bm{B}}^{c}_{i}{\bm{\alpha}}
\displaystyle={\bm{\alpha}}^{T}\Big{(}\sum_{i}{{\bm{B}}^{c}_{i}}^{T}\sum_{j}{%
\bm{T}}_{j}^{T}{\bm{T}}_{j}{\bm{B}}^{c}_{i}\Big{)}{\bm{\alpha}}{\bm{\omega}}^{%
T}{\bm{\omega}}-2\sum_{m}{\bm{\omega}}_{m}^{T}\sum_{i,j}{\bm{T}}_{j}1_{full}^{%
T}{\bm{{V_{\text{goal}}}}}^{i}1_{j,m}{\bm{B}}^{c}_{i}{\bm{\alpha}}
\displaystyle={\bm{\alpha}}^{T}{\bm{S}}{\bm{\alpha}}{\bm{\omega}}^{T}{\bm{%
\omega}}-2\sum_{m}{\bm{\omega}}_{m}^{T}\sum_{i}{\bm{F}}_{i}^{m}{\bm{B}}^{c}_{i%
}{\bm{\alpha}}
\displaystyle={\bm{\alpha}}^{T}{\bm{S}}{\bm{\alpha}}{\bm{\omega}}^{T}{\bm{%
\omega}}-2\sum_{m}{\bm{\omega}}_{m}^{T}\sum_{i}{\bm{F}}_{i}^{m}{\bm{B}}^{c}_{i%
}{\bm{\alpha}}
\displaystyle={\bm{\alpha}}^{T}{\bm{S}}{\bm{\alpha}}{\bm{\omega}}^{T}{\bm{%
\omega}}-2{\bm{\omega}}{\bm{N}}{\bm{\alpha}}
\displaystyle={\bm{\alpha}}^{T}{\bm{S}}{\bm{\alpha}}{\bm{\omega}}^{T}{\bm{%
\omega}}-2{\bm{\omega}}{\bm{N}}{\bm{\alpha}}
T_{j}=\begin{pmatrix}\overbrace{0\hskip 8.5359pt.\hskip 8.5359pt0}^{j-1+%
\lfloor j/(p-1)\rfloor}&1&0&.&.&.&.\\
\overbrace{0\hskip 8.5359pt.\hskip 8.5359pt0}^{j-1+\lfloor j/(p-1)\rfloor}&0&1%
&.&.&.&.\\
\overbrace{0\hskip 8.5359pt.\hskip 8.5359pt0}^{j-1+\lfloor j/(p-1)\rfloor}&%
\overbrace{0\hskip 8.5359pt.\hskip 8.5359pt0}^{31}&1&0&.&.&.\\
\overbrace{0\hskip 8.5359pt.\hskip 8.5359pt0}^{j-1+\lfloor j/(p-1)\rfloor}&%
\overbrace{0\hskip 8.5359pt.\hskip 8.5359pt0}^{31}&0&1&0&.&.\\
\end{pmatrix}
(2,2)
{\bm{S}}
{\bm{S}}={\bm{S}}^{\frac{1}{2}}{{\bm{S}}^{\frac{1}{2}}}
{\bm{\alpha}}_{k}
\lambda
\displaystyle{\bm{N}}{\bm{N}}^{T}{\bm{\alpha}}_{k}=\lambda{\bm{S}}{\bm{\alpha}%
}_{k}
\displaystyle{\bm{N}}{\bm{N}}^{T}{\bm{\alpha}}_{k}=\lambda{\bm{S}}{\bm{\alpha}%
}_{k}
\displaystyle{\bm{\alpha}}^{*}=\max_{x}\frac{{\bm{\alpha}}^{T}{\bm{N}}{\bm{N}}%
^{T}{\bm{\alpha}}}{{\bm{\alpha}}^{T}{\bm{S}}{\bm{\alpha}}}
\displaystyle{\bm{\alpha}}^{*}
\displaystyle=\max_{x}\frac{{\bm{\alpha}}^{T}{\bm{N}}{\bm{N}}^{T}{\bm{\alpha}}%
}{{\bm{\alpha}}^{T}{\bm{S}}{\bm{\alpha}}}
\displaystyle{\bm{p}}^{*}=\max_{{\bm{p}}={\bm{S}}^{1/2}{\bm{\alpha}}}\frac{{%
\bm{p}}^{T}{\bm{S}}^{-\frac{1}{2}}{\bm{N}}{\bm{N}}^{T}{{\bm{S}}^{-\frac{1}{2}}%
}{\bm{p}}}{{\bm{p}}^{T}{\bm{p}}}
\displaystyle{\bm{p}}^{*}
\displaystyle=\max_{{\bm{p}}={\bm{S}}^{1/2}{\bm{\alpha}}}\frac{{\bm{p}}^{T}{%
\bm{S}}^{-\frac{1}{2}}{\bm{N}}{\bm{N}}^{T}{{\bm{S}}^{-\frac{1}{2}}}{\bm{p}}}{{%
\bm{p}}^{T}{\bm{p}}}
\displaystyle{\bm{p}}^{*}=\max_{||{\bm{p}}||=1}||{\bm{N}}^{T}{{\bm{S}}^{-\frac%
{1}{2}}}{\bm{p}}||
\displaystyle{\bm{p}}^{*}
\displaystyle=\max_{||{\bm{p}}||=1}||{\bm{N}}^{T}{{\bm{S}}^{-\frac{1}{2}}}{\bm%
{p}}||
\displaystyle{\bm{\alpha}}^{*}={{\bm{S}}^{-\frac{1}{2}}}{\bm{p}}^{*}
\displaystyle{\bm{\alpha}}^{*}
\displaystyle={{\bm{S}}^{-\frac{1}{2}}}{\bm{p}}^{*}
{\bm{S}}^{-\frac{1}{2}}{\bm{N}}=\sum_{r=1}^{R}\lambda_{r}{\bm{e}}_{r}{\bm{f}}_%
{r}^{T}
{\bm{S}}^{-\frac{1}{2}}{\bm{N}}{\bm{N}}^{T}{{\bm{S}}^{-\frac{1}{2}}}=\sum_{r=1%
}^{R}\lambda_{r}^{2}{\bm{f}}_{r}{\bm{f}}_{r}^{T}
j\neq i\;\implies\;{\bm{e}}_{i}^{T}{\bm{e}}_{j}=0
{\bm{f}}_{i}^{T}{\bm{f}}_{j}=0
{\bm{p}}_{k}^{*}={\bm{f}}_{k}
{\bm{\alpha}}_{k}={{\bm{S}}^{-\frac{1}{2}}}{\bm{e}}_{k}
{\bm{\omega}}_{k}
m=m^{\prime}=1
\displaystyle{\bm{a}}_{l}({\bm{x}})^{t+1}={\bm{a}}_{l}({\bm{x}})^{t}+{\bm{V}}(%
{\theta}_{\leftrightarrow}^{1,*},{\bm{x}})\gamma+o(\gamma)
\displaystyle{\bm{a}}_{l}({\bm{x}})^{t+1}
\displaystyle={\bm{a}}_{l}({\bm{x}})^{t}+{\bm{V}}({\theta}_{\leftrightarrow}^{%
1,*},{\bm{x}})\gamma+o(\gamma)
\displaystyle{\bm{{v_{\text{goal}}}}}^{l,t+1}({\bm{x}})={\bm{{v_{\text{goal}}}%
}}^{l,t}({\bm{x}})+\nabla_{a_{l}({\bm{x}})}\mathcal{L}(f_{\theta}({\bm{x}}),{%
\bm{y}})^{T}{\bm{v}}({\theta}_{\leftrightarrow}^{1,*},{\bm{x}})\gamma+o(\gamma)
\displaystyle{\bm{{v_{\text{goal}}}}}^{l,t+1}({\bm{x}})
\displaystyle={\bm{{v_{\text{goal}}}}}^{l,t}({\bm{x}})+\nabla_{a_{l}({\bm{x}})%
}\mathcal{L}(f_{\theta}({\bm{x}}),{\bm{y}})^{T}{\bm{v}}({\theta}_{%
\leftrightarrow}^{1,*},{\bm{x}})\gamma+o(\gamma)
\displaystyle\operatorname*{arg\,min}_{{\bm{\alpha}}_{2},{\bm{\omega}}_{2}}||{%
\bm{{V_{\text{goal}}}}}^{l,t}-{\bm{V}}^{l}({\bm{\alpha}}_{2},{\bm{\omega}}_{2}%
)||_{\operatorname{Tr}}+o(1)
\displaystyle\operatorname*{arg\,min}_{{\bm{\alpha}}_{2},{\bm{\omega}}_{2}}||{%
\bm{{V_{\text{goal}}}}}^{l,t}-{\bm{V}}^{l}({\bm{\alpha}}_{2},{\bm{\omega}}_{2}%
)||_{\operatorname{Tr}}+o(1)
\left\|{\color[rgb]{1,0,1}{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})}+{\color[%
rgb]{1,0,1}{\bm{V}}^{l}({\mathbf{\delta W}_{\!l}})}-{\color[rgb]{0,.5,.5}{\bm{%
{V_{\text{goal}}}}}^{l}}\right\|_{\operatorname{Tr}}^{2}
{\mathbf{\delta W}_{\!l}}
\theta_{\leftrightarrow}^{K}
{\mathbf{\delta W}_{\!l}}
\theta_{\leftrightarrow}^{K}
{\bm{V}}^{l}({\mathbf{\delta W}_{\!l}})=\delta{\bm{W}}_{l}\,{\bm{B}}_{l-1}
{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})=\sum_{k=1}^{K}{\bm{\omega}}_{k}{\bm%
{B}}_{l-2}^{T}{\bm{\alpha}}_{k}
{\bm{B}}_{l-1}
\min(n_{S},n_{l-1})
n_{S}
n_{l-1}
l-1
{\bm{B}}_{l-2}
\min(n_{S},n_{l-2})
n_{l-2}
l-2
\delta{\bm{W}}_{l}
\theta_{\leftrightarrow}^{K}=({\bm{\omega}}_{k},{\bm{\alpha}}_{k})
n_{S}
n_{l-1}
n_{l-2}
\delta{\bm{W}}_{l}
\theta_{\leftrightarrow}^{K}
{\bm{V}}^{l}({\mathbf{\delta W}_{\!l}})
{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})
n_{S}\leqslant n_{l-1}\leqslant n_{l-2}
{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})
{\bm{{V_{\text{goal}}}}}^{l}-{\bm{V}}^{l}({\mathbf{\delta W}_{\!l}})
n_{l-1}
n_{l-2}
{\bm{B}}_{l-1}
{\bm{B}}_{l-2}
{\bm{V}}^{l}({\mathbf{\delta W}_{\!l}})
{\bm{V}}^{l}(\theta_{\leftrightarrow}^{K})
{\bm{B}}_{l-1}
{\bm{B}}_{l-2}
f^{*}
\inf_{f}\sum_{x\in\mathcal{D}}\|f(x)-f^{*}(x)\|^{2}
f(x)
\mathcal{D}
f
f^{*}
f^{\prime}
f
g
{\bm{\omega}}
\gamma
\sigma
\widehat{g}
\gamma
\sigma
\forall x,\|g(x)-g^{*}(x)\|\leqslant\gamma
g^{*}=f^{*}-f
f^{*}
f
\sigma
f
\gamma=\frac{1}{10}\|f^{*}-f\|_{L2}
\left<a\right|\left.b\right>_{L2}=\frac{1}{|{\bm{\omega}}|}\int_{x\in{\bm{%
\omega}}}a(x)\,b(x)\,dx
g
\sigma
\forall x\in{\bm{\omega}},\;\;-\gamma\leqslant g(x)-g^{*}(x)\leqslant\gamma
\forall x\in{\bm{\omega}},\;\;g(x)=f^{*}(x)-f(x)+a(x)
\forall x\in{\bm{\omega}},\;|a(x)|\leqslant\gamma
\forall x\in{\bm{\omega}},\;\;f^{*}(x)-(f(x)+g(x))=-a(x)
\forall x\in{\bm{\omega}},\;\;\left(f^{*}(x)-h(x)\right)^{2}=a^{2}(x)
h
f
g
\left\|f^{*}-h\right\|^{2}_{L2}=\|a\|^{2}_{L2}
\left\|f^{*}-h\right\|^{2}_{L2}\leqslant\gamma^{2}=\frac{1}{100}\|f^{*}-f\|^{2%
}_{L2}
\gamma=\frac{1}{10}\sqrt{\frac{1}{|\mathcal{D}|}\sum_{x\in\mathcal{D}}\|f(x)-f%
^{*}(x)\|^{2}}
\sum_{x\in\mathcal{D}}\left(f^{*}(x)-h(x)\right)^{2}=\sum_{x\in\mathcal{D}}a^{%
2}(x)\leqslant\frac{1}{100}\sum_{x\in\mathcal{D}}\left(f^{*}(x)-f(x)\right)^{2}
g
c_{n}
n
\sigma^{(n)}(c_{n})
c_{n}
n
\sigma
c_{n}
c^{n}
n
\sigma
c_{n}
f
f^{*}
f^{\prime}
f
L2
g
g=2(f^{*}-f)
L2
a_{i}\sigma({\bm{W}}_{i}\cdot{\bm{x}})
N
\big{<}\sum_{i=1}^{N}a_{i}\sigma({\bm{w}}_{i}\cdot{\bm{x}})\;\big{|}\;g\big{>}%
_{L2}=K<0
\sum_{i=1}^{N}\left<a_{i}\sigma({\bm{w}}_{i}\cdot{\bm{x}})\right|\left.g\right%
>_{L2}=K<0
i
\left<a_{i}\sigma({\bm{w}}_{i}\cdot{\bm{x}})\;\right|\;\left.g\right>_{L2}%
\leqslant\frac{1}{N}K
\forall i\in[1,N],\;\;\left<a_{i}\sigma({\bm{w}}_{i}\cdot{\bm{x}})\right|\left%
.g\right>_{L2}>\frac{1}{N}K
\sum_{i=1}^{N}\left<a_{i}\sigma({\bm{w}}_{i}\cdot{\bm{x}})\right|\left.g\right%
>_{L2}>K
N
\left<a_{i}\sigma({\bm{w}}_{i}\cdot{\bm{x}})\right|\left.g\right>_{L2}%
\leqslant\frac{1}{N}K<0
f
\frac{1}{N}
f
f
{\mathbf{\delta W}_{\!l}}^{*}
{\bm{S}}^{-1/2}{\bm{N}}
n
Y
X
\displaystyle Y\sim AX+\varepsilon,\;\;\varepsilon\sim\mathcal{N}(0,\sigma^{2}%
),\;\;\mathbb{E}[\varepsilon|X]=0
\displaystyle Y\sim AX+\varepsilon,\;\;\varepsilon\sim\mathcal{N}(0,\sigma^{2}%
),\;\;\mathbb{E}[\varepsilon|X]=0
(X_{i},Y_{i})
A
{\mathbf{\delta W}_{\!l}}^{*}
{\bm{S}}^{-1/2}{\bm{N}}
Y
Y
Y\in\mathbb{R}
\hat{A}:=(\mathbf{X}\mathbf{X}^{T})^{-1}\mathbf{X}\mathbf{Y}^{T}
\operatorname{var}(\hat{A})=\sigma^{2}(\mathbf{X}\mathbf{X}^{T})^{-1}
n
\frac{1}{n}\mathbf{X}\mathbf{X}^{T}\rightarrow Q
Q
\hat{A}\sim\mathcal{N}(A,\sigma^{2}\frac{Q^{-1}}{n})
(\hat{A}-A)\sqrt{\frac{n}{\sigma}}Q^{1/2}\sim\mathcal{N}(0,I)
||(\hat{A}-A)\sqrt{\frac{n}{\sigma}}Q^{1/2}||^{2}\sim\chi^{2}(k)
k
X
\mathbb{E}\left[||(\hat{A}-A)Q^{1/2}||^{2}\right]=\frac{k\sigma}{n}
Q^{1/2}{Q^{1/2}}^{T}
\operatorname{var}(\hat{A})\leqslant\frac{k\sigma}{n\lambda_{\min}(Q)}
n\propto\frac{(SW)^{2}}{P},
SW
P
P
X
b_{t=0}=32
t
C_{t}
t+1
b_{t+1}=b_{t}\times\sqrt{\frac{C_{t+1}}{C_{t}}}
\displaystyle\alpha_{k}^{*}\leftarrow 0
\displaystyle\alpha_{k}^{*}
\displaystyle\leftarrow 0
\displaystyle\text{for \ref{fig:Pareto_WT}}\;\;\;\omega_{k}^{*}\leftarrow%
\omega_{k}^{*}\times\frac{1e-3}{\sqrt{||\{\omega_{j}^{*}\}_{j=1}^{n_{d}}||_{2}%
^{2}/n_{d}}}
\displaystyle\text{for \ref{fig:Pareto_WT}}\;\;\;\omega_{k}^{*}
\displaystyle\leftarrow\omega_{k}^{*}\times\frac{1e-3}{\sqrt{||\{\omega_{j}^{*%
}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\text{for \ref{fig:sqrt_GM}}\;\;\;\omega_{k}^{*}\leftarrow\omega_%
{k}^{*}\times\sqrt{\frac{1e-3}{||\{\omega_{j}^{*}\}_{j=1}^{n_{d}}||_{2}^{2}/n_%
{d}}}
\displaystyle\text{for \ref{fig:sqrt_GM}}\;\;\;\omega_{k}^{*}
\displaystyle\leftarrow\omega_{k}^{*}\times\sqrt{\frac{1e-3}{||\{\omega_{j}^{*%
}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\sqrt{1e-3}
\displaystyle\alpha_{k}\leftarrow\alpha_{k}^{*}\times\sqrt{\frac{1e-3}{||\{%
\alpha_{j}^{*}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\alpha_{k}
\displaystyle\leftarrow\alpha_{k}^{*}\times\sqrt{\frac{1e-3}{||\{\alpha_{j}^{*%
}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\omega_{k}\leftarrow\omega_{k}^{*}\times\sqrt{\frac{1e-3}{||%
\omega_{j}^{*}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\omega_{k}
\displaystyle\leftarrow\omega_{k}^{*}\times\sqrt{\frac{1e-3}{||\omega_{j}^{*}%
\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\alpha_{k}^{*}\leftarrow\alpha_{k}^{*}\times\frac{1}{\sqrt{||\{%
\alpha_{j}^{*}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\alpha_{k}^{*}
\displaystyle\leftarrow\alpha_{k}^{*}\times\frac{1}{\sqrt{||\{\alpha_{j}^{*}\}%
_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\omega_{k}^{*}\leftarrow\alpha_{k}^{*}\times\frac{1}{\sqrt{||\{%
\omega_{j}^{*}\}_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle\omega_{k}^{*}
\displaystyle\leftarrow\alpha_{k}^{*}\times\frac{1}{\sqrt{||\{\omega_{j}^{*}\}%
_{j=1}^{n_{d}}||_{2}^{2}/n_{d}}}
\displaystyle{\bm{W}}^{*}\leftarrow{\bm{W}}^{*}\times\frac{1}{\sqrt{||{\bm{W}}%
^{*}||_{2}^{2}/n_{d}}}
\displaystyle{\bm{W}}^{*}
\displaystyle\leftarrow{\bm{W}}^{*}\times\frac{1}{\sqrt{||{\bm{W}}^{*}||_{2}^{%
2}/n_{d}}}
\gamma^{*}
\displaystyle\alpha_{k}^{*},\;\;\omega_{k}^{*}\;\;\leftarrow\alpha_{k}^{*}%
\gamma^{*},\omega_{k}^{*}\gamma^{*}
\displaystyle\gamma^{*}:=\operatorname*{arg\,min}_{\gamma\in[-L,L]}\sum_{i}%
\mathcal{L}(f_{\theta\oplus\gamma\theta_{\leftrightarrow}^{K}}({\bm{x}}_{i}),{%
\bm{y}}_{i})\hskip 14.22636pt
\displaystyle{\bm{W}}_{l}^{*}\;\;\leftarrow\gamma^{*}{\bm{W}}_{l}
\displaystyle\gamma^{*}:=\operatorname*{arg\,min}_{\gamma\in[-L,L]}\sum_{i}%
\mathcal{L}(f_{\theta+\gamma{\bm{W}}^{*}}({\bm{x}}_{i}),{\bm{y}}_{i})
\gamma\theta_{\leftrightarrow}^{K^{*}}=(\gamma\alpha^{*}_{k},\gamma\omega^{*}_%
{k})_{k}^{K}
\theta+\gamma{\bm{W}}^{*}
\gamma^{*}
(l)
l
(l)
l
N
\iota\in\{1/4,1/64\}
\text{ResNet18}_{f}
\theta_{\leftrightarrow}^{K^{*}}=\text{NewNeurons}(d,method=method)
\theta_{\leftrightarrow}^{K^{*}}
N
\Delta t
N
l,\text{method}=TINY
l
=TINY
{\mathbf{\delta W}_{\!l}}=
(l+1)
{\bm{S}},{\bm{N}}=\text{MatrixSN}(l-1,l+1,{\mathbf{\delta W}_{\!l}}={\mathbf{%
\delta W}_{\!l}})
{\bm{S}}:=U\Sigma U^{T}
{\bm{U}}\sqrt{\Sigma}^{-1}{\bm{U}}{\bm{N}}:={\bm{A}}\Lambda{\bm{\Omega}}
{\bm{A}}
{\bm{\Omega}}
\Lambda
=GradMax
{\mathbf{\delta W}_{\!l}}=None
\_,N=\text{MatrixSN}(l-1,l+1,{\mathbf{\delta W}_{\!l}}={\mathbf{\delta W}_{\!l%
}})
N^{T}N
=Random
(\alpha_{k},\omega_{k})_{k=1}^{n_{d}}\sim\mathcal{N}(0,Id)
p_{1},p_{2}
{\mathbf{\delta W}_{\!l}}=
{\bm{S}}
{\bm{N}}
\mathbf{X}
\propto\frac{(SW)^{2}}{P}\!
\mathbf{X}
\mathbf{V}_{goal}
p_{2}
-\frac{\partial\mathcal{L}^{tot}}{\partial\mathbf{A_{p_{2}}}}
{\mathbf{\delta W}_{\!l}}\neq
\mathbf{V}_{goal}-={\mathbf{\delta W}_{\!l}}{\bm{B}}_{p_{1}}
\mathbf{S},\mathbf{N}={\bm{B}}_{p_{1}}{{\bm{B}}_{p_{1}}}^{T},{\bm{B}}_{p_{1}}{%
\bm{{V_{\text{goal}}}}}^{T}
l
l
\mathbf{X}
\propto\frac{(SW)^{2}}{P}
(\mathbf{S},\mathbf{N})
l
l
{\mathbf{\delta W}_{\!l}}=N^{T}S^{-1}
L
W
P
P=1
S
S=1
M
M^{\prime}
M^{\prime\prime}
T
TMLW^{2}SP
LM^{\prime}(SW)^{2}P
L(SW)^{3}
L^{2}M^{\prime\prime}W^{2}SP
LSW
M^{\prime}S\,/\,TM\;\;+\;\;S^{2}W\,/\,TMP\;\;+\;\;M^{\prime\prime}L\;/\;TM\;\;%
+\;\;1\,/\,WTMP.
S^{2}W\,/\,TMP
S=1
P=1
W/TM
W
TM
10\times 100
S=9
3\times 3
P\approx 1000
P\approx 100000
W<\!\!<10000
L<TM/M"
M^{\prime}S/TM
M^{\prime}
M^{\prime}
(SW)^{2}/P
W>\sqrt{TMP/S^{3}}
W>\sqrt{TM}\approx 30
T=10
M=100
W>\sqrt{TMP/S^{3}}\approx 30
\approx 300
M^{\prime}
(SW)^{2}/P
M^{\prime}
lr=1e-2
l
n_{l}
s=1/4
1/64
16
21
n_{2}=(\text{Size}_{2}^{final}-\text{Size}_{2}^{start})/\text{nb of layer %
extensions}=(64-16)/16=(64-1)/21=3
l
n_{l}
1/64
1/4
\mathcolor{blue}{1}/\mathcolor{green}{16}
1/64
1/4
1/64
1/4
\mathcolor{blue}{1}/\mathcolor{green}{16}
1/64
1/4
32\times 32\times 64
\begin{bmatrix}3\times 3,\end{bmatrix}
\begin{bmatrix}3\times 3,64\end{bmatrix}
32\times 32\times 64
\begin{bmatrix}3\times 3,64\\
3\times 3,\mathcolor{blue}{1}/\mathcolor{green}{16}\end{bmatrix}\begin{bmatrix%
}3\times 3,\mathcolor{blue}{1}/\mathcolor{green}{16}\\
3\times 3,64\end{bmatrix}
\begin{bmatrix}3\times 3,64\\
3\times 3,\mathcolor{red}{64}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor{%
red}{64}\\
3\times 3,64\end{bmatrix}
32\times 32\times 64
\begin{bmatrix}3\times 3,64\\
3\times 3,\mathcolor{blue}{1}/\mathcolor{green}{16}\end{bmatrix}\begin{bmatrix%
}3\times 3,\mathcolor{blue}{1}/\mathcolor{green}{16}\\
3\times 3,64\end{bmatrix}
\begin{bmatrix}3\times 3,64\\
3\times 3,\mathcolor{red}{64}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor{%
red}{64}\\
3\times 3,64\end{bmatrix}
16\times 16\times 64
\begin{bmatrix}3\times 3,128\end{bmatrix}
\begin{bmatrix}3\times 3,128\end{bmatrix}
16\times 16\times 128
\begin{bmatrix}3\times 3,128\\
3\times 3,\mathcolor{blue}{2}/\mathcolor{green}{32}\end{bmatrix}\begin{bmatrix%
}3\times 3,\mathcolor{blue}{2}/\mathcolor{green}{32}\\
3\times 3,128\end{bmatrix}
\begin{bmatrix}3\times 3,128\\
3\times 3,\mathcolor{red}{128}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor%
{red}{128}\\
3\times 3,128\end{bmatrix}
16\times 16\times 128
\begin{bmatrix}3\times 3,128\\
3\times 3,\mathcolor{blue}{2}/\mathcolor{green}{32}\end{bmatrix}\begin{bmatrix%
}3\times 3,\mathcolor{blue}{2}/\mathcolor{green}{32}\\
3\times 3,128\end{bmatrix}
\begin{bmatrix}3\times 3,128\ \\
3\times 3,\mathcolor{red}{128}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor%
{red}{128}\\
3\times 3,128\end{bmatrix}
8\times 8\times 256
\begin{bmatrix}3\times 3,256\end{bmatrix}
\begin{bmatrix}3\times 3,256\end{bmatrix}
8\times 8\times 256
\begin{bmatrix}3\times 3,256\\
3\times 3,\mathcolor{blue}{4}/\mathcolor{green}{64}\end{bmatrix}\begin{bmatrix%
}3\times 3,\mathcolor{blue}{4}/\mathcolor{green}{64}\\
3\times 3,256\end{bmatrix}
\begin{bmatrix}3\times 3,256\\
3\times 3,\mathcolor{red}{256}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor%
{red}{256}\\
3\times 3,256\end{bmatrix}
8\times 8\times 256
\begin{bmatrix}3\times 3,256\\
3\times 3,\mathcolor{blue}{4}/\mathcolor{green}{64}\end{bmatrix}\begin{bmatrix%
}3\times 3,\mathcolor{blue}{4}/\mathcolor{green}{64}\\
3\times 3,256\end{bmatrix}
\begin{bmatrix}3\times 3,256\\
3\times 3,\mathcolor{red}{256}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor%
{red}{256}\\
3\times 3,256\end{bmatrix}
4\times 4\times 512
\begin{bmatrix}3\times 3,512\end{bmatrix}
\begin{bmatrix}3\times 3,512\end{bmatrix}
4\times 4\times 512
\begin{bmatrix}3\times 3,512\\
3\times 3,\mathcolor{blue}{8}/\mathcolor{green}{128}\end{bmatrix}\begin{%
bmatrix}3\times 3,\mathcolor{blue}{8}/\mathcolor{green}{128}\\
3\times 3,512\end{bmatrix}
\begin{bmatrix}3\times 3,512\\
3\times 3,\mathcolor{red}{512}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor%
{red}{512}\\
3\times 3,512\end{bmatrix}
4\times 4\times 512
\begin{bmatrix}3\times 3,512\\
3\times 3,\mathcolor{blue}{8}/\mathcolor{green}{128}\end{bmatrix}\begin{%
bmatrix}3\times 3,\mathcolor{blue}{8}/\mathcolor{green}{128}\\
3\times 3,512\end{bmatrix}
\begin{bmatrix}3\times 3,512\\
3\times 3,\mathcolor{red}{512}\end{bmatrix}\begin{bmatrix}3\times 3,\mathcolor%
{red}{512}\\
3\times 3,512\end{bmatrix}
1\times 1\times 512
100
512\times 100
256\times 100
100
\text{ResNet}_{1/64}
\sqrt{10^{-3}}
\text{ResNet}_{1/64}
\sqrt{10^{-3}}
s
\Delta t
\mathcolor{black!50}{68.0\pm 0.4}
72.9
\pm
0.1^{\;5*}
\mathcolor{black}{\textbf{69.0}\pm\textbf{0.6}}^{\;5*}
\mathcolor{black}{57.7\pm 0.3}^{\;3*}\;
\text{ResNet}_{1/64}
\Delta t=1
\mathcolor{black!50}{68.0\pm 0.4}
\mathcolor{black}{\textbf{69.0}\pm\textbf{0.6}}^{\;5*}
*:=5\times 50
\text{ResNet}_{1/64}
\Delta t=1
\mathcolor{black!50}{68.0\pm 0.4}
\mathcolor{black}{\textbf{69.0}\pm\textbf{0.6}}^{\;5*}
*:=5\times 50
