n
x_{n}\in\cX
d
x_{n}
\bff=(f_{nd1},...,f_{ndK})
k
y_{nd}
y_{n}=(y_{n1},...,y_{nD})
\cX
\bff
\bY
N
D
d
n
y_{nd}
0
K_{d}
K_{d}\equiv K,~{}\forall d=1,\dots,D
y_{nd}
\bff_{nd}=(0,f_{nd1},\dots,f_{ndK})
f_{ndk}
Q
\bx_{n}\in\eR^{Q}
\cF_{dk}(\bx_{n})
\sigma_{x}^{2}
M
\bZ\in\eR^{M\times Q}
\bU\in\eR^{M\times D\times K}
f_{ndk}
\mathcal{O}(M^{2}N)
\mathcal{O}(N^{3})
M
N
\displaystyle x_{nq}\iiddist\cN(0,\sg_{x}^{2})
\displaystyle x_{nq}
\displaystyle\iiddist\cN(0,\sg_{x}^{2})
\displaystyle\cF_{dk}\iiddist\mathrm{GP}(\bK_{d})\nn
\displaystyle\cF_{dk}
\displaystyle\iiddist\mathrm{GP}(\bK_{d})\nn
\displaystyle f_{ndk}=\cF_{dk}(\bx_{n}),\quad u_{mdk}=\cF_{dk}(\bz_{m})\nn
\displaystyle f_{ndk}
\displaystyle=\cF_{dk}(\bx_{n}),\quad u_{mdk}=\cF_{dk}(\bz_{m})\nn
\displaystyle y_{nd}\sim\operatorname*{Softmax}(\bff_{nd}),\nn
\displaystyle y_{nd}
\displaystyle\sim\operatorname*{Softmax}(\bff_{nd}),\nn
n\in[N]
N
q\in[Q]
d\in[D]
k\in[K]
m\in[M]
\displaystyle\operatorname*{Softmax}(y=k;\bff)=\operatorname*{Categorical}%
\bigg{(}\frac{\exp(f_{k})}{\exp(\operatorname*{lse}(\bff))}\bigg{)},\nn
\displaystyle\operatorname*{Softmax}(y=k;\bff)
\displaystyle=\operatorname*{Categorical}\bigg{(}\frac{\exp(f_{k})}{\exp(%
\operatorname*{lse}(\bff))}\bigg{)},\nn
\displaystyle\operatorname*{lse}(\bff)=\log\bigg{(}1+\sum_{k^{\prime}=1}^{K}%
\exp(f_{k^{\prime}})\bigg{)},
\displaystyle\operatorname*{lse}(\bff)
\displaystyle=\log\bigg{(}1+\sum_{k^{\prime}=1}^{K}\exp(f_{k^{\prime}})\bigg{)},
k=0,\dots,K
f_{0}:=0
\bx_{n}
d
\bx_{n}
(f_{nd1},...,f_{ndK})
k
y_{nd}
\by_{n}=(y_{n1},...,y_{nD})
\bff_{dk}=(f_{1dk},...,f_{Ndk})
\bu_{dk}=(u_{1dk},...,u_{Mdk})
(\bff_{dk},\bu_{dk})
\cF_{dk}
\cN(\bzero,\bK_{d}([\bX,\bZ],[\bX,\bZ]))
\bff_{dk}\sim\cN(\bzero,\bK_{d}(\bX,\bX)),\forall d,k
\bY
\bZ
\bX
\bF
\bU
q(\bX,\bF,\bU)=q(\bX)q(\bU)p(\bF|\bX,\bU).
\displaystyle\log p(\bY)=\log\int p(\bX)p(\bU)p(\bF|\bX,\bU)p(\bY|\bF)\d{\bX}%
\d{\bF}\d{\bU}\nn
\displaystyle\log p(\bY)
\displaystyle=\log\int p(\bX)p(\bU)p(\bF|\bX,\bU)p(\bY|\bF)\d{\bX}\d{\bF}\d{%
\bU}\nn
\displaystyle\geq\int q(\bX)q(\bU)p(\bF|\bX,\bU)\nn
\displaystyle\geq\int q(\bX)q(\bU)p(\bF|\bX,\bU)\nn
\displaystyle\qquad\cdot\log\frac{p(\bX)p(\bU)p(\bF|\bX,\bU)p(\bY|\bF)}{q(\bX)%
q(\bU)p(\bF|\bX,\bU)}\d{\bX}\d{\bF}\d{\bU}\nn
\displaystyle\qquad\cdot\log\frac{p(\bX)p(\bU)p(\bF|\bX,\bU)p(\bY|\bF)}{q(\bX)%
q(\bU)p(\bF|\bX,\bU)}\d{\bX}\d{\bF}\d{\bU}\nn
\displaystyle=-\operatorname*{KL}(q(\bX)\|p(\bX))-\operatorname*{KL}(q(\bU)\|p%
(\bU))\nn
\displaystyle=-\operatorname*{KL}(q(\bX)\|p(\bX))-\operatorname*{KL}(q(\bU)\|p%
(\bU))\nn
\displaystyle\quad\quad+\sum_{n=1}^{N}\sum_{d=1}^{D}\int q(\bx_{n})q(\bU_{d})p%
(\bff_{nd}|\bx_{n},\bU_{d})\nn
\displaystyle\quad\quad+\sum_{n=1}^{N}\sum_{d=1}^{D}\int q(\bx_{n})q(\bU_{d})p%
(\bff_{nd}|\bx_{n},\bU_{d})\nn
\displaystyle\qquad\qquad\qquad\qquad\cdot\log p(\by_{nd}|\bff_{nd})\d{\bx}_{n%
}\d{\bff}_{nd}\d{\bU}_{d}\nn
\displaystyle\qquad\qquad\qquad\qquad\cdot\log p(\by_{nd}|\bff_{nd})\d{\bx}_{n%
}\d{\bff}_{nd}\d{\bU}_{d}\nn
\displaystyle:=\cL
\displaystyle:=\cL
p(\bff_{nd}|\bx_{n},\bU_{d})=\prod_{k=1}^{K}\cN(f_{ndk}|\baa_{nd}^{T}\bu_{dk},%
b_{nd})
\displaystyle\baa_{nd}=\bK_{d,MM}^{-1}\bK_{d,Mn},\nn
\displaystyle\baa_{nd}
\displaystyle=\bK_{d,MM}^{-1}\bK_{d,Mn},\nn
\displaystyle b_{nd}=K_{d,nn}-\bK_{d,nM}\bK_{d,MM}^{-1}\bK_{d,Mn}.
\displaystyle b_{nd}
\displaystyle=K_{d,nn}-\bK_{d,nM}\bK_{d,MM}^{-1}\bK_{d,Mn}.
\log p(\by_{nd}|\bff_{nd})
\operatorname*{lse}(\bff)
q(\bU)
\cL
\cL
\bx_{n}
\bU_{d}
\bff_{nd}
q(\bx_{n})
q(\bU_{d})
p(\bff_{nd}|\bx_{n},\bU_{d})
\cL
q(\bX)
q(\bU)
\displaystyle q(\bU)=\prod_{d=1}^{D}\prod_{k=1}^{K}\cN(\bu_{dk}|\bmu_{dk},%
\bSig_{d}),\nn
\displaystyle q(\bU)
\displaystyle=\prod_{d=1}^{D}\prod_{k=1}^{K}\cN(\bu_{dk}|\bmu_{dk},\bSig_{d}),\nn
\displaystyle q(\bX)=\prod_{n=1}^{N}\prod_{i=1}^{Q}\cN(x_{ni}|m_{ni},s_{ni}^{2})
\displaystyle q(\bX)
\displaystyle=\prod_{n=1}^{N}\prod_{i=1}^{Q}\cN(x_{ni}|m_{ni},s_{ni}^{2})
\bSig_{d}
d
K
\cL
f_{ndk}
\bta_{d}
\bZ
\bmu_{dk}
\bSig_{d}
m_{ni}
s_{ni}
\cL
\bX
\bX
x_{ni}=m_{ni}+s_{ni}\eps_{ni}^{(x)},\quad\eps_{ni}^{(x)}\sim\cN(0,1)
\bu_{dk}
\bu_{dk}
\bSig_{d}
\bL_{d}\bL_{d}^{T}=\bSig_{d}
\bu_{dk}
\bu_{dk}=\bmu_{dk}+\bL_{d}\beps_{dk}^{(u)},\quad\beps_{dk}^{(u)}\sim\cN(\bzero%
,\bI_{M})
\bL_{d}
\bSig_{d}
\bff_{nd}
p(\bff_{nd}|\bx_{n},\bU_{d})
k
f_{ndk}
f_{ndk}=\baa_{nd}^{T}\bu_{dk}+\sqrt{b_{nd}}\eps_{ndk}^{(f)},\quad\eps_{ndk}^{(%
f)}\sim\cN(0,1)
\displaystyle\cL=-\sum_{n=1}^{N}\sum_{i=1}^{Q}\operatorname*{KL}(q(x_{ni})\|p(%
x_{ni}))\nn
\displaystyle\cL=
\displaystyle-\sum_{n=1}^{N}\sum_{i=1}^{Q}\operatorname*{KL}(q(x_{ni})\|p(x_{%
ni}))\nn
\displaystyle\quad-\sum_{d=1}^{D}\sum_{k=1}^{K}\operatorname*{KL}(q(\bu_{dk})%
\|p(\bu_{dk}))\nn
\displaystyle\quad-\sum_{d=1}^{D}\sum_{k=1}^{K}\operatorname*{KL}(q(\bu_{dk})%
\|p(\bu_{dk}))\nn
\displaystyle\quad+\sum_{n=1}^{N}\sum_{d=1}^{D}\eE_{\beps_{n}^{(x)},\beps_{d}^%
{(u)},\beps_{nd}^{(f)}}\bigg{[}\nn
\displaystyle\quad+\sum_{n=1}^{N}\sum_{d=1}^{D}\eE_{\beps_{n}^{(x)},\beps_{d}^%
{(u)},\beps_{nd}^{(f)}}\bigg{[}\nn
\displaystyle\quad\log\operatorname*{Softmax}\left(\by_{nd}\middle|\bff_{nd}%
\left(\beps_{nd}^{(f)},\bU_{d}(\beps_{d}^{(u)}),\bx_{n}(\beps_{n}^{(x)})\right%
)\right)\bigg{]}
\displaystyle\quad\log\operatorname*{Softmax}\left(\by_{nd}\middle|\bff_{nd}%
\left(\beps_{nd}^{(f)},\bU_{d}(\beps_{d}^{(u)}),\bx_{n}(\beps_{n}^{(x)})\right%
)\right)\bigg{]}
\cL^{nd}_{s}
\displaystyle\cL^{nd}_{s}\approx\nn
\displaystyle\cL^{nd}_{s}\approx\nn
\displaystyle\quad\frac{1}{T}\sum_{i=1}^{T}\log\operatorname*{Softmax}\left(%
\by_{nd}\middle|\bff_{nd}\left(\beps_{nd,i}^{(f)},\bU_{d}(\beps_{d,i}^{(u)}),%
\bx_{n}(\beps_{n,i}^{(x)})\right)\right)
\displaystyle\quad\frac{1}{T}\sum_{i=1}^{T}\log\operatorname*{Softmax}\left(%
\by_{nd}\middle|\bff_{nd}\left(\beps_{nd,i}^{(f)},\bU_{d}(\beps_{d,i}^{(u)}),%
\bx_{n}(\beps_{n,i}^{(x)})\right)\right)
\beps_{n,i}^{(x)},\beps_{d,i}^{(u)},\beps_{nd,i}^{(f)}
\cL
m_{n}
\bmu_{dk}
10^{-2}
s_{n}
\bu_{dk}
\bu_{dk}
p(\by_{d}=1|\bx)
\bx
d=0,1,2
p(\by_{d}=1|\bx)
\bx
d=0,1,2
\bu
(0,0,0),~{}(0,1,1),~{}(1,0,1),~{}(1,1,0)
0~{}\text{XOR}~{}1=1
(0,0,?),~{}(0,1,?),~{}(1,0,?),~{}(1,1,?)
75.785\pm 13.221
1.027\pm 0.016
\{\alpha,\beta,A,B,C\}
\alpha
\{a,b,c,d,e,f,g\}
\displaystyle\alpha\rightarrow A\beta~{}[1.0]
\displaystyle\alpha
\displaystyle\rightarrow A\beta~{}[1.0]
\displaystyle\beta\rightarrow BA~{}[0.5]~{}~{}|~{}~{}C~{}[0.5]
\displaystyle\beta
\displaystyle\rightarrow BA~{}[0.5]~{}~{}|~{}~{}C~{}[0.5]
\displaystyle A\rightarrow a~{}[0.5]~{}~{}|~{}~{}b~{}[0.3]~{}~{}|~{}~{}c~{}[0.2]
\displaystyle A
\displaystyle\rightarrow a~{}[0.5]~{}~{}|~{}~{}b~{}[0.3]~{}~{}|~{}~{}c~{}[0.2]
\displaystyle B\rightarrow d~{}[0.7]~{}~{}|~{}~{}e~{}[0.3]
\displaystyle B
\displaystyle\rightarrow d~{}[0.7]~{}~{}|~{}~{}e~{}[0.3]
\displaystyle C\rightarrow f~{}[0.7]~{}~{}|~{}~{}g~{}[0.3]
\displaystyle C
\displaystyle\rightarrow f~{}[0.7]~{}~{}|~{}~{}g~{}[0.3]
ada
af
ceb
s,\overline{s}
ssceb\overline{s}\overline{s}
ssc
sce
b\overline{s}\overline{s}
ss
a
sa
7.898\pm 3.220
2.769\pm 0.070
26.477\pm 23.457
2.958\pm 0.265
6.748\pm 3.028
2.797\pm 0.081
20\%
8.68
4.41
4.41
3.41
3.57\pm 0.208
\mathbf{2.86\pm 0.119}
8.68
\infty
4.42
\mathbf{3.49}
\mathbf{3.47\pm 0.252}
\mathbf{3.36\pm 0.186}
8.85
4.64
4.64
3.67
12.13\pm 9.705
\mathbf{3.34\pm 0.096}
\alpha=0.01
\alpha=1
\alpha=0.01
\alpha=1
2\times 10^{9}
\alpha=0.01
\alpha=1
\infty
3.07
\mathbf{2.11}
1.56
1.34
20\times 16
10\times 8
20\%
