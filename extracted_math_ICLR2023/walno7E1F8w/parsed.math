10^{60}
<30
\mathcal{M}=\{(\B x_{i},\bm{r}_{i})\}_{i=1}^{n}
n
\B x_{i}\in\mathbb{R}^{n_{a}}
\bm{r}_{i}\in\mathbb{R}^{3}
n_{a}
\mathcal{F}
m
\mathcal{F}=\{(\B X_{1},\bm{R}_{1}),\dots,(\B X_{f},\bm{R}_{f}),\dots,(\B X_{m%
},\bm{R}_{m})\}
f
1<n_{f}<n
\bm{R}_{f}=(\bm{r}_{\footnotesize 1},\dots,\bm{r}_{n_{\scriptscriptstyle f}})%
\in\mathbb{R}^{3\times n_{f}}
\B X_{f}=(\B x_{\footnotesize 1},\dots,\B x_{n_{\scriptscriptstyle f}})\in%
\mathbb{R}^{n_{a}\times n_{f}}
\mathrm{E}(\mathcal{M})
\mathcal{F}
\mathcal{M}
\bm{R}_{f}
\mathcal{F}
(\mathcal{S},\mathcal{A},\mathcal{T},\gamma,T,r)
\mathcal{S}
\mathcal{A}
\mathcal{T}:\mathcal{S}\times\mathcal{A}\mapsto S
\gamma\in(0,1]
T
r:\mathcal{S}\times\mathcal{A}\mapsto\mathbb{R}
a_{t}
s_{t}
\mathcal{M}_{t}
\mathcal{F}_{t}
\mathcal{M}_{t+1}
a_{t}
(\B X_{t},\bm{R}_{t})
s_{t}
\mathcal{M}_{t}
t
\mathcal{F}_{t}
a_{t}
\mathcal{M}_{t+1}
\B X_{t}
\bm{R}_{t}
\mathcal{F}=\{\ce{C4H6N2},\ce{C4H5NS},\ce{C3H6},\ce{C3H7NO}\}
\ce{C14H22N4OS}
\ce{C4H6N2}
s_{t}
\mathcal{M}_{t}
t
\mathcal{F}_{t}
a_{t}
\mathcal{M}_{t+1}
\B X_{t}
\bm{R}_{t}
\mathcal{F}=\{\ce{C4H6N2},\ce{C4H5NS},\ce{C3H6},\ce{C3H7NO}\}
\ce{C14H22N4OS}
\ce{C4H6N2}
s_{t}
\mathcal{M}_{t}
t
\mathcal{F}_{t}
t
\mathcal{M}_{t}=\left\{(\B X_{0},\bm{R}_{0}),\dots,(\B X_{t-1},\bm{R}_{t-1})\right\}
(\B X_{\ell},\bm{R}_{\ell})
\mathcal{F}_{t}=\left\{f\ |\ (\B X_{f},\bm{R}_{f})\notin\mathcal{M}_{t}\right\}
(\B X_{0},\bm{R}_{0})
\mathcal{M}_{t}
a_{t}=(\mathbf{X}_{t},\bm{R}_{t})
\mathrm{E}\in\mathbb{R}
a_{t}
s_{t}
r(s_{t},a_{t})
\displaystyle r(s_{t},a_{t})=-\left[\mathrm{E}(\mathcal{M}_{t+1})-\mathrm{E}(%
\mathcal{M}_{t}^{+f})\right]
\displaystyle r(s_{t},a_{t})=-\left[\mathrm{E}(\mathcal{M}_{t+1})-\mathrm{E}(%
\mathcal{M}_{t}^{+f})\right]
\mathrm{E}(\mathcal{M}_{t+1})
a_{t}
\displaystyle\mathrm{E}(\mathcal{M}_{t}^{+f})=\mathrm{E}(\mathcal{M}_{t})+%
\mathrm{E}(\{(\B X_{t},\bm{R}^{\prime}_{t})\})
\displaystyle\mathrm{E}(\mathcal{M}_{t}^{+f})=\mathrm{E}(\mathcal{M}_{t})+%
\mathrm{E}(\{(\B X_{t},\bm{R}^{\prime}_{t})\})
\mathrm{E}(\mathcal{M}_{t})
t
\mathrm{E}(\{(\B X_{t},\bm{R}^{\prime}_{t})\}
\bm{R}^{\prime}_{t}
\mathcal{M}_{t+1}
E(\mathcal{M})
\mathcal{M}
\mathcal{F}
v_{\scriptscriptstyle\mathcal{M}}
\B h_{\scriptscriptstyle\mathcal{F}}
\B h_{v}
\B h_{v_{\scriptscriptstyle\mathcal{M}}}
\B h_{u_{f}}
f
\textsc{MLP}_{v}
\scriptscriptstyle\textsc{MLP}_{\tiny\mathcal{\tiny F}}
\textsc{MLP}_{f}
\textsc{MLP}_{u}
\B h_{u}
u_{f}
\scriptsize\textsc{MLP}_{d}
\footnotesize\textsc{MLP}_{\varphi}
d
\varphi
v_{\scriptscriptstyle\mathcal{M}}
f
u_{f}
s
\displaystyle p(u_{f},f,v_{\scriptscriptstyle\mathcal{M}}|s)=p(u_{f}|f,v_{%
\scriptscriptstyle\mathcal{M}},s)p(f|v_{\scriptscriptstyle\mathcal{M}},s)p(v_{%
\scriptscriptstyle\mathcal{M}}|s)
\displaystyle p(u_{f},f,v_{\scriptscriptstyle\mathcal{M}}|s)=p(u_{f}|f,v_{%
\scriptscriptstyle\mathcal{M}},s)p(f|v_{\scriptscriptstyle\mathcal{M}},s)p(v_{%
\scriptscriptstyle\mathcal{M}}|s)
\mathcal{M}
\{\B h_{v}\}_{v\in\mathcal{M}}=\textsc{MolNet}(\{\mathbf{x}_{v},\bm{r}_{v}\}_{%
v\in\mathcal{M}})
v
\mathcal{M}
[\B h_{v}\oplus\B h_{\scriptscriptstyle\mathcal{F}}]_{v\in\mathcal{M}}
\B h_{\scriptscriptstyle\mathcal{F}}=\textsc{MLP}_{\scriptscriptstyle\mathcal{%
F}}(\bm{x}_{\scriptscriptstyle\mathcal{F}})
\textsc{MLP}_{\scriptscriptstyle\mathcal{F}}
\bm{x}_{\scriptscriptstyle\mathcal{F}}=[n_{f}\ \text{for}\ f\in\mathcal{F}]
n_{f}
f
\mathcal{F}
p(v_{\scriptscriptstyle\mathcal{M}}|s)=\frac{\mathbb{M}_{v}\exp\left(\textsc{%
MLP}_{v}[\B h_{v}\oplus\B h_{\scriptscriptstyle\mathcal{F}}]\right)}{\sum_{v%
\in\mathcal{M}}\mathbb{M}_{v}\exp\left(\textsc{MLP}_{v}[\B h_{v}\oplus\B h_{%
\scriptscriptstyle\mathcal{F}}]\right)}
\mathbb{M}_{v}=\mathbb{I}[\mathrm{Z}_{v}=1]
\mathrm{Z}_{v}=1
v_{\scriptscriptstyle\mathcal{M}}\sim\text{Categorical}(p(v_{%
\scriptscriptstyle\mathcal{M}}|s))
\B h_{f}=\textsc{MLP}_{f}([\B h_{v_{\scriptscriptstyle\mathcal{M}}}\oplus\B h_%
{\scriptscriptstyle\mathcal{F}}])
p(f|\ v_{\scriptscriptstyle\mathcal{M}},s)={\scriptstyle\mathbb{M}}_{f}\exp(\B
h%
_{f})\big{/}\textstyle\sum_{f^{\prime}\in\mathcal{F}}{\scriptstyle\mathbb{M}}_%
{f^{\prime}}\exp(\B h_{f^{\prime}})
{\scriptstyle\mathbb{M}}_{f}=\mathbb{I}[n_{f}>0]
u
f
\{\B h_{u}\}_{u\in f}=\textsc{FragNet}(\{\mathbf{x}_{u},\bm{r}_{u}\}_{u\in f})
u\in f
\B H^{f,{v_{\scriptscriptstyle\mathcal{M}}}}_{u}=\B h_{u}\oplus\B h_{v_{%
\scriptscriptstyle\mathcal{M}}}\oplus\B h_{\scriptscriptstyle\mathcal{F}}%
\oplus\bm{x}_{f}
p(u_{f}|f,v_{\scriptscriptstyle\mathcal{M}},s)=\frac{\mathbb{M}_{u}\exp\left(%
\textsc{MLP}_{u}[\B H^{f,{v_{\scriptscriptstyle\mathcal{M}}}}_{u}]\right)}{%
\sum_{u^{\prime}\in f}\mathbb{M}_{u^{\prime}}\exp\left(\textsc{MLP}_{u}[\B H^{%
f,{v_{\scriptscriptstyle\mathcal{M}}}}_{u^{\prime}}]\right)}
\mathbb{M}_{u}=\mathbb{I}[\mathrm{Z}_{u}=1]
u_{f}\sim\text{Categorical}(p(u_{f}|f,v_{\scriptscriptstyle\mathcal{M}},s))
d
\varphi
\pi_{\theta}(d,\varphi,u_{f},f,v_{\scriptscriptstyle\mathcal{M}}|s)
p(d,\varphi|u_{f},f,v_{\scriptscriptstyle\mathcal{M}},s)\times p(u_{f},f,v_{%
\scriptscriptstyle\mathcal{M}}|s)
p(d,\varphi|u_{f},f,v_{\scriptscriptstyle\mathcal{M}},s)
d
d=||\B r_{a_{f}}-\bm{r}_{a_{\scriptscriptstyle\mathcal{M}}}||
a_{\scriptscriptstyle\mathcal{M}}
a_{f}
\mathbb{E}[d]=\textsc{MLP}_{d}([\B h_{u_{f}}\oplus\B h_{v_{\scriptscriptstyle%
\mathcal{M}}}\oplus\B h_{\scriptscriptstyle\mathcal{F}}\oplus\bm{x}_{f}])
\varphi\in[-\pi,\pi]
a_{\scriptscriptstyle\mathcal{M}}
a_{f}
\mathbb{E}[\varphi]=\textsc{MLP}_{\varphi}([\B h_{u_{f}}\oplus\B h_{v_{%
\scriptscriptstyle\mathcal{M}}}\oplus\B h_{\scriptscriptstyle\mathcal{F}}%
\oplus\bm{x}_{f}])
d
\{\bm{r}_{v}\in\mathbb{R}^{3}\}_{v\in f}
2\times
2\times
2\times
3\times
3\times
3\times
2\times
2\times
\varphi
d
\varphi
d
\varphi
d
\varphi
d
\varphi
d
\varphi
d
<
<
>
>95\%
E
<
>
-10
(\theta,\phi)
\pi_{\theta}
V_{\phi}
\pi_{\theta}
J(\theta)
\nabla_{\theta}J(\theta)=\mathbb{E}[\nabla_{\theta}\pi(a_{t}|s_{t})\hat{A}_{t}]
\hat{A}_{t}
r_{t}(\theta)=\pi_{\theta}(a_{t}|s_{t})/\pi_{\theta_{\text{old}}}(a_{t}|s_{t})
J^{\text{CL}}
J^{\text{CL}}(\theta)=\mathbb{E}\left[\min(r_{t}(\theta)\hat{A}_{t},\text{clip%
}(r_{t}(\theta),1-\epsilon,1+\epsilon)\hat{A}_{t})\right],
\hat{A}_{t}
\epsilon
r(\theta)
J^{\text{AC}}(\theta)=\mathbb{E}\left[J^{\text{CL}}(\theta)-c_{1}J^{\text{V}}+%
c_{2}\mathbb{H}[\pi_{\theta}|s_{t}]\right],
c_{1}
c_{2}
J^{\text{V}}=(V_{\theta}(s_{t})-V^{\text{target}})^{2}
\mathbb{H}
\hat{A}_{t}=\Delta_{t}+(\gamma\lambda)\Delta_{t+1}+\cdot\cdot\cdot+(\gamma%
\lambda)^{T-t+1}\Delta_{T-1},
\Delta_{t}=r(s_{t},a_{t})+\gamma V^{\pi}(s_{t+1})-V^{\pi}(s_{t})
\lambda
s
\B h_{v}
V_{\phi}(s)=\text{MLP}_{\phi}\left(\sum_{v\in\mathcal{M}}\B h_{v}\oplus\B h_{%
\scriptscriptstyle\mathcal{F}}\right),
\text{MLP}_{\phi}
V
\varphi
|\varphi|\in[0,\pi]
\varphi
\text{sgn}(\varphi)\in\{+1,-1\}
p(\text{sgn}(\varphi)|\,|\varphi|,u_{f},f,v_{\scriptscriptstyle\mathcal{M}},s)%
=\text{Ber}(p_{\text{sgn}(\varphi)})
p_{\text{sgn}(\varphi)})=\textsc{MLP}[\B h_{u_{f}}\oplus\B h_{v_{%
\scriptscriptstyle\mathcal{M}}}\oplus\B h_{\scriptscriptstyle\mathcal{F}}%
\oplus\bm{x}_{f}]
0
\pi
[1.10,2.10]
\epsilon=0.2
0.5
\lambda=0.97
c_{1}=0.5
c_{2}=0.01
5
3\times 10^{-4}
\gamma
1
100
128
5.0
128
64
