\Gamma
\text{\boldmath$\omega$}=\{W_{1},...,W_{L}\}
\text{\boldmath$\omega$}\sim p(\text{\boldmath$\omega$}),
p(\text{\boldmath$\omega$})
p(y=c|\mathbf{x},\text{\boldmath$\omega$})=\text{softmax}(\mathbf{f}^{\text{%
\boldmath$\omega$}}(\mathbf{x}))
\mathbf{f}^{\text{\boldmath$\omega$}}(\mathbf{x})
\omega
q_{\theta}^{*}(\text{\boldmath$\omega$})
p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})
\mathcal{D}_{\text{train}}
\displaystyle p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})=\int p(y=c|\mathbf{%
x},\text{\boldmath$\omega$})p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{%
train}})\text{d}\text{\boldmath$\omega$}
\omega
\displaystyle p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})
\displaystyle=\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})p(\text{\boldmath%
$\omega$}|\mathcal{D}_{\text{train}})\text{d}\text{\boldmath$\omega$}
\omega
\displaystyle\approx\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})q_{\theta}^%
{*}(\text{\boldmath$\omega$})\text{d}\text{\boldmath$\omega$}
\omega
\displaystyle\approx\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})q_{\theta}^%
{*}(\text{\boldmath$\omega$})\text{d}\text{\boldmath$\omega$}
\omega
\displaystyle\approx\frac{1}{T}\sum_{t=1}^{T}p(y=c|\mathbf{x},\widehat{\text{%
\boldmath$\omega$}}_{t})
\displaystyle\approx\frac{1}{T}\sum_{t=1}^{T}p(y=c|\mathbf{x},\widehat{\text{%
\boldmath$\omega$}}_{t})
\widehat{\text{\boldmath$\omega$}}_{t}\sim q_{\theta}^{*}(\text{\boldmath$%
\omega$})
q_{\theta}(\text{\boldmath$\omega$})
\mathcal{M}
\mathcal{D}_{\text{pool}}
x\in\mathcal{D}_{\text{pool}}
a(x,\mathcal{M})
x
\displaystyle x^{*}=\text{argmax}_{x\in\mathcal{D}_{\text{pool}}}a(x,\mathcal{%
M}).
\displaystyle x^{*}=\text{argmax}_{x\in\mathcal{D}_{\text{pool}}}a(x,\mathcal{%
M}).
\displaystyle{\mathbb{H}}[y|\mathbf{x},\mathcal{D}_{\text{train}}]:=
\displaystyle{\mathbb{H}}[y|\mathbf{x},\mathcal{D}_{\text{train}}]:=
\displaystyle\quad-\sum_{c}p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})\log p(%
y=c|\mathbf{x},\mathcal{D}_{\text{train}}).
\displaystyle\quad-\sum_{c}p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})\log p(%
y=c|\mathbf{x},\mathcal{D}_{\text{train}}).
{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D}_{\text{train}}]%
={\mathbb{H}}[y|\mathbf{x},\mathcal{D}_{\text{train}}]-{\mathbb{E}}_{p(\text{%
\boldmath$\omega$}|\mathcal{D}_{\text{train}})}\big{[}{\mathbb{H}}[y|\mathbf{x%
},\text{\boldmath$\omega$}]\big{]}
\omega
{\mathbb{H}}[y|\mathbf{x},\text{\boldmath$\omega$}]
y
\omega
\text{variation-ratio}[\mathbf{x}]:=1-\max_{y}p(y|x,\mathcal{D}_{\text{train}})
\displaystyle\sigma_{c}=\sqrt{{\mathbb{E}}_{q(\text{\boldmath$\omega$})}[p(y=c%
|\mathbf{x},\text{\boldmath$\omega$})^{2}]-{\mathbb{E}}_{q(\text{\boldmath$%
\omega$})}[p(y=c|\mathbf{x},\text{\boldmath$\omega$})]^{2}}
\displaystyle\sigma(\mathbf{x})=\frac{1}{C}\sum_{c}\sigma_{c}
c
\mathbf{x}
a(\mathbf{x})=\text{unif}()
\text{unif}()
[0,1]
q_{\theta}^{*}(\text{\boldmath$\omega$})
\displaystyle{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D}_{%
\text{train}}]:={\mathbb{H}}[y|\mathbf{x},\mathcal{D}_{\text{train}}]-{\mathbb%
{E}}_{p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})}\big{[}{\mathbb{H%
}}[y|\mathbf{x},\text{\boldmath$\omega$}]\big{]}
\displaystyle{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D}_{%
\text{train}}]:={\mathbb{H}}[y|\mathbf{x},\mathcal{D}_{\text{train}}]-{\mathbb%
{E}}_{p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})}\big{[}{\mathbb{H%
}}[y|\mathbf{x},\text{\boldmath$\omega$}]\big{]}
\displaystyle\quad=-\sum_{c}p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})\log p%
(y=c|\mathbf{x},\mathcal{D}_{\text{train}})
\displaystyle\quad=-\sum_{c}p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})\log p%
(y=c|\mathbf{x},\mathcal{D}_{\text{train}})
\displaystyle\quad\qquad+{\mathbb{E}}_{p(\text{\boldmath$\omega$}|\mathcal{D}_%
{\text{train}})}\bigg{[}\sum_{c}p(y=c|\mathbf{x},\text{\boldmath$\omega$})\log
p%
(y=c|\mathbf{x},\text{\boldmath$\omega$})\bigg{]},
\displaystyle\quad\qquad+{\mathbb{E}}_{p(\text{\boldmath$\omega$}|\mathcal{D}_%
{\text{train}})}\bigg{[}\sum_{c}p(y=c|\mathbf{x},\text{\boldmath$\omega$})\log
p%
(y=c|\mathbf{x},\text{\boldmath$\omega$})\bigg{]},
c
y
{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D}_{\text{train}}]
p(y=c|\mathbf{x},\mathcal{D}_{\text{train}})=\int p(y=c|\mathbf{x},\text{%
\boldmath$\omega$})p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})\text%
{d}\text{\boldmath$\omega$}
\omega
\displaystyle{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D}_{%
\text{train}}]=
\displaystyle{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D}_{%
\text{train}}]=
\displaystyle\quad-\sum_{c}\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})p(%
\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})\text{d}\text{\boldmath$%
\omega$}
\omega
\displaystyle\quad-\sum_{c}\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})p(%
\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})\text{d}\text{\boldmath$%
\omega$}
\omega
\displaystyle\quad\qquad\qquad\cdot\log\int p(y=c|\mathbf{x},\text{\boldmath$%
\omega$})p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})\text{d}\text{%
\boldmath$\omega$}
\omega
\displaystyle\quad\qquad\qquad\cdot\log\int p(y=c|\mathbf{x},\text{\boldmath$%
\omega$})p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})\text{d}\text{%
\boldmath$\omega$}
\omega
\displaystyle\quad+{\mathbb{E}}_{p(\text{\boldmath$\omega$}|\mathcal{D}_{\text%
{train}})}\bigg{[}\sum_{c}p(y=c|\mathbf{x},\text{\boldmath$\omega$})\log p(y=c%
|\mathbf{x},\text{\boldmath$\omega$})\bigg{]}.
\displaystyle\quad+{\mathbb{E}}_{p(\text{\boldmath$\omega$}|\mathcal{D}_{\text%
{train}})}\bigg{[}\sum_{c}p(y=c|\mathbf{x},\text{\boldmath$\omega$})\log p(y=c%
|\mathbf{x},\text{\boldmath$\omega$})\bigg{]}.
p(\text{\boldmath$\omega$}|\mathcal{D}_{\text{train}})
q_{\theta}^{*}(\text{\boldmath$\omega$})
\displaystyle\approx-\sum_{c}\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})q_%
{\theta}^{*}(\text{\boldmath$\omega$})\text{d}\text{\boldmath$\omega$}
\omega
\displaystyle\approx-\sum_{c}\int p(y=c|\mathbf{x},\text{\boldmath$\omega$})q_%
{\theta}^{*}(\text{\boldmath$\omega$})\text{d}\text{\boldmath$\omega$}
\omega
\displaystyle\qquad\qquad\qquad\cdot\log\int p(y=c|\mathbf{x},\text{\boldmath$%
\omega$})q_{\theta}^{*}(\text{\boldmath$\omega$})\text{d}\text{\boldmath$%
\omega$}
\omega
\displaystyle\qquad\qquad\qquad\cdot\log\int p(y=c|\mathbf{x},\text{\boldmath$%
\omega$})q_{\theta}^{*}(\text{\boldmath$\omega$})\text{d}\text{\boldmath$%
\omega$}
\omega
\displaystyle\quad+{\mathbb{E}}_{q_{\theta}^{*}(\text{\boldmath$\omega$})}%
\bigg{[}\sum_{c}p(y=c|\mathbf{x},\text{\boldmath$\omega$})\log p(y=c|\mathbf{x%
},\text{\boldmath$\omega$})\bigg{]}
\displaystyle\quad+{\mathbb{E}}_{q_{\theta}^{*}(\text{\boldmath$\omega$})}%
\bigg{[}\sum_{c}p(y=c|\mathbf{x},\text{\boldmath$\omega$})\log p(y=c|\mathbf{x%
},\text{\boldmath$\omega$})\bigg{]}
\displaystyle\approx-\sum_{c}\bigg{(}\frac{1}{T}\sum_{t}\widehat{p}_{c}^{t}%
\bigg{)}\log\bigg{(}\frac{1}{T}\sum_{t}\widehat{p}_{c}^{t}\bigg{)}
\displaystyle\approx-\sum_{c}\bigg{(}\frac{1}{T}\sum_{t}\widehat{p}_{c}^{t}%
\bigg{)}\log\bigg{(}\frac{1}{T}\sum_{t}\widehat{p}_{c}^{t}\bigg{)}
\displaystyle\qquad+\frac{1}{T}\sum_{c,t}\widehat{p}_{c}^{t}\log\widehat{p}_{c%
}^{t}=:\widehat{{\mathbb{I}}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D%
}_{\text{train}}]
\displaystyle\qquad+\frac{1}{T}\sum_{c,t}\widehat{p}_{c}^{t}\log\widehat{p}_{c%
}^{t}=:\widehat{{\mathbb{I}}}[y,\text{\boldmath$\omega$}|\mathbf{x},\mathcal{D%
}_{\text{train}}]
\widehat{p}_{c}^{t}
\mathbf{x}
\widehat{\text{\boldmath$\omega$}}_{t}\sim q_{\theta}^{*}(\text{\boldmath$%
\omega$})
c
\displaystyle\widehat{\mathbf{p}}^{t}=[\widehat{p}_{1}^{t},...,\widehat{p}_{C}%
^{t}]=\text{softmax}(\mathbf{f}^{\widehat{\text{\boldmath$\omega$}}_{t}}(%
\mathbf{x})).
\displaystyle\widehat{\mathbf{p}}^{t}=[\widehat{p}_{1}^{t},...,\widehat{p}_{C}%
^{t}]=\text{softmax}(\mathbf{f}^{\widehat{\text{\boldmath$\omega$}}_{t}}(%
\mathbf{x})).
\displaystyle\widehat{{\mathbb{I}}}[y,\text{\boldmath$\omega$}|\mathbf{x},%
\mathcal{D}_{\text{train}}]\xrightarrow[T\to\infty]{}{\mathbb{H}}[y|\mathbf{x}%
,q_{\theta}^{*}]-{\mathbb{E}}_{q_{\theta}^{*}(\text{\boldmath$\omega$})}\big{[%
}{\mathbb{H}}[y|\mathbf{x},\text{\boldmath$\omega$}]\big{]}
\displaystyle\widehat{{\mathbb{I}}}[y,\text{\boldmath$\omega$}|\mathbf{x},%
\mathcal{D}_{\text{train}}]
\displaystyle\xrightarrow[T\to\infty]{}{\mathbb{H}}[y|\mathbf{x},q_{\theta}^{*%
}]-{\mathbb{E}}_{q_{\theta}^{*}(\text{\boldmath$\omega$})}\big{[}{\mathbb{H}}[%
y|\mathbf{x},\text{\boldmath$\omega$}]\big{]}
\displaystyle\approx{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},%
\mathcal{D}_{\text{train}}],
\displaystyle\approx{\mathbb{I}}[y,\text{\boldmath$\omega$}|\mathbf{x},%
\mathcal{D}_{\text{train}}],
q_{\theta}^{*}(\text{\boldmath$\omega$})=\delta(\text{\boldmath$\omega$}-\theta)
\theta
\Gamma
\Gamma
\Gamma
(1-p)l^{2}/N
N
p=0.5
l^{2}
0.5
0.71\pm 0.003
0.75\pm 0.01
