\mathcal{X}
\mathcal{Y}\in\mathbb{R}
p_{z}
f:\mathcal{X}\rightarrow\mathcal{Y}
x
f(x)
p_{x}
p_{adv}
o:\mathcal{X}\rightarrow\mathcal{Y}
x\in\mathcal{X}
\mathcal{T}\subset\mathcal{X}
\epsilon>0
\mathcal{A}_{p}=\{x_{adv}\in\mathcal{X}|\exists x\in\mathcal{T},\|x-x_{adv}\|_%
{p}<\epsilon\wedge f(x_{adv})\neq o(x_{adv})=f(x)=o(x)\}
G
z\sim p_{z}
G(z)\sim p_{\theta}
p_{\theta}
p_{x}
\epsilon>0
\mathcal{A}_{u}=\{G(z^{*})\in\mathcal{X}|\exists z\sim p_{z},z^{*}\sim p_{z},%
\|z-z^{*}\|_{p}<\epsilon\wedge f(G(z^{*}))\neq o(G(z^{*}))=f(G(z))=o(G(z))\}
G^{*}
z\sim p_{z}
G^{*}(z)\sim q_{\theta}
q_{\theta}
p_{adv}
\mathcal{A}_{n}=\{G^{*}(z)\in\mathcal{X}|o(G^{*}(z)\neq f(G^{*}(z))\}
x\in\mathcal{X}
z\sim p_{z}
G
G^{*}
p_{z}
\mathcal{A}_{p}\subset\mathcal{A}_{u}\subset\mathcal{A}_{n}
G
D
G
D
G
D
G
V(G,D)
\begin{split}\min_{G}\max_{D}V(G,D)=\mathbb{E}_{x\sim p_{x}}[\log D(x)]+\\
\mathbb{E}_{z\sim p_{z}}[\log(1-D(G(z)))].\end{split}
C
\begin{split}\min_{G}\max_{D}\min_{C}&V(G,D,C)=\mathbb{E}_{x\sim p_{x}}[\log D%
(x)]\\
&+\mathbb{E}_{z\sim p_{z}}[\log(1-D(G(z,y)))]\\
&+\mathbb{E}_{x\sim p_{x}}[\log(1-C(x,y))]\\
&+\mathbb{E}_{z\sim p_{z}}[\log(1-C(G(z,y),y))].\end{split}
\begin{split}&\min_{G}\max_{D}V(D,G)=\mathbb{E}_{x\sim p_{x}}[D(x)]-\\
&\mathbb{E}_{z\sim p_{z}}[D(G(z))]-\lambda\mathbb{E}_{\hat{x}\sim p_{\hat{x}}}%
[(\|\nabla_{\hat{x}}D(\hat{x})\|_{2}-1)^{2}],\end{split}
p_{\hat{x}}
p_{x}
p_{g}
z^{0}
z^{*}
\epsilon
z^{0}
G(z^{*},y_{s})
f
G(z^{*},y_{s})
y_{s}
C
\begin{split}z^{*}=&\mathop{\arg\min}_{z}\{\frac{\lambda_{1}}{m}\sum_{i=1}^{m}%
\max(|z_{i}-z_{i}^{0}|-\epsilon,0)\\
&-\lambda_{2}\log C(y_{s}|G(z^{*},y_{s}))\\
&-max_{y\neq y_{s}}\log f(y|G(z^{*},y_{s}))\}\ ,\end{split}
C(y|x)
f(y|x)
y
x
C
f
G(z^{*},y_{s})
C
G(z^{*},y_{s})
q_{\theta}
p_{\theta}
p_{\theta}
q_{\theta}
q_{\theta}
p_{\theta}
p_{\theta}
q_{\theta}
p_{adv}(x_{adv}|y)
q_{\theta}(x)
q_{\theta^{*}}(x_{adv}|y)=\mathop{\arg\min}_{\theta\in\Omega}KL(q_{\theta}(x_{%
adv}|y)\|p_{adv}(x_{adv}|y)),
\theta
\Omega
p_{adv}(x_{adv}|y)
x_{adv}
x
\|x-x_{adv}\|_{p}<\epsilon
p_{adv}(x_{adv}|y)
p(x|y)
p(x|y)=\frac{p(y|x)\cdot p(x)}{p(y)}.
p_{\theta}
p_{\theta}
q_{\theta}
G_{original}
p_{\theta}
G_{original}
f_{target}
q_{\theta}
G
G
G_{original}
G_{original}
G_{attack}
G_{attack}
G
G
G_{original}
G_{original}
G_{attack}
G_{attack}
G
D
f
G
z
y
G(z,y)
G(z,y)
D
f
y
G
\begin{split}L_{G}(z,y)=&\mathbb{E}_{z\sim p_{z}(z)}[H(f(G(z,y)),y)]\\
&-\mathbb{E}_{z\sim p_{z}(z)}[D(G(z))].\end{split}
H(a,b)
a
b
D
x
G(z,y)
D
\hat{x}\sim p_{\hat{x}}
\begin{split}L_{D}(x,z,y)=&-\mathbb{E}_{x\sim p_{data}(x)}[D(x)]\\
&+\mathbb{E}_{z\sim p_{z}(z)}[D(G(z,y))]\\
&+\lambda\mathbb{E}_{\hat{x}\sim p_{\hat{x}}(\hat{x})}[(\|\nabla_{\hat{x}}D(%
\hat{x})\|_{2}-1)^{2}].\end{split}
f
x
G(z,y)
\begin{split}L_{f}(x,y)=&\mathbb{E}_{x\sim p_{data}(x)}[H(f(x),y)]+\\
&\mathbb{E}_{z\sim p_{z}(z)}[H(f(G(z,y)),y)].\end{split}
G
G
G
G
G_{original}
G_{original}
G_{original}
G_{attack}
G_{original}
f_{target}
\displaystyle G_{attack}^{*}=\mathop{\arg\min}_{G_{attack}}\ ||G_{original}(z,%
y)-G_{attack}(z,y)||_{p}
\displaystyle s.\ t.\quad f_{target}(G(z,y))=y_{t}\neq\ y,
y_{t}
\|\cdot\|_{p}
\ell_{p}
p=2
L_{a}
L_{d}
L_{a}
f_{target}
y_{t}
L_{a}(z,y)=\mathbb{E}_{z\sim p_{z}}[H(f_{target}(G_{attack}(z,y)),y_{t})],
L_{d}
G_{attack}
L_{d}(z,y)=\mathbb{E}_{z\sim p_{z}}[||G_{original}(z,y)+\rho-G_{attack}(z,y)||%
_{p}].
\rho
l_{0}
l_{\infty}
G_{original}
G_{attack}
L(z,y)=\alpha L_{a}(z,y)+\beta L_{d}(z,y),
\alpha
\beta
\alpha=1
\beta\to\infty
y_{t}
L_{a}
\max_{y\neq y_{s}}C(G_{attack}(z,y_{s}))
C(\cdot)
f_{target}
p_{data}
p_{g}
p_{a}
L_{d}
G_{attack}
\epsilon
G_{original}
L_{d}
G_{attack}(z,y)
G_{original}(z,y)
z
\max_{z,y}L_{d}(z,y)<\epsilon
KL(p_{a}\|p_{g})\to 0
\epsilon\to 0
p_{g}=p_{data}
p_{g}=p_{data}
p_{a}\approx p_{g}=p_{data}
0
9
10
200,000
[0,1]
98\%
1000
\geq
5,000
5,000
[0,1]
J
x
x_{adv}=x+\epsilon\cdot sign(\nabla_{x}J(\theta,x,y))
y
x
\theta
\epsilon
\ell_{\infty}
x
x_{adv}
k
\alpha
\begin{split}x_{adv_{t+1}}=\mathbf{clip}(x_{adv_{t}}&+\alpha sign(\nabla_{x}J(%
\theta,x_{adv_{t}},y)),\\
&x_{adv_{t}}-\epsilon,x_{adv_{t}}+\epsilon)\end{split}
x_{adv_{0}}=x,\quad x_{adv}=x_{adv_{k}}
\mathbf{clip}(x,p,q)
x
[p,q]
\alpha
\alpha<\epsilon
\begin{split}x_{adv}=x^{\prime}+(\epsilon-\alpha)\cdot sign(\nabla_{x^{\prime}%
}J(\theta,x^{\prime},y))\\
\text{where}\ x^{\prime}=x+\alpha\cdot sign(\mathcal{N}(\mathbf{0}^{d},\mathbf%
{I}^{d}))\end{split}
f
\tilde{J}(\theta,x,y)=\alpha J_{f}(\theta,x,y)+(1-\alpha)J_{f}(\theta,x_{adv},%
y).
y
x
\theta
\begin{split}\tilde{J}(\theta,x,y)=&\alpha J_{f}(\theta,x,y)+(1-\alpha)J_{f}(%
\theta,x+\\
&\epsilon sign(\nabla_{x}J(\theta,x,y)),y)\end{split}
\max_{z,y}L_{d}(z,y)<\epsilon
KL(p_{a}\|p_{g})\to 0
\epsilon\to 0
p(x)
\mathcal{X}
q(x)
p_{\epsilon}(x)
\epsilon
p(x)
x\in\mathcal{X}
p_{\epsilon}(x)
p(x)
q(x)
p(x)
P
Q
p(x)
q(x)
\mathcal{X}
\epsilon
\|q(x)-p(x)\|<\epsilon
x\in\mathcal{X}
KL(P\|Q)\to 0\text{ when }\epsilon\to 0
P
Q
p(x)
q(x)
q(x)=p(x)+r(x)
\|r(x)\|<\epsilon
\begin{split}&KL(P\|Q)=\int p(x)\log\frac{p(x)}{q(x)}dx\\
&=\int p(x)\log p(x)dx-\int p(x)\log q(x)dx\\
\end{split}
\begin{split}&=\int(q(x)-r(x))\log p(x)dx-\\
&\quad\int(q(x)-r(x))\log q(x)dx\\
&=\int q(x)\log p(x)dx-\int q(x)\log q(x)dx\\
&\quad-\int r(x)\log p(x)dx+\int r(x)\log q(x)dx\\
&=\int r(x)\log\frac{q(x)}{p(x)}dx-KL(Q\|P)\\
&\leq\int\epsilon\log(1+\frac{\epsilon}{p(x)})dx\end{split}
\epsilon\to 0
\int\epsilon\log(1+\frac{\epsilon}{p(x)})dx\to 0
DL(P\|Q)\to 0
p_{a}
p_{g}
\max_{y,z}L_{d}<\epsilon
\forall z\sim p_{z},\|p_{a}(z)-p_{g}(z)\|<\epsilon
KL(p_{a}\|p_{g})\to 0
\epsilon\to 0
p_{g}=p_{data}
y
p_{g}(x|y)
p_{data}(x|y)
\begin{split}&\min_{G}\max_{D}V(D,G)=\mathbb{E}_{x\sim p_{data}(x)}[D(x)]-\\
&\quad\mathbb{E}_{z\sim p_{z}(z)}[D(G(z))]-\lambda\mathbb{E}_{\hat{x}\sim p_{%
\hat{x}}(\hat{x})}[(\|\nabla_{\hat{x}}D(\hat{x})\|_{2}-1)^{2}]\\
&=\int_{x}p_{data}(x)D(x)dx-\int_{z}p_{z}(z)D(G(z))dz\\
&\quad-\lambda\int_{\hat{x}}p_{\hat{x}}(\hat{x})[(\|\nabla_{\hat{x}}D(\hat{x})%
\|_{2}-1)^{2}]d\hat{x}\\
&=\int_{x}[p_{data}(x)-p_{g}(x)]D(x)dx\\
&\quad-\lambda\int_{\hat{x}}p_{\hat{x}}(\hat{x})[(\|\nabla_{\hat{x}}D(\hat{x})%
\|_{2}-1)^{2}]d\hat{x}\\
\end{split}
G
D
V(D,G)
D_{G}^{*}(x)=\left\{\begin{array}[]{l}1\qquad\text{if }p_{data}(x)\geq p_{g}(x%
)\\
0\qquad\text{otherwise}\\
\end{array}\right.
\begin{split}&V(D,G)=\int_{x}[p_{data}(x)-p_{g}(x)]D(x)dx\\
&\quad-\lambda\int_{\hat{x}}p_{\hat{x}}(\hat{x})[(\|\nabla_{\hat{x}}D(\hat{x})%
\|_{2}-1)^{2}]d\hat{x}\\
&=\int_{\{x|p_{data}(x)\geq p_{g}(x)\}}(p_{data}(x)-p_{g}(x))dx\\
&\quad-\lambda\int_{\hat{x}}p_{\hat{x}}(\hat{x})d\hat{x}\\
&=\int_{\{x|p_{data}(x)\geq p_{g}(x)\}}(p_{data}(x)-p_{g}(x))dx-\lambda\\
\end{split}
\mathcal{X}=\{x|p_{data}(x)\geq p_{g}(x)\}
p_{data}(x)=p_{g}(x)
x\in\mathcal{X}
p_{g}
p_{data}
\int_{\mathcal{X}^{c}}p_{g}(x)dx=\int_{\mathcal{X}^{c}}p_{data}(x)dx.
p_{data}(x)<p_{g}(x)
x\in\mathcal{X}^{c}
\mu(\mathcal{X}^{c})=0
\mu
p_{g}(x|y)=p_{data}(x|y)
p_{g}(x)=p_{data}(x)
m\text{, }k\times k
m
k
m\text{, }k\times k
m
k
\alpha
\alpha
m
m
\alpha
\alpha
k\text{,}s
k
s
1024
64\text{, }4\times 4
0.2
32\text{, }3\times 3
7\times 7\times 128
128\text{, }4\times 4
0.2
2\text{, }2
64\text{, }4\times 4
1024
0.2
64\text{, }3\times 3
1\text{, }4\times 4
2\text{, }2
1024
0.4
10
3\text{,}382\text{,}346
710\text{,}218
4\text{,}795\text{,}082
64\text{, }5\times 5
0.2
128\text{, }3\times 3
64\text{, }5\times 5
64\text{, }8\times 8
64\text{, }3\times 3
0.25
128\text{, }6\times 6
0.25
128
128\text{, }5\times 5
128
0.5
0.5
0.5
10
10
10
509\text{,}410
17,066,658
\begin{bmatrix}\text{FC(300)+Relu}\\
\text{Dropout(0.5)}\end{bmatrix}\times 4
32\text{, }3\times 3
32\text{, }3\times 3
0.3
10
64\text{, }3\times 3
64\text{, }3\times 3
2\text{, }2
0.3
128\text{, }3\times 3
128\text{, }3\times 3
2\text{, }2
0.3
512
0.3
10
\epsilon=0.3
\epsilon=0.1
\epsilon=0.015
\ell_{\infty}
\epsilon=0.3\text{, }\alpha=0.075\text{, epochs}=20
\epsilon=0.1\text{, }\alpha=0.01\text{, epochs}=20
\epsilon=0.015\text{, }\alpha=0.005\text{, epochs}=20
\ell_{\infty}
\epsilon=0.3\text{, }\alpha=0.15
\epsilon=0.2\text{, }\alpha=0.1
\epsilon=0.015\text{, }\alpha=0.003
\ell_{\infty}
\lambda_{1}=100\text{, }\lambda_{2}=0\text{, epochs}=200
\lambda_{1}=100\text{, }\lambda_{2}=0\text{, epochs}=200
\lambda_{1}=100\text{, }\lambda_{2}=100\text{, epochs}=200
\alpha=2\text{, }\beta=1\text{, epochs}=100
\alpha=2\text{, }\beta=1\text{, epochs}=100
\alpha=3\text{, }\beta=2\text{, epochs}=200
G_{original}
G_{original}
