i
k
ii
k
i
k
ii
k
i
ii
i
ii
iii
f(\mathbf{x};\mathbf{\theta})
\mathbf{x}
\mathbf{\theta}
\mathbf{\theta}^{\prime}
g(\mathbf{x};\mathbf{\theta}^{\prime})
L_{KD}
f(\mathbf{x};\mathbf{\theta})
g(\mathbf{x};\mathbf{\theta}^{\prime})
k
\{\mathbf{x}_{i},\mathbf{y}_{i}\}_{i=1}^{N}
N
\mathbf{x}_{i}
i
\mathbf{y}_{i}
\mathbf{h}_{i}=\text{BERT}(\mathbf{x}_{i})\in\mathbb{R}^{d}
\hat{\mathbf{y}}_{i}=P(\mathbf{y}_{i}|\mathbf{x}_{i})=softmax(\mathbf{W}%
\mathbf{h}_{i})
\mathbf{W}
\displaystyle\hat{\theta}^{t}=\arg\min_{\theta}\sum_{i\in[N]}L_{CE}^{t}(%
\mathbf{x}_{i},\mathbf{y}_{i};[\theta_{\text{BERT}_{12}},\mathbf{W}])\,
\displaystyle\hat{\theta}^{t}=\arg\min_{\theta}\sum_{i\in[N]}L_{CE}^{t}(%
\mathbf{x}_{i},\mathbf{y}_{i};[\theta_{\text{BERT}_{12}},\mathbf{W}])\,
t
[N]
\{1,2,\dots,N\}
L_{CE}^{t}
\theta_{\text{BERT}_{12}}
\mathbf{x}_{i}
\displaystyle\hat{\mathbf{y}}_{i}={P}^{t}(\mathbf{y}_{i}|\mathbf{x}_{i})=%
softmax\Big{(}\frac{\mathbf{W}\mathbf{h}_{i}}{T}\Big{)}
\displaystyle\hat{\mathbf{y}}_{i}
\displaystyle={P}^{t}(\mathbf{y}_{i}|\mathbf{x}_{i})=softmax\Big{(}\frac{%
\mathbf{W}\mathbf{h}_{i}}{T}\Big{)}
\displaystyle=softmax\Big{(}\frac{\mathbf{W}\cdot\text{BERT}_{12}(\mathbf{x}_{%
i};\hat{\theta}^{t})}{T}\Big{)}\,
\displaystyle=softmax\Big{(}\frac{\mathbf{W}\cdot\text{BERT}_{12}(\mathbf{x}_{%
i};\hat{\theta}^{t})}{T}\Big{)}\,
{P}^{t}(\cdot|\cdot)
\hat{\mathbf{y}}_{i}
T
\theta^{s}
{P}^{s}(\cdot|\cdot)
\displaystyle L_{DS}=-\sum_{i\in[N]}\sum_{c\in C}\Big{[}P^{t}(\mathbf{y}_{i}=c%
|\mathbf{x}_{i};\hat{\theta}^{t})\cdot
\displaystyle L_{DS}=-\sum_{i\in[N]}
\displaystyle\sum_{c\in C}\Big{[}P^{t}(\mathbf{y}_{i}=c|\mathbf{x}_{i};\hat{%
\theta}^{t})\cdot
\displaystyle\log P^{s}(\mathbf{y}_{i}=c|\mathbf{x}_{i};\theta^{s})\Big{]}
\displaystyle\log P^{s}(\mathbf{y}_{i}=c|\mathbf{x}_{i};\theta^{s})\Big{]}
c
C
\displaystyle L_{CE}^{s}=-\sum_{i\in[N]}\sum_{c\in C}\Big{[}\mathbbm{1}[%
\mathbf{y}_{i}=c]\cdot
\displaystyle L_{CE}^{s}=-\sum_{i\in[N]}
\displaystyle\sum_{c\in C}\Big{[}\mathbbm{1}[\mathbf{y}_{i}=c]\cdot
\displaystyle\log P^{s}(\mathbf{y}_{i}=c|\mathbf{x}_{i};\theta^{s})\Big{]}
\displaystyle\log P^{s}(\mathbf{y}_{i}=c|\mathbf{x}_{i};\theta^{s})\Big{]}
\displaystyle L_{KD}=(1-\alpha)L_{CE}^{s}+\alpha L_{DS}\,
\displaystyle L_{KD}=(1-\alpha)L_{CE}^{s}+\alpha L_{DS}\,
\alpha
i
k
ii
k
\mathbf{h}_{\text{final}}=\sum_{j\in[k]}w_{j}\mathbf{h}_{j}
w_{j}
\mathbf{h}_{j}
j
k
\mathbf{x}_{i}
\displaystyle\mathbf{h}_{i}=[\mathbf{h}_{i,1},\mathbf{h}_{i,2},\dots,\mathbf{h%
}_{i,k}]=\text{BERT}_{k}(\mathbf{x}_{i})\in\mathbb{R}^{k\times d}
\displaystyle\mathbf{h}_{i}=[\mathbf{h}_{i,1},\mathbf{h}_{i,2},\dots,\mathbf{h%
}_{i,k}]=\text{BERT}_{k}(\mathbf{x}_{i})\in\mathbb{R}^{k\times d}
I_{pt}
I_{pt}=\{2,4,6,8,10\}
I_{pt}=\{7,8,9,10,11\}
k=5
n
k
n-1
\displaystyle L_{PT}=\sum_{i=1}^{N}\sum_{j=1}^{M}\Big{|}\Big{|}\frac{\mathbf{h%
}_{i,j}^{s}}{||\mathbf{h}_{i,j}^{s}||_{2}}-\frac{\mathbf{h}^{t}_{i,I_{pt}(j)}}%
{||\mathbf{h}^{t}_{i,I_{pt}(j)}||_{2}}\Big{|}\Big{|}_{2}^{2}\,
\displaystyle L_{PT}=\sum_{i=1}^{N}\sum_{j=1}^{M}\Big{|}\Big{|}\frac{\mathbf{h%
}_{i,j}^{s}}{||\mathbf{h}_{i,j}^{s}||_{2}}-\frac{\mathbf{h}^{t}_{i,I_{pt}(j)}}%
{||\mathbf{h}^{t}_{i,I_{pt}(j)}||_{2}}\Big{|}\Big{|}_{2}^{2}\,
M
N
s
t
\mathbf{h}
\displaystyle L_{PKD}=(1-\alpha)L_{CE}^{s}+\alpha L_{DS}+\beta L_{PT}\,
\displaystyle L_{PKD}=(1-\alpha)L_{CE}^{s}+\alpha L_{DS}+\beta L_{PT}\,
\beta
P
q
a_{1},\dots,a_{4}
q
a_{i}
P
q+a_{i}
(P,q+a_{i})
a_{i}
a_{i}
k
k\in\{3,6\}
T
\alpha=\{0.2,0.5,0.7\}
T
\alpha
\beta
\{10,100,500,1000\}
\alpha
T
\beta
k
k
\times
\times
\times
\times
\times
\times
