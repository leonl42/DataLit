(\tau,\bm{q})
\tau
\bm{q}
\tau
\tau
\tau
P_{ij}(t)
i
j
t
\eta
E(\tau)
\tau
r
\bm{Y}=\{Y_{1},Y_{2},\ldots,Y_{M}\}\in\Omega^{N\times M}
\Omega
M
N
Y_{i},i=1,\ldots,M
\bm{Y}
(\tau,\bm{q})
p(\bm{Y}|\tau,\bm{q})=\prod_{i=1}^{M}p(Y_{i}|\tau,\bm{q})=\prod_{i=1}^{M}\sum_%
{a^{i}}\eta(a_{r}^{i})\prod_{(u,v)\in E(\tau)}P_{a_{u}^{i}a_{v}^{i}}(q_{uv}),
a^{i}
Y_{i}
a_{u}^{i}
u
p(\tau,\bm{q})
p(\tau,\bm{q}|\bm{Y})\propto p(\bm{Y}|\tau,\bm{q})p(\tau,\bm{q})
Q_{\bm{\phi}}(\tau)
Q_{\bm{\psi}}(\bm{q}|\tau)
p(\tau,\bm{q}|\bm{Y})
Q_{\bm{\phi}}(\tau)
Q_{\bm{\psi}}(\bm{q}|\tau)
L^{K}(\bm{\phi},\bm{\psi})=\mathbb{E}_{Q_{\bm{\phi},\bm{\psi}}(\tau^{1:K},\bm{%
q}^{1:K})}\log\left(\frac{1}{K}\sum_{i=1}^{K}\frac{p(\bm{Y}|\tau^{i},\bm{q}^{i%
})p(\tau^{i},\bm{q}^{i})}{Q_{\bm{\phi}}(\tau^{i})Q_{\bm{\psi}}(\bm{q}^{i}|\tau%
^{i})}\right)\leq\log p(\bm{Y})
Q_{\bm{\phi},\bm{\psi}}(\tau^{1:K},\bm{q}^{1:K})=\prod_{i=1}^{K}Q_{\bm{\phi}}(%
\tau^{i})Q_{\bm{\psi}}(\bm{q}^{i}|\tau^{i})
Q_{\bm{\psi}}(\bm{q}|\tau)
Q_{\bm{\psi}}(\bm{q}|\tau)=\prod\nolimits_{e\in E(\tau)}p^{\mathrm{Lognormal}}%
\left(q_{e}\;|\;\mu(e,\tau),\sigma(e,\tau)\right)
\mu(e,\tau),\sigma(e,\tau)
G=(V,E)
\bm{X}_{v}
v\in V
\mathcal{N}(v)
v
T
\bm{h}_{v}^{(t+1)}=\mathrm{UPDATE}^{(t)}\left(\bm{h}_{v}^{(t)},\bm{m}_{v}^{(t+%
1)}\right),\quad\bm{m}_{v}^{(t+1)}=\mathrm{AGG}^{(t)}\left(\left\{\bm{h}_{u}^{%
(t)}:u\in\mathcal{N}(v)\right\}\right)
\bm{h}_{v}^{(t)}
v
t
\bm{h}_{v}^{(0)}=\bm{X}_{v}
\mathrm{UPDATE}^{(t)}
\mathrm{AGG}^{(t)}
\mathrm{READOUT}
\bm{h}_{G}=\mathrm{READOUT}\left(\left\{\bm{h}_{v}^{(T)}:v\in V\right\}\right).
\mathrm{READOUT}
\tau=(V,E)
f:V\mapsto\mathbb{R}^{d}
\ell(f,\tau)=\sum_{(u,v)\in E}\|f(u)-f(v)\|^{2}.
V=V^{b}\cup V^{o}
V^{b}
V^{o}
\bm{X}^{b}=\{\bm{x}_{v}|v\in V^{b}\}
\bm{X}^{o}=\{\bm{x}_{v}|v\in V^{o}\}
\widehat{\bm{X}^{o}}=\operatorname*{arg\,min}_{\bm{X}^{o}}\ell(\bm{X}^{o},\bm{%
X}^{b},\tau)=\operatorname*{arg\,min}_{\bm{X}^{o}}\sum_{(u,v)\in E}\|\bm{x}_{u%
}-\bm{x}_{v}\|^{2}.
\frac{\partial\ell(\bm{X}^{o},\bm{X}^{b},\tau)}{\partial\bm{X}^{o}}(\widehat{%
\bm{X}^{o}})=\bm{0}.
\sum\nolimits_{v\in\mathcal{N}(u)}\left(\widehat{\bm{x}}_{u}-\widehat{\bm{x}}_%
{v}\right)=\bm{0},\quad\forall u\in V^{o},\qquad\widehat{\bm{x}}_{v}=\bm{x}_{v%
},\quad\forall v\in V^{b},
\mathcal{N}(u)
u
\widehat{\bm{x}}_{u}=c_{u}\widehat{\bm{x}}_{\pi_{u}}+\bm{d}_{u},
\pi_{u}
u
c_{u}=0,\bm{d}_{u}=\bm{x}_{u}
u\in V^{b}
c_{u},\bm{d}_{u}
c_{u}=\frac{1}{|\mathcal{N}(u)|-\sum_{v\in\mathrm{ch}(u)}c_{v}},\quad\bm{d}_{u%
}=\frac{\sum_{v\in\mathrm{ch}(u)}\bm{d}_{v}}{|\mathcal{N}(u)|-\sum_{v\in%
\mathrm{ch}(u)}c_{v}},
\mathrm{ch}(u)
u
r
\widehat{\bm{x}}_{r}=\frac{\sum_{v\in\mathrm{ch}(r)}\bm{d}_{v}}{|\mathcal{N}(r%
)|-\sum_{v\in\mathrm{ch}(r)}c_{v}}.
\lambda=\min_{u\in V^{o}\backslash\{r\}}|\mathcal{N}(u)|
u\in V^{o}\backslash\{r\}
0\leq c_{u}\leq\frac{1}{\lambda-1}
\tau=(V,E)
V=V^{b}\cup V^{o}
\{\bm{x}_{u}|u\in V^{b}\}
c_{u}=0,\bm{d}_{u}=\bm{x}_{u},\forall u\in V^{b}
u
c_{u}
\bm{d}_{u}
r
u
\widehat{\bm{x}}_{u}=c_{u}\widehat{\bm{x}}_{\pi_{u}}+\bm{d}_{u}
\{\widehat{\bm{x}}_{u}|u\in V^{o}\}
\{\widehat{\bm{x}}_{u}\in\mathbb{R}^{d}|u\in V\}
d
\forall 1\leq n\leq d
\widehat{\bm{X}}[n]=\{\widehat{\bm{x}}_{u}[n]|u\in V\}
n
\forall 1\leq n\leq d
\widehat{\bm{X}}[n]
\widehat{\bm{X}}[n]
\widehat{\bm{x}}_{u}[n]
\forall u\in V
N
\{\widehat{\bm{x}}_{u}\in\mathbb{R}^{N}|u\in V\}
\forall u\in V^{o}
(i)\;0<\widehat{\bm{x}}_{u}[n]<1,\quad\forall 1\leq n\leq N,\quad\text{and}%
\quad(ii)\;\sum\nolimits_{n=1}^{N}\widehat{\bm{x}}_{u}[n]=1.
\{\widehat{\bm{x}}_{u}|u\in V\}
\{\widehat{\bm{x}}_{u}=\sum_{v\in V^{b}}a_{u}^{v}\bm{x}_{v}|u\in V^{o}\}
v\in V^{b}
u^{\ast}=\operatorname*{arg\,max}_{u\in V^{o}}a_{u}^{v}\quad\Leftrightarrow%
\quad u^{\ast}\in\mathcal{N}(v).
\bm{X}^{o}=\{\widehat{\bm{x}}_{u}|u\in V^{o}\}
\bm{Z}^{o}=\{\widehat{\bm{z}}_{u}|u\in V^{o}\}
\tau_{x}
\tau_{z}
\bm{X}^{o}=\bm{Z}^{o}
\tau_{x}=\tau_{z}
\tau
\{\bm{h}_{v}^{(0)}:v\in V\}
\{\bm{h}_{v}^{(T)}:v\in V\}
\bm{h}_{v}=\mathrm{MLP}^{(0)}\left(\bm{h}_{v}^{(T)}\right),\quad\forall\;v\in V,
\mathcal{T}
g
F_{\bm{\phi}}:\mathcal{T}\mapsto\mathbb{R}
F_{\bm{\phi}}(\tau)=\mathrm{MLP}^{(1)}(\bm{h}_{G}),\quad\bm{h}_{G}=g\left(%
\left\{\bm{h}_{v}:v\in V\right\}\right).
g\circ\mathrm{MLP}^{(0)}
\mathrm{READOUT}
q_{\bm{\phi}}(\tau)=\frac{\exp\left(-F_{\bm{\phi}}(\tau)\right)}{Z(\bm{\phi})}%
,\quad Z(\bm{\phi})=\sum\nolimits_{\tau\in\mathcal{T}}\exp\left(-F_{\bm{\phi}}%
(\tau)\right).
Z(\bm{\phi})
p_{n}
D_{\bm{\phi}}(\tau)=\log q_{\bm{\phi}}(\tau)-\log p_{n}(\tau)
D_{\bm{\phi}}
Z(\bm{\phi})
\bm{\phi}
J(\bm{\phi})=-\left(\mathbb{E}_{\tau\sim p_{\mathrm{data}}(\tau)}\log\left(S%
\left(D_{\bm{\phi}}(\tau)\right)\right)+\mathbb{E}_{\tau\sim p_{n}(\tau)}\log%
\left(1-S\left(D_{\bm{\phi}}(\tau)\right)\right)\right),
S(x)=\frac{1}{1+\exp(-x)}
D_{\bm{\phi}^{\ast}}(\tau)=\log p_{\mathrm{data}}(\tau)-\log p_{n}(\tau)
q_{\bm{\phi}^{\ast}}(\tau)=p_{\mathrm{data}}(\tau)=p_{n}(\tau)\exp\left(D_{\bm%
{\phi}^{\ast}}(\tau)\right)
\mathbb{S}_{\mathrm{r}}
\mathbb{S}_{\mathrm{psp}}
\bm{\psi}^{\mu},\bm{\psi}^{\sigma}
\mathbb{S}_{\mathrm{r}}
e
\tau
e/\tau
\mu(e,\tau)=\psi_{e/\tau}^{\mu},\quad\sigma(e,\tau)=\psi_{e/\tau}^{\sigma}.
\mathbb{S}_{\mathrm{psp}}
e/\!\!/\tau
\mu(e,\tau)=\psi_{e/\tau}^{\mu}+\sum\nolimits_{s\in e/\!\!/\tau}\psi_{s}^{\mu}%
,\;\;\sigma(e,\tau)=\psi_{e/\tau}^{\sigma}+\sum\nolimits_{s\in e/\!\!/\tau}%
\psi_{s}^{\sigma}.
e=(u,v)
\tau
f
\mu(e,\tau)=\mathrm{MLP}^{\mu}\left(\bm{h}_{e}\right),\quad\sigma(e,\tau)=%
\mathrm{MLP}^{\sigma}\left(\bm{h}_{e}\right),\quad\bm{h}_{e}=f\left(\left\{\bm%
{h}_{u},\bm{h}_{v}\right\}\right).
T=0
p_{0}(\tau)
\mathrm{Dir}(\beta\bm{1})
\beta
p_{n}(\tau)
J^{\ast}=-2\mathrm{JSD}\left(p_{0}(\tau)\|p_{n}(\tau)\right)+2\log 2,
\mathrm{JSD}(\cdot\|\cdot)
J^{\ast}
p_{0}(\tau)
\mathrm{Exp}
K=10
\lambda_{n}=\min(1,0.001+n/100000)
\tau
L(Q^{\ast}|\tau)-L(Q_{\bm{\psi}}|\tau)
L(Q_{\bm{\psi}}|\tau)
Q_{\bm{\psi}}(\bm{q}|\tau)
L(Q^{\ast}|\tau)
\tau
95\%
95\%
D
A
B
C
A
B
C
D
\dfrac{ABC}{D}
\dfrac{A}{BC}
D
A
\dfrac{B}{C}
D
D
\dfrac{AB}{CD}
\dfrac{A}{B}
\dfrac{C}{D}
A
B
C
D
S_{4}
S_{5}
S_{6}
S_{7}
S_{2}
S_{3}
S_{1}
(W,Z)
\frac{W}{Z}
(W,Z)
\frac{W}{Z}
\mathcal{X}
N
B_{\mathcal{X}}
\tau=\{s_{1},s_{2},\ldots\}
s_{1}
\tau
p_{\mathrm{sbn}}(T=\tau)=p(S_{1}=s_{1})\prod_{i>1}p(S_{i}=s_{i}|S_{\pi_{i}}=s_%
{\pi_{i}})
S_{i}
i
\pi_{i}
S_{i}
p_{\mathrm{sbn}}(T^{\mathrm{u}}=\tau)=\sum_{s_{1}\sim\tau}p(S_{1}=s_{1})\prod_%
{i>1}p(S_{i}=s_{i}|S_{\pi_{i}}=s_{\pi_{i}})
\sim
\tau
\tau
\mathbb{S}_{\mathrm{r}}
\mathbb{S}_{\mathrm{ch}|\mathrm{pa}}
p(S_{1}=s_{1})=\frac{\exp(\phi_{s_{1}})}{\sum_{s_{\mathrm{r}}\in\mathbb{S}_{%
\mathrm{r}}}\exp(\phi_{s_{\mathrm{r}}})},\quad p(S_{i}=s|S_{\pi_{i}}=t)=\frac{%
\exp(\phi_{s|t})}{\sum_{s\in\mathbb{S}_{\cdot|t}}\exp(\phi_{s|t})}.
\widehat{\bm{x}}_{u}=c_{u}\widehat{\bm{x}}_{\pi_{u}}+\bm{d}_{u},
\pi_{u}
u
u\in V^{b}
c_{u}=0,\;\bm{d}_{u}=\bm{x}_{u}
u
c_{v},\bm{d}_{v}
\forall v\in\mathrm{ch}(u)
u
u
\displaystyle|\mathcal{N}(u)|\widehat{\bm{x}}_{u}=\widehat{\bm{x}}_{\pi_{u}}+%
\sum_{v\in\mathrm{ch}(u)}\widehat{\bm{x}}_{v}
\displaystyle|\mathcal{N}(u)|\widehat{\bm{x}}_{u}
\displaystyle=\widehat{\bm{x}}_{\pi_{u}}+\sum_{v\in\mathrm{ch}(u)}\widehat{\bm%
{x}}_{v}
\displaystyle=\widehat{\bm{x}}_{\pi_{u}}+\sum_{v\in\mathrm{ch}(u)}\left(c_{v}%
\widehat{\bm{x}}_{u}+\bm{d}_{v}\right).
\displaystyle=\widehat{\bm{x}}_{\pi_{u}}+\sum_{v\in\mathrm{ch}(u)}\left(c_{v}%
\widehat{\bm{x}}_{u}+\bm{d}_{v}\right).
\widehat{\bm{x}}_{u}=\frac{1}{|\mathcal{N}(u)|-\sum_{v\in\mathrm{ch}(u)}c_{v}}%
\cdot\widehat{\bm{x}}_{\pi_{u}}+\frac{\sum_{v\in\mathrm{ch}(u)}\bm{d}_{v}}{|%
\mathcal{N}(u)|-\sum_{v\in\mathrm{ch}(u)}c_{v}},
r
c_{v},\bm{d}_{v}
\forall v\in\mathrm{ch}(r)
\displaystyle|\mathcal{N}(r)|\widehat{\bm{x}}_{r}=\sum_{v\in\mathrm{ch}(r)}%
\widehat{\bm{x}}_{v}
\displaystyle|\mathcal{N}(r)|\widehat{\bm{x}}_{r}
\displaystyle=\sum_{v\in\mathrm{ch}(r)}\widehat{\bm{x}}_{v}
\displaystyle=\sum_{v\in\mathrm{ch}(r)}\left(c_{v}\widehat{\bm{x}}_{r}+\bm{d}_%
{v}\right)
\displaystyle=\sum_{v\in\mathrm{ch}(r)}\left(c_{v}\widehat{\bm{x}}_{r}+\bm{d}_%
{v}\right)
\widehat{\bm{x}}_{r}=\frac{\sum_{v\in\mathrm{ch}(r)}\bm{d}_{v}}{|\mathcal{N}(r%
)|-\sum_{v\in\mathrm{ch}(r)}c_{v}}.
u
\widehat{\bm{x}}_{\pi_{u}}
u
\widehat{\bm{x}}_{u}
|\mathcal{N}(u)|\geq 2,\;\forall u\in V^{o}
\lambda\geq 2
c_{u}=0,\;\forall u\in V^{b}
0\leq c_{v}\leq\frac{1}{\lambda-1},\;\forall v\in\mathrm{ch}(u)
0\leq c_{u}\leq\frac{1}{\lambda-1}
u
0\leq c_{u}=\frac{1}{|\mathcal{N}(u)|-\sum_{v\in\mathrm{ch}(u)}c_{v}}\leq\frac%
{1}{|\mathcal{N}(u)|-\sum_{v\in\mathrm{ch}(u)}\frac{1}{\lambda-1}}=\frac{1}{|%
\mathcal{N}(u)|-\frac{|\mathcal{N}(u)|-1}{\lambda-1}}.
2\leq\lambda\leq|\mathcal{N}(u)|
\left(|\mathcal{N}(u)|-\lambda\right)\frac{\lambda-2}{\lambda-1}\geq 0%
\Rightarrow|\mathcal{N}(u)|-\lambda\geq\frac{|\mathcal{N}(u)|-\lambda}{\lambda%
-1}\Rightarrow|\mathcal{N}(u)|-\frac{|\mathcal{N}(u)|-1}{\lambda-1}\geq\lambda%
-1.
0\leq c_{u}\leq\frac{1}{\lambda-1}
\lambda=3\Rightarrow 0\leq c_{u}\leq\frac{1}{2}
\widehat{\bm{x}}_{u}=\frac{1}{|\mathcal{N}(u)|}\sum_{v\in\mathcal{N}(u)}%
\widehat{\bm{x}}_{v},\quad\forall u\in V^{o}.
\forall 1\leq n\leq d
\widehat{\bm{X}}[n]
\widehat{\bm{X}}[n]
u
u
\widehat{\bm{x}}_{u}[n]
\forall u\in V
(i)
S=\{\bm{x}\in\mathbb{R}^{N}|\sum_{n=1}^{N}\bm{x}[n]=1\}
P_{S}
S
\{\widehat{\bm{x}}_{u}\in\mathbb{R}^{N}|u\in V\}
\{P_{S}(\widehat{\bm{x}}_{u})\in\mathbb{R}^{N}|u\in V\}
S
P_{S}(\widehat{\bm{x}}_{u})=\widehat{\bm{x}}_{u},\forall u\in V^{b}
P_{S}
\sum_{(u,v)\in E}\|P_{S}(\widehat{\bm{x}}_{u})-P_{S}(\widehat{\bm{x}}_{v})\|^{%
2}\leq\sum_{(u,v)\in E}\|\widehat{\bm{x}}_{u}-\widehat{\bm{x}}_{v}\|^{2}.
\{\widehat{\bm{x}}_{u}\in\mathbb{R}^{N}|u\in V\}
\widehat{\bm{x}}_{u}-\widehat{\bm{x}}_{v}
S
\forall(u,v)\in E
\widehat{\bm{x}}_{u}\in S,\forall u\in V^{o}
S
{\bm{A}}
{\bm{A}}
\widehat{\bm{x}}_{u}={\bm{A}}\widehat{\bm{y}}_{u},\quad\forall u\in V
\{\widehat{\bm{y}}_{u}\in\mathbb{R}^{N}|u\in V\}
\sum_{v\in\mathcal{N}(u)}\left(\widehat{\bm{y}}_{u}-\widehat{\bm{y}}_{v}\right%
)=\bm{0},\quad\forall u\in V^{o},\qquad\widehat{\bm{y}}_{v}=\bm{y}_{v},\quad%
\forall v\in V^{b},
\{\bm{y}_{v}\in\mathbb{R}^{N}|v\in V^{b}\}
\forall u\in V^{o}
(i)\;0<\widehat{\bm{y}}_{u}[n]<1,\quad\forall 1\leq n\leq N,\quad\text{and}%
\quad(ii)\;\sum_{n=1}^{N}\widehat{\bm{y}}_{u}[n]=1.
v\in V^{b}
\bar{v}\in\mathcal{N}(v)
v
a_{\bar{v}}^{v}>a_{u}^{v},\forall u\in V^{o}\backslash\{\bar{v}\}
\{\bm{x}_{v}|v\in V^{b}\}
a_{u}^{v}=\frac{\sum_{w\in\mathcal{N}(u)}a_{w}^{v}}{|\mathcal{N}(u)|},\quad%
\forall u\in V^{o}.
\tau^{\prime}
v
\tau
\bar{v}
\{a_{u}^{v}|u\in V\backslash\{v\}\}
\tau^{\prime}
\bar{v}
a_{u}^{v}=0,\forall u\in V^{b}\backslash\{v\}
a_{\bar{v}}^{v}>0
a_{\bar{v}}^{v}
a_{\bar{v}}^{v}\geq a_{u}^{v},\forall u\in V^{o}
u\neq\bar{v}
a_{u}^{v}=a_{\bar{v}}^{v}
a_{u}^{v}=a_{\bar{v}}^{v},\forall u\in V\backslash\{v\}
N
N=3
N>3
N-1
\bm{h}_{v}^{(t+1)}=W^{(t)}\frac{\bm{m}_{v}^{(t+1)}}{\sqrt{1+d_{v}}},\quad\bm{m%
}_{v}^{(t+1)}=\sum_{u\in\mathcal{N}(v)\cup\{v\}}\frac{\bm{h}_{u}^{(t)}}{\sqrt{%
1+d_{u}}},
d_{u}
u
\bm{h}_{v}^{(t+1)}=\mathrm{MLP}^{(t)}\left((1+\epsilon^{(t)})\bm{h}_{v}^{(t)}+%
\bm{m}_{v}^{(t+1)}\right),\quad\bm{m}_{v}^{(t+1)}=\sum_{u\in\mathcal{N}(v)}\bm%
{h}_{u}^{(t)},
\epsilon^{(t)}
\bm{h}_{v}^{(t+1)}=W_{1}^{(t)}\bm{h}_{v}^{(t)}+W_{2}^{(t)}\bm{m}_{v}^{(t+1)},%
\quad\bm{m}_{v}^{(t+1)}=\frac{\sum_{u\in\mathcal{N}(v)}\bm{h}_{u}^{(t)}}{d_{v}}.
\bm{h}_{v}^{(t+1)}=\mathrm{GRU}^{(t)}\left(\bm{m}_{v}^{(t+1)},\bm{h}_{v}^{(t)}%
\right),\quad\bm{m}_{v}^{(t+1)}=\sum_{u\in\mathcal{N}(v)}W^{(t)}\bm{h}_{u}^{(t%
)},
\mathrm{GRU}^{(t)}
\bm{h}_{v}^{(t+1)}=\sum_{u\in\mathcal{N}(v)}\bm{e}_{u\rightarrow v}^{(t+1)},%
\quad\bm{e}_{u\rightarrow v}^{(t+1)}=\mathrm{MLP}^{(t)}\left(\bm{h}_{v}^{(t)}%
\;|\!|\;\bm{h}_{u}^{(t)}-\bm{h}_{v}^{(t)}\right),\;\forall u\in\mathcal{N}(v)
|\!|
\bm{e}_{u\rightarrow v}^{(t+1)}
u
v
