f_{e}
z_{img}
z_{t}
M
f_{s}
q_{int_{t}}
r_{\theta}
f_{e}
z_{img}
z_{t}
M
f_{s}
q_{int_{t}}
r_{\theta}
z_{img}
x_{in}
f_{e}
z_{img}
\in\mathcal{R}^{(128,hw)}
h
w
z_{img}
LN
||
\odot
f_{e}
LN
||
\odot
f_{e}
{k}_{r_{t=1}}\leftarrow{}0
\in\mathcal{R}^{128}
{h}_{t=1}\leftarrow{}0
\in\mathcal{R}^{512}
{M}_{t=1}\leftarrow{}\{\}
z_{img}\leftarrow{}f_{e}(x_{in})
\in\mathcal{R}^{(hw,128)}
out,~{}g,~{}q_{int_{t}},~{}h_{t}\leftarrow{}f_{s}(h_{t-1},~{}k_{r_{t-1}})
~{}~{}~{}~{}~{}~{}out\in\mathcal{R}^{512},g\in\mathcal{R}^{128},q_{int_{t}}\in%
\mathcal{R}^{128}
w_{t}\leftarrow{}LN(z_{img}+q_{int_{t}}.repeat(hw,axis=1))
\in\mathcal{R}^{(hw,128)}
z_{t}\leftarrow{}(z_{img}~{}\odot~{}w_{t}.sum(axis=1)).sum(axis=1)
\in\mathcal{R}^{128}
k_{r_{t}}\leftarrow{}0
k_{r_{t}}\leftarrow{}g~{}\odot~{}M_{t-1}.sum(axis=1)
M_{t}\leftarrow{}\{M_{t-1},~{}z_{t}\}
\in\mathcal{R}^{(t,128)}
{all}_{obj}\leftarrow{}r_{{\theta}}(\sum_{i,j=1}^{T}(M_{v_{i}},~{}M_{v_{j}}))
\hat{y}\leftarrow{}f_{\phi}({all}_{obj}~{}||~{}out)
f_{s}
z_{t}
z_{img}
t
z_{t}
w_{t}
\in\mathcal{R}^{128}
z_{img}
q_{int_{t}}
f_{s}
z_{img}
z_{t}
\in\mathcal{R}^{128}
f_{s}
q_{int_{t}}
\in\mathcal{R}^{128}
t
f_{s}
g
\in\mathcal{R}^{128}
out
\in\mathcal{R}^{512}
g
M
out
z_{t}
M
r_{\theta}
all_{obj}
r_{\theta}
z_{t}
M
out
f_{s}
t=T
f_{\phi}
\hat{y}
RN
RN
\mathcal{R}^{128,hw}
h=8
w=8
N=8\times 8=64
all_{obj}
f_{\phi}
RN
N
128\times 128
256\times 256
ResNet
RN
SD
SR
SD
SR
SD
SR
(x,y,z)
z
x
y
x
y
r_{\theta}
M
z
x
y
f_{\phi}
z
z
x
x
z_{img}
SD
SR
out
w_{t}
all_{obj}
g
iNorm
out
w_{t}
all_{obj}
g
iNorm
SR
SD
out
no\_all_{obj}
out
f_{s}
no\_w_{t}
z_{t}
z_{img}
no\_g
\pm 5
all_{obj}
f_{e}
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
f_{e}
f_{e}
f_{e}
f_{s}
out\in\mathcal{R}^{512}
g
q_{int_{t}}
r_{\theta}
t
out
\hat{y}
z_{img}\in\mathcal{R}^{(64,128)}
f_{e}
r_{\theta}
z_{img}
GAMR
z_{img}
\times
\hat{y}
q_{int_{t}}
z_{img}
GAMR
SD
r_{\theta}\in\mathcal{R}^{128}
\mathcal{R}^{128}
q
k
v
z_{img}
q_{int_{t}}
q_{int_{t}}
q
k
v
z_{img}
q_{int_{t}}
q_{int_{t}}
\times
>95\%
x
128\times 128
192\times 192
128\times 128
192\times 192
128\times 128
192\times 192
z_{img}
z_{t}
M
r_{\theta}
z_{img}
f_{e}
z_{img}
z_{t}
z_{img}
f_{s}
z_{t}
128\times 128
x
y
z
f_{e}
centered
jittered
x
y
centered
jittered
x
y
ResNet
RN
ESBN
ResNet
RN
ESBN
f_{e}
