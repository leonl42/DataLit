\beta
\beta
\beta
\beta
\beta
\propto
\beta_{2}
\beta_{1}
\triangle
\diamond
\pentagon
\beta_{2}\!=\!\beta_{1}\!=\!1
\bullet
\beta
\beta_{2}\!=\!\beta_{1}
\propto
\beta_{2}
\beta_{1}
\triangle
\diamond
\pentagon
\beta_{2}\!=\!\beta_{1}\!=\!1
\bullet
\beta
\beta_{2}\!=\!\beta_{1}
\triangle
\pentagon
\diamond
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\mathbf{d}_{1}
\mathbf{x}
\mathbf{d}_{1}
\mathbf{x}
\beta
\beta
{\bm{x}}
L
\{{\bm{z}}_{\ell}\}_{\ell=1}^{L}
{L=2}
p_{\theta}(\{{\bm{z}}_{\ell}\},{\bm{x}})
\theta
p_{\theta}(\{{\bm{z}}_{\ell}\},{\bm{x}})
\displaystyle p_{\theta}(\{{\bm{z}}_{\ell}\},{\bm{x}})=p_{\theta}({\bm{z}}_{L}%
)\,p_{\theta}({\bm{z}}_{L-1}|{\bm{z}}_{L})\,p_{\theta}({\bm{z}}_{L-2}|{\bm{z}}%
_{L-1},{\bm{z}}_{L})\,\cdots\,p_{\theta}({\bm{z}}_{1}|{\bm{z}}_{\geq 2})\,p_{%
\theta}({\bm{x}}|{\bm{z}}_{\geq 1})
\displaystyle p_{\theta}(\{{\bm{z}}_{\ell}\},{\bm{x}})=p_{\theta}({\bm{z}}_{L}%
)\,p_{\theta}({\bm{z}}_{L-1}|{\bm{z}}_{L})\,p_{\theta}({\bm{z}}_{L-2}|{\bm{z}}%
_{L-1},{\bm{z}}_{L})\,\cdots\,p_{\theta}({\bm{z}}_{1}|{\bm{z}}_{\geq 2})\,p_{%
\theta}({\bm{x}}|{\bm{z}}_{\geq 1})
{\bm{z}}_{\geq n}
n
\{{\bm{z}}_{\ell}\}_{\ell=n}^{L}
{\bm{z}}_{\geq 1}
\{{\bm{z}}_{\ell}\}
L
1
\beta
\displaystyle{\mathcal{L}}_{\beta}(\theta,\phi)=\mathbb{E}_{{\bm{x}}\sim{%
\mathbb{X}}_{\text{train}}}\big{[}\underbrace{\mathbb{E}_{q_{\phi}(\{{\bm{z}}_%
{\ell}\}|{\bm{x}})}\big{[}-\log p_{\theta}({\bm{x}}|\{{\bm{z}}_{\ell}\})\big{]%
}}_{=\text{ ``distortion'' $D$}}+\beta\underbrace{D_{\mathrm{KL}}\big{[}q_{%
\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})\,\big{|}\!\big{|}\,p_{\theta}(\{{\bm{z%
}}_{\ell}\})\big{]}}_{=\text{ ``rate'' $R$}}\big{]}.
D
R
\displaystyle{\mathcal{L}}_{\beta}(\theta,\phi)
\displaystyle=\mathbb{E}_{{\bm{x}}\sim{\mathbb{X}}_{\text{train}}}\big{[}%
\underbrace{\mathbb{E}_{q_{\phi}(\{{\bm{z}}_{\ell}\}|{\bm{x}})}\big{[}-\log p_%
{\theta}({\bm{x}}|\{{\bm{z}}_{\ell}\})\big{]}}_{=\text{ ``distortion'' $D$}}+%
\beta\underbrace{D_{\mathrm{KL}}\big{[}q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x%
}})\,\big{|}\!\big{|}\,p_{\theta}(\{{\bm{z}}_{\ell}\})\big{]}}_{=\text{ ``rate%
'' $R$}}\big{]}.
D
R
q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
\phi
{\mathbb{X}}_{\text{train}}
D_{\mathrm{KL}}[\,\cdot\,|\!\!\!\;|\,\cdot\,]
\beta>0
R
D
\beta=1
R
q_{\phi}
\{{\bm{z}}_{\ell}\}
\{{\bm{z}}_{\ell}\}\sim q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
p_{\theta}(\{{\bm{z}}_{\ell}\})
R
D
\beta
R+D
p_{\text{data}}({\bm{x}})
H[p_{\text{data}}({\bm{x}})]:=\mathbb{E}_{p_{\text{data}}({\bm{x}})}[-\log p_{%
\text{data}}({\bm{x}})]
\displaystyle\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R+D]\geq H[p_{\text{data}}%
({\bm{x}})]\qquad\forall\,p_{\text{data}}.
\displaystyle\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R+D]\geq H[p_{\text{data}}%
({\bm{x}})]\qquad\forall\,p_{\text{data}}.
R
\{{\bm{z}}_{\ell}\}
{\bm{z}}_{\ell}
\ell=L
1
q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})=q_{\phi}({\bm{z}}_{1}|{\bm{x}})\,q_%
{\phi}({\bm{z}}_{2}|{\bm{z}}_{1})\cdots q_{\phi}({\bm{z}}_{L}|{\bm{z}}_{L-1})
{\bm{x}}
{\bm{x}}
{\bm{z}}_{1}
q_{\phi}({\bm{z}}_{1}|{\bm{x}})
{\bm{z}}_{1}
p_{\theta}({\bm{x}}|{\bm{z}}_{1})
{\bm{z}}_{\ell}
\ell>1
{\bm{z}}_{\ell}
\ell>1
\{{\bm{z}}_{\ell}\}
\displaystyle q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})=q_{\phi}({\bm{z}}_{L}%
|{\bm{x}})\,q_{\phi}({\bm{z}}_{L-1}\,|\,{\bm{z}}_{L},{\bm{x}})\,q_{\phi}({\bm{%
z}}_{L-2}\,|\,{\bm{z}}_{L-1},{\bm{z}}_{L},{\bm{x}})\,\cdots\,q_{\phi}({\bm{z}}%
_{1}\,|\,{\bm{z}}_{\geq 2},{\bm{x}}).
\displaystyle q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
\displaystyle=q_{\phi}({\bm{z}}_{L}|{\bm{x}})\,q_{\phi}({\bm{z}}_{L-1}\,|\,{%
\bm{z}}_{L},{\bm{x}})\,q_{\phi}({\bm{z}}_{L-2}\,|\,{\bm{z}}_{L-1},{\bm{z}}_{L}%
,{\bm{x}})\,\cdots\,q_{\phi}({\bm{z}}_{1}\,|\,{\bm{z}}_{\geq 2},{\bm{x}}).
q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
{\bm{x}}
\hat{\bm{x}}
{\bm{z}}_{\ell}
\displaystyle{\bm{x}}\xrightarrow{\;q_{\phi}({\bm{z}}_{L}|{\bm{x}})\;}{\bm{z}}%
_{L}\xrightarrow{\;q_{\phi}({\bm{z}}_{L-1}|{\bm{z}}_{L},{\bm{x}})\;}{\bm{z}}_{%
L-1}\longrightarrow\cdots\longrightarrow{\bm{z}}_{2}\xrightarrow{\;q_{\phi}({%
\bm{z}}_{1}|{\bm{z}}_{\geq 2},{\bm{x}})\;}{\bm{z}}_{1}\xrightarrow{\;p_{\theta%
}({\bm{x}}|\{{\bm{z}}_{\ell}\})\;}\hat{{\bm{x}}}.
\displaystyle{\bm{x}}\xrightarrow{\;q_{\phi}({\bm{z}}_{L}|{\bm{x}})\;}{\bm{z}}%
_{L}\xrightarrow{\;q_{\phi}({\bm{z}}_{L-1}|{\bm{z}}_{L},{\bm{x}})\;}{\bm{z}}_{%
L-1}\longrightarrow\cdots\longrightarrow{\bm{z}}_{2}\xrightarrow{\;q_{\phi}({%
\bm{z}}_{1}|{\bm{z}}_{\geq 2},{\bm{x}})\;}{\bm{z}}_{1}\xrightarrow{\;p_{\theta%
}({\bm{x}}|\{{\bm{z}}_{\ell}\})\;}\hat{{\bm{x}}}.
{\bm{x}}
{\bm{z}}_{L}
{\bm{z}}_{1}
\hat{\bm{x}}
q_{\phi}({\bm{z}}_{\ell}\,|\,{\bm{z}}_{\geq\ell+1},{\bm{x}})
{\bm{z}}_{\geq\ell+1}
{\bm{x}}
\hat{\bm{x}}
{\bm{x}}
\{{\bm{z}}_{\ell}\}
R
\displaystyle\begin{split}R&=\mathbb{E}_{q_{\phi}(\{{\bm{z}}_{\ell}\}|{\bm{x}}%
)}\left[\log\frac{q_{\phi}({\bm{z}}_{L}|{\bm{x}})}{p_{\theta}({\bm{z}}_{L})}+%
\log\frac{q_{\phi}({\bm{z}}_{L-1}|{\bm{z}}_{L},{\bm{x}})}{p_{\theta}({\bm{z}}_%
{L-1}|{\bm{z}}_{L})}+\ldots+\log\frac{q_{\phi}({\bm{z}}_{1}|{\bm{z}}_{\geq 2},%
{\bm{x}})}{p_{\theta}({\bm{z}}_{1}|{\bm{z}}_{\geq 2})}\right]\\
&=R({\bm{z}}_{L})+R({\bm{z}}_{L-1}|{\bm{z}}_{L})+R({\bm{z}}_{L-2}\,|\,{\bm{z}}%
_{L-1},{\bm{z}}_{L})+\,\ldots\,+R({\bm{z}}_{1}|{\bm{z}}_{\geq 2}).\end{split}
\displaystyle\begin{split}R&=\mathbb{E}_{q_{\phi}(\{{\bm{z}}_{\ell}\}|{\bm{x}}%
)}\left[\log\frac{q_{\phi}({\bm{z}}_{L}|{\bm{x}})}{p_{\theta}({\bm{z}}_{L})}+%
\log\frac{q_{\phi}({\bm{z}}_{L-1}|{\bm{z}}_{L},{\bm{x}})}{p_{\theta}({\bm{z}}_%
{L-1}|{\bm{z}}_{L})}+\ldots+\log\frac{q_{\phi}({\bm{z}}_{1}|{\bm{z}}_{\geq 2},%
{\bm{x}})}{p_{\theta}({\bm{z}}_{1}|{\bm{z}}_{\geq 2})}\right]\\
&=R({\bm{z}}_{L})+R({\bm{z}}_{L-1}|{\bm{z}}_{L})+R({\bm{z}}_{L-2}\,|\,{\bm{z}}%
_{L-1},{\bm{z}}_{L})+\,\ldots\,+R({\bm{z}}_{1}|{\bm{z}}_{\geq 2}).\end{split}
\displaystyle\begin{split}R({\bm{z}}_{L})&=D_{\mathrm{KL}}\big{[}q_{\phi}({\bm%
{z}}_{L}|{\bm{x}})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{L})\big{]}\qquad%
\text{and}\\
R({\bm{z}}_{\ell}|{\bm{z}}_{\geq\ell+1})&=\mathbb{E}_{q({\bm{z}}_{\geq\ell+1}|%
{\bm{x}})}\big{[}D_{\mathrm{KL}}\big{[}q_{\phi}({\bm{z}}_{\ell}\,|\,{\bm{z}}_{%
\geq\ell+1},{\bm{x}})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{\ell}\,|\,{\bm{z%
}}_{\geq\ell+1})\big{]}\big{]}\end{split}
\displaystyle\begin{split}R({\bm{z}}_{L})&=D_{\mathrm{KL}}\big{[}q_{\phi}({\bm%
{z}}_{L}|{\bm{x}})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{L})\big{]}\qquad%
\text{and}\\
R({\bm{z}}_{\ell}|{\bm{z}}_{\geq\ell+1})&=\mathbb{E}_{q({\bm{z}}_{\geq\ell+1}|%
{\bm{x}})}\big{[}D_{\mathrm{KL}}\big{[}q_{\phi}({\bm{z}}_{\ell}\,|\,{\bm{z}}_{%
\geq\ell+1},{\bm{x}})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{\ell}\,|\,{\bm{z%
}}_{\geq\ell+1})\big{]}\big{]}\end{split}
{\bm{z}}_{L}
{\bm{z}}_{\ell+1}\to{\bm{z}}_{\ell}
L
\beta_{L}
\beta_{L-1}
\beta_{1}
\bm{\beta}
\displaystyle{\mathcal{L}}_{\bm{\beta}}(\theta,\phi)=\mathbb{E}_{{\bm{x}}\sim{%
\mathbb{X}}_{\text{train}}}\big{[}D+\beta_{L}R({\bm{z}}_{L})+\beta_{L-1}R({\bm%
{z}}_{L-1}|{\bm{z}}_{L})+\ldots+\beta_{1}R({\bm{z}}_{1}|{\bm{z}}_{\geq 2})\big%
{]}.
\displaystyle{\mathcal{L}}_{\bm{\beta}}(\theta,\phi)
\displaystyle=\mathbb{E}_{{\bm{x}}\sim{\mathbb{X}}_{\text{train}}}\big{[}D+%
\beta_{L}R({\bm{z}}_{L})+\beta_{L-1}R({\bm{z}}_{L-1}|{\bm{z}}_{L})+\ldots+%
\beta_{1}R({\bm{z}}_{1}|{\bm{z}}_{\geq 2})\big{]}.
\beta
\beta
\{{\bm{z}}_{\ell}\}
\beta
L
\beta
\beta
R({\bm{z}}_{L})
R({\bm{z}}_{\ell}|{\bm{z}}_{\geq\ell+1})
\bm{\beta}
{\bm{x}}
\{{\bm{z}}_{\ell}\}
E_{p_{\text{data}}({\bm{x}})}[D]
\displaystyle\mathbb{E}_{p_{\text{data}}({\bm{x}})}[D]\geq H[p_{\text{data}}({%
\bm{x}})]-\mathbb{E}_{p_{\text{data}}({\bm{x}})}\big{[}R({\bm{z}}_{L})+R({\bm{%
z}}_{L-1}|{\bm{z}}_{L})+\cdots+R({\bm{z}}_{1}|{\bm{z}}_{\geq 2})\big{]}.
\displaystyle\mathbb{E}_{p_{\text{data}}({\bm{x}})}[D]
\displaystyle\geq H[p_{\text{data}}({\bm{x}})]-\mathbb{E}_{p_{\text{data}}({%
\bm{x}})}\big{[}R({\bm{z}}_{L})+R({\bm{z}}_{L-1}|{\bm{z}}_{L})+\cdots+R({\bm{z%
}}_{1}|{\bm{z}}_{\geq 2})\big{]}.
\beta
\{{\bm{z}}_{\ell}\}
{\bm{z}}_{L}
R({\bm{z}}_{L})
R
D
{\bm{x}}
p_{\text{cls.}}(y|{\bm{z}}_{\ell})
{\bm{z}}_{\ell}
\ell
p_{\text{data}}(y,{\bm{x}})=p_{\text{data}}(y)\,p_{\text{data}}({\bm{x}}|y)
{\bm{x}}
y
y\xrightarrow{p_{\text{data}}}{\bm{x}}\xrightarrow{q_{\phi}}{\bm{z}}_{\ell}%
\xrightarrow{p_{\text{cls.}}}\hat{y}
\hat{y}:=\arg\max_{y}p_{\text{cls.}}(y|{\bm{z}}_{\ell})
I_{q}(y;{\bm{z}}_{\ell})
\displaystyle I_{q}(y;{\bm{z}}_{\ell})\leq I_{q}({\bm{x}};{\bm{z}}_{\ell})%
\equiv\mathbb{E}_{p_{\text{data}}({\bm{x}})}\left[\mathbb{E}_{q_{\phi}({\bm{z}%
}_{\ell}|{\bm{x}})}\left[\log\frac{q_{\phi}({\bm{z}}_{\ell}|{\bm{x}})}{q_{\phi%
}({\bm{z}}_{\ell})}\right]\right]
\displaystyle I_{q}(y;{\bm{z}}_{\ell})\leq I_{q}({\bm{x}};{\bm{z}}_{\ell})
\displaystyle\equiv\mathbb{E}_{p_{\text{data}}({\bm{x}})}\left[\mathbb{E}_{q_{%
\phi}({\bm{z}}_{\ell}|{\bm{x}})}\left[\log\frac{q_{\phi}({\bm{z}}_{\ell}|{\bm{%
x}})}{q_{\phi}({\bm{z}}_{\ell})}\right]\right]
\displaystyle=\mathbb{E}_{p_{\text{data}}({\bm{x}})}\left[\mathbb{E}_{q_{\phi}%
({\bm{z}}_{\ell}|{\bm{x}})}\left[\log\frac{q_{\phi}({\bm{z}}_{\ell}|{\bm{x}})}%
{p_{\theta}({\bm{z}}_{\ell})}\right]\right]-D_{\mathrm{KL}}\big{[}q_{\phi}({%
\bm{z}}_{\ell})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{\ell})\big{]}
\displaystyle=\mathbb{E}_{p_{\text{data}}({\bm{x}})}\left[\mathbb{E}_{q_{\phi}%
({\bm{z}}_{\ell}|{\bm{x}})}\left[\log\frac{q_{\phi}({\bm{z}}_{\ell}|{\bm{x}})}%
{p_{\theta}({\bm{z}}_{\ell})}\right]\right]-D_{\mathrm{KL}}\big{[}q_{\phi}({%
\bm{z}}_{\ell})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{\ell})\big{]}
\displaystyle\leq\mathbb{E}_{p_{\text{data}}({\bm{x}})}\bigg{[}\mathbb{E}_{q_{%
\phi}({\bm{z}}_{\geq\ell}|{\bm{x}})}\left[\log\frac{q_{\phi}({\bm{z}}_{\geq%
\ell}|{\bm{x}})}{p_{\theta}({\bm{z}}_{\geq\ell})}\right]
\displaystyle\leq\mathbb{E}_{p_{\text{data}}({\bm{x}})}\bigg{[}\mathbb{E}_{q_{%
\phi}({\bm{z}}_{\geq\ell}|{\bm{x}})}\left[\log\frac{q_{\phi}({\bm{z}}_{\geq%
\ell}|{\bm{x}})}{p_{\theta}({\bm{z}}_{\geq\ell})}\right]
\displaystyle\qquad\qquad\quad-\mathbb{E}_{q_{\phi}({\bm{z}}_{\ell}|{\bm{x}})}%
\Big{[}D_{\mathrm{KL}}\big{[}q_{\phi}({\bm{z}}_{\geq\ell+1}\,|\,{\bm{x}},{\bm{%
z}}_{\ell})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{\geq\ell+1}|{\bm{z}}_{\ell%
})\big{]}\Big{]}\bigg{]}
\displaystyle\qquad\qquad\quad-\mathbb{E}_{q_{\phi}({\bm{z}}_{\ell}|{\bm{x}})}%
\Big{[}D_{\mathrm{KL}}\big{[}q_{\phi}({\bm{z}}_{\geq\ell+1}\,|\,{\bm{x}},{\bm{%
z}}_{\ell})\,\big{|}\!\big{|}\,p_{\theta}({\bm{z}}_{\geq\ell+1}|{\bm{z}}_{\ell%
})\big{]}\Big{]}\bigg{]}
\displaystyle\leq\mathbb{E}_{p_{\text{data}}({\bm{x}})}\big{[}\underbrace{R({%
\bm{z}}_{L})+R({\bm{z}}_{L-1}|{\bm{z}}_{L})+\ldots+R({\bm{z}}_{\ell}\,|\,{\bm{%
z}}_{\geq\ell+1})}_{=:R({\bm{z}}_{\geq\ell})\;(\leq R)}\big{]}.
\displaystyle\leq\mathbb{E}_{p_{\text{data}}({\bm{x}})}\big{[}\underbrace{R({%
\bm{z}}_{L})+R({\bm{z}}_{L-1}|{\bm{z}}_{L})+\ldots+R({\bm{z}}_{\ell}\,|\,{\bm{%
z}}_{\geq\ell+1})}_{=:R({\bm{z}}_{\geq\ell})\;(\leq R)}\big{]}.
q_{\phi}({\bm{z}}_{\ell}):=\mathbb{E}_{p_{\text{data}}({\bm{x}})}[q_{\phi}({%
\bm{z}}_{\ell}|{\bm{x}})]
R({\bm{z}}_{\geq\ell})
{\bm{z}}_{L}
{\bm{z}}_{\ell}
\displaystyle\text{class.~{}accuracy}\leq f^{-1}\big{(}I_{q}(y;{\bm{z}}_{\ell}%
)\big{)}\leq f^{-1}\big{(}\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R({\bm{z}}_{%
\geq\ell})]\big{)}\quad\big{(}\!\leq f^{-1}\big{(}\mathbb{E}_{p_{\text{data}}(%
{\bm{x}})}[R]\big{)}\big{)}
\displaystyle\text{class.~{}accuracy}\leq f^{-1}\big{(}I_{q}(y;{\bm{z}}_{\ell}%
)\big{)}\leq f^{-1}\big{(}\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R({\bm{z}}_{%
\geq\ell})]\big{)}\quad\big{(}\!\leq f^{-1}\big{(}\mathbb{E}_{p_{\text{data}}(%
{\bm{x}})}[R]\big{)}\big{)}
f^{-1}
f(\alpha)=H[p_{\text{data}}(y)]+\alpha\log\alpha+(1-\alpha)\log\frac{1-\alpha}%
{M-1}
M
H[p_{\text{data}}(y)]\leq\log M
{\bm{z}}_{\ell}
R({\bm{z}}_{\geq\ell})
{\bm{z}}_{L}
{\bm{z}}_{\ell}
\beta_{\geq\ell}\to 0
{\bm{z}}_{<\ell}
R({\bm{z}}_{\geq\ell})
{\bm{z}}_{\ell}
{\bm{z}}_{<\ell}
{\bm{z}}_{\ell}
{\bm{z}}_{<\ell}
\beta=1
\beta
1
p_{\theta}
L\geq 2
L=2
32\times 32
28\times 28
p({\bm{z}}_{2})=\mathcal{N}(\mathbf{0},\mathbf{I})
p_{\theta}({\bm{z}}_{1}|{\bm{z}}_{2})=\mathcal{N}(g_{\mu}({\bm{z}}_{2}),g_{%
\sigma}({\bm{z}}_{2})^{2})
p_{\theta}({\bm{x}}|{\bm{z}}_{1})=\mathcal{N}(g_{\mu^{\prime}}({\bm{z}}_{1}),%
\sigma_{\bm{x}}^{2}\mathbf{I})
g_{\mu}
g_{\sigma}
g_{\mu^{\prime}}
p_{\theta}({\bm{x}}|{\bm{z}}_{1})=\operatorname{Bern}(g_{\mu^{\prime}}({\bm{z}%
}_{1}))
q_{\phi}({\bm{z}}_{2}|{\bm{x}})=\mathcal{N}(f_{\mu}({\bm{x}}),f_{\sigma}({\bm{%
x}})^{2})
q_{\phi}({\bm{z}}_{1}|{\bm{x}},{\bm{z}}_{2})=\mathcal{N}(f_{\mu^{\prime}}({\bm%
{x}},{\bm{z}}_{2}),f_{\sigma^{\prime}}({\bm{x}},{\bm{z}}_{2})^{2})
f_{\mu}
f_{\sigma}
f_{\mu^{\prime}}
f_{\sigma^{\prime}}
(\beta_{2},\beta_{1})
21\times 21
0.1
10
\sim\!27
\beta
\beta_{2}=\beta_{1}=1
\beta_{2}=\beta_{1}
R(\mathbf{z}_{2})
R(\mathbf{z}_{1}|\mathbf{z}_{2})
e
{21\!\times\!21}
\beta_{2}
\beta_{1}
\beta
\triangle
\diamond
\pentagon
\beta
\beta_{2}\!=\!\beta_{1}
\beta
R
R
\beta_{2}
\beta_{1}
R
21\times 21
\beta
R
\beta_{2}\!=\!\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\beta_{2}\!=\!\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\mathbb{E}_{{\bm{x}}\sim{\mathbb{X}}_{\text{test}}}[-\log D]
R({\bm{z}}_{1}|{\bm{z}}_{2})
R({\bm{z}}_{2})
\beta
R
\beta
\beta_{2}\!=\!\beta_{1}
{\bm{z}}_{2}
{\bm{z}}_{1}
\bm{\mu}_{2}
\bm{\mu}_{2}
\text{IS}=\exp{\big{\{}\mathbb{E}_{p_{\theta}({\bm{x}})}\big{[}D_{\mathrm{KL}}%
[p_{\text{cls.}}(y|\bm{x})\,|\!|\,p_{\text{cls.}}(y)]\big{]}\big{\}}}=e^{H[p_{%
\text{cls.}}(y)]}\times e^{-\mathbb{E}_{p_{\theta}({\bm{x}})}[H[p_{\text{cls.}%
}(y|{\bm{x}})]]}
p_{\theta}
p_{\text{cls.}}(y|\bm{x})
p_{\text{cls.}}(y):=\mathbb{E}_{p_{\theta}({\bm{x}})}[p_{\text{cls.}}(y|{\bm{x%
}})]
95.02\,\%
94.34\,\%
R(\mathbf{z}_{2})
R(\mathbf{z}_{1}|\mathbf{z}_{2})
\beta_{2}<\beta_{1}
R(\mathbf{z}_{2})
\beta
R(\mathbf{z}_{2})
{\bm{z}}_{2}
{\bm{z}}_{1}
I_{q}(y;{\bm{z}}_{2})
R({\bm{z}}_{2})
R({\bm{z}}_{1}|{\bm{z}}_{2})
\bm{\mu}_{2}:=\arg\max_{{\bm{z}}_{2}}q({\bm{z}}_{2}|{\bm{x}})
I_{q}(y;{\bm{z}}_{2})
R({\bm{z}}_{2})
R({\bm{z}}_{1}|{\bm{z}}_{2})
\bm{\mu}_{2}:=\arg\max_{{\bm{z}}_{2}}q({\bm{z}}_{2}|{\bm{x}})
{\bm{x}}
\{{\bm{z}}_{\ell}\}
k
k=5
\bm{\mu}_{2}
q_{\phi}({\bm{z}}_{2}|{\bm{x}})
\bm{\mu}_{1}
q_{\phi}({\bm{z}}_{1}|{\bm{z}}_{2},{\bm{x}})
{\bm{z}}_{2}\sim q_{\phi}({\bm{z}}_{2}|{\bm{x}})
(\beta_{2},\beta_{1})
\bm{\mu}_{2}
\bm{\mu}_{1}
(\beta_{2},\beta_{1})
\bm{\mu}_{2}
\bm{\mu}_{1}
\bm{\mu}_{2}
\bm{\mu}_{1}
\bm{\mu}_{2}
\bm{\mu}_{1}
\bm{\mu}_{2}
I_{q}(y;{\bm{z}}_{2})
R({\bm{z}}_{2})
\approx
R({\bm{z}}_{2})
R({\bm{z}}_{1}|{\bm{z}}_{2})
\bm{\mu}_{2}
\bm{\mu}_{1}
{\bm{x}}
\bm{\beta}
q({\bm{z}}_{2}|{\bm{x}})
q({\bm{z}}_{1}|{\bm{z}}_{2},{\bm{x}})
p({\bm{z}}_{1}|{\bm{z}}2)
p({\bm{x}}|{\bm{z}}_{1})
{\bm{x}}
{\bm{z}}_{2}
{\bm{z}}_{1}
{\bm{z}}_{2}
\sigma_{\bm{x}}=0.71
{\bm{x}}
{\bm{z}}_{2}
{\bm{z}}_{1}
{\bm{z}}_{2}
\sigma_{\bm{x}}
q({\bm{z}}_{2}|{\bm{x}})
q({\bm{z}}_{1}|{\bm{z}}_{2},{\bm{x}})
p({\bm{z}}_{1}|{\bm{z}}2)
p({\bm{x}}|{\bm{z}}_{1})
\mathbf{d}
{\bm{z}}_{1}
{\bm{z}}_{2}
\sigma_{\bm{x}}=0.71
R({\bm{z}}_{1}|{\bm{z}}_{2})
R({\bm{z}}_{2})
\beta_{2}=\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\beta_{2}=\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\beta_{2}=\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\beta_{2}=\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\beta_{2}=\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
\beta_{2}=\beta_{1}=1
\beta
\beta_{2}=\beta_{1}
p_{\text{data}}(y,{\bm{x}})
{\bm{x}}
y
q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
\ell
y
{\bm{x}}
{\bm{z}}_{\ell}
\displaystyle q(y,{\bm{x}},{\bm{z}}_{\ell}):=p_{\text{data}}(y,{\bm{x}})\,q_{%
\phi}({\bm{z}}_{\ell}|{\bm{x}})
\displaystyle q(y,{\bm{x}},{\bm{z}}_{\ell}):=p_{\text{data}}(y,{\bm{x}})\,q_{%
\phi}({\bm{z}}_{\ell}|{\bm{x}})
q_{\phi}({\bm{z}}_{\ell}|{\bm{x}})
q_{\phi}(\{{\bm{z}}_{\ell}\}\,|\,{\bm{x}})
p_{\text{cls.}}(y|{\bm{z}}_{\ell})
{\bm{z}}_{\ell}
\hat{y}:=\arg\max_{y}p_{\text{cls.}}(y|{\bm{z}}_{\ell})
\alpha:=\mathbb{E}_{q}[\delta_{y,\hat{y}}]
\delta
I_{q}(y;{\bm{z}}_{\ell})
{\bm{z}}_{\ell}
y
q
\displaystyle I_{q}(y;{\bm{z}}_{\ell})\geq f(\alpha)\qquad\text{with}\qquad f(%
\alpha)=H_{p_{\text{data}}}[y]-H_{2}(\alpha)-(1-\alpha)\log(M-1)
\displaystyle I_{q}(y;{\bm{z}}_{\ell})\geq f(\alpha)\qquad\text{with}\qquad f(%
\alpha)=H_{p_{\text{data}}}[y]-H_{2}(\alpha)-(1-\alpha)\log(M-1)
H_{2}(\alpha)=-\alpha\log\alpha-{(1-\alpha)\log(1-\alpha)}
{H_{p_{\text{data}}}[y]\leq\log M}
M
f
[\max_{y}p_{\text{data}}(y),1]
f
\alpha
\displaystyle\alpha\leq f^{-1}(I_{q}(y;{\bm{z}}_{\ell}))\leq f^{-1}\big{(}%
\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R({\bm{z}}_{\geq\ell})]\big{)}.
\displaystyle\alpha\leq f^{-1}(I_{q}(y;{\bm{z}}_{\ell}))\leq f^{-1}\big{(}%
\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R({\bm{z}}_{\geq\ell})]\big{)}.
I_{q}(y;{\bm{z}}_{\ell})\leq\mathbb{E}_{p_{\text{data}}({\bm{x}})}[R({\bm{z}}_%
{\geq\ell})]
f^{-1}
f
\displaystyle I_{q}(y;{\bm{z}}_{\ell})=H_{p_{\text{data}}}[y]-H_{q}[y|{\bm{z}}%
_{\ell}]=H_{p_{\text{data}}}[y]-\mathbb{E}_{{\bm{z}}_{\ell}\sim q({\bm{z}}_{%
\ell})}\big{[}\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell%
})]\big{]}
\displaystyle I_{q}(y;{\bm{z}}_{\ell})
\displaystyle=H_{p_{\text{data}}}[y]-H_{q}[y|{\bm{z}}_{\ell}]=H_{p_{\text{data%
}}}[y]-\mathbb{E}_{{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})}\big{[}\mathbb{E}_{y%
\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell})]\big{]}
H_{q}[y|{\bm{z}}_{\ell}]
{\bm{z}}_{\ell}
y
{\bm{z}}_{\ell}
q({\bm{z}}_{\ell})
q(y|{\bm{z}}_{\ell})
q
H_{p_{\text{data}}}[y]
I_{q}(y;{\bm{z}}_{\ell})
\alpha
H_{q}[y|{\bm{z}}_{\ell}]=\mathbb{E}_{{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})}[%
\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell})]]
\mathbb{E}_{q}[\delta_{y,\hat{y}}]=\alpha
{\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell})]}
y
{\bm{z}}_{\ell}
{\bm{z}}_{\ell}
{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})
{\bm{z}}_{\ell}
{\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell})]}
y=\hat{y}
\hat{y}=\arg\max_{y}p_{\text{cls.}}(y|{\bm{z}}_{\ell})
{\bm{z}}_{\ell}
\displaystyle\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell}%
)]=-q(y\!=\!\hat{y}|{\bm{z}}_{\ell})\log q(y\!=\!\hat{y}|{\bm{z}}_{\ell})-\sum%
_{y\neq\hat{y}}q(y|{\bm{z}}_{\ell})\log q(y|{\bm{z}}_{\ell}).
\displaystyle\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell})]
\displaystyle=-q(y\!=\!\hat{y}|{\bm{z}}_{\ell})\log q(y\!=\!\hat{y}|{\bm{z}}_{%
\ell})-\sum_{y\neq\hat{y}}q(y|{\bm{z}}_{\ell})\log q(y|{\bm{z}}_{\ell}).
(M-1)
y\neq\hat{y}
{(1-q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))}
q(y\!=\!\hat{y}|{\bm{z}}_{\ell})
q(y|{\bm{z}}_{\ell})
{(1-q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))}
(M-1)
\displaystyle\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell}%
)]\leq-q(y\!=\!\hat{y}|{\bm{z}}_{\ell})\log q(y\!=\!\hat{y}|{\bm{z}}_{\ell})-(%
1-q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))\log\frac{1-q(y\!=\!\hat{y}|{\bm{z}}_{\ell}%
)}{M-1}
\displaystyle\mathbb{E}_{y\sim q(y|{\bm{z}}_{\ell})}[-\log q(y|{\bm{z}}_{\ell})]
\displaystyle\leq-q(y\!=\!\hat{y}|{\bm{z}}_{\ell})\log q(y\!=\!\hat{y}|{\bm{z}%
}_{\ell})-(1-q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))\log\frac{1-q(y\!=\!\hat{y}|{\bm%
{z}}_{\ell})}{M-1}
\displaystyle=H_{2}(q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))+(1-q(y\!=\!\hat{y}|{\bm{%
z}}_{\ell}))\log(M-1).
\displaystyle=H_{2}(q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))+(1-q(y\!=\!\hat{y}|{\bm{%
z}}_{\ell}))\log(M-1).
\displaystyle I_{q}(y;{\bm{z}}_{\ell})\geq H_{p_{\text{data}}}[y]-\mathbb{E}_{%
{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})}\big{[}H_{2}(q(y\!=\!\hat{y}|{\bm{z}}_{%
\ell}))\big{]}-\mathbb{E}_{{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})}\big{[}1-q(y%
\!=\!\hat{y}|{\bm{z}}_{\ell})\big{]}\log(M-1).
\displaystyle I_{q}(y;{\bm{z}}_{\ell})
\displaystyle\geq H_{p_{\text{data}}}[y]-\mathbb{E}_{{\bm{z}}_{\ell}\sim q({%
\bm{z}}_{\ell})}\big{[}H_{2}(q(y\!=\!\hat{y}|{\bm{z}}_{\ell}))\big{]}-\mathbb{%
E}_{{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})}\big{[}1-q(y\!=\!\hat{y}|{\bm{z}}_{%
\ell})\big{]}\log(M-1).
H_{2}
{\mathbb{E}_{{\bm{z}}_{\ell}\sim q({\bm{z}}_{\ell})}[q(y\!=\!\hat{y}|{\bm{z}}_%
{\ell})]}={q(y\!=\!\hat{y})}=\alpha
