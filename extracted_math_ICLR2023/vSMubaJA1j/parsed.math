\mathcal{O}(L\log L)
\mathcal{O}(1)
L
L
\mathcal{O}(L^{2})
J
\mathcal{O}(J\cdot L^{2})
\mathcal{O}(L\log L)
\mathcal{O}(L\log L)
\mathcal{O}(L)
\mathcal{O}(L^{2})
\mathcal{O}(L\log L)
\mathcal{O}(L\log L)
J
\mathcal{O}((2-\epsilon)L\log L)
\mathcal{X}^{t}=\{\mathbf{x}^{t}_{1},\ldots,\mathbf{x}^{t}_{L_{x}}~{}|~{}%
\mathbf{x}^{t}_{i}\in\mathbb{R}^{d_{x}}\}
t
\mathcal{Y}^{t}=\{\mathbf{y}^{t}_{1},\ldots,\mathbf{y}^{t}_{L_{y}}~{}|~{}%
\mathbf{y}^{t}_{i}\in\mathbb{R}^{d_{y}}\}
L_{y}
d_{y}\geq 1
\mathcal{X}^{t}
\mathcal{H}^{t}
\mathcal{Y}^{t}
\mathcal{H}^{t}=\{\mathbf{h}^{t}_{1},\ldots,\mathbf{h}^{t}_{L_{h}}\}
\mathbf{h}^{t}_{k+1}
\mathbf{h}^{t}_{k}
k
(k+1)
\mathbf{y}^{t}_{k+1}
\mathcal{A}(\mathbf{Q},\mathbf{K},\mathbf{V})=\textrm{Softmax}({\mathbf{Q}%
\mathbf{K}^{\top}}/{\sqrt{d}})\mathbf{V}
\mathbf{Q}\in\mathbb{R}^{L_{Q}\times d}
\mathbf{K}\in\mathbb{R}^{L_{K}\times d}
\mathbf{V}\in\mathbb{R}^{L_{V}\times d}
d
\mathbf{q}_{i}
\mathbf{k}_{i}
\mathbf{v}_{i}
i
\mathbf{Q}
\mathbf{K}
\mathbf{V}
i
\mathcal{A}(\mathbf{q}_{i},\mathbf{K},\mathbf{V})=\sum_{j}\frac{k(\mathbf{q}_{%
i},\mathbf{k}_{j})}{\sum_{l}k(\mathbf{q}_{i},\mathbf{k}_{l})}\mathbf{v}_{j}=%
\mathbb{E}_{p(\mathbf{k}_{j}|\mathbf{q}_{i})}[\mathbf{v}_{j}]~{},
p(\mathbf{k}_{j}|\mathbf{q}_{i})={k(\mathbf{q}_{i},\mathbf{k}_{j})}/{\sum_{l}k%
(\mathbf{q}_{i},\mathbf{k}_{l})}
k(\mathbf{q}_{i},\mathbf{k}_{j})
\exp({\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}/{\sqrt{d}})
p(\mathbf{k}_{j}|\mathbf{q}_{i})
\mathcal{O}(L_{Q}L_{K})
p(\mathbf{k}_{j}|\mathbf{q}_{i})
i
p(\mathbf{k}_{j}|\mathbf{q}_{i})
\mathbf{v}
p(\mathbf{k}_{j}|\mathbf{q}_{i})
q(\mathbf{k}_{j}|\mathbf{q}_{i})={1}/{L_{K}}
\mathbf{V}
p
q
KL(q||p)=\ln\sum_{l=1}^{L_{K}}e^{{\mathbf{q}_{i}\mathbf{k}_{l}^{\top}}/{\sqrt{%
d}}}-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}/{%
\sqrt{d}}-\ln L_{K}
i
M(\mathbf{q}_{i},\mathbf{K})=\ln\sum_{j=1}^{L_{K}}e^{\frac{\mathbf{q}_{i}%
\mathbf{k}_{j}^{\top}}{\sqrt{d}}}-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}\frac{%
\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}{\sqrt{d}}\qquad,
\mathbf{q}_{i}
i
M(\mathbf{q}_{i},\mathbf{K})
p
u
\mathcal{A}(\mathbf{Q},\mathbf{K},\mathbf{V})=\textrm{Softmax}(\frac{\overline%
{\mathbf{Q}}\mathbf{K}^{\top}}{\sqrt{d}})\mathbf{V}\qquad,
\overline{\mathbf{Q}}
\mathbf{q}
u
M(\mathbf{q},\mathbf{K})
c
u=c\cdot\ln{L_{Q}}
\mathcal{O}(\ln{L_{Q}})
\mathcal{O}(L_{K}\ln{L_{Q}})
M(\mathbf{q}_{i},\mathbf{K})
\mathcal{O}(L_{Q}L_{K})
\mathbf{q}_{i}\in\mathbb{R}^{d}
\mathbf{k}_{j}\in\mathbb{R}^{d}
\mathbf{K}
\ln L_{K}\leq M(\mathbf{q}_{i},\mathbf{K})\leq\max_{j}\{{\mathbf{q}_{i}\mathbf%
{k}_{j}^{\top}}/{\sqrt{d}}\}-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}\{{\mathbf{q}_{i%
}\mathbf{k}_{j}^{\top}}/{\sqrt{d}}\}+\ln L_{K}
\mathbf{q}_{i}\in\mathbf{K}
\overline{M}(\mathbf{q}_{i},\mathbf{K})=\max_{j}\{\frac{\mathbf{q}_{i}\mathbf{%
k}_{j}^{\top}}{\sqrt{d}}\}-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}\frac{\mathbf{q}_{%
i}\mathbf{k}_{j}^{\top}}{\sqrt{d}}\quad.
u
U=L_{K}\ln L_{Q}
\overline{M}(\mathbf{q}_{i},\mathbf{K})
u
\overline{\mathbf{Q}}
\overline{M}(\mathbf{q}_{i},\mathbf{K})
L_{Q}=L_{K}=L
\mathcal{O}(L\ln L)
t
\mathcal{X}^{t}
\mathbf{X}^{t}_{\textrm{en}}\in\mathbb{R}^{L_{x}\times d_{\textrm{model}}}
\mathbf{V}
n
j
(j+1)
\mathbf{X}^{t}_{j+1}=\mathrm{MaxPool}\left(~{}\mathrm{ELU}(~{}\mathrm{Conv1d}(%
[\mathbf{X}^{t}_{j}]_{\mathrm{AB}})~{})~{}\right)\quad,
[\cdot]_{\text{{AB}}}
\textrm{Conv1d}(\cdot)
\textrm{ELU}(\cdot)
\mathbf{X}^{t}
\mathcal{O}((2-\epsilon)L\log L)
\epsilon
\mathbf{X}^{t}_{\textrm{de}}=\textrm{Concat}(\mathbf{X}^{t}_{\textrm{token}},%
\mathbf{X}^{t}_{\mathbf{0}})\in\mathbb{R}^{(L_{\textrm{token}}+L_{y})\times d_%
{\textrm{model}}}\quad,
\mathbf{X}^{t}_{\textrm{token}}\in\mathbb{R}^{L_{\textrm{token}}\times d_{%
\textrm{model}}}
\mathbf{X}^{t}_{\mathbf{0}}\in\mathbb{R}^{L_{y}\times d_{\textrm{model}}}
-\infty
d_{y}
L_{\textrm{token}}
\mathbf{X}_{\textrm{de}}=\{\mathbf{X}_{5d},\mathbf{X}_{\mathbf{0}}\}
\mathbf{X}_{\mathbf{0}}
1e^{-4}
L_{y}
\textrm{MSE}=\frac{1}{n}\sum_{i=1}^{n}(\mathbf{y}-\hat{\mathbf{y}})^{2}
\textrm{MAE}=\frac{1}{n}\sum_{i=1}^{n}|\mathbf{y}-\hat{\mathbf{y}}|
\textrm{stride}=1
\mathcal{O}(L\log L)
\mathcal{O}(L\log L)
\mathcal{O}(L^{2})
\mathcal{O}(L^{2})
L
\mathcal{O}(L\log L)
\mathcal{O}(L^{2})
\mathcal{O}(L\log L)
\mathcal{O}(L\log L)
L
\mathcal{O}(L)
\mathcal{O}(L)
L
{\star}
L
L
>
\leq 336
c=5
\mathcal{O}(L^{2})
>720
\star
t
\mathcal{X}^{t}
p
d_{\rm{model}}
\begin{aligned} \textrm{PE}_{(pos,2j)}=\sin(pos/(2L_{x})^{2j/d_{\rm{model}}})%
\\
\textrm{PE}_{(pos,2j+1)}=\cos(pos/(2L_{x})^{2j/d_{\rm{model}}})\end{aligned}\quad,
j\in\{1,\dots,\lfloor{d_{\rm{model}}}/{2}\rfloor\}
\textrm{SE}_{(pos)}
\mathbf{x}^{t}_{i}
d_{\rm{model}}
\mathbf{u}^{t}_{i}
\mathcal{X}^{t}_{\textrm{feed}[i]}=\alpha\mathbf{u}^{t}_{i}+\textrm{PE}_{(L_{x%
}\times(t-1)+i,~{})}\!+\!\sum_{p}[\textrm{SE}_{(L_{x}\times(t-1)+i)}]_{p}\quad,
i\in\{1,\dots,L_{x}\}
\alpha
\alpha=1
\mathbf{q}_{i}
d
\mathbf{k}_{j}
M(\mathbf{q}_{i},\mathbf{K})=\ln\sum_{j=1}^{L_{K}}e^{{\mathbf{q}_{i}\mathbf{k}%
_{j}^{\top}}/{\sqrt{d}}}-\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}({\mathbf{q}_{i}%
\mathbf{k}_{j}^{\top}}/{\sqrt{d}})
\mathbf{q}_{i}
M(\mathbf{q}_{i},\mathbf{K})
\mathbf{q}_{i}
f_{i}(\mathbf{K})=\ln\sum_{j=1}^{L_{K}}e^{{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}%
}/{\sqrt{d}}}
f_{i}(\mathbf{K})
f_{i}(\mathbf{K})
\mathbf{k}_{j}
M(\mathbf{q}_{i},\mathbf{K})
\mathbf{k}_{j}
\frac{\partial M(\mathbf{q}_{i},\mathbf{K})}{\partial\mathbf{k}_{j}}=\frac{e^{%
\mathbf{q}_{i}\mathbf{k}_{j}^{\top}/{\sqrt{d}}}}{\sum_{j=1}^{L_{K}}e^{\mathbf{%
q}_{i}\mathbf{k}_{j}^{\top}/{\sqrt{d}}}}\cdot\frac{\mathbf{q}_{i}}{\sqrt{d}}-%
\frac{1}{L_{K}}\cdot\frac{\mathbf{q}_{i}}{\sqrt{d}}
\vec{\nabla}M(\mathbf{q}_{i})=\vec{0}
\mathbf{q}_{i}\mathbf{k}_{1}^{\top}+\ln L_{K}=\cdots=\mathbf{q}_{i}\mathbf{k}_%
{j}^{\top}+\ln L_{K}=\cdots=\ln\sum_{j=1}^{L_{K}}e^{\mathbf{q}_{i}\mathbf{k}_{%
j}^{\top}}
\mathbf{k}_{1}=\mathbf{k}_{2}=\cdots=\mathbf{k}_{L_{K}}
\ln L_{K}
M(\mathbf{q}_{i},\mathbf{K})\geq\ln L_{K}\qquad.
\max_{j}\{{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}/{\sqrt{d}}\}
\begin{aligned} M(\mathbf{q}_{i},\mathbf{K})&=\ln\sum_{j=1}^{L_{K}}e^{\frac{{%
\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}}{{\sqrt{d}}}}\!-\!\frac{1}{L_{K}}\sum_{j=%
1}^{L_{K}}(\frac{{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}}{\sqrt{d}})\\
&\leq\ln(L_{K}\!\cdot\!\max_{j}\{\frac{{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}}{%
\sqrt{d}}\})\!-\!\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}(\frac{\mathbf{q}_{i}\mathbf%
{k}_{j}^{\top}}{\sqrt{d}})\\
&=\ln L_{K}\!+\!\max_{j}\{\frac{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}{\sqrt{d}}%
\}\!-\!\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}(\frac{\mathbf{q}_{i}\mathbf{k}_{j}^{%
\top}}{\sqrt{d}})\end{aligned}.
\mathbf{k}_{j}\sim\mathcal{N}(\mu,\Sigma)
\mathbf{qk}_{i}
\{({\mathbf{q}_{i}\mathbf{k}_{j}^{\top}})/{\sqrt{d}}~{}|~{}j=1,\ldots,L_{K}\}
\forall M_{m}=\max_{i}M(\mathbf{q}_{i},\mathbf{K})
\kappa>0
\forall\mathbf{q}_{1},\mathbf{q}_{2}\in\{\mathbf{q}|M(\mathbf{q},\mathbf{K})%
\in[M_{m},M_{m}-\kappa)\}
\overline{M}(\mathbf{q}_{1},\mathbf{K})>\overline{M}(\mathbf{q}_{2},\mathbf{K})
\mathrm{Var}(\mathbf{qk}_{1})>\mathrm{Var}(\mathbf{qk}_{2})
M(\mathbf{q}_{1},\mathbf{K})>M(\mathbf{q}_{2},\mathbf{K})
a_{i,j}={q_{i}k_{j}^{T}}/{\sqrt{d}}
A_{i}=[a_{i,1},\cdots,a_{i,L_{k}}]
\frac{1}{L_{K}}\sum_{j=1}^{L_{K}}({\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}/{\sqrt%
{d}})=\mathrm{mean}(A_{i})
\bar{M}\left(\mathbf{q}_{i},\mathbf{K}\right)=\max(A_{i})-\mathrm{mean}(A_{i})
i=1,2
M\left(\mathbf{q}_{i},\mathbf{K}\right)
a_{i,j}=\mathrm{mean}(A_{i})+\Delta a_{i,j},j=1,\cdots,L_{k}
\begin{aligned} M\left(\mathbf{q}_{i},\mathbf{K}\right)=&\ln\sum_{j=1}^{L_{K}}%
e^{{\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}/{\sqrt{d}}}-\frac{1}{L_{K}}\sum_{j=1}%
^{L_{K}}({\mathbf{q}_{i}\mathbf{k}_{j}^{\top}}/{\sqrt{d}})\\
=&\ln(\Sigma_{j=1}^{L_{k}}e^{\mathrm{mean}(A_{i})}e^{\Delta a_{i,j}})-\mathrm{%
mean}(A_{i})\\
=&\ln(e^{\mathrm{mean}(A_{i})}\Sigma_{j=1}^{L_{k}}e^{\Delta a_{i,j}})-\mathrm{%
mean}(A_{i})\\
=&\ln(\Sigma_{j=1}^{L_{k}}e^{\Delta a_{i,j}})\end{aligned},
\Sigma_{j=1}^{L_{k}}\Delta a_{i,j}=0
ES(A_{i})=\Sigma_{j=1}^{L_{k}}\exp(\Delta a_{i,j})
A_{i}=[\Delta a_{i,1},\cdots,\Delta a_{i,L_{k}}]
\forall A_{1},A_{2}
\max(A_{1})-\mathrm{mean}(A_{1})\geq\max(A_{2})-\mathrm{mean}(A_{2})
\mathrm{Var}(A_{1})>\mathrm{Var}(A_{2})
ES(A_{1})>ES(A_{2})
\mathrm{Var}(A_{1})-\mathrm{Var}(A_{2})
\forall M_{m}=\max_{i}M(\mathbf{q}_{i},\mathbf{K})
\kappa>0
\forall\mathbf{q}_{i},\mathbf{q}_{j}\in\{\mathbf{q}|M(\mathbf{q},\mathbf{K})%
\in[M_{m},M_{m}-\kappa)\}
\max(A_{1})-\mathrm{mean}(A_{1})\geq\max(A_{2})-\mathrm{mean}(A_{2})
\mathrm{Var}(A_{1})>\mathrm{Var}(A_{2})
M(\mathbf{q}_{1},\mathbf{K})>M(\mathbf{q}_{2},\mathbf{K})
ES(A_{1})>ES(A_{2})
\mathbf{k}_{\mathbf{j}}\sim\mathcal{N}(\mu,\Sigma)
k_{1},\cdots,k_{n}
a_{i,j}={q_{i}k_{j}^{T}}/{\sqrt{d}}
n\rightarrow\infty
\Delta a_{1,m}\sim N(0,\sigma_{1}^{2}),\Delta a_{2,m}\sim N(0,\sigma_{2}^{2}),%
\forall m\in 1,\cdots,L_{k}
ES(A_{1})
ES(A_{1})
E(ES(A_{1}))=ne^{\frac{\sigma_{1}^{2}}{2}}
\mathrm{Var}(ES(A_{1}))=ne^{\sigma_{1}^{2}}(e^{\sigma_{1}^{2}}-1)
E(ES(A_{2}))=ne^{\frac{\sigma_{2}^{2}}{2}}
\mathrm{Var}(ES(A_{2}))=ne^{\sigma_{2}^{2}}(e^{\sigma_{2}^{2}}-1)
B_{1}=ES(A_{1}),B_{2}=ES(A_{2})
Pr(B_{1}-B_{2}>0)
\sigma_{1}^{2}>\sigma_{2}^{2}
S_{1}
S_{2}
\frac{dS_{i}}{S_{i}}=\sigma_{i}dZ_{i}
i=1,2,
dZ_{1,2}
S_{1,2}
\sigma_{i}^{2}=\operatorname{Var}\left(\ln S_{i}\right)
S^{\pm}\equiv S_{1}\pm S_{2}
S_{0}^{\pm}\equiv S_{10}\pm S_{20}
P\left(S_{1},S_{2},t;S_{10},S_{20},t_{0}\right)
S_{1}
S_{2}
t>t_{0}
S_{10}
S_{20}
t_{0}
\pm
+
-
\bar{P}_{\pm}\left(S^{\pm},t;S_{10},S_{20},t_{0}\longrightarrow t\right)=%
\delta\left(S_{10}\pm S_{20}-S^{\pm}\right)\quad,
\displaystyle\qquad f^{\mathrm{LN}}\left(\tilde{S}^{\pm},t;\tilde{S}_{0}^{\pm}%
,t_{0}\right)
\displaystyle\qquad f^{\mathrm{LN}}\left(\tilde{S}^{\pm},t;\tilde{S}_{0}^{\pm}%
,t_{0}\right)
\displaystyle=\frac{1}{\widetilde{S}^{\pm}\sqrt{2\pi\tilde{\sigma}_{\pm}^{2}%
\left(t-t_{0}\right)}}
\displaystyle=
\displaystyle\frac{1}{\widetilde{S}^{\pm}\sqrt{2\pi\tilde{\sigma}_{\pm}^{2}%
\left(t-t_{0}\right)}}
\displaystyle\cdot\exp\left\{-\frac{\left[\ln\left(\tilde{S}^{+}/\tilde{S}_{0}%
^{+}\right)+(1/2)\tilde{\sigma}_{\pm}^{2}\left(t-t_{0}\right)\right]^{2}}{2%
\tilde{\sigma}_{\pm}^{2}\left(t-t_{0}\right)}\right\}\quad.
\displaystyle\cdot\exp\left\{-\frac{\left[\ln\left(\tilde{S}^{+}/\tilde{S}_{0}%
^{+}\right)+(1/2)\tilde{\sigma}_{\pm}^{2}\left(t-t_{0}\right)\right]^{2}}{2%
\tilde{\sigma}_{\pm}^{2}\left(t-t_{0}\right)}\right\}\quad.
\tilde{S}^{+}
\tilde{S}^{-}
\tilde{S}_{0}^{\pm}
t_{0}
\tilde{\sigma}_{\pm}^{2}\left(t-t_{0}\right)
t-t_{0}=1
\widetilde{S}_{0}^{-}=(S_{10}-S_{20})+\left(\frac{\sigma_{-}^{2}}{\sigma_{1}^{%
2}-\sigma_{2}^{2}}\right)(S_{10}+S_{20}),\\

\tilde{\sigma_{-}}=\left(\sigma_{1}^{2}-\sigma_{2}^{2}\right)/\left(2\sigma_{-%
}\right)\\

\sigma_{-}=\sqrt{\sigma_{1}^{2}+\sigma_{2}^{2}}
E(B_{1})>E(B_{2})
\mathrm{Var}(B_{1})>\mathrm{Var}(B_{2})
\sigma_{1}^{2}-\sigma_{2}^{2}
f^{\mathrm{LN}}\left(\tilde{S}^{\pm},t;\tilde{S}_{0}^{\pm},t_{0}\right)
\sigma_{1}^{2}-\sigma_{2}^{2}
\tilde{\sigma}_{\pm}^{2}\left(t-t_{0}\right)
B_{1}-B_{2}
\sigma_{1}^{2}>\sigma_{2}^{2}
B_{1}>B_{2}
ES(A_{1})>ES(A_{2})
\mathbf{q}_{1},\mathbf{q}_{2}\in\{\mathbf{q}|M(\mathbf{q},\mathbf{K})\in[M_{m}%
,M_{m}-\kappa)\}
M(q_{1},\mathbf{k})=ln(B_{1})>(M_{m}-\kappa)
\forall q_{1},q_{2}
E(B_{1}))=ne^{\frac{\sigma_{1}^{2}}{2}}
\forall q_{i}
\exists\alpha,\sigma_{i}^{2}>\alpha,i=1,2
\widetilde{S}_{0}^{-}=(S_{10}-S_{20})+\left(\frac{\sigma_{-}^{2}}{\sigma_{1}^{%
2}-\sigma_{2}^{2}}\right)(S_{10}+S_{20})
\sigma_{1}^{2}+\sigma_{2}^{2}>2\alpha
\sigma_{1}^{2}-\sigma_{2}^{2}
\sigma_{1}^{2}>\sigma_{2}^{2}
Pr(M(q_{1},\mathbf{k})>M(q_{2},\mathbf{k}))\approx\Phi(\frac{\widetilde{S}_{0}%
^{-}}{\tilde{\sigma_{-}}})
\sigma_{1}^{2}+\sigma_{2}^{2}>2\alpha
A_{1},A_{2}
top-\lfloor\frac{1}{4}L_{k}\rfloor
A_{1},A_{2}
A_{1}^{{}^{\prime}},A_{2}^{{}^{\prime}}
\sigma_{1},\sigma_{2}
E(A_{1}^{{}^{\prime}}),E(A_{2}^{{}^{\prime}})
S_{10},S_{20}
top-\lfloor\frac{1}{4}L_{k}\rfloor
U
top-\lfloor\frac{1}{4}L_{k}\rfloor
A_{1}
A_{2}
99\%
[M_{m},M_{m}-\kappa)
q_{1},q_{2}
M(\mathbf{q}_{1},\mathbf{K})>M(\mathbf{q}_{2},\mathbf{K})
S_{1}-S_{2}
S_{1}-S_{2}
d
n
p=0.1
d=512
h=16
d=32
p=0.1
d_{\rm{inner}}=2048
p=0.1
\textrm{stride}=2
d=512
h=8
d=64
p=0.1
d_{\rm{inner}}=2048
p=0.1
d=d_{\rm{out}}
\textrm{cmusum}(\cdot)
\textrm{mean}(\cdot)
\textrm{sum}(\cdot)
\textrm{mean}(\cdot)
\mathbf{Q}\in\mathbb{R}^{m\times d}
\mathbf{K}\in\mathbb{R}^{n\times d}
\mathbf{V}\in\mathbb{R}^{n\times d}
c
u=c\ln m
U=m\ln n
U
\mathbf{K}
\bar{\mathbf{K}}
\bar{\mathbf{S}}=\mathbf{Q}\bar{\mathbf{K}}^{\top}
M=\textrm{max}(\bar{\mathbf{S}})-\textrm{mean}(\bar{\mathbf{S}})
u
M
\bar{\mathbf{Q}}
\mathbf{S}_{1}=\textrm{softmax}(\bar{\mathbf{Q}}\mathbf{K}^{\top}/\sqrt{d})%
\cdot\mathbf{V}
\mathbf{S}_{0}=\textrm{mean}(\mathbf{V})
\mathbf{S}=\{\mathbf{S}_{1},\mathbf{S}_{0}\}
\mathbf{S}
