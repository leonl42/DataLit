{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{c}}_{k}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{c}}_{k}({\mathbf{x}})
y({\mathbf{x}})\mkern 1.25mu{=}\mkern 1.25mu{\mathbf{W}}{\mathbf{x}}
y({\mathbf{x}})
c_{i}\mkern 1.25mu{=}\mkern 1.25muw_{i}\,x_{i}
i
y\mkern 1.25mu{=}\mkern 1.25mu\sum_{i}c_{i}
{\mathbf{W}}({\mathbf{x}})
{\mathbf{y}}({\mathbf{x}})\mkern 1.25mu{=}\mkern 1.25mu{\mathbf{W}}({\mathbf{x%
}}){\mathbf{x}}
L
\displaystyle{\mathbf{y}}({\mathbf{x}})=\text{Classifier}\circ\textstyle\prod_%
{l=1}^{L}\left(\text{MLPBlock}_{l}\circ\text{AttBlock}_{l}\right)\,\circ\text{%
Tokens}({\mathbf{x}})\,.
\displaystyle{\mathbf{y}}({\mathbf{x}})=\text{Classifier}\circ\textstyle\prod_%
{l=1}^{L}\left(\text{MLPBlock}_{l}\circ\text{AttBlock}_{l}\right)\,\circ\text{%
Tokens}({\mathbf{x}})\,.
{\mathbf{x}}\in\mathbb{R}^{(CHW)}
H\mkern 1.25mu{=}\mkern 1.25muW
C
\circ
{\mathbf{P}},{\mathbf{E}}\in\mathbb{R}^{D\times N}
N
D
\mathcal{T}
{\mathbf{p^{\prime}}}({\mathbf{p}})\mkern 1.25mu{=}\mkern 1.25mu{\mathbf{W}}{%
\mathbf{p}}\mkern 1.25mu{+}\mkern 1.25mu{\mathbf{b}}
{\mathbf{W}}
{\mathbf{b}}
{\mathbf{p}}
{\mathbf{P}}
{\mathbf{E}}
{\mathbf{y}}({\mathbf{x}})\in\mathbb{R}^{M}
M
{\mathbf{y}}({\mathbf{x}})={\mathbf{W}}({\mathbf{x}})\,{\mathbf{x}}
{\mathbf{W}}({\mathbf{x}})
\displaystyle\text{Tokens}\,({\mathbf{x}})
\displaystyle\text{Tokens}\,(
\displaystyle{\mathbf{x}})
\displaystyle=\;\mathcal{T}(\text{CNN}({\mathbf{x}}))+{\mathbf{E}}\;\;{{\color%
[rgb]{0.15234375,0.62109375,0.80859375}\xrightarrow{\hphantom{\text{1234}}}}}\;\;
\displaystyle=\;\mathcal{T}(\text{CNN}({\mathbf{x}}))+{\mathbf{E}}
\displaystyle\;\;{{\color[rgb]{0.15234375,0.62109375,0.80859375}\xrightarrow{%
\hphantom{\text{1234}}}}}\;\;
\displaystyle\text{{{\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos Tokens%
}}}({\mathbf{x}})
\displaystyle({\mathbf{x}})
\displaystyle={\mathbf{W}}^{\text{Tokens}}({\mathbf{x}})
\displaystyle={\mathbf{W}}^{\text{Tokens}}
\displaystyle({\mathbf{x}})
\displaystyle\;{\mathbf{x}}
\displaystyle\;{\mathbf{x}}
\displaystyle\text{AttBlock}\,({\mathbf{P}})
\displaystyle\text{AttBlock}\,(
\displaystyle{\mathbf{P}})
\displaystyle=\;\text{MSA}({\mathbf{P}})+{\mathbf{P}}\;\;{{\color[rgb]{%
0.15234375,0.62109375,0.80859375}\xrightarrow{\hphantom{\text{1234}}}}}\;\;
\displaystyle=\;\text{MSA}({\mathbf{P}})+{\mathbf{P}}
\displaystyle\;\;{{\color[rgb]{0.15234375,0.62109375,0.80859375}\xrightarrow{%
\hphantom{\text{1234}}}}}\;\;
\displaystyle\text{{{\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos %
AttBlock}}}({\mathbf{P}})
\displaystyle({\mathbf{P}})
\displaystyle={\mathbf{W}}^{\text{Att}}({\mathbf{P}})
\displaystyle={\mathbf{W}}^{\text{Att}}
\displaystyle({\mathbf{P}})
\displaystyle\;{\mathbf{P}}
\displaystyle\;{\mathbf{P}}
\displaystyle\text{MLPBlock}\,({\mathbf{P}})
\displaystyle\text{MLPBlock}\,(
\displaystyle{\mathbf{P}})
\displaystyle=\;\text{MLP}({\mathbf{P}})+{\mathbf{P}}\;\;{{\color[rgb]{%
0.15234375,0.62109375,0.80859375}\xrightarrow{\hphantom{\text{1234}}}}}\;\;
\displaystyle=\;\text{MLP}({\mathbf{P}})+{\mathbf{P}}
\displaystyle\;\;{{\color[rgb]{0.15234375,0.62109375,0.80859375}\xrightarrow{%
\hphantom{\text{1234}}}}}\;\;
\displaystyle\text{{{\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos %
MLPBlock}}}({\mathbf{P}})
\displaystyle({\mathbf{P}})
\displaystyle={\mathbf{W}}^{\text{MLP}}({\mathbf{P}})
\displaystyle={\mathbf{W}}^{\text{MLP}}
\displaystyle({\mathbf{P}})
\displaystyle\;{\mathbf{P}}
\displaystyle\;{\mathbf{P}}
\displaystyle\text{Classifier}\,({\mathbf{P}})
\displaystyle\text{Classifier}\,(
\displaystyle{\mathbf{P}})
\displaystyle=\;\text{Linear}\circ\text{Pool}({\mathbf{P}})\;\;{{\color[rgb]{%
0.15234375,0.62109375,0.80859375}\xrightarrow{\hphantom{\text{1234}}}}}\;\;
\displaystyle=\;\text{Linear}\circ\text{Pool}({\mathbf{P}})
\displaystyle\;\;{{\color[rgb]{0.15234375,0.62109375,0.80859375}\xrightarrow{%
\hphantom{\text{1234}}}}}\;\;
\displaystyle\text{{{\color[rgb]{0.15234375,0.62109375,0.80859375}B-cos %
Classifier}}}({\mathbf{P}})
\displaystyle({\mathbf{P}})
\displaystyle={\mathbf{W}}^{\text{Class}}({\mathbf{P}})
\displaystyle={\mathbf{W}}^{\text{Class}}
\displaystyle({\mathbf{P}})
\displaystyle\;{\mathbf{P}}\,.
\displaystyle\;{\mathbf{P}}\,.
\displaystyle{\mathbf{y}}({\mathbf{x}})={\mathbf{W}}^{\text{Class}}({\mathbf{x%
}})\;\textstyle\prod_{l=1}^{L}\left({\mathbf{W}}^{\text{MLP}}_{l}({\mathbf{x}}%
)\;{\mathbf{W}}^{\text{Att}}_{l}({\mathbf{x}})\right)\,\;{\mathbf{W}}^{\text{%
Tokens}}({\mathbf{x}})\,{\mathbf{x}}={\mathbf{W}}({\mathbf{x}})\,{\mathbf{x}}\,.
\displaystyle{\mathbf{y}}({\mathbf{x}})={\mathbf{W}}^{\text{Class}}({\mathbf{x%
}})\;\textstyle\prod_{l=1}^{L}\left({\mathbf{W}}^{\text{MLP}}_{l}({\mathbf{x}}%
)\;{\mathbf{W}}^{\text{Att}}_{l}({\mathbf{x}})\right)\,\;{\mathbf{W}}^{\text{%
Tokens}}({\mathbf{x}})\,{\mathbf{x}}={\mathbf{W}}({\mathbf{x}})\,{\mathbf{x}}\,.
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{x}}
{\mathbf{c}}_{k}
k
\displaystyle\textbf{Dynamic Linear Contribution Maps:}{\mathbf{c}}_{k}({%
\mathbf{x}})=\left[{\mathbf{W}}({\mathbf{x}})\right]^{T}_{k}\odot{\mathbf{x}}%
\,,\quad\quad\quad
\displaystyle{\mathbf{c}}_{k}({\mathbf{x}})=\left[{\mathbf{W}}({\mathbf{x}})%
\right]^{T}_{k}\odot{\mathbf{x}}\,,\quad\quad\quad
\odot
\times
{\mathbf{c}}
{\mathbf{W}}({\mathbf{x}})
\displaystyle\text{B-cos}({\mathbf{a}};{\mathbf{W}})=\left(\cos^{\text{B}-1}({%
\mathbf{a}},{\mathbf{W}})\odot\widehat{{\mathbf{W}}}\right){\mathbf{a}}={%
\mathbf{W}}({\mathbf{a}}){\mathbf{a}}\;.
\displaystyle\text{B-cos}({\mathbf{a}};{\mathbf{W}})=\left(\cos^{\text{B}-1}({%
\mathbf{a}},{\mathbf{W}})\odot\widehat{{\mathbf{W}}}\right){\mathbf{a}}={%
\mathbf{W}}({\mathbf{a}}){\mathbf{a}}\;.
\cos
\widehat{{\mathbf{W}}}
\odot
[{\mathbf{W}}({\mathbf{x}})]_{k}
k
{\mathbf{W}}({\mathbf{x}})
\displaystyle\text{B-cos Token}\;{\mathbf{p}}_{i}({\mathbf{x}})=\mathcal{T}_{i%
}\circ\text{B-cos CNN}({\mathbf{x}})={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\mathcal{T}_{i}}{\mathbf{W}}^{%
\text{CNN}}({\mathbf{x}})}}\,{\mathbf{x}}={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}{\mathbf{W}}_{i}^{\text{Tokens}}({\mathbf{x}}%
)}}\,{\mathbf{x}}\,.
\displaystyle\text{B-cos Token}\;{\mathbf{p}}_{i}({\mathbf{x}})=\mathcal{T}_{i%
}\circ\text{B-cos CNN}({\mathbf{x}})={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\mathcal{T}_{i}}{\mathbf{W}}^{%
\text{CNN}}({\mathbf{x}})}}\,{\mathbf{x}}={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}{\mathbf{W}}_{i}^{\text{Tokens}}({\mathbf{x}}%
)}}\,{\mathbf{x}}\,.
{\mathbf{p}}_{i}\mkern 1.25mu{\in}\mkern 1.25mu\mathbb{R}^{D}
i
{\mathbf{P}}
\mathcal{T}_{i}
{\mathbf{W}}^{\mathcal{T}_{i}}
{\mathbf{W}}^{\text{CNN}}
{\mathbf{W}}_{i}^{\text{Tokens}}({\mathbf{x}})\mkern 1.25mu{=}\mkern 1.25mu{%
\mathbf{W}}^{\mathcal{T}_{i}}{\mathbf{W}}^{\text{CNN}}({\mathbf{x}})
{\mathbf{E}}
\displaystyle\text{Attention}({{{\mathbf{P}}}};{\mathbf{Q}},{\mathbf{K}},{%
\mathbf{V}})\;=\;\underbrace{\text{softmax}\left({\mathbf{P}}^{T}{\mathbf{Q}}^%
{T}{{{\mathbf{K}}}}{{{\mathbf{P}}}}\right)}_{\text{Attention matrix ${\mathbf{%
A}}({{{\mathbf{P}}}})$}}\underbrace{\,{\mathbf{V}}{{{\mathbf{P}}}}\,\vphantom{%
\text{softmax}\left({\mathbf{Q}}{{{\mathbf{P}}}}{{{\mathbf{P}}}}^{T}{\mathbf{K%
}}^{T}\right)}}_{\text{Value}({{\mathbf{P}}})}\;=\;\underbrace{{\mathbf{A}}({{%
{\mathbf{P}}}})\,{\mathbf{V}}\vphantom{\text{softmax}\left({\mathbf{Q}}{{{%
\mathbf{P}}}^{T}}{{{\mathbf{P}}}}{\mathbf{K}}^{T}\right)}}_{{\mathbf{W}}({{{%
\mathbf{P}}}})}\,{{{\mathbf{P}}}}\;\;=\;{\mathbf{W}}({{{\mathbf{P}}}}){{{%
\mathbf{P}}}}.
{\mathbf{A}}({{{\mathbf{P}}}})
\displaystyle\text{Attention}({{{\mathbf{P}}}};{\mathbf{Q}},{\mathbf{K}},{%
\mathbf{V}})\;
\displaystyle=\;\underbrace{\text{softmax}\left({\mathbf{P}}^{T}{\mathbf{Q}}^{%
T}{{{\mathbf{K}}}}{{{\mathbf{P}}}}\right)}_{\text{Attention matrix ${\mathbf{A%
}}({{{\mathbf{P}}}})$}}\underbrace{\,{\mathbf{V}}{{{\mathbf{P}}}}\,\vphantom{%
\text{softmax}\left({\mathbf{Q}}{{{\mathbf{P}}}}{{{\mathbf{P}}}}^{T}{\mathbf{K%
}}^{T}\right)}}_{\text{Value}({{\mathbf{P}}})}\;=\;\underbrace{{\mathbf{A}}({{%
{\mathbf{P}}}})\,{\mathbf{V}}\vphantom{\text{softmax}\left({\mathbf{Q}}{{{%
\mathbf{P}}}^{T}}{{{\mathbf{P}}}}{\mathbf{K}}^{T}\right)}}_{{\mathbf{W}}({{{%
\mathbf{P}}}})}\,{{{\mathbf{P}}}}\;\;=\;{\mathbf{W}}({{{\mathbf{P}}}}){{{%
\mathbf{P}}}}.
{\mathbf{A}}({{{\mathbf{P}}}})
{\mathbf{Q}},{\mathbf{K}}
{\mathbf{V}}
{\mathbf{P}}
H
{\mathbf{U}}
\displaystyle\text{MSA}(\widetilde{{\mathbf{P}}})={\mathbf{U}}\left[{\mathbf{W%
}}_{1}(\widetilde{{\mathbf{P}}})\widetilde{{\mathbf{P}}},\;{\mathbf{W}}_{2}(%
\widetilde{{\mathbf{P}}})\widetilde{{\mathbf{P}}},\;...\;,{\mathbf{W}}_{H}(%
\widetilde{{\mathbf{P}}})\widetilde{{\mathbf{P}}}\right]\quad\text{with}\quad%
\widetilde{{\mathbf{P}}}=\text{LayerNorm}({\mathbf{P}})
\displaystyle\text{MSA}(\widetilde{{\mathbf{P}}})={\mathbf{U}}\left[{\mathbf{W%
}}_{1}(\widetilde{{\mathbf{P}}})\widetilde{{\mathbf{P}}},\;{\mathbf{W}}_{2}(%
\widetilde{{\mathbf{P}}})\widetilde{{\mathbf{P}}},\;...\;,{\mathbf{W}}_{H}(%
\widetilde{{\mathbf{P}}})\widetilde{{\mathbf{P}}}\right]\quad\text{with}\quad%
\widetilde{{\mathbf{P}}}=\text{LayerNorm}({\mathbf{P}})
{\mathbf{P}}
{\mathbf{A}}({{\mathbf{P}}})
{\mathbf{V}}{{\mathbf{P}}}
{\mathbf{U}}
{\mathbf{V}}
{\mathbf{U}}
{\mathbf{U}}
{\mathbf{P}}
\displaystyle\text{B-cos Linear}({{\mathbf{P}}};{\mathbf{S}})\;=\;\text{MaxOut%
}\circ\text{B-cos}({\mathbf{P}};{\mathbf{S}})\;=\;{\mathbf{W}}^{{\mathbf{S}}}(%
{\mathbf{P}}){\mathbf{P}}\quad\text{with}\quad{\mathbf{S}}\in\{{\mathbf{U}},{%
\mathbf{V}}\}.
\displaystyle\text{B-cos Linear}({{\mathbf{P}}};{\mathbf{S}})\;=\;\text{MaxOut%
}\circ\text{B-cos}({\mathbf{P}};{\mathbf{S}})\;=\;{\mathbf{W}}^{{\mathbf{S}}}(%
{\mathbf{P}}){\mathbf{P}}\quad\text{with}\quad{\mathbf{S}}\in\{{\mathbf{U}},{%
\mathbf{V}}\}.
{\mathbf{A}}({{\mathbf{P}}})
{\mathbf{A}}({\mathbf{P}})
\displaystyle{\mathbf{A}}({\mathbf{P}};{\mathbf{Q}},{\mathbf{K}})=\text{%
softmax}\left(\widetilde{{\mathbf{P}}}^{T}{\mathbf{Q}}^{T}{\mathbf{K}}%
\widetilde{{\mathbf{P}}}\right)\quad\text{with}\quad\widetilde{{\mathbf{P}}}=%
\text{LayerNorm}({\mathbf{P}})\,.
\displaystyle{\mathbf{A}}({\mathbf{P}};{\mathbf{Q}},{\mathbf{K}})=\text{%
softmax}\left(\widetilde{{\mathbf{P}}}^{T}{\mathbf{Q}}^{T}{\mathbf{K}}%
\widetilde{{\mathbf{P}}}\right)\quad\text{with}\quad\widetilde{{\mathbf{P}}}=%
\text{LayerNorm}({\mathbf{P}})\,.
\displaystyle\text{B-cos AttBlock}({{\mathbf{P}}})={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}\left({\mathbf{W}}^{{\mathbf{U}}}({\mathbf{P}%
}^{\prime})\left[{\mathbf{A}}_{h}({\mathbf{P}}){\mathbf{W}}_{h}^{{\mathbf{V}}}%
({\mathbf{P}})\,\right]_{h=1}^{H}+{\mathbf{I}}\right)}}{\mathbf{P}}={{\color[%
rgb]{0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\text{Att}}({\mathbf{P}})}%
}\;{{\mathbf{P}}}\;,
\displaystyle\text{B-cos AttBlock}({{\mathbf{P}}})={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}\left({\mathbf{W}}^{{\mathbf{U}}}({\mathbf{P}%
}^{\prime})\left[{\mathbf{A}}_{h}({\mathbf{P}}){\mathbf{W}}_{h}^{{\mathbf{V}}}%
({\mathbf{P}})\,\right]_{h=1}^{H}+{\mathbf{I}}\right)}}{\mathbf{P}}={{\color[%
rgb]{0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\text{Att}}({\mathbf{P}})}%
}\;{{\mathbf{P}}}\;,
{\mathbf{P}}^{\prime}=\left[{\mathbf{A}}_{h}({\mathbf{P}}){\mathbf{W}}_{h}^{{%
\mathbf{V}}}({\mathbf{P}})\,\right]_{h=1}^{H}
{\mathbf{W}}^{U}
{\mathbf{W}}^{V}
{\mathbf{A}}_{h}({\mathbf{P}})
{\mathbf{I}}
\displaystyle\text{MLPBlock}({\mathbf{P}})=\text{Linear}_{2}\circ\text{GELU}%
\circ\text{Linear}_{1}\circ\text{LayerNorm}({\mathbf{P}})+{\mathbf{P}}
\displaystyle\text{MLPBlock}({\mathbf{P}})=\text{Linear}_{2}\circ\text{GELU}%
\circ\text{Linear}_{1}\circ\text{LayerNorm}({\mathbf{P}})+{\mathbf{P}}
\displaystyle\text{B-cos MLPBlock}({\mathbf{P}})={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}\left({\mathbf{M}}_{2}({\mathbf{P}})\,{%
\mathbf{L}}_{2}({\mathbf{P}})\,{\mathbf{M}}_{1}({\mathbf{P}})\,{\mathbf{L}}_{1%
}({\mathbf{P}})+{\mathbf{I}}\right)}}{\mathbf{P}}={{\color[rgb]{%
0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\text{MLP}}({\mathbf{P}})}}\,{%
\mathbf{P}}\;.
\displaystyle\text{B-cos MLPBlock}({\mathbf{P}})
\displaystyle={{\color[rgb]{0.15234375,0.62109375,0.80859375}\left({\mathbf{M}%
}_{2}({\mathbf{P}})\,{\mathbf{L}}_{2}({\mathbf{P}})\,{\mathbf{M}}_{1}({\mathbf%
{P}})\,{\mathbf{L}}_{1}({\mathbf{P}})+{\mathbf{I}}\right)}}{\mathbf{P}}={{%
\color[rgb]{0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\text{MLP}}({%
\mathbf{P}})}}\,{\mathbf{P}}\;.
{\mathbf{M}}_{i}({\mathbf{P}})
{\mathbf{L}}_{i}({\mathbf{P}})
{\mathbf{I}}
\displaystyle\text{B-cos Classifier}({\mathbf{P}})=\text{B-cos}\circ\text{Pool%
}({\mathbf{P}})={{\color[rgb]{0.15234375,0.62109375,0.80859375}{\mathbf{L}}({%
\mathbf{P}}^{\prime}){\mathbf{W}}^{\text{AvgPool}}}}{\mathbf{P}}={{\color[rgb]%
{0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\text{Class}}({\mathbf{P}})}}%
\,{\mathbf{P}}\;,
\displaystyle\text{B-cos Classifier}({\mathbf{P}})=\text{B-cos}\circ\text{Pool%
}({\mathbf{P}})={{\color[rgb]{0.15234375,0.62109375,0.80859375}{\mathbf{L}}({%
\mathbf{P}}^{\prime}){\mathbf{W}}^{\text{AvgPool}}}}{\mathbf{P}}={{\color[rgb]%
{0.15234375,0.62109375,0.80859375}{\mathbf{W}}^{\text{Class}}({\mathbf{P}})}}%
\,{\mathbf{P}}\;,
{\mathbf{L}}({\mathbf{P}}^{\prime})
{\mathbf{P}}^{\prime}\mkern 1.25mu{=}\mkern 1.25mu\text{Pool}({\mathbf{P}})
{\mathbf{E}}
{\mathbf{P}}
{\mathbf{B}}_{h}^{l}
h
l
\displaystyle{\mathbf{A}}_{\text{add}}({\mathbf{P}})=\text{SM}\left({\mathbf{R%
}}({\mathbf{P}})+{\mathbf{B}}\right)
\displaystyle{\mathbf{A}}_{\text{add}}({\mathbf{P}})
\displaystyle=\text{SM}\left({\mathbf{R}}({\mathbf{P}})+{\mathbf{B}}\right)
\displaystyle\text{and}\quad\;{\mathbf{A}}_{\text{mul}}({\mathbf{P}})=\text{SM%
}\left({\mathbf{R}}({\mathbf{P}})\right)\times\text{SM}\left({\mathbf{B}}%
\right)\;.
\displaystyle\text{and}\quad\;{\mathbf{A}}_{\text{mul}}({\mathbf{P}})
\displaystyle=\text{SM}\left({\mathbf{R}}({\mathbf{P}})\right)\times\text{SM}%
\left({\mathbf{B}}\right)\;.
{\mathbf{R}}({\mathbf{P}})\mkern 1.25mu{=}\mkern 1.25mu{\mathbf{Q}}\widetilde{%
{\mathbf{P}}}\widetilde{{\mathbf{P}}}^{T}{\mathbf{K}}^{T}
{\mathbf{B}}
{\mathbf{B}}
\times
\in
\in
2.5e^{-4}
\times
\times
{\mathbf{A}}_{\text{mul}}
{\mathbf{A}}_{\text{mul}}
2.47
\,\times 2.47
\,\times 1.99
\,\times 2.47
\,\times 1.99
1.99
k
{\mathbf{W}}({\mathbf{x}})
k
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
[-p,p]
p
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
{\mathbf{W}}({\mathbf{x}})
\displaystyle{\mathbf{W}}({\mathbf{x}})={\mathbf{W}}^{\text{Class}}({\mathbf{x%
}})\;\textstyle\prod_{l=1}^{L}\left({\mathbf{W}}^{\text{MLP}}_{l}({\mathbf{x}}%
)\;{\mathbf{W}}^{\text{Att}}_{l}({\mathbf{x}})\right)\,\;{\mathbf{W}}^{\text{%
Tokens}}({\mathbf{x}})\,.
\displaystyle{\mathbf{W}}({\mathbf{x}})={\mathbf{W}}^{\text{Class}}({\mathbf{x%
}})\;\textstyle\prod_{l=1}^{L}\left({\mathbf{W}}^{\text{MLP}}_{l}({\mathbf{x}}%
)\;{\mathbf{W}}^{\text{Att}}_{l}({\mathbf{x}})\right)\,\;{\mathbf{W}}^{\text{%
Tokens}}({\mathbf{x}})\,.
\displaystyle{\mathbf{A}}_{\text{rollout}}({\mathbf{x}})={\mathbf{I}}^{\text{%
Class}}\;\textstyle\prod_{l=1}^{L}\left({\mathbf{I}}^{\text{MLP}}_{l}\;\bar{{%
\mathbf{A}}}_{l}({\mathbf{x}})\right)\,\;{\mathbf{I}}^{\text{Tokens}}\,,
\displaystyle{\mathbf{A}}_{\text{rollout}}({\mathbf{x}})={\mathbf{I}}^{\text{%
Class}}\;\textstyle\prod_{l=1}^{L}\left({\mathbf{I}}^{\text{MLP}}_{l}\;\bar{{%
\mathbf{A}}}_{l}({\mathbf{x}})\right)\,\;{\mathbf{I}}^{\text{Tokens}}\,,
{\mathbf{I}}^{\text{layer}}
\bar{{\mathbf{A}}}_{l}
l
{\mathbf{W}}({\mathbf{x}})
-v
v
v
v
k
{\mathbf{W}}({\mathbf{x}})
k
{\mathbf{W}}({\mathbf{x}})
10^{5}
10^{0}
k\mkern 1.25mu{=}\mkern 1.25mu1,2,4
s\mkern 1.25mu{=}\mkern 1.25mu1,2,4
10^{3}
c\mkern 1.25mu{=}\mkern 1.25mu192,384,768
c\mkern 1.25mu{\times}\mkern 1.25muh\mkern 1.25mu{\times}\mkern 1.25muw
n\mkern 1.25mu{\times}\mkern 1.25muc
n
{\mathbf{B}}\mkern 1.25mu{\in}\mkern 1.25mu\mathbb{R}^{m\times n\times n}
m
{\mathbf{B}}
C\mkern 1.25mu{=}\mkern 1.25mu1000
\gamma\mkern 1.25mu{=}\mkern 1.25muf/\sqrt{c}
f\mkern 1.25mu{=}\mkern 1.25mu15,20,25
\leq 1
f
10
10^{3}
{\mathbf{b}}\mkern 1.25mu{\in}\mkern 1.25mu\mathbb{R}^{C}
\log(0.01/0.99)
C
[r,g,b,1\mkern 1.25mu{-}\mkern 1.25mur,1\mkern 1.25mu{-}\mkern 1.25mug,1\mkern
1%
.25mu{-}\mkern 1.25mub]
r,g,b\mkern 1.25mu{\in}\mkern 1.25mu[0,1]
{\mathbf{W}}({\mathbf{x}})
n\mkern 1.25mu{=}\mkern 1.25mu2
m\mkern 1.25mu{=}\mkern 1.25mu9
224\mkern 1.25mu{\times}\mkern 1.25mu224
224\mkern 1.25mu{\times}\mkern 1.25mu224
\mkern 1.25mu{\times}\mkern 1.25mu
[-v,v]
v
{\mathbf{W}}({\mathbf{x}})
{\mathbf{p}}=[r,g,b,1\mkern 1.25mu{-}\mkern 1.25mur,1\mkern 1.25mu{-}\mkern 1.%
25mug,1\mkern 1.25mu{-}\mkern 1.25mub]
r,g,b\mkern 1.25mu{\in}\mkern 1.25mu[0,1]
{\mathbf{p}}
{\mathbf{W}}({\mathbf{x}})
\alpha
\alpha
n\mkern 1.25mu{=}\mkern 1.25mu32
\mkern 1.25mu{\times}\mkern 1.25mu
2\mkern 1.25mu{\times}\mkern 1.25mu2
448\mkern 1.25mu{\times}\mkern 1.25mu448
224\mkern 1.25mu{\times}\mkern 1.25mu224
r
(r,o)\mkern 1.25mu{=}\mkern 1.25mu(0,1)
r
o
