z
z
\mathcal{X}\subset\mathbb{R}^{d}
x
z
\mathcal{Z}\subset\mathbb{R}^{n}
n\ll d
z
z_{i}
x
x=g(z)+\xi
\xi\sim\mathcal{N}(0,\sigma^{2}I)
g:\mathcal{Z}\to\mathcal{X}
z_{i}
p_{\theta}(x,z)=p_{\theta}(x|z)p_{\theta}(z)
\theta
p(x,z)
p(z|x)
p(z)
\sim
\sim
\sim
\theta
\sim
p_{\theta}(x)=p_{\hat{\theta}}(x)\implies\theta\sim\hat{\theta}
\theta
\hat{\theta}
p_{\theta}(x)
p_{\theta}(x,z)=p_{\hat{\theta}}(x,z)
p_{\theta}(z)=p_{\hat{\theta}}(z)
p_{\theta}(z|x)=p_{\hat{\theta}}(z|x)
p_{\theta}(x)=p_{\hat{\theta}}(x)
p_{\theta}(z)
z_{i}
u
\bm{\lambda}
\displaystyle p_{T,\lambda}(z|u)=\prod_{i}h_{i}(z_{i})\exp\Bigg{[}\sum_{j=1}^{%
k}T_{i,j}(z_{i})\lambda_{i,j}(u)-\psi_{i}(u)\Bigg{]}
h_{i}(z_{i})
\mathbf{T}_{i}:\mathcal{Z}\to\mathbb{R}^{k}
\mathbf{T}_{i}=(T_{i,1},\dots,T_{i,k})
\bm{\lambda}_{i}(u)=(\lambda_{i,1}(u),\dots,\lambda_{i,k}(u))
k
\psi_{i}(u)
u
p_{\theta}(x,z)=p_{\hat{\theta}}(x,z)
\sim
\theta
\mathcal{X}=g(\mathcal{Z})
\mathcal{\hat{X}}=\hat{g}(\mathcal{Z})
\theta
\hat{\theta}
A\in\mathbb{R}^{nk\times nk}
b,c\in\mathbb{R}^{nk}
\forall x\in\mathcal{X}
\mathbf{T}(g^{-1}(x))=A\hat{\mathbf{T}}(\hat{g}^{-1}(x))+b,\forall x\in%
\mathcal{X}
A^{T}\bm{\lambda}(u)+c=\hat{\bm{\lambda}}(u)
\theta\sim_{A}\hat{\theta}
\theta
\hat{\theta}
\theta\sim_{P}\hat{\theta}
P
\mathbf{T}
n
k\times k
A_{1},\dots,A_{n}
n
\pi
z\in\mathbb{R}^{nk}
P\hat{z}=[z_{\pi(1)}A_{1}^{T},z_{\pi(2)}A_{2}^{T},\dots,z_{\pi(n)}A_{n}^{T}]^{T}
g^{-1}
\hat{g}^{-1}
i
z_{i}
\pi
\hat{\theta}
\theta
\hat{\theta}
z
\mathcal{M}=\langle\mathcal{Z},\mathcal{E},F\rangle
\mathcal{Z}
n
z=\{z_{1},\dots,z_{n}\}
\mathcal{E}
n
\epsilon=\{\epsilon_{1},\dots,\epsilon_{n}\}
F=\{f_{1},\dots,f_{n}\}
n
z_{i}=f_{i}(\epsilon_{i},z_{\textbf{pa}_{i}})
\forall i
f_{i}:\mathcal{E}_{i}\times\prod_{j\in\textbf{pa}_{i}}\mathcal{Z}_{j}\to%
\mathcal{Z}_{i}
z_{\textbf{pa}_{i}}
z_{i}
p_{\mathcal{E}}(\epsilon)=p_{\mathcal{E}_{1}}(\epsilon_{1})p_{\mathcal{E}_{2}}%
(\epsilon_{2})\dots p_{\mathcal{E}_{n}}(\epsilon_{n})
z
\mathcal{G}^{z}
G^{z}\in\{0,1\}^{n\times n}
p_{\theta}(z)=p_{\hat{\theta}}(z)
p_{\theta}(z_{i}|z_{\textbf{pa}_{i}})=p_{\hat{\theta}}(z_{i}|z_{\textbf{pa}_{i%
}})
\sim
\hat{\theta}
\theta
\mathcal{X}=g(\mathcal{{Z}})
\mathcal{\hat{X}}=\hat{g}(\mathcal{{Z}})
z
\theta
\hat{\theta}
P
I=P\cdot J
I
J
z
\hat{z}
(i,j)
P_{ij}\neq 0
\mathbf{T}_{i}(z_{i}|z_{\textbf{pa}_{i}})=D_{ij}\hat{\mathbf{T}}_{j}(z_{j}|z_{%
\textbf{pa}_{j}}),\forall z_{i}\in\mathcal{Z}_{i},\forall\hat{z}_{j}\in%
\mathcal{Z}_{j}
D_{ij}
i,j\in\{1,\dots,n\}
\bm{\lambda}_{i}(z_{\textbf{pa}_{i}},u)=D_{ij}\hat{\bm{\lambda}}_{j}(z_{%
\textbf{pa}_{j}},u)
D
\theta
\hat{\theta}
\theta
\hat{\theta}
f^{\text{RF}}
\epsilon
z
z=f^{\text{RF}}(\epsilon)
f^{\text{RF}}:\mathcal{E}\to\mathcal{Z}
f_{i}
z_{i}=f_{i}(\epsilon_{i};z_{\textbf{pa}_{i}}),\qquad\forall i\in\{1,\dots,n\}
\epsilon_{i}
z_{i}
f^{\text{RF}}
z_{1}\to z_{3},z_{4}
z_{2}\to z_{3},z_{4}
f^{\text{RF}}:(\epsilon_{1},\epsilon_{2},\epsilon_{3},\epsilon_{4})\mapsto(z_{%
1}=f_{1}(\epsilon_{1}),z_{2}=f_{2}(\epsilon_{2}),z_{3}=f_{3}(\epsilon_{3},z_{1%
},z_{2}),z_{4}=f_{4}(\epsilon_{4},z_{1},z_{2}))
z_{i}=f^{\text{RF}}_{i}(\epsilon_{i};\epsilon_{\textbf{pa}_{i}})=f_{i}(%
\epsilon_{i};z_{\textbf{pa}_{i}})
f_{i}
z_{i}=f_{i}(\epsilon_{i};z_{\textbf{pa}_{i}})=\exp(a_{i})\cdot\epsilon_{i}+b_{i}
a_{i}=r_{1}(z_{\textbf{pa}_{i}})
b_{i}=r_{2}(z_{\textbf{pa}_{i}})
r_{1}
r_{2}
\log\prod_{i}\bigg{|}\frac{\partial\epsilon_{i}}{\partial z_{i}}\bigg{|}=\sum_%
{i}\log\bigg{|}\frac{\partial f^{\text{RF}}_{i}(\epsilon_{i};\epsilon_{\textbf%
{pa}_{i}})}{\partial\epsilon_{i}}\bigg{|}^{-1}=\sum_{i}a_{i}
\epsilon_{\textbf{pa}_{i}}
z_{i}
u\in\mathbb{R}^{n}
\mathcal{U}\subset\mathbb{R}^{n}
g
\mathcal{Z}
\mathcal{X}
g
\theta=(g,\mathbf{T},\bm{\lambda},G^{z})
p_{\theta}(x,\epsilon,z|u)=p_{\theta}(x|\epsilon,z)p_{\theta}(\epsilon,z|u)
p_{\theta}(x|\epsilon,z)=p_{\theta}(x|z)=p_{\xi}(x-g(z))
\xi
p_{\theta}(\epsilon,z|u)=p(\epsilon)p_{\theta}(z|u)
p(\epsilon)
p(z|u)
z
z
u
z
u
u
z
z
\begin{split}p_{\theta}(z|u)&=\prod_{i=1}^{n}p_{\theta}(z_{i}|z_{\textbf{pa}_{%
i}},u_{i})=\prod_{i=1}^{n}p(u_{i})\bigg{|}\frac{\partial\bm{\lambda}_{i}(u_{i}%
;z_{\textbf{pa}_{i}})}{\partial u_{i}}\bigg{|}^{-1}\end{split}
\displaystyle p_{\theta}(z_{i}|z_{\textbf{pa}_{i}},u_{i})=h_{i}(z_{i})\exp(%
\mathbf{T}_{i}(z_{i}|z_{\textbf{pa}_{i}})\bm{\lambda}_{i}(G_{i}^{z}\odot z,u_{%
i})
\displaystyle p_{\theta}(z_{i}|z_{\textbf{pa}_{i}},u_{i})=h_{i}(z_{i})\exp(%
\mathbf{T}_{i}(z_{i}|z_{\textbf{pa}_{i}})\bm{\lambda}_{i}(G_{i}^{z}
\displaystyle\odot z,u_{i})
\displaystyle-\psi_{i}(z,u))
\displaystyle-\psi_{i}(z,u))
\bm{\lambda}_{i}(G_{i}^{z}\odot z,u_{i})
\bm{\lambda}_{i}
G^{z}_{i}
i
z
h_{i}(z)
\mathbf{T}_{i}(z)=(z,z^{2})
z
p_{\theta}(z_{i}|z_{\textbf{pa}_{i}},u_{i})
u_{i}
\bm{\lambda}(z,u)
\bm{\lambda}_{i}(G_{i}^{z}\odot z,u_{i})
\bm{\lambda}(z,u)
\bm{\lambda}:\mathcal{Z}\times\mathcal{U}\to\mathcal{Z}
u
z
p(u)
\bm{\lambda}_{i}
\bm{\lambda}_{i}(u_{i};z_{\textbf{pa}_{i}})=\exp(c_{i})\cdot u_{i}+d_{i}
c_{i}=s_{1}(z_{\textbf{pa}_{i}})
d_{i}=s_{2}(z_{\textbf{pa}_{i}})
z
p(u)
z
q_{\phi}(\epsilon,z|x,u)
p_{\theta}(x|\epsilon,z)
f_{i}(\cdot;\epsilon)
\displaystyle\log p_{\theta}(x,u)\geq\mathbb{E}_{\epsilon,z\sim q_{\phi}(%
\epsilon,z|x,u)}\Big{[}\log p_{\theta}(x|\epsilon)+\log p_{\theta}(x|z)
\displaystyle\log p_{\theta}(x,u)\geq\mathbb{E}_{\epsilon,z\sim q_{\phi}(%
\epsilon,z|x,u)}\Big{[}\log p_{\theta}(x|\epsilon)
\displaystyle+\log p_{\theta}(x|z)
\displaystyle-\beta\{\log q_{\phi}(\epsilon|x,u)+\log q_{\phi}(z|x,u)
\displaystyle-\beta\{\log q_{\phi}(\epsilon|x,u)+\log q_{\phi}(z|x,u)
\displaystyle-\log p(\epsilon)-\log p_{\theta}(z|u)\}\Big{]}
\displaystyle-\log p(\epsilon)-\log p_{\theta}(z|u)\}\Big{]}
\beta
\theta=(g,\mathbf{T},\bm{\lambda},G^{z})
\hat{\theta}=(\hat{g},\hat{\mathbf{T}},\hat{\bm{\lambda}},\hat{G}^{z})
\{x\in\mathcal{X}|\phi_{\xi}(x)=0\}
\phi_{\xi}
p_{\xi}
g
\mathbf{T}_{i}
nk+1
u_{0},\dots,u_{nk}
\begin{split}L=(\bm{\lambda}(z_{\textbf{pa}_{(1)}},u_{(1)})-\bm{\lambda}(z_{(0%
)},u_{(0)}),\dots,\\
\bm{\lambda}(z_{\textbf{pa}_{(nk)}},u_{(nk)})-\bm{\lambda}(z_{(0)},u_{(0)}))%
\end{split}
nk\times nk
\bm{\lambda}
u_{i}
z_{\textbf{pa}_{i}}
\forall i
\bm{\lambda}_{i}(z_{\textbf{pa}_{i}},u_{i})\neq 0
\theta
\hat{\theta}
\hat{\theta}
\to
\to
\to
\to
\to
\to
\to
\to
D
C
I
I=0
3
R^{2}
6
1
6
2
\beta
0
1
9\cdot 10^{3}
64
35
10
\beta
0
0.05
3.5\cdot 10^{4}
100
6
\sigma^{2}\in\{0.01,0.00001\}
\bm{\lambda}
100
0.001
4
\beta
\bm{\lambda}
D
C
\beta
0.182
0.285
0.449
0.483
0.385
0.670
0.885
0.539
0.817
0.764
0.475
0.829
\mathbf{0.997}
\mathbf{0.882}
\mathbf{0.869}
\beta
0.308
0.332
0.452
0.730
0.481
0.674
0.819
0.522
0.707
0.854
0.483
0.811
\mathbf{0.988}
\mathbf{0.598}
\mathbf{0.893}
\beta
0.692
0.442
0.982
0.745
0.541
0.992
0.886
0.625
0.994
0.867
0.652
0.993
\mathbf{0.982}
\mathbf{0.689}
\mathbf{0.999}
\mathbf{T}_{i}
v\neq 0
v^{T}\mathbf{T}_{i}(z)
z\in\mathcal{Z}
\mathbf{T}:\mathcal{Z}\to\mathbb{R}^{k}
z_{(0)},\dots,z_{(k)}
\mathcal{Z}
k
\mathbf{T}(z_{(1)})-\mathbf{T}(z_{(0)}),\dots,\mathbf{T}(z_{(k)})-\mathbf{T}(z%
_{(0)})
\mathbf{T}(z|y):\mathcal{Z}\times\mathcal{Y}\to\mathbb{R}^{k}
z
y
i,j\in\{1,\dots,n\}
\mathbf{T}_{i}(z_{i}|z_{\textbf{pa}_{i}})
\hat{\mathbf{T}}_{i}(z_{j}|z_{\textbf{pa}_{j}})
z_{i}
z_{j}
\theta=(g,\mathbf{T},\bm{\lambda},G^{z})
\hat{\theta}=(\hat{g},\hat{\mathbf{T}},\hat{\bm{\lambda}},\hat{G}^{z})
\{x\in\mathcal{X}|\phi_{\xi}(x)=0\}
\phi_{\xi}
p_{\xi}
g
\mathbf{T}_{i}
nk+1
u_{0},\dots,u_{nk}
\begin{split}L=(\bm{\lambda}(z_{\textbf{pa}_{(1)}},u_{(1)})-\bm{\lambda}(z_{(0%
)},u_{(0)}),\dots,\\
\bm{\lambda}(z_{\textbf{pa}_{(nk)}},u_{(nk)})-\bm{\lambda}(z_{(0)},u_{(0)}))%
\end{split}
nk\times nk
\bm{\lambda}
u_{i}
z_{\textbf{pa}_{i}}
\forall i
\bm{\lambda}_{i}(z_{\textbf{pa}_{i}},u_{i})\neq 0
\theta
\hat{\theta}
\hat{\theta}
L
\bm{\lambda}
\bm{\lambda}
\hat{\theta}
\theta
\hat{\theta}
p_{\theta}(x|u)=p_{\hat{\theta}}(x|u)
(x,u)
g^{-1}=s\circ a^{-1}
z
a^{-1}
\epsilon
\begin{split}\int_{\mathcal{Z}}&p_{\mathbf{T},\bm{\lambda}}(z|u)p_{g}(x|z)\;dz%
\\
&=\int_{\mathcal{Z}}p_{\hat{\mathbf{T}},\hat{\bm{\lambda}}}(z|u)p_{\hat{g}}(x|%
z)\;dz\end{split}
\begin{split}\int_{\mathcal{Z}}&p_{\mathbf{T},\bm{\lambda}}(z|u)p_{\xi}(x-g(z)%
)\;dz\\
&=\int_{\mathcal{Z}}p_{\hat{\mathbf{T}},\hat{\bm{\lambda}}}(z|u)p_{\xi}(x-\hat%
{g}(x))\;dz\end{split}
\begin{split}\int_{\mathcal{X}}&p_{\mathbf{T},\bm{\lambda}}(g^{-1}(\bar{x})|u)%
\det J_{g^{-1}}(\bar{x})p_{\xi}(x-\bar{x})\;d\bar{x}\\
&=\int_{\mathcal{X}}p_{\hat{\mathbf{T}},\hat{\bm{\lambda}}}(\hat{g}^{-1}(\bar{%
x})|u)\det J_{\hat{g}^{-1}}(\bar{x})p_{\xi}(x-\bar{x})\;d\bar{x}\end{split}
\begin{split}\int_{\mathbb{R}^{d}}&p_{\mathbf{T},\bm{\lambda},g,u}(\bar{x})p_{%
\xi}(x-\bar{x})\;d\bar{x}\\
&=\int_{\mathbb{R}^{d}}p_{\hat{\mathbf{T}},\hat{\bm{\lambda}},\hat{g},\hat{u}}%
(\bar{x})p_{\xi}(x-\bar{x})\;d\bar{x}\end{split}
(p_{\mathbf{T},\bm{\lambda},g,u}*p_{\xi})(x)=(p_{\hat{\mathbf{T}},\hat{\bm{%
\lambda}},\hat{g},\hat{u}}*p_{\xi})(x)
\mathcal{F}[p_{\mathbf{T},\bm{\lambda},g,u}](w)\phi_{\xi}(w)=\mathcal{F}[p_{%
\hat{\mathbf{T}},\hat{\bm{\lambda}},\hat{g},\hat{u}}](w)\phi_{\xi}(w)
\mathcal{F}[p_{\mathbf{T},\bm{\lambda},g,u}](w)=\mathcal{F}[p_{\hat{\mathbf{T}%
},\hat{\bm{\lambda}},\hat{g},\hat{u}}](w)
p_{\mathbf{T},\bm{\lambda},g,u}=p_{\hat{\mathbf{T}},\hat{\bm{\lambda}},\hat{g}%
,\hat{u}}
\mathcal{F}
(x,u)
v=\hat{g}^{-1}\circ g:\mathcal{Z}\to\hat{\mathcal{Z}}
\displaystyle p_{\mathbf{T},\bm{\lambda}}(z|u)=p_{\hat{\mathbf{T}},\hat{\bm{%
\lambda}}}(z|u)
\displaystyle p_{\mathbf{T},\bm{\lambda}}(z|u)
\displaystyle=p_{\hat{\mathbf{T}},\hat{\bm{\lambda}}}(z|u)
\displaystyle p_{\mathbf{T},\bm{\lambda}}(g^{-1}(x)|u)\det J_{g^{-1}}(x)=p_{%
\hat{\mathbf{T}},\hat{\bm{\lambda}}}(\hat{g}^{-1}(x)|u)\det J_{\hat{g}^{-1}}(x)
\displaystyle p_{\mathbf{T},\bm{\lambda}}(g^{-1}(x)|u)\det J_{g^{-1}}(x)
\displaystyle=p_{\hat{\mathbf{T}},\hat{\bm{\lambda}}}(\hat{g}^{-1}(x)|u)\det J%
_{\hat{g}^{-1}}(x)
\begin{split}\prod_{i=1}^{n}h_{i}(g^{-1}_{i}(x))\exp\Bigg{[}\sum_{j=1}^{k}T_{i%
,j}(g^{-1}_{i}(x)|g^{-1}_{\textbf{pa}_{i}}(x))\lambda_{i,j}(z_{\textbf{pa}_{i}%
},u_{i})&\\
-\psi_{i}(z_{\textbf{pa}_{i}},u_{i})\Bigg{]}\det J_{g^{-1}}(x)=\\
\prod_{i=1}^{n}h_{i}(\hat{g}^{-1}_{i}(x))\exp\Bigg{[}\sum_{j=1}^{k}\hat{T}_{i,%
j}(\hat{g}^{-1}_{i}(x)|g^{-1}_{\textbf{pa}_{i}}(x))\hat{\lambda}_{i,j}(v(z_{%
\textbf{pa}_{i}}),u_{i})\\
-\hat{\psi}_{i}(z_{\textbf{pa}_{i}},u_{i})\Bigg{]}\det J_{\hat{g}^{-1}}(x)\end%
{split}
\begin{split}&\log\det J_{g^{-1}}(x)+\sum_{i=1}^{n}\log h_{i}(g^{-1}_{i}(x))\\
&+\sum_{j=1}^{k}T_{i,j}(g_{i}^{-1}(x)|g^{-1}_{\textbf{pa}_{i}}(x))\lambda_{i,j%
}(z_{\textbf{pa}_{i}},u)-\psi_{i}(z_{\textbf{pa}_{i}},u_{i})\\
&=\log\det J_{\hat{g}^{-1}}(x)+\sum_{i=1}^{n}\log\hat{h}_{i}(\hat{g}^{-1}_{i}(%
x))\\
&+\sum_{j=1}^{k}\hat{T}_{i,j}(\hat{g}_{i}^{-1}(x)|g^{-1}_{\textbf{pa}_{i}}(x))%
\hat{\lambda}_{i,j}(v(z_{\textbf{pa}_{i}}),u)-\hat{\psi}_{i}(z_{\textbf{pa}_{i%
}},u_{i})\end{split}
u_{0},\dots,u_{nk}
\Delta\bm{\lambda}(z_{\textbf{pa}},u)=\bm{\lambda}(z_{\textbf{pa}},u)-\bm{%
\lambda}(z_{0},u_{0})
z_{\textbf{pa}}
z
u_{\ell}
nk+1
u_{0}
u_{0}
nk
\forall\ell\in 1,\dots,nk,
\begin{split}&\mathbf{T}(g^{-1}(x))^{T}\Delta\bm{\lambda}(z_{\textbf{pa}_{\ell%
}},u_{\ell})\\
&-\sum_{i}\psi_{i}(z_{\textbf{pa}_{\ell}},u_{\ell})-\psi_{i}(z_{0},u_{0})\\
=&\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}\Delta\hat{\bm{\lambda}}(v(z_{\textbf{%
pa}_{\ell}}),u_{\ell})\\
&-\sum_{i}\hat{\psi}_{i}(z_{\textbf{pa}_{\ell}},u_{\ell})-\hat{\psi}_{i}(z_{0}%
,u_{0})\end{split}
L
\hat{L}
\hat{\bm{\lambda}}
\hat{L}
\psi
b_{\ell}=d(z_{\textbf{pa}_{\ell}},z_{0},u_{\ell},u_{0})
b
b_{\ell}
\ell\in\{1,\dots,nk\}
L^{T}\mathbf{T}(g^{-1}(x))=\hat{L}^{T}\hat{\mathbf{T}}(\hat{g}^{-1}(x))+b
L
L^{T}
\mathbf{T}(g^{-1}(x))=A\hat{\mathbf{T}}(\hat{g}^{-1}(x))+c
A=(L^{T})^{-1}\hat{L}
c=(L^{T})^{-1}b
A
A
\mathbf{T}_{i}
\mathbf{T}_{i}(z_{i}^{(1)})-\mathbf{T}_{i}(z_{i}^{(0)}),\dots,\mathbf{T}_{i}(z%
_{i}^{(k)})-\mathbf{T}_{i}(z_{i}^{(0)})
z^{(0)}=[z_{1}^{(0)},\dots,z_{n}^{(0)}]^{T}\in\mathbb{R}^{n}
i\in\{1,\dots,n\}
p\in\{1,\dots,k\}
z^{(p,i)}=[z_{1}^{(0)},\dots,z_{i-1}^{(0)},z_{i}^{(p)},z_{i+1}^{(0)}\dots,z_{n%
}^{(0)}]^{T}\in\mathbb{R}^{n}
1\leq p\leq k
i\in\{1,\dots,n\}
\mathbf{T}(z^{(p,i)})-\mathbf{T}(z^{(0)})=A[\hat{\mathbf{T}}(z^{(p,i)})-\hat{%
\mathbf{T}}(z^{(0)})]
\mathbf{T}_{i}(z_{i}^{(p,i)})-\mathbf{T}(z_{i}^{(0)})
\Delta\mathbf{T}^{(i)}=[\mathbf{T}(z^{(1,i)})-\mathbf{T}(z^{(0)})\dots\mathbf{%
T}(z^{(k,i)})-\mathbf{T}(z^{(0)})]
\Delta\hat{\mathbf{T}}^{(i)}=[\hat{\mathbf{T}}(z^{(1,i)})-\hat{\mathbf{T}}(z^{%
(0)})\dots\hat{\mathbf{T}}(z^{(k,i)})-\hat{\mathbf{T}}(z^{(0)})]
\{(i-1)k+1,\dots,ik\}
[\Delta\mathbf{T}^{(1)},\dots,\Delta\mathbf{T}^{(n)}]=A[\Delta\hat{\mathbf{T}}%
^{(1)},\dots,\Delta\hat{\mathbf{T}}^{(n)}]
nk\times nk
[\Delta\mathbf{T}^{(1)},\dots,\Delta\mathbf{T}^{(n)}]
A
A
\theta\sim_{A}\hat{\theta}
\bm{\lambda}
\hat{\bm{\lambda}}
v=\hat{g}^{-1}\circ g:\mathcal{Z}\to\hat{\mathcal{Z}}
\begin{split}&\mathbf{T}(g^{-1}(x))^{T}\bm{\lambda}(z_{\textbf{pa}},u)\\
&=\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u%
)+\kappa(z_{\textbf{pa}},u)+\gamma(z)\end{split}
z
\gamma
u
\kappa
\begin{split}&\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}A^{T}\bm{\lambda}(z_{%
\textbf{pa}},u)+c^{T}\bm{\lambda}(z_{\textbf{pa}},u)\\
&=\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u%
)+\kappa(z_{\textbf{pa}},u)+\gamma(z)\end{split}
\begin{split}&\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}A^{T}\bm{\lambda}(z_{%
\textbf{pa}},u)\\
&=\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u%
)+\bar{\kappa}(z_{\textbf{pa}},u)+\gamma(z)\end{split}
\bar{\kappa}
u
\begin{split}&\hat{\mathbf{T}}(\hat{g}^{-1}(x))^{T}(A^{T}\bm{\lambda}(z_{%
\textbf{pa}},u)-\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u))\\
&=\bar{\kappa}(z_{\textbf{pa}},u)+\gamma(z)\end{split}
\begin{split}&\mathbf{T}(\hat{g}^{-1}(x))^{T}(A^{T}\bm{\lambda}(z_{\textbf{pa}%
},u)-\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u))\\
&=\bar{\kappa}(z_{\textbf{pa}},u)+\gamma(\hat{g}^{-1}(x))\end{split}
z
\bar{z}
\begin{split}&[\mathbf{T}(z)-\mathbf{T}(\bar{z})]^{T}(A^{T}\bm{\lambda}(z_{%
\textbf{pa}},u)-\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u))\\
&=\gamma(\hat{g}^{-1}(x))-\gamma(\hat{g}^{-1}(\bar{x}))\end{split}
[\Delta\mathbf{T}^{(1)}\dots\Delta\mathbf{T}^{(n)}]
\begin{split}[\Delta\mathbf{T}^{(1)}\dots\Delta\mathbf{T}^{(n)}]^{T}&(A^{T}\bm%
{\lambda}(z_{\textbf{pa}},u)-\hat{\bm{\lambda}}(v(z_{\textbf{pa}}),u))\\
&=[\Delta\gamma^{(1)}\dots\Delta\gamma^{(n)}]\end{split}
A^{T}\bm{\lambda}(z_{\textbf{pa}},u)+\gamma=\hat{\bm{\lambda}}(v(z_{\textbf{pa%
}}),u)
\gamma=-[\Delta\mathbf{T}^{(1)}\dots\Delta\mathbf{T}^{(n)}]^{-T}[\Delta\gamma^%
{(1)}\dots\Delta\gamma^{(n)}]
\bm{\lambda}
\hat{\bm{\lambda}}
A^{T}\bm{\lambda}(z_{\textbf{pa}},u)+\gamma=\hat{\bm{\lambda}}(v(z_{\textbf{pa%
}}),u)
A
G^{z}
G^{z}
\hat{G}^{z}
\pi(\hat{G}^{z})=G^{z}
A
\bm{\lambda}
z
\mathbf{T}_{i}(z_{i}|z_{\textbf{pa}_{i}})=A_{ij}\hat{\mathbf{T}}_{j}(z_{j}|z_{%
\textbf{pa}_{j}})
\mathbf{T}
\hat{\mathbf{T}}
\bm{\lambda}
\hat{\bm{\lambda}}
z
z
\theta\sim_{P}\hat{\theta}
P=A
z
\hat{z}
z_{i}
\hat{z}_{i}
\begin{split}p(z)&=p(z_{1})p(z_{2})p(z_{3}|z_{1},z_{2})p(z_{4}|z_{1},z_{2})\\
&\approx p(\hat{z}_{1})p(\hat{z}_{2})p(\hat{z}_{3}|\hat{z}_{1},\hat{z}_{2})p(%
\hat{z}_{4}|\hat{z}_{1},\hat{z}_{2})=p(\hat{z})\end{split}
q_{\phi}(\epsilon,z|x,u)
p_{\theta}(\epsilon,z|x,u)
\mathcal{D}(q_{\phi}(\epsilon,z|x,u),p_{\theta}(\epsilon,z|x,u))
\displaystyle=\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x%
,u)}{p_{\theta}(\epsilon,z|x,u)}\;d\epsilon\;dz
\displaystyle=\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x%
,u)}{p_{\theta}(\epsilon,z|x,u)}\;d\epsilon\;dz
\displaystyle=\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x%
,u)p_{\theta}(x,u)}{p_{\theta}(\epsilon,z,u,x)}\;d\epsilon\;dz
\displaystyle=\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x%
,u)p_{\theta}(x,u)}{p_{\theta}(\epsilon,z,u,x)}\;d\epsilon\;dz
\displaystyle\begin{split}&=\int\int q_{\phi}(\epsilon,z|x,u)\Big{[}\log p_{%
\theta}(x,u)\\
&\qquad\qquad+\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{\theta}(\epsilon,z,u,x)}%
\Big{]}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\int\int q_{\phi}(\epsilon,z|x,u)\Big{[}\log p_{%
\theta}(x,u)\\
&\qquad\qquad+\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{\theta}(\epsilon,z,u,x)}%
\Big{]}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\int\int q_{\phi}(\epsilon,z|x,u)\log p_{\theta}(x%
,u)\\
&\qquad\qquad+q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{%
\theta}(\epsilon,z,u,x)}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\int\int q_{\phi}(\epsilon,z|x,u)\log p_{\theta}(x%
,u)\\
&\qquad\qquad+q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{%
\theta}(\epsilon,z,u,x)}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)\\
&\qquad+\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x,u)}{p%
_{\theta}(\epsilon,z,u,x)}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)\\
&\qquad+\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x,u)}{p%
_{\theta}(\epsilon,z,u,x)}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)\\
&+\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{%
\theta}(x|\epsilon,z,u)p_{\theta}(\epsilon,z,u)}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)\\
&+\int\int q_{\phi}(\epsilon,z|x,u)\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{%
\theta}(x|\epsilon,z,u)p_{\theta}(\epsilon,z,u)}\;d\epsilon\;dz\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)+\mathbb{E}_{\epsilon,z\sim q_%
{\phi}(\epsilon,z|x,u)}\Big{[}\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{\theta}(%
\epsilon,z,u)}\\
&\qquad\qquad-\log p_{\theta}(x|\epsilon,z,u)\Big{]}\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)+\mathbb{E}_{\epsilon,z\sim q_%
{\phi}(\epsilon,z|x,u)}\Big{[}\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{\theta}(%
\epsilon,z,u)}\\
&\qquad\qquad-\log p_{\theta}(x|\epsilon,z,u)\Big{]}\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)+\mathcal{D}(q_{\phi}(\epsilon%
,z|x,u)||p_{\theta}(\epsilon,z|u))\\
&\qquad\qquad-\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p%
_{\theta}(x|\epsilon,z,u)\Big{]}\end{split}
\displaystyle\begin{split}&=\log p_{\theta}(x,u)+\mathcal{D}(q_{\phi}(\epsilon%
,z|x,u)||p_{\theta}(\epsilon,z|u))\\
&\qquad\qquad-\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p%
_{\theta}(x|\epsilon,z,u)\Big{]}\end{split}
\begin{split}\mathcal{D}(q_{\phi}(\epsilon,z|x,u)||&p_{\theta}(\epsilon,z|x,u)%
)=\log p_{\theta}(x,u)\\
&+\mathcal{D}(q_{\phi}(\epsilon,z|x,u)||p_{\theta}(\epsilon,z|u))\\
&-\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p_{\theta}(x%
|\epsilon,z,u)\Big{]}\end{split}
\begin{split}&\log p_{\theta}(x,u)-\mathcal{D}(q_{\phi}(\epsilon,z|x,u)||p_{%
\theta}(\epsilon,z|x,u))\\
&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p_{\theta}(x%
|\epsilon,z,u)\Big{]}\\
&-\mathcal{D}(q_{\phi}(\epsilon,z|x,u)||p_{\theta}(\epsilon,z|u))\end{split}
\begin{split}\log p_{\theta}(x,u)&-\mathcal{D}(q_{\phi}(\epsilon,z|x,u)||p_{%
\theta}(\epsilon,z|x,u))\\
&\leq\log p_{\theta}(x,u)\end{split}
\begin{split}\underbrace{\log p_{\theta}(x,u)}_{\text{Evidence}}&\geq%
\overbrace{\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p_{%
\theta}(x|\epsilon,z,u)\Big{]}}^{\text{Likelihood}}\\
&-\underbrace{\mathcal{D}(q_{\phi}(\epsilon,z|x,u)||p_{\theta}(\epsilon,z,u))}%
^{\text{KL Term}}\end{split}
\epsilon
z
\begin{split}\log p_{\theta}(x,u)\geq&\mathbb{E}_{\epsilon,z\sim q_{\phi}(%
\epsilon,z|x,u)}\Big{[}\log p_{\theta}(x|\epsilon,z,u)\Big{]}\\
&-\mathcal{D}(q_{\phi}(\epsilon|x,u)||p_{\theta}(\epsilon))\\
&-\mathcal{D}(q_{\phi}(z|x,u)||p_{\theta}(z|u))\end{split}
\log p_{\theta}(x,u)\geq
\displaystyle\begin{split}&\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)%
}\Big{[}\log p_{\theta}(x|\epsilon,z,u)\Big{]}\\
&-\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log\frac{q_{\phi%
}(\epsilon,z|x,u)}{p_{\theta}(\epsilon,z)}\Big{]}\end{split}
\displaystyle\begin{split}&\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)%
}\Big{[}\log p_{\theta}(x|\epsilon,z,u)\Big{]}\\
&-\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log\frac{q_{\phi%
}(\epsilon,z|x,u)}{p_{\theta}(\epsilon,z)}\Big{]}\end{split}
\displaystyle=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p%
_{\theta}(x|\epsilon,z,u)-\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{\theta}(%
\epsilon,z)}\Big{]}
\displaystyle=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u)}\Big{[}\log p%
_{\theta}(x|\epsilon,z,u)-\log\frac{q_{\phi}(\epsilon,z|x,u)}{p_{\theta}(%
\epsilon,z)}\Big{]}
\displaystyle\begin{split}&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u%
)}\Big{[}\log p_{\theta}(x|\epsilon,z)-\log q_{\phi}(\epsilon,z|x,u)\\
&\qquad+\log p_{\theta}(\epsilon,z)\Big{]}\end{split}
\displaystyle\begin{split}&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u%
)}\Big{[}\log p_{\theta}(x|\epsilon,z)-\log q_{\phi}(\epsilon,z|x,u)\\
&\qquad+\log p_{\theta}(\epsilon,z)\Big{]}\end{split}
\displaystyle\begin{split}&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u%
)}\Big{[}\log p_{\theta}(x|\epsilon)+\log p_{\theta}(x|z)\\
&\qquad-\log q_{\phi}(\epsilon,z|x,u)+\log p_{\theta}(\epsilon)+\log p_{\theta%
}(z|u)\Big{]}\end{split}
\displaystyle\begin{split}&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u%
)}\Big{[}\log p_{\theta}(x|\epsilon)+\log p_{\theta}(x|z)\\
&\qquad-\log q_{\phi}(\epsilon,z|x,u)+\log p_{\theta}(\epsilon)+\log p_{\theta%
}(z|u)\Big{]}\end{split}
\displaystyle\begin{split}&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u%
)}\Big{[}\log p_{\theta}(x|\epsilon)+\log p_{\theta}(x|z)\\
&\qquad-\log q_{\phi}(\epsilon|x,u)-\log q_{\phi}(z|x,u)\\
&\qquad+\log p_{\theta}(\epsilon)+\log p_{\theta}(z|u)\Big{]}\end{split}
\displaystyle\begin{split}&=\mathbb{E}_{\epsilon,z\sim q_{\phi}(\epsilon,z|x,u%
)}\Big{[}\log p_{\theta}(x|\epsilon)+\log p_{\theta}(x|z)\\
&\qquad-\log q_{\phi}(\epsilon|x,u)-\log q_{\phi}(z|x,u)\\
&\qquad+\log p_{\theta}(\epsilon)+\log p_{\theta}(z|u)\Big{]}\end{split}
7
96\times 96\times 4
4
u_{1}=
u_{2}=
u_{3}=
u_{4}=
u_{1}\sim U(-45,45);\;\qquad\theta=u_{1}*\frac{\pi}{200}
u_{2}\sim U(60,145);\;\qquad\phi=u_{2}*\frac{\pi}{200}
x=10+9.5\sin\theta
y=10-9.5\cos\theta
\displaystyle u_{3}=\max(3,\Big{|}\frac{-0.5-(10.5-10\tan\phi)}{\tan\phi}
\displaystyle u_{3}
\displaystyle=\max(3,\Big{|}\frac{-0.5-(10.5-10\tan\phi)}{\tan\phi}
\displaystyle-\frac{-0.5-(y-x\tan\phi)}{\tan\phi}\Big{|})
\displaystyle-\frac{-0.5-(y-x\tan\phi)}{\tan\phi}\Big{|})
\displaystyle=\max(3,\Big{|}\frac{(-10.5+y)+(10-x)\tan\phi}{\tan\phi}\Big{|})
\displaystyle=\max(3,\Big{|}\frac{(-10.5+y)+(10-x)\tan\phi}{\tan\phi}\Big{|})
\displaystyle=\max(3,\Big{|}9.5\frac{\cos\theta}{\tan\phi}+9.5\sin\theta\Big{|})
\displaystyle=\max(3,\Big{|}9.5\frac{\cos\theta}{\tan\phi}+9.5\sin\theta\Big{|})
\displaystyle u_{4}=\frac{1}{2}\Big{(}\frac{-0.5-(10.5-10\tan\phi)}{\tan\phi}
\displaystyle u_{4}
\displaystyle=\frac{1}{2}\Big{(}\frac{-0.5-(10.5-10\tan\phi)}{\tan\phi}
\displaystyle+\frac{-0.5-(y-x\tan\phi)}{\tan\phi}\Big{)}
\displaystyle+\frac{-0.5-(y-x\tan\phi)}{\tan\phi}\Big{)}
\displaystyle=\frac{1}{2}\Big{(}\frac{(-11.5-y)+(10+x)\tan\phi}{\tan\phi}\Big{)}
\displaystyle=\frac{1}{2}\Big{(}\frac{(-11.5-y)+(10+x)\tan\phi}{\tan\phi}\Big{)}
\displaystyle=\frac{-11+4.75\cos\theta}{\tan\phi}+(10+4.75\sin\theta)
\displaystyle=\frac{-11+4.75\cos\theta}{\tan\phi}+(10+4.75\sin\theta)
8
96\times 96\times 4
4
u_{1}=
u_{2}=
u_{3}=
u_{4}=
512\times 512\times 3
4
\displaystyle v_{R}=0.2+0.6*\text{clip}(u_{2}+u_{3}+b_{R},0,1)
\displaystyle v_{R}
\displaystyle=0.2+0.6*\text{clip}(u_{2}+u_{3}+b_{R},0,1)
\displaystyle v_{G}=0.2+0.6*b_{G}
\displaystyle v_{G}
\displaystyle=0.2+0.6*b_{G}
\displaystyle v_{B}=0.2+0.6*b_{B}
\displaystyle v_{B}
\displaystyle=0.2+0.6*b_{B}
\displaystyle u_{4}\sim\text{Beta}(5v_{R},5*(1-v_{R}))
\displaystyle u_{4}
\displaystyle\sim\text{Beta}(5v_{R},5*(1-v_{R}))
\displaystyle u_{3}\sim\text{Beta}(5v_{G},5*(1-v_{G}))
\displaystyle u_{3}
\displaystyle\sim\text{Beta}(5v_{G},5*(1-v_{G}))
\displaystyle u_{2}\sim\text{Beta}(5v_{B},5*(1-v_{B}))
\displaystyle u_{2}
\displaystyle\sim\text{Beta}(5v_{B},5*(1-v_{B}))
\displaystyle u_{1}\sim U(0,1)
\displaystyle u_{1}
\displaystyle\sim U(0,1)
b_{R}
b_{G}
b_{B}
u_{1}
u_{2}
u_{3}
u_{4}
35
10
x
\epsilon
\epsilon=a^{-1}(x)
z=g^{-1}(x)=f^{RF}(\epsilon)
z
z_{z_{j}\leftarrow\alpha}
z
x
z_{2}
z_{3}
z_{4}
\beta
\beta
\mathcal{L}_{total}=\mathcal{L}_{ICM-VAE}+H(A)+\|A\|_{0}
H(A)=tr[(I+\alpha A\odot A)]^{n}-n=0
\|\cdot\|_{0}
\|\cdot\|_{1}
