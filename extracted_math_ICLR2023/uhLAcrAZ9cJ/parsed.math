\mathcal{Y}
\mathcal{X}
G:\mathcal{Y}\mapsto\mathcal{X}
\mathcal{Y}
\mathcal{X}
D_{X}
\mathcal{X}
D_{X}
\mathcal{X}
G
\mathcal{Y}
\mathcal{Y}
\mathcal{X}
D_{X}
\mathcal{Y}
\mathcal{X}
G
D_{X}
x\sim P_{\mathcal{X}}
G(z)
G(z)
D_{X}
x\sim P_{\mathcal{X}}
N
N
N
N
\mathcal{Y}
\mathcal{X}
P_{\mathcal{X}}
\mathcal{X}
P_{\mathcal{Y}}
\mathcal{Y}
x
y
\mathcal{X}
\mathcal{Y}
G:\mathcal{Y}\mapsto\mathcal{X}
\mathcal{Y}
\mathcal{X}
D_{X}
\mathcal{X}
G
\mathcal{Y}
F:\mathcal{X}\mapsto\mathcal{Y}
\mathcal{X}
\mathcal{Y}
D_{Y}
\mathcal{Y}
F
\mathcal{X}
G
D_{X}
\displaystyle\begin{split}\ell_{GAN}(G,D_{X})&=\mathbb{E}_{x\sim P_{\mathcal{X%
}}}[\log D_{X}(x)]+\mathbb{E}_{y\sim P_{\mathcal{Y}}}[\log(1-D_{X}(G(y)))].%
\end{split}
\displaystyle\begin{split}\ell_{GAN}(G,D_{X})&=\mathbb{E}_{x\sim P_{\mathcal{X%
}}}[\log D_{X}(x)]+\mathbb{E}_{y\sim P_{\mathcal{Y}}}[\log(1-D_{X}(G(y)))].%
\end{split}
\ell_{GAN}(F,D_{Y})
F
D_{Y}
\displaystyle\begin{split}\ell_{GAN}(F,D_{Y})&=\mathbb{E}_{y\sim P_{\mathcal{Y%
}}}[\log D_{Y}(y)]+\mathbb{E}_{x\sim P_{\mathcal{X}}}[\log(1-D_{Y}(F(x)))].%
\end{split}
\displaystyle\begin{split}\ell_{GAN}(F,D_{Y})&=\mathbb{E}_{y\sim P_{\mathcal{Y%
}}}[\log D_{Y}(y)]+\mathbb{E}_{x\sim P_{\mathcal{X}}}[\log(1-D_{Y}(F(x)))].%
\end{split}
\displaystyle\begin{split}\ell_{cycle}(G,F)&=\mathbb{E}_{y\sim P_{\mathcal{Y}}%
}[||F(G(y))-y||_{1}]+\mathbb{E}_{x\sim P_{\mathcal{X}}}[||G(F(x))-x||_{1}],%
\end{split}
\displaystyle\begin{split}\ell_{cycle}(G,F)&=\mathbb{E}_{y\sim P_{\mathcal{Y}}%
}[||F(G(y))-y||_{1}]+\mathbb{E}_{x\sim P_{\mathcal{X}}}[||G(F(x))-x||_{1}],%
\end{split}
\displaystyle\begin{split}\ell_{CycleGAN}(G,F,D_{X},D_{Y})&=\ell_{GAN}(G,D_{X}%
)+\ell_{GAN}(F,D_{Y})+\lambda\ell_{cycle}(G,F)\end{split}
\displaystyle\begin{split}\ell_{CycleGAN}(G,F,D_{X},D_{Y})&=\ell_{GAN}(G,D_{X}%
)+\ell_{GAN}(F,D_{Y})+\lambda\ell_{cycle}(G,F)\end{split}
\lambda
\displaystyle\min_{G,F}\max_{D_{X},D_{Y}}\ell_{CycleGAN}(G,F,D_{X},D_{Y}).
\displaystyle\min_{G,F}\max_{D_{X},D_{Y}}\ell_{CycleGAN}(G,F,D_{X},D_{Y}).
G
F
D_{X}
D_{Y}
\ell_{identity}
\displaystyle\begin{split}\ell_{identity}(G,F)&=\mathbb{E}_{x\sim P_{\mathcal{%
X}}}[||G(x)-x||_{1}]+\mathbb{E}_{y\sim P_{\mathcal{Y}}}[||F(y)-y||_{1}].\end{split}
\displaystyle\begin{split}\ell_{identity}(G,F)&=\mathbb{E}_{x\sim P_{\mathcal{%
X}}}[||G(x)-x||_{1}]+\mathbb{E}_{y\sim P_{\mathcal{Y}}}[||F(y)-y||_{1}].\end{split}
z\sim P_{\mathcal{Z}}
x\sim P_{\mathcal{X}}
\mathcal{X}
\mathcal{Y}
z\sim P_{\mathcal{Z}}
x\sim P_{\mathcal{X}}
G
F
D_{X}
D_{Y}
\displaystyle\begin{split}\ell_{CycleGAN}(G,F,D_{X},D_{Y})&=\ell_{\mathcal{X}}%
(G,F,D_{X},D_{Y})+\ell_{\mathcal{Y}}(G,F,D_{X},D_{Y})\end{split}
\displaystyle\begin{split}\ell_{CycleGAN}(G,F,D_{X},D_{Y})&=\ell_{\mathcal{X}}%
(G,F,D_{X},D_{Y})+\ell_{\mathcal{Y}}(G,F,D_{X},D_{Y})\end{split}
\ell_{\mathcal{X}}
\ell_{\mathcal{Y}}
\mathcal{X}
\mathcal{Y}
\displaystyle\ell_{\mathcal{X}}(G,F,D_{X},D_{Y})=\mathbb{E}_{x\sim P_{\mathcal%
{X}}}[\log D_{X}(x)]+\mathbb{E}_{x\sim P_{\mathcal{X}}}[\log(1-D_{Y}(F(x)))]
\displaystyle\ell_{\mathcal{X}}(G,F,D_{X},D_{Y})
\displaystyle=\mathbb{E}_{x\sim P_{\mathcal{X}}}[\log D_{X}(x)]+\mathbb{E}_{x%
\sim P_{\mathcal{X}}}[\log(1-D_{Y}(F(x)))]
\displaystyle+{\lambda}\mathbb{E}_{x\sim P_{\mathcal{X}}}[||G(F(x))-x||_{1}]
\displaystyle+{\lambda}\mathbb{E}_{x\sim P_{\mathcal{X}}}[||G(F(x))-x||_{1}]
\displaystyle\ell_{\mathcal{Y}}(G,F,D_{X},D_{Y})=\mathbb{E}_{y\sim P_{\mathcal%
{Y}}}[\log(1-D_{X}(G(y)))]+\mathbb{E}_{y\sim P_{\mathcal{Y}}}[\log D_{Y}(y)]
\displaystyle\ell_{\mathcal{Y}}(G,F,D_{X},D_{Y})
\displaystyle=\mathbb{E}_{y\sim P_{\mathcal{Y}}}[\log(1-D_{X}(G(y)))]+\mathbb{%
E}_{y\sim P_{\mathcal{Y}}}[\log D_{Y}(y)]
\displaystyle+{\lambda}\mathbb{E}_{y\sim P_{\mathcal{Y}}}[||F(G(y))-y||_{1}]
\displaystyle+{\lambda}\mathbb{E}_{y\sim P_{\mathcal{Y}}}[||F(G(y))-y||_{1}]
\ell_{CycleGAN}
\mathcal{X}
\ell_{\mathcal{X}}
\mathcal{Y}
\ell_{\mathcal{Y}}
\mathcal{X}
\ell_{\mathcal{X}}
\mathcal{Y}
\ell_{\mathcal{Y}}
N
\mathcal{X}
\mathcal{Y}
N
\ell_{\mathcal{X}}
\ell_{\mathcal{Y}}
G,F
D_{X},D_{Y}
\mathcal{Y}
\mathcal{X}
\mathcal{X}
\mathcal{Y}
\mathcal{G}
\mathcal{D}
\displaystyle\mathcal{G}(\cdot,c)=\begin{cases}G(\cdot),&\mbox{if~{}}c=g(0)\\
F(\cdot),&\mbox{if~{}}c=g(1)\end{cases},\mathcal{D}(\cdot,c)=\begin{cases}D_{X%
}(\cdot),&\mbox{if~{}}c=d(0)\\
D_{Y}(\cdot),&\mbox{if~{}}c=d(1)\end{cases}
\displaystyle\mathcal{G}(\cdot,c)=\begin{cases}G(\cdot),&\mbox{if~{}}c=g(0)\\
F(\cdot),&\mbox{if~{}}c=g(1)\end{cases},
\displaystyle\mathcal{D}(\cdot,c)=\begin{cases}D_{X}(\cdot),&\mbox{if~{}}c=d(0%
)\\
D_{Y}(\cdot),&\mbox{if~{}}c=d(1)\end{cases}
g(n)
d(n)
n
\mathcal{X}
\mathcal{Y}
\displaystyle\ell_{\mathcal{X}}(\mathcal{G},\mathcal{D},g,d)=\mathbb{E}_{x}[%
\log\mathcal{D}(x,d(0))]+\mathbb{E}_{x}[\log(1-\mathcal{D}(\mathcal{G}(x,g(1))%
,d(1)))]
\displaystyle\ell_{\mathcal{X}}(\mathcal{G},\mathcal{D},g,d)
\displaystyle=\mathbb{E}_{x}[\log\mathcal{D}(x,d(0))]+\mathbb{E}_{x}[\log(1-%
\mathcal{D}(\mathcal{G}(x,g(1)),d(1)))]
\displaystyle~{}+{\lambda}\mathbb{E}_{x}[||\mathcal{G}(\mathcal{G}(x,g(1)),g(0%
))-x||_{1}]
\displaystyle~{}+{\lambda}\mathbb{E}_{x}[||\mathcal{G}(\mathcal{G}(x,g(1)),g(0%
))-x||_{1}]
\displaystyle\ell_{\mathcal{Y}}(\mathcal{G},\mathcal{D},g,d)=\mathbb{E}_{y}[%
\log(1-\mathcal{D}(\mathcal{G}(y,g(0)),d(0)))]+\mathbb{E}_{y}[\log\mathcal{D}(%
y,d(1))]
\displaystyle\ell_{\mathcal{Y}}(\mathcal{G},\mathcal{D},g,d)
\displaystyle=\mathbb{E}_{y}[\log(1-\mathcal{D}(\mathcal{G}(y,g(0)),d(0)))]+%
\mathbb{E}_{y}[\log\mathcal{D}(y,d(1))]
\displaystyle~{}+{\lambda}\mathbb{E}_{y}[||\mathcal{G}(\mathcal{G}(y,g(0)),g(1%
))-y||_{1}]
\displaystyle~{}+{\lambda}\mathbb{E}_{y}[||\mathcal{G}(\mathcal{G}(y,g(0)),g(1%
))-y||_{1}]
\#
\#
G
\mathcal{G}
F
g
D_{X}
\mathcal{D}
D_{Y}
d
\mathcal{G},\mathcal{D}
g
d
g
d
W^{(k)}_{Global}
\nabla\ell_{\mathcal{X}}
\nabla\ell_{\mathcal{Y}}
\lambda=10
5
\beta_{1}=0.5
\beta_{2}=0.999
\downarrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\cdot
\cdot
\cdot
\cdot
\cdot
\cdot
\times
\times
\times
\%
\times
\times
N
N
N
N
N=4
N
N
\uparrow
\downarrow
\mathcal{G}
\mathcal{D}
g
d
k
\mathcal{X}
\mathcal{Y}
\theta_{\mathcal{G}}^{(k-1)}
\theta_{\mathcal{D}}^{(k-1)}
\theta_{g}^{(k-1)}
\theta_{d}^{(k-1)}
\ell_{\mathcal{X}}
\ell_{\mathcal{Y}}
\eta
K
K
\eta
\mathcal{G}
\mathcal{D}
g
d
\theta_{\mathcal{G}}
\theta_{\mathcal{D}}
\theta_{g}
\theta_{d}
K
\{\mathcal{X},\mathcal{Y}\}
{g_{\theta_{\mathcal{G}}}}^{(i)},{g_{\theta_{\mathcal{D}}}}^{(i)},{g_{\theta_{%
g}}}^{(i)},{g_{\theta_{d}}}^{(i)}\leftarrow
\theta_{\mathcal{G}}^{(k-1)}
\theta_{\mathcal{D}}^{(k-1)}
\theta_{g}^{(k-1)}
\theta_{d}^{(k-1)}
{\theta_{\mathcal{G}}}^{(k)}\leftarrow{\theta_{\mathcal{G}}}^{(k-1)}-\eta\sum_%
{i}{g_{\theta_{\mathcal{G}}}}^{(i)}
{\theta_{\mathcal{D}}}^{(k)}\leftarrow{\theta_{\mathcal{D}}}^{(k-1)}-\eta\sum_%
{i}{g_{\theta_{\mathcal{D}}}}^{(i)}
{\theta_{g}}^{(k)}\leftarrow{\theta_{g}}^{(k-1)}-\eta\sum_{i}{g_{\theta_{g}}}^%
{(i)}
{\theta_{d}}^{(k)}\leftarrow{\theta_{d}}^{(k-1)}-\eta\sum_{i}{g_{\theta_{d}}}^%
{(i)}
\mathcal{G}
\mathcal{D}
g
d
\theta_{\mathcal{G}}
\theta_{\mathcal{D}}
\theta_{g}
\theta_{d}
b\leftarrow
i
{g_{\theta_{\mathcal{G}}}}^{(i)}\leftarrow\nabla_{\theta_{\mathcal{G}}}\ell_{i%
}(\mathcal{G},\mathcal{D},g,d;b)
{g_{\theta_{\mathcal{D}}}}^{(i)}\leftarrow\nabla_{\theta_{\mathcal{D}}}\ell_{i%
}(\mathcal{G},\mathcal{D},g,d;b)
{g_{\theta_{g}}}^{(i)}\leftarrow\nabla_{\theta_{g}}\ell_{i}(\mathcal{G},%
\mathcal{D},g,d;b)
{g_{\theta_{d}}}^{(i)}\leftarrow\nabla_{\theta_{d}}\ell_{i}(\mathcal{G},%
\mathcal{D},g,d;b)
{g_{\theta_{\mathcal{G}}}}^{(i)},{g_{\theta_{\mathcal{D}}}}^{(i)},{g_{\theta_{%
g}}}^{(i)},{g_{\theta_{d}}}^{(i)}
