700\times
k
k
N
k
t
t+1
k
\mathcal{D}_{k}
t
w_{k}^{t-1}
w^{t}
\hat{w}_{k}^{t}
\hat{w}_{k}^{t}
\mathcal{D}_{k}
w_{k}^{t}
w_{k}^{t-1}\rightarrow\hat{w}_{k}^{t}
\hat{w}_{k}^{t}\rightarrow w_{k}^{t}
w^{t}
\hat{w}_{k}^{t}\simeq w^{t}
\hat{w}_{k}^{t}\sim w^{t}
w_{t-1}
t
w^{t-1}\rightarrow\{\hat{w}_{i}^{t}|i=1,2,...,N\}
\{\hat{w}_{i}^{t}|i=1,2,...,N\}\rightarrow w^{t}
k
t
[t-T,t]
\mathcal{L}_{k}^{t}=\{w_{k}^{t-T},...,w_{k}^{t}\}
w_{k}^{t}\rightarrow\hat{w}_{k}^{t}
\mathcal{\hat{G}}_{k}^{t}=\{\hat{w}_{k}^{t-T},...,\hat{w}_{k}^{t}\}
\hat{w}_{k}^{t}\rightarrow w_{k}^{t+1}
\{\mathcal{\hat{L}}_{i}|i=1,2,...,N\}
\{\mathcal{G}_{i}|i=1,2,...,N\}
t
k
t
\hat{w}_{k}^{t}\rightarrow w_{k}^{t}
\mathcal{L}_{k}^{t-1}
\mathcal{\hat{G}}_{k}^{t-1}
\tilde{w}_{k}^{t}=f_{predict,k}(\mathcal{L}_{k}^{t-1},\mathcal{\hat{G}}_{k}^{t%
-1},\hat{w}_{k}^{t})=\operatorname*{arg\,max}_{w_{k}^{t}}p(w_{k}^{t}|%
\underbrace{w_{k}^{t-T},...,w_{k}^{t-1}}_{\text{$\mathcal{L}_{k}^{t-1}$}},%
\underbrace{\hat{w}_{k}^{t-T},...,\hat{w}_{k}^{t-1}}_{\text{$\mathcal{\hat{G}}%
_{k}^{t-1}$}},\hat{w}_{k}^{t})
f_{predict,k}
k
\hat{w}_{i}^{t}\rightarrow w^{t}
i
\mathcal{\hat{L}}_{i}^{t-1}
\mathcal{G}_{i}^{t-1}
\tilde{w}_{i}^{t}=h_{predict,i}(\mathcal{\hat{L}}_{i}^{t-1},\mathcal{G}_{i}^{t%
-1},\hat{w}_{i}^{t})=\operatorname*{arg\,max}_{w_{i}^{t}}p(w_{i}^{t}|%
\underbrace{w_{i}^{t-T},...,w_{i}^{t-1}}_{\text{$\mathcal{\hat{L}}_{k}^{t-1}$}%
},\underbrace{\hat{w}_{i}^{t-T},...,\hat{w}_{i}^{t-1}}_{\text{$\mathcal{G}_{k}%
^{t-1}$}},\hat{w}_{i}^{t}),\forall i\in{1,...,N}
h_{predict,i}
i
\hat{w}_{i}^{t}\rightarrow w_{i}^{t}
i
t
\tilde{w}_{i}^{t}
r_{i}^{t}=w_{i}^{t}-\tilde{w}_{i}^{t}
r_{i,ul}^{t}
r_{i,dl}^{t}
\bar{w}_{k}^{t}=f_{compress}(w_{k}^{t})
\bar{w}_{i}^{t}=h_{compress}(w_{i}^{t}),\forall i\in\{1,...,N\}
f_{compress}
h_{compress}
\bar{r}_{k,ul}^{t}=f_{compress}(r_{k,ul}^{t})=f_{compress}(w_{k}^{t}-f_{%
predict,i}(w_{k}^{t-T},...,w_{i}^{t-1},\hat{w}_{k}^{t-T},...,\hat{w}_{k}^{t-1}%
,\hat{w}_{k}^{t}))
\bar{r}_{i,dl}^{t}=h_{compress}(r_{i,dl}^{t})=h_{compress}(w_{i}^{t}-f_{%
predict,i}(w_{i}^{t-T},...,w_{i}^{t-1},\hat{w}_{i}^{t-T},...,\hat{w}_{i}^{t-1}%
,\hat{w}_{i}^{t})),\forall i\in\{1,...,N\}
w
\mathcal{\hat{L}}_{1},...,\mathcal{\hat{L}}_{N}
\mathcal{G}_{1},...,\mathcal{G}_{N}
h_{predict}
i\in\{1,2,...,N\}
\mathcal{L}_{i}
i
\mathcal{\hat{G}}_{i}
i
h^{\prime}_{predict,i}=h_{predict}
i
f^{\prime}_{predict,i}=f_{predict,i}
i
t\in\{1,2,...,M\}
i\in\{1,2,...,N\}
t<T
\mathcal{\hat{G}}_{i}\leftarrow cache(w)
\mathcal{\hat{G}}_{i}
i
w
i
\hat{w}_{i}\leftarrow\textbf{LocalTrain}(w)
i
i
\hat{w}_{i}
\mathcal{L}_{i}\leftarrow cache(\hat{w}_{i})
\mathcal{L}_{i}
i
\bar{r}_{i,dl}
i
\bar{r}_{i,ul}\leftarrow
(i,\bar{r}_{i,dl})
i
i
\bar{r}_{i,ul}
\tilde{w}_{i}\leftarrow f^{\prime}_{predict,i}(\mathcal{G}_{i},\mathcal{\hat{L%
}}_{i},\hat{w})
\hat{w}_{i}\leftarrow\tilde{w}_{i}+\bar{r}_{i,ul}
\mathcal{\hat{L}}_{i}\leftarrow cache(\hat{w}_{i})
w\leftarrow\textbf{Aggregate}(\hat{w}_{1},...,\hat{w}_{N})
i\in\{1,2,...,N\}
\tilde{w}_{i}\leftarrow h_{predict}(\mathcal{G}_{i},\mathcal{\hat{L}}_{i},w)
r_{i,dl}\leftarrow w-\tilde{w}_{i}
\bar{r}_{i,dl}\leftarrow h_{compress}(r_{i,dl})
\mathcal{G}_{i}\leftarrow cache(\tilde{w}_{i}+\bar{r}_{i,dl})
w
(k,\bar{r})
\tilde{w}\leftarrow h^{\prime}_{predict,i}(\mathcal{\hat{G}}_{k},\mathcal{L}_{%
k},w_{k})
\hat{w}\leftarrow\tilde{w}+\bar{r}
\mathcal{\hat{G}}_{k}\leftarrow cache(\hat{w})
w_{k}\leftarrow\textbf{LocalTrain}(\hat{w})
\tilde{w}_{k}\leftarrow f_{predict,i}(\mathcal{\hat{G}}_{k},\mathcal{L}_{k},%
\hat{w})
r_{k}\leftarrow w_{k}-\tilde{w}_{k}
\bar{r}_{k}\leftarrow f_{compress}(r_{k})
\mathcal{L}_{k}\leftarrow cache(\tilde{w}_{k}+\bar{r}_{k})
\bar{r}_{k}
k
\mathcal{\hat{G}}_{k}
k
f_{predict,k}
k
f^{\prime}_{predict,k}=f_{predict,k}
t+1
\{h_{predict,i}|i=1,...,N\}
h^{\prime}_{predict,i}=h_{predict,i},\forall i\in\{1,...,N\}
\tilde{w}_{k}^{t}=f_{predict}(\mathcal{L}_{k}^{t-1},\mathcal{\hat{G}}_{k}^{t-1%
},\hat{w}_{k}^{t})=\begin{cases}\hat{w}_{k}^{t},&\text{$T=0$}.\\
\hat{w}_{k}^{t}+\sum_{\tau=1}^{T}(-1)^{T-\tau}(T-\tau+1)(w_{k}^{t-\tau}-\hat{w%
}_{k}^{t-\tau}),&\text{$T>0$}.\end{cases}
[t-T,t]
T=0
T=1
\tilde{w}_{k}^{t}=\hat{w}_{k}^{t}
r_{k}^{t}=w_{k}^{t}-\hat{w}_{k}^{t}
r=\eta g
\eta
g
\tilde{w}_{k}^{t}=\hat{w}_{k}^{t}+w_{k}^{t-1}-\hat{w}_{k}^{t-1}
r_{k}^{t}=w_{k}^{t}-\hat{w}_{k}^{t}-w_{k}^{t-1}+\hat{w}_{k}^{t-1}
k
h_{predict,k}
f_{predict,k}
k
t
\tilde{w}_{k}^{t}
k
\hat{w}_{k}^{t}=w^{t}
k
w_{k}^{t}
w_{k}^{t}=r_{k}^{t}+\hat{w}_{k}^{t}=r_{k}^{t}+w^{t}
\hat{w}_{k}^{t}
\bar{r}\neq r
w
\hat{w}=\bar{r}+\tilde{w}
w
\hat{w}\neq w
w
\hat{w}
350\times
375\times
350\times-375\times
N
V
T
2*32*V*T
2
T*V
2*32*V*T*N
i
k
t
\eta
N
T
V
w
w^{t}
t
w_{k}
k
\bar{w}
\tilde{w}
\hat{w}
g
r
r^{t}
t
r_{k}
k
r_{i,dl}
i
i
r_{i,ul}
i
\bar{r}
\hat{r}
\mathcal{D}
\mathcal{G}
\mathcal{L}
\times
\times
T=0
T=1
350\times
375\times
356\times
\{0\%,90\%,95\%,99\%,99.5\%\}
61706
10
0.001
64
1
\{1,4,8,16,32,128\}
61706
10
0.001
64
1
\{1,4,8,16,32,128\}
\{1,4,8,16,32,128\}
