G(V,E)
V
E
G(V,E)
G^{\prime}(V,E^{\prime})
\{x_{i}\}^{i=n}_{i=1}
D
G^{\prime}(V,E^{\prime})
i
j
D_{ij}=\begin{cases}Distance(i,j)&\text{$x_{i}$ and $x_{j}$ in $G^{\prime}(V,E%
^{\prime})$,}\\
1&\text{$x_{i}$ and $x_{j}$ in different modalities,}\\
1&\text{$x_{i}$ and $x_{j}$ in text modality.}\\
\end{cases}
x_{i}
x_{j}
G^{\prime}(V,E^{\prime})
x_{i}
x_{j}
x_{i}
x_{j}
L
W^{K}
W^{Q}
W^{V}
Q=H_{in}W^{Q},K=H_{in}W^{K},V=H_{in}W^{V}.
Q
K
h
A=softmax\left(\frac{QK^{T}}{\sqrt{d_{k}}}+M\right),
\mbox{where }M_{ij}=\begin{cases}0&D_{ij}\leq h,\\
-\infty&D_{ij}>h.\end{cases}
A
V
F:D\rightarrow\mathbb{R}^{1}
A
\sigma
H_{out}=\sigma(F(D)\cdot A)V,
\sigma(e_{ij})=\frac{e_{ij}}{\sum_{j=1}^{n}e_{ij}}.
F(D)_{ij}=\begin{cases}(1+\dfrac{(D_{ij}-1)^{2}}{2\cdot\alpha_{o}\cdot l^{2}_{%
o}})^{-\alpha_{o}}&\text{$x_{i}$ $\in$ objects}\\
(1+\dfrac{(D_{ij}-1)^{2}}{2\cdot\alpha_{p}\cdot l^{2}_{p}})^{-\alpha_{p}}&%
\text{$x_{i}$ $\in$ predicates}\\
1&\text{else}\end{cases}
x_{i}
\in
x_{i}
\in
\alpha_{o}
\alpha_{p}
l_{o}
l_{p}
1\times 1
1\times 1
[man,on,floor](subject,relationship,object)
[on]
(subject,relationship,object)
30\%
\mathcal{L}_{\mathrm{MNM}}(\theta)=\mathcal{L}_{sbj}(\theta)+\mathcal{L}_{obj}%
(\theta)+\mathcal{L}_{rel}(\theta),
\theta
\left\langle\mathbf{n}_{s_{i}},\mathbf{n}_{o_{i}},\mathbf{n}_{r_{i}}\right\rangle
\mathbf{N}
\mathcal{L}_{sbj}(\theta)=-\mathbb{E}_{(\mathbf{n},\mathbf{v})\sim D}\log P_{%
\theta}\left(\mathbf{n}_{\mathbf{s_{i}}}\mid\mathbf{n}_{\backslash\mathbf{s_{i%
}}},\mathbf{n}_{\mathbf{o_{i}}},\mathbf{n}_{\mathbf{r_{i}}},\mathbf{N},\mathbf%
{V}\right),
\mathcal{L}_{obj}(\theta)=-\mathbb{E}_{(\mathbf{n},\mathbf{v})\sim D}\log P_{%
\theta}\left(\mathbf{n}_{\mathbf{o_{i}}}\mid\mathbf{n}_{\backslash\mathbf{o_{i%
}}},\mathbf{n}_{\mathbf{s_{i}}},\mathbf{n}_{\mathbf{r_{i}}},\mathbf{N},\mathbf%
{V}\right),
\mathcal{L}_{rel}(\theta)=-\mathbb{E}_{(\mathbf{n},\mathbf{v})\sim D}\log P_{%
\theta}\left(\mathbf{n}_{\mathbf{r_{i}}}\mid\mathbf{n}_{\backslash\mathbf{r_{i%
}}},\mathbf{n}_{\mathbf{s_{i}}},\mathbf{n}_{\mathbf{o_{i}}},\mathbf{N},\mathbf%
{V}\right),
i
s
o
r
\rightarrow
\rightarrow
\rightarrow
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
F()
\rightarrow
F(x)=x
F(x)=x
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
F()
F()
\rightarrow
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\surd
\rightarrow
\rightarrow
\rightarrow
76.0\%
78.0\%
59.6\%
\alpha
l
\alpha
l
\rightarrow
\rightarrow
\rightarrow
