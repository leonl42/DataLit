21.82\times
\mathcal{O}(T^{-2/3}M^{-1/3})
T
M
\textbf{33.14}\%
\textbf{21.82}\times
\mathcal{G(V,E)}
\mathbf{X}\in\mathbb{R}^{|\mathcal{V}|\times d}
d
v\in\mathcal{V}
\mathbf{y}_{v}
L
f
\mathbf{h}_{v}
\mathbf{y}_{v}
\mathcal{G(V,E)}
v\in\mathcal{V}
(\ell+1)
\begin{split}\mathbf{h}_{v}^{(\ell+1)}=f^{(\ell+1)}\Big{(}\mathbf{h}_{v}^{(%
\ell)},\big{\{}\mathbf{h}^{(\ell)}_{u}:u\in\mathcal{N}(v)\big{\}}\Big{)}=\Psi^%
{(\ell+1)}\Big{(}\mathbf{h}_{v}^{(\ell)},\Phi^{(\ell+1)}\Big{(}\big{\{}\mathbf%
{h}^{(\ell)}_{u}:u\in\mathcal{N}(v)\big{\}}\Big{)}\Big{)},\end{split}\vspace{-%
1mm}
\mathbf{h}_{v}^{(\ell)}
v
\ell
\mathbf{h}^{(0)}_{v}
\mathbf{x}_{v}
v
\mathbf{X}
\mathcal{N}(v)
1
v
f^{(\ell)}
\Phi^{(\ell)}
v
\Psi^{(\ell)}
v
v
\Phi^{(\ell)}
\Psi^{(\ell)}
\mathcal{L}(\mathbf{W})
\mathcal{L}(\mathbf{W})=(1/|\mathcal{V}|)\sum\nolimits_{v\in\mathcal{V}}Loss%
\big{(}\mathbf{h}_{v}^{(L)},\mathbf{y}_{v}\big{)}
Loss(\cdot,\cdot)
\mathbf{h}_{v}^{(L)}
v
\begin{split}\mathbf{h}_{v}^{(\ell+1)}=\Psi^{(\ell+1)}\Big{(}\mathbf{h}_{v}^{(%
\ell)},\Phi^{(\ell+1)}\Big{(}\underbrace{\big{\{}\mathbf{h}^{(\ell)}_{u}:u\in%
\mathcal{N}(v)\cap\mathcal{S}(v)\big{\}}}_{\text{In-subgraph nodes}}\cup%
\underbrace{\big{\{}\mathbf{h}^{(\ell)}_{u}:u\in\mathcal{N}(v)\setminus%
\mathcal{S}(v)\big{\}}}_{\text{Out-of-subgraph nodes}}\Big{)}\Big{)},\end{split}
\mathcal{S}(v)
v
\mathcal{G}
M
\mathcal{G}_{m}(\mathcal{V}_{m},\mathcal{E}_{m})
m
\mathbf{W}
\text{min}_{\mathbf{W}}\;\mathcal{L}_{m}^{\text{Local}}\big{(}\mathbf{W}_{m}%
\big{)}=\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in\mathcal{V}_{m}}Loss\big{(}%
\mathbf{h}_{v}^{(L)},\mathbf{y}_{v}\big{)},\quad m=1,2,\cdots,M\;\;\text{\emph%
{in parallel}},
\mathbf{W}_{m}=\{\mathbf{W}_{m}^{(\ell)}\}_{\ell=1}^{L}
\mathbf{h}_{v}^{(L)}
\nabla\mathcal{L}_{m}^{\text{Local}}
\mathbf{\tilde{h}}^{(\ell)}_{v}
v\in\mathcal{G}_{m}(\mathcal{V}_{m},\mathcal{E}_{m})
(\ell+1)
\begin{split}\mathbf{h}_{v}^{(\ell+1)}=\Psi^{(\ell+1)}\bigg{(}\mathbf{h}_{v}^{%
(\ell)},\Phi^{(\ell+1)}\Big{(}\left\{\mathbf{h}^{(\ell)}_{u}:u\in\mathcal{N}(v%
)\cap\mathcal{V}_{m}\right\}\cup\underbrace{\left\{\mathbf{\tilde{h}}^{(\ell)}%
_{u}:u\in\mathcal{N}(v)\setminus\mathcal{V}_{m}\right\}}_{\text{Stale %
representation}}\Big{)}\bigg{)}.\end{split}
\begin{split}\mathbf{H}_{in}^{(\ell+1,m)}=F\Big{(}\mathbf{H}_{in}^{(\ell,m)},%
\mathbf{\tilde{H}}_{out}^{(\ell,m)}\Big{)}\coloneqq\sigma\Big{(}\mathbf{P}_{in%
}^{(m)}\mathbf{H}_{in}^{(\ell,m)}\mathbf{W}_{m}^{(\ell+1)}+\mathbf{P}_{out}^{(%
m)}\mathbf{\tilde{H}}_{out}^{(\ell,m)}\mathbf{W}_{m}^{(\ell+1)}\Big{)},\end{split}
\mathbf{H}_{in}^{(\ell,m)}
\mathbf{\tilde{H}}_{out}^{(\ell,m)}
\ell
\mathcal{G}_{m}
F
\mathbf{P}_{in}^{(m)}
\mathbf{P}_{out}^{(m)}
\mathcal{G}_{m}
\mathbf{P}_{m}=\mathbf{P}_{in}^{(m)}+\mathbf{P}_{out}^{(m)}
\mathbf{P}_{m}
\mathcal{G}_{m}
\sigma(\cdot)
\begin{split}&\frac{\partial}{\partial\mathbf{W}^{(\ell+1)}_{m}}F\Big{(}%
\mathbf{H}_{in}^{(\ell,m)},\mathbf{\tilde{H}}_{out}^{(\ell,m)}\Big{)}=\frac{%
\partial}{\partial\mathbf{W}^{(\ell+1)}_{m}}\sigma\Big{(}\mathbf{P}_{in}^{(m)}%
\mathbf{H}_{in}^{(\ell,m)}\mathbf{W}_{m}^{(\ell+1)}+\mathbf{P}_{out}^{(m)}%
\mathbf{\tilde{H}}_{out}^{(\ell,m)}\mathbf{W}_{m}^{(\ell+1)}\Big{)}\\
&=\Big{[}\mathbf{P}_{in}^{(m)}\mathbf{H}_{in}^{(\ell,m)}+\mathbf{P}_{out}^{(m)%
}\mathbf{\tilde{H}}_{out}^{(\ell,m)}\Big{]}^{\top}\sigma^{\prime}\Big{(}%
\mathbf{P}_{in}^{(m)}\mathbf{H}_{in}^{(\ell,m)}\mathbf{W}_{m}^{(\ell+1)}+%
\mathbf{P}_{out}^{(m)}\mathbf{\tilde{H}}_{out}^{(\ell,m)}\mathbf{W}_{m}^{(\ell%
+1)}\Big{)}.\end{split}
\mathbf{\tilde{H}}_{out}^{(\ell,m)}
\ell
\mathcal{V}
\mathbf{\tilde{H}}^{(\ell)}=\{\mathbf{\tilde{h}}^{(\ell)}_{v}:v\in\mathcal{V}\}
\mathcal{G}_{m}
\ell
\mathbf{\tilde{H}}_{out}^{(\ell,m)}=\{\mathbf{\tilde{h}}^{(\ell)}_{u}:u\in%
\mathcal{N}(v)\setminus\mathcal{V}_{m},\forall\;v\in\mathcal{V}_{m}\}
\mathbf{H}^{(\ell,m)}_{out}\leftarrow\mathbf{\tilde{H}}^{(\ell,m)}_{out}
\mathbf{H}_{in}^{(\ell,m)}=\{\mathbf{{h}}^{(\ell)}_{v}:\forall\;v\in\mathcal{V%
}_{m}\}
\mathbf{H}^{(\ell,m)}_{in}\rightarrow\mathbf{\tilde{H}}^{(\ell,m)}_{in}
\mathcal{G(V,E)}
L
R
\mathbf{W}^{(r)}=\{\mathbf{W}^{(r,\ell)}\}_{\ell=1}^{L}
\mathbf{W}_{m}^{(r)}=\{\mathbf{W}_{m}^{(r,\ell)}\}_{\ell=1}^{L}
\forall\;m\in\big{[}M\big{]},r\in\big{[}R\big{]}
\sigma
\mathcal{N}:v\rightarrow 2^{\mathcal{V}}
\eta
\mathbf{W}^{(R+1)}
\mathbf{W}^{(1)}
\{\mathcal{G}_{m}(\mathcal{V}_{m},\mathcal{E}_{m}),m=1,2,..,M\}
\leftarrow
\mathcal{G}
r=1...R
m=1,\cdots,M
\mathbf{W}^{(r)}_{m}=\mathbf{W}^{(r)}
\ell=1...L
r\;\%\;N==0
\ell\neq L
\mathbf{H}_{out}^{(\ell,m)}\leftarrow\mathbf{\tilde{H}}_{out}^{(\ell,m)}
v\in\mathcal{V}_{m}
\mathbf{h}_{out}^{(\ell)}=\{\mathbf{h}^{(\ell)}_{u}:u\in\mathcal{N}(v)%
\setminus\mathcal{V}_{m}\}
\mathbf{h}_{in}^{(\ell)}=\{\mathbf{h}^{(\ell)}_{u}:u\in\mathcal{N}(v)\cap%
\mathcal{V}_{m}\}
\mathbf{h}^{(\ell)}_{v}=\sigma\Big{(}\mathbf{W}^{(r,\ell)}_{m}\cdot
\big{(}\mathbf{h}^{(\ell)}_{v},\mathbf{h}_{in}^{(\ell)},\mathbf{h}_{out}^{(%
\ell)}\big{)}\Big{)}
(r-1)\;\%\;N==0
\ell\neq L
\mathbf{H}^{(\ell,m)}_{in}\rightarrow\mathbf{\tilde{H}}^{(\ell,m)}_{in}
\mathbf{h}^{(\ell)}_{v}\leftarrow\mathbf{h}^{(\ell)}_{v}/\|\mathbf{h}^{(\ell)}%
_{v}\|_{2}
\forall\;v\in\mathcal{V}_{m}
\mathbf{W}^{(r,\ell+1)}_{m}=\mathbf{W}^{(r,\ell)}_{m}-\eta\cdot%
\bigtriangledown\mathbf{W}^{(r,\ell)}_{m}
\mathbf{W}^{(r+1)}\leftarrow
\mathbf{W}^{(r+1)}_{1}...\mathbf{W}^{(r+1)}_{M}
\mathbf{W}^{(R+1)}
N
N
\mathcal{G}_{m}
|\mathbf{\tilde{H}}_{out}^{(\ell,m)}|
t
|\mathbf{\tilde{H}}_{out}^{(\ell,m)}|\times t
v\in\mathcal{V}_{m}
t
\mathbf{\tilde{H}}_{out}^{(\ell,m)}
\ell-1
\mathbf{H}_{in}^{(\ell,m)}
\ell+1
N
L
d
L
m
\mathcal{G}_{m}(\mathcal{V}_{m},\mathcal{E}_{m})
\mathcal{O}\big{(}\left|\bigcup_{v\in\mathcal{V}_{m}}\mathcal{N}(v)\cup\{v\}%
\right|Ld\big{)}
L
\mathcal{O}\big{(}MLd^{2}+\sum\nolimits_{m=1}^{M}\left|\bigcup_{v\in\mathcal{V%
}_{m}}\mathcal{N}(v)\setminus\mathcal{V}_{m}\right|Ld+NLd\big{)}
N
L
L
f_{\mathbf{W}}
r_{1}
\Phi
r_{2}
\Psi
\Delta(\mathcal{G})
\mathcal{G}
\forall\;v\in\mathcal{V}
\forall\;\ell\in\{1,2,\cdots,L-1\}
\|\mathbf{h}_{v}^{(\ell)}-\mathbf{\tilde{h}}_{v}^{(\ell)}\|\leq\epsilon^{(\ell)}
\mathbf{h}_{v}^{(\ell)}
\mathbf{\tilde{h}}_{v}^{(\ell)}
\mathcal{L}_{m}^{\text{Local}}
\tau
\big{\|}\nabla_{\mathbf{W}}\mathcal{L}-\nabla_{\mathbf{W}}\mathcal{L}^{*}\big{%
\|}_{2}\leq\frac{\tau}{M}\sum_{\ell=1}^{L-1}\epsilon^{(\ell)}r_{1}^{L-\ell}r_{%
2}^{L-\ell}\sum_{m=1}^{M}|\Delta(\mathcal{G}_{m})|^{L-\ell},
\nabla_{\mathbf{W}}\mathcal{L}
\nabla_{\mathbf{W}}\mathcal{L}^{*}
\forall\;\epsilon>0
\exists
E>0\;
\eta=\frac{\sqrt{M\epsilon}}{E}
T=(\mathcal{L}(\mathbf{W}^{(1)})-\mathcal{L}(\mathbf{W}^{*}))\frac{E}{\sqrt{M}%
}\epsilon^{-\frac{3}{2}}
s.t.
\frac{1}{T}\sum_{t=1}^{T}\left\|\nabla\mathcal{L}(\mathbf{W}^{(t)})\right\|^{2%
}_{2}\leq\mathcal{O}\left(\frac{1}{T^{\frac{2}{3}}M^{\frac{1}{3}}}\right),
\mathbf{W}^{*}
\mathcal{O}(T^{-2/3}M^{-1/3})
\mathcal{O}(T^{-2/3})
\mathcal{O}(T^{-1/2})
\mathcal{O}(T^{-1})
\mathcal{L}(\mathbf{W})
B
\eta
P(\eta)
T
\mathbf{W}^{*}
\frac{1}{T}\sum_{t=1}^{T}\left\|\nabla\mathcal{L}(\mathbf{W}^{(t)})\right\|^{2%
}_{2}\leq\frac{1}{\eta TB}\Big{(}\mathcal{L}(\mathbf{W}^{(1)})-\mathcal{L}(%
\mathbf{W}^{(*)})\Big{)}+\frac{P(\eta)}{B}.
8
96
384
69.8\pm 0.21
2.35\times
50.73\pm 0.15
0.88\times
62.09\pm 0.41
1.47\times
90.79\pm 0.16
1.396\times
68.84\pm 0.22
1.787\times
43.98\pm 0.32
0.923\times
91.1\pm 0.17
9.956\times
69.9\pm 0.17
1\times
50.9\pm 0.13
1\times
87.02\pm 0.23
1\times
91.01\pm 0.12
1\times
70.34\pm 0.17
1\times
51.50\pm 0.27
1\times
92.58\pm 0.12
1\times
72\pm 0.23
17.41\times
53.78\pm 0.21
11.06\times
95.23\pm 0.43
7.86\times
91.55\pm 0.1
3.096\times
68.35\pm 0.41
11.49\times
52.08\pm 0.21
6.591\times
94.19\pm 0.15
21.817\times
71.9\pm 0.16
53.1\pm 0.32
94.55\pm 0.37
91.54\pm 0.1
69.04\pm 0.13
52.16\pm 0.17
93.95\pm 0.22
10
20
1
8
96
384
\%
\%
\%
58.43\%
L
f_{\mathbf{W}}
r_{1}
\Phi
r_{2}
\Psi
\Delta(\mathcal{G})
\mathcal{G}
\forall\;v\in\mathcal{V}
\forall\;\ell\in\{1,2,\cdots,L-1\}
\|\mathbf{h}_{v}^{(\ell)}-\mathbf{\tilde{h}}_{v}^{(\ell)}\|\leq\epsilon^{(\ell)}
\mathbf{h}_{v}^{(\ell)}
\mathbf{\tilde{h}}_{v}^{(\ell)}
\mathcal{L}_{m}^{\text{Local}}
\tau
\big{\|}\nabla_{\mathbf{W}}\mathcal{L}-\nabla_{\mathbf{W}}\mathcal{L}^{*}\big{%
\|}_{2}\leq\frac{\tau}{M}\sum_{\ell=1}^{L-1}\epsilon^{(\ell)}r_{1}^{L-\ell}r_{%
2}^{L-\ell}\sum_{m=1}^{M}|\Delta(\mathcal{G}_{m})|^{L-\ell},
\nabla_{\mathbf{W}}\mathcal{L}\coloneqq\frac{1}{M}\sum_{m=1}^{M}\frac{1}{|%
\mathcal{V}_{m}|}\sum_{v\in\mathcal{V}_{m}}\nabla_{\mathbf{W}}\mathcal{L}_{m}^%
{\text{Local}}(\mathbf{h}_{v}^{(L)}),
\nabla_{\mathbf{W}}\mathcal{L}^{*}\coloneqq\frac{1}{M}\sum_{m=1}^{M}\frac{1}{|%
\mathcal{V}_{m}|}\sum_{v\in\mathcal{V}_{m}}\nabla_{\mathbf{W}}\mathcal{L}_{m}^%
{\text{Local}}(\mathbf{h^{*}}_{v}^{(L)}),
\mathbf{h^{*}}_{v}^{(\ell)}
\ell
\Phi
\Psi
\left\|\mathbf{h}_{v}^{(L)}-\mathbf{h^{*}}_{v}^{(L)}\right\|_{2}\leq\sum_{\ell%
=1}^{L-1}\epsilon^{(\ell)}r_{1}^{L-\ell}r_{2}^{L-\ell}|\mathcal{N}(v)|^{L-\ell}.
\mathbf{\tilde{h}}_{v}^{(\ell)}
m=1,2,\cdots,M
\begin{split}\left\|\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{%
h}_{v}^{(L)})-\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h^{*}}%
_{v}^{(L)})\right\|_{2}&\leq\tau\left\|\mathbf{h}_{v}^{(L)}-\mathbf{h^{*}}_{v}%
^{(L)}\right\|_{2}\\
&\leq\tau\cdot\sum_{\ell=1}^{L-1}\epsilon^{(\ell)}r_{1}^{L-\ell}r_{2}^{L-\ell}%
|\mathcal{N}(v)|^{L-\ell}.\end{split}
|\mathcal{N}(v)|\leq\Delta(\mathcal{G}_{m})
\forall\;v\in\mathcal{V}_{m}
\Delta(\mathcal{G}_{m})
\mathcal{G}_{m}
v\in\mathcal{V}_{m}
\begin{split}\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in\mathcal{V}_{m}}\left\|%
\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h}_{v}^{(L)})-\nabla%
_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h^{*}}_{v}^{(L)})\right\|_%
{2}\leq\tau\cdot\sum_{\ell=1}^{L-1}\epsilon^{(\ell)}r_{1}^{L-\ell}r_{2}^{L-%
\ell}|\Delta\mathcal{G}_{m}|^{L-\ell}.\end{split}
\begin{split}&\Big{\|}\nabla_{\mathbf{W}}\mathcal{L}-\nabla_{\mathbf{W}}%
\mathcal{L}^{*}\Big{\|}_{2}\\
=&\left\|\frac{1}{M}\sum_{m=1}^{M}\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in%
\mathcal{V}_{m}}\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h}_{%
v}^{(L)})-\frac{1}{M}\sum_{m=1}^{M}\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in%
\mathcal{V}_{m}}\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h^{*%
}}_{v}^{(L)})\right\|_{2}\\
\leq&\frac{1}{M}\sum_{m=1}^{M}\left\|\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in%
\mathcal{V}_{m}}\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h}_{%
v}^{(L)})-\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in\mathcal{V}_{m}}\nabla_{\mathbf%
{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h^{*}}_{v}^{(L)})\right\|_{2}\\
\leq&\frac{1}{M}\sum_{m=1}^{M}\frac{1}{|\mathcal{V}_{m}|}\sum_{v\in\mathcal{V}%
_{m}}\left\|\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h}_{v}^{%
(L)})-\nabla_{\mathbf{W}}\mathcal{L}_{m}^{\text{Local}}(\mathbf{h^{*}}_{v}^{(L%
)})\right\|_{2}\\
\leq&\frac{1}{M}\sum_{m=1}^{M}\tau\cdot\sum_{\ell=1}^{L-1}\epsilon^{(\ell)}r_{%
1}^{L-\ell}r_{2}^{L-\ell}|\Delta\mathcal{G}_{m}|^{L-\ell},\end{split}
\mathcal{G}=(\mathcal{V},\mathcal{E})
L
f
X
W
Z^{(\ell+1)}=PH^{(\ell)}W^{(\ell)},\quad H^{(\ell+1)}=\sigma(Z^{(\ell)}),
\ell
\sigma
P
H^{(0)}=X
(\ell+1)
f^{(\ell+1)}(H^{(\ell)},W^{(\ell)})\coloneqq\sigma(PH^{(\ell)}W^{(\ell)})
G^{(\ell)}_{H}=\nabla_{H}f^{(\ell+1)}(H^{(\ell)},W^{(\ell)},G^{(\ell+1)}_{H})%
\coloneqq P^{\intercal}D^{(\ell+1)}(W^{(\ell+1)})^{\intercal}
G^{(\ell+1)}_{W}=\nabla_{W}f^{(\ell+1)}(H^{(\ell+1)},W^{(\ell)},G^{(\ell+1)}_{%
H})\coloneqq(PH^{(\ell)})^{\mathcal{\intercal}}D^{(\ell+1)}
D^{(\ell+1)}=G^{(\ell)}_{H}\circ\sigma^{\prime}(PH^{(\ell)}W^{(\ell+1)})
\circ
\mathcal{G}_{m}=(\mathcal{V}_{m},\mathcal{E}_{m})
m=1.2,\cdots,M
P=P_{m,in}+P_{m,out}
P_{m,in}
\mathcal{G}_{m}
P_{m,out}
\mathcal{G}_{m}
P_{in}
P_{out}
\begin{split}\tilde{Z}_{m}^{(t,\ell+1)}&=P_{in}\tilde{H}_{m}^{(t,\ell)}\tilde{%
W}_{m}^{(t,\ell)}+P_{out}\tilde{H}_{m}^{(t-1,\ell)}\tilde{W}_{m}^{(t,\ell)}\\
\tilde{H}_{m}^{(t,\ell+1)}&=\sigma(\tilde{Z}_{m}^{(t,\ell)})\end{split}
\tilde{H}
H
t
\tilde{f}_{m}^{(t,\ell+1)}(\tilde{H}_{m}^{(t,\ell)},\tilde{W}_{m}^{(t,\ell)})%
\coloneqq\sigma(P_{in}\tilde{H}_{m}^{(t,\ell)}\tilde{W}_{m}^{(t,\ell)}+P_{out}%
\tilde{H}_{m}^{(t-1,\ell)}\tilde{W}_{m}^{(t,\ell)})
\tilde{H}_{m}^{(t-1,\ell-1)}
\begin{split}\tilde{G}^{(t,\ell)}_{H,m}&=\nabla_{H}\tilde{f}_{m}^{(t,\ell+1)}(%
\tilde{H}_{m}^{(\ell)},\tilde{W}^{(\ell)},\tilde{G}^{(\ell+1)}_{H,m})\\
&\coloneqq P_{in}^{\intercal}\tilde{D}_{m}^{(t,\ell+1)}(\tilde{W}_{m}^{(t,\ell%
+1)})^{\intercal}+P_{out}^{\intercal}\tilde{D}_{m}^{(t-1,\ell+1)}(\tilde{W}_{m%
}^{(t,\ell+1)})^{\intercal}\end{split}
\begin{split}\tilde{G}^{(t,\ell+1)}_{W,m}&=\nabla_{W}\tilde{f}_{m}^{(t,\ell+1)%
}(\tilde{H}_{m}^{(t,\ell+1)},\tilde{W}_{m}^{(t,\ell)},\tilde{G}^{(t,\ell+1)}_{%
H,m})\\
&\coloneqq(P_{in}\tilde{H}_{m}^{(t,\ell)}+P_{out}\tilde{H}_{m}^{(t-1,\ell-1)})%
^{\intercal}\tilde{D}_{m}^{(t,\ell+1)}\end{split}
\tilde{D}_{m}^{(t,\ell+1)}=G^{(\ell)}_{H,m}\circ\sigma^{\prime}(P_{in}\tilde{H%
}_{m}^{(t,\ell)}\tilde{W}_{m}^{(t,\ell)}+P_{out}\tilde{H}_{m}^{(t-1,\ell-1)}%
\tilde{W}_{m}^{(t,\ell)})
\mathcal{L}(W^{(t)})
W
t
\mathcal{\tilde{L}}_{m}(W_{m}^{(t)})
m
W_{m}^{(t)}
t
Loss(\cdot,\cdot)
C_{Loss}
L_{Loss}
|Loss(\mathbf{h}^{(L)}_{v},\mathbf{y}_{v})-Loss(\mathbf{h}^{(L)}_{w},\mathbf{y%
}_{v})|\leq C_{Loss}\|\mathbf{h}^{(L)}_{v}-\mathbf{h}^{(L)}_{w}\|_{2}
\|\nabla Loss(\mathbf{h}^{(L)}_{v},\mathbf{y}_{v})-\nabla Loss(\mathbf{h}^{(L)%
}_{w},\mathbf{y}_{v})\|_{2}\leq L_{Loss}\|\mathbf{h}^{(L)}_{v}-\mathbf{h}^{(L)%
}_{w}\|_{2}
\sigma(\cdot)
C_{\sigma}
L_{\sigma}
\|\sigma(Z^{(\ell)}_{1})-\sigma(Z^{(\ell)}_{2})\|_{2}\leq C_{\sigma}\|(Z^{(%
\ell)}_{1}-Z^{(\ell)}_{2}\|_{2}\quad\text{and}\quad\|\sigma^{\prime}(Z^{(\ell)%
}_{1})-\sigma^{\prime}(Z^{(\ell)}_{2})\|_{2}\leq L_{\sigma}\|(Z^{(\ell)}_{1}-Z%
^{(\ell)}_{2}\|_{2}
\forall\;\ell
\ell=1,2,\cdots,L
\|W^{(\ell)}\|_{F}\leq K_{W},\;\|P^{(\ell)}\|_{P}\leq K_{W},\;\|X^{(\ell)}\|_{%
F}\leq K_{X}.
L
L_{f}
\|\nabla\mathcal{L}(W_{1})-\nabla\mathcal{L}(W_{2})\|_{2}\leq L_{f}\|W_{1}-W_{%
2}\|_{2}
E
\epsilon>0
\eta=\frac{\sqrt{M\epsilon}}{E}
T=(\mathcal{L}({W}^{(1)})-\mathcal{L}({W}^{*}))\frac{E}{\sqrt{M}}\epsilon^{-%
\frac{3}{2}}
\vspace{-2mm}\frac{1}{T}\sum_{t=1}^{T}\|\nabla\mathcal{L}({W}^{(t)})\|^{2}\leq%
\mathcal{O}(\frac{1}{T^{\frac{2}{3}}M^{\frac{1}{3}}})
{W}^{(t)}
{W}^{*}
t
\begin{split}\mathcal{L}(W^{t+1})\leq\mathcal{L}(W^{t})+\left\langle\nabla%
\mathcal{L}(W^{t}),W^{(t+1)}-W^{(t)}\right\rangle+\frac{L_{f}}{2}\|W^{(t+1)}-W%
^{(t)}\|_{2}^{2}\end{split}
W^{(t+1)}=W^{(t)}-\frac{\eta}{M}\sum_{m=1}^{M}\nabla\mathcal{\tilde{L}}_{m}(W_%
{m}^{(t)})
\begin{split}&\mathcal{L}(W^{t})+\left\langle\nabla\mathcal{L}(W^{t}),W^{(t+1)%
}-W^{(t)}\right\rangle+\frac{L_{f}}{2}\|W^{(t+1)}-W^{(t)}\|_{2}^{2}\\
=&\mathcal{L}(W^{t})-\eta\left\langle\nabla\mathcal{L}(W^{t}),\frac{1}{M}\sum_%
{m=1}^{M}\nabla\mathcal{\tilde{L}}_{m}(W_{m}^{(t)})\right\rangle+\frac{\eta^{2%
}L_{f}}{2}\left\|\frac{1}{M}\sum_{m=1}^{M}\nabla\mathcal{\tilde{L}}_{m}(W_{m}^%
{(t)})\right\|_{2}^{2}\end{split}
\delta^{(t)}_{m}=\nabla\mathcal{\tilde{L}}_{m}(W_{m}^{(t)})-\nabla\mathcal{L}_%
{m}(W_{m}^{(t)})
\begin{split}\mathcal{L}(W^{t+1})\leq&\mathcal{L}(W^{t})-\eta\left\langle%
\nabla\mathcal{L}(W^{t}),\frac{1}{M}\sum_{m=1}^{M}\left(\nabla\mathcal{L}_{m}(%
W_{m}^{(t)})+\delta^{(t)}_{m}\right)\right\rangle\\
&+\frac{\eta^{2}L_{f}}{2}\left\|\frac{1}{M}\sum_{m=1}^{M}\left(\nabla\mathcal{%
L}_{m}(W_{m}^{(t)})+\delta^{(t)}_{m}\right)\right\|_{2}^{2}\end{split}
N=|\mathcal{V}|
N=M\cdot S
S
\begin{split}\nabla\mathcal{L}(W^{t})&=\frac{1}{N}\sum_{i=1}^{N}\nabla Loss(f_%
{i}^{(L)},y_{i})=\frac{1}{M}\Big{\{}\sum_{m=1}^{M}\frac{1}{S}\sum_{i=1}^{S}%
\nabla Loss(f_{m,i}^{(L)},y_{m,i})\Big{\}}\end{split}
\nabla\mathcal{L}(W^{t})=\frac{1}{M}\sum_{m=1}^{M}\nabla\mathcal{L}_{m}(W_{m}^%
{(t)})
\mathcal{L}(W^{t+1})\leq\mathcal{L}(W^{t})-\frac{\eta}{2}\|\nabla\mathcal{L}(W%
^{t})\|_{2}^{2}+\frac{\eta^{2}L_{f}}{2}\Big{\|}\frac{1}{M}\sum_{m=1}^{M}\delta%
_{m}^{(t)}\Big{\|}_{2}^{2}
\|\nabla\mathcal{L}(W^{t})\|_{2}^{2}\leq\frac{2}{\eta}(\mathcal{L}(W^{t})-%
\mathcal{L}(W^{t+1}))+\eta L_{f}\Big{\|}\frac{1}{M}\sum_{m=1}^{M}\delta_{m}^{(%
t)}\Big{\|}_{2}^{2}
\eta<1/L_{f}
t=1,2,\cdots,T
\begin{split}\frac{1}{T}\sum_{t=1}^{T}\|\nabla\mathcal{L}({W}^{(t)})\|^{2}&%
\leq\frac{2}{\eta T}\big{(}\mathcal{L}(W^{1})-\mathcal{L}(W^{T+1})\big{)}+%
\frac{\eta^{2}E^{2}}{M}\\
&\leq\frac{2}{\eta T}\big{(}\mathcal{L}(W^{1})-\mathcal{L}(W^{*})\big{)}+\frac%
{\eta^{2}E^{2}}{M}\end{split}
W^{*}
E
E^{\prime}
\eta=\frac{\sqrt{M\epsilon}}{E}
T=(\mathcal{L}({W}^{(1)})-\mathcal{L}({W}^{*}))\frac{E}{\sqrt{M}}\epsilon^{-%
\frac{3}{2}}
\forall\;m\in[M]
\|\nabla\tilde{\mathcal{L}}_{m}({W})\|_{2}\leq V\cdot\|\nabla\mathcal{L}({W})%
\|_{2}
\big{\langle}\nabla\mathcal{L}({W}),\nabla\tilde{\mathcal{L}}_{m}({W})\big{%
\rangle}\geq\beta\cdot\|\nabla\mathcal{L}({W})\|_{2}^{2}
V
\beta
V,\beta\in\mathbb{R}^{+}
L_{f}
\|\nabla\tilde{\mathcal{L}}_{m}(W_{1})-\nabla\tilde{\mathcal{L}}_{m}(W_{2})\|_%
{2}\leq L_{f}\|W_{1}-W_{2}\|_{2}
\forall\;m=1,2,\cdots,M
\mathcal{L}(W)
C_{f}
\tau<K
\beta-\frac{V^{2}}{2}>0
T
W^{*}
\frac{1}{T}\sum_{t=1}^{T}\|\nabla\mathcal{L}(W^{(t)})\|^{2}_{2}\leq\frac{1}{%
\eta TB}\Big{(}\mathcal{L}(W^{(1)})-\mathcal{L}(W^{(*)})\Big{)}+\frac{P(\eta)}%
{B},
B=\beta-\frac{V^{2}}{2}
P(\eta)=\frac{1}{2}\eta^{2}K^{2}C_{f}^{2}L_{f}^{2}+(1+V)\eta KC_{f}^{2}L_{f}
\begin{split}\mathcal{L}(W^{(t+1)})\leq\mathcal{L}(W^{(t)})+\left\langle\nabla%
\mathcal{L}(W^{(t)}),W^{(t+1)}-W^{(t)}\right\rangle+\frac{L_{f}}{2}\|W^{(t+1)}%
-W^{(t)}\|_{2}^{2}.\end{split}
t+1
m
m
M
\mathcal{L}(W^{(t+1)})\leq\mathcal{L}(W^{(t)})-\eta\left\langle\nabla\mathcal{%
L}(W^{(t)}),\nabla\tilde{\mathcal{L}}_{m}({W^{(t-\tau)}})\right\rangle+\frac{%
\eta^{2}L_{f}}{2}\|\nabla\tilde{\mathcal{L}}_{m}({W^{(t-\tau)}})\|_{2}^{2},
\tau
m
r_{m}\coloneqq\nabla\tilde{\mathcal{L}}_{m}({W^{(t-\tau)}})-\nabla\tilde{%
\mathcal{L}}_{m}({W^{(t)}})
\tau\leq K
\tilde{\mathcal{L}}_{m}
\begin{split}\|r_{m}\|_{2}&=\|\nabla\tilde{\mathcal{L}}_{m}({W^{(t-\tau)}})-%
\nabla\tilde{\mathcal{L}}_{m}({W^{(t)}})\|_{2}\\
&\leq L_{f}\cdot\|{W^{(t-\tau)}}-W^{(t)}\|_{2}\\
&=L_{f}\cdot\|\sum_{i=t-\tau}^{t}\eta g_{i}\|_{2}\\
&\leq\eta KL_{f}C_{f},\end{split}
g_{i}
i
\begin{split}&\mathcal{L}(W^{(t+1)})-\mathcal{L}(W^{(t)})\\
\leq&-\eta\left\langle\nabla\mathcal{L}(W^{(t)}),\nabla\tilde{\mathcal{L}}_{m}%
({W^{(t)}})+r_{m}\right\rangle+\frac{\eta^{2}L_{f}}{2}\|\nabla\tilde{\mathcal{%
L}}_{m}({W^{(t)}})+r_{m}\|_{2}^{2}\\
=&\underbrace{-\eta\left\langle\nabla\mathcal{L}(W^{(t)}),\nabla\tilde{%
\mathcal{L}}_{m}({W^{(t)}})\right\rangle}_{\text{{I}}}+\underbrace{\frac{\eta^%
{2}L_{f}}{2}\|\nabla\tilde{\mathcal{L}}_{m}({W^{(t)}})\|_{2}^{2}}_{\text{{II}}%
}+\underbrace{\frac{\eta^{2}L_{f}}{2}\|r_{m}\|_{2}^{2}}_{\text{{III}}}\\
&\underbrace{-\eta\left\langle\nabla\mathcal{L}(W^{(t)}),r_{m}\right\rangle}_{%
\text{{IV}}}+\underbrace{\eta^{2}L_{f}\left\langle\nabla\tilde{\mathcal{L}}_{m%
}({W^{(t)}}),r_{m}\right\rangle}_{\text{{V}}}\end{split}
\text{({I})}\leq-\eta\beta\|\nabla\mathcal{L}(\mathbf{W}^{(t)})\|^{2}_{2},
\text{({II})}\leq\frac{1}{2}\eta^{2}L_{f}V^{2}\|\nabla\mathcal{L}(\mathbf{W}^{%
(t)})\|^{2}_{2}.
\|r_{m}\|_{2}
\text{({III})}\leq\frac{1}{2}\eta^{3}K^{2}L_{f}^{2}C_{f}^{2}
\eta\leq 1/L_{f}
\text{({IV})}+\text{({V})}\leq\eta\left\langle\nabla\tilde{\mathcal{L}}_{m}({W%
^{(t)}})-\nabla\mathcal{L}(W^{(t)}),r_{m}\right\rangle
\begin{split}\text{({IV})}+\text{({V})}&\leq\eta\|\nabla\tilde{\mathcal{L}}_{m%
}({W^{(t)}})-\nabla\mathcal{L}(W^{(t)})\|_{2}\cdot\|r_{m}\|_{2}\\
&\leq\eta^{2}KC_{f}L_{f}\cdot\|\nabla\tilde{\mathcal{L}}_{m}({W^{(t)}})-\nabla%
\mathcal{L}(W^{(t)})\|_{2}\\
&\leq\eta^{2}KC_{f}L_{f}\cdot\left(\|\nabla\tilde{\mathcal{L}}_{m}({W^{(t)}})%
\|_{2}+\|\nabla\mathcal{L}(W^{(t)})\|_{2}\right)\\
&\leq(1+V)\eta^{2}KC_{f}L_{f}\cdot\|\nabla\mathcal{L}(W^{(t)})\|_{2}\\
&\leq(1+V)\eta^{2}KC_{f}^{2}L_{f}\end{split}
\mathcal{L}(W^{(t+1)})-\mathcal{L}(W^{(t)})\leq\left(\frac{1}{2}\eta V^{2}-%
\eta\beta\right)\cdot\|\nabla\mathcal{L}(W^{(t)})\|_{2}^{2}+\frac{1}{2}\eta^{3%
}K^{2}L_{f}^{2}C_{f}^{2}+(1+V)\eta^{2}KC_{f}^{2}L_{f}.
\begin{split}\|\nabla\mathcal{L}(W^{(t)})\|_{2}^{2}&\leq\left(\eta\beta-\frac{%
1}{2}\eta V^{2}\right)^{-1}\cdot\left(\mathcal{L}(W^{(t)})-\mathcal{L}(W^{(t+1%
)})\right)\\
&+\left(\eta\beta-\frac{1}{2}\eta V^{2}\right)^{-1}\cdot\left(\frac{1}{2}\eta^%
{3}K^{2}L_{f}^{2}C_{f}^{2}+(1+V)\eta^{2}KC_{f}^{2}L_{f}\right).\end{split}
t=1
T
\begin{split}\frac{1}{T}\sum_{t=1}^{T}\|\nabla\mathcal{L}(W^{(t)})\|^{2}_{2}&%
\leq\frac{1}{\left(\eta\beta-\frac{1}{2}\eta V^{2}\right)T}\left(\mathcal{L}(W%
^{(1)})-\mathcal{L}(W^{(*)})\right)\\
&+\left(\eta\beta-\frac{1}{2}\eta V^{2}\right)^{-1}\cdot\left(\frac{1}{2}\eta^%
{3}K^{2}L_{f}^{2}C_{f}^{2}+(1+V)\eta^{2}KC_{f}^{2}L_{f}\right)\\
&\leq\frac{1}{\eta TB}\Big{(}\mathcal{L}(W^{(1)})-\mathcal{L}(W^{(*)})\Big{)}+%
\frac{P(\eta)}{B},\end{split}
B=\beta-\frac{V^{2}}{2}
P(\eta)=\frac{1}{2}\eta^{2}K^{2}C_{f}^{2}L_{f}^{2}+(1+V)\eta KC_{f}^{2}L_{f}
