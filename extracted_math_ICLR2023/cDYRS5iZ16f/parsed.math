50\%
\boldsymbol{\Theta}^{(large)}=\boldsymbol{M}\boldsymbol{\Theta}^{(small)}
\boldsymbol{\Theta}^{(small)}
\boldsymbol{\Theta}^{(large)}
\boldsymbol{M}
\boldsymbol{M}=\boldsymbol{L}_{depth}\boldsymbol{R}_{width}
\boldsymbol{M}
\boldsymbol{\Theta}
\boldsymbol{\Theta}^{(new)}
\boldsymbol{M}
\boldsymbol{R}_{width}
\boldsymbol{L}_{depth}
\boldsymbol{M}
\boldsymbol{\Theta}
\boldsymbol{\Theta}^{(new)}
\boldsymbol{M}
\boldsymbol{R}_{width}
\boldsymbol{L}_{depth}
\boldsymbol{M}
44.7\%
22.5\%
55\%
L
D
\boldsymbol{\Theta}_{L,D}=\begin{bmatrix}\boldsymbol{W}_{1}&\cdots&\boldsymbol%
{W}_{L}\end{bmatrix}^{\top}\in{}^{LD\times D}
\boldsymbol{W}_{l}\in{}^{D\times D}
l
D
\boldsymbol{\Theta}_{L,D}
\operatorname{vec}(\boldsymbol{\Theta}_{L,D})^{\top}=\begin{bmatrix}%
\operatorname{vec}(\boldsymbol{W}_{1})^{\top}&\cdots&\operatorname{vec}(%
\boldsymbol{W}_{L})^{\top}\end{bmatrix}
\operatorname{vec}(\boldsymbol{\Theta}_{L,D})^{\top}\in{}^{LD^{2}}
\boldsymbol{\Theta}=\boldsymbol{\Theta}_{L_{1},D_{1}}
\boldsymbol{\Theta}^{(new)}=\boldsymbol{\Theta}_{L_{2},D_{2}}
M:{}^{L_{1}D_{1}\times D_{1}}\rightarrow{}^{L_{2}D_{2}\times D_{2}}
\boldsymbol{\Theta}^{(new)}=M(\boldsymbol{\Theta})
L_{1}<L_{2}
D_{1}<D_{2}
\boldsymbol{\Theta}^{(new)}
L_{1}<L_{2},D_{1}=D_{2}
L_{1}=L_{2},D_{1}<D_{2}
L_{2}=kL_{1}
\displaystyle\text{(StackBERT)}\ \boldsymbol{W}^{(new)}_{l}=\boldsymbol{W}_{l%
\ \mathrm{mod}\ L_{1}},\quad\text{(Interpolation)}\ \boldsymbol{W}^{(new)}_{i}%
=\boldsymbol{W}_{\lfloor l/k\rfloor},\quad\forall l\in[L_{2}].
\displaystyle\text{(StackBERT)}\ \boldsymbol{W}^{(new)}_{l}=\boldsymbol{W}_{l%
\ \mathrm{mod}\ L_{1}},\quad\text{(Interpolation)}\ \boldsymbol{W}^{(new)}_{i}%
=\boldsymbol{W}_{\lfloor l/k\rfloor},\quad\forall l\in[L_{2}].
\boldsymbol{W}_{l}\in{}^{D_{1}\times D_{1}}
f_{l}(\boldsymbol{x})=\boldsymbol{W}_{l}\boldsymbol{x}+\boldsymbol{b}_{l}
\boldsymbol{W}_{l}
\boldsymbol{W}_{l}
\boldsymbol{W}^{(new)}_{l}\in{}^{D_{2}\times D_{2}}
D_{2}>D_{1}
\boldsymbol{W}_{l}
\boldsymbol{W}^{(new)}_{l}
\boldsymbol{S}_{l}
\displaystyle\text{(Net2Net)}\ \boldsymbol{W}^{(new)}_{l}=\begin{bmatrix}%
\boldsymbol{I}\\
\boldsymbol{S}_{l-1}^{\top}\end{bmatrix}\boldsymbol{D}_{l}^{-1}\boldsymbol{W}_%
{l}\begin{bmatrix}\boldsymbol{I}&\boldsymbol{S}_{l}\end{bmatrix},\quad%
\boldsymbol{D}_{l}=\operatorname{diag}(\boldsymbol{S}_{l-1}\boldsymbol{1})+%
\boldsymbol{I},\quad\forall l\in[L_{2}]
\displaystyle\text{(Net2Net)}\ \boldsymbol{W}^{(new)}_{l}=\begin{bmatrix}%
\boldsymbol{I}\\
\boldsymbol{S}_{l-1}^{\top}\end{bmatrix}\boldsymbol{D}_{l}^{-1}\boldsymbol{W}_%
{l}\begin{bmatrix}\boldsymbol{I}&\boldsymbol{S}_{l}\end{bmatrix},\quad%
\boldsymbol{D}_{l}=\operatorname{diag}(\boldsymbol{S}_{l-1}\boldsymbol{1})+%
\boldsymbol{I},\quad\forall l\in[L_{2}]
\boldsymbol{S}_{l}\in\{0,1\}^{D_{1}\times(D_{2}-D_{1})}
\boldsymbol{D}_{l}
D_{1}
i
i
\boldsymbol{W}_{l}
\boldsymbol{\Theta}^{(new)}
\boldsymbol{\Theta}
\displaystyle\operatorname*{arg\,min}_{M}\,\mathbb{E}_{\boldsymbol{x}\sim%
\mathcal{D}}\,\,\mathcal{L}(\boldsymbol{x};\boldsymbol{\Theta}^{(new)}),\quad%
\text{ subject to }\boldsymbol{\Theta}^{(new)}=M(\boldsymbol{\Theta}),
\displaystyle\operatorname*{arg\,min}_{M}\,\mathbb{E}_{\boldsymbol{x}\sim%
\mathcal{D}}\,\,\mathcal{L}(\boldsymbol{x};\boldsymbol{\Theta}^{(new)}),\quad%
\text{ subject to }\boldsymbol{\Theta}^{(new)}=M(\boldsymbol{\Theta}),
\mathcal{D}
\mathcal{L}
M
\displaystyle\operatorname{vec}(\boldsymbol{\Theta}^{(new)})=\operatorname{vec%
}(M(\boldsymbol{\Theta}))=\boldsymbol{M}\operatorname{vec}(\boldsymbol{\Theta}%
),\quad\boldsymbol{M}\in{}^{L_{2}D_{2}^{2}\times L_{1}D_{1}^{2}}.
\displaystyle\operatorname{vec}(\boldsymbol{\Theta}^{(new)})=\operatorname{vec%
}(M(\boldsymbol{\Theta}))=\boldsymbol{M}\operatorname{vec}(\boldsymbol{\Theta}%
),\quad\boldsymbol{M}\in{}^{L_{2}D_{2}^{2}\times L_{1}D_{1}^{2}}.
L_{1}D_{1}
\boldsymbol{M}
\boldsymbol{M}=\boldsymbol{L}_{depth}\boldsymbol{R}_{width}
\boldsymbol{L}_{depth}
\boldsymbol{R}_{width}
\boldsymbol{M}
\displaystyle\boldsymbol{M}=\underbrace{\begin{bmatrix}\operatorname{diag}(%
\boldsymbol{\ell}_{1,1})&\cdots&\operatorname{diag}(\boldsymbol{\ell}_{1,L_{1}%
})\\
\vdots&\ddots&\vdots\\
\operatorname{diag}(\boldsymbol{\ell}_{L_{2},1})&\cdots&\operatorname{diag}(%
\boldsymbol{\ell}_{L_{2},L_{1}})\\
\end{bmatrix}}_{\boldsymbol{L}_{depth}}\underbrace{\begin{bmatrix}\boldsymbol{%
R}_{1}&&\\
&\ddots&\\
&&\boldsymbol{R}_{L_{1}}\\
\end{bmatrix}}_{\boldsymbol{R}_{width}}.
\displaystyle\boldsymbol{M}=\underbrace{\begin{bmatrix}\operatorname{diag}(%
\boldsymbol{\ell}_{1,1})&\cdots&\operatorname{diag}(\boldsymbol{\ell}_{1,L_{1}%
})\\
\vdots&\ddots&\vdots\\
\operatorname{diag}(\boldsymbol{\ell}_{L_{2},1})&\cdots&\operatorname{diag}(%
\boldsymbol{\ell}_{L_{2},L_{1}})\\
\end{bmatrix}}_{\boldsymbol{L}_{depth}}\underbrace{\begin{bmatrix}\boldsymbol{%
R}_{1}&&\\
&\ddots&\\
&&\boldsymbol{R}_{L_{1}}\\
\end{bmatrix}}_{\boldsymbol{R}_{width}}.
\boldsymbol{R}_{l}\in{}^{D_{2}^{2}\times D_{1}^{2}}
\boldsymbol{\ell}_{i,j}\in{}^{D_{2}^{2}}
\boldsymbol{L}_{depth}
\boldsymbol{R}_{width}
\boldsymbol{R}_{width}
\operatorname{vec}(\boldsymbol{\Theta})
\operatorname{vec}(\boldsymbol{W}^{(new)}_{l})=\boldsymbol{R}_{l}\operatorname%
{vec}(\boldsymbol{W}_{l})
l
\boldsymbol{L}_{depth}
l
\operatorname{vec}(\boldsymbol{W}^{(new)}_{l})_{k}=\sum_{l^{\prime}=1}^{L_{1}}%
(\boldsymbol{\ell}_{l,l^{\prime}})_{k}\operatorname{vec}(\boldsymbol{W}_{l})_{k}
\mathcal{O}(D_{1}^{2}L_{1}D_{2}^{2}L_{2})
\mathcal{O}(D_{1}^{2}D_{2}^{2}L_{1})
\mathcal{O}(D_{1}^{2}D_{2}^{2}L_{1})
\boldsymbol{R}_{width}
\mathcal{O}(L_{1}L_{2}D_{2}^{2})
\boldsymbol{L}_{depth}
\boldsymbol{R}_{width}
D_{1}
D_{2}
\boldsymbol{L}_{depth}
\operatorname{diag}(\boldsymbol{\ell}_{i,j})=w_{i,j}\boldsymbol{I}
\boldsymbol{L}_{depth}=\boldsymbol{w}\otimes\boldsymbol{I}
\boldsymbol{w}\in{}^{L_{2}\times L_{1}}
w_{i,j}
j
i
\boldsymbol{L}_{depth}
\mathcal{O}(L_{1}L_{2})
\boldsymbol{R}_{width}
\boldsymbol{R}_{l}=\boldsymbol{A}_{l}\otimes\boldsymbol{B}_{l}
\boldsymbol{A}_{l},\boldsymbol{B}_{l}\in{}^{D_{2}\times D_{1}}
\operatorname{vec}(\boldsymbol{C}\boldsymbol{A}\boldsymbol{B})=(\boldsymbol{B}%
^{\top}\otimes\boldsymbol{C})\operatorname{vec}(\boldsymbol{A})
\displaystyle\boldsymbol{R}_{width}\operatorname{vec}(\boldsymbol{\Theta})=%
\begin{bmatrix}\boldsymbol{A}_{1}\otimes\boldsymbol{B}_{1}&&\\
&\ddots\\
&&\boldsymbol{\boldsymbol{A}}_{L_{1}}\otimes\boldsymbol{B}_{L_{1}}\end{bmatrix%
}\operatorname{vec}(\boldsymbol{\Theta})
\displaystyle\boldsymbol{R}_{width}\operatorname{vec}(\boldsymbol{\Theta})
\displaystyle=\begin{bmatrix}\boldsymbol{A}_{1}\otimes\boldsymbol{B}_{1}&&\\
&\ddots\\
&&\boldsymbol{\boldsymbol{A}}_{L_{1}}\otimes\boldsymbol{B}_{L_{1}}\end{bmatrix%
}\operatorname{vec}(\boldsymbol{\Theta})
\displaystyle=\operatorname{vec}\left(\begin{bmatrix}\boldsymbol{B}_{1}%
\boldsymbol{W}_{1}\boldsymbol{A}_{1}^{\top}&\cdots&\boldsymbol{B}_{L_{1}}%
\boldsymbol{W}_{L_{1}}\boldsymbol{A}_{L_{1}}^{\top}\end{bmatrix}^{\top}\right).
\displaystyle=\operatorname{vec}\left(\begin{bmatrix}\boldsymbol{B}_{1}%
\boldsymbol{W}_{1}\boldsymbol{A}_{1}^{\top}&\cdots&\boldsymbol{B}_{L_{1}}%
\boldsymbol{W}_{L_{1}}\boldsymbol{A}_{L_{1}}^{\top}\end{bmatrix}^{\top}\right).
\boldsymbol{B}_{l}\boldsymbol{W}_{l}\boldsymbol{A}_{l}^{\top}
\boldsymbol{A}_{l}
\boldsymbol{B}_{l}
\mathcal{O}(L_{1}D_{1}D_{2})
\boldsymbol{M}
\displaystyle\boldsymbol{M}=\underbrace{\left(\begin{bmatrix}w_{1,1}&w_{1,2}&%
\cdots&w_{1,L_{1}}\\
\vdots&\vdots&\ddots&\vdots\\
w_{L_{2},1}&w_{L_{2},2}&\cdots&w_{L_{2},L_{1}}\\
\end{bmatrix}\otimes\boldsymbol{I}\right)}_{\text{Depth expansion}}\underbrace%
{\left(\begin{bmatrix}\boldsymbol{A}_{1}\otimes\boldsymbol{B}_{1}&&\\
&\ddots\\
&&\boldsymbol{\boldsymbol{A}}_{L_{1}}\otimes\boldsymbol{B}_{L_{1}}\end{bmatrix%
}\right)}_{\text{Width expansion}}
\displaystyle\boldsymbol{M}=\underbrace{\left(\begin{bmatrix}w_{1,1}&w_{1,2}&%
\cdots&w_{1,L_{1}}\\
\vdots&\vdots&\ddots&\vdots\\
w_{L_{2},1}&w_{L_{2},2}&\cdots&w_{L_{2},L_{1}}\\
\end{bmatrix}\otimes\boldsymbol{I}\right)}_{\text{Depth expansion}}\underbrace%
{\left(\begin{bmatrix}\boldsymbol{A}_{1}\otimes\boldsymbol{B}_{1}&&\\
&\ddots\\
&&\boldsymbol{\boldsymbol{A}}_{L_{1}}\otimes\boldsymbol{B}_{L_{1}}\end{bmatrix%
}\right)}_{\text{Width expansion}}
\boldsymbol{B}_{l}
\boldsymbol{A}_{l}
\boldsymbol{w}
\boldsymbol{M}
\boldsymbol{M}
\boldsymbol{M}\operatorname{vec}(\boldsymbol{\Theta})
\boldsymbol{\Theta}^{(new)}
\boldsymbol{L}_{depth}
\boldsymbol{R}_{width}
\boldsymbol{B}^{(emb)}
\boldsymbol{W}^{Q},\boldsymbol{W}^{K},\boldsymbol{W}^{V}
\boldsymbol{W}^{O}
\boldsymbol{A}^{k}_{l}
\boldsymbol{B}^{k}_{l}
k\in\{Q,K,V,O\}
l
l\in[L_{1}]
\boldsymbol{A}^{k}_{l}=(\boldsymbol{B}^{(emb)})^{\top}
\forall k\in\{Q,K,V\}
\boldsymbol{A}^{O}_{l}=(\boldsymbol{B}_{l}^{V})^{\top}
\boldsymbol{B}^{O}_{l}=\boldsymbol{B}^{(emb)}
\boldsymbol{A}^{(fc1)}_{l}=(\boldsymbol{B}^{(emb)})^{\top}
\boldsymbol{A}^{(fc2)}_{l}=(\boldsymbol{B}^{(fc1)})^{\top}_{l}
\boldsymbol{B}^{(fc2)}_{l}=\boldsymbol{B}^{(emb)}
\boldsymbol{B}^{(emb)}
\boldsymbol{A}_{l}^{k}
\boldsymbol{B}_{l}^{k}
\boldsymbol{M}
\boldsymbol{M}
\mathcal{M}\subseteq{}^{mn_{1}\times mn_{2}}
\boldsymbol{M}\in\mathcal{M}
\boldsymbol{M}=\boldsymbol{P}_{1}\boldsymbol{L}\boldsymbol{P}_{2}^{\top}%
\boldsymbol{R}=\boldsymbol{P}_{1}\operatorname{diag}(\boldsymbol{L}_{1},\cdots%
,\boldsymbol{L}_{n_{1}})\boldsymbol{P}_{2}^{\top}\operatorname{diag}(%
\boldsymbol{R}_{1},\cdots,\boldsymbol{R}_{n_{2}})
\boldsymbol{L}_{i}\in{}^{b_{1}\times b_{2}}
\boldsymbol{R}_{i}\in{}^{b_{3}\times b_{4}}
n_{1}b_{2}=n_{2}b_{3}
\boldsymbol{P}_{1}
\pi(i)=(i-b_{1}\lfloor\frac{i}{b_{1}}\rfloor-1)n_{1}+\lfloor\frac{i}{b_{1}}%
\rfloor+1
\boldsymbol{P}_{2}
\pi(j)=(j-b_{2}\lfloor\frac{j}{b_{2}}\rfloor-1)n_{1}+\lfloor\frac{j}{b_{2}}%
\rfloor+1
\boldsymbol{R}
\boldsymbol{R}_{width}
\boldsymbol{P}_{1}
\boldsymbol{P}_{2}
\boldsymbol{L}
\boldsymbol{L}
\boldsymbol{L}_{depth}
5
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
6
512
400
10
128
256
2e^{-4}
1024
8e^{-4}
384
1024
300
1024
3
1e^{-4}
32
2
5e^{-5}
12
1000
0.01
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
44.7\%
40.7\%
+10.6\%
+7.2\%
30\%
45.2\%
30.3\%
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
47.2\%
22.5\%
47.2\%
22.5\%
22.5\%
\rightarrow
\rightarrow
\rightarrow
\rightarrow
55.4
52
72
81.7\%
15\%
\rightarrow
52.6\%
46.1\%
81.10
99.09
90.76
97.79
92.06
23.8\%
15.1\%
81.21
99.11
90.80
97.56
92.09
36.7\%
28.9\%
81.27
99.07
90.21
97.71
92.11
-11.2\%
-36.8\%
81.01
98.94
90.32
97.81
92.08
40.8\%
37.0\%
81.59
99.14
90.69
97.67
92.15
55.4\%
52.0\%
81.71
99.12
90.74
97.77
92.09
4.7\%
7.4\%
8.2\%
16.7\%
\rightarrow
\rightarrow
\rightarrow
\rightarrow
51.7\%
41.6\%
51.7\%
41.6\%
\boldsymbol{L}_{depth})
6
12
\rightarrow
\boldsymbol{L}_{depth}
10^{15}
10^{15}
\boldsymbol{R}_{width}
512
768
\rightarrow
100
100
500
1000
10000
\rightarrow
1000
1.8
215
10000
214
\boldsymbol{L}_{depth}
\boldsymbol{R}_{width}
\displaystyle\boldsymbol{M}=\underbrace{\begin{bmatrix}\boldsymbol{I}&&\\
&\boldsymbol{I}&\\
&&\ddots\\
\boldsymbol{I}&&\\
&\boldsymbol{I}&\\
&&\ddots\\
\end{bmatrix}}_{\boldsymbol{L}_{depth}}\underbrace{\begin{bmatrix}\boldsymbol{%
I}&&\\
&\ddots&\\
&&\boldsymbol{I}\end{bmatrix}}_{\boldsymbol{R}_{width}}
\displaystyle\boldsymbol{M}=\underbrace{\begin{bmatrix}\boldsymbol{I}&&\\
&\boldsymbol{I}&\\
&&\ddots\\
\boldsymbol{I}&&\\
&\boldsymbol{I}&\\
&&\ddots\\
\end{bmatrix}}_{\boldsymbol{L}_{depth}}\underbrace{\begin{bmatrix}\boldsymbol{%
I}&&\\
&\ddots&\\
&&\boldsymbol{I}\end{bmatrix}}_{\boldsymbol{R}_{width}}
\displaystyle\boldsymbol{M}=\underbrace{\begin{bmatrix}\boldsymbol{I}&&\\
\boldsymbol{I}&&\\
&\boldsymbol{I}&\\
&\boldsymbol{I}&\\
&&\ddots\\
&&\ddots\\
\end{bmatrix}}_{\boldsymbol{L}_{depth}}\underbrace{\begin{bmatrix}\boldsymbol{%
I}&&\\
&\ddots&\\
&&\boldsymbol{I}\end{bmatrix}}_{\boldsymbol{R}_{width}}
\displaystyle\boldsymbol{M}=\underbrace{\begin{bmatrix}\boldsymbol{I}&&\\
\boldsymbol{I}&&\\
&\boldsymbol{I}&\\
&\boldsymbol{I}&\\
&&\ddots\\
&&\ddots\\
\end{bmatrix}}_{\boldsymbol{L}_{depth}}\underbrace{\begin{bmatrix}\boldsymbol{%
I}&&\\
&\ddots&\\
&&\boldsymbol{I}\end{bmatrix}}_{\boldsymbol{R}_{width}}
\boldsymbol{R}_{l}
\displaystyle\boldsymbol{L}_{depth}=\boldsymbol{I}\in{}^{L_{1}D_{2}\times L_{2%
}D_{2}},\quad\boldsymbol{R}_{width}=\begin{bmatrix}\boldsymbol{A}_{1}\otimes%
\boldsymbol{B}_{1}&&\\
&\ddots&\\
&&\boldsymbol{A}_{L_{1}}\otimes\boldsymbol{B}_{L_{1}}\end{bmatrix}
\displaystyle\boldsymbol{L}_{depth}=\boldsymbol{I}\in{}^{L_{1}D_{2}\times L_{2%
}D_{2}},\quad\boldsymbol{R}_{width}=\begin{bmatrix}\boldsymbol{A}_{1}\otimes%
\boldsymbol{B}_{1}&&\\
&\ddots&\\
&&\boldsymbol{A}_{L_{1}}\otimes\boldsymbol{B}_{L_{1}}\end{bmatrix}
\displaystyle\boldsymbol{A}_{l}=\begin{bmatrix}\boldsymbol{I}\\
\widetilde{\boldsymbol{S}}_{l-1}\end{bmatrix},\quad\boldsymbol{B}_{l}=\begin{%
bmatrix}\boldsymbol{I}\\
\boldsymbol{S}_{l},\end{bmatrix}
\displaystyle\boldsymbol{A}_{l}=\begin{bmatrix}\boldsymbol{I}\\
\widetilde{\boldsymbol{S}}_{l-1}\end{bmatrix},\quad\boldsymbol{B}_{l}=\begin{%
bmatrix}\boldsymbol{I}\\
\boldsymbol{S}_{l},\end{bmatrix}
\boldsymbol{S}_{l}\in\{0,1\}^{(D_{2}-D1)\times D_{1}}
\widetilde{\boldsymbol{S}}_{l-1}=\boldsymbol{S}_{l-1}\operatorname{diag}(%
\boldsymbol{1}^{\top}\boldsymbol{S}_{l-1})^{-1}
\boldsymbol{S}_{l-1}
\boldsymbol{B}^{(emb)}
\boldsymbol{W}^{Q},\boldsymbol{W}^{K},\boldsymbol{W}^{V}
\boldsymbol{W}^{O}
\boldsymbol{A}^{k}_{l}
\boldsymbol{B}^{k}_{l}
k\in\{Q,K,V,O\}
l
\boldsymbol{B}^{k}_{l}
\boldsymbol{W}^{k}
k\in{Q,K,V}
\boldsymbol{A}^{k}_{l}=(\boldsymbol{B}^{(emb)})^{\top}
\forall k\in\{Q,K,V\}
\boldsymbol{A}^{O}_{l}=(\boldsymbol{B}^{(V)}_{l})^{\top}
\boldsymbol{B}^{O}_{l}=\boldsymbol{B}^{(emb)}
\forall l\in[L_{1}]
\boldsymbol{w}
\boldsymbol{A}^{k}_{l}
\boldsymbol{B}^{k}_{l}
k\in\{fc1,fc2\}
l
\boldsymbol{A}^{(fc1)}_{l}=\boldsymbol{B}^{(emb)\top}
\boldsymbol{A}^{(fc2)}_{l}=\boldsymbol{B}^{(fc1)\top}_{l}
\boldsymbol{B}^{(fc2)}_{l}=\boldsymbol{B}^{(emb)}
\boldsymbol{A}^{(out)}=\boldsymbol{B}^{(emb)\top}
\boldsymbol{B}^{(emb)}
D_{1}
L_{1}
\boldsymbol{W}^{(emb)}\in{}^{D_{1}\times E}
\boldsymbol{W}^{Q}_{l},\boldsymbol{W}^{K},\boldsymbol{W}^{V}_{l},\boldsymbol{W%
}^{O}_{l}\in{}^{D_{1},\times D_{1}}
\boldsymbol{W}^{(fc1)}_{l}\in{}^{4D_{1}\times D_{1}}
\boldsymbol{W}^{(fc2)}_{l}\in{}^{D_{1}\times 4D_{1}}
\boldsymbol{W}^{(ln1)}_{l}\in{}^{D_{1}\times 4D_{1}}
\boldsymbol{W}^{(ln1)}_{l},\boldsymbol{W}^{(ln2)}_{l}\in{}^{D_{1}}
\forall l\in[L_{1}]
\boldsymbol{W}^{(out)}\in{}^{C\times D_{1}}
D_{2}
L_{2}
\boldsymbol{\Omega}
\boldsymbol{\Omega}^{(emb)}\leftarrow\boldsymbol{B}^{(emb)}\boldsymbol{W}^{(%
emb)}
l=1,\cdots,L_{1}
\boldsymbol{\Omega}^{Q}_{l}\leftarrow\boldsymbol{B}^{(Q)}\boldsymbol{W}^{Q}_{l%
}\boldsymbol{B}^{(emb)\top}
\boldsymbol{\Omega}^{K}_{l}\leftarrow\boldsymbol{B}^{(K)}\boldsymbol{W}^{K}_{l%
}\boldsymbol{B}^{(emb)\top}
\boldsymbol{\Omega}^{V}_{l}\leftarrow\boldsymbol{B}^{(V)}\boldsymbol{W}^{V}_{l%
}\boldsymbol{B}^{(emb)\top}
\boldsymbol{\Omega}^{O}_{l}\leftarrow\boldsymbol{B}^{(emb)}\boldsymbol{W}^{V}_%
{l}\boldsymbol{B}^{(V)\top}
\boldsymbol{\Omega}^{(ln1)}_{l}\leftarrow\boldsymbol{B}^{(emb)}\boldsymbol{W}^%
{(ln1)}_{l}
\boldsymbol{\Omega}^{(fc1)}_{l}\leftarrow\boldsymbol{B}^{(fc1)}\boldsymbol{W}^%
{V}_{l}\boldsymbol{B}^{(emb)\top}
\boldsymbol{\Omega}^{(fc2)}_{l}\leftarrow\boldsymbol{B}^{(emb)}\boldsymbol{W}^%
{V}_{l}\boldsymbol{B}^{(fc1)\top}
\boldsymbol{\Omega}^{(ln2)}_{l}\leftarrow\boldsymbol{B}^{(emb)}\boldsymbol{W}^%
{(ln2)}_{l}
l=1,\cdots,L_{2}
\boldsymbol{\Omega}^{Q}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{Q}\boldsymbol{%
\Omega}^{Q}_{j}
\boldsymbol{\Omega}^{K}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{K}\boldsymbol{%
\Omega}^{K}_{j}
\boldsymbol{\Omega}^{V}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{V}\boldsymbol{%
\Omega}^{V}_{j}
\boldsymbol{\Omega}^{O}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{O}\boldsymbol{%
\Omega}^{O}_{j}
\boldsymbol{\Omega}^{(ln1)}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{(ln1)}%
\boldsymbol{\Omega}^{(ln1)}_{j}
\boldsymbol{\Omega}^{(fc1)}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{(fc1)}%
\boldsymbol{\Omega}^{(fc1)}_{j}
\boldsymbol{\Omega}^{(fc2)}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{(fc2)}%
\boldsymbol{\Omega}^{(fc2)}_{j}
\boldsymbol{\Omega}^{(ln2)}_{l}\leftarrow\sum_{j=1}^{L_{1}}w_{l,j}^{(ln2)}%
\boldsymbol{\Omega}^{(ln2)}_{j}
\boldsymbol{\Omega}^{(out)}\leftarrow\boldsymbol{W}^{(out)}\boldsymbol{B}^{(%
emb)\top}
\boldsymbol{\Omega}
50
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
52.6\%
46.1\%
52.6\%
46.1\%
