f
f
f
f
V^{\pi}
\rho_{0}
\pi
(\mathcal{S},\mathcal{A},\mathcal{T},r,\gamma,\rho_{0})
\mathcal{S}
\mathcal{A}
\mathcal{T}
r
\gamma
\rho_{0}
r:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
\tau
\pi
\max_{\pi}\mathbb{E}_{\tau\sim\pi}\left[\sum_{t=0}^{T}\gamma^{t}r(s_{t},a_{t})\right]
\pi
\max_{\pi}\mathbb{E}_{\begin{subarray}{c}\tau\sim\pi\end{subarray}}\left[\sum_%
{t=0}^{T}\gamma^{t}(r(s_{t},a_{t})+\displaystyle H(\pi(\cdot|s_{t})))\right]
\pi^{*}(a|s)=\frac{1}{Z_{s}}\exp(Q^{*}(s,a))
\pi^{*}
Q^{*}
\pi
d
\displaystyle y(r,s^{\prime},d)=r+\gamma(1-d)(\min_{i=1,2}Q_{\theta_{\text{%
targ},i}}(s^{\prime},\tilde{a}^{\prime})-\alpha\log\pi_{\theta}(\tilde{a}^{%
\prime}|s^{\prime})),\tilde{a}^{\prime}\sim\pi_{\theta}(\cdot|s^{\prime})
\displaystyle y(r,s^{\prime},d)=r+\gamma(1-d)(\min_{i=1,2}Q_{\theta_{\text{%
targ},i}}(s^{\prime},\tilde{a}^{\prime})-\alpha\log\pi_{\theta}(\tilde{a}^{%
\prime}|s^{\prime})),\tilde{a}^{\prime}\sim\pi_{\theta}(\cdot|s^{\prime})
\min_{i=1,2}Q_{\theta_{\text{targ},i}}(s^{\prime},\tilde{a}^{\prime})-\alpha%
\log\pi_{\theta}(\tilde{a}^{\prime}|s^{\prime})
V^{\pi}(s^{\prime})
s^{\prime}
\displaystyle\mathcal{L}(s,a,r,s^{\prime},d)=(Q(s,a)-y(r,s^{\prime},d))^{2}.
\displaystyle\mathcal{L}(s,a,r,s^{\prime},d)
\displaystyle=(Q(s,a)-y(r,s^{\prime},d))^{2}.
\displaystyle\max_{\pi}\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q(s,a)-\alpha\log%
\pi(a|s)\right].
\displaystyle\max_{\pi}\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q(s,a)-\alpha\log%
\pi(a|s)\right].
r
\mathcal{D}
f
D_{E}
N
T
\pi
Q
r
\pi
Q
r
D_{L}
D_{P}
i=0
N
\tau_{L}
D_{L}
B_{E}
D_{E}
B_{L}
D_{L}
\mathbb{E}_{s,a\in B_{E}}\left[\nabla_{\theta_{r}}r(s,a)\right]-\mathbb{E}_{s,%
a\in B_{L}}\left[\nabla_{\theta_{r}}r(s,a)\right]
j=0
T
\pi
D_{P}
B_{P}
D_{P}
B_{E}
D_{E}
B_{P}=B_{E}\cup B_{P}
Q
\pi
\pi
r
\pi
\displaystyle=r+\gamma(1-d){\color{red}V_{\text{EQB}}(s^{\prime},\tilde{a}^{%
\prime},a^{\prime}_{E})},\quad(s^{\prime},a^{\prime}_{E})\in B_{E},\tilde{a}^{%
\prime}\sim\pi_{\theta}(\cdot|s^{\prime})
\displaystyle=r+\gamma(1-d){\color{red}V_{\text{EQB}}(s^{\prime},\tilde{a}^{%
\prime},a^{\prime}_{E})},\quad(s^{\prime},a^{\prime}_{E})\in B_{E},\tilde{a}^{%
\prime}\sim\pi_{\theta}(\cdot|s^{\prime})
\displaystyle Q_{m}(s,a)=\min_{i=1,2}Q_{\theta_{\text{targ},i}}(s,a)
\displaystyle Q_{m}(s,a)
\displaystyle=\min_{i=1,2}Q_{\theta_{\text{targ},i}}(s,a)
\displaystyle{\color{red}V_{\text{EQB}}(s,\tilde{a}^{\prime},a^{\prime}_{E})}=%
\alpha\log({\color{red}e^{\frac{Q_{m}(s,a^{\prime}_{E})}{\alpha}}}+e^{\frac{Q_%
{m}(s,\tilde{a}^{\prime})}{\alpha}}).
\displaystyle{\color{red}V_{\text{EQB}}(s,\tilde{a}^{\prime},a^{\prime}_{E})}
\displaystyle=\alpha\log({\color{red}e^{\frac{Q_{m}(s,a^{\prime}_{E})}{\alpha}%
}}+e^{\frac{Q_{m}(s,\tilde{a}^{\prime})}{\alpha}}).
\displaystyle\mathcal{L_{\text{EQB}}}(s,a,r,s^{\prime},d)=\begin{cases}(Q(s,a)%
-y_{E}(r,s^{\prime},d))^{2}\ \text{if}\ s^{\prime}\in B_{E}\\
(Q(s,a)-y(r,s^{\prime},d))^{2}\ \text{otherwise}\end{cases}.
\displaystyle\mathcal{L_{\text{EQB}}}(s,a,r,s^{\prime},d)
\displaystyle=\begin{cases}(Q(s,a)-y_{E}(r,s^{\prime},d))^{2}\ \text{if}\ s^{%
\prime}\in B_{E}\\
(Q(s,a)-y(r,s^{\prime},d))^{2}\ \text{otherwise}\end{cases}.
B_{E}
V_{\text{EQB}}
\displaystyle\max_{\pi}\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q(s,a)-\alpha\log%
\pi(a|s)\right]
\displaystyle\max_{\pi}\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q(s,a)-\alpha\log%
\pi(a|s)\right]
s^{\prime}
\tilde{a}^{\prime}
a^{\prime}_{E}
\Pi_{M}
w
w
1-w
w
\pi_{M}
\displaystyle V_{\text{EQB}}(s)=\max_{w}\left[w(Q_{m}(s,\tilde{a}^{\prime})-%
\alpha\log w)+(1-w)(Q_{m}(s,a^{\prime}_{E})-\alpha\log(1-w))\right]
\displaystyle V_{\text{EQB}}(s)
\displaystyle=\max_{w}\left[w(Q_{m}(s,\tilde{a}^{\prime})-\alpha\log w)+(1-w)(%
Q_{m}(s,a^{\prime}_{E})-\alpha\log(1-w))\right]
\displaystyle=\alpha\log({\color{red}e^{\frac{Q_{m}(s,a^{\prime}_{E})}{\alpha}%
}}+e^{\frac{Q_{m}(s,\tilde{a}^{\prime})}{\alpha}}).
\displaystyle=\alpha\log({\color{red}e^{\frac{Q_{m}(s,a^{\prime}_{E})}{\alpha}%
}}+e^{\frac{Q_{m}(s,\tilde{a}^{\prime})}{\alpha}}).
\pi
v_{\pi}
n
\displaystyle y=r+\gamma(1-d)(Q(s^{\prime},\tilde{a}^{\prime})-\log(\pi(\tilde%
{a}^{\prime}|s^{\prime}))),\tilde{a}^{\prime}\sim\pi(\cdot|s^{\prime})
\displaystyle y
\displaystyle=r+\gamma(1-d)(Q(s^{\prime},\tilde{a}^{\prime})-\log(\pi(\tilde{a%
}^{\prime}|s^{\prime}))),\tilde{a}^{\prime}\sim\pi(\cdot|s^{\prime})
\displaystyle Q(s,a):=Q(s,a)+\eta_{Q}*(y-Q(s,a)).
\displaystyle Q(s,a)
\displaystyle:=Q(s,a)+\eta_{Q}*(y-Q(s,a)).
\gamma
\alpha
\displaystyle y=r+\gamma(1-d)(\log(e^{Q(s^{\prime},\tilde{a}^{\prime})}+e^{Q(s%
^{\prime},a^{*})})),\tilde{a}^{\prime}\sim\pi(\cdot|s^{\prime}).
\displaystyle y
\displaystyle=r+\gamma(1-d)(\log(e^{Q(s^{\prime},\tilde{a}^{\prime})}+e^{Q(s^{%
\prime},a^{*})})),\tilde{a}^{\prime}\sim\pi(\cdot|s^{\prime}).
\displaystyle\max_{\pi}\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q(s,a)-\log\pi(a|s)%
\right].
\displaystyle\max_{\pi}\mathbb{E}_{a\sim\pi(\cdot|s)}\left[Q(s,a)-\log\pi(a|s)%
\right].
\displaystyle v_{\pi}:=v_{\pi}+\eta_{\pi}*\nabla_{v_{\pi}}\mathbb{E}_{a\sim\pi%
(\cdot|s)}\left[Q(s,a)-\log\pi(a|s)\right].
\displaystyle v_{\pi}:=v_{\pi}+\eta_{\pi}*\nabla_{v_{\pi}}\mathbb{E}_{a\sim\pi%
(\cdot|s)}\left[Q(s,a)-\log\pi(a|s)\right].
\displaystyle r(s,a):=r(s,a)+\eta_{r}*(\mathbbm{1}((s,a)\text{ is expert}))-%
\eta_{r}*(\mathbbm{1}((s,a)\text{ is learner})).
\displaystyle r(s,a):=r(s,a)+\eta_{r}*(\mathbbm{1}((s,a)\text{ is expert}))-%
\eta_{r}*(\mathbbm{1}((s,a)\text{ is learner})).
\eta_{Q}
\eta_{r}
\eta_{\pi}
\left\{0.01,0.001,0.0001\right\}
\eta_{\pi}
b=10
\eta_{\pi}
\eta_{\pi}
V^{\pi}
\pi_{M}
f
f
\alpha
f
f
f
f
f
f
f
f
f
f
\pm
\pm
\pm
\pm
>
>
>
\pi_{M}
\displaystyle V^{\pi_{M}}(s)=V_{\text{EQB}}(s)=\max_{\pi_{M}}\mathbb{E}_{a\sim%
\pi_{M}(\cdot|s)}\left[Q_{m}(s,a)-\alpha\log\pi_{M}(a|s)\right],
\displaystyle V^{\pi_{M}}(s)=V_{\text{EQB}}(s)=\max_{\pi_{M}}\mathbb{E}_{a\sim%
\pi_{M}(\cdot|s)}\left[Q_{m}(s,a)-\alpha\log\pi_{M}(a|s)\right],
\displaystyle\pi_{M}(a|s)=w*\pi(a|s)
\displaystyle\pi_{M}(a|s)
\displaystyle=w*\pi(a|s)
w
\displaystyle V_{\text{EQB}}(s)=\max_{w}[w(Q_{m}(s,\tilde{a}^{\prime})-\alpha%
\log\pi(\tilde{a}^{\prime}|s)-\alpha\log w)+
\displaystyle V_{\text{EQB}}(s)=\max_{w}[w(Q_{m}(s,\tilde{a}^{\prime})-\alpha%
\log\pi(\tilde{a}^{\prime}|s)-\alpha\log w)+
\displaystyle(1-w)(Q_{m}(s,a^{\prime}_{E})-\alpha\log\pi(a^{\prime}_{E}|s)-%
\alpha\log(1-w))].
\displaystyle(1-w)(Q_{m}(s,a^{\prime}_{E})-\alpha\log\pi(a^{\prime}_{E}|s)-%
\alpha\log(1-w))].
\tilde{a}^{\prime}
a^{\prime}_{E}
\tilde{a}^{\prime}
a^{\prime}_{E}
x_{1}
x_{2}
\displaystyle Q_{m}(s,x_{1})-\alpha\log\pi(x_{1}|s)-\alpha(\log w+1)
\displaystyle Q_{m}(s,x_{1})-\alpha\log\pi(x_{1}|s)-\alpha(\log w+1)
\displaystyle-Q_{m}(s,x_{2})+\alpha\log\pi(x_{2}|s)+\alpha(\log(1-w)+1)=0,
\displaystyle-Q_{m}(s,x_{2})+\alpha\log\pi(x_{2}|s)+\alpha(\log(1-w)+1)=0,
\displaystyle w=\frac{1}{1+e^{\frac{(Q_{m}(s,x_{2})-\alpha\log\pi(x_{2}|s))-(Q%
_{m}(s,x_{1})-\alpha\log\pi(x_{1}|s))}{\alpha}}}.
\displaystyle w=\frac{1}{1+e^{\frac{(Q_{m}(s,x_{2})-\alpha\log\pi(x_{2}|s))-(Q%
_{m}(s,x_{1})-\alpha\log\pi(x_{1}|s))}{\alpha}}}.
\displaystyle V_{\text{EQB}}(s)=\alpha\log(e^{\frac{Q_{m}(s,\tilde{a}^{\prime}%
)-\alpha\log\pi(\tilde{a}^{\prime}|s))}{\alpha}}+e^{\frac{Q_{m}(s,a^{\prime}_{%
E})-\alpha\log\pi(a^{\prime}_{E}|s))}{\alpha}}).
\displaystyle V_{\text{EQB}}(s)=\alpha\log(e^{\frac{Q_{m}(s,\tilde{a}^{\prime}%
)-\alpha\log\pi(\tilde{a}^{\prime}|s))}{\alpha}}+e^{\frac{Q_{m}(s,a^{\prime}_{%
E})-\alpha\log\pi(a^{\prime}_{E}|s))}{\alpha}}).
\log 2
V^{\pi}(s^{\prime})
\alpha
\alpha=1
\alpha=0.2
\alpha=1
\alpha=1
\alpha=1
\alpha=1
\alpha=1
\alpha=1
\left\{25,50,75\right\}
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
f
