X
Y
X
Y
(X,Y)
P(Y|X)
X
p_{\theta}(Y|X)
P(Y|X)
{\theta}
p_{\theta}(Y|X)
P(Y|X)
\theta
\sum\log p_{\theta}(Y|X)
X
Y
Z
Y
X
p_{\theta}(Y|X)
p_{\psi}(Y|X,Z)
p(Z|X)
p_{\theta}(Y|X)=\int p_{\psi}(Y|X,Z)p(Z|X)dz
p_{\psi}(Y|X,Z)
Y
X
Z
\psi
p(Z|X)
Z
p(Z|X)
X
p_{\psi}(Y|X,Z)
Z
X
Z
Y
p_{\psi}(Y|X,Z)
Y
p(Z|X)
p_{\psi}(Y|X,Z)
Z
Z
Z
Y
X
P(Z|X,Y)
q_{\phi}(Z|X,Y)
\phi
P(Z|X,Y)
\log p_{\theta}(Y|X)=\overbrace{\underbrace{E_{Z\sim q_{\phi}}[\log p_{\psi}(Y%
|X,Z)]}_{\text{Reconstruction term}}-\underbrace{KL\big{(}q_{\phi}(Z|X,Y)\|p(Z%
|X)\big{)}}_{\text{Regularization term}}}^{\text{Evidence lower bound (ELBO)}}%
+\underbrace{KL\big{(}q_{\phi}(Z|X,Y)\|P(Z|X,Y)\big{)}}_{\text{Residual term}}
E_{Z\sim q_{\phi}}[\cdot]
q_{\phi}(Z|X,Y)
KL(\cdot\|\cdot)
\log p_{\theta}(Y|X)
\log p_{\theta}(Y|X)
\log p_{\theta}(Y|X)
\theta=\{\phi,\psi\}
q_{\phi}(Z|X,Y)
{\mu}_{\text{NN}_{\phi}}(X,Y)
{\Sigma}_{\text{NN}_{\phi}}(X,Y)
\begin{split}KL\big{(}q_{\phi}(Z|X,Y)\|p(Z|X)\big{)}&=KL\Big{(}\mathcal{N}(\mu%
_{\text{NN}_{\phi}},\Sigma_{\text{NN}_{\phi}})\|\mathcal{N}(0,\mathbb{1})\Big{%
)}\\
&=\frac{1}{2}\Big{(}\text{tr}(\Sigma_{\text{NN}_{\phi}})+\mu_{\text{NN}_{\phi}%
}^{T}\mu_{\text{NN}_{\phi}}-k-\ln{|\Sigma_{\text{NN}_{\phi}}|}\Big{)}\end{split}
\mathbb{1}
\text{tr}(\cdot)
|\cdot|
k
Z\sim\mathcal{N}(\mu_{\text{NN}_{\phi}},\Sigma_{\text{NN}_{\phi}})
k
\epsilon\sim\mathcal{N}(0,\mathbb{1})
Z=\mu_{\text{NN}_{\phi}}+\Sigma_{\text{NN}_{\phi}}\epsilon
\begin{split}E_{Z\sim q_{\phi}}[\log p_{\psi}(Y|X,Z)]&=E_{\epsilon\sim\mathcal%
{N}(\boldsymbol{0},\mathbb{1})}[\log p_{\psi}(Y|X,\mu_{\text{NN}_{\phi}}+{%
\Sigma}_{\text{NN}_{\phi}}\epsilon)]\\
&\triangleq\frac{1}{l}\sum_{i=1}^{l}\Big{(}\log p_{\psi}(Y_{i}|X_{i},\mu_{%
\text{NN}_{\phi}}+{\Sigma}_{\text{NN}_{\phi}}\epsilon_{i})\Big{)}\end{split}
\triangleq
l
p_{\psi}(Y|X,Z)=\mathcal{N}{\Big{(}}\mu_{\text{NN}_{\psi}}(X,Z),{\Sigma_{\psi}%
}{\Big{)}}
\mu_{\text{NN}_{\psi}}
X
Z
Y
\Sigma_{\psi}
\underset{\phi,\psi}{\operatorname*{argmax\,}}E_{Z\sim q_{\phi}}[\log p_{\psi}%
(Y|X,Z)]\triangleq\underset{\phi,\psi}{\operatorname*{argmin}}\frac{1}{l}%
\underset{i=1}{\overset{l}{\displaystyle\sum}}\Bigg{(}\Big{(}\mu_{\text{NN}_{%
\psi}}(X_{i},\mu_{\text{NN}_{\phi}}+{\Sigma}_{\text{NN}_{\phi}}\epsilon_{i})-Y%
_{i}\Big{)}^{T}{\Sigma_{\psi}}^{-1}\Big{(}\mu_{\text{NN}_{\psi}}(X_{i},\mu_{%
\text{NN}_{\phi}}+{\Sigma}_{\text{NN}_{\phi}}\epsilon_{i})-Y_{i}\Big{)}\Bigg{)}
\{\phi,\psi\}
\Sigma_{\psi}
\beta
\mathcal{L}
\mathcal{L}=\frac{1}{l}\underset{i=1}{\overset{l}{\displaystyle\sum}}\Bigg{(}%
\Big{(}\mu_{\text{NN}_{\psi}}(X_{i},\mu_{\text{NN}_{\phi}}+{\Sigma}_{\text{NN}%
_{\phi}}\epsilon_{i})-Y_{i}\Big{)}^{T}{\Sigma_{\psi}}^{-1}\Big{(}\mu_{\text{NN%
}_{\psi}}(X_{i},\mu_{\text{NN}_{\phi}}+{\Sigma}_{\text{NN}_{\phi}}\epsilon_{i}%
)-Y_{i}\Big{)}\Bigg{)}+\frac{1}{2}\Big{(}\text{tr}(\Sigma_{\text{NN}_{\phi}})+%
\mu_{\text{NN}_{\phi}}^{T}\mu_{\text{NN}_{\phi}}-k-\ln{|\Sigma_{\text{NN}_{%
\phi}}|}\Big{)}
Y
P(Y|X)
p(Z|X)
p_{\psi}(Y|X,Z)
\mu_{\text{NN}_{\phi}}(X,Y)
\Sigma_{\text{NN}_{\phi}}(X,Y)
\mu_{\text{NN}_{\psi}}(X,Z)
F^{L+1}(x,y)=\sum_{i=1}^{m}\sum_{j=1}^{n}w^{L}_{i,j}F^{L}(x+i,y+j)+b^{L}
F^{L}(x,y)
F^{L+1}(x,y)
L
(L+1)
(x,y)
w^{L}
b^{L}
L
m\times n
X
Y
\mu_{\text{NN}_{\phi}}(X,Y)
\Sigma_{\text{NN}_{\phi}}(X,Y)
X
\mu_{\text{NN}_{\psi}}(X,Z)
X
Z
q_{\phi}(Z|X,Y)
X
Y
Z\sim\mathcal{N}(\mu_{\text{NN}_{\phi}},\Sigma_{\text{NN}_{\phi}})
p_{\psi}(Y|X,Z)
Z
X
Y
L_{X}
L_{Y}
X
Y
L_{X}
q_{\phi}(Z|X,Y)
p_{\psi}(Y|X,Z)
q_{\phi}(Z|X,Y)
k
\mu_{\text{NN}_{\phi}}
\Sigma_{\text{NN}_{\phi}}
q_{\phi}(Z|X,Y)
X
Y
Z\sim\mathcal{N}(\mu_{\text{NN}_{\phi}},\Sigma_{\text{NN}_{\phi}})
p_{\psi}(Y|X,Z)
Z
X
Y
L_{X}
L_{Y}
X
Y
L_{X}
q_{\phi}(Z|X,Y)
p_{\psi}(Y|X,Z)
q_{\phi}(Z|X,Y)
k
\mu_{\text{NN}_{\phi}}
\Sigma_{\text{NN}_{\phi}}
\mu_{\text{NN}_{\phi}}
\Sigma_{\text{NN}_{\phi}}
\mu_{\text{NN}_{\psi}}
\mathcal{L}
X
Z
Y
Z
Y
X
Z=0
\mu_{\text{NN}_{\psi}}
Y
X
X
\mathcal{L}
p(Z|X)
P(Y|X)
p(Z|X)
Y
Y
Z
p(Z|X)
Y
p_{\psi}(Y|X,Z)
2^{\circ}\times 2^{\circ}
60^{\circ}\text{S}-60^{\circ}\text{N}
2^{\circ}\times 2^{\circ}
{L_{X}}^{\dagger\dagger}
m\times n
(3\times 3)
\underline{(4\times 4)}^{\ddagger}
{\underline{16\times 2^{\mathcal{D}_{E}}}}^{\ddagger\ddagger}
L_{Y}^{\dagger\dagger}
m\times n
(3\times 3)
\underline{(4\times 4)}
\underline{16\times 2^{\mathcal{D}_{E}}}
z
z
k
32\times 4\times 12
\underline{64\times 4\times 12}
m\times n
\underline{(4\times 4)}
\underline{128\times 2^{-\mathcal{D}_{D}}}
\beta_{1}=0.9,\beta_{2}=0.999,\epsilon=10^{-5}
10^{-3}
10^{-4}
10^{-5}
\beta^{\mathsection\mathsection}
\underline{5}
\dagger
\dagger
\dagger\dagger
\dagger\dagger
\mathcal{L}_{X}
\mathcal{L}_{Y}
X
Y
\ddagger
\ddagger
\ddagger\ddagger
\ddagger\ddagger
\mathcal{D}_{E}
\mathcal{D}_{D}
\mathsection
\mathsection
\text{ReLU}(x)=max(0,x)
2\times 2
{\mathsection\mathsection}
{\mathsection\mathsection}
\beta
r
r^{\dagger\dagger}=\frac{{}\sum_{i=1}^{n}(y_{\text{simu}}^{i}-\overline{y_{%
\text{simu}}})(y_{\text{obser}}^{i}-\overline{y_{\text{obser}}})}{\sqrt{\sum_{%
i=1}^{n}(y_{\text{simu}}^{i}-\overline{y_{\text{simu}}})^{2}}\sqrt{(y_{\text{%
obser}}^{i}-\overline{y_{\text{obser}}})^{2}}}
r
\text{NRMSE}=1-\frac{\sqrt{\sum_{i=1}^{n}(y_{\text{obser}}^{i}-y_{\text{simu}}%
^{i})^{2}}}{\sqrt{\sum_{i=1}^{n}(y_{\text{obser}}^{i}-\overline{y_{\text{obser%
}}})^{2}}}
\text{CRPSS}^{\ddagger\ddagger}=1-\frac{\sum_{i=1}^{n}\int_{-\infty}^{\infty}[%
P_{\text{simu}}(y_{i})-P_{\text{obser}}(y_{i})]^{2}dy_{i}}{\sum_{i=1}^{n}\int_%
{-\infty}^{\infty}[P_{\text{ref}}(y_{i})-P_{\text{obser}}(y_{i})]^{2}dy_{i}}
\dagger
\dagger
\dagger\dagger
\dagger\dagger
n
y_{\text{simu}}^{i}
y_{\text{obser}}^{i}
i
\ddagger
\ddagger
\ddagger\ddagger
\ddagger\ddagger
P_{\text{simu}}
P_{\text{obser}}
P_{\text{obser}}(y)=\begin{cases}0,&\text{if }y<y^{\text{obser}}\\
1,&\text{otherwise}\end{cases}
P_{\text{ref}}
2^{\circ}\times 2^{\circ}
4\times 10
Z
2^{\circ}\times 2^{\circ}
r
r
r
r
\mu
n
2^{\circ}\times 2^{\circ}
r
r
r
r
\mu
n
r
r
r>0.9
>0.85
\text{CVAE}_{\text{CanESM}}
\text{CVAE}_{\text{CanESM}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}
r
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
r
r
r
r
r
r
r
r
\text{CVAE}_{\text{CanESM}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
r
r
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
r
r
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
r
\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}>\text{CVAE}_{\text{CanESM}}^{%
\text{CanESM}_{\text{his}}}>\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
r
\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}>\text{CVAE}_{\text{%
Ensemble}}^{\text{Obser}}>\text{CVAE}_{\text{CanESM}}^{\text{Obser}}
r
\text{CVAE}_{\text{CanESM}}^{\text{CanESM}_{\text{his}}}>\text{CVAE}_{\text{%
CanESM}}^{\text{Obser}}>\text{CVAE}_{\text{Ensemble}}^{\text{Obser}}
r
r
r
r
{}^{\circ}\times 2^{\circ}
r
r
r
{}^{\circ}\times 2^{\circ}
P(Z|X,Y)
\log p_{\theta}(Y|X)
\log p_{\theta}(Y|X)
KL\big{(}q_{\phi}(Z|X,Y)\|P(Z|X,Y)\big{)}
\begin{split}&\log p_{\theta}(Y|X)=\int\displaylimits_{Z\sim q_{\phi}}\log%
\bigg{(}\overbrace{\frac{p_{\psi}(Y|X,Z)p(Z|X)}{P(Z|X,Y)}}^{\text{Bayes Rule}}%
\cdot\overbrace{\frac{q_{\phi}(Z|X,Y)}{q_{\phi}(Z|X,Y)}}^{\text{Constant 1}}%
\bigg{)}q_{\phi}(Z|X,Y)dZ\\
&=\int\displaylimits_{Z\sim q_{\phi}}\log p_{\psi}(Y|X,Z)q_{\phi}(Z|X,Y)dZ-%
\int\displaylimits_{Z\sim q_{\phi}}\log\frac{q_{\phi}(Z|X,Y)}{p(Z|X)}q_{\phi}(%
Z|X,Y)dZ+\int\displaylimits_{Z\sim q_{\phi}}\log\frac{q_{\phi}(Z|X,Y)}{P(Z|X,Y%
)}q_{\phi}(Z|X,Y)dZ\\
&=\underbrace{\underbrace{E_{Z\sim q_{\phi}}[\log p_{\psi}(Y|X,Z)]}_{\text{%
Reconstruction term}}-\underbrace{KL\big{(}q_{\phi}(Z|X,Y)\|p(Z|X)\big{)}}_{%
\text{Regularization term}}}_{\text{Evidence lower bound}}+\underbrace{KL\big{%
(}q_{\phi}(Z|X,Y)\|P(Z|X,Y)\big{)}}_{\text{Residual term}}\\
\end{split}
\times
\dagger
\dagger
\dagger\dagger
\dagger\dagger
\ddagger
\ddagger
\ddagger\ddagger
\ddagger\ddagger
\mathsection
\mathsection\mathsection
*
**
\mathsection
\mathsection\mathsection
*
**
\times
\dagger
\dagger
\dagger\dagger
\ddagger
\ddagger\ddagger
\mathsection
\mathsection\mathsection
*
**
\dagger\dagger
\ddagger
\ddagger\ddagger
\mathsection
\mathsection\mathsection
*
**
\text{HR}_{20\%}=\frac{n\Big{(}(y_{\text{simu}}>y_{\text{simu}}^{20\%})\land(y%
_{\text{obser}}>y_{\text{obser}}^{20\%})\Big{)}}{n(y_{\text{obser}}>y_{\text{%
obser}}^{20\%})}
\text{FAR}_{20\%}=\frac{n\Big{(}(y_{\text{simu}}>y_{\text{simu}}^{20\%})\land(%
y_{\text{obser}}\leq y_{\text{obser}}^{20\%})\Big{)}}{n(y_{\text{obser}}\leq y%
_{\text{obser}}^{20\%})}
\text{HR}_{20\%}
\text{FAR}_{20\%}
Y
n(\cdot)
y_{\text{simu}}>y_{\text{simu}}^{20\%}
y_{\text{obser}}>y_{\text{obser}}^{20\%}
y_{\text{obser}}\leq y_{\text{obser}}^{20\%}
(\text{HR},\text{FAR})
(\text{HR},\text{FAR})
(\text{HR},\text{FAR})
2^{\circ}\times 2^{\circ}
r
\mu
n
2^{\circ}\times 2^{\circ}
r
\mu
n
