M=\langle\mathcal{S},\mathcal{A},P,R\rangle
\pi_{A}
\pi_{H}
\mathcal{S}
\mathcal{A}
P
R
\pi_{i}
a^{(i)}_{t}\in\mathcal{A}
s_{t}\in\mathcal{S}
t
J(\pi_{A},\pi_{H})=\mathbb{E}_{s_{t},a_{t}^{(i)}}\left[\sum_{t}\gamma^{t}R(s_{%
t},a_{t}^{(A)},a_{t}^{(H)})\right]
J(\pi_{H},\pi_{A})
J(\pi_{A},\pi_{H})
P_{H}:\Pi\rightarrow[0,1]
\pi_{A}
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{H},\pi_{A})]
\hat{P}_{H}
\pi_{A}
\mathbb{E}_{\hat{\pi}_{H}\sim\hat{P}_{H}}[J(\pi_{A},\hat{\pi}_{H})]
J(\pi_{1},\pi_{2})
\pi_{1}
\pi_{2}
\pi_{1}
\pi_{A}
\pi_{i}
K
\{\pi_{i}^{(k)}\}_{k=1}^{K}
K
\{(\pi_{1}^{(k)},\pi_{2}^{(k)})\}_{k=1}^{K}
J(\pi_{1}^{(k)},\pi_{2}^{(k)})
k
(\pi_{1}^{(k)},\pi_{2}^{(k)})
\Pi_{2}=\{\tilde{\pi}_{2}^{(k)},\pi^{(k)}_{2}\}_{k=1}^{K}
\pi^{(k)}_{2}
\tilde{\pi}_{2}^{(k)}
\hat{P}_{H}
\Pi_{2}
\pi_{A}
\mathbb{E}_{\hat{\pi}_{H}\sim\hat{P}_{H}}[J(\pi_{A},\hat{\pi}_{H})]
\pi_{A}
\hat{P}_{H}
\hat{P}_{H}
\pi_{A}
\pi_{A}
\langle\mathcal{S},\mathcal{A},P,R_{w},R_{t}\rangle
\langle\mathcal{S},\mathcal{A},P,R_{t}\rangle
R_{t}
R_{w}
\pi_{a}
R_{t}
\pi_{w}
R_{w}
R_{w}
\pi_{w}
J(\pi_{1},\pi_{2}|R)
R
\pi_{1}
\pi_{2}
\pi_{a}
J(\pi_{a},\pi_{w}|R_{t})
\pi_{w}
J(\pi_{a},\pi_{w}|R_{w})
(\pi_{a}^{*},\pi_{w}^{*})
J(\pi_{a}^{*},\pi_{w}^{*}|R_{w})\geq J(\pi_{a}^{*},\pi_{w}^{\prime}|R_{w}),%
\forall\pi_{w}^{\prime}
J(\pi_{a}^{*},\pi_{w}^{*}|R_{t})\geq J(\pi_{a}^{\prime},\pi_{w}^{*}|R_{t}),%
\forall\pi_{a}^{\prime}
\hfill\square
R_{w}
R_{w}
M=\langle\mathcal{S},\mathcal{A},P,R_{t}\rangle
\pi:\mathcal{S}\times\mathcal{A}\rightarrow[0,1]
R_{w}
M^{\prime}=\langle\mathcal{S},\mathcal{A},P,R_{w},R_{t}\rangle
(\pi_{a}^{*},\pi_{w}^{*})
\pi_{w}^{*}=\pi
\pi_{A}
\mathcal{R}
\epsilon>0
\tilde{\pi}_{w}
\tilde{\pi}_{w}(R_{w})
\pi_{w}^{*}
M_{w}=\langle\mathcal{S},\mathcal{A},P,R_{w},R_{t}\rangle
R_{w}
P_{R}:\mathcal{R}\rightarrow[0,1]
\mathcal{R}
\pi_{A}\in\arg\max_{\pi^{\prime}}\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi^{\prime},%
\tilde{\pi}_{w}(R_{w}))]
\pi_{A}
\epsilon
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]\geq\max_{\pi^{\prime}}%
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi^{\prime},\pi_{H})]-\epsilon
\hat{P}_{R}
\hat{P}_{R}
\displaystyle\pi_{A}=\arg\max_{\pi^{\prime}}\mathbb{E}_{R_{w}\sim\hat{P}_{R}}[%
J(\pi^{\prime},\tilde{\pi}_{w}(R_{w}))]
\displaystyle\pi_{A}=\arg\max_{\pi^{\prime}}\mathbb{E}_{R_{w}\sim\hat{P}_{R}}[%
J(\pi^{\prime},\tilde{\pi}_{w}(R_{w}))]
\{\tilde{\pi}_{w}(R):R\sim\hat{P}_{R}\}
\hat{P}_{R}
\pi_{A}
\mathcal{R}
\mathcal{R}
\mathcal{R}=\{R_{w}:R_{w}(s,a_{1},a_{2})=\phi(s,a_{1},a_{2})^{T}w,||w||_{%
\infty}\leq C_{\max}\}
C_{\max}
w
\phi:\mathcal{S}\times\mathcal{A}\times\mathcal{A}\rightarrow\mathbb{R}^{m}
(a_{1},a_{2})
s
w
N
\{w^{(i)}\}_{i\in[N]}
w
w^{(i)}_{j}
C_{j}
\{R_{w}^{(i)}:R_{w}^{(i)}(s,a_{1},a_{2})=\phi(s,a_{1},a_{2})^{T}w^{(i)}\}_{i%
\in[N]}
R_{w}^{(i)}
\pi_{w}^{(i)},\pi_{a}^{(i)}
R_{w}^{(i)}
\{\pi_{w}^{(i)}\}_{i\in[N]}
S\leftarrow\{i_{0}\}
i_{0}\sim[N]
i=1\rightarrow K-1
k^{\prime}\leftarrow\arg\max_{k^{\prime}\notin S}\text{ED}(S\cup\{k^{\prime}\})
S\leftarrow S\cup\{k^{\prime}\}
\pi_{A}
\pi_{w}^{(i)}
\text{EC}^{(i)}
\mathbb{E}[\sum_{t=1}^{T}\phi(s_{t},a_{t})|\pi_{w}^{(i)},\pi_{a}^{(i)}]
S\subseteq[N]
\text{ED}(S)=\sum_{i,j\in S}\sum_{k}c_{k}\cdot|\text{EC}_{k}^{(i)}-\text{EC}_{%
k}^{(j)}|
c_{k}
S^{*}
K
i=1\rightarrow N
\pi_{w}^{(i)}
\pi_{a}^{(i)}
R_{w}^{(i)}
K
\pi_{A}
\pi_{A}
\pi_{w}^{(i)}
\pi_{A}
\pi_{A}
\pi_{A}
36
10\times
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
r
|r(s,a)|\leq R_{\max},\forall s\in\mathcal{S},a\in\mathcal{A}
M=\langle\mathcal{S},\mathcal{A},P,R_{t}\rangle
\pi_{w}:\mathcal{S}\times\mathcal{A}\rightarrow[0,1]
R_{w}
M^{\prime}=\langle\mathcal{S},\mathcal{A},P,R_{w},R_{t}\rangle
(\pi_{a}^{*},\pi_{w}^{*})
\pi_{w}^{*}=\pi_{w}
R
\pi_{1}
\pi_{2}
\pi_{i}(1\leq i\leq 2)
J_{i}(\pi_{1},\pi_{2}|R)=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R(s_{t},a_{%
t}^{(1)},a_{t}^{(2)})+\alpha\mathcal{H}(\pi_{i}(\cdot|s_{t})))\Big{|}a_{t}^{(i%
)}\sim\pi_{i}(\cdot|s_{t})\right]
\pi_{a}
\pi_{w}
J_{2}(\pi_{w},\pi_{a}|R_{t})\geq J_{2}(\pi_{w},\pi_{a}^{\prime}|R_{t}),\forall%
\pi_{a}^{\prime}
R_{w}
J_{1}(\pi_{w},\pi_{a}|R_{w})\geq J_{1}(\pi_{w}^{\prime},\pi_{a}|R_{w}),\forall%
\pi_{w}^{\prime}
\pi_{a}
\pi_{w}
\pi_{w}
\pi_{a}\in\arg\max_{\pi}J_{2}(\pi_{w},\pi|R_{t})
R_{w}
J_{1}(\pi_{w},\pi_{a}|R_{w})\geq J_{1}(\pi_{w}^{\prime},\pi_{a}|R_{w}),\forall%
\pi_{w}^{\prime}
\pi_{w}
\pi_{a}
\pi_{a}
\pi_{a}
\pi_{w}
M^{\prime}=\langle\mathcal{S},\mathcal{A},P^{\prime},R_{w},\gamma\rangle
\mathcal{S}
\mathcal{A}
P^{\prime}
R_{w}
P^{\prime}
\displaystyle P^{\prime}(s^{\prime}|s,a)=\sum_{\tilde{a}}P(s^{\prime}|s,a,%
\tilde{a})\cdot\pi_{a}(\tilde{a}|s)
\displaystyle P^{\prime}(s^{\prime}|s,a)=\sum_{\tilde{a}}P(s^{\prime}|s,a,%
\tilde{a})\cdot\pi_{a}(\tilde{a}|s)
M^{\prime}
R_{w}
\pi_{w}
\displaystyle\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{w}(s_{t},a%
_{t})+\alpha\mathcal{H}(\pi(s_{t})))\Big{|}a_{t}\sim\pi(s_{t})\right]
\displaystyle\max_{\pi}\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{w}(s_{t},a%
_{t})+\alpha\mathcal{H}(\pi(s_{t})))\Big{|}a_{t}\sim\pi(s_{t})\right]
\displaystyle V(s)=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{w}(s_{t},a_{t}%
)+\alpha\mathcal{H}(\pi_{w}(s_{t})))\Big{|}a_{t}\sim\pi_{w}(s_{t}),s_{0}=s\right]
\displaystyle V(s)
\displaystyle=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}(R_{w}(s_{t},a_{t})+%
\alpha\mathcal{H}(\pi_{w}(s_{t})))\Big{|}a_{t}\sim\pi_{w}(s_{t}),s_{0}=s\right]
\displaystyle=\sum_{a}\pi_{w}(a|s)(R_{w}(s,a)+\gamma\mathbb{E}_{s^{\prime}}[V(%
s^{\prime})|s,a])+\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle=\sum_{a}\pi_{w}(a|s)(R_{w}(s,a)+\gamma\mathbb{E}_{s^{\prime}}[V(%
s^{\prime})|s,a])+\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle Q(s,a)=R_{w}(s,a)+\gamma\cdot\mathbb{E}_{s^{\prime}}[V(s^{\prime%
})|s,a]
\displaystyle Q(s,a)
\displaystyle=R_{w}(s,a)+\gamma\cdot\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s,a]
R_{w}
V(s)
\mathcal{T}^{*}
R_{w}
\displaystyle(\mathcal{T}^{*}V)(s)=\max_{d:\sum_{a}d(a)=1}\alpha\mathcal{H}(d)%
+\sum_{a}d(a)(R_{w}(s,a)+\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s,a])
\displaystyle(\mathcal{T}^{*}V)(s)=\max_{d:\sum_{a}d(a)=1}\alpha\mathcal{H}(d)%
+\sum_{a}d(a)(R_{w}(s,a)+\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s,a])
V(s)
R_{w}
s\in\mathcal{S}
\pi_{w}(\cdot|s)
\displaystyle\max_{d}\;\alpha\mathcal{H}(d)+\sum_{a}d(a)Q(s,a)
\displaystyle\max_{d}
\displaystyle\;\alpha\mathcal{H}(d)+\sum_{a}d(a)Q(s,a)
\displaystyle s.t.\;\;\sum_{a}d(a)=1
\displaystyle s.t.
\displaystyle\;\;\sum_{a}d(a)=1
\displaystyle\pi_{w}(\cdot|s)\propto\exp(Q(s,\cdot)/\alpha),\forall s
\displaystyle\pi_{w}(\cdot|s)\propto\exp(Q(s,\cdot)/\alpha),\forall s
\pi^{*}_{w}(s)=\arg\max_{a}\pi_{w}(a|s),V^{*}(s)=\max_{a}Q(s,a),A(s,a)=Q(s,a)-%
V^{*}(s)
\displaystyle A(s,a)=\alpha(\log\pi_{w}(a|s)-\log\pi_{w}(\pi_{w}^{*}(s)|s))
\displaystyle A(s,a)=\alpha(\log\pi_{w}(a|s)-\log\pi_{w}(\pi_{w}^{*}(s)|s))
V(s)
\displaystyle V(s)=\sum_{a}\pi_{w}(a|s)Q(s,a)+\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle V(s)
\displaystyle=\sum_{a}\pi_{w}(a|s)Q(s,a)+\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle=\sum_{a}\pi_{w}(a|s)(A(s,a)+V^{*}(s))+\alpha\mathcal{H}(\pi_{w}(%
s))
\displaystyle=\sum_{a}\pi_{w}(a|s)(A(s,a)+V^{*}(s))+\alpha\mathcal{H}(\pi_{w}(%
s))
\displaystyle=\sum_{a}\pi_{w}(a|s)A(s,a)+V^{*}(s)+\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle=\sum_{a}\pi_{w}(a|s)A(s,a)+V^{*}(s)+\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle=\sum_{a}\pi_{w}(a|s)A(s,a)+R_{w}(s,\pi_{w}^{*}(s))+\gamma\mathbb%
{E}_{s^{\prime}}[V(s^{\prime})|s^{\prime}\sim P^{\prime}(s,\pi^{*}_{w}(s))]+%
\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle=\sum_{a}\pi_{w}(a|s)A(s,a)+R_{w}(s,\pi_{w}^{*}(s))+\gamma\mathbb%
{E}_{s^{\prime}}[V(s^{\prime})|s^{\prime}\sim P^{\prime}(s,\pi^{*}_{w}(s))]+%
\alpha\mathcal{H}(\pi_{w}(s))
\displaystyle=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}\left(\sum_{a^{\prime}}%
\pi_{w}(a^{\prime}|s)A(s,a^{\prime})+R_{w}(s_{t},a_{t})+\alpha\mathcal{H}(\pi_%
{w}(s_{t}))\right)\Big{|}a_{t}=\pi^{*}_{w}(s_{t})\right]
\displaystyle=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}\left(\sum_{a^{\prime}}%
\pi_{w}(a^{\prime}|s)A(s,a^{\prime})+R_{w}(s_{t},a_{t})+\alpha\mathcal{H}(\pi_%
{w}(s_{t}))\right)\Big{|}a_{t}=\pi^{*}_{w}(s_{t})\right]
b(s)=R_{w}(s,\pi^{*}_{w}(s))
V(s)
\pi_{w}
b
\displaystyle V(s)=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}\left(\sum_{a^{%
\prime}}\pi_{w}(a^{\prime}|s)A(s,a^{\prime})+b(s_{t})+\alpha\mathcal{H}(\pi_{w%
}(s_{t}))\right)\Big{|}a_{t}=\pi^{*}_{w}(s_{t})\right]
\displaystyle V(s)=\mathbb{E}_{\tau}\left[\sum_{t}\gamma^{t}\left(\sum_{a^{%
\prime}}\pi_{w}(a^{\prime}|s)A(s,a^{\prime})+b(s_{t})+\alpha\mathcal{H}(\pi_{w%
}(s_{t}))\right)\Big{|}a_{t}=\pi^{*}_{w}(s_{t})\right]
A(s,a)=\alpha(\log\pi_{w}(a|s)-\log\pi_{w}(\pi_{w}^{*}(s)|s))=Q(s,a)-V^{*}(s)
\displaystyle\alpha(\log\pi_{w}(a|s)-\log\pi_{w}(\pi_{w}^{*}(s)|s))=R_{w}(s,a)%
+\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s^{\prime}\sim P^{\prime}(s,a)]-V%
^{*}(s)
\displaystyle\alpha(\log\pi_{w}(a|s)-\log\pi_{w}(\pi_{w}^{*}(s)|s))
\displaystyle=R_{w}(s,a)+\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s^{\prime%
}\sim P^{\prime}(s,a)]-V^{*}(s)
\displaystyle R_{w}(s,a)=\alpha\log\left(\frac{\pi_{w}(a|s)}{\pi_{w}(\pi_{w}^{%
*}(s)|s)}\right)-\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s^{\prime}\sim P^%
{\prime}(s,a)]+V^{*}(s)
\displaystyle R_{w}(s,a)
\displaystyle=\alpha\log\left(\frac{\pi_{w}(a|s)}{\pi_{w}(\pi_{w}^{*}(s)|s)}%
\right)-\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})|s^{\prime}\sim P^{\prime}(%
s,a)]+V^{*}(s)
\pi_{w}
R_{w}
b:\mathcal{S}^{\prime}\rightarrow\mathbb{R}
A(s,a)
V(s)
V^{*}(s)
R_{w}(s,a)
R_{w}(s,\pi^{*}_{w}(s))=b(s)
b:\mathcal{S}^{\prime}\rightarrow\mathbb{R}
R_{w}
V(s)
\mathcal{T}^{*}
R_{w}
\alpha(\log\pi_{w}(a|s)-\log\pi_{w}(\pi_{w}^{*}(s)|s))=Q(s,a)-V^{*}(s)
\pi_{w}(a|w)\propto\exp(Q(s,a)/\alpha)
\pi_{w}
\displaystyle(\mathcal{T}^{*}V)(s)=\max_{d}\alpha\mathcal{H}(d)+\sum_{a}d(a)(R%
_{w}(s,a)+\gamma\mathbb{E}_{s^{\prime}}[V(s^{\prime})])
\displaystyle(\mathcal{T}^{*}V)(s)
\displaystyle=\max_{d}\alpha\mathcal{H}(d)+\sum_{a}d(a)(R_{w}(s,a)+\gamma%
\mathbb{E}_{s^{\prime}}[V(s^{\prime})])
\displaystyle=\sum_{a}\pi_{w}(a|s)Q(s,a)+\alpha\mathcal{H}(\pi_{w}(s))=V(s).
\displaystyle=\sum_{a}\pi_{w}(a|s)Q(s,a)+\alpha\mathcal{H}(\pi_{w}(s))=V(s).
\epsilon>0
\tilde{\pi}_{w}
\tilde{\pi}_{w}(R_{w})
\pi_{w}^{*}
M_{w}=\langle\mathcal{S},\mathcal{A},P,R_{w},R_{t}\rangle
R_{w}
P_{R}:\mathcal{R}\rightarrow[0,1]
\mathcal{R}
\pi_{A}\in\arg\max_{\pi^{\prime}}\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi^{\prime},%
\tilde{\pi}_{w}(R_{w}))]
\pi_{A}
\epsilon
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]\geq\max_{\pi^{\prime}}%
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi^{\prime},\pi_{H})]-\epsilon
K(K>|\mathcal{A}|)
\Pi
\Pi_{K}=\{\pi:\pi(a|s)=\frac{i}{K}\text{ where }i\in[K],\forall s\in\mathcal{S%
},a\in\mathcal{A}\text{ and }\sum_{a}\pi(a|s)=1,\forall s\in\mathcal{S}\}
\Pi_{K}
|\Pi_{K}|\leq\left(K+1\right)^{|\mathcal{S}|\cdot|\mathcal{A}|}
M=|\Pi_{K}|
\pi_{1},\pi_{2},\cdots,\pi_{M}
\Pi_{K}
\delta=\frac{|\mathcal{A}|}{K}
\Pi_{K}
\hat{\pi}\in\Pi_{K}
\pi\in\Pi
\pi\in\Pi
G(\pi)=\arg\min_{i=1,\dots,M}\sum_{s,a}|\pi(a|s)-\pi_{i}(a|s)|
G
\forall s\in\mathcal{S}
||\pi(\cdot|s)-G(\pi)(\cdot|s)||_{\infty}\leq\frac{|\mathcal{A}|}{K}=\delta
\pi_{1}
\pi_{2}
\pi_{1}
\pi_{2}
G(\pi_{2})
\pi_{2}
G(\pi_{2})
\delta
\displaystyle|J(\pi_{1},\pi_{2})-J(\pi_{1},G(\pi_{2}))|\leq\sum_{t}\gamma^{t}%
\cdot(1-\delta)^{t}\cdot\delta\cdot\frac{2R_{\max}}{1-\gamma}\leq\frac{2\delta
R%
_{\max}}{(1-\gamma)^{2}}
\displaystyle|J(\pi_{1},\pi_{2})-J(\pi_{1},G(\pi_{2}))|\leq\sum_{t}\gamma^{t}%
\cdot(1-\delta)^{t}\cdot\delta\cdot\frac{2R_{\max}}{1-\gamma}\leq\frac{2\delta
R%
_{\max}}{(1-\gamma)^{2}}
P_{H}
\displaystyle\hat{P}_{H}(\pi)=\text{Pr}_{\pi^{\prime}\sim P_{H}}[\pi=G(\pi^{%
\prime})]
\displaystyle\hat{P}_{H}(\pi)=\text{Pr}_{\pi^{\prime}\sim P_{H}}[\pi=G(\pi^{%
\prime})]
P_{H}
\hat{P}_{H}
\pi_{A}
\displaystyle\big{|}\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi_{A},\pi_{H})]-%
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]\big{|}=\big{|}\mathbb{E}_{%
\pi_{H}\sim P_{H}}[J(\pi_{A},G(\pi_{H}))-J(\pi_{A},\pi_{H})]\big{|}
\displaystyle\big{|}\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi_{A},\pi_{H})]-%
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]\big{|}
\displaystyle=\big{|}\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},G(\pi_{H}))-J(%
\pi_{A},\pi_{H})]\big{|}
\displaystyle\leq\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle\leq\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\Pi_{K}
i=1..M
R_{w}^{(i)}
R_{w}^{(i)}\notin\{R_{w}^{(j)}|1\leq j\leq i-1\}
R_{w}^{(i)}
\pi_{i}
R_{w}^{(i)}
b:\mathcal{S}\rightarrow\mathbb{R}
\tilde{\pi}_{w}(R_{w}^{(i)})=\pi_{i},\forall i=1\dots M
P_{R}
P_{R}(R_{w}^{(i)})=\hat{P}_{H}(\pi_{i}),\forall i=1\cdots M
\pi_{A}
\hat{P}_{H}
P_{R}
\displaystyle\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi_{A},\tilde{\pi}_{w}(R_{w}))]=%
\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi_{A},\pi_{H})]
\displaystyle\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi_{A},\tilde{\pi}_{w}(R_{w}))]=%
\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi_{A},\pi_{H})]
\pi_{A}\in\arg\max_{\pi^{\prime}}\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi^{\prime},%
\tilde{\pi}_{w}(R_{w}))]
\pi^{\prime}\in\Pi
\displaystyle\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]\geq\mathbb{E}_%
{\pi_{H}\sim\hat{P}_{H}}[J(\pi_{A},\pi_{H})]-\frac{2\delta R_{\max}}{(1-\gamma%
)^{2}}
\displaystyle\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]
\displaystyle\geq\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi_{A},\pi_{H})]-\frac%
{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle=\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi_{A},\tilde{\pi}_{w}(R_{w}))]-%
\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle=\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi_{A},\tilde{\pi}_{w}(R_{w}))]-%
\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle\geq\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi^{\prime},\tilde{\pi}_{w}(R%
_{w}))]-\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle\geq\mathbb{E}_{R_{w}\sim P_{R}}[J(\pi^{\prime},\tilde{\pi}_{w}(R%
_{w}))]-\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle=\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi^{\prime},\pi_{H})]-%
\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle=\mathbb{E}_{\pi_{H}\sim\hat{P}_{H}}[J(\pi^{\prime},\pi_{H})]-%
\frac{2\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle\geq\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi^{\prime},\pi_{H})]-\frac%
{4\delta R_{\max}}{(1-\gamma)^{2}}
\displaystyle\geq\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi^{\prime},\pi_{H})]-\frac%
{4\delta R_{\max}}{(1-\gamma)^{2}}
K\geq\frac{4|\mathcal{A}|R_{\max}}{\epsilon(1-\gamma)^{2}}
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi_{A},\pi_{H})]\geq\max_{\pi^{\prime}}%
\mathbb{E}_{\pi_{H}\sim P_{H}}[J(\pi^{\prime},\pi_{H})]-\epsilon
3
3
i=1\rightarrow N
\pi_{w}^{(i)}
\pi_{a}^{(i)}
R_{w}^{(i)}
K
\pi_{A}
\pi_{A}
\pi_{w}^{(i)}
\pi_{A}
96
36
36
36
72
15
36
\pi_{a},\pi_{b}
\text{EC}(\pi_{a},\pi_{b})=\mathbb{E}[\sum_{t=1}^{T}\phi(s_{t},a_{t})|\pi_{a},%
\pi_{b}]
\pi_{HSP}
\{\pi_{w}^{(n)}\}_{n\in[N]}
\{\pi_{s}^{(m)}\}_{m\in M}
\Pi=\{\pi_{w}^{(n)}\}_{n\in[N]}\cup\{\pi_{s}^{(m)}\}_{m\in M}
\pi^{\prime}\in\Pi
\Pi
\text{EventDiff}_{\Pi}(\pi^{\prime})=\min_{\pi^{\prime\prime}\in\Pi\backslash%
\{\pi^{\prime}\}}\sum_{k}c_{k}\cdot|\text{EC}_{k}(\pi^{\prime},\pi_{HSP})-%
\text{EC}_{k}(\pi^{\prime\prime},\pi_{HSP})|
c_{k}
\pi^{\prime}
\Pi
\pi_{A}
2
64
12
36
36
18
6
36
\mathcal{R}=\{R_{w}:R_{w}(s,a_{1},a_{2})=\phi(s,a_{1},a_{2})^{T}w,||w||_{%
\infty}\leq C_{\max}\}
\phi:\mathcal{S}\times\mathcal{A}\times\mathcal{A}\rightarrow\mathbb{R}^{m}
(a_{1},a_{2})
s
w_{j}
[-C_{\max},C_{\max}]
w_{j}
C_{j}
C_{j}
C_{j}
C_{j}
S
\text{ED}(S)=\sum_{i,j\in S}\sum_{k}c_{k}\cdot|\text{EC}_{k}^{(i)}-\text{EC}_{%
k}^{(j)}|
\text{EC}_{k}^{i}
k
\pi_{w}^{(i)}
c_{k}
c_{k}
c_{k}=\left(\max_{i\in[N]}\text{EC}_{k}^{(i)}\right)^{-1}
C_{j}
C_{j}
C_{j}
C_{j}
C_{j}
C_{j}
C_{j}
C_{j}
C_{j}
1
0
1
0.5
\times
\times
N
N_{A}
N_{B}
\frac{N_{A}}{N}-\frac{N_{B}}{N}
