{{}^{\dagger}}{{}^{\circ}}
{{}^{\dagger}}{{}^{\circ}}
l
\textbf{[Forward]}\quad z_{l}=W_{l}h_{l-1};\quad\quad h_{l}=f_{l}(z_{l})
\textbf{[Backward]}\quad g_{l}=\text{Diag}(f^{\prime}_{l}(z_{l}))W_{l+1}^{T}g_%
{l+1}
\textbf{[Update]}\quad\frac{\partial C}{\partial W_{l}}=g_{l}h_{l-1}^{T}\,,
C
l
f_{l}
W_{l}
z_{l}
h_{l}
g_{l}=\frac{\partial C}{\partial z_{l}}
h_{l}
g_{l}
\frac{2}{3}
\theta
\text{MSE}[\theta(\textbf{a})]=E||\theta(\textbf{a})-\textbf{a}||^{2}=E||%
\theta(\textbf{a})-E\theta(\textbf{a})||^{2}+||E[\theta(\textbf{a})]-\textbf{a%
}||^{2}\triangleq\operatorname{Var}[\mathrm{\theta}(\textbf{a})]+\operatorname%
{Bias}^{2}[\mathrm{\theta}(\textbf{a})]\,,
E
\theta(\textbf{a})
\theta(\textbf{a})
\operatorname{Bias}[\mathrm{\theta}(\textbf{a})]=0
\operatorname{Bias}[\mathrm{\theta}(\textbf{a})]=0
\operatorname{Var}[\mathrm{\theta}(\textbf{a})]
a
\theta(\textbf{a})
N:M
\textbf{a}\triangleq[a_{1},a_{2}]
\theta\left(\textbf{a}\right)=\begin{cases}{[v_{1},0]}&,\text{w.p. }p\\
{\left[0,v_{2}\right]}&,\text{w.p. }1-p\end{cases}\,.
E[\theta\left(\textbf{a}\right)]=[a_{1},a_{2}]\,.
\mathrm{Var}_{B}\left[\theta(\textbf{{a}})\right]\triangleq\sum_{i}\mathrm{Var%
}\left[\theta_{i}(\textbf{a})\right]=\sum_{i}\left(E\left[\theta_{i}^{2}(%
\textbf{a})\right]-E\left[\theta_{i}(\textbf{{a}})\right]^{2}\right)=v_{1}^{2}%
p-a_{1}^{2}+v_{2}^{2}(1-p)-a_{2}^{2}\,.
v_{1}
\displaystyle\operatorname{Var}_{B}[\theta(\textbf{a})]=v_{1}\cdot a_{1}-a_{1}%
^{2}+\frac{a_{2}^{2}\cdot v_{1}}{v_{1}-a_{1}}-a_{2}^{2}\,.
\displaystyle\operatorname{Var}_{B}[\theta(\textbf{a})]=v_{1}\cdot a_{1}-a_{1}%
^{2}+\frac{a_{2}^{2}\cdot v_{1}}{v_{1}-a_{1}}-a_{2}^{2}\,.
v_{1}
\theta\left(\textbf{a}\right)=\begin{cases}{[\text{sign}(a_{1})\cdot(|a_{1}|+|%
a_{2}|),0]}&,\text{w.p. }\frac{|a_{1}|}{|a_{1}|+|a_{2}|}\\
{\left[0,\text{sign}({\color[rgb]{0,0,0}a_{2}})\cdot(|a_{1}|+|a_{2}|)\right]}&%
,\text{w.p. }\frac{|a_{2}|}{|a_{1}|+|a_{2}|}\end{cases}\,.
v_{1}
2a_{1}a_{2}
\mathrm{MSE}=\text{Bias}^{2}+\text{Var}=0+2a_{1}a_{2}=2a_{1}a_{2}\,.
[v_{1},v_{2}]=[a_{1},a_{2}]
p={|a_{1}|}/{|a_{1}|+|a_{2}|}
p=0.5
[v_{1},v_{2}]=[a_{1},a_{2}]
p=0.5
[v_{1},v_{2}]=[2a_{1},2a_{2}]
[v_{1},v_{2}]=[a_{1},a_{2}]
p={|a_{1}|}/{|a_{1}|+|a_{2}|}
p=0.5
[v_{1},v_{2}]=[a_{1},a_{2}]
p=0.5
[v_{1},v_{2}]=[2a_{1},2a_{2}]
[a_{1},a_{2}]
[0,a_{2}]
a_{1}\leq a_{2}
[a_{1},0]
[a_{1},a_{2}]
[2a_{1},0]
[0,2a_{2}]
[a_{1},a_{2}]
[0,a_{2}]
a_{1}\leq a_{2}
[a_{1},0]
[a_{1},a_{2}]
[2a_{1},0]
[0,2a_{2}]
a\triangleq[a_{1},a_{2},a_{3},a_{4}]
\theta(\textbf{a})
\theta_{i}(\textbf{a})=\frac{a_{i}}{p_{i}}\quad\text{with probability}\,\,p_{i}
E[\theta_{i}(\textbf{a})]=\frac{a_{i}}{p_{i}}\cdot p_{i}+0\cdot(1-p_{i})=a_{i}%
,\hskip 5.0pt\hskip 2.0pt,\forall i\in\{1,2,3,4\}\,.
\displaystyle\operatorname{Var}\left[\theta_{i}(\textbf{a})\right]=E\left[%
\theta_{i}^{2}(\textbf{a})\right]-E\left[\theta_{i}(\textbf{a})\right]^{2}=%
\left(\frac{a_{i}}{p_{i}}\right)^{2}\cdot p_{i}+0^{2}\cdot\left(1-p_{i}\right)%
-a^{2}=\frac{a_{i}^{2}}{p_{i}}-a_{i}^{2}\,.
\displaystyle\operatorname{Var}\left[\theta_{i}(\textbf{a})\right]
\displaystyle=E\left[\theta_{i}^{2}(\textbf{a})\right]-E\left[\theta_{i}(%
\textbf{a})\right]^{2}=\left(\frac{a_{i}}{p_{i}}\right)^{2}\cdot p_{i}+0^{2}%
\cdot\left(1-p_{i}\right)-a^{2}=\frac{a_{i}^{2}}{p_{i}}-a_{i}^{2}\,.
\operatorname{Var}_{B}\left[\theta(\textbf{a})\right]\triangleq\sum_{i}%
\operatorname{Var}\left[\theta_{i}\left(\textbf{a}\right)\right]=\sum_{i}\left%
(\frac{a_{i}^{2}}{p_{i}}-a_{i}^{2}\right)\,.
\sum_{i}p_{i}-2=0\hskip 10.0pt;\hskip 10.0ptp_{i}-1\leq 0\,\,\,,\forall i\in\{%
1,2,3,4\}\,.
p_{i}
L=\sum_{j}\left(\frac{a_{j}^{2}}{p_{j}}-a_{j}^{2}\right)+\sum_{j}\lambda_{j}(p%
_{j}-1)+\mu\sum_{j}(p_{j}-2)\,.
p_{i}
\frac{\partial L}{\partial p_{i}}=-\frac{a_{i}^{2}}{p_{i}^{2}}+\lambda_{i}+\mu%
=0\,\,\,,\forall i\in\{1,2,3,4\}\,,
i
\lambda_{i}
\lambda_{i}=0
p_{i}=a_{i}{}/\sqrt{\mu}
(\sum_{i}p_{i}=2)
p_{i}=\frac{2a_{i}}{\sum_{j}a_{j}}\,\,\,,\forall i\in\{1,2,3,4\}\,.
\lambda_{i}>0
i
p_{i}=1
\sum_{j}p_{j}=2
\sum_{k\neq i}p_{k}=1
p_{k}
k\neq i
[0,1]
p_{k}\leq 1
\lambda_{k}=0
k\neq i
\frac{\partial L}{\partial p_{k}}=-\frac{a_{k}^{2}}{p_{k}^{2}}+\mu=0%
\Rightarrow p_{k}=\frac{a_{k}}{\sqrt{\mu}}\quad,\,\forall k\neq i
\sum_{k\neq i}p_{k}=1
\exists i:p_{i}=1\quad\mathrm{and}\quad p_{k}=\frac{a_{k}}{\sum_{k\neq i}a_{i}%
}\quad,\,\forall k\neq i\quad
a=[a_{1},a_{2},a_{3},a_{4}]
\theta_{2:4}(\textbf{a})
[a_{1},a_{2}]
[a_{3},a_{4}]
\theta_{1:2}([a_{1},a_{2}])
\theta_{1:2}([a_{3},a_{4}])
\operatorname{Var}[\theta_{2:4}(\textbf{a})]\leq\operatorname{Var}[\theta_{1:2%
}([a_{1},a_{2}])]+\operatorname{Var}[\theta_{1:2}([a_{3},a_{4}])]
[a_{1},a_{2},a_{3},1]
0\leq a_{1},a_{2},a_{3}\leq 1
a_{4}{\color[rgb]{0,0,0}\gg}\max(a_{1},a_{2},a_{3})
[a_{1},a_{2},a_{3},1]
0\leq a_{1},a_{2},a_{3}\leq 1
a_{4}{\color[rgb]{0,0,0}\gg}\max(a_{1},a_{2},a_{3})
a_{i}
i
p_{i}=\frac{a_{i}}{a_{1}+a_{2}+a_{3}+a_{4}}\,.
p_{j}=\frac{{a}_{j}}{{a_{1}}+{a_{2}}+{a_{3}}+a_{4}-a_{i}}\,.
p_{i}=\frac{|a_{i}|}{\sum_{j}|a_{j}|}+\sum_{k\neq i}\frac{|a_{k}|}{\sum_{j}|a_%
{j}|}\frac{|a_{i}|}{\sum_{j\neq k}|a_{j}|}
\frac{\mathrm{Var}(\theta^{\mathrm{approx}}_{2:4})}{\mathrm{Var}(\theta^{%
\mathrm{opt}}_{2:4})}\,,
[a_{1},a_{2},a_{3},a_{4}]
a_{1}\leq a_{2}\leq a_{3}\leq a_{4}
a_{4}=1
a_{1},a_{2},a_{3}
a_{4}\gg\max(a_{1},a_{2},a_{3})
\sim 70\%
N
N
G
W
W^{T}
G
W
W^{T}
b_{W}
b_{H}
M_{b_{W}}
M_{b_{H}}
\binom{4}{2}=6
\begin{split}\mathbb{E}[\mathrm{\#MACs(b_{H},b_{W})}]&=\mathbb{E}\left[\mathbb%
{E}[\mathrm{\#MACs(b_{H},b_{W})}|\mathrm{M_{b_{H}}}]\right]=\frac{1}{6}\cdot 0%
+\frac{1}{6}\cdot 2+\frac{4}{6}\cdot 1=1\vspace{-.4cm}\end{split}
N/2
a\triangleq[a_{1},a_{2}]
\theta\left(\textbf{a}\right)=\begin{cases}{[v_{1},0]}&,\text{w.p. }p\\
{\left[0,v_{2}\right]}&,\text{w.p. }1-p\end{cases}
E[\theta\left(\textbf{a}\right)]=[a_{1},a_{2}]
E[\theta\left(\textbf{a}\right)]=p\cdot[v_{1},0]+(1-p)\cdot[0,v_{2}]=[a_{1},a_%
{2}]
\begin{array}[]{lll}p\cdot v_{1}=a_{1}&\Rightarrow&p=\frac{a_{1}}{v_{1}}\\
(1-p)\cdot v_{2}=a_{2}&\Rightarrow&v_{2}=\frac{a_{2}}{1-\frac{a_{1}}{v_{1}}}%
\end{array}
\theta\left(\textbf{a}\right)=[\theta_{1},\theta_{2}]
\displaystyle\operatorname{Var}[\theta_{1}]=E\left[\theta_{1}^{2}\right]-E^{2}%
(\theta_{1})=v_{1}^{2}\cdot p-a_{1}^{2}
\displaystyle\operatorname{Var}[\theta_{1}]=E\left[\theta_{1}^{2}\right]-E^{2}%
(\theta_{1})=v_{1}^{2}\cdot p-a_{1}^{2}
\displaystyle\operatorname{Var}[\theta_{2}]=E\left[\theta_{2}^{2}\right]-E^{2}%
[\theta_{2}]=v_{2}^{2}\cdot(1-p)-a_{2}^{2}
\displaystyle\operatorname{Var}[\theta_{2}]=E\left[\theta_{2}^{2}\right]-E^{2}%
[\theta_{2}]=v_{2}^{2}\cdot(1-p)-a_{2}^{2}
\mathrm{Var}_{B}\left[\theta\right]=\mathrm{Var}[\theta_{1}]+\mathrm{Var}[%
\theta_{2}]=v_{1}^{2}p-a_{1}^{2}+v_{2}^{2}-v_{2}^{2}p-a_{2}^{2}
v_{1}
\displaystyle\operatorname{Var}_{B}[\theta]=v_{1}^{2}\cdot\frac{a_{1}}{v_{1}}-%
a_{1}^{2}+\frac{a_{2}^{2}}{\left(1-\frac{a_{1}}{v_{1}}\right)^{2}}\cdot\left(1%
-\frac{a_{1}}{v_{1}}\right)-a_{2}^{2}
\displaystyle\operatorname{Var}_{B}[\theta]
\displaystyle=v_{1}^{2}\cdot\frac{a_{1}}{v_{1}}-a_{1}^{2}+\frac{a_{2}^{2}}{%
\left(1-\frac{a_{1}}{v_{1}}\right)^{2}}\cdot\left(1-\frac{a_{1}}{v_{1}}\right)%
-a_{2}^{2}
\displaystyle=v_{1}\cdot a_{1}-a_{1}^{2}+\frac{a_{2}^{2}}{1-\frac{a_{1}}{v_{1}%
}}-a_{2}^{2}
\displaystyle=v_{1}\cdot a_{1}-a_{1}^{2}+\frac{a_{2}^{2}}{1-\frac{a_{1}}{v_{1}%
}}-a_{2}^{2}
\displaystyle=v_{1}\cdot a_{1}-a_{1}^{2}+\frac{a_{2}^{2}\cdot v_{1}}{v_{1}-a_{%
1}}-a_{2}^{2}
\displaystyle=v_{1}\cdot a_{1}-a_{1}^{2}+\frac{a_{2}^{2}\cdot v_{1}}{v_{1}-a_{%
1}}-a_{2}^{2}
v_{1}
\frac{\partial\mathrm{Var}_{B}[\theta]}{\partial v_{1}}=\frac{a_{2}^{2}}{v_{1}%
-a_{1}}-\frac{a_{2}^{2}v_{1}}{\left(v_{1}-a_{1}\right)^{2}}+a_{1}=0
v_{1}
\displaystyle v_{1}=a_{1}+a_{2}
\displaystyle v_{1}=a_{1}+a_{2}
\displaystyle v_{1}=a_{1}-a_{2}
\displaystyle v_{1}=a_{1}-a_{2}
\theta\left(\textbf{a}\right)=\begin{cases}{[\text{sign}(a_{1})\cdot(|a_{1}|+|%
a_{2}|),0]}&,\text{w.p. }\frac{|a_{1}|}{|a_{1}|+|a_{2}|}\\
{\left[0,\text{sign}(a_{2})\cdot(|a_{1}|+|a_{2}|)\right]}&,\text{w.p. }\frac{|%
a_{2}|}{|a_{1}|+|a_{2}|}\end{cases}
v_{q}=a_{1}+a_{2}
2a_{1}a_{2}
MSE=\text{Bias}^{2}+\text{Var}=0+2a_{1}a_{2}=2a_{1}a_{2}
[a_{1},a_{2},a_{3},a_{4}]
a_{4}>a_{3}>a_{2}>a_{1}
a_{i},a_{j}
p_{i,j}
a_{4}\leq 2a_{1}+a_{3}
\displaystyle p_{12}=0
\displaystyle p_{12}
\displaystyle=0
\displaystyle p_{13}=\frac{2a_{1}+a_{3}-a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{13}
\displaystyle=\frac{2a_{1}+a_{3}-a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{14}=\frac{2a_{1}-a_{3}+a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{14}
\displaystyle=\frac{2a_{1}-a_{3}+a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{23}=\frac{2a_{2}+a_{3}-a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{23}
\displaystyle=\frac{2a_{2}+a_{3}-a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{24}=\frac{2a_{2}-a_{3}+a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{24}
\displaystyle=\frac{2a_{2}-a_{3}+a_{4}}{2(a_{1}+a_{2}+a_{3}+a_{4})}
\displaystyle p_{34}=\frac{-a_{1}-a_{2}+a_{3}+a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{34}
\displaystyle=\frac{-a_{1}-a_{2}+a_{3}+a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
p_{1}
p_{2}
\frac{p_{1}}{p_{2}}=\frac{p_{12}+p_{13}+p_{14}}{p_{12}+p_{23}+p_{24}}=\frac{a_%
{1}}{a_{2}}
2a_{1}+a_{3}\leq a_{4}\leq a_{1}+a_{2}+a_{3}
\displaystyle p_{12}=0
\displaystyle p_{12}
\displaystyle=0
\displaystyle p_{13}=0
\displaystyle p_{13}
\displaystyle=0
\displaystyle p_{14}=\frac{2a_{1}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{14}
\displaystyle=\frac{2a_{1}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{23}=\frac{a_{1}+a_{2}+a_{3}-a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{23}
\displaystyle=\frac{a_{1}+a_{2}+a_{3}-a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{24}=\frac{-a_{1}+a_{2}-a_{3}+a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{24}
\displaystyle=\frac{-a_{1}+a_{2}-a_{3}+a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{34}=\frac{-a_{1}-a_{2}+a_{3}+a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
\displaystyle p_{34}
\displaystyle=\frac{-a_{1}-a_{2}+a_{3}+a_{4}}{a_{1}+a_{2}+a_{3}+a_{4}}
a_{4}\geq a_{1}+a_{2}+a_{3}
a_{4}
a_{i}
\left\{a_{1},a_{2},a_{3}\right\}
\tilde{p}_{i}=\frac{a_{i}}{a_{1}+a_{2}+a_{3}}
\operatorname{Var}[\theta_{2:4}(\textbf{a})]
p_{i}=\frac{a_{i}}{a_{1}+a_{2}+a_{3}+a_{4}}
i
\displaystyle\operatorname{Var}\left[\theta(\textbf{a})\right]=\frac{a_{1}}{2}%
\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{1}^{2}+\frac{a_{2}}{2}\left(a_{1}+a_{2%
}+a_{3}+a_{4}\right)-a_{2}^{2}
\displaystyle\operatorname{Var}\left[\theta(\textbf{a})\right]
\displaystyle=\frac{a_{1}}{2}\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{1}^{2}+%
\frac{a_{2}}{2}\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{2}^{2}
\displaystyle+\frac{a_{3}}{2}\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{3}^{2}+%
\frac{a_{4}}{2}\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{4}^{2}
\displaystyle+\frac{a_{3}}{2}\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{3}^{2}+%
\frac{a_{4}}{2}\left(a_{1}+a_{2}+a_{3}+a_{4}\right)-a_{4}^{2}
\displaystyle=a_{1}\cdot a_{2}+a_{1}\cdot a_{3}+a_{1}\cdot a_{4}+a_{2}\cdot a_%
{3}+a_{2}\cdot a_{4}+a_{3}\cdot a_{4}
\displaystyle=a_{1}\cdot a_{2}+a_{1}\cdot a_{3}+a_{1}\cdot a_{4}+a_{2}\cdot a_%
{3}+a_{2}\cdot a_{4}+a_{3}\cdot a_{4}
\displaystyle-\frac{a_{1}^{2}}{2}-\frac{a_{2}^{2}}{2}-\frac{a_{3}^{2}}{2}-%
\frac{a_{4}^{2}}{2}
\displaystyle-\frac{a_{1}^{2}}{2}-\frac{a_{2}^{2}}{2}-\frac{a_{3}^{2}}{2}-%
\frac{a_{4}^{2}}{2}
2a_{1}a_{2}+2a_{3}a_{4}
D
D
\displaystyle D=a_{1}a_{2}+a_{1}a_{3}+a_{1}a_{4}+a_{2}a_{3}+a_{2}a_{4}+a_{3}a_%
{4}
\displaystyle D=a_{1}a_{2}+a_{1}a_{3}+a_{1}a_{4}+a_{2}a_{3}+a_{2}a_{4}+a_{3}a_%
{4}
\displaystyle-\frac{a_{1}^{2}}{2}-\frac{a_{2}^{2}}{2}-\frac{a_{3}^{2}}{2}-%
\frac{a_{4}^{2}}{2}-(2a_{1}a_{2}+2a_{3}a_{4})
\displaystyle-\frac{a_{1}^{2}}{2}-\frac{a_{2}^{2}}{2}-\frac{a_{3}^{2}}{2}-%
\frac{a_{4}^{2}}{2}-(2a_{1}a_{2}+2a_{3}a_{4})
\displaystyle=\underbrace{\left(-\frac{a_{1}^{2}}{2}+a_{1}a_{4}-\frac{a_{4}^{2%
}}{2}\right)}_{-0.5\left(a_{1}-a_{4}\right)^{2}}+\underbrace{\left(-\frac{a_{2%
}^{2}}{2}+a_{2}a_{3}-\frac{a_{3}^{2}}{2}\right)}_{-0.5\left(a_{2}-a_{3}\right)%
^{2}}+
\displaystyle=
\displaystyle\underbrace{\left(-\frac{a_{1}^{2}}{2}+a_{1}a_{4}-\frac{a_{4}^{2}%
}{2}\right)}_{-0.5\left(a_{1}-a_{4}\right)^{2}}+\underbrace{\left(-\frac{a_{2}%
^{2}}{2}+a_{2}a_{3}-\frac{a_{3}^{2}}{2}\right)}_{-0.5\left(a_{2}-a_{3}\right)^%
{2}}+
\displaystyle+\underbrace{a_{4}a_{2}+a_{1}a_{3}-a_{1}a_{2}-a_{3}a_{4}}_{-\left%
(a_{1}-a_{4}\right)\cdot\left(a_{2}-a_{3}\right)}
\displaystyle+\underbrace{a_{4}a_{2}+a_{1}a_{3}-a_{1}a_{2}-a_{3}a_{4}}_{-\left%
(a_{1}-a_{4}\right)\cdot\left(a_{2}-a_{3}\right)}
A\triangleq(a_{1}-a_{4})
B\triangleq(a_{2}-a_{3})
D=-\frac{A^{2}}{2}-A\cdot B-\frac{B^{2}}{2}=-\frac{1}{2}(A+B)^{2}<0
\frac{1}{10}
N/2
p_{i}
p_{i}
a\triangleq[a_{1},a_{2}]
a_{1}
p_{1}
a_{2}
1-p_{1}
\varepsilon\sim U[0,1]
\varepsilon<p_{1}
a_{1}
a_{2}
\varepsilon
\varepsilon
10^{3}
10^{4}
10^{5}
10^{6}
10^{7}
10^{8}
M=4
M=2
M=4
M=2
1\hskip 3.0pt\textrm{div}=4\hskip 3.0pt\textrm{mul}=16\hskip 3.0pt\textrm{add/%
subtract/compare}
~{}50.75\hskip 3.0pt\textrm{mul}
M=4
12.5\hskip 3.0pt\textrm{mul}
M=2
h\in R^{B\times C_{I}}
g\in R^{B\times C_{O}}
B
C_{I},C_{O}
\Delta\in R^{C_{I}\times C_{O}}
C_{I}BC_{o}/2
50.75BC_{o}/4
M=4
C_{I}>26
M=4
C_{I}>7
M>2
A\in R^{B\times C_{I}\times H\times W}
G\in R^{B\times C_{O}\times H\times W}
H,W
\Delta=R^{C_{I}\times C_{O}\times k\times k}
k^{2}C_{I}BHWC_{o}/2
50.75HWBC_{o}/4
M=4
C_{I}>26/k^{2}
M=4
C_{I}>7/k^{2}
M>2
k=3
C_{I}\geq 3
M=4
C_{I}
M=2
X\in\mathbb{R}^{K\times M},R\in\mathbb{R}^{K\times M},M
out\leftarrow abs(out)
s\leftarrow sum(outs,dim=1)
M=4
2
v\leftarrow outs/s
M=4
2
vv\leftarrow v/(1-v)
M=4
M=2
q\leftarrow sum(vv,dim=1)
M=4
M=2
p\leftarrow v\cdot(1+q-vv)
M=4
M=2
indices\leftarrow topk(outs/rdn,K=M)
M=4
M=2
scale\leftarrow 1/p
M=4
2
M=4
M=8
h\in R^{B\times C_{I}}
W\in R^{C_{I}\times C_{O}}
BC_{I}C_{O}/2
1.25BC_{I}/4
M=4
M=4
C_{O}>1
M=8
C_{O}>3
h\in R^{B\times C_{I}\times H\times W}
C_{I}\times C_{O}\times k\times k
BC_{I}C_{O}HWk^{2}/2
1.25BC_{I}HW/4
M=4
M=4
C_{O}>1
M=8
C_{O}>3/k^{2}
l_{1}
