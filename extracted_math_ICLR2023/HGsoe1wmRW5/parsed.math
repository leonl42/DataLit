\mathbf{x}_{1},\cdots,\mathbf{x}_{t-1}
\displaystyle q_{(}\mathbf{x}_{1:T}|\mathbf{x}_{0})=\prod_{t=1}^{T}q(\mathbf{x%
}_{t}|\mathbf{x}_{t-1})
\displaystyle q_{(}\mathbf{x}_{1:T}|\mathbf{x}_{0})
\displaystyle=\prod_{t=1}^{T}q(\mathbf{x}_{t}|\mathbf{x}_{t-1})
\displaystyle q\left(\mathbf{x}_{t}\mid\mathbf{x}_{t-1}\right)=\mathcal{N}%
\left(\mathbf{x}_{t};\sqrt{1-\beta_{t}}\mathbf{x}_{t-1},\beta_{t}\mathbf{I}\right)
\displaystyle q\left(\mathbf{x}_{t}\mid\mathbf{x}_{t-1}\right)
\displaystyle=\mathcal{N}\left(\mathbf{x}_{t};\sqrt{1-\beta_{t}}\mathbf{x}_{t-%
1},\beta_{t}\mathbf{I}\right)
\beta_{1},\cdots,\beta_{T}
\alpha_{t}=1-\beta_{t}
\bar{\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i}
q\left(\mathbf{x}_{t}\mid\mathbf{x}_{0}\right)=\mathcal{N}\left(\mathbf{x}_{t}%
;\sqrt{\bar{\alpha}_{t}}\mathbf{x}_{0},\left(1-\bar{\alpha}_{t}\right)\mathbf{%
I}\right)
P_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
\displaystyle P_{\theta}\left(\mathbf{x}_{t-1}\mid\mathbf{x}_{t}\right)=%
\mathcal{N}\left(\mathbf{x}_{t-1};\mu_{\theta}\left(\mathbf{x}_{t},t\right),%
\sigma_{t}^{2}\mathbf{I}\right)
\displaystyle P_{\theta}\left(\mathbf{x}_{t-1}\mid\mathbf{x}_{t}\right)
\displaystyle=\mathcal{N}\left(\mathbf{x}_{t-1};\mu_{\theta}\left(\mathbf{x}_{%
t},t\right),\sigma_{t}^{2}\mathbf{I}\right)
\displaystyle P_{\theta}(\mathbf{x}_{0})=\int p\left(\mathbf{x}_{T}\right)P_{%
\theta}\left(\mathbf{x}_{0:T-1}\mid\mathbf{x}_{T}\right)\mathrm{d}\mathbf{x}_{%
1:T}
\displaystyle P_{\theta}(\mathbf{x}_{0})
\displaystyle=\int p\left(\mathbf{x}_{T}\right)P_{\theta}\left(\mathbf{x}_{0:T%
-1}\mid\mathbf{x}_{T}\right)\mathrm{d}\mathbf{x}_{1:T}
\mu_{\theta}
\sigma_{t}^{2}
P_{\theta}(\mathbf{x}_{T})
T_{g}
S_{g}
\mathcal{X}
\mathcal{Y}
f
G
\displaystyle f\circ T_{g}(x)=S_{g}\circ f(x)
\displaystyle f\circ T_{g}(x)=S_{g}\circ f(x)
P_{\theta}(.)
P_{\theta}(x)=P_{\theta}(T_{g}(x))
\mathcal{G}
G
\mathcal{V}
\mathcal{E}
V\in\mathcal{V}
E_{ij}\in\mathcal{E}
V_{i}
V_{j}
P_{\theta}(\mathcal{V},\mathcal{E})
\displaystyle\,\,G\sim P_{\theta}(\mathcal{V},\mathcal{E}),
\displaystyle\,\,G\sim P_{\theta}(\mathcal{V},\mathcal{E}),
\displaystyle s.t.~{}G_{s}(V_{i})\in\mathcal{W},~{}\forall i=1,\cdots n,
\displaystyle s.t.~{}G_{s}(V_{i})\in\mathcal{W},~{}\forall i=1,\cdots n,
G_{s}(V_{i})
V_{i}
\mathcal{W}
P_{\phi}(V_{i}|N(V_{i}))
N(V_{i})
V_{i}
P_{\theta,\phi}(\mathcal{V},\mathcal{E})
P_{\theta}(\mathcal{V},\mathcal{E})\prod_{1\leq i\leq n}P_{\phi}(V_{i}|N(V_{i}))
H
P_{\theta,\phi}(\mathcal{V},\mathcal{E})=P_{\theta}(H)P_{\phi}(\mathcal{V},%
\mathcal{E}|H)
\displaystyle\mathbb{E}_{(V,E)\sim P_{\text{data}}}\log\sum_{H\in\mathbb{H}}P_%
{\theta}(H)P_{\phi}(V,E|H)\geq
\displaystyle\mathbb{E}_{(V,E)\sim P_{\text{data}}}\log\sum_{H\in\mathbb{H}}
\displaystyle P_{\theta}(H)P_{\phi}(V,E|H)\geq
\displaystyle\mathbb{E}_{(V,E)\sim P_{\text{data}}}\mathbb{E}_{H\sim Q(H|V,E)}%
\Bigg{[}\underbrace{\log P_{\theta}(H)}_{\text{Coarse-grained Diffusion}}
\displaystyle\mathbb{E}_{(V,E)\sim P_{\text{data}}}
\displaystyle\mathbb{E}_{H\sim Q(H|V,E)}\Bigg{[}\underbrace{\log P_{\theta}(H)%
}_{\text{Coarse-grained Diffusion}}
\displaystyle+\underbrace{\log P_{\phi}(V,E|H)}_{\text{Fine-Grained Generation%
}}-\underbrace{\log Q(H|V,E)}_{\text{Constant Term}}\Bigg{]}
\displaystyle+\underbrace{\log P_{\phi}(V,E|H)}_{\text{Fine-Grained Generation%
}}-\underbrace{\log Q(H|V,E)}_{\text{Constant Term}}\Bigg{]}
\mathbb{H}
H
Q(H|V,E)
Q(H|\mathcal{V},\mathcal{E})
\log P_{\theta}(H)
\log P_{\phi}(\mathcal{V},\mathcal{E}|H)
\log P_{\theta}(H)
\log P_{\phi}(\mathcal{V},\mathcal{E}|H)
H=[H_{f},H_{p}]
H_{f}
H_{p}
Q(H|V,E)
H_{f}
H_{p}
V
E
\log P_{\theta}(H)
H_{f}
H_{p}
H_{f}
t>0
0
H_{f}^{\text{int}}
H_{f}^{\text{cont}}
\mathcal{L}_{0}
\displaystyle\mathcal{L}_{0}(H_{f}^{\text{int}},H_{f}^{\text{cont}})=-\log[%
\int_{H_{f}^{\text{int}}-\frac{1}{2}}^{H_{f}^{\text{int}}+\frac{1}{2}}\mathcal%
{N}\left(\boldsymbol{u}\mid\boldsymbol{x}_{0}^{(H_{f}^{\text{int}})},\sigma_{0%
}\right)\mathrm{d}\boldsymbol{u}]
\displaystyle\mathcal{L}_{0}(H_{f}^{\text{int}},H_{f}^{\text{cont}})=-\log[%
\int_{H_{f}^{\text{int}}-\frac{1}{2}}^{H_{f}^{\text{int}}+\frac{1}{2}}\mathcal%
{N}\left(\boldsymbol{u}\mid\boldsymbol{x}_{0}^{(H_{f}^{\text{int}})},\sigma_{0%
}\right)\mathrm{d}\boldsymbol{u}]
\displaystyle-\log\mathcal{N}\left(H_{f}^{\text{cont}}\mid\frac{\boldsymbol{x}%
_{0}^{(H_{f}^{\text{cont}})}}{\alpha_{0}}-\frac{\sigma_{0}}{\alpha_{0}}\hat{%
\boldsymbol{\epsilon}}_{0},\frac{\sigma_{0}^{2}}{\alpha_{0}^{2}}\mathbf{I}%
\right).
\displaystyle-\log\mathcal{N}\left(H_{f}^{\text{cont}}\mid\frac{\boldsymbol{x}%
_{0}^{(H_{f}^{\text{cont}})}}{\alpha_{0}}-\frac{\sigma_{0}}{\alpha_{0}}\hat{%
\boldsymbol{\epsilon}}_{0},\frac{\sigma_{0}^{2}}{\alpha_{0}^{2}}\mathbf{I}%
\right).
H_{p}
\displaystyle\mathcal{N}\left(H_{p}\mid\boldsymbol{0},\sigma^{2}\mathbf{I}%
\right)=(\sqrt{2\pi}\sigma)^{-(M-1)\cdot n}\exp\left(-\frac{1}{2\sigma^{2}}\|H%
_{p}\|^{2}\right).
\displaystyle\mathcal{N}\left(H_{p}\mid\boldsymbol{0},\sigma^{2}\mathbf{I}%
\right)=(\sqrt{2\pi}\sigma)^{-(M-1)\cdot n}\exp\left(-\frac{1}{2\sigma^{2}}\|H%
_{p}\|^{2}\right).
H_{p}
\mathbb{R}^{M\times n}
M
n
\displaystyle\mu_{\theta}\left(H_{p}^{t},t\right)=\frac{1}{\sqrt{\alpha_{t}}}%
\left({H}_{p}^{t}-\frac{\beta_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{\theta}%
\left(H_{p}^{t},t\right)\right).
\displaystyle\mu_{\theta}\left(H_{p}^{t},t\right)=\frac{1}{\sqrt{\alpha_{t}}}%
\left({H}_{p}^{t}-\frac{\beta_{t}}{\sqrt{1-\bar{\alpha}_{t}}}\epsilon_{\theta}%
\left(H_{p}^{t},t\right)\right).
\epsilon_{\theta}
P_{\theta}(H_{p}^{t-1}|H_{p}^{t-1})
P_{\theta}\left(H_{p}^{t-1}\mid H_{p}^{t}\right)=P_{\theta}\left(T_{g}\left(H_%
{p}^{t-1}\right)\mid T_{g}\left(H_{p}^{t}\right)\right)
[H_{f},H_{p}]
P_{\phi}(\mathcal{V},\mathcal{E}|H)
\phi_{\text{focal}}
\phi_{\text{edge}}
\phi_{\text{node}}
\phi_{\text{node}}
\phi_{\text{refine}}
\displaystyle P_{\text{target}}=\prod_{V_{i}\in T_{f}}P_{\phi_{\text{refine}}}%
(f(V_{i})\mid T_{c},T_{f}\setminus V_{i}),
\displaystyle P_{\text{target}}=\prod_{V_{i}\in T_{f}}P_{\phi_{\text{refine}}}%
(f(V_{i})\mid T_{c},T_{f}\setminus V_{i}),
T_{f}
T_{c}
f
\phi_{\text{focal}}
\phi_{\text{edge}}
\phi_{\text{node}}
\phi_{\text{refine}}
\phi_{\text{focal}}
\phi_{\text{edge}}
\phi_{\text{node}}
\phi_{\text{refine}}
\phi_{\text{node}}
\phi_{{\text{focal}}}
\phi_{\text{edge}}
\phi_{\text{node}}
\phi_{\text{refine}}
R
t
R
t
R
t
{}_{\text{DRUG}}
{}_{\text{DRUG}}
\Delta_{\text{LogP}}
\Delta_{\text{MW}}
{}_{\text{DRUG}}
\Delta_{\text{MW}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
\uparrow
\uparrow
\uparrow
\downarrow
\Delta_{\text{LogP}}\downarrow
\Delta_{\text{MW}}\downarrow
\uparrow
\uparrow
\uparrow
\downarrow
\Delta_{\text{LogP}}\downarrow
\Delta_{\text{MW}}\downarrow
\displaystyle\mathrm{COV}\left(C,\mathcal{C^{*}}\right)=\frac{1}{\left|%
\mathcal{C^{*}}\right|}\left\{\sum_{C^{*}\in\mathcal{C^{*}}}{\mathbbm{1}(%
\mathrm{RMSD}(C,C^{*})\leq\delta)}\right\},
\displaystyle\mathrm{COV}\left(C,\mathcal{C^{*}}\right)
\displaystyle=\frac{1}{\left|\mathcal{C^{*}}\right|}\left\{\sum_{C^{*}\in%
\mathcal{C^{*}}}{\mathbbm{1}(\mathrm{RMSD}(C,C^{*})\leq\delta)}\right\},
\displaystyle\mathrm{MAT}\left(C,\mathcal{C^{*}}\right)=\min_{C^{*}\in\mathcal%
{C^{*}}}\mathrm{RMSD}(C,C^{*}),
\displaystyle\mathrm{MAT}\left(C,\mathcal{C^{*}}\right)
\displaystyle=\min_{C^{*}\in\mathcal{C^{*}}}\mathrm{RMSD}(C,C^{*}),
C
\mathcal{C^{*}}
C^{*}
\mathcal{C^{*}}
\mathbbm{1}(\cdot)
\delta
\uparrow
\downarrow
\uparrow
\downarrow
{}_{\text{DRUG}}
t
\mathcal{N}(\mathbf{0},\mathbf{I})
\displaystyle p_{\theta}\left(T_{g}\left(x_{0}\right)\right)=\int p\left(T_{g}%
\left(x_{T}\right)\right)p_{\theta}\left(T_{g}\left(x_{0:T-1}\right)\mid T_{g}%
\left(x_{T}\right)\right)\mathrm{d}\boldsymbol{x}_{1:T}
\displaystyle p_{\theta}\left(T_{g}\left(x_{0}\right)\right)
\displaystyle=\int p\left(T_{g}\left(x_{T}\right)\right)p_{\theta}\left(T_{g}%
\left(x_{0:T-1}\right)\mid T_{g}\left(x_{T}\right)\right)\mathrm{d}\boldsymbol%
{x}_{1:T}
\displaystyle=\int p\left(T_{g}\left(x_{T}\right)\right)\Pi_{t=1}^{T}p_{\theta%
}\left(T_{g}\left(x_{t-1}\right)\mid T_{g}\left(x_{t}\right)\right)\mathrm{d}%
\boldsymbol{x}_{1:T}
\displaystyle=\int p\left(T_{g}\left(x_{T}\right)\right)\Pi_{t=1}^{T}p_{\theta%
}\left(T_{g}\left(x_{t-1}\right)\mid T_{g}\left(x_{t}\right)\right)\mathrm{d}%
\boldsymbol{x}_{1:T}
\displaystyle=\int p\left(x_{T}\right)\Pi_{t=1}^{T}p_{\theta}\left(T_{g}\left(%
x_{t-1}\right)\mid T_{g}\left(x_{t}\right)\right)\mathrm{d}\boldsymbol{x}_{1:T%
}\quad\text{ (invariant prior }p\left(x_{T}\right))
\displaystyle=\int p\left(x_{T}\right)\Pi_{t=1}^{T}p_{\theta}\left(T_{g}\left(%
x_{t-1}\right)\mid T_{g}\left(x_{t}\right)\right)\mathrm{d}\boldsymbol{x}_{1:T%
}\quad\text{ (invariant prior }p\left(x_{T}\right))
\displaystyle=\int p\left(x_{T}\right)\Pi_{t=1}^{T}p_{\theta}\left(x_{t-1}\mid
x%
_{t}\right)\mathrm{d}\boldsymbol{x}_{1:T}\quad\text{ (equivariant kernels }p%
\left(x_{t-1}\mid x_{t}\right))
\displaystyle=\int p\left(x_{T}\right)\Pi_{t=1}^{T}p_{\theta}\left(x_{t-1}\mid
x%
_{t}\right)\mathrm{d}\boldsymbol{x}_{1:T}\quad\text{ (equivariant kernels }p%
\left(x_{t-1}\mid x_{t}\right))
\displaystyle=\int p\left(x_{T}\right)p_{\theta}\left(x_{0:T-1}\mid x_{T}%
\right)\mathrm{d}\boldsymbol{x}_{1:T}
\displaystyle=\int p\left(x_{T}\right)p_{\theta}\left(x_{0:T-1}\mid x_{T}%
\right)\mathrm{d}\boldsymbol{x}_{1:T}
\displaystyle=p_{\theta}\left(x_{0}\right)
\displaystyle=p_{\theta}\left(x_{0}\right)
\sum_{i}^{i=3}H_{pi}=\mathbf{0}
\log P(H)\geq\mathcal{L}_{0}+\mathcal{L}_{\text{base }}+\sum_{t=1}^{T}\mathcal%
{L}_{t}
\displaystyle\mathcal{L}_{0}=\log P\left(H\mid\boldsymbol{x}_{0}\right)
\displaystyle\mathcal{L}_{0}
\displaystyle=\log P\left(H\mid\boldsymbol{x}_{0}\right)
\displaystyle\mathcal{L}_{\text{base }}=-\mathrm{KL}\left(q\left(\boldsymbol{x%
}_{T}\mid H\right)\mid P\left(\boldsymbol{x}_{T}\right)\right)
\displaystyle\mathcal{L}_{\text{base }}
\displaystyle=-\mathrm{KL}\left(q\left(\boldsymbol{x}_{T}\mid H\right)\mid P%
\left(\boldsymbol{x}_{T}\right)\right)
\displaystyle\mathcal{L}_{t}=-\mathrm{KL}\left(q\left(\boldsymbol{x}_{s}\mid H%
,\boldsymbol{x}_{t}\right)\mid P\left(\boldsymbol{x}_{s}\mid\boldsymbol{x}_{t}%
\right)\right)
\displaystyle\mathcal{L}_{t}
\displaystyle=-\mathrm{KL}\left(q\left(\boldsymbol{x}_{s}\mid H,\boldsymbol{x}%
_{t}\right)\mid P\left(\boldsymbol{x}_{s}\mid\boldsymbol{x}_{t}\right)\right)
\mathcal{L}_{t}
\mathcal{L}_{base}
\mathcal{L}_{0}
\mathcal{L}_{0}
\displaystyle P\left(H_{f}^{int}\mid\boldsymbol{x}_{0}^{(H)}\right)=\int_{H_{f%
}^{int}-\frac{1}{2}}^{H_{f}^{int}+\frac{1}{2}}\mathcal{N}\left(\boldsymbol{u}%
\mid\boldsymbol{x}_{0}^{(H_{f}^{int})}\sigma_{0}\right)\mathrm{d}\boldsymbol{u}
\displaystyle P\left(H_{f}^{int}\mid\boldsymbol{x}_{0}^{(H)}\right)
\displaystyle=\int_{H_{f}^{int}-\frac{1}{2}}^{H_{f}^{int}+\frac{1}{2}}\mathcal%
{N}\left(\boldsymbol{u}\mid\boldsymbol{x}_{0}^{(H_{f}^{int})}\sigma_{0}\right)%
\mathrm{d}\boldsymbol{u}
\displaystyle P\left(H_{f}^{cont}\mid\boldsymbol{x}_{0}\right)=\mathcal{N}%
\left(H_{f}^{cont}\mid\boldsymbol{x}_{0}^{(H_{f}^{cont})}/\alpha_{0}-\sigma_{0%
}/\alpha_{0}\hat{\boldsymbol{\epsilon}}_{0},\sigma_{0}^{2}/\alpha_{0}^{2}%
\mathbf{I}\right)
\displaystyle P\left(H_{f}^{cont}\mid\boldsymbol{x}_{0}\right)
\displaystyle=\mathcal{N}\left(H_{f}^{cont}\mid\boldsymbol{x}_{0}^{(H_{f}^{%
cont})}/\alpha_{0}-\sigma_{0}/\alpha_{0}\hat{\boldsymbol{\epsilon}}_{0},\sigma%
_{0}^{2}/\alpha_{0}^{2}\mathbf{I}\right)
\displaystyle P\left(H_{p}\mid\boldsymbol{x}_{0}\right)=\mathcal{N}\left(H_{f}%
^{cont}\mid\boldsymbol{x}_{0}^{(H_{p})}/\alpha_{0}-\sigma_{0}/\alpha_{0}\hat{%
\boldsymbol{\epsilon}}_{0},\sigma_{0}^{2}/\alpha_{0}^{2}\mathbf{I}\right)
\displaystyle P\left(H_{p}\mid\boldsymbol{x}_{0}\right)
\displaystyle=\mathcal{N}\left(H_{f}^{cont}\mid\boldsymbol{x}_{0}^{(H_{p})}/%
\alpha_{0}-\sigma_{0}/\alpha_{0}\hat{\boldsymbol{\epsilon}}_{0},\sigma_{0}^{2}%
/\alpha_{0}^{2}\mathbf{I}\right)
h_{int}
-1/2
1/2
\displaystyle\vspace{-20pt}m_{uv}=\phi_{m}\left(n_{u}^{l},n_{v}^{l},\left\|x_{%
u}^{l}-x_{v}^{l}\right\|^{2},\mathbf{e_{uv}^{l}}\right)
\displaystyle\vspace{-20pt}m_{uv}
\displaystyle=\phi_{m}\left(n_{u}^{l},n_{v}^{l},\left\|x_{u}^{l}-x_{v}^{l}%
\right\|^{2},\mathbf{e_{uv}^{l}}\right)
\displaystyle x_{u}^{l+1}=x_{u}^{l}+c\tanh\left(\sum_{v\in\mathcal{N}(u)}\left%
(x_{u}^{l}-x_{v}^{l}\right)\phi_{x}\left(m_{uv}\right)\right)
\displaystyle x_{u}^{l+1}
\displaystyle=x_{u}^{l}+c\tanh\left(\sum_{v\in\mathcal{N}(u)}\left(x_{u}^{l}-x%
_{v}^{l}\right)\phi_{x}\left(m_{uv}\right)\right)
\displaystyle n_{u}^{l+1}=\phi_{n}\left(n_{u}^{l},\sum_{v\in\mathcal{N}(u)}%
\left(m_{uv}\right)\right)
\displaystyle n_{u}^{l+1}
\displaystyle=\phi_{n}\left(n_{u}^{l},\sum_{v\in\mathcal{N}(u)}\left(m_{uv}%
\right)\right)
\displaystyle\mathbf{e_{uv}^{l+1}}=\phi_{e}\left(\mathbf{e_{uv}^{l}},m_{uv},%
\left\|x_{u}^{l}-x_{v}^{l}\right\|^{2}\right)\vspace{-30pt}
\displaystyle\mathbf{e_{uv}^{l+1}}
\displaystyle=\phi_{e}\left(\mathbf{e_{uv}^{l}},m_{uv},\left\|x_{u}^{l}-x_{v}^%
{l}\right\|^{2}\right)\vspace{-30pt}
n
e
c
x
\phi
\phi_{focal}
\phi_{edge}
\phi_{node}
\{G\}
\phi_{\text{focal}},\phi_{\text{edge}},\phi_{\text{node}},\phi_{\text{refine}}
\phi_{\text{focal}},\phi_{\text{edge}},\phi_{\text{node}},\phi_{\text{refine}}
\text{feat}\leftarrow\text{Coarse-grained feature of~{}}n,n\in S
\text{coord}\leftarrow\text{Position of~{}}n,n\in S
\text{feat}\leftarrow\text{Fine-grained feature of~{}}n,n\in S
\text{coord}\leftarrow\text{Position of~{}}n,n\in S
\text{edge}\leftarrow\{i,j\},\{i,j\}\in E
\text{feat}\leftarrow\text{Fine-grained feature of~{}}n
T\sim{T\in G}
T
n\sim{n\in T}
n
m\sim{m\in T}
m
\tilde{T}=T\setminus n
V=G\setminus T
\hat{T}=T\setminus m
\text{context}=(\Call{F}{\tilde{T}},\Call{C}{V\cup n})
\mathcal{L}_{\text{sample}}=-\log P_{\phi_{\text{focal}}}(n.\text{parent}\mid%
\text{context})
-\log P_{\phi_{\text{edge}}}(\{n,n.\text{parent}\}\mid\text{context})
-\log P_{\phi_{\text{node}}}(\Call{Frag}{n}\mid\text{context},\{n,n.\text{%
parent}\})
\phi_{\text{focal}},\phi_{\text{edge}},\phi_{\text{node}}\leftarrow\text{%
Optimize}(\mathcal{L}_{\text{sample}})
\mathcal{L}_{\text{refine}}=-\log P_{\phi_{\text{refine}}}(\Call{Frag}{m}\mid[%
(\Call{F}{\hat{T}},\Call{C}{m}])
\phi_{\text{refine}}\leftarrow\text{Optimize}(\mathcal{L}_{\text{refine}})
N
\phi_{\text{focal}},\phi_{\text{edge}},\phi_{\text{node}},\phi_{\text{refine}}
T
n_{\text{focal}}\sim P_{\phi_{\text{focal}}}(n_{\text{focal}}\mid T)
\{n_{\text{focal}},n_{\text{new}}\}\sim P_{\phi_{\text{edge}}}(\{n_{\text{%
focal}},n_{\text{new}}\}\mid T)
T\leftarrow T+\{n_{\text{focal}},n_{\text{new}}\}
\text{fragment}\sim P_{\phi_{\text{node}}}(fragment\mid T)
\Call{frag}{n_{\text{new}}}\leftarrow\text{fragment}
\text{T}_{\text{coarse}}\leftarrow
\text{T}_{\text{fine}}\leftarrow
n_{\text{refine}}=\arg\min_{n}(P_{\phi_{\text{refine}}}(\Call{frag}{n}\mid%
\text{T}_{\text{fine}}\setminus n,\text{T}_{\text{coarse}}),n\in T)
\text{fragment}\sim P_{\phi_{\text{refine}}}(\text{fragment}\mid\text{T}_{%
\text{fine}}\setminus n,\text{T}_{\text{coarse}})
\Call{frag}{n_{\text{refine}}}\leftarrow\text{fragment}
\sum_{n\in T}(\log P_{\phi_{\text{refine}}}(\Call{frag}{n}\mid T\setminus n))
T\leftarrow N
T\leftarrow
T
\hat{T}\leftarrow
T
\hat{T}
>
T
T\leftarrow\hat{T}
\forall_{n\in T},n\text{~{}is fine-grained node}
F_{out}
G
C_{out}
X\in\mathbb{R}_{3},\hat{X}\in\mathbb{R}_{3}
X_{c}=\sum_{i=1}^{n}X_{i},\hat{X}_{c}=\sum_{i=1}^{n}\hat{X}_{i}
X=X-X_{c},\hat{X}=\hat{X}-\hat{X}_{c}
H=\sum_{i=1}^{n}X\hat{X}^{T}
H=U\Lambda V^{T}
R={\left(UV^{T}\right)}^{T}
t=\hat{X}_{c}-RX_{c}
R,t
C_{\text{in}},F_{\text{in}}\leftarrow
C_{\text{out}}\leftarrow C_{\text{in}}
n\in BFS(G)
n_{\text{frag}},n_{\text{atom}}\leftarrow\text{fragment index , atom index of~%
{}}n
n_{\text{frag}}^{\text{nei}},n_{\text{atom}}^{\text{nei}}\leftarrow\text{%
fragment index , atom index of~{}}n.\text{neighbors}
n
{n}_{\text{frag}}^{\text{par}},{n}_{\text{atom}}^{\text{par}}\leftarrow\text{%
fragment index , atom index of~{}}n.\text{parent}
n_{\text{attach}}\leftarrow{n}_{\text{atom}}^{\text{par}}\cap n_{\text{atom}}
\text{ref}=\left\{F_{\text{in}}\right[n_{\text{frag}},n_{\text{frag}}^{\text{%
nei}}\left],C_{\text{in}}\right[n_{\text{attach}}\left]\right\}
\text{out}=\left\{F_{\text{out}}\right[n_{\text{frag}},n_{\text{frag}}^{\text{%
nei}}\left],C_{\text{out}}\right[n_{\text{attach}}\left]\right\}
\text{ref}=\left\{F_{\text{in}}\right[n_{\text{frag}},n_{\text{frag}}^{\text{%
nei}}\left]\right\}
\text{out}=\left\{F_{\text{out}}\right[n_{\text{frag}},n_{\text{frag}}^{\text{%
nei}}\left]\right\}
R,t=\Call{KABSCH}{\text{ref},\text{out}}
C_{\text{out}}\left[n_{\text{atom}}\right]=RC_{\text{out}}\left[n_{\text{atom}%
}\right]+t
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{E}}
{}_{\text{P}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{E}}
{}_{\text{P}}
{}_{\text{DRUG}}
\pi-\pi
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{E}}
{}_{\text{P}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
\downarrow
\uparrow
\downarrow
\uparrow
{}_{\text{E}}
{}_{\text{P}}
\log P
{}_{\text{E}}
{}_{\text{P}}
{}_{\text{DRUG}}
\Delta
\Delta
\uparrow
\uparrow
\uparrow
\downarrow
\Delta_{\text{LogP}}\downarrow
\Delta_{\text{MW}}\downarrow
{}_{\text{E}}
{}_{\text{P}}
{}_{\text{E}}
{}_{\text{P}}
{}_{\text{DRUG}}
\Delta
\Delta
\uparrow
\uparrow
\uparrow
\downarrow
\Delta
\downarrow
\Delta
\downarrow
\uparrow
\phi_{focal}
\phi_{node}
\phi_{edge}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
{}_{\text{DRUG}}
