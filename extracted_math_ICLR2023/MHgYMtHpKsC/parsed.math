\mathcal{D}_{i}
\mathcal{D}_{i}
k
M
m\in[M]
\mathcal{D}_{m}=\{({\bm{x}}_{i},y_{i})\}_{i=1}^{|\mathcal{D}_{m}|}
{\bm{x}}
y\in\{1,\cdots,C\}=[C]
\ell
\mathcal{L}_{m}(\bm{\theta})=\frac{1}{|\mathcal{D}_{m}|}\sum_{({\bm{x}}_{i},y_%
{i})\in\mathcal{D}_{m}}\ell(y_{i},h_{\bm{\theta}}({\bm{x}}_{i}))
m
h_{\bm{\theta}}
\bm{\theta}
m
\bm{\theta}_{m}
m
\displaystyle\min_{\{\bm{\Omega},\bm{\theta}_{1},\cdots,\bm{\theta}_{M}\}}%
\frac{1}{M}\sum_{m=1}^{M}\mathcal{L}_{m}(\bm{\theta}_{m})+\mathcal{R}(\bm{%
\Omega},\bm{\theta}_{1},\cdots,\bm{\theta}_{M}),
\displaystyle\min_{\{\bm{\Omega},\bm{\theta}_{1},\cdots,\bm{\theta}_{M}\}}%
\frac{1}{M}\sum_{m=1}^{M}\mathcal{L}_{m}(\bm{\theta}_{m})+\mathcal{R}(\bm{%
\Omega},\bm{\theta}_{1},\cdots,\bm{\theta}_{M}),
\mathcal{R}
\bm{\Omega}
\bm{\Omega}
m^{\prime}\notin[M]
\{\bm{v}_{1},\dots,\bm{v}_{K}\}
K\ll M
|\bm{v}|=|\bm{\theta}|
\bm{\theta}_{m}
K
\mathcal{V}=\{\bm{v}_{1},\dots,\bm{v}_{K}\}
\displaystyle\bm{\theta}_{m}=\bm{\theta}(\bm{\alpha}_{m},\mathcal{V})=\sum_{k}%
\bm{\alpha}_{m}[k]\times\bm{v}_{k},
\displaystyle\bm{\theta}_{m}=\bm{\theta}(\bm{\alpha}_{m},\mathcal{V})=\sum_{k}%
\bm{\alpha}_{m}[k]\times\bm{v}_{k},
\bm{\alpha}_{m}\in\Delta^{K-1}
K
(K-1)
\mathcal{V}=\{\bm{v}_{1},\dots,\bm{v}_{K}\}
\mathcal{A}=\{\bm{\alpha}_{1},\dots,\bm{\alpha}_{M}\}
\bm{\alpha}
\displaystyle\min_{\mathcal{A}=\{\bm{\alpha}_{m}\}_{m=1}^{M},\mathcal{V}=\{\bm%
{v}_{k}\}_{k=1}^{K}}\hskip 2.0pt\frac{1}{M}\sum_{m=1}^{M}\mathcal{L}_{m}(\bm{%
\theta}_{m}),
\displaystyle\min_{\mathcal{A}=\{\bm{\alpha}_{m}\}_{m=1}^{M},\mathcal{V}=\{\bm%
{v}_{k}\}_{k=1}^{K}}\hskip 2.0pt\frac{1}{M}\sum_{m=1}^{M}\mathcal{L}_{m}(\bm{%
\theta}_{m}),
\displaystyle\quad\text{ where }\bm{\theta}_{m}=\sum_{k}\bm{\alpha}_{m}[k]%
\times\bm{v}_{k}.
\displaystyle\quad\text{ where }\bm{\theta}_{m}=\sum_{k}\bm{\alpha}_{m}[k]%
\times\bm{v}_{k}.
m^{\prime}
\mathcal{V}
\bm{\alpha}_{m^{\prime}}
\mathcal{V}
\bm{\alpha}_{m^{\prime}}=\operatorname{arg\,min}_{\bm{\alpha}}\mathcal{L}_{m^{%
\prime}}(\bm{\theta}(\bm{\alpha},\mathcal{V}))
|\bm{\alpha}_{m^{\prime}}|
K
\mathcal{V}
\bm{\alpha}_{m^{\prime}}
\bm{\theta}_{m^{\prime}}
K
\mathcal{V}\in\mathbb{R}^{|\bm{\theta}|\times K}
Q
\mathcal{A}=[\bm{\alpha}_{1},\dots,\bm{\alpha}_{M}]\in\mathbb{R}^{K\times M}
L
m
\bm{\alpha}_{m}\in\mathbb{R}^{K}
M
\displaystyle N=\mathcal{O}(\frac{K}{\epsilon^{2}}\log\frac{L}{\delta}+\frac{Q%
}{M\epsilon^{2}}\log\frac{L}{\delta})
\displaystyle N=\mathcal{O}(\frac{K}{\epsilon^{2}}\log\frac{L}{\delta}+\frac{Q%
}{M\epsilon^{2}}\log\frac{L}{\delta})
|\mathcal{D}_{m}|>N
\bm{\theta}_{m}:=\bm{\theta}(\bm{\alpha}_{m},\mathcal{V})
|\tilde{\mathcal{L}}_{m}(\bm{\theta}_{m})-\mathcal{L}_{m}(\bm{\theta}_{m})|\leq\epsilon
1-\delta
M
Q=|\bm{\theta}|\times K
K\ll M
\bm{\theta}_{m}=\bm{\theta}(\bm{\alpha}_{m},\mathcal{V})
\bm{\alpha}_{m}
\mathcal{V}
\bm{\theta}_{m}
\mathcal{V}
Q
Q
100\times|\bm{\theta}|
10\sim 100
Q=K\times|\bm{\theta}|
K
4
8
\bm{\theta}_{m}
\bm{\alpha}_{m}
\mathcal{V}
\mathcal{V}
\mathcal{A}
\displaystyle\text{Local: }\{\bm{\alpha}_{m}^{(t)},\tilde{\mathcal{V}}_{m}^{(t%
)}\}=\operatorname{arg\,min}_{\{\bm{\alpha},\mathcal{V}\}}\mathcal{L}_{m}(\bm{%
\alpha},\mathcal{V}),
\displaystyle\{\bm{\alpha}_{m}^{(t)},\tilde{\mathcal{V}}_{m}^{(t)}\}=%
\operatorname{arg\,min}_{\{\bm{\alpha},\mathcal{V}\}}\mathcal{L}_{m}(\bm{%
\alpha},\mathcal{V}),
\displaystyle\text{ initialized by }\bm{\alpha}={\frac{\textbf{1}}{K}}\text{ %
and }\mathcal{V}=\bar{\mathcal{V}}^{(t-1)},
\displaystyle\text{ initialized by }\bm{\alpha}={\frac{\textbf{1}}{K}}\text{ %
and }\mathcal{V}=\bar{\mathcal{V}}^{(t-1)},
\displaystyle\text{Global: }\bar{\mathcal{V}}^{(t)}\leftarrow\frac{1}{M}\sum_{%
m=1}^{M}{\tilde{\mathcal{V}}_{m}^{(t)}},
\displaystyle\bar{\mathcal{V}}^{(t)}\leftarrow\frac{1}{M}\sum_{m=1}^{M}{\tilde%
{\mathcal{V}}_{m}^{(t)}},
\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})
\mathcal{L}_{m}(\bm{\theta}=\sum_{k}\bm{\alpha}[k]\times\bm{v}_{k})
t
K
\bar{\mathcal{V}}^{(t-1)}
m
\bm{\alpha}_{m}^{(t)}
\bm{\alpha}_{m}^{(t)}
\mathcal{L}_{m}
\tilde{\mathcal{V}}_{m}^{(t)}
m
M
\bar{\mathcal{V}}^{(t)}
M
K=4
M=40
=5
\mathcal{V}
K
\displaystyle\nabla_{\bm{v}_{k}}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})=\bm{%
\alpha}[k]\times\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{\theta}),
\displaystyle\nabla_{\bm{v}_{k}}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})=
\displaystyle\bm{\alpha}[k]\times\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{%
\theta}),
\displaystyle\nabla_{\bm{\alpha}[k]}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})=%
\bm{v}_{k}\cdot\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{\theta}).
\displaystyle\nabla_{\bm{\alpha}[k]}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})=
\displaystyle\bm{v}_{k}\cdot\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{\theta}).
\bm{\alpha}[k]
\nabla_{\bm{v}_{k}}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})
\bm{v}_{k}\in\tilde{\mathcal{V}}_{m}^{(t)}
\bm{\alpha}[k]\geq 0
-\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{\theta})
-\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{\theta})
\bm{\alpha}[k]
\bm{\alpha}
\mathcal{V}
\bm{\alpha}
\mathcal{V}
\mathcal{V}
\bm{\alpha}
\bm{v}_{k}\cdot\nabla_{\bm{\theta}}\mathcal{L}_{m}(\bm{\theta})
\bm{\alpha}
\mathcal{V}
\bm{\alpha}
\bm{\alpha}[k]\geq 0
\bm{v}_{k}
\nabla_{\bm{v}_{k}}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})
0
\bm{\alpha}[k]=0
\nabla_{\bm{v}_{k}}\mathcal{L}_{m}(\bm{\alpha},\mathcal{V})
\bm{\alpha}
\bm{\psi}\in\mathbb{R}^{K}
0<\tau\leq 1
\bm{\alpha}[k]=\frac{\exp{(\bm{\psi}[k]/\tau})}{\sum_{k^{\prime}}\exp{(\bm{%
\psi}[k^{\prime}]/\tau})}
\displaystyle\text{Local: }\text{ initialized by }\bm{\alpha}={\frac{\textbf{1%
}}{K}}\text{ and }\mathcal{V}=\bar{\mathcal{V}}^{(t-1)},
\displaystyle\text{ initialized by }\bm{\alpha}={\frac{\textbf{1}}{K}}\text{ %
and }\mathcal{V}=\bar{\mathcal{V}}^{(t-1)},
\displaystyle\bm{\alpha}_{m}^{(t)}=\operatorname{arg\,min}_{\bm{\alpha}}%
\mathcal{L}_{m}(\bm{\alpha},\mathcal{V}),
\displaystyle\bm{\alpha}_{m}^{(t)}=\operatorname{arg\,min}_{\bm{\alpha}}%
\mathcal{L}_{m}(\bm{\alpha},\mathcal{V}),
\displaystyle\bm{\alpha}_{m}^{(t)\dagger}\leftarrow\textsc{Sharpen}(\bm{\alpha%
}_{m}^{(t)};\tau),
\displaystyle\bm{\alpha}_{m}^{(t)\dagger}\leftarrow\textsc{Sharpen}(\bm{\alpha%
}_{m}^{(t)};\tau),
\displaystyle\tilde{\mathcal{V}}_{m}^{(t)}=\operatorname{arg\,min}_{\mathcal{V%
}}\mathcal{L}_{m}(\bm{\alpha}_{m}^{(t)\dagger},\mathcal{V}),
\displaystyle\tilde{\mathcal{V}}_{m}^{(t)}=\operatorname{arg\,min}_{\mathcal{V%
}}\mathcal{L}_{m}(\bm{\alpha}_{m}^{(t)\dagger},\mathcal{V}),
\displaystyle\text{Global: }\bar{\mathcal{V}}^{(t)}\leftarrow\frac{1}{M}\sum_{%
m=1}^{M}{\tilde{\mathcal{V}}_{m}^{(t)}}.
\displaystyle\bar{\mathcal{V}}^{(t)}\leftarrow\frac{1}{M}\sum_{m=1}^{M}{\tilde%
{\mathcal{V}}_{m}^{(t)}}.
K
K
226
62
\leq 1
\mathcal{P}_{m}(y)
\frac{1}{M}\sum_{m}\|\mathcal{P}^{train}_{m}(y)-\mathcal{P}^{test}_{m}(y)\|_{1%
}=0.77
50/50\%
\mathcal{P}_{m}({\bm{x}},y)
\mathcal{P}_{m}({\bm{x}},y)
\mathcal{P}_{m}({\bm{x}})
\mathcal{P}_{m}(y)
\mathcal{D}
\{(\mathcal{D}^{train}_{m},\mathcal{D}^{test/val}_{m})\}
\mathcal{D}
M^{\prime}
m
\mathcal{P}_{m}(y)
\mathcal{D}^{test/val}_{m}
\frac{1}{M}\sum_{m}\frac{\sum_{i}\mathcal{P}_{m}(y_{i})\textbf{1}(y_{i}=\hat{y%
}_{i})}{\sum_{i}\mathcal{P}_{m}(y_{i})}
\mathcal{D}^{train}_{m}
\#
4
60
20
5
15\%
20/10
0.3
\%
20
|\Delta|
\%
20
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
\{\bm{\alpha}_{m}\}
\{\bm{\alpha}_{m}\}
233
k
5
\bm{\alpha}
\mathcal{V}
\tau=0.1
4/4/8
\mathcal{V}
0.9
1\text{e-}4
0.01
100/200
16/64
5
100/10\%
\{0.005,0.01,0.05\}
1\text{e-}4
7\%
|\Delta|
\tau
3
100
5
100
5
\pm
\pm
80/20
5
80/20
5
\pm
\pm
\pm
\pm
\pm
\pm
m
m
\bar{\mathcal{V}}
\mathcal{L}_{m}
\tau
t\leftarrow 1
T
\bar{\mathcal{V}}
m\in[M]
m\in[M]
\{\bm{\alpha}_{m},\mathcal{V}\}\text{ by }\{\bm{\frac{1}{K}},\bar{\mathcal{V}}\}
\bm{\alpha}_{m}^{\star}=\operatorname{arg\,min}_{\bm{\alpha}_{m}}\mathcal{L}_{%
m}(\bm{\alpha}_{m},\mathcal{V})
\bm{\alpha}_{m}^{\star\dagger}\leftarrow\textsc{Sharpen}(\bm{\alpha}_{m}^{%
\star};\tau)
\mathcal{V}_{m}^{\star}=\operatorname{arg\,min}_{\mathcal{V}}\mathcal{L}_{m}(%
\bm{\alpha}_{m}^{\star\dagger},\mathcal{V})
\mathcal{V}_{m}^{\star}
\bar{\mathcal{V}}=\frac{1}{M}\sum_{m=1}^{M}\mathcal{V}^{\star}_{m}
\bar{\mathcal{V}}
m
m
\mathcal{V}
\mathcal{L}_{m}
\bm{\alpha}_{m}\text{ by }\bm{\frac{1}{K}}
\bm{\alpha}_{m}^{\star}=\operatorname{arg\,min}_{\bm{\alpha}_{m}}\mathcal{L}_{%
m}(\bm{\alpha}_{m},\mathcal{V})
\bm{\theta}_{m}(\bm{\alpha}_{m},\mathcal{V})=\sum_{k}\bm{\alpha}_{m}[k]\times%
\bm{v}_{k}
\bm{\theta}_{m}
K
\mathcal{V}=\{\bm{v}_{k}\}_{k=1}^{K}
\bm{\alpha}_{m}\in\mathbb{R}^{K}
\Delta^{(K-1)}
T
m
\mathcal{V}
\bm{\alpha}_{m}
\mathcal{V}
\bm{\alpha}_{m}
\mathcal{V}
5
\bm{\alpha}_{m}
6
\mathcal{V}
\bm{\alpha}_{m}
\mathcal{V}
\bm{\alpha}_{m}
m
|\bm{\alpha}_{m}|=K
\mathcal{V}
K
K
4\sim 8
60
20
5
15\%
20/10
0.3
50
100\%
20\%
10
20
40\%
20\%
\bm{\alpha}_{m}[k]
\bm{v}_{k}
\bm{\theta}_{m}
4
\bm{\theta}_{m}(\bm{\alpha}_{m},\mathcal{V})=\frac{1}{2}(\bm{v}^{\prime}+\sum_%
{k}\bm{\alpha}_{m}[k]\times\bm{v}_{k}
\bm{v}^{\prime}
\{\bm{\theta}_{m}\}
K
K
30\%
0.9
1\text{e-}4
0.01
100/200
16/64
5
100/10\%
5
\bm{\alpha}
\mathcal{V}
\tau=0.1
4/4/8
\{0.005,0.01,0.05\}
1\text{e-}4
k
\mathcal{P}_{m}({\bm{x}},y)
0.3
\mathcal{P}_{m}(y)
\mathcal{P}_{m}(x)
4
M=80
7
256
4
M=80
7
256
4
M=80
65
49
4
M=80
65
49
M=233
D=203
M=233
D=203
M=40
K=4
M=40
K=4
5
7
7
M=40
\mathcal{P}_{m}(y)
m
0.3
K=4
100
\mathcal{P}_{m}(y)
m
N_{m}
j
\displaystyle\frac{1}{M}\sum_{m}\frac{\sum_{j}\mathcal{P}_{m}(y_{j})\textbf{1}%
[y_{j}=h_{\bm{\theta}_{m}}({\bm{x}}_{j})]}{\sum_{j}\mathcal{P}_{m}(y_{j})},
\displaystyle\frac{1}{M}\sum_{m}\frac{\sum_{j}\mathcal{P}_{m}(y_{j})\textbf{1}%
[y_{j}=h_{\bm{\theta}_{m}}({\bm{x}}_{j})]}{\sum_{j}\mathcal{P}_{m}(y_{j})},
\displaystyle\frac{1}{M}\sum_{m}\frac{1}{N_{m}}\sum_{j}{\textbf{1}[y_{j}=h_{%
\bm{\theta}_{m}}({\bm{x}}_{j})]}.
\displaystyle\frac{1}{M}\sum_{m}\frac{1}{N_{m}}\sum_{j}{\textbf{1}[y_{j}=h_{%
\bm{\theta}_{m}}({\bm{x}}_{j})]}.
\mathcal{P}_{m}(y_{j})
m
m
100
5
5
k
k
\{\bm{v}_{1},\dots,\bm{v}_{k}\}
40
40
\{\bm{\theta}_{m}\}
4
18.1\%
k
k
\{\bm{\theta}_{m}\}
k=4
21.4\%
40
k
40
k
|\Delta|
30
=0.005
\ell
30
=0.005
\ell
K
K
0.001
0.005
0.01
0.05
0.1
\%
20
\{0.005,0.01,0.05\}
\%
20
\{0.005,0.01,0.05\}
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
|\Delta|
\sigma^{2}
\%
3
\sigma^{2}
\%
3
K
K
K
\tau
