p(y|x)
p(x)
p(x)
x
y
x
y
p(y|x)
p(x)
p(x)
x
y
p(x)
0
p(x,y)
p(x,y)
x
\operatorname{\mathbf{x}}
p_{\bm{\theta}}(\operatorname{\mathbf{x}})=\frac{e^{-E_{\bm{\theta}}(%
\operatorname{\mathbf{x}})}}{Z_{\bm{\theta}}}=\frac{e^{f_{\bm{\theta}}^{x}(%
\operatorname{\mathbf{x}})}}{Z_{\bm{\theta}}}\text{,}
E_{\bm{\theta}}(\operatorname{\mathbf{x}})
\operatorname{\mathbf{x}}\in\mathbf{X},\mathbf{X}=\mathbb{R}^{D_{x}}
p_{\bm{\theta}}(\operatorname{\mathbf{x}})
Z_{\bm{\theta}}=\int_{\mathbf{x}}{e^{f_{\bm{\theta}}^{x}(\mathbf{x})}}d\mathbf%
{x}
p_{\bm{\theta}}(\mathbf{x},y)
\mathbf{x}
y\in\text{Y},\text{Y}=\mathbb{N}^{+},y\leq D_{y}
p_{\bm{\theta}}(\mathbf{x},y=i)=\frac{e^{-E_{\bm{\theta}}(\mathbf{x},y=i)}}{Z_%
{\bm{\theta}}}=\frac{e^{f_{\bm{\theta}}(\mathbf{x},y=i)}}{Z_{\bm{\theta}}}=%
\frac{e^{{f_{\bm{\theta}}(\mathbf{x})}_{i}}}{Z_{\bm{\theta}}}=\frac{e^{q_{i}}}%
{Z_{\bm{\theta}}}
-E_{\bm{\theta}}(\mathbf{x},y)
{f_{\bm{\theta}}(\mathbf{x},y):\operatorname{\mathbf{x}},y\mapsto-E_{\bm{%
\theta}}(\mathbf{x},y)}
f_{\bm{\theta}}(\mathbf{x}):\operatorname{\mathbf{x}}\mapsto\mathbf{q}
\mathbf{q}\in\mathbb{R}^{D_{y}}
i
\mathbf{q}
q_{i}
-E_{\bm{\theta}}(\mathbf{x},y=i)
Z_{\bm{\theta}}=\sum_{y}\int_{\mathbf{x}}{e^{-E_{\bm{\theta}}(\mathbf{x},y)}}d%
\mathbf{x}
Z_{\bm{\theta}}
\mathbf{x}
{\bm{\theta}}
\operatorname{\mathbf{x}}
\nabla_{\bm{\theta}}\log p_{\bm{\theta}}(\mathbf{x})=\nabla_{\bm{\theta}}f_{%
\bm{\theta}}^{x}(\mathbf{x})-\nabla_{\bm{\theta}}\log Z_{\bm{\theta}}=\nabla_{%
\bm{\theta}}f_{\bm{\theta}}^{x}(\mathbf{x})-\mathbb{E}_{(\tilde{\mathbf{x}})%
\sim p_{\bm{\theta}}(\mathbf{x})}\left[\nabla_{\bm{\theta}}f_{\bm{\theta}}^{x}%
(\tilde{\mathbf{x}})\right]
\nabla_{\bm{\theta}}\log p_{\bm{\theta}}(\mathbf{x},y)
\nabla_{\bm{\theta}}\log p_{\bm{\theta}}(\mathbf{x},y)=\nabla_{\bm{\theta}}f_{%
\bm{\theta}}(\mathbf{x})_{y}-\nabla_{\bm{\theta}}\log Z_{\bm{\theta}}=\nabla_{%
\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}-\mathbb{E}_{(\tilde{\mathbf{x}},j)%
\sim p_{\bm{\theta}}(\mathbf{x},y)}\left[\nabla_{\bm{\theta}}f_{\bm{\theta}}(%
\tilde{\mathbf{x}})_{j}\right]
p_{\bm{\theta}}(\mathbf{x})
f_{\bm{\theta}}^{x}(\mathbf{x})
\mathbf{x}^{t+1}=\operatorname{\mathbf{x}}^{t}+\frac{\alpha^{t}}{2}\nabla_{%
\mathbf{x}}f_{\bm{\theta}}^{x}(\mathbf{x}^{t})+\mathbf{u}^{t},\;\;\;\;\;\;\;\;%
\;u^{t}_{i}\sim\mathcal{N}(0,\alpha^{t}),\;\;1\leq i\leq D_{x}\text{,}
\operatorname{\mathbf{x}}^{0}
\sum_{t}\alpha^{t}=\infty
\sum_{t}(\alpha^{t})^{2}<\infty
\mathbf{x}^{t}
p_{\bm{\theta}}(\mathbf{x})
t\to\infty
\operatorname{\mathbf{x}}^{0}
\mathbf{u}^{t}
p_{\bm{\theta}}(\mathbf{x})
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}},y)
f_{\operatorname{\bm{\theta}}}^{x}(\operatorname{\mathbf{x}})
\log\sum_{i}e^{f_{\bm{\theta}}(\mathbf{x})_{i}}
y=i
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}},y=i)
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y=i)
\log p_{\operatorname{\bm{\theta}}}(y)
\nabla_{\mathbf{x}}\log p_{\operatorname{\bm{\theta}}}(y)=0
f_{\operatorname{\bm{\theta}}}^{x}(\operatorname{\mathbf{x}})
f_{\bm{\theta}}(\mathbf{x})_{i}
{\bm{\theta}}
\operatorname{H}
p
p_{\bm{\theta}}
y
\mathbf{x}
H(p,p_{\operatorname{\bm{\theta}}})=-\sum_{y\in\text{Y}}p(y\mid\operatorname{%
\mathbf{x}})\log p_{\operatorname{\bm{\theta}}}(y\mid\operatorname{\mathbf{x}}%
)\text{.}
p(y\mid\operatorname{\mathbf{x}})
p(x)
\mathbb{E}_{p(\operatorname{\mathbf{x}})}\left[\operatorname{H}(p,p_{\bm{%
\theta}})\right]
p_{data}
(\mathbf{x^{i}},y^{i})\in\operatorname{DS}
p_{data}(y=y^{i}\mid\mathbf{x}=\mathbf{x^{i}})=1
\mathbb{E}_{p_{\mathbf{x}}}\left[\operatorname{H}(p,p_{\bm{\theta}})\right]%
\approx\underbrace{\mathbb{E}_{\mathbf{x}\sim p_{data}(x)}\mathbb{E}_{y\sim p(%
y\mid\operatorname{\mathbf{x}})}}_{\mathbb{E}_{(\mathbf{x},y)\sim p_{data}(%
\mathbf{x},y)}}\left[-\log{p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})}%
\right]=\frac{1}{\lvert\operatorname{DS}\rvert}\sum_{i=0}^{\lvert\operatorname%
{DS}\rvert}-\log{p_{\bm{\theta}}(y^{i}\mid\mathbf{x^{i}})}
p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})
\operatorname{SM(\mathbf{z})}:\mathbb{R}^{D_{y}}\to(0,1)^{D_{y}}
\mathbf{z}=g_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}})
g_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}})
p_{\bm{\theta}}(y=i\mid\operatorname{\mathbf{x}})=\operatorname{SM}(\mathbf{z}%
)_{i}=\frac{e^{z_{i}}}{\sum_{j=1}^{D_{y}}e^{z_{j}}}
\operatorname{\mathbf{x}}
c(\mathbf{x})
\mathbf{z}
\operatorname{\mathbf{x}}
y
c(\mathbf{x}):\mathbb{R}^{D_{x}}\to\mathbb{R}
\operatorname{SM}_{i}(\mathbf{z}+c(\mathbf{x}))=\frac{e^{z_{i}+c(\mathbf{x})}}%
{\sum_{j=1}^{D_{y}}e^{z_{j}+c(\mathbf{x})}}=\frac{e^{c(\mathbf{x})}e^{z_{i}}}{%
e^{c(\mathbf{x})}\sum_{j=1}^{D_{y}}e^{z_{j}}}=\operatorname{SM}_{i}(\mathbf{z})
e^{c(\mathbf{x})}
k(\mathbf{x})
p_{\bm{\theta}}(y=i\mid\operatorname{\mathbf{x}})=\frac{e^{c(\mathbf{x})}e^{z_%
{i}}}{e^{c(\mathbf{x})}\sum_{j=1}^{D_{y}}e^{z_{j}}}=\frac{k(\mathbf{x})e^{z_{i%
}}}{k(\mathbf{x})\sum_{j=1}^{D_{y}}e^{z_{j}}}=\frac{\frac{e^{z_{i}}}{k(\mathbf%
{x})}}{\sum_{j=1}^{D_{y}}\frac{e^{z_{j}}}{k(\mathbf{x})}}
p_{\bm{\theta}}(y\mid x)
p_{\bm{\theta}}(y=i\mid\operatorname{\mathbf{x}})=\frac{p_{\bm{\theta}}(%
\mathbf{x},y=i)}{p_{\bm{\theta}}(\mathbf{x})}=\frac{p_{\bm{\theta}}(\mathbf{x}%
,y=i)}{\sum_{y}p_{\bm{\theta}}(\mathbf{x},y=i)}=\frac{\frac{e^{q_{i}}}{Z_{\bm{%
\theta}}}}{\sum_{j=1}^{D_{y}}\frac{e^{q_{j}}}{Z_{\bm{\theta}}}}
\mathbf{z}=\mathbf{q}
k(\operatorname{\mathbf{x}})
\operatorname{\mathbf{x}}
{Z_{\bm{\theta}}}
\operatorname{\mathbf{x}}
y
\log p_{\bm{\theta}}(\mathbf{x},y)
{\log p_{\bm{\theta}}(\mathbf{x})+\log p_{\bm{\theta}}(y\mid\mathbf{x})}
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}})
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}},y)
p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})
p_{\bm{\theta}}(\mathbf{x})
\sum_{y}p_{\bm{\theta}}(\mathbf{x},y)
t
\log p(y\mid\operatorname{\mathbf{x}})
0
1
\operatorname{\mathbf{x}}
\mathbf{X}
p_{\bm{\theta}}
\operatorname{I}(\mathbf{X};\text{Y})=D_{\mathrm{KL}}(p_{\bm{\theta}}(\mathbf{%
x},y)\|p_{\bm{\theta}}(\mathbf{x})p_{\bm{\theta}}(y))=\mathbb{E}_{(\mathbf{x},%
y)\sim p_{\bm{\theta}}(\mathbf{x},y)}\left[\log\left(\frac{p_{\bm{\theta}}(%
\mathbf{x},y)}{p_{\bm{\theta}}(\mathbf{x})p_{\bm{\theta}}(y)}\right)\right]
{\log p_{\bm{\theta}}(\mathbf{x},y)}
\operatorname{L}
-\operatorname{L}=-{\mathbb{E}_{(\mathbf{x},y)\sim p_{data}(\mathbf{x},y)}}%
\left[\log{p_{\bm{\theta}}(\mathbf{x},y)}\right]+\mathbb{E}_{(\mathbf{x},y)%
\sim p_{\bm{\theta}}(\mathbf{x},y)}\left[\log\left(\frac{p_{\bm{\theta}}(%
\mathbf{x},y)}{p_{\bm{\theta}}(\mathbf{x})p_{\bm{\theta}}(y)}\right)\right]
p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})
\mathbf{x}
p(y)
y
\operatorname{I}(\mathbf{X};\text{Y})=\mathbb{E}_{(\mathbf{x},y)\sim p_{\bm{%
\theta}}(\mathbf{x},y)}\left[\log\left(\frac{p_{\bm{\theta}}(y\mid%
\operatorname{\mathbf{x}})}{p_{\bm{\theta}}(y)}\right)\right]=\mathbb{E}_{(%
\mathbf{x},y)\sim p_{\bm{\theta}}(\mathbf{x},y)}\left[\log p_{\bm{\theta}}(y%
\mid\operatorname{\mathbf{x}})\right]+\operatorname{H}(p_{\bm{\theta}}(y))
p_{\bm{\theta}}
p_{data}
\operatorname{L_{a}}
-\operatorname{L_{a}}={\mathbb{E}_{p_{data}}}\left[\log{p_{\bm{\theta}}(%
\mathbf{x},y)}+\log\left(\frac{p_{\bm{\theta}}(\mathbf{x},y)}{p_{\bm{\theta}}(%
\mathbf{x})p_{\bm{\theta}}(y)}\right)\right]={\mathbb{E}_{p_{data}}}\left[\log%
{p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})}+\log{p_{\bm{\theta}}(\mathbf%
{x}\mid y)}\right]
p_{data}=p_{\bm{\theta}}
\mathbb{E}_{p_{data}}\left[\log\left(\frac{p_{\bm{\theta}}(\mathbf{x},y)}{p_{%
\bm{\theta}}(\mathbf{x})p_{\bm{\theta}}(y)}\right)\right]
p_{\operatorname{\bm{\theta}}}(y)
{p_{data}}
{p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})}
p_{\mathbf{\theta}}(\mathbf{x}\mid y)
p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})
p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})
Z_{\theta}
y
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y)
p_{\bm{\theta}}(\mathbf{x}\mid y)
p_{\bm{\theta}}(\mathbf{x}\mid y)=\frac{p_{\bm{\theta}}(\mathbf{x},y)}{\int_{%
\mathbf{x}}p_{\bm{\theta}}(\mathbf{x},y)d\mathbf{x}}=\frac{e^{f_{\bm{\theta}}(%
\mathbf{x})_{y}}}{\int_{\mathbf{x}}e^{f_{\bm{\theta}}(\mathbf{x})_{y}}d\mathbf%
{x}}
\log p_{\bm{\theta}}(\mathbf{x}\mid y)
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y)
\nabla_{\bm{\theta}}\log p_{\bm{\theta}}(\mathbf{x}\mid y)=\nabla_{\bm{\theta}%
}f_{\bm{\theta}}(\mathbf{x})_{y}-\mathbb{E}_{\mathbf{x}\sim p_{\bm{\theta}}(%
\mathbf{x}\mid y)}\left[\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}%
\right]\approx\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}-\frac{1}{N}%
\sum_{i}\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x^{i}})_{y}
q(\mathbf{x})
q{(\operatorname{\mathbf{x}})}
q_{u}(\mathbf{x})
\operatorname{k}
\mathbb{E}_{\mathbf{x}\sim p_{\bm{\theta}}(\mathbf{x}\mid y)}\left[\nabla_{\bm%
{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}\right]=\mathbb{E}_{\mathbf{x}\sim q(%
\mathbf{x})}\left[\frac{p_{\bm{\theta}}(\mathbf{x}\mid y)}{q(\mathbf{x})}%
\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}\right]=\operatorname{k}\>%
\mathbb{E}_{\mathbf{x}\sim q_{u}(\mathbf{x})}\left[p_{\bm{\theta}}(\mathbf{x}%
\mid y)\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}\right]
q_{u}(\mathbf{x})
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y)
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}})
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}},y)
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y)
q_{u}(\mathbf{x})
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y)
\operatorname{k}\mathbb{E}_{\mathbf{x}\sim q_{u}(\mathbf{x})}\left[\frac{p_{%
\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}},y)}{p_{\operatorname{\bm%
{\theta}}}(y)}\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}\right]%
\approx\sum_{i}^{N}\frac{\operatorname{k}\frac{p_{\operatorname{\bm{\theta}}}(%
\mathbf{x^{i}},y)}{p_{\operatorname{\bm{\theta}}}(y)}}{\operatorname{k}\sum_{j%
}^{N}\frac{p_{\operatorname{\bm{\theta}}}(\mathbf{x^{j}},y)}{p_{\operatorname{%
\bm{\theta}}}(y)}}\nabla_{\operatorname{\bm{\theta}}}f_{\operatorname{\bm{%
\theta}}}(\mathbf{x^{i}})_{y}=\sum_{i}^{N}\frac{e^{f_{\bm{\theta}}(\mathbf{x^{%
i}})_{y}}}{\sum_{j}^{N}e^{f_{\bm{\theta}}(\mathbf{x^{j}})_{y}}}\nabla_{%
\operatorname{\bm{\theta}}}f_{\operatorname{\bm{\theta}}}(\mathbf{x^{i}})_{y}
\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}-\nabla_{\bm{\theta}}f_{\bm%
{\theta}}(\mathbf{x})_{y}
\operatorname{\mathbf{x}}
q_{u}(\mathbf{x})
\frac{1}{p_{\bm{\theta}}(\mathbf{x}\mid y)}
y
p_{data}
p_{\bm{\theta}}
p_{data}
p_{\operatorname{\bm{\theta}}}
0
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}\mid y)
\operatorname{\mathbf{x}}
\frac{e^{f_{\bm{\theta}}(\mathbf{x})_{y}}}{\int_{\mathbf{x}}e^{f_{\bm{\theta}}%
(\mathbf{x})_{y}}d\mathbf{x}}
p_{\bm{\theta}}(\mathbf{x}\mid y)
\frac{e^{f_{\bm{\theta}}(\mathbf{x})_{y}}}{\int_{\mathbf{x}}p_{\bm{\theta}}(%
\mathbf{x}\mid y)e^{f_{\bm{\theta}}(\mathbf{x})_{y}}d\mathbf{x}}
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}^{1})\geq p_{%
\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}}^{2})
\operatorname{\mathbf{x}}^{1}
\operatorname{\mathbf{x}}^{2}
\operatorname{\bm{\theta}}
\operatorname{\mathbf{x}}
\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}-\frac{1}{N}\sum_{i}\nabla_%
{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x^{i}})_{y}\;\rightarrow\;\nabla_{\bm{%
\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}-\sum_{i}^{N}\frac{e^{f_{\bm{\theta}}(%
\mathbf{x^{i}})_{y}}}{\sum_{j}^{N}e^{f_{\bm{\theta}}(\mathbf{x^{j}})_{y}}}%
\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x^{i}})_{y}
\mathbb{E}_{p_{data}}\left[\frac{e^{f_{\bm{\theta}}(\mathbf{x})_{y}}}{\int_{%
\mathbf{x}}e^{f_{\bm{\theta}}(\mathbf{x})_{y}}d\mathbf{x}}\right]
0
f_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}},y)
\operatorname*{arg\,max}_{\bm{\theta}}\frac{e^{f_{\bm{\theta}}(\mathbf{x})_{y}%
}}{\int_{\mathbf{x}}e^{f_{\bm{\theta}}(\mathbf{x})_{y}}d\mathbf{x}}=%
\operatorname*{arg\,max}_{\bm{\theta}}\frac{e^{f_{\bm{\theta}}(\mathbf{x})_{y}%
}}{\int_{\mathbf{x}}p_{\bm{\theta}}(\mathbf{x}\mid y)e^{f_{\bm{\theta}}(%
\mathbf{x})_{y}}d\mathbf{x}}
0
\mathbf{X}
\mathbf{X}
q_{u}
p_{\operatorname{\bm{\theta}}}(\operatorname{\mathbf{x}})=0
y
\mathbb{E}_{\mathbf{x}\sim p_{data}(\mathbf{x})}\left[\overbrace{{\sum_{y}p_{%
\bm{\theta}}(y\mid\operatorname{\mathbf{x}})}}^{\text{ replaces }\;p_{data}(y%
\mid\operatorname{\mathbf{x}})}\left[\log{p_{\bm{\theta}}(y\mid\operatorname{%
\mathbf{x}})}+\log{p_{\bm{\theta}}(\mathbf{x}\mid y)}\right]\right]
p(x)
y
p_{\bm{\theta}}
p_{\bm{\theta}}(y)
p_{data}(y)
p_{\bm{\theta}}(\mathbf{x}\mid y)
y
H(y)
y\rightarrow\operatorname{\mathbf{x}}\rightarrow y
p_{\bm{\theta}}(x)
y
-\operatorname{L_{s}}=\mathbb{E}_{y\sim p_{data}(y)}\mathbb{E}_{\mathbf{x}\sim
p%
_{\bm{\theta}}(\mathbf{x}\mid y)}\left[\log\left(\frac{p_{\bm{\theta}}(\mathbf%
{x},y)}{p_{\bm{\theta}}(\mathbf{x})p_{\bm{\theta}}(y)}\right)\right]=\mathbb{E%
}_{y\sim p_{data}(y)}\mathbb{E}_{(\mathbf{x})\sim p_{\bm{\theta}}(\mathbf{x}%
\mid y)}\left[\log p_{\bm{\theta}}(y\mid\operatorname{\mathbf{x}})\right]
21
80
\operatorname{\mathbf{x}}
y
200
21
p_{\operatorname{\bm{\theta}}}(x,y)
\operatorname{\mathbf{x}}
75\%
1-20\%
35-50\%
p(\mathbf{x}|y)
\mathbf{x}
\approx 3000
y
\mathbf{x}\in\mathbb{R}^{80\times 9}
80
9
100
3376
y\in\{0,1,2,\dots 3375\}
\bm{\theta_{1}}
\bm{\theta_{2}}
\bm{\theta_{comb}}
\displaystyle p_{\bm{\theta_{comb}}}(\operatorname{\mathbf{x}},y)=\frac{p_{\bm%
{\theta_{1}}}(\operatorname{\mathbf{x}},y)+p_{\bm{\theta_{2}}}(\operatorname{%
\mathbf{x}},y)}{2}=\frac{e^{f_{\bm{\theta_{1}}}(\mathbf{x})_{y}}}{2Z(\bm{%
\theta_{1}})}+\frac{e^{f_{\bm{\theta_{2}}}(\mathbf{x})_{y}}}{2Z(\bm{\theta_{2}%
})}
\displaystyle p_{\bm{\theta_{comb}}}(\operatorname{\mathbf{x}},y)
\displaystyle=
\displaystyle\frac{p_{\bm{\theta_{1}}}(\operatorname{\mathbf{x}},y)+p_{\bm{%
\theta_{2}}}(\operatorname{\mathbf{x}},y)}{2}
\displaystyle=
\displaystyle\frac{e^{f_{\bm{\theta_{1}}}(\mathbf{x})_{y}}}{2Z(\bm{\theta_{1}}%
)}+\frac{e^{f_{\bm{\theta_{2}}}(\mathbf{x})_{y}}}{2Z(\bm{\theta_{2}})}
p_{\bm{\theta_{comb}}}(\mathbf{x},y)=\frac{p_{\bm{\theta_{1}}}(\mathbf{x})p_{%
\bm{\theta_{1}}}(y|\mathbf{x})+p_{\bm{\theta_{2}}}(\mathbf{x})p_{\bm{\theta_{2%
}}}(y|\mathbf{x})}{2}
p_{\bm{\theta_{comb}}}(\mathbf{x},y)
\mathbf{x}
\mathbf{x}_{test}
p_{\bm{\theta_{1}}}(\mathbf{x}_{test})
p_{\bm{\theta_{2}}}(\mathbf{x}_{test})
\mathbf{x}_{test}
Z(\bm{\theta_{1}})\approx Z(\bm{\theta_{2}})
C
Z(\bm{\theta_{1}})=Z(\bm{\theta_{2}})=C
\displaystyle\log p_{\bm{\theta_{comb}}}(\mathbf{x},y)=\log(e^{f_{\bm{\theta_{%
1}}}(\mathbf{x})_{y}}+e^{f_{\bm{\theta_{2}}}(\mathbf{x})_{y}})-\log 2C
\displaystyle\log p_{\bm{\theta_{comb}}}(\mathbf{x},y)
\displaystyle=
\displaystyle\log(e^{f_{\bm{\theta_{1}}}(\mathbf{x})_{y}}+e^{f_{\bm{\theta_{2}%
}}(\mathbf{x})_{y}})-\log 2C
C
p(y)
\displaystyle\log p_{\bm{\theta_{comb}}}(\mathbf{x}|y)\equiv\log(e^{f_{\bm{%
\theta_{1}}}(\mathbf{x})_{y}}+e^{f_{\bm{\theta_{2}}}(\mathbf{x})_{y}})-\log p(%
y)\text{.}
\displaystyle\log p_{\bm{\theta_{comb}}}(\mathbf{x}|y)
\displaystyle\equiv
\displaystyle\log(e^{f_{\bm{\theta_{1}}}(\mathbf{x})_{y}}+e^{f_{\bm{\theta_{2}%
}}(\mathbf{x})_{y}})-\log p(y)\text{.}
\displaystyle\log p_{\bm{\theta_{comb}}}(\mathbf{x}|y)\equiv\log\sum_{i}\exp e%
^{f_{\bm{\theta_{i}}}(\mathbf{x})_{y}}-\log p(y)
\displaystyle\log p_{\bm{\theta_{comb}}}(\mathbf{x}|y)
\displaystyle\equiv
\displaystyle\log\sum_{i}\exp e^{f_{\bm{\theta_{i}}}(\mathbf{x})_{y}}-\log p(y)
\operatorname{\mathbf{x}}
ph
\operatorname{\mathbf{x}}
spk
21
\log p_{\bm{\theta}}(\mathbf{x}\mid y)
\nabla_{\bm{\theta}}\log p_{\bm{\theta}}(\mathbf{x}\mid y)=\nabla_{\bm{\theta}%
}f_{\bm{\theta}}(\mathbf{x})_{y}-\nabla_{\bm{\theta}}\log{\int_{\mathbf{x}}e^{%
f_{\bm{\theta}}(\mathbf{x})_{y}}d\mathbf{x}}=\nabla_{\bm{\theta}}f_{\bm{\theta%
}}(\mathbf{x})_{y}-\mathbb{E}_{\mathbf{x}\sim p_{\bm{\theta}}(\mathbf{x}\mid y%
)}\left[\nabla_{\bm{\theta}}f_{\bm{\theta}}(\mathbf{x})_{y}\right]
\begin{split}\nabla_{\bm{\theta}}\log{\int_{\mathbf{x}}e^{f_{\bm{\theta}}(%
\mathbf{x})_{y}d\mathbf{x}}}&=\frac{{\int_{\mathbf{x}}e^{f_{\bm{\theta}}(%
\mathbf{x})_{y}}\nabla_{\bm{\theta}}f_{\bm{\theta}(\mathbf{x})_{y}}d\mathbf{x}%
}}{{\int_{\mathbf{x}}e^{f_{\bm{\theta}}(\mathbf{x})_{y}}d\mathbf{x}}}=\int_{%
\mathbf{x}}\frac{e^{f_{\bm{\theta}}(\mathbf{x})_{y}}}{Z_{\bm{\theta}}}\frac{%
\nabla_{\bm{\theta}}f_{\bm{\theta}(\mathbf{x})_{y}}}{p_{\bm{\theta}}(y)}d%
\mathbf{x}\\
&=\int_{\mathbf{x}}\frac{p_{\bm{\theta}}(\mathbf{x},y)}{p_{\bm{\theta}}(y)}%
\nabla_{\bm{\theta}}f_{\bm{\theta}(\mathbf{x})_{y}}=\mathbb{E}_{\mathbf{x}\sim
p%
_{\bm{\theta}}(\mathbf{x}\mid y)}\left[\nabla_{\bm{\theta}}f_{\bm{\theta}}(%
\mathbf{x})_{y}\right]\end{split}
