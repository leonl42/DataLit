e.g.
\mathbf{C}
\mathbf{F}
\mathbf{C}
\mathbf{D}
[cos(\theta_{y_{i}}+m)-argmax(cos\theta_{j\neq y_{i}})]
y_{i}
[cos(\theta_{y_{i}}+m)-argmax(cos\theta_{j\neq y_{i}})]
y_{i}
\mathbf{C}
\mathbf{F}
\mathbf{C}
\mathbf{D}
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\bullet
\mathcal{R}
\mathcal{R}
E
E
E
E
F^{l}\in\mathbb{R}^{d_{c}\times d_{w}\times d_{h}}
d_{c}
d_{w}
d_{h}
F^{g}\in\mathbb{R}^{d_{g}}
d_{g}
E
F^{l}
E
x_{i}
i
N
y_{i}
\ell_{2}
i.e.
m_{1}
m_{2}
m_{3}
\theta_{y_{i}}
cos\theta_{y_{i}}
\small\mathcal{L}=-\frac{1}{N}\sum_{i=1}^{N}log\frac{e^{s(cos(m_{1}\theta_{y_{%
i}}+m_{2})-m_{3})}}{e^{s(cos(m_{1}\theta_{y_{i}}+m_{2})-m_{3})}+B_{i}},
s
B_{i}=\sum_{j=1,j\neq y_{i}}^{n}e^{s\,cos\theta_{j}}
m_{2}
cos\theta_{y_{i}}
\theta_{y_{i}}
cos\theta_{y_{i}}
cos\theta_{y_{i}}
m_{3}
m_{2}
m_{3}
\small P_{i,y_{i}}=\frac{e^{s(cos\theta_{y_{i}}-m)}}{e^{s(cos\theta_{y_{i}}-m)%
}+B_{i}},
P_{i,y_{i}}
x_{i}
y_{i}
cos_{m}\theta
y_{k}
cos_{m}\theta
-log(P)
P(cos_{m}\theta)
s
m
P(cos_{m}\theta)
\rho
\rho
\theta_{i,y_{i}}
P(cos_{m}\theta)=\rho
s
m
\rho
\small\frac{e^{s(cos_{m}\theta-m)}}{e^{s(cos_{m}\theta-m)}+\tilde{B}}=\rho,
m
s
s
e.g.
s=10
P_{i,y_{i}}
\theta_{y_{i}}
P_{i,y_{i}}
\theta_{y_{i}}
\small\frac{e^{s(1-m)}}{e^{s(1-m)}+\tilde{B}}=1-\epsilon,
\tilde{B}=\sum_{j=1,j\neq y_{k}}^{n}e^{s\,cos\theta_{j}}
\epsilon=e^{-7}
s
m
cos\theta_{y_{i}}
[cos\theta_{y_{i}}-argmax(cos\theta_{j\neq y_{i}})]
x_{i}
i
y_{i}
N
cos\theta_{y_{i}}
s
m
cos_{m}\theta=Median\{cos\theta_{y_{0}},cos\theta_{y_{1}},\ldots,cos\theta_{y_%
{N-1}}\}
cos_{m}\theta
s
s=\frac{log((1-\epsilon)(1-\rho)/(\rho\epsilon))}{1-cos_{m}\theta}
cos_{m}\theta
y_{k}
s
\tilde{B}_{k}=\sum_{j\neq y_{k}}^{n}e^{s\,cos\theta_{j}}
m
s
\tilde{B}_{k}
m=cos_{m}\theta-\frac{log(\rho\tilde{B}_{k}/(1-\rho))}{s}
\mathcal{L}_{mda}
m
s
\mathcal{L}_{mda}=-\frac{1}{N}\sum_{i=1}^{N}log\frac{e^{s(cos\theta_{y_{i}}-m)%
}}{e^{s(cos\theta_{y_{i}}-m)}+B_{i}}
\mathcal{L}_{mda}
f\in\mathbb{R}^{d_{c}}
F^{l}
F^{l}
Z=d_{w}\times d_{h}
\mathcal{F}=\{f_{i}\in\mathbb{R}^{d_{c}}:i\in 1\ldots Z\}
\eta(f,\mathcal{F})=argmin_{\forall f_{i}\in\mathcal{F}}||f-f_{i}||_{2}
f
\mathcal{F}
\psi(\tau,\mathcal{F})=\{argmax^{\tau}_{\forall f_{i}\in\mathcal{F}}||f_{i}||\}
\tau
l_{1}
\tau
x_{a},x_{p}
F_{a}^{l}
F_{p}^{l}
v\in\mathcal{F}
(v_{a},v_{p})
(v_{a},v_{p})
\psi(\tau,\mathcal{F})
\mathcal{M}
\small(v_{a},v_{p})\in\mathcal{M}\Longleftrightarrow\begin{cases}v_{a}=\eta(v_%
{p},\psi(\tau,F_{a}^{l}))\\
v_{p}=\eta(v_{a},\psi(\tau,F_{p}^{l}))\end{cases}
\mathcal{M}
Q
x_{n_{j}},j=1,\ldots,Q
v_{n_{j}}=\eta(v_{a},F_{n_{j}}^{l})
x_{n_{j}}
\small\mathcal{L}_{trip}=\sum_{\tiny{(v_{a},v_{p})\in\mathcal{M}}}\sum_{j=1}^{%
Q}\{||v_{a}-v_{p}||_{2}^{2}-||v_{a}-v_{n_{j}}||_{2}^{2}+\mu\}^{+},
\mu=0.1
Q=6
\mathcal{L}_{tot}
\mathcal{L}_{mda}
\mathcal{L}_{trip}
\small\mathcal{L}_{tot}=\mathcal{L}_{mda}+\lambda\mathcal{L}_{trip},
\lambda
x_{a}
C
P(x_{a})
I(C)
I(\tilde{C})
C
\tilde{C}
P(x_{a})=C
I(C)
x_{n}\in I(\tilde{C})
P(x_{a})\neq C
I(C)
P(x_{p})=C
x_{n}\in I(\tilde{C})
x_{a}
C
P(x_{a})
I(C)
I(\tilde{C})
C
\tilde{C}
P(x_{a})=C
I(C)
x_{n}\in I(\tilde{C})
P(x_{a})\neq C
I(C)
P(x_{p})=C
x_{n}\in I(\tilde{C})
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
Local\ features\ aggregation\ +\ re
ranking
\mathbf{81.80}
\mathbf{66.50}
\mathbf{85.30}
\mathbf{67.60}
\mathbf{61.20}
\mathbf{40.10}
\mathbf{70.00}
\mathbf{42.90}
Global\ features\ +\ Local\ feature\ re
ranking
\mathbf{87.90}
\mathbf{81.90}
\mathbf{91.20}
\mathbf{83.80}
\mathbf{75.90}
\mathbf{67.40}
\mathbf{81.10}
\mathbf{69.30}
Global\ features
\mathbf{81.97}
\mathbf{63.76}
\mathbf{74.00}
\mathbf{90.30}
\mathbf{80.60}
\mathbf{53.70}
\mathbf{79.10}
\mathbf{62.20}
\mathbf{82.51}
\mathbf{72.73}
\mathbf{89.64}
\mathbf{78.91}
\mathbf{63.59}
\mathbf{48.54}
\mathbf{78.06}
\mathbf{60.09}
\mathbf{84.08}
\mathbf{74.66}
\mathbf{91.03}
\mathbf{82.18}
\mathbf{67.80}
\mathbf{54.10}
\mathbf{81.21}
\mathbf{65.51}
\mathbf{82.42}
\mathbf{73.06}
\mathbf{91.57}
\mathbf{81.57}
\mathbf{65.06}
\mathbf{50.78}
\mathbf{81.69}
\mathbf{62.80}
\mathbf{85.24}
\mathbf{73.99}
\mathbf{91.56}
\mathbf{82.80}
\mathbf{69.96}
\mathbf{52.78}
\mathbf{81.78}
\mathbf{65.78}
\mathcal{R}
\mathcal{R}
*
\mathcal{R}
\mathcal{R}
*
80\%
20\%
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
\times
T
E
E
T-E
\boldsymbol{p}
\ell_{2}
\ell_{2}
T
E
\boldsymbol{d_{g}}
\{\frac{1}{2\sqrt{2}},\frac{1}{2},\frac{1}{\sqrt{2}},1,\sqrt{2}\}
T
E
\boldsymbol{d_{g}}
\{\frac{1}{\sqrt{2}},1,\sqrt{2}\}
\%
\mathcal{R}
\%
\mathcal{R}
\%
\mathcal{R}
\%
\mathcal{R}
\%
\%
\mathcal{R}
\mathcal{R}
\{\frac{1}{2\sqrt{2}},\frac{1}{2},\frac{1}{\sqrt{2}},1,\sqrt{2}\}
\boldsymbol{d_{g}}
\#
E
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\mathbf{82.42}
\mathbf{91.57}
\mathbf{65.06}
\mathbf{81.69}
E
E
\rho
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathbf{81.78}
\mathbf{90.60}
\mathbf{79.94}
\mathbf{64.90}
\rho
\rho
\rho=0.02
\rho=0.02
m
s
\%
\%
\mathcal{R}
\%
\%
\mathcal{R}
\%
\%
\mathcal{R}
\%
\%
\mathcal{R}
\rho
s
m
\rho
\rho
\rho
\rho=0.02
s
m
s
m
s=48.33,m=0.33
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
Res4
Res4
\mathbf{82.42}
\mathbf{91.57}
\mathbf{65.06}
\mathbf{81.69}
Res4
Res4
Res4
\tau
Res4
\tau
\tau
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathbf{82.42}
\mathbf{91.57}
\mathbf{81.69}
\mathbf{65.10}
\tau
\tau
\mathbf{C}
\mathbf{F}
\mathbf{C}
\mathbf{D}
E
E
I(C)
I(\tilde{C})
C
\tilde{C}
C
x_{a}
C
P(x_{a})
P(x_{a})=C
x_{p}
I(C)
Q
I(\tilde{C})
P(x_{n})=\tilde{C}
P(x_{n})=C
x_{n}
P(x_{a})\neq C
I(C)
P(x_{p})=C
x_{a}
x_{p}
I(\tilde{C})
P(x_{n})=\{\tilde{C}-P(x_{a})
P(x_{n})=C
P(x_{n})=P(x_{a})
X
G
P
E
x\Leftarrow I
x
I
rand()
[0,1]
Q
\mathcal{C}_{n}
Y
X\neq\varnothing
C
\mathcal{C}_{n}
I(C)=\{\forall x\in X\quad s.t.\quad G(x)=C\}
I(\tilde{C})=X-I(C)
x_{a}\Leftarrow I(C)
P(x_{a})=C
x_{p}\Leftarrow I(C)
j=1
Q
rand()\leq
x_{n_{j}}\Leftarrow I(\tilde{C})\quad s.t.\quad P(x_{n_{j}})=C
x_{n_{j}}\Leftarrow I(\tilde{C})\quad s.t.\quad P(x_{n_{j}})=\tilde{C}
x_{p}\Leftarrow I(C)\quad s.t.\quad P(x_{p})=C
j=1
Q
rand()\leq\frac{1}{3}
x_{n_{j}}\Leftarrow I(\tilde{C})\quad s.t.\quad P(x_{n_{j}})=C
rand()\geq\frac{2}{3}
x_{n_{j}}\Leftarrow I(\tilde{C})\quad s.t.\quad P(x_{n_{j}})=P(x_{a})
x_{n_{j}}\Leftarrow I(\tilde{C})\quad s.t.\quad P(x_{n_{j}})=\{\tilde{C}-P(x_{%
a})\}
Y.
\{x_{a},x_{p},x_{n_{1}},\dots,x_{n_{Q}}\}
Y
112\times 112
s
m
\rho
\%
\%
\rho
\rho
\rho
\rho
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
\rho
\rho
Q
\mu
Q
\mu
Q
\mu
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
Q
\mu
Q
\mu
th
th
E
T
\mathcal{R}
\mathcal{R}
\mathcal{R}
\mathcal{R}
E
T
E=T
E
T
E=T
\%
\%
\mathbf{33.60}
\mathbf{30.93}
\mathcal{R}
\mathcal{R}
\mathcal{R}
