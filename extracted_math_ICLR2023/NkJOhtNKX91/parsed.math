D(x,y)
(x,y)
(x,y)
G(x,y)=\begin{cases}0,&if(x,y)\in\emph{fake face region}\\
\Omega(D(x,y)+\lambda),&\emph{otherwise},\end{cases}
\Omega
\lambda
\lambda
\lambda
255
G(x,y)
P
T
P
F_{rgb}
F_{d}
F_{rgb}
F_{d}
F_{rd}=(F_{d}W^{D})\cdot(F_{rgb}W^{R}),
W^{R}
W^{D}
\cdot
F_{rd}
A_{rd}=softmax(\frac{F_{rd}}{\sqrt{d}}),
d
F^{\prime}_{rgb}=A_{rd}\odot(F_{rgb}W^{V}),
W^{V}
\odot
F_{en}=F_{rgb}+\text{MLP}(F^{\prime}_{rgb}+F_{rgb}).
l
\text{MultiHead}(F_{d}W^{D},F_{rgb}W^{R},F_{rgb}W^{V})=\\
\text{Concat}(d_{1},d_{2},\dots,d_{l})W^{O},
d_{i}
i
F_{d}W^{D}
F_{rgb}W^{R}
F_{rgb}W^{V}
F_{en}
W^{O}
F_{d}
F_{rgb}
\mathcal{L}_{ssim}=\frac{(2\mu_{a}\mu_{b}+c_{1})(2\sigma_{ab}+c_{2})}{(\mu_{a}%
^{2}+\mu_{b}^{2}+c_{1})(\sigma_{a}^{2}+\sigma_{b}^{2}+c_{2})},
\mu_{a}
\mu_{b}
\sigma_{a}^{2}
\sigma_{b}^{2}
\sigma_{ab}
c_{1}
c_{2}
\mathcal{L}_{patch\_mse}=\sum_{i=1}^{M}\sum_{p=1}^{P}{||a_{i,p}-b_{i,p}||_{2}},
a_{i,p}
b_{i,p}
p
i
\mathcal{L}_{total}=\mathcal{L}_{c}+\alpha\cdot\mathcal{L}_{ssim}+\beta\cdot%
\mathcal{L}_{patch\_mse},
\mathcal{L}_{c}
\alpha
\beta
224\times 224
\lambda=50
[0,1]
T=12
P=14\times 14
\alpha
\beta
0.7
3\times 10^{-4}
10^{-4}
32
1.97\%
1.75\%
1.66\%
1.89\%
3.36\%
3.79\%
5.34\%
5.75\%
2.39\%
