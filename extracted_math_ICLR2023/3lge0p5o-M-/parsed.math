\rightarrow
T
\mathcal{L}=\displaystyle\mathbb{E}_{\mathbf{x}_{0},t,\bm{\epsilon}}\|\bm{%
\epsilon}-\epsilon_{\theta}(\mathbf{x}_{t},t)\|_{2}^{2},
\epsilon_{\theta}
\bm{\epsilon}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\mathbf{x}_{0}
\mathbf{x}_{t}=\sqrt{\alpha_{t}}\mathbf{x}_{0}+\sqrt{1-\alpha_{t}}\bm{\epsilon}
\alpha_{t}
t
\alpha_{0}=1
\alpha_{T}\approx 0
\epsilon_{\theta}
\mathbf{x}_{T}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\mathbf{x}_{t-1}=\sqrt{\alpha_{t-1}}\bigg{(}\frac{\mathbf{x}_{t}-\sqrt{1-%
\alpha_{t}}\epsilon_{\theta}(\mathbf{x}_{t},t)}{\sqrt{\alpha_{t}}}\bigg{)}+%
\sqrt{1-\alpha_{t-1}}\epsilon_{\theta}(\mathbf{x}_{t},t).
\mathbf{x}
\epsilon_{\theta}
\mathbf{u}=\mathbf{x}/\sqrt{\alpha}
\tau=\sqrt{1/\alpha-1}
d\mathbf{u}=\epsilon_{\theta}(\frac{\mathbf{u}}{\sqrt{1+\tau^{2}}},t)d\tau.
\mathbf{u}(t=T)\sim\mathcal{N}(\mathbf{0},\alpha_{T}\mathbf{I})
T
t
t=1
T
\mathbf{x}_{0}
\mathbf{x}_{r}
r\leq 1
\mathbf{u}(t=0)=\mathbf{x}_{0}
\mathbf{u}(t=1)
r
\mathbf{x}_{0}
\mathbf{x}_{r}
E_{r}
r
\mathbf{x}_{r}
\mathbf{x}_{0}
\mathbf{x}_{0}
\mathbf{x}_{r}
Q=\emptyset
n
n\!=\!10
[0,1]
\mathbf{x}_{0}
r
E_{r}
\emptyset
\mathbf{x}_{r}
Q
M
M
\mathbf{x}_{t}
\mathbf{x}_{0}
\mathbf{\tilde{y}}_{t}=M\mathbf{y}_{t}+(1-M)\mathbf{x}_{t}
\mathbf{y}_{t}
\mathbf{y}_{t-dt}
\mathbf{x}_{t}
r
r
\mathbf{x}_{r}
\mathbf{x}_{0}
\mathbf{x}_{r}
\mathbf{x}_{0}
Q
\epsilon_{\theta}
\epsilon_{\theta}(\cdot,Q)
\mathbf{x}_{r}
E_{r}(\mathbf{x}_{0})
G_{r}(\mathbf{x}_{0},\epsilon):=\sqrt{\alpha_{r}}\mathbf{x}_{0}+\sqrt{1-\alpha%
_{r}}\epsilon
\mathbf{x}_{0}
\mathcal{X}=\mathbb{R}^{d}
p_{D}
(\mathbf{x}_{0},Q)
\mathbf{x}_{0}\in\mathcal{X}
Q
\|\epsilon_{\theta}(\mathbf{x}_{t},Q,t)\|_{2}\leq C
x\in\mathcal{X}
t\in[0,1]
\epsilon_{\theta}(\cdot,\emptyset,t)
K_{1}
t
K_{2}=\mathbb{E}_{(\mathbf{x}_{0},Q)\in p_{D}}\max_{t\in[0,1]}\|\epsilon_{%
\theta}(\mathbf{x},Q,t)-\epsilon_{\theta}(\mathbf{x},\emptyset,t)\|
0\leq r\leq 1
\displaystyle\mathop{\mathbb{E}}_{\begin{subarray}{c}(\mathbf{x}_{0},Q)\sim p_%
{D}\\
\epsilon\sim\mathcal{N}(0,1)\end{subarray}}\|\mathbf{x}_{0}-D_{r}(G_{r}(%
\mathbf{x}_{0},\epsilon),Q)\|_{2}\leq(C+1)\tau,
\displaystyle\displaystyle\mathop{\mathbb{E}}_{\begin{subarray}{c}(\mathbf{x}_%
{0},Q)\sim p_{D}\\
\epsilon\sim\mathcal{N}(0,1)\end{subarray}}\|\mathbf{x}_{0}-D_{r}(G_{r}(%
\mathbf{x}_{0},\epsilon),Q)\|_{2}
\displaystyle\leq(C+1)\tau,
\displaystyle\mathop{\mathbb{E}}_{\begin{subarray}{c}(\mathbf{x}_{0},Q)\sim p_%
{D}\end{subarray}}\|\mathbf{x}_{0}-D_{r}(E_{r}(\mathbf{x}_{0}),Q)\|_{2}\leq%
\frac{K_{2}\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}+1}\Big{)}^{K_{1}},
\displaystyle\displaystyle\mathop{\mathbb{E}}_{\begin{subarray}{c}(\mathbf{x}_%
{0},Q)\sim p_{D}\end{subarray}}\|\mathbf{x}_{0}-D_{r}(E_{r}(\mathbf{x}_{0}),Q)%
\|_{2}
\displaystyle\leq\frac{K_{2}\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}%
+1}\Big{)}^{K_{1}},
\tau=\sqrt{1/\alpha_{r}-1}
r
\tau(r=0)=0
\lim_{r\rightarrow 1}\tau=+\infty
C\!=\!1,K_{2}\!=\!0.02,
K_{1}\!=\!3
C\!=\!1,K_{2}\!=\!0.02,
K_{1}\!=\!3
K_{1},K_{2}
C
K_{1}>1
K_{2}
K_{2}
\epsilon_{\theta}(\cdot,Q,\cdot)
\mathbf{y}_{r},...,\mathbf{y}_{0}
x_{r},\dots,D_{r}(x_{r})\approx\mathbf{x}_{0}
\mathbf{x}_{r}
\mathbf{x}_{0}
256\!\times\!256
512\!\times\!512
32\!\times\!32
64\!\times\!64
\sim
\mathbf{\tilde{y}}_{t}\!=\!M\mathbf{y}_{t}\!+\!(1-M)\mathbf{x}_{t}
\mathbf{y}_{t}
\hat{\mathbf{y}}_{0}
|
|
|
|
|
|
|
|
|
|
|
\emptyset
25\%
0.25
\epsilon_{\theta}
t
\epsilon_{\theta}(\mathbf{x}_{t},Q,t)
\epsilon_{\theta}(\mathbf{x}_{t},\emptyset,t)
\epsilon=\epsilon_{\theta}(\mathbf{x}_{t},\emptyset,t)+\lambda(\epsilon_{%
\theta}(\mathbf{x}_{t},Q,t)-\epsilon_{\theta}(\mathbf{x}_{t},\emptyset,t)),
\lambda
\lambda=5
25\%
30\%
80\%
60\%-70\%
\rightarrow
\|\epsilon_{\theta}(\mathbf{x},Q,t)\|_{2}\leq C
x\in\mathcal{X}
t\in[0,1]
\displaystyle\mathop{\mathbb{E}}_{\begin{subarray}{c}(\mathbf{x}_{0},Q)\sim p_%
{D}\\
\epsilon\sim\mathcal{N}(0,1)\end{subarray}}\|\mathbf{x}_{0}-D_{r}(G_{r}(%
\mathbf{x}_{0},\epsilon),Q)\|_{2}\leq(C+1)\tau
T
\mathbf{x}_{r}=G_{r}(\mathbf{x}_{0},\epsilon)
\mathbf{y}_{r}=\mathbf{x}_{r}
\mathbf{y}_{0}=D_{r}(\mathbf{y}_{r},Q)
\displaystyle\|\frac{\mathbf{x}_{r}}{\sqrt{\alpha_{r}}}-\mathbf{y}_{0}\|=\|%
\frac{\mathbf{y}_{r}}{\sqrt{\alpha_{r}}}-\frac{\mathbf{y}_{0}}{\sqrt{\alpha_{0%
}}}\|=\|\int_{\tau}^{0}\epsilon_{\theta}(x_{t},Q,t)d\tau\|\leq C\tau.
\displaystyle\|\frac{\mathbf{x}_{r}}{\sqrt{\alpha_{r}}}-\mathbf{y}_{0}\|
\displaystyle=\|\frac{\mathbf{y}_{r}}{\sqrt{\alpha_{r}}}-\frac{\mathbf{y}_{0}}%
{\sqrt{\alpha_{0}}}\|=\|\int_{\tau}^{0}\epsilon_{\theta}(x_{t},Q,t)d\tau\|\leq
C\tau.
\frac{\mathbf{x}_{r}}{\sqrt{\alpha_{r}}}=\mathbf{x}_{0}+\tau\epsilon
\|\mathbf{x}_{0}-\mathbf{y}_{0}\|\leq\|\mathbf{x}_{0}+\tau\epsilon-\mathbf{y}_%
{0}\|+\|\tau\epsilon\|\leq C\tau+\tau
\epsilon_{\theta}(\cdot,Q,t)
K_{1}
\kappa_{2}
\displaystyle\kappa_{2}(\mathbf{x}_{0})=\max_{t\in[0,1]}\|\epsilon_{\theta}(E_%
{t}(\mathbf{x}_{0}),Q,t)-\epsilon_{\theta}(E_{t}(\mathbf{x}_{0}),\emptyset,t)\|
\displaystyle\kappa_{2}(\mathbf{x}_{0})
\displaystyle=\max_{t\in[0,1]}\|\epsilon_{\theta}(E_{t}(\mathbf{x}_{0}),Q,t)-%
\epsilon_{\theta}(E_{t}(\mathbf{x}_{0}),\emptyset,t)\|
K_{2}=\mathbb{E}_{\mathbf{x}_{0}}\kappa_{2}(\mathbf{x}_{0})
r
\tau=\sqrt{\alpha_{r}^{-1}-1}
\displaystyle\mathbb{E}_{\mathbf{x}_{0}}\|\mathbf{x}_{0}-D_{r}(E_{r}(\mathbf{x%
}_{0}),Q)\|\leq\frac{K_{2}\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}+1%
}\Big{)}^{K_{1}}
\displaystyle\mathbb{E}_{\mathbf{x}_{0}}\|\mathbf{x}_{0}-D_{r}(E_{r}(\mathbf{x%
}_{0}),Q)\|
\displaystyle\leq\frac{K_{2}\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}%
+1}\Big{)}^{K_{1}}
\sigma
\sigma(t)=\sqrt{\alpha_{t}^{-1}-1}
\mathbf{u}=\mathbf{x}/\sqrt{\alpha}=\mathbf{x}\sqrt{1+\sigma^{2}}
\mathbf{v}=\mathbf{y}\sqrt{1+\sigma^{2}}
\mathbf{u}
\mathbf{v}
\displaystyle d\mathbf{u}|_{t}=\epsilon_{\theta}(\mathbf{u}/\sqrt{1+\sigma^{2}%
},\emptyset,t)d\sigma,
\displaystyle d\mathbf{u}|_{t}
\displaystyle=\epsilon_{\theta}(\mathbf{u}/\sqrt{1+\sigma^{2}},\emptyset,t)d\sigma,
\displaystyle d\mathbf{v}|_{t}=\epsilon_{\theta}(\mathbf{v}/\sqrt{1+\sigma^{2}%
},Q,t)d\sigma,
\displaystyle d\mathbf{v}|_{t}
\displaystyle=\epsilon_{\theta}(\mathbf{v}/\sqrt{1+\sigma^{2}},Q,t)d\sigma,
\displaystyle\mathbf{u}(r)=\mathbf{v}(r)=E_{r}(\mathbf{x}_{0})\sqrt{1+\sigma^{%
2}}.
\displaystyle\mathbf{u}(r)
\displaystyle=\mathbf{v}(r)=E_{r}(\mathbf{x}_{0})\sqrt{1+\sigma^{2}}.
\mathbf{w}=\|\mathbf{u}-\mathbf{v}\|
\mathbf{w}|_{t=r}=0
\displaystyle d\mathbf{w}|_{t}\leq\|d\mathbf{u}|_{t}-d\mathbf{v}|_{t}\|=\|(%
\epsilon_{\theta}(\mathbf{x},\emptyset,t)-\epsilon_{\theta}(\mathbf{y},Q,t))d\sigma\|
\displaystyle d\mathbf{w}|_{t}\leq\|d\mathbf{u}|_{t}-d\mathbf{v}|_{t}\|
\displaystyle=\|(\epsilon_{\theta}(\mathbf{x},\emptyset,t)-\epsilon_{\theta}(%
\mathbf{y},Q,t))d\sigma\|
\displaystyle\leq\|(\epsilon_{\theta}(\mathbf{x},\emptyset,t)-\epsilon_{\theta%
}(\mathbf{x},Q,t)\|d\sigma+\|(\epsilon_{\theta}(\mathbf{x},Q,t)-\epsilon_{%
\theta}(\mathbf{y},Q,t)\|d\sigma
\displaystyle\leq\|(\epsilon_{\theta}(\mathbf{x},\emptyset,t)-\epsilon_{\theta%
}(\mathbf{x},Q,t)\|d\sigma+\|(\epsilon_{\theta}(\mathbf{x},Q,t)-\epsilon_{%
\theta}(\mathbf{y},Q,t)\|d\sigma
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})d\sigma+K_{1}\|\mathbf{x}-\mathbf{y%
}\|d\sigma
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})d\sigma+K_{1}\|\mathbf{x}-\mathbf{y%
}\|d\sigma
\displaystyle\leq\Big{(}\kappa_{2}(\mathbf{x}_{0})+\frac{K_{1}}{\sqrt{1+\sigma%
^{2}}}\bm{w}\Big{)}d\sigma.
\displaystyle\leq\Big{(}\kappa_{2}(\mathbf{x}_{0})+\frac{K_{1}}{\sqrt{1+\sigma%
^{2}}}\bm{w}\Big{)}d\sigma.
\bm{w}(t)\leq\kappa_{2}(\mathbf{x}_{0})*(\tau-t)+\int_{t}^{\tau}\frac{K_{1}}{%
\sqrt{1+\sigma^{2}}}\bm{w}(\sigma)d\sigma.
\displaystyle\bm{w}(0)\leq\kappa_{2}(\mathbf{x}_{0})\tau\exp\Big{(}\int_{0}^{%
\tau}\frac{K_{1}}{\sqrt{1+s^{2}}}ds\Big{)}
\displaystyle\bm{w}(0)
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})\tau\exp\Big{(}\int_{0}^{\tau}\frac%
{K_{1}}{\sqrt{1+s^{2}}}ds\Big{)}
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})\tau\exp\Big{(}K_{1}\log(\tau+\sqrt%
{\tau^{2}+1})\Big{)}
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})\tau\exp\Big{(}K_{1}\log(\tau+\sqrt%
{\tau^{2}+1})\Big{)}
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})\tau\Big{(}\tau+\sqrt{\tau^{2}+1}%
\Big{)}^{K_{1}}.
\displaystyle\leq\kappa_{2}(\mathbf{x}_{0})\tau\Big{(}\tau+\sqrt{\tau^{2}+1}%
\Big{)}^{K_{1}}.
\displaystyle\|\mathbf{x}_{0}-\mathbf{y}_{0}\|\leq\frac{\kappa_{2}(\mathbf{x}_%
{0})\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}+1}\Big{)}^{K_{1}}.
\displaystyle\|\mathbf{x}_{0}-\mathbf{y}_{0}\|
\displaystyle\leq\frac{\kappa_{2}(\mathbf{x}_{0})\tau}{\sqrt{\tau^{2}+1}}\Big{%
(}\tau+\sqrt{\tau^{2}+1}\Big{)}^{K_{1}}.
\mathbf{x}_{0}
\displaystyle\mathbb{E}_{\mathbf{x}_{0}}\|\mathbf{x}_{0}-D_{T}(E_{T}(\mathbf{x%
}_{0}),Q)\|\leq\frac{K_{2}\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}+1%
}\Big{)}^{K_{1}}
\displaystyle\mathbb{E}_{\mathbf{x}_{0}}\|\mathbf{x}_{0}-D_{T}(E_{T}(\mathbf{x%
}_{0}),Q)\|
\displaystyle\leq\frac{K_{2}\tau}{\sqrt{\tau^{2}+1}}\Big{(}\tau+\sqrt{\tau^{2}%
+1}\Big{)}^{K_{1}}
E_{r}
p_{0}=p_{D}
p_{r}
r
E_{r}
p_{0}
p_{r}
\mathbb{E}_{\mathbf{x}_{0}}\|\mathbf{x}_{0}-E_{r}(\mathbf{x}_{0})\|_{2}^{2}
p_{r}
D_{r}=E_{r}^{-1}
p_{r}
p_{0}
D_{r}(\cdot,Q)
p_{r}(\cdot|Q)
p_{0}(\cdot|Q)
Q
p_{r}
p_{r}(\cdot|Q)
E_{r}
D_{r}(\cdot,Q)
p_{0}
p_{r}
p_{r}\simeq p_{r}(\cdot|Q)
p_{0}(\cdot|Q)
p_{1}
p_{2}
f
\displaystyle f=\operatorname*{arg\,min}_{f}\mathbb{E}_{\mathbf{x}}\|\mathbf{x%
}-f(\mathbf{x})\|\quad\text{s.t.}\quad p_{2}=f_{\#}p_{1},
\displaystyle f=\operatorname*{arg\,min}_{f}\mathbb{E}_{\mathbf{x}}\|\mathbf{x%
}-f(\mathbf{x})\|\quad\text{s.t.}\quad p_{2}=f_{\#}p_{1},
f_{\#}
D_{r}(\cdot,Q)\circ E_{r}
E_{r}
E_{r}
D_{r}(\cdot,Q)\circ E_{r}
