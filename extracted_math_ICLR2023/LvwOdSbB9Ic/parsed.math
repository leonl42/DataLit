\min_{x\in\mathbb{R}^{d}}f(x)\stackrel{{\scriptstyle\text{def}}}{{=}}\frac{1}{%
n}\sum_{i=1}^{n}f_{i}(x)
f_{i}:\mathbb{R}^{d}\rightarrow\mathbb{R}
n
f_{i}
i
f_{i}
i
f_{i}
s
x=\arg\min\{f(x-\alpha s),f(x+\alpha s),f(x)\}
\alpha>0
f
{\cal D}
\mathbb{R}^{d}
\mathbf{E}\left[\cdot\right]
\mathbf{E}_{\xi}\left[\cdot\right]
\xi
\mathbf{E}[X|Y]
\left\langle x,y\right\rangle=x^{\top}y
x
y
\|\cdot\|_{2}
\ell_{2}
\|\cdot\|_{\cal D}
{\cal D}
f_{\mathcal{B}}
{f}_{\mathcal{B}}(x)=\frac{1}{|\mathcal{B}|}\sum_{i\in\mathcal{B}}f_{i}(x),
\mathcal{B}
[1,2,\ldots,n]
|\mathcal{B}|
x_{0}\in\mathbb{R}^{d}
\{\alpha_{k}\}_{k\geq 0}
{\cal D}
\mathbb{R}^{d}
k=0,1,2,\ldots
k=0,1,2,\ldots
s_{k}\sim{\cal D}
\mathcal{B}_{k}
x_{+}=x_{k}+\alpha_{k}s_{k}
x_{-}=x_{k}-\alpha_{k}s_{k}
x_{k+1}=\arg\min\{f_{\mathcal{B}_{k}}(x_{-}),f_{\mathcal{B}_{k}}(x_{+}),f_{%
\mathcal{B}_{k}}(x_{k})\}
s_{k}
{\mathcal{B}_{k}}
k\geq 0
k\geq 1
x_{0}
f(x_{0})
x\in\mathbb{R}^{d}
x
\mathcal{B}
x
\mathcal{B}
f_{\mathcal{B}}(x)
f(x)
A
A.1
f_{i}
i=1,\ldots,n
L_{i}
f
f_{i}
i=1,\ldots,n
L_{i}
L_{i}>0
f
f_{*}\in\mathbb{R}
f_{i}
L_{i}
\|\nabla f_{i}(x)-\nabla f_{i}(y)\|_{2}\leq L_{i}\|x-y\|_{2},\qquad\forall x,y%
\in\mathbb{R}^{d}
f(x)\geq f_{*}
x\in\mathbb{R}^{d}.
f_{\mathcal{B}}(x)
x\in\mathbb{R}^{d}
\mathbf{E}_{\mathcal{B}}[(f(x)-f_{\mathcal{B}}(x))^{2}]<\sigma_{|\mathcal{B}|}%
^{2}<\infty
|{\mathcal{B}}|
\sigma_{|\mathcal{B}|}
f
f_{\mathcal{B}}
\mathbf{E}_{\mathcal{B}}[(f(x)-f_{\mathcal{B}}(x))^{2}]\leq\frac{A}{|\mathcal{%
B}|}
x\in\mathbb{R}^{d}
\mathcal{B}
A=\sup_{x\in\mathbb{R}^{d}}\frac{1}{n}\sum_{i=1}^{n}(f_{i}(x)-f(x))^{2}
A
A.2
f(y)=y^{2}
\mathbb{R}
(\mathbf{E}_{\mathcal{B}}[|f(x)-f_{\mathcal{B}}(x)|])^{2}\leq\mathbf{E}_{%
\mathcal{B}}[(|f(x)-f_{\mathcal{B}}(x)|)^{2}]
\mathbf{E}_{\mathcal{B}}[|f(x)-f_{\mathcal{B}}(x)|]\leq\sigma_{|\mathcal{B}|}
{\cal D}
\mathbb{R}^{d}
\mathbf{E}_{s\sim{\cal D}}\;\|s\|_{2}^{2}
1
\mu_{\cal D}>0
\|\cdot\|_{\cal D}
\mathbb{R}^{d}
g\in\mathbb{R}^{d}
\mathbf{E}_{s\sim{\cal D}}\;|\left\langle g,s\right\rangle|\geq\mu_{\cal D}\|g%
\|_{\cal D}.
\mathbb{R}^{d}
d\times d
\{e_{1},...,e_{d}\}
\mathbb{R}^{d}
S={s_{1},...,s_{d}}
\{s_{1},...,s_{d}\}
\mathbb{R}^{d}
k\geq 0
\theta_{k+1}\leq\theta_{k}-\mu_{\cal D}\alpha_{k}g_{k}+\frac{L}{2}\alpha_{k}^{%
2}+\sigma_{|\mathcal{B}|},
L_{\mathcal{B}_{k}}=\frac{1}{|\mathcal{B}_{k}|}\sum_{i\in\mathcal{B}_{k}}L_{i}
L=\mathbf{E}[L_{\mathcal{B}_{k}}]=\frac{1}{n}\sum_{i=1}^{n}L_{i}
\theta_{k}=\mathbf{E}[f(x_{k})]
g_{k}=\mathbf{E}[\|\nabla f(x_{k})\|_{\cal D}]
|\mathcal{B}_{k}|
f(x_{k+1})-f_{\mathcal{B}_{k}}(x_{k+1})\leq|f(x_{k+1})-f_{\mathcal{B}_{k}}(x_{%
k+1})|
f(x_{k+1})\leq f_{\mathcal{B}_{k}}(x_{k+1})+|f(x_{k+1})-f_{\mathcal{B}_{k}}(x_%
{k+1})|~{}~{}\mbox{(5)}
x_{k+1}=\arg\min\{f_{\mathcal{B}_{k}}(x_{k}-\alpha_{k}s_{k}),f_{\mathcal{B}_{k%
}}(x_{k}+\alpha_{k}s_{k}),f_{\mathcal{B}_{k}}(x_{k})\}
f_{\mathcal{B}_{k}}(x_{k+1})\leq f_{\mathcal{B}_{k}}(x_{k}+\alpha_{k}s_{k})~{}%
~{}\mbox{(6)}
L_{i}
f_{i}
f_{i}(x_{k}+\alpha_{k}s_{k})\leq f_{i}(x_{k})+\left\langle\nabla f_{i}(x_{k}),%
\alpha_{k}s_{k}\right\rangle+\frac{L_{i}}{2}\|\alpha_{k}s_{k}\|_{2}^{2}
f_{i}
i\in\mathcal{B}_{k}
1/|\mathcal{B}_{k}|
\displaystyle f_{\mathcal{B}_{k}}(x_{k}+\alpha_{k}s_{k})\leq f_{\mathcal{B}_{k%
}}(x_{k})+\left\langle\nabla f_{\mathcal{B}_{k}}(x_{k}),\alpha_{k}s_{k}\right%
\rangle+\frac{L_{\mathcal{B}_{k}}}{2}\|\alpha_{k}s_{k}\|_{2}^{2}=f_{\mathcal{B%
}_{k}}(x_{k})+\alpha_{k}\left\langle\nabla f_{\mathcal{B}_{k}}(x_{k}),s_{k}%
\right\rangle+\frac{L_{\mathcal{B}_{k}}}{2}\alpha_{k}^{2}\|s_{k}\|_{2}^{2}~{}~%
{}\mbox{(8)}
\displaystyle f_{\mathcal{B}_{k}}(x_{k}+\alpha_{k}s_{k})
\displaystyle\leq
\displaystyle f_{\mathcal{B}_{k}}(x_{k})+\left\langle\nabla f_{\mathcal{B}_{k}%
}(x_{k}),\alpha_{k}s_{k}\right\rangle+\frac{L_{\mathcal{B}_{k}}}{2}\|\alpha_{k%
}s_{k}\|_{2}^{2}
\displaystyle=
\displaystyle f_{\mathcal{B}_{k}}(x_{k})+\alpha_{k}\left\langle\nabla f_{%
\mathcal{B}_{k}}(x_{k}),s_{k}\right\rangle+\frac{L_{\mathcal{B}_{k}}}{2}\alpha%
_{k}^{2}\|s_{k}\|_{2}^{2}~{}~{}\mbox{(8)}
f(x_{k+1})\leq f_{\mathcal{B}_{k}}(x_{k})+\alpha_{k}\left\langle\nabla f_{%
\mathcal{B}_{k}}(x_{k}),s_{k}\right\rangle+\frac{L_{\mathcal{B}_{k}}}{2}\alpha%
_{k}^{2}\|s_{k}\|_{2}^{2}+e_{\mathcal{B}_{k}}^{k+1}
e_{\mathcal{B}_{k}}^{k+1}=|f(x_{k+1})-f_{\mathcal{B}_{k}}(x_{k+1})|
x_{k}
s_{k}
\mathbf{E}[f(x_{k+1})|x_{k},s_{k}]\leq f(x_{k})+\alpha_{k}\left\langle\nabla f%
(x_{k}),s_{k}\right\rangle+\frac{L}{2}\alpha_{k}^{2}\|s_{k}\|_{2}^{2}+\sigma_{%
|\mathcal{B}|}
A
A.3
\mathbf{E}[f(x_{k+1})|x_{k},s_{k}]\leq f(x_{k})-\alpha_{k}\left\langle\nabla f%
(x_{k}),s_{k}\right\rangle+\frac{L}{2}\alpha_{k}^{2}\|s_{k}\|_{2}^{2}+\sigma_{%
|\mathcal{B}|}
\mathbf{E}[f(x_{k+1})|x_{k},s_{k}]\leq f(x_{k})-\alpha_{k}|\left\langle\nabla f%
(x_{k}),s_{k}\right\rangle|+\frac{L}{2}\alpha_{k}^{2}\|s_{k}\|_{2}^{2}+\sigma_%
{|\mathcal{B}|}
s_{k}
\mathbf{E}[f(x_{k+1})|x_{k}]\leq f(x_{k})-\alpha_{k}\mu_{\cal D}\|\nabla f(x_{%
k})\|_{\cal D}+\frac{L}{2}\alpha_{k}^{2}\ +\sigma_{|\mathcal{B}|}
\mathbf{E}[f(x_{k+1})]\leq\mathbf{E}[f(x_{k})]-\alpha_{k}\mu_{\cal D}\mathbf{E%
}[\|\nabla f(x_{k})\|_{\cal D}]+\frac{L}{2}\alpha_{k}^{2}\ +\sigma_{|\mathcal{%
B}|}
f_{i}
i=1,\ldots,n
f
\sigma_{|\cal B|}<\frac{(\mu_{\cal D}\epsilon)^{2}}{2L}
\alpha_{k}=\alpha
(\mu_{\cal D}\epsilon-\sqrt{(\mu_{\cal D}\epsilon)^{2}-2L\sigma_{|\cal B|}})/L%
<\alpha<(\mu_{\cal D}\epsilon+\sqrt{(\mu_{\cal D}\epsilon)^{2}-2L\sigma_{|\cal
B%
|}})/L
K\geq k(\varepsilon)\stackrel{{\scriptstyle\text{def}}}{{=}}\left\lceil\frac{f%
(x_{0})-f_{*}}{\mu_{\cal D}\varepsilon\alpha-\tfrac{L}{2}\alpha^{2}-\sigma_{|%
\mathcal{B}|}}\right\rceil-1,
\min_{k=0,1,\dots,K}\mathbf{E}\left[\|\nabla f(x_{k})\|_{\cal D}\right]\leq\varepsilon.
\alpha_{optimal}=\mu_{\cal D}\varepsilon/L
A
A.4
f
f
x_{*}
x_{0}
R_{0}\stackrel{{\scriptstyle\text{def}}}{{=}}\max\{\|x-x_{*}\|_{\cal D}^{*}\;:%
\;f(x)\leq f(x_{0})\}<+\infty,
\|\xi\|_{\cal D}^{*}\stackrel{{\scriptstyle\text{def}}}{{=}}\max\{\langle\xi,x%
\rangle\mid\|x\|_{\cal D}\leq 1\}
\|\cdot\|_{\cal D}
f(x)\leq f(x_{0})
f(x)-f(x_{*})\leq\left\langle\nabla f(x),x-x_{*}\right\rangle=\|\nabla f(x)\|_%
{\cal D}(x-x_{*})^{T}\nabla f(x)/\|\nabla f(x)\|_{\cal D}\leq\|\nabla f(x)\|_{%
\cal D}\|x-x_{*}\|_{\cal D}^{*}\leq R_{0}\|\nabla f(x)\|_{\cal D}
\|\nabla f(x)\|_{\cal D}\geq\frac{f(x)-f(x_{*})}{R_{0}}.
\varepsilon>0
\sigma_{|\cal B|}<\frac{(\mu_{\cal D}\epsilon)^{2}}{4LR_{0}^{2}}
\alpha_{k}=\alpha=\tfrac{\varepsilon\mu_{\cal D}}{LR_{0}}
K\geq\frac{LR_{0}^{2}}{\mu_{\cal D}^{2}\varepsilon}\log\left(\frac{4(f(x_{0})-%
f(x_{*}))}{\varepsilon}\right),
\mathbf{E}\left[f(x_{K})-f(x_{*})\right]\leq\varepsilon.
A
A.5
\mu\pm\frac{\sigma}{2}
\mu
\sigma
\alpha
\tau
\tau=|\mathcal{B}|
x_{0}
\mathcal{D}
d\times d
f
\min_{x\in\mathbb{R}^{d}}\big{[}f(x)=\frac{1}{2n}\sum_{i=1}^{n}(A[i,:]x-y_{i})%
^{2}+\frac{\lambda}{2}\left\|x\right\|_{2}^{2}\big{]}
\min_{x\in\mathbb{R}^{d}}\big{[}f(x)=\frac{1}{2n}\sum_{i=1}^{n}\ln(1+\exp(-y_{%
i}A[i,:]x))+\frac{\lambda}{2}\left\|x\right\|_{2}^{2}\big{]}
A\in\mathbb{R}^{n\times d}
y\in\mathbb{R}^{n}
\lambda>0
y\in\{-1,1\}^{n}
A
\lambda=1/n
50
1
10
n=4177
d=8
n=1605
d=123
n=4177
d=8
n=1605
d=123
n=690
d=15
n=1605
d=124
n=690
d=15
n=1605
d=124
d
d
f_{\mathcal{B}}
f
\tau\geq 500
f_{\mathcal{B}}
f
k
x_{k+1}=x_{k}-\alpha_{k}\frac{f_{\mathcal{B}_{k}}(x_{k}+\mu_{k}s_{k})-f_{%
\mathcal{B}_{k}}(x_{k})}{\mu_{k}}s_{k}
\mu_{k}\in(0,1)
\alpha_{k}
s_{k}
\mathcal{B}_{k}
k
f_{\mathcal{B}_{k}}
x_{k}
\hat{\nabla}f_{\mathcal{B}_{k}}(x_{k})=\frac{d}{\mu}(f_{\mathcal{B}_{k}}(x_{k}%
+\mu s_{k})-f_{\mathcal{B}_{k}}(x_{k}))s_{k}
\mu>0
s_{k}
k
x_{k+1}=x_{k}-\alpha_{k}g_{\mathcal{B}_{k}},\qquad g_{\mathcal{B}_{k}}=\sum_{i%
=1}^{d}\frac{f_{\mathcal{B}_{k}}(x_{k}+\mu e_{i})-f_{\mathcal{B}_{k}}(x_{k}-%
\mu e_{i})}{2\mu}e_{i}
\mu>0
e_{i}\in\mathbb{R}^{d}
i\in[d]
1
i
0
\mathcal{D}
\mu_{k}=\mu=10^{-4}
f_{i}
i\in[n]
5
\tau=100
2
\tau=50
6000
3000
\tau=6000
1/10
60000
60000
\mathcal{B}
[n]
|\mathcal{B}|
\mathcal{B}
\mathbf{P}(\mathcal{B})=1/\tbinom{n}{|\mathcal{B}|}
\displaystyle\mathbf{E}_{\mathcal{B}}\left[f_{\mathcal{B}}(x)\right]=\mathbf{E%
}_{\mathcal{B}}\left[\frac{1}{|\mathcal{B}|}\sum_{i\in\mathcal{B}}f_{i}(x)%
\right]=\frac{1}{|\mathcal{B}|}\mathbf{E}_{\mathcal{B}}\left[\sum_{i\in%
\mathcal{B}}f_{i}(x)\right]=\frac{1}{|\mathcal{B}|}\sum_{j=1}^{\tbinom{n}{|%
\mathcal{B}|}}\mathbf{P}(\mathcal{B}_{j})\sum_{i\in\mathcal{B}_{j}}f_{i}(x)=%
\frac{1}{|\mathcal{B}|}\mathbf{P}(\mathcal{B})\sum_{j=1}^{\tbinom{n}{|\mathcal%
{B}|}}\sum_{i\in\mathcal{B}_{j}}f_{i}(x)
\displaystyle\mathbf{E}_{\mathcal{B}}\left[f_{\mathcal{B}}(x)\right]
\displaystyle=
\displaystyle\mathbf{E}_{\mathcal{B}}\left[\frac{1}{|\mathcal{B}|}\sum_{i\in%
\mathcal{B}}f_{i}(x)\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\mathbf{E}_{\mathcal{B}}\left[\sum_{i\in%
\mathcal{B}}f_{i}(x)\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\sum_{j=1}^{\tbinom{n}{|\mathcal{B}|}}%
\mathbf{P}(\mathcal{B}_{j})\sum_{i\in\mathcal{B}_{j}}f_{i}(x)
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\mathbf{P}(\mathcal{B})\sum_{j=1}^{\tbinom%
{n}{|\mathcal{B}|}}\sum_{i\in\mathcal{B}_{j}}f_{i}(x)
\sum_{j=1}^{\tbinom{n}{|\mathcal{B}|}}\sum_{i\in\mathcal{B}_{j}}f_{i}(x)
f_{i}(x)
f_{i}(x)
\tbinom{n-1}{|\mathcal{B}|-1}
f_{i}(x)
\tbinom{n-1}{|\mathcal{B}|-1}
\displaystyle\mathbf{E}_{\mathcal{B}}\left[f_{\mathcal{B}}(x)\right]=\frac{1}{%
|\mathcal{B}|}\mathbf{P}(\mathcal{B})\tbinom{n-1}{|\mathcal{B}|-1}\sum_{i=1}^{%
n}f_{i}(x)=\frac{1}{|\mathcal{B}|}\frac{1}{\tbinom{n}{|\mathcal{B}|}}\tbinom{n%
-1}{|\mathcal{B}|-1}\sum_{i=1}^{n}f_{i}(x)=\frac{1}{|\mathcal{B}|}\frac{1}{%
\frac{n}{|\mathcal{B}|}\tbinom{n-1}{|\mathcal{B}|-1}}\tbinom{n-1}{|\mathcal{B}%
|-1}\sum_{i=1}^{n}f_{i}(x)=\frac{1}{n}\sum_{i=1}^{n}f_{i}(x)=f(x)
\displaystyle\mathbf{E}_{\mathcal{B}}\left[f_{\mathcal{B}}(x)\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\mathbf{P}(\mathcal{B})\tbinom{n-1}{|%
\mathcal{B}|-1}\sum_{i=1}^{n}f_{i}(x)
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\frac{1}{\tbinom{n}{|\mathcal{B}|}}\tbinom%
{n-1}{|\mathcal{B}|-1}\sum_{i=1}^{n}f_{i}(x)
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\frac{1}{\frac{n}{|\mathcal{B}|}\tbinom{n-%
1}{|\mathcal{B}|-1}}\tbinom{n-1}{|\mathcal{B}|-1}\sum_{i=1}^{n}f_{i}(x)
\displaystyle=
\displaystyle\frac{1}{n}\sum_{i=1}^{n}f_{i}(x)
\displaystyle=
\displaystyle f(x)
f
f_{\mathcal{B}}
x\in\mathbb{R}^{d}
\mathcal{B}
f
f_{\mathcal{B}}
\mathbf{E}_{\mathcal{B}}[(f(x)-f_{\mathcal{B}}(x))^{2}]\leq\frac{A}{|\mathcal{%
B}|}
A=\sup_{x\in\mathbb{R}^{d}}\frac{1}{n}\sum_{i=1}^{n}(f_{i}(x)-f(x))^{2}
g_{i}:=f_{i}(x)-f(x)
g_{\mathcal{B}}=f_{\mathcal{B}}(x)-f(x)=\frac{1}{|\mathcal{B}|}\sum_{i\in%
\mathcal{B}}g_{i}
B=\mathbf{E}_{i}[g_{i}^{2}]=\frac{1}{n}\sum_{i=1}^{n}g_{i}^{2}\leq A
\displaystyle\mathbf{E}_{\mathcal{B}}\left[g_{\mathcal{B}}^{2}\right]=\mathbf{%
E}_{\mathcal{B}}\left[\left(\frac{1}{|\mathcal{B}|}\sum_{i\in\mathcal{B}}g_{i}%
\right)^{2}\right]=\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[%
\left(\sum_{i\in\mathcal{B}}g_{i}\right)^{2}\right]=\frac{1}{|\mathcal{B}|^{2}%
}\mathbf{E}_{\mathcal{B}}\left[\sum_{i,j\in\mathcal{B}}g_{i}g_{j}\right]=\frac%
{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[\sum_{i\neq j\in\mathcal{B%
}}g_{i}g_{j}\right]+\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[%
\sum_{i\in\mathcal{B}}g_{i}^{2}\right]=\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{%
\mathcal{B}}\left[\sum_{i\neq j\in\mathcal{B}}g_{i}g_{j}\right]+\frac{1}{|%
\mathcal{B}|^{2}}|\mathcal{B}|B=\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{%
\mathcal{B}}\left[\sum_{i\neq j\in\mathcal{B}}g_{i}g_{j}\right]+\frac{B}{|%
\mathcal{B}|}
\displaystyle\mathbf{E}_{\mathcal{B}}\left[g_{\mathcal{B}}^{2}\right]
\displaystyle=
\displaystyle\mathbf{E}_{\mathcal{B}}\left[\left(\frac{1}{|\mathcal{B}|}\sum_{%
i\in\mathcal{B}}g_{i}\right)^{2}\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[\left(%
\sum_{i\in\mathcal{B}}g_{i}\right)^{2}\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[\sum_{i,%
j\in\mathcal{B}}g_{i}g_{j}\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[\sum_{i%
\neq j\in\mathcal{B}}g_{i}g_{j}\right]+\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{%
\mathcal{B}}\left[\sum_{i\in\mathcal{B}}g_{i}^{2}\right]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[\sum_{i%
\neq j\in\mathcal{B}}g_{i}g_{j}\right]+\frac{1}{|\mathcal{B}|^{2}}|\mathcal{B}|B
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|^{2}}\mathbf{E}_{\mathcal{B}}\left[\sum_{i%
\neq j\in\mathcal{B}}g_{i}g_{j}\right]+\frac{B}{|\mathcal{B}|}
\mathbf{E}_{\mathcal{B}}[\sum_{i\neq j\in\mathcal{B}}g_{i}g_{j}]=\sum_{k=1}^{%
\tbinom{n}{|\mathcal{B}|}}\frac{1}{\tbinom{n}{|\mathcal{B}|}}\sum_{i\neq j\in%
\mathcal{B}_{k}}g_{i}g_{j}
i
j
\tbinom{n-2}{|\mathcal{B}|-2}
\mathbf{E}_{\mathcal{B}}[\sum_{i\neq j\in\mathcal{B}}g_{i}g_{j}]=\frac{1}{%
\tbinom{n}{|\mathcal{B}|}}\tbinom{n-2}{|\mathcal{B}|-2}\sum_{i\neq j\in[n]}g_{%
i}g_{j}=\frac{1}{\frac{n(n-1)}{|\mathcal{B}|(|\mathcal{B}|-1)}\tbinom{n-2}{|%
\mathcal{B}|-2}}\tbinom{n-2}{|\mathcal{B}|-2}\sum_{i\neq j\in[n]}g_{i}g_{j}=%
\frac{|\mathcal{B}|(|\mathcal{B}|-1)}{n(n-1)}\sum_{i\neq j\in[n]}g_{i}g_{j}
\displaystyle\mathbf{E}_{\mathcal{B}}[g_{\mathcal{B}}^{2}]=\frac{1}{|\mathcal{%
B}|^{2}}\frac{|\mathcal{B}|(|\mathcal{B}|-1)}{n(n-1)}\sum_{i\neq j\in[n]}g_{i}%
g_{j}+\frac{B}{|\mathcal{B}|}=\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{%
n(n-1)}\sum_{i,j\in[n]}g_{i}g_{j}-\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-%
1)}{n(n-1)}\sum_{i\in[n]}g_{i}^{2}+\frac{B}{|\mathcal{B}|}=\frac{1}{|\mathcal{%
B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}\sum_{i,j\in[n]}g_{i}g_{j}-\frac{1}{|%
\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}nB+\frac{B}{|\mathcal{B}|}=\frac{%
1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}\sum_{i,j\in[n]}g_{i}g_{j}-%
\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}nB+\frac{B}{|\mathcal{B%
}|}=0+\frac{B(n-|\mathcal{B}|)}{|\mathcal{B}|(n-1)}\leq\frac{B}{|\mathcal{B}|}%
\leq\frac{A}{|\mathcal{B}|}
\displaystyle\mathbf{E}_{\mathcal{B}}[g_{\mathcal{B}}^{2}]
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|^{2}}\frac{|\mathcal{B}|(|\mathcal{B}|-1)}{%
n(n-1)}\sum_{i\neq j\in[n]}g_{i}g_{j}+\frac{B}{|\mathcal{B}|}
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}\sum_{i,j%
\in[n]}g_{i}g_{j}-\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}\sum_%
{i\in[n]}g_{i}^{2}+\frac{B}{|\mathcal{B}|}
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}\sum_{i,j%
\in[n]}g_{i}g_{j}-\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}nB+%
\frac{B}{|\mathcal{B}|}
\displaystyle=
\displaystyle\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}\sum_{i,j%
\in[n]}g_{i}g_{j}-\frac{1}{|\mathcal{B}|}\frac{(|\mathcal{B}|-1)}{n(n-1)}nB+%
\frac{B}{|\mathcal{B}|}
\displaystyle=
\displaystyle 0+\frac{B(n-|\mathcal{B}|)}{|\mathcal{B}|(n-1)}
\displaystyle\leq
\displaystyle\frac{B}{|\mathcal{B}|}
\displaystyle\leq
\displaystyle\frac{A}{|\mathcal{B}|}
\sum_{i,j\in[n]}g_{i}g_{j}=n^{2}(f-f)^{2}=0
x_{k+1}=\arg\min\{f_{\mathcal{B}_{k}}(x_{k}-\alpha_{k}s_{k}),f_{\mathcal{B}_{k%
}}(x_{k}+\alpha_{k}s_{k}),f_{\mathcal{B}_{k}}(x_{k})\}
f_{\mathcal{B}_{k}}(x_{k+1})\leq f_{\mathcal{B}_{k}}(x_{k}-\alpha_{k}s_{k})~{}%
~{}\mbox{(16)}
L_{i}
f_{i}
f_{i}(x_{k}-\alpha_{k}s_{k})\leq f_{i}(x_{k})-{\bm{e}}{\nabla f_{i}(x_{k})}{%
\alpha_{k}s_{k}}+\frac{L_{i}}{2}\|\alpha_{k}s_{k}\|_{2}^{2}
f_{i}
i\in\mathcal{B}_{k}
1/|\mathcal{B}_{k}|
\displaystyle f_{\mathcal{B}_{k}}(x_{k}-\alpha_{k}s_{k})\leq f_{\mathcal{B}_{k%
}}(x_{k})-{\bm{e}}{\nabla f_{\mathcal{B}_{k}}(x_{k})}{\alpha_{k}s_{k}}+\frac{L%
_{\mathcal{B}_{k}}}{2}\|\alpha_{k}s_{k}\|_{2}^{2}=f_{\mathcal{B}_{k}}(x_{k})-%
\alpha_{k}{\bm{e}}{\nabla f_{\mathcal{B}_{k}}(x_{k})}{s_{k}}+\frac{L_{\mathcal%
{B}_{k}}}{2}\alpha_{k}^{2}\|s_{k}\|_{2}^{2}~{}~{}\mbox{(18)}
\displaystyle f_{\mathcal{B}_{k}}(x_{k}-\alpha_{k}s_{k})
\displaystyle\leq
\displaystyle f_{\mathcal{B}_{k}}(x_{k})-{\bm{e}}{\nabla f_{\mathcal{B}_{k}}(x%
_{k})}{\alpha_{k}s_{k}}+\frac{L_{\mathcal{B}_{k}}}{2}\|\alpha_{k}s_{k}\|_{2}^{2}
\displaystyle=
\displaystyle f_{\mathcal{B}_{k}}(x_{k})-\alpha_{k}{\bm{e}}{\nabla f_{\mathcal%
{B}_{k}}(x_{k})}{s_{k}}+\frac{L_{\mathcal{B}_{k}}}{2}\alpha_{k}^{2}\|s_{k}\|_{%
2}^{2}~{}~{}\mbox{(18)}
f(x_{k+1})\leq f_{\mathcal{B}_{k}}(x_{k})-\alpha_{k}{\bm{e}}{\nabla f_{%
\mathcal{B}_{k}}(x_{k})}{s_{k}}+\frac{L_{\mathcal{B}_{k}}}{2}\alpha_{k}^{2}\|s%
_{k}\|_{2}^{2}+e_{\mathcal{B}_{k}}^{k+1}
e_{\mathcal{B}_{k}}^{k+1}=|f(x_{k+1})-f_{\mathcal{B}_{k}}(x_{k+1})|
x_{k}
s_{k}
\mathbf{E}[f(x_{k+1})|x_{k},s_{k}]\leq f(x_{k})-\alpha_{k}{\bm{e}}{\nabla f(x_%
{k})}{s_{k}}+\frac{L}{2}\alpha_{k}^{2}\|s_{k}\|_{2}^{2}+\mathbf{E}[e_{\mathcal%
{B}_{k}}^{k+1}|x_{k},s_{k}]
g_{k}\leq\varepsilon
k\leq K
g_{k}>\varepsilon
k\leq K
\theta_{k+1}\leq\theta_{k}-\mu_{\cal D}\alpha g_{k}+\frac{L}{2}\alpha^{2}+%
\sigma_{|\mathcal{B}|},
\theta_{k}=\mathbf{E}[f(x_{k})]
g_{k}=\mathbf{E}[\|\nabla f(x_{k})\|_{\cal D}]
f_{*}\leq\theta_{K+1}<\theta_{0}-(K+1)\left(\mu_{\cal D}\alpha\varepsilon-%
\frac{L}{2}\alpha^{2}-\sigma_{|\mathcal{B}|}\right)\overset{equation~{}\ref{eq%
:kineq31}}{\leq}\theta_{0}-(f(x_{0})-f_{*})=f_{*},
\mathbf{E}[f(x_{k+1})|x_{k}]\leq f(x_{k})-\alpha\mu_{\cal D}\|\nabla f(x_{k})%
\|_{\cal D}+\frac{L}{2}\alpha^{2}\ +\sigma_{|\mathcal{B}|}
\theta_{k+1}\leq\theta_{k}-\frac{\mu_{\cal D}\alpha}{R_{0}}(\theta_{k}-f(x_{*}%
))+\frac{L}{2}\alpha^{2}+\sigma_{|\mathcal{B}|}.
r_{k}=\theta_{k}-f(x_{*})
\delta=1-\frac{\mu_{\cal D}\alpha}{R_{0}}\in(0,1)
f(x_{*})
\displaystyle r_{K}\leq\delta r_{K-1}+\frac{L}{2}\alpha^{2}+\sigma_{|\mathcal{%
B}|}\leq\delta^{K}r_{0}+\left(\frac{L}{2}\alpha^{2}+\sigma_{|\mathcal{B}|}%
\right)\sum_{i=0}^{K-1}\delta^{i}\leq\exp(-\mu_{\cal D}\alpha K/R_{0})r_{0}+%
\left(\frac{L}{2}\alpha^{2}+\sigma_{|\mathcal{B}|}\right)\frac{1}{1-\delta}=%
\quad\exp(-\mu_{\cal D}\alpha K/R_{0})r_{0}+\frac{\varepsilon}{2}+\sigma_{|%
\mathcal{B}|}\frac{LR_{0}^{2}}{\varepsilon\mu_{\cal D}^{2}}\;\;\overset{%
equation~{}\ref{eq:isjsssus2}}{\leq}\;\;\varepsilon.
\displaystyle r_{K}
\displaystyle\leq
\displaystyle\delta r_{K-1}+\frac{L}{2}\alpha^{2}+\sigma_{|\mathcal{B}|}
\displaystyle\leq
\displaystyle\delta^{K}r_{0}+\left(\frac{L}{2}\alpha^{2}+\sigma_{|\mathcal{B}|%
}\right)\sum_{i=0}^{K-1}\delta^{i}
\displaystyle\leq
\displaystyle\exp(-\mu_{\cal D}\alpha K/R_{0})r_{0}+\left(\frac{L}{2}\alpha^{2%
}+\sigma_{|\mathcal{B}|}\right)\frac{1}{1-\delta}
\displaystyle=
\displaystyle\quad\exp(-\mu_{\cal D}\alpha K/R_{0})r_{0}+\frac{\varepsilon}{2}%
+\sigma_{|\mathcal{B}|}\frac{LR_{0}^{2}}{\varepsilon\mu_{\cal D}^{2}}\;\;%
\overset{equation~{}\ref{eq:isjsssus2}}{\leq}\;\;\varepsilon.
f_{\mathcal{B}}=\tilde{f}
\tau
\alpha
