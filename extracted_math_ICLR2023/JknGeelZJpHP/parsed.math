k
L^{2}
k
L^{2}
L^{2}
r
L^{2}
n
X_{a}\in(L^{2})^{n\times r}
L^{2}
n
L^{2}
X_{v}\in\mathbb{R}^{o\times r}
o
n
L^{2}
c
n
m
P_{a}\in(L^{2})^{n\times m}
P_{v}\in\mathbb{R}^{o\times m}
\displaystyle X_{v}=P_{v}b\big{(}P_{a}^{T}X_{a}\big{)},\qquad b(e)=\begin{%
cases}1,&\text{if}\ e\geq c\\
0,&\text{else},\end{cases}
\displaystyle X_{v}=P_{v}b\big{(}P_{a}^{T}X_{a}\big{)},\qquad b(e)=\begin{%
cases}1,&\text{if}\ e\geq c\\
0,&\text{else},\end{cases}
b(e)
c
\bm{\xi}
\mathbf{y}
\mathbf{y}
L^{2}
\displaystyle\mathbf{y}=X_{v}b\big{(}X_{a}^{T}\bm{\xi}\big{)}.
\displaystyle\mathbf{y}=X_{v}b\big{(}X_{a}^{T}\bm{\xi}\big{)}.
\bm{\xi}
\mathbf{y}
\displaystyle\mathbf{y}=\tilde{X}_{v}f(\tilde{X}_{a}^{T}\tilde{\bm{\xi}}+%
\tilde{\mathbf{b}}_{a})+\tilde{\mathbf{b}}_{v},
\displaystyle\mathbf{y}=\tilde{X}_{v}f(\tilde{X}_{a}^{T}\tilde{\bm{\xi}}+%
\tilde{\mathbf{b}}_{a})+\tilde{\mathbf{b}}_{v},
\tilde{X}_{a}\in\mathbb{R}^{n\times r}
\tilde{X}_{v}\in\mathbb{R}^{o\times r}
\tilde{\mathbf{b}}_{a}\in\mathbb{R}^{r}
\tilde{\mathbf{b}}_{v}\in\mathbb{R}^{o}
f(\cdot)
k
k
k
k
k
k+1
\mathbf{a}\coloneqq X_{a}^{T}\bm{\xi}
\mathbf{a}^{*}
\displaystyle\mathbf{a}^{*}=[\mathbf{a}-I]_{+}
\displaystyle\mathbf{a}^{*}
\displaystyle=[\mathbf{a}-I]_{+}
\displaystyle I=\text{descending-sort}([\mathbf{a}]_{+})_{(k_{t}+1)}
\displaystyle I
\displaystyle=\text{descending-sort}([\mathbf{a}]_{+})_{(k_{t}+1)}
\displaystyle k_{t}=\max\big{(}k_{\text{target}},\lfloor k_{\text{max}}-E_{t}(%
k_{\text{max}}-k_{\text{target}})/s\rfloor\big{)},
\displaystyle k_{t}
\displaystyle=\max\big{(}k_{\text{target}},\lfloor k_{\text{max}}-E_{t}(k_{%
\text{max}}-k_{\text{target}})/s\rfloor\big{)},
[\cdot]_{+}
\lfloor\cdot\rfloor
k_{t}
\cdot
k+1
E_{t}
t
k_{t}
E_{t}
s
k
k_{\text{max}}
k_{\text{target}}
k_{t}=k_{\text{target}}
L^{2}
k
X_{v}
k_{\text{target}}=10
k_{\text{target}}=1
k
k_{\text{target}}
k
\beta
k=1
k
k
k
L^{2}
L^{2}
L^{2}
k=10
k_{\text{target}}
s
k
r
k
L^{2}
(X_{a},X_{v})
(T_{1},\dots,T_{n})
k_{\text{max}}
k_{\text{target}}
s
(X_{a},X_{v})
X_{v}\leftarrow\text{LayerInit}(X_{v})
\mathbf{X},\mathbf{Y}\leftarrow T_{i}
\mathbf{x},\mathbf{y}\sim\mathbf{X},\mathbf{Y}
\mathbf{x}\leftarrow\mathbf{x}/||\mathbf{x}||
\mathbf{a}\leftarrow X_{a}^{T}\mathbf{x}
\mathbf{a}\leftarrow\text{Top-K}(\mathbf{a})
\hat{\mathbf{y}}\leftarrow X_{v}^{T}\mathbf{a}
\nabla_{\theta}X_{a},\nabla_{\theta}X_{v}\leftarrow\text{ComputeGradients}(%
\hat{\mathbf{y}},\mathbf{y})
X_{a},X_{v}\leftarrow\text{GradientStep}(\nabla_{\theta}X_{a},\nabla_{\theta}X%
_{v})
X_{a},X_{v}\leftarrow[X_{a}]_{+},[X_{v}]_{+}
X_{a}\leftarrow X_{a}/||X_{a}||
X_{a},X_{v}
\bm{\xi}
\mathbf{p}_{a}
\mathbf{x}
\mathbf{x}_{a}
\mathbf{x}_{v}
(\mathbf{x}_{v})_{i}
i
\mathbf{p}_{a}
\bm{\xi}
\mathbf{x}_{a}
\mathbf{x}_{a}^{1}
\mathbf{x}_{a}^{2}
[\mathbf{x}_{v}^{1}]_{1}
[\mathbf{x}_{v}^{2}]_{1}
-I
\mathbf{p}_{v}
[\mathbf{p}_{v}]_{1}
[\mathbf{y}]_{1}
\mathbf{p}_{a}
\bm{\xi}
\mathbf{x}_{a}
\mathbf{x}_{a}^{1}
\mathbf{x}_{a}^{2}
[\mathbf{x}_{v}^{1}]_{1}
[\mathbf{x}_{v}^{2}]_{1}
-I
\mathbf{p}_{v}
[\mathbf{p}_{v}]_{1}
[\mathbf{y}]_{1}
i
\mathbf{y}_{i}
(\mathbf{p}_{v})_{i}
L^{2}
X_{a}
c
c
k
c
k
c
c
k
c
k
k
\{+1,-1\}
w_{i}=\pm 1
w_{i}=\big{(}2*[\mathbf{x}_{a}^{\tau}]_{i}\big{)}-1,\forall i\in\{1,...,n\}.
\tau
\bm{\xi}
a(\cdot,\cdot)
a(\bm{\xi},\mathbf{x}^{\tau}_{a})=I\bigg{[}\Big{(}\sum_{i=1}^{n}w_{i}\xi_{i}%
\Big{)}>d\bigg{]}=I\Bigg{[}\bigg{(}\sum_{i=1}^{n}\Big{(}(2*[\mathbf{x}^{\tau}_%
{a}]_{i})-1\Big{)}\xi_{i}\bigg{)}>d\Bigg{]},
d
I[\cdot]
[-\sum_{i}^{n}[\mathbf{x}_{a}^{\tau}]_{i},\sum_{i}^{n}[\mathbf{x}_{a}^{\tau}]_%
{i}]
d
\sim 4
L^{2}
a\in[0,t]
t
L^{2}
[-1,1]
b(\cdot)
L^{2}
L^{2}
L^{2}
L^{2}
k
k
k
k
\sim
\mathbf{x}_{v}=\mathbf{x}_{v}+\alpha\mathbf{p}_{v}
\alpha
\mathbf{x}_{v}
\mathbf{p}_{a}
\mathbf{p}_{v}
\mathbf{x}_{v}
\mathbf{x}_{v}
\mathbf{x}_{a}
\mathbf{p}_{v}
\mathbf{x}_{v}
\mathbf{x}_{v}
\mathbf{x}_{v}
\mathbf{p}_{v}
\mathbf{p}_{v}
n
d
\bm{\xi}
\mathbf{p}_{a}
d_{v}\coloneqq d(\bm{\xi},\mathbf{p}_{a})
\bm{\xi}
\mathbf{p}_{a}
n-d_{v}
d_{v}
\displaystyle\bm{\xi}=[\overbrace{{1,\dots,1}\>|\>{0,\dots,0}}^{n-d_{v}}|%
\overbrace{1,\dots,1\>|\>0,\dots,0}^{d_{v}}]
\displaystyle\bm{\xi}
\displaystyle=[\overbrace{{1,\dots,1}\>|\>{0,\dots,0}}^{n-d_{v}}|\overbrace{1,%
\dots,1\>|\>0,\dots,0}^{d_{v}}]
\displaystyle\mathbf{p}_{a}=[\underbrace{1,\dots,1\>|\>0,\dots,0}_{a+z}|%
\underbrace{0,\dots,0\>|\>1,\dots,1}_{b+c}]
\displaystyle\mathbf{p}_{a}
\displaystyle=[\underbrace{1,\dots,1\>|\>0,\dots,0}_{a+z}|\underbrace{0,\dots,%
0\>|\>1,\dots,1}_{b+c}]
a
\bm{\xi}
\mathbf{p}_{a}
z
\bm{\xi}
\mathbf{p}_{a}
b
\bm{\xi}
\mathbf{p}_{a}
c
\mathbf{p}_{a}
\bm{\xi}
a
z
b
c
\bm{\xi}
\mathbf{p}_{a}
\displaystyle a+b+c+z=n
\displaystyle a+b+c+z
\displaystyle=n
\displaystyle a+b\geq n-d
\displaystyle a+b
\displaystyle\geq n-d
\displaystyle a+c\geq n-d
\displaystyle a+c
\displaystyle\geq n-d
\displaystyle a+z=n-d_{v}
\displaystyle a+z
\displaystyle=n-d_{v}
\displaystyle b+c=d_{v}
\displaystyle b+c
\displaystyle=d_{v}
\sum_{a=n-d-\lfloor\frac{d_{v}}{2}\rfloor}^{n-d_{v}}\sum_{c=\max(0,n-d-a)}^{d_%
{v}-(n-d-a)}w_{\text{Type}}(a,c,d_{v},n)\Bigg{(}{{n-d_{v}}\choose a}\cdot{d_{v%
}\choose c}\Bigg{)},
w_{\text{Type}}()
\displaystyle w_{\text{Binary}}(a,c,d_{v},n)=1
\displaystyle w_{\text{Binary}}(a,c,d_{v},n)
\displaystyle=1
\displaystyle w_{\text{Linear}}(a,c,d_{v},n)=\frac{a+c}{n}\cdot\frac{a+(d_{v}-%
c)}{n}
\displaystyle w_{\text{Linear}}(a,c,d_{v},n)
\displaystyle=\frac{a+c}{n}\cdot\frac{a+(d_{v}-c)}{n}
\displaystyle w_{\text{Exp}}(a,c,d_{v},n)=\exp\Big{(}-\beta\big{(}n-(a+c)\big{%
)}\Big{)}\cdot\exp\Big{(}-\beta\big{(}n-(a+(d_{v}-c))\big{)}\Big{)},
\displaystyle w_{\text{Exp}}(a,c,d_{v},n)
\displaystyle=\exp\Big{(}-\beta\big{(}n-(a+c)\big{)}\Big{)}\cdot\exp\Big{(}-%
\beta\big{(}n-(a+(d_{v}-c))\big{)}\Big{)},
w_{\text{Binary}}
w_{\text{Linear}}
w_{\text{Exp}}
\beta
x
x\coloneqq(n-z)-(a+c)=b-z
z=0
\displaystyle w_{\text{Linear}}(a,c,d_{v},n)=\frac{n-x}{n}\cdot\frac{n-((d_{v}%
+z)-x)}{n}
\displaystyle w_{\text{Linear}}(a,c,d_{v},n)
\displaystyle=\frac{n-x}{n}\cdot\frac{n-((d_{v}+z)-x)}{n}
\displaystyle=\frac{n-x}{n}\cdot\frac{n-(\mathcal{C}-x)}{n}
\displaystyle=\frac{n-x}{n}\cdot\frac{n-(\mathcal{C}-x)}{n}
\displaystyle=\frac{n^{2}-x^{2}-n\mathcal{C}+x\mathcal{C}}{n^{2}}
\displaystyle=\frac{n^{2}-x^{2}-n\mathcal{C}+x\mathcal{C}}{n^{2}}
\displaystyle=Z+\frac{-x(x-\mathcal{C})}{n^{2}}
\displaystyle=Z+\frac{-x(x-\mathcal{C})}{n^{2}}
\mathcal{C}=(d_{v}+z)
Z=\frac{n^{2}-n\mathcal{C}}{n^{2}}
\mathcal{C}/2
\beta
\displaystyle w_{\text{Exp}}(a,c,d_{v},n)=\exp\big{(}-\beta x\big{)}\cdot\exp%
\big{(}-\beta(\mathcal{C}-x)\big{)}
\displaystyle w_{\text{Exp}}(a,c,d_{v},n)
\displaystyle=\exp\big{(}-\beta x\big{)}\cdot\exp\big{(}-\beta(\mathcal{C}-x)%
\big{)}
\displaystyle=\exp\big{(}-\beta\mathcal{C}\big{)}.
\displaystyle=\exp\big{(}-\beta\mathcal{C}\big{)}.
d^{*}
n=64
\text{CL}^{-}
\text{CL}^{-}
\text{CL}^{-}
\text{CL}^{-}
\text{CL}^{-}
\text{CL}^{-}
k
s
s
k
s
\displaystyle a_{i}^{*}=[a_{i}-\lambda_{i}I]_{+}
\displaystyle a_{i}^{*}
\displaystyle=[a_{i}-\lambda_{i}I]_{+}
\displaystyle I=\text{descending-sort}([\mathbf{a}]_{+})_{(k_{\text{target}}+1)}
\displaystyle I
\displaystyle=\text{descending-sort}([\mathbf{a}]_{+})_{(k_{\text{target}}+1)}
\displaystyle\lambda_{i}=\min\Big{(}1,\max\big{(}-1,-1+2C_{i}/s\big{)}\Big{)}
\displaystyle\lambda_{i}
\displaystyle=\min\Big{(}1,\max\big{(}-1,-1+2C_{i}/s\big{)}\Big{)}
C_{i}
\lambda_{i}
C_{i}
[\cdot]_{+}
s
s=250,000
s
s=5,000,000
s
k
\sim 20
L^{1}
k
k
k
k
k
k
k
k+1
k
k+1
k
k=1
k
s
L^{2}
\sim
s
\sim
s
\sim
k
k\approx 200
k\approx 200
k
k+1
k
\displaystyle\mathbf{e}^{0}=W_{\text{inp}}^{T}\mathbf{x}
\displaystyle\mathbf{e}^{0}
\displaystyle=W_{\text{inp}}^{T}\mathbf{x}
\displaystyle\mathbf{i}^{0}=0
\displaystyle\mathbf{i}^{0}
\displaystyle=0
\displaystyle\mathbf{p}_{a}^{t}=\mathbf{e}^{0}+W_{IE}\mathbf{i}^{t-1}
\displaystyle\mathbf{p}_{a}^{t}
\displaystyle=\mathbf{e}^{0}+W_{IE}\mathbf{i}^{t-1}
\displaystyle\mathbf{p}_{i}^{t}=\mathbf{e}^{0}+W_{EI}\mathbf{e}^{t-1}
\displaystyle\mathbf{p}_{i}^{t}
\displaystyle=\mathbf{e}^{0}+W_{EI}\mathbf{e}^{t-1}
\displaystyle\mathbf{g}_{a}=\frac{1}{\tau_{a}}\big{(}-\mathbf{e}^{t-1}+\tanh{(%
[(\mathbf{p}_{a}^{t}-\mathbf{b})/L]_{+})}\big{)}
\displaystyle\mathbf{g}_{a}
\displaystyle=\frac{1}{\tau_{a}}\big{(}-\mathbf{e}^{t-1}+\tanh{([(\mathbf{p}_{%
a}^{t}-\mathbf{b})/L]_{+})}\big{)}
\displaystyle\mathbf{g}_{i}=\frac{1}{\tau_{i}}\big{(}-\mathbf{i}^{t-1}+[(%
\mathbf{p}_{i}^{t}-b_{i})]_{+}\big{)}
\displaystyle\mathbf{g}_{i}
\displaystyle=\frac{1}{\tau_{i}}\big{(}-\mathbf{i}^{t-1}+[(\mathbf{p}_{i}^{t}-%
b_{i})]_{+}\big{)}
\displaystyle\mathbf{e}^{t}=\mathbf{e}^{t-1}+\Delta\mathbf{g}_{a}
\displaystyle\mathbf{e}^{t}
\displaystyle=\mathbf{e}^{t-1}+\Delta\mathbf{g}_{a}
\displaystyle\mathbf{i}^{t}=\mathbf{i}^{t-1}+\Delta\mathbf{g}_{i},
\displaystyle\mathbf{i}^{t}
\displaystyle=\mathbf{i}^{t-1}+\Delta\mathbf{g}_{i},
\mathbf{e}
\mathbf{i}
\Delta
\tau_{a}
\tau_{i}
L
\mathbf{b}
W_{IE}
W_{EI}
W_{\text{inp}}
\mathbf{x}
b_{i}
k
W_{\text{inp}}
k
W_{EI}
W_{IE}
1/(0.9r_{I})
r_{I}
k
b_{i}
k\approx 200
k
k+1
k+1
k
k
k
k
r
k
k
k
k<8
k
k
k<8
k
k
k<8
k
k
k
k=5
k\leq 50
k=1
k=10
k=1
k
L^{2}
k
k
k
k
k\geq 250
k=2,500
\sim
k
k
k
k
k
k<<r
k
k
k
\sim
\sim
\sim
\sim
L^{2}
L^{2}
L^{2}
\Delta_{\text{Optimizer}}
m_{t}
\beta=0.9
\sqrt{v_{t}}
\beta_{2}=0.999
\lambda
\theta_{t}
t
g_{t}
\gamma=0.9
\beta_{1}=0.9
\beta_{2}=0.999
\alpha=0.99
\displaystyle\theta_{t}=\theta_{t-1}-\lambda\Delta_{\text{Optimizer}}
\displaystyle\theta_{t}
\displaystyle=\theta_{t-1}-\lambda\Delta_{\text{Optimizer}}
\displaystyle\Delta_{\text{SGD}}=g_{t}
\displaystyle\Delta_{\text{SGD}}
\displaystyle=g_{t}
\displaystyle\Delta_{\text{SGDM}}=\gamma\theta_{t-1}+g_{t}
\displaystyle\Delta_{\text{SGDM}}
\displaystyle=\gamma\theta_{t-1}+g_{t}
\displaystyle\Delta_{\text{Adam}}=\frac{\hat{m}_{t}}{\sqrt{\hat{v}_{t}}}
\displaystyle\Delta_{\text{Adam}}
\displaystyle=\frac{\hat{m}_{t}}{\sqrt{\hat{v}_{t}}}
\displaystyle\hat{m}_{t}=\frac{m_{t}}{1-\beta_{1}}
\displaystyle\hat{m}_{t}
\displaystyle=\frac{m_{t}}{1-\beta_{1}}
\displaystyle\hat{v}_{t}=\frac{v_{t}}{1-\beta_{2}}
\displaystyle\hat{v}_{t}
\displaystyle=\frac{v_{t}}{1-\beta_{2}}
\displaystyle m_{t}=\beta_{1}m_{t-1}+(1-\beta_{1})g_{t}
\displaystyle m_{t}
\displaystyle=\beta_{1}m_{t-1}+(1-\beta_{1})g_{t}
\displaystyle v_{t}=\beta_{2}v_{t-1}+(1-\beta_{2})g_{t}^{2}
\displaystyle v_{t}
\displaystyle=\beta_{2}v_{t-1}+(1-\beta_{2})g_{t}^{2}
\displaystyle\Delta_{\text{RMSProp}}=\frac{g_{t}}{\sqrt{v_{t}}}
\displaystyle\Delta_{\text{RMSProp}}
\displaystyle=\frac{g_{t}}{\sqrt{v_{t}}}
\displaystyle v_{t}=\alpha v_{t-1}+(1-\alpha)g_{t}^{2}
\displaystyle v_{t}
\displaystyle=\alpha v_{t-1}+(1-\alpha)g_{t}^{2}
\log_{10}
10/0.2=
1/0.2=
<1
\log_{10}
10/0.2=
1/0.2=
<1
g_{t}<1
L^{2}
s
\beta_{1}=0
v_{t}
\beta
\beta
\beta
k=1
\sim
\sim
k=1
k
s=5,000,000
\sim 50
\sim 100
k
k
\sim
\sim 5
\sim 5
k
k
\beta
k
k
\beta<1
\displaystyle p_{i}=\frac{\exp{(\beta l_{i})}}{\sum_{i=1}^{o}\exp{(\beta l_{i}%
)}},
\displaystyle p_{i}=\frac{\exp{(\beta l_{i})}}{\sum_{i=1}^{o}\exp{(\beta l_{i}%
)}},
l_{i}\in\mathbb{R}
o
i
\sum_{i=1}^{o}p_{i}=1
\beta=1
\beta=1
\sim 1
\beta<1
\beta
\beta
\beta
L^{2}
L^{2}
\log_{10}
L^{2}
L^{2}
L^{2}
\log_{10}
L^{2}
\log_{10}
L^{2}
L^{2}
L^{2}
L^{2}
L^{2}
L^{2}
\textbf{x}-\min{(\textbf{x})}
\textbf{x}*1/(\max{(\textbf{x})})
L^{2}
L^{2}
