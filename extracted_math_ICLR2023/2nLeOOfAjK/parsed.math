D_{C}=(X_{C},Y_{C}):=(\mathbf{x}_{i},\mathbf{y}_{i})_{i\in C}
\mathbf{x}_{i}
\mathbf{y}_{i}
D_{T}=(X_{T},Y_{T}):=(\mathbf{x}_{i},\mathbf{y}_{i})_{i\in T}
f
p_{\phi}(Y_{T}|X_{T},D_{c})=\prod\nolimits_{(\mathbf{x},\mathbf{y})\in D_{T}}{%
\mathcal{N}(\mathbf{y};\mu_{\mathbf{y}}(\mathbf{x},D_{c}),\sigma_{\mathbf{y}}^%
{2}(\mathbf{x},D_{c}))}.
\mathbf{z}\sim p_{\theta}(\mathbf{z}|X_{T},D_{C});\quad p_{\phi,\theta}(Y_{T}|%
X_{T},\mathbf{z})=\prod\nolimits_{(\mathbf{x},\mathbf{y})\in D_{T}}{\mathcal{N%
}(\mathbf{y};\mu_{\mathbf{y}}(\mathbf{z},X_{T},D_{C}),\sigma_{\mathbf{y}}^{2}(%
\mathbf{z},X_{T},D_{C}))}.
\log p_{\theta}(Y_{T}|X_{T},\mathbf{z})
\mathbb{E}_{\mathbf{z}\sim q_{\phi}(\mathbf{z}|D_{T})}[\log p_{\theta}(Y_{T}|%
\mathbf{z},X_{T},D_{C})]-D_{KL}[q_{\phi}(\mathbf{z}|D_{T})||p_{\psi}(\mathbf{z%
}|X_{T},D_{C})].
\psi
\theta
q_{\phi}(\mathbf{z}|D_{T})
D_{C}=(X_{C},Y_{C})
X_{T}
Y_{T}
k\times k
k
k^{2}
k
\mathcal{O}(L_{s}N_{C}^{2}+L_{c}N_{C}N_{T})\rightarrow\mathcal{O}(L_{s}\frac{N%
_{C}^{2}}{k^{4}}+L_{c}\frac{N_{C}}{k^{2}}N_{T}),
L_{s}
L_{c}
N_{C}
N_{T}
L_{c}
L_{K}
X_{T}
\hat{Y}_{0}\in\mathbb{R}^{T\times d}
T
d
L_{K}^{th}
Y_{T}
\hat{Y}_{k-1}
\hat{Y}_{k}
\mathbf{z}\in\mathbb{R}^{1\times d_{\mathbf{z}}}
\mathbf{z}_{k}
k^{th}
\displaystyle p_{\psi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},X_{T})=\mathcal{N}(%
\mathbf{\mu_{\mathbf{z}_{k}}},\mathbf{\sigma^{2}_{\mathbf{z}_{k}}})\leftarrow%
\rm{MLPs\ (AvgPool\ (MLPs}\it{(\hat{Y}_{k-1})))},
\displaystyle p_{\psi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},X_{T})=\mathcal{N}(%
\mathbf{\mu_{\mathbf{z}_{k}}},\mathbf{\sigma^{2}_{\mathbf{z}_{k}}})
\displaystyle\leftarrow\rm{MLPs\ (AvgPool\ (MLPs}\it{(\hat{Y}_{k-1})))},
\hat{Y}_{k-1}
(k-1)^{th}
\mathbf{z}_{k}
p_{\psi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},X_{T})
q_{\phi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},D_{T})
Y_{T}
\displaystyle q_{\phi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},D_{T})=\mathcal{N}(%
\mathbf{\mu_{\mathbf{z}_{k}}},\mathbf{\sigma^{2}_{\mathbf{z}_{k}}})\leftarrow%
\rm{MLPs\ (AvgPool\ (MLPs}\it{([\hat{Y}_{k-1},D_{T}])))}.
\displaystyle q_{\phi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},D_{T})=\mathcal{N}(%
\mathbf{\mu_{\mathbf{z}_{k}}},\mathbf{\sigma^{2}_{\mathbf{z}_{k}}})
\displaystyle\leftarrow\rm{MLPs\ (AvgPool\ (MLPs}\it{([\hat{Y}_{k-1},D_{T}])))}.
Y_{T}
\mathbf{z}_{k}
\mathbf{z_{k}}
(\mathbf{z}_{1},\mathbf{z}_{2},...,\mathbf{z}_{L_{K}})
\displaystyle D_{KL}=\sum_{k=2}^{L_{K}}\mathbb{E}_{q_{\phi}(\mathbf{z}_{<k}|D_%
{C},D_{T})}[D_{KL}[q_{\phi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},D_{T})||p_{\psi}%
(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},X_{T})]]
\displaystyle D_{KL}=\sum_{k=2}^{L_{K}}\mathbb{E}_{q_{\phi}(\mathbf{z}_{<k}|D_%
{C},D_{T})}[
\displaystyle D_{KL}[q_{\phi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},D_{T})||p_{%
\psi}(\mathbf{z}_{k}|\hat{Y}_{<k},D_{C},X_{T})]]
\displaystyle+D_{KL}[q_{\phi}(\mathbf{z}_{1}|D_{C},D_{T})||p_{\psi}(\mathbf{z}%
_{1}|D_{C},X_{T})],
\displaystyle+D_{KL}[q_{\phi}(\mathbf{z}_{1}|D_{C},D_{T})||p_{\psi}(\mathbf{z}%
_{1}|D_{C},X_{T})],
q_{\phi}(\mathbf{z}_{<k}|D_{C},D_{T})=\prod_{i=1}^{k-1}q_{\phi}(\mathbf{z}_{i}%
|\hat{Y}_{<i},D_{C},D_{T})
\mathbf{z}_{<k}
\mathcal{L}=\mathbb{E}_{\mathbf{z}_{1:L_{K}}\sim q_{\phi}(\mathbf{z}_{1:L_{K}}%
|D_{T})}[-\log p_{\theta}(Y_{T}|\mathbf{z}_{1:L_{K}},X_{T},D_{C})]+\beta\cdot D%
_{KL},
\beta
\beta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
L_{K}=6
\mathbf{z}
L_{K}=6
\mathbf{z}_{6}
\mathbf{z}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
ks
L_{K}
ks
L_{K}
ks
L_{K}
ks
L_{K}
ks
L_{K}
ks
L_{K}
64\times 64
32\times 32
\mathbf{z}_{k}
W\in\mathbb{R}^{d_{in}\times d_{out}}
d_{in}
d_{out}
w_{ij}
i^{th}
j^{th}
W
\mathbf{s}\in\mathbb{R}^{d_{in}}
\mathbf{z}
i^{th}
s_{i}
W
w^{\prime}_{ij}=s_{i}\cdot w_{ij},\hskip 11.38092ptj=1,\cdots,d_{out},
w_{ij}
w^{\prime}_{ij}
w^{\prime\prime}_{ij}=w^{\prime}_{ij}\ /\sqrt{\sum\limits_{i}{w_{ij}^{{}^{%
\prime}2}+\epsilon}},\hskip 11.38092ptj=1,\cdots,d_{out},
\epsilon
L_{s}
L_{c}
K
d
\beta
\mathbb{E}_{z\sim q_{\phi}(z|D_{T})}[-\log p_{\theta}(Y_{T}|z,X_{T},D_{C})].
L_{s}
L_{c}
L_{K}
d
d_{z}
\beta
128\times 128
128\times 128\times p
p
p=128
