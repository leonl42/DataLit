F_{1}
F_{1}
F_{1}
85\%
\bullet
\bullet
F_{1}
F_{1}
\bullet
\bullet
80\%
F_{1}
\mathcal{M}=(\mathcal{S},\mathcal{A},P,R,\gamma,\xi)
s=\mathbf{x}\odot M
\mathbf{x}\in\mathbb{R}^{d}
d
M\in\{0,1\}^{d}
\mathbf{x}
D
d
\mathcal{A}=\{1,2,\cdots,D\}\sqcup\{\text{P},\text{N}\}
a\in\{1,2,\cdots,D\}
a
c(a)
a\in\{\text{P},\text{N}\}
y
\xi
\gamma=1
\pi:\mathcal{S}\to\mathcal{A}
\pi
\bullet
F_{1}
F_{1}(\pi)
\pi
F_{1}
F_{1}(\pi)=\frac{\text{TP}(\pi)}{\text{TP}(\pi)+\frac{1}{2}(\text{FP}(\pi)+%
\text{FN}(\pi))}=\frac{2\text{TP}(\pi)}{1+\text{TP}(\pi)-\text{TN}(\pi)}
\text{TP}(\pi),\text{TN}(\pi),\text{FP}(\pi),\text{FN}(\pi)
\text{TP}(\pi),\text{TN}(\pi),\text{FP}(\pi),\text{FN}(\pi)
F_{1}(\pi)
\bullet
\text{Cost}(\pi)=\mathbb{E}^{\pi}[\sum_{t\geq 0}\sum_{k\in[D]}c(k)\cdot\mathbf%
{1}\{a_{t}=k\}]
\mathbb{E}^{\pi}
\pi
c(k)
k
F_{1}
\Pi^{*}
\displaystyle\Pi^{*}=\cup_{B>0}~{}\operatorname*{argmax}_{\pi}\{F_{1}(\pi){%
\hbox{ subject to }}\text{Cost}(\pi)\leq B\}
\displaystyle\Pi^{*}=\cup_{B>0}~{}\operatorname*{argmax}_{\pi}\{F_{1}(\pi){%
\hbox{ subject to }}\text{Cost}(\pi)\leq B\}
\Pi^{*}
F_{1}(\pi)
\text{TP}(\pi),\text{TN}(\pi)
\text{TP}(\pi),\text{TN}(\pi)
F_{1}
F_{1}
F_{1}
F_{1}
F_{1}
F_{1}
B
\pi^{*}(B)
F_{1}
\pi^{*}(B)
\displaystyle\max_{\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(%
\pi)\leq B,\text{TP}(\pi)\geq\text{TP}(\pi^{*}(B))\right\},
\displaystyle\max_{\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(%
\pi)\leq B,\text{TP}(\pi)\geq\text{TP}(\pi^{*}(B))\right\},
F_{1}
\displaystyle\Pi^{*}\subseteq\cup_{B>0,K\in[0,1]}~{}\operatorname*{argmax}_{%
\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(\pi)\leq B,\text{TP}%
(\pi)\geq K\right\}.
\displaystyle\Pi^{*}\subseteq\cup_{B>0,K\in[0,1]}~{}\operatorname*{argmax}_{%
\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(\pi)\leq B,\text{TP}%
(\pi)\geq K\right\}.
(B,B^{\prime})
\mu:\Delta_{\mathcal{A}}^{\mathcal{S}}\to\mathbb{R}_{\geq 0}^{\mathcal{S}%
\times\mathcal{A}}
\mu^{\pi}(s,a):=\mathbb{E}^{\pi}\left[\sum_{t\geq 0}\mathbf{1}(s_{t}=s,a_{t}=a%
)\right],~{}\forall s\in\mathcal{S},a\in\mathcal{A}.
\displaystyle\max_{\mu}\text{TN}(\mu){\hbox{ subject to }}\text{Cost}(\mu)\leq
B%
,~{}\text{TP}(\mu)\geq K,~{}\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]%
}\mu(s^{\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s
\displaystyle\max_{\mu}\text{TN}(\mu){\hbox{ subject to }}\text{Cost}(\mu)\leq
B%
,~{}\text{TP}(\mu)\geq K,~{}\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]%
}\mu(s^{\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s
\xi(\cdot)
\mu
\text{TP}(\mu)=\sum_{y=\text{P},a=\text{P}}\mu(s,a),~{}\text{TN}(\mu)=\sum_{y=%
\text{N},a=\text{N}}\mu(s,a),~{}\text{Cost}(\mu)=\sum_{k\in[D]}c(k)\cdot\sum_{%
s,a=k}\mu(s,a).
\displaystyle\max_{\mu}\min_{\lambda\geq 0,\rho\leq 0}~{}\text{TN}(\mu)+%
\lambda\cdot(\text{TP}(\mu)-K)+\rho\cdot(\text{Cost}(\mu)-B)
\displaystyle\max_{\mu}\min_{\lambda\geq 0,\rho\leq 0}~{}
\displaystyle\text{TN}(\mu)+\lambda\cdot(\text{TP}(\mu)-K)+\rho\cdot(\text{%
Cost}(\mu)-B)
\displaystyle\hbox{ subject to }\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}%
\in[D]}\mu(s^{\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
\displaystyle\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]}\mu(s^{\prime}%
,a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
\lambda,\rho
\mu
\displaystyle\min_{\lambda\geq 0,\rho\leq 0}\max_{\mu}~{}\text{TN}(\mu)+%
\lambda\cdot(\text{TP}(\mu)-K)+\rho\cdot(\text{Cost}(\mu)-B)
\displaystyle\min_{\lambda\geq 0,\rho\leq 0}\max_{\mu}~{}
\displaystyle\text{TN}(\mu)+\lambda\cdot(\text{TP}(\mu)-K)+\rho\cdot(\text{%
Cost}(\mu)-B)
\displaystyle\hbox{ subject to }\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}%
\in[D]}\mu(s^{\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
\displaystyle\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]}\mu(s^{\prime}%
,a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
(\lambda,\rho)
\max_{\pi}~{}\text{TN}(\pi)+\lambda\cdot\text{TP}(\pi)+\rho\cdot\text{Cost}(%
\pi).
\rho\cdot c(t)
t
\lambda
F_{1}
\Pi^{*}\subseteq\overline{\Pi}:=\cup_{\lambda\geq 0,\rho\leq 0}~{}%
\operatorname*{argmax}_{\pi}\left\{\text{TN}(\pi)+\lambda\cdot\text{TP}(\pi)+%
\rho\cdot\text{Cost}(\pi)\right\}.
\pi
\pi
\pi
\hbox{Imp}_{\theta}(\cdot)
\theta
\mathbf{x}\odot M
\hbox{Imp}_{\theta}(\mathbf{x}\odot M)\in\mathbb{R}^{d}
\bullet
f_{\phi}(\cdot):\mathbb{R}^{d}\to\mathbb{R}^{2}
\phi
\hbox{Imp}_{\theta}(\mathbf{x}\odot M)
\ell_{c}
\ell_{c}
\ell_{rl}
\bullet
\psi
\displaystyle s_{\theta,\phi}^{\text{emb}}(s)=s_{\theta,\phi}^{\text{emb}}(%
\mathbf{x}\odot M)=(\hbox{Imp}_{\theta}(\mathbf{x}\odot M),f_{\phi}(\hbox{Imp}%
_{\theta}(\mathbf{x}\odot M)),M),
\displaystyle s_{\theta,\phi}^{\text{emb}}(s)=s_{\theta,\phi}^{\text{emb}}(%
\mathbf{x}\odot M)=(\hbox{Imp}_{\theta}(\mathbf{x}\odot M),f_{\phi}(\hbox{Imp}%
_{\theta}(\mathbf{x}\odot M)),M),
\ell_{rl}
\bullet
\hbox{Imp}_{\theta}
f_{\phi^{(0,0)}}
\pi_{\psi^{(0,0)}}
L,L_{1},L_{2}
\eta
i=0,1,\cdots,L
s_{\theta,\phi^{(i,0)}}^{\text{emb}}
j=1,2,\cdots,L_{1}
T
Q
\psi^{(i,j)}=\operatorname*{argmax}_{\psi}\ell_{rl}(\psi;\psi^{(i,j-1)})
\psi^{(i+1,0)}=\psi^{(i,L_{1})}
j=1,2,\cdots,L_{2}
B_{j}
Q
\phi^{i,j}=\phi^{i,j-1}-\eta\cdot\nabla_{\phi}\frac{1}{|B_{j}|}\sum_{k\in B_{j%
}}\ell_{c}(\phi^{i-1};(\mathbf{x_{k}},M_{k}))
\phi^{(i+1,0)}=\phi^{(i,L_{2})}
f_{\phi^{(L+1,0)}}
\pi_{\psi^{(L+1,0)}}
\bullet
\text{SM-DDPO}_{\text{end2end}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{SM-DDPO}_{\text{end2end}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\bullet
\text{SM-DDPO}_{\text{end2end}}
F_{1}
F_{1}
\bullet
\text{SM-DDPO}_{\text{end2end}}
\text{SM-DDPO}_{\text{pretrain}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{SM-DDPO}_{\text{pretrained}}
\text{SM-DDPO}_{\text{end2end}}
\bullet
\bullet
F_{1}
F_{1}
F_{1}
F_{1}
F_{1}
(\lambda,\rho)
F_{1}
B
F_{1}
85\%
\ell
\ell
F_{1}
F_{1}
\mu
\mu
\mu
\mu
\mu
\mu
\mu
\mu
\mu
\dagger
\mu
\mu
\dagger
\ddagger
\mu
\mu
\mu
\mu
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\text{F}_{\text{1}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{SM-DDPO}_{\text{pretrained}}
\pm
\pm
\pm
\text{SM-DDPO}_{\text{end2end}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{SM-DDPO}_{\text{pretrained}}
\pm
\pm
\pm
\text{SM-DDPO}_{\text{end2end}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{SM-DDPO}_{\text{pretrained}}
\pm
\pm
\pm
\text{SM-DDPO}_{\text{end2end}}
\pm
\pm
\pm
\alpha
F_{1}
F_{1}
F_{1}
F_{1}
F_{1}
F_{1}
\mathcal{N}(\hat{\mu},\hat{\Sigma})
B
\displaystyle L_{1}(\theta)=-\frac{1}{|B|}\sum_{i\in B}\log p_{X}(\hat{\bf{x}}%
_{i};\theta,\hat{\mu},\hat{\Sigma})
\displaystyle L_{1}(\theta)=-\frac{1}{|B|}\sum_{i\in B}\log p_{X}(\hat{\bf{x}}%
_{i};\theta,\hat{\mu},\hat{\Sigma})
\theta
p_{X}
{\bf{x}}_{i}
\displaystyle\hat{\bf{z}}_{i}^{m}=\mathbb{E}[\hat{\bf{z}}_{i}^{m}|\hat{\bf{z}}%
_{i}^{o};\hat{\mu},\hat{\Sigma}],~{}i\in B
\displaystyle\hat{\bf{z}}_{i}^{m}=\mathbb{E}[\hat{\bf{z}}_{i}^{m}|\hat{\bf{z}}%
_{i}^{o};\hat{\mu},\hat{\Sigma}],~{}i\in B
\displaystyle\hat{\mu}^{(t)}=\rho_{t}\hat{\mu}_{batch}+(1-\rho_{t})\hat{\mu}^{%
(t-1)}
\displaystyle\hat{\mu}^{(t)}
\displaystyle=\rho_{t}\hat{\mu}_{batch}+(1-\rho_{t})\hat{\mu}^{(t-1)}
\displaystyle\hat{\Sigma}^{(t)}=\rho_{t}\hat{\Sigma}_{batch}+(1-\rho_{t})\hat{%
\Sigma}^{(t-1)}
\displaystyle\hat{\Sigma}^{(t)}
\displaystyle=\rho_{t}\hat{\Sigma}_{batch}+(1-\rho_{t})\hat{\Sigma}^{(t-1)}
\hat{\mu}_{batch}
\hat{\Sigma}_{batch}
\displaystyle\hat{\mu}_{batch}=g_{\mu}(\hat{\mu}^{(t)},\hat{\Sigma}^{(t)};\{{%
\bf{z}}_{i},M_{i}\}_{i\in B})
\displaystyle\hat{\mu}_{batch}
\displaystyle=g_{\mu}(\hat{\mu}^{(t)},\hat{\Sigma}^{(t)};\{{\bf{z}}_{i},M_{i}%
\}_{i\in B})
\displaystyle\hat{\Sigma}_{batch}=g_{\Sigma}(\hat{\mu}^{(t)},\hat{\Sigma}^{(t)%
};\{{\bf{z}}_{i},M_{i}\}_{i\in B})
\displaystyle\hat{\Sigma}_{batch}
\displaystyle=g_{\Sigma}(\hat{\mu}^{(t)},\hat{\Sigma}^{(t)};\{{\bf{z}}_{i},M_{%
i}\}_{i\in B})
\displaystyle L_{2}(\theta)=-\frac{1}{|B|}\sum_{i\in B}[\log p_{X}(\tilde{\bf{%
x}}_{i};\theta,\hat{\mu},\hat{\Sigma})-{\color[rgb]{1,0,0}\alpha\|\tilde{\bf{x%
}}_{i}-{\bf{x}}_{i}\|_{2}^{2}}]
\displaystyle L_{2}(\theta)=-\frac{1}{|B|}\sum_{i\in B}[\log p_{X}(\tilde{\bf{%
x}}_{i};\theta,\hat{\mu},\hat{\Sigma})-{\color[rgb]{1,0,0}\alpha\|\tilde{\bf{x%
}}_{i}-{\bf{x}}_{i}\|_{2}^{2}}]
\hat{\bf{X}}=(\hat{\bf{x}}_{1},\hat{\bf{x}}_{2},\cdots,\hat{\bf{x}}_{n})^{\top}
{\bf{M}}=(M_{1},M_{2},\cdots,M_{n})^{\top}
(\hat{\mu}^{(0)},\hat{\Sigma}^{(0)})
\rho_{1},\rho_{2},\cdots,
t=1,2,\cdots,T_{\text{epoch}}
\hat{\bf{X}}_{B}=\{\hat{\bf{x}}_{i}\}_{i\in B}
L_{1}
\theta
{\bf{z}}_{i}=f_{\theta}^{-1}(\hat{\bf{x}}_{i})
i\in B
(\hat{\mu}^{(t-1)},\hat{\Sigma}^{(t-1)})
\{{\bf{z}}_{i}\}_{i\in B}
(\hat{\mu}^{(t)},\hat{\Sigma}^{(t)})
\tilde{\bf{x}}_{i}=f_{\theta}(\hat{\bf{z}}_{i})
i\in B
L_{2}
\theta
\hat{\bf{X}}=(\hat{\bf{x}}_{1},\hat{\bf{x}}_{2},\cdots,\hat{\bf{x}}_{n})^{\top}
{\bf{M}}=(M_{1},M_{2},\cdots,M_{n})^{\top}
(\hat{\mu},\hat{\Sigma})
t=1,2,\cdots,n
{\bf{z}}_{i}=f_{\theta}^{-1}(\hat{\bf{x}}_{i})
i\in B
(\hat{\mu}^{(t-1)},\hat{\Sigma}^{(t-1)})
\{{\bf{z}}_{i}\}_{i\in B}
\tilde{\bf{x}}_{i}=f_{\theta}(\hat{\bf{z}}_{i})
i\in B
\hat{\bf{x}}_{i}=\hat{\bf{x}}_{i}\odot(1-M_{i})+\tilde{\bf{x}}_{i}\odot M_{i}
\{\hat{\bf{x}}_{i}\}_{i=1}^{n}
\ell_{c}
f_{\phi}(\cdot):\mathbb{R}^{d}\to\mathbb{R}^{C}
\phi
\hbox{Imp}_{\theta}(\mathbf{x}\odot M)
\ell_{c}
\ell_{c}(\phi;\mathbf{x},M)=-\sum_{i=1}^{2}w_{i}\log{\frac{\exp{f_{\phi}(\hbox%
{Imp}_{\theta}(\mathbf{x}\odot M))_{i}}}{\sum_{i=1}^{2}\exp{f_{\phi}(\hbox{Imp%
}_{\theta}(\mathbf{x}\odot M))_{i}}}}.
Q
w_{i}
\ell_{rl}
\psi
\displaystyle s_{\theta,\phi}^{\text{emb}}(s)=s_{\theta,\phi}^{\text{emb}}(%
\mathbf{x}\odot M)=(\hbox{Imp}_{\theta}(\mathbf{x}\odot M),f_{\phi}(\hbox{Imp}%
_{\theta}(\mathbf{x}\odot M)),M),
\displaystyle s_{\theta,\phi}^{\text{emb}}(s)=s_{\theta,\phi}^{\text{emb}}(%
\mathbf{x}\odot M)=(\hbox{Imp}_{\theta}(\mathbf{x}\odot M),f_{\phi}(\hbox{Imp}%
_{\theta}(\mathbf{x}\odot M)),M),
\ell_{rl}
\ell_{rl}(\psi;\psi^{old}):=\ell_{CLIP}(\psi;\psi^{old})-c_{1}\ell_{VF}(\psi)+%
c_{2}\text{Ent}[\pi_{\psi}],
\ell_{CLIP}(\psi;\psi^{old})=\hat{\mathbb{E}}_{t}\left[\min(\frac{\pi_{\psi}(a%
_{t}|\hat{s}_{t})}{\pi_{\psi^{old}}(a_{t}|\hat{s}_{t})}\hat{A}_{t},\text{clip}%
(\frac{\pi_{\psi}(a_{t}|\hat{s}_{t})}{\pi_{\psi^{old}}(a_{t}|\hat{s}_{t})},1-%
\epsilon,1+\epsilon)\hat{A}_{t})\right]
\hat{A}_{t}
\ell_{VF}(\psi)=\hat{\mathbb{E}}_{t}[(V_{\psi}(\hat{s}_{t})-V_{t}^{targ})^{2}]
\text{Ent}[\pi_{\psi}]
\hat{\mathbb{E}}_{t}
Q
\hat{s}_{t}=s_{\theta,\phi}^{\text{emb}}(s_{t})
\psi
0,1,\cdots
1,2,\cdots,N_{actor}
\pi_{\psi^{old}}
T
Q
Q
\hat{A}_{1},\cdots,\hat{A}_{T}
\ell_{rl}
\psi
K
M\leq N_{actor}T
\psi_{old}\leftarrow\psi
F_{1}
\Pi^{*}\subseteq\overline{\Pi}:=\cup_{\lambda\geq 0,\rho\leq 0}~{}%
\operatorname*{argmax}_{\pi}\left\{\text{TN}(\pi)+\lambda\cdot\text{TP}(\pi)+%
\rho\cdot\text{Cost}(\pi)\right\}.
F_{1}
\displaystyle R((s,a)=\begin{cases}\rho\cdot c(a),&\text{if }a\in[D]\text{ (%
choosing task panels)}\\
\lambda\cdot\mathbf{1}\{y=\text{P}\},&\text{if }a=\text{P}\text{ (true %
positive diagnosis)}\\
\mathbf{1}\{y=\text{N}\},&\text{if }a=\text{N}\text{ (true negative diagnosis)%
}\end{cases},
\displaystyle R((s,a)=\begin{cases}\rho\cdot c(a),&\text{if }a\in[D]\text{ (%
choosing task panels)}\\
\lambda\cdot\mathbf{1}\{y=\text{P}\},&\text{if }a=\text{P}\text{ (true %
positive diagnosis)}\\
\mathbf{1}\{y=\text{N}\},&\text{if }a=\text{N}\text{ (true negative diagnosis)%
}\end{cases},
(\lambda,\rho)
y
\tau=\min\{t\geq 0|a_{t}\in\{\text{P},\text{N}\}\}
\pi
\displaystyle\text{TP}(\pi):=g(\text{P},\text{P}),~{}\text{TN}(\pi):=g(\text{N%
},\text{N}),~{}\text{FP}(\pi):=g(\text{P},\text{N}),~{}\text{FN}(\pi):=g(\text%
{N},\text{P}).
\displaystyle\text{TP}(\pi):=g(\text{P},\text{P}),~{}\text{TN}(\pi):=g(\text{N%
},\text{N}),~{}\text{FP}(\pi):=g(\text{P},\text{N}),~{}\text{FN}(\pi):=g(\text%
{N},\text{P}).
g(i,j):=\mathbb{E}^{\pi}[\mathbf{1}\{a_{\tau}=i\}\cdot\mathbf{1}\{y=j\}]
i\in\{\text{P},\text{N}\}
j\in\{\text{P},\text{N}\}
\text{Cost}(\pi)=\mathbb{E}^{\pi}\left[\sum_{t=0}^{\tau-1}\sum_{k\in[D]}c(k)%
\cdot\mathbf{1}\{a_{t}=k\}\right],
c(k)
k
\mu:\Delta_{\mathcal{A}}^{\mathcal{S}}\to\mathbb{R}_{\geq 0}^{\mathcal{S}%
\times\mathcal{A}}
\mu^{\pi}(s,a):=\mathbb{E}^{\pi}\left[\sum_{t=0}^{\tau}\mathbf{1}(s_{t}=s,a_{t%
}=a)\right],~{}\forall s\in\mathcal{S},a\in\mathcal{A},
(s,a)
\pi(a|s)=\frac{\mu(s,a)}{\sum_{a\in\mathcal{A}}\mu(s,a)}.
F_{1}
F_{1}
B
\pi^{*}(B)
F_{1}
\pi^{*}(B)
\displaystyle\max_{\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(%
\pi)\leq B,\text{TP}(\pi)\geq\text{TP}(\pi^{*}(B))\right\},
\displaystyle\max_{\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(%
\pi)\leq B,\text{TP}(\pi)\geq\text{TP}(\pi^{*}(B))\right\},
F_{1}
\displaystyle\Pi^{*}\subseteq\cup_{B>0,B^{\prime}\in[0,1]}~{}\operatorname*{%
argmax}_{\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(\pi)\leq B,%
\text{TP}(\pi)\geq B^{\prime}\right\}.
\displaystyle\Pi^{*}\subseteq\cup_{B>0,B^{\prime}\in[0,1]}~{}\operatorname*{%
argmax}_{\pi}\left\{\text{TN}(\pi){\hbox{ subject to }}\text{Cost}(\pi)\leq B,%
\text{TP}(\pi)\geq B^{\prime}\right\}.
(B,B^{\prime})
\displaystyle\max_{\mu}~{}~{}\text{TN}(\mu)
\displaystyle\max_{\mu}~{}
\displaystyle~{}\text{TN}(\mu)
\displaystyle\hbox{ subject to }~{}\text{Cost}(\mu)\leq B,
\displaystyle~{}\text{Cost}(\mu)\leq B,
\displaystyle~{}\text{TP}(\mu)\geq B^{\prime},
\displaystyle~{}\text{TP}(\mu)\geq B^{\prime},
\displaystyle~{}\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]}\mu(s^{%
\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s,
\displaystyle~{}\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]}\mu(s^{%
\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s,
\xi(\cdot)
\mu
\text{TP}(\mu)=\sum_{s.y=\text{P},a=\text{P}}\mu(s,a),~{}\text{TN}(\mu)=\sum_{%
s.y=\text{N},a=\text{N}}\mu(s,a),~{}\text{Cost}(\mu)=\sum_{k\in[D]}c(k)\cdot%
\sum_{s,a=k}\mu(s,a).
\displaystyle\max_{\mu}\min_{\lambda\geq 0,\rho\leq 0}~{}\text{TN}(\mu)+%
\lambda\cdot(\text{TP}(\mu)-B^{\prime})+\rho\cdot(\text{Cost}(\mu)-B)
\displaystyle\max_{\mu}\min_{\lambda\geq 0,\rho\leq 0}~{}
\displaystyle\text{TN}(\mu)+\lambda\cdot(\text{TP}(\mu)-B^{\prime})+\rho\cdot(%
\text{Cost}(\mu)-B)
\displaystyle\hbox{ subject to }\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}%
\in[D]}\mu(s^{\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
\displaystyle\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]}\mu(s^{\prime}%
,a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
\lambda,\rho
\mu
\displaystyle\min_{\lambda\geq 0,\rho\leq 0}\max_{\mu}~{}\text{TN}(\mu)+%
\lambda\cdot(\text{TP}(\mu)-B^{\prime})+\rho\cdot(\text{Cost}(\mu)-B)
\displaystyle\min_{\lambda\geq 0,\rho\leq 0}\max_{\mu}~{}
\displaystyle\text{TN}(\mu)+\lambda\cdot(\text{TP}(\mu)-B^{\prime})+\rho\cdot(%
\text{Cost}(\mu)-B)
\displaystyle\hbox{ subject to }\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}%
\in[D]}\mu(s^{\prime},a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
\displaystyle\sum_{a}\mu(s,a)=\sum_{s^{\prime},a^{\prime}\in[D]}\mu(s^{\prime}%
,a^{\prime})P(s|s^{\prime},a^{\prime})+\xi(s),\forall s.
(\lambda,\rho)
\pi
\max_{\pi}~{}\text{TN}(\pi)+\lambda\cdot\text{TP}(\pi)+\rho\cdot\text{Cost}(%
\pi).
\rho\cdot c(t)
t
\lambda
\displaystyle R((s,a)=\begin{cases}\rho\cdot c(a),&\text{if }a\in[D]\text{ (%
choosing task panels)}\\
\lambda\cdot\mathbf{1}\{y=\text{P}\},&\text{if }a=\text{P}\text{ (true %
positive diagnosis)}\\
\mathbf{1}\{y=\text{N}\},&\text{if }a=\text{N}\text{ (true negative diagnosis)%
}\end{cases}.
\displaystyle R((s,a)=\begin{cases}\rho\cdot c(a),&\text{if }a\in[D]\text{ (%
choosing task panels)}\\
\lambda\cdot\mathbf{1}\{y=\text{P}\},&\text{if }a=\text{P}\text{ (true %
positive diagnosis)}\\
\mathbf{1}\{y=\text{N}\},&\text{if }a=\text{N}\text{ (true negative diagnosis)%
}\end{cases}.
\displaystyle\Pi^{*}_{\text{AM}}=\cup_{B>0}~{}\operatorname*{argmax}_{\pi}\{%
\text{AM}(\pi){\hbox{ subject to }}\text{Cost}(\pi)\leq B\}
\displaystyle\Pi^{*}_{\text{AM}}=\cup_{B>0}~{}\operatorname*{argmax}_{\pi}\{%
\text{AM}(\pi){\hbox{ subject to }}\text{Cost}(\pi)\leq B\}
\text{AM}(\pi)=\frac{1}{2}(\text{TPR}(\pi)+\text{TNR}(\pi))
\text{TPR}(\pi):=\frac{\text{TP}(\pi)}{\text{TP}(\pi)+\text{FN}(\pi)},\quad%
\text{TNR}(\pi):=\frac{\text{TN}(\pi)}{\text{TN}(\pi)+\text{FP}(\pi)},
\text{TP}(\pi),\text{TN}(\pi),\text{FP}(\pi),\text{FN}(\pi)
\lambda>0
\text{TP}(\pi)+\text{FN}(\pi)=\frac{1}{1+\lambda}
\text{TN}(\pi)+\text{FP}(\pi)=\frac{\lambda}{1+\lambda}
\text{AM}(\pi)=\frac{1+\lambda}{2\lambda}(\lambda\text{TP}(\pi)+\text{TN}(\pi))
\Pi^{*}_{\text{AM}}=\cup_{\rho\leq 0}~{}\operatorname*{argmax}_{\pi}\left\{%
\text{TN}(\pi)+\lambda\cdot\text{TP}(\pi)+\rho\cdot\text{Cost}(\pi)\right\}.
