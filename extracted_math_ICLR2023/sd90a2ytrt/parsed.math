{\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}}),\quad{\bm{z}}\sim q_{\xi}({\bm{z}}),%
\quad q_{\varphi}({\bm{x}})=\int q_{\phi}({\bm{x}}|{\bm{z}})q_{\xi}({\bm{z}})d%
{\bm{z}}.
\varphi=\{\phi,\xi\}
q_{\phi}({\bm{x}}|{\bm{z}})
q_{\xi}({\bm{z}})
q_{\varphi}({\bm{x}})
q_{\xi}({\bm{z}})
q_{\phi}({\bm{x}}|{\bm{z}})
\log p(D)\geq\text{ELBO}:=\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\left%
[\log p(D,{\bm{x}})-\log q_{\varphi}({\bm{x}})\right],
D
q_{\varphi}({\bm{x}})
\text{ELBO}\geq\underline{\mathcal{L}}_{L}:=\mathbb{E}_{{\bm{z}}\sim q_{\xi}({%
\bm{z}}),{\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}})}\mathbb{E}_{{\bm{z}}^{(1)},%
\cdots,{\bm{z}}^{(L)}\overset{i.i.d.}{\sim}q_{\xi}({\bm{z}})}\log\frac{p(D,{%
\bm{x}})}{\frac{1}{L+1}\left(q_{\phi}({\bm{x}}|{\bm{z}})+\sum_{l=1}^{L}q_{\phi%
}({\bm{x}}|{\bm{z}}^{(l)})\right)}.
\underline{\mathcal{L}}_{L}
L\rightarrow\infty
\{L_{t}\}_{t=1}^{\infty}
\underline{\mathcal{L}}_{L_{t}}
t\text{-}th
q_{\xi}({\bm{z}})=q({\bm{z}})
q_{\phi}({\bm{x}}|{\bm{z}})
{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}}),{\bm{\epsilon}}\sim q_{\bm{%
\epsilon}}({\bm{\epsilon}})\Leftrightarrow{\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{%
z}})
\displaystyle\nabla_{\phi}\text{ELBO}=\nabla_{\phi}\mathbb{E}_{q_{\bm{\epsilon%
}}({\bm{\epsilon}})q({\bm{z}})}\left[\left.\log p(D,{\bm{x}})-\log q_{\phi}({%
\bm{x}})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\right],
\displaystyle\nabla_{\phi}\text{ELBO}
\displaystyle=\nabla_{\phi}\mathbb{E}_{q_{\bm{\epsilon}}({\bm{\epsilon}})q({%
\bm{z}})}\left[\left.\log p(D,{\bm{x}})-\log q_{\phi}({\bm{x}})\right|_{{\bm{x%
}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\right],
\displaystyle:=\mathbb{E}_{q_{\bm{\epsilon}}({\bm{\epsilon}})q({\bm{z}})}\left%
[g_{\phi}^{mod}({\bm{z}},{\bm{\epsilon}})+g_{\phi}^{ent}({\bm{z}},{\bm{%
\epsilon}})\right],
\displaystyle:=\mathbb{E}_{q_{\bm{\epsilon}}({\bm{\epsilon}})q({\bm{z}})}\left%
[g_{\phi}^{mod}({\bm{z}},{\bm{\epsilon}})+g_{\phi}^{ent}({\bm{z}},{\bm{%
\epsilon}})\right],
\displaystyle g_{\phi}^{mod}({\bm{z}},{\bm{\epsilon}}):=\left.\nabla_{\bm{x}}%
\log p(D,{\bm{x}})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_%
{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}}),
\displaystyle g_{\phi}^{mod}({\bm{z}},{\bm{\epsilon}})
\displaystyle:=\left.\nabla_{\bm{x}}\log p(D,{\bm{x}})\right|_{{\bm{x}}=T_{%
\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}}),
\displaystyle g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}}):=-\left.\mathbb{E}_{q_{%
\phi}({\bm{z}}^{\prime}|{\bm{x}})}\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z%
}}^{\prime})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_{\phi}%
T_{\phi}({\bm{z}},{\bm{\epsilon}}).
\displaystyle g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}})
\displaystyle:=-\left.\mathbb{E}_{q_{\phi}({\bm{z}}^{\prime}|{\bm{x}})}\nabla_%
{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}}^{\prime})\right|_{{\bm{x}}=T_{\phi}({%
\bm{z}},{\bm{\epsilon}})}\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}}).
q_{\phi}({\bm{z}}|{\bm{x}})
p({\bm{x}})
p({\bm{x}})
S({\bm{x}})
\nabla\log p({\bm{x}})
\mathbb{E}_{p({\bm{x}})}[\frac{1}{2}\|S({\bm{x}})-\nabla_{\bm{x}}\log p({\bm{x%
}})\|_{2}^{2}]
\mathbb{E}_{{\bm{x}}\sim p({\bm{x}})}[\operatorname{Tr}(\nabla_{\bm{x}}(S({\bm%
{x}})))+\frac{1}{2}\|S({\bm{x}})\|_{2}^{2}].
\operatorname{Tr}\nabla_{\bm{x}}(S({\bm{x}}))
q_{\sigma}(\tilde{{\bm{x}}}|{\bm{x}})
q_{\sigma}(\tilde{{\bm{x}}})=\int q_{\sigma}(\tilde{{\bm{x}}}|{\bm{x}})p({\bm{%
x}})d{\bm{x}}
q_{\sigma}(\tilde{{\bm{x}}})
\frac{1}{2}\mathbb{E}_{q_{\sigma}(\tilde{{\bm{x}}}|{\bm{x}})p({\bm{x}})}\left[%
\|S(\tilde{{\bm{x}}})-\nabla_{\tilde{{\bm{x}}}}\log q_{\sigma}(\tilde{{\bm{x}}%
}|{\bm{x}})\|_{2}^{2}\right].
\nabla_{\tilde{{\bm{x}}}}\log q_{\sigma}(\tilde{{\bm{x}}}|{\bm{x}})
\nabla\log p({\bm{x}})
q_{\phi}({\bm{x}}|{\bm{z}})
\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})
\min_{\varphi}\quad\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}}%
)-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})\|_{2}^{2}.
S({\bm{x}})=\nabla_{\bm{x}}\log p({\bm{x}}|D)=\nabla_{\bm{x}}\log p(D,{\bm{x}})
q_{\varphi}({\bm{x}})
\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})
q_{\varphi}({\bm{x}})
\varphi
S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})
\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})\|_{2}^{2}=\max_{f({\bm%
{x}})}\quad 2f({\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{%
x}})]-\|f({\bm{x}})\|_{2}^{2},\quad\forall{\bm{x}}.
f({\bm{x}})
{\bm{x}}
f^{\varphi}({\bm{x}}):=S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}}).
\min_{\varphi}\max_{f}\quad\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}2f({%
\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f({\bm{x%
}})\|_{2}^{2}.
q_{\varphi}({\bm{x}})
\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})
\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})=\frac{1}{q_{\varphi}({\bm{x}})}\int q%
_{\xi}({\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})\nabla_{\bm{x}}\log q_{\phi}({\bm{x%
}}|{\bm{z}})d{\bm{z}}.
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}f({\bm{x}})^{T}%
\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})=\int q_{\varphi}({\bm{x}})f({\bm{x}}%
)^{T}\frac{1}{q_{\varphi}({\bm{x}})}\int q_{\xi}({\bm{z}})q_{\phi}({\bm{x}}|{%
\bm{z}})\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}d{\bm{x}},
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}f({\bm{x}})^{T}%
\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})
\displaystyle=\int q_{\varphi}({\bm{x}})f({\bm{x}})^{T}\frac{1}{q_{\varphi}({%
\bm{x}})}\int q_{\xi}({\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})\nabla_{\bm{x}}\log q%
_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}d{\bm{x}},
\displaystyle=\iint q_{\xi}({\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})f({\bm{x}})^{T%
}\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}d{\bm{x}},
\displaystyle=\iint q_{\xi}({\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})f({\bm{x}})^{T%
}\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}d{\bm{x}},
\displaystyle=\mathbb{E}_{{\bm{z}}\sim q_{\xi}({\bm{z}}),{\bm{x}}\sim q_{\phi}%
({\bm{x}}|{\bm{z}})}f({\bm{x}})^{T}\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{%
z}}).
\displaystyle=\mathbb{E}_{{\bm{z}}\sim q_{\xi}({\bm{z}}),{\bm{x}}\sim q_{\phi}%
({\bm{x}}|{\bm{z}})}f({\bm{x}})^{T}\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{%
z}}).
q_{\varphi}({\bm{x}})
\min_{\varphi}\max_{f}\quad\mathbb{E}_{{\bm{z}}\sim q_{\xi}({\bm{z}}),{\bm{x}}%
\sim q_{\phi}({\bm{x}}|{\bm{z}})}2f({\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}%
\log q_{\phi}({\bm{x}}|{\bm{z}})]-\|f({\bm{x}})\|_{2}^{2},
\varphi=\{\phi,\xi\}
f
(\varphi^{*},f^{*})
f^{*},\varphi^{*}
\displaystyle f^{*}({\bm{x}})=S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi^{*}}(%
{\bm{x}}),
\displaystyle f^{*}({\bm{x}})
\displaystyle=S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi^{*}}({\bm{x}}),
\displaystyle\varphi^{*}\in\operatorname*{arg\,min}_{\varphi}\{\mathbb{E}_{{%
\bm{x}}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi%
}({\bm{x}})\|_{2}^{2}\}.
\displaystyle\varphi^{*}
\displaystyle\in\operatorname*{arg\,min}_{\varphi}\{\mathbb{E}_{{\bm{x}}\sim q%
_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})\|%
_{2}^{2}\}.
q_{\varphi}({\bm{x}})
f
f_{\psi}({\bm{x}})
{\bm{z}}\sim q_{\xi}({\bm{z}}),{\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}})
{\bm{x}}=T_{\phi}({\bm{z}};{\bm{\epsilon}}),{\bm{z}}=h_{\xi}({\bm{\gamma}})
{\bm{\epsilon}}\sim q_{\bm{\epsilon}}({\bm{\epsilon}}),{\bm{\gamma}}\sim q_{%
\bm{\gamma}}({\bm{\gamma}})
\min_{\varphi}\max_{\psi}\quad\mathbb{E}_{q_{\bm{\gamma}}({\bm{\gamma}}),q_{%
\bm{\epsilon}}({\bm{\epsilon}})}\left[\left.2f_{\psi}({\bm{x}})^{T}[S({\bm{x}}%
)-\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})-\frac{1}{2}f_{\psi}({\bm{x}}%
)]\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}}),{\bm{z}}=h_{\xi}({\bm{%
\gamma}})}\right],
\varphi,\psi
f
K
f
q_{\varphi}
q_{\phi}({\bm{x}}|{\bm{z}})\sim\mathcal{N}(\mu_{\phi}({\bm{z}}),\text{diag}\{%
\bm{\sigma}^{2}_{\phi}({\bm{z}})\})
{\bm{x}}=\mu_{\phi}({\bm{z}})+\bm{\sigma}_{\phi}({\bm{z}})\odot{\bm{\epsilon}}%
,\quad\text{where}\quad{\bm{\epsilon}}\sim\mathcal{N}(0,{\bm{I}}),
\odot
\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})=-\bm{\sigma}_{\phi}({\bm{z}})^%
{-1}\odot{\bm{\epsilon}}
S({\bm{x}})
N
K
f_{\psi}({\bm{x}})
\varphi
\psi
\varphi_{0}
\psi_{0}
t=0
N-1
\{{\bm{\gamma}}^{(1)},{\bm{\gamma}}^{(2)},\cdots,{\bm{\gamma}}^{(m)}\}
q_{\bm{\gamma}}({\bm{\gamma}})
{\bm{z}}^{(i)}=h_{\xi}({\bm{\gamma}}^{(i)}),i=1,\ldots,m
\{{\bm{\epsilon}}^{(1)},{\bm{\epsilon}}^{(2)},\cdots,{\bm{\epsilon}}^{(m)}\}
\mathcal{N}(0,{\bm{I}})
{\bm{x}}^{(i)}=\mu_{\phi}({\bm{z}}^{(i)})+\bm{\sigma}_{\phi}({\bm{z}}^{(i)})%
\odot{\bm{\epsilon}}^{(i)}
\varphi
\nabla_{\varphi}\frac{1}{m}\sum_{i=1}^{m}f_{\psi}({\bm{x}}^{(i)})^{T}[S({\bm{x%
}}^{(i)})+\bm{\sigma}_{\phi}({\bm{z}}^{(i)})^{-1}\odot{\bm{\epsilon}}^{(i)}]-%
\frac{1}{2}\|f_{\psi}({\bm{x}}^{(i)})\|_{2}^{2}.
j=1
K
\{{\bm{\gamma}}^{(1)},{\bm{\gamma}}^{(2)},\cdots,{\bm{\gamma}}^{(m)}\}
q_{\bm{\gamma}}({\bm{\gamma}})
{\bm{z}}^{(i)}=h_{\xi}({\bm{\gamma}}^{(i)}),i=1,\ldots,m
\{{\bm{\epsilon}}^{(1)},{\bm{\epsilon}}^{(2)},\cdots,{\bm{\epsilon}}^{(m)}\}
\mathcal{N}(0,{\bm{I}})
{\bm{x}}^{(i)}=\mu_{\phi}({\bm{z}}^{(i)})+\bm{\sigma}_{\phi}({\bm{z}}^{(i)})%
\odot{\bm{\epsilon}}^{(i)}
\psi
\nabla_{\psi}\frac{1}{m}\sum_{i=1}^{m}f_{\psi}({\bm{x}}^{(i)})^{T}[S({\bm{x}}^%
{(i)})+\bm{\sigma}_{\phi}({\bm{z}}^{(i)})^{-1}\odot{\bm{\epsilon}}^{(i)}]-%
\frac{1}{2}\|f_{\psi}({\bm{x}}^{(i)})\|_{2}^{2}.
q_{\varphi}({\bm{x}})
\Omega
\varphi
\forall\varphi\in\Omega
f_{\hat{\psi}(\varphi)}
\epsilon
\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\|\hat{R}_{\varphi}({\bm{x}})\|%
_{2}^{2}\leq\epsilon,\quad\text{where}\quad\hat{R}_{\varphi}({\bm{x}}):=S({\bm%
{x}})-\nabla\log q_{\varphi}({\bm{x}})-f_{\hat{\psi}(\varphi)}.
\varphi^{*}
\tilde{\varphi}
f_{\hat{\psi}(\varphi)}
\epsilon
\tilde{\varphi}:=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm%
{x}}\sim q_{\varphi}({\bm{x}})}2f_{\hat{\psi}(\varphi)}({\bm{x}})^{T}[S({\bm{x%
}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f_{\hat{\psi}(\varphi)}({\bm{%
x}})\|_{2}^{2}\}.
\mathbb{E}_{{\bm{x}}\sim q_{\tilde{\varphi}}({\bm{x}})}\|S({\bm{x}})-\nabla_{%
\bm{x}}\log q_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2}\leq\mathbb{E}_{{\bm{x}}%
\sim q_{\varphi^{*}}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi^{*%
}}({\bm{x}})\|_{2}^{2}+\epsilon.
\mathbb{E}_{{\bm{x}}\sim q_{\varphi^{*}}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x%
}}\log q_{\varphi^{*}}({\bm{x}})\|_{2}^{2}
f_{\psi}({\bm{x}})
f_{\psi}({\bm{x}})
\varphi
f_{\psi}({\bm{x}})
\min_{\psi}\;\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-%
\nabla\log q_{\varphi}({\bm{x}})-f_{\psi}({\bm{x}})\|_{2}^{2},
f_{\psi}({\bm{x}})
\varphi
f_{\psi}
q_{\phi}({\bm{x}}|{\bm{z}})=\mathcal{N}({\bm{x}}|\mu_{\phi}({\bm{z}}),\text{%
diag}(\bm{\sigma}))
\bm{\sigma}
{\bm{x}}
q({\bm{z}})=\mathcal{N}(0,{\bm{I}})
\varphi=\{\phi,\bm{\sigma}\}
\mu_{\phi}({\bm{z}})
[3,50,50,2]
f_{\psi}({\bm{x}})
[2,128,128,2]
K=1
L=50
f_{\psi}({\bm{x}})
f_{\psi}({\bm{x}})
f^{*}({\bm{x}})
p({\bm{x}})
q_{\varphi}({\bm{x}})
f_{\psi}({\bm{x}})
f_{\psi}({\bm{x}})
f_{\psi}({\bm{x}})
f_{\psi}({\bm{x}})
\log p(y_{i}|{\bm{x}}_{i}^{\prime},{\bm{\beta}})=y_{i}*{\bm{\beta}}^{T}{\bm{x}%
}_{i}^{\prime}-\log(1+\exp({\bm{\beta}}^{T}{\bm{x}}_{i}^{\prime})),y_{i}\in\{0%
,1\},{\bm{x}}_{i}^{\prime}=\bigl{[}\begin{smallmatrix}1\\
{\bm{x}}_{i}\end{smallmatrix}\bigl{]}.
{\bm{x}}_{i}
y_{i}\in\{0,1\}
{\bm{\beta}}\sim\mathcal{N}({\bm{0}},\alpha^{-1}{\bm{I}})
\alpha=0.01
{\bm{x}}_{i}
q({\bm{z}})
\mu_{\phi}({\bm{z}})
[10,100,100,22]
f_{\psi}({\bm{\beta}})
[22,256,256,22]
K=1
L=100
5
{\bm{\beta}}
10^{-4}
\beta_{4}
\beta_{5}
{\bm{\beta}}
N
\{(x_{i},y_{i}):i=1,\ldots,N\}
y_{i}\in\{1,\ldots,R\}
p(y_{i}=r|x_{i})\propto\exp([1,{\bm{x}}_{i}^{T}]\cdot{\bm{\beta}}_{r}),\;r\in%
\{1,2,\cdots,R\},
{\bm{\beta}}=({\bm{\beta}}_{1}^{T},{\bm{\beta}}_{2}^{T},\cdots,{\bm{\beta}}_{R%
}^{T})^{T}
\times
R=10
R=12
q({\bm{z}})
\mu_{\phi}({\bm{z}})
f_{\psi}({\bm{\beta}})
\mu_{\phi}({\bm{z}})
f_{\psi}({\bm{\beta}})
K=1
L=200
m=1
f_{\psi}({\bm{\beta}})
90\%
10\%
q({\bm{z}})
10
\mu_{\phi}({\bm{z}})
16
f_{\psi}({\bm{x}})
2.714_{\pm 0.08}
2.817_{\pm 0.11}
3.186_{\pm 0.09}
2.621_{\pm 0.10}
2.420_{\pm 0.09}
2.397_{\pm 0.07}
3.164_{\pm 0.08}
2.396_{\pm 0.13}
6.205_{\pm 0.12}
6.049_{\pm 0.10}
6.512_{\pm 0.06}
5.392_{\pm 0.09}
3.247_{\pm 0.04}
3.221_{\pm 0.11}
3.978_{\pm 0.05}
3.156_{\pm 0.03}
4.818_{\pm 0.05}
4.908_{\pm 0.07}
4.768_{\pm 0.03}
4.903_{\pm 0.04}
2.994_{\pm 0.02}
3.016_{\pm 0.02}
2.979_{\pm 0.01}
3.015_{\pm 0.04}
4.13_{\pm 0.02}
4.134_{\pm 0.03}
4.067_{\pm 0.01}
4.086_{\pm 0.05}
2.853_{\pm 0.04}
2.852_{\pm 0.06}
2.965_{\pm 0.03}
2.854_{\pm 0.03}
0.640_{\pm 0.03}
0.646_{\pm 0.04}
0.639_{\pm 0.01}
0.646_{\pm 0.06}
0.975_{\pm 0.02}
0.983_{\pm 0.04}
0.976_{\pm 0.01}
0.985_{\pm 0.07}
0.577_{\pm 0.11}
0.675_{\pm 0.06}
0.651_{\pm 0.03}
0.560_{\pm 0.08}
0.871_{\pm 0.13}
1.074_{\pm 0.07}
0.983_{\pm 0.03}
0.836_{\pm 0.07}
1.902_{\pm 0.21}
2.1407_{\pm 0.18}
2.377_{\pm 0.11}
1.559_{\pm 0.15}
2.147_{\pm 0.11}
2.309_{\pm 0.09}
2.631_{\pm 0.08}
1.683_{\pm 0.18}
\displaystyle\nabla_{\phi}\text{ELBO}=\nabla_{\phi}\mathbb{E}_{q({\bm{\epsilon%
}})q({\bm{z}})}\left[\left.\log p(D,{\bm{x}})-\log q_{\phi}({\bm{x}})\right|_{%
{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\right],
\displaystyle\nabla_{\phi}\text{ELBO}
\displaystyle=\nabla_{\phi}\mathbb{E}_{q({\bm{\epsilon}})q({\bm{z}})}\left[%
\left.\log p(D,{\bm{x}})-\log q_{\phi}({\bm{x}})\right|_{{\bm{x}}=T_{\phi}({%
\bm{z}},{\bm{\epsilon}})}\right],
\displaystyle=\mathbb{E}_{q({\bm{\epsilon}})q({\bm{z}})}\left[\left.\nabla_{%
\bm{x}}\log p(D,{\bm{x}})\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}})-%
\nabla_{\bm{x}}\log q_{\phi}({\bm{x}})\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{%
\epsilon}})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\right],
\displaystyle=\mathbb{E}_{q({\bm{\epsilon}})q({\bm{z}})}\left[\left.\nabla_{%
\bm{x}}\log p(D,{\bm{x}})\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}})-%
\nabla_{\bm{x}}\log q_{\phi}({\bm{x}})\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{%
\epsilon}})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\right],
\displaystyle:=\mathbb{E}_{q({\bm{\epsilon}})q({\bm{z}})}\left[g_{\phi}^{mod}(%
{\bm{z}},{\bm{\epsilon}})-g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}})\right],
\displaystyle:=\mathbb{E}_{q({\bm{\epsilon}})q({\bm{z}})}\left[g_{\phi}^{mod}(%
{\bm{z}},{\bm{\epsilon}})-g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}})\right],
\displaystyle g_{\phi}^{mod}({\bm{z}},{\bm{\epsilon}}):=\left.\nabla_{\bm{x}}%
\log p(D,{\bm{x}})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_%
{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}}),
\displaystyle g_{\phi}^{mod}({\bm{z}},{\bm{\epsilon}})
\displaystyle:=\left.\nabla_{\bm{x}}\log p(D,{\bm{x}})\right|_{{\bm{x}}=T_{%
\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}}),
\displaystyle g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}}):=-\left.\nabla_{\bm{x}}%
\log q_{\phi}({\bm{x}})\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}%
\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{\epsilon}}).
\displaystyle g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}})
\displaystyle:=-\left.\nabla_{\bm{x}}\log q_{\phi}({\bm{x}})\right|_{{\bm{x}}=%
T_{\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_{\phi}T_{\phi}({\bm{z}},{\bm{%
\epsilon}}).
\nabla_{\bm{x}}\log q_{\phi}({\bm{x}})=\int q_{\phi}({\bm{z}}^{\prime}|{\bm{x}%
})\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}}^{\prime})d{\bm{z}}^{\prime}.
g_{\phi}^{ent}
g_{\phi}^{ent}({\bm{z}},{\bm{\epsilon}})=-\left.\mathbb{E}_{q_{\phi}({\bm{z}}^%
{\prime}|{\bm{x}})}\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}}^{\prime})%
\right|_{{\bm{x}}=T_{\phi}({\bm{z}},{\bm{\epsilon}})}\nabla_{\phi}T_{\phi}({%
\bm{z}},{\bm{\epsilon}}).
f
\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\max_{f({\bm{x}})}\{2f({\bm{x}}%
)^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f({\bm{x}})\|_{%
2}^{2}\}.
q_{\varphi}({\bm{x}})
\displaystyle\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})=\frac{1}{q_{\varphi}({%
\bm{x}})}\nabla_{\bm{x}}\int q_{\xi}({\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})d{\bm%
{z}}
\displaystyle\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})
\displaystyle=\frac{1}{q_{\varphi}({\bm{x}})}\nabla_{\bm{x}}\int q_{\xi}({\bm{%
z}})q_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}
\displaystyle=\frac{1}{q_{\varphi}({\bm{x}})}\int q_{\xi}({\bm{z}})q_{\phi}({%
\bm{x}}|{\bm{z}})\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}.
\displaystyle=\frac{1}{q_{\varphi}({\bm{x}})}\int q_{\xi}({\bm{z}})q_{\phi}({%
\bm{x}}|{\bm{z}})\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})d{\bm{z}}.
q_{\varphi}({\bm{x}})
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\max_{f({\bm{x}})}%
\{2f({\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f(%
{\bm{x}})\|_{2}^{2}\}
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\max_{f({\bm{x}})}%
\{2f({\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f(%
{\bm{x}})\|_{2}^{2}\}
\displaystyle=\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\max_{f({\bm{x}})%
}\{2f({\bm{x}})^{T}[S({\bm{x}})-\frac{1}{q_{\varphi}({\bm{x}})}\int q_{\xi}({%
\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{%
z}})d{\bm{z}}]-\|f({\bm{x}})\|_{2}^{2}\}
\displaystyle=
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}\max_{f({\bm{x}})}%
\{2f({\bm{x}})^{T}[S({\bm{x}})-\frac{1}{q_{\varphi}({\bm{x}})}\int q_{\xi}({%
\bm{z}})q_{\phi}({\bm{x}}|{\bm{z}})\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{%
z}})d{\bm{z}}]-\|f({\bm{x}})\|_{2}^{2}\}
\displaystyle=\max_{f({\bm{x}})}\{\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}%
})}[2f({\bm{x}})^{T}S({\bm{x}})-\|f({\bm{x}})\|_{2}^{2}]-\int q_{\xi}({\bm{z}}%
)q_{\phi}({\bm{x}}|{\bm{z}})2f({\bm{x}})^{T}\nabla_{\bm{x}}\log q_{\phi}({\bm{%
x}}|{\bm{z}})d{\bm{x}}d{\bm{z}}\}
\displaystyle=
\displaystyle\max_{f({\bm{x}})}\{\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}}%
)}[2f({\bm{x}})^{T}S({\bm{x}})-\|f({\bm{x}})\|_{2}^{2}]-\int q_{\xi}({\bm{z}})%
q_{\phi}({\bm{x}}|{\bm{z}})2f({\bm{x}})^{T}\nabla_{\bm{x}}\log q_{\phi}({\bm{x%
}}|{\bm{z}})d{\bm{x}}d{\bm{z}}\}
\displaystyle=\max_{f({\bm{x}})}\{\mathbb{E}_{{\bm{z}}\sim q_{\xi}({\bm{z}}),{%
\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}})}[2f({\bm{x}})^{T}(S(x)-\nabla_{\bm{x}}%
\log q_{\phi}({\bm{x}}|{\bm{z}}))-\|f({\bm{x}})\|_{2}^{2}]\}
\displaystyle=
\displaystyle\max_{f({\bm{x}})}\{\mathbb{E}_{{\bm{z}}\sim q_{\xi}({\bm{z}}),{%
\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}})}[2f({\bm{x}})^{T}(S(x)-\nabla_{\bm{x}}%
\log q_{\phi}({\bm{x}}|{\bm{z}}))-\|f({\bm{x}})\|_{2}^{2}]\}
\varphi=\{\xi,\phi\}
\min_{\varphi}\max_{f}\quad\mathbb{E}_{{\bm{z}}\sim q_{\xi}({\bm{z}}),{\bm{x}}%
\sim q_{\phi}({\bm{x}}|{\bm{z}})}2f({\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}%
\log q_{\phi}({\bm{x}}|{\bm{z}})]-\|f({\bm{x}})\|_{2}^{2}.
(\varphi^{*},f^{*})
\varphi=\varphi^{*}
f^{*}({\bm{x}})
f^{*}
f^{*}({\bm{x}})=S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi^{*}}({\bm{x}}).
f^{*}({\bm{x}})
\varphi^{*}
\displaystyle\varphi^{*}\in\operatorname*{arg\,min}_{\varphi}\{\mathbb{E}_{{%
\bm{z}}\sim q_{\xi}({\bm{z}}),{\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}})}2f^{*}(%
{\bm{x}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})]-\|f%
^{*}({\bm{x}})\|_{2}^{2}\},
\displaystyle\varphi^{*}
\displaystyle\in\operatorname*{arg\,min}_{\varphi}\{\mathbb{E}_{{\bm{z}}\sim q%
_{\xi}({\bm{z}}),{\bm{x}}\sim q_{\phi}({\bm{x}}|{\bm{z}})}2f^{*}({\bm{x}})^{T}%
[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\phi}({\bm{x}}|{\bm{z}})]-\|f^{*}({\bm{x}}%
)\|_{2}^{2}\},
\displaystyle\in\operatorname*{arg\,min}_{\varphi}\{\mathbb{E}_{{\bm{x}}\sim q%
_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})\|%
_{2}^{2}\}.
\displaystyle\in\operatorname*{arg\,min}_{\varphi}\{\mathbb{E}_{{\bm{x}}\sim q%
_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})\|%
_{2}^{2}\}.
\epsilon\text{-}trained
f_{\hat{\psi}(\varphi)}
\displaystyle\tilde{\varphi}=\operatorname*{arg\,min}_{\varphi\in\Omega}\{%
\mathbb{E}_{{\bm{x}}\sim q_{\varphi}({\bm{x}})}2f_{\hat{\psi}(\varphi)}({\bm{x%
}})^{T}[S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f_{\hat{\psi}%
(\varphi)}({\bm{x}})\|_{2}^{2}\},
\displaystyle\tilde{\varphi}
\displaystyle=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm{x}%
}\sim q_{\varphi}({\bm{x}})}2f_{\hat{\psi}(\varphi)}({\bm{x}})^{T}[S({\bm{x}})%
-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})]-\|f_{\hat{\psi}(\varphi)}({\bm{x}}%
)\|_{2}^{2}\},
\displaystyle=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm{x}%
}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm%
{x}})\|_{2}^{2}-\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})-f_{%
\hat{\psi}(\varphi)}({\bm{x}})\|_{2}^{2}\},
\displaystyle=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm{x}%
}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm%
{x}})\|_{2}^{2}-\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{x}})-f_{%
\hat{\psi}(\varphi)}({\bm{x}})\|_{2}^{2}\},
\displaystyle=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm{x}%
}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm%
{x}})\|_{2}^{2}-\|\hat{R}_{\varphi}({\bm{x}})\|_{2}^{2}\}.
\displaystyle=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm{x}%
}\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm%
{x}})\|_{2}^{2}-\|\hat{R}_{\varphi}({\bm{x}})\|_{2}^{2}\}.
S({\bm{x}})
\nabla_{\bm{x}}\log q_{\tilde{\varphi}}({\bm{x}})
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\tilde{\varphi}}({\bm{x}})}\|S({\bm{x%
}})-\nabla_{\bm{x}}\log q_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2},
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\tilde{\varphi}}({\bm{x}})}\|S({\bm{x%
}})-\nabla_{\bm{x}}\log q_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2},
\displaystyle=\mathbb{E}_{{\bm{x}}\sim q_{\tilde{\varphi}}({\bm{x}})}\|S({\bm{%
x}})-\nabla_{\bm{x}}\log q_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2}-\|\hat{R}_{%
\tilde{\varphi}}({\bm{x}})\|_{2}^{2}+\|\hat{R}_{\tilde{\varphi}}({\bm{x}})\|_{%
2}^{2},
\displaystyle=
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\tilde{\varphi}}({\bm{x}})}\|S({\bm{x%
}})-\nabla_{\bm{x}}\log q_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2}-\|\hat{R}_{%
\tilde{\varphi}}({\bm{x}})\|_{2}^{2}+\|\hat{R}_{\tilde{\varphi}}({\bm{x}})\|_{%
2}^{2},
\displaystyle\leq\mathbb{E}_{{\bm{x}}\sim q_{\varphi^{*}}({\bm{x}})}\|S({\bm{x%
}})-\nabla_{\bm{x}}\log q_{\varphi^{*}}({\bm{x}})\|_{2}^{2}-\|\hat{R}_{\varphi%
^{*}}({\bm{x}})\|_{2}^{2}+\|\hat{R}_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2},
\displaystyle\leq
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi^{*}}({\bm{x}})}\|S({\bm{x}})-%
\nabla_{\bm{x}}\log q_{\varphi^{*}}({\bm{x}})\|_{2}^{2}-\|\hat{R}_{\varphi^{*}%
}({\bm{x}})\|_{2}^{2}+\|\hat{R}_{\tilde{\varphi}}({\bm{x}})\|_{2}^{2},
\displaystyle\leq\mathbb{E}_{{\bm{x}}\sim q_{\varphi^{*}}({\bm{x}})}\|S({\bm{x%
}})-\nabla_{\bm{x}}\log q_{\varphi^{*}}({\bm{x}})\|_{2}^{2}+\epsilon,
\displaystyle\leq
\displaystyle\mathbb{E}_{{\bm{x}}\sim q_{\varphi^{*}}({\bm{x}})}\|S({\bm{x}})-%
\nabla_{\bm{x}}\log q_{\varphi^{*}}({\bm{x}})\|_{2}^{2}+\epsilon,
\varphi^{*}:=\operatorname*{arg\,min}_{\varphi\in\Omega}\{\mathbb{E}_{{\bm{x}}%
\sim q_{\varphi}({\bm{x}})}\|S({\bm{x}})-\nabla_{\bm{x}}\log q_{\varphi}({\bm{%
x}})\|_{2}^{2}\}
f_{\hat{\psi}(\varphi)}
\epsilon\text{-}trained
\|\hat{R}_{\varphi^{*}}({\bm{x}})\|_{2}^{2}
q({\bm{z}})
q({\bm{z}}|{\bm{x}})
\log q({\bm{z}}|{\bm{x}})
m
{\bm{x}}_{1},{\bm{x}}_{2},\cdots,{\bm{x}}_{m}
[\nabla_{\bm{z}}\log q({\bm{z}}|{\bm{x}}_{1}),\nabla_{\bm{z}}\log q({\bm{z}}|{%
\bm{x}}_{2}),\cdots,\nabla_{\bm{z}}\log q({\bm{z}}|{\bm{x}}_{m})]
m=1
p({\bm{x}})
{\bm{x}}=(v_{1},v_{1}^{2}+v_{2}+1)
{\bm{v}}\sim\mathcal{N}({\bm{0}},\Sigma)
\Sigma=\bigl{[}\begin{smallmatrix}1&0.9\\
0.9&1\end{smallmatrix}\bigl{]}
\frac{1}{2}\mathcal{N}({\bm{x}}|{\bm{\mu}}_{1},{\bm{I}})+\frac{1}{2}\mathcal{N%
}({\bm{x}}|{\bm{\mu}}_{2},{\bm{I}})
-{\bm{\mu}}_{1}={\bm{\mu}}_{2}=[2,0]^{T}
\frac{1}{2}\mathcal{N}({\bm{x}}|{\bm{0}},\Sigma_{1})+\frac{1}{2}\mathcal{N}({%
\bm{x}}|{\bm{0}},\Sigma_{2})
\Sigma_{1}=\bigl{[}\begin{smallmatrix}2&1.8\\
1.8&2\end{smallmatrix}\bigl{]},\Sigma_{2}=\bigl{[}\begin{smallmatrix}2&-1.8\\
-1.8&2\end{smallmatrix}\bigl{]}
\bm{0.1876(0.0230)}
0.3602(0.1106)
0.1936(0.0169)
0.1823(0.0025)
0.0611(0.0192)
\bm{0.0005(0.0007)}
0.0341(0.0118)
0.0236(0.0083)
\bm{0.0046(0.0038)}
500
q_{\varphi}({\bm{x}})
L_{2}\text{-}
\mathbb{E}_{q_{\varphi}({\bm{x}})}\|f_{\psi}({\bm{x}})\|_{2}^{2}
f_{\psi}
L_{2}\text{-}
f_{\psi}({\bm{x}})
\mathbb{E}_{q_{\varphi}({\bm{x}})}\|f_{\psi}({\bm{x}})\|_{2}^{2}
L_{2}\text{-}
f_{\psi}({\bm{x}})
\mathbb{E}_{q_{\varphi}({\bm{x}})}\|f_{\psi}({\bm{x}})\|_{2}^{2}
58.510
8.267
0.0107
0.0088
0.0048
0.0059
0.0065
0.0058
0.0045
0.0057
0.0042
0.0507
0.0042
0.0493
L=100
m=10
\{10^{-4},10^{-5},10^{-6}\}
\{50000,100000\}
K=1,3
\mathcal{F}
p
q
\mathbb{S}(q,p)=\sup_{f\in\mathcal{F}}\mathbb{E}_{q({\bm{x}})}\left[\nabla_{%
\bm{x}}\log p({\bm{x}})^{T}f({\bm{x}})+\operatorname{Tr}(\nabla_{\bm{x}}f({\bm%
{x}}))\right].
\mathbb{E}_{q({\bm{x}})}\left[\nabla_{\bm{x}}\log q({\bm{x}})^{T}f({\bm{x}})+%
\operatorname{Tr}(\nabla_{\bm{x}}f({\bm{x}}))\right]=0.
O_{\mathrm{LS}}^{p}
\mathcal{L}(q,O_{\mathrm{LS}}^{p},\mathcal{F})=\sup_{f\in\mathcal{F}}\left(%
\mathbb{E}_{q({\bm{x}})}\left[\nabla_{\bm{x}}\log p({\bm{x}})^{T}f({\bm{x}})+%
\operatorname{Tr}(\nabla_{\bm{x}}f({\bm{x}}))\right]\right)^{2}.
q
f
L_{2}
\mathcal{F}
\mathcal{L}_{\mathrm{LSD}}=\sup_{f}\mathbb{E}_{q({\bm{x}})}\left[\nabla_{\bm{x%
}}\log p({\bm{x}})^{T}f({\bm{x}})+\operatorname{Tr}(\nabla_{\bm{x}}f({\bm{x}})%
)-\lambda\|f({\bm{x}})\|_{2}^{2}\right].
\mathcal{L}_{\mathrm{LSD}}
\lambda=\frac{1}{2}
\displaystyle\mathcal{L}_{\mathrm{LSD}}=\sup_{f}\mathbb{E}_{q({\bm{x}})}\left[%
f({\bm{x}})^{T}\left(\nabla_{\bm{x}}\log p({\bm{x}})-\nabla_{\bm{x}}\log q({%
\bm{x}})\right)-\frac{1}{2}\|f({\bm{x}})\|_{2}^{2}\right],
\displaystyle\mathcal{L}_{\mathrm{LSD}}
\displaystyle=\sup_{f}\mathbb{E}_{q({\bm{x}})}\left[f({\bm{x}})^{T}\left(%
\nabla_{\bm{x}}\log p({\bm{x}})-\nabla_{\bm{x}}\log q({\bm{x}})\right)-\frac{1%
}{2}\|f({\bm{x}})\|_{2}^{2}\right],
\displaystyle=\frac{1}{2}\mathbb{E}_{q({\bm{x}})}\|\nabla\log p({\bm{x}})-%
\nabla\log q({\bm{x}})\|_{2}^{2}.
\displaystyle=\frac{1}{2}\mathbb{E}_{q({\bm{x}})}\|\nabla\log p({\bm{x}})-%
\nabla\log q({\bm{x}})\|_{2}^{2}.
\operatorname{Tr}(\nabla_{\bm{x}}f({\bm{x}}))
q({\bm{x}})
f_{\psi}({\bm{x}})
f_{\psi}({\bm{x}})
