\mathcal{M}=(\mathcal{S},\mathcal{A},T,r,\mu_{0},\gamma)
\mathcal{S}
\mathcal{A}
T(s^{\prime}|s,a)
r(s,a)
\mu_{0}
\gamma\in(0,1)
|r(s,a)|\leq R_{max}
\pi
d_{\mathcal{M}}^{\pi}(s):=(1-\gamma)\sum_{t=0}^{\infty}\gamma^{t}P_{\mathcal{M%
}}(s_{t}=s|\pi)
P_{\mathcal{M}}(s_{t}=s|\pi)
s
t
\pi
\mathcal{M}
d_{\mathcal{M}}^{\pi}(s,a):=d_{\mathcal{M}}^{\pi}(s)\pi(a|s)
J(\mathcal{M},\pi):=\frac{1}{1-\gamma}\mathbb{E}_{(s,a)\sim d_{\mathcal{M}}^{%
\pi}(s,a)}[r(s,a)]
J(\mathcal{M},\pi)
\mathcal{D}=\{(s,a,r,s^{\prime})\}
\pi_{\beta}
d_{\mathcal{M}}^{\pi_{\beta}}(s)
\pi_{\beta}
\mathcal{D}
d_{\mathcal{M}}^{\pi_{\beta}}(s,a)=d_{\mathcal{M}}^{\pi_{\beta}}(s)\pi_{\beta}%
(a|s)
\overline{\mathcal{M}}
\mathcal{D}
d(s,a)
d_{\mathcal{M}}^{\pi_{\beta}}(s,a)
p(\mathcal{M})
\mathcal{M}_{n}
\mathcal{M}_{n}=(\mathcal{S},\mathcal{A},T_{n},r_{n},\mu_{0,n},\gamma)
\mathcal{M}_{n}
\mathcal{D}_{n}
\pi_{\beta,n}
\{\mathcal{M}_{n}\}_{n=1}^{N}
\widehat{T}_{\theta}(s^{\prime}|s,a)
\theta
\mathcal{D}
\widehat{\mathcal{M}}:=(\mathcal{S},\mathcal{A},\widehat{T},r,\mu_{0},\gamma)
\mathcal{D}
Q^{\pi}(s,a):=\mathbb{E}\left[\sum\nolimits_{t=0}^{\infty}\gamma^{t}r(s_{t},a_%
{t})|s_{0}=s,a_{0}=a\right]
\widehat{\mathcal{B}}^{\pi}Q(s,a)=r(s,a)+\gamma\mathbb{E}_{(s,a,s^{\prime})%
\sim\mathcal{D}}[Q(s^{\prime},a^{\prime})]
a^{\prime}\sim\pi(\cdot|s^{\prime})
\displaystyle\widehat{Q}^{k+1}\leftarrow\arg\min_{Q(s,a)}\beta(\mathbb{E}_{s,a%
\sim\rho}[Q(s,a)]-\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)])+\frac{1}{2}\mathbb{%
E}_{s,a,s^{\prime}\sim d_{f}}[(Q(s,a)-\widehat{\mathcal{B}}^{\pi}\widehat{Q}^{%
k}(s,a))^{2}]
\displaystyle\widehat{Q}^{k+1}\leftarrow\arg\min_{Q(s,a)}\beta(\mathbb{E}_{s,a%
\sim\rho}[Q(s,a)]-\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)])+\frac{1}{2}\mathbb{%
E}_{s,a,s^{\prime}\sim d_{f}}[(Q(s,a)-\widehat{\mathcal{B}}^{\pi}\widehat{Q}^{%
k}(s,a))^{2}]
\rho(s,a):=d^{\pi}_{\widehat{\mathcal{M}}}(s)\pi(a|s)
\pi
\widehat{\mathcal{M}}
d_{f}(s,a)=fd_{\mathcal{M}}^{\pi_{\beta}}(s,a)+(1-f)\rho(s,a)
f\in[0,1]
\widehat{\mathcal{B}}^{\pi}
d_{f}
f
\mathcal{B}_{\overline{\mathcal{M}}}^{\pi}
\mathcal{B}_{\widehat{\mathcal{M}}}^{\pi}
\widehat{Q}^{\pi}
\displaystyle\pi^{\prime}\leftarrow\arg\max_{\pi}\mathbb{E}_{s\sim\rho(s),a%
\sim\pi(\cdot|s)}[\widehat{Q}^{\pi}(s,a)].
\displaystyle\pi^{\prime}\leftarrow\arg\max_{\pi}\mathbb{E}_{s\sim\rho(s),a%
\sim\pi(\cdot|s)}[\widehat{Q}^{\pi}(s,a)].
\{\mathcal{D}_{n}\}_{n=1}^{N}
\displaystyle\min_{\phi_{m}}~{}~{}L_{model}(\phi_{m})=\mathbb{E}_{\mathcal{M}_%
{n}}\left\{\min_{\theta_{n}}~{}\left[\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{%
D}_{n}}[\log\widehat{T}_{\theta_{n}}(s^{\prime}|s,a)]+\eta\|\theta_{n}-\phi_{m%
}\|^{2}_{2}\right]\right\}
\displaystyle\min_{\phi_{m}}~{}~{}L_{model}(\phi_{m})=\mathbb{E}_{\mathcal{M}_%
{n}}\left\{\min_{\theta_{n}}~{}\left[\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{%
D}_{n}}[\log\widehat{T}_{\theta_{n}}(s^{\prime}|s,a)]+\eta\|\theta_{n}-\phi_{m%
}\|^{2}_{2}\right]\right\}
\mathcal{M}_{n}
\theta_{n}
\phi_{m}
T_{\phi^{*}_{m}}
j
T_{\phi^{*}_{m}}
\mathcal{D}_{j}
\displaystyle\min_{\theta_{j}}~{}~{}\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{D%
}_{j}}[\log\widehat{T}_{\theta_{j}}(s^{\prime}|s,a)]+\eta\|\theta_{j}-\phi^{*}%
_{m}\|^{2}_{2}.
\displaystyle\min_{\theta_{j}}~{}~{}\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{D%
}_{j}}[\log\widehat{T}_{\theta_{j}}(s^{\prime}|s,a)]+\eta\|\theta_{j}-\phi^{*}%
_{m}\|^{2}_{2}.
T_{\phi^{*}_{m}}
\displaystyle\max_{\pi_{c}}~{}\mathbb{E}_{\mathcal{M}_{n}}\left\{\max_{\pi_{n}%
}\left[\mathbb{E}_{\begin{subarray}{c}s\sim\rho_{n},\\
a\sim\pi_{n}(\cdot|s)\end{subarray}}\left[\hat{Q}_{n}^{\pi}(s,a)\right]-%
\lambda D(\pi_{n},\pi_{c})\right]\right\}
\displaystyle\max_{\pi_{c}}~{}\mathbb{E}_{\mathcal{M}_{n}}\left\{\max_{\pi_{n}%
}\left[\mathbb{E}_{\begin{subarray}{c}s\sim\rho_{n},\\
a\sim\pi_{n}(\cdot|s)\end{subarray}}\left[\hat{Q}_{n}^{\pi}(s,a)\right]-%
\lambda D(\pi_{n},\pi_{c})\right]\right\}
\pi_{c}
\pi_{n}
\rho_{n}
\rho_{n}(s,a)
n
D(\cdot,\cdot)
\hat{Q}_{n}^{\pi}
\pi_{c}
\displaystyle\pi_{n}\leftarrow\arg\max_{\pi_{n}}\mathbb{E}_{s\sim\rho_{n},a%
\sim\pi_{n}(\cdot|s)}[\widehat{Q}_{n}^{\pi}(s,a)]-\lambda D(\pi_{n},\pi_{c}).
\displaystyle\pi_{n}\leftarrow\arg\max_{\pi_{n}}\mathbb{E}_{s\sim\rho_{n},a%
\sim\pi_{n}(\cdot|s)}[\widehat{Q}_{n}^{\pi}(s,a)]-\lambda D(\pi_{n},\pi_{c}).
\pi_{c}
\pi_{n}
\pi_{\beta,n}
\pi_{n}
\pi_{c}
\pi_{\beta}
\pi_{c}
n
\pi_{\beta,n}
\pi_{c}
\displaystyle\pi_{n}\leftarrow\arg\max_{\pi_{n}}\mathbb{E}_{s\sim\rho_{n},a%
\sim\pi_{n}(\cdot|s)}[\widehat{Q}_{n}^{\pi}(s,a)]-\lambda\alpha D(\pi_{n},\pi_%
{\beta,n})-\lambda(1-\alpha)D(\pi_{n},\pi_{c}),
\displaystyle\pi_{n}\leftarrow\arg\max_{\pi_{n}}\mathbb{E}_{s\sim\rho_{n},a%
\sim\pi_{n}(\cdot|s)}[\widehat{Q}_{n}^{\pi}(s,a)]-\lambda\alpha D(\pi_{n},\pi_%
{\beta,n})-\lambda(1-\alpha)D(\pi_{n},\pi_{c}),
\alpha\in[0,1]
\alpha
\alpha
0
\pi_{n}
\pi_{c}
D(\pi_{n},\pi_{\beta,n})
\pi_{n}
\pi_{c}
\widehat{T}_{\theta_{n}}
\mathcal{D}_{n}
k=1,2,...
\mathcal{D}_{n}
\mathcal{D}_{model,n}
\mathcal{D}_{n}\cup\mathcal{D}_{model,n}
\pi_{n}(a|s)
\pi_{\beta,n}
\pi_{c}
\mathcal{M}_{n}
D(\pi_{1},\pi_{2})
D(\pi_{1},\pi_{2}):=\max_{s}D_{TV}(\pi_{1}||\pi_{2})
\nu_{n}(\rho,f)=\mathbb{E}_{\rho}\left[(\rho(s,a)-d_{n}(s,a))/d_{f,n}(s,a)\right]
\delta\in(0,1/2)
\pi_{n}(a|s)
\epsilon=\frac{\beta[\nu_{n}(\rho^{\pi_{n}},f)-\nu_{n}(\rho^{\pi_{\beta,n}},f)%
]}{2\lambda(1-\gamma)D(\pi_{n},\pi_{\beta,n})}
\nu_{n}(\rho^{\pi_{n}},f)-\nu_{n}(\rho^{\pi_{\beta,n}},f)>0
\alpha\in\left(\max\{\frac{1}{2}-\epsilon,0\},\frac{1}{2}\right)
J(\mathcal{M}_{n},\pi_{n})\geq\max\{J(\mathcal{M}_{n},\pi_{c})+\xi_{1},J(%
\mathcal{M}_{n},\pi_{\beta,n})+\xi_{2}\}
1-2\delta
\xi_{1}
\xi_{2}
\beta
\lambda
J(\mathcal{M}_{n},\pi_{n})\geq\max\{J(\mathcal{M}_{n},\pi_{c})+\xi_{1},J(%
\mathcal{M}_{n},\pi_{\beta,n})+\xi_{2}\}
1-2\delta
\alpha\in(0,1/2)
\xi_{1}
\lambda
\xi_{1}
\xi_{2}
\xi_{1}
\xi_{2}
\beta
\lambda
\pi_{c}
\pi_{\beta,n}
T_{\widehat{\mathcal{M}_{n}}}
T_{\mathcal{M}_{n}}
\pi_{\beta,n}
d^{\pi_{\beta,n}}_{\widehat{\mathcal{M}_{n}}}(s,a)
d^{\pi_{\beta,n}}_{\overline{\mathcal{M}_{n}}}(s,a)
\rho^{\pi_{\beta,n}}
d_{n}(s,a)
\nu_{n}(\rho^{\pi_{n}},f)-\nu_{n}(\rho^{\pi_{\beta,n}},f)>0
\xi_{1}
\lambda
\xi_{2}
\alpha
\pi_{\beta,n}
\pi_{c}
\pi_{c}
\pi_{\beta,n}
\alpha
D(\pi_{n},\pi_{\beta,n})
D(\pi_{n},\pi_{c})
\alpha
\displaystyle\widehat{Q}_{n}^{k+1}(s,a)=\widehat{\mathcal{B}}^{\pi}\widehat{Q}%
_{n}^{k}(s,a)-\frac{\beta[\rho(s,a)-d_{n}(s,a)]}{d_{f,n}(s,a)}.
\displaystyle\widehat{Q}_{n}^{k+1}(s,a)=\widehat{\mathcal{B}}^{\pi}\widehat{Q}%
_{n}^{k}(s,a)-\frac{\beta[\rho(s,a)-d_{n}(s,a)]}{d_{f,n}(s,a)}.
\epsilon
\alpha
\pi_{c}
\pi_{c}
\alpha
\frac{1}{2}
\pi_{\beta,n}
\|\pi_{1}-\pi_{2}\|\leq\sqrt{2D_{KL}(\pi_{1}||\pi_{2})}
\pi_{\beta,n}
\pi_{n}
\pi_{\beta,n}
\pi_{\beta,n}
\displaystyle D_{KL}(\pi_{\beta,n}||\pi_{n})=\mathbb{E}_{a\sim\pi_{\beta,n}}[%
\log\pi_{\beta,n}(a|s)]-\mathbb{E}_{a\sim\pi_{\beta,n}}[\log\pi_{n}(a|s)]
\displaystyle D_{KL}(\pi_{\beta,n}||\pi_{n})
\displaystyle=\mathbb{E}_{a\sim\pi_{\beta,n}}[\log\pi_{\beta,n}(a|s)]-\mathbb{%
E}_{a\sim\pi_{\beta,n}}[\log\pi_{n}(a|s)]
\displaystyle\propto-\mathbb{E}_{a\sim\pi_{\beta,n}}[\log\pi_{n}(a|s)]\approx-%
\mathbb{E}_{(s,a)\sim\mathcal{D}_{n}}[\log\pi_{n}(a|s)].
\displaystyle\propto-\mathbb{E}_{a\sim\pi_{\beta,n}}[\log\pi_{n}(a|s)]\approx-%
\mathbb{E}_{(s,a)\sim\mathcal{D}_{n}}[\log\pi_{n}(a|s)].
\displaystyle\max_{\pi_{n}}~{}~{}\mathbb{E}_{s\sim\rho_{n},a\sim\pi_{n}(\cdot|%
s)}\left[\widehat{Q}_{n}^{\pi}(s,a)\right]+\lambda\alpha\mathbb{E}_{(s,a)\sim%
\mathcal{D}_{n}}[\log\pi_{n}(a|s)]-\lambda(1-\alpha)D_{KL}(\pi_{n}||\pi_{c}).
\displaystyle\max_{\pi_{n}}~{}~{}\mathbb{E}_{s\sim\rho_{n},a\sim\pi_{n}(\cdot|%
s)}\left[\widehat{Q}_{n}^{\pi}(s,a)\right]+\lambda\alpha\mathbb{E}_{(s,a)\sim%
\mathcal{D}_{n}}[\log\pi_{n}(a|s)]-\lambda(1-\alpha)D_{KL}(\pi_{n}||\pi_{c}).
\pi_{c}
\pi_{c}
\pi_{n}
\{\pi_{n}\}_{n}
\pi_{c}
\displaystyle\max_{\pi_{c}}~{}\mathbb{E}_{\mathcal{M}_{n}}\left\{\mathbb{E}_{%
\begin{subarray}{c}s\sim\rho_{n},\\
a\sim\pi_{n}(\cdot|s)\end{subarray}}\left[\hat{Q}_{n}^{\pi}(s,a)\right]+%
\lambda\alpha\mathbb{E}_{(s,a)\sim\mathcal{D}_{n}}[\log\pi_{n}(a|s)]-\lambda(1%
-\alpha)D_{KL}(\pi_{n}||\pi_{c})\right\}
\displaystyle\max_{\pi_{c}}~{}\mathbb{E}_{\mathcal{M}_{n}}\left\{\mathbb{E}_{%
\begin{subarray}{c}s\sim\rho_{n},\\
a\sim\pi_{n}(\cdot|s)\end{subarray}}\left[\hat{Q}_{n}^{\pi}(s,a)\right]+%
\lambda\alpha\mathbb{E}_{(s,a)\sim\mathcal{D}_{n}}[\log\pi_{n}(a|s)]-\lambda(1%
-\alpha)D_{KL}(\pi_{n}||\pi_{c})\right\}
\rho_{n}
\hat{Q}_{n}^{\pi}
\pi_{n}
\pi_{c}
\alpha
T_{\phi^{*}_{m}}
\pi_{c}^{*}
\pi_{c}^{*}
\mathcal{M}
\pi_{o}
\pi_{c}^{*}
\epsilon=\frac{\beta[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{\beta}},f)]}{2%
\lambda(1-\gamma)D(\pi_{o},\pi_{\beta})}\geq 0
\alpha\in\left(\max\{\frac{1}{2}-\epsilon,0\},\frac{1}{2}\right)
\pi_{o}
\pi_{c}^{*}
\pi_{\beta}
J(\mathcal{M},\pi_{o})>\max\{J(\mathcal{M},\pi_{c}^{*}),J(\mathcal{M},\pi_{%
\beta})\}
1-2\delta
\beta
\lambda
\alpha=0.4
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha=0,0.4,0.7,1
\alpha=0
\alpha=1
\alpha=0.4
\alpha
\alpha\in[0.3,0.5]
\alpha
\alpha
\alpha
\alpha
k
\pi_{n}^{k}
n
\pi_{c}^{k}
k
\alpha^{k}_{n}
\displaystyle\min_{\alpha^{k}_{n}}~{}(1-\alpha^{k}_{n})(D(\pi^{k}_{n},\pi_{%
\beta,n})-D(\pi^{k}_{n},\pi^{k}_{c})),~{}~{}\text{s.t.}~{}\alpha^{k}_{n}\in[0.%
1,0.5].
\displaystyle\min_{\alpha^{k}_{n}}~{}(1-\alpha^{k}_{n})(D(\pi^{k}_{n},\pi_{%
\beta,n})-D(\pi^{k}_{n},\pi^{k}_{c})),~{}~{}\text{s.t.}~{}\alpha^{k}_{n}\in[0.%
1,0.5].
\alpha_{n}^{k}
D(\pi^{k}_{n},\pi_{\beta,n})
D(\pi^{k}_{n},\pi^{k}_{c})
k
n
\alpha^{k}_{n}
\pi_{n}^{k}
\pi^{k}_{c}
\pi_{n}^{k}
\alpha^{k}_{n}
[0.1,0.5]
\alpha
\alpha
\alpha=0.4
\alpha=1
[-0.05,0.05]^{2}
\displaystyle\widehat{T}_{\theta}(s_{t+1},r|s,a)=\mathcal{N}(\mu_{\theta}(s_{t%
},a_{t}),\Sigma_{\theta}(s_{t},a_{t})).
\displaystyle\widehat{T}_{\theta}(s_{t+1},r|s,a)=\mathcal{N}(\mu_{\theta}(s_{t%
},a_{t}),\Sigma_{\theta}(s_{t},a_{t})).
\beta
\lambda
\alpha
\alpha
\alpha
\alpha=0.4
\alpha=1
\{s_{i},a_{i},r_{i},s_{i}^{\prime}\}
\alpha=0.4
\alpha
1e-4
\beta
\lambda
\beta
\beta
\displaystyle\min_{Q}\max_{\beta\geq 0}\beta(\mathbb{E}_{s,a\sim\rho}[Q(s,a)]-%
\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)]-\tau)+\frac{1}{2}\mathbb{E}_{s,a,s^{%
\prime}\sim d_{f}}[(Q(s,a)-\widehat{\mathcal{B}}^{\pi}\widehat{Q}^{k}(s,a))^{2%
}].
\displaystyle\min_{Q}\max_{\beta\geq 0}\beta(\mathbb{E}_{s,a\sim\rho}[Q(s,a)]-%
\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)]-\tau)+\frac{1}{2}\mathbb{E}_{s,a,s^{%
\prime}\sim d_{f}}[(Q(s,a)-\widehat{\mathcal{B}}^{\pi}\widehat{Q}^{k}(s,a))^{2%
}].
\beta
\mathbb{E}_{s,a\sim\rho}[Q(s,a)]-\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)]
\tau
\lambda
\lambda
\displaystyle\max_{\pi}\min_{\lambda\geq 0}\mathbb{E}_{s\sim\rho(s),a\sim\pi(%
\cdot|s)}[\widehat{Q}^{\pi}(s,a)]-\lambda\alpha[D(\pi,\pi_{\beta})-D_{target}]%
-\lambda(1-\alpha)[D(\pi,\pi_{c})-D_{target}].
\displaystyle\max_{\pi}\min_{\lambda\geq 0}\mathbb{E}_{s\sim\rho(s),a\sim\pi(%
\cdot|s)}[\widehat{Q}^{\pi}(s,a)]-\lambda\alpha[D(\pi,\pi_{\beta})-D_{target}]%
-\lambda(1-\alpha)[D(\pi,\pi_{c})-D_{target}].
\lambda
D_{target}
D_{target}
Q_{meta}
k
B
\xi_{q}
\displaystyle Q_{meta}^{k+1}=Q_{meta}^{k}-\xi_{q}[Q_{meta}^{k}-\frac{1}{|B|}%
\sum_{n\in B}Q_{n}].
\displaystyle Q_{meta}^{k+1}=Q_{meta}^{k}-\xi_{q}[Q_{meta}^{k}-\frac{1}{|B|}%
\sum_{n\in B}Q_{n}].
8e-5
\lambda
\lambda
\lambda
\beta
\log\beta
\log\beta
\alpha
\#
\#
\alpha=1
10^{3}
k=1,2,...
\mathcal{M}_{n}
h
\widehat{T}_{\theta^{k}_{n}}
\mathcal{D}_{i}
\displaystyle\min_{\theta_{n}}~{}~{}\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{D%
}_{n}}[\log\widehat{T}_{\theta_{n}}(s^{\prime}|s,a)]+\eta\|\theta_{n}-\phi_{m}%
(k)\|^{2}_{2};
\displaystyle\min_{\theta_{n}}~{}~{}\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{D%
}_{n}}[\log\widehat{T}_{\theta_{n}}(s^{\prime}|s,a)]+\eta\|\theta_{n}-\phi_{m}%
(k)\|^{2}_{2};
\phi_{m}(k+1)=\phi_{m}(k)-\xi_{1}[\phi_{m}(k)-\frac{1}{N}\sum_{n=1}^{N}\theta^%
{k}_{n}]
\widehat{T}_{n}
t
k=1,2,...
\mathcal{M}_{n}
j=1,...,J
\widehat{T}_{n}
\mathcal{D}_{n}
\mathcal{D}^{n}_{model}
\mathcal{D}_{n}\cup\mathcal{D}^{n}_{model}
\pi_{c}^{k}
\pi_{n}^{k}
\pi_{n}^{k}
\pi_{c}^{k+1}
T_{\mathcal{M}}
r_{\mathcal{M}}
\mathcal{M}
T_{\overline{\mathcal{M}}}
r_{\overline{\mathcal{M}}}
\overline{\mathcal{M}}
\mathcal{D}
T_{\widehat{\mathcal{M}}}
r_{\widehat{\mathcal{M}}}
\widehat{\mathcal{M}}
\infty
\mathcal{D}
|\mathcal{D}(s,a)|
|\mathcal{D}(s,a)|
(s,a)\notin\mathcal{D}
\overline{\mathcal{M}}
(s,a)\in\mathcal{M}
1-\delta
\displaystyle\|T_{\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal{M}}(s^{%
\prime}|s,a)\|_{1}\leq\frac{C_{T,\delta}}{\sqrt{|\mathcal{D}(s,a)|}};\ \ ~{}|r%
_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}|\leq\frac{C_{r,\delta}}{\sqrt{|%
\mathcal{D}(s,a)|}}
\displaystyle\|T_{\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal{M}}(s^{%
\prime}|s,a)\|_{1}\leq\frac{C_{T,\delta}}{\sqrt{|\mathcal{D}(s,a)|}};\ \ ~{}|r%
_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}|\leq\frac{C_{r,\delta}}{\sqrt{|%
\mathcal{D}(s,a)|}}
C_{T,\delta}
C_{r,\delta}
\delta
\sqrt{\log(1/\delta)}
(s,a)\in\mathcal{M}
\displaystyle\left|\mathcal{B}^{\pi}_{\overline{\mathcal{M}}}\widehat{Q}^{k}(s%
,a)-\mathcal{B}^{\pi}_{\mathcal{M}}\widehat{Q}^{k}(s,a)\right|
\displaystyle\left|\mathcal{B}^{\pi}_{\overline{\mathcal{M}}}\widehat{Q}^{k}(s%
,a)-\mathcal{B}^{\pi}_{\mathcal{M}}\widehat{Q}^{k}(s,a)\right|
\displaystyle=\left|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)+%
\gamma\sum_{s^{\prime}}(T_{\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal%
{M}}(s^{\prime}|s,a))\mathbb{E}_{\pi(a^{\prime}|s^{\prime})}[\widehat{Q}^{k}(s%
^{\prime},a^{\prime})]\right|
\displaystyle=
\displaystyle\left|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)+\gamma%
\sum_{s^{\prime}}(T_{\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal{M}}(s%
^{\prime}|s,a))\mathbb{E}_{\pi(a^{\prime}|s^{\prime})}[\widehat{Q}^{k}(s^{%
\prime},a^{\prime})]\right|
\displaystyle\leq|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|+\gamma%
\left|\sum_{s^{\prime}}(T_{\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal%
{M}}(s^{\prime}|s,a))\mathbb{E}_{\pi(a^{\prime}|s^{\prime})}[\widehat{Q}^{k}(s%
^{\prime},a^{\prime})]\right|
\displaystyle\leq
\displaystyle|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|+\gamma%
\left|\sum_{s^{\prime}}(T_{\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal%
{M}}(s^{\prime}|s,a))\mathbb{E}_{\pi(a^{\prime}|s^{\prime})}[\widehat{Q}^{k}(s%
^{\prime},a^{\prime})]\right|
\displaystyle\leq\frac{C_{r,\delta}}{\sqrt{|\mathcal{D}(s,a)|}}+\gamma\|T_{%
\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal{M}}(s^{\prime}|s,a)\|_{1}%
\|\mathbb{E}_{\pi(a^{\prime}|s^{\prime})}[\widehat{Q}^{k}(s^{\prime},a^{\prime%
})]\|_{\infty}
\displaystyle\leq
\displaystyle\frac{C_{r,\delta}}{\sqrt{|\mathcal{D}(s,a)|}}+\gamma\|T_{%
\overline{\mathcal{M}}}(s^{\prime}|s,a)-T_{\mathcal{M}}(s^{\prime}|s,a)\|_{1}%
\|\mathbb{E}_{\pi(a^{\prime}|s^{\prime})}[\widehat{Q}^{k}(s^{\prime},a^{\prime%
})]\|_{\infty}
\displaystyle\leq\frac{C_{r,\delta}+\gamma C_{T,\delta}R_{max}/(1-\gamma)}{%
\sqrt{|\mathcal{D}(s,a)|}}
\displaystyle\leq
\displaystyle\frac{C_{r,\delta}+\gamma C_{T,\delta}R_{max}/(1-\gamma)}{\sqrt{|%
\mathcal{D}(s,a)|}}
\displaystyle=\frac{{((1-\gamma)C_{r,\delta}/R_{max}+\gamma C_{T,\delta})R_{%
max}}}{(1-\gamma)\sqrt{|\mathcal{D}(s,a)|}}
\displaystyle=
\displaystyle\frac{{((1-\gamma)C_{r,\delta}/R_{max}+\gamma C_{T,\delta})R_{max%
}}}{(1-\gamma)\sqrt{|\mathcal{D}(s,a)|}}
\displaystyle\leq\frac{{(C_{r,\delta}/R_{max}+C_{T,\delta})R_{max}}}{(1-\gamma%
)\sqrt{|\mathcal{D}(s,a)|}}\triangleq\frac{C_{r,T,\delta}R_{max}}{(1-\gamma)%
\sqrt{|\mathcal{D}(s,a)|}}.
\displaystyle\leq
\displaystyle\frac{{(C_{r,\delta}/R_{max}+C_{T,\delta})R_{max}}}{(1-\gamma)%
\sqrt{|\mathcal{D}(s,a)|}}\triangleq\frac{C_{r,T,\delta}R_{max}}{(1-\gamma)%
\sqrt{|\mathcal{D}(s,a)|}}.
\widehat{\mathcal{M}}
\displaystyle\left|\mathcal{B}^{\pi}_{\widehat{\mathcal{M}}}\widehat{Q}^{k}(s,%
a)-\mathcal{B}^{\pi}_{\mathcal{M}}\widehat{Q}^{k}(s,a)\right|
\displaystyle\left|\mathcal{B}^{\pi}_{\widehat{\mathcal{M}}}\widehat{Q}^{k}(s,%
a)-\mathcal{B}^{\pi}_{\mathcal{M}}\widehat{Q}^{k}(s,a)\right|
\displaystyle\leq|r_{\widehat{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|+\frac{%
\gamma R_{max}}{1-\gamma}D_{tv}(T_{\widehat{\mathcal{M}}},T_{\mathcal{M}})
\displaystyle\leq
\displaystyle|r_{\widehat{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|+\frac{%
\gamma R_{max}}{1-\gamma}D_{tv}(T_{\widehat{\mathcal{M}}},T_{\mathcal{M}})
D_{tv}(T_{\widehat{\mathcal{M}}},T_{\mathcal{M}})
T_{\widehat{\mathcal{M}}}
T_{\mathcal{M}}
\mathcal{M}_{1}
\mathcal{M}_{2}
\gamma
f\in(0,1)
f
\mathcal{M}_{f}
T_{\mathcal{M}_{f}}=fT_{\mathcal{M}_{1}}+(1-f)T_{\mathcal{M}_{2}}
r_{\mathcal{M}_{f}}=fr_{\mathcal{M}_{1}}+(1-f)r_{\mathcal{M}_{2}}
\mathcal{M}_{1}
\mathcal{M}_{2}
T^{\pi}
\pi
\displaystyle T^{\pi}=T(s^{\prime}|s,a)\pi(a^{\prime}|s^{\prime}).
\displaystyle T^{\pi}=T(s^{\prime}|s,a)\pi(a^{\prime}|s^{\prime}).
\pi
\mathcal{M}
J(\mathcal{M},\pi)
\mathcal{M}_{f}
J(\mathcal{M}_{1},\mathcal{M}_{2},f,\pi)
\displaystyle J(\mathcal{M},\pi)-\eta\leq J(\mathcal{M}_{1},\mathcal{M}_{2},f,%
\pi)\leq J(\mathcal{M},\pi)+\eta
\displaystyle J(\mathcal{M},\pi)-\eta\leq J(\mathcal{M}_{1},\mathcal{M}_{2},f,%
\pi)\leq J(\mathcal{M},\pi)+\eta
\displaystyle\eta=\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\mathcal%
{M}_{2}},T_{\mathcal{M}})+\frac{\gamma f}{1-\gamma}|\mathbb{E}_{d^{\pi}_{%
\mathcal{M}}}[(T^{\pi}_{\mathcal{M}}-T^{\pi}_{\mathcal{M}_{1}})Q_{\mathcal{M}}%
^{\pi}]|
\displaystyle\eta=
\displaystyle\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\mathcal{M}_{%
2}},T_{\mathcal{M}})+\frac{\gamma f}{1-\gamma}|\mathbb{E}_{d^{\pi}_{\mathcal{M%
}}}[(T^{\pi}_{\mathcal{M}}-T^{\pi}_{\mathcal{M}_{1}})Q_{\mathcal{M}}^{\pi}]|
\displaystyle+\frac{f}{1-\gamma}\mathbb{E}_{s,a\sim d^{\pi}_{\mathcal{M}}}[|r_%
{\mathcal{M}_{1}}(s,a)-r_{\mathcal{M}}(s,a)|]+\frac{1-f}{1-\gamma}\mathbb{E}_{%
s,a\sim d^{\pi}_{M}}[|r_{\mathcal{M}_{2}}(s,a)-r_{\mathcal{M}}(s,a)|].
\displaystyle+\frac{f}{1-\gamma}\mathbb{E}_{s,a\sim d^{\pi}_{\mathcal{M}}}[|r_%
{\mathcal{M}_{1}}(s,a)-r_{\mathcal{M}}(s,a)|]+\frac{1-f}{1-\gamma}\mathbb{E}_{%
s,a\sim d^{\pi}_{M}}[|r_{\mathcal{M}_{2}}(s,a)-r_{\mathcal{M}}(s,a)|].
d(s,a):=d^{\pi_{\beta}}_{\mathcal{M}}(s,a)
\displaystyle\widehat{Q}^{k+1}(s,a)=\widehat{\mathcal{B}}^{\pi}\widehat{Q}^{k}%
(s,a)-\beta\frac{\rho(s,a)-d(s,a)}{d_{f}(s,a)}.
\displaystyle\widehat{Q}^{k+1}(s,a)=\widehat{\mathcal{B}}^{\pi}\widehat{Q}^{k}%
(s,a)-\beta\frac{\rho(s,a)-d(s,a)}{d_{f}(s,a)}.
\nu(\rho,f)=\mathbb{E}_{\rho}\left[\frac{\rho(s,a)-d(s,a)}{d_{f}(s,a)}\right]
\nu(\rho,f)\geq 0
f
\rho
f\in(0,1)
f
\overline{\mathcal{M}}
\widehat{\mathcal{M}}
\pi_{\beta}
\pi_{c}
\displaystyle\max_{\pi}~{}~{}J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,%
\pi)-\beta\frac{\nu(\rho^{\pi},f)}{1-\gamma}-\lambda\alpha D(\pi,\pi_{\beta})-%
\lambda(1-\alpha)D(\pi,\pi_{c}).
\displaystyle\max_{\pi}~{}~{}J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,%
\pi)-\beta\frac{\nu(\rho^{\pi},f)}{1-\gamma}-\lambda\alpha D(\pi,\pi_{\beta})-%
\lambda(1-\alpha)D(\pi,\pi_{c}).
\pi_{o}
\pi_{o}
\mathcal{M}
f
\displaystyle J(M,\pi_{o})+\eta_{1}\geq J(\overline{\mathcal{M}},\widehat{%
\mathcal{M}},f,\pi_{o})
\displaystyle J(M,\pi_{o})+\eta_{1}\geq J(\overline{\mathcal{M}},\widehat{%
\mathcal{M}},f,\pi_{o})
\displaystyle\eta_{1}=\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{%
\widehat{\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma f}{1-\gamma}|\mathbb{E}_{%
d^{\pi_{o}}_{\mathcal{M}}}[(T^{\pi_{o}}_{\mathcal{M}}-T^{\pi_{o}}_{\overline{%
\mathcal{M}}})Q_{\mathcal{M}}^{\pi_{o}}]|
\displaystyle\eta_{1}=
\displaystyle\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma f}{1-\gamma}|\mathbb{E}_{d^{\pi_{o%
}}_{\mathcal{M}}}[(T^{\pi_{o}}_{\mathcal{M}}-T^{\pi_{o}}_{\overline{\mathcal{M%
}}})Q_{\mathcal{M}}^{\pi_{o}}]|
\displaystyle+\frac{f}{1-\gamma}\mathbb{E}_{s,a\sim d^{\pi_{o}}_{\mathcal{M}}}%
[|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]+\frac{1-f}{1-\gamma}%
\mathbb{E}_{s,a\sim d^{\pi_{o}}_{\mathcal{M}}}[|r_{\widehat{\mathcal{M}}}(s,a)%
-r_{\mathcal{M}}(s,a)|]
\displaystyle+\frac{f}{1-\gamma}\mathbb{E}_{s,a\sim d^{\pi_{o}}_{\mathcal{M}}}%
[|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]+\frac{1-f}{1-\gamma}%
\mathbb{E}_{s,a\sim d^{\pi_{o}}_{\mathcal{M}}}[|r_{\widehat{\mathcal{M}}}(s,a)%
-r_{\mathcal{M}}(s,a)|]
\displaystyle\leq\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma^{2}fC_{T,\delta}R_{max}}{(1-\gamma%
)^{2}}\mathbb{E}_{s\sim d^{\pi_{o}}_{\mathcal{M}}(s)}\left[\sqrt{\frac{|A|}{|%
\mathcal{D}(s)|}}\sqrt{D_{CQL}(\pi_{o},\pi_{\beta})(s)+1}\right]
\displaystyle\leq
\displaystyle\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma^{2}fC_{T,\delta}R_{max}}{(1-\gamma%
)^{2}}\mathbb{E}_{s\sim d^{\pi_{o}}_{\mathcal{M}}(s)}\left[\sqrt{\frac{|A|}{|%
\mathcal{D}(s)|}}\sqrt{D_{CQL}(\pi_{o},\pi_{\beta})(s)+1}\right]
\displaystyle+\frac{C_{r,\delta}}{1-\gamma}\mathbb{E}_{s,a\sim d_{\mathcal{M}}%
^{\pi_{o}}}\left[\frac{1}{\sqrt{|\mathcal{D}(s,a)}|}\right]+\frac{1}{1-\gamma}%
\mathbb{E}_{s,a\sim d^{\pi_{o}}_{\mathcal{M}}}[|r_{\widehat{\mathcal{M}}}(s,a)%
-r_{\mathcal{M}}(s,a)|]
\displaystyle+\frac{C_{r,\delta}}{1-\gamma}\mathbb{E}_{s,a\sim d_{\mathcal{M}}%
^{\pi_{o}}}\left[\frac{1}{\sqrt{|\mathcal{D}(s,a)}|}\right]+\frac{1}{1-\gamma}%
\mathbb{E}_{s,a\sim d^{\pi_{o}}_{\mathcal{M}}}[|r_{\widehat{\mathcal{M}}}(s,a)%
-r_{\mathcal{M}}(s,a)|]
\displaystyle\triangleq\eta_{1}^{c}.
\displaystyle\triangleq
\displaystyle\eta_{1}^{c}.
\overline{\mathcal{M}}
\displaystyle|\mathbb{E}_{d^{\pi}_{\mathcal{M}}}[(T^{\pi}_{\mathcal{M}}-T^{\pi%
}_{\overline{\mathcal{M}}})Q_{\mathcal{M}}^{\pi}]|\leq\frac{\gamma C_{T,\delta%
}R_{max}}{1-\gamma}\mathbb{E}_{s\sim d^{\pi}_{\mathcal{M}}(s)}\left[\sqrt{%
\frac{|A|}{|\mathcal{D}(s)|}}\sqrt{D_{CQL}(\pi,\pi_{\beta})(s)+1}\right]
\displaystyle|\mathbb{E}_{d^{\pi}_{\mathcal{M}}}[(T^{\pi}_{\mathcal{M}}-T^{\pi%
}_{\overline{\mathcal{M}}})Q_{\mathcal{M}}^{\pi}]|\leq\frac{\gamma C_{T,\delta%
}R_{max}}{1-\gamma}\mathbb{E}_{s\sim d^{\pi}_{\mathcal{M}}(s)}\left[\sqrt{%
\frac{|A|}{|\mathcal{D}(s)|}}\sqrt{D_{CQL}(\pi,\pi_{\beta})(s)+1}\right]
D_{CQL}(\pi_{1},\pi_{2})(s):=\sum_{a}\pi_{1}(a|s)\left(\frac{\pi_{1}(a|s)}{\pi%
_{2}(a|s)}-1\right)
\pi_{c}
\pi_{c}
\pi_{c}
\mathcal{M}
f
\displaystyle J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{c})\geq J(%
M,\pi_{c})-\eta_{2}
\displaystyle J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{c})\geq J(%
M,\pi_{c})-\eta_{2}
\displaystyle\eta_{2}\leq\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{%
\widehat{\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma^{2}fC_{T,\delta}R_{max}}{%
(1-\gamma)^{2}}\mathbb{E}_{s\sim d^{\pi_{c}}_{\mathcal{M}}(s)}\left[\sqrt{%
\frac{|A|}{|\mathcal{D}(s)|}}\sqrt{D_{CQL}(\pi_{c},\pi_{\beta})(s)+1}\right]
\displaystyle\eta_{2}\leq
\displaystyle\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma^{2}fC_{T,\delta}R_{max}}{(1-\gamma%
)^{2}}\mathbb{E}_{s\sim d^{\pi_{c}}_{\mathcal{M}}(s)}\left[\sqrt{\frac{|A|}{|%
\mathcal{D}(s)|}}\sqrt{D_{CQL}(\pi_{c},\pi_{\beta})(s)+1}\right]
\displaystyle+\frac{C_{r,\delta}}{1-\gamma}\mathbb{E}_{s,a\sim d_{\mathcal{M}}%
^{\pi_{c}}}\left[\frac{1}{\sqrt{|\mathcal{D}(s,a)|}}\right]+\frac{1}{1-\gamma}%
\mathbb{E}_{s,a\sim d^{\pi_{c}}_{\mathcal{M}}}[|r_{\widehat{\mathcal{M}}}(s,a)%
-r_{\mathcal{M}}(s,a)|]
\displaystyle+\frac{C_{r,\delta}}{1-\gamma}\mathbb{E}_{s,a\sim d_{\mathcal{M}}%
^{\pi_{c}}}\left[\frac{1}{\sqrt{|\mathcal{D}(s,a)|}}\right]+\frac{1}{1-\gamma}%
\mathbb{E}_{s,a\sim d^{\pi_{c}}_{\mathcal{M}}}[|r_{\widehat{\mathcal{M}}}(s,a)%
-r_{\mathcal{M}}(s,a)|]
\displaystyle\triangleq\eta_{2}^{c}.
\displaystyle\triangleq
\displaystyle\eta_{2}^{c}.
\displaystyle J(\mathcal{M},\pi_{o})+\eta_{1}^{c}-\beta\frac{\nu(\rho^{\pi_{o}%
},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta})-\lambda(1-\alpha)D(\pi_{o%
},\pi_{c})
\displaystyle J(\mathcal{M},\pi_{o})+\eta_{1}^{c}-\beta\frac{\nu(\rho^{\pi_{o}%
},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta})-\lambda(1-\alpha)D(\pi_{o%
},\pi_{c})
\displaystyle\geq J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{o})-%
\beta\frac{\nu(\rho^{\pi_{o}},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta%
})-\lambda(1-\alpha)D(\pi_{o},\pi_{c})
\displaystyle\geq
\displaystyle J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{o})-\beta%
\frac{\nu(\rho^{\pi_{o}},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta})-%
\lambda(1-\alpha)D(\pi_{o},\pi_{c})
\displaystyle\geq J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{c})-%
\beta\frac{\nu(\rho^{\pi_{c}},f)}{1-\gamma}-\lambda\alpha D(\pi_{c},\pi_{\beta})
\displaystyle\geq
\displaystyle J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{c})-\beta%
\frac{\nu(\rho^{\pi_{c}},f)}{1-\gamma}-\lambda\alpha D(\pi_{c},\pi_{\beta})
\displaystyle\geq J(\mathcal{M},\pi_{c})-\eta_{2}^{c}-\beta\frac{\nu(\rho^{\pi%
_{c}},f)}{1-\gamma}-\lambda\alpha D(\pi_{c},\pi_{\beta}),
\displaystyle\geq
\displaystyle J(\mathcal{M},\pi_{c})-\eta_{2}^{c}-\beta\frac{\nu(\rho^{\pi_{c}%
},f)}{1-\gamma}-\lambda\alpha D(\pi_{c},\pi_{\beta}),
\pi_{o}
J(\mathcal{M},\pi_{o})
J(\mathcal{M},\pi_{c})
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{c})-\eta_{1}^{c}-%
\eta_{2}^{c}+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{c})-
\displaystyle\eta_{1}^{c}-\eta_{2}^{c}+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o%
}},f)-\nu(\rho^{\pi_{c}},f)]
\displaystyle+\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta}).
\displaystyle+\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta}).
\eta_{1}^{c}
\eta_{2}^{c}
\beta
\lambda
\pi_{o}
\pi_{c}
\beta
\lambda
\displaystyle\Delta_{c}=\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)%
D(\pi_{o},\pi_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta})+\frac{\beta}{1-\gamma}%
[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]>0.
\displaystyle\Delta_{c}=\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)%
D(\pi_{o},\pi_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta})+\frac{\beta}{1-\gamma}%
[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]>0.
|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|
L_{1}
L_{2}
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|\leq 2(L_{1}+L_{2})D%
_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a)).
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|\leq 2(L_{1}+L_{2})D%
_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a)).
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|
\displaystyle=\left|\mathbb{E}_{\rho^{\pi_{o}}}\left[\frac{\rho^{\pi_{o}}(s,a)%
-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right]-\mathbb{E}_{\rho^{\pi_{c}}}%
\left[\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}%
\right]\right|
\displaystyle=
\displaystyle\left|\mathbb{E}_{\rho^{\pi_{o}}}\left[\frac{\rho^{\pi_{o}}(s,a)-%
d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right]-\mathbb{E}_{\rho^{\pi_{c}}}%
\left[\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}%
\right]\right|
\displaystyle=\left|\sum_{(s,a)}\left[\rho^{\pi_{o}}(s,a)\frac{\rho^{\pi_{o}}(%
s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\rho^{\pi_{c}}(s,a)\frac{\rho^{%
\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right]\right|
\displaystyle=
\displaystyle\left|\sum_{(s,a)}\left[\rho^{\pi_{o}}(s,a)\frac{\rho^{\pi_{o}}(s%
,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\rho^{\pi_{c}}(s,a)\frac{\rho^{%
\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right]\right|
\displaystyle\leq\left|\sum_{(s,a)}\left[\rho^{\pi_{o}}(s,a)\frac{\rho^{\pi_{o%
}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\rho^{\pi_{c}}(s,a)\frac{%
\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right]\right|
\displaystyle\leq
\displaystyle\left|\sum_{(s,a)}\left[\rho^{\pi_{o}}(s,a)\frac{\rho^{\pi_{o}}(s%
,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\rho^{\pi_{c}}(s,a)\frac{\rho^{%
\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right]\right|
\displaystyle+\left|\sum_{(s,a)}\left[\rho^{\pi_{c}}(s,a)\frac{\rho^{\pi_{o}}(%
s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\rho^{\pi_{c}}(s,a)\frac{\rho^{%
\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right]\right|
\displaystyle+\left|\sum_{(s,a)}\left[\rho^{\pi_{c}}(s,a)\frac{\rho^{\pi_{o}}(%
s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\rho^{\pi_{c}}(s,a)\frac{\rho^{%
\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right]\right|
\displaystyle=\left|\sum_{(s,a)}[\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)]\frac%
{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right|
\displaystyle=
\displaystyle\left|\sum_{(s,a)}[\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)]\frac{%
\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right|
\displaystyle+\left|\sum_{(s,a)}\rho^{\pi_{c}}(s,a)\left[\frac{\rho^{\pi_{o}}(%
s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a%
)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right]\right|
\displaystyle+\left|\sum_{(s,a)}\rho^{\pi_{c}}(s,a)\left[\frac{\rho^{\pi_{o}}(%
s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a%
)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right]\right|
\displaystyle\leq\sum_{(s,a)}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|\left|%
\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right|
\displaystyle\leq
\displaystyle\sum_{(s,a)}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|\left|\frac{%
\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right|
\displaystyle+\sum_{(s,a)}\rho^{\pi_{c}}(s,a)\left|\frac{\rho^{\pi_{o}}(s,a)-d%
(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(%
s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right|.
\displaystyle+
\displaystyle\sum_{(s,a)}\rho^{\pi_{c}}(s,a)\left|\frac{\rho^{\pi_{o}}(s,a)-d(%
s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s%
,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right|.
\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right|
\rho^{\pi_{o}}(s,a)\geq d(s,a)
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}\right|
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}\right|
\displaystyle\leq\left|\frac{\rho^{\pi_{o}}(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(%
s,a)}\right|\leq\left|\frac{\rho^{\pi_{o}}(s,a)}{(1-f)\rho^{\pi_{o}}(s,a)}%
\right|=\frac{1}{1-f}.
\displaystyle\leq
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)%
}\right|\leq\left|\frac{\rho^{\pi_{o}}(s,a)}{(1-f)\rho^{\pi_{o}}(s,a)}\right|=%
\frac{1}{1-f}.
\rho^{\pi_{o}}(s,a)<d(s,a)
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}\right|\leq\left|\frac{d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right%
|\leq\left|\frac{d(s,a)}{fd(s,a)}\right|=\frac{1}{f}.
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}\right|\leq\left|\frac{d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}\right%
|\leq\left|\frac{d(s,a)}{fd(s,a)}\right|=\frac{1}{f}.
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}\right|\leq\max\left\{\frac{1}{f},\frac{1}{1-f}\right\}\triangleq L_{1}.
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}\right|\leq\max\left\{\frac{1}{f},\frac{1}{1-f}\right\}\triangleq L_{1}.
\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o}}(s,a)}-%
\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}\right|
g(x)=\frac{x-d}{fd+(1-f)x}
x\in[0,1]
d(s,a)=0
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}%
\right|=0.
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}%
\right|=0.
(s,a)
d(s,a)>0
g(x)
|\nabla g(x)|\leq\frac{1}{f^{2}d}\triangleq L_{2}
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}%
\right|\leq L_{2}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|.
\displaystyle\left|\frac{\rho^{\pi_{o}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{o%
}}(s,a)}-\frac{\rho^{\pi_{c}}(s,a)-d(s,a)}{fd(s,a)+(1-f)\rho^{\pi_{c}}(s,a)}%
\right|\leq L_{2}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|.
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|
\displaystyle\leq L_{1}\sum_{(s,a)}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|+L%
_{2}\sum_{(s,a)}\rho^{\pi_{c}}(s,a)|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|
\displaystyle\leq
\displaystyle L_{1}\sum_{(s,a)}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|+L_{2}%
\sum_{(s,a)}\rho^{\pi_{c}}(s,a)|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|
\displaystyle\leq(L_{1}+L_{2})\sum_{s,a}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,%
a)|
\displaystyle\leq
\displaystyle(L_{1}+L_{2})\sum_{s,a}|\rho^{\pi_{o}}(s,a)-\rho^{\pi_{c}}(s,a)|
\displaystyle=2(L_{1}+L_{2})D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a)).
\displaystyle=
\displaystyle 2(L_{1}+L_{2})D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a)).
\displaystyle\rho^{\pi_{o}}(s,a)=d_{\widehat{\mathcal{M}}}^{\pi_{o}}(s)\pi_{o}%
(a|s),~{}~{}\rho^{\pi_{c}}(s,a)=d_{\widehat{\mathcal{M}}}^{\pi_{c}}(s)\pi_{c}(%
a|s),
\displaystyle\rho^{\pi_{o}}(s,a)=d_{\widehat{\mathcal{M}}}^{\pi_{o}}(s)\pi_{o}%
(a|s),~{}~{}\rho^{\pi_{c}}(s,a)=d_{\widehat{\mathcal{M}}}^{\pi_{c}}(s)\pi_{c}(%
a|s),
\pi_{o}
\pi_{c}
\widehat{\mathcal{M}}
\pi_{o}
\pi_{c}
D(\pi_{1}||\pi_{2})=\max_{s}D_{tv}(\pi_{1}||\pi_{2})
\pi_{1}
\pi_{2}
\displaystyle D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a))\leq\frac{1}{1-%
\gamma}\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)).
\displaystyle D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a))\leq\frac{1}{1-%
\gamma}\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)).
\displaystyle D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a))\leq(1-\gamma)%
\sum_{t=0}^{\infty}\gamma^{t}D_{tv}(\rho_{t}^{\pi_{o}}(s,a)||\rho_{t}^{\pi_{c}%
}(s,a)).
\displaystyle D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a))\leq(1-\gamma)%
\sum_{t=0}^{\infty}\gamma^{t}D_{tv}(\rho_{t}^{\pi_{o}}(s,a)||\rho_{t}^{\pi_{c}%
}(s,a)).
t
\pi_{o}
\pi_{c}
\widehat{\mathcal{M}}
\displaystyle D_{tv}(\rho_{t}^{\pi_{o}}(s,a)||\rho_{t}^{\pi_{c}}(s,a))
\displaystyle D_{tv}(\rho_{t}^{\pi_{o}}(s,a)||\rho_{t}^{\pi_{c}}(s,a))
\displaystyle\leq D_{tv}(\rho_{t}^{\pi_{o}}(s)||\rho_{t}^{\pi_{c}}(s))+\max_{s%
}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s))
\displaystyle\leq
\displaystyle D_{tv}(\rho_{t}^{\pi_{o}}(s)||\rho_{t}^{\pi_{c}}(s))+\max_{s}D_{%
tv}(\pi_{o}(a|s)||\pi_{c}(a|s))
\displaystyle\leq t\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s))+\max_{s}D_{tv}(%
\pi_{o}(a|s)||\pi_{c}(a|s))
\displaystyle\leq
\displaystyle t\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s))+\max_{s}D_{tv}(\pi_{%
o}(a|s)||\pi_{c}(a|s))
\displaystyle=(t+1)\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)),
\displaystyle=
\displaystyle(t+1)\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)),
\displaystyle D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a))\leq(1-\gamma)%
\sum_{t=0}^{\infty}\gamma^{t}(t+1)\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s))
\displaystyle D_{tv}(\rho^{\pi_{o}}(s,a)||\rho^{\pi_{c}}(s,a))
\displaystyle\leq(1-\gamma)\sum_{t=0}^{\infty}\gamma^{t}(t+1)\max_{s}D_{tv}(%
\pi_{o}(a|s)||\pi_{c}(a|s))
\displaystyle=\frac{1}{1-\gamma}\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)).
\displaystyle=\frac{1}{1-\gamma}\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)).
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|\leq\frac{2(L_{1}+L_%
{2})}{1-\gamma}\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s))
\displaystyle|\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)|
\displaystyle\leq\frac{2(L_{1}+L_{2})}{1-\gamma}\max_{s}D_{tv}(\pi_{o}(a|s)||%
\pi_{c}(a|s))
\displaystyle\triangleq C\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)).
\displaystyle\triangleq C\max_{s}D_{tv}(\pi_{o}(a|s)||\pi_{c}(a|s)).
D(\cdot,\cdot)=\max_{s}D_{tv}(\cdot||\cdot)
\lambda\geq\lambda_{0}
\lambda_{0}>\frac{C\beta}{(1-\gamma)(1-2\alpha)}
\alpha<\frac{1}{2}
\displaystyle\Delta_{c}=\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)%
D(\pi_{o},\pi_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta})+\frac{\beta}{1-\gamma}%
[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]
\displaystyle\Delta_{c}=
\displaystyle\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta})+\frac{\beta}{1-\gamma}[\nu(\rho^%
{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]
\displaystyle=\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda\alpha D(\pi_{o},\pi%
_{c})-\lambda\alpha D(\pi_{c},\pi_{\beta})+\lambda(1-2\alpha)D(\pi_{o},\pi_{c})
\displaystyle=
\displaystyle\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda\alpha D(\pi_{o},\pi_%
{c})-\lambda\alpha D(\pi_{c},\pi_{\beta})+\lambda(1-2\alpha)D(\pi_{o},\pi_{c})
\displaystyle+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},%
f)]
\displaystyle+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},%
f)]
\displaystyle\geq\lambda(1-2\alpha)D(\pi_{o},\pi_{c})+\frac{\beta}{1-\gamma}[%
\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]
\displaystyle\geq
\displaystyle\lambda(1-2\alpha)D(\pi_{o},\pi_{c})+\frac{\beta}{1-\gamma}[\nu(%
\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{c}},f)]
\displaystyle\geq\lambda(1-2\alpha)D(\pi_{o},\pi_{c})-\frac{C\beta}{1-\gamma}D%
(\pi_{o},\pi_{c})
\displaystyle\geq
\displaystyle\lambda(1-2\alpha)D(\pi_{o},\pi_{c})-\frac{C\beta}{1-\gamma}D(\pi%
_{o},\pi_{c})
\displaystyle=(\lambda-\lambda_{0})(1-2\alpha)D(\pi_{o},\pi_{c})+\left[\lambda%
_{0}(1-2\alpha)-\frac{C\beta}{1-\gamma}\right]D(\pi_{o},\pi_{c})>0.
\displaystyle=
\displaystyle(\lambda-\lambda_{0})(1-2\alpha)D(\pi_{o},\pi_{c})+\left[\lambda_%
{0}(1-2\alpha)-\frac{C\beta}{1-\gamma}\right]D(\pi_{o},\pi_{c})>0.
1-\delta
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{c})\underbrace{-%
\eta_{1}^{c}-\eta_{2}^{c}}_{(a)}\underbrace{+(\lambda-\lambda_{0})(1-2\alpha)D%
(\pi_{o},\pi_{c})}_{(b)}\underbrace{+\left[\lambda_{0}(1-2\alpha)-\frac{C\beta%
}{1-\gamma}\right]D(\pi_{o},\pi_{c})}_{(c)},
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{c})\underbrace{-%
\eta_{1}^{c}-\eta_{2}^{c}}_{(a)}\underbrace{+(\lambda-\lambda_{0})(1-2\alpha)D%
(\pi_{o},\pi_{c})}_{(b)}\underbrace{+\left[\lambda_{0}(1-2\alpha)-\frac{C\beta%
}{1-\gamma}\right]D(\pi_{o},\pi_{c})}_{(c)},
\delta
\lambda
\lambda
\lambda
\pi_{c}
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{c})+\xi_{1}
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{c})+\xi_{1}
\xi_{1}\geq 0
\pi_{\beta}
\pi_{o}
\pi_{\beta}
\displaystyle J(\mathcal{M}_{1},\mathcal{M}_{2},f,\pi_{\beta})\geq J(\mathcal{%
M},\pi_{\beta})-\eta_{3}
\displaystyle J(\mathcal{M}_{1},\mathcal{M}_{2},f,\pi_{\beta})\geq J(\mathcal{%
M},\pi_{\beta})-\eta_{3}
\displaystyle\eta_{3}=\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{%
\widehat{\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma f}{1-\gamma}|\mathbb{E}_{%
d^{\pi_{\beta}}_{\mathcal{M}}}[(T^{\pi_{\beta}}_{\mathcal{M}}-T^{\pi_{\beta}}_%
{\overline{\mathcal{M}}})Q_{\mathcal{M}}^{\pi_{\beta}}]|
\displaystyle\eta_{3}=
\displaystyle\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma f}{1-\gamma}|\mathbb{E}_{d^{\pi_{%
\beta}}_{\mathcal{M}}}[(T^{\pi_{\beta}}_{\mathcal{M}}-T^{\pi_{\beta}}_{%
\overline{\mathcal{M}}})Q_{\mathcal{M}}^{\pi_{\beta}}]|
\displaystyle+\frac{f}{1-\gamma}\mathbb{E}_{s,a\sim d^{\pi_{\beta}}_{\mathcal{%
M}}}[|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]+\frac{1-f}{1-%
\gamma}\mathbb{E}_{s,a\sim d^{\pi_{\beta}}_{\mathcal{M}}}[|r_{\widehat{%
\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]
\displaystyle+\frac{f}{1-\gamma}\mathbb{E}_{s,a\sim d^{\pi_{\beta}}_{\mathcal{%
M}}}[|r_{\overline{\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]+\frac{1-f}{1-%
\gamma}\mathbb{E}_{s,a\sim d^{\pi_{\beta}}_{\mathcal{M}}}[|r_{\widehat{%
\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]
\displaystyle\leq\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma^{2}fC_{T,\delta}R_{max}}{(1-\gamma%
)^{2}}\mathbb{E}_{s\sim d^{\pi_{\beta}}_{\mathcal{M}}(s)}\left[\sqrt{\frac{|A|%
}{|\mathcal{D}(s)|}}\right]
\displaystyle\leq
\displaystyle\frac{2\gamma(1-f)}{(1-\gamma)^{2}}R_{max}D_{tv}(T_{\widehat{%
\mathcal{M}}},T_{\mathcal{M}})+\frac{\gamma^{2}fC_{T,\delta}R_{max}}{(1-\gamma%
)^{2}}\mathbb{E}_{s\sim d^{\pi_{\beta}}_{\mathcal{M}}(s)}\left[\sqrt{\frac{|A|%
}{|\mathcal{D}(s)|}}\right]
\displaystyle+\frac{C_{r,\delta}}{1-\gamma}\mathbb{E}_{s,a\sim d_{\mathcal{M}}%
^{\pi_{\beta}}}\left[\frac{1}{\sqrt{|\mathcal{D}(s,a)|}}\right]+\frac{1}{1-%
\gamma}\mathbb{E}_{s,a\sim d^{\pi_{\beta}}_{\mathcal{M}}}[|r_{\widehat{%
\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]
\displaystyle+\frac{C_{r,\delta}}{1-\gamma}\mathbb{E}_{s,a\sim d_{\mathcal{M}}%
^{\pi_{\beta}}}\left[\frac{1}{\sqrt{|\mathcal{D}(s,a)|}}\right]+\frac{1}{1-%
\gamma}\mathbb{E}_{s,a\sim d^{\pi_{\beta}}_{\mathcal{M}}}[|r_{\widehat{%
\mathcal{M}}}(s,a)-r_{\mathcal{M}}(s,a)|]
\displaystyle\triangleq\eta_{3}^{\beta}.
\displaystyle\triangleq
\displaystyle\eta_{3}^{\beta}.
\displaystyle J(\mathcal{M},\pi_{o})+\eta_{1}^{c}-\beta\frac{\nu(\rho^{\pi_{o}%
},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta})-\lambda(1-\alpha)D(\pi_{o%
},\pi_{c})
\displaystyle J(\mathcal{M},\pi_{o})+\eta_{1}^{c}-\beta\frac{\nu(\rho^{\pi_{o}%
},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta})-\lambda(1-\alpha)D(\pi_{o%
},\pi_{c})
\displaystyle\geq J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{o})-%
\beta\frac{\nu(\rho^{\pi_{o}},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta%
})-\lambda(1-\alpha)D(\pi_{o},\pi_{c})
\displaystyle\geq
\displaystyle J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{o})-\beta%
\frac{\nu(\rho^{\pi_{o}},f)}{1-\gamma}-\lambda\alpha D(\pi_{o},\pi_{\beta})-%
\lambda(1-\alpha)D(\pi_{o},\pi_{c})
\displaystyle\geq J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{\beta}%
)-\beta\frac{\nu(\rho^{\pi_{\beta}},f)}{1-\gamma}-\lambda(1-\alpha)D(\pi_{%
\beta},\pi_{c})
\displaystyle\geq
\displaystyle J(\overline{\mathcal{M}},\widehat{\mathcal{M}},f,\pi_{\beta})-%
\beta\frac{\nu(\rho^{\pi_{\beta}},f)}{1-\gamma}-\lambda(1-\alpha)D(\pi_{\beta}%
,\pi_{c})
\displaystyle\geq J(\mathcal{M},\pi_{\beta})-\eta_{3}^{\beta}-\beta\frac{\nu(%
\rho^{\pi_{\beta}},f)}{1-\gamma}-\lambda(1-\alpha)D(\pi_{\beta},\pi_{c}),
\displaystyle\geq
\displaystyle J(\mathcal{M},\pi_{\beta})-\eta_{3}^{\beta}-\beta\frac{\nu(\rho^%
{\pi_{\beta}},f)}{1-\gamma}-\lambda(1-\alpha)D(\pi_{\beta},\pi_{c}),
1-\delta
\displaystyle J(\mathcal{M},\pi_{c})\geq J(\mathcal{M},\pi_{\beta})-\eta_{1}^{%
c}-\eta_{3}^{\beta}+\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(%
\pi_{o},\pi_{c})-\lambda(1-\alpha)D(\pi_{\beta},\pi_{c})
\displaystyle J(\mathcal{M},\pi_{c})\geq J(\mathcal{M},\pi_{\beta})-\eta_{1}^{%
c}-\eta_{3}^{\beta}+
\displaystyle\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda(1-\alpha)D(\pi_{\beta},\pi_{c})
\displaystyle+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{%
\beta}},f)],
\displaystyle+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{%
\beta}},f)],
\eta_{3}^{\beta}
\delta
\beta
\lambda
1-2\delta
\displaystyle J(\mathcal{M},\pi_{o})\geq\max\{J(\mathcal{M},\pi_{c})+\xi_{1},J%
(\mathcal{M},\pi_{\beta})+\xi_{2}\}
\displaystyle J(\mathcal{M},\pi_{o})\geq\max\{J(\mathcal{M},\pi_{c})+\xi_{1},J%
(\mathcal{M},\pi_{\beta})+\xi_{2}\}
\displaystyle\xi_{1}=-\eta_{1}^{c}-\eta_{2}^{c}+(\lambda-\lambda_{0})(1-2%
\alpha)D(\pi_{o},\pi_{c})+\left[\lambda_{0}(1-2\alpha)-\frac{C\beta}{1-\gamma}%
\right]D(\pi_{o},\pi_{c})
\displaystyle\xi_{1}=-\eta_{1}^{c}-\eta_{2}^{c}+(\lambda-\lambda_{0})(1-2%
\alpha)D(\pi_{o},\pi_{c})+\left[\lambda_{0}(1-2\alpha)-\frac{C\beta}{1-\gamma}%
\right]D(\pi_{o},\pi_{c})
\displaystyle\xi_{2}=-\eta_{1}^{c}-\eta_{3}^{\beta}+\lambda\alpha D(\pi_{o},%
\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},\pi_{c})-\lambda(1-\alpha)D(\pi_{\beta%
},\pi_{c})
\displaystyle\xi_{2}=-\eta_{1}^{c}-\eta_{3}^{\beta}+\lambda\alpha D(\pi_{o},%
\pi_{\beta})+
\displaystyle\lambda(1-\alpha)D(\pi_{o},\pi_{c})-\lambda(1-\alpha)D(\pi_{\beta%
},\pi_{c})
\displaystyle+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{%
\beta}},f)].
\displaystyle+\frac{\beta}{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{%
\beta}},f)].
\xi_{1}>0
\lambda
\alpha<\frac{1}{2}
\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{\beta}},f)
\xi_{2}
\nu(\rho^{\pi},f)
\mathbb{E}_{\rho^{\pi}}\left[\frac{\rho^{\pi}(s,a)-d(s,a)}{d_{f}(s,a)}\right]
\nu(\rho^{\pi_{\beta}},f)
\nu(\rho^{\pi_{o}},f)
T_{\widehat{\mathcal{M}}}
T_{\mathcal{M}}
\pi_{\beta}
d^{\pi_{\beta}}_{\widehat{\mathcal{M}}}(s,a)
d^{\pi_{\beta}}_{\overline{\mathcal{M}}}(s,a)
\rho^{\pi_{\beta}}
d(s,a)
\displaystyle\epsilon=\frac{\beta[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{\beta}}%
,f)]}{2\lambda(1-\gamma)D(\pi_{o},\pi_{\beta})}.
\displaystyle\epsilon=\frac{\beta[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{\beta}}%
,f)]}{2\lambda(1-\gamma)D(\pi_{o},\pi_{\beta})}.
\alpha>\frac{1}{2}-\epsilon
\displaystyle\Delta_{\beta}=\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-%
\alpha)D(\pi_{o},\pi_{c})-\lambda(1-\alpha)D(\pi_{c},\pi_{\beta})+\frac{\beta}%
{1-\gamma}[\nu(\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{\beta}},f)]
\displaystyle\Delta_{\beta}=
\displaystyle\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda(1-\alpha)D(\pi_{c},\pi_{\beta})+\frac{\beta}{1-\gamma}[\nu(%
\rho^{\pi_{o}},f)-\nu(\rho^{\pi_{\beta}},f)]
\displaystyle=\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda(1-\alpha)D(\pi_{c},\pi_{\beta})+2\epsilon\lambda D(\pi_{o},%
\pi_{\beta})
\displaystyle=
\displaystyle\lambda\alpha D(\pi_{o},\pi_{\beta})+\lambda(1-\alpha)D(\pi_{o},%
\pi_{c})-\lambda(1-\alpha)D(\pi_{c},\pi_{\beta})+2\epsilon\lambda D(\pi_{o},%
\pi_{\beta})
\displaystyle=\lambda\left[(2\epsilon+\alpha)D(\pi_{o},\pi_{\beta})+(1-\alpha)%
D(\pi_{o},\pi_{c})-(1-\alpha)D(\pi_{c},\pi_{\beta})\right]
\displaystyle=
\displaystyle\lambda\left[(2\epsilon+\alpha)D(\pi_{o},\pi_{\beta})+(1-\alpha)D%
(\pi_{o},\pi_{c})-(1-\alpha)D(\pi_{c},\pi_{\beta})\right]
\displaystyle>\lambda(1-\alpha)[D(\pi_{o},\pi_{\beta})+D(\pi_{o},\pi_{c})-D(%
\pi_{c},\pi_{\beta})]
\displaystyle>
\displaystyle\lambda(1-\alpha)[D(\pi_{o},\pi_{\beta})+D(\pi_{o},\pi_{c})-D(\pi%
_{c},\pi_{\beta})]
\displaystyle>0,
\displaystyle>
\displaystyle 0,
\Delta_{\beta}
\lambda
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{\beta})+\xi_{2}=J(%
\mathcal{M},\pi_{\beta})-\eta_{1}^{c}-\eta_{3}^{\beta}+\Delta_{\beta}>J(%
\mathcal{M},\pi_{\beta})
\displaystyle J(\mathcal{M},\pi_{o})\geq J(\mathcal{M},\pi_{\beta})+\xi_{2}=J(%
\mathcal{M},\pi_{\beta})-\eta_{1}^{c}-\eta_{3}^{\beta}+\Delta_{\beta}>J(%
\mathcal{M},\pi_{\beta})
\lambda
