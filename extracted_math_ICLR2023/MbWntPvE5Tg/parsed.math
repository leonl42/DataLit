\gamma
\mathcal{M}=\langle\mathcal{S},\mathcal{A},\mathcal{T},\rho_{0},r,\gamma,%
\mathcal{G},p_{g},\phi\rangle
\mathcal{S}
\mathcal{A}
\mathcal{T}:\mathcal{S}\times\mathcal{A}^{k}\rightarrow\mathcal{S}
k
\mathcal{T}
\rho_{0}:\mathcal{S}\rightarrow[0,1]
\gamma\in[0,1]
\pi(a|s):\mathcal{S}\rightarrow\mathcal{A}
r:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
R=\sum_{t=0}^{t}\gamma^{t}r(s_{t},a_{t})
\mathcal{G}
p_{g}
\phi:\mathcal{S}\rightarrow\mathcal{G}
r_{g}(s_{t},a_{t},g)=\mathbbm{1}({\text{the goal is reached}})=\mathbbm{1}(\|%
\phi(s_{t+1})-g\|\leq\epsilon)~{}.
d
\tilde{r}_{g}(s_{t},a_{t},g)=-d(\phi(s_{t+1}),g)
h
I
\displaystyle\pi(\cdot|s)=\int_{s^{\prime}}h_{\pi}(s^{\prime}|s)I(\cdot|s,s^{%
\prime})\mathop{}\!\mathrm{d}s^{\prime}=\mathbb{E}_{{\scriptsize\hat{s}^{%
\prime}\sim h_{\pi}(\hat{s}^{\prime}|s)}}\Big{[}I(\cdot|s,\hat{s}^{\prime})%
\Big{]}~{}.
\displaystyle\pi(\cdot|s)=\int_{s^{\prime}}h_{\pi}(s^{\prime}|s)I(\cdot|s,s^{%
\prime})\mathop{}\!\mathrm{d}s^{\prime}=\mathbb{E}_{{\scriptsize\hat{s}^{%
\prime}\sim h_{\pi}(\hat{s}^{\prime}|s)}}\Big{[}I(\cdot|s,\hat{s}^{\prime})%
\Big{]}~{}.
\mathcal{M}=\langle\mathcal{S},\mathcal{A},\mathcal{T},\rho_{0},r,\gamma,%
\mathcal{G},p_{g},\phi\rangle
\mathcal{\tilde{M}}=\langle\mathcal{\tilde{S}},\mathcal{\tilde{A}},\mathcal{%
\tilde{T}},\tilde{\rho}_{0},\tilde{r},\gamma,\mathcal{G},p_{g},\tilde{\phi}\rangle
\mathcal{S},\mathcal{\tilde{S}}
\mathcal{A},\mathcal{\tilde{A}}
k
A^{k}=\{a_{t},...,a_{t+k}\}
\forall s,s^{\prime}\in\mathcal{S},\forall a\in\mathcal{A}
\exists\tilde{s},\tilde{s}^{\prime}\in\mathcal{\tilde{S}}
\mathcal{T}(s^{\prime}|s,a)=\mathcal{\tilde{T}}(\tilde{s}^{\prime}|\tilde{s},A%
^{k}),r(s,a,g^{t})=\tilde{r}(\tilde{s},\tilde{a},g^{t}),\phi(s)=\tilde{\phi}(%
\tilde{s}),\phi(s^{\prime})=\tilde{\phi}(\tilde{s}^{\prime})~{}.
\phi
f
\pi(a|s,g^{t})
\displaystyle\pi(a|s,g^{t})=\int_{s^{\prime}}h_{\pi}(s^{\prime}|s,g^{t})I(%
\cdot|s,s^{\prime})\mathop{}\!\mathrm{d}s^{\prime}=\mathbb{E}_{{\scriptsize%
\hat{s}^{\prime}\sim h_{\pi}(\hat{s}^{\prime}|s,g^{t})}}\Big{[}I(\cdot|s,\hat{%
s}^{\prime})\Big{]}~{},
\displaystyle\pi(a|s,g^{t})=\int_{s^{\prime}}h_{\pi}(s^{\prime}|s,g^{t})I(%
\cdot|s,s^{\prime})\mathop{}\!\mathrm{d}s^{\prime}=\mathbb{E}_{{\scriptsize%
\hat{s}^{\prime}\sim h_{\pi}(\hat{s}^{\prime}|s,g^{t})}}\Big{[}I(\cdot|s,\hat{%
s}^{\prime})\Big{]}~{},
g^{t}
h_{\pi}
s^{\prime}
\displaystyle s^{\prime}=h(\epsilon;s,g^{t}),~{}~{}\pi(a|s,g^{t})=\mathbb{E}_{%
\epsilon\sim\mathcal{N}}\left[I(a|s,h(\epsilon;s,g^{t}))\right]~{},
\displaystyle s^{\prime}=h(\epsilon;s,g^{t}),~{}~{}\pi(a|s,g^{t})
\displaystyle=\mathbb{E}_{\epsilon\sim\mathcal{N}}\left[I(a|s,h(\epsilon;s,g^{%
t}))\right]~{},
\epsilon
I
\pi_{\mathcal{B}}
\phi
I_{\phi}
\min_{\psi}L^{I}=\mathbb{E}_{(s,s^{\prime})\sim\pi_{\mathcal{B}}}[\text{D}_{%
\text{f}}(I_{\pi_{\mathcal{B}}}(a|s,s^{\prime})\|I_{\phi}(a|s,s^{\prime}))]~{}.
h_{\pi}
I
\displaystyle\nabla_{\psi}\mathcal{L}^{\pi}=\mathbb{E}_{(s,a)\sim\pi,g^{t}\sim
p%
_{g},\epsilon\sim\mathcal{N}}\left[\frac{Q(s,a,g)}{\pi(a|s,g^{t})}\big{(}%
\nabla_{h}I(a|s,h_{\psi}(\epsilon;s,g^{t}))\nabla_{\psi}h_{\psi}(\epsilon;s,g^%
{t})\big{)}\right]~{},
\displaystyle\nabla_{\psi}\mathcal{L}^{\pi}
\displaystyle=\mathbb{E}_{(s,a)\sim\pi,g^{t}\sim p_{g},\epsilon\sim\mathcal{N}%
}\left[\frac{Q(s,a,g)}{\pi(a|s,g^{t})}\big{(}\nabla_{h}I(a|s,h_{\psi}(\epsilon%
;s,g^{t}))\nabla_{\psi}h_{\psi}(\epsilon;s,g^{t})\big{)}\right]~{},
a
\Delta s^{\prime}=\alpha\nabla_{h}I(a|s,h(\epsilon;s))
\alpha
\displaystyle\max\mathbb{E}_{(s,s^{\prime})\sim\pi}[h(s^{\prime}|s,g^{t})]~{},
\displaystyle\max\mathbb{E}_{(s,s^{\prime})\sim\pi}[h(s^{\prime}|s,g^{t})]~{},
\displaystyle\nabla_{\psi}\mathcal{L}^{\pi}=\mathbb{E}_{(s,a,s^{\prime})\sim%
\pi,g^{t}\sim p_{g},\epsilon\sim\mathcal{N}}\left[\frac{Q(s,a,g)}{\pi(a|s,g^{t%
})}\big{(}\nabla_{h}I(a|s,h_{\psi}(\epsilon;s,g^{t}))\nabla_{\psi}h_{\psi}(%
\epsilon;s,g^{t})\big{)}+\lambda\nabla_{\psi}h_{\psi}(\epsilon;s,g^{t})\right]%
~{},
\displaystyle\nabla_{\psi}\mathcal{L}^{\pi}
\displaystyle=\mathbb{E}_{(s,a,s^{\prime})\sim\pi,g^{t}\sim p_{g},\epsilon\sim%
\mathcal{N}}\left[\frac{Q(s,a,g)}{\pi(a|s,g^{t})}\big{(}\nabla_{h}I(a|s,h_{%
\psi}(\epsilon;s,g^{t}))\nabla_{\psi}h_{\psi}(\epsilon;s,g^{t})\big{)}+\lambda%
\nabla_{\psi}h_{\psi}(\epsilon;s,g^{t})\right]~{},
\lambda
\omega
f_{\omega}(g^{\prime}|g,g^{t})
g^{\prime}
g=\phi(s)
g^{t}
h_{\psi}(s^{\prime}|s,g^{t})
f_{\omega}(g^{\prime}|g,g^{t})
\displaystyle\nabla_{\omega}\mathcal{L}^{f}=\max_{\omega}\mathbb{E}_{s\sim%
\mathcal{B},\tilde{s^{\prime}}\sim h_{\psi}g^{t}\sim p_{g}}[f_{\omega}(\tilde{%
g}^{\prime}|g,g^{t})],\text{ where }g=\phi(s),\tilde{g}^{\prime}=\phi(\tilde{s%
^{\prime}})~{},
\displaystyle\nabla_{\omega}\mathcal{L}^{f}=\max_{\omega}\mathbb{E}_{s\sim%
\mathcal{B},\tilde{s^{\prime}}\sim h_{\psi}g^{t}\sim p_{g}}[f_{\omega}(\tilde{%
g}^{\prime}|g,g^{t})],\text{ where }g=\phi(s),\tilde{g}^{\prime}=\phi(\tilde{s%
^{\prime}})~{},
\mathcal{B}
\phi
g_{t}
g
f_{\omega}
r(s,a,\hat{g}^{\prime})=\frac{\phi(s^{\prime})\cdot\hat{g}^{\prime}}{\|\phi(s^%
{\prime})\|\|\hat{g}^{\prime}\|},\text{ where }s^{\prime}=\mathcal{T}(s,a)~{},%
\hat{g}^{\prime}\sim f_{\omega}(\hat{g}^{\prime}|g,g^{t})~{}.
c
\mathcal{B}_{s}
h_{\psi}
I_{\phi}
f_{\omega}
\mathcal{B}_{t}
f_{\omega}
\pi_{\theta}
\triangleright
k=0,1,2,\cdots
\{(s,a,s^{\prime},g^{t},r,\text{done})\}
\pi=\mathbb{E}_{\epsilon\sim\mathcal{N}}\left[I_{\phi}(a|s,h_{\psi}(\epsilon;s%
))\right]
\mathcal{B}
(s,a,s^{\prime},g_{t},r)\sim\mathcal{B}_{s}
\phi
L^{I}
\triangleright
\omega
\nabla_{\omega}\mathcal{L}^{f}
\triangleright
k=0,1,2,\cdots
\{(s,a,s^{\prime},g^{t},r,\text{done})\}
\pi_{\theta}
r=r+r(s,a,\hat{g}^{\prime}),~{}\text{where }\hat{g}^{\prime}\sim f_{\omega}(%
\hat{g}^{\prime}|\phi(s),g^{t})
\{(s,a,s^{\prime},g^{t},r,\text{done})\}
\mathcal{B}_{t}
\{(s,a,s^{\prime},g^{t},r,\text{done})\}\sim\mathcal{B}_{t}
\pi_{\theta}
m
s^{\prime}=f_{s}(a)
s
n=2m
s^{\prime}=f_{s}(h(a))
h
h=-\exp(a[0:n/2]+1)+\exp(a[n/2:-1]))/1.5~{}
a[i:j]
i
(j-1)
a
3\times 3
\in\{1e5,1e6\}
\in\{128,2048,4096\}
\pi
\in\{3e-4,1e-3\}
\lambda\in\{1e-3,5e-3,1e-2,5e-2,1e-1\}
I
\Delta\in\{200,500,1500,2000\}
\lambda
\Delta
\Delta
\lambda
\Delta
\lambda=1e-2
\Delta=1500
\gamma
Q
\pi
\gamma
\lambda
Q
\pi
I
I
\Delta
\gamma
Q
\pi
\Delta
\lambda
\beta
\Delta
\Delta
\Delta
\Delta
\Delta
\Delta
\Delta
\Delta
\lambda
\lambda
\lambda
\lambda
\lambda=0.1
\lambda
\lambda
\lambda
\lambda
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
