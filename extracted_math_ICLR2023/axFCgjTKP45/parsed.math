\mathtt{\langle MASK\rangle}
\theta\in\mathbb{R}^{|V_{t}|\times|V_{s}|}
\gamma\in\mathbb{R}^{|V_{s}|\times|V_{t}|}
f_{\theta}:x_{t}\rightarrow x_{s}
g_{\gamma}:y_{s}\rightarrow y_{t}
x_{t}
y_{t}=f_{\gamma}(M(f_{\theta}(x_{t})))
M
\mathtt{\langle MASK\rangle}
\theta\in\mathbb{R}^{|V_{t}|\times|V_{s}|}
\gamma\in\mathbb{R}^{|V_{s}|\times|V_{t}|}
f_{\theta}:x_{t}\rightarrow x_{s}
g_{\gamma}:y_{s}\rightarrow y_{t}
x_{t}
y_{t}=f_{\gamma}(M(f_{\theta}(x_{t})))
M
\boldsymbol{\theta}
\boldsymbol{\gamma}
\mathtt{base}
\mathtt{bert}
\mathtt{uncased}
V_{s}
|V_{s}|=30522
\displaystyle y_{s}=\langle w_{1},w_{2},\ldots,w_{n}\rangle,
\displaystyle y_{s}=\langle w_{1},w_{2},\ldots,w_{n}\rangle,
w_{i}
V_{t}
|V_{t}|=30
\displaystyle x_{t}=\langle a_{1},a_{2},\ldots,a_{n}\rangle,
\displaystyle x_{t}=\langle a_{1},a_{2},\ldots,a_{n}\rangle,
a_{i}
\displaystyle f_{\theta}:x_{t}\rightarrow x_{s},
\displaystyle f_{\theta}:x_{t}\rightarrow x_{s},
\displaystyle g_{\gamma}:y_{s}\rightarrow y_{t},
\displaystyle g_{\gamma}:y_{s}\rightarrow y_{t},
\displaystyle x_{s}=x_{t}\theta
\displaystyle x_{s}
\displaystyle=x_{t}\theta
\displaystyle y_{t}=y_{s}\gamma,
\displaystyle y_{t}
\displaystyle=y_{s}\gamma,
\displaystyle\theta\in\mathbb{R}^{|V_{t}|\times|V_{s}|}
\displaystyle\theta
\displaystyle\in\mathbb{R}^{|V_{t}|\times|V_{s}|}
\displaystyle\gamma\in\mathbb{R}^{|V_{s}|\times|V_{t}|}
\displaystyle\gamma
\displaystyle\in\mathbb{R}^{|V_{s}|\times|V_{t}|}
\theta
x_{t}
N
x_{t}\in\mathbb{R}^{N\times|V_{t}|}
x_{s}\in\mathbb{R}^{N\times|V_{s}|}
E\in\mathbb{R}^{|V_{s}|\times d}
d
\displaystyle x_{s}^{E}=x_{s}E,
\displaystyle x_{s}^{E}=x_{s}E,
\theta
\gamma
\theta
\gamma
\mathcal{L}_{NLL}(y_{t},y_{t}^{*})
y_{t}=f_{\gamma}(M(f_{\theta}(x_{t})))
x_{t}
y_{t}^{*}
E_{aa}\in\mathbb{R}^{|V_{t}|\times d}
E_{aa}=\theta E
x_{s}
E
\theta
\gamma
\mathtt{\langle MASK\rangle}
V_{s}\times h
V_{s}
h
V_{t}\times h
V_{t}
\mathtt{\langle MASK\rangle}
V_{s}\times h
V_{s}
h
V_{t}\times h
V_{t}
\mathbb{R}^{30522\times 30}
\mathbb{R}^{30522\times 30}
1e^{-5}
size>1
\displaystyle\theta\in\mathbb{R}^{|V_{t}|\times|V_{s}|}
\displaystyle\theta
\displaystyle\in\mathbb{R}^{|V_{t}|\times|V_{s}|}
\displaystyle\gamma\in\mathbb{R}^{|V_{s}|\times|V_{t}|}
\displaystyle\gamma
\displaystyle\in\mathbb{R}^{|V_{s}|\times|V_{t}|}
x_{t}
x_{s}
\displaystyle x_{s}=x_{t}\theta
\displaystyle x_{s}
\displaystyle=x_{t}\theta
\displaystyle y_{t}=\gamma y_{s}.
\displaystyle y_{t}
\displaystyle=\gamma y_{s}.
\theta
x_{t}
N
x_{t}\in\mathbb{R}^{N\times|V_{t}|}
x_{s}\in\mathbb{R}^{N\times|V_{s}|}
E\in\mathbb{R}^{|V_{s}|\times d}
d
\displaystyle x_{s}^{E}=x_{s}E,
\displaystyle x_{s}^{E}=x_{s}E,
E_{aa}\in\mathbb{R}^{|V_{t}|\times d}
\displaystyle E_{aa}=\theta E.
\displaystyle E_{aa}=\theta E.
E_{aa}
d
E_{aa}
E_{aa}
x_{s}
E
\theta
\displaystyle\theta\in\mathbb{R}^{|V_{t}|\times d}
\displaystyle\theta
\displaystyle\in\mathbb{R}^{|V_{t}|\times d}
\displaystyle E\in\mathbb{R}^{|V_{s}|\times d},
\displaystyle E
\displaystyle\in\mathbb{R}^{|V_{s}|\times d},
\theta
E
d
d=768
h
d_{i}=d/h
\displaystyle\theta=\left[\theta_{1},\ldots,\theta_{h}\right],\quad\text{for}~%
{}\theta_{i}\in\mathbb{R}^{|V_{t}|\times d_{i}}
\displaystyle\theta
\displaystyle=\left[\theta_{1},\ldots,\theta_{h}\right],\quad\text{for}~{}%
\theta_{i}\in\mathbb{R}^{|V_{t}|\times d_{i}}
\displaystyle E=\left[E_{1},\ldots,E_{h}\right],\quad\text{for}~{}E_{i}\in%
\mathbb{R}^{|V_{s}|\times d_{i}},
\displaystyle E
\displaystyle=\left[E_{1},\ldots,E_{h}\right],\quad\text{for}~{}E_{i}\in%
\mathbb{R}^{|V_{s}|\times d_{i}},
d_{i}
\displaystyle W_{i}^{Q}\in\mathbb{R}^{d_{i}\times d_{i}}
\displaystyle W_{i}^{Q}\in\mathbb{R}^{d_{i}\times d_{i}}
\displaystyle W_{i}^{K}\in\mathbb{R}^{d_{i}\times d_{i}}
\displaystyle W_{i}^{K}\in\mathbb{R}^{d_{i}\times d_{i}}
\displaystyle W_{i}^{V}\in\mathbb{R}^{d_{i}\times d_{i}}.
\displaystyle W_{i}^{V}\in\mathbb{R}^{d_{i}\times d_{i}}.
\theta
E
\displaystyle Q_{i}=\theta_{i}W_{i}^{Q}
\displaystyle Q_{i}
\displaystyle=\theta_{i}W_{i}^{Q}
\displaystyle K_{i}=E_{i}W_{i}^{K}
\displaystyle K_{i}
\displaystyle=E_{i}W_{i}^{K}
\displaystyle V_{i}=E_{i}W_{i}^{V},
\displaystyle V_{i}
\displaystyle=E_{i}W_{i}^{V},
\displaystyle\bar{E}=\left[\bar{E}_{1},\ldots,\bar{E}_{h}\right],\quad\text{%
where}~{}\bar{E}\in\mathbb{R}^{|V_{t}|\times d}
\displaystyle\bar{E}
\displaystyle=\left[\bar{E}_{1},\ldots,\bar{E}_{h}\right],\quad\text{where}~{}%
\bar{E}\in\mathbb{R}^{|V_{t}|\times d}
\displaystyle\bar{E}_{i}=hardmax\left(\frac{Q_{i}K_{i}^{T}}{\sqrt{d_{i}}}%
\right)V_{i},\quad\text{where}~{}\bar{E}_{i}\in\mathbb{R}^{|V_{t}|\times d_{i}},
\displaystyle\bar{E}_{i}
\displaystyle=hardmax\left(\frac{Q_{i}K_{i}^{T}}{\sqrt{d_{i}}}\right)V_{i},%
\quad\text{where}~{}\bar{E}_{i}\in\mathbb{R}^{|V_{t}|\times d_{i}},
\displaystyle A_{i}=hardmax\left(\frac{Q_{i}K_{i}^{T}}{\sqrt{d_{i}}}\right)\in%
\mathbb{R}^{|V_{t}|\times|V_{s}|},
\displaystyle A_{i}=hardmax\left(\frac{Q_{i}K_{i}^{T}}{\sqrt{d_{i}}}\right)\in%
\mathbb{R}^{|V_{t}|\times|V_{s}|},
\displaystyle\bar{E}=\left[\bar{E}_{1},\ldots,\bar{E}_{h}\right].
\displaystyle\bar{E}
\displaystyle=\left[\bar{E}_{1},\ldots,\bar{E}_{h}\right].
\displaystyle x_{s}^{\bar{E}}=x_{s}\bar{E},
\displaystyle x_{s}^{\bar{E}}=x_{s}\bar{E},
\gamma
\theta
\gamma
\theta
\gamma
h
W_{i}^{Q}
W_{i}^{K}
W_{i}^{V}
A_{i}
A_{i}
