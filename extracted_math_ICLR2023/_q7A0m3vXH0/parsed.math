t
t
t
t
t
t
t
\mathbb{R}^{3}
X
\mathbb{R}^{n}
\mathbb{R}^{n}\xrightarrow[]{E}\mathbb{R}^{l}\xrightarrow[]{D}\mathbb{R}^{n}
E
D
l<n
\ell_{2}
l
M
\mathbb{R}^{n}
D^{-1}\colon M\to\mathbb{R}^{l}
E\colon\mathbb{R}^{n}\to\mathbb{R}^{l}
f\colon\mathbb{R}^{n}\to\mathbb{R}^{n}
p\in\mathbb{R}^{n}
f
p
F\colon M\to N
U
\mathbb{R}^{n}
M
p\in M
T_{p}M
p
f\colon M\to N
p\in M
f
p
d_{p}f
p
d_{p}f\colon T_{p}M\to T_{f(p)}N
J_{p}F
F
p
p
p
g_{e}
F\colon M\to N
m
n
(N,g)
F
F(M)
F
M
\omega_{g}
F(M)
x_{1},...,x_{l}
F
\omega_{g}=\sqrt{\det\left[\left(J_{p}F\right)^{t}J_{p}F\right]}dx_{1}\wedge..%
.\wedge dx_{l}
F
g_{e}
(\mathbb{R}^{n},g_{e})
F\colon\mathbb{R}^{l}\to\mathbb{R}^{n}
D
F^{*}g_{e}
p\in\mathbb{R}^{l}
v,w\in T_{p}\mathbb{R}^{l}
F^{*}g_{e_{p}}(v,w)\coloneqq g_{e_{F}(p)}(d_{p}Fv,d_{p}Fw),
d_{p}F\colon T_{p}\mathbb{R}^{l}\to T_{F(p)}\mathbb{R}^{n}
F
p
F
g_{e}
F
p\in\mathbb{R}^{l}
\langle\cdot,\cdot\rangle_{p}\coloneqq F^{*}g_{e_{p}}=\left(J_{p}F\right)^{t}J%
_{p}F\in\mathbb{R}^{l,l},
J_{p}F\in\mathbb{R}^{n\times l}
F
p
F
M
N
p\in M
F
p
F
p
p
F
F(p)
p
F
g_{e}
D
F=D
F\colon\mathbb{R}^{2}\to\mathbb{R}^{3}
p\in\mathbb{R}^{2}
u
v
p
F
d_{p}F
v
w
F\colon\mathbb{R}^{2}\to\mathbb{R}^{2}
(x,y)\mapsto(x^{2},y^{2})
F\colon\mathbb{R}^{2}\to\mathbb{R}^{3}
p\in\mathbb{R}^{2}
u
v
p
F
d_{p}F
v
w
F\colon\mathbb{R}^{2}\to\mathbb{R}^{2}
(x,y)\mapsto(x^{2},y^{2})
D\colon\mathbb{R}^{l}\to\mathbb{R}^{n}
p\in\mathbb{R}^{l}
v_{i}/\sqrt{\langle v_{i},v_{i}\rangle_{p}}
v_{i}
p
p
v_{i}
p
p
B
\mathcal{L}_{\det}
\mathcal{L}_{\det}=\operatorname{Var}_{x\sim\mathcal{U}(B)}\left[\log\left(%
\det\left(J_{E(x)}D\right)^{t}J_{E(x)}D\right)\right].
\mathcal{L}\to\mathcal{L}_{\text{rec}}+\alpha\mathcal{L}_{\det}
\alpha
\mathcal{L}_{\text{rec}}
\beta\in\mathbb{R}\setminus\{0\}
\mathcal{L}_{\det}
t
t
S^{2}\subset\mathbb{R}^{3}
t
\lambda=0.5
100
\operatorname{ELU}
\alpha=0.1
1
5\%
t
t
t
\mathit{KL_{0.1}}
k
\mathit{KL_{0.1}}
0.1
\mathit{KL_{100}}
\mathit{KL_{100}}
10\%
\langle\text{Rank}\rangle
\langle
\rangle
\langle
\rangle
\operatorname{KL}_{0.1}
\operatorname{KL}_{100}
\langle\text{rank}\rangle
t
t
2
2
2
0
7
2
\mathit{KL_{\sigma}}
D
D
p
p
p
t
X
l
l+1
\mathcal{S}
l
X
(E,D)\in\mathcal{S}
\mathcal{S}
E\in\mathbb{R}^{l\times n}
D\in\mathbb{R}^{n\times l}
W\in\mathbb{R}^{l\times n}
l
l
X
l
V^{\prime}\subset\mathbb{R}^{n}
X\in\mathbb{R}^{n,m}
\mathcal{W}=\{W^{\prime}\in\mathbb{R}^{l,n}\;|\;W^{\prime}\text{ has %
orthonormal rows}\}
W\in\operatorname*{arg\,min}_{W^{\prime}\in\mathcal{W}}\|X-W^{\prime T}W^{%
\prime}X\|_{2}^{2}.
E,D=\operatorname*{arg\,min}_{E^{\prime}\in\mathbb{R}^{l,n},D^{\prime}\in%
\mathbb{R}^{n,l}}\|X-D^{\prime}E^{\prime}X\|_{2}^{2}.
(E,D)=(AW,W^{T}A^{-1})
A\in\text{GL}(l,\mathbb{R})
DE
l
V
\mathbb{R}^{n}
V\subset\mathbb{R}^{n}
\ell_{2}
\mathbb{R}^{n}
B\in\mathbb{R}^{l,n}
V
\mathbb{R}^{n}\to V
v\mapsto B^{T}Bv
DE=B^{T}B
B
(E,D)
(E,D)=(AW,W^{T}A^{-1})
A\in\text{GL}(l,\mathbb{R})
V^{\prime}
l
W^{T}W
V^{\prime}
DE
W^{T}W
W
D
W^{T}
A\in\text{GL}(l,\mathbb{R})
D=W^{T}A^{-1}
W
WW^{T}=I
DE=W^{T}W
W
\displaystyle A^{-1}E=WW^{T}A^{-1}E=W(DE)=W(W^{T}W)
\displaystyle A^{-1}E
\displaystyle=WW^{T}A^{-1}E=W(DE)=W(W^{T}W)
\displaystyle=W.
\displaystyle=W.
\#
A
E
D
E
D
(E,D)\in\{(AW,W^{T}A^{-1})|A\in\text{GL}(l,\mathbb{R})\}
A
M\in\mathbb{R}^{m,n}
\|M\|_{F}^{2}=\operatorname{tr}(MM^{t})
E
D
A
A
A=U^{t}\Sigma V
U
V
l\times l
\Sigma=(\sigma_{1},\sigma_{2},...,\sigma_{l-1},\sigma_{l})
l\times l
\sigma_{i}\neq 0
D
\begin{split}\|D\|_{F}&=\|W^{T}A^{-1}\|_{F}\\
&=\|W^{T}V^{T}\Sigma^{-1}U\|_{F}\\
&=\|\Sigma^{-1}\|_{F},\end{split}
U
V
W
\begin{split}\|E\|_{F}=\|\Sigma\|_{F}.\end{split}
\begin{split}\text{loss}_{\text{weight decay}}&=\|D\|_{F}^{2}+\|E\|_{F}^{2}\\
&=\|\Sigma^{-1}\|_{F}^{2}+\|\Sigma\|_{F}^{2}\\
&=\sum_{i}\sigma_{i}^{2}+\sigma_{i}^{-2},\end{split}
\sigma_{i}=\pm 1.
A=U^{t}\operatorname{diag}(\pm 1)V\in O(l),
U
\operatorname{diag}(\pm 1)
V
\#
D
p\in\mathbb{R}^{l}
p
\langle\cdot,\cdot\rangle_{p}\coloneqq D^{*}g_{e_{p}}=\left(J_{p}D\right)^{t}J%
_{p}D\in\mathbb{R}^{2,2},
J_{p}D
p
\mathbb{R}^{l}
\mathbb{R}^{n}
D
p
J_{p}D
(\mathbb{R}^{l},D^{*}g)
\displaystyle\langle v,w\rangle_{p}\coloneqq D^{*}g_{p}(v,w)=d_{p}D(v)^{t}d_{p%
}D(w)
\displaystyle\langle v,w\rangle_{p}
\displaystyle\coloneqq D^{*}g_{p}(v,w)=d_{p}D(v)^{t}d_{p}D(w)
\displaystyle=\left(J_{p}Dv\right)^{t}J_{p}Dw=v^{t}\left(J_{p}D^{t}J_{p}D%
\right)w.
\displaystyle=\left(J_{p}Dv\right)^{t}J_{p}Dw=v^{t}\left(J_{p}D^{t}J_{p}D%
\right)w.
\mathcal{L}_{\det}(D)\geq 0
\mathcal{L}_{\det}(D)=0
x,x^{\prime}\in X
\det((J_{E(x)}D)^{t}J_{E(x)}D)=\det((J_{E(x^{\prime})}D)^{t}J_{E(x^{\prime})}D)
D
\tilde{D}
c>0
x\in X
\det((J_{E(x)}D)^{t}J_{E(x)}D)=c\det((J_{E(x)}\tilde{D})^{t}J_{E(x)}\tilde{D})
\mathcal{L}_{\det}(D)=\mathcal{L}_{\det}(\tilde{D})
F:\mathbb{R}^{l}\to\mathbb{R}^{l}
\det(J_{z}F)
z
(E,D)
(F^{-1}\circ E,D\circ F)
\mathcal{L}_{\det}(D)=\mathcal{L}_{\det}(D\circ F)
F
F^{-1}
d=\det(J_{z}F)
F
x\in X
\displaystyle J_{F^{-1}(E(x))}(D\circ F)=J_{E(x)}(D)J_{F^{-1}(E(x))}(F)
\displaystyle J_{F^{-1}(E(x))}(D\circ F)=J_{E(x)}(D)J_{F^{-1}(E(x))}(F)
\displaystyle\det\left(J_{F^{-1}(E(x))}(D\circ F)^{t}J_{F^{-1}(E(x))}(D\circ F%
)\right)
\displaystyle\det\left(J_{F^{-1}(E(x))}(D\circ F)^{t}J_{F^{-1}(E(x))}(D\circ F%
)\right)
\displaystyle\quad=d^{2}\det\left(J_{E(x)}(D)^{t}J_{E(x)}(D)\right).
\displaystyle\quad=d^{2}\det\left(J_{E(x)}(D)^{t}J_{E(x)}(D)\right).
\displaystyle\mathcal{L}_{\det}(D\circ F)
\displaystyle\mathcal{L}_{\det}(D\circ F)
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log\left(\det%
\left(J_{F^{-1}(E(x))}(D\circ F)^{t}\right.\right.\right.
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log\left(\det%
\left(J_{F^{-1}(E(x))}(D\circ F)^{t}\right.\right.\right.
\displaystyle\qquad\qquad\qquad\qquad\;\,\left.\left.\left.J_{F^{-1}(E(x))}(D%
\circ F)\right)\right)\right)
\displaystyle\qquad\qquad\qquad\qquad\;\,\left.\left.\left.J_{F^{-1}(E(x))}(D%
\circ F)\right)\right)\right)
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log\left(d^{2}%
\det(J_{E(x)}(D)^{t}J_{E(x)}(D))\right)\right)
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log\left(d^{2}%
\det(J_{E(x)}(D)^{t}J_{E(x)}(D))\right)\right)
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log(\det(J_{E(x)%
}(D)^{t}J_{E(x)}(D)))\right.
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log(\det(J_{E(x)%
}(D)^{t}J_{E(x)}(D)))\right.
\displaystyle\qquad\qquad\qquad\;+2\log(d)\big{)}
\displaystyle\qquad\qquad\qquad\;+2\log(d)\big{)}
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log(\det(J_{E(x)%
}(D)^{t}J_{E(x)}(D)))\right)
\displaystyle=\operatorname*{Var}_{x\sim\mathcal{U}(B)}\left(\log(\det(J_{E(x)%
}(D)^{t}J_{E(x)}(D)))\right)
\displaystyle=\mathcal{L}_{\det}(D).
\displaystyle=\mathcal{L}_{\det}(D).
\beta\in\mathbb{R}\setminus\{0\}
\beta^{-1}
F
\beta
z
d(z)\coloneqq\det((J_{z}D)^{t}J_{z}D)
\lambda_{1}(z),\dots,\lambda_{l}(z)
z
z\sim\mathcal{U}(B)
z=E(x)
x
x\sim\mathcal{U}(B)
\displaystyle\mathcal{L}_{\det}
\displaystyle\mathcal{L}_{\det}
\displaystyle=\operatorname*{Var}_{z\sim\mathcal{U}(B)}\left[\log\left(d(z)%
\right)\right]
\displaystyle=\operatorname*{Var}_{z\sim\mathcal{U}(B)}\left[\log\left(d(z)%
\right)\right]
\displaystyle=\operatorname*{\mathbb{E}}_{z\sim\mathcal{U}(B)}\left[\left(\log%
(d(z))-\operatorname*{\mathbb{E}}_{z^{\prime}\sim\mathcal{U}(B)}\log(d(z^{%
\prime}))\right)^{2}\right]
\displaystyle=\operatorname*{\mathbb{E}}_{z\sim\mathcal{U}(B)}\left[\left(\log%
(d(z))-\operatorname*{\mathbb{E}}_{z^{\prime}\sim\mathcal{U}(B)}\log(d(z^{%
\prime}))\right)^{2}\right]
\displaystyle=\operatorname*{\mathbb{E}}_{z\sim\mathcal{U}(B)}\left[\left(\sum%
_{i=1}^{l}\log(\lambda_{i}(z))\right.\right.
\displaystyle=\operatorname*{\mathbb{E}}_{z\sim\mathcal{U}(B)}\left[\left(\sum%
_{i=1}^{l}\log(\lambda_{i}(z))\right.\right.
\displaystyle\qquad\qquad\qquad-\operatorname*{\mathbb{E}}_{z^{\prime}\sim%
\mathcal{U}(B)}\sum_{j=1}^{l}\log(\lambda_{j}(z^{\prime}))\Bigg{)}^{2}\Bigg{]}
\displaystyle\qquad\qquad\qquad-\operatorname*{\mathbb{E}}_{z^{\prime}\sim%
\mathcal{U}(B)}\sum_{j=1}^{l}\log(\lambda_{j}(z^{\prime}))\Bigg{)}^{2}\Bigg{]}
\mathbb{P}
h:\mathbb{R}\to[0,\infty)
h(1)=0
h^{\prime}(\lambda)=0
\lambda=1
S:\mathbb{R}^{l}\to\mathbb{R}
\displaystyle S(\alpha\lambda_{1},\dots,\alpha\lambda_{l})=\alpha S(\lambda_{1%
},\dots,\lambda_{l})
\displaystyle S(\alpha\lambda_{1},\dots,\alpha\lambda_{l})
\displaystyle=\alpha S(\lambda_{1},\dots,\lambda_{l})
\displaystyle S(1,\dots,1)=1.
\displaystyle S(1,\dots,1)
\displaystyle=1.
\mathbb{P}
h
S
\displaystyle\mathcal{L}_{\text{Lee}}(\mathbb{P},h,S)=
\displaystyle\mathcal{L}_{\text{Lee}}(\mathbb{P},h,S)=
\displaystyle\quad\operatorname*{\mathbb{E}}_{z\sim\mathbb{P}}\left(\sum_{i=1}%
^{l}h\left(\frac{\lambda_{i}(z)}{\mathbb{E}_{z^{\prime}\sim\mathbb{P}}S(%
\lambda_{1}(z^{\prime}),\dots,\lambda_{l}(z^{\prime}))}\right)\right)
\displaystyle\quad\operatorname*{\mathbb{E}}_{z\sim\mathbb{P}}\left(\sum_{i=1}%
^{l}h\left(\frac{\lambda_{i}(z)}{\mathbb{E}_{z^{\prime}\sim\mathbb{P}}S(%
\lambda_{1}(z^{\prime}),\dots,\lambda_{l}(z^{\prime}))}\right)\right)
\displaystyle\mathbb{P}\text{ to be given by }z=E(x),x\sim\mathcal{U}(B)
\displaystyle\mathbb{P}\text{ to be given by }z
\displaystyle=E(x),x\sim\mathcal{U}(B)
\displaystyle h(\lambda)=\log(\lambda)^{2}
\displaystyle h(\lambda)
\displaystyle=\log(\lambda)^{2}
\displaystyle S(\lambda_{1},\dots,\lambda_{l})=\frac{1}{l}\sum_{i=1}^{l}%
\lambda_{i}
\displaystyle S(\lambda_{1},\dots,\lambda_{l})
\displaystyle=\frac{1}{l}\sum_{i=1}^{l}\lambda_{i}
\displaystyle\mathcal{L}_{\text{Lee}}=\mathbb{E}_{z\sim\mathcal{U}(B)}\Bigg{[}%
\sum_{i=1}^{l}\Bigg{(}\log(\lambda_{i}(z))
\displaystyle\mathcal{L}_{\text{Lee}}=\mathbb{E}_{z\sim\mathcal{U}(B)}\Bigg{[}%
\sum_{i=1}^{l}\Bigg{(}\log(\lambda_{i}(z))
\displaystyle\qquad\qquad\qquad-\log\Bigg{(}\frac{1}{l}\sum_{j=1}^{l}\mathbb{E%
}_{z^{\prime}\sim\mathcal{U}(B)}\lambda_{i}(z^{\prime})\Bigg{)}\Bigg{)}^{2}%
\Bigg{]}
\displaystyle\qquad\qquad\qquad-\log\Bigg{(}\frac{1}{l}\sum_{j=1}^{l}\mathbb{E%
}_{z^{\prime}\sim\mathcal{U}(B)}\lambda_{i}(z^{\prime})\Bigg{)}\Bigg{)}^{2}%
\Bigg{]}
2
2
100\times 100
2
100\times 100
2.5\pm 1.1
100.0\pm 900.0
10.1\pm 22.1
3.6\pm 3.1
1.0\pm 0.0
14.6\pm 13.8
2.5\pm 1.2
\text{log}_{2}(x+1)
50
100\,000
S^{2}
t
125
10^{-3}
10^{-5}
10^{-5}
100
k
k
2600
100
70\,000
182\,278\,632
2600
70\,000
191\,104\,176
2800
68\,551
191\,021\,188
2800
86\,024
236\,600\,132
2800
48\,969
142807948
3000
39.00\pm 1.00
24.40\pm 0.40
82.10\pm 2.10
1000
125
108.40\pm 4.9
00.20\pm 0.01
t
05.70\pm 0.50
03.51\pm 0.03
4
D\colon\mathbb{R}^{2}\to\mathbb{R}^{n}
J_{x}D\in\mathbb{R}^{n\times 2}
x\in\mathbb{R}^{2}
J=
\mathit{KL_{0.1}}
\mathit{KL_{100}}
\mathit{KL_{\sigma}}
\sigma=0.1,100
f_{\sigma}^{X}
X
f_{\sigma}^{Z}
Z
f_{\sigma}^{X}(x)=\sum_{y\in X}\exp\left(-\sigma^{-1}\frac{\|x-y\|_{2}^{2}}{%
\max_{y^{\prime},x^{\prime}\in X}\|y^{\prime}-x^{\prime}\|_{2}^{2}}\right)
\sigma
\mathit{KL_{\sigma}}
10
200
10
\mathcal{L}_{\det}
M
x
z
M
z-x
M
M
y\in M
z
x
y\in M
z\in M
x
y
\|x-y\|\leq\|x-z\|
\forall z\in M
x-y
y
x=(2,0,...,0)
\text{im}(D)
l
\mathbb{R}^{n}
M
M
g^{\prime}
g^{\prime}
A\in\mathbb{R}^{n,n}
D^{*}g^{\prime}
D^{*}{g^{\prime}}_{p}=\left(J_{p}D\right)^{t}A_{D}(p)J_{p}D
p\in\mathbb{R}^{l}
\ell^{1}
\ell^{1}
\ell^{2}
\ell^{1}
0.21\pm 0.09
\mathbf{0.23\pm 0.15}
0.18\pm 0.06
\mathbf{0.21\pm 0.07}
0.047\pm 0.012
\mathbf{0.074\pm 0.011}
0.036\pm 0.004
\mathbf{0.095\pm 0.010}
0.47\pm 0.13
\mathbf{0.57\pm 0.14}
2
5
2
5
2
5
2
5
2
2
2
5
\operatorname{KL}_{0.1}
\downarrow
\uparrow
\uparrow
\downarrow
\operatorname{KL}_{100}
\downarrow
\uparrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
t
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
t
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
t
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
t
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
t
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\operatorname{KL}_{0.1}
\downarrow
\uparrow
\uparrow
\downarrow
\operatorname{KL}_{100}
\downarrow
\uparrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
