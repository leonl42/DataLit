N
\text{FID}\left(\bm{\mu}_{\text{r}},\bm{\Sigma}_{\text{r}},\bm{\mu}_{\text{g}}%
,\bm{\Sigma}_{\text{g}}\right)=\left\lVert\bm{\mu}_{\text{r}}-\bm{\mu}_{\text{%
g}}\right\rVert_{2}^{2}+\text{Tr}\left(\bm{\Sigma}_{\text{r}}+\bm{\Sigma}_{%
\text{g}}-2\left(\bm{\Sigma}_{\text{r}}\bm{\Sigma}_{\text{g}}\right)^{\frac{1}%
{2}}\right),
\bm{\mu}_{\text{r}}
\bm{\Sigma}_{\text{r}}
\bm{\mu}_{\text{g}}
\bm{\Sigma}_{\text{g}}
\text{Tr}(\cdot)
\sim
\bm{\mu}_{\text{r}},\bm{\Sigma}_{\text{r}}
\bm{\mu}_{\text{g}},\bm{\Sigma}_{\text{g}}
\bm{A}^{k}
8\times 8
\bm{\mu}_{\text{g}},\bm{\Sigma}_{\text{g}}
\bm{f}
\bm{{\mu}}^{\prime}_{\text{g}}=\frac{N-1}{N}\bm{{\mu}}_{\text{g}}+\frac{1}{N}%
\bm{f}
\bm{{\Sigma}}^{\prime}_{\text{g}}=\frac{N-2}{N-1}\bm{{\Sigma}}_{\text{g}}+%
\frac{1}{N}(\bm{f}-\bm{{\mu}}_{\text{g}})^{T}(\bm{f}-\bm{{\mu}}_{\text{g}})
N=50,000
\bm{\alpha}_{k}
k
\bm{\alpha}_{k}=\frac{1}{8\times 8}\sum_{i}\sum_{j}\left|\frac{\partial\text{%
FID}(\bm{\mu}_{\text{r}},\bm{\Sigma}_{\text{r}},\bm{\mu}_{\text{g}}^{\prime},%
\bm{\Sigma}_{\text{g}}^{\prime})}{\partial\bm{A}^{k}_{ij}}\right|^{2}
8\times 8
\sum_{k}\bm{\alpha}_{k}\bm{A}^{k}
N
256\times 256
512\times 512
\text{FID}^{\text{Top-1}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{CLIP}}
\text{FID}^{\text{Top-1}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{CLIP}}
\text{FID}^{\text{Top-1}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{ResNet-50}}^{\text{Top-1}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{SwAV}}^{\text{Top-1}}
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{CLIP}}^{\text{Top-1}}
5.30
4.70
\left(-11.3\%\right)
6.11
5.59
\left(-8.5\%\right)
1.42
1.41
\left(-0.7\%\right)
2.76
2.74
\left(-0.7\%\right)
8.25
7.37
\left(-10.7\%\right)
12.33
11.29
\left(-8.4\%\right)
2.99
2.96
\left(-1.0\%\right)
8.94
8.83
\left(-1.2\%\right)
5.65
5.17
\left(-8.5\%\right)
8.79
8.51
\left(-3.2\%\right)
2.39
2.38
\left(-0.4\%\right)
7.75
7.73
\left(-0.3\%\right)
12.96
11.76
\left(-9.3\%\right)
15.20
13.61
\left(-10.5\%\right)
3.12
3.02
\left(-3.2\%\right)
16.35
16.17
\left(-1.1\%\right)
10.25
9.39
\left(-8.4\%\right)
13.71
13.19
\left(-3.8\%\right)
2.78
2.77
\left(-0.4\%\right)
4.25
4.16
\left(-2.1\%\right)
\sim 10
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{CLIP}}
\sim 1\%
\text{FID}_{\text{CLIP}}
\sim 40\%
N
N
\text{FID}^{\text{PL}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{CLIP}}
\text{FID}^{\text{L}}
\text{FID}^{\text{PL}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{CLIP}}
\text{FID}^{\text{L}}
\text{FID}^{\text{PL}}
\text{FID}^{\text{L}}
\text{FID}_{\text{ResNet-50}}
\text{FID}_{\text{ResNet-50}}^{\text{PL}}
\text{FID}_{\text{SwAV}}
\text{FID}_{\text{SwAV}}^{\text{PL}}
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{CLIP}}^{\text{PL}}
5.30
1.78
\left(-66.4\%\right)
2.22
\left(-58.1\%\right)
6.11
3.85
\left(-37.0\%\right)
1.42
1.24
\left(-12.7\%\right)
2.76
2.64
\left(-4.3\%\right)
8.25
3.05
\left(-63.0\%\right)
3.88
\left(-53.0\%\right)
12.33
7.17
\left(-41.8\%\right)
2.99
2.71
\left(-9.4\%\right)
8.94
7.98
\left(-10.7\%\right)
5.65
2.11
\left(-62.7\%\right)
2.59
\left(-54.2\%\right)
8.79
5.88
\left(-33.1\%\right)
2.39
2.15
\left(-10.0\%\right)
7.75
7.33
\left(-5.4\%\right)
12.96
3.59
\left(-72.3\%\right)
4.43
\left(-65.8\%\right)
15.20
9.35
\left(-38.5\%\right)
3.12
2.60
\left(-16.7\%\right)
16.35
14.54
\left(-11.1\%\right)
10.25
5.92
\left(-42.2\%\right)
6.27
\left(-38.8\%\right)
13.71
11.38
\left(-17.1\%\right)
2.78
2.62
\left(-5.8\%\right)
4.25
4.04
\left(-4.9\%\right)
10\%
10\%
10\%
10\%
\times
w_{i}
\min_{\bm{w}}\left(\left\lVert\bm{{\mu}}_{\text{r}}-\bm{{\mu}}_{\text{g}}(\bm{%
w})\right\rVert^{2}_{2}+\text{Tr}\left(\bm{{\Sigma}}_{\text{r}}+\bm{{\Sigma}}_%
{\text{g}}(\bm{w})-2\left(\bm{{\Sigma}}_{\text{r}}\bm{{\Sigma}}_{\text{g}}(\bm%
{w})\right)^{\frac{1}{2}}\right)\right),
\bm{{\mu}}_{\text{g}}(\bm{w})=\frac{\sum_{i}w_{i}\bm{f}_{i}}{\sum_{i}w_{i}}
\bm{{\Sigma}}_{\text{g}}(\bm{w})=\frac{1}{\sum_{i}w_{i}}\sum_{i}w_{i}\left(\bm%
{f}_{i}-\bm{{\mu}}_{\text{g}}(\bm{w})\right)^{T}\left(\bm{f}_{i}-\bm{{\mu}}_{%
\text{g}}(\bm{w})\right)
\bm{f}_{i}
w_{i}
\text{FID}^{\text{PL}}
\text{FID}^{\text{L}}
y
N
\text{FID}_{\text{CLIP}}
y
\text{FID}_{\text{CLIP}}
y
y
N
\text{FID}_{\text{CLIP}}
y
\text{FID}_{\text{CLIP}}
y
N
N
N
N
N
N
N
N=1
N
N
N
\text{FID}^{\text{PL}}
N
\leq 50
\text{FID}_{\text{CLIP}}
N
\text{FID}=5.28
\text{Recall}=0.45
\text{FID}_{\text{CLIP}}=4.67
\text{FID}=5.30
\text{Recall}=0.46
\text{FID}_{\text{CLIP}}=2.76
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{CLIP}}
11.65\ \mbox{\scriptsize$\pm\ 0.04$}
17.38\ \mbox{\scriptsize$\pm\ 0.13$}
8.31\ \mbox{\scriptsize$\pm\ 0.06$}
12.42\ \mbox{\scriptsize$\pm\ 0.06$}
5.30\ \mbox{\scriptsize$\pm\ 0.04$}
8.25\ \mbox{\scriptsize$\pm\ 0.04$}
5.14\ \mbox{\scriptsize$\pm\ 0.04$}
7.83\ \mbox{\scriptsize$\pm\ 0.03$}
5.30\ \mbox{\scriptsize$\pm\ 0.04$}
8.25\ \mbox{\scriptsize$\pm\ 0.04$}
3.69\ \mbox{\scriptsize$\pm\ 0.05$}
6.64\ \mbox{\scriptsize$\pm\ 0.03$}
\pm
\pm
\text{FID}_{\text{CLIP}}
299\times 299
256\times 256
256\times 256
0.05
0.05
\bm{F}_{\text{r}},\bm{F}_{\text{g}},\alpha,T
\bm{{\mu}}_{\text{r}}\leftarrow\frac{1}{\lvert\bm{F}_{\text{r}}\rvert}\sum_{i}%
\bm{f}_{\text{r}}^{i}
\bm{{\Sigma}}_{\text{r}}\leftarrow\frac{1}{\lvert\bm{F}_{\text{r}}\rvert-1}%
\sum_{i}\left(\bm{f}^{i}_{\text{r}}-\bm{{\mu}}_{\text{r}}\right)^{T}\left(\bm{%
f}^{i}_{\text{r}}-\bm{{\mu}}_{\text{r}}\right)
\bm{w}
w_{i}=0,\ \forall i
T
\bm{{\mu}}_{\text{g}}(\bm{w})\leftarrow\frac{\sum_{i}e^{w_{i}}\bm{f}_{\text{g}%
}^{i}}{\sum_{i}e^{w_{i}}}
\bm{{\Sigma}}_{\text{g}}(\bm{w})\leftarrow\frac{1}{\sum_{i}e^{w_{i}}}\sum_{i}e%
^{w_{i}}\left(\bm{f}^{i}_{\text{g}}-\bm{{\mu}}_{\text{g}}(\bm{w})\right)^{T}%
\left(\bm{f}^{i}_{\text{g}}-\bm{{\mu}}_{\text{g}}(\bm{w})\right)
\bm{w}\leftarrow\bm{w}-\alpha\nabla_{\bm{w}}\text{FID}\left(\bm{{\mu}}_{\text{%
r}},\bm{{\Sigma}}_{\text{r}},\bm{{\mu}}_{\text{g}}(\bm{w}),\bm{{\Sigma}}_{%
\text{g}}(\bm{w})\right)
\bm{w}
\bm{F}_{\text{r}}
\bm{F}_{\text{g}}
\alpha
T
w_{i}
T
p_{i}=\frac{e^{w_{i}}}{\sum_{j}e^{w_{j}}}
p_{i}
i
\text{FID}^{\text{PL}}
\text{FID}^{\text{L}}
\text{FID}_{\text{CLIP}}^{\text{PL}}
\alpha=10.0
\alpha=5.0
\sim
\text{FID}=5.30
\text{Recall}=0.46
\text{FID}_{\text{CLIP}}=2.76
\text{FID}=4.70
\text{Recall}=0.45
\text{FID}_{\text{CLIP}}=2.74
\text{FID}=1.78
\text{Recall}=0.40
\text{FID}_{\text{CLIP}}=2.64
10\%
10\%
10\%
10\%
\text{FID}_{\text{CLIP}}
\gamma=\frac{1}{d}
d=2048
\gamma\in\left\{\frac{1}{8d},\frac{1}{4d},\frac{1}{2d},\frac{1}{d},\frac{2}{d}%
,\frac{4}{d},\frac{8}{d}\right\}
N
N
N
\text{KID}^{\text{PL}}
\text{RBF-KID}^{\text{PL}}
\text{KID}^{\text{PL}}
\text{RBF-KID}^{\text{PL}}
\text{FID}^{\text{PL}}
\times 10^{3}
\text{KID}^{\text{PL}}
\times 10^{3}
\times 10^{3}
\text{RBF-KID}^{\text{PL}}
\times 10^{3}
5.30
1.78
\left(-66.4\%\right)
1.52
0.19
\left(-87.5\%\right)
0.67
0.08
\left(-88.1\%\right)
8.25
3.05
\left(-63.0\%\right)
3.00
0.37
\left(-87.7\%\right)
1.32
0.16
\left(-87.9\%\right)
5.65
2.11
\left(-62.7\%\right)
2.49
0.32
\left(-87.1\%\right)
1.19
0.16
\left(-86.6\%\right)
12.96
3.59
\left(-72.3\%\right)
7.43
0.31
\left(-95.8\%\right)
3.04
0.14
\left(-95.4\%\right)
10.25
5.92
\left(-42.2\%\right)
2.05
0.12
\left(-94.1\%\right)
1.04
0.06
\left(-94.2\%\right)
\text{FID}_{\text{CLIP}}
\text{FID}_{\text{CLIP}}
\text{FID}=5.28
\text{Recall}=0.45
\text{FID}_{\text{CLIP}}=4.67
\text{FID}=5.30
\text{Recall}=0.46
\text{FID}_{\text{CLIP}}=2.76
