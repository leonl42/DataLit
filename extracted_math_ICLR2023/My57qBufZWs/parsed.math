l
f
{\bm{X}}=\{{\bm{x}}_{k:1\leq k\leq N_{d}}\in\mathbb{R}^{d_{0}}\}
{\bm{z}}^{i}\in\mathbb{R}^{d_{i}}
f=f_{1}\circ f_{2}\circ\cdots\circ f_{l}
f_{i}
{\bm{z}}^{i}=f_{i}({\bm{z}}^{i-1})=\sigma({\bm{W}}_{i}{\bm{z}}^{i-1}+{\bm{b}}_%
{i})
{\bm{W}}_{i}=[{\bm{w}}^{i}_{1},\cdots,{\bm{w}}^{i}_{d_{i}}]^{T}\in\mathbb{R}^{%
d_{i}\times d_{i-1}}
{\bm{b}}\in\mathbb{R}^{d_{i}}
\sigma
{\bm{z}}^{i-1}
{\bm{z}}^{i}
{\bm{b}}_{i}
{\bm{W}}_{i}
{\bm{w}}^{i}_{j}
{\bm{W}}_{i}
{\bm{w}}^{i}_{j}
{\bm{z}}\in{\mathbb{Z}}
\exists{\bm{z}}\in{\mathbb{Z}},\exists k>0,{\bm{w}}^{i}_{j}=k{\bm{z}},
{\mathbb{Z}}
{\bm{z}}^{i}
\hat{{\bm{z}}}_{i-1}=g({\bm{z}}^{i},f_{i})
g
{\bm{x}}
\epsilon
g
\exists\epsilon>0,\forall{\bm{z}}^{i-1},s.t.\|{\bm{z}}^{i-1}-g({\bm{z}}^{i},f_%
{i})\|_{2}=\|{\bm{z}}^{i-1}-g(f_{i}({\bm{z}}^{i-1}),f_{i})\|_{2}\leq\epsilon
{z}^{i}_{j}
{\bm{w}}^{i}_{j}
{\bm{w}}^{i}_{j}
\sigma
s^{i}_{j}={\bm{w}}^{i}_{j}\cdot{\bm{z}}^{i-1}=\lVert{\bm{w}}^{i}_{j}\rVert%
\lVert{\bm{z}}^{i-1}\rVert\cos\langle{\bm{w}}^{i}_{j},{\bm{z}}^{i-1}\rangle.
{\bm{w}}^{i}_{j}
{\bm{z}}^{i-1}
{\bm{w}}^{i}_{j}
{\bm{z}}^{i-1}
{\bm{w}}^{i}_{j}
\forall i,j,\lVert{\bm{w}}^{i}_{j}\rVert_{2}\leq C_{w},\text{where}~{}C_{w}~{}%
\text{is a constant}.
\|{\bm{z}}^{i-1}\|_{2}
C_{z}
s^{i}_{j}={\bm{w}}^{i}_{j}\cdot{\bm{z}}^{i-1}\leq C_{w}C_{z}.
s^{i}_{j}
k
{\bm{w}}^{i}_{j}=k{\bm{z}}^{i-1}
{\bm{w}}^{i}_{j}
\hat{{\bm{z}}}^{i-1}=g({\bm{s}}^{i},{\bm{W}}^{i})=\sum_{k=1}^{d_{i}}{\bm{w}}^{%
i}_{k}{s}^{i}_{k}={{\bm{W}}^{i}}^{T}{\bm{s}}^{i},
{\bm{s}}^{i}_{j}
{\bm{z}}^{i-1}
{\bm{w}}^{i}_{j}
\hat{{\bm{z}}}^{i-1}
g
\displaystyle\min_{{\bm{W}}}\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}\lVert{\bm{z%
}}-g({\bm{W}}{\bm{z}})\rVert=\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}\lVert{\bm{%
z}}-{\bm{W}}^{T}{\bm{s}}\rVert^{2}_{2}=\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}%
\lVert{\bm{z}}-{\bm{W}}^{T}{\bm{W}}{\bm{z}}\rVert^{2}_{2},
\displaystyle\min_{{\bm{W}}}\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}\lVert{\bm{z%
}}-g({\bm{W}}{\bm{z}})\rVert=\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}\lVert{\bm{%
z}}-{\bm{W}}^{T}{\bm{s}}\rVert^{2}_{2}=\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}%
\lVert{\bm{z}}-{\bm{W}}^{T}{\bm{W}}{\bm{z}}\rVert^{2}_{2},
p_{z}
{\bm{z}}
\nabla L=2\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({\bm{z}}{\bm{z}}^{T})({\bm{W}%
}^{T}{\bm{W}}-{\bm{I}})=0
\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({\bm{z}}{\bm{z}}^{T})
{\bm{W}}^{T}{\bm{W}}={\bm{I}},
{\bm{W}}
{\bm{W}}^{i}
{\bm{w}}^{i}_{j}
L_{t}
\displaystyle\min_{{\bm{W}}^{i},{\bm{b}}^{i}}L_{t}({\bm{X}};{\bm{W}}^{i},{\bm{%
b}}^{i},1\leq i\leq l)
\displaystyle\min_{{\bm{W}}^{i},{\bm{b}}^{i}}
\displaystyle L_{t}({\bm{X}};{\bm{W}}^{i},{\bm{b}}^{i},1\leq i\leq l)
\displaystyle s.t.~{}\left\{\begin{aligned} \lVert{\bm{w}}^{i}_{j}\rVert\leq C%
_{w},&~{}1\leq i\leq l,1\leq j\leq d_{i},\\
{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}={\bm{I}},&~{}1\leq i\leq l\end{aligned}\right..
\displaystyle s.t.
\displaystyle~{}\left\{\begin{aligned} \lVert{\bm{w}}^{i}_{j}\rVert\leq C_{w},%
&~{}1\leq i\leq l,1\leq j\leq d_{i},\\
{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}={\bm{I}},&~{}1\leq i\leq l\end{aligned}\right..
\displaystyle\min_{{\bm{W}}^{i},{\bm{b}}^{i}}L_{t}({\bm{X}};{\bm{W}}^{i},{\bm{%
b}}^{i},1\leq i\leq l)
\displaystyle\min_{{\bm{W}}^{i},{\bm{b}}^{i}}
\displaystyle L_{t}({\bm{X}};{\bm{W}}^{i},{\bm{b}}^{i},1\leq i\leq l)
\displaystyle s.t.{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}={\bm{I}},~{}1\leq i\leq l.
\displaystyle s.t.
\displaystyle{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}={\bm{I}},~{}1\leq i\leq l.
\displaystyle\min_{{\bm{W}}^{i},{\bm{b}}^{i}}L_{t}({\bm{X}};{\bm{W}}^{i},{\bm{%
b}}^{i},1\leq i\leq l)+\sum_{i=1}^{l}\lambda_{i}\lVert{{\bm{W}}^{i}}^{T}{\bm{W%
}}^{i}-{\bm{I}}\rVert^{2}_{F},
\displaystyle\min_{{\bm{W}}^{i},{\bm{b}}^{i}}
\displaystyle L_{t}({\bm{X}};{\bm{W}}^{i},{\bm{b}}^{i},1\leq i\leq l)+\sum_{i=%
1}^{l}\lambda_{i}\lVert{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}-{\bm{I}}\rVert^{2}_{F},
L_{r}
{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}
\displaystyle({\bm{W}}^{i})^{*}\leftarrow{\bm{W}}^{i}-\alpha(\nabla L_{t}+%
\nabla L_{r})={\bm{W}}^{i}-\alpha\nabla L_{t}-\alpha\lambda\left({\bm{W}}^{i}(%
{\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{W}}^{i}\right),
\displaystyle({\bm{W}}^{i})^{*}\leftarrow{\bm{W}}^{i}-\alpha(\nabla L_{t}+%
\nabla L_{r})={\bm{W}}^{i}-\alpha\nabla L_{t}-\alpha\lambda\left({\bm{W}}^{i}(%
{\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{W}}^{i}\right),
\alpha
\lambda
h({\bm{x}})={\bm{v}}^{T}{\bm{W}}{\bm{x}}
{\bm{v}}\in\mathbb{R}^{m}
{\bm{W}}\in\mathbb{R}^{m\times n}
{\bm{W}}
\lambda_{wd}
\lambda
0.01
40
256
0.1
0.01
0.05
0.001
0.005
300
1024
2048
0.002
\lambda
0.00002
0.00002
\lambda
0.0001
1024
300
0.0005
0.005
\lambda
0.05
{\bm{G}}={\bm{W}}^{T}{\bm{W}}
{\bm{W}}
1
0
0
\lVert{\bm{z}}^{i-1}-\hat{{\bm{z}}}^{i-1}\rVert/\lVert{\bm{z}}^{i-1}\rVert
5^{th}
8^{th}
K=64
K=64
K=64
K=64
5^{th}
2592
6\times 6
1
0
64
2592\times 6\times 6
{\bm{Z}}^{s}
{\bm{Z}}^{t}
{\bm{Z}}^{s}
{\bm{Z}}^{t}
{\bm{Z}}^{tr}
{\bm{Z}}^{tr}
{\bm{A}}={\bm{W}}^{T}{\bm{W}}
L=\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}\lVert{\bm{z}}-{\bm{A}}{\bm{z}}\rVert^%
{2}_{2}
L
{\bm{A}}
\displaystyle\mathop{}\!\mathrm{d}L=\mathop{}\!\mathrm{d}\mathbb{E}_{{\bm{z}}%
\sim p_{{\bm{z}}}}\operatorname{Tr}\left[({\bm{z}}-{\bm{A}}{\bm{z}})^{T}({\bm{%
z}}-{\bm{A}}{\bm{z}})\right]
\displaystyle\mathop{}\!\mathrm{d}L
\displaystyle=\mathop{}\!\mathrm{d}\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}%
\operatorname{Tr}\left[({\bm{z}}-{\bm{A}}{\bm{z}})^{T}({\bm{z}}-{\bm{A}}{\bm{z%
}})\right]
\displaystyle=\mathop{}\!\mathrm{d}\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}%
\operatorname{Tr}\left[{\bm{z}}{\bm{z}}^{T}({\bm{A}}^{2}-2{\bm{A}}+{\bm{I}})\right]
\displaystyle=\mathop{}\!\mathrm{d}\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}%
\operatorname{Tr}\left[{\bm{z}}{\bm{z}}^{T}({\bm{A}}^{2}-2{\bm{A}}+{\bm{I}})\right]
\displaystyle=\operatorname{Tr}\left[2\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({%
\bm{z}}{\bm{z}}^{T})({\bm{A}}-{\bm{I}})\mathop{}\!\mathrm{d}{\bm{A}}\right],
\displaystyle=\operatorname{Tr}\left[2\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({%
\bm{z}}{\bm{z}}^{T})({\bm{A}}-{\bm{I}})\mathop{}\!\mathrm{d}{\bm{A}}\right],
\displaystyle\nabla L=2\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({\bm{z}}{\bm{z}}%
^{T})({\bm{A}}-{\bm{I}}).
\displaystyle\nabla L
\displaystyle=2\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({\bm{z}}{\bm{z}}^{T})({%
\bm{A}}-{\bm{I}}).
L
\nabla L=2\mathbb{E}_{{\bm{z}}\sim p_{{\bm{z}}}}({\bm{z}}{\bm{z}}^{T})({\bm{W}%
}^{T}{\bm{W}}-{\bm{I}})=0
L_{r}=\sum_{i=1}^{l}\lambda_{i}\lVert{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}-{\bm{I}}%
\rVert^{2}_{F}
\lVert{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}-{\bm{I}}\rVert^{2}_{2}
{{\bm{W}}^{i}}^{T}{\bm{W}}^{i}
\lambda_{i}
L_{r}
{\bm{W}}^{i}
\displaystyle\mathop{}\!\mathrm{d}L_{r}=\lambda_{i}\mathop{}\!\mathrm{d}%
\operatorname{Tr}\left[(({\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{I}})^{T}(({\bm{W}}%
^{i})^{T}{\bm{W}}^{i}-{\bm{I}})\right]
\displaystyle\mathop{}\!\mathrm{d}L_{r}
\displaystyle=\lambda_{i}\mathop{}\!\mathrm{d}\operatorname{Tr}\left[(({\bm{W}%
}^{i})^{T}{\bm{W}}^{i}-{\bm{I}})^{T}(({\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{I}})\right]
\displaystyle=4\lambda_{i}\operatorname{Tr}\left[(({\bm{W}}^{i})^{T}{\bm{W}}^{%
i}({\bm{W}}^{i})^{T}-({\bm{W}}^{i})^{T})\mathop{}\!\mathrm{d}{\bm{W}}^{i}\right]
\displaystyle=4\lambda_{i}\operatorname{Tr}\left[(({\bm{W}}^{i})^{T}{\bm{W}}^{%
i}({\bm{W}}^{i})^{T}-({\bm{W}}^{i})^{T})\mathop{}\!\mathrm{d}{\bm{W}}^{i}\right]
\displaystyle\nabla L_{r}=4\lambda_{i}\left({\bm{W}}^{i}({\bm{W}}^{i})^{T}{\bm%
{W}}^{i}-{\bm{W}}^{i}\right).
\displaystyle\nabla L_{r}
\displaystyle=4\lambda_{i}\left({\bm{W}}^{i}({\bm{W}}^{i})^{T}{\bm{W}}^{i}-{%
\bm{W}}^{i}\right).
\lambda_{i}
\nabla L_{r}
4\lambda\left({\bm{W}}^{i}({\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{W}}^{i}\right)
\displaystyle({\bm{W}}^{i})^{*}\leftarrow{\bm{W}}^{i}-\alpha(\nabla L_{t}+%
\nabla L_{r})={\bm{W}}^{i}-\alpha\nabla L_{t}-\alpha\lambda\left({\bm{W}}^{i}(%
{\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{W}}^{i}\right),
\displaystyle({\bm{W}}^{i})^{*}\leftarrow{\bm{W}}^{i}-\alpha(\nabla L_{t}+%
\nabla L_{r})={\bm{W}}^{i}-\alpha\nabla L_{t}-\alpha\lambda\left({\bm{W}}^{i}(%
{\bm{W}}^{i})^{T}{\bm{W}}^{i}-{\bm{W}}^{i}\right),
\alpha
\lambda
\mathcal{H}_{u},\mathcal{H}_{c}
\mathcal{H}_{u}\supseteq\mathcal{H}_{c}
\mathcal{H}_{c}
\mathcal{H}_{u}\subseteq\mathcal{H}_{c}
({\bm{v}}_{0},{\bm{W}}_{0})\in\mathcal{H}_{u}
{\bm{x}}
{\bm{v}}_{0}^{T}{\bm{W}}_{0}{\bm{x}}
{\bm{W}}_{0}
\displaystyle\exists~{}{\bm{U}}\in\mathbb{R}^{m\times m},{\bm{V}}\in\mathbb{R}%
^{n\times n},{\bm{\Sigma}}\in\mathbb{R}^{m\times n}~{}s.t.~{}{\bm{U}}^{T}{\bm{%
U}}={\bm{I}},{\bm{V}}^{T}{\bm{V}}={\bm{I}},{\bm{W}}_{0}={\bm{U}}{\bm{\Sigma}}{%
\bm{V}}^{T}.
\displaystyle\exists~{}{\bm{U}}\in\mathbb{R}^{m\times m},{\bm{V}}\in\mathbb{R}%
^{n\times n},{\bm{\Sigma}}\in\mathbb{R}^{m\times n}~{}s.t.~{}{\bm{U}}^{T}{\bm{%
U}}={\bm{I}},{\bm{V}}^{T}{\bm{V}}={\bm{I}},{\bm{W}}_{0}={\bm{U}}{\bm{\Sigma}}{%
\bm{V}}^{T}.
{\bm{W}}_{1}={\bm{V}}^{T}
{\bm{v}}_{1}={\bm{\Sigma}}^{T}{\bm{U}}^{T}{\bm{v}}_{0}
{\bm{v}}_{0}^{T}{\bm{W}}_{0}{\bm{x}}={\bm{v}}_{1}^{T}{\bm{W}}_{1}{\bm{x}}
({\bm{v}}_{0},{\bm{W}}_{0})
({\bm{v}}_{1},{\bm{W}}_{1})
({\bm{v}}_{1},{\bm{W}}_{1};{{\bm{W}}_{1}}^{T}{\bm{W}}_{1}={\bm{I}})\in\mathcal%
{H}_{c}
\mathcal{H}_{u}\subseteq\mathcal{H}_{c}
\mathcal{H}_{u}=\mathcal{H}_{c}
{\bm{Z}}\in\mathbb{R}^{c\times h\times w}
{\bm{Z}}
g
k
B
\gamma
{\bm{A}}
{\mathbb{M}}=\emptyset
{\bm{y}}\in\mathbb{R}^{c}
{\bm{Z}}
k
vy
{\mathbb{I}}_{k}=\{i~{}|~{}{y}_{i}\in topk({\bm{y}})\}
i\in{\mathbb{I}}_{k}
{\bm{Z}}^{0}
{\bm{Z}}
i^{th}
{\bm{Z}}^{0}
{\bm{Z}}^{0}_{i}
{\bm{Z}}^{0}_{i}
{\bm{Z}}_{i}
B
{\bm{S}}^{i}
{\bm{S}}^{i}=g({\bm{Z}}^{0})
{\bm{M}}^{i}
{\bm{S}}^{i}
\gamma
{\mathbb{M}}\leftarrow{\mathbb{M}}\bigcup\{({\bm{M}}^{i},{y}_{i})\}
{\bm{A}}=\sum_{({\bm{M}}^{i},{y}_{i})\in{\mathbb{M}}}{y}_{i}{\bm{M}}^{i}
a_{i}
\displaystyle s_{i}=ReLU(a_{i})=\left\{\begin{aligned} &0,&~{}~{}if~{}a_{i}%
\leq 0\\
&a_{i},&~{}~{}if~{}a_{i}>0\\
\end{aligned}.\right.
\displaystyle s_{i}=ReLU(a_{i})=\left\{\begin{aligned} &0,&~{}~{}if~{}a_{i}%
\leq 0\\
&a_{i},&~{}~{}if~{}a_{i}>0\\
\end{aligned}.\right.
a_{i}>0
\hat{s}_{i}
\displaystyle\hat{a}_{i}=GuidedBP(\hat{s}_{i})=\left\{\begin{aligned} &\hat{s}%
_{i},&~{}~{}if~{}a_{i}>0~{}and~{}\hat{s}_{i}>0\\
&0,&~{}~{}otherwise\\
\end{aligned}.\right.
\displaystyle\hat{a}_{i}=GuidedBP(\hat{s}_{i})=\left\{\begin{aligned} &\hat{s}%
_{i},&~{}~{}if~{}a_{i}>0~{}and~{}\hat{s}_{i}>0\\
&0,&~{}~{}otherwise\\
\end{aligned}.\right.
{\bm{X}}
{\bm{Z}}=f({\bm{X}})\in\mathbb{R}^{c\times h\times w}
{\bm{y}}\in\mathbb{R}^{c}
{\bm{Z}}
{\mathbb{I}}
k
{\bm{y}}
i\in sI
{\bm{Z}}^{0}
{\bm{Z}}
{\bm{Z}}^{0}_{i}
{\bm{Z}}_{i}
B
{\bm{S}}^{i}=g({\bm{Z}}^{0})
k
{\mathbb{S}}=\{{\bm{S}}^{i}~{}|~{}i\in{\mathbb{I}}\}
{\bm{X}}
{\bm{Z}}^{t}=f({\bm{X}}^{t})
{\bm{Z}}^{s}=f({\bm{X}}^{s})
{\mathbb{I}}^{t}
k
{\bm{y}}^{t}
{\bm{Z}}^{tr}
i\in{\mathbb{I}}^{t}
{\bm{Z}}^{tr}_{i}
{\bm{Z}}^{s}_{i}
{y}_{i}B
{\bm{Z}}^{tr}
{\bm{Z}}^{t}
{\bm{Z}}^{s}
{\bm{X}}^{adv}=g({\bm{Z}}^{tr})
{\bm{X}}^{s}
{\bm{X}}^{t}
28\times 28
32\times 32
5\times 5
5\times 5
2\times 2
2\times 2
4\times 4
4\times 4
2\times 2
2\times 2
3\times 3
3\times 3
224\times 224
10\times 10
1\times 1
3\times 3
3\times 3
1\times 1
3\times 3
3\times 3
1\times 1
3\times 3
3\times 3
1\times 1
1\times 1
\lambda_{wd}
\lambda
\lambda_{wd}
\lambda_{Bort}
\lambda_{wd}
\lambda_{Bort}
\lambda_{wd}
\lambda_{Bort}
\lambda_{Bort}
\lambda_{wd}
