\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm{A^{2}Q}
<
\rm A^{2}Q
N
F
{\bm{X}}\in\mathbb{R}^{N\times F}
{\bm{x}}_{i}
i
\alpha_{i}\in\mathbb{R}_{+}
b_{i}\in\mathbb{R}_{+}
i
\displaystyle\bar{{\bm{x}}}_{i}=sign({\bm{x}}_{i})\begin{cases}\lfloor\frac{%
\left|{\bm{x}}_{i}\right|}{\alpha_{i}}+0.5\rfloor\text{,}&\left|{\bm{x}}\right%
|<\alpha_{i}(2^{[b_{i}]-1}-1)\\
\\
2^{[b_{i}]-1}-1\text{,}&\left|{\bm{x}}_{i}\right|\geq\alpha_{i}(2^{[b_{i}]-1}-%
1)\end{cases}\ \text{,}
\lfloor\cdot\rfloor
[\cdot]
{\bm{s}}_{X}=(\alpha_{1},\alpha_{2},...,\alpha_{N})
{\bm{b}}_{X}=(b_{1},b_{2},...,b_{N})
\bar{{\bm{X}}}
{\bm{X}}_{q}={\bm{S}}_{X}\cdot\bar{{\bm{X}}}
{\bm{S}}_{X}=diag(\alpha_{1},\alpha_{2},...,\alpha_{N})
[b]+1
\bar{x}
\bar{w}
\bar{x}
\bar{w}
x_{q}
x_{q}
{\bm{X}}{\bm{W}}
{\bm{W}}
{\bm{W}}
{\bm{W}}
{\bm{W}}
{\bm{s}}_{W}=(\beta_{1},\beta_{2},..,\beta_{F_{2}})
F_{2}
\beta_{i}
i
{\bm{W}}
{\bm{W}}
\bar{{\bm{W}}}
{\bm{W}}_{q}=\bar{{\bm{W}}}\cdot{\bm{S}}_{W}
{\bm{S}}_{W}=diag(\beta_{1},\beta_{2},...,\beta_{F_{2}})
{\bm{X}}\cdot{\bm{W}}\approx{\bm{X}}_{q}\cdot{\bm{W}}_{q}=({\bm{S}}_{X}\cdot%
\bar{{\bm{X}}})\cdot(\bar{{\bm{W}}}\cdot{\bm{S}}_{W})=(\bar{{\bm{X}}}\cdot\bar%
{{\bm{W}}})\odot({\bm{s}}_{X}\otimes{\bm{s}}_{W})\ \text{,}
\odot
\otimes
{\bm{s}}_{X}
{\bm{s}}_{W}
{\bm{A}}{\bm{X}}
{\bm{A}}
{\bm{A}}\in\{0,1\}^{N\times N}
{\bm{X}}
{\bm{W}}
(s,b)
\frac{\partial L}{\partial s}=\sum\limits_{i=1}^{d}{\frac{\partial L}{\partial
x%
_{q}^{i}}\cdot\frac{\partial x_{q}^{i}}{\partial s}}\ \text{,}
\frac{\partial L}{\partial b}=\sum\limits_{i=1}^{d}{\frac{\partial L}{\partial
x%
_{q}^{i}}\cdot\frac{\partial x_{q}^{i}}{\partial b}}\ \text{,}
d
{\bm{x}}
(s,b)
{\bm{x}}
x_{q}^{i}
i
{\bm{x}}_{q}
{{L}_{memory}}={{(\frac{1}{\eta}\cdot\sum\limits_{l=1}^{L}{\sum\limits_{i=1}^{%
N}{\dim^{l}\cdot b_{i}^{l}}}-{{M}_{target}})^{2}}}\ \text{,}
L
N
\dim^{l}
l
b_{i}^{l}
i
l
M_{target}
\eta=8*1024
\rm KB
L_{total}={{L}_{task}}+\lambda\cdot{L}_{memory}\ \text{,}
L_{task}
\lambda
L_{memory}
\frac{\partial{L_{task}}}{\partial s}
\frac{\partial{L_{task}}}{\partial b}
0.30\%
\frac{\partial{L_{task}}}{\partial{x_{q}}}
\frac{\partial{L_{task}}}{\partial{x_{q}}}
L_{task}
L_{task}
E=\frac{1}{d}\left|{{{\bm{x}}}_{q}}-{\bm{x}}\right|_{1}
{\bm{x}}
{\bm{x}}_{q}
|\cdot|_{1}
E
\frac{\partial E}{\partial s}=\frac{1}{d}\sum\limits_{i=1}^{d}{sign(x_{q}^{i}-%
{{x}^{i}})\cdot\frac{\partial x_{q}^{i}}{\partial s}}\ \text{,}
\frac{\partial E}{\partial b}=\frac{1}{d}\sum\limits_{i=1}^{d}{sign(x_{q}^{i}-%
{{x}^{i}})\cdot\frac{\partial x_{q}^{i}}{\partial b}}\ \text{.}
{\bm{W}}
(s,b)
s
b
{\bm{x}}_{q}
{\bm{x}}
{\bm{x}}
m
q_{max}=s(2^{[b]-1}-1)
i
f_{i}
{\bm{x}}_{i}
q_{max}
(s,b)
q_{max}
{\bm{X}}=({\bm{x}}_{1},{\bm{x}}_{2},...,{\bm{x}}_{N})^{T}
({\bm{s}},{\bm{b}}),{\bm{s}}\in\mathbb{R}_{+}^{m\times 1},{\bm{b}}\in\mathbb{R%
}_{+}^{m\times 1}
{\bm{q}}_{max}={\bm{s}}\odot(2^{{\bm{b}}-1}-1)
{{f}_{i}}=\underset{j}{\mathop{\max}}\,abs({\bm{x}}_{i}^{(j)})
inde{{x}_{i}}=\arg\underset{k}{\mathop{\min}}\,|{{f}_{i}}-q_{\max}^{k}|
i
(s_{index_{i}},b_{index_{i}})
{\bm{X}}_{q}
(s_{j},b_{j})
({\bm{s}},{\bm{b}})
q_{max}
q_{max}
m=1000
{\bm{W}}
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\leq 4
\rm A^{2}Q
\rm A^{2}Q
({\bm{s}},{\bm{b}})
{\bm{s}}
{\bm{b}}
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
{\bm{x}}
{\bm{x}}_{q}
s
s\in\mathbb{R_{+}}
b
b\in\mathbb{N_{+}}
\displaystyle\bar{{\bm{x}}}=sign({\bm{x}})\begin{cases}\lfloor\frac{\left|{\bm%
{x}}\right|}{s}+0.5\rfloor\text{,}&\left|{\bm{x}}\right|<s(2^{b-1}-1)\\
\\
2^{b-1}-1\text{,}&\left|{\bm{x}}\right|\geq s(2^{b-1}-1)\end{cases}\ \text{.}
{\bm{x}}
\{-2^{b-1}+1,...,0,...,2^{b-1}-1\}
\#b
{\bm{x}}_{q}=s\cdot\bar{{\bm{x}}}
\bar{{\bm{x}}}
s
{\bm{x}}\in\mathbb{R}^{3\times 1}
{\bm{y}}\in\mathbb{R}^{3\times 1}
s=0.1
b=5
\#b
[-s(2^{b}-1),s(2^{b}-1)]
x_{q}
x
\frac{\partial L}{\partial x}=\frac{\partial L}{\partial x_{q}}\mathbb{I}_{|x|%
\leq s(2^{b}-1)}
\mathbb{I}_{|x|\leq s(2^{b}-1)}
1
|x|\leq s(2^{b}-1)
(s,b)
x_{q}
(s,b)
\displaystyle\begin{bmatrix}\frac{\partial x_{q}}{\partial s}\\
\\
\frac{\partial x_{q}}{\partial b}\end{bmatrix}=\begin{cases}\begin{bmatrix}%
\frac{1}{s}\left(x_{q}-{{x}}\right)\\
0\end{bmatrix}\text{,}&\left|{\bm{x}}\right|<s(2^{b-1}-1)\\
sign(x)\begin{bmatrix}\left({{2}^{b-1}}-1\right)\\
{{2}^{b-1}}\ln\left(2\right)s\end{bmatrix}\text{,}&\left|{\bm{x}}\right|\geq s%
(2^{b-1}-1)\end{cases}\ \text{.}
d_{i}
i
\varepsilon
\alpha
d_{i}
i
\varepsilon
\alpha
{\bm{h}}_{i}^{(l)}=\sum\limits_{j\in\mathcal{N}(i)\cup\{i\}}{\frac{1}{\sqrt{{{%
d}_{i}}}\sqrt{{{d}_{j}}}}{\bm{x}}_{j}^{\left(l-1\right)}}
{\bm{x}}_{i}^{\left(l\right)}=ReLU({{{\bm{W}}}^{\left(l\right)}}{\bm{h}}_{i}^{%
\left(l\right)}+{{{\bm{b}}}^{\left(l\right)}})
{\bm{h}}_{i}^{(l)}=(1+{{\varepsilon}^{\left(l\right)}}){\bm{x}}_{i}^{\left(l-1%
\right)}+\sum\limits_{j\in\mathcal{N}\left(i\right)}{{\bm{x}}_{j}^{\left(l-1%
\right)}}
{\bm{x}}_{i}^{\left(l\right)}=ML{{P}^{(l)}}({\bm{h}}_{i}^{\left(l\right)},{{{%
\bm{W}}}^{\left(l\right)}},{{{\bm{b}}}^{\left(l\right)}})
{\bm{h}}_{i}^{(l)}=\sum\limits_{j\in\mathcal{N}\left(i\right)\cup\left\{i%
\right\}}{\alpha_{i,j}^{\left(l\right)}}{\bm{x}}_{j}^{\left(l-1\right)}
{\bm{x}}_{i}^{\left(l\right)}={{{\bm{W}}}^{\left(l\right)}}{\bm{h}}_{i}^{l}+{{%
{\bm{b}}}^{\left(l\right)}}
{\mathcal{G}}=(\mathcal{V},\mathcal{E})
\mathcal{V}=\{1,...,N\}
\mathcal{E}\subseteq\mathcal{V}\times\mathcal{V}
{\bm{X}}\in\mathbb{R}^{N\times F}
{\bm{E}}\in\mathbb{R}^{E\times H}
{\bm{x}}_{i}^{(l)}={{\gamma}^{(l)}}({\bm{x}}_{i}^{(l-1)},\underset{j\in%
\mathcal{N}(i)}{\mathop{\square}}\,{{\phi}^{(l)}}({\bm{x}}_{i}^{(l-1)},{\bm{x}%
}_{j}^{(l-1)},{\bm{e}}_{ij}^{(l-1)}))
{\phi}
\mathop{\square}
\gamma
{\bm{x}}_{i}
i
{\bm{e}}_{ij}
i
j
\mathcal{N}(i)=\{j:(i,j)\in\mathcal{E}\}
l
l
A=\{0,1\}^{N\times N}
i
j
a_{ij}=1
a_{ij}=0
\tilde{A}=A+I
D=diag({d_{1},d_{2},...,d_{n}})
{{d}_{i}}=\sum\nolimits_{j}{{{a}_{ij}}}
\tilde{D}=({\tilde{d}_{1},\tilde{d}_{2},...,\tilde{d}_{n}})
\tilde{d}_{i}=\sum\nolimits_{j}{{{\tilde{a}}_{ij}}}
\displaystyle{{{\bm{X}}}^{(l+1)}}=\sigma(\hat{{\bm{A}}}{{{\bm{X}}}^{(l)}}{\bm{%
W}}^{(l)})\text{,}
\hat{{\bm{A}}}=\tilde{{\bm{D}}}^{-\frac{1}{2}}\tilde{{\bm{A}}}\tilde{{\bm{D}}}%
^{-\frac{1}{2}}
{\bm{W}}^{(l)}\in\mathbb{R}^{F_{in}\times F_{out}}
l
{\bm{X}}^{(l)}
l
(l-1)
\sigma
\hat{{\bm{A}}}
nll\_loss
L
T
{\bm{H}}^{(l+1)}=softmax({\bm{X}}^{(l+1)})
L
{\bm{X}}^{(l+1)}
\displaystyle{\bm{G}}^{1}={{\nabla}_{{{{\bm{X}}}^{(l+1)}}}}L=\frac{\partial L}%
{\partial{\bm{H}}^{(l+1)}}\cdot\frac{\partial{\bm{H}}^{(l+1)}}{\partial{\bm{X}%
}^{(l+1)}}=[{{l}_{ij}}]\in{{\mathbb{R}}^{N\times{{F}_{out}}}}\text{,}
{\bm{G}}_{i,:}^{1},\ i\in T
{\bm{G}}_{i,:}^{1}=0
{\bm{X}}^{(l)}
\displaystyle{\bm{G}}^{2}={{\nabla}_{{{{\bm{X}}}^{(l)}}}}L={\hat{{\bm{A}}}^{T}%
}({{{\nabla}_{{{{\bm{X}}}^{(l+1)}}}}L}\odot{{\sigma}^{\prime}(\hat{{\bm{A}}}{{%
{\bm{X}}}^{(l)}}{\bm{W}}^{(l)})}){({\bm{W}}^{(l)})^{T}}\text{.}
j
i
i\in T
{\bm{G}}_{j,:}^{2}=0
{\bm{A}}
\hat{{\bm{A}}}
{\bm{X}}{\bm{W}}\rightarrow{\bm{A}}({\bm{X}}{\bm{W}})
{\bm{B}}={\bm{X}}{\bm{W}}
{\bm{A}}{\bm{B}}
l
{\bm{B}}_{l}={\bm{X}}_{l}{\bm{W}}_{l}
X_{l+1}=\hat{{\bm{A}}}{\bm{B}}_{l}
{\bm{X}}_{l}\in\mathbb{R}^{N\times F_{1}}
{\bm{W}}_{l}\in\mathbb{R}^{F_{1}\times F_{2}}
{\bm{A}}\in\mathbb{R}^{N\times N}
{\bm{B}}_{l}
{\bm{X}}_{l}
{\bm{W}}_{l}
{\bm{S}}_{B_{l}}
{\bm{S}}_{X_{l}}
{\bm{S}}_{W_{l}}
{\bm{B}}_{l}={\bm{B}}_{l\_q}{\bm{S}}_{B_{l}}
{\bm{X}}_{l}={\bm{S}}_{X_{l}}{\bm{X}}_{l\_q}
{\bm{W}}_{l}={\bm{W}}_{l\_q}{\bm{S}}_{W_{l}}
{\bm{S}}_{B_{l}}
{\bm{S}}_{X_{l}}
{\bm{S}}_{W_{l}}
\begin{split}{\bm{B}}_{l}&={\bm{X}}_{l}\cdot{\bm{W}}_{l}\\
&=({\bm{S}}_{X_{l}}\cdot{{\bm{X}}_{l\_q}})\cdot({\bm{W}}_{l\_q}\cdot{\bm{S}}_{%
W_{l}})\end{split}\ \text{,}
{\bm{B}}_{l}={\bm{B}}_{l\_q}{\bm{S}}_{B_{l}}
\begin{split}{\bm{B}}_{l\_q}&={\bm{B}}_{l}{\bm{S}}^{-1}_{B_{l}}\\
&=({\bm{S}}_{X_{l}}\cdot{{\bm{X}}_{l\_q}})\cdot({\bm{W}}_{l\_q}\cdot{\bm{S}}_{%
W_{l}}){\bm{S}}^{-1}_{B_{l}}\\
&=({\bm{S}}_{X_{l}}\cdot{{\bm{X}}_{l\_q}})\cdot({\bm{W}}_{l\_q}\cdot({\bm{S}}_%
{W_{l}}{\bm{S}}^{-1}_{B_{l}}))\\
&=({\bm{S}}_{X_{l}}\otimes({\bm{S}}_{W_{l}}{\bm{S}}^{-1}_{B_{l}}))\odot({{\bm{%
X}}_{l\_q}}\cdot{{\bm{W}}_{l\_q}})\end{split}\ \text{,}
({\bm{S}}_{X_{l}}\otimes({\bm{S}}_{W_{l}}{\bm{S}}^{-1}_{B_{l}}))
B_{l\_q}
{\bm{X}}_{l+1}=\sigma(\hat{{\bm{A}}}{\bm{B}}_{l})
\hat{{\bm{A}}}={\bm{D}}^{-\frac{1}{2}}\tilde{{\bm{A}}}{\bm{D}}^{-\frac{1}{2}}
\sigma
{\bm{D}}^{-\frac{1}{2}}
\tilde{{\bm{A}}}
{\bm{S}}_{X_{l}}
{\bm{B}}_{l\_q}
(l+1)
{\bm{X}}_{l+1}
{\bm{X}}_{l+1}=\sigma({\bm{D}}^{-\frac{1}{2}}\tilde{{\bm{A}}}{\bm{B}}_{l\_q})
{\bm{X}}_{l+1}={\bm{S}}_{X_{l+1}}{\bm{X}}_{(l+1)\_q}
{\bm{X}}_{(l+1)\_q}
\begin{split}{\bm{X}}_{(l+1)\_q}&={\bm{S}}_{X_{l+1}}^{-1}{\bm{X}}_{l+1}\\
&={\bm{S}}_{X_{l+1}}^{-1}\sigma({\bm{D}}^{-\frac{1}{2}}\tilde{{\bm{A}}}{\bm{B}%
}_{l\_q})\end{split}\ \text{.}
{\bm{S}}_{X_{l+1}}
{\bm{X}}_{(l+1)\_q}=\sigma({\bm{S}}_{X_{l+1}}^{-1}{\bm{D}}^{-\frac{1}{2}}%
\tilde{{\bm{A}}}{\bm{B}}_{l\_q})
{\bm{S}}_{X_{l+1}}^{-1}{\bm{D}}^{-\frac{1}{2}}
\tilde{{\bm{A}}}\in\{0,1\}^{N\times N}
\tilde{{\bm{A}}}{\bm{B}}_{l\_q}
{\bm{S}}_{X_{l+1}}^{-1}{\bm{D}}^{-\frac{1}{2}}
{\bm{D}}^{-\frac{1}{2}}
{\bm{D}}^{-\frac{1}{2}}
\begin{split}{\bm{X}}_{l+1}&=BN(\sigma(\hat{{\bm{A}}}{\bm{B}}_{l\_q}))\\
&=\sigma(\hat{{\bm{A}}}{\bm{B}}_{l\_q}){\bm{Y}}+{\bm{Z}}\end{split}\ \text{,}
{\bm{Y}}=diag(y_{1},y_{2},...,y_{F_{2}})\in\mathbb{R}^{F_{2}\times F_{2}}
{\bm{Z}}=({\bm{z}}_{1},{\bm{z}}_{2},...,{\bm{z}}_{F_{2}})\in\mathbb{R}^{N%
\times F_{2}}
{\bm{z}}_{i}=(\theta_{i},\theta_{i},...,\theta_{i})^{T}\in\mathbb{R}^{N}
y_{i}
\theta_{i}
{\bm{X}}_{l+1}={\bm{S}}_{X_{l+1}}{\bm{X}}_{l+1\_q}
\begin{split}{\bm{X}}_{l+1\_q}&={\bm{S}}_{X_{l+1}}^{-1}{\bm{X}}_{l+1}\\
&={\bm{S}}_{X_{l+1}}^{-1}(\sigma(\hat{{\bm{A}}}{\bm{B}}_{l\_q}){\bm{Y}}+{\bm{Z%
}})\\
&=({\bm{S}}_{X_{l+1}}^{-1}\otimes{\bm{Y}})\odot(\sigma(\hat{{\bm{A}}}{\bm{B}}_%
{l\_q}))+{\bm{S}}_{X_{l+1}}^{-1}{\bm{Z}}\end{split}\ \text{.}
\rm logP
\sim
\sim
\sim
\sim
\sim
\sim
\sim
\sim
(s,b)
b
s
s
s\in\mathcal{N}(0.01,0.01)
s\in\mathcal{U}(0,1)
\mathcal{N}
\mathcal{U}
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\rm A^{2}Q
\#m
(s,b)
m
m
m
m
m
m
m
m
m
2^{n}
2^{n}\times a
a
n
256\times 16
{\bm{B}}^{l}={\bm{X}}^{l}{\bm{W}}^{l}
{\bm{X}}^{l}
{\bm{W}}^{l}
{\bm{W}}^{l}
{\bm{X}}^{l+1}={\bm{A}}{\bm{B}}^{l}
{\bm{A}}
{\bm{A}}
{\bm{A}}
{\bm{A}}
{\bm{B}}^{l}
\rm A^{2}Q
{\bm{X}}\in\mathbb{R}^{N\times F_{0}}
F_{1}
N\times F_{1}
b_{m}
b_{m}[NF_{0}+(L-1)NF_{1}]
32NL
M=b_{m}[NF_{0}+(L-1)NF_{1}]+32NL\text{.}
r=\frac{32NL}{b_{m}[NF_{0}+(L-1)NF_{1}]}\text{.}
F_{0}
m=1000
{\bm{H}}^{l}=\hat{{\bm{A}}}{\bm{X}}^{l}
{\bm{X}}^{l+1}={\bm{H}}^{l}{\bm{W}}^{l}
\hat{{\bm{A}}}\in\mathbb{R}^{N\times N}
{\bm{X}}^{l}\in\mathbb{R}^{N\times F_{1}}
{\bm{W}}^{l}\in\mathbb{R}^{F_{1}\times F_{2}}
\mathcal{O}(N^{2}F_{1}+NF_{1}F_{2})
C=\mathcal{O}_{I}(N^{2}F_{1}+NF_{1}F_{2})+\mathcal{O}_{E}(NF_{2})\text{,}
\mathcal{O}_{I}
\mathcal{O}_{E}
N\times F_{2}
