5
5
\alpha
\alpha
\alpha
\alpha
(\mathcal{X},d_{\infty})
\mathcal{X}
d_{\infty}({x},\tilde{{x}})=\|{x}-\tilde{{x}}\|_{\infty}
\mathcal{B}_{\epsilon}[{x}]=\{\tilde{{x}}\in\mathcal{X}\mid d_{\infty}({x},%
\tilde{{x}})\leq\epsilon\}
\epsilon>0
{x}
\mathcal{X}
S=\{({x}_{n},y_{n})\}^{N}_{n=1}
{x}_{n}\in\mathcal{X}
y_{n}\in\mathcal{Y}=\{0,1,...,C-1\}
\min_{f_{\theta}\in\mathcal{F}}\frac{1}{N}\sum_{n=1}^{N}\max_{\tilde{{x}}_{n}%
\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(f_{\theta}(\tilde{{x}}_{n}),y_{n})
\mathcal{F}
\tilde{{x}}_{n}
\epsilon
{x_{n}}
f_{\theta}(\cdot):\mathcal{X}\to\mathbb{R}^{C}
\ell:\mathbb{R}^{C}\times\mathcal{Y}\to\mathbb{R}
\ell_{\textrm{B}}:\Delta^{C-1}\times\mathcal{Y}\to\mathbb{R}
\ell_{\textrm{L}}:\mathbb{R}^{C}\to\Delta^{C-1}
\Delta^{C-1}
\ell(f_{\theta}(\cdot),y)=\ell_{\textrm{B}}(\ell_{\textrm{L}}(f_{\theta}(\cdot%
)),y)
{x}^{(0)}\in\mathcal{X}
\alpha>0
{x}^{(t+1)}=\Pi_{\mathcal{B}_{\epsilon}[{x}^{(0)}]}\big{(}{x}^{(t)}+\alpha%
\text{sign}(\nabla_{{x}^{(t)}}\ell(f_{\theta}({x}^{(t)}),y))\big{)}
t\in\mathbb{N}
{x}^{(t)}
t
\text{sign}(\cdot)
\Pi_{\mathcal{B}_{\epsilon}[{x}^{(0)}]}(\cdot)
\epsilon
{x}^{(0)}
\mathcal{D}_{k}
k
\{\mathcal{D}_{k}\}_{k=1}^{K}
K
\theta_{k}
\theta^{t}
t
\{\theta^{t}_{k}\}_{k=1}^{K}
\theta^{t+1}=\frac{1}{N}\sum^{K}_{k=1}{N_{k}\theta^{t}_{k}}
N_{k}
\mathcal{D}_{k}
N=\sum_{k=1}^{K}N_{k}
\theta^{t+1}
\alpha
\alpha
\alpha
\alpha
\alpha
K
K
\alpha
\displaystyle\vspace{-4mm}\footnotesize\begin{split}\mathcal{L}_{AT}&=\frac{1}%
{N}\sum_{n=1}^{N}\max_{\tilde{{x}}_{n}\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(%
f_{\theta}(\tilde{{x}}_{n}),y_{n})=\sum_{k=1}^{K}\frac{N_{k}}{N}\underbrace{%
\left(\frac{1}{N_{k}}\sum_{n=1}^{N_{k}}\max_{\tilde{{x}}_{n}\in\mathcal{B}_{%
\epsilon}[{x}_{n}]}\ell(f_{\theta}(\tilde{{x}}_{n}^{k}),y_{n}^{k})\right)}_{%
\mathcal{L}_{k}}\\
&\geq(1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(%
k)}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi%
(k)}~{}\quad\\
&\doteq\mathcal{L}^{\alpha}(\widehat{K}),~{}\quad~{}\quad\text{s.t.}~{}\alpha%
\in\left[0,~{}1\right.),~{}\widehat{K}\leq\frac{K}{2},\end{split}\vspace{-6mm}
\displaystyle\vspace{-4mm}\footnotesize\begin{split}\mathcal{L}_{AT}&=\frac{1}%
{N}\sum_{n=1}^{N}\max_{\tilde{{x}}_{n}\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(%
f_{\theta}(\tilde{{x}}_{n}),y_{n})=\sum_{k=1}^{K}\frac{N_{k}}{N}\underbrace{%
\left(\frac{1}{N_{k}}\sum_{n=1}^{N_{k}}\max_{\tilde{{x}}_{n}\in\mathcal{B}_{%
\epsilon}[{x}_{n}]}\ell(f_{\theta}(\tilde{{x}}_{n}^{k}),y_{n}^{k})\right)}_{%
\mathcal{L}_{k}}\\
&\geq(1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(%
k)}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi%
(k)}~{}\quad\\
&\doteq\mathcal{L}^{\alpha}(\widehat{K}),~{}\quad~{}\quad\text{s.t.}~{}\alpha%
\in\left[0,~{}1\right.),~{}\widehat{K}\leq\frac{K}{2},\end{split}\vspace{-6mm}
\phi(\cdot)
\{\frac{N_{k}}{N}\mathcal{L}_{k}\}
\phi(\cdot)
\alpha
\mathcal{L}^{\alpha}(\widehat{K})
\alpha
\widehat{K}
\mathcal{L}^{\alpha_{1}}(\widehat{K})<\mathcal{L}^{\alpha_{2}}(\widehat{K})
\alpha_{1}>\alpha_{2}
\mathcal{L}^{\alpha}(\widehat{K}_{1})<\mathcal{L}^{\alpha}(\widehat{K}_{2})
\widehat{K}_{1}>\widehat{K}_{2}
\mathcal{L}^{\alpha}(\widehat{K})
\mathcal{L}
\alpha
\mathcal{L}^{\alpha}(\widehat{K})
\mathcal{L}
\widehat{K}
\alpha
\widehat{K}
\alpha
\ell(\cdot,\cdot)
\theta
x
\lambda
x
\mathbb{E}\left[||\nabla_{\theta}\mathcal{L}^{\alpha}(\widehat{K})-\nabla_{%
\theta}\ell(f_{\theta}(\tilde{{x}}),y)||^{2}_{2}\right]\leq\delta^{2}
\tilde{x}
T
T\geq\frac{L\Delta}{\delta^{2}}
\alpha
\sqrt{\frac{\Delta}{LT\sigma^{2}}}
\displaystyle\begin{split}\frac{1}{T}&\sum_{t=1}^{T}\mathbb{E}\left[\bigg{|}%
\bigg{|}\nabla\mathcal{L}^{\alpha}(\widehat{K})\big{|}_{\theta^{t}}\bigg{|}%
\bigg{|}^{2}_{2}\right]\leq\left(1+\alpha\frac{\frac{1}{T}\sum_{t=1}^{T}\xi^{(%
t)}}{N}\right)\left(\frac{4L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{%
\frac{L\Delta}{T}}\right),\end{split}
\displaystyle\begin{split}\frac{1}{T}&\sum_{t=1}^{T}\mathbb{E}\left[\bigg{|}%
\bigg{|}\nabla\mathcal{L}^{\alpha}(\widehat{K})\big{|}_{\theta^{t}}\bigg{|}%
\bigg{|}^{2}_{2}\right]\leq\left(1+\alpha\frac{\frac{1}{T}\sum_{t=1}^{T}\xi^{(%
t)}}{N}\right)\left(\frac{4L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{%
\frac{L\Delta}{T}}\right),\end{split}
L=L_{\theta\theta}+\frac{L_{\theta x}L_{x\theta}}{\lambda}
\Delta\geq\mathcal{L}^{\alpha}(\widehat{K})|_{\theta^{0}}-\inf_{\theta}%
\mathcal{L}^{\alpha}(\widehat{K})
\xi^{(t)}=\sum_{k=1}^{\widehat{K}}N_{\phi(k)}^{(t)}-\sum_{\widehat{K}+1}^{K}N_%
{\phi(k)}^{(t)}
t
\alpha=0
\alpha\rightarrow 1
\frac{1}{T}\sum_{t=1}^{T}\xi^{(t)}<0
\left(1+\alpha\frac{\frac{1}{T}\sum_{t=1}^{T}\xi^{(t)}}{N}\right)<1
-N<\xi^{(t)}=N_{\phi(1)}^{(t)}-\sum_{k=2}^{K}N_{\phi(k)}^{(t)}<0
\alpha
\alpha
\alpha
\alpha
\displaystyle\vspace{2mm}\begin{split}\min\mathcal{L}_{\text{SFAT}}=\min_{f_{%
\theta}\in\mathcal{F}}\frac{1}{\sum_{k}^{K}N_{k}}\sum_{k=1}^{K}P_{k}N_{k}\cdot%
\underbrace{\left(\frac{1}{N_{k}}\sum_{n=1}^{N_{k}}\max_{\tilde{{x}}_{n}^{k}%
\in\mathcal{B}_{\epsilon}[{x}_{n}^{k}]}\ell(f_{\theta}(\tilde{{x}}^{k}_{n}),y^%
{k}_{n})\right)}_{\mathcal{L}_{k}},\end{split}
\displaystyle\vspace{2mm}\begin{split}\min\mathcal{L}_{\text{SFAT}}=\min_{f_{%
\theta}\in\mathcal{F}}\frac{1}{\sum_{k}^{K}N_{k}}\sum_{k=1}^{K}P_{k}N_{k}\cdot%
\underbrace{\left(\frac{1}{N_{k}}\sum_{n=1}^{N_{k}}\max_{\tilde{{x}}_{n}^{k}%
\in\mathcal{B}_{\epsilon}[{x}_{n}^{k}]}\ell(f_{\theta}(\tilde{{x}}^{k}_{n}),y^%
{k}_{n})\right)}_{\mathcal{L}_{k}},\end{split}
P_{k}
k
\widehat{K}
(1+\alpha)\cdot\mathds{1}(\frac{N_{k}}{N}\mathcal{L}_{k}\leq\mathcal{L}_{\text%
{sorted}}[\widehat{K}])+(1-\alpha)\cdot\mathds{1}(\frac{N_{k}}{N}\mathcal{L}_{%
k}>\mathcal{L}_{\text{sorted}}[\widehat{K}])
P_{k}=((1+\alpha)/(1-\alpha)\cdot\mathds{1}(\frac{N_{k}}{N}\mathcal{L}_{k}\leq%
\mathcal{L}_{\text{sorted}}[\widehat{K}])+1\cdot\mathds{1}(\frac{N_{k}}{N}%
\mathcal{L}_{k}>\mathcal{L}_{\text{sorted}}[\widehat{K}]))/((\sum_{k=1}^{K}P_{%
k})+2\alpha/(1-\alpha))
\{\theta_{k}\}_{k=1}^{K}
\{\mathcal{L}_{k}\}_{k=1}^{K}
\{\frac{N_{k}}{N}\mathcal{L}_{k}\}_{k=1}^{K}
\widehat{K}
\alpha
\widehat{K}
(1+\alpha)/(1-\alpha)
||\theta_{k}-\theta_{s}||_{2}
\ell(\cdot,\cdot)
L
\lambda
\theta
\mathbb{E}\left[||\nabla_{\theta}\ell(f_{\theta}(\tilde{{x}}^{k}),y^{k})||^{2}%
_{2}\right]\leq\varsigma^{2}
\mathbb{E}\left[||\nabla_{\theta}\ell(f_{\theta}(\tilde{{x}}^{k}),y^{k})-%
\nabla_{\theta}\mathcal{L}_{k}||^{2}_{2}\right]\leq\delta^{2}_{k}
\kappa=\frac{L}{\lambda}
\gamma=\max\{8\kappa,E\}
E
\eta_{t}=\frac{2}{\lambda(\gamma+t)}
T
\displaystyle\vspace{-3mm}\begin{split}\mathbb{E}[\mathcal{L}&{}_{\text{SFAT}}%
]-\mathcal{L}^{*}\leq\frac{\kappa}{\gamma+T-1}\left(\frac{2B}{\lambda}+\frac{%
\lambda\gamma}{2}\mathbb{E}\left[||\theta^{0}-\theta^{*}||^{2}\right]\right),%
\end{split}
\displaystyle\vspace{-3mm}\begin{split}\mathbb{E}[\mathcal{L}&{}_{\text{SFAT}}%
]-\mathcal{L}^{*}\leq\frac{\kappa}{\gamma+T-1}\left(\frac{2B}{\lambda}+\frac{%
\lambda\gamma}{2}\mathbb{E}\left[||\theta^{0}-\theta^{*}||^{2}\right]\right),%
\end{split}
\mathcal{L}^{*}
\mathcal{L}_{\text{SFAT}}
\theta^{*}
\displaystyle\begin{split}B=&\sum_{k=1}^{K}\left(\frac{P_{k}^{(T)}}{1+\alpha%
\frac{\xi^{(T)}}{N}}\right)^{2}\left(\frac{N_{k}}{N}\delta_{k}\right)^{2}+6L%
\left(\mathcal{L}^{*}-\sum_{k}^{K}\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}}{%
N}}\frac{N_{k}}{N}\mathcal{L}_{k}^{*}\right)+8(E-1)^{2}\varsigma^{2}.\end{split}
\displaystyle\begin{split}B=&\sum_{k=1}^{K}\left(\frac{P_{k}^{(T)}}{1+\alpha%
\frac{\xi^{(T)}}{N}}\right)^{2}\left(\frac{N_{k}}{N}\delta_{k}\right)^{2}+6L%
\left(\mathcal{L}^{*}-\sum_{k}^{K}\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}}{%
N}}\frac{N_{k}}{N}\mathcal{L}_{k}^{*}\right)+8(E-1)^{2}\varsigma^{2}.\end{split}
\alpha=0
P_{k}^{(T)}/(1+\alpha\frac{\xi^{(T)}}{N})=1
\alpha\rightarrow 1
B
\left(P_{k}^{(T)}/(1+\alpha\frac{\xi^{(T)}}{N})\right)^{2}
P_{k}^{(T)}/(1+\alpha\frac{\xi^{(T)}}{N})
\delta_{k}^{2}
\mathcal{L}^{*}_{k}
\theta^{*}
\delta_{k}^{2}
\mathcal{L}^{*}_{k}
B
B
B
s
K
\mathcal{Y}
\mathcal{Y}_{k}
K
K
(100-(K-1)\times s)\%
\mathcal{Y}_{k}
s\%
\alpha
\widehat{K}=1
\alpha
\alpha
\alpha
\alpha=1/11
\alpha
\widehat{K}
\alpha
\alpha=1/11
\alpha
\widehat{K}
\alpha
\widehat{K}
\alpha
K=5
\widehat{K}=1
\alpha\in(0,1/6]
\alpha
\alpha
\widehat{K}
K=8
\widehat{K}
\widehat{K}<=K/2
\widehat{K}
\widehat{K}
\widehat{K}
\alpha=1/11
\frac{1+\alpha}{1-\alpha}=1.2
\widehat{K}=K/5
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\sim
\sim
\alpha
\alpha
\alpha
\alpha
\alpha
K
\displaystyle\begin{split}\mathcal{L}_{AT}&=\frac{1}{N}\sum_{n=1}^{N}\max_{%
\tilde{{x}}_{n}\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(f(\tilde{{x}}_{n}),y_{n%
})=\sum_{k=1}^{K}\frac{N_{k}}{N}\underbrace{\left(\frac{1}{N_{k}}\sum_{n=1}^{N%
_{k}}\max_{\tilde{{x}}_{n}\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(f(\tilde{{x}%
}_{n}^{k}),y_{n}^{k})\right)}_{\mathcal{L}_{k}}\\
&\geq(1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(%
k)}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi%
(k)}~{}\quad\text{s.t.}~{}\alpha\in\left[0,~{}1\right.),~{}\widehat{K}\leq%
\frac{K}{2}\\
&\doteq\mathcal{L}^{\alpha}(\widehat{K}),\end{split}
\displaystyle\begin{split}\mathcal{L}_{AT}&=\frac{1}{N}\sum_{n=1}^{N}\max_{%
\tilde{{x}}_{n}\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(f(\tilde{{x}}_{n}),y_{n%
})=\sum_{k=1}^{K}\frac{N_{k}}{N}\underbrace{\left(\frac{1}{N_{k}}\sum_{n=1}^{N%
_{k}}\max_{\tilde{{x}}_{n}\in\mathcal{B}_{\epsilon}[{x}_{n}]}\ell(f(\tilde{{x}%
}_{n}^{k}),y_{n}^{k})\right)}_{\mathcal{L}_{k}}\\
&\geq(1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(%
k)}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi%
(k)}~{}\quad\text{s.t.}~{}\alpha\in\left[0,~{}1\right.),~{}\widehat{K}\leq%
\frac{K}{2}\\
&\doteq\mathcal{L}^{\alpha}(\widehat{K}),\end{split}
\phi(\cdot)
\{\frac{N_{k}}{N}\mathcal{L}_{k}\}
\phi(\cdot)
\alpha\in\left[0,1)\right.
\widehat{K}\leq\frac{K}{2}
\{\frac{N_{k}}{N}\mathcal{L}_{k}\}
\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}\leq\sum_{k=%
\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}
\displaystyle\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)%
}+\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}-(1+%
\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}-(1-%
\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}
\displaystyle\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)%
}+\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}-(1+%
\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}-(1-%
\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}\mathcal{L}_{\phi(k)}
\displaystyle=\alpha\cdot\left(\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}%
\mathcal{L}_{\phi(k)}-\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}%
_{\phi(k)}\right)\geq 0.
\displaystyle=\alpha\cdot\left(\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}{N}%
\mathcal{L}_{\phi(k)}-\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}\mathcal{L}%
_{\phi(k)}\right)\geq 0.
\alpha_{1}>\alpha_{2}
\displaystyle\mathcal{L}^{\alpha_{1}}(\widehat{K})-\mathcal{L}^{\alpha_{2}}(%
\widehat{K})=(1+\alpha_{1})\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}%
\mathcal{L}_{\phi(k)}+(1-\alpha_{1})\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)%
}}{N}\mathcal{L}_{\phi(k)}
\displaystyle\mathcal{L}^{\alpha_{1}}(\widehat{K})-\mathcal{L}^{\alpha_{2}}(%
\widehat{K})=(1+\alpha_{1})\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}%
\mathcal{L}_{\phi(k)}+(1-\alpha_{1})\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)%
}}{N}\mathcal{L}_{\phi(k)}
\displaystyle-(1+\alpha_{2})\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}%
\mathcal{L}_{\phi(k)}-(1-\alpha_{2})\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)%
}}{N}\mathcal{L}_{\phi(k)}
\displaystyle-(1+\alpha_{2})\sum_{k=1}^{\widehat{K}}\frac{N_{\phi(k)}}{N}%
\mathcal{L}_{\phi(k)}-(1-\alpha_{2})\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)%
}}{N}\mathcal{L}_{\phi(k)}
\displaystyle=(\alpha_{1}-\alpha_{2})\left(\sum_{k=1}^{\widehat{K}}\frac{N_{%
\phi(k)}}{N}\mathcal{L}_{\phi(k)}-\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}%
{N}\mathcal{L}_{\phi(k)}\right)\leq 0
\displaystyle=(\alpha_{1}-\alpha_{2})\left(\sum_{k=1}^{\widehat{K}}\frac{N_{%
\phi(k)}}{N}\mathcal{L}_{\phi(k)}-\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}}%
{N}\mathcal{L}_{\phi(k)}\right)\leq 0
\mathcal{L}^{\alpha}(\widehat{K}_{1})<\mathcal{L}^{\alpha}(\widehat{K}_{2})
\widehat{K}_{1}>\widehat{K}_{2}
c:\mathcal{X}\times\mathcal{X}\rightarrow\mathbb{R}_{+}
x_{0}\in\mathcal{X}
c(\cdot,x_{0})
l
||\cdot||
||\cdot||_{*}
||\cdot||
\ell:\Theta\times\mathcal{X}\rightarrow\mathbb{R}
||\nabla_{\theta}\ell(\theta;x)-\nabla_{\theta}\ell(\theta^{\prime};x)||_{*}%
\leq L_{\theta\theta}||\theta-\theta^{\prime}||,\quad||\nabla_{x}\ell(\theta;x%
)-\nabla_{x}\ell(\theta;x^{\prime})||_{*}\leq L_{xx}||x-x^{\prime}||,
||\nabla_{\theta}\ell(\theta;x)-\nabla_{\theta}\ell(\theta;x^{\prime})||_{*}%
\leq L_{\theta x}||x-x^{\prime}||,\quad||\nabla_{x}\ell(\theta;x)-\nabla_{x}%
\ell(\theta^{\prime};x)||_{*}\leq L_{x\theta}||\theta-\theta^{\prime}||.
f:\Theta\times\mathcal{X}\rightarrow\mathbb{R}
\lambda
x
||\cdot||
\bar{f}(\theta)=\sup_{x\in\mathcal{X}}f(\theta,x)
g_{\theta}(\theta,x)=\nabla_{\theta}f(\theta,x)
g_{x}(\theta,x)=\nabla_{x}f(\theta,x)
g_{\theta}
g_{x}
\ell(\theta,x)
f(\theta,x)
\bar{f}
x^{*}(\theta)=\arg\max_{x\in\mathcal{X}}f(\theta,x)
\nabla\bar{f}(\theta)=g_{\theta}(\theta,x^{*}(\theta)).
||x^{*}(\theta_{1})-x^{*}(\theta_{2})||\leq\frac{L_{x\theta}}{\lambda}||\theta%
_{1}-\theta_{2}||
||\nabla\bar{f}(\theta)-\nabla\bar{f}(\theta^{\prime})||_{*}\leq(L_{\theta%
\theta}+\frac{L_{\theta x}L_{x\theta}}{\lambda}||\theta-\theta^{\prime}||).
c:\mathcal{X}\times\mathcal{X}\rightarrow\mathbb{R}_{+}\cup\{\infty\}
c(x,x_{0})
x_{0}
x
f(\theta,x;x_{0})=\ell(\theta;x)-\gamma c(x,x_{0})
g^{t}=\nabla_{\theta}f(\theta^{t},\hat{x};x^{t})
\hat{x}
f(\theta,x;x^{t})
x
\theta^{t+1}=\theta^{t}-\mu_{t}g^{t}
\mu_{t}\leq\frac{1}{L_{\psi}}
\mu=\sqrt{\frac{\Delta_{\mathcal{L}}}{L_{\psi}T\delta^{2}}}
T\geq\frac{L_{\psi}\Delta_{\mathcal{L}}}{\delta^{2}}
L_{\psi}
\mathcal{L}_{k}
k
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\leq\mathcal{L}_{k}\big{|}_{%
\theta^{t}}+\left\langle\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}},\theta^{t+1}%
-\theta^{t}\right\rangle+\frac{L_{\psi}}{2}||\theta^{t+1}-\theta^{t}||_{2}^{2}
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t+1}}
\displaystyle\leq\mathcal{L}_{k}\big{|}_{\theta^{t}}+\left\langle\nabla%
\mathcal{L}_{k}\big{|}_{\theta^{t}},\theta^{t+1}-\theta^{t}\right\rangle+\frac%
{L_{\psi}}{2}||\theta^{t+1}-\theta^{t}||_{2}^{2}
\displaystyle=\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}||\nabla\mathcal{L}_{%
k}\big{|}_{\theta^{t}}||_{2}^{2}+\frac{L_{\psi}\mu^{2}}{2}||g^{t}||_{2}^{2}+%
\mu_{t}\left\langle\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}},\nabla\mathcal{L}%
_{k}\big{|}_{\theta^{t}}-g^{t}\right\rangle
\displaystyle=\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}||\nabla\mathcal{L}_{%
k}\big{|}_{\theta^{t}}||_{2}^{2}+\frac{L_{\psi}\mu^{2}}{2}||g^{t}||_{2}^{2}+%
\mu_{t}\left\langle\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}},\nabla\mathcal{L}%
_{k}\big{|}_{\theta^{t}}-g^{t}\right\rangle
\displaystyle=\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}\left(1-\frac{1}{2}L_%
{\psi}\mu^{2}\right)||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle=\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}\left(1-\frac{1}{2}L_%
{\psi}\mu^{2}\right)||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle+\mu_{t}(1-L_{\psi}\mu)\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-g^{t}\right\rangle+\frac%
{L_{\psi}\mu^{2}}{2}||g^{t}-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle+\mu_{t}(1-L_{\psi}\mu)\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-g^{t}\right\rangle+\frac%
{L_{\psi}\mu^{2}}{2}||g^{t}-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\phi_{\gamma}(\theta;x_{0})=\sup_{x\in\mathbb{Z}}f(\theta,x;x_{0})
\zeta^{t}=g^{t}-\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\leq\mathcal{L}_{k}\big{|}_{%
\theta^{t}}-\mu_{t}\left(1-\frac{1}{2}L_{\psi}\mu^{2}\right)||\nabla\mathcal{L%
}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\leq
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}\left(1-\frac{1}{2}L_{%
\psi}\mu^{2}\right)||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle+\mu_{t}(1-L_{\psi}\mu)\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})\right\rangle
\displaystyle+\mu_{t}(1-L_{\psi}\mu)\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})\right\rangle
\displaystyle-\mu_{t}(1-L_{\psi}\mu_{t})\left\langle\nabla\mathcal{L}_{k}\big{%
|}_{\theta^{t}},\zeta^{t}\right\rangle+\frac{L_{\psi}\mu^{2}}{2}||\nabla_{%
\theta}\phi_{\gamma}(\theta^{t};x^{t})+\zeta^{2}-\nabla\mathcal{L}_{k}\big{|}_%
{\theta^{t}}||_{2}^{2}
\displaystyle-\mu_{t}(1-L_{\psi}\mu_{t})\left\langle\nabla\mathcal{L}_{k}\big{%
|}_{\theta^{t}},\zeta^{t}\right\rangle+\frac{L_{\psi}\mu^{2}}{2}||\nabla_{%
\theta}\phi_{\gamma}(\theta^{t};x^{t})+\zeta^{2}-\nabla\mathcal{L}_{k}\big{|}_%
{\theta^{t}}||_{2}^{2}
\displaystyle=\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}\left(1-\frac{1}{2}L_%
{\psi}\mu^{2}\right)||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle=\mathcal{L}_{k}\big{|}_{\theta^{t}}-\mu_{t}\left(1-\frac{1}{2}L_%
{\psi}\mu^{2}\right)||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle+\mu_{t}(1-L_{\psi}\mu)\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})\right\rangle
\displaystyle+\mu_{t}(1-L_{\psi}\mu)\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})\right\rangle
\displaystyle-\mu_{t}(1-L_{\psi}\mu_{t})\left\langle\nabla\mathcal{L}_{k}\big{%
|}_{\theta^{t}},\zeta^{t}\right\rangle
\displaystyle-\mu_{t}(1-L_{\psi}\mu_{t})\left\langle\nabla\mathcal{L}_{k}\big{%
|}_{\theta^{t}},\zeta^{t}\right\rangle
\displaystyle+\frac{L_{\psi}\mu_{t}^{2}}{2}\left(||\zeta^{t}||_{2}^{2}+||%
\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}}||_{2}^{2}+2\left\langle\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{%
t})-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}},\zeta^{t}\right\rangle\right).
\displaystyle+\frac{L_{\psi}\mu_{t}^{2}}{2}\left(||\zeta^{t}||_{2}^{2}+||%
\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}}||_{2}^{2}+2\left\langle\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{%
t})-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}},\zeta^{t}\right\rangle\right).
\pm\langle a,b\rangle\leq\frac{1}{2}\left(||a||_{2}^{2}+||b||_{2}^{2}\right)
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\leq\mathcal{L}_{k}\big{|}_{%
\theta^{t}}-\frac{\mu_{t}}{2}||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}%
^{2}+\mu_{t}((1-L_{\psi}\alpha))\left\langle\nabla\mathcal{L}_{k}\big{|}_{%
\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}-\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})\right\rangle
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\leq
\displaystyle\mathcal{L}_{k}\big{|}_{\theta^{t}}-\frac{\mu_{t}}{2}||\nabla%
\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}+\mu_{t}((1-L_{\psi}\alpha))\left%
\langle\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}},\nabla\mathcal{L}_{k}\big{|}_%
{\theta^{t}}-\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})\right\rangle
\displaystyle+\frac{\mu_{t}((1+L_{\psi}\mu))}{2}||\zeta||_{2}^{2}+L_{\psi}\mu_%
{t}^{2}||\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}%
\big{|}_{\theta^{t}}||_{2}^{2}.
\displaystyle+\frac{\mu_{t}((1+L_{\psi}\mu))}{2}||\zeta||_{2}^{2}+L_{\psi}\mu_%
{t}^{2}||\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}%
\big{|}_{\theta^{t}}||_{2}^{2}.
x_{*}^{t}=\arg\max_{x}f(\theta^{t},x;x^{t})
\zeta^{t}
\displaystyle||\zeta||_{2}^{2}=||\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t}%
)-\nabla f(\theta,\hat{x}^{t};x^{t})||_{2}^{2}=||\nabla_{\theta}\ell(\theta,x_%
{*}^{t})-\nabla_{\theta}\ell(\theta,\hat{x}^{t})||_{2}^{2}
\displaystyle||\zeta||_{2}^{2}=
\displaystyle||\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})-\nabla f(\theta,%
\hat{x}^{t};x^{t})||_{2}^{2}=||\nabla_{\theta}\ell(\theta,x_{*}^{t})-\nabla_{%
\theta}\ell(\theta,\hat{x}^{t})||_{2}^{2}
\displaystyle\leq L_{\theta_{x}}||\hat{x}^{t}-x_{*}^{t}||_{2}^{2}\leq\frac{2L_%
{\theta_{x}}^{2}}{\lambda}\epsilon,
\displaystyle\leq L_{\theta_{x}}||\hat{x}^{t}-x_{*}^{t}||_{2}^{2}\leq\frac{2L_%
{\theta_{x}}^{2}}{\lambda}\epsilon,
\lambda=\gamma-L_{xx}
x\mapsto f(\theta,x;x_{0})
\hat{\epsilon}=\frac{2L_{\theta_{x}}^{2}}{\gamma-L_{xx}}\epsilon
\mathbb{E}\left[\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})|\theta^{t}%
\right]=\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}
\displaystyle\mathbb{E}\left[\mathcal{L}_{k}\big{|}_{\theta^{t+1}}-\mathcal{L}%
_{k}\big{|}_{\theta^{t}}|\theta^{t}\right]\leq-\frac{\mu_{t}}{2}||\nabla%
\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}+\frac{\mu_{t}((1+L_{\psi}\mu))}{%
2}\hat{\epsilon}+L_{\psi}\mu_{t}^{2}||\nabla_{\theta}\phi_{\gamma}(\theta^{t};%
x^{t})-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle\mathbb{E}\left[\mathcal{L}_{k}\big{|}_{\theta^{t+1}}-\mathcal{L}%
_{k}\big{|}_{\theta^{t}}|\theta^{t}\right]
\displaystyle\leq-\frac{\mu_{t}}{2}||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}%
||_{2}^{2}+\frac{\mu_{t}((1+L_{\psi}\mu))}{2}\hat{\epsilon}+L_{\psi}\mu_{t}^{2%
}||\nabla_{\theta}\phi_{\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}\big{|}%
_{\theta^{t}}||_{2}^{2}
\displaystyle\leq-\frac{\mu_{t}}{2}||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}%
||_{2}^{2}+\mu_{t}\hat{\epsilon}+L_{\psi}\mu_{t}^{2}||\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\displaystyle\leq-\frac{\mu_{t}}{2}||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}%
||_{2}^{2}+\mu_{t}\hat{\epsilon}+L_{\psi}\mu_{t}^{2}||\nabla_{\theta}\phi_{%
\gamma}(\theta^{t};x^{t})-\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}^{2}
\mu_{t}\leq\frac{1}{L_{\psi}}
\mu
\displaystyle\mathbb{E}\left[||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}%
^{2}\right]-2\hat{\epsilon}\leq\frac{2}{\mu}\mathbb{E}\left[\mathcal{L}_{k}%
\big{|}_{\theta^{t}}-\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\right]+2L_{\psi}\mu%
\delta^{2}
\displaystyle\mathbb{E}\left[||\nabla\mathcal{L}_{k}\big{|}_{\theta^{t}}||_{2}%
^{2}\right]-2\hat{\epsilon}\leq\frac{2}{\mu}\mathbb{E}\left[\mathcal{L}_{k}%
\big{|}_{\theta^{t}}-\mathcal{L}_{k}\big{|}_{\theta^{t+1}}\right]+2L_{\psi}\mu%
\delta^{2}
\mathbb{E}\left[||\nabla_{\theta}\phi_{\gamma}(\theta;Z)-\nabla\mathcal{L}_{k}%
\big{|}_{\theta}||_{2}^{2}\right]\leq\delta^{2}
t
\displaystyle\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[||\nabla\mathcal{L}_{k}%
\big{|}_{\theta^{t}}||_{2}^{2}\right]-2\hat{\epsilon}\leq\frac{2}{\mu T}(%
\mathcal{L}_{k}\big{|}_{\theta^{0}}-\mathbb{E}[\mathcal{L}_{k}\big{|}_{\theta^%
{T}}])+2L_{\psi}\mu\delta^{2}
\displaystyle\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[||\nabla\mathcal{L}_{k}%
\big{|}_{\theta^{t}}||_{2}^{2}\right]-2\hat{\epsilon}
\displaystyle\leq\frac{2}{\mu T}(\mathcal{L}_{k}\big{|}_{\theta^{0}}-\mathbb{E%
}[\mathcal{L}_{k}\big{|}_{\theta^{T}}])+2L_{\psi}\mu\delta^{2}
\displaystyle\leq\frac{2\Delta}{\mu T}+2L_{\psi}\mu\delta^{2}
\displaystyle\leq\frac{2\Delta}{\mu T}+2L_{\psi}\mu\delta^{2}
\mu=\sqrt{\frac{Delta}{L_{\psi}T\delta^{2}}}
\lambda=\gamma-L_{xx}
\displaystyle\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[||\nabla\mathcal{L}_{k}%
\big{|}_{\theta^{t}}||_{2}^{2}\right]\leq\frac{4L_{\theta x}^{2}\epsilon}{%
\lambda}+4\delta\sqrt{\frac{L\Delta}{T}}
\displaystyle\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[||\nabla\mathcal{L}_{k}%
\big{|}_{\theta^{t}}||_{2}^{2}\right]\leq\frac{4L_{\theta x}^{2}\epsilon}{%
\lambda}+4\delta\sqrt{\frac{L\Delta}{T}}
\alpha
\displaystyle\begin{split}&\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[\bigg{|}%
\bigg{|}\nabla\mathcal{L}^{\alpha}(\widehat{K})\big{|}_{\theta^{t}}\bigg{|}%
\bigg{|}^{2}_{2}\right]\\
&=\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[\bigg{|}\bigg{|}(1+\alpha)\sum_{k=1%
}^{\widehat{K}}\frac{N_{\phi(k)}^{(t)}}{N}\nabla\mathcal{L}_{\phi(k)}\big{|}_{%
\theta^{t}}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}^{(t)}}{N}%
\nabla\mathcal{L}_{\phi(k)}\big{|}_{\theta^{t}}\bigg{|}\bigg{|}^{2}_{2}\right]%
\\
&\leq\frac{1}{T}\sum_{t=1}^{T}\left((1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_%
{\phi(k)}^{(t)}}{N}\mathbb{E}\left[\bigg{|}\bigg{|}\nabla\mathcal{L}_{\phi(k)}%
\big{|}_{\theta^{t}}\bigg{|}\bigg{|}^{2}_{2}\right]+(1-\alpha)\sum_{k=\widehat%
{K}+1}^{K}\frac{N_{\phi(k)}^{(t)}}{N}\mathbb{E}\left[\bigg{|}\bigg{|}\nabla%
\mathcal{L}_{\phi(k)}\big{|}_{\theta^{t}}\bigg{|}\bigg{|}^{2}_{2}\right]\right%
)\\
&\leq\frac{1}{T}\sum_{t=1}^{T}\left((1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_%
{\phi(k)}^{(t)}}{N}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}^{(t)%
}}{N}\right)\left(\frac{4L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{\frac%
{L\Delta}{T}}\right)\\
&=\frac{1}{T}\sum_{t=1}^{T}\left(1+\alpha\frac{\sum_{k=1}^{\widehat{K}}N_{\phi%
(k)}^{(t)}-\sum_{k=\widehat{K}+1}^{K}N_{\phi(k)}^{(t)}}{N}\right)\left(\frac{4%
L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{\frac{L\Delta}{T}}\right)\\
&=\left(1+\alpha\frac{\frac{1}{T}\sum_{t=1}^{T}\xi^{(t)}}{N}\right)\left(\frac%
{4L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{\frac{L\Delta}{T}}\right),%
\end{split}
\displaystyle\begin{split}&\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[\bigg{|}%
\bigg{|}\nabla\mathcal{L}^{\alpha}(\widehat{K})\big{|}_{\theta^{t}}\bigg{|}%
\bigg{|}^{2}_{2}\right]\\
&=\frac{1}{T}\sum_{t=1}^{T}\mathbb{E}\left[\bigg{|}\bigg{|}(1+\alpha)\sum_{k=1%
}^{\widehat{K}}\frac{N_{\phi(k)}^{(t)}}{N}\nabla\mathcal{L}_{\phi(k)}\big{|}_{%
\theta^{t}}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}^{(t)}}{N}%
\nabla\mathcal{L}_{\phi(k)}\big{|}_{\theta^{t}}\bigg{|}\bigg{|}^{2}_{2}\right]%
\\
&\leq\frac{1}{T}\sum_{t=1}^{T}\left((1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_%
{\phi(k)}^{(t)}}{N}\mathbb{E}\left[\bigg{|}\bigg{|}\nabla\mathcal{L}_{\phi(k)}%
\big{|}_{\theta^{t}}\bigg{|}\bigg{|}^{2}_{2}\right]+(1-\alpha)\sum_{k=\widehat%
{K}+1}^{K}\frac{N_{\phi(k)}^{(t)}}{N}\mathbb{E}\left[\bigg{|}\bigg{|}\nabla%
\mathcal{L}_{\phi(k)}\big{|}_{\theta^{t}}\bigg{|}\bigg{|}^{2}_{2}\right]\right%
)\\
&\leq\frac{1}{T}\sum_{t=1}^{T}\left((1+\alpha)\sum_{k=1}^{\widehat{K}}\frac{N_%
{\phi(k)}^{(t)}}{N}+(1-\alpha)\sum_{k=\widehat{K}+1}^{K}\frac{N_{\phi(k)}^{(t)%
}}{N}\right)\left(\frac{4L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{\frac%
{L\Delta}{T}}\right)\\
&=\frac{1}{T}\sum_{t=1}^{T}\left(1+\alpha\frac{\sum_{k=1}^{\widehat{K}}N_{\phi%
(k)}^{(t)}-\sum_{k=\widehat{K}+1}^{K}N_{\phi(k)}^{(t)}}{N}\right)\left(\frac{4%
L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{\frac{L\Delta}{T}}\right)\\
&=\left(1+\alpha\frac{\frac{1}{T}\sum_{t=1}^{T}\xi^{(t)}}{N}\right)\left(\frac%
{4L^{2}_{\theta x}\epsilon}{\lambda}+4\delta\sqrt{\frac{L\Delta}{T}}\right),%
\end{split}
\xi^{(t)}=\sum_{k=1}^{\widehat{K}}N_{\phi(k)}^{(t)}-\sum_{k=\widehat{K}+1}^{K}%
N_{\phi(k)}^{(t)}
\ell_{2}
\mathcal{L}_{1}
\dots
\mathcal{L}_{K}
v
w
\mathcal{L}_{k}(v)\leq\mathcal{L}_{k}(w)+(v-w)^{T}\nabla\mathcal{L}_{k}(w)+%
\frac{L}{2}||v-w||_{2}^{2}
\mathcal{L}_{1}
\dots
\mathcal{L}_{K}
\lambda
v
w
\mathcal{L}_{k}(v)\geq\mathcal{L}_{k}(w)+(v-w)^{T}\nabla\mathcal{L}_{k}(w)+%
\frac{\lambda}{2}||v-w||_{2}^{2}
\xi_{t}^{k}
k
\mathbb{E}||\nabla\mathcal{L}_{k}(w_{t}^{k},\xi_{t}^{k})-\nabla\mathcal{L}_{k}%
(w_{t}^{k})||^{2}\leq\delta_{k}^{2}
k=1,\cdots,K
\mathbb{E}||\nabla\mathcal{L}_{k}(w_{t}^{k},\xi_{t}^{k})||^{2}\leq\varsigma^{2}
k=1,\cdots,K
t=1,\cdots,T-1
\theta_{t}^{k}
k
t
\Theta
\theta_{t}^{k}
\bar{\Theta}_{t}=\sum_{k=1}^{K}\frac{N_{k}}{N}\Theta_{t}
\bar{\theta}_{t}==\sum_{k=1}^{K}\frac{N_{k}}{N}\theta_{t}
\bar{g}_{t}=\sum_{k=1}^{K}\frac{N_{k}}{N}\nabla\mathcal{L}_{k}(\theta_{t}^{k})
g_{t}=\sum_{k=1}^{K}\frac{N_{k}}{N}\nabla\mathcal{L}_{k}(\theta_{t}^{k},\xi_{t%
}^{k})
\mathbb{E}g_{t}=\bar{g}_{t}
\eta_{t}\leq\frac{1}{4L}
\displaystyle\mathbb{E}||\bar{\Theta}_{t+1}-\theta^{*}||^{2}\leq(1-\eta_{t}%
\lambda)\mathbb{E}||\bar{\theta}_{t}-\theta^{*}||^{2}
\displaystyle\mathbb{E}||\bar{\Theta}_{t+1}-\theta^{*}||^{2}
\displaystyle\leq(1-\eta_{t}\lambda)\mathbb{E}||\bar{\theta}_{t}-\theta^{*}||^%
{2}
\displaystyle+\eta_{t}^{2}\mathbb{E}||g_{t}-\bar{g}_{t}||^{2}+6L\eta_{t}^{2}%
\Gamma+2\mathbb{E}\sum_{k=1}^{K}\frac{N_{k}}{N}||\bar{\theta}_{t}-\theta_{t}^{%
k}||^{2},
\displaystyle+\eta_{t}^{2}\mathbb{E}||g_{t}-\bar{g}_{t}||^{2}+6L\eta_{t}^{2}%
\Gamma+2\mathbb{E}\sum_{k=1}^{K}\frac{N_{k}}{N}||\bar{\theta}_{t}-\theta_{t}^{%
k}||^{2},
\Gamma=\mathcal{L}^{*}-\sum_{k}^{K}\mathbb{E}_{t}\frac{N_{k}}{N}\mathcal{L}_{k%
}^{*}\geq 0
\displaystyle\mathbb{E}||g_{t}-\bar{g}_{t}||^{2}\leq\sum_{k=1}^{K}\left(\frac{%
N_{k}}{N}\right)^{2}\delta_{k}^{2},
\displaystyle\mathbb{E}||g_{t}-\bar{g}_{t}||^{2}\leq\sum_{k=1}^{K}\left(\frac{%
N_{k}}{N}\right)^{2}\delta_{k}^{2},
\theta_{t}^{k}
\eta_{t}
\eta\leq 2\eta_{t+E}
t>0
\displaystyle\mathbb{E}\left[\sum_{k=1}^{K}\frac{N_{k}}{N}||\bar{\theta}_{t}-%
\theta_{t}^{k}||^{2}\right]\leq 4\eta_{t}^{2}(E-1)^{2}\varsigma^{2}
\displaystyle\mathbb{E}\left[\sum_{k=1}^{K}\frac{N_{k}}{N}||\bar{\theta}_{t}-%
\theta_{t}^{k}||^{2}\right]\leq 4\eta_{t}^{2}(E-1)^{2}\varsigma^{2}
\Delta_{t}=\mathbb{E}||\theta_{t}-\theta^{*}||^{2}
\displaystyle\Delta_{t+1}\leq(1-\eta_{t}\lambda)\Delta_{t}+\eta_{t}^{2}B,
\displaystyle\Delta_{t+1}\leq(1-\eta_{t}\lambda)\Delta_{t}+\eta_{t}^{2}B,
\displaystyle B=\sum_{k=1}^{K}\left(\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}%
}{N}}\right)^{2}\left(\frac{N_{k}}{N}\delta_{k}\right)^{2}+6L\left(\mathcal{L}%
^{*}-\sum_{k=1}^{K}\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}}{N}}\frac{N_{k}}%
{N}\mathcal{L}_{k}^{*}\right)+8(E-1)^{2}\varsigma^{2},
\displaystyle B=\sum_{k=1}^{K}\left(\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}%
}{N}}\right)^{2}\left(\frac{N_{k}}{N}\delta_{k}\right)^{2}+6L\left(\mathcal{L}%
^{*}-\sum_{k=1}^{K}\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}}{N}}\frac{N_{k}}%
{N}\mathcal{L}_{k}^{*}\right)+8(E-1)^{2}\varsigma^{2},
\left(\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}}{N}}\right)^{2}
\frac{P_{k}^{(T)}}{1+\alpha\frac{\xi^{(T)}}{N}}
\delta_{k}^{2}
\mathcal{L}^{*}_{k}
\eta_{t}=\frac{\beta}{\gamma+t}
\beta>\frac{1}{\lambda}
\gamma>0
\eta_{1}\leq\min\{\frac{1}{\lambda},\frac{1}{4L}\}=\frac{1}{4L}
\eta_{t}\leq 2\eta_{t+E}
\Delta_{t}\leq\frac{\nu}{\gamma+t}
\nu=\max\{\frac{\beta^{2}B}{\beta\lambda-1},(\gamma+1)\Delta_{1}\}
\nu
t=1
t
\displaystyle\begin{split}\Delta_{t+1}&\leq(1-\eta_{t}\lambda)\Delta_{t}+\eta_%
{t}^{2}B\\
&\leq(1-\frac{\beta\lambda}{t+\gamma})\frac{\nu}{t+\gamma}+\frac{\beta^{2}B}{(%
t+\gamma)^{2}}\\
&=\frac{t+\gamma-1}{(t+\gamma)^{2}}\nu+[\frac{\beta^{2}B}{(t+\gamma)^{2}}-%
\frac{\beta\lambda-1}{(t+\gamma)^{2}}\nu]\\
&\leq\frac{\nu}{t+\gamma+1}.\end{split}
\displaystyle\begin{split}\Delta_{t+1}&\leq(1-\eta_{t}\lambda)\Delta_{t}+\eta_%
{t}^{2}B\\
&\leq(1-\frac{\beta\lambda}{t+\gamma})\frac{\nu}{t+\gamma}+\frac{\beta^{2}B}{(%
t+\gamma)^{2}}\\
&=\frac{t+\gamma-1}{(t+\gamma)^{2}}\nu+[\frac{\beta^{2}B}{(t+\gamma)^{2}}-%
\frac{\beta\lambda-1}{(t+\gamma)^{2}}\nu]\\
&\leq\frac{\nu}{t+\gamma+1}.\end{split}
\mathcal{L}
\cdot
\displaystyle\mathbb{E}[\mathcal{L}_{t}]-\mathcal{L}^{*}\leq\frac{L}{2}\Delta_%
{t}\leq\frac{L}{2}\frac{\nu}{\gamma+t}
\displaystyle\mathbb{E}[\mathcal{L}_{t}]-\mathcal{L}^{*}\leq\frac{L}{2}\Delta_%
{t}\leq\frac{L}{2}\frac{\nu}{\gamma+t}
\beta=\frac{2}{\lambda},\gamma=\max\{8\frac{L}{\lambda},E\}-1
\kappa=\frac{L}{\lambda}
\eta_{t}=\frac{2}{\lambda}\frac{1}{\gamma+t}
\eta_{t}
\eta_{t}\leq 2\eta_{t+E}
t\geq 1
\displaystyle\nu=\max\left\{\frac{\beta^{2}B}{\beta\lambda-1},(\gamma+1)\Delta%
_{1}\right\}\leq\frac{\beta^{2}B}{\beta\lambda-1}+(\gamma+1)\Delta_{1}\leq%
\frac{4B}{\lambda^{2}}+(\gamma+1)\Delta_{1},
\displaystyle\nu=\max\left\{\frac{\beta^{2}B}{\beta\lambda-1},(\gamma+1)\Delta%
_{1}\right\}\leq\frac{\beta^{2}B}{\beta\lambda-1}+(\gamma+1)\Delta_{1}\leq%
\frac{4B}{\lambda^{2}}+(\gamma+1)\Delta_{1},
\displaystyle\mathbb{E}[\mathcal{L}_{t}]-\mathcal{L}^{*}\leq\frac{L}{2}\frac{%
\nu}{\gamma+t}\leq\frac{\kappa}{\gamma+t}\left(\frac{2B}{\lambda}+\frac{%
\lambda(\gamma+1)}{2}\Delta_{1}\right)
\displaystyle\mathbb{E}[\mathcal{L}_{t}]-\mathcal{L}^{*}
\displaystyle\leq\frac{L}{2}\frac{\nu}{\gamma+t}\leq\frac{\kappa}{\gamma+t}%
\left(\frac{2B}{\lambda}+\frac{\lambda(\gamma+1)}{2}\Delta_{1}\right)
\epsilon=1/255
\epsilon=4/255
||\theta_{k}-\theta_{s}||_{2}
\epsilon=1/255
\epsilon=4/255
||\theta_{k}-\theta_{s}||_{2}
\epsilon
1/255
4/255
\delta^{2}
\alpha
\theta_{k}
\frac{N_{k}}{N}\mathcal{L}_{k})
\odot
\alpha
\theta_{k}
\frac{N_{k}}{N}\mathcal{L}_{k})
\odot
\alpha
K
T
E
\theta^{0}
\alpha
\widehat{K}
\theta^{T}
=1
\dots
T
k=1
\dots
K
\theta_{k}^{t},\mathcal{L}_{k}=
(\theta_{k}^{t},E)
\mathcal{L}_{all}\leftarrow[\frac{N_{1}}{N}\mathcal{L}_{1},\frac{N_{2}}{N}%
\mathcal{L}_{2},\dots,\frac{N_{K}}{N}\mathcal{L}_{K}]
\mathcal{L}_{\text{sorted}}\leftarrow
\_
\mathcal{L}_{all}
\forall k,~{}P_{k}=(\frac{1+\alpha}{1-\alpha}\cdot\mathds{1}(\frac{N_{k}}{N}%
\mathcal{L}_{k}\leq\mathcal{L}_{\text{sorted}}[\widehat{K}])+1\cdot\mathds{1}(%
\frac{N_{k}}{N}\mathcal{L}_{k}>\mathcal{L}_{\text{sorted}}[\widehat{K}]))/((%
\sum_{k=1}^{K}P_{k})+\frac{2\alpha}{1-\alpha})
\theta^{t+1}=\frac{1}{\sum^{K}_{k=1}N_{k}}\sum^{K}_{k=1}{P_{k}N_{k}\theta^{t}_%
{k}}
P_{k}=((1+\alpha)/(1-\alpha)\cdot\mathds{1}(\frac{N_{k}}{N}\mathcal{L}_{k}\leq%
\mathcal{L}_{\text{sorted}}[\widehat{K}])+1\cdot\mathds{1}(\frac{N_{k}}{N}%
\mathcal{L}_{k}>\mathcal{L}_{\text{sorted}}[\widehat{K}]))/((\sum_{k=1}^{K}P_{%
k})+2\alpha/(1-\alpha))
\alpha
s
K
\mathcal{Y}
\mathcal{Y}_{k}
K
K
(100-(K-1)\times s)\%
\mathcal{Y}_{k}
s\%
s=2
5
K
\widehat{K}
32
128
5
0.0001
\epsilon=8/255
2/255
10
\epsilon=4/255
1/255
10
[-\epsilon,\epsilon]
\alpha
\alpha=1/6
\frac{1+\alpha}{1-\alpha}=1.4
\alpha=1/11
\frac{1+\alpha}{1-\alpha}=1.2
\alpha=1/11
\frac{1+\alpha}{1-\alpha}=1.2
\mu=0.01
\alpha
\alpha
1/11
1/11
1/11
\alpha
1/11
3/23
1/11
\alpha
\alpha
\alpha
\alpha
\widehat{K}
\alpha=1/6
\widehat{K}=1
\widehat{K}
\alpha=1/6
\widehat{K}=1
32.40\%
32.23\%
5
5
\frac{1+\alpha}{1-\alpha}=1.4
\frac{1+\alpha}{1-\alpha}=1.2
\frac{1+\alpha}{1-\alpha}=1.0
\frac{1+\alpha}{1-\alpha}=0.8
\frac{1+\alpha}{1-\alpha}=0.6
\frac{1+\alpha}{1-\alpha}=1.4
\frac{1+\alpha}{1-\alpha}=1.2
\frac{1+\alpha}{1-\alpha}=1.0
\frac{1+\alpha}{1-\alpha}=0.8
\frac{1+\alpha}{1-\alpha}=0.6
\alpha
5
\widehat{K}=1
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
\frac{1+\alpha}{1-\alpha}:1.4
\frac{1+\alpha}{1-\alpha}:1.4\rightarrow 1.0
\frac{1+\alpha}{1-\alpha}:1.2
\frac{1+\alpha}{1-\alpha}:1.2\rightarrow 1.0
\mathbb{E}|\cdot|
\mathbb{E}|\mathcal{L}_{\text{SFAT}}|-\mathcal{L}^{*}
\alpha
\mathbb{E}|\cdot|
\mathbb{E}|\mathcal{L}_{\text{SFAT}}|-\mathcal{L}^{*}
\alpha
\alpha
\downarrow
\downarrow
\mu
\mu
\mu
\mu
\frac{\mu}{2}||w-w^{t}||_{2}
\mu
\mu
\widehat{K}=K/5
\alpha=1/11
\alpha
\alpha
\widehat{K}=2*K/5
\alpha=1/6
L_{\infty}
L_{\infty}
