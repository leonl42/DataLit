{}^{1}\hskip 2.0pt
{}^{2}\hskip 2.0pt
1.1\times 10^{9}
11.3\times 10^{9}
3\times 3
{\bm{I}}
m\times m
{\bm{W}}
n\times n
{\bm{O}}
(m-n+1)\times(m-n+1)
m=4
n=3
m=4
n=3
{\bm{W}}
{\bm{I}}
{\bm{G}}
{\bm{B}}
{\bm{G}}{\bm{W}}{\bm{G}}^{\top}
{\bm{B}}^{\top}{\bm{I}}\;{\bm{B}}
m\times m
{\bm{A}}
\odot
{\bm{O}}={\bm{A}}^{\top}[({\bm{G}}{\bm{W}}{\bm{G}}^{\top})\odot({\bm{B}}^{\top%
}{\bm{I}}\;{\bm{B}})]{\bm{A}}
{\bm{A}}
{\bm{B}}
{\bm{G}}
m
n
{\bm{G}}{\bm{W}}{\bm{G}}^{\top}
{\bm{B}}^{\top}{\bm{I}}\;{\bm{B}}
(m-n+1)^{2}n^{2}
m^{2}
5\times
{\bm{G}}{\bm{W}}{\bm{G}}^{\top}
>90\%
{\bm{O}}={\bm{A}}^{\top}[({\bm{G}}{\bm{W}}{\bm{G}}^{\top})\odot\mathrm{ReLU}({%
\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})]{\bm{A}}
{\bm{W}}
{\bm{M}}^{spatial}
{\bm{W}}
n\times n
{\bm{Q}}
m\times m
{\bm{Q}}={\bm{G}}{\bm{W}}{\bm{G}}^{\top}
{\bm{Q}}_{i,j}
{\bm{Q}}_{i,j}=\sum_{0\leqslant u,v\leqslant n-1}{({\bm{S}}_{i,j,u,v}\cdot{\bm%
{W}}_{u,v})}\;\;\;\;\;\;0\leqslant i,j\leqslant m-1
{\bm{S}}
m
n
{\bm{S}}
{\bm{Q}}_{i,j}
{\mathbb{D}}_{i,j}
{\bm{Q}}_{i,j}
{\mathbb{D}}_{i,j}
{\mathbb{D}}_{i,j}=\{{\bm{W}}_{u,v}\;\bigr{\rvert}\;{\bm{S}}_{i,j,u,v}\neq 0,%
\;0\leqslant u,v\leqslant n-1\}
{\mathbb{D}}_{i,j}
h({\mathbb{D}}_{i,j})
h
h({\mathbb{D}}_{i,j})=\mathrm{max}(\{\;|{\bm{W}}_{u,v}|\;\bigr{\rvert}\;{\bm{W%
}}_{u,v}\in{\mathbb{D}}_{i,j}\})
t^{spatial}
h({\mathbb{D}}_{i,j})<t^{spatial}
{\mathbb{D}}_{i,j}
{\bm{Q}}_{i,j}
{\bm{W}}
{\mathbb{D}}_{i,j}
{\mathbb{D}}=\bigcup_{0\leqslant i,j\leqslant m-1,h({\mathbb{D}}_{i,j})<t^{%
spatial}}{\mathbb{D}}_{i,j}
{\mathbb{D}}_{i,j}
{\bm{M}}^{spatial}
{\bm{M}}_{u,v}^{spatial}=\left\{\begin{matrix}0&{\bm{W}}_{u,v}\in{\mathbb{D}}%
\\
1&{\bm{W}}_{u,v}\notin{\mathbb{D}}\end{matrix}\right.\;\;\;\;\;\;0\leqslant u,%
v\leqslant n-1
{\bm{W}}={\bm{W}}\odot{\bm{M}}^{spatial}
\odot
t^{spatial}
{\bm{M}}^{Winograd}
{\bm{Q}}
{\bm{Q}}
{\bm{O}}
{\bm{O}}={\bm{A}}^{\top}[{\bm{Q}}\odot({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})]{\bm%
{A}}
\begin{split}{\bm{O}}_{x,y}=\sum_{0\leqslant i,j,s,t\leqslant m-1}({\bm{H}}_{x%
,y,i,j,s,t}\cdot{\bm{Q}}_{i,j}\cdot{\bm{I}}_{s,t})\;\;\;\;\;\;0\leqslant x,y%
\leqslant m-n\end{split}
{\bm{H}}
{\bm{Q}}_{i,j}\cdot{\bm{I}}_{s,t}
m
n
{\bm{H}}
{\bm{Q}}_{i,j}
{\bm{O}}_{x,y}
\begin{split}\Delta{{\bm{O}}_{x,y}\rvert}_{{\bm{Q}}_{i,j}}=-1\cdot\sum_{0%
\leqslant s,t\leqslant m-1}({\bm{H}}_{x,y,i,j,s,t}\cdot{\bm{Q}}_{i,j}\cdot{\bm%
{I}}_{s,t})\;\;\;\;\;\;0\leqslant x,y\leqslant m-n\end{split}
{||\Delta{\bm{O}}||_{2}}
{\bm{Q}}_{i,j}
{||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_{i,j}}||_{2}^{2}}
\displaystyle E({||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_{i,j}}||_{2}^{2}})=E\Big{(%
}\sum_{0\leqslant x,y\leqslant m-n}\Big{[}\sum_{\;\;\;0\leqslant s,t\leqslant m%
-1}({\bm{H}}_{x,y,i,j,s,t}\cdot{\bm{Q}}_{i,j}\cdot{\bm{I}}_{s,t})\Big{]}^{2}%
\Big{)}
\displaystyle E({||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_{i,j}}||_{2}^{2}})
\displaystyle=E\Big{(}\sum_{0\leqslant x,y\leqslant m-n}\Big{[}\sum_{\;\;\;0%
\leqslant s,t\leqslant m-1}({\bm{H}}_{x,y,i,j,s,t}\cdot{\bm{Q}}_{i,j}\cdot{\bm%
{I}}_{s,t})\Big{]}^{2}\Big{)}
\displaystyle={\bm{Q}}_{i,j}^{2}\cdot\bigg{\{}\sum_{0\leqslant x,y\leqslant m-%
n,0\leqslant s,t\leqslant m-1}\big{[}{\bm{H}}_{x,y,i,j,s,t}^{2}\cdot E({\bm{I}%
}_{s,t}^{2})\big{]}+
\displaystyle={\bm{Q}}_{i,j}^{2}\cdot\bigg{\{}\sum_{0\leqslant x,y\leqslant m-%
n,0\leqslant s,t\leqslant m-1}\big{[}{\bm{H}}_{x,y,i,j,s,t}^{2}\cdot E({\bm{I}%
}_{s,t}^{2})\big{]}+
\displaystyle\;\;\;\;\;\;\sum_{\begin{subarray}{c}0\leqslant x,y\leqslant m-n%
\\
0\leqslant s,t,s^{\prime},t^{\prime}\leqslant m-1\\
(s,t)\neq(s^{\prime},t^{\prime})\end{subarray}}\big{[}{\bm{H}}_{x,y,i,j,s,t}%
\cdot{\bm{H}}_{x,y,i,j,s^{\prime},t^{\prime}}\cdot E({\bm{I}}_{s,t}\cdot{\bm{I%
}}_{s^{\prime},t^{\prime}})\big{]}\bigg{\}}
\displaystyle\;\;\;\;\;\;\sum_{\begin{subarray}{c}0\leqslant x,y\leqslant m-n%
\\
0\leqslant s,t,s^{\prime},t^{\prime}\leqslant m-1\\
(s,t)\neq(s^{\prime},t^{\prime})\end{subarray}}\big{[}{\bm{H}}_{x,y,i,j,s,t}%
\cdot{\bm{H}}_{x,y,i,j,s^{\prime},t^{\prime}}\cdot E({\bm{I}}_{s,t}\cdot{\bm{I%
}}_{s^{\prime},t^{\prime}})\big{]}\bigg{\}}
\begin{split}E({\bm{I}}_{s,t}\cdot{\bm{I}}_{s^{\prime},t^{\prime}})=E({\bm{I}}%
_{s,t})\cdot E({\bm{I}}_{s^{\prime},t^{\prime}})=0\;\;\;\;\;\;(s,t)\neq(s^{%
\prime},t^{\prime})\end{split}
E({\bm{I}}_{s,t}^{2})=1
E({||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_{i,j}}||_{2}^{2}})={\bm{Q}}_{i,j}^{2}%
\cdot\sum_{0\leqslant x,y\leqslant m-n,0\leqslant s,t\leqslant m-1}{\bm{H}}_{x%
,y,i,j,s,t}^{2}
{\bm{F}}
\displaystyle{\bm{F}}_{i,j}=\sqrt{\frac{E({||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_%
{i,j}}||_{2}^{2}})}{{\bm{Q}}_{i,j}^{2}}}=\sqrt{\sum_{0\leqslant x,y\leqslant m%
-n,0\leqslant s,t\leqslant m-1}{\bm{H}}_{x,y,i,j,s,t}^{2}}\;\;\;\;\;\;0%
\leqslant i,j\leqslant m-1
\displaystyle{\bm{F}}_{i,j}
\displaystyle=\sqrt{\frac{E({||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_{i,j}}||_{2}^{%
2}})}{{\bm{Q}}_{i,j}^{2}}}=\sqrt{\sum_{0\leqslant x,y\leqslant m-n,0\leqslant s%
,t\leqslant m-1}{\bm{H}}_{x,y,i,j,s,t}^{2}}\;\;\;\;\;\;0\leqslant i,j\leqslant
m-1
{\bm{F}}
m
n
{\bm{Q}}
E({||{\Delta{\bm{O}}\rvert}_{{\bm{Q}}_{i,j}}||_{2}^{2}})={\bm{Q}}_{i,j}^{2}%
\cdot{\bm{F}}_{i,j}^{2}
t^{Winograd}
{\bm{M}}^{Winograd}
\begin{split}{\bm{M}}_{i,j}^{Winograd}=\left\{\begin{matrix}0&{\bm{Q}}_{i,j}^{%
2}\cdot{\bm{F}}_{i,j}^{2}<t^{Winograd}\\
1&{\bm{Q}}_{i,j}^{2}\cdot{\bm{F}}_{i,j}^{2}\geqslant t^{Winograd}\end{matrix}%
\right.\;\;\;\;\;\;0\leqslant i,j\leqslant m-1\end{split}
{\bm{Q}}_{i,j}
|{\bm{Q}}_{i,j}|
{\bm{Q}}^{2}_{i,j}
{\bm{Q}}_{i,j}^{2}\cdot{\bm{F}}_{i,j}^{2}
{\bm{F}}
{\bm{Q}}^{2}_{i,j}
{\bm{Q}}={\bm{Q}}\odot{\bm{M}}^{Winograd}
{\bm{F}}
loss
k
{\bm{Q}}
{\frac{\partial\;loss}{\partial{\bm{Q}}}\rvert}_{k}
({\frac{\partial\;loss}{\partial{\bm{Q}}}\Bigr{\rvert}}_{k})^{adjusted}={\frac%
{\partial\;loss}{\partial{\bm{Q}}}\Bigr{\rvert}}_{k}\oslash{\bm{F}}^{\circ\alpha}
\oslash
\circ\alpha
\alpha
\alpha
\eta
{\bm{Q}}
k
{{\bm{Q}}\rvert}_{k+1}={{\bm{Q}}\rvert}_{k}-\eta\cdot({\frac{\partial\;loss}{%
\partial{\bm{Q}}}\Bigr{\rvert}}_{k}\oslash{\bm{F}}^{\circ\alpha})
3\times 3
3\times 3
m
3\times 3
<0.1\%
3\times 3
3\times 3
<0.1\%
2\times 2
3\times 3
2\times 2
1\times 1
3\times 3
<0.1\%
<0.1\%
{\bm{F}}
{\bm{F}}
{\bm{F}}
{\bm{F}}
{\bm{F}}
{\bm{F}}
{\bm{S}}
{\bm{H}}
m
n
{\bm{S}}
{\bm{a}}
{\bm{b}}
m
{\bm{C}}
m\times m
{{\bm{a}}}^{\top}{\bm{C}}{\bm{b}}={\vec{\mathbf{1}}\;}^{\top}[({\bm{a}}{\bm{b}%
}^{\top})\odot{\bm{C}}]\;\vec{\mathbf{1}}
\vec{\mathbf{1}}
m
{\bm{S}}
{\bm{G}}
{\bm{Q}}={\bm{G}}{\bm{W}}{\bm{G}}^{\top}
{\bm{Q}}
\displaystyle{\bm{Q}}_{i,j}={\bm{G}}_{i,:}\cdot{\bm{W}}\cdot({\bm{G}}_{j,:})^{\top}
\displaystyle{\bm{Q}}_{i,j}
\displaystyle={\bm{G}}_{i,:}\cdot{\bm{W}}\cdot({\bm{G}}_{j,:})^{\top}
\displaystyle={\vec{\mathbf{1}}\;}^{\top}\big{[}\big{(}({\bm{G}}_{i,:})^{\top}%
{\bm{G}}_{j,:}\big{)}\odot{\bm{W}}\big{]}\;\vec{\mathbf{1}}
\displaystyle={\vec{\mathbf{1}}\;}^{\top}\big{[}\big{(}({\bm{G}}_{i,:})^{\top}%
{\bm{G}}_{j,:}\big{)}\odot{\bm{W}}\big{]}\;\vec{\mathbf{1}}
\displaystyle=\sum_{0\leqslant u,v\leqslant n-1}({\bm{G}}_{i,u}\cdot{\bm{G}}_{%
j,v}\cdot{\bm{W}}_{u,v})
\displaystyle=\sum_{0\leqslant u,v\leqslant n-1}({\bm{G}}_{i,u}\cdot{\bm{G}}_{%
j,v}\cdot{\bm{W}}_{u,v})
0\leqslant i,j\leqslant m-1
{\bm{S}}
{\bm{S}}_{i,j,u,v}={\bm{G}}_{i,u}\cdot{\bm{G}}_{j,v}
0\leqslant i,j\leqslant m-1,0\leqslant u,v\leqslant n-1
{\bm{Q}}
{\bm{O}}
{\bm{O}}={\bm{A}}^{\top}[{\bm{Q}}\odot({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})]{\bm%
{A}}
{\bm{O}}_{x,y}
{\bm{O}}_{x,y}=({\bm{A}}_{:,x})^{\top}[{\bm{Q}}\odot({\bm{B}}^{\top}{\bm{I}}\;%
{\bm{B}})]{\bm{A}}_{:,y}
0\leqslant x,y\leqslant m-n
{\bm{O}}_{x,y}={\vec{\mathbf{1}}\;}^{\top}[({\bm{A}}_{:,x}({\bm{A}}_{:,y})^{%
\top})\odot{\bm{Q}}\odot({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})]\;\vec{\mathbf{1}}
{\bm{V}}=({\bm{A}}_{:,x}({\bm{A}}_{:,y})^{\top})\odot{\bm{Q}}\odot({\bm{B}}^{%
\top}{\bm{I}}\;{\bm{B}})
\displaystyle{\bm{V}}_{i,j}=({\bm{A}}_{i,x}{\bm{A}}_{j,y})\cdot{\bm{Q}}_{i,j}%
\cdot({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})_{i,j}
\displaystyle{\bm{V}}_{i,j}
\displaystyle=({\bm{A}}_{i,x}{\bm{A}}_{j,y})\cdot{\bm{Q}}_{i,j}\cdot({\bm{B}}^%
{\top}{\bm{I}}\;{\bm{B}})_{i,j}
0\leqslant i,j\leqslant m-1
({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})_{i,j}
\displaystyle({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})_{i,j}=({\bm{B}}_{:,i})^{\top}%
{\bm{I}}\;{\bm{B}}_{:,j}
\displaystyle({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})_{i,j}
\displaystyle=({\bm{B}}_{:,i})^{\top}{\bm{I}}\;{\bm{B}}_{:,j}
\displaystyle={\vec{\mathbf{1}}\;}^{\top}[({\bm{B}}_{:,i}({\bm{B}}_{:,j})^{%
\top})\odot{\bm{I}}]\;\vec{\mathbf{1}}
\displaystyle={\vec{\mathbf{1}}\;}^{\top}[({\bm{B}}_{:,i}({\bm{B}}_{:,j})^{%
\top})\odot{\bm{I}}]\;\vec{\mathbf{1}}
\displaystyle=\sum_{0\leqslant s,t\leqslant m-1}[{({\bm{B}}_{s,i}{\bm{B}}_{t,j%
})\cdot{\bm{I}}_{s,t}}]
\displaystyle=\sum_{0\leqslant s,t\leqslant m-1}[{({\bm{B}}_{s,i}{\bm{B}}_{t,j%
})\cdot{\bm{I}}_{s,t}}]
\displaystyle{\bm{O}}_{x,y}=\sum_{0\leqslant i,j\leqslant m-1}{{\bm{V}}_{i,j}}
\displaystyle{\bm{O}}_{x,y}
\displaystyle=\sum_{0\leqslant i,j\leqslant m-1}{{\bm{V}}_{i,j}}
\displaystyle=\sum_{0\leqslant i,j\leqslant m-1}{[({\bm{A}}_{i,x}{\bm{A}}_{j,y%
})\cdot{\bm{Q}}_{i,j}\cdot({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})_{i,j}]}
\displaystyle=\sum_{0\leqslant i,j\leqslant m-1}{[({\bm{A}}_{i,x}{\bm{A}}_{j,y%
})\cdot{\bm{Q}}_{i,j}\cdot({\bm{B}}^{\top}{\bm{I}}\;{\bm{B}})_{i,j}]}
\displaystyle=\sum_{0\leqslant i,j\leqslant m-1}{\Big{[}({\bm{A}}_{i,x}{\bm{A}%
}_{j,y})\cdot{\bm{Q}}_{i,j}\cdot\sum_{0\leqslant s,t\leqslant m-1}[{({\bm{B}}_%
{s,i}{\bm{B}}_{t,j})\cdot{\bm{I}}_{s,t}}]\Big{]}}
\displaystyle=\sum_{0\leqslant i,j\leqslant m-1}{\Big{[}({\bm{A}}_{i,x}{\bm{A}%
}_{j,y})\cdot{\bm{Q}}_{i,j}\cdot\sum_{0\leqslant s,t\leqslant m-1}[{({\bm{B}}_%
{s,i}{\bm{B}}_{t,j})\cdot{\bm{I}}_{s,t}}]\Big{]}}
\displaystyle=\sum_{0\leqslant i,j,s,t\leqslant m-1}{[({\bm{A}}_{i,x}{\bm{A}}_%
{j,y}{\bm{B}}_{s,i}{\bm{B}}_{t,j})\cdot{\bm{Q}}_{i,j}\cdot{\bm{I}}_{s,t}]}
\displaystyle=\sum_{0\leqslant i,j,s,t\leqslant m-1}{[({\bm{A}}_{i,x}{\bm{A}}_%
{j,y}{\bm{B}}_{s,i}{\bm{B}}_{t,j})\cdot{\bm{Q}}_{i,j}\cdot{\bm{I}}_{s,t}]}
{\bm{H}}
{\bm{H}}_{x,y,i,j,s,t}={\bm{A}}_{i,x}{\bm{A}}_{j,y}{\bm{B}}_{s,i}{\bm{B}}_{t,j}
0\leqslant x,y\leqslant m-n,0\leqslant i,j,s,t\leqslant m-1
i
i
i
i
i
t^{spatial}_{i}
t^{spatial,\;2\%\;loss}_{i}
i
t^{spatial}_{i}=\beta\cdot t^{spatial,\;2\%\;loss}_{i}
\beta
\beta
5
{\bm{Q}}
6\times 6
