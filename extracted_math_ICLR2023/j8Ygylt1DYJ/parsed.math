k
x
k
k
k
k
k
k
k
k
\rho
\tau
k
3
k
3
k
\ell_{\infty}
k=1000
k
3
k
3
k
\ell_{\infty}
k=1000
k
k
k
3\times 3
5\times 5
k
k=1000
k
k
k
k
k
k
k
3\times 3
5\times 5
k
k=1000
k
k
k
k
k
a_{ij}(x)
(i,j)
x
S_{k}(x)
k
N_{w}(i,j)=\{(p,q)\;:\;i-w\leq p\leq i+w,~{}j-w\leq q\leq j+w\}
(2w+1)\times(2w+1)
(i,j)
N_{w}(S_{k}(x))
\bigcup_{(i,j)\in S_{k}(x)}N_{w}(i,j)
(2w+1)\times(2w+1)
k
\mathrm{Att}(\cdot)
T_{k}=S_{k}(x+\mathrm{Att}(x))
k
\mathrm{Att}(x)
k
\left|S_{k}(x)\cap T_{k}(x)\right|/k
k
k
\left|N_{w}(S_{k}(x))\cap T_{k}(x)\right|/k
\left|S_{k}(x)\cap N_{w}(T_{k}(x))\right|/k
\rho
\tau
\tilde{a}_{ij}(x)
\tilde{a}_{ij}(x+\mathrm{Att}(x))
k
k
\mathbf{a}_{1}
\mathbf{a}_{2}
S_{k}
T_{k}
k
\mathbf{a}_{1}
\mathbf{a}_{2}
k
\mathbf{a}_{1}
\mathbf{a}_{2}
d_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})\overset{\text{def}}{=}\text{prec}_{%
k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})+\text{recall}_{k}^{(w)}(\mathbf{a}_{1}%
,\mathbf{a}_{2})
\text{prec}_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})\overset{\text{def}}{=}%
\frac{\left|S_{k}\setminus N_{w}(T_{k})\right|}{k}\quad\text{and}
\quad\text{recall}_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})\overset{\text{def}%
}{=}\frac{\left|T_{k}\setminus N_{w}(S_{k})\right|}{k},
d_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})
k
w_{1}\leq w_{2}
d_{k}^{(w_{2})}(\mathbf{a}_{1},\mathbf{a}_{2})\leq d_{k}^{(w_{1})}(\mathbf{a}_%
{1},\mathbf{a}_{2})\leq\left|S_{k}\triangle T_{k}\right|/k
\triangle
A\triangle B=(A\setminus B)\cup(B\setminus A)
d_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})
k
w
d(\mathbf{a}_{1},\mathbf{a}_{2})=\sum_{k=1}^{\infty}\alpha_{k}\sum_{w=0}^{%
\infty}\beta_{w}~{}d_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2}),
\alpha_{k}
\beta_{w}
k
w
\sum_{k}\alpha_{k}<\infty
\sum_{w}\beta_{w}<\infty
k
d(\mathbf{a}_{1},\mathbf{a}_{2})
u(\mathbf{a}_{1},\mathbf{a}_{2})
u(\mathbf{a}_{1},\mathbf{a}_{2})=\sum_{k=1}^{\infty}\alpha_{k}\sum_{w=0}^{%
\infty}\beta_{w}~{}\frac{\left|S_{k}\triangle T_{k}\right|}{k},
u(\mathbf{a}_{1},\mathbf{a}_{2})
k
\rho
\tau
a_{ij}(x)
w
\tilde{a}_{ij}^{(w)}(x)=\frac{1}{(2w+1)^{2}}\sum_{\begin{subarray}{c}(p,q)\in N%
_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}a_{pq}(x)
w
\ell_{2}
x,y
w\geq 0
\left\|\tilde{\mathbf{a}}^{(w)}(x)-\tilde{\mathbf{a}}^{(w)}(y)\right\|_{2}\leq%
\left\|\mathbf{a}(x)-\mathbf{a}(y)\right\|_{2}
\ell_{2}
w
x
f
\nabla_{x}(f)
\nabla_{y}(f)
x
y
\ell_{2}
\left\|x-y\right\|_{2}\leq\delta
\left\|\nabla_{x}(f)-\nabla_{y}(f)\right\|_{2}\lesssim\delta~{}\lambda_{\text{%
max}}(H_{x}(f))
H_{x}(f)
f
x
\lambda_{\text{max}}(H_{x}(f))
w
\left\|\tilde{\nabla}_{x}^{(w)}(f)-\tilde{\nabla}_{y}^{(w)}(f)\right\|_{2}%
\lesssim\delta~{}\lambda_{\text{max}}(H_{x}(f))
k
w\text{-LENS-prec@}k
w\text{-LENS-recall@}k
1-\text{prec}_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})
1-\text{recall}_{k}^{(w)}(\mathbf{a}_{1},\mathbf{a}_{2})
\mathbf{a}_{1}
\mathbf{a}_{2}
\tau
\rho
w
w
\tau
\rho
w
\tilde{\mathbf{a}}^{(w)}
\mathbf{a}
w
k
w
k
w
k
t
\ell_{\infty}
\delta=0.3
\delta=0.1
\delta=8/255
t
t
t=200
t=100
t=1000
k
k=100
k=1000
k
1
k
1
k
k
1
k
1
k
1
k
2
90\%
k
40\%
k
<
k
k
k
1
k
1
k
t
k
1
k
1
k
t
w
w
k
w
k
k
k
w
w
k
w
k
k
k
w
k
w
w
k
w
t
t
t
w
k
1
k
k
1
k
k
k
k
k
k
k
3\times 3
5\times 5
k
k=1000
k
1
k
1
k
2
k
2
k
k
k
3\times 3
5\times 5
k
k=1000
k
1
k
1
k
2
k
2
k
k
k
w
S\leftarrow\emptyset
k
S
S
(2w+1)\times(2w+1)
k
(2w+1)\times(2w+1)
k
k
(2w+1)\times(2w+1)
k
w
k
w
k
(2w+1)\times(2w+1)
k
\tilde{S}_{k}(x)
k
x
\tilde{T}_{k}=\tilde{S}_{k}(x+\text{Att}(x))
\tilde{S_{k}}
\tilde{T}_{k}
S_{k}
T_{k}
k=1000
k
k
(2w+1)\times(2w+1)
w=\{1,2\}
k
0
k
0
k
k
k
2
k
w
w
k
k
k
k
k
k
k
1
k
1
k
t
k
0
k
0
k
k
1
k
1
k
t
k
0
k
0
k
k
1
k
1
k
k
1
k
1
1
k
\ell_{\infty}
\ell_{1}
k
k
k
k
k
k
k
k
\times
\times
k
k
k
k
k
k
k
k
\ell_{\infty}
k
k
k
\pm 1
\ell_{\infty}
\epsilon=0.3
k
k
k
k
\pm 1
\ell_{\infty}
\epsilon=0.3
k
k
k
k
k
\rho
\tau
k
\rho
\tau
k=100
k=1000
k
\rho
\tau
k=100
k=1000
70,000
28\times 28
10
60,000
10,000
70,000
28\times 28
10
60,000
10,000
51,739
32\times 32
43
34,699
4,410
12,630
1,360
128\times 128
17
1,224
136
227\times 227
1000
50,000
k
\rho
\tau
k
k
k
\epsilon
\ell_{\infty}
\epsilon=8/255
w_{1}\leq w_{2}
d_{k}^{(w_{2})}(\mathbf{a}_{1},\mathbf{a}_{2})\leq d_{k}^{(w_{1})}(\mathbf{a}_%
{1},\mathbf{a}_{2})\leq\left|S_{k}\triangle T_{k}\right|/k
\triangle
A\triangle B=(A\setminus B)\cup(B\setminus A)
S\subseteq N_{w_{1}}(S)\subseteq N_{w_{2}}(S)
S
\left|S\setminus N_{w}(T)\right|\leq\left|S\setminus T\right|
S,T
w
d(\mathbf{a}_{1},\mathbf{a}_{2})
u(\mathbf{a}_{1},\mathbf{a}_{2})
u(\mathbf{a}_{1},\mathbf{a}_{2})=\sum_{k=1}^{\infty}\alpha_{k}\sum_{w=0}^{%
\infty}\beta_{w}~{}\frac{\left|S_{k}\triangle T_{k}\right|}{k},
u(\mathbf{a}_{1},\mathbf{a}_{2})
x,y
w\geq 0
\left\|\tilde{\mathbf{a}}^{(w)}(x)-\tilde{\mathbf{a}}^{(w)}(y)\right\|_{2}\leq%
\left\|\mathbf{a}(x)-\mathbf{a}(y)\right\|_{2}
\left\|\tilde{\mathbf{a}}^{(w)}(x)-\tilde{\mathbf{a}}^{(w)}(y)\right\|_{2}^{2}
\displaystyle=\sum_{1\leq i,j\leq n}\left(\tilde{a}_{ij}^{(w)}(x)-\tilde{a}_{%
ij}^{(w)}(y)\right)^{2}
\displaystyle=\sum_{1\leq i,j\leq n}\left(\tilde{a}_{ij}^{(w)}(x)-\tilde{a}_{%
ij}^{(w)}(y)\right)^{2}
\displaystyle=\sum_{1\leq i,j\leq n}\frac{1}{(2w+1)^{4}}\left(\sum_{\begin{%
subarray}{c}(p,q)\in N_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}\left(a_{pq}(x)-a_{pq}(y)\right)\right)^{2}
\displaystyle=\sum_{1\leq i,j\leq n}\frac{1}{(2w+1)^{4}}\left(\sum_{\begin{%
subarray}{c}(p,q)\in N_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}\left(a_{pq}(x)-a_{pq}(y)\right)\right)^{2}
\displaystyle\leq\sum_{1\leq i,j\leq n}\frac{(2w+1)^{2}}{(2w+1)^{4}}\sum_{%
\begin{subarray}{c}(p,q)\in N_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}\left(a_{pq}(x)-a_{pq}(y)\right)^{2}~{}
\displaystyle\leq\sum_{1\leq i,j\leq n}\frac{(2w+1)^{2}}{(2w+1)^{4}}\sum_{%
\begin{subarray}{c}(p,q)\in N_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}\left(a_{pq}(x)-a_{pq}(y)\right)^{2}~{}
\displaystyle=\frac{1}{(2w+1)^{2}}\sum_{1\leq i,j\leq n}\sum_{\begin{subarray}%
{c}(p,q)\in N_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}\left(a_{pq}(x)-a_{pq}(y)\right)^{2}
\displaystyle=\frac{1}{(2w+1)^{2}}\sum_{1\leq i,j\leq n}\sum_{\begin{subarray}%
{c}(p,q)\in N_{w}(i,j),\\
1\leq p,q\leq n\end{subarray}}\left(a_{pq}(x)-a_{pq}(y)\right)^{2}
\displaystyle\leq\frac{(2w+1)^{2}}{(2w+1)^{2}}\sum_{1\leq p,q\leq n}\left(a_{%
pq}(x)-a_{pq}(y)\right)^{2}
\displaystyle\leq\frac{(2w+1)^{2}}{(2w+1)^{2}}\sum_{1\leq p,q\leq n}\left(a_{%
pq}(x)-a_{pq}(y)\right)^{2}
(p,q)
(2w+1)^{2}
N_{w}(i,j)
\displaystyle=\left\|\mathbf{a}(x)-\mathbf{a}(y)\right\|_{2}^{2}.
\displaystyle=\left\|\mathbf{a}(x)-\mathbf{a}(y)\right\|_{2}^{2}.
k
k
1
k
k
k
1
k
k
k
k
t
t
k
k
k
k
k
1
k
k
k
k
1
k
k
k
k
k
k
k
k
k
k
k
k
1
k
k
k
k
1
k
k
k
k
k
k
k
k
k
k
k
k
k
k
1
k
k
k
k
1
k
k
k
\rho
1
\tau
1
t
\rho
1
\tau
1
t
\tau
\rho
1
1
k
\tau
\rho
1
1
k
\rho
\tau
1
1
\rho
\tau
1
1
1
\tau
\rho
1
1
\rho
\tau
1
k
k
k
1
k
1
k
k\times k
k
k
1
k
k
1
k
k
1
k
1
k
k
k
1
k
1
k
k
k
1
k
1
k
k
1
k
1
k
k
1
k
1
k
k
1
k
1
k
k
k
k
w
k
k
w
k
w
k
k
w
k
1
k
1
k
k
k
1
k
1
k
k
k
1
k
1
k
k
1
k
1
k
k
1
k
1
k
k
1
k
1
k
k
k
k
w
k
k
w
k
w
k
k
w
k
3
k
3
k
k=1000
\ell_{\infty}
k
3
k
3
k
k=1000
\ell_{\infty}
k
w
k
w
k
k
w
k
w
k
\times
k
w
k
w
k
\times
\times
k
w
k
w
k
\times
k
w
k
w
k
k
w
k
w
k
w
w
k
w
k
w
w
k
w
k
k
w
k
w
k
k
w
k
w
k
k
w
k
w
k
k
w
k
w
k
\times
\times
k
w
k
w
k
w
k
w
k
k
w
k
w
k
k
k
k
k
k
k
k
k
k
k
k
w
k
k
k
w
k
k
k
k
k
k
k
k
k
k
k
w
k
k
k
w
k
k
3{\times}3
3{\times}3
5{\times}5
5{\times}5
3{\times}3
3{\times}3
5{\times}5
5{\times}5
k
\times
\times
k
k
\times
\times
k
k
k
\times
k
k
\times
k
k
k
k
w
w
k
k
3\times 3
k
k
k
k
\times
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
\times
\times
\times
\times
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
\times
\times
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
k
\epsilon
k
k
k
k
\epsilon=8/255
k
k
k
k
k
\epsilon=8/255
\epsilon=8/255
k
k
k
\epsilon=8/255
k
k
k
k
k
