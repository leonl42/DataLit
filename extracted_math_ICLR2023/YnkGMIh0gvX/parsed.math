\mathrm{AUROC}_{\mathrm{f}}
\mathrm{AUROC}_{\mathrm{f}}
\rightarrow\quad
\rightarrow\quad
\rightarrow\quad
\{(x_{i},y_{\mathrm{cl},i})\}_{i=1}^{N}
N
(x_{i},y_{\mathrm{cl},i})
\mathcal{X}\times\mathcal{Y}
y_{\mathrm{cl}}
(m,g)
g:\mathcal{X}\rightarrow\mathbb{R}
m(\cdot,w):\mathcal{X}\rightarrow\mathcal{Y}
w
(m,g)(x):=\begin{cases}P_{m}(y_{\mathrm{cl}}|x,w),&\text{if }g(x)\geq\tau\\
\text{filter},&\text{otherwise.}\end{cases}
g(x)
\tau
g(x)
y_{\mathrm{f}}(x,w,y)=\mathbb{I}(y_{\mathrm{cl}}\neq\hat{y}_{m}(x,w)),
\hat{y}_{m}=\mathrm{argmax}_{c\in\mathcal{Y}}P_{m}(y_{\mathrm{cl}}=c|x,w)
\mathbb{I}
g(x)
g(x)
\mathrm{AUROC}_{\mathrm{f}}
\mathrm{AUROC}_{\mathrm{f}}
1-\mathrm{Accuracy}
40\%
\bm{*10^{3}}
\downarrow
\bm{*10^{3}}
\downarrow
\mathrm{AUROC}_{\mathrm{f}}
\mathrm{AUROC}_{\mathrm{f}}
*100\downarrow
*10^{3}\downarrow
\mathrm{AUROC}_{f}*100\uparrow
*100\uparrow
\mathrm{AUROC}_{\mathrm{f}}
\mathrm{AUROC}_{\mathrm{f}}
[0,1]
\mathrm{AUROC}_{\mathrm{f}}
\mathrm{AUROC}_{\mathrm{f}}
9\%
5.47\%
\mathrm{AUROC}_{\mathrm{f}}
y_{\mathrm{cl}}
y_{\mathrm{f}}
\{(x_{i},y_{\mathrm{cl},i})\}_{i=1}^{N}
N
(x_{i},y_{\mathrm{cl},i})
\mathcal{X}\times\mathcal{Y}
y_{\mathrm{cl}}\in\mathcal{Y}=\{0,1,2,...,n_{\mathrm{classes}}-1\}
m(\cdot,w):\mathcal{X}\rightarrow\mathcal{Y}
x
\hat{y}
w
\hat{y}_{m,i}
P_{m}(y_{\mathrm{cl}}|x,w)\in[0,1]^{n_{\mathrm{classes}}}
\hat{y}_{m}=\operatorname*{arg\,max}_{c\in\mathcal{Y}}P_{m}(y_{\mathrm{cl}}=c|%
x,w),
c\in\{0,...n_{\mathrm{classes}}-1\}
\operatorname*{arg\,max}_{c\in Y}P_{m}(y=c|x_{i},w)
\mathrm{Accuracy}=\frac{1}{N}\sum_{i}^{N}\mathbb{I}(y_{\mathrm{cl},i}=\hat{y}_%
{m,i}),
\mathbb{I}(\mathrm{Event})
\mathbb{I}(\mathrm{Event}):=\begin{cases}1,&\text{if the event Event occurs}\\
0,&\text{otherwise.}\end{cases}
y_{c}\in[0,1]
y_{c}=\mathbb{I}(y_{\mathrm{cl}}=c).
y_{c,i}=\mathbb{I}(y_{\mathrm{cl},i}=c)
i
c
\mathrm{TP}_{\mathrm{cl}}(\theta,c)=\sum_{i}^{N}y_{c,i}\cdot\mathbb{I}(P_{m}(y%
_{\mathrm{cl}}=c|x_{i},w)\geq\theta)
\mathrm{FP}_{\mathrm{cl}}(\theta,c)=\sum_{i}^{N}(1-y_{c,i})\cdot\mathbb{I}(P_{%
m}(y_{\mathrm{cl}}=c|x_{i},w)\geq\theta)
\mathrm{TN}_{\mathrm{cl}}(\theta,c)=\sum_{i}^{N}(1-y_{c,i})\cdot\mathbb{I}(P_{%
m}(y_{\mathrm{cl}}=c|x_{i},w)<\theta)
\mathrm{FN}_{\mathrm{cl}}(\theta,c)=\sum_{i}^{N}y_{c,i}\cdot\mathbb{I}(P_{m}(y%
_{\mathrm{cl}}=c|x_{i},w)<\theta).
\theta
c
\mathrm{Sensitivity}_{\mathrm{cl}}(\theta,c)=\frac{\mathrm{TP}_{\mathrm{cl}}(%
\theta,c)}{\mathrm{TP}_{\mathrm{cl}}(\theta,c)+\mathrm{FN}_{\mathrm{cl}}(%
\theta,c)}
\mathrm{FPR}_{\mathrm{cl}}(\theta,c)=\frac{\mathrm{FP}_{\mathrm{cl}}(\theta,c)%
}{\mathrm{TN}_{\mathrm{cl}}(\theta,c)+\mathrm{FP}_{\mathrm{cl}}(\theta,c)}
\mathrm{Precision}_{\mathrm{cl}}(\theta,c)=\frac{\mathrm{TP}_{\mathrm{cl}}(%
\theta,c)}{\mathrm{TP}_{\mathrm{cl}}(\theta,c)+\mathrm{FP}_{\mathrm{cl}}(%
\theta,c)}.
\theta
\{\theta_{t}\}_{t=0}^{T}
T
\begin{split}\mathrm{AUROC}_{\mathrm{cl}}(c)=&\sum_{t=1}^{T}\dfrac{1}{2}(%
\mathrm{FPR}_{\mathrm{cl}}(\theta_{t},c)-\mathrm{FPR}_{\mathrm{cl}}(\theta_{(t%
-1)},c))\\
&\cdot(\mathrm{Sensitivity}_{\mathrm{cl}}(\theta_{t},c)+\mathrm{Sensitivity}_{%
\mathrm{cl}}(\theta_{(t-1)},c)).\end{split}
\begin{split}AP_{\mathrm{cl}}(c)=&\sum_{t=1}^{T}(\mathrm{Sensitivity}_{\mathrm%
{cl}}(\theta_{t},c)-\mathrm{Sensitivity}_{\mathrm{cl}}(\theta_{(t-1)},c))\cdot%
\mathrm{Precision}_{\mathrm{cl}}(\theta_{t},c).\\
\end{split}
c
\tau
\mathrm{TP}_{\mathrm{f}}(\tau)=\sum_{i}^{N}(1-y_{\mathrm{f},i})\cdot\mathbb{I}%
(g(x_{i})\geq\tau)
\mathrm{FP}_{\mathrm{f}}(\tau)=\sum_{i}^{N}y_{\mathrm{f},i}\cdot\mathbb{I}(g(x%
_{i})\geq\tau)
\mathrm{TN}_{\mathrm{f}}(\tau)=\sum_{i}^{N}y_{\mathrm{f},i}\cdot\mathbb{I}(g(x%
_{i})<\tau)
\mathrm{FN}_{\mathrm{f}}(\tau)=\sum_{i}^{N}(1-y_{\mathrm{f},i})\cdot\mathbb{I}%
(g(x_{i})<\tau).
\mathrm{Sensitivity}_{\mathrm{f}}(\tau)=\frac{\mathrm{TP}_{\mathrm{f}}(\tau)}{%
\mathrm{TP}_{\mathrm{f}}(\tau)+\mathrm{FN}_{\mathrm{f}}(\tau)}
\mathrm{FPR}_{\mathrm{f}}(\tau)=\frac{\mathrm{FP}_{\mathrm{f}}(\tau)}{\mathrm{%
TN}_{\mathrm{f}}(\tau)+\mathrm{FP}_{\mathrm{f}}(\tau)}
\mathrm{Precision}_{\mathrm{f}}(\tau)=\frac{\mathrm{TP}_{\mathrm{f}}(\tau)}{%
\mathrm{TP}_{\mathrm{f}}(\tau)+\mathrm{FP}_{\mathrm{f}}(\tau)}.
\{\tau_{t}\}_{t=0}^{T}
T
\begin{split}\mathrm{AUROC}_{f}=&\sum_{t=1}^{T}(\mathrm{FPR}_{\mathrm{f}}(\tau%
_{t})-\mathrm{FPR}_{\mathrm{f}}(\tau_{(t-1)}))\cdot(\mathrm{Sensitivity}_{%
\mathrm{f}}(\tau_{t})+\mathrm{Sensitivity}_{\mathrm{f}}(\tau_{(t-1)}))/2\\
=&\sum_{t=1}^{T}\frac{\sum_{i}^{N}y_{\mathrm{f},i}\cdot(\mathbb{I}(g(x_{i})%
\geq\tau_{t})-\mathbb{I}(g(x_{i})\geq\tau_{(t-1)}))}{\sum_{i}^{N}y_{\mathrm{f}%
,i}}\\
&\cdot\frac{\sum_{i}^{N}(1-y_{\mathrm{f},i})\cdot(\mathbb{I}(g(x_{i})\geq\tau_%
{t})+\mathbb{I}(g(x_{i})\geq\tau_{(t-1)})}{2\cdot\sum_{i}^{N}(1-y_{\mathrm{f},%
i})},\end{split}
\begin{split}\mathrm{AP}_{f}=&\sum_{t=1}^{T}(\mathrm{Sensitivity}_{\mathrm{f}}%
(\tau_{t})-\mathrm{Sensitivity}_{\mathrm{f}}(\tau_{t-1)}))\cdot\mathrm{%
Precision}_{\mathrm{f}}(\tau_{t})\\
=&\sum_{t=1}^{T}\frac{\sum_{i}^{N}(1-y_{\mathrm{f},i})\cdot(\mathbb{I}(g(x_{i}%
)\geq\tau_{t})-\mathbb{I}(g(x_{i})\geq\tau_{(t-1)}))}{\sum_{i}^{N}(1-y_{%
\mathrm{f},i})}\cdot\frac{\sum_{i}^{N}(1-y_{\mathrm{f},i})\cdot\mathbb{I}(g(x_%
{i})\geq\tau_{t})}{\sum_{i}^{N}\mathbb{I}(g(x_{i})\geq\tau_{t})}.\end{split}
\begin{split}\mathrm{AP}_{\mathrm{f},err}=&\sum_{t=1}^{T}\frac{\sum_{i}^{N}y_{%
\mathrm{f},i}\cdot(\mathbb{I}(g(x_{i})<\tau_{t})-\mathbb{I}(g(x_{i})<\tau_{(t-%
1)}))}{\sum_{i}^{N}y_{\mathrm{f},i}}\cdot\frac{\sum_{i}^{N}y_{\mathrm{f},i}%
\cdot\mathbb{I}(g(x_{i})<\tau_{t})}{\sum_{i}^{N}\mathbb{I}(g(x_{i})<\tau_{t})}%
.\end{split}
(1-y_{\mathrm{f},i})
y_{\mathrm{f}}=0
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
y_{\mathrm{out}}
y_{\mathrm{out}}=1
y_{\mathrm{out}}=0
\begin{split}\mathrm{AUROC}_{\mathrm{out}}=&\sum_{t}^{T}(\mathrm{FPR}_{\mathrm%
{out}}(\tau_{t})-\mathrm{FPR}_{\mathrm{out}}(\tau_{(t-1)}))\cdot(\mathrm{%
Sensitivity}_{\mathrm{out}}(\tau_{t})+\mathrm{Sensitivity}_{\mathrm{out}}(\tau%
_{(t-1)}))/2\\
=&\sum_{t}^{T}\frac{\sum_{i}^{N}(1-y_{\mathrm{out},i})\cdot(\mathbb{I}(g(x_{i}%
)\geq\tau_{t})-\mathbb{I}(g(x_{i})\geq\tau_{(t-1)}))}{\sum_{i}^{N}(1-y_{%
\mathrm{out},i})}\cdot\\
&\frac{\sum_{i}^{N}(y_{\mathrm{out},i})\cdot(\mathbb{I}(g(x_{i})\geq\tau_{t})+%
\mathbb{I}(g(x_{i})\geq\tau_{(t-1)})}{2\cdot\sum_{i}^{N}y_{\mathrm{out},i}}.%
\end{split}
\tau_{t}
y_{\mathrm{out}}
\mathrm{NLL}=-\frac{1}{N}\sum_{i}^{N}\mathrm{log}(P_{m}(y_{\mathrm{cl}}=y_{%
\mathrm{cl},i}|x_{i},w)),
\mathrm{BrierScore}=\frac{1}{N}\sum_{i}^{N}\sum_{c}^{\mathcal{Y}}(P_{m}(y_{%
\mathrm{cl}}=c|x_{i},w)-y_{c,i})^{2}.
\mathrm{Risk}(\tau)=1-\mathrm{Precision}_{\mathrm{f}}(\tau)=\frac{\mathrm{FP}_%
{\mathrm{f}}(\tau)}{\mathrm{TP}_{\mathrm{f}}(\tau)+\mathrm{FP}_{\mathrm{f}}(%
\tau)}=\frac{\sum_{i}^{N}y_{\mathrm{f},i}\cdot\mathbb{I}(g(x_{i})\geq\tau)}{%
\sum_{i}^{N}\mathbb{I}(g(x_{i})\geq\tau)}
\mathrm{Coverage}(\tau)=\frac{\mathrm{TP}_{\mathrm{f}}(\tau)+\mathrm{FP}_{%
\mathrm{f}}(\tau)}{\mathrm{TP}_{\mathrm{f}}(\tau)+\mathrm{FP}_{\mathrm{f}}(%
\tau)+\mathrm{FN}_{\mathrm{f}}(\tau)+\mathrm{TN}_{\mathrm{f}}(\tau)}=\frac{%
\sum_{i}^{N}\mathbb{I}(g(x_{i})\geq\tau)}{N}
\tau
\begin{split}\mathrm{AURC}=&\sum_{t=1}^{T}(\mathrm{Coverage}(\tau_{t})-\mathrm%
{Coverage}(\tau_{(t-1)}))\cdot(\mathrm{Risk}(\tau_{t})+\mathrm{Risk}(\tau_{(t-%
1)}))/2\\
=&\sum_{t=1}^{T}\frac{\sum_{i}^{N}(\mathbb{I}(g(x_{i})\geq\tau_{t})-\mathbb{I}%
(g(x_{i})\geq\tau_{(t-1)}))}{N}\cdot\\
&\left(\frac{\sum_{i}^{N}y_{\mathrm{f},i}\cdot\mathbb{I}(g(x_{i})\geq\tau_{t})%
}{2\cdot\sum_{i}^{N}\mathbb{I}(g(x_{i})\geq\tau_{t})}+\frac{\sum_{i}^{N}y_{%
\mathrm{f},i}\cdot\mathbb{I}(g(x_{i})\geq\tau_{(t-1)})}{2\cdot\sum_{i}^{N}%
\mathbb{I}(g(x_{i})\geq\tau_{(t-1)})}\right)\end{split}
\tau_{t}
\text{e-AURC}=\mathrm{AURC}+(1-\mathrm{Risk}(\tau_{0}))\cdot\log(1-\mathrm{%
Risk}(\tau_{0}))=\mathrm{AURC}-\mathrm{Accuray}\cdot\log(\mathrm{Accuracy}),
\mathrm{Risk}(\tau_{0})=(1-\mathrm{Prevalence}_{\mathrm{f}})
\mathrm{Prevalence}_{\mathrm{f}}
m
(1-y_{\mathrm{f},i})
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
80\%
risk>0.8
20\%
5\%
1/n_{classes}
1/n_{classes}
0.11
r^{*}
\delta
\delta
\tau
\bm{\mathrm{P}}_{S_{i}}\left\{R(m,g)>r^{*}\right\}<\delta,
\delta
r^{*}
R
S_{i}
m
g
\tau
\delta
r*
0.15
Risk-r*
\delta
\tau
\delta
r*
0.15
Risk-r*
\delta
10^{-4}
10^{-6}
10^{-2}
15*10^{-4}
10^{-1}
5*10^{-4}
10^{-1}
5*10^{-4}
10^{-3}
0
10^{-2}
10^{-2}
10^{-1}
10^{-4}
o
o=[2.2,3,6,10]
o
o=[12,15,20]
o=15
o
[3*10^{-2},10^{-2},3*10^{-3},10^{-3},3*10^{-4},10^{-4}]
0.1
o
o
3*10^{-2}
10^{-2}
10^{-2}
10^{-2}
10^{-2}
10^{-2}
3*10^{-4}
3*10^{-4}
10^{-2}
10^{-2}
10^{-2}
10^{-2}
3*10^{-3}
10^{-3}
10^{-3}
10^{-3}
3*10^{-3}
3*10^{-3}
10^{-3}
10^{-3}
10^{-3}
3*10^{-3}
10^{-3}
10^{-3}
3*10^{-3}
10^{-2}
10^{-3}
10^{-3}
\mathrm{AUROC}_{f}
[\%]
[\%]
\mathrm{AUROC_{f}}
[\%]
\mathrm{AUROC_{f}}
\mathrm{AUROC_{f}}
[\%]
\mathrm{AUROC_{f}}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AURC}
\rightarrow
\alpha
\mathrm{AUROC}_{f}
\rightarrow
\beta
\mathrm{AUROC}_{f}
\mathrm{AURC}
\rightarrow
\alpha
\mathrm{AUROC}_{f}
\rightarrow
\beta
\mathrm{AUROC}_{f}
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\mathrm{AUROC}_{f}
\rightarrow
\rightarrow
\mathrm{AUROC}_{f}
\rightarrow
\rightarrow
[0,1]
\theta
y
\mathcal{P}=\max_{c}P(y=c|\bm{x}^{*};\mathcal{D}),
c
\mathcal{H}[\mathrm{P}(y|\bm{x}^{*};\mathcal{D})]=-\sum_{c=1}^{C}P(y=c|\bm{x}^%
{*};\mathcal{D})\cdot\mathrm{ln}(P(y=c|\bm{x}^{*};\mathcal{D})
\max_{c}f(\bm{x}^{*},\mathcal{D}),
f
P(y|\bm{x}^{*},\mathcal{D})=\text{softmax}(f(\bm{x}^{*},\mathcal{D}))
\mathcal{P}=\max_{c}\mathbb{E}_{\mathrm{p(\text{\boldmath$\theta$}|\mathcal{D}%
)}}[\mathrm{P}(\omega_{c}|\bm{x}^{*};\text{\boldmath$\theta$})],
\theta
\mathcal{H}[\mathbb{E}_{\mathrm{p(\text{\boldmath$\theta$}|\mathcal{D})}}[%
\mathrm{P}(y|\bm{x}^{*};\text{\boldmath$\theta$})]],
\mathbb{E}_{\mathrm{p(\text{\boldmath$\theta$}|\mathcal{D})}}[\mathcal{H}[%
\mathrm{P}(y|\bm{x}^{*};\text{\boldmath$\theta$})]]
I(y;\text{\boldmath$\theta$}|)=\mathcal{H}[\mathbb{E}_{\mathrm{p(\text{%
\boldmath$\theta$}|\mathcal{D})}}[\mathrm{P}(y|\bm{x}^{*};\text{\boldmath$%
\theta$})]]-\mathbb{E}_{\mathrm{p(\text{\boldmath$\theta$}|\mathcal{D})}}[%
\mathcal{H}[\mathrm{P}(y|\bm{x}^{*};\text{\boldmath$\theta$})]]
\max_{c}\mathbb{E}_{\mathrm{p(\text{\boldmath$\theta$}|\mathcal{D})}}[f(\bm{x}%
^{*},\text{\boldmath$\theta$})],
f
P(y|\bm{x}^{*},\text{\boldmath$\theta$})=\text{softmax}(f(\bm{x}^{*},\text{%
\boldmath$\theta$}))
o
0.965
97.0
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}*100\uparrow
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}
\mathrm{AUROC}_{f}*100\uparrow
\mathrm{AUROC}_{f}*100\uparrow
\rightarrow
\pm
\pm
\rightarrow
\rightarrow
\rightarrow
\pm
\pm
\rightarrow
\rightarrow
