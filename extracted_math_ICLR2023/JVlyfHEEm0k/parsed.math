L
f_{\theta}\colon\bR^{d}\mapsto\bR^{k}
0pt_{l}
l
l\in[L-1]
L-1
\theta^{\body}
\phitop_{\theta^{\body}}\colon\bR^{d}\mapsto\bR^{0pt_{L-1}}
w\in\bR^{0pt_{L-1}\times k}
x\in\bR^{d}
f_{\theta}(x)=\phitop_{\theta^{\body}}(x)~{}w~{}.
L
N
\fmtl_{\thetamtl}\colon\bR^{d}\times[N]\mapsto\bR^{k}
x\in\bR^{d}
i\in[N]
\displaystyle\fmtl_{\thetamtl}(x,i)=\phitop_{\thetamtl^{\body}}(x)~{}\wmtl{i}
\displaystyle\fmtl_{\thetamtl}(x,i)=\phitop_{\thetamtl^{\body}}(x)~{}\wmtl{i}
\phi_{\thetamtl^{\body}}(x)
\thetamtl^{\body}
L-1
w_{i}
i
\thetamtl=\{\thetamtl^{\body}\}\cup\{\wmtl{i}\}_{i\in[N]}
N
N
n
i\in[N]
i
(X_{i},Y_{i})
X_{i}\in\bR^{n\times d}
Y_{i}\in\bR^{n\times k}
\ell
\displaystyle\min_{\thetamtl}\loss_{\mtl}(\thetamtl)\coloneqq\sum_{i\in[N]}%
\ell\left(\phitop_{\thetamtl^{\body}}(X_{i})~{}\wmtl{i},~{}Y_{i}\right)
\displaystyle\min_{\thetamtl}\loss_{\mtl}(\thetamtl)\coloneqq\sum_{i\in[N]}%
\ell\left(\phitop_{\thetamtl^{\body}}(X_{i})~{}\wmtl{i},~{}Y_{i}\right)
\phitop_{\thetamtl^{\body}}(X_{i})\coloneqq\big{(}\phitop_{\thetamtl}(x)\big{)%
}_{x\in[X_{i}]}\in\bR^{n\times 0pt_{L-1}}
N
n
\{X_{i},Y_{i}\}_{i=1}^{N}
\theta=\{\theta^{\body},w\}
\displaystyle\min_{\theta}\loss_{\anil}(\theta)\coloneqq\sum_{i\in[N]}\ell(%
\phitop_{\theta^{\body}}(X_{i})~{}w_{i}^{*},~{}Y_{i})
\displaystyle\min_{\theta}\loss_{\anil}(\theta)\coloneqq\sum_{i\in[N]}\ell(%
\phitop_{\theta^{\body}}(X_{i})~{}w_{i}^{*},~{}Y_{i})
\displaystyle\text{s.t. }w_{i}^{*}=~{}\innerloop(w,\phitop_{\theta^{\body}}(X_%
{i}),Y_{i},\tau,\lambda)
\displaystyle\text{s.t. }w_{i}^{*}=~{}\innerloop(w,\phitop_{\theta^{\body}}(X_%
{i}),Y_{i},\tau,\lambda)
\tau
w
\ell(\phitop_{\theta^{\body}}(X_{i})w,Y_{i})
\lambda
w
w
w
\displaystyle\min_{\theta^{\body}}\loss_{\anil}(\theta)\coloneqq\sum_{i\in[N]}%
\ell(\phitop_{\theta^{\body}}(X_{i})~{}w_{i}^{*},~{}Y_{i})
\displaystyle\min_{\theta^{\body}}\loss_{\anil}(\theta)\coloneqq\sum_{i\in[N]}%
\ell(\phitop_{\theta^{\body}}(X_{i})~{}w_{i}^{*},~{}Y_{i})
w_{i}^{*}
\task
(\xyxy)\in\bR^{n\times d}\times\bR^{n\times k}\times\bR^{n^{\prime}\times d}%
\times\bR^{n^{\prime}\times k}
(X,Y)
(X^{\prime},Y^{\prime})
\wtest
\wtest
(X^{\prime},Y^{\prime})
X
\thetamtl
X
\wtest
(X^{\prime},Y^{\prime})
\hat{\tau}
\displaystyle F_{\mtl}(\xxy)=\phitop_{\thetamtl^{\body}}(X)~{}\wtest^{*}
\displaystyle F_{\mtl}(\xxy)=\phitop_{\thetamtl^{\body}}(X)~{}\wtest^{*}
\displaystyle\text{s.t. }\wtest^{*}=\innerloop(\wtest,\phitop_{\thetamtl^{%
\body}}(X^{\prime}),Y^{\prime},\hat{\tau},\lambda)
\displaystyle\text{s.t. }\wtest^{*}=\innerloop(\wtest,\phitop_{\thetamtl^{%
\body}}(X^{\prime}),Y^{\prime},\hat{\tau},\lambda)
\wtest^{*}
\hat{\tau}
\wtest
\innerloop
\theta
X
\displaystyle F_{\anil}(\xxy)=\phitop_{\theta^{\body}}(X)~{}\wtest^{*}
\displaystyle F_{\anil}(\xxy)=\phitop_{\theta^{\body}}(X)~{}\wtest^{*}
\displaystyle\text{s.t. }\wtest^{*}=\innerloop(\wtest,\phitop_{\theta^{\body}}%
(X^{\prime}),Y^{\prime},\hat{\tau},\lambda)
\displaystyle\text{s.t. }\wtest^{*}=\innerloop(\wtest,\phitop_{\theta^{\body}}%
(X^{\prime}),Y^{\prime},\hat{\tau},\lambda)
1
\sim
10
\ell_{2}
\ell_{2}
\displaystyle\quad\min_{\theta^{\body}}~{}~{}\sum_{i\in[N]}\ell\big{(}\phitop_%
{\theta^{\body}}(X_{i})~{}w_{i}^{*},~{}Y_{i}\big{)}
\displaystyle\quad\min_{\theta^{\body}}~{}~{}\sum_{i\in[N]}\ell\big{(}\phitop_%
{\theta^{\body}}(X_{i})~{}w_{i}^{*},~{}Y_{i}\big{)}
\displaystyle\text{s.t.}~{}w_{i}^{*}=\argmin_{w_{i}}~{}\ell\big{(}\phitop_{%
\theta^{\body}}(X_{i})~{}w_{i},~{}Y_{i}\big{)}+R(w_{i})
\displaystyle\text{s.t.}~{}w_{i}^{*}=\argmin_{w_{i}}~{}\ell\big{(}\phitop_{%
\theta^{\body}}(X_{i})~{}w_{i},~{}Y_{i}\big{)}+R(w_{i})
\alpha\in\bR^{+}
\alpha\in\bR^{+}
\ell
R(w_{i})
\alpha\|w_{i}\|_{2}^{2}
\alpha\|w_{i}\|_{2}^{2}
\ell
R(w_{i})
\displaystyle\min_{\thetamtl^{\body},\{\wmtl{i}\}_{i=1}^{N}}\overbrace{\sum_{i%
\in[N]}\ell\left(\phitop_{\thetamtl^{\body}}(X_{i})~{}\wmtl{i},~{}Y_{i}\right)%
}^{\loss_{\mtl}(\thetamtl)}
\displaystyle\min_{\thetamtl^{\body},\{\wmtl{i}\}_{i=1}^{N}}\overbrace{\sum_{i%
\in[N]}\ell\left(\phitop_{\thetamtl^{\body}}(X_{i})~{}\wmtl{i},~{}Y_{i}\right)%
}^{\loss_{\mtl}(\thetamtl)}
\{\wmtl{i}\}_{i=1}^{N}
\thetamtl=\{\thetamtl^{\body}\}\cup\{\wmtl{i}\}_{i=1}^{N}
\displaystyle\min_{\theta^{\body}}\overbrace{\Big{[}\min_{\{w_{i}\}_{i=1}^{N}}%
\sum_{i\in[N]}\ell\Big{(}\phitop_{\theta^{\body}}(X_{i})~{}w_{i},Y_{i}\Big{)}+%
R(w_{i})\Big{]}}^{\loss_{\gbml}(\theta^{\body})}
\displaystyle\min_{\theta^{\body}}\overbrace{\Big{[}\min_{\{w_{i}\}_{i=1}^{N}}%
\sum_{i\in[N]}\ell\Big{(}\phitop_{\theta^{\body}}(X_{i})~{}w_{i},Y_{i}\Big{)}+%
R(w_{i})\Big{]}}^{\loss_{\gbml}(\theta^{\body})}
\{w_{i}\}_{i=1}^{N}
\theta^{\body}
\theta^{\body}
\ell_{\gbml}(\theta^{\body})
\{w_{i}\}_{i=1}^{N}
\theta^{\body}
\{w_{i}\}_{i=1}^{N}
\theta^{\body}
\{w_{i}\}_{i=1}^{N}
\theta^{\body}
\thetamtl^{\body}
\{\wmtl{i}\}_{i=1}^{N}
\ell(\hat{y},y)=\frac{1}{2}\|\hat{y}-y\|_{2}^{2}
\displaystyle\loss_{\mtl}(\thetamtl_{t})=\frac{1}{2}\sum_{i\in[N]}\left\|%
\vecop\left(\phitop_{\thetamtl^{\body}}(X_{i})~{}\wmtl{i}-Y_{i}\right)\right\|%
_{2}^{2},
\displaystyle\loss_{\mtl}(\thetamtl_{t})
\displaystyle=\frac{1}{2}\sum_{i\in[N]}\left\|\vecop\left(\phitop_{\thetamtl^{%
\body}}(X_{i})~{}\wmtl{i}-Y_{i}\right)\right\|_{2}^{2},
\displaystyle\loss_{\anil}(\theta_{t})=\frac{1}{2}\sum_{i\in[N]}\Big{\|}\vecop%
\Big{(}\phitop_{\theta^{\body}}(X_{i})~{}w_{i}^{*}-Y_{i}\Big{)}\Big{\|}_{2}^{2},
\displaystyle\loss_{\anil}(\theta_{t})
\displaystyle=\frac{1}{2}\sum_{i\in[N]}\Big{\|}\vecop\Big{(}\phitop_{\theta^{%
\body}}(X_{i})~{}w_{i}^{*}-Y_{i}\Big{)}\Big{\|}_{2}^{2},
\vecop(\cdot)
w_{i}^{*}=\innerloop(w,\phitop_{\theta^{\body}}(X_{i}),Y_{i},\tau,\lambda)
\eta
\displaystyle\frac{d\thetamtl_{t}}{dt}=-\eta\nabla_{\thetamtl_{t}}\loss_{\mtl}%
(\thetamtl_{t}),~{}~{}\frac{d\theta_{t}}{dt}=-\eta\nabla_{\theta_{t}}\loss_{%
\anil}(\thetamtl_{t})
\displaystyle\frac{d\thetamtl_{t}}{dt}=-\eta\nabla_{\thetamtl_{t}}\loss_{\mtl}%
(\thetamtl_{t}),~{}~{}\frac{d\theta_{t}}{dt}=-\eta\nabla_{\theta_{t}}\loss_{%
\anil}(\thetamtl_{t})
\theta_{t}
\thetamtl_{t}
t
\NTK(\cdot,\cdot)
\NNGP(\cdot,\cdot)
L
\metaNTK_{\anil}
\metaNTK_{\mtl}
\metaNTK_{\anil}
\metaNTK_{\mtl}
\NTK
\NNGP
\task=(\xyxy)
\delta>0
\eta^{*},h^{*}\in\bR_{+}
h^{*}
\eta<\eta^{*}
1-\delta
\task
\displaystyle F_{\mtl}(\xxy)=G_{\hat{\tau}}(\xxy)
\displaystyle F_{\mtl}(\xxy)=G_{\hat{\tau}}(\xxy)
\displaystyle\quad+\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{\mtl%
}^{-1}(\X,\X)\cdot\Y,
\displaystyle\quad+\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{\mtl%
}^{-1}(\X,\X)\cdot\Y,
\displaystyle F_{\anil}(\xxy)=G_{\hat{\tau}}(\xxy)
\displaystyle F_{\anil}(\xxy)=G_{\hat{\tau}}(\xxy)
\displaystyle\quad+\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{%
\anil}^{-1}(\X,\X)\big{[}\Y-G_{\tau}(\X,\X,\Y)\big{]},
\displaystyle\quad+\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{%
\anil}^{-1}(\X,\X)\big{[}\Y-G_{\tau}(\X,\X,\Y)\big{]},
\cO(\frac{1}{\sqrt{h^{*}}})
\ell_{2}
\X=(X_{i})_{i=1}^{N}\in\bR^{Nn\times d}
\Y=\vecop((Y_{i})_{i=1}^{N})\in\bR^{Nnk}
G
\metaNTK_{\mtl}
\metaNTK_{\anil}
\metaNTK_{\mtl}^{\prime}
\metaNTK_{\anil}^{\prime}
G
G
\displaystyle\quad G_{\hat{\tau}}(\xxy)
\displaystyle\quad G_{\hat{\tau}}(\xxy)
\displaystyle=\NNGP(X,X^{\prime})\NNGP(X^{\prime},X^{\prime})^{-1}(I-e^{-%
\lambda\NNGP(X^{\prime},X^{\prime})\hat{\tau}})Y^{\prime}
\displaystyle=\NNGP(X,X^{\prime})\NNGP(X^{\prime},X^{\prime})^{-1}(I-e^{-%
\lambda\NNGP(X^{\prime},X^{\prime})\hat{\tau}})Y^{\prime}
G_{\tau}(\XXY)=\vecop((G_{\tau}(X_{i},X_{i},Y_{i}))_{i=1}^{N})
\metaNTK_{\mtl}(\X,\X)
N\times N
(i,j)
i,j\in[N]
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\NTK(X_{i},X_{j})-\indicator[i\neq j%
]\NNGP(X_{i},X_{j})~{}.
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\NTK(X_{i},X_{j})-\indicator[i\neq j%
]\NNGP(X_{i},X_{j})~{}.
\metaNTK_{\mtl}^{\prime}
\metaNTK_{\mtl}
\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)
1\times N
(1,j)
\displaystyle[\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)]_{1j}=%
\NTK(X,X_{j})-\NNGP(X,X_{j})
\displaystyle[\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)]_{1j}=%
\NTK(X,X_{j})-\NNGP(X,X_{j})
\displaystyle~{}~{}-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{\prime})\Big%
{[}\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j})\Big{]}
\displaystyle~{}~{}-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{\prime})\Big%
{[}\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j})\Big{]}
T
\T_{\NNGP}^{\hat{\tau}}(X^{\prime})=\NNGP(X^{\prime},X^{\prime})^{-1}\left(I-e%
^{-\lambda\NNGP(X^{\prime})\hat{\tau}}\right)
\metaNTK_{\anil}(\X,\X)
N\times N
(i,j)
i,j\in[N]
\displaystyle\quad[\metaNTK_{\mathrm{ANIL}}(\X,\X)]_{ij}
\displaystyle\quad[\metaNTK_{\mathrm{ANIL}}(\X,\X)]_{ij}
\displaystyle=e^{-\lambda\NNGP(X_{i},X_{i})\tau}\NTK(X_{i},X_{j})e^{-\lambda%
\NNGP(X_{j},X_{j})\tau},
\displaystyle=e^{-\lambda\NNGP(X_{i},X_{i})\tau}\NTK(X_{i},X_{j})e^{-\lambda%
\NNGP(X_{j},X_{j})\tau},
\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)
1\times N
(1,j)
\displaystyle[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)]_{1j}=\NTK(X,X_{j%
})e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)]_{1j}=\NTK(X,X_{j%
})e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{\prime})\NTK(X^{%
\prime},X_{j})e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{\prime})\NTK(X^{%
\prime},X_{j})e^{-\lambda\NNGP(X_{j},X_{j})\tau}
G
\task=(\xyxy)
G_{\hat{\tau}}(\xxy)
X
(X^{\prime},Y^{\prime})
\lambda
\hat{\tau}
\task=(\xyxy)\in\bR^{n\times d}\times\bR^{n\times k}\times\bR^{n^{\prime}%
\times d}\times\bR^{n^{\prime}\times k}
\epsilon>0
h^{*}=\cO(\epsilon^{-2})
h
h^{*}
X
\displaystyle\quad\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
\displaystyle\quad\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
\displaystyle\leq\cO\left(\lambda\tau+\frac{1}{L}\right)+\epsilon.
\displaystyle\leq\cO\left(\lambda\tau+\frac{1}{L}\right)+\epsilon.
\cO(\lambda\tau+\frac{1}{L})
\lambda
\tau
\lambda\tau\in[0.01,0.5]
L\geq 12
1/L
L,\lambda,\tau
N,n,k,d
F_{\anil}
F_{\mtl}
\displaystyle\qquad\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
\displaystyle\qquad\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
\displaystyle\leq\cO\left(L\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{%
op}\right)+\cO(\lambda\tau+\frac{1}{\sqrt{h}})
\displaystyle\leq\cO\left(L\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{%
op}\right)+\cO(\lambda\tau+\frac{1}{\sqrt{h}})
\metaNTK_{\mtl}
\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\leq\cO(\frac{1}{L^{2}}),
h^{*}=\cO(\eps^{-2})
h>h^{*}
e^{L}
\metaNTK_{\mtl}
F_{\mtl}
\displaystyle\qquad e^{L}\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X%
)\cdot(e^{L}\metaNTK_{\mtl}(\X,\X))^{-1}
\displaystyle\qquad e^{L}\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X%
)\cdot(e^{L}\metaNTK_{\mtl}(\X,\X))^{-1}
\displaystyle=\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)\metaNTK_{%
\mtl}(\X,\X)^{-1}.
\displaystyle=\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)\metaNTK_{%
\mtl}(\X,\X)^{-1}.
\metaNTK_{\anil}
F_{\anil}
\metaNTK_{\mtl}
\metaNTK_{\anil}
L
\lambda\tau=0
\lambda\tau
L=10
\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
L
\lambda\tau=0
\lambda\tau
L=10
\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
i
(X_{i},Y_{i})
\mu_{i}\in\bR^{d}
\nu_{i}\in\bR+
X_{i}
\mathcal{N}(\mu_{i},\nu_{i}^{2}I)
x
y=\nu_{i}(x-\mu_{i})^{2}
\task=(\xyxy)
(\mu_{\test},\nu_{\test})
X,X^{\prime}
\mathcal{N}(\mu_{\test},\nu_{\test}^{2}I)
x
y=\nu_{\test}(x-\mu_{\test})^{2}
d=10
N=20
n=10
5
10
(\mu,\nu)
\mu\sim\mathcal{N}(0,I)
\nu\sim\mathrm{Unif}(1.3,1.6)
F_{\mtl}
F_{\anil}
20
\lambda\tau
L
\lambda\tau
L
\|F_{\mtl}(\xxy)-F_{\anil}(\xxy)\|_{2}
1\%
1\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\ell_{2}
\ell_{2}
\binom{64}{5}=7.6\times 10^{6}
\binom{351}{5}=4.3\times 10^{9}
63
3.6
\leq 2.2\%
11
81.55\%
81.56\%
n
n_{q}
n_{s}
i\in[N]
i
\displaystyle\text{$n_{q}$ Query Samples \& Labels:}X_{i}^{q}\in\bR^{n_{q}%
\times d},~{}Y_{i}^{q}\in\bR^{n_{q}k}
n_{q}
n_{q}
\displaystyle X_{i}^{q}\in\bR^{n_{q}\times d},~{}Y_{i}^{q}\in\bR^{n_{q}k}
\displaystyle\text{$n_{s}$ Support Samples \& Labels:}X_{i}^{s}\in\bR^{n_{s}%
\times d},~{}Y_{i}^{s}\in\bR^{n_{q}k}
n_{s}
n_{s}
\displaystyle X_{i}^{s}\in\bR^{n_{s}\times d},~{}Y_{i}^{s}\in\bR^{n_{q}k}
\{X_{i}^{q},Y_{i}^{q},X_{i}^{s},Y_{i}^{s}\}_{i=1}^{N}
\displaystyle\min_{\theta}\loss_{\anil}(\theta)\coloneqq\sum_{i\in[N]}\ell(%
\phitop_{\theta^{\body}}(X_{i}^{q})~{}w_{i}^{\prime},~{}Y_{i}^{q})
\displaystyle\min_{\theta}\loss_{\anil}(\theta)\coloneqq\sum_{i\in[N]}\ell(%
\phitop_{\theta^{\body}}(X_{i}^{q})~{}w_{i}^{\prime},~{}Y_{i}^{q})
\displaystyle\text{s.t. }w_{i}^{\prime}=~{}\innerloop(w,\phitop_{\theta^{\body%
}}(X_{i}^{s}),Y_{i}^{s},\tau,\lambda)
\displaystyle\text{s.t. }w_{i}^{\prime}=~{}\innerloop(w,\phitop_{\theta^{\body%
}}(X_{i}^{s}),Y_{i}^{s},\tau,\lambda)
\innerloop
(X_{i}^{s},Y_{i}^{s})
(X_{i}^{q},Y_{i}^{q})
\displaystyle\min_{\theta}\overbrace{\Big{[}\min_{\{\theta_{i}\}_{i=1}^{N}}%
\sum_{i\in[N]}\ell\Big{(}f_{\theta_{i}}(X_{i}),Y_{i}\Big{)}+R(\theta_{i})\Big{%
]}}^{\loss_{\gbml}(\theta)}~{}.
\displaystyle\min_{\theta}\overbrace{\Big{[}\min_{\{\theta_{i}\}_{i=1}^{N}}%
\sum_{i\in[N]}\ell\Big{(}f_{\theta_{i}}(X_{i}),Y_{i}\Big{)}+R(\theta_{i})\Big{%
]}}^{\loss_{\gbml}(\theta)}~{}.
\{\theta_{i}\}_{i=1}^{N}
\theta
\theta
\ell_{\gbml}(\theta)
\{\theta_{i}\}_{i=1}^{N}
\theta
\{\theta_{i}\}_{i=1}^{N}
N
N
L
l_{i}
i=1,...,L-1
l_{L}=k
i
x\in\mathbb{R}^{d}
h^{i}(x),z^{i}(x)\in\mathbb{R}^{l_{i}}
\displaystyle\begin{cases}h^{i+1}&=z^{i}W^{i+1}+b^{i+1}\\
z^{i+1}&=\activation\left(h^{i+1}\right)\end{cases}\,\,\textrm{and}\,\,\begin{%
cases}W^{i}_{\mu,\nu}&=\omega_{\mu\nu}^{i}\sim\mathcal{N}(0,\frac{\sigma_{%
\omega}}{\sqrt{l_{i}}})\\
b_{\nu}^{i}&=\beta_{\nu}^{i}\sim\mathcal{N}(0,\sigma_{b})\end{cases},
\displaystyle\begin{cases}h^{i+1}&=z^{i}W^{i+1}+b^{i+1}\\
z^{i+1}&=\activation\left(h^{i+1}\right)\end{cases}\,\,\textrm{and}\,\,\begin{%
cases}W^{i}_{\mu,\nu}&=\omega_{\mu\nu}^{i}\sim\mathcal{N}(0,\frac{\sigma_{%
\omega}}{\sqrt{l_{i}}})\\
b_{\nu}^{i}&=\beta_{\nu}^{i}\sim\mathcal{N}(0,\sigma_{b})\end{cases},
W^{i+1}\in\mathbb{R}^{l_{i}\times l_{i+1}}
b^{i+1}\in\mathbb{R}^{l_{i+1}}
\omega_{\mu\nu}^{l}
b_{\nu}^{l}
\frac{\sws}{l_{i}}
\sbs
\activation
\wtest
\thetatest=\{\theta^{\body},\wtest\}
L-1
\theta
\wtest
\thetamtltest=\{\thetamtl^{\body},\wmtltest\}
L-1
\theta
\wtest
\ell(\hat{y},y)\defeq\frac{1}{2}\|\hat{y}-y\|_{2}^{2}
\task=(\xyxy)
\tau
\displaystyle F^{\tau}_{\theta}(\xxy)=f_{\thetatest}\left(\sX\right)\in\mathbb%
{R}^{nk}
\displaystyle F^{\tau}_{\theta}(\xxy)=f_{\thetatest}\left(\sX\right)\in\mathbb%
{R}^{nk}
\thetatest
\theta
\tau
(\sX^{\prime},\sY^{\prime})
\lambda
\ell
\forall j=0,...,\tau-1
\displaystyle\theta=\theta_{0},~{}~{}\thetatest=\theta_{\tau},\text{ and }%
\theta_{j+1}=\theta_{j}-\lambda\nabla_{\theta_{j}}\ell(f_{\theta_{j}}(\sX^{%
\prime}),\sY^{\prime})
\displaystyle\theta=\theta_{0},~{}~{}\thetatest=\theta_{\tau},\text{ and }%
\theta_{j+1}=\theta_{j}-\lambda\nabla_{\theta_{j}}\ell(f_{\theta_{j}}(\sX^{%
\prime}),\sY^{\prime})
F^{\tau}_{\theta}(\X,\X,\Y)\triangleq\left(F^{\tau}_{\theta}(X_{i},X_{i},Y_{i}%
)\right)_{i=1}^{N}
F^{\tau}_{t}\triangleq F^{\tau}_{\theta_{t}}
\theta_{t}
t
\displaystyle\mathcal{L}_{\anil}(\theta)=\sum_{i=1}^{N}\ell(F^{\tau}_{\theta}(%
X_{i},X_{i},Y_{i}),Y_{i})=\frac{1}{2}\sum_{i=1}^{N}\|F^{\tau}_{\theta}(X_{i},X%
_{i},Y_{i})-Y_{i}\|_{2}^{2}=\frac{1}{2}\|F^{\tau}_{\theta}(\X,\X,\Y)-\Y\|_{2}^%
{2}
\displaystyle\mathcal{L}_{\anil}(\theta)
\displaystyle=\sum_{i=1}^{N}\ell(F^{\tau}_{\theta}(X_{i},X_{i},Y_{i}),Y_{i})=%
\frac{1}{2}\sum_{i=1}^{N}\|F^{\tau}_{\theta}(X_{i},X_{i},Y_{i})-Y_{i}\|_{2}^{2%
}=\frac{1}{2}\|F^{\tau}_{\theta}(\X,\X,\Y)-\Y\|_{2}^{2}
\displaystyle\mathcal{L}_{\mtl}(\thetamtl)=\sum_{i=1}^{N}\ell(\fmtl_{\thetamtl%
}(X_{i},i),Y_{i})=\frac{1}{2}\sum_{i=1}^{N}\|\fmtl_{\thetamtl}(X_{i},i)-Y_{i}%
\|_{2}^{2}=\frac{1}{2}\|\fmtl_{\thetamtl}(\X)-\Y\|_{2}^{2}
\displaystyle\mathcal{L}_{\mtl}(\thetamtl)
\displaystyle=\sum_{i=1}^{N}\ell(\fmtl_{\thetamtl}(X_{i},i),Y_{i})=\frac{1}{2}%
\sum_{i=1}^{N}\|\fmtl_{\thetamtl}(X_{i},i)-Y_{i}\|_{2}^{2}=\frac{1}{2}\|\fmtl_%
{\thetamtl}(\X)-\Y\|_{2}^{2}
\fmtl_{\thetamtl}(\X)
\vecop(\{\fmtl_{\thetamtl}(X_{i},i)\}_{i=1}^{N})
0pt
0pt=\min_{l\in[L-1]}h_{l}
\displaystyle\metaNTK_{\mtl}=\lim_{0pt\rightarrow\infty}\nabla_{\thetamtl_{0}}%
\fmtl_{\thetamtl_{0}}(\X)\cdot\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)^%
{\top}
\displaystyle\metaNTK_{\mtl}
\displaystyle=\lim_{0pt\rightarrow\infty}\nabla_{\thetamtl_{0}}\fmtl_{%
\thetamtl_{0}}(\X)\cdot\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)^{\top}
\displaystyle\metaNTK_{\anil}=\lim_{0pt\rightarrow\infty}\nabla_{\theta_{0}}F^%
{\tau}_{\theta_{0}}(\X,\X,\Y)\cdot\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,%
\X,\Y)^{\top}
\displaystyle\metaNTK_{\anil}
\displaystyle=\lim_{0pt\rightarrow\infty}\nabla_{\theta_{0}}F^{\tau}_{\theta_{%
0}}(\X,\X,\Y)\cdot\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)^{\top}
\theta_{0}
\thetamtl_{0}
\eta_{0}=\min\left\{\frac{2}{\lev(\metaNTK_{\mtl})+\Lev(\metaNTK_{\anil})},%
\frac{2}{\lev(\metaNTK_{\mtl})+\Lev(\metaNTK_{\anil})}\right\}.
\delta>0
R,\lambda_{0},0pt^{*}>0
0pt^{*}
\loss_{\mtl}
\loss_{\anil}
\eta>\eta_{0}
\lambda<\lambda_{0}
1-\delta
\displaystyle\loss_{\anil}(\theta_{t})\leq\left(1-\frac{1}{3}\eta_{0}\cdot\lev%
(\metaNTK_{\anil})\right)^{2t}R
\displaystyle\loss_{\anil}(\theta_{t})
\displaystyle\leq\left(1-\frac{1}{3}\eta_{0}\cdot\lev(\metaNTK_{\anil})\right)%
^{2t}R
\displaystyle\loss_{\mtl}(\thetamtl_{t})\leq\left(1-\frac{1}{3}\eta_{0}\cdot%
\lev(\metaNTK_{\mtl})\right)^{2t}R
\displaystyle\loss_{\mtl}(\thetamtl_{t})
\displaystyle\leq\left(1-\frac{1}{3}\eta_{0}\cdot\lev(\metaNTK_{\mtl})\right)^%
{2t}R
t\in\mathbb{N}
\displaystyle\sup_{t\geq 0}\frac{1}{\sqrt{0pt}}\|\theta_{t}-\theta_{0}\|_{2}=%
\cO(0pt^{-\frac{1}{2}}),~{}~{}\sup_{t\geq 0}\frac{1}{\sqrt{0pt}}\|\thetamtl_{t%
}-\thetamtl_{0}\|_{2}=\cO(0pt^{-\frac{1}{2}})
\displaystyle\sup_{t\geq 0}\frac{1}{\sqrt{0pt}}\|\theta_{t}-\theta_{0}\|_{2}=%
\cO(0pt^{-\frac{1}{2}}),~{}~{}\sup_{t\geq 0}\frac{1}{\sqrt{0pt}}\|\thetamtl_{t%
}-\thetamtl_{0}\|_{2}=\cO(0pt^{-\frac{1}{2}})
\displaystyle\sup_{t\geq 0}\|\theta_{t}-\theta_{0}\|_{2}=\cO(0pt^{-\frac{1}{2}%
}),~{}~{}\sup_{t\geq 0}\|\thetamtl_{t}-\thetamtl_{0}\|_{2}=\cO(0pt^{-\frac{1}{%
2}}),
\displaystyle\sup_{t\geq 0}\|\theta_{t}-\theta_{0}\|_{2}=\cO(0pt^{-\frac{1}{2}%
}),~{}~{}\sup_{t\geq 0}\|\thetamtl_{t}-\thetamtl_{0}\|_{2}=\cO(0pt^{-\frac{1}{%
2}}),
0pt
\tau=0
\delta>0
h^{*}>0
h
h^{*}
1-\delta
\theta_{t}\in\{\theta:\|\theta-\theta_{0}\|_{2}\leq\cO(1/0pt^{2})\}
\thetamtl_{t}\in\{\thetamtl:\|\thetamtl-\thetamtl_{0}\|_{2}\leq\cO(1/0pt^{2})\}
\theta_{0}=\{\theta_{0}^{\body},w_{0}\}
\thetamtl_{0}=\{\theta_{0}^{\body}\}\cup\{\wmtl{i}_{0}\}_{i\in[N]}
x\in\bR^{d}
\displaystyle f_{\theta}(x)=f_{\theta_{0}}(x)+\nabla_{\theta_{0}}f_{\theta_{0}%
}(x)(\theta-\theta_{0})+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle f_{\theta}(x)=f_{\theta_{0}}(x)+\nabla_{\theta_{0}}f_{\theta_{0}%
}(x)(\theta-\theta_{0})+\cO(\frac{1}{\sqrt{0pt}})
x
i\in[N]
\displaystyle\fmtl_{\thetamtl}(x,i)=\fmtl_{\thetamtl_{0}}(x,i)+\nabla_{%
\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(x,i)(\thetamtl-\thetamtl_{0})+\cO(\frac{1}%
{\sqrt{0pt}})
\displaystyle\fmtl_{\thetamtl}(x,i)=\fmtl_{\thetamtl_{0}}(x,i)+\nabla_{%
\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(x,i)(\thetamtl-\thetamtl_{0})+\cO(\frac{1}%
{\sqrt{0pt}})
\task=(\xyxy)
\displaystyle F^{\tau}_{\theta}(\xxy)=F^{\tau}_{\theta_{0}}(\xxy)+\nabla_{%
\theta_{0}}F^{\tau}_{\theta_{0}}(\xxy)(\theta-\theta_{0})+\cO(\frac{1}{\sqrt{0%
pt}}),
\displaystyle F^{\tau}_{\theta}(\xxy)
\displaystyle=F^{\tau}_{\theta_{0}}(\xxy)+\nabla_{\theta_{0}}F^{\tau}_{\theta_%
{0}}(\xxy)(\theta-\theta_{0})+\cO(\frac{1}{\sqrt{0pt}}),
F^{\tau}_{\theta_{0}}(\xxy)
\displaystyle F^{\tau}_{\theta_{0}}(\xxy)=f_{\theta_{0}}(X)+\nngp_{w_{0}}(X,X^%
{\prime})\nngp_{w_{0}}^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\nngp_{w_%
{0}}(X^{\prime},X^{\prime})\tau}\right)\left[Y^{\prime}-f_{\theta_{0}}(X^{%
\prime})\right]+\cO(\frac{1}{\sqrt{0pt}}),
\displaystyle F^{\tau}_{\theta_{0}}(\xxy)=f_{\theta_{0}}(X)+\nngp_{w_{0}}(X,X^%
{\prime})\nngp_{w_{0}}^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\nngp_{w_%
{0}}(X^{\prime},X^{\prime})\tau}\right)\left[Y^{\prime}-f_{\theta_{0}}(X^{%
\prime})\right]+\cO(\frac{1}{\sqrt{0pt}}),
\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\xxy)
\displaystyle\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\xxy)=\nabla_{\theta_{0}%
}f_{\theta_{0}}(X)-\nngp_{w_{0}}(X,X^{\prime})\nngp_{w_{0}}^{-1}(X^{\prime},X^%
{\prime})\left(I-e^{-\lambda\nngp_{w_{0}}(X^{\prime},X^{\prime})\tau}\right)%
\nabla_{\theta_{0}}f_{\theta_{0}}(X^{\prime})+\cO(\frac{1}{\sqrt{0pt}}),
\displaystyle\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\xxy)=\nabla_{\theta_{0}%
}f_{\theta_{0}}(X)-\nngp_{w_{0}}(X,X^{\prime})\nngp_{w_{0}}^{-1}(X^{\prime},X^%
{\prime})\left(I-e^{-\lambda\nngp_{w_{0}}(X^{\prime},X^{\prime})\tau}\right)%
\nabla_{\theta_{0}}f_{\theta_{0}}(X^{\prime})+\cO(\frac{1}{\sqrt{0pt}}),
\nngp_{w_{0}}
\displaystyle\nngp_{w_{0}}(\cdot,\ast)=\nabla_{w}f_{\theta_{0}}(\cdot)\cdot%
\nabla_{w}f_{\theta_{0}}(\ast)^{\top}
\displaystyle\nngp_{w_{0}}(\cdot,\ast)=\nabla_{w}f_{\theta_{0}}(\cdot)\cdot%
\nabla_{w}f_{\theta_{0}}(\ast)^{\top}
\theta_{0}
\{\theta_{0}^{\body},\wtest\}
\{\thetamtl_{0}^{\body},\wmtltest\}
\cO(\frac{1}{\sqrt{0pt}})
\displaystyle\metantk_{\anil}(\X,\X)=\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(%
\X,\X,\Y)\cdot\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)^{\top}\in\bR^%
{Nn\times Nn}
\displaystyle\metantk_{\anil}(\X,\X)
\displaystyle=\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)\cdot\nabla_{%
\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)^{\top}\in\bR^{Nn\times Nn}
\displaystyle\metantk_{\mtl}(\X,\X)=\nabla_{\theta_{0}}\fmtl_{\thetamtl_{0}}(%
\X)\cdot\nabla_{\theta_{0}}\fmtl_{\thetamtl_{0}}(\X)^{\top}\in\bR^{Nn\times Nn}
\displaystyle\metantk_{\mtl}(\X,\X)
\displaystyle=\nabla_{\theta_{0}}\fmtl_{\thetamtl_{0}}(\X)\cdot\nabla_{\theta_%
{0}}\fmtl_{\thetamtl_{0}}(\X)^{\top}\in\bR^{Nn\times Nn}
\metantk
\eta
t
\displaystyle T^{\eta,t}_{\metantk}(\cdot)=\metantk^{-1}(\cdot,\cdot)\left(I-e%
^{-\eta\metantk(\cdot,\cdot)t}\right)
\displaystyle T^{\eta,t}_{\metantk}(\cdot)
\displaystyle=\metantk^{-1}(\cdot,\cdot)\left(I-e^{-\eta\metantk(\cdot,\cdot)t%
}\right)
t
\displaystyle\theta_{t}=\theta_{0}+\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X%
,\X,\Y)^{\top}\metantk_{\anil}^{-1}(\X,\X)\left(I-e^{-\eta\metantk_{\anil}(\X,%
\X)t}\right)\left[\Y-F^{\tau}_{\theta_{0}}(\X,\X,\Y)\right]+\cO(\frac{1}{\sqrt%
{0pt}})
\displaystyle\theta_{t}
\displaystyle=\theta_{0}+\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)^{%
\top}\metantk_{\anil}^{-1}(\X,\X)\left(I-e^{-\eta\metantk_{\anil}(\X,\X)t}%
\right)\left[\Y-F^{\tau}_{\theta_{0}}(\X,\X,\Y)\right]+\cO(\frac{1}{\sqrt{0pt}})
\task=(\xyxy)
\hat{\tau}
\theta^{\body}
\wtest
\displaystyle\qquad F^{\hat{\tau}}_{\thetatest_{t}}(\xxy)
\displaystyle\qquad F^{\hat{\tau}}_{\thetatest_{t}}(\xxy)
\displaystyle=F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)+\nabla_{\theta_{0}^{\body}%
}F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)\nabla_{\theta_{0}^{\body}}F^{\tau}_{%
\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{\metantk_{\anil}}(\X)\left[\Y-F^{\tau}%
_{\theta_{0}}(\X,\X,\Y)\right]+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)+\nabla_{\theta_{0}^{\body}%
}F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)\nabla_{\theta_{0}^{\body}}F^{\tau}_{%
\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{\metantk_{\anil}}(\X)\left[\Y-F^{\tau}%
_{\theta_{0}}(\X,\X,\Y)\right]+\cO(\frac{1}{\sqrt{0pt}})
\thetamtltest_{t}=\{\thetamtl_{t}^{\body},\wmtltest\}
\thetamtltest_{0}=\{\thetamtl_{0}^{\body},\wmtltest\}
\displaystyle\thetamtl_{t}=\thetamtl_{0}+\nabla_{\thetamtl_{0}}\fmtl_{%
\thetamtl_{0}}(\X)^{\top}T^{\eta,t}_{\metantk_{\mtl}}(\X)\left[\Y-\fmtl_{%
\thetamtl_{0}}(\X)\right]+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle\thetamtl_{t}
\displaystyle=\thetamtl_{0}+\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)^{%
\top}T^{\eta,t}_{\metantk_{\mtl}}(\X)\left[\Y-\fmtl_{\thetamtl_{0}}(\X)\right]%
+\cO(\frac{1}{\sqrt{0pt}})
\task=(\xyxy)
\hat{\tau}
\thetamtl^{\body}
\wmtltest
\displaystyle\qquad F^{\hat{\tau}}_{\thetamtltest_{t}}(\xxy)
\displaystyle\qquad F^{\hat{\tau}}_{\thetamtltest_{t}}(\xxy)
\displaystyle=F^{\hat{\tau}}_{\thetamtltest_{0}}(\xxy)+\nabla_{\thetamtl_{0}^{%
\body}}F^{\hat{\tau}}_{\thetamtltest_{0}}(\xxy)\nabla_{\thetamtl_{0}^{\body}}%
\fmtl_{\thetamtl_{0}}(\X)^{\top}T^{\eta,t}_{\metantk_{\mtl}}(\X)\left[\Y-\fmtl%
_{\thetamtl_{0}}(\X)\right]+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=F^{\hat{\tau}}_{\thetamtltest_{0}}(\xxy)+\nabla_{\thetamtl_{0}^{%
\body}}F^{\hat{\tau}}_{\thetamtltest_{0}}(\xxy)\nabla_{\thetamtl_{0}^{\body}}%
\fmtl_{\thetamtl_{0}}(\X)^{\top}T^{\eta,t}_{\metantk_{\mtl}}(\X)\left[\Y-\fmtl%
_{\thetamtl_{0}}(\X)\right]+\cO(\frac{1}{\sqrt{0pt}})
\thetamtltest_{t}=\{\thetamtl_{t}^{\body},\wmtltest\}
\thetamtltest_{0}=\{\thetamtl_{0}^{\body},\wmtltest\}
\displaystyle\diff{\theta_{t}}{t}=-\eta\nabla_{\theta_{0}}F_{\theta_{0}}(\X,\X%
,\Y)^{\top}\left(F_{\theta_{t}}(\X,\X,\Y)-\Y\right)
\displaystyle\diff{\theta_{t}}{t}=-\eta\nabla_{\theta_{0}}F_{\theta_{0}}(\X,\X%
,\Y)^{\top}\left(F_{\theta_{t}}(\X,\X,\Y)-\Y\right)
\displaystyle\diff{F_{\theta_{t}}(\X,\X,\Y)}{t}=-\eta\metantk_{\anil}(\X,\X)%
\left(F_{\theta_{t}}(\X,\X,\Y)-\Y\right)
\displaystyle\diff{F_{\theta_{t}}(\X,\X,\Y)}{t}=-\eta\metantk_{\anil}(\X,\X)%
\left(F_{\theta_{t}}(\X,\X,\Y)-\Y\right)
\theta_{t}
\displaystyle\theta_{t}=\theta_{0}-\nabla_{\theta_{0}}F_{\theta_{0}}(\X,\X,\Y)%
^{\top}\metantk_{\anil}(\X,\X)^{-1}\left(I-e^{-\eta\metantk_{\anil}(\X,\X)t}%
\right)\left(F_{\theta_{0}}(\X,\X,\Y)-\Y\right)
\displaystyle\theta_{t}=\theta_{0}-\nabla_{\theta_{0}}F_{\theta_{0}}(\X,\X,\Y)%
^{\top}\metantk_{\anil}(\X,\X)^{-1}\left(I-e^{-\eta\metantk_{\anil}(\X,\X)t}%
\right)\left(F_{\theta_{0}}(\X,\X,\Y)-\Y\right)
\cO(\frac{1}{\sqrt{0pt}})
\displaystyle\diff{\thetamtl_{t}}{t}=-\eta\nabla_{\thetamtl_{0}}\fmtl_{%
\thetamtl_{0}}(\X)^{\top}\left(\fmtl_{\theta_{t}}(\X)-\Y\right)
\displaystyle\diff{\thetamtl_{t}}{t}
\displaystyle=-\eta\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)^{\top}\left%
(\fmtl_{\theta_{t}}(\X)-\Y\right)
\displaystyle\diff{\fmtl_{\theta_{t}}(\X)}{t}=-\eta\metantk_{\mtl}(\X,\X)\left%
(\fmtl_{\theta_{0}}(\X)-\Y\right)
\displaystyle\diff{\fmtl_{\theta_{t}}(\X)}{t}
\displaystyle=-\eta\metantk_{\mtl}(\X,\X)\left(\fmtl_{\theta_{0}}(\X)-\Y\right)
\thetamtl_{t}
\displaystyle\thetamtl_{t}=\thetamtl_{0}-\nabla_{\thetamtl_{0}}\fmtl_{%
\thetamtl_{0}}(\X)^{\top}\metantk_{\mtl}(\X,\X)^{-1}\left(I-e^{-\eta\metantk_{%
\mtl}(\X,\X)t}\right)\left(\fmtl_{\theta_{t}}(\X)-\Y\right)
\displaystyle\thetamtl_{t}=\thetamtl_{0}-\nabla_{\thetamtl_{0}}\fmtl_{%
\thetamtl_{0}}(\X)^{\top}\metantk_{\mtl}(\X,\X)^{-1}\left(I-e^{-\eta\metantk_{%
\mtl}(\X,\X)t}\right)\left(\fmtl_{\theta_{t}}(\X)-\Y\right)
\cO(\frac{1}{\sqrt{0pt}})
\task=(\xyxy)
\nngp_{t}(\cdot,\ast)=\nabla_{\wtest}f_{\thetatest_{t}}(\cdot)\nabla_{\wtest}f%
_{\thetatest_{t}}(\ast)^{\top}
\wtest
\displaystyle F^{\hat{\tau}}_{\thetatest_{t}}(\xxy)=f_{\thetatest_{t}}(X)+%
\nngp_{t}(X,X^{\prime})T^{\lambda,\hat{\tau}}_{\nngp_{t}}(X^{\prime})\left(Y^{%
\prime}-f_{\thetatest_{t}}(X^{\prime})\right)+\cO(\frac{1}{\sqrt{0pt}})\eq
\displaystyle F^{\hat{\tau}}_{\thetatest_{t}}(\xxy)=f_{\thetatest_{t}}(X)+%
\nngp_{t}(X,X^{\prime})T^{\lambda,\hat{\tau}}_{\nngp_{t}}(X^{\prime})\left(Y^{%
\prime}-f_{\thetatest_{t}}(X^{\prime})\right)+\cO(\frac{1}{\sqrt{0pt}})\eq
\displaystyle\qquad f_{\thetatest_{t}}(X)\eq
\displaystyle\qquad f_{\thetatest_{t}}(X)\eq
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\thetatest_{0}}f_{\thetatest_{0}}(%
X)(\thetatest_{t}-\thetatest_{0})+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\thetatest_{0}}f_{\thetatest_{0}}(%
X)(\thetatest_{t}-\thetatest_{0})+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)(\theta^{\body}_{t}-\theta_{0}^{\body})+\nabla_{\wtest}f_{\thetatest_{0}%
}(X)(\wtest-\wtest)+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)(\theta^{\body}_{t}-\theta_{0}^{\body})+\nabla_{\wtest}f_{\thetatest_{0}%
}(X)(\wtest-\wtest)+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)(\theta^{\body}_{t}-\theta_{0}^{\body})+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)(\theta^{\body}_{t}-\theta_{0}^{\body})+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)\nabla_{\theta_{0}^{\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}\metantk_{%
\anil}(\X,\X)^{-1}\left(I-e^{-\eta\metantk_{\anil}(\X,\X)t}\right)\left(\Y-F_{%
\theta_{0}}(\X,\X,\Y)\right)
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)\nabla_{\theta_{0}^{\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}\metantk_{%
\anil}(\X,\X)^{-1}\left(I-e^{-\eta\metantk_{\anil}(\X,\X)t}\right)\left(\Y-F_{%
\theta_{0}}(\X,\X,\Y)\right)
\displaystyle\quad+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle\quad+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)\nabla_{\theta_{0}^{\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{%
\metantk_{\anil}}(\X)\left(\Y-F_{\theta_{0}}(\X,\X,\Y)\right)+\cO(\frac{1}{%
\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)\nabla_{\theta_{0}^{\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{%
\metantk_{\anil}}(\X)\left(\Y-F_{\theta_{0}}(\X,\X,\Y)\right)+\cO(\frac{1}{%
\sqrt{0pt}})
\displaystyle\nabla_{\wtest}f_{\thetatest_{t}}(X)=\nabla_{\wtest}f_{\thetatest%
_{0}}(X)+\cO(\frac{1}{\sqrt{0pt}})\eq
\displaystyle\nabla_{\wtest}f_{\thetatest_{t}}(X)=\nabla_{\wtest}f_{\thetatest%
_{0}}(X)+\cO(\frac{1}{\sqrt{0pt}})\eq
\displaystyle\qquad F^{\hat{\tau}}_{\thetatest_{t}}(\xxy)\eq
\displaystyle\qquad F^{\hat{\tau}}_{\thetatest_{t}}(\xxy)\eq
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)\nabla_{\theta_{0}^{\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{%
\metantk_{\anil}}(\X)\left(\Y-F_{\theta_{0}}(\X,\X,\Y)\right)
\displaystyle=f_{\thetatest_{0}}(X)+\nabla_{\theta_{0}^{\body}}f_{\thetatest_{%
0}}(X)\nabla_{\theta_{0}^{\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{%
\metantk_{\anil}}(\X)\left(\Y-F_{\theta_{0}}(\X,\X,\Y)\right)
\displaystyle\quad+\nngp_{0}(X,X^{\prime})T^{\lambda,\hat{\tau}}_{\nngp_{0}}(X%
^{\prime})\left(Y^{\prime}-f_{\thetatest_{t}}(X^{\prime})\right)+\cO(\frac{1}{%
\sqrt{0pt}})
\displaystyle\quad+\nngp_{0}(X,X^{\prime})T^{\lambda,\hat{\tau}}_{\nngp_{0}}(X%
^{\prime})\left(Y^{\prime}-f_{\thetatest_{t}}(X^{\prime})\right)+\cO(\frac{1}{%
\sqrt{0pt}})
\displaystyle=f_{\thetatest_{0}}(X)+\nngp_{0}(X,X^{\prime})T^{\lambda,\hat{%
\tau}}_{\nngp_{0}}(X^{\prime})(Y^{\prime}-f_{\thetatest_{0}}(X^{\prime}))
\displaystyle=f_{\thetatest_{0}}(X)+\nngp_{0}(X,X^{\prime})T^{\lambda,\hat{%
\tau}}_{\nngp_{0}}(X^{\prime})(Y^{\prime}-f_{\thetatest_{0}}(X^{\prime}))
\displaystyle\quad+\left(\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(X)-%
\nngp_{0}(X,X^{\prime})T^{\lambda,\hat{\tau}}_{\nngp_{0}}(X^{\prime})\nabla_{%
\theta_{0}^{\body}}f_{\thetatest_{0}}(X^{\prime})\right)\nabla_{\theta_{0}^{%
\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{\metantk_{\anil}}(\X)\left(%
\Y-F_{\theta_{0}}(\X,\X,\Y)\right)
\displaystyle\quad+\left(\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(X)-%
\nngp_{0}(X,X^{\prime})T^{\lambda,\hat{\tau}}_{\nngp_{0}}(X^{\prime})\nabla_{%
\theta_{0}^{\body}}f_{\thetatest_{0}}(X^{\prime})\right)\nabla_{\theta_{0}^{%
\body}}F_{\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{\metantk_{\anil}}(\X)\left(%
\Y-F_{\theta_{0}}(\X,\X,\Y)\right)
\displaystyle\quad+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle\quad+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)+\nabla_{\theta_{0}^{\body}%
}F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)\nabla_{\theta_{0}^{\body}}F^{\tau}_{%
\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{\metantk_{\anil}}(\X)\left[\Y-F^{\tau}%
_{\theta_{0}}(\X,\X,\Y)\right]+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle=F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)+\nabla_{\theta_{0}^{\body}%
}F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)\nabla_{\theta_{0}^{\body}}F^{\tau}_{%
\theta_{0}}(\X,\X,\Y)^{\top}T^{\eta,t}_{\metantk_{\anil}}(\X)\left[\Y-F^{\tau}%
_{\theta_{0}}(\X,\X,\Y)\right]+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle F^{\hat{\tau}}_{\thetamtltest_{t}}(\xxy)=F^{\hat{\tau}}_{%
\thetamtltest_{0}}(\xxy)+\nabla_{\thetamtl_{0}^{\body}}F^{\hat{\tau}}_{%
\thetamtltest_{0}}(\xxy)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\X%
)^{\top}T^{\eta,t}_{\metantk_{\mtl}}(\X)\left[\Y-\fmtl_{\thetamtl_{0}}(\X)%
\right]+\cO(\frac{1}{\sqrt{0pt}})
\displaystyle F^{\hat{\tau}}_{\thetamtltest_{t}}(\xxy)=F^{\hat{\tau}}_{%
\thetamtltest_{0}}(\xxy)+\nabla_{\thetamtl_{0}^{\body}}F^{\hat{\tau}}_{%
\thetamtltest_{0}}(\xxy)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\X%
)^{\top}T^{\eta,t}_{\metantk_{\mtl}}(\X)\left[\Y-\fmtl_{\thetamtl_{0}}(\X)%
\right]+\cO(\frac{1}{\sqrt{0pt}})
\NTK(\cdot,\ast)
\NNGP(\cdot,\ast)
h
\theta_{0}=\{\theta_{0}^{\body},w_{0}\}
\displaystyle\nabla_{\theta_{0}}f_{\theta_{0}}(\cdot)\nabla_{\theta_{0}}f_{%
\theta_{0}}(\ast)^{\top}=\NTK(\cdot,\ast)
\displaystyle\nabla_{\theta_{0}}f_{\theta_{0}}(\cdot)\nabla_{\theta_{0}}f_{%
\theta_{0}}(\ast)^{\top}
\displaystyle=\NTK(\cdot,\ast)
\displaystyle\nabla_{w}f_{\theta_{0}}(\cdot)\nabla_{\theta_{0}}f_{w}(\ast)^{%
\top}=\NNGP(\cdot,\ast)
\displaystyle\nabla_{w}f_{\theta_{0}}(\cdot)\nabla_{\theta_{0}}f_{w}(\ast)^{\top}
\displaystyle=\NNGP(\cdot,\ast)
0pt\rightarrow\infty
\metaNTK_{\anil}(\X,\X)=\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)%
\cdot\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)^{\top}
N\times N
\forall i,j\in[N]
(i,j)
\displaystyle\quad[\metaNTK_{\mathrm{ANIL}}(\X,\X)]_{ij}=e^{-\lambda\NNGP(X_{i%
},X_{i})\tau}\NTK(X_{i},X_{j})e^{-\lambda\NNGP(X_{j},X_{j})\tau},
\displaystyle\quad[\metaNTK_{\mathrm{ANIL}}(\X,\X)]_{ij}=e^{-\lambda\NNGP(X_{i%
},X_{i})\tau}\NTK(X_{i},X_{j})e^{-\lambda\NNGP(X_{j},X_{j})\tau},
\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)=\nabla_{\theta_{0}^{\body}}F^{%
\hat{\tau}}_{\thetatest_{0}}(\xxy)\nabla_{\theta_{0}^{\body}}F^{\tau}_{\theta_%
{0}}(\X,\X,\Y)^{\top}
1\times N
(1,j)
\displaystyle\qquad[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)]_{1j}=\Big{%
[}\NTK(X,X_{j})-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{\prime})\NTK(X^{%
\prime},X_{j})\Big{]}e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle\qquad[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)]_{1j}=\Big{%
[}\NTK(X,X_{j})-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{\prime})\NTK(X^{%
\prime},X_{j})\Big{]}e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\metaNTK_{\mtl}(\X,\X)=\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)\cdot%
\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)^{\top}
N\times N
\forall i,j\in[N]
(i,j)
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\NTK(X_{i},X_{j})-\indicator[i\neq j%
]\NNGP(X_{i},X_{j}),
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\NTK(X_{i},X_{j})-\indicator[i\neq j%
]\NNGP(X_{i},X_{j}),
\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)=\nabla_{\thetamtl_{0}^{\body}}F^%
{\hat{\tau}}_{\thetamtltest_{0}}(\xxy)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{%
\thetamtl_{0}}(\X)^{\top}
1\times N
(1,j)
\displaystyle[\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)]_{1j}=%
\NTK(X,X_{j})-\NNGP(X,X_{j})-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{%
\prime})\Big{[}\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j})\Big{]}
\displaystyle[\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)]_{1j}
\displaystyle=\NTK(X,X_{j})-\NNGP(X,X_{j})-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat%
{\tau}}(X^{\prime})\Big{[}\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j})\Big{]}
\displaystyle=\NTK(X,X_{j})-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{%
\prime})\NTK(X^{\prime},X_{j})-\NNGP(X,X^{\prime})e^{-\lambda\NNGP(X^{\prime},%
X^{\prime})\hat{\tau}}\NNGP(X^{\prime},X_{j})
\displaystyle=\NTK(X,X_{j})-\NNGP(X,X^{\prime})\T_{\NNGP}^{\hat{\tau}}(X^{%
\prime})\NTK(X^{\prime},X_{j})-\NNGP(X,X^{\prime})e^{-\lambda\NNGP(X^{\prime},%
X^{\prime})\hat{\tau}}\NNGP(X^{\prime},X_{j})
\metaNTK_{\anil}(\X,\X)
\displaystyle\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)=\left(\nabla_{%
\theta_{0}}F^{\tau}_{\theta_{0}}(X_{i},X_{i},Y_{i})\right)_{i=1}^{N}
\displaystyle\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)
\displaystyle=\left(\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(X_{i},X_{i},Y_{i}%
)\right)_{i=1}^{N}
\displaystyle=\left(\nabla_{\theta_{0}}f_{\theta_{0}}(X_{i})-\NNGP(X_{i},X_{i}%
)\NNGP^{-1}(X_{i},X_{i})\left(I-e^{-\lambda\NNGP(X_{i},X_{i})\tau}\right)%
\nabla_{\theta_{0}}f_{\theta_{0}}(X_{i})\right)_{i=1}^{N}
\displaystyle=\left(\nabla_{\theta_{0}}f_{\theta_{0}}(X_{i})-\NNGP(X_{i},X_{i}%
)\NNGP^{-1}(X_{i},X_{i})\left(I-e^{-\lambda\NNGP(X_{i},X_{i})\tau}\right)%
\nabla_{\theta_{0}}f_{\theta_{0}}(X_{i})\right)_{i=1}^{N}
\displaystyle=\left(e^{-\lambda\NNGP(X_{i},X_{i})\tau}\nabla_{\theta_{0}}f_{%
\theta_{0}}(X_{i})\right)_{i=1}^{N}
\displaystyle=\left(e^{-\lambda\NNGP(X_{i},X_{i})\tau}\nabla_{\theta_{0}}f_{%
\theta_{0}}(X_{i})\right)_{i=1}^{N}
(i,j)
\metaNTK_{\anil}(\X,\X)=\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)%
\cdot\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(\X,\X,\Y)^{\top}
\displaystyle\left[\metaNTK_{\anil}(\X,\X)\right]_{ij}=\nabla_{\theta_{0}}F^{%
\tau}_{\theta_{0}}(X_{i},X_{i},Y_{i})\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(%
X_{j},X_{j},Y_{j})^{\top}
\displaystyle\left[\metaNTK_{\anil}(\X,\X)\right]_{ij}
\displaystyle=\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(X_{i},X_{i},Y_{i})%
\nabla_{\theta_{0}}F^{\tau}_{\theta_{0}}(X_{j},X_{j},Y_{j})^{\top}
\displaystyle=e^{-\lambda\NNGP(X_{i},X_{i})\tau}\nabla_{\theta_{0}}f_{\theta_{%
0}}(X_{i})f_{\theta_{0}}(X_{j})^{\top}e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=e^{-\lambda\NNGP(X_{i},X_{i})\tau}\nabla_{\theta_{0}}f_{\theta_{%
0}}(X_{i})f_{\theta_{0}}(X_{j})^{\top}e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=e^{-\lambda\NNGP(X_{i},X_{i})\tau}\NTK(X_{i},X_{j})e^{-\lambda%
\NNGP(X_{j},X_{j})\tau}
\displaystyle=e^{-\lambda\NNGP(X_{i},X_{i})\tau}\NTK(X_{i},X_{j})e^{-\lambda%
\NNGP(X_{j},X_{j})\tau}
\displaystyle\metaNTK_{\anil}(\X,\X)=\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau%
}\}_{i=1}^{N}}\cdot\NTK(\X,\X)\cdot\diag
\displaystyle\metaNTK_{\anil}(\X,\X)=\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau%
}\}_{i=1}^{N}}\cdot\NTK(\X,\X)\cdot\diag
\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau}\}_{i=1}^{N}}
i
e^{-\lambda\NNGP(X_{i},X_{i})\tau}
\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)
\displaystyle\qquad\left[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\right]%
_{1j}
\displaystyle\qquad\left[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\right]%
_{1j}
\displaystyle=\nabla_{\theta_{0}^{\body}}F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)%
\nabla_{\theta_{0}^{\body}}F^{\tau}_{\theta_{0}}(X_{j},X_{j},Y_{j})^{\top}
\displaystyle=\nabla_{\theta_{0}^{\body}}F^{\hat{\tau}}_{\thetatest_{0}}(\xxy)%
\nabla_{\theta_{0}^{\body}}F^{\tau}_{\theta_{0}}(X_{j},X_{j},Y_{j})^{\top}
\displaystyle=\left(\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(X)-\NNGP(X,X%
^{\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime}%
,X^{\prime})\hat{\tau}}\right)\nabla_{\theta_{0}^{\body}}f_{\theta_{0}^{\body}%
}(X^{\prime})\right)
\displaystyle=\left(\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(X)-\NNGP(X,X%
^{\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime}%
,X^{\prime})\hat{\tau}}\right)\nabla_{\theta_{0}^{\body}}f_{\theta_{0}^{\body}%
}(X^{\prime})\right)
\displaystyle\quad\cdot\left(\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X_{j})-%
\NNGP(X_{j},X_{j})\NNGP^{-1}(X_{j},X_{j})\left(I-e^{-\lambda\NNGP(X_{j},X_{j})%
\tau}\right)\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X_{j})\right)^{\top}
\displaystyle\quad\cdot\left(\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X_{j})-%
\NNGP(X_{j},X_{j})\NNGP^{-1}(X_{j},X_{j})\left(I-e^{-\lambda\NNGP(X_{j},X_{j})%
\tau}\right)\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X_{j})\right)^{\top}
\displaystyle=\left(\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(X)-\NNGP(X,X%
^{\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime}%
,X^{\prime})\hat{\tau}}\right)\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X^{%
\prime})\right)\cdot\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X_{j})^{\top}e^{%
-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=\left(\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(X)-\NNGP(X,X%
^{\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime}%
,X^{\prime})\hat{\tau}}\right)\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X^{%
\prime})\right)\cdot\nabla_{\theta_{0}^{\body}}f_{\theta_{0}}(X_{j})^{\top}e^{%
-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=\left[\left(\NTK(X,X_{j})-\NNGP(X,X_{j})\right)-\NNGP(X,X^{%
\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime},X%
^{\prime})\hat{\tau}}\right)\left(\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j%
})\right)\right]e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=\left[\left(\NTK(X,X_{j})-\NNGP(X,X_{j})\right)-\NNGP(X,X^{%
\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime},X%
^{\prime})\hat{\tau}}\right)\left(\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j%
})\right)\right]e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=\left[\left(\NTK(X,X_{j})-\NNGP(X,X_{j})\right)-\NNGP(X,X^{%
\prime})T^{\lambda,\hat{\tau}}_{\NNGP}(X^{\prime})\left(\NTK(X^{\prime},X_{j})%
-\NNGP(X^{\prime},X_{j})\right)\right]e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle=\left[\left(\NTK(X,X_{j})-\NNGP(X,X_{j})\right)-\NNGP(X,X^{%
\prime})T^{\lambda,\hat{\tau}}_{\NNGP}(X^{\prime})\left(\NTK(X^{\prime},X_{j})%
-\NNGP(X^{\prime},X_{j})\right)\right]e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\displaystyle\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(\cdot)\cdot\nabla_{%
\theta_{0}^{\body}}f_{\theta_{0}}(\ast)^{\top}=\NTK(\cdot,\ast)-\NNGP(\cdot,\ast)
\displaystyle\nabla_{\theta_{0}^{\body}}f_{\thetatest_{0}}(\cdot)\cdot\nabla_{%
\theta_{0}^{\body}}f_{\theta_{0}}(\ast)^{\top}=\NTK(\cdot,\ast)-\NNGP(\cdot,\ast)
\metaNTK_{\mtl}(\X,\X)=\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)\cdot%
\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\X)^{\top}
i
\displaystyle\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\cdot,i)=\nabla_{%
\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\cdot,i)+\sum_{j=1}^{N+1}\nabla_{%
\wmtl{j}}\fmtl_{\thetamtl_{0}}(\cdot,i)
\displaystyle\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(\cdot,i)
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\cdot,i)+%
\sum_{j=1}^{N+1}\nabla_{\wmtl{j}}\fmtl_{\thetamtl_{0}}(\cdot,i)
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\cdot,i)+%
\nabla_{\wmtl{i}}\fmtl_{\thetamtl_{0}}(\cdot,i)\eq
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\cdot,i)+%
\nabla_{\wmtl{i}}\fmtl_{\thetamtl_{0}}(\cdot,i)\eq
j\neq i
\nabla_{\wmtl{j}}\fmtl_{\thetamtl_{0}}(x,i)=0
(i,j)
\metaNTK_{\mtl}(\X,\X)
\displaystyle\qquad[\metaNTK_{\mtl}(\X,\X)]_{ij}=\nabla_{\thetamtl_{0}}\fmtl_{%
\thetamtl_{0}}(X_{i},i)\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}
\displaystyle\qquad[\metaNTK_{\mtl}(\X,\X)]_{ij}
\displaystyle=\nabla_{\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(X_{i},i)\nabla_{%
\thetamtl_{0}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{i},i)%
\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}+\nabla_{%
\wmtl{i}}\fmtl_{\thetamtl_{0}}(X_{i},i)\nabla_{\wmtl{j}}\fmtl_{\thetamtl_{0}}(%
X_{j},j)^{\top}
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{i},i)%
\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}+\nabla_{%
\wmtl{i}}\fmtl_{\thetamtl_{0}}(X_{i},i)\nabla_{\wmtl{j}}\fmtl_{\thetamtl_{0}}(%
X_{j},j)^{\top}
i\neq j
\nabla_{\wmtl{i}}\fmtl_{\thetamtl_{0}}(X_{i},i)\nabla_{\wmtl{j}}\fmtl_{%
\thetamtl_{0}}(X_{j},j)^{\top}=0
\wmtl{i}
\wmtl{j}
\thetamtl
i\neq j
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\nabla_{\thetamtl_{0}^{\body}}\fmtl%
_{\thetamtl_{0}}(X_{i},i)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X%
_{j},j)^{\top}=\NTK(X_{i},X_{j})-\NNGP(X_{i},X_{j})
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\nabla_{\thetamtl_{0}^{\body}}\fmtl%
_{\thetamtl_{0}}(X_{i},i)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X%
_{j},j)^{\top}=\NTK(X_{i},X_{j})-\NNGP(X_{i},X_{j})
i=j
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ii}=\nabla_{\thetamtl_{0}^{\body}}\fmtl%
_{\thetamtl_{0}}(X_{i},i)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X%
_{i},i)^{\top}+\nabla_{\wmtl{i}}\fmtl_{\thetamtl_{0}}(X_{i},i)\nabla_{\wmtl{i}%
}\fmtl_{\thetamtl_{0}}(X_{i},i)^{\top}=\NTK(X_{i},X_{i})
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ii}=\nabla_{\thetamtl_{0}^{\body}}\fmtl%
_{\thetamtl_{0}}(X_{i},i)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X%
_{i},i)^{\top}+\nabla_{\wmtl{i}}\fmtl_{\thetamtl_{0}}(X_{i},i)\nabla_{\wmtl{i}%
}\fmtl_{\thetamtl_{0}}(X_{i},i)^{\top}=\NTK(X_{i},X_{i})
i,j\in[N]
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\NTK(X_{i},X_{j})-\indicator[i\neq j%
]\NNGP(X_{i},X_{j})
\displaystyle[\metaNTK_{\mtl}(\X,\X)]_{ij}=\NTK(X_{i},X_{j})-\indicator[i\neq j%
]\NNGP(X_{i},X_{j})
\displaystyle\metaNTK_{\mtl}(\X,\X)=\NTK(\X,\X)-\NNGP(\X,\X)+\diag{\{\NNGP(X_{%
i},X_{i})\}_{i=1}^{N}}
\displaystyle\metaNTK_{\mtl}(\X,\X)=\NTK(\X,\X)-\NNGP(\X,\X)+\diag{\{\NNGP(X_{%
i},X_{i})\}_{i=1}^{N}}
\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)=\nabla_{\thetamtl_{0}^{\body}}%
\Fmtl^{\hat{\tau}}_{\thetamtl_{0}}(\xxy)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{%
\thetamtl_{0}}(\X)^{\top}
(1,j)
\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)
\displaystyle\qquad\left[\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\right]_%
{1j}
\displaystyle\qquad\left[\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\right]_%
{1j}
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}F^{\hat{\tau}}_{\thetamtltest_{0}}%
(\xxy)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\X)^{\top}
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}F^{\hat{\tau}}_{\thetamtltest_{0}}%
(\xxy)\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(\X)^{\top}
\displaystyle=\left(\nabla_{\thetamtl_{0}^{\body}}f_{\thetamtltest}(X)-\NNGP(X%
,X^{\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{%
\prime},X^{\prime})\hat{\tau}}\right)\nabla_{\thetamtl_{0}^{\body}}f_{%
\thetamtltest}(X^{\prime})\right)\cdot\nabla_{\thetamtl_{0}^{\body}}\fmtl_{%
\thetamtl_{0}}(X_{j},j)^{\top}
\displaystyle=\left(\nabla_{\thetamtl_{0}^{\body}}f_{\thetamtltest}(X)-\NNGP(X%
,X^{\prime})\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{%
\prime},X^{\prime})\hat{\tau}}\right)\nabla_{\thetamtl_{0}^{\body}}f_{%
\thetamtltest}(X^{\prime})\right)\cdot\nabla_{\thetamtl_{0}^{\body}}\fmtl_{%
\thetamtl_{0}}(X_{j},j)^{\top}
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}f_{\thetamtltest}(X)\nabla_{%
\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}-\NNGP(X,X^{\prime}%
)\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime},X^{%
\prime})\hat{\tau}}\right)\nabla_{\thetamtl_{0}^{\body}}f_{\thetamtltest}(X^{%
\prime})\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}
\displaystyle=\nabla_{\thetamtl_{0}^{\body}}f_{\thetamtltest}(X)\nabla_{%
\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}-\NNGP(X,X^{\prime}%
)\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime},X^{%
\prime})\hat{\tau}}\right)\nabla_{\thetamtl_{0}^{\body}}f_{\thetamtltest}(X^{%
\prime})\nabla_{\thetamtl_{0}^{\body}}\fmtl_{\thetamtl_{0}}(X_{j},j)^{\top}
\displaystyle=\Big{[}\NTK(X,X_{j})-\NNGP(X,X_{j})\Big{]}-\NNGP(X,X^{\prime})%
\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime},X^{\prime%
})\hat{\tau}}\right)\Big{[}\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j})\Big{]}
\displaystyle=\Big{[}\NTK(X,X_{j})-\NNGP(X,X_{j})\Big{]}-\NNGP(X,X^{\prime})%
\NNGP^{-1}(X^{\prime},X^{\prime})\left(I-e^{-\lambda\NNGP(X^{\prime},X^{\prime%
})\hat{\tau}}\right)\Big{[}\NTK(X^{\prime},X_{j})-\NNGP(X^{\prime},X_{j})\Big{]}
\displaystyle=\NTK(X,X_{j})-\NNGP(X,X^{\prime})\T^{\hat{\tau}}_{\NNGP}(X^{%
\prime})\NTK(X^{\prime},X_{j})-\NNGP(X,X^{\prime})\NNGP^{-1}(X^{\prime},X^{%
\prime})e^{-\lambda\NNGP(X^{\prime},X^{\prime})\hat{\tau}}\NNGP(X^{\prime},X_{%
j})\eq
\displaystyle=\NTK(X,X_{j})-\NNGP(X,X^{\prime})\T^{\hat{\tau}}_{\NNGP}(X^{%
\prime})\NTK(X^{\prime},X_{j})-\NNGP(X,X^{\prime})\NNGP^{-1}(X^{\prime},X^{%
\prime})e^{-\lambda\NNGP(X^{\prime},X^{\prime})\hat{\tau}}\NNGP(X^{\prime},X_{%
j})\eq
\displaystyle\left[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\right]_{1j}=%
\left[\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\right]_{1j}e^{-\lambda%
\NNGP(X_{j},X_{j})\tau}
\displaystyle\left[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\right]_{1j}=%
\left[\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\right]_{1j}e^{-\lambda%
\NNGP(X_{j},X_{j})\tau}
\displaystyle\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)=\metaNTK_{\mtl}^{%
\prime}((\xx,\hat{\tau}),\X)\cdot\diag{\{e^{-\lambda\NNGP(X_{j},X_{j})\tau}\}_%
{j=1}^{N}}
\displaystyle\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)=\metaNTK_{\mtl}^{%
\prime}((\xx,\hat{\tau}),\X)\cdot\diag{\{e^{-\lambda\NNGP(X_{j},X_{j})\tau}\}_%
{j=1}^{N}}
\diag{\{e^{-\lambda\NNGP(X_{j},X_{j})\tau}\}_{j=1}^{N}}
j
e^{-\lambda\NNGP(X_{j},X_{j})\tau}
\|f_{\theta_{0}}(x)\|_{2}\leq\|y\|_{2}\leq\cO(0pt^{-\frac{1}{2}})
\lim_{0pt\rightarrow\infty}\nngp_{w_{0}}\rightarrow\NNGP
0pt
\cO(\frac{1}{\sqrt{0pt}})
\cO(\frac{1}{\sqrt{0pt}})
\lambda\tau
t=\infty
\theta_{\infty}
\thetamtl_{\infty}
\task=(\xyxy)
\displaystyle\qquad F_{\anil}(\xxy)-F_{\mtl}(\xxy)
\displaystyle\qquad F_{\anil}(\xxy)-F_{\mtl}(\xxy)
\displaystyle=F_{\thetatest_{\infty}}(\xxy)-F_{\thetamtltest_{\infty}}(\xxy)
\displaystyle=F_{\thetatest_{\infty}}(\xxy)-F_{\thetamtltest_{\infty}}(\xxy)
\displaystyle=\left[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{%
\anil}^{-1}(\X,\X)-\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{\mtl%
}^{-1}(\X,\X)\right]\Y
\displaystyle=\left[\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{%
\anil}^{-1}(\X,\X)-\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{\mtl%
}^{-1}(\X,\X)\right]\Y
\displaystyle\quad-\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{%
\anil}^{-1}(\X,\X)\overbrace{G_{\tau}(\XXY)}^{=\cO(\lambda\tau\Lev(\NNGP))}+%
\cO(\frac{1}{\sqrt{h}})
\displaystyle\quad-\metaNTK_{\anil}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{%
\anil}^{-1}(\X,\X)\overbrace{G_{\tau}(\XXY)}^{=\cO(\lambda\tau\Lev(\NNGP))}+%
\cO(\frac{1}{\sqrt{h}})
\displaystyle=\Big{[}\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\cdot\diag{%
\{e^{-\lambda\NNGP(X_{j},X_{j})\tau}\}_{j=1}^{N}}\diag{\{e^{-\lambda\NNGP(X_{i%
},X_{i})\tau}\}_{i=1}^{N}}^{-1}\NTK(\X,\X)^{-1}\diag{\{e^{-\lambda\NNGP(X_{i},%
X_{i})\tau}\}_{i=1}^{N}}^{-1}
\displaystyle=\Big{[}\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\cdot\diag{%
\{e^{-\lambda\NNGP(X_{j},X_{j})\tau}\}_{j=1}^{N}}\diag{\{e^{-\lambda\NNGP(X_{i%
},X_{i})\tau}\}_{i=1}^{N}}^{-1}\NTK(\X,\X)^{-1}\diag{\{e^{-\lambda\NNGP(X_{i},%
X_{i})\tau}\}_{i=1}^{N}}^{-1}
\displaystyle\quad-\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{\mtl%
}^{-1}(\X,\X)\Big{]}\Y+\cO(\lambda\tau)+\cO(\frac{1}{\sqrt{h}})
\displaystyle\quad-\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\metaNTK_{\mtl%
}^{-1}(\X,\X)\Big{]}\Y+\cO(\lambda\tau)+\cO(\frac{1}{\sqrt{h}})
\displaystyle=\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\left[\NTK(\X,\X)^{%
-1}\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau}\}_{i=1}^{N}}^{-1}-\metaNTK_{\mtl%
}^{-1}(\X,\X)\right]\Y+\cO(\lambda\tau)+\cO(\frac{1}{\sqrt{h}})
\displaystyle=\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\left[\NTK(\X,\X)^{%
-1}\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau}\}_{i=1}^{N}}^{-1}-\metaNTK_{\mtl%
}^{-1}(\X,\X)\right]\Y+\cO(\lambda\tau)+\cO(\frac{1}{\sqrt{h}})
\displaystyle=\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\Big{[}\NTK(\X,\X)^%
{-1}\underbrace{\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau}\}_{i=1}^{N}}^{-1}}_%
{=I+\cO(\lambda\tau\Lev(\NNGP))}-\metaNTK_{\mtl}^{-1}(\X,\X)\Big{]}\Y+\cO(%
\lambda\tau\Lev(\NNGP))+\cO(\frac{1}{\sqrt{h}})
\displaystyle=\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\Big{[}\NTK(\X,\X)^%
{-1}\underbrace{\diag{\{e^{-\lambda\NNGP(X_{i},X_{i})\tau}\}_{i=1}^{N}}^{-1}}_%
{=I+\cO(\lambda\tau\Lev(\NNGP))}-\metaNTK_{\mtl}^{-1}(\X,\X)\Big{]}\Y+\cO(%
\lambda\tau\Lev(\NNGP))+\cO(\frac{1}{\sqrt{h}})
\displaystyle=\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\Big{[}\NTK(\X,\X)^%
{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\Big{]}\Y+\cO(\lambda\tau\Lev(\NNGP))+\cO(%
\frac{1}{\sqrt{h}})\eq
\displaystyle=\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\Big{[}\NTK(\X,\X)^%
{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\Big{]}\Y+\cO(\lambda\tau\Lev(\NNGP))+\cO(%
\frac{1}{\sqrt{h}})\eq
\Lev(\NNGP)\triangleq\max\left(\{\Lev(\NNGP(X_{i},X_{i}))\}_{i=1}^{N}\right)
\lambda\tau
\displaystyle\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X).
\displaystyle\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X).
L
f(x)=o(g(x))
g(x)
f(x)
o(\cdot)
L
\displaystyle\NTK^{(L)}(\X,\X)
\displaystyle\NTK^{(L)}(\X,\X)
\displaystyle\NNGP^{(L)}(\X,\X)=\ones{Nn}{Nn}+\frac{1}{L^{2}}\bB^{(L)}_{\X,\X}
\displaystyle\NNGP^{(L)}(\X,\X)
\displaystyle=\ones{Nn}{Nn}+\frac{1}{L^{2}}\bB^{(L)}_{\X,\X}
\bA^{(L)}_{\X,\X},\bB^{(L)}_{\X,\X}\in\bR^{Nn\times Nn}
\cO(1)
\NTK^{(L)}(\X,\X)
\NNGP^{(L)}(\X,\X)
\NTK
\NNGP
\displaystyle\begin{cases}\Lev(\NTK(\X,\X))=\frac{Nn+3}{4}L+\cO(1)\\
\bulkev(\NTK(\X,\X))=\frac{3}{4}L+\cO(1)\end{cases}\qquad\begin{cases}\Lev(%
\NNGP(\X,\X))=Nn+\cO(\frac{1}{L}^{2})\\
\bulkev(\NNGP(\X,\X))=\cO(\frac{1}{L^{2}})\end{cases}
\displaystyle\begin{cases}\Lev(\NTK(\X,\X))=\frac{Nn+3}{4}L+\cO(1)\\
\bulkev(\NTK(\X,\X))=\frac{3}{4}L+\cO(1)\end{cases}\qquad\begin{cases}\Lev(%
\NNGP(\X,\X))=Nn+\cO(\frac{1}{L}^{2})\\
\bulkev(\NNGP(\X,\X))=\cO(\frac{1}{L^{2}})\end{cases}
\bulkev(\cdot)
\NTK^{\inv}(\X,\X)-\metaNTK_{\mtl}^{\inv}(\X,\X)
L^{*}\in\mathbb{N}^{+}
L\geq L^{*}
\displaystyle\begin{cases}\Lev\left(\NTK^{(L)}(\X,\X)\right)&\simeq\cO(NnL)\gg%
\eval_{2}\left(\NTK^{(L)}(\X,\X)\right)\\
\frac{1}{Nn}\bone{Nn}^{\top}\NTK^{(L)}(\X,\X)\bone{Nn}&\simeq\cO(NnL)\gg\eval_%
{2}\left(\NTK^{(L)}(\X,\X)\right)\\
\Lev\left(\NTK^{(L)}(\X,\X)\right)&\geq\cO(L)\cdot\Lev\left(\NNGP^{(L)}(\X,\X)%
\right)\\
\end{cases}
\displaystyle\begin{cases}\Lev\left(\NTK^{(L)}(\X,\X)\right)&\simeq\cO(NnL)\gg%
\eval_{2}\left(\NTK^{(L)}(\X,\X)\right)\\
\frac{1}{Nn}\bone{Nn}^{\top}\NTK^{(L)}(\X,\X)\bone{Nn}&\simeq\cO(NnL)\gg\eval_%
{2}\left(\NTK^{(L)}(\X,\X)\right)\\
\Lev\left(\NTK^{(L)}(\X,\X)\right)&\geq\cO(L)\cdot\Lev\left(\NNGP^{(L)}(\X,\X)%
\right)\\
\end{cases}
\eval_{2}(\cdot)
\displaystyle\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\leq\cO(%
\frac{1}{L^{2}})
\displaystyle\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\leq\cO(%
\frac{1}{L^{2}})
\displaystyle\metaNTK_{\mtl}(\X,\X)=\NTK(\X,\X)-\NNGP(\X,\X)+\diag{\{\NNGP(X_{%
i},X_{i})\}_{i=1}^{N}}
\displaystyle\metaNTK_{\mtl}(\X,\X)
\displaystyle=\NTK(\X,\X)-\NNGP(\X,\X)+\diag{\{\NNGP(X_{i},X_{i})\}_{i=1}^{N}}
\displaystyle=\NTK(\X,\X)-\wdNNGP(\X,\X)
\displaystyle=\NTK(\X,\X)-\wdNNGP(\X,\X)
\wdNNGP(\X,\X)=\NNGP(\X,\X)+\diag{\{\NNGP(X_{i},X_{i})\}_{i=1}^{N}}
n=1
i\in[N]
\NNGP(X_{i},X_{i})=1+\cO(\frac{1}{L}^{2})\in\bR
\displaystyle\wdNNGP(\X,\X)=\NNGP(\X,\X)-\diag{\{\NNGP(X_{i},X_{i})\}_{i=1}^{N}}
\displaystyle\wdNNGP(\X,\X)
\displaystyle=\NNGP(\X,\X)-\diag{\{\NNGP(X_{i},X_{i})\}_{i=1}^{N}}
\displaystyle=\ones{N}{N}-I+\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}
\displaystyle=\ones{N}{N}-I+\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}
\widetilde{\bB}^{(L)}_{\X,\X}=\bB^{(L)}_{\X,\X}-\left(\diag{\{\NNGP(X_{i},X_{i%
})\}_{i=1}^{N}}-I\right)
\bB^{(L)}_{\X,\X}
\cO(\frac{1}{L}^{2})
\diag{\{\NNGP(X_{i},X_{i})\}_{i=1}^{N}}
\displaystyle\wdNTK(\X,\X)=\NTK(\X,\X)-\left(\wdNNGP(\X,\X)-\ones{N}{N}\right)
\displaystyle\wdNTK(\X,\X)
\displaystyle=\NTK(\X,\X)-\left(\wdNNGP(\X,\X)-\ones{N}{N}\right)
\displaystyle=\NTK(\X,\X)+I-\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}.
\displaystyle=\NTK(\X,\X)+I-\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}.
\displaystyle\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}=\|\NTK(\X,%
\X)^{-1}-\wdNTK^{-1}(\X,\X)+\wdNTK^{-1}(\X,\X)-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}
\displaystyle\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}
\displaystyle=\|\NTK(\X,\X)^{-1}-\wdNTK^{-1}(\X,\X)+\wdNTK^{-1}(\X,\X)-%
\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}
\displaystyle\leq\|\NTK(\X,\X)^{-1}-\wdNTK^{-1}(\X,\X)\|_{\op}+\|\wdNTK^{-1}(%
\X,\X)-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\eq
\displaystyle\leq\|\NTK(\X,\X)^{-1}-\wdNTK^{-1}(\X,\X)\|_{\op}+\|\wdNTK^{-1}(%
\X,\X)-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\eq
\|\NTK(\X,\X)^{-1}-\wdNTK^{-1}(\X,\X)\|_{\op}
\|\wdNTK^{-1}(\X,\X)-\NTK^{-1}(\X,\X)\|_{\op}
\|\metaNTK_{\mtl}^{-1}-\wdNTK^{-1}(\X,\X)\|_{\op}
\displaystyle\metaNTK_{\mtl}^{-1}(\X,\X)=\left(\NTK(\X,\X)-\wdNNGP(\X,\X)%
\right)^{-1}
\displaystyle\metaNTK_{\mtl}^{-1}(\X,\X)
\displaystyle=\left(\NTK(\X,\X)-\wdNNGP(\X,\X)\right)^{-1}
\displaystyle=\Big{(}\big{[}\overbrace{\NTK(\X,\X)+I-\frac{1}{L^{2}}\widetilde%
{\bB}^{(L)}_{\X,\X}-o(\frac{1}{L^{2}})}^{\wdNTK(\X,\X)\triangleq}\big{]}-\ones%
{N}{N}\big{)}^{-1}
\displaystyle=\Big{(}\big{[}\overbrace{\NTK(\X,\X)+I-\frac{1}{L^{2}}\widetilde%
{\bB}^{(L)}_{\X,\X}-o(\frac{1}{L^{2}})}^{\wdNTK(\X,\X)\triangleq}\big{]}-\ones%
{N}{N}\big{)}^{-1}
\displaystyle=\left(\wdNTK(\X,\X)-\ones{N}{N}\right)^{-1}
\displaystyle=\left(\wdNTK(\X,\X)-\ones{N}{N}\right)^{-1}
\displaystyle=\wdNTK(\X,\X)^{-1}-\rho\cdot\wdNTK(\X,\X)^{-1}\ones{N}{N}\wdNTK(%
\X,\X)^{-1}
\displaystyle=\wdNTK(\X,\X)^{-1}-\rho\cdot\wdNTK(\X,\X)^{-1}\ones{N}{N}\wdNTK(%
\X,\X)^{-1}
\rho=\frac{1}{1-\bone{N}^{\top}\wdNTK(\X,\X)^{-1}\bone{N}}
\displaystyle\rho=\frac{1}{1-\bone{N}^{\top}\wdNTK(\X,\X)^{-1}\bone{N}}\simeq%
\frac{1}{1-\cO(\frac{1}{L})}
\displaystyle\rho=\frac{1}{1-\bone{N}^{\top}\wdNTK(\X,\X)^{-1}\bone{N}}
\displaystyle\simeq\frac{1}{1-\cO(\frac{1}{L})}
\displaystyle\wdNTK(\X,\X)^{-1}\ones{N}{N}\wdNTK(\X,\X)^{-1}\simeq\cO\left(%
\frac{1}{N^{2}L^{2}}\right)\ones{N}{N}
\displaystyle\wdNTK(\X,\X)^{-1}\ones{N}{N}\wdNTK(\X,\X)^{-1}
\displaystyle\simeq\cO\left(\frac{1}{N^{2}L^{2}}\right)\ones{N}{N}
\displaystyle\metaNTK_{\mtl}^{-1}(\X,\X)=\wdNTK(\X,\X)^{-1}-\cO\left(\frac{1}{%
N^{2}L^{2}(1-\cO(\frac{1}{L}))}\right)\ones{N}{N}
\displaystyle\metaNTK_{\mtl}^{-1}(\X,\X)=\wdNTK(\X,\X)^{-1}-\cO\left(\frac{1}{%
N^{2}L^{2}(1-\cO(\frac{1}{L}))}\right)\ones{N}{N}
\cO(\frac{1}{NL^{2}(1-\cO(\frac{1}{L})}))
\cO(\frac{1}{NL})
\displaystyle\|\metaNTK_{\mtl}^{-1}(\X,\X)-\wdNTK(\X,\X)^{-1}\|_{\op}=\|\cO%
\left(\frac{1}{N^{2}L^{2}(1-\cO(\frac{1}{L}))}\right)\ones{N}{N}\|_{\op}\leq%
\cO(\frac{1}{NL^{2}})
\displaystyle\|\metaNTK_{\mtl}^{-1}(\X,\X)-\wdNTK(\X,\X)^{-1}\|_{\op}=\|\cO%
\left(\frac{1}{N^{2}L^{2}(1-\cO(\frac{1}{L}))}\right)\ones{N}{N}\|_{\op}\leq%
\cO(\frac{1}{NL^{2}})
\|\wdNTK^{-1}(\X,\X)-\NTK^{-1}(\X,\X)\|_{\op}
\displaystyle\wdNTK(\X,\X)=\Big{(}\overbrace{\frac{L}{4}\ones{N}{Nn}+\frac{3L}%
{4}I+\bA^{(L)}_{\X,\X}}^{\NTK(\X,\X)}\Big{)}-\Big{(}\overbrace{\ones{N}{N}-I+%
\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}}^{\wdNNGP(\X,\X)-\ones{N}{N}}\Big%
{)}
\displaystyle\wdNTK(\X,\X)
\displaystyle=\Big{(}\overbrace{\frac{L}{4}\ones{N}{Nn}+\frac{3L}{4}I+\bA^{(L)%
}_{\X,\X}}^{\NTK(\X,\X)}\Big{)}-\Big{(}\overbrace{\ones{N}{N}-I+\frac{1}{L^{2}%
}\widetilde{\bB}^{(L)}_{\X,\X}}^{\wdNNGP(\X,\X)-\ones{N}{N}}\Big{)}
\displaystyle=\left(\frac{L}{4}-1\right)\ones{N}{N}+\left(\frac{3L}{4}+1\right%
)I+\left(\bA^{(L)}_{\X,\X}-\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}\right)
\displaystyle=\left(\frac{L}{4}-1\right)\ones{N}{N}+\left(\frac{3L}{4}+1\right%
)I+\left(\bA^{(L)}_{\X,\X}-\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}\right)
L
\ones{N}{N}-I+\frac{1}{L^{2}}\widetilde{\bB}^{(L)}_{\X,\X}
\wdNTK(\X,\X)
\NTK(\X,\X)
\wdNTK(\X,\X)
(A+B)^{\inv}=A^{\inv}A^{\inv}B(A+B)^{\inv}
\hDelta=\wdNTK(\X,\X)-\NTK(\X,\X)=\ones{N}{N}-I+\frac{1}{L^{2}}\widetilde{\bB}%
^{(L)}_{\X,\X}
\displaystyle\qquad\left\|\wdNTK(\X,\X)^{-1}-\NTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle\qquad\left\|\wdNTK(\X,\X)^{-1}-\NTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle=\left\|\left(\NTK(\X,\X)+\hDelta\right)^{-1}\right\|_{op}
\displaystyle=\left\|\left(\NTK(\X,\X)+\hDelta\right)^{-1}\right\|_{op}
\displaystyle=\left\|\NTK(\X,\X)^{\inv}+\NTK(\X,\X)^{\inv}\hDelta\left(\NTK(\X%
,\X)+\Delta\right)^{\inv}-\NTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle=\left\|\NTK(\X,\X)^{\inv}+\NTK(\X,\X)^{\inv}\hDelta\left(\NTK(\X%
,\X)+\Delta\right)^{\inv}-\NTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle=\left\|\NTK(\X,\X)^{\inv}\hDelta\wdNTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle=\left\|\NTK(\X,\X)^{\inv}\hDelta\wdNTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle=\left\|\NTK(\X,\X)^{\inv}\left(\ones{N}{N}-I+\frac{1}{L^{2}}%
\widetilde{\bB}^{(L)}_{\X,\X}\right)\wdNTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle=\left\|\NTK(\X,\X)^{\inv}\left(\ones{N}{N}-I+\frac{1}{L^{2}}%
\widetilde{\bB}^{(L)}_{\X,\X}\right)\wdNTK(\X,\X)^{\inv}\right\|_{op}
\displaystyle\leq\left\|\wdNTK(\X,\X)^{-1}\ones{N}{N}\wdNTK(\X,\X)^{-1}\right%
\|_{\op}+\left\|\NTK(\X,\X)^{-1}I\wdNTK(\X,\X)^{-1}\right\|_{\op}+\frac{1}{L}^%
{2}\left\|\wdNTK(\X,\X)^{-1}\widetilde{\bB}^{(L)}_{\X,\X}\wdNTK(\X,\X)^{-1}%
\right\|_{\op}\eq
\displaystyle\leq\left\|\wdNTK(\X,\X)^{-1}\ones{N}{N}\wdNTK(\X,\X)^{-1}\right%
\|_{\op}+\left\|\NTK(\X,\X)^{-1}I\wdNTK(\X,\X)^{-1}\right\|_{\op}+\frac{1}{L}^%
{2}\left\|\wdNTK(\X,\X)^{-1}\widetilde{\bB}^{(L)}_{\X,\X}\wdNTK(\X,\X)^{-1}%
\right\|_{\op}\eq
\displaystyle\leq\cO\left(\frac{1}{NL^{2}}\right)+\cO\left(\frac{1}{L^{2}}%
\right)+\cO\left(\frac{1}{L^{4}}\right)
\displaystyle\leq\cO\left(\frac{1}{NL^{2}}\right)+\cO\left(\frac{1}{L^{2}}%
\right)+\cO\left(\frac{1}{L^{4}}\right)
\displaystyle\leq\cO\left(\frac{1}{L^{2}}\right)\eq
\displaystyle\leq\cO\left(\frac{1}{L^{2}}\right)\eq
\displaystyle\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\leq\|\NTK(%
\X,\X)^{-1}-\wdNTK^{-1}(\X,\X)\|_{\op}+\|\wdNTK^{-1}(\X,\X)-\metaNTK_{\mtl}^{-%
1}(\X,\X)\|_{\op}
\displaystyle\|\NTK(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}
\displaystyle\leq\|\NTK(\X,\X)^{-1}-\wdNTK^{-1}(\X,\X)\|_{\op}+\|\wdNTK^{-1}(%
\X,\X)-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}
\displaystyle\leq\cO(\frac{1}{NL^{2}})+\cO(\frac{1}{L^{2}})=\cO(\frac{1}{L^{2}%
})\eq
\displaystyle\leq\cO(\frac{1}{NL^{2}})+\cO(\frac{1}{L^{2}})=\cO(\frac{1}{L^{2}%
})\eq
n>1
n=1
\left\|\NTK(\X,\X)^{-1}I\wdNTK(\X,\X)^{-1}\right\|_{\op}
\left\|\NTK(\X,\X)^{-1}\diag{\{\ones{n}{n}\}_{i=1}^{N}}\wdNTK(\X,\X)^{-1}%
\right\|_{\op}
\|\diag{\{\ones{n}{n}\}_{i=1}^{N}}\|_{op}=\|\ones{n}{n}\|_{op}=n=\cO(1)~{},
\displaystyle\left\|\NTK(\X,\X)^{-1}\diag{\{\ones{n}{n}\}_{i=1}^{N}}\wdNTK(\X,%
\X)^{-1}\right\|_{\op}\leq\left\|\wdNTK(\X,\X)^{-1}\right\|_{\op}^{2}\left\|%
\diag{\{\ones{n}{n}\}_{i=1}^{N}}\right\|_{\op}
\displaystyle\left\|\NTK(\X,\X)^{-1}\diag{\{\ones{n}{n}\}_{i=1}^{N}}\wdNTK(\X,%
\X)^{-1}\right\|_{\op}
\displaystyle\leq\left\|\wdNTK(\X,\X)^{-1}\right\|_{\op}^{2}\left\|\diag{\{%
\ones{n}{n}\}_{i=1}^{N}}\right\|_{\op}
\displaystyle\leq\cO(\frac{1}{L^{2}})
\displaystyle\leq\cO(\frac{1}{L^{2}})
\displaystyle\qquad\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
\displaystyle\qquad\|F_{\anil}(\xxy)-F_{\mtl}(\xxy)\|_{2}
\displaystyle\leq\|\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\|_{\op}\|\NTK%
(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\|\Y\|_{2}+\cO(\lambda\tau\Lev%
(\NNGP))+\cO(\frac{1}{\sqrt{h}})
\displaystyle\leq\|\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\|_{\op}\|\NTK%
(\X,\X)^{-1}-\metaNTK_{\mtl}^{-1}(\X,\X)\|_{\op}\|\Y\|_{2}+\cO(\lambda\tau\Lev%
(\NNGP))+\cO(\frac{1}{\sqrt{h}})
\displaystyle\leq\cO(\frac{1}{L})+\cO(\lambda\tau)+\cO(\frac{1}{\sqrt{h}})
\displaystyle\leq\cO(\frac{1}{L})+\cO(\lambda\tau)+\cO(\frac{1}{\sqrt{h}})
\|\metaNTK_{\mtl}^{\prime}((\xx,\hat{\tau}),\X)\|_{\op}=\cO(L)
e^{L}
F_{\anil}
F_{\mtl}
e^{L}\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)\cdot(e^{L}\metaNTK%
_{\mtl}(\X,\X))^{-1}=\metaNTK_{\mtl}^{\prime}((X,X^{\prime},\hat{\tau}),\X)%
\metaNTK_{\mtl}(\X,\X)^{-1}
L=10
\lambda\tau=0
\ell_{2}
\ell_{2}
0.33
\ell_{2}
\ell_{2}
0.0001
0.001
\ell_{2}
\ell_{2}
