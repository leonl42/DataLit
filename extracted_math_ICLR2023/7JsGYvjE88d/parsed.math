15
50\%
k
k
k
3
k
\mathtt{t_{lo}}
\mathtt{t_{hi}}
k
T
(k,v)
k
k
k
(s_{0},a_{0}),\ldots,(s_{n-1},a_{n-1}),s_{n}
k
s_{i}
s_{i+k}
s_{i}
(i-n)
(s_{i},s_{i+d})
a_{i}
d\leq k_{\textrm{max}}
k_{\textrm{max}}
\mathtt{t_{hi}}=1
\mathtt{t_{lo}}=0
C_{1}
V
\rho_{k_{0}},\ldots,\rho_{k_{m}}
\Call{Solved}{}
\mathtt{s_{0}}
\mathtt{T}\leftarrow\emptyset
\mathtt{parents}\leftarrow\{\}
k
k_{0},\ldots,k_{m}
\mathtt{T}
((k,V(\mathtt{s_{0}})),\mathtt{s_{0}})
\mathtt{seen}.\Call{add}{\mathtt{s_{0}}}
\mathtt{seen}
0<\Call{{len}}{\mathtt{T}}\text{ and }\Call{{len}}{\mathtt{seen}}<C_{1}
(k,\_),\mathtt{s}\leftarrow\mathtt{T}.\Call{extract\_max}{}
\mathtt{subgoals}\leftarrow\rho_{k}(\mathtt{s})
\mathtt{s^{\prime}}\textbf{ in }\mathtt{subgoals}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{seen}
\Call{is\_valid}{\mathtt{s,s^{\prime}}}
\mathtt{seen}.\Call{add}{\mathtt{s^{\prime}}}
\mathtt{parents}[\mathtt{s^{\prime}}]\leftarrow s
k
k_{0},\ldots,k_{m}
\texttt{T}.\Call{push}{((k,V(\mathtt{s^{\prime}})),\mathtt{s^{\prime}})}
\Call{solved}{\mathtt{s^{\prime}}}
s^{\prime},\mathtt{parents}
\mathtt{False}
C_{2}
\pi
M
\mathtt{s_{0}}
\mathtt{subgoal}
\mathtt{step}\leftarrow 0,\;\mathtt{s}\leftarrow\mathtt{s_{0}}
\mathtt{action\_path}\leftarrow[]
\mathtt{step}<C_{2}
\mathtt{action}\leftarrow\pi.\Call{predict}{\mathtt{s},\mathtt{subgoal}}
\mathtt{action\_path}.\Call{append}{\mathtt{action}}
\mathtt{s}\leftarrow M.\Call{next\_state}{\mathtt{s,action}}
\mathtt{s}=\mathtt{subgoal}
\mathtt{action\_path}
\mathtt{step}\leftarrow\mathtt{step}+1
[]
v
\mathtt{t_{hi}}
\mathtt{t_{lo}}
\mathtt{s,s^{\prime}}
v(\mathtt{s,s^{\prime}})>\mathtt{t_{hi}}
\mathtt{True}
v(\mathtt{s,s^{\prime}})<\mathtt{t_{lo}}
\mathtt{False}
\Call{get\_path}{\mathtt{s},\mathtt{s^{\prime}}}\neq[]
12\times 12
4.3\times 10^{19}
20
1000
A^{*}
\mathtt{t_{lo}}=0
\mathtt{t_{hi}}=1
20
15
20
15
50
60\%
10\%
50
90\%
\sim
95\%
100\%
93\%
15
9\%
15
15
28
50\%
3.5\%
21
20
5000
15
95\%
5000
15
95\%
8
91.8\%
4
7.4\%
2
0.8\%
8
4
2
6.9
3.9
2.0
1.7\%
36.7\%
k=4
2.2\%
0.1\%
82.4\%
83.0\%
k=3
4.0\%
0.2\%
89.6\%
90.7\%
k=2
2.1\%
0.5\%
89.8\%
91.7\%
k=1
0.0\%
0.0\%
34.7\%
46.0\%
k=[4,3,2]
0.0\%
0.0\%
94.6\%
95.0\%
k=[3,2,1]
0.0\%
0.0\%
92.2\%
92.9\%
k=[3,2]
17.0\%
14.8\%
92.2\%
93.5\%
\text{iterations}=[1,1,1]
32.0\%
30.1\%
87.0\%
88.6\%
\text{iterations}=[10,1,1]
43.0\%
44.8\%
95.1\%
96.0\%
\text{iterations}=[4,2,1]
54.0\%
52.1\%
93.6\%
95.5\%
39.5\%
40.8\%
88.5\%
89.8\%
59.0\%
51.5\%
95.7\%
95.5\%
0.0\%
1.8\%
28.8\%
98.6\%
49.1\%
99.2\%
50.6\%
99.1\%
33.4\%
99.0\%
58.0\%
99.2\%
45.9\%
26.0\%
4.7\%
52.7\%
37.7\%
64.5\%
52.6\%
54.6\%
41.9\%
72.2\%
63.4\%
k=[3,2,1]
1000
\pm 3\%
95\%
k=[3,2,1]
1000
\pm 3\%
95\%
n
\rho_{k_{1}},\ldots,\rho_{k_{n}}
k_{1}<\ldots<k_{n}
\rho_{k_{i}}
\texttt{subgoals}\leftarrow\cup_{j=1}^{n}\rho_{k_{j}}(\texttt{s})
V(s)
i
l_{i}
l_{1},\ldots,l_{n}
\texttt{subgoals}\leftarrow\rho_{k_{\ell}}(\texttt{s})
k_{\ell}
V(s)
k
V(s)
k
\Call{LL\_PATH}{}
\mathtt{s,parents}
\mathtt{parents}
\in
\mathtt{parents}
\mathtt{path}\leftarrow[]
\mathtt{s}\textbf{ in }\mathtt{parents}.\Call{keys}{}
\mathtt{subgoal\_path}\leftarrow\Call{get\_path}{\mathtt{parents}[\mathtt{s}],%
\mathtt{s}}
\mathtt{subgoal\_path}=[]
\mathtt{path}\leftarrow\mathtt{concatenate}(\mathtt{subgoal\_path},\mathtt{%
path})
\mathtt{s}\leftarrow\mathtt{parents}[\mathtt{s}]
\mathtt{path}
\beta_{1}=0.9
\beta_{2}=0.999
\epsilon=10^{-8}
3\cdot 10^{-4}
10^{-4}
200
\beta_{1}=0.9
\beta_{2}=0.999
\epsilon=10^{-7}
1000
98.8
97.1
99.2
99.2
99
98.5
6085
852
8872
2205
1244
680
0
0
277
275
311
340
1330
1526
352
350
395
446
259
285
163
162
181
197
7675
2664
9666
2994
2133
1665
86.3
49.9
96.1
49.2
47.3
37.3
1000
1000
84.4
84.6
82.3
94
94
94.1
2500
1281
746
3389
1692
848
0
0
0
211
211
212
4576
4693
5554
248
247
247
183
187
216
82
82
82
7260
6161
6301
3931
2233
1391
48.7
36.6
33.6
54.4
39.3
30.6
1000
1000
90.7
89.7
96
96
95.3
107
26.0
362
166
76.3
0
0
67.9
62.2
57.2
378
366
801
738
659
6.9
6.6
14.0
13.0
11.9
492
399
1245
974
805
15.3
12.1
43.8
31.9
31.1
1000
1000
93.4
102
0
19
328
300
6.2
5.6
428
427
154000
15
\mathcal{D}
\mathcal{D}
\mathcal{D}_{1}
\mathcal{D}_{2}
2\cdot 10^{6}
10^{7}
\mathtt{t_{hi}}=1
\mathtt{t_{lo}}=0
\mathcal{D}_{1}
\mathcal{D}_{2}
\mathcal{D}_{2}
\mathcal{D}_{2}
5\cdot 10^{6}
A^{*}
\rho_{k}
\rho_{BFS}
\rho_{BFS}
\rho_{BFS}
98\%
V
\rho_{BFS}
\Call{Solved}{}
\mathtt{s_{0}}
\mathtt{T}\leftarrow\emptyset
\mathtt{parents}\leftarrow\{\}
\mathtt{T}
(V(\mathtt{s_{0}}),\mathtt{s_{0}})
\mathtt{seen}.\Call{add}{\mathtt{s_{0}}}
\mathtt{seen}
0<\Call{{len}}{\mathtt{T}}\text{ and }\Call{{len}}{\mathtt{seen}}<C_{1}
\_,\mathtt{s}\leftarrow\mathtt{T}.\Call{extract\_max}{}
\mathtt{actions}\leftarrow\rho_{BFS}(\mathtt{s})
\mathtt{a}\textbf{ in }\mathtt{actions}
\mathtt{s^{\prime}}\leftarrow\Call{env\_step}{\mathtt{s},\mathtt{a}}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{seen}
\Call{is\_valid}{\mathtt{s,s^{\prime}}}
\mathtt{seen}.\Call{add}{\mathtt{s^{\prime}}}
\mathtt{parents}[\mathtt{s^{\prime}}]\leftarrow s
\texttt{T}.\Call{push}{(V(\mathtt{s^{\prime}}),\mathtt{s^{\prime}})}
\Call{solved}{\mathtt{s^{\prime}}}
s^{\prime},\mathtt{parents}
\mathtt{False}
\mathtt{t_{lo}}=0
\mathtt{t_{hi}}=1
10^{-4}
3\cdot 10^{-4}
3\cdot 10^{-4}
10^{-4}
k
C_{2}
C_{1}
t_{hi}
t_{lo}
k
C_{2}
C_{1}
t_{hi}
t_{lo}
k
C_{2}
C_{1}
t_{hi}
t_{lo}
C_{1}
[10^{-5};10^{-3}]
k
k
k
26
15
k
k
k=[8,4,2]
k=[4,3,2]
k=[3,2,1]
\{1,2,3\}
\{2,3,4\}
15
k
k=8
k=4
99\%
99\%
[0;0.1]
[0.9;1]
25
s
g
k
s_{0},s_{1},\ldots,s_{n}
s_{n}
s_{i}
k
s_{i+k}
k
k
k
k
k
k
s_{i},s_{j}
d
a_{i}
s_{i}
s_{j}
d
d
d
95\%
k
k
V:\mathcal{S}\to\mathbb{R}
s
g
s_{0},\ldots,s_{n}
i-n
s_{i}
k
k
k
k
k
k
90\%
4
16
50\%
82\%
4
3
99\%
k
p
p>t_{hi}
p<t_{lo}
p\in[t_{lo},t_{hi}]
t_{hi}
t_{hi}=0.99
97\%
t_{lo}
t_{lo}=0.1
99\%
p\in[t_{lo},t_{hi}]
70\%
k
k
\rho_{k_{0}},\ldots,\rho_{k_{m}}
k
\rho_{k_{0}}
\rho_{k_{m}}
100\%
l_{i}
\rho_{k_{i}}
\rho_{k_{0}}
l_{0}
\rho_{k_{1}}
l_{1}
l_{i}
\rho_{k_{0}},\ldots,\rho_{k_{m}}
l_{0},\ldots,l_{m}
\mathtt{s_{0}}
\mathtt{T}\leftarrow\emptyset
\mathtt{parents}\leftarrow\{\}
\mathtt{T}
(V(\mathtt{s_{0}}),\mathtt{s_{0}})
\mathtt{seen}.\Call{add}{\mathtt{s_{0}}}
0<\Call{{len}}{\mathtt{T}}\text{ and }\Call{{len}}{\mathtt{seen}}<C_{1}
\_,\mathtt{s}\leftarrow\mathtt{T}.\Call{extract\_max}{}
\mathtt{subgoals}\leftarrow\{\rho_{k_{1}}(\mathtt{s}),\ldots,\rho_{k_{m}}(%
\mathtt{s})\}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{subgoals}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{seen}
\Call{is\_valid}{\mathtt{s,s^{\prime}}}
\mathtt{seen}.\Call{add}{\mathtt{s^{\prime}}}
\mathtt{parents}[\mathtt{s^{\prime}}]\leftarrow s
\texttt{T}.\Call{push}{(V(\mathtt{s^{\prime}}),\mathtt{s^{\prime}})}
\Call{solved}{\mathtt{s^{\prime}}}
s^{\prime},\mathtt{parents}
\mathtt{False}
\mathtt{s_{0}}
\mathtt{T_{k_{i}}}\leftarrow\emptyset
m+1
\mathtt{parents}\leftarrow\{\}
k
k_{0},\ldots,k_{m}
\mathtt{T_{k}}
(V(\mathtt{s_{0}}),\mathtt{s_{0}})
\mathtt{seen}.\Call{add}{\mathtt{s_{0}}}
\mathtt{cnt}\leftarrow 0
\mathtt{id}\leftarrow 0
0<\Call{{len}}{\mathtt{T}}\text{ and }\Call{{len}}{\mathtt{seen}}<C_{1}
\mathtt{cnt}=l_{\mathtt{id}}
\Call{{len}}{T_{k_{\mathtt{id}}}}=0
\mathtt{id}\leftarrow(\mathtt{id}+1)\%(m+1)
\mathtt{cnt}\leftarrow 0
\mathtt{cnt}\leftarrow\mathtt{cnt}+1
\_,\mathtt{s}\leftarrow\mathtt{T_{k_{\mathtt{id}}}}.\Call{extract\_max}{}
\mathtt{subgoals}\leftarrow\rho_{k_{\mathtt{id}}}(\mathtt{s})
\mathtt{s^{\prime}}\textbf{ in }\mathtt{subgoals}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{seen}
\Call{is\_valid}{\mathtt{s,s^{\prime}}}
\mathtt{seen}.\Call{add}{\mathtt{s^{\prime}}}
\mathtt{parents}[\mathtt{s^{\prime}}]\leftarrow s
k
k_{0},\ldots,k_{m}
\mathtt{T_{k}}.\Call{push}{(V(\mathtt{s^{\prime}}),\mathtt{s^{\prime}})}
\Call{solved}{\mathtt{s^{\prime}}}
s^{\prime},\mathtt{parents}
\mathtt{False}
\mathtt{s_{0}}
\mathtt{T}\leftarrow\emptyset
\mathtt{parents}\leftarrow\{\}
k
k_{0},\ldots,k_{m}
\mathtt{T}
((V(\mathtt{s_{0}}),k),\mathtt{s_{0}})
\mathtt{seen}.\Call{add}{\mathtt{s_{0}}}
0<\Call{{len}}{\mathtt{T}}\text{ and }\Call{{len}}{\mathtt{seen}}<C_{1}
(\_,k),\mathtt{s}\leftarrow\mathtt{T}.\Call{extract\_max}{}
\mathtt{subgoals}\leftarrow\rho_{k}(\mathtt{s})
\mathtt{s^{\prime}}\textbf{ in }\mathtt{subgoals}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{seen}
\Call{is\_valid}{\mathtt{s,s^{\prime}}}
\mathtt{seen}.\Call{add}{\mathtt{s^{\prime}}}
\mathtt{parents}[\mathtt{s^{\prime}}]\leftarrow s
k
k_{0},\ldots,k_{m}
\texttt{T}.\Call{push}{((V(\mathtt{s^{\prime}}),k),\mathtt{s^{\prime}})}
\Call{solved}{\mathtt{s^{\prime}}}
s^{\prime},\mathtt{parents}
\mathtt{False}
\mathtt{s_{0}}
\mathtt{T}\leftarrow\emptyset
\mathtt{parents}\leftarrow\{\}
k
k_{0},\ldots,k_{m}
\mathtt{T}
((k,V(\mathtt{s_{0}})),\mathtt{s_{0}})
\mathtt{seen}.\Call{add}{\mathtt{s_{0}}}
0<\Call{{len}}{\mathtt{T}}\text{ and }\Call{{len}}{\mathtt{seen}}<C_{1}
(k,\_),\mathtt{s}\leftarrow\mathtt{T}.\Call{extract\_max}{}
\mathtt{subgoals}\leftarrow\rho_{k}(\mathtt{s})
\mathtt{s^{\prime}}\textbf{ in }\mathtt{subgoals}
\mathtt{s^{\prime}}\textbf{ in }\mathtt{seen}
\Call{is\_valid}{\mathtt{s,s^{\prime}}}
\mathtt{seen}.\Call{add}{\mathtt{s^{\prime}}}
\mathtt{parents}[\mathtt{s^{\prime}}]\leftarrow s
k
k_{0},\ldots,k_{m}
\texttt{T}.\Call{push}{((k,V(\mathtt{s^{\prime}})),\mathtt{s^{\prime}})}
\Call{solved}{\mathtt{s^{\prime}}}
s^{\prime},\mathtt{parents}
\mathtt{False}
k
k
s_{i}
s_{t(i)}
s_{i}
s_{t(i)}
s_{i}
s_{i}
s_{i+1}
s_{i+2}
s_{j}
t(i)
j-1
25\%
90\%
[3,2,1]
[4,3,2]
[8,4,2]
1.7\%
36.7\%
2.2\%
0.1\%
82.4\%
83.0\%
4.0\%
0.2\%
89.6\%
90.7\%
2.1\%
0.5\%
89.8\%
91.7\%
0.0\%
0.0\%
34.7\%
46.0\%
0.0\%
0.0\%
94.6\%
95.0\%
0.0\%
0.0\%
92.2\%
92.9\%
17.0\%
14.8\%
92.2\%
93.5\%
32.0\%
30.1\%
87.0\%
88.6\%
43.0\%
44.8\%
95.1\%
96.0\%
54.0\%
52.1\%
93.6\%
95.5\%
39.5\%
40.8\%
88.5\%
89.8\%
59.0\%
51.5\%
95.7\%
95.5\%
0.0\%
1.8\%
28.8\%
24.5\%
98.6\%
98.8\%
19.3\%
18.6\%
95.6\%
95.4\%
8.2\%
4.5\%
99.0\%
95.8\%
0.5\%
0.5\%
76.5\%
76.5\%
29.1\%
20.9\%
99.1\%
100.0\%
49.1\%
45.1\%
99.2\%
100.0\%
33.5\%
23.0\%
99.2\%
100.0\%
50.6\%
43.6\%
99.1\%
99.9\%
48.4\%
41.2\%
99.2\%
100.0\%
33.4\%
27.1\%
99.0\%
99.9\%
58.0\%
52.4\%
99.2\%
100.0\%
45.9\%
82.6\%
13.7\%
5.1\%
60.5\%
63.5\%
26.0\%
4.7\%
85.6\%
84.4\%
8.2\%
2.6\%
68.1\%
65.5\%
1.4\%
0.7\%
40.0\%
38.3\%
52.7\%
37.7\%
91.7\%
90.2\%
55.6\%
44.9\%
89.1\%
89.0\%
52.7\%
37.7\%
91.7\%
90.2\%
68.3\%
58.6\%
92.5\%
92.1\%
64.5\%
52.6\%
93.5\%
93.2\%
54.6\%
41.9\%
92.0\%
90.8\%
72.2\%
63.4\%
93.4\%
93.6\%
32
11
2.60
128
10
7\cdot 10^{9}
4\cdot 10^{19}
99\%
87\%
82\%
74\%
74\%
67\%
56\%
5000
95\%
5000
95\%
