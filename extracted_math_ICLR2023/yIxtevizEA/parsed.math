\Omega(\mathcal{T})
B
\mathbf{T}=\{\mathcal{T}_{i}\}_{i=1}^{B}
\Omega(\mathcal{T})
\mathcal{T}_{i}
\mathcal{X}
\mathcal{Y}
\mathcal{L}
q
\mathcal{X}
\mathcal{Y}
\mathcal{L}
q(x,y)
\mathcal{T}_{i}\in\mathbf{T}
q_{\mathcal{T}_{i}}
\mathcal{D}_{i}^{\text{context}}=\{(x,y)^{i,j}\}_{j=1}^{N}
\mathcal{D}_{i}^{\text{target}}=\{(x,y)^{i,j}\}_{j=1}^{M}
N
M
f
p_{\theta}(y|x,\mathcal{D}^{\text{context}})
\theta
N+M
N
M
N^{2}+NM
N^{2}
NM
N+M
N
M
N^{2}+NM
N^{2}
NM
(N+M)K
KN
KM
(N^{2}+NM)K
KN^{2}
KNM
(N+M)^{2}
(N+M)^{2}
N^{2}+NM
N^{2}
NM
(N+M+L)L
NL+L^{2}
ML
N
M
L
K
L
K
N
M
L
K
L
K
p(y|x,\mathcal{D}_{\text{context}}):=p(y|x,r_{C})
r_{C}:=\mathrm{Agg}(\mathcal{D}_{\text{context}})
\mathrm{Agg}
\mathcal{D}_{\text{context}}
\mathrm{DEEPSETs}
r_{C}
p(y_{i}|x_{i},\mathcal{D}_{\text{context}})
p(y_{1,\ldots,M}|x_{1,\ldots,M},D_{\text{context}})
p(y_{1,\ldots,M}|x_{1,\ldots,M},D_{\text{context}}):=p(y_{1,\ldots,M}|r_{C,T})
r_{C,T}:=\mathrm{Agg}(x_{C},y_{C},x_{T})
\mathrm{Agg}
r_{C,T}
O((N+M)^{2})
N
M
N
M
O((N+M)^{2})
O(NM)
L\times D_{L}
\mathrm{LEMB}
\mathrm{LEMB}_{0}
L\times D_{L}
L
D_{L}
\mathrm{CONTEXT}
\displaystyle\mathrm{LEMB}_{i}=\mathrm{SelfAttention}(\mathrm{CrossAttention}(%
\mathrm{LEMB}_{i-1},\mathrm{CONTEXT}))
\displaystyle\mathrm{LEMB}_{i}
\displaystyle=\mathrm{SelfAttention}(\mathrm{CrossAttention}(\mathrm{LEMB}_{i-%
1},\mathrm{CONTEXT}))
O(NL)
L
O(L^{2})
O(NL+L^{2})=O(N)
L
\mathrm{LEMB}_{i}
\displaystyle\mathrm{QEMB}_{0}=\mathrm{QUERY}
\displaystyle\mathrm{QEMB}_{0}
\displaystyle=\mathrm{QUERY}
\displaystyle\mathrm{QEMB}_{i}=\mathrm{CrossAttention}(\mathrm{QEMB}_{i-1},%
\mathrm{LEMB}_{i})
\displaystyle\mathrm{QEMB}_{i}
\displaystyle=\mathrm{CrossAttention}(\mathrm{QEMB}_{i-1},\mathrm{LEMB}_{i})
\displaystyle\mathrm{Output}=\mathrm{Predictor}(\mathrm{QEMB_{K}})
\displaystyle\mathrm{Output}
\displaystyle=\mathrm{Predictor}(\mathrm{QEMB_{K}})
\mathrm{QEMB}
L
O(1)
M
O(M)
\mathrm{LEMB}
L=8
L=128
x
y
x
y
[-0.5,0.5]
32\times 32
10
N\sim\mathcal{U}[3,197)
M\sim\mathcal{U}[3,200-N)
32\times 32
N\sim\mathcal{U}[3,197)
M\sim\mathcal{U}[3,200-N)
64\times 64
N\sim\mathcal{U}[3,797)
M\sim\mathcal{U}[3,800-N)
128\times 128
N\sim\mathcal{U}[3,1597)
M\sim\mathcal{U}[3,1600-N)
8
32\times 32
64\times 64
128\times 128
(N+M)_{max}
128\times 128
L=8=0.5\%(N+M)_{max}
L=128=8\%(N+M)_{max}
N
f
M
B=16
f_{i}\sim GP(m,k)
m(x)=0
k(x,x^{\prime})=\sigma_{f}^{2}\mathrm{exp}\left(-\frac{(x-x^{\prime})^{2}}{2l^%
{2}}\right)
l
\sigma_{f}
l\sim\mathcal{U}[0.6,1.0)
\sigma_{f}\sim\mathcal{U}[0.1,1.0)
N\sim\mathcal{U}[3,47)
M\sim\mathcal{U}[3,50-N)
5/2
N
M
8
L=8=16\%(N+M)_{max}
L=128=256\%(N+M)_{max}
\delta
5
X
||X||<\delta
1
r\sim\mathcal{N}(1.2,0.012)
r\sim\mathcal{N}(1.0,0.012)
||X||>\delta
N\sim\mathcal{N}(50.0,0.012)
1
r\sim\mathcal{N}(1.2,0.012)
3
r\sim\mathcal{N}(1.0,0.012)
B=8
\{\delta_{i}\}_{i=1}^{B}
\delta\sim\mathcal{U}(0,1)
M=50
N=512
(X,r)
X
r
5
\delta
50
\delta
2000
\delta
\delta=0.95
8
\delta=0.7,0.9,0.95
L=8=0.4\%(N+M)_{max}
L=128=6.4\%(N+M)_{max}
\delta=0.7
\delta=0.9
\delta=0.95
\delta=0.99
\delta=0.995
\delta
\delta
\delta
\delta
32\times 32
8
256
128
8
128
256
8
N=1400
L=128
1172
13730
L
\displaystyle\mathrm{CEMB}_{0}=\mathrm{CONTEXT}
\displaystyle\mathrm{CEMB}_{0}
\displaystyle=\mathrm{CONTEXT}
\displaystyle\mathrm{CEMB}_{i}=\mathrm{SelfAttention}(\mathrm{CEMB}_{i-1})
\displaystyle\mathrm{CEMB}_{i}
\displaystyle=\mathrm{SelfAttention}(\mathrm{CEMB}_{i-1})
O(N)
O(N^{2})
K
\{\mathrm{CEMB}_{1},\ldots,\mathrm{CEMB}_{K}\}
\{\mathrm{CEMB}_{1},\ldots,\mathrm{CEMB}_{K}\}
\displaystyle\mathrm{QEMB}_{0}=\mathrm{QUERY}
\displaystyle\mathrm{QEMB}_{0}
\displaystyle=\mathrm{QUERY}
\displaystyle\mathrm{QEMB}_{i}=\mathrm{CrossAttention}(\mathrm{QEMB}_{i-1},%
\mathrm{CEMB}_{i})
\displaystyle\mathrm{QEMB}_{i}
\displaystyle=\mathrm{CrossAttention}(\mathrm{QEMB}_{i-1},\mathrm{CEMB}_{i})
\displaystyle\mathrm{Output}=\mathrm{Predictor}(\mathrm{QEMB_{K}})
\displaystyle\mathrm{Output}
\displaystyle=\mathrm{Predictor}(\mathrm{QEMB_{K}})
\mathrm{CEMB}
O(NM)
N
M
O(M)
N+M
N
M
N^{2}+NM
N^{2}
NM
N+M
N
M
N^{2}+NM
N^{2}
NM
N+M
N
M
N^{2}+NM
N^{2}
NM
(N+M)^{2}
(N+M)^{2}
N^{2}+NM
N^{2}
NM
(N+M+L)L
NL+L^{2}
ML
(N+M)^{2}
N^{2}
(N+M)^{2}
N+M^{2}
N
M^{2}
N+M^{2}
N
M^{2}
N
M
L
K
L
K
N
M
L
K
L
K
D_{C}
D_{L}
D_{C}
D_{C}=D_{L}=D_{Q}=64
64
D_{c}=D_{Q}=64
L
L=8
L=128
512
N
N=1400
L=128
1172
13730
N
M
N
M
N
M
N
M
N
M
L=128
L=8
\mathrm{LQEMB}
\mathrm{LQEMB_{0}}
\displaystyle\mathrm{LQEMB}_{i}=\mathrm{SelfAttention}(\mathrm{CrossAttention}%
(\mathrm{LQEMB}_{i-1},\mathrm{QEMB}_{K}))
\displaystyle\mathrm{LQEMB}_{i}
\displaystyle=\mathrm{SelfAttention}(\mathrm{CrossAttention}(\mathrm{LQEMB}_{i%
-1},\mathrm{QEMB}_{K}))
\displaystyle\mathrm{Output}=\mathrm{Predictor}(\mathrm{CrossAttention}(%
\mathrm{QEMB}_{K},\mathrm{LQEMB}_{Q}))
\displaystyle\mathrm{Output}
\displaystyle=\mathrm{Predictor}(\mathrm{CrossAttention}(\mathrm{QEMB}_{K},%
\mathrm{LQEMB}_{Q}))
Q
32\times 32
64\times 64
