Z
\mathcal{L}_{IB}=-I\left(Z;Y\right)+\alpha I\left(Z;X\right),
I(Z;Y)
Y
Z
I(Z;X)
X
Z
X
Z
I(Z,Y)
I(Z,X)
I\left(Z,Y\right)\,\,\geq\,\,\int{dxdydz\,\,p\left(x\right)p\left(y|x\right)p%
\left(z|x\right)\log q\left(y|z\right)}=\mathbb{E}_{q\left(y,t\right)}\log p%
\left(y|t\right),
I\left(Z,X\right)\,\,\leq\,\,\int{dxdz\,\,p\left(x\right)p\left(z|x\right)\log%
\frac{p\left(z|x\right)}{r\left(z\right)}},
r(z)
Z
\displaystyle\mathcal{L}_{IB}\approx\frac{1}{N}\sum_{n=1}^{N}{\left[\int{d}zp%
\left(z\mid x_{n}\right)\log q\left(y_{n}\mid z\right)-\alpha p\left(z\mid x_{%
n}\right)\log\frac{p\left(z\mid x_{n}\right)}{r(z)}\right]}
\displaystyle\mathcal{L}_{IB}
\displaystyle\approx\frac{1}{N}\sum_{n=1}^{N}{\left[\int{d}zp\left(z\mid x_{n}%
\right)\log q\left(y_{n}\mid z\right)-\alpha p\left(z\mid x_{n}\right)\log%
\frac{p\left(z\mid x_{n}\right)}{r(z)}\right]}
\displaystyle=\frac{1}{N}\sum_{n=1}^{N}{\mathbb{E}_{\epsilon\sim p(\epsilon)}}%
\left[-\log q\left(y_{n}\mid f\left(x_{n},\epsilon\right)\right)\right]+\alpha%
\mathrm{KL}\left[p\left(Z\mid x_{n}\right),r(Z)\right],
\displaystyle=\frac{1}{N}\sum_{n=1}^{N}{\mathbb{E}_{\epsilon\sim p(\epsilon)}}%
\left[-\log q\left(y_{n}\mid f\left(x_{n},\epsilon\right)\right)\right]+\alpha%
\mathrm{KL}\left[p\left(Z\mid x_{n}\right),r(Z)\right],
X
Y
S
X\leftarrow S\rightarrow Y
X
Y
X
Y
S
Y
Y
X
X
S
x=w_{sx}s+u_{x}
x
s
w_{sx}
S
X
u_{x}
Y
X
S
y=w_{xy}x+w_{sy}s+u_{y}
w_{xy}
X
Y
w_{sy}
S
Y
u_{y}
Y
X
Y
S
R
X
R
S
x_{r}=w_{sx}s+w_{rx}r+u_{x}
y_{r}=w_{xy}x_{r}+w_{sy}s+u_{y}
r
w_{rx}
R
X
S
CDE=P\left(Y=y|do\left(X=x_{i}\right),do\left(S=s\right)\right)-P\left(Y=y|do%
\left(X=x_{j}\right),do\left(S=s\right)\right),
i
j
y_{r_{i}}-y_{r_{j}}=w_{xy}\left(x_{r_{i}}-x_{r_{j}}\right),
w_{xy}
w_{xy}=\frac{y_{r_{i}}-y_{r_{j}}}{x_{r_{i}}-x_{r_{j}}}.
Y
R
Y[X=x_{r}]=w_{xy}x_{r}+w_{sy}s=w_{sy}s+w_{xy}w_{sx}s+w_{rx}w_{xy}r=Y[X=x]+w_{%
rx}w_{xy}r.
w_{xy_{i}}=w_{rx}w_{xy}=\frac{Y\left[X=x_{r_{i}}\right]-Y\left[X=x\right]}{r_{%
i}},
x_{r_{i}}
i
X
r
R
S
\mathcal{L}_{causal}=\sum_{i\neq j}{||w_{xy_{i}}-w_{xy_{j}}||}.
\mathcal{L}_{CausalIB}=\mathcal{L}_{IB}+\mathcal{L}_{causal}\\
\,\,=-I\left(Z;Y\right)+\alpha I\left(Z;X\right)+\beta\sum_{i\neq j}{||w_{xy_{%
i}}-w_{xy_{j}}||}.
X
w_{xy}
w_{sy}
\alpha
\beta
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
L_{1}
\pm
\pm
\pm
L_{2}
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
L_{1}
L_{2}
\beta
\beta
\beta
\alpha
\alpha
\alpha
\epsilon=8/255
L_{inf}
L_{2}
L_{inf}
L_{2}
L_{inf}
L_{2}
L_{inf}
L_{2}
X
Y
Z
\mathcal{L}_{IB}=-I\left(Z;Y\right)+\alpha I\left(Z;X\right).
I\left(Z;Y\right)
I(Z,Y)=\int dydzp(y,z)\log\frac{p(y,z)}{p(y)p(z)}=\int dydzp(y,z)\log\frac{p(y%
\mid z)}{p(y)},
p(y\mid z)
Y\leftrightarrow X\leftrightarrow Z
p(y\mid z)=\int dxp(x,y\mid z)=\int dxp(y\mid x)p(x\mid z)=\int dx\frac{p(y%
\mid x)p(z\mid x)p(x)}{p(z)}.
p(y\mid z)
q(y\mid z)
p(y\mid z)
\mathrm{KL}[p(Y\mid Z),q(Y\mid Z)]\geq 0\Longrightarrow\int dyp(y\mid z)\log p%
(y\mid z)\geq\int dyp(y\mid z)\log q(y\mid z),
I(Z,Y)
\displaystyle I(Z,Y)\geq\int{d}ydzp(y,z)\log\frac{q(y\mid z)}{p(y)}
\displaystyle I(Z,Y)
\displaystyle\geq\int{d}ydzp(y,z)\log\frac{q(y\mid z)}{p(y)}
\displaystyle=\int{d}ydzp(y,z)\log q(y\mid z)-\int{d}yp(y)\log p(y)
\displaystyle=\int{d}ydzp(y,z)\log q(y\mid z)-\int{d}yp(y)\log p(y)
\displaystyle=\int{d}ydzp(y,z)\log q(y\mid z)+H(Y).
\displaystyle=\int{d}ydzp(y,z)\log q(y\mid z)+H(Y).
p(y,z)
p(y,z)=\int{dxp\left(x,y,z\right)=\int{dxp\left(x\right)p\left(y|x\right)p%
\left(z|x\right)}},
I(Z,Y)\geq\int dxdydzp(x)p(y\mid x)p(z\mid x)\log q(y\mid z).
I\left(Z;X\right)
I(Z,X)=\int dzdxp(x,z)\log\frac{p(z\mid x)}{p(z)}=\int dzdxp(x,z)\log p(z\mid x%
)-\int dzp(z)\log p(z).
p\left(z\right)=\int{dxp\left(z|x\right)p\left(x\right)}
r(z)
I(Z,X)\leq\int dxdzp(x)p(z\mid x)\log\frac{p(z\mid x)}{r(z)}.
\displaystyle I(Z,Y)-\alpha I(Z,X)\geq\int dxdydzp(x)p(y\mid x)p(z\mid x)\log q%
(y\mid z)
\displaystyle I(Z,Y)-\alpha I(Z,X)\geq
\displaystyle\int dxdydzp(x)p(y\mid x)p(z\mid x)\log q(y\mid z)
\displaystyle-\alpha\int dxdzp(x)p(z\mid x)\log\frac{p(z\mid x)}{r(z)}=L.
\displaystyle-\alpha\int dxdzp(x)p(z\mid x)\log\frac{p(z\mid x)}{r(z)}=L.
p\left(x,y\right)
p(x,y)=\frac{1}{N}\sum_{n=1}^{N}\delta_{x_{n}}(x)\delta_{y_{n}}(y)
L\approx\frac{1}{N}\sum_{n=1}^{N}\left[\int dzp\left(z\mid x_{n}\right)\log q%
\left(y_{n}\mid z\right)-\alpha p\left(z\mid x_{n}\right)\log\frac{p\left(z%
\mid x_{n}\right)}{r(z)}\right].
p(z\mid x)=\mathcal{N}\left(z\mid f_{e}^{\mu}(x)\right.
f_{e}
p(z\mid x)dz=p(\epsilon)d\epsilon
z=f(x,\epsilon)
x
\epsilon
L_{IB}
L_{IB}=\frac{1}{N}\sum_{n=1}^{N}\mathbb{E}_{\epsilon\sim p(\epsilon)}\left[-%
\log q\left(y_{n}\mid f\left(x_{n},\epsilon\right)\right)\right]+\alpha%
\operatorname{KL}\left[p\left(Z\mid x_{n}\right),r(Z)\right],
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\alpha
\beta
\pm
\pm
\pm
\beta
\beta
L_{inf}
L_{inf}
L_{inf}
