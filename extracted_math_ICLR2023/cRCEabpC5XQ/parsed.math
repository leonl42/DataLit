0.5
18.93
50
50
50
50
79.2
79.9
81.7
82.2
18.93
\displaystyle Attn(Q,K,V)=softmax(\frac{\textsl{S}(QK)}{\sqrt{d_{emb}/H}})V
\displaystyle Attn(Q,K,V)=softmax(\frac{\textsl{S}(QK)}{\sqrt{d_{emb}/H}})V
\displaystyle\textsl{S}(QK)=MatMul(QK^{T})
\displaystyle\textsl{S}(QK)=MatMul(QK^{T})
Q
K
V
Batch\ size\times sequence\ length\times d_{emb}
d_{emb}
H
K
V
Q
Q
\omega.
S(QK)
\hat{Attn\_M}
M
\hat{Attn}(Q,K,V)
h_{t}
\textsl{S}(QK)
\textsl{S}(QK)
Q
K
R
\displaystyle\hat{Attn\_M}=Bernoulli(Attn\_M,R)
\displaystyle\hat{Attn\_M}=Bernoulli(Attn\_M,R)
Attn\_M
Attn\_M
Attn\_M=[1,1,...0]
R
0.1
\textsl{S}(QK)
\hat{Attn\_M}
M
\displaystyle M=Extend(\hat{Attn\_M})
\displaystyle M=Extend(\hat{Attn\_M})
M\in{\mathbb{R}}^{B\times H\times N\times N}
B
H
N
M
\displaystyle\hat{Attn}(Q,K,V)=softmax(\frac{\hat{\textsl{S}}(QK)}{\sqrt{d_{%
emb}/H}})V
\displaystyle\hat{Attn}(Q,K,V)=softmax(\frac{\hat{\textsl{S}}(QK)}{\sqrt{d_{%
emb}/H}})V
\displaystyle\hat{\textsl{S}}(QK)=\textsl{S}(QK)+M
\displaystyle\hat{\textsl{S}}(QK)=\textsl{S}(QK)+M
\hat{Attn}(Q,K,V)
h_{t}
18
10
6
1
1
10\%/20\%/5\%
0.2
0.9/0.7/0.5
27.5
35.3
51.0
53.7
59.7
61.7
0.7
0.6/1.1
87.2
87.8
87.5
88.6
89.3
91.1
5\%
10\%
1.2\%
0.9\%
10\%
10.9
10.2
11.0
2.4
28k
138M
1.0
1.4
10\%
0.97
0.92
0.05
0.10
0.15
0.20
0.1
0.1
E_{R}
D_{R}
E_{R}
D_{R}
E_{R}
D_{R}
20\%
20\%
2.6\%
0.6\%
3.0\%
1.2\%
7.6\%
2.2\%
1.7
\rightarrow
2.4
\rightarrow
