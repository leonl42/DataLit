w\in\mathbb{R}^{d}
\min_{w\in\mathbb{R}^{d}}\{F(w)\triangleq\sum_{i=1}^{N}p_{i}F_{i}(w)\ \},
N
p_{i}
i
p_{i}\geq 0
\sum_{i=1}^{N}p_{i}=1
i
n_{i}
S_{i}=\{z_{1}^{i},z_{2}^{i},\ldots,z_{n_{i}}^{i}\}
F_{i}(\cdot)
F_{i}(w)\triangleq\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\ell(w;z_{j}^{i}),
\ell(\cdot;\cdot)
t
w_{t-1}
i
w_{(t-1)\tau_{i}}^{i}=w_{t-1}
\tau_{i}\leavevmode\nobreak\ (\tau_{i}\geq 1)
w_{s}^{i}\leftarrow w_{s-1}^{i}-\eta_{i}g_{i}(w_{s-1}^{i};\xi_{s-1}^{i}),%
\leavevmode\nobreak\ s=(t-1)\tau_{i}+1,(t-1)\tau_{i}+2,\ldots,t\tau_{i},
\eta_{i}
\xi_{s}^{i}\subset S^{i}
n_{B_{i}}
g_{i}(w;\xi^{i})=\frac{1}{n_{B_{i}}}\sum_{z_{j}^{i}\in\xi^{i}}\nabla\ell(w;z_{%
j}^{i})
w_{t\tau_{i}}^{i}-w_{t-1}
w_{t}
w_{t}\leftarrow w_{t-1}+\sum_{i=1}^{N}p_{i}(w_{t\tau_{i}}^{i}-w_{t-1}).
R
N
\mathsf{t_{adv}}
D:=\{S_{1},S_{2},\ldots,S_{N}\}
z_{j}^{i}:=\{x_{j}^{i},y_{j}^{i}\}
S_{i}
{z^{\prime}}_{j}^{i}:=\{x_{j}^{i}+{{\delta_{i}}_{x}},y_{j}^{i}+{{\delta_{i}}_{%
y}}\}
\delta_{i}:=\{{\delta_{i}}_{x},{\delta_{i}}_{y}\}
i
q_{i}
S^{\prime i}
n_{i}
D^{\prime}:=\{{S^{\prime}}_{1},\ldots,{S^{\prime}}_{R-1},{S^{\prime}}_{R},{S}_%
{R+1},\ldots,S_{N}\}
\mathsf{t_{adv}}
D^{\prime}=D+\{\{\delta_{i}\}_{j=1}^{q_{i}}\}_{i=1}^{R}.
\mathsf{t_{adv}}
t=\mathsf{t_{adv}}
i
S^{\prime}_{i}
{w^{\prime}}_{s}^{i}\leftarrow{w^{\prime}}_{s-1}^{i}-\eta_{i}g_{i}({w^{\prime}%
}_{s-1}^{i};{\xi^{\prime}}_{s-1}^{i}),\\
s=(t-1)\tau_{i}+1,(t-1)\tau_{i}+2,\ldots,t\tau_{i},
w^{\prime}
{\xi^{\prime}}^{i}
S^{\prime}_{i}
{w^{\prime}}_{(t-1)\tau_{i}}^{i}=w_{t-1}
q_{B_{i}}
{g}_{i}(w^{\prime};{\xi^{\prime}}^{i})=\frac{1}{n_{B_{i}}}(\sum_{j=1}^{q_{B_{i%
}}}\nabla\ell(w^{\prime};{z^{\prime}}_{j}^{i})+\sum_{j=q_{B_{i}}+1}^{n_{B_{i}}%
}\nabla\ell(w^{\prime};{z}_{j}^{i}))
S^{\prime}_{i}
q_{B_{i}}/n_{B_{i}}=q_{i}/n_{i}
{w^{\prime}}_{s}^{i}
{w}_{s}^{i}
\gamma_{i}
i
{\gamma_{i}}({w^{\prime}}_{\mathsf{t_{adv}}\tau_{i}}^{i}-{w}_{\mathsf{t_{adv}}%
-1}).
{w^{\prime}}_{t}
{w^{\prime}}_{t}\leftarrow w_{t-1}+\sum_{i=1}^{R}p_{i}\gamma_{i}({w^{\prime}}_%
{t\tau_{i}}^{i}-w_{t-1})+\sum_{i=R+1}^{N}p_{i}(w_{t\tau_{i}}^{i}-w_{t-1}).
\mathsf{t_{adv}}
t\textgreater\mathsf{t_{adv}}
\mathsf{t_{adv}}
{w^{\prime}}_{t}
t=1,\ldots,T-1
\mathrm{Clip}_{\rho_{t}}(w_{t})\leftarrow w_{t}/\max(1,\frac{\|w_{t}\|}{\rho_{%
t}})
\rho_{t}
\epsilon_{t}\sim\mathcal{N}(0,\sigma_{t}^{2}\bf I)
\widetilde{w}_{t}\leftarrow\mathrm{Clip}_{\rho_{t}}({w_{t}})+\epsilon_{t}.
\|\cdot\|
\ell_{2}
\|\cdot\|_{2}
t+1
i
w_{t\tau_{i}}^{i}\leftarrow\widetilde{w}_{t}
T
\mathcal{M}
\mathrm{Clip}_{\rho_{T}}(w_{T})
\mathcal{M}(D):=\mathrm{Clip}_{\rho_{T}}(w_{T}).
w_{0}
\widetilde{w}_{0}\leftarrow w_{0}
i
S_{i}
\eta_{i}
t=1,\ldots,T
\widetilde{w}_{t-1}
i
i=1,2,\ldots,N
w_{(t-1)\tau_{i}}^{i}\leftarrow\widetilde{w}_{t-1}
s=(t-1)\tau_{i}+1,\ldots,t\tau_{i}
{g_{i}}(\cdot;\cdot)
w_{s}^{i}\leftarrow w_{s-1}^{i}-\eta_{i}g_{i}(w_{s-1}^{i};\xi_{s-1}^{i})
i
w_{t\tau_{i}}^{i}-\widetilde{w}_{t-1}
w_{t}\leftarrow\widetilde{w}_{t-1}+\sum\limits_{i=1}^{N}p_{i}(w_{t\tau_{i}}^{i%
}-\widetilde{w}_{t-1})
\mathrm{Clip}_{\rho_{t}}(w_{t})\leftarrow w_{t}/\max(1,\frac{\|w_{t}\|_{2}}{%
\rho_{t}})
t\leq T-1
\epsilon_{t}\leftarrow
\mathcal{N}(0,\sigma_{t}^{2}\bf I)
\widetilde{w}_{t}\leftarrow\mathrm{Clip}_{\rho_{t}}(w_{t})+\epsilon_{t}
\mathrm{Clip}_{\rho_{T}}(w_{T})
h:\mathcal{(W,X)}\rightarrow\mathcal{Y}
\mathcal{Y}=\{1,\ldots,C\}
C
h_{s}
h
h_{s}
w
h
x_{test}
h
\mu
{H_{s}^{c}}(w;x_{test})
c\in\mathcal{Y}
h_{s}
\displaystyle{h_{s}}(w;x_{test})=\arg\max_{c\in\mathcal{Y}}{H_{s}^{c}}(w;x_{%
test}),
\displaystyle{h_{s}}(w;x_{test})=\arg\max_{c\in\mathcal{Y}}{H_{s}^{c}}(w;x_{%
test}),
\displaystyle\text{where }{H_{s}^{c}}(w;x_{test})=\mathbb{P}_{W\sim\mu(w)}[h(W%
;x_{test})=c].
\displaystyle\text{where }{H_{s}^{c}}(w;x_{test})=\mathbb{P}_{W\sim\mu(w)}[h(W%
;x_{test})=c].
\mu(w)=\mathcal{N}(w,{\sigma_{T}}^{2}\bf I)
p_{c}=\mathbb{P}_{W\sim\mu(w)}[h(W;x_{test})=c]
c
\hat{p}_{c}
t=T
\mathrm{Clip}_{\rho_{T}}({w_{T}})
\epsilon_{T}^{k}\sim\mathcal{N}(0,\sigma_{T}^{2}\bf I)
M
M
M
\widetilde{w}_{T}^{k}\leftarrow\mathrm{Clip}_{\rho_{T}}({w_{T}})+\epsilon_{T}^%
{k},\leavevmode\nobreak\ k=1,2,\ldots,M.
\mathrm{GetCounts}
w_{T}^{k}
x_{test}
\hat{c}_{A}
\hat{c}_{B}
\hat{p}_{A}
\hat{p}_{B}
\mathrm{CalculateBound}
\alpha
h_{s}
\alpha
\underline{p_{A}}
H_{s}^{c_{A}}(w;x_{test})
\overline{p_{B}}
H_{s}^{c_{B}}(w;x_{test})
\underline{p_{A}}=\hat{p}_{A}-\sqrt{\frac{\log(1/\alpha)}{2N}}
\overline{p_{B}}=\hat{p}_{B}+\sqrt{\frac{\log(1/\alpha)}{2N}}
\mathrm{CalculateRadius}
x_{test}
y_{test}
\mathrm{Clip}_{\rho_{T}}(w_{T})
h(\cdot,\cdot)
k=0,1,\ldots M
\epsilon_{T}^{k}\leftarrow
\mathcal{N}(0,\sigma_{T}^{2}\bf I)
\widetilde{w}_{T}^{k}=\mathrm{Clip}_{\rho_{T}}(w_{T})+\epsilon_{T}^{k}
p_{A},p_{B}
x_{test}
\texttt{counts}\leftarrow\mathrm{GetCounts}(x_{test},\{\widetilde{w}_{T}^{1},%
\ldots,\widetilde{w}_{T}^{M}\})
\hat{c}_{A},\hat{c}_{B}\leftarrow
\hat{p}_{A},\hat{p}_{B}\leftarrow\texttt{counts}[\hat{c}_{A}]/M,\texttt{counts%
}[\hat{c}_{B}]/M
p_{A},p_{B}
\underline{p_{A}},\overline{p_{B}}\leftarrow\mathrm{CalculateBound}
\hat{p}_{A}
\hat{p}_{B}
N,\alpha
\underline{p_{A}}>\overline{p_{B}}
\mathsf{RAD}=\mathrm{CalculateRadius}(\underline{p_{A}},\overline{p_{B}})
\hat{c}_{A}
\mathsf{RAD}
M
T
\sigma_{T}
M
M
M
M
m
m\cdot M
M
\mathcal{M}(D^{\prime}):=\mathrm{Clip}_{\rho_{T}}({w^{\prime}}_{T}).
D^{\prime}
D
\{\{\delta_{i}\}_{j=1}^{q_{i}}\}_{i=1}^{R}
\mathcal{M}(D^{\prime})
\mathcal{M}(D)
\mu
\mu(\mathcal{M}(D^{\prime}))
\mu(\mathcal{M}(D))
c
{H_{s}^{c}}(\mathcal{M}(D^{\prime});x_{test})
{H_{s}^{c}}(\mathcal{M}(D);x_{test})
{h_{s}}(\mathcal{M}(D^{\prime});x_{test})
{h_{s}}(\mathcal{M}(D);x_{test})
\{\{\delta_{i}\}_{j=1}^{q_{i}}\}_{i=1}^{R}
D
D^{\prime}
{h_{s}}(\mathcal{M}(D^{\prime});x_{test})={h_{s}}(\mathcal{M}(D);x_{test})
\nabla_{w}\ell(w;z)
\nabla\ell(w;z)
\ell(w;z)
\beta
\forall w_{1},w_{2}
\|\nabla\ell(w_{1};z)-\nabla\ell(w_{2};z)\|\leq\beta\|w_{1}-w_{2}\|.
\ell(w;z)
\displaystyle\|\nabla\ell(w_{1};z)-\nabla\ell(w_{2};z)\|^{2}
\displaystyle\|\nabla\ell(w_{1};z)-\nabla\ell(w_{2};z)\|^{2}
\displaystyle\leq\beta\langle w_{1}-w_{2},\nabla\ell(w_{1};z)-\nabla\ell(w_{2}%
;z)\rangle.
\displaystyle\leq\beta\langle w_{1}-w_{2},\nabla\ell(w_{1};z)-\nabla\ell(w_{2}%
;z)\rangle.
\nabla_{w}l(z;w)
L_{\mathcal{Z}}
z
\|\cdot\|
\forall z_{1},z_{2}
\|\nabla\ell(w;z_{1})-\nabla\ell(w;z_{2})\|\leq L_{\mathcal{Z}}\|z_{1}-z_{2}\|.
h_{s}
\eta_{i}\leq\frac{1}{\beta}
c_{A}\in\mathcal{Y}
\underline{p_{A}},\overline{p_{B}}\in[0,1]
{H_{s}^{c_{A}}}(\mathcal{M}(D^{\prime});x_{test})\geq\underline{p_{A}}\geq%
\overline{p_{B}}\geq\max_{c\neq c_{A}}{H_{s}^{c}}(\mathcal{M}(D^{\prime});x_{%
test}),
\displaystyle R\sum_{i=1}^{R}(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q_{B}}_{i%
}}}{{{n_{B}}_{i}}}\|\delta_{i}\|)^{2}
\displaystyle R\sum_{i=1}^{R}(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q_{B}}_{i%
}}}{{{n_{B}}_{i}}}\|\delta_{i}\|)^{2}
\displaystyle\leq\frac{-\log\left(1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{%
p_{B}}})^{2}\right)\sigma_{\mathsf{t_{adv}}}^{2}}{2L_{\mathcal{Z}}^{2}\prod%
\limits_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}%
\right)-1\right)},
\displaystyle\leq\frac{-\log\left(1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{%
p_{B}}})^{2}\right)\sigma_{\mathsf{t_{adv}}}^{2}}{2L_{\mathcal{Z}}^{2}\prod%
\limits_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}%
\right)-1\right)},
{h_{s}}(\mathcal{M}(D^{\prime});x_{test})={h_{s}}(\mathcal{M}(D);x_{test})=c_{%
A},
\Phi
\|\delta\|=\|\delta_{i}\|
i=1,\ldots,R
c_{A}\in\mathcal{Y}
\underline{p_{A}},\overline{p_{B}}\in[0,1]
{H_{s}^{c_{A}}}(\mathcal{M}(D^{\prime});x_{test})\geq\underline{p_{A}}\geq%
\overline{p_{B}}\geq\max_{c\neq c_{A}}{H_{s}^{c}}(\mathcal{M}(D^{\prime});x_{%
test}),
{h_{s}}(\mathcal{M}(D^{\prime});x_{test})={h_{s}}(\mathcal{M}(D);x_{test})=c_{A}
\|\delta\|<\mathsf{RAD}
\displaystyle\mathsf{RAD}=\sqrt{\frac{-\log\left(1-(\sqrt{\underline{p_{A}}}-%
\sqrt{\overline{p_{B}}})^{2}\right)\sigma_{\mathsf{t_{adv}}}^{2}}{2RL_{%
\mathcal{Z}}^{2}\sum\limits_{i=1}^{R}(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q%
_{B}}_{i}}}{{{n_{B}}_{i}}})^{2}\prod\limits_{t=\mathsf{t_{adv}}+1}^{T}\left(2%
\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)-1\right)}}
\displaystyle\mathsf{RAD}=\sqrt{\frac{-\log\left(1-(\sqrt{\underline{p_{A}}}-%
\sqrt{\overline{p_{B}}})^{2}\right)\sigma_{\mathsf{t_{adv}}}^{2}}{2RL_{%
\mathcal{Z}}^{2}\sum\limits_{i=1}^{R}(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q%
_{B}}_{i}}}{{{n_{B}}_{i}}})^{2}\prod\limits_{t=\mathsf{t_{adv}}+1}^{T}\left(2%
\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)-1\right)}}
\mathrm{CalculateRadius}
\mathsf{RAD}
\sigma_{t}
\rho_{t}
\mathsf{RAD}
\sigma_{t}
\rho_{t}
\underline{p_{A}}
\overline{p_{B}}
R
\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}
\gamma_{i}
p_{i}
\tau_{i}
\eta_{i}
0\leq 2\Phi(\cdot)-1\leq 1
\mathsf{RAD}
\infty
T\rightarrow\infty
\Phi(\cdot)<1
\mathsf{t_{adv}}
N
p_{i}
\mathsf{RAD}
L_{\mathcal{Z}}
z_{j}^{i}
\delta_{i_{x}}
\delta_{i_{y}}
L_{\mathcal{Z}}
z=\{x,y\}
x
y
L_{\mathcal{Z}}
L_{\mathcal{Z}}
\|w\|\leq\rho
z_{1}
z_{2}
x_{1}\neq x_{2}
y_{1}=y_{2}
L_{\mathcal{Z}}=\sqrt{2+2\rho+\rho^{2}}
\|\nabla\ell(w;z_{1})-\nabla\ell(w;z_{2})\|\leq\sqrt{2+2\rho+\rho^{2}}\|z_{1}-%
z_{2}\|.
\mathcal{M}(D^{\prime})
\mathcal{M}(D))
\mu
\mu(\mathcal{M}(D^{\prime}))
\mu(\mathcal{M}(D))
f:(0,\infty)\rightarrow\mathbb{R}
f(1)=0
\mu
\nu
D_{f}(\mu||\nu)=E_{W\sim\nu}[f(\frac{\mu(W)}{\nu(W)})].
f(x)=\frac{1}{2}\|x-1\|
f(x)=x\log x
f
D_{f}(\mu K||\nu K)\leq D_{f}(\mu||\nu)
\mu K
\mu
K
\mu K=\int\mu(dW)K(W)
D_{f}(\mu||\nu)
K
\mathsf{t_{adv}}
\rho_{t}
\sigma_{t}
T
\eta_{i}\leq\frac{1}{\beta}
\mu(\mathcal{M}(D))
\mu(\mathcal{M}(D^{\prime}))
\mu(w)=\mathcal{N}(w,{\sigma_{T}}^{2}\bf I)
\begin{split}&D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))\\
&\leq\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q_{B}}%
_{i}}}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\|\delta_{i}\|\right)^{2}}{\sigma_{\mathsf%
{t_{adv}}}^{2}}\prod_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}%
}{\sigma_{t}}\right)-1\right)\end{split}
h_{s}
\mu(w^{\prime})
D_{KL}(\mu(w),\mu(w^{\prime}))\leq\epsilon
h_{s}
c_{A}\in\mathcal{Y}
\underline{p_{A}},\overline{p_{B}}\in[0,1]
{H_{s}^{c_{A}}}(w^{\prime};x_{test})\geq\underline{p_{A}}\geq\overline{p_{B}}%
\geq\max_{c\neq c_{A}}{H_{s}^{c}}(w^{\prime};x_{test}),
{h_{s}}(w^{\prime};x_{test})={h_{s}}(w;x_{test})=c_{A}
{w}
D_{KL}(\mu(w),\mu(w^{\prime}))\leq\epsilon
\displaystyle\epsilon=-\log\Big{(}1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{%
p_{B}}})^{2}\Big{)}
\displaystyle\epsilon=-\log\Big{(}1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{%
p_{B}}})^{2}\Big{)}
D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))
D
D^{\prime}
x_{test}
-\log(1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{p_{B}}})^{2})
h_{s}
\mathcal{M}(D^{\prime})
h_{s}
\mathcal{M}(D)
D
D^{\prime}
D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))\leq-\log(1-(\sqrt{%
\underline{p_{A}}}-\sqrt{\overline{p_{B}}})^{2})
h_{s}
\mathcal{M}(D^{\prime})
\mathsf{t_{adv}}
T
\mathsf{RAD}
\sigma_{t}
R
\frac{q_{B_{i}}}{n_{B_{i}}}
\gamma_{i}
N
T
m
i
y_{i}
c_{i}
\mathsf{RAD}_{i}
c_{i}=\texttt{ABSTAIN}
\mathsf{RAD}_{i}=0
r
\frac{1}{m}\sum_{i=1}^{m}\mathbb{1}\{\mathsf{RAD}_{i}\geq r\}
r
\frac{1}{m}\sum_{i=1}^{m}\mathbb{1}\{c_{i}=y_{i}
\mathsf{RAD}_{i}\geq r\}
\mathsf{RAD}\geq r
\mathsf{RAD}_{i}
\sigma_{T}=0.01
M=1000
\alpha=0.001
L_{\mathcal{Z}}
L_{\mathcal{Z}}
z_{1},z_{2}
x_{1}\neq x_{2}
y_{1}\neq y_{2}
x_{1}=x_{2}
y_{1}\neq y_{2}
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma=\sigma_{t},t<T
\sigma_{T}
\sigma
\sigma
\sigma
r
\sigma
\sigma_{T}
R
\frac{q_{B_{i}}}{n_{B_{i}}}
\gamma_{i}
\mathsf{t_{adv}}
\mathsf{t_{adv}}
{q_{B_{i}}}/{n_{B_{i}}}
{q_{B_{i}}}/{n_{B_{i}}}
\gamma
\gamma
R
R
R
R
R
p_{i}
N
N
N
p_{i}
T
T
\ell_{2}
\Phi(\cdot)
\ell_{2}
\Phi(\cdot)
T
\Phi(\cdot)
\mathsf{RAD}
\infty
T\rightarrow\infty
0\leq 2\Phi(\rho/\sigma)-1\leq 1
\underline{p_{A}}
\overline{p_{B}}
\rho/\sigma
T
\mathsf{RAD}
\rho/\sigma
\mathsf{RAD}
T
T
\rho/\sigma
T
\underline{p_{A}}-\overline{p_{B}}
\alpha
M
M
\alpha
\ell_{2}
\mathsf{t_{adv}}
\{20,40,60\}
\ell_{2}
\mathsf{t_{adv}}
\mathsf{t_{adv}}
\{
\}
phi
\eta_{i}
\rho_{t}
\sigma_{t}=0.01
t<T
L_{\mathcal{Z}}
\rho_{\mathsf{t_{adv}}}
R=1
\|\delta_{i}\|=\|\delta_{i_{x}}\|
\|\delta_{i}\|=0.1
q_{B_{i}}/n_{B_{i}}
\#
N
q_{B_{i}}/n_{B_{i}}
\tau_{i}
\gamma_{i}
\mathsf{t_{adv}}
\rho_{t}
M
\alpha
\underline{p_{A}}
\overline{p_{B}}
M
\alpha
\alpha
M
\alpha
\mathsf{t_{adv}}
M
\alpha
\mathsf{t_{adv}}
\mathsf{t_{adv}}
\gamma
R
\mathsf{t_{adv}}
\rho_{\mathsf{t_{adv}}}
\mathsf{t_{adv}}
L_{\mathcal{Z}}
\rho_{\mathsf{t_{adv}}}
L_{z}
\rho_{44}
\mathsf{t_{adv}}=10,20,40,43,44
\mathsf{t_{adv}}
\mathsf{t_{adv}}
R
R
R
R
\gamma
\gamma
q_{B_{i}}/n_{B_{i}}
q_{B_{i}}/n_{B_{i}}
\sigma
\sigma
N
N
T
T
\sigma
N
T
\sigma
N
T
\mathcal{M}(\cdot)
z_{j}^{i}:=\{x_{j}^{i},y_{j}^{i}\}
j
i
x_{j}^{i}
y_{j}^{i}
{z^{\prime}}_{j}^{i}:=\{x_{j}^{i}+{{\delta_{i}}_{x}},y_{j}^{i}+{{\delta_{i}}_{%
y}}\}
z_{j}^{i}
{\delta_{i}}_{x}
{\delta_{i}}_{y}
D:=\{S_{1},S_{2},\ldots,S_{N}\}
N
D^{\prime}=D+\{\{\delta_{i}\}_{j=1}^{q_{i}}\}_{i=1}^{R}.
\mathsf{t_{adv}}
R
q_{i}
i
\mathcal{M}(D)
\mathcal{M}
D
\mathcal{M}(D^{\prime})
\mathcal{M}
D^{\prime}
\mathsf{t_{adv}}
D
t\neq\mathsf{t_{adv}}
g_{i}(w)=g_{i}(w;\xi^{i})
i
w
\xi^{i}
{g^{\prime}}_{i}(w)={g}_{i}(w;{\xi^{\prime}}^{i})
i
w
{\xi^{\prime}}^{i}
\mathcal{B}^{i}\triangleq{g^{\prime}}_{i}(w)-g_{i}(w)
w
w_{s}^{i}
i
s
w_{t}\leftarrow\widetilde{w}_{t-1}+\sum\limits_{i=1}^{N}p_{i}(w_{t\tau_{i}}^{i%
}-\widetilde{w}_{t-1})
t
\mathrm{Clip}_{\rho_{t}}(w_{t})\leftarrow w_{t}/\max(1,\frac{\|w_{t}\|}{\rho_{%
t}})
\rho_{t}
t
\widetilde{w}_{t}\leftarrow\mathrm{Clip}_{\rho_{t}}(w_{t})+\epsilon_{t}
t
\epsilon_{t}
h_{s}
h
p_{c}={H_{s}^{c}}(w;x_{test})=\mathbb{P}_{W\sim\mu(w)}[h(W;x_{test})=c]
c
w
x_{test}
{h_{s}}(w;x_{test})=\arg\max_{c\in\mathcal{Y}}{H_{s}^{c}}(w;x_{test})
w
x_{test}
D
T
\mathcal{M}(D)
D^{\prime}
\mathsf{t_{adv}}
t\neq\mathsf{t_{adv}}
\mathcal{M}(D^{\prime})
f:(0,\infty)\rightarrow\mathbb{R}
f(1)=0
\nu
\rho
D_{f}(\nu||\rho)=E_{W\sim\rho}\left[f(\frac{\nu(W)}{\rho(W)})\right].
f(x)=\frac{1}{2}\|x-1\|
f(x)=x\log x
m_{1},m_{2}\in\mathbb{R}^{d}
\sigma\textgreater 0
\mathcal{N}_{1}
\mathcal{N}_{2}
\mathcal{N}_{1}(m_{1},\sigma^{2}I)
\mathcal{N}_{2}(m_{2},\sigma^{2}I)
\displaystyle D_{KL}(\mathcal{N}_{1}||\mathcal{N}_{2})=\frac{\|m_{2}-m_{1}\|^{%
2}}{2\sigma^{2}},
\displaystyle D_{KL}(\mathcal{N}_{1}||\mathcal{N}_{2})=\frac{\|m_{2}-m_{1}\|^{%
2}}{2\sigma^{2}},
\displaystyle D_{TV}(\mathcal{N}_{1}||\mathcal{N}_{2})=2\Phi\left(\frac{\|m_{2%
}-m_{1}\|}{\sigma}\right)-1,
\displaystyle D_{TV}(\mathcal{N}_{1}||\mathcal{N}_{2})=2\Phi\left(\frac{\|m_{2%
}-m_{1}\|}{\sigma}\right)-1,
\Phi
f
K
D_{f}(\nu K||\rho K)\leq D_{f}(\nu||\rho),
\nu K
\nu
K
\nu K=\int\nu(dW)K(W)
D_{f}(\nu||\rho)
\eta_{f}(K):=\sup\limits_{\nu,\rho;{D_{f}(\nu||\rho)\neq 0}}\frac{D_{f}(\nu K|%
|\rho K)}{D_{f}(\nu||\rho)}.
\eta_{TV}(K)
\eta_{TV}(K):=\sup\limits_{y_{1},y_{2}\in y}D_{TV}(K(y_{1})||K(y_{2}))
\eta_{TV}(K)
\eta_{f}(K)\leq\eta_{TV}(K)
\mu
\mu(\mathcal{M}(D^{\prime}))
\mu(\mathcal{M}(D))
t
\widetilde{w}_{t}\leftarrow\mathrm{Clip}_{\rho_{t}}\left(w_{t}\right)+\epsilon%
_{t}
w_{t}
w_{t}=\Psi_{t}(\widetilde{w}_{t-1})
\widetilde{w}_{t}\leftarrow\mathrm{Clip}_{\rho_{t}}\left(\Psi_{t}\left(%
\widetilde{w}_{t-1}\right)\right)+\epsilon_{t},
\Psi_{t}(\widetilde{w}_{t-1})\triangleq\widetilde{w}_{t-1}-\sum_{i=1}^{N}p_{i}%
\eta_{i}\sum_{s=(t-1)\tau_{i}+1}^{t\tau_{i}}g_{i}\left(w_{s-1}^{i};\xi_{s-1}^{%
i}\right)
w_{(t-1)\tau_{i}}^{i}\leftarrow\widetilde{w}_{t-1}
t
K_{t}
\widetilde{w}_{t-1}\rightarrow\mathrm{Clip}_{\rho_{t}}(\Psi_{t}(\widetilde{w}_%
{t-1}))+\epsilon_{t}
K_{t}
\widetilde{w}_{t-1}
\widetilde{w}_{t}
\mu_{t}
{\widetilde{w}_{t}}
\widetilde{w}_{t-1}\sim\mu_{t-1}
\mu_{t}=\int\mu_{t-1}(dy)K_{t}(y).
\mathsf{t_{adv}}
{\Psi^{\prime}}_{t}
t=\mathsf{t_{adv}}
\displaystyle{\Psi^{\prime}}_{t}(\widetilde{w}_{t-1})\triangleq\widetilde{w}_{%
t-1}-\sum_{i=1}^{R}p_{i}\gamma_{i}\eta_{i}\sum_{s=(t-1)\tau_{i}+1}^{t\tau_{i}}%
g_{i}\left({w^{\prime}}_{s-1}^{i};{\xi^{\prime}}_{s-1}^{i}\right)-\sum_{i=R+1}%
^{N}p_{j}\eta_{j}\sum_{s=(t-1)\tau_{i}+1}^{t\tau_{i}}g_{j}\left({w}_{s-1}^{i};%
{\xi}_{s-1}^{i}\right)
\displaystyle{\Psi^{\prime}}_{t}(\widetilde{w}_{t-1})
\displaystyle\triangleq\widetilde{w}_{t-1}-\sum_{i=1}^{R}p_{i}\gamma_{i}\eta_{%
i}\sum_{s=(t-1)\tau_{i}+1}^{t\tau_{i}}g_{i}\left({w^{\prime}}_{s-1}^{i};{\xi^{%
\prime}}_{s-1}^{i}\right)-\sum_{i=R+1}^{N}p_{j}\eta_{j}\sum_{s=(t-1)\tau_{i}+1%
}^{t\tau_{i}}g_{j}\left({w}_{s-1}^{i};{\xi}_{s-1}^{i}\right)
{w^{\prime}}_{(t-1)\tau_{i}}^{i}\leftarrow\widetilde{w}_{t-1}
K^{\prime}_{t}
\widetilde{w}_{t-1}\rightarrow\mathrm{Clip}_{\rho_{t}}({\Psi^{\prime}}_{t}(%
\widetilde{w}_{t-1}))+\epsilon_{t}
\mu^{\prime}_{t}
{\widetilde{w}^{\prime}_{t}}
\widetilde{w}_{t-1}\sim\mu_{t-1}
\mu^{\prime}_{t}=\int\mu_{t-1}(dy)K^{\prime}_{t}(y).
\mathsf{t_{adv}}
\mathsf{t_{adv}}
t\textgreater\mathsf{t_{adv}}
\widetilde{w}^{\prime}_{t-1}\sim\mu^{\prime}_{t-1}
\mu^{\prime}_{t}=\int\mu^{\prime}_{t-1}(dy)K_{t}(y).
t\textgreater\mathsf{t_{adv}}
K_{t}
\eta_{f}(K_{t}):=\sup\limits_{\mu_{t-1},\mu^{\prime}_{t-1};\atop{D_{f}(\mu_{t-%
1}\|\mu^{\prime}_{t-1})\neq 0}}\frac{D_{f}(\mu_{t-1}K_{t}\|\mu^{\prime}_{t-1}K%
_{t})}{D_{f}(\mu_{t-1}\|\mu^{\prime}_{t-1})}.
\eta_{f}(K_{t})
\frac{D_{f}(\mu_{t}\|\mu^{\prime}_{t})}{D_{f}(\mu_{t-1}\|\mu^{\prime}_{t-1})}.
D_{f}(\mu_{T}\|\mu_{T}^{\prime})
\displaystyle D_{f}(\mu_{T}\|\mu_{T}^{\prime})=D_{f}(\mu_{\mathsf{t_{adv}}}\|%
\mu^{\prime}_{\mathsf{t_{adv}}})\frac{D_{f}(\mu_{\mathsf{t_{adv}}+1}\|\mu^{%
\prime}_{\mathsf{t_{adv}}+1})}{D_{f}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{%
\mathsf{t_{adv}}})}\cdot\cdot\cdot\frac{D_{f}(\mu_{T}\|\mu_{T}^{\prime})}{D_{f%
}(\mu_{T-1}\|\mu_{T-1}^{\prime})}
\displaystyle D_{f}(\mu_{T}\|\mu_{T}^{\prime})
\displaystyle=D_{f}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})%
\frac{D_{f}(\mu_{\mathsf{t_{adv}}+1}\|\mu^{\prime}_{\mathsf{t_{adv}}+1})}{D_{f%
}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})}\cdot\cdot\cdot%
\frac{D_{f}(\mu_{T}\|\mu_{T}^{\prime})}{D_{f}(\mu_{T-1}\|\mu_{T-1}^{\prime})}
\displaystyle\leq D_{f}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}%
})\prod_{t=\mathsf{t_{adv}}+1}^{T}\eta_{f}(K_{t}).
\displaystyle\leq D_{f}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}%
})\prod_{t=\mathsf{t_{adv}}+1}^{T}\eta_{f}(K_{t}).
D_{f}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})
\eta_{f}(K_{t})
t=\mathsf{t_{adv}}
\mathsf{t_{adv}}
D_{f}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})
\displaystyle D_{KL}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})=%
D_{KL}\left(\mathcal{N}\left(\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}\left(w_{%
\mathsf{t_{adv}}}\right),\sigma_{\mathsf{t_{adv}}}^{2}\bf I\right)\|\mathcal{N%
}\left(\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}\left(w^{\prime}_{\mathsf{t_{adv%
}}}\right),\sigma_{\mathsf{t_{adv}}}^{2}\bf I\right)\right)
\displaystyle D_{KL}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})
\displaystyle=D_{KL}\left(\mathcal{N}\left(\mathrm{Clip}_{\rho_{\mathsf{t_{adv%
}}}}\left(w_{\mathsf{t_{adv}}}\right),\sigma_{\mathsf{t_{adv}}}^{2}\bf I\right%
)\|\mathcal{N}\left(\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}\left(w^{\prime}_{%
\mathsf{t_{adv}}}\right),\sigma_{\mathsf{t_{adv}}}^{2}\bf I\right)\right)
\displaystyle=\frac{\left\|\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}(w_{\mathsf{%
t_{adv}}})-\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}\left(w^{\prime}_{\mathsf{t_%
{adv}}}\right)\right\|^{2}}{2\sigma_{\mathsf{t_{adv}}}^{2}}
\displaystyle=\frac{\left\|\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}(w_{\mathsf{%
t_{adv}}})-\mathrm{Clip}_{\rho_{\mathsf{t_{adv}}}}\left(w^{\prime}_{\mathsf{t_%
{adv}}}\right)\right\|^{2}}{2\sigma_{\mathsf{t_{adv}}}^{2}}
\displaystyle\leq\frac{\left\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}%
}}\right\|^{2}}{2\sigma_{\mathsf{t_{adv}}}^{2}}.
\displaystyle\leq\frac{\left\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}%
}}\right\|^{2}}{2\sigma_{\mathsf{t_{adv}}}^{2}}.
\left\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}}}\right\|^{2}
s=(t-1)\tau_{i}+1,(t-1)\tau_{i}+2,\ldots,t\tau_{i}
i
{\underline{s}}=s-(\mathsf{t_{adv}}-1)\tau_{i},\underline{s}=1,2,\ldots,\tau_{i}
\Delta_{\underline{s}}^{i}\triangleq w_{\underline{s}}^{i}-{w^{\prime}}_{%
\underline{s}}^{i}
\Delta_{0}^{i}=0
\mathsf{t_{adv}}
w_{(\mathsf{t_{adv}}-1)\tau_{i}}^{i}={w^{\prime}}_{(\mathsf{t_{adv}}-1)\tau_{i%
}}^{i}=\widetilde{w}_{\mathsf{t_{adv}}-1}
i\in[N]
g_{i}(w),{g^{\prime}}_{i}(w)
g_{i}(w;\xi),g_{i}(w;\xi^{\prime})
\mathcal{B}^{i}\triangleq{g^{\prime}}_{i}(w)-g_{i}(w)
\eta_{i}\leq\frac{1}{\beta}
{\underline{s}}\in[1,\tau_{i}]
\displaystyle{\Delta_{{\underline{s}}+1}^{i}}^{2}\leq{\Delta_{\underline{s}}^{%
i}}^{2}+2\eta_{i}\left\|\mathcal{B}^{i}\right\|\Delta_{\underline{s}}^{i}+2%
\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}.
\displaystyle{\Delta_{{\underline{s}}+1}^{i}}^{2}\leq{\Delta_{\underline{s}}^{%
i}}^{2}+2\eta_{i}\left\|\mathcal{B}^{i}\right\|\Delta_{\underline{s}}^{i}+2%
\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}.
\Delta_{\underline{s}}^{i}
\eta_{i}\leq\frac{1}{\beta}
{\underline{s}}\in[1,\tau_{i}]
\displaystyle\Delta_{\underline{s}}^{i}\leq 2\eta_{i}\left\|\mathcal{B}^{i}%
\right\|{\underline{s}}.
\displaystyle\Delta_{\underline{s}}^{i}\leq 2\eta_{i}\left\|\mathcal{B}^{i}%
\right\|{\underline{s}}.
\Delta_{0}^{i}=0
\Delta_{1}^{i}\leq\sqrt{2\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}}\leq 2%
\eta_{i}\left\|\mathcal{B}^{i}\right\|
\Delta_{\underline{s}}^{i}\leq 2\eta_{i}\left\|\mathcal{B}^{i}\right\|%
\underline{s}
\underline{s}=1
\Delta_{\underline{s}}^{i}\leq 2\eta_{i}\left\|\mathcal{B}^{i}\right\|%
\underline{s}
\underline{s}
\underline{s}+1
\displaystyle{\Delta_{\underline{s}+1}^{i}}^{2}\leq 4\eta_{i}^{2}\left\|%
\mathcal{B}^{i}\right\|^{2}\underline{s}^{2}+4\eta_{i}^{2}\left\|\mathcal{B}^{%
i}\right\|^{2}\underline{s}+2\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}
\displaystyle{\Delta_{\underline{s}+1}^{i}}^{2}
\displaystyle\leq 4\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}\underline{s}%
^{2}+4\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}\underline{s}+2\eta_{i}^{2%
}\left\|\mathcal{B}^{i}\right\|^{2}
\displaystyle=\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}(4\underline{s}^{2%
}+8\underline{s}+4)
\displaystyle=\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}(4\underline{s}^{2%
}+8\underline{s}+4)
\displaystyle\leq 4\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}(\underline{s%
}+1)^{2}.
\displaystyle\leq 4\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|^{2}(\underline{s%
}+1)^{2}.
\Delta_{\underline{s}}^{i}\leq 2\eta_{i}\left\|\mathcal{B}^{i}\right\|%
\underline{s}
{\underline{s}}+1
\tau_{i}
\Delta_{{\tau_{i}}}^{i}
\|\mathcal{B}^{i}\|
{q_{B}}_{i}
{n_{B}}_{i}
\displaystyle\|\mathcal{B}^{i}\|\leq\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}L_{%
\mathcal{Z}}\|\delta_{i}\|.
\displaystyle\|\mathcal{B}^{i}\|\leq\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}L_{%
\mathcal{Z}}\|\delta_{i}\|.
\displaystyle\left\|\mathcal{B}^{i}\right\|=\left\|{g^{\prime}}_{i}(w)-g_{i}(w%
)\right\|
\displaystyle\left\|\mathcal{B}^{i}\right\|
\displaystyle=\left\|{g^{\prime}}_{i}(w)-g_{i}(w)\right\|
\displaystyle=\left\|\frac{1}{n_{B_{i}}}\left(\sum_{j=1}^{q_{B_{i}}}\nabla\ell%
(w;{z^{\prime}}_{j}^{i})+\sum_{j=q_{B_{i}}+1}^{n_{B_{i}}}\nabla\ell(w;{z}_{j}^%
{i})\right)-\frac{1}{n_{B_{i}}}\sum_{j=1}^{n_{B_{i}}}\nabla\ell(w;z_{j}^{i})\right\|
\displaystyle=\left\|\frac{1}{n_{B_{i}}}\left(\sum_{j=1}^{q_{B_{i}}}\nabla\ell%
(w;{z^{\prime}}_{j}^{i})+\sum_{j=q_{B_{i}}+1}^{n_{B_{i}}}\nabla\ell(w;{z}_{j}^%
{i})\right)-\frac{1}{n_{B_{i}}}\sum_{j=1}^{n_{B_{i}}}\nabla\ell(w;z_{j}^{i})\right\|
\displaystyle=\left\|\frac{1}{n_{B_{i}}}\sum_{j=1}^{q_{B_{i}}}\left(\nabla\ell%
(w;{z^{\prime}}_{j}^{i})-\nabla\ell(w;{z}_{j}^{i})\right)\right\|
\displaystyle=\left\|\frac{1}{n_{B_{i}}}\sum_{j=1}^{q_{B_{i}}}\left(\nabla\ell%
(w;{z^{\prime}}_{j}^{i})-\nabla\ell(w;{z}_{j}^{i})\right)\right\|
\displaystyle\leq\left\|\frac{1}{n_{B_{i}}}L_{\mathcal{Z}}\sum_{j=1}^{q_{B_{i}%
}}({z^{\prime}}_{j}^{i}-{z}_{j}^{i})\right\|
\displaystyle\leq\left\|\frac{1}{n_{B_{i}}}L_{\mathcal{Z}}\sum_{j=1}^{q_{B_{i}%
}}({z^{\prime}}_{j}^{i}-{z}_{j}^{i})\right\|
\displaystyle=\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\left\|\delta_%
{i}\right\|.
\displaystyle=\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\left\|\delta_%
{i}\right\|.
\gamma_{i}
i
\gamma_{i}({w^{\prime}}_{\mathsf{t_{adv}}\tau_{i}}^{i}-\widetilde{w}_{\mathsf{%
t_{adv}}-1}).
\gamma_{i}({w}_{\mathsf{t_{adv}}\tau_{i}}^{i}-\widetilde{w}_{\mathsf{t_{adv}}-%
1}),
-\eta_{i}\gamma_{i}\sum_{s=(\mathsf{t_{adv}}-1)\tau_{i}+1}^{\mathsf{t_{adv}}%
\tau_{i}}g_{i}\left(w_{s-1}^{i};\xi_{s-1}^{i}\right).
\eta_{i}\leftarrow\eta_{i}\gamma_{i}
\mathsf{t_{adv}}
\displaystyle\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}}}\|^{2}=R\sum_%
{i=1}^{R}(\gamma_{i}p_{i}\Delta_{{\tau_{i}}}^{i})^{2}.
\displaystyle\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}}}\|^{2}=R\sum_%
{i=1}^{R}(\gamma_{i}p_{i}\Delta_{{\tau_{i}}}^{i})^{2}.
\displaystyle\left\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}}}\right\|%
^{2}
\displaystyle\left\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}}}\right\|%
^{2}
\displaystyle=\left\|\sum_{i=1}^{R}p_{i}\gamma_{i}({w}_{\mathsf{t_{adv}}\tau_{%
i}}^{i}-w_{t-1})-\sum_{i=1}^{R}p_{i}\gamma_{i}({w^{\prime}}_{\mathsf{t_{adv}}%
\tau_{i}}^{i}-w_{t-1})\right\|^{2}
\displaystyle=\left\|\sum_{i=1}^{R}p_{i}\gamma_{i}({w}_{\mathsf{t_{adv}}\tau_{%
i}}^{i}-w_{t-1})-\sum_{i=1}^{R}p_{i}\gamma_{i}({w^{\prime}}_{\mathsf{t_{adv}}%
\tau_{i}}^{i}-w_{t-1})\right\|^{2}
\displaystyle=\left\|\sum_{i=1}^{R}p_{i}\gamma_{i}\left({w}_{\mathsf{t_{adv}}%
\tau_{i}}^{i}-{w^{\prime}}_{\mathsf{t_{adv}}\tau_{i}}^{i}\right)\right\|^{2}
\displaystyle=\left\|\sum_{i=1}^{R}p_{i}\gamma_{i}\left({w}_{\mathsf{t_{adv}}%
\tau_{i}}^{i}-{w^{\prime}}_{\mathsf{t_{adv}}\tau_{i}}^{i}\right)\right\|^{2}
\displaystyle=\left\|\sum_{i=1}^{R}p_{i}\gamma_{i}\Delta_{{\tau_{i}}}^{i}%
\right\|^{2}
\displaystyle=\left\|\sum_{i=1}^{R}p_{i}\gamma_{i}\Delta_{{\tau_{i}}}^{i}%
\right\|^{2}
\displaystyle\leq R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\Delta_{{\tau_{i}}}^{i}%
\right)^{2},
\displaystyle\leq R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\Delta_{{\tau_{i}}}^{i}%
\right)^{2},
\|\sum_{i=1}^{R}a_{i}\|^{2}\leq R\sum_{i=1}^{R}\|a_{i}\|^{2}
\eta_{i}\leq\frac{1}{\beta}
D_{KL}(\mu_{\mathsf{t_{adv}}}\|\mu^{\prime}_{\mathsf{t_{adv}}})\leq\frac{2R%
\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}\ \frac{{{q_{B}}_{i}}}{{{n_%
{B}}_{i}}}L_{\mathcal{Z}}\|\delta_{i}\|\right)^{2}}{\sigma_{\mathsf{t_{adv}}}^%
{2}}.
\left\|w_{\mathsf{t_{adv}}}-w^{\prime}_{\mathsf{t_{adv}}}\right\|^{2}\leq R%
\sum_{i=1}^{R}(2p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q_{B}}_{i}}}{{{n_{B}}_{%
i}}}L_{\mathcal{Z}}\|\delta_{i}\|)^{2}.
\mathsf{t_{adv}}
t>\mathsf{t_{adv}}
\eta_{f}(K_{t})
t\textgreater\mathsf{t_{adv}}
\eta_{TV}(K_{t})\leq 2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)-1.
\displaystyle\eta_{TV}(K_{t}):=\sup\limits_{w_{1},w_{2}\in W}D_{TV}(K_{t}(w_{1%
})\|K_{t}(w_{2}))
\displaystyle\eta_{TV}(K_{t}):=\sup\limits_{w_{1},w_{2}\in W}D_{TV}(K_{t}(w_{1%
})\|K_{t}(w_{2}))
\displaystyle\leq\sup\limits_{w_{1},w_{2}\in W}D_{TV}\Bigg{(}\mathcal{N}\Big{(%
}\mathrm{Clip}_{\rho_{t}}(\Psi(w_{1})),\sigma_{t}^{2}{\bf I}\Big{)}\|\mathcal{%
N}\Big{(}\mathrm{Clip}_{\rho_{t}}(\Psi(w_{2})),\sigma_{t}^{2}{\bf I}\Big{)}%
\Bigg{)}
\displaystyle\leq\sup\limits_{w_{1},w_{2}\in W}D_{TV}\Bigg{(}\mathcal{N}\Big{(%
}\mathrm{Clip}_{\rho_{t}}(\Psi(w_{1})),\sigma_{t}^{2}{\bf I}\Big{)}\|\mathcal{%
N}\Big{(}\mathrm{Clip}_{\rho_{t}}(\Psi(w_{2})),\sigma_{t}^{2}{\bf I}\Big{)}%
\Bigg{)}
\displaystyle=\sup\limits_{w_{3},w_{4}\in ball(\rho_{t})}D_{TV}\Bigg{(}%
\mathcal{N}\Big{(}w_{3},\sigma_{t}^{2}{\bf I}\Big{)}\|\mathcal{N}\Big{(}w_{4},%
\sigma_{t}^{2}\bf I\Big{)}\Bigg{)}
\displaystyle=\sup\limits_{w_{3},w_{4}\in ball(\rho_{t})}D_{TV}\Bigg{(}%
\mathcal{N}\Big{(}w_{3},\sigma_{t}^{2}{\bf I}\Big{)}\|\mathcal{N}\Big{(}w_{4},%
\sigma_{t}^{2}\bf I\Big{)}\Bigg{)}
\displaystyle=\sup\limits_{w_{3},w_{4}\in ball(\rho_{t})}2\Phi\left(\frac{\|w_%
{3}-w_{4}\|}{2\sigma_{t}}\right)-1
\displaystyle=\sup\limits_{w_{3},w_{4}\in ball(\rho_{t})}2\Phi\left(\frac{\|w_%
{3}-w_{4}\|}{2\sigma_{t}}\right)-1
\triangleright
\rho_{t}
\triangleright
\rho_{t}
\triangleright
\rho_{t}
\displaystyle=2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)-1.
\displaystyle=2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)-1.
T
\eta_{i}\leq\frac{1}{\beta}
\mu(\mathcal{M}(D))
\mu(\mathcal{M}(D^{\prime}))
\mu(w)=\mathcal{N}(w,{\sigma_{T}}^{2}\bf I)
\displaystyle D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))\leq%
\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q_{B}}_{i}}%
}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\|\delta_{i}\|\right)^{2}}{\sigma_{\mathsf{t_{%
adv}}}^{2}}\prod_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}}{%
\sigma_{t}}\right)-1\right)
\displaystyle D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))\leq%
\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}\frac{{{q_{B}}_{i}}%
}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\|\delta_{i}\|\right)^{2}}{\sigma_{\mathsf{t_{%
adv}}}^{2}}\prod_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}}{%
\sigma_{t}}\right)-1\right)
\displaystyle D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))=D_{KL}%
(\mu_{T}||\mu_{T}^{\prime})
\displaystyle D_{KL}(\mu(\mathcal{M}(D))||\mu(\mathcal{M}(D^{\prime})))=D_{KL}%
(\mu_{T}||\mu_{T}^{\prime})
\triangleright
\triangleright
\triangleright
\displaystyle\leq D_{KL}(\mu_{\mathsf{t_{adv}}}||\mu^{\prime}_{\mathsf{t_{adv}%
}})\prod_{t=\mathsf{t_{adv}}+1}^{T}\eta_{KL}(K_{t})
\displaystyle\leq D_{KL}(\mu_{\mathsf{t_{adv}}}||\mu^{\prime}_{\mathsf{t_{adv}%
}})\prod_{t=\mathsf{t_{adv}}+1}^{T}\eta_{KL}(K_{t})
\triangleright
\triangleright
\triangleright
\displaystyle\leq D_{KL}(\mu_{\mathsf{t_{adv}}}||\mu^{\prime}_{\mathsf{t_{adv}%
}})\prod_{t=\mathsf{t_{adv}}+1}^{T}\eta_{TV}(K_{t})
\displaystyle\leq D_{KL}(\mu_{\mathsf{t_{adv}}}||\mu^{\prime}_{\mathsf{t_{adv}%
}})\prod_{t=\mathsf{t_{adv}}+1}^{T}\eta_{TV}(K_{t})
\triangleright
\triangleright
\triangleright
\displaystyle\leq\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}%
\left\|\mathcal{B}^{i}\right\|\right)^{2}}{\sigma_{\mathsf{t_{adv}}}^{2}}\prod%
_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)%
-1\right)
\displaystyle\leq\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}%
\left\|\mathcal{B}^{i}\right\|\right)^{2}}{\sigma_{\mathsf{t_{adv}}}^{2}}\prod%
_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left(\frac{\rho_{t}}{\sigma_{t}}\right)%
-1\right)
\triangleright
\triangleright
\triangleright
\displaystyle\leq\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}%
\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\|\delta_{i}\|\right)^{2}}{%
\sigma_{\mathsf{t_{adv}}}^{2}}\prod_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left%
(\frac{\rho_{t}}{\sigma_{t}}\right)-1\right).
\displaystyle\leq\frac{2R\sum_{i=1}^{R}\left(p_{i}\gamma_{i}\tau_{i}\eta_{i}%
\frac{{{q_{B}}_{i}}}{{{n_{B}}_{i}}}L_{\mathcal{Z}}\|\delta_{i}\|\right)^{2}}{%
\sigma_{\mathsf{t_{adv}}}^{2}}\prod_{t=\mathsf{t_{adv}}+1}^{T}\left(2\Phi\left%
(\frac{\rho_{t}}{\sigma_{t}}\right)-1\right).
\displaystyle\left\|g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}%
\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}\leq 2\beta\left%
\langle\Delta_{\underline{s}}^{i},g_{i}\left(w_{\underline{s}}^{i}\right)-g_{i%
}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle+2\left\|{g^{\prime%
}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{%
\underline{s}}^{i}\right)\right\|^{2}.
\displaystyle\left\|g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}%
\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}\leq 2\beta\left%
\langle\Delta_{\underline{s}}^{i},g_{i}\left(w_{\underline{s}}^{i}\right)-g_{i%
}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle+2\left\|{g^{\prime%
}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{%
\underline{s}}^{i}\right)\right\|^{2}.
\displaystyle\left\|g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}%
\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}
\displaystyle\left\|g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}%
\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}
\displaystyle=\left\|\left[g_{i}\left(w_{\underline{s}}^{i}\right)-g_{i}\left(%
{w^{\prime}}_{\underline{s}}^{i}\right)\right]-\left[{g^{\prime}}_{i}\left({w^%
{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{%
i}\right)\right]\right\|^{2}
\displaystyle=\left\|\left[g_{i}\left(w_{\underline{s}}^{i}\right)-g_{i}\left(%
{w^{\prime}}_{\underline{s}}^{i}\right)\right]-\left[{g^{\prime}}_{i}\left({w^%
{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{%
i}\right)\right]\right\|^{2}
\displaystyle\leq 2\left\|g_{i}\left(w_{\underline{s}}^{i}\right)-g_{i}\left({%
w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\left\|{g^{\prime}}_{i}%
\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{%
\underline{s}}^{i}\right)\right\|^{2}
\displaystyle\leq 2\left\|g_{i}\left(w_{\underline{s}}^{i}\right)-g_{i}\left({%
w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\left\|{g^{\prime}}_{i}%
\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{%
\underline{s}}^{i}\right)\right\|^{2}
\triangleright
\triangleright
\triangleright
\displaystyle\leq 2\beta\left\langle\Delta_{\underline{s}}^{i},g_{i}\left(w_{%
\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)%
\right\rangle+2\left\|{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}%
\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}.
\displaystyle\leq 2\beta\left\langle\Delta_{\underline{s}}^{i},g_{i}\left(w_{%
\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)%
\right\rangle+2\left\|{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}%
\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|^{2}.
\eta_{i}\leq\frac{1}{\beta}
\displaystyle{\Delta_{{\underline{s}}+1}^{i}}^{2}\triangleq\left\|w_{%
\underline{s}+1}^{i}-{w^{\prime}}_{\underline{s}+1}^{i}\right\|^{2}
\displaystyle{\Delta_{{\underline{s}}+1}^{i}}^{2}\triangleq\left\|w_{%
\underline{s}+1}^{i}-{w^{\prime}}_{\underline{s}+1}^{i}\right\|^{2}
\displaystyle=\left\|(w_{\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i})-%
\eta_{i}\left[g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}\left({w%
^{\prime}}_{\underline{s}}^{i}\right)\right]\right\|^{2}
\displaystyle=\left\|(w_{\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i})-%
\eta_{i}\left[g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}\left({w%
^{\prime}}_{\underline{s}}^{i}\right)\right]\right\|^{2}
\displaystyle={\Delta_{\underline{s}}^{i}}^{2}+\eta_{i}^{2}\left\|g_{i}\left(w%
_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}%
^{i}\right)\right\|^{2}-2\eta_{i}\left\langle w_{\underline{s}}^{i}-{w^{\prime%
}}_{\underline{s}}^{i},g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i%
}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle
\displaystyle={\Delta_{\underline{s}}^{i}}^{2}+\eta_{i}^{2}\left\|g_{i}\left(w%
_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}%
^{i}\right)\right\|^{2}-2\eta_{i}\left\langle w_{\underline{s}}^{i}-{w^{\prime%
}}_{\underline{s}}^{i},g_{i}\left(w_{\underline{s}}^{i}\right)-{g^{\prime}}_{i%
}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle
\displaystyle={\Delta_{\underline{s}}^{i}}^{2}+\eta_{i}^{2}\left\|g_{i}\left(w%
_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}%
^{i}\right)\right\|^{2}+2\eta_{i}\left\langle w_{\underline{s}}^{i}-{w^{\prime%
}}_{\underline{s}}^{i},{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}%
\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle-2\eta_%
{i}\left\langle w_{\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},g_{i}%
\left(w_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}%
\right)\right\rangle
\displaystyle={\Delta_{\underline{s}}^{i}}^{2}+\eta_{i}^{2}\left\|g_{i}\left(w%
_{\underline{s}}^{i}\right)-{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}%
^{i}\right)\right\|^{2}+2\eta_{i}\left\langle w_{\underline{s}}^{i}-{w^{\prime%
}}_{\underline{s}}^{i},{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}%
\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle-2\eta_%
{i}\left\langle w_{\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},g_{i}%
\left(w_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}%
\right)\right\rangle
\triangleright
\triangleright
\triangleright
\displaystyle\leq{\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}^{2}\left\|{g^{%
\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\eta_{i}\left\langle w_{%
\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},{g^{\prime}}_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i%
}\right)\right\rangle+(2\beta\eta_{i}^{2}-2\eta_{i})\left\langle w_{\underline%
{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},g_{i}\left(w_{\underline{s}}^{i}%
\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle
\displaystyle\leq{\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}^{2}\left\|{g^{%
\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\eta_{i}\left\langle w_{%
\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},{g^{\prime}}_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i%
}\right)\right\rangle+(2\beta\eta_{i}^{2}-2\eta_{i})\left\langle w_{\underline%
{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},g_{i}\left(w_{\underline{s}}^{i}%
\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\rangle
\triangleright
\eta_{i}\leq\frac{1}{\beta}
\triangleright
\eta_{i}\leq\frac{1}{\beta}
\triangleright
\eta_{i}\leq\frac{1}{\beta}
\displaystyle\leq{\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}^{2}\left\|{g^{%
\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\eta_{i}\left\langle w_{%
\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},{g^{\prime}}_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i%
}\right)\right\rangle
\displaystyle\leq{\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}^{2}\left\|{g^{%
\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\eta_{i}\left\langle w_{%
\underline{s}}^{i}-{w^{\prime}}_{\underline{s}}^{i},{g^{\prime}}_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{\prime}}_{\underline{s}}^{i%
}\right)\right\rangle
\triangleright
\langle a,b\rangle\leq\|a\|\|b\|
\triangleright
\langle a,b\rangle\leq\|a\|\|b\|
\triangleright
\langle a,b\rangle\leq\|a\|\|b\|
\displaystyle\leq{\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}^{2}\left\|{g^{%
\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\eta_{i}\Delta_{\underline{s}%
}^{i}\left\|{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i%
}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|
\displaystyle\leq{\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}^{2}\left\|{g^{%
\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i}\left({w^{%
\prime}}_{\underline{s}}^{i}\right)\right\|^{2}+2\eta_{i}\Delta_{\underline{s}%
}^{i}\left\|{g^{\prime}}_{i}\left({w^{\prime}}_{\underline{s}}^{i}\right)-g_{i%
}\left({w^{\prime}}_{\underline{s}}^{i}\right)\right\|
\triangleright
\mathcal{B}^{i}\triangleq{g^{\prime}}_{i}(w)-g_{i}(w)
\triangleright
\mathcal{B}^{i}\triangleq{g^{\prime}}_{i}(w)-g_{i}(w)
\triangleright
\mathcal{B}^{i}\triangleq{g^{\prime}}_{i}(w)-g_{i}(w)
\displaystyle={\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}\left\|\mathcal{B}^{i}%
\right\|\Delta_{\underline{s}}^{i}+2\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|%
^{2}.
\displaystyle={\Delta_{\underline{s}}^{i}}^{2}+2\eta_{i}\left\|\mathcal{B}^{i}%
\right\|\Delta_{\underline{s}}^{i}+2\eta_{i}^{2}\left\|\mathcal{B}^{i}\right\|%
^{2}.
W
z=\{x,y\}
z^{\prime}=\{x^{\prime},y\}
\ell(W;z)
\ell(W;z^{\prime})
x\in\mathbb{R}^{1\times d_{x}}
W\in\mathbb{R}^{d_{x}\times C}
Y\in\mathbb{R}^{1\times C}
C
Y_{i}=\mathbb{1}\{i=y\}
x
xW
P_{i}(x)=\mathrm{softmax}(xW)_{i}
i
\displaystyle\ell(x)=-\sum_{i}Y_{i}\log P_{i}(x)=-\sum_{i}Y_{i}\log\mathrm{%
softmax}(xW)_{i}.
\displaystyle\ell(x)=-\sum_{i}Y_{i}\log P_{i}(x)=-\sum_{i}Y_{i}\log\mathrm{%
softmax}(xW)_{i}.
G\in\mathbb{R}^{d_{x}\times C}
\displaystyle G(x)=\nabla\ell(W;\{x,y\})=\frac{d\ell}{dW}(x)=x^{\top}(P(x)-Y),
\displaystyle G(x)=\nabla\ell(W;\{x,y\})=\frac{d\ell}{dW}(x)=x^{\top}(P(x)-Y),
G^{\prime}
\displaystyle G(x^{\prime})=\nabla\ell(W;\{x^{\prime},y\})=\frac{d\ell}{dW}(x^%
{\prime})=x^{\prime\top}(P(x^{\prime})-Y).
\displaystyle G(x^{\prime})=\nabla\ell(W;\{x^{\prime},y\})=\frac{d\ell}{dW}(x^%
{\prime})=x^{\prime\top}(P(x^{\prime})-Y).
f:[a,b]\to\mathbb{R}^{k}
(a,b)
c\in(a,b)
\displaystyle\frac{\|f(b)-f(a)\|}{b-a}\leq\|f^{\prime}(c)\|.
\displaystyle\frac{\|f(b)-f(a)\|}{b-a}\leq\|f^{\prime}(c)\|.
x
[0,1]
G_{l}(t)=G(x^{\prime}+t(x-x^{\prime})),t\in[0,1]
\displaystyle\|G(x)-G(x^{\prime})\|=\left\|G_{l}(1)-G_{l}(0)\right\|
\displaystyle\|G(x)-G(x^{\prime})\|
\displaystyle=\left\|G_{l}(1)-G_{l}(0)\right\|
\displaystyle\leq\left\|\frac{dG_{l}}{dt}(t_{0})\right\|(1-0)
\displaystyle\leq\left\|\frac{dG_{l}}{dt}(t_{0})\right\|(1-0)
\displaystyle=\left\|\frac{dG}{dx}(\xi)\odot(x-x^{\prime})\right\|
\displaystyle=\left\|\frac{dG}{dx}(\xi)\odot(x-x^{\prime})\right\|
\displaystyle\leq\left\|\frac{dG}{dx}(\xi)\right\|\left\|x-x^{\prime}\right\|
\displaystyle\leq\left\|\frac{dG}{dx}(\xi)\right\|\left\|x-x^{\prime}\right\|
\xi=x^{\prime}+t_{0}(x-x^{\prime}),t_{0}\in[0,1]
\frac{dG}{dx}(\xi)
\odot
G_{i}
i
G
W_{i}
\mathbf{1}_{i}
i
\displaystyle\|G(x)-G(x^{\prime})\|
\displaystyle\|G(x)-G(x^{\prime})\|
\displaystyle\leq\left\|\frac{dG}{dx}(\xi)\right\|\left\|x-x^{\prime}\right\|
\displaystyle\leq\left\|\frac{dG}{dx}(\xi)\right\|\left\|x-x^{\prime}\right\|
\displaystyle=\sqrt{\sum_{i}^{C}\left\|\frac{dG_{i}}{dx}(\xi)\right\|^{2}}%
\left\|x-x^{\prime}\right\|
\displaystyle=\sqrt{\sum_{i}^{C}\left\|\frac{dG_{i}}{dx}(\xi)\right\|^{2}}%
\left\|x-x^{\prime}\right\|
\triangleright
G_{i}(x)=x^{\top}(P_{i}(x)-Y_{i})
\triangleright
G_{i}(x)=x^{\top}(P_{i}(x)-Y_{i})
\triangleright
G_{i}(x)=x^{\top}(P_{i}(x)-Y_{i})
\displaystyle=\sqrt{\sum_{i}^{C}\left\|\frac{dx^{\top}(P_{i}-Y_{i})}{dx}(\xi)%
\right\|^{2}}\left\|x-x^{\prime}\right\|
\displaystyle=\sqrt{\sum_{i}^{C}\left\|\frac{dx^{\top}(P_{i}-Y_{i})}{dx}(\xi)%
\right\|^{2}}\left\|x-x^{\prime}\right\|
\displaystyle=\sqrt{\sum_{i}^{C}\left\|\frac{dx^{\top}}{dx}(\xi)(P_{i}-Y_{i})+%
x^{\top}\frac{d(P_{i}-Y_{i})}{dx}(\xi)\right\|^{2}}\left\|x-x^{\prime}\right\|
\displaystyle=\sqrt{\sum_{i}^{C}\left\|\frac{dx^{\top}}{dx}(\xi)(P_{i}-Y_{i})+%
x^{\top}\frac{d(P_{i}-Y_{i})}{dx}(\xi)\right\|^{2}}\left\|x-x^{\prime}\right\|
\triangleright
\frac{d(P_{i}-Y_{i})}{dx}=\frac{d\mathrm{softmax}(xW)_{i}}{dx}=(P_{i}\mathbf{1%
}_{i}-P_{i}P)W^{\top}
\triangleright
\frac{d(P_{i}-Y_{i})}{dx}=\frac{d\mathrm{softmax}(xW)_{i}}{dx}=(P_{i}\mathbf{1%
}_{i}-P_{i}P)W^{\top}
\triangleright
\frac{d(P_{i}-Y_{i})}{dx}=\frac{d\mathrm{softmax}(xW)_{i}}{dx}=(P_{i}\mathbf{1%
}_{i}-P_{i}P)W^{\top}
\displaystyle=\sqrt{\sum_{i}^{C}\left\|(P_{i}(\xi)-Y_{i})I+x^{\top}(P_{i}(\xi)%
\mathbf{1}_{i}-P_{i}(\xi)P(\xi))W^{\top}\right\|^{2}}\left\|x-x^{\prime}\right\|
\displaystyle=\sqrt{\sum_{i}^{C}\left\|(P_{i}(\xi)-Y_{i})I+x^{\top}(P_{i}(\xi)%
\mathbf{1}_{i}-P_{i}(\xi)P(\xi))W^{\top}\right\|^{2}}\left\|x-x^{\prime}\right\|
\triangleright
P_{i}
P_{i}(\xi)
\triangleright
P_{i}
P_{i}(\xi)
\triangleright
P_{i}
P_{i}(\xi)
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|^{2}+2\|(P_{i}-Y_{i})\|\|x%
^{\top}(P_{i}\mathbf{1}_{i}-P_{i}P)W^{\top}\|+\|x^{\top}(P_{i}\mathbf{1}_{i}-P%
_{i}P)W^{\top}\|^{2}}\left\|x-x^{\prime}\right\|
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|^{2}+2\|(P_{i}-Y_{i})\|\|x%
^{\top}(P_{i}\mathbf{1}_{i}-P_{i}P)W^{\top}\|+\|x^{\top}(P_{i}\mathbf{1}_{i}-P%
_{i}P)W^{\top}\|^{2}}\left\|x-x^{\prime}\right\|
\triangleright
\|(P_{i}-Y_{i})\|\leq 1
\triangleright
\|(P_{i}-Y_{i})\|\leq 1
\triangleright
\|(P_{i}-Y_{i})\|\leq 1
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2||x^{\top}(P_{i}\mathbf{%
1}_{i}-P_{i}P)W^{\top}\|+\|x^{\top}(P_{i}\mathbf{1}_{i}-P_{i}P)W^{\top}\|^{2}}%
\left\|x-x^{\prime}\right\|,
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2||x^{\top}(P_{i}\mathbf{%
1}_{i}-P_{i}P)W^{\top}\|+\|x^{\top}(P_{i}\mathbf{1}_{i}-P_{i}P)W^{\top}\|^{2}}%
\left\|x-x^{\prime}\right\|,
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2P_{i}\|x\|\|(\mathbf{1}_%
{i}-P)W^{\top}\|+P_{i}^{2}\|x\|^{2}\|(\mathbf{1}_{i}-P)W^{\top}\|^{2}}\left\|x%
-x^{\prime}\right\|
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2P_{i}\|x\|\|(\mathbf{1}_%
{i}-P)W^{\top}\|+P_{i}^{2}\|x\|^{2}\|(\mathbf{1}_{i}-P)W^{\top}\|^{2}}\left\|x%
-x^{\prime}\right\|
\triangleright
\|x\|\leq 1
0\leq P_{i}\leq 1
\triangleright
\|x\|\leq 1
0\leq P_{i}\leq 1
\triangleright
\|x\|\leq 1
0\leq P_{i}\leq 1
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2P_{i}\|W\|+P_{i}\|W\|^{2%
}}\left\|x-x^{\prime}\right\|,
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2P_{i}\|W\|+P_{i}\|W\|^{2%
}}\left\|x-x^{\prime}\right\|,
\triangleright
\|W\|\leq\rho
\triangleright
\|W\|\leq\rho
\triangleright
\|W\|\leq\rho
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2P_{i}\rho+P_{i}^{2}\rho^%
{2}}\left\|x-x^{\prime}\right\|,
\displaystyle\leq\sqrt{\sum_{i}^{C}\|(P_{i}-Y_{i})\|+2P_{i}\rho+P_{i}^{2}\rho^%
{2}}\left\|x-x^{\prime}\right\|,
\displaystyle\leq\sqrt{2+2\rho+\rho^{2}}\left\|x-x^{\prime}\right\|.
\displaystyle\leq\sqrt{2+2\rho+\rho^{2}}\left\|x-x^{\prime}\right\|.
h:\mathcal{(W,X)}\rightarrow\mathcal{Y}
w
x_{test}
h
h(w;x_{test})=\mathrm{softmax}(w\times x_{test})
\times
h(w;x_{test})=\mathrm{softmax}(w\circledast x_{test})
\circledast
h(w;x_{test})
w
w
x_{test}
h:\mathcal{(W,X)}\rightarrow\mathcal{Y}
\mathcal{Y}
\mu:\mathcal{W}\mapsto\mathcal{P(W)}
h_{s}
h_{s}(w;x_{test})=\arg\max_{c\in\mathcal{Y}}\mathbb{P}_{W\sim\mu(w)}[h(W;x_{%
test})=c]
h_{s}(w;x_{test})
\epsilon
d
h_{s}(w^{\prime};x_{test})=h_{s}(w;x_{test})\text{ $\forall{w^{\prime}}$ such %
that $d(w,w^{\prime})\leq\epsilon$}
\forall{w^{\prime}}
d(w,w^{\prime})\leq\epsilon
\mathcal{W}\subseteq\mathbb{R}^{d}
d
\rho=\mu(w)
\mathcal{D}_{w,\epsilon}=\{\mu(w^{\prime}):d(w,w^{\prime})\leq\epsilon\}
\phi:\mathcal{(W,X)}\rightarrow\mathcal{Z}\subseteq\mathbb{R}
c=h_{s}(w;x_{test})
\{c,c^{\prime}\}
c^{\prime}\in\mathcal{Y}\setminus\{c\}
\phi
c^{\prime}\in\mathcal{Y}\setminus\{c\}
\phi_{c,c^{\prime}}:\mathcal{(W,X)}\mapsto\{-1,0,+1\}
\phi_{c,c^{\prime}}(w)=\begin{cases}+1&\text{if $h(w;x_{test})=c$}\\
-1&\text{if $h(w;x_{test})=c^{\prime}$}\\
0&\text{otherwise}\end{cases}
h(w;x_{test})=c
h(w;x_{test})=c^{\prime}
\phi_{c,c^{\prime}}(w;x_{test})
\phi_{c,c^{\prime}}(w)
h_{s}
c^{\prime}\in\mathcal{Y}\setminus\{c\}
\phi_{c,c^{\prime}}
\mu(w)
\mathcal{D}_{w,\epsilon}
\phi
OPT(\phi,\rho,\mathcal{D}_{w,\epsilon}):=\min_{\nu\in\mathcal{D}_{w,\epsilon}}%
\mathbb{E}_{W^{\prime}\sim\nu}(\phi(W^{\prime}))
\nu\in\mathcal{D}_{w,\epsilon}
\displaystyle\mathbb{E}_{W^{\prime}\sim\nu}[\phi_{c,c^{\prime}}(W^{\prime})]=%
\mathbb{P}_{W^{\prime}\sim\nu}[h(W^{\prime};x_{test})=c]-\mathbb{P}_{W^{\prime%
}\sim\nu}[h(W^{\prime};x_{test})=c^{\prime}].
\displaystyle\mathbb{E}_{W^{\prime}\sim\nu}[\phi_{c,c^{\prime}}(W^{\prime})]=%
\mathbb{P}_{W^{\prime}\sim\nu}[h(W^{\prime};x_{test})=c]-\mathbb{P}_{W^{\prime%
}\sim\nu}[h(W^{\prime};x_{test})=c^{\prime}].
\mathbb{E}_{W^{\prime}\sim\nu}[\phi_{c,c^{\prime}}(W^{\prime})]\geq 0
c^{\prime}\in\mathcal{Y}\setminus\{c\}
c=\arg\max_{y\in\mathcal{C}}\mathbb{P}_{W^{\prime}\sim\nu}[h(W^{\prime};x_{%
test})=y]
\nu=\mu(w^{\prime})
h_{s}(w^{\prime};x_{test})=c
\mathbb{E}_{W^{\prime}\sim\nu}[\phi_{c,c^{\prime}}(W^{\prime})]\geq 0
c^{\prime}\in\mathcal{Y}\setminus\{c\}
\nu=\mu(w^{\prime})\subset\mathcal{D}_{w,\epsilon}
h_{s}(w^{\prime};x_{test})=c
w^{\prime}
d(w,w^{\prime})\leq\epsilon
\rho\in\mathcal{P(W)}
p_{A}
p_{B}
p_{A},p_{B}\geq 0
p_{A}+p_{B}\leq 1
S
S=\{\phi:\mathcal{(W,X)}\mapsto\{-1,0,+1\}\text{ s.t. }\mathbb{P}_{W\sim\rho}[%
\phi(W)=+1]\geq p_{A},\mathbb{P}_{W\sim\rho}[\phi(W)=-1]\leq p_{B}\}
S
h_{s}
S
\mu(w)
\mathcal{D}_{w,\epsilon}
S
\mathbb{E}_{W^{\prime}\sim\nu}[\phi(W^{\prime})]\geq 0
\nu\in\mathcal{D}_{w,\epsilon}
\phi\in S
\phi_{c,c^{\prime}}
c^{\prime}\in\mathcal{Y}\setminus\{c\}
p_{A}
c
p_{B}
f(\cdot)
\mathcal{D}_{w,\epsilon}=\{\mu(w^{\prime}):d(w,w^{\prime})\leq\epsilon\}=\{\nu%
:D_{f}(\nu\|\mu(w))\leq\epsilon\}
D_{f}
\epsilon
D_{f}
\epsilon
S
p_{A},p_{B}
h_{s}
\rho
\mathcal{D}_{w,\epsilon}=\{\nu:D_{f}(\nu\|\rho)\leq\epsilon\}
\displaystyle\max_{\lambda\geq 0,\kappa}\kappa-\lambda\epsilon-p_{A}f_{\lambda%
}^{*}(\kappa-1)-p_{B}f_{\lambda}^{*}(\kappa+1)-(1-p_{A}-p_{B})f_{\lambda}^{*}(%
\kappa)\geq 0
\displaystyle\max_{\lambda\geq 0,\kappa}\kappa-\lambda\epsilon-p_{A}f_{\lambda%
}^{*}(\kappa-1)-p_{B}f_{\lambda}^{*}(\kappa+1)-(1-p_{A}-p_{B})f_{\lambda}^{*}(%
\kappa)\geq 0
\rho(W)
\nu(W)
r(W)=\frac{\nu(W)}{\rho(W)}
\displaystyle\mathbb{E}_{W\sim\nu}[\phi(W)]=\mathbb{E}_{W\sim\rho}[r(W)\phi(W)],
\displaystyle\mathbb{E}_{W\sim\nu}[\phi(W)]
\displaystyle=\mathbb{E}_{W\sim\rho}[r(W)\phi(W)],
\displaystyle D_{f}(\nu\|\rho)=\mathbb{E}_{W\sim\rho}[f(r(W))],
\displaystyle D_{f}(\nu\|\rho)
\displaystyle=\mathbb{E}_{W\sim\rho}[f(r(W))],
\displaystyle\mathbb{E}_{W\sim\rho}[r(W)]=1.
\displaystyle\mathbb{E}_{W\sim\rho}[r(W)]
\displaystyle=1.
\nu
\nu
r
\displaystyle\min_{r\geq 0}\leavevmode\nobreak\ \mathbb{E}_{W\sim\rho}[r(W)%
\phi(W)]
\displaystyle\min_{r\geq 0}
\displaystyle\leavevmode\nobreak\ \mathbb{E}_{W\sim\rho}[r(W)\phi(W)]
\displaystyle s.t.\leavevmode\nobreak\ \mathbb{E}_{W\sim\rho}[f(r(W))]\leq%
\epsilon,\mathbb{E}_{W\sim\rho}[r(W)]=1
\displaystyle s.t.
\displaystyle\leavevmode\nobreak\ \mathbb{E}_{W\sim\rho}[f(r(W))]\leq\epsilon,%
\mathbb{E}_{W\sim\rho}[r(W)]=1
r
\displaystyle\min_{r\geq 0}\mathbb{E}_{W\sim\rho}[r(W)\phi(W)]+\lambda(\mathbb%
{E}_{W\sim\rho}[f(r(W))]-\epsilon)+\kappa(1-\mathbb{E}_{W\sim\rho}[r(W)])
\displaystyle\min_{r\geq 0}\mathbb{E}_{W\sim\rho}[r(W)\phi(W)]+\lambda(\mathbb%
{E}_{W\sim\rho}[f(r(W))]-\epsilon)+\kappa(1-\mathbb{E}_{W\sim\rho}[r(W)])
\displaystyle=\min_{r\geq 0}\mathbb{E}_{W\sim\rho}[r(W)\phi(W)+\lambda f(r(W))%
-\kappa r(W)]+\kappa-\lambda\epsilon
\displaystyle=\min_{r\geq 0}\mathbb{E}_{W\sim\rho}[r(W)\phi(W)+\lambda f(r(W))%
-\kappa r(W)]+\kappa-\lambda\epsilon
\displaystyle=\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[\max_{r\geq 0}%
\kappa r(W)-r(W)\phi(W)-\lambda f(r(W))]
\displaystyle=\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[\max_{r\geq 0}%
\kappa r(W)-r(W)\phi(W)-\lambda f(r(W))]
\displaystyle=\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[\max_{r\geq 0}r(W)%
(\kappa-\phi(W))-\lambda f(r(W))]
\displaystyle=\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[\max_{r\geq 0}r(W)%
(\kappa-\phi(W))-\lambda f(r(W))]
\displaystyle=\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[\max_{r\geq 0}r(W)%
(\kappa-\phi(W))-f_{\lambda}(r(W))]
\displaystyle=\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[\max_{r\geq 0}r(W)%
(\kappa-\phi(W))-f_{\lambda}(r(W))]
\displaystyle\leq\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[f_{\lambda}^{*}%
(\kappa-\phi(W))]
\displaystyle\leq\kappa-\lambda\epsilon-\mathbb{E}_{W\sim\rho}[f_{\lambda}^{*}%
(\kappa-\phi(W))]
f_{\lambda}^{*}(u)=\max_{v\geq 0}(uv-f_{\lambda}(v)),f_{\lambda}(v)=\lambda f(v)
\lambda\geq 0,\kappa
S
\displaystyle\max_{\lambda\geq 0,\kappa}\kappa-\lambda\epsilon-\mathbb{E}_{W%
\sim\rho}[f_{\lambda}^{*}(\kappa-\phi(W))]
\displaystyle\max_{\lambda\geq 0,\kappa}\kappa-\lambda\epsilon-\mathbb{E}_{W%
\sim\rho}[f_{\lambda}^{*}(\kappa-\phi(W))]
p_{A},p_{B}
\displaystyle\max_{\lambda\geq 0,\kappa}\kappa-\lambda\epsilon-p_{A}f_{\lambda%
}^{*}(\kappa-1)-p_{B}f_{\lambda}^{*}(\kappa+1)-(1-p_{A}-p_{B})f_{\lambda}^{*}(\kappa)
\displaystyle\max_{\lambda\geq 0,\kappa}\kappa-\lambda\epsilon-p_{A}f_{\lambda%
}^{*}(\kappa-1)-p_{B}f_{\lambda}^{*}(\kappa+1)-(1-p_{A}-p_{B})f_{\lambda}^{*}(\kappa)
p_{A}=\mathbb{P}_{W\sim\rho}[\phi(W)=+1]
p_{B}=\mathbb{P}_{W\sim\rho}[\phi(W)=-1]
1-p_{A}-p_{B}=\mathbb{P}_{W\sim\rho}[\phi(W)=0]
W
p_{A}
p_{B}
D_{KL}
\epsilon
S
p_{A},p_{B}
h_{s}
\rho
\mathcal{D}_{w,\epsilon}=\{\nu:D_{KL}(\nu\|\rho)\leq\epsilon\}
\displaystyle\epsilon\leq-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}
\displaystyle\epsilon\leq-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}
f(u)=ulog(u)
f(1)=0
f_{\lambda}^{*}(u)=\max_{v\geq 0}(uv-\lambda f(v))=\max_{v\geq 0}(uv-\lambda v%
\log(v)).
v
v
v=\exp\left(\frac{u-\lambda}{\lambda}\right),\lambda\textgreater 0
f_{\lambda}^{*}(u)=\lambda\exp\left(\frac{u}{\lambda}-1\right).
D_{f}(\nu\|\rho)\leq\epsilon
\displaystyle\max_{\lambda\textgreater 0,\kappa}\Bigg{(}\kappa-\lambda\epsilon%
-p_{A}\lambda\exp\left(\frac{\kappa-1}{\lambda}-1\right)-p_{B}\lambda\exp\left%
(\frac{\kappa+1}{\lambda}-1\right)-(1-p_{A}-p_{B})\lambda\exp\left(\frac{%
\kappa}{\lambda}-1\right)\Bigg{)}\geq 0.
\displaystyle\max_{\lambda\textgreater 0,\kappa}\Bigg{(}\kappa-\lambda\epsilon%
-p_{A}\lambda\exp\left(\frac{\kappa-1}{\lambda}-1\right)-p_{B}\lambda\exp\left%
(\frac{\kappa+1}{\lambda}-1\right)-(1-p_{A}-p_{B})\lambda\exp\left(\frac{%
\kappa}{\lambda}-1\right)\Bigg{)}\geq 0.
y=\kappa/\lambda,z=\frac{1}{\lambda}(z\textgreater 0)
\displaystyle\max_{z\textgreater 0,y}\Bigg{(}\frac{1}{z}\Big{(}y-\epsilon-p_{A%
}\exp(y-z-1)-p_{B}\exp(y+z-1)-(1-p_{A}-p_{B})\exp(y-1)\Big{)}\Bigg{)}\geq 0.
\displaystyle\max_{z\textgreater 0,y}\Bigg{(}\frac{1}{z}\Big{(}y-\epsilon-p_{A%
}\exp(y-z-1)-p_{B}\exp(y+z-1)-(1-p_{A}-p_{B})\exp(y-1)\Big{)}\Bigg{)}\geq 0.
\frac{1}{z}
\frac{1}{z}
\displaystyle\max_{z\textgreater 0,y}\Bigg{(}y-\epsilon-p_{A}\exp(y-z-1)-p_{B}%
\exp(y+z-1)-(1-p_{A}-p_{B})\exp(y-1)\Bigg{)}\geq 0.
\displaystyle\max_{z\textgreater 0,y}\Bigg{(}y-\epsilon-p_{A}\exp(y-z-1)-p_{B}%
\exp(y+z-1)-(1-p_{A}-p_{B})\exp(y-1)\Bigg{)}\geq 0.
z
z
\displaystyle p_{A}\exp(y-z-1)-p_{B}\exp(y+z-1)=0
\displaystyle p_{A}\exp(y-z-1)-p_{B}\exp(y+z-1)
\displaystyle=0
\displaystyle z=\log(\sqrt{\frac{p_{A}}{p_{B}}}).
\displaystyle z
\displaystyle=\log(\sqrt{\frac{p_{A}}{p_{B}}}).
\displaystyle\max_{y}\Bigg{(}y-\epsilon-\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{%
2}\Big{)}\exp(y-1)\Bigg{)}.
\displaystyle\max_{y}\Bigg{(}y-\epsilon-\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{%
2}\Big{)}\exp(y-1)\Bigg{)}.
y
y
\displaystyle 1-\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}\exp(y-1)=0
\displaystyle 1-\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}\exp(y-1)
\displaystyle=0
\displaystyle y=1-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}.
\displaystyle y
\displaystyle=1-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}.
\displaystyle-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}-\epsilon.
\displaystyle-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}-\epsilon.
\displaystyle\epsilon\leq-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}.
\displaystyle\epsilon\leq-\log\Big{(}1-(\sqrt{p_{A}}-\sqrt{p_{B}})^{2}\Big{)}.
\frac{1}{z}
y=\kappa/\lambda,z=\frac{1}{\lambda}
h_{s}
c_{A}\in\mathcal{Y}
\underline{p_{A}},\overline{p_{B}}\in[0,1]
{H_{s}^{c_{A}}}(w^{\prime};x_{test})\geq\underline{p_{A}}\geq\overline{p_{B}}%
\geq\max_{c\neq c_{A}}{H_{s}^{c}}(w^{\prime};x_{test}),
{h_{s}}(w^{\prime};x_{test})={h_{s}}(w;x_{test})=c_{A}
{w}
D_{KL}(\mu(w),\mu(w^{\prime}))\leq\epsilon
\displaystyle\epsilon=-\log\Big{(}1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{%
p_{B}}})^{2}\Big{)}
\displaystyle\epsilon=-\log\Big{(}1-(\sqrt{\underline{p_{A}}}-\sqrt{\overline{%
p_{B}}})^{2}\Big{)}
\rho=\mu(w^{\prime})
\nu=\mu(w)
{H_{s}^{c_{A}}}(w^{\prime};x_{test})\geq\underline{p_{A}}
\mathbb{P}_{W\sim\rho}[\phi(W)=+1]\geq p_{A}
\max_{c\neq c_{A}}{H_{s}^{c}}(w^{\prime};x_{test})\leq\overline{p_{B}}
\mathbb{P}_{W\sim\rho}[\phi(W)=-1]\leq p_{B}
