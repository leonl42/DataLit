p(y|\mathbf{x})
p(\mathbf{x}|y)
p(y)
p(y|\mathbf{x})
p(\mathbf{x}|y)p(y)
p(\mathbf{x}|y)
p(y)
\mathbf{z}
\mathbf{x}\in{}^{D}
D
\mathbf{f}(\mathbf{x}):{}^{D}\to{}^{D}
\mathbf{x}
\pi(\mathbf{z})
\mathbf{z}=\mathbf{f}(\mathbf{x})
\mathbf{x}
p(\mathbf{x})
p(\mathbf{x})=\pi(\mathbf{f}(\mathbf{x}))|\det\nabla\mathbf{f}(\mathbf{x})|,
\nabla\mathbf{f}
\mathbf{f}
\mathbf{f}
T
\mathbf{f}=\mathbf{f}_{T}\circ\mathbf{f}_{T-1}\circ\cdots\circ\mathbf{f}_{1}
\mathbf{f}_{i}(\mathbf{x}^{(i-1)})=\mathbf{x}^{(i)}
i
\mathbf{x}^{(0)}\equiv\mathbf{x}
\mathbf{x}^{(T)}\equiv\mathbf{z}
\det\nabla\mathbf{f}(\mathbf{x})=\prod_{i=1}^{T}\det\nabla\mathbf{f}_{i}(%
\mathbf{x}^{(i-1)})
p(\mathbf{x})
\mathbf{g}(\mathbf{x})=\mathbf{y}
\displaystyle\mathbf{y}_{1:d}=\mathbf{x}_{1:d},
\displaystyle\mathbf{y}_{1:d}
\displaystyle=\mathbf{x}_{1:d},
\displaystyle\mathbf{y}_{d+1:D}=\mathbf{x}_{d+1:D}\odot\exp(\mathbf{s}(\mathbf%
{x}_{1:d}))+\mathbf{t}(\mathbf{x}_{1:d}),
\displaystyle\mathbf{y}_{d+1:D}
\displaystyle=\mathbf{x}_{d+1:D}\odot\exp(\mathbf{s}(\mathbf{x}_{1:d}))+%
\mathbf{t}(\mathbf{x}_{1:d}),
d=\left\lfloor D/2\right\rfloor
\mathbf{s},\mathbf{t}:{}^{d}\to{}^{D-d}
1
d
\exp(\mathbf{s})
D-d
\mathbf{s}
\det\nabla\mathbf{g}(\mathbf{x})=\prod_{i=1}^{D-d}\exp(s_{i})
k
K
\pi(\mathbf{z})
\displaystyle\pi(\mathbf{z})=\sum_{k=1}^{K}\phi_{k}\mathcal{N}(\mathbf{z};\bm{%
\mu}_{k},\bm{\Sigma}_{k})\quad\text{with}
\displaystyle\pi(\mathbf{z})
\displaystyle=\sum_{k=1}^{K}\phi_{k}\mathcal{N}(\mathbf{z};\bm{\mu}_{k},\bm{%
\Sigma}_{k})\quad\text{with}
\displaystyle\mathcal{N}(\mathbf{z};\bm{\mu}_{k},\bm{\Sigma}_{k})=\frac{\exp({%
-\frac{1}{2}(\mathbf{z}-\bm{\mu}_{k})^{T}\bm{\Sigma}_{k}^{-1}(\mathbf{z}-\bm{%
\mu}_{k})})}{(2\pi)^{D/2}(\det{\bm{\Sigma}_{k}})^{1/2}},
\displaystyle\mathcal{N}(\mathbf{z};\bm{\mu}_{k},\bm{\Sigma}_{k})
\displaystyle=\frac{\exp({-\frac{1}{2}(\mathbf{z}-\bm{\mu}_{k})^{T}\bm{\Sigma}%
_{k}^{-1}(\mathbf{z}-\bm{\mu}_{k})})}{(2\pi)^{D/2}(\det{\bm{\Sigma}_{k}})^{1/2%
}},
\phi_{k}\geq 0
\bm{\mu}_{k}
\bm{\Sigma}_{k}
k
\mathbf{x}
p(\mathbf{x}|y)p(y)
p(y)
p(\mathbf{x}|y)
p(y|\mathbf{x})
p(\mathbf{x}|y)p(y)
\mathbf{z}=\mathbf{f}(\mathbf{x})
p(\mathbf{x}|y=k)=\mathcal{N}(\mathbf{f}(\mathbf{x});\bm{\mu}_{k},\bm{\Sigma}_%
{k})|\det\nabla\mathbf{f}(\mathbf{x})|
p(y=k)=\phi_{k}
y
p(\mathbf{x})=\sum_{y}p(\mathbf{x}|y)p(y)
y
\mathbf{x}
p(y|\mathbf{x})
\mathbf{x}
\mathbf{A}\in{}^{n\times n}
n
\mathbf{X}=[\mathbf{x}_{1},\cdots,\mathbf{x}_{n}]^{T}\in{}^{n\times D}
\mathbf{x}_{i}
i
\mathbf{P}\in{}^{n\times K}
K
\mathbf{P}_{ik}\equiv p(y=k|\mathbf{x}_{i})
L
\mathbf{X}^{(i)}=\sigma_{i}(\widehat{\mathbf{A}}\mathbf{X}^{(i-1)}\mathbf{W}^{%
(i-1)}),\quad i=1,\ldots,L,
\mathbf{X}\equiv\mathbf{X}^{(0)}
\mathbf{P}\equiv\mathbf{X}^{(L)}
\sigma_{i}
i<L
\sigma_{L}
\mathbf{W}^{(i)}
i=0,\ldots,L-1
\widehat{\mathbf{A}}
\mathbf{A}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}=\widetilde{\mathbf{D}}^{-\frac{1}{2}}\widetilde{\mathbf{A%
}}\widetilde{\mathbf{D}}^{-\frac{1}{2}}
\widetilde{\mathbf{A}}=\mathbf{A}+\mathbf{I}
\widetilde{\mathbf{D}}=\operatorname{diag}\left(\sum_{j}\widetilde{\mathbf{A}}%
_{ij}\right)
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}=\widetilde{\mathbf{D}}^{-1}\widetilde{\mathbf{A}}
\mathbf{X}^{(0)}\equiv\mathbf{X}
\mathbf{X}
n\times D
n
\mathbf{F}(\mathbf{X}):{}^{n\times D}\to{}^{n\times D}
T
\mathbf{F}=\mathbf{F}_{T}\circ\mathbf{F}_{T-1}\circ\cdots\circ\mathbf{F}_{1}
\mathbf{F}_{i}
\mathbf{W}^{(i-1)}
\mathbf{X}^{(i)}=\mathbf{F}_{i}(\underbrace{\widehat{\mathbf{A}}\mathbf{X}^{(i%
-1)}}_{\widetilde{\mathbf{X}}^{(i)}}\,;\mathbf{W}^{(i-1)}),\quad i=1,\ldots,T.
\mathbf{Z}\equiv\mathbf{X}^{(T)}\in{}^{n\times D}
\mathbf{F}_{i}
{}^{n\times D}\to{}^{n\times D}
\mathbf{F}_{i}
\widetilde{\mathbf{X}}^{(i)}
\mathbf{F}_{i}
\mathbf{f}_{i}:{}^{1\times D}\to{}^{1\times D}
\mathbf{x}^{(i)}_{j}=\mathbf{f}_{i}(\widetilde{\mathbf{x}}^{(i)}_{j})
j
\mathbf{f}_{i}
j
\widehat{\mathbf{A}}=\mathbf{I}
\mathbf{F}_{i}
\widehat{\mathbf{A}}
\mathbf{X}^{(i-1)}
\widehat{\mathbf{A}}
\mathbf{W}^{(i-1)}
\sigma_{i}
\mathbf{F}_{i}
\mathbf{W}^{(i-1)}
\mathbf{U}^{(i-1)}
\mathbf{X}^{(i)}=\mathbf{X}^{(i-1)}+\sigma_{i}(\widehat{\mathbf{A}}\mathbf{X}^%
{(i-1)}\mathbf{W}^{(i-1)})\mathbf{U}^{(i-1)}.
\mathbf{F}_{i}
\mathbf{Z}
\mathbf{Z}
\max\,\,\mathcal{L}:=\frac{1-\lambda}{|\mathcal{D}_{l}|}\sum_{(\mathbf{x},y=k)%
\in\mathcal{D}_{l}}\log p(\mathbf{x},y=k)\\
+\frac{\lambda}{|\mathcal{D}_{u}|}\sum_{\mathbf{x}\in\mathcal{D}_{u}}\log p(%
\mathbf{x}),
\mathcal{D}_{l}
\mathcal{D}_{u}
\lambda\in(0,1)
\mathcal{L}
\mathbf{x}
k
\log p(y=k|\mathbf{x})
\mathbf{x}
y
\log p(\mathbf{x},y=k)=\log~{}p(y=k|\mathbf{x})~{}+~{}\log p(\mathbf{x})
p(\mathbf{x}|y)p(y)
\mathbf{x}
\mathcal{L}
y
\operatorname*{argmax}_{k}p(y=k|\mathbf{x})
\mathbf{F}_{i}
nD\times nD
D
n\times n
\mathbf{f}_{i}
\mathbf{G}
\mathbf{X}\in{}^{n\times D}
\widehat{\mathbf{A}}\in{}^{n\times n}
\mathbf{Y}=\mathbf{G}(\widetilde{\mathbf{X}})
\widetilde{\mathbf{X}}\equiv\widehat{\mathbf{A}}\mathbf{X}
\mathbf{G}:{}^{n\times D}\to~{}{}^{n\times D}
\mathbf{g}:{}^{D}\to{}^{D}
\mathbf{G}
\mathbf{y}_{i}=\mathbf{g}(\widetilde{\mathbf{x}}_{i})
\mathbf{y}_{i}
\widetilde{\mathbf{x}}_{i}
i
\mathbf{Y}
\widetilde{\mathbf{X}}
\left|\det\left(\frac{d\mathbf{Y}}{d\mathbf{X}}\right)\right|=|\det\widehat{%
\mathbf{A}}|^{D}\prod_{i=1}^{n}|\det\nabla\mathbf{g}(\widetilde{\mathbf{x}}_{i%
})|.
\mathbf{F}
|\det\nabla\mathbf{F}(\mathbf{X})|=|\det\widehat{\mathbf{A}}|^{TD}\prod_{j=1}^%
{T}\prod_{i=1}^{n}|\det\nabla\mathbf{f}_{j}(\widetilde{\mathbf{x}}_{i}^{(j)})|.
\widehat{\mathbf{A}}
\mathbf{z}_{i}
i
\mathbf{x}_{i}
\mathbf{z}_{i}
\mathbf{X}
\widehat{\mathbf{A}}
p(\mathbf{X})
\pi(\mathbf{Z})
p(\mathbf{X})=\pi(\mathbf{Z})|\det\nabla\mathbf{F}(\mathbf{X})|,
\pi(\mathbf{Z})
\pi(\mathbf{Z})=\pi(\mathbf{z}_{1})\pi(\mathbf{z}_{2})\cdots\pi(\mathbf{z}_{n})
\pi(\mathbf{z}_{i})
p(\mathbf{X})=p(\mathbf{x}_{1})p(\mathbf{x}_{2})\cdots p(\mathbf{x}_{n})
p(y)
p(\mathbf{x}|y)
p(y|\mathbf{x})
p(\mathbf{x}|y)p(y)
\displaystyle p(\mathbf{x}_{i}|y_{i}=k):=\mathcal{N}(\mathbf{z}_{i};\bm{\mu}_{%
k},\bm{\Sigma}_{k})|\det\widehat{\mathbf{A}}|^{TD/n}
\displaystyle p(\mathbf{x}_{i}|y_{i}=k)
\displaystyle:=\mathcal{N}(\mathbf{z}_{i};\bm{\mu}_{k},\bm{\Sigma}_{k})|\det%
\widehat{\mathbf{A}}|^{TD/n}
\displaystyle\qquad\times\prod_{j=1}^{T}|\det\nabla\mathbf{f}_{j}(\widetilde{%
\mathbf{x}}_{i}^{(j)})|
\displaystyle\qquad\times\prod_{j=1}^{T}|\det\nabla\mathbf{f}_{j}(\widetilde{%
\mathbf{x}}_{i}^{(j)})|
\displaystyle p(y_{i}=k):=\phi_{k}.
\displaystyle p(y_{i}=k)
\displaystyle:=\phi_{k}.
y_{i}
\pi(\mathbf{z}_{i})
p(\mathbf{x}_{i})=\pi(\mathbf{z}_{i})|\det\widehat{\mathbf{A}}|^{TD/n}\prod_{j%
=1}^{T}|\det\nabla\mathbf{f}_{j}(\widetilde{\mathbf{x}}_{i}^{(j)})|.
\pi(\mathbf{Z})
p(\mathbf{X})
\pi(\mathbf{Z})
\pi(\mathbf{z}_{i})
T
\mathbf{z}_{i}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\mathbf{A}
\det\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{X}
\pm
\pm
\pm
\pm
\pm
\pm
\widehat{\mathbf{A}}\mathbf{X}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{X}
\pm
\pm
\pm
\pm
\pm
\pm
\widehat{\mathbf{A}}\mathbf{X}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{X}
\widetilde{\mathbf{X}}=\widehat{\mathbf{A}}\mathbf{X}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{z}_{i}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
p(y|\mathbf{x})
p(\mathbf{x}|y)
p(y)
\mathbf{x}
D
\mathbf{f}(\mathbf{x})
{}^{D}\to{}^{D}
\mathbf{f}_{i}
i
\mathbf{f}=\mathbf{f}_{T}\circ\mathbf{f}_{T-1}\circ\cdots\circ\mathbf{f}_{1}
\mathbf{z}
\mathbf{z}=\mathbf{f}(\mathbf{x})
p(\mathbf{x})
\pi(\mathbf{z})
\phi_{k}
k
\mathcal{N}(\mathbf{z};\bm{\mu}_{k},\bm{\Sigma}_{k})
k
\bm{\mu}_{k}
\bm{\Sigma}_{k}
\mathbf{A}
n\times n
n
\widehat{\mathbf{A}}
\mathbf{A}
\mathbf{X}
n\times D
n
\mathbf{x}_{j}
D
j
\mathbf{X}=[\mathbf{x}_{1},\cdots,\mathbf{x}_{n}]^{T}
\mathbf{F}(\mathbf{X})
{}^{n\times D}\to{}^{n\times D}
\mathbf{F}_{i}
i
\mathbf{F}=\mathbf{F}_{T}\circ\mathbf{F}_{T-1}\circ\cdots\circ\mathbf{F}_{1}
\mathbf{Z}
\mathbf{Z}=\mathbf{F}(\mathbf{X})
\mathbf{z}_{i}
j
\mathbf{Z}=[\mathbf{z}_{1},\cdots,\mathbf{z}_{n}]^{T}
p(\mathbf{X})
p(\mathbf{X})=p(\mathbf{x}_{1})p(\mathbf{x}_{2})\cdots p(\mathbf{x}_{n})
\pi(\mathbf{Z})
\pi(\mathbf{Z})=\pi(\mathbf{z}_{1})\pi(\mathbf{z}_{2})\cdots\pi(\mathbf{z}_{n})
\mathbf{X}^{(i-1)}
i
\mathbf{F}_{i}
\widetilde{\mathbf{X}}^{(i)}
\widehat{\mathbf{A}}\mathbf{X}^{(i-1)}
\mathbf{X}^{(i)}=\mathbf{F}_{i}(\widetilde{\mathbf{X}}^{(i)})
\widetilde{\mathbf{x}}_{j}^{(i)}
\widetilde{\mathbf{X}}^{(i-1)}=[\widetilde{\mathbf{x}}_{1}^{(i)},\cdots,%
\widetilde{\mathbf{x}}_{n}^{(i)}]^{T}
\mathbf{f}_{i}(\widetilde{\mathbf{x}}_{j}^{(i)})
\mathbf{F}_{i}
\widetilde{\mathbf{X}}^{(i)}
\mathbf{f}_{i}
\mathbf{f}_{i}(\widetilde{\mathbf{x}}_{j}^{(i)})=\mathbf{x}_{j}^{(i)}
j
\frac{d\mathbf{Y}}{d\mathbf{X}}
nD\times nD
\frac{d\mathbf{Y}_{ij}}{d\mathbf{X}_{pq}}=\widehat{\mathbf{A}}_{ip}\mathbf{J}_%
{jq}^{i}
\mathbf{J}^{i}:=\nabla\mathbf{g}(\widetilde{\mathbf{x}}_{i})\in{}^{D\times D}
\frac{d\mathbf{Y}}{d\mathbf{X}}
\begin{bmatrix}\widehat{\mathbf{A}}_{11}\mathbf{J}^{1}&\widehat{\mathbf{A}}_{1%
2}\mathbf{J}^{1}&\cdots&\widehat{\mathbf{A}}_{1n}\mathbf{J}^{1}\\
\widehat{\mathbf{A}}_{21}\mathbf{J}^{2}&\widehat{\mathbf{A}}_{22}\mathbf{J}^{2%
}&\cdots&\widehat{\mathbf{A}}_{2n}\mathbf{J}^{2}\\
\vdots&\vdots&\ddots&\vdots\\
\widehat{\mathbf{A}}_{n1}\mathbf{J}^{n}&\widehat{\mathbf{A}}_{n2}\mathbf{J}^{n%
}&\cdots&\widehat{\mathbf{A}}_{nn}\mathbf{J}^{n}\end{bmatrix}.
\mathbf{J}^{i}=\mathbf{Q}^{i}\mathbf{R}^{i}
i
\mathbf{Q}^{i}
\mathbf{R}^{i}
\begin{bmatrix}\mathbf{Q}^{1}&&&\\
&\mathbf{Q}^{2}&&\\
&&\ddots&\\
&&&\mathbf{Q}^{n}\end{bmatrix}\begin{bmatrix}\widehat{\mathbf{A}}_{11}\mathbf{%
R}^{1}&\widehat{\mathbf{A}}_{12}\mathbf{R}^{1}&\cdots&\widehat{\mathbf{A}}_{1n%
}\mathbf{R}^{1}\\
\widehat{\mathbf{A}}_{21}\mathbf{R}^{2}&\widehat{\mathbf{A}}_{22}\mathbf{R}^{2%
}&\cdots&\widehat{\mathbf{A}}_{2n}\mathbf{R}^{2}\\
\vdots&\vdots&\ddots&\vdots\\
\widehat{\mathbf{A}}_{n1}\mathbf{R}^{n}&\widehat{\mathbf{A}}_{n2}\mathbf{R}^{n%
}&\cdots&\widehat{\mathbf{A}}_{nn}\mathbf{R}^{n}\end{bmatrix}.
\begin{bmatrix}\widehat{\mathbf{A}}\odot\mathbf{S}^{11}&\widehat{\mathbf{A}}%
\odot\mathbf{S}^{12}&\cdots&\widehat{\mathbf{A}}\odot\mathbf{S}^{1n}\\
\widehat{\mathbf{A}}\odot\mathbf{S}^{21}&\widehat{\mathbf{A}}\odot\mathbf{S}^{%
22}&\cdots&\widehat{\mathbf{A}}\odot\mathbf{S}^{2n}\\
\vdots&\vdots&\ddots&\vdots\\
\widehat{\mathbf{A}}\odot\mathbf{S}^{n1}&\widehat{\mathbf{A}}\odot\mathbf{S}^{%
n2}&\cdots&\widehat{\mathbf{A}}\odot\mathbf{S}^{nn}\end{bmatrix}\quad\text{%
where}\quad\mathbf{S}^{ij}=\begin{bmatrix}\mathbf{R}_{ij}^{1}&\mathbf{R}_{ij}^%
{1}&\cdots&\mathbf{R}_{ij}^{1}\\
\mathbf{R}_{ij}^{2}&\mathbf{R}_{ij}^{2}&\cdots&\mathbf{R}_{ij}^{2}\\
\vdots&\vdots&\ddots&\vdots\\
\mathbf{R}_{ij}^{n}&\mathbf{R}_{ij}^{n}&\cdots&\mathbf{R}_{ij}^{n}\end{bmatrix%
}\text{for all $i,j$ pairs}.
i,j
\mathbf{R}^{k}
\mathbf{S}^{ij}
i>j
\prod_{i=1}^{D}|\det(\widehat{\mathbf{A}}\odot\mathbf{S}^{ii})|.
\mathbf{S}^{ii}
i
\det(\widehat{\mathbf{A}}\odot\mathbf{S}^{ii})=\det(\widehat{\mathbf{A}})\cdot%
\mathbf{R}_{ii}^{1}\mathbf{R}_{ii}^{2}\cdots\mathbf{R}_{ii}^{n}
\displaystyle\prod_{i=1}^{D}|\det(\widehat{\mathbf{A}}\odot\mathbf{S}^{ii})|=|%
\det\widehat{\mathbf{A}}|^{D}\cdot|\mathbf{R}_{11}^{1}\mathbf{R}_{11}^{2}%
\cdots\mathbf{R}_{11}^{n}\mathbf{R}_{22}^{1}\mathbf{R}_{22}^{2}\cdots\mathbf{R%
}_{22}^{n}\cdots\mathbf{R}_{DD}^{1}\mathbf{R}_{DD}^{2}\cdots\mathbf{R}_{DD}^{n}|
\displaystyle\prod_{i=1}^{D}|\det(\widehat{\mathbf{A}}\odot\mathbf{S}^{ii})|
\displaystyle=|\det\widehat{\mathbf{A}}|^{D}\cdot|\mathbf{R}_{11}^{1}\mathbf{R%
}_{11}^{2}\cdots\mathbf{R}_{11}^{n}\mathbf{R}_{22}^{1}\mathbf{R}_{22}^{2}%
\cdots\mathbf{R}_{22}^{n}\cdots\mathbf{R}_{DD}^{1}\mathbf{R}_{DD}^{2}\cdots%
\mathbf{R}_{DD}^{n}|
\displaystyle=|\det\widehat{\mathbf{A}}|^{D}\cdot|\det\mathbf{J}^{1}|\cdot|%
\det\mathbf{J}^{2}|\cdots|\det\mathbf{J}^{n}|,
\displaystyle=|\det\widehat{\mathbf{A}}|^{D}\cdot|\det\mathbf{J}^{1}|\cdot|%
\det\mathbf{J}^{2}|\cdots|\det\mathbf{J}^{n}|,
\widehat{\mathbf{A}}
T
T
\widetilde{\mathbf{X}}^{(j)}=\widehat{\mathbf{A}}\mathbf{X}^{(j-1)}
j
\det\nabla\mathbf{f}_{j}(\widetilde{\mathbf{x}}_{i}^{(j)})
i
\det\widehat{\mathbf{A}}
\mathbf{s}
\mathbf{t}
C_{\mathbf{s}\mathbf{t}}
O\big{(}\operatorname{nz}(\widehat{\mathbf{A}})DT+nTC_{\mathbf{s}\mathbf{t}}%
\big{)},
\operatorname{nz}(\widehat{\mathbf{A}})
\widehat{\mathbf{A}}
D
T
C_{\mathbf{s}\mathbf{t}}=O\big{(}\sum_{i=0}^{L-1}h_{i}h_{i+1}\big{)}
h_{0}=\left\lfloor D/2\right\rfloor
h_{1}\ldots h_{L-1}
h_{L}=2\left\lceil D/2\right\rceil
O(C_{\mathbf{s}\mathbf{t}})
O(D)
\textstyle O\big{(}\operatorname{nz}(\widehat{\mathbf{A}})\sum_{j=0}^{T-1}d_{j%
}+n\sum_{j=0}^{T-1}d_{j}d_{j+1}\big{)},
d_{0}=D
d_{1}\ldots d_{T-1}
d_{T}=K
T
DT
\sum_{j=0}^{T-1}d_{j}
d_{j}
DT
D^{\prime}T
D^{\prime}\ll D
L
h_{j}
h_{0}
TC_{\mathbf{s}\mathbf{t}}
\sum_{j=0}^{T-1}d_{j}d_{j+1}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}^{(j)}
j
\det\widehat{\mathbf{A}}^{(j)}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
j
\widehat{\mathbf{A}}^{(j)}
\mathcal{G}=(\mathcal{V},\mathcal{E})
\mathcal{V}
\mathcal{E}
\widehat{\mathbf{A}}^{(j)}
(i,k)\in\mathcal{E}
\mathbf{E}_{1},\mathbf{E}_{2}:{}^{D}\to{}^{d}
D
d
\mathbf{M}:{}^{2d}\to{}^{1}
\mathbf{h}_{i}^{(j-1)}=\operatorname{ReLU}\Big{(}\mathbf{E}_{1}(\mathbf{x}_{i}%
^{(j-1)})\Big{)},\quad\mathbf{g}_{k}^{(j-1)}=\operatorname{ReLU}\Big{(}\mathbf%
{E}_{2}(\mathbf{x}_{k}^{(j-1)})\Big{)}
\alpha_{ik}^{(j)}
(i,k)\in\mathcal{E}
\alpha_{ik}^{(j)}=\mathbf{M}\Big{(}[\mathbf{h}_{i}^{(j-1)}\,||\,\mathbf{g}_{k}%
^{(j-1)}]\Big{)}.
\mathbf{S}^{(j)}
\mathbf{S}_{ik}^{(j)}=\begin{cases}\operatorname{LeakyReLU}(\alpha_{ik}^{(j)})%
&\text{if}(i,k)\in\mathcal{E},\\
-\infty&\text{otherwise},\end{cases}
\widehat{\mathbf{A}}^{(j)}
\widehat{\mathbf{A}}^{(j)}=\operatorname*{softmax}(\mathbf{S}^{(j)}).
\mathbf{E}_{1}
\mathbf{E}_{2}
\mathbf{h}_{i}^{(j-1)}
\mathbf{g}_{k}^{(j-1)}
\mathcal{E}
\mathcal{E}
\mathcal{E}
e=\sigma\bigg{(}\Big{(}\log\epsilon-\log\big{(}1-\epsilon\big{)}+\omega\Big{)}%
/\tau\bigg{)}\quad\text{where}\quad\epsilon\sim\operatorname{Uniform}\big{(}0,%
1\big{)}
p=(1+e^{-\omega})^{-1}
\tau>0
\omega
p
e
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
\omega
\omega
\mathbf{E}_{1},\mathbf{E}_{2}:{}^{D}\to{}^{d}
\displaystyle\mathbf{a}_{ik}^{(j)}=\tanh\Big{(}\mathbf{E}_{1}\big{(}\mathbf{x}%
_{i}^{(j)}\big{)}\Big{)}\odot\tanh\Big{(}\mathbf{E}_{2}\big{(}\mathbf{x}_{k}^{%
(j)}\big{)}\Big{)},
\displaystyle\mathbf{a}_{ik}^{(j)}
\displaystyle=\tanh\Big{(}\mathbf{E}_{1}\big{(}\mathbf{x}_{i}^{(j)}\big{)}\Big%
{)}\odot\tanh\Big{(}\mathbf{E}_{2}\big{(}\mathbf{x}_{k}^{(j)}\big{)}\Big{)},
\displaystyle\forall\,(i,k)\in\mathcal{E}
\displaystyle\forall\,(i,k)\in\mathcal{E}
\displaystyle\mathbf{b}_{ik}^{(j)}=\tanh\Big{(}\mathbf{E}_{2}\big{(}\mathbf{x}%
_{i}^{(j)}\big{)}\Big{)}\odot\tanh\Big{(}\mathbf{E}_{1}\big{(}\mathbf{x}_{k}^{%
(j)}\big{)}\Big{)},
\displaystyle\mathbf{b}_{ik}^{(j)}
\displaystyle=\tanh\Big{(}\mathbf{E}_{2}\big{(}\mathbf{x}_{i}^{(j)}\big{)}\Big%
{)}\odot\tanh\Big{(}\mathbf{E}_{1}\big{(}\mathbf{x}_{k}^{(j)}\big{)}\Big{)},
\displaystyle\forall\,(i,k)\in\mathcal{E}
\displaystyle\forall\,(i,k)\in\mathcal{E}
\mathbf{a}_{ik}^{(j)},\mathbf{b}_{ik}^{(j)}\in{}^{d}
\odot
\omega_{ik}^{(j)}=\tanh\Big{(}\mathbf{1}^{T}(\mathbf{a}_{ik}^{(j)}-\mathbf{b}_%
{ik}^{(j)})\Big{)},
\widehat{e}_{ik}^{(j)}=\sigma\bigg{(}\Big{(}\log\epsilon-\log\big{(}1-\epsilon%
\big{)}+\omega_{ik}^{(j)}\Big{)}/\tau\bigg{)}\quad\text{where}\quad\epsilon%
\sim\operatorname{Uniform}\big{(}0,1\big{)},
(i,k)
\tau
\gamma<0
\xi>1
\widehat{e}_{ik}^{(j)}
\widehat{\mathbf{A}}_{ik}^{(j)}=\min\Big{(}1,\max\big{(}e^{(j)}_{ik},0\big{)}%
\Big{)}\quad\text{where}\quad e^{(j)}_{ik}=\widehat{e}^{(j)}_{ik}(\xi-\gamma)+\gamma.
\widehat{\mathbf{A}}^{(j)}
(i,k)\notin\mathcal{E}
\widehat{\mathbf{A}}_{ik}^{(j)}=0
(i,k)
\mathcal{E}
\widehat{\mathbf{A}}
\widehat{\mathbf{A}}
|\det\nabla\mathbf{F}(\mathbf{X})|=\prod_{j=1}^{T}\left(|\det\widehat{\mathbf{%
A}}^{(j)}|^{D}\prod_{i=1}^{n}|\det\nabla\mathbf{f}_{j}(\widetilde{\mathbf{x}}_%
{i}^{(j)})|\right).
p(\mathbf{x}_{i}|y_{i}=k):=\mathcal{N}(\mathbf{z}_{i};\bm{\mu}_{k},\bm{\Sigma}%
_{k})\prod_{j=1}^{T}|\det\widehat{\mathbf{A}}^{(j)}|^{D/n}|\det\nabla\mathbf{f%
}_{j}(\widetilde{\mathbf{x}}_{i}^{(j)})|\quad\text{and}\quad p(y_{i}=k):=\phi_%
{k},
p(\mathbf{x}_{i}):=\pi(\mathbf{z}_{i})\prod_{j=1}^{T}|\det\widehat{\mathbf{A}}%
^{(j)}|^{D/n}|\det\nabla\mathbf{f}_{j}(\widetilde{\mathbf{x}}_{i}^{(j)})|.
\ell_{2}
5\times 10^{-4}
\widehat{\mathbf{A}}=(\mathbf{D}+\mathbf{I})^{-1}(\mathbf{A}+\mathbf{I})
\mathbf{D}=\operatorname{diag}(\sum_{j}\mathbf{A}_{ij})
[-50,50]
\widehat{\mathbf{A}}^{(j)}
\widehat{\mathbf{A}}^{(j)}
10^{-3}
\operatorname{LeakyReLU}
0.2
\lambda
\left[0.5,10\right]
\mathbf{E}_{1}
\mathbf{E}_{2}
\mathbf{E}_{1}
\mathbf{E}_{2}
d
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
