[n]
\{1,\cdots,n\}
x\in\mathbb{R}\backslash\{0\}
\operatorname{sign}(x)
\frac{x}{\lvert x\rvert}
\operatorname{sign}(0)=0
\mathbb{I}\{\cdot\}
(\operatorname{\mathcal{S}},\operatorname{\mathcal{A}},\mathcal{P},r,\gamma,\rho)
\mathcal{S}
\operatorname{\mathcal{A}}
\operatorname{\mathcal{P}}:\operatorname{\mathcal{S}}\times\operatorname{%
\mathcal{A}}\rightarrow\Delta(\operatorname{\mathcal{S}})
\mathcal{P}(s^{\prime}\rvert s,a)
(s,a)
s^{\prime}
\Delta(\operatorname{\mathcal{S}})
\operatorname{\mathcal{S}}
r:\mathcal{S}\times\mathcal{A}\rightarrow[0,1]
\gamma\in(0,1)
\rho
\pi_{\theta}:\operatorname{\mathcal{S}}\rightarrow\Delta(\operatorname{%
\mathcal{A}})
\theta
\Delta(\operatorname{\mathcal{A}})
\operatorname{\mathcal{A}}
\pi_{\theta}
V^{\pi_{\theta}}:\mathcal{S}\rightarrow\mathbb{R}
s
\pi_{\theta}
V^{\pi_{\theta}}(s):=\mathbb{E}\bigg{[}\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},a_%
{t})\bigg{|}\pi_{\theta},s_{0}=s\bigg{]},
t
\{(s_{t},a_{t})\}^{\infty}_{t=0}
\pi_{\theta}
s_{0}=s
V^{\pi_{\theta}}(\rho):=\mathbb{E}_{s\sim\rho}[V^{\pi_{\mathbf{\theta}}}(s)].
\pi^{*}
V^{*}(s)
V^{\pi^{*}}(s)
\pi_{\theta}
Q
Q^{\pi_{\theta}}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
Q^{\pi_{\theta}}(s,a):=\mathbb{E}\bigg{[}\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},%
a_{t})\bigg{|}\pi,s_{0}=s,a_{0}=a\bigg{]}.
A^{\pi_{\theta}}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
A^{\pi_{\theta}}(s,a):=Q^{\pi_{\theta}}(s,a)-V^{\pi_{\theta}}(s),
a
s
\pi_{\theta}
m
\pi_{m}
\pi_{\theta_{m}}
m
\pi_{\theta}
V^{\pi_{\theta}}(\mu)
\mu
\nabla_{\theta}V^{\pi_{\theta}}({\mu})
\displaystyle\nabla_{\theta}V^{\pi_{\theta}}({\mu})
\displaystyle\nabla_{\theta}V^{\pi_{\theta}}({\mu})
\displaystyle=\frac{1}{1-\gamma}\mathbb{E}_{s\sim d_{\mu}^{\pi_{\theta}},a\sim%
\pi_{\theta}(\cdot\mid s)}\big{[}\nabla_{\theta}\log\pi_{\theta}(a\rvert s)A^{%
\pi_{\theta}}(s,a)\big{]},
\displaystyle=\frac{1}{1-\gamma}\mathbb{E}_{s\sim d_{\mu}^{\pi_{\theta}},a\sim%
\pi_{\theta}(\cdot\mid s)}\big{[}\nabla_{\theta}\log\pi_{\theta}(a\rvert s)A^{%
\pi_{\theta}}(s,a)\big{]},
\mu
d_{\mu}^{\pi_{\theta}}(s):=\mathbb{E}_{s_{0}\sim\mu}\bigg{[}(1-\gamma)\sum_{t=%
0}^{\infty}\gamma^{t}\operatorname{\mathbb{P}}\big{(}s_{t}=s\rvert s_{0},{\pi_%
{\theta}}\big{)}\bigg{]}.
d_{\mu}^{\pi_{\theta}}(s)
s
\pi_{\theta}
\pi^{*}
J^{\pi_{\theta}}(\beta):=\sum_{s\in\operatorname{\mathcal{S}}}\bar{d}^{\beta}(%
s)V^{\pi_{\theta}}(s),
\beta:\operatorname{\mathcal{S}}\rightarrow\Delta(\operatorname{\mathcal{A}})
\bar{d}^{\beta}(s)
\beta
\displaystyle\nabla_{\theta}J^{\pi_{\theta}}(\beta)=\mathbb{E}_{s\sim\bar{d}^{%
\beta}(s)}\Big{[}\sum_{a\in\operatorname{\mathcal{A}}}\Big{(}\nabla_{\theta}%
\pi_{\theta}(a\rvert s)Q^{\pi_{\theta}}(a\rvert s)
\displaystyle\nabla_{\theta}J^{\pi_{\theta}}(\beta)=\mathbb{E}_{s\sim\bar{d}^{%
\beta}(s)}\Big{[}
\displaystyle\sum_{a\in\operatorname{\mathcal{A}}}\Big{(}\nabla_{\theta}\pi_{%
\theta}(a\rvert s)Q^{\pi_{\theta}}(a\rvert s)
\displaystyle+\pi_{\theta}(a\rvert s)\nabla_{\theta}Q^{\pi_{\theta}}(s,a)\Big{%
)}\Big{]}.
\displaystyle+\pi_{\theta}(a\rvert s)\nabla_{\theta}Q^{\pi_{\theta}}(s,a)\Big{%
)}\Big{]}.
\pi_{\theta}(a\rvert s)\nabla_{\theta}Q^{\pi_{\theta}}(s,a)
\theta_{m+1}=\theta_{m}+\eta\cdot\omega_{m}(s,a)Q^{\pi_{m}}(s,a)\nabla_{\theta%
}\log\pi_{\theta_{m}}(s,a),
s
\bar{d}^{\beta}
a
\beta(\cdot\rvert s)
\omega_{m}(s,a):=\frac{\pi_{m}(a\rvert s)}{\beta(a\rvert s)}
f(\theta):\mathbb{R}^{n}\rightarrow\mathbb{R}
m
i_{m}
\theta_{m+1}=\theta_{m}+\eta\cdot[\nabla_{\theta}f(\theta)]_{i_{m}}e_{i_{m}},
e_{i_{m}}
i_{m}
\eta
i_{m}\leftarrow m\bmod n
[n]
(s,a)
\theta(s,a)
a
s
\pi_{\theta}(a\rvert s)=\frac{\exp({\theta(s,a)})}{\sum_{a^{\prime}\in\mathcal%
{A}}\exp({\theta(s,a^{\prime})})}
\theta
\frac{\partial V^{\pi_{\theta}}(\mu)}{\partial\theta(s,a)}=\frac{1}{1-\gamma}d%
^{\pi_{\theta}}_{\mu}(s)\cdot\pi_{\theta}(a\rvert s)\cdot A^{\pi_{\theta}}(s,a).
m
{B}_{m}
{B}_{m}
\displaystyle\theta_{m+1}(s,a)
\displaystyle\theta_{m+1}(s,a)
\displaystyle=\theta_{m}(s,a)+\alpha_{m}(s,a)\mathbb{I}\{(s,a)\in{B}_{m}\}%
\cdot\operatorname{sign}\left(A^{\pi_{\theta_{m}}}(s,a)\right),
\displaystyle=\theta_{m}(s,a)+\alpha_{m}(s,a)\mathbb{I}\{(s,a)\in{B}_{m}\}%
\cdot\operatorname{sign}\left(A^{\pi_{\theta_{m}}}(s,a)\right),
\alpha_{m}:\operatorname{\mathcal{S}}\times\operatorname{\mathcal{A}}%
\rightarrow\operatorname{\mathbb{R}}_{+}
\operatorname{sign}(A^{\pi_{\theta_{m}}}(s,a))
{B}_{m}
m
B_{m}
\alpha
\lvert A(s,a)\rvert
\alpha(s,a)
\mathbb{E}_{s\sim\rho}[V^{\pi}(s)]
\lim_{M\rightarrow\infty}\sum^{M}_{m=1}\operatorname{\mathbb{I}}\{(s,a)\in{B}_%
{m}\}\rightarrow\infty
\epsilon
V^{\pi_{m+1}}(s)\geq V^{\pi_{m}}(s)
s\in S
m\in\mathbb{N}
\alpha(\cdot,\cdot)
\pi_{\theta}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}(a\rvert s)}})}
V^{\pi_{m}}(s)\rightarrow V^{*}(s)
m\rightarrow\infty
s\in\operatorname{\mathcal{S}}
V^{\pi_{m}}(s)
(s^{\prime},a^{\prime})
A^{(\infty)}(s^{\prime},a^{\prime})>0
\pi_{\infty}(a^{\prime\prime}\rvert s^{\prime\prime})=0
(s^{\prime\prime},a^{\prime\prime})
A^{(\infty)}(s^{\prime\prime},a^{\prime\prime})>0
\epsilon>0
M^{{\epsilon}}
\pi_{m}(a^{\prime\prime}\rvert s^{\prime\prime})<{\epsilon}
\forall m>M^{{\epsilon}}
1
Q
\alpha
\pi_{\theta}(a\rvert s)
(s,a)\in\mathcal{S}\times\mathcal{A}
\lvert B_{m}\rvert=1
\bigcup_{i=1}^{|\mathcal{S}||\mathcal{A}|}B_{m\cdot|\mathcal{S}||\mathcal{A}|+%
i}=\mathcal{S}\times\mathcal{A}
(s,a)\in\mathcal{S}\times\mathcal{A}
d_{\text{gen}}
\operatorname{\mathcal{S}}\times\operatorname{\mathcal{A}}
d_{\text{gen}}(s,a)>0
(s,a)
d_{\text{gen}}
d_{\text{gen}}
B_{m}=\left\{(s,a):(s,a)\in\mathcal{S}\times\mathcal{A}\right\}
\pi_{\theta}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}(a\rvert s)}})}
|B_{m}|=1
\bigcup_{i=1}^{|\mathcal{S}||\mathcal{A}|}B_{m\cdot|\mathcal{S}||\mathcal{A}|+%
i}=\mathcal{S}\times\mathcal{A}
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{|\mathcal{S}||\mathcal{A}%
|}{c}\cdot\frac{1}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{|\mathcal{S}||\mathcal{A}%
|}{c}\cdot\frac{1}{m},\quad\text{for all $m\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}^{-1}\cdot%
{\min}\left\{\frac{\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)}{|\mathcal{S}||%
\mathcal{A}|}\right\}>0
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
V^{*}(s)-V^{\pi_{m}}(s)
\operatorname{\mathcal{O}}(\frac{1}{m})
\alpha
\lvert S\rvert\lvert A\rvert
\pi_{\theta}
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}(a\rvert s)}})}
B_{m}=\left\{(s,a):(s,a)\in\mathcal{S}\times\mathcal{A}\right\}
V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{c}\cdot\frac{1}{m},\quad\text{for %
all $m\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{|\mathcal{A}|}\cdot\left\|\frac{1}{\mu}\right\|_{%
\infty}^{-1}\cdot\underset{s}{\min}\left\{\mu(s)\right\}>0
\pi_{\theta}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}(a\rvert s)}})}
\underset{({s_{m}},{a_{m}})\sim d_{\text{gen}}}{\mathbb{E}}\left[V^{*}(\rho)-V%
^{\pi_{m}}(\rho)\right]\leq\frac{1}{c}\cdot\frac{1}{m},\quad\text{for all $m%
\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}^{-1}\cdot%
\underset{(s,a)}{\min}\left\{d_{\text{gen}}(s,a)\cdot\mu(s)\right\}>0
d_{\text{gen}}:\mathcal{S}\times\mathcal{A}\rightarrow(0,1)
d_{\text{gen}}(s,a)=\mathbb{P}((s,a)\in B_{m})
\operatorname{\mathcal{O}}(\frac{1}{m})
V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{16\cdot|\mathcal{S}|}{\inf_{m\geq 1}\pi%
_{m}(a^{*}|s)^{2}\cdot(1-\gamma)^{6}}\cdot\left\|\frac{d^{\pi^{*}}_{\mu}}{\mu}%
\right\|_{\infty}^{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}\cdot\frac{1}{m}
V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{2\cdot|\mathcal{S}||\mathcal{A}|}{(1-%
\gamma)^{4}}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}\cdot{\max}\left\{\frac{%
2}{\min_{s}{\mu(s)}},\frac{|\mathcal{S}||\mathcal{A}|}{(1-\gamma)}\right\}%
\cdot\frac{1}{m}
V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{|\mathcal{A}|}{(1-\gamma)^{4}}\cdot%
\left\|\frac{1}{\mu}\right\|_{\infty}\cdot\frac{1}{\underset{s}{\min}\left\{%
\mu(s)\right\}}\cdot\frac{1}{m}
\underset{({s_{m}},{a_{m}})\sim d_{\text{gen}}}{\mathbb{E}}\left[V^{*}(\rho)-V%
^{\pi_{m}}(\rho)\right]\leq\frac{2}{(1-\gamma)^{4}}\cdot\left\|\frac{1}{\mu}%
\right\|_{\infty}\cdot\frac{1}{\underset{(s,a)}{\min}\left\{d_{\text{gen}}(s,a%
)\cdot\mu(s)\right\}}\cdot\frac{1}{m}
\lvert\operatorname{\mathcal{S}}\rvert
\inf_{m\geq 1}\pi_{m}(a^{*}|s)^{2}
\pi^{*}
\inf_{m\geq 1}\pi_{m}(a^{*}|s)^{2}
\theta_{m+1}=\theta_{m}+\eta\left(F_{\rho}^{\theta_{m}}\right)^{\dagger}\nabla%
_{\theta}J^{\pi_{\theta}}(\rho),
\eta
\left(F_{\rho}^{\theta_{m}}\right)^{\dagger}
F_{\rho}^{\theta_{m}}:={\mathbb{E}}_{s\sim d_{\rho}^{\pi_{\theta_{m}}},a\sim%
\pi_{\theta_{m}}(\cdot\mid s)}[(\nabla_{\theta}\log\pi_{\theta_{m}}(a\rvert s)%
)(\nabla_{\theta}\log\pi_{\theta_{m}}(a\rvert s))^{\top}]
\theta_{m+1}=\theta_{m}+\frac{\eta}{1-\gamma}A^{\pi_{\theta_{m}}},
A^{\pi_{\theta_{m}}}
\lvert S\rvert\lvert A\rvert
{\pi_{\theta_{m}}}
f_{\theta}(s,a)
\theta
(s,a)
{\pi}_{\theta}(a\rvert s)=\frac{\exp({f_{\theta}\left(s,a\right)})}{\sum_{a^{%
\prime}\in\mathcal{A}}\exp({f_{\theta}\left(s,a^{\prime}\right)})}
\pi_{\hat{\theta}}(s,a)
\tilde{\theta}(s,a)=f_{\theta}(s,a)+\alpha(s,a)\mathbb{I}\{(s,a)\in{B}\}\cdot%
\operatorname{sign}\left(A^{\pi_{\theta}}\left(s,a\right)\right).
\tilde{\theta}
\tilde{\pi}(a\rvert s)=\frac{\exp({\tilde{\theta}\left(s,a\right)})}{\sum_{a^{%
\prime}\in\mathcal{A}}\exp({\tilde{\theta}\left(s,a^{\prime}\right)})}
f_{\theta}
\mathcal{L}(\theta)=\sum_{s\in B}D_{\text{KL}}\left(\pi_{\theta}(\cdot\rvert s%
)\|\tilde{\pi}(\cdot\rvert s)\right).
10\times 10\times n
10\times 10
n
n
\text{mean}\pm 0.5\cdot\text{std}
\text{mean}\pm 0.5\cdot\text{std}
s_{0}
s_{0}
\pi
\pi^{\prime}
V^{\pi}\left(s_{0}\right)-V^{\pi^{\prime}}\left(s_{0}\right)=\frac{1}{1-\gamma%
}\mathbb{E}_{s\sim d_{s_{0}}^{\pi}}\mathbb{E}_{a\sim\pi(\cdot\rvert s)}\left[A%
^{\pi^{\prime}}(s,a)\right]
V^{\pi_{m+1}}(s)\geq V^{\pi_{m}}(s)
s\in S
m\in\mathbb{N}
A(s,a)
\sum_{a\in\mathcal{A}}\pi_{m}(a|s)A^{m}(s,a)=0,\quad\forall s\in\mathcal{S}
Z_{m}(s):=\sum_{a\in\mathcal{A}}\exp({\theta_{m}(s,a)})
\pi_{m}(a|s)
\pi_{m+1}(a|s)
\pi_{m}(a|s)=\frac{\exp({\theta_{m}(s,a)})}{Z_{m}(s)},\quad\pi_{m+1}(a|s)=%
\frac{\exp({\theta_{m+1}(s,a)})}{Z_{m+1}(s)}.
V^{\pi_{m+1}}(s)\geq V^{\pi_{m}}(s),\forall s\in S
\sum_{a\in\operatorname{\mathcal{A}}}\pi_{m+1}(a|s)A^{m}(s,a)>0,\quad\forall s%
\in\mathcal{S}.
{B}_{m}(s):=\{a\rvert(s,a)\in{B}_{m}\}
s\in\mathcal{S}
\displaystyle\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s)A^{m}(s,a)=\sum_{a\in\mathcal%
{A}}\frac{\exp({\theta_{m+1}(s,a)})}{Z_{m+1}(s)}A^{m}(s,a)
\displaystyle\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s)A^{m}(s,a)
\displaystyle=\sum_{a\in\mathcal{A}}\frac{\exp({\theta_{m+1}(s,a)})}{Z_{m+1}(s%
)}A^{m}(s,a)
\displaystyle=\frac{Z_{m}(s)}{Z_{m+1}(s)}\sum_{a\in\mathcal{A}}\frac{\exp({%
\theta_{m+1}(s,a)})}{Z_{m}(s)}A^{m}(s,a)
\displaystyle=\frac{Z_{m}(s)}{Z_{m+1}(s)}\sum_{a\in\mathcal{A}}\frac{\exp({%
\theta_{m+1}(s,a)})}{Z_{m}(s)}A^{m}(s,a)
\displaystyle=\frac{Z_{m}(s)}{Z_{m+1}(s)}\left[\sum_{a\in{B}_{m}(s)}\frac{\exp%
({\theta_{m+1}(s,a)})}{Z_{m}(s)}A^{m}(s,a)+\sum_{a\not\in{B}_{m}(s)}\frac{\exp%
({\theta_{m}(s,a)})}{Z_{m}(s)}A^{m}(s,a)\right]
\displaystyle=\frac{Z_{m}(s)}{Z_{m+1}(s)}\left[\sum_{a\in{B}_{m}(s)}\frac{\exp%
({\theta_{m+1}(s,a)})}{Z_{m}(s)}A^{m}(s,a)+\sum_{a\not\in{B}_{m}(s)}\frac{\exp%
({\theta_{m}(s,a)})}{Z_{m}(s)}A^{m}(s,a)\right]
\displaystyle>\frac{Z_{m}(s)}{Z_{m+1}(s)}\left[\sum_{a\in{B}_{m}(s)}\frac{\exp%
({\theta_{m}(s,a)})}{Z_{m}(s)}A^{m}(s,a)+\sum_{a\not\in{B}_{m}(s)}\frac{\exp({%
\theta_{m}(s,a)})}{Z_{m}(s)}A^{m}(s,a)\right]
\displaystyle>\frac{Z_{m}(s)}{Z_{m+1}(s)}\left[\sum_{a\in{B}_{m}(s)}\frac{\exp%
({\theta_{m}(s,a)})}{Z_{m}(s)}A^{m}(s,a)+\sum_{a\not\in{B}_{m}(s)}\frac{\exp({%
\theta_{m}(s,a)})}{Z_{m}(s)}A^{m}(s,a)\right]
\displaystyle=\frac{Z_{m}(s)}{Z_{m+1}(s)}\sum_{a\in\mathcal{A}}\pi_{m}(a|s)A^{%
m}(s,a)
\displaystyle=\frac{Z_{m}(s)}{Z_{m+1}(s)}\sum_{a\in\mathcal{A}}\pi_{m}(a|s)A^{%
m}(s,a)
\displaystyle=0,
\displaystyle=0,
\{V^{m}\}
\{V^{m}\}
\{Q^{m}\}
V^{(\infty)}(s)
Q^{(\infty)}(s,a)
\{V^{(m)}(s)\}
\{Q^{(m)}(s,a)\}
A^{(\infty)}(s,a):=Q^{(\infty)}(s,a)-V^{(\infty)}(s)
\pi_{\infty}
\displaystyle I_{0}^{s}:=\left\{a\rvert Q^{(\infty)}(s,a)=V^{(\infty)}(s)%
\right\},
\displaystyle I_{0}^{s}
\displaystyle:=\left\{a\rvert Q^{(\infty)}(s,a)=V^{(\infty)}(s)\right\},
\displaystyle I_{+}^{s}:=\left\{a\rvert Q^{(\infty)}(s,a)>V^{(\infty)}(s)%
\right\},
\displaystyle I_{+}^{s}
\displaystyle:=\left\{a\rvert Q^{(\infty)}(s,a)>V^{(\infty)}(s)\right\},
\displaystyle I_{-}^{s}:=\left\{a\rvert Q^{(\infty)}(s,a)<V^{(\infty)}(s)%
\right\}.
\displaystyle I_{-}^{s}
\displaystyle:=\left\{a\rvert Q^{(\infty)}(s,a)<V^{(\infty)}(s)\right\}.
V^{(\infty)}
I_{+}^{s}
s
V^{(\infty)}
I_{+}^{s}=\emptyset
V^{(\infty)}
\exists s\in\mathcal{S},I_{+}^{s}\neq\emptyset
\forall s\in\mathcal{S}
a_{-}\in I_{-}^{s}
\pi_{\infty}(a_{-}|s)=0
\forall a_{-}\in I_{-}^{s}
I_{-}^{s}
\forall I_{+}^{s}\neq\emptyset
a\in I_{+}^{s}
\pi_{\infty}(a_{+}|s)=0
\forall a_{+}\in I_{+}^{s}
a_{+}\in I_{+}^{s}
\lim_{m\rightarrow\infty}\pi_{m}(a_{+}|s)=1
\exists s\in\mathcal{S},I_{+}^{s}\neq\emptyset
I_{+}^{s}=\emptyset,\forall s\in\mathcal{S}
M_{1}
m>M_{1},s\in\mathcal{S},a\in\mathcal{A}
\displaystyle A^{(m)}(s,a)<-\frac{\Delta}{4},\quad\text{ for }a\in I_{-}^{s},
\displaystyle A^{(m)}(s,a)<-\frac{\Delta}{4},
\displaystyle\quad\text{ for }a\in I_{-}^{s},
\displaystyle A^{(m)}(s,a)>\frac{\Delta}{4},\quad\text{ for }a\in I_{+}^{s},
\displaystyle A^{(m)}(s,a)>\frac{\Delta}{4},
\displaystyle\quad\text{ for }a\in I_{+}^{s},
\Delta:=\min_{\left\{s,a\rvert A^{(\infty)}(s,a)\neq 0\right\}}\left|A^{(%
\infty)}(s,a)\right|
\pi_{\infty}(a_{-}|s)=0,\forall s\in\mathcal{S},a_{-}\in I^{s}_{-}
m>M_{1}
A^{(m)}(s,a)
\theta_{m}(s,a_{-})
\forall a_{-}\in I^{s}_{-},\forall m>M_{1}
\forall a_{+}\in I^{s}_{+},m>M_{1}
\theta_{m}(s,a_{+})
m\rightarrow\infty
\theta_{m+1}(s,a_{-})-\theta_{m}(a_{-}\rvert s)\leq-\log(\frac{1}{\pi_{m}(a_{-%
}\rvert s)})<0.
\lim_{m\rightarrow\infty}\theta_{m}(s,a_{-})=-\infty
\sum_{a_{+}\in I_{+}^{s}}\pi_{\infty}(a_{+}\rvert s)=0
I_{+}^{s}\neq\emptyset
\sum_{a_{+}\in I_{+}^{s}}\pi_{\infty}(a_{+}|s)=0
\sum_{a\in\mathcal{A}}\pi_{m}(a\rvert s)A^{m}(s,a)=0,\forall s\in\mathcal{S},m>0
\sum_{a_{0}\in I_{0}^{s}}\pi_{\infty}(a_{0}|s)A^{\infty}(s,a_{0})=0
\displaystyle\sum_{a_{+}\in I_{+}^{s}}\pi_{\infty}(a_{+}|s)A^{\infty}(s,a_{+})%
=\sum_{a\in\mathcal{A}}\pi_{\infty}(a\rvert s)A^{\infty}(s,a)-\sum_{a_{0}\in I%
_{0}^{s}}\pi_{\infty}(a_{0}\rvert s)A^{\infty}(s,a)-\sum_{a_{-}\in I_{-}^{s}}%
\pi_{\infty}(a_{-}\rvert s)A^{\infty}(s,a)
\displaystyle\sum_{a_{+}\in I_{+}^{s}}\pi_{\infty}(a_{+}|s)A^{\infty}(s,a_{+})
\displaystyle=\sum_{a\in\mathcal{A}}\pi_{\infty}(a\rvert s)A^{\infty}(s,a)-%
\sum_{a_{0}\in I_{0}^{s}}\pi_{\infty}(a_{0}\rvert s)A^{\infty}(s,a)-\sum_{a_{-%
}\in I_{-}^{s}}\pi_{\infty}(a_{-}\rvert s)A^{\infty}(s,a)
\displaystyle=0-0-0=0,
\displaystyle=0-0-0=0,
A^{\infty}(s,a_{+})>0
\pi_{\infty}(a_{+}\rvert s)\geq 0
\sum_{a_{+}\in I_{+}^{s}}\pi_{\infty}(a_{+}\rvert s)=0
I_{+}^{s}\neq\emptyset
\pi_{m}(a_{+}\rvert s)\rightarrow 0
m\rightarrow\infty
a\in I_{+}^{s}
\lim_{m\rightarrow\infty}\pi_{m}(a|s)=1
I_{+}^{s}=\emptyset
I_{+}^{s}\neq\emptyset
K
\forall m>K,s\in\mathcal{S}
\displaystyle Q^{m}(s,a^{+})>Q^{m}(s,a^{0})>Q^{m}(s,a^{-}),\quad\text{for all %
$a^{+}\in I^{s}_{+}$, $a^{0}\in I^{s}_{0}$, $a^{-}\in I^{s}_{-}$}.
a^{+}\in I^{s}_{+}
a^{0}\in I^{s}_{0}
a^{-}\in I^{s}_{-}
\displaystyle Q^{m}(s,a^{+})>Q^{m}(s,a^{0})>Q^{m}(s,a^{-}),\quad\text{for all %
$a^{+}\in I^{s}_{+}$, $a^{0}\in I^{s}_{0}$, $a^{-}\in I^{s}_{-}$}.
a^{+}\in I^{s}_{+}
a^{0}\in I^{s}_{0}
a^{-}\in I^{s}_{-}
Q^{m}
\forall m>K
\displaystyle Q^{m}(s,\tilde{a}^{+})>Q^{m}(s,a_{1})>Q^{m}(s,a_{2})>\dots>Q^{m}%
(s,a_{|\mathcal{A}|-1}),\quad\text{provided that $I_{+}^{s}\neq\emptyset$},
I_{+}^{s}\neq\emptyset
\displaystyle Q^{m}(s,\tilde{a}^{+})>Q^{m}(s,a_{1})>Q^{m}(s,a_{2})>\dots>Q^{m}%
(s,a_{|\mathcal{A}|-1}),\quad\text{provided that $I_{+}^{s}\neq\emptyset$},
I_{+}^{s}\neq\emptyset
\tilde{a}^{+}:=\operatorname*{argmax}_{a^{+}\in I^{s}_{+}}Q^{(\infty)}(s,a^{+})
I_{+}^{s}\neq\emptyset
a_{+}\in I_{+}^{s}
\lim_{m\rightarrow\infty}\pi_{m}(a_{+}|s)=1
\alpha_{m}(s,a)\geq\log\frac{1}{\pi_{m}(a|s)}
I_{+}^{s}\neq\emptyset
\lim_{m\rightarrow\infty}\pi_{m}(a|s)=0
a\neq\tilde{a}^{+}
m\geq 1,s\in\mathcal{S},a\in\mathcal{A}
A^{m}(s,a)\leq 0
\exists\enspace a^{\prime}\neq a
a^{\prime}\in{B}_{m}(s)
A^{m}(s,a^{\prime})>0
\pi_{m+1}(a|s)\leq\frac{1}{2}
a\in{B}_{m}(s)
A^{m}(s,a)\leq 0
\operatorname{sign}(A^{m}(s,a))\cdot\alpha_{m}(s,a)\leq 0
\displaystyle\begin{cases}\pi_{m+1}(a|s)=\frac{\exp({\theta_{m}(s,a)+%
\operatorname{sign}(A^{m}(s,a))\cdot\alpha_{m}(s,a)})}{Z_{m+1}(s)}\leq\frac{%
\exp({\theta_{m}(s,a)})}{Z_{m+1}(s)}\leq\frac{Z_{m}(s)}{Z_{m+1}(s)}\\
\pi_{m+1}(a^{{}^{\prime}}|s)=\frac{\exp({\theta_{m}(s,a^{\prime})+\alpha_{m}(s%
,a^{\prime})})}{Z_{m+1}(s)}\geq\frac{\exp({\theta_{m}(s,a^{\prime})+\log(\frac%
{1}{\pi_{m}(a^{\prime}|s)})})}{Z_{m+1}(s)}=\frac{Z_{m}(s)}{Z_{m+1}(s)}\end{cases}
\displaystyle\begin{cases}\pi_{m+1}(a|s)=\frac{\exp({\theta_{m}(s,a)+%
\operatorname{sign}(A^{m}(s,a))\cdot\alpha_{m}(s,a)})}{Z_{m+1}(s)}\leq\frac{%
\exp({\theta_{m}(s,a)})}{Z_{m+1}(s)}\leq\frac{Z_{m}(s)}{Z_{m+1}(s)}\\
\pi_{m+1}(a^{{}^{\prime}}|s)=\frac{\exp({\theta_{m}(s,a^{\prime})+\alpha_{m}(s%
,a^{\prime})})}{Z_{m+1}(s)}\geq\frac{\exp({\theta_{m}(s,a^{\prime})+\log(\frac%
{1}{\pi_{m}(a^{\prime}|s)})})}{Z_{m+1}(s)}=\frac{Z_{m}(s)}{Z_{m+1}(s)}\end{cases}
\pi_{m+1}(a^{{}^{\prime}}|s)\geq\pi_{m+1}(a|s)
\pi_{m+1}(a^{{}^{\prime}}|s)+\pi_{m+1}(a|s)\leq 1
\pi_{m+1}(a|s)\leq\frac{1}{2}
s\in\mathcal{S},a\in\mathcal{A}\setminus\left\{\tilde{a}^{+}\right\}
\exists\enspace T\in\mathbb{N}
\forall m>T
A^{m}(s,a)\leq 0
\exists\enspace n\in\mathbb{N}
\bar{K}\in\mathbb{N}
A^{m+n+1}(s,a)<0\text{, }\forall\enspace m>\bar{K}
I_{+}^{s}\neq\emptyset
n\in\mathbb{N}
\exists\enspace a^{\prime}\neq a
a^{\prime}\in{B}_{m+n}(s)
A^{m+n+1}(s,a^{\prime})>0
\displaystyle\pi_{m+n+1}(a|s)\leq\frac{1}{2},\quad\text{$\forall m\geq T$}.
\displaystyle\pi_{m+n+1}(a|s)\leq\frac{1}{2},\quad\text{$\forall m\geq T$}.
\displaystyle V^{m+n+1}(s)=\sum_{a\in\mathcal{A}}\pi_{m+n+1}(a|s)\cdot Q^{m+n+%
1}(s,a)\geq\frac{1}{2}\cdot\left(Q^{m+n+1}(s,a)+Q^{m+n+1}(s,a^{\prime})\right)
\displaystyle V^{m+n+1}(s)=\sum_{a\in\mathcal{A}}\pi_{m+n+1}(a|s)\cdot Q^{m+n+%
1}(s,a)\geq\frac{1}{2}\cdot\left(Q^{m+n+1}(s,a)+Q^{m+n+1}(s,a^{\prime})\right)
a^{\prime}=\underset{\begin{subarray}{c}a^{\prime\prime}\in\mathcal{A}\\
Q^{\infty}(s,a^{\prime\prime})>Q^{\infty}(s,a)\end{subarray}}{\mathrm{argmin}}%
Q^{\infty}(s,a^{\prime\prime})
a^{\prime}=\underset{\begin{subarray}{c}a^{\prime\prime}\in\mathcal{A}\\
Q^{\infty}(s,a^{\prime\prime})>Q^{\infty}(s,a)\end{subarray}}{\mathrm{argmin}}%
Q^{\infty}(s,a^{\prime\prime})
Q^{m}
\lim_{m\rightarrow\infty}Q^{m}(s,a)=Q^{\infty}(s,a)
\epsilon=\frac{1}{4}\cdot\left(Q^{\infty}(s,a^{\prime})-Q^{\infty}(s,a)\right)>0
\exists\enspace\bar{T}
m>\bar{T}
\displaystyle\begin{cases}Q^{m}(s,a)\in\left(Q^{\infty}(s,a)-\epsilon,Q^{%
\infty}(s,a)+\epsilon\right)\\
Q^{m}(s,a^{\prime})\in\left(Q^{\infty}(s,a^{\prime})-\epsilon,Q^{\infty}(s,a^{%
\prime})+\epsilon\right)\end{cases}
\displaystyle\begin{cases}Q^{m}(s,a)\in\left(Q^{\infty}(s,a)-\epsilon,Q^{%
\infty}(s,a)+\epsilon\right)\\
Q^{m}(s,a^{\prime})\in\left(Q^{\infty}(s,a^{\prime})-\epsilon,Q^{\infty}(s,a^{%
\prime})+\epsilon\right)\end{cases}
m>\max\left\{T,\bar{T}\right\}
\displaystyle V^{m+n+1}(s)\geq\frac{1}{2}\cdot\left(Q^{m+n+1}(s,a)+Q^{m+n+1}(s%
,a^{\prime})\right)
\displaystyle V^{m+n+1}(s)
\displaystyle\geq\frac{1}{2}\cdot\left(Q^{m+n+1}(s,a)+Q^{m+n+1}(s,a^{\prime})\right)
\displaystyle>\frac{1}{2}\cdot\left((Q^{\infty}(s,a))+(Q^{\infty}(s,a^{\prime}%
))\right)
\displaystyle>\frac{1}{2}\cdot\left((Q^{\infty}(s,a))+(Q^{\infty}(s,a^{\prime}%
))\right)
\displaystyle>\frac{1}{2}\cdot\left(Q^{\infty}(s,a)+Q^{\infty}(s,a^{\prime})%
\right)-\epsilon
\displaystyle>\frac{1}{2}\cdot\left(Q^{\infty}(s,a)+Q^{\infty}(s,a^{\prime})%
\right)-\epsilon
\displaystyle=Q^{\infty}(s,a)+\epsilon>Q^{m+n+1}(s,a).
\displaystyle=Q^{\infty}(s,a)+\epsilon>Q^{m+n+1}(s,a).
A^{m+n+1}(s,a)<0\enspace\forall\enspace m>\bar{K}
\bar{K}=\max\left\{T,\bar{T}\right\}
V^{m}(s)\in\left(Q^{m}(s,a_{|\mathcal{A}|-k}),Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\right)
\exists\enspace T^{\prime}\in\mathbb{N}
m>T^{\prime}
\displaystyle\frac{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}\geq\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}|-1})}{Q^%
{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|\mathcal{A}|-(k+1)})}
\displaystyle\frac{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}\geq\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}|-1})}{Q^%
{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|\mathcal{A}|-(k+1)})}
V^{m}(s)\in\left(Q^{m}(s,a_{|\mathcal{A}|-k}),Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\right)
V^{m}(s)\in\left(Q^{m}(s,a_{|\mathcal{A}|-k}),Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\right)
V^{m}(s)\in\left(Q^{m}(s,a_{|\mathcal{A}|-k}),Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\right)
A^{m}(s,a_{|\mathcal{A}|-j})<0,\enspace\forall\enspace j=1,2,\dots,k
n\in\mathbb{N}
\bar{a}^{+}\in\mathcal{B}_{m+n}(s)
\bar{a}^{+}\in\left\{\tilde{a}^{+},a_{1},a_{2},\dots,a_{|\mathcal{A}|-(k+2)}\right\}
\bar{a}^{-}\in\left\{a_{|\mathcal{A}|-k},a_{|\mathcal{A}|-(k-1)},\dots,a_{|%
\mathcal{A}|-1}\right\}
\displaystyle\frac{\pi_{m+n+1}(\bar{a}^{+}|s)}{\pi_{m+n+1}(\bar{a}^{-}|s)}\geq%
\frac{\frac{e^{\theta_{m+n}(s,\bar{a}^{+})+\log{\frac{1}{\pi_{m+n}(\bar{a}^{+}%
|s)}}}}{Z_{m+n+1}(s)}}{\frac{e^{\theta_{m+n}(s,\bar{a}^{-})}}{Z_{m+n+1}(s)}}=%
\frac{Z_{m+n}(s)}{e^{\theta_{m+n}(s,\bar{a}^{-})}}=\frac{1}{\pi_{m+n}(\bar{a}^%
{-}|s)}.
\displaystyle\frac{\pi_{m+n+1}(\bar{a}^{+}|s)}{\pi_{m+n+1}(\bar{a}^{-}|s)}\geq%
\frac{\frac{e^{\theta_{m+n}(s,\bar{a}^{+})+\log{\frac{1}{\pi_{m+n}(\bar{a}^{+}%
|s)}}}}{Z_{m+n+1}(s)}}{\frac{e^{\theta_{m+n}(s,\bar{a}^{-})}}{Z_{m+n+1}(s)}}=%
\frac{Z_{m+n}(s)}{e^{\theta_{m+n}(s,\bar{a}^{-})}}=\frac{1}{\pi_{m+n}(\bar{a}^%
{-}|s)}.
\lim_{m\rightarrow\infty}\pi_{m}(s,a)=0
\forall z\in\mathbb{Z}
\exists\enspace T\in\mathbb{N}
\frac{\pi_{m+n+1}(\bar{a}^{+}|s)}{\pi_{m+n+1}(\bar{a}^{-}|s)}\geq z,\enspace%
\forall m>T
m>K
Q^{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|\mathcal{A}|-(k+1)})>0
z=\frac{1}{\mathcal{A}}\cdot\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{%
|\mathcal{A}|-1})}{Q^{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|\mathcal{A}|-(%
k+1)})}
\bar{a}^{+}
\bar{a}^{-}
T^{\prime}=\max\left\{K,T\right\}
I_{+}^{s}\neq\emptyset
\lim_{m\rightarrow\infty}\pi_{m}(a_{|\mathcal{A}|-1}|s)=0
Q^{m}
\displaystyle V^{m}(s)=\sum_{a\in\mathcal{A}}\pi_{m}(a|s)\cdot Q^{m}(s,a)\geq 1%
\cdot Q^{m}(s,a_{|\mathcal{A}|-1})\text{, \quad$\forall m>K$ }.
\forall m>K
\displaystyle V^{m}(s)=\sum_{a\in\mathcal{A}}\pi_{m}(a|s)\cdot Q^{m}(s,a)\geq 1%
\cdot Q^{m}(s,a_{|\mathcal{A}|-1})\text{, \quad$\forall m>K$ }.
\forall m>K
m>K
\displaystyle A^{m}(s,a_{|\mathcal{A}|-1})=Q^{m}(s,a_{|\mathcal{A}|-1})-V^{m}(%
s)\leq Q^{m}(s,a_{|\mathcal{A}|-1})-Q^{m}(s,a_{|\mathcal{A}|-1})=0.
\displaystyle A^{m}(s,a_{|\mathcal{A}|-1})=Q^{m}(s,a_{|\mathcal{A}|-1})-V^{m}(%
s)\leq Q^{m}(s,a_{|\mathcal{A}|-1})-Q^{m}(s,a_{|\mathcal{A}|-1})=0.
\exists\enspace n_{|\mathcal{A}|-1}\in\mathbb{N}
K_{|\mathcal{A}|-1}\in\mathbb{N}
\displaystyle A^{m+n_{|\mathcal{A}|-1}+1}(s,a_{|\mathcal{A}|-1})<0\text{, %
\quad$\forall m>K_{|\mathcal{A}|-1}$ }.
\forall m>K_{|\mathcal{A}|-1}
\displaystyle A^{m+n_{|\mathcal{A}|-1}+1}(s,a_{|\mathcal{A}|-1})<0\text{, %
\quad$\forall m>K_{|\mathcal{A}|-1}$ }.
\forall m>K_{|\mathcal{A}|-1}
\displaystyle\operatorname{sign}(A^{m}(s,a_{|\mathcal{A}|-1}))\cdot\alpha_{m}%
\left(s,a_{|\mathcal{A}|-1}\right)<0\text{, \quad$\forall m>K_{|\mathcal{A}|-1%
}$. }
\forall m>K_{|\mathcal{A}|-1}
\displaystyle\operatorname{sign}(A^{m}(s,a_{|\mathcal{A}|-1}))\cdot\alpha_{m}%
\left(s,a_{|\mathcal{A}|-1}\right)<0\text{, \quad$\forall m>K_{|\mathcal{A}|-1%
}$. }
\forall m>K_{|\mathcal{A}|-1}
\lim_{m\rightarrow\infty}\theta_{m}(s,a_{|\mathcal{A}|-1})=-\infty
\lim_{m\rightarrow\infty}\pi_{m}(s,a_{|\mathcal{A}|-1})=0
\lim_{m\rightarrow\infty}\pi_{m}(a_{|\mathcal{A}|-1}|s)=\lim_{m\rightarrow%
\infty}\pi_{m}(a_{|\mathcal{A}|-2}|s)=\dots=\lim_{m\rightarrow\infty}\pi_{m}(a%
_{|\mathcal{A}|-k}|s)=0
k\in\left[1,(|\mathcal{A}|-2)\right]
\lim_{m\rightarrow\infty}\pi_{m}(a_{|\mathcal{A}|-(k+1)}|s)
\displaystyle\lim_{m\rightarrow\infty}\sum_{\begin{subarray}{c}a\in\mathcal{A}%
\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)=0
\displaystyle\lim_{m\rightarrow\infty}\sum_{\begin{subarray}{c}a\in\mathcal{A}%
\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)=0
\exists\enspace K^{\prime}_{|\mathcal{A}|-(k+1)}\in\mathbb{N}
\forall\enspace m>K^{\prime}_{|\mathcal{A}|-(k+1)}
a_{|\mathcal{A}|-(k+1)}
a_{|\mathcal{A}|-(k+1)}
\displaystyle\frac{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}\geq\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}|-1})}{Q^%
{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|\mathcal{A}|-(k+1)})}
\displaystyle\frac{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}{\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)}\geq\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}|-1})}{Q^%
{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|\mathcal{A}|-(k+1)})}
V^{m}(s)\in\left(Q^{m}(s,a_{|\mathcal{A}|-k}),Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\right)
V^{m}(s)\in\left(Q^{m}(s,a_{|\mathcal{A}|-k}),Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\right)
Q^{m}
\displaystyle V^{m}(s)=\sum_{a\in\mathcal{A}}\pi_{m}(a|s)\cdot Q^{m}(s,a)
\displaystyle V^{m}(s)
\displaystyle=\sum_{a\in\mathcal{A}}\pi_{m}(a|s)\cdot Q^{m}(s,a)
\displaystyle=\left[\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\cdot Q^{m}(s,a)+Q^{m}(s,a_{|\mathcal{A}|-(k+1)})\cdot\pi_{m}(a_{|\mathcal{A%
}|-(k+1)}|s)\right.
\displaystyle=\left[\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\cdot Q^{m}(s,a)+Q^{m}(s,a_{|\mathcal{A}|-(k+1)})\cdot\pi_{m}(a_{|\mathcal{A%
}|-(k+1)}|s)\right.
\displaystyle\left.\quad+\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\cdot Q^{m}(s,a)\right]
\displaystyle\left.\quad+\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\cdot Q^{m}(s,a)\right]
\displaystyle\geq\left[Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\cdot\sum_{\begin{%
subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)+Q^{m}(s,a_{|\mathcal{A}|-(k+1)})\cdot\pi_{m}(a_{|\mathcal{A}|-(k+1)}|s)\right.
\displaystyle\geq\left[Q^{m}(s,a_{|\mathcal{A}|-(k+2)})\cdot\sum_{\begin{%
subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)+Q^{m}(s,a_{|\mathcal{A}|-(k+1)})\cdot\pi_{m}(a_{|\mathcal{A}|-(k+1)}|s)\right.
\displaystyle\left.\quad+Q^{m}(s,a_{|\mathcal{A}|-1})\cdot\sum_{\begin{%
subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\right]\text{, \quad$\forall m>K$ }.
\forall m>K
\displaystyle\left.\quad+Q^{m}(s,a_{|\mathcal{A}|-1})\cdot\sum_{\begin{%
subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\right]\text{, \quad$\forall m>K$ }.
\forall m>K
m>K^{\prime}_{|\mathcal{A}|-(k+1)}
\displaystyle A^{m}(s,a_{|\mathcal{A}|-(k+1)})=Q^{m}(s,a_{|\mathcal{A}|-(k+1)}%
)-V^{m}(s)
\displaystyle A^{m}(s,a_{|\mathcal{A}|-(k+1)})
\displaystyle=Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-V^{m}(s)
\displaystyle\leq Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-\left[Q^{m}(s,a_{|\mathcal{%
A}|-(k+2)})\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\right.
\displaystyle\leq Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-\left[Q^{m}(s,a_{|\mathcal{%
A}|-(k+2)})\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\right.
\displaystyle\left.\qquad\qquad\qquad\qquad\qquad\quad+Q^{m}(s,a_{|\mathcal{A}%
|-(k+1)})\cdot\pi_{m}(a_{|\mathcal{A}|-(k+1)}|s)\right.
\displaystyle\left.\qquad\qquad\qquad\qquad\qquad\quad+Q^{m}(s,a_{|\mathcal{A}%
|-(k+1)})\cdot\pi_{m}(a_{|\mathcal{A}|-(k+1)}|s)\right.
\displaystyle\left.\qquad\qquad\qquad\qquad\qquad\quad+Q^{m}(s,a_{|\mathcal{A}%
|-1})\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\right]
\displaystyle\left.\qquad\qquad\qquad\qquad\qquad\quad+Q^{m}(s,a_{|\mathcal{A}%
|-1})\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|%
s)\right]
\displaystyle=\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}|-%
(k+2)})\right)\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle=\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}|-%
(k+2)})\right)\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle\quad+\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal%
{A}|-1})\right)\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle\quad+\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal%
{A}|-1})\right)\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)<Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle\leq\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A%
}|-(k+2)})\right)\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle\leq\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A%
}|-(k+2)})\right)\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle\quad+\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal%
{A}|-1})\right)\cdot\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|%
\mathcal{A}|-(k+1)})}{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}%
|-1})}
\displaystyle\quad+\left(Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal%
{A}|-1})\right)\cdot\frac{Q^{m}(s,a_{|\mathcal{A}|-(k+2)})-Q^{m}(s,a_{|%
\mathcal{A}|-(k+1)})}{Q^{m}(s,a_{|\mathcal{A}|-(k+1)})-Q^{m}(s,a_{|\mathcal{A}%
|-1})}
\displaystyle\qquad\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle\qquad\cdot\sum_{\begin{subarray}{c}a\in\mathcal{A}\\
Q^{\infty}(s,a)>Q^{\infty}(s,a_{|\mathcal{A}|-(k+1)})\end{subarray}}\pi_{m}(a|s)
\displaystyle=0
\displaystyle=0
\exists\enspace n_{|\mathcal{A}|-(k+1)}\in\mathbb{N}
K_{|\mathcal{A}|-(k+1)}\in\mathbb{N}
\displaystyle A^{m+n_{|\mathcal{A}|-(k+1)}+1}(s,a_{|\mathcal{A}|-(k+1)})<0%
\text{, \quad$\forall m>K_{|\mathcal{A}|-(k+1)}$ }
\forall m>K_{|\mathcal{A}|-(k+1)}
\displaystyle A^{m+n_{|\mathcal{A}|-(k+1)}+1}(s,a_{|\mathcal{A}|-(k+1)})<0%
\text{, \quad$\forall m>K_{|\mathcal{A}|-(k+1)}$ }
\forall m>K_{|\mathcal{A}|-(k+1)}
\displaystyle\operatorname{sign}(A^{m}(s,a_{|\mathcal{A}|-1}))\cdot\alpha_{m}%
\left(s,a_{|\mathcal{A}|-(k+1)}\right)<0\text{, \quad$\forall m>K_{|\mathcal{A%
}|-(k+1)}$ }
\forall m>K_{|\mathcal{A}|-(k+1)}
\displaystyle\operatorname{sign}(A^{m}(s,a_{|\mathcal{A}|-1}))\cdot\alpha_{m}%
\left(s,a_{|\mathcal{A}|-(k+1)}\right)<0\text{, \quad$\forall m>K_{|\mathcal{A%
}|-(k+1)}$ }
\forall m>K_{|\mathcal{A}|-(k+1)}
\lim_{m\rightarrow\infty}\theta_{m}(s,a_{|\mathcal{A}|-(k+1)})=-\infty
\lim_{m\rightarrow\infty}\pi_{m}(s,a_{|\mathcal{A}|-(k+1)})=0
\forall a\neq\tilde{a^{+}}
\lim_{m\rightarrow\infty}\pi_{m}(s,a)=0
\lim_{m\rightarrow\infty}\pi_{m}(s,\tilde{a^{+}})=1
\pi_{\theta}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
V^{\pi_{m}}(s)\rightarrow V^{*}(s)
m\rightarrow\infty
s\in\mathcal{S}
I_{+}^{s}\neq\emptyset
a\in I_{+}^{s}
\lim_{m\rightarrow\infty}\pi_{m}(a|s)=1
I_{+}^{s}=\emptyset
V^{(\infty)}
|A^{m}(s,a)|\leq\frac{1}{1-\gamma}\cdot(1-\pi_{m}(a|s))
(s,a)\in\mathcal{S}\times\mathcal{A}
A^{m}(s,a)>0
\displaystyle|A^{m}(s,a)|=Q^{\pi_{m}}(s,a)-V^{\pi_{m}}(s)
\displaystyle|A^{m}(s,a)|
\displaystyle=Q^{\pi_{m}}(s,a)-V^{\pi_{m}}(s)
\displaystyle=Q^{\pi_{m}}(s,a)-\sum_{a^{\prime}\in\mathcal{A}}\pi_{m}(a^{%
\prime}|s)\cdot Q^{\pi_{m}}(s,a^{\prime})
\displaystyle=Q^{\pi_{m}}(s,a)-\sum_{a^{\prime}\in\mathcal{A}}\pi_{m}(a^{%
\prime}|s)\cdot Q^{\pi_{m}}(s,a^{\prime})
\displaystyle\leq Q^{\pi_{m}}(s,a)-\pi_{m}(a|s)\cdot Q^{\pi_{m}}(s,a)
\displaystyle\leq Q^{\pi_{m}}(s,a)-\pi_{m}(a|s)\cdot Q^{\pi_{m}}(s,a)
\displaystyle=Q^{\pi_{m}}(s,a)\cdot(1-\pi_{m}(a|s))
\displaystyle=Q^{\pi_{m}}(s,a)\cdot(1-\pi_{m}(a|s))
\displaystyle\leq\frac{1}{1-\gamma}\cdot(1-\pi_{m}(a|s))
\displaystyle\leq\frac{1}{1-\gamma}\cdot(1-\pi_{m}(a|s))
A^{m}(s,a)\leq 0
\displaystyle|A^{m}(s,a)|=V^{\pi_{m}}(s)-Q^{\pi_{m}}(s,a)
\displaystyle|A^{m}(s,a)|
\displaystyle=V^{\pi_{m}}(s)-Q^{\pi_{m}}(s,a)
\displaystyle=\sum_{a^{\prime}\in\mathcal{A}}\pi_{m}(a^{\prime}|s)\cdot Q^{\pi%
_{m}}(s,a^{\prime})-Q^{\pi_{m}}(s,a)
\displaystyle=\sum_{a^{\prime}\in\mathcal{A}}\pi_{m}(a^{\prime}|s)\cdot Q^{\pi%
_{m}}(s,a^{\prime})-Q^{\pi_{m}}(s,a)
\displaystyle=\sum_{a^{\prime}\neq a}\pi_{m}(a^{\prime}|s)\cdot Q^{\pi_{m}}(s,%
a^{\prime})-(1-\pi_{m}(a|s))\cdot Q^{\pi_{m}}(s,a)
\displaystyle=\sum_{a^{\prime}\neq a}\pi_{m}(a^{\prime}|s)\cdot Q^{\pi_{m}}(s,%
a^{\prime})-(1-\pi_{m}(a|s))\cdot Q^{\pi_{m}}(s,a)
\displaystyle\leq\sum_{a^{\prime}\neq a}\pi_{m}(a^{\prime}|s)\cdot Q^{\pi_{m}}%
(s,a^{\prime})
\displaystyle\leq\sum_{a^{\prime}\neq a}\pi_{m}(a^{\prime}|s)\cdot Q^{\pi_{m}}%
(s,a^{\prime})
\displaystyle\leq\frac{1}{1-\gamma}\cdot\sum_{a^{\prime}\neq a}\pi_{m}(a^{%
\prime}|s)
\displaystyle\leq\frac{1}{1-\gamma}\cdot\sum_{a^{\prime}\neq a}\pi_{m}(a^{%
\prime}|s)
\displaystyle=\frac{1}{1-\gamma}\cdot(1-\pi_{m}(a|s))
\displaystyle=\frac{1}{1-\gamma}\cdot(1-\pi_{m}(a|s))
\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}\leq\left(\frac{1}{1-\gamma}\cdot A^{m%
}(\tilde{s_{m}},\tilde{a_{m}})\right)^{2}
m\geq 1
(\tilde{s_{m}},\tilde{a_{m}})=\underset{(s,a)\in\mathcal{S}\times\mathcal{A}}{%
\operatorname*{argmax}}A^{m}(s,a)
\displaystyle\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}=\left(\frac{1}{1-\gamma}%
\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi^{*}}_{s}(s^{\prime})\sum_{a^{\prime%
}\in\mathcal{A}}\pi^{*}(a^{\prime}|s^{\prime})\cdot A^{m}(s^{\prime},a^{\prime%
})\right)^{2}
\displaystyle\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=\left(\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{%
\pi^{*}}_{s}(s^{\prime})\sum_{a^{\prime}\in\mathcal{A}}\pi^{*}(a^{\prime}|s^{%
\prime})\cdot A^{m}(s^{\prime},a^{\prime})\right)^{2}
\displaystyle\leq\left(\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d%
^{\pi^{*}}_{s}(s^{\prime})\cdot\underset{a^{\prime}\in\mathcal{A}}{\max}A^{m}(%
s^{\prime},a^{\prime})\right)^{2}
\displaystyle\leq\left(\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d%
^{\pi^{*}}_{s}(s^{\prime})\cdot\underset{a^{\prime}\in\mathcal{A}}{\max}A^{m}(%
s^{\prime},a^{\prime})\right)^{2}
\displaystyle\leq\left(\frac{1}{1-\gamma}\cdot\underset{(s^{\prime},a^{\prime}%
)\in\mathcal{S}\times\mathcal{A}}{\max}A^{m}(s^{\prime},a^{\prime})\right)^{2}
\displaystyle\leq\left(\frac{1}{1-\gamma}\cdot\underset{(s^{\prime},a^{\prime}%
)\in\mathcal{S}\times\mathcal{A}}{\max}A^{m}(s^{\prime},a^{\prime})\right)^{2}
\displaystyle=\left(\frac{1}{1-\gamma}\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})%
\right)^{2}
\displaystyle=\left(\frac{1}{1-\gamma}\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})%
\right)^{2}
V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{1-\gamma}\cdot\left\|\frac{1}{\mu}%
\right\|_{\infty}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)=\frac{1}{1-\gamma}\cdot\sum_{s\in%
\mathcal{S}}d^{\pi^{*}}_{\rho}(s)\sum_{a\in\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}%
(s,a)
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\rho}(%
s)\sum_{a\in\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\mu}(s%
)\cdot\frac{d^{\pi^{*}}_{\rho}(s)}{d^{\pi^{*}}_{\mu}(s)}\sum_{a^{\prime}\in%
\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\mu}(s%
)\cdot\frac{d^{\pi^{*}}_{\rho}(s)}{d^{\pi^{*}}_{\mu}(s)}\sum_{a^{\prime}\in%
\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle\leq\frac{1}{1-\gamma}\cdot\left\|\frac{1}{d^{\pi^{*}}_{\mu}}%
\right\|_{\infty}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\mu}(s)\sum_{a^{%
\prime}\in\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle\leq\frac{1}{1-\gamma}\cdot\left\|\frac{1}{d^{\pi^{*}}_{\mu}}%
\right\|_{\infty}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\mu}(s)\sum_{a^{%
\prime}\in\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle\leq\frac{1}{(1-\gamma)^{2}}\cdot\left\|\frac{1}{\mu}\right\|_{%
\infty}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\mu}(s)\sum_{a^{\prime}\in%
\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle\leq\frac{1}{(1-\gamma)^{2}}\cdot\left\|\frac{1}{\mu}\right\|_{%
\infty}\cdot\sum_{s\in\mathcal{S}}d^{\pi^{*}}_{\mu}(s)\sum_{a^{\prime}\in%
\mathcal{A}}\pi^{*}(a|s)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}%
\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)
\displaystyle=\frac{1}{1-\gamma}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}%
\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)
d^{\pi}_{\mu}(s)\geq(1-\gamma)\cdot\mu(s)
\pi,s\in\mathcal{S}
\mu(s)
\displaystyle d^{\pi}_{\mu}(s)=\underset{s_{0}\sim\mu}{\mathbb{E}}\left[d^{\pi%
}_{\mu}(s)\right]
\displaystyle d^{\pi}_{\mu}(s)
\displaystyle=\underset{s_{0}\sim\mu}{\mathbb{E}}\left[d^{\pi}_{\mu}(s)\right]
\displaystyle=\underset{s_{0}\sim\mu}{\mathbb{E}}\left[(1-\gamma)\cdot\sum_{t=%
0}^{\infty}\gamma^{t}\cdot\mathbb{P}(s_{t}=s\>|\>s_{0},\pi)\right]
\displaystyle=\underset{s_{0}\sim\mu}{\mathbb{E}}\left[(1-\gamma)\cdot\sum_{t=%
0}^{\infty}\gamma^{t}\cdot\mathbb{P}(s_{t}=s\>|\>s_{0},\pi)\right]
\displaystyle\geq\underset{s_{0}\sim\mu}{\mathbb{E}}\left[(1-\gamma)\cdot%
\mathbb{P}(s_{0}=s\>|\>s_{0},\pi)\right]
\displaystyle\geq\underset{s_{0}\sim\mu}{\mathbb{E}}\left[(1-\gamma)\cdot%
\mathbb{P}(s_{0}=s\>|\>s_{0},\pi)\right]
\displaystyle=(1-\gamma)\cdot\mu(s)
\displaystyle=(1-\gamma)\cdot\mu(s)
\delta_{m+1}\leq\delta_{m}-c\cdot\delta_{m}^{2}
\delta_{m}\leq\frac{1}{1-\gamma}
m\geq 1
c\leq\frac{1-\gamma}{2}
\delta_{m}\leq\frac{1}{c}\cdot\frac{1}{m}
\sum_{m=1}^{M}\delta_{m}\leq\min{\left\{\sqrt{\frac{M}{c\cdot(1-\gamma)}},%
\frac{\log M+1}{c}\right\}}
m\geq 1
m\leq 2
\delta_{m}\leq\frac{1}{c}\cdot\frac{1}{m}
c\leq\frac{1-\gamma}{2}
\delta_{m}\leq\frac{1}{1-\gamma}
f_{t}(x)=x-c\cdot x^{2}=-c(x-\frac{1}{2c})^{2}+\frac{1}{4c}
f_{t}(x)
[0,\frac{1}{2c}]
\displaystyle\delta_{m+1}\leq f_{t}(\delta_{m})
\displaystyle\delta_{m+1}
\displaystyle\leq f_{t}(\delta_{m})
\displaystyle\leq f_{t}(\frac{1}{c}\cdot\frac{1}{m})
\displaystyle\leq f_{t}(\frac{1}{c}\cdot\frac{1}{m})
\displaystyle=\frac{1}{c}\cdot(\frac{1}{m}-\frac{1}{m^{2}})
\displaystyle=\frac{1}{c}\cdot(\frac{1}{m}-\frac{1}{m^{2}})
\displaystyle\leq\frac{1}{c}\cdot\frac{1}{m+1}
\displaystyle\leq\frac{1}{c}\cdot\frac{1}{m+1}
\delta_{m}
\displaystyle\sum_{m=1}^{M}\delta_{m}\leq\sum_{m=1}^{M}\frac{1}{c}\cdot\frac{1%
}{m}
\displaystyle\sum_{m=1}^{M}\delta_{m}
\displaystyle\leq\sum_{m=1}^{M}\frac{1}{c}\cdot\frac{1}{m}
\displaystyle=\frac{1}{c}\cdot\sum_{m=1}^{M}\frac{1}{m}
\displaystyle=\frac{1}{c}\cdot\sum_{m=1}^{M}\frac{1}{m}
\displaystyle\leq\frac{1}{c}\cdot(\ln{M}+1)
\displaystyle\leq\frac{1}{c}\cdot(\ln{M}+1)
\displaystyle\sum_{m=1}^{M}\delta_{m}^{2}\leq\frac{1}{c}\cdot\sum_{m=1}^{M}(%
\delta_{m}-\delta_{m+1})
\displaystyle\sum_{m=1}^{M}\delta_{m}^{2}
\displaystyle\leq\frac{1}{c}\cdot\sum_{m=1}^{M}(\delta_{m}-\delta_{m+1})
\displaystyle\leq\frac{1}{c}\cdot(\delta_{1}-\delta_{M+1})
\displaystyle\leq\frac{1}{c}\cdot(\delta_{1}-\delta_{M+1})
\displaystyle\leq\frac{1}{c}\cdot\frac{1}{1-\gamma}
\displaystyle\leq\frac{1}{c}\cdot\frac{1}{1-\gamma}
\displaystyle\sum_{m=1}^{M}\delta_{m}\leq\sqrt{M}\cdot\sqrt{\sum_{m=1}^{M}%
\delta_{m}^{2}}
\displaystyle\sum_{m=1}^{M}\delta_{m}
\displaystyle\leq\sqrt{M}\cdot\sqrt{\sum_{m=1}^{M}\delta_{m}^{2}}
\displaystyle\leq\sqrt{M}\cdot\sqrt{\frac{1}{c}\cdot\frac{1}{1-\gamma}}
\displaystyle\leq\sqrt{M}\cdot\sqrt{\frac{1}{c}\cdot\frac{1}{1-\gamma}}
\displaystyle=\sqrt{\frac{M}{c\cdot(1-\gamma)}}
\displaystyle=\sqrt{\frac{M}{c\cdot(1-\gamma)}}
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s_{m},a_{m})\right\}
A^{m}(s_{m},a_{m})>0
\pi_{m+1}(a|s)-\pi_{m}(a|s)
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}\frac{(1-\pi_{m}(a_{m}|s%
_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}&\text{, if }s=s_{m},a=a_{m}\\
-\frac{1-\pi_{m}(a_{m}|s_{m})}{2-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{m}(a|s)&\text{%
, if }s=s_{m},a\neq a_{m}\\
0&\text{, else }\end{cases}
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}\frac{(1-\pi_{m}(a_{m}|s%
_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}&\text{, if }s=s_{m},a=a_{m}\\
-\frac{1-\pi_{m}(a_{m}|s_{m})}{2-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{m}(a|s)&\text{%
, if }s=s_{m},a\neq a_{m}\\
0&\text{, else }\end{cases}
s=s_{m},a=a_{m}
\displaystyle\pi_{m+1}(a_{m}|s_{m})-\pi_{m}(a_{m}|s_{m})=\frac{e^{\theta_{m+1}%
(s_{m},a_{m})}}{\sum\limits_{a\in\mathcal{A}}e^{\theta_{m+1}(s_{m},a)}}-\pi_{m%
}(a_{m}|s_{m})
\displaystyle\pi_{m+1}(a_{m}|s_{m})-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m+1}(s_{m},a_{m})}}{\sum\limits_{a\in\mathcal{A%
}}e^{\theta_{m+1}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_{m}(a_{m}|s_{m}%
)})\cdot sign(A^{m}(s_{m},a_{m})}}{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_%
{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_{m}(a_{m}|s_{m}%
)})\cdot sign(A^{m}(s_{m},a_{m})}}{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_%
{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{\sum_{a}e^{\theta_{m}}%
(a)}{e^{\theta_{m}}(a_{m})})}}{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{\sum_{a}e^{%
\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{\sum_{a}e^{\theta_{m}}%
(a)}{e^{\theta_{m}}(a_{m})})}}{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{\sum_{a}e^{%
\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}}{%
\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}+\sum\limits_{a\neq a_%
{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}}{%
\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}+\sum\limits_{a\neq a_%
{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}}{%
\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}+(\frac{1}{\pi_{m}(a_{%
m}|s_{m})}-1)\cdot e^{\theta_{m}}(s_{m},a_{m})}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}}{%
\frac{e^{\theta_{m}}(s_{m},a_{m})}{\pi_{m}(a_{m}|s_{m})}+(\frac{1}{\pi_{m}(a_{%
m}|s_{m})}-1)\cdot e^{\theta_{m}}(s_{m},a_{m})}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\frac{1}{\pi_{m}(a_{m}|s_{m})}}{\frac{2}{\pi_{m}(a_{m}|s_{%
m})}-1}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\frac{1}{\pi_{m}(a_{m}|s_{m})}}{\frac{2}{\pi_{m}(a_{m}|s_{%
m})}-1}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}
\displaystyle=\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}
s=s_{m},a\neq a_{m}
\displaystyle\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})=\frac{e^{\theta_{m+1}(s_{m},a%
)}}{\sum\limits_{a\in\mathcal{A}}e^{\theta_{m+1}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m+1}(s_{m},a)}}{\sum\limits_{a\in\mathcal{A}}e^%
{\theta_{m+1}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})+ln(%
\frac{1}{\pi_{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})+ln(%
\frac{1}{\pi_{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})+ln(%
\frac{\sum_{a}e^{\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})+ln(%
\frac{\sum_{a}e^{\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\frac{e^{\theta_{m}}(s_{m},a_{m})%
}{\pi_{m}(a_{m}|s_{m})}+\sum\limits_{a\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_%
{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\frac{e^{\theta_{m}}(s_{m},a_{m})%
}{\pi_{m}(a_{m}|s_{m})}+\sum\limits_{a\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_%
{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\frac{e^{\theta_{m}}(s_{m},a_{m})%
}{\pi_{m}(a_{m}|s_{m})}+(\frac{1}{\pi_{m}(a_{m}|s_{m})}-1)\cdot e^{\theta_{m}}%
(s_{m},a_{m})}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\frac{e^{\theta_{m}}(s_{m},a_{m})%
}{\pi_{m}(a_{m}|s_{m})}+(\frac{1}{\pi_{m}(a_{m}|s_{m})}-1)\cdot e^{\theta_{m}}%
(s_{m},a_{m})}-\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{e^{\theta_{m}(s_{m},a)}}{(\frac{2}{\pi_{m}(a_{m}|s_{%
m})}-1)\cdot e^{\theta_{m}}(s_{m},a_{m})}{\div}\pi_{m}(a|s_{m})-1\right)\cdot%
\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{e^{\theta_{m}(s_{m},a)}}{(\frac{2}{\pi_{m}(a_{m}|s_{%
m})}-1)\cdot e^{\theta_{m}}(s_{m},a_{m})}{\div}\pi_{m}(a|s_{m})-1\right)\cdot%
\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{\frac{1}{\pi_{m}(a_{m}|s_{m})}}{(\frac{2}{\pi_{m}(a_%
{m}|s_{m})}-1)}-1\right)\cdot\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{\frac{1}{\pi_{m}(a_{m}|s_{m})}}{(\frac{2}{\pi_{m}(a_%
{m}|s_{m})}-1)}-1\right)\cdot\pi_{m}(a|s_{m})
\displaystyle=-\frac{1-\pi_{m}(a_{m}|s_{m})}{2-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{%
m}(a|s)
\displaystyle=-\frac{1-\pi_{m}(a_{m}|s_{m})}{2-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{%
m}(a|s)
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s_{m},a_{m})\right\}
A^{m}(s_{m},a_{m})<0
\pi_{m+1}(a|s)-\pi_{m}(a|s)
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}\frac{-\pi_{m}(a_{m}|s_{%
m})\cdot(1-\pi_{m}(a_{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s%
_{m})+1}&\text{, if }s=s_{m},a=a_{m}\\
\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))}{\pi_{m}(a_{m}|s_{m})^%
{2}-\pi_{m}(a_{m}|s_{m})+1}\cdot\pi_{m}(a|s)&\text{, if }s=s_{m},a\neq a_{m}\\
0&\text{, else }\end{cases}
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}\frac{-\pi_{m}(a_{m}|s_{%
m})\cdot(1-\pi_{m}(a_{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s%
_{m})+1}&\text{, if }s=s_{m},a=a_{m}\\
\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))}{\pi_{m}(a_{m}|s_{m})^%
{2}-\pi_{m}(a_{m}|s_{m})+1}\cdot\pi_{m}(a|s)&\text{, if }s=s_{m},a\neq a_{m}\\
0&\text{, else }\end{cases}
s=s_{m},a=a_{m}
\displaystyle\pi_{m+1}(a_{m}|s_{m})-\pi_{m}(a_{m}|s_{m})=\frac{e^{\theta_{m+1}%
(s_{m},a_{m})}}{\sum\limits_{a\in\mathcal{A}}e^{\theta_{m+1}(s_{m},a)}}-\pi_{m%
}(a_{m}|s_{m})
\displaystyle\pi_{m+1}(a_{m}|s_{m})-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m+1}(s_{m},a_{m})}}{\sum\limits_{a\in\mathcal{A%
}}e^{\theta_{m+1}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_{m}(a_{m}|s_{m}%
)})\cdot sign(A^{m}(s_{m},a_{m})}}{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_%
{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_{m}(a_{m}|s_{m}%
)})\cdot sign(A^{m}(s_{m},a_{m})}}{e^{\theta_{m}(s_{m},a_{m})+ln(\frac{1}{\pi_%
{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})-ln(\frac{\sum_{a}e^{\theta_{m}}%
(a)}{e^{\theta_{m}}(a_{m})})}}{e^{\theta_{m}(s_{m},a_{m})-ln(\frac{\sum_{a}e^{%
\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a_{m})-ln(\frac{\sum_{a}e^{\theta_{m}}%
(a)}{e^{\theta_{m}}(a_{m})})}}{e^{\theta_{m}(s_{m},a_{m})-ln(\frac{\sum_{a}e^{%
\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})}{e^{%
\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})}{e^{%
\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})+\sum\limits_{a\neq a_{m}}e^{%
\theta_{m}(s_{m},a)}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})}{e^{%
\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})+(\frac{1}{\pi_{m}(a_{m}|s_{m%
})}-1)\cdot e^{\theta_{m}}(s_{m},a_{m})}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{e^{\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})}{e^{%
\theta_{m}}(s_{m},a_{m})\cdot\pi_{m}(a_{m}|s_{m})+(\frac{1}{\pi_{m}(a_{m}|s_{m%
})}-1)\cdot e^{\theta_{m}}(s_{m},a_{m})}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\pi_{m}(a_{m}|s_{m})}{\pi_{m}(a_{m}|s_{m})-1+\frac{1}{\pi_%
{m}(a_{m}|s_{m})}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{\pi_{m}(a_{m}|s_{m})}{\pi_{m}(a_{m}|s_{m})-1+\frac{1}{\pi_%
{m}(a_{m}|s_{m})}}-\pi_{m}(a_{m}|s_{m})
\displaystyle=\frac{-\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))^{2}}{%
\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}
\displaystyle=\frac{-\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))^{2}}{%
\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}
s=s_{m},a\neq a_{m}
\displaystyle\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})=\frac{e^{\theta_{m+1}(s_{m},a%
)}}{\sum\limits_{a\in\mathcal{A}}e^{\theta_{m+1}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m+1}(s_{m},a)}}{\sum\limits_{a\in\mathcal{A}}e^%
{\theta_{m+1}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})+ln(%
\frac{1}{\pi_{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})+ln(%
\frac{1}{\pi_{m}(a_{m}|s_{m})})\cdot sign(A^{m}(s_{m},a_{m})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})-ln(%
\frac{\sum_{a}e^{\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{e^{\theta_{m}(s_{m},a_{m})-ln(%
\frac{\sum_{a}e^{\theta_{m}}(a)}{e^{\theta_{m}}(s_{m},a_{m})})}+\sum\limits_{a%
\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\pi_{m}(a_{m}|s_{m})\cdot e^{%
\theta_{m}}(s_{m},a_{m})+\sum\limits_{a\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi%
_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\pi_{m}(a_{m}|s_{m})\cdot e^{%
\theta_{m}}(s_{m},a_{m})+\sum\limits_{a\neq a_{m}}e^{\theta_{m}(s_{m},a)}}-\pi%
_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\pi_{m}(a_{m}|s_{m})\cdot e^{%
\theta_{m}}(s_{m},a_{m})+(\frac{1}{\pi_{m}(a_{m}|s_{m})}-1)\cdot e^{\theta_{m}%
}(s_{m},a_{m})}-\pi_{m}(a|s_{m})
\displaystyle=\frac{e^{\theta_{m}(s_{m},a)}}{\pi_{m}(a_{m}|s_{m})\cdot e^{%
\theta_{m}}(s_{m},a_{m})+(\frac{1}{\pi_{m}(a_{m}|s_{m})}-1)\cdot e^{\theta_{m}%
}(s_{m},a_{m})}-\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{e^{\theta_{m}(s_{m},a)}}{(\pi_{m}(a_{m}|s_{m})-1+%
\frac{1}{\pi_{m}(a_{m}|s_{m})})\cdot e^{\theta_{m}}(s_{m},a_{m})}{\div}\pi_{m}%
(a|s_{m})-1\right)\cdot\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{e^{\theta_{m}(s_{m},a)}}{(\pi_{m}(a_{m}|s_{m})-1+%
\frac{1}{\pi_{m}(a_{m}|s_{m})})\cdot e^{\theta_{m}}(s_{m},a_{m})}{\div}\pi_{m}%
(a|s_{m})-1\right)\cdot\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{\frac{1}{\pi_{m}(a_{m}|s_{m})}}{(\pi_{m}(a_{m}|s_{m}%
)-1+\frac{1}{\pi_{m}(a_{m}|s_{m})})}-1\right)\cdot\pi_{m}(a|s_{m})
\displaystyle=\left(\frac{\frac{1}{\pi_{m}(a_{m}|s_{m})}}{(\pi_{m}(a_{m}|s_{m}%
)-1+\frac{1}{\pi_{m}(a_{m}|s_{m})})}-1\right)\cdot\pi_{m}(a|s_{m})
\displaystyle=\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))}{\pi_{m}%
(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\cdot\pi_{m}(a|s)
\displaystyle=\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))}{\pi_{m}%
(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\cdot\pi_{m}(a|s)
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s_{m},a_{m})\right\}
A^{m}(s_{m},a_{m})>0
\pi_{m+1}(a|s)-\pi_{m}(a|s)
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}W^{+}&\text{, if }s=s_{m%
},a=a_{m}\\
-W^{+}\cdot\frac{\pi_{m}(a|s)}{1-\pi_{m}(a_{m}|s_{m})}&\text{, if }s=s_{m},a%
\neq a_{m}\\
0&\text{, else }\end{cases}
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}W^{+}&\text{, if }s=s_{m%
},a=a_{m}\\
-W^{+}\cdot\frac{\pi_{m}(a|s)}{1-\pi_{m}(a_{m}|s_{m})}&\text{, if }s=s_{m},a%
\neq a_{m}\\
0&\text{, else }\end{cases}
(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-%
\pi_{m}(a_{m}|s_{m})}
(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-%
\pi_{m}(a_{m}|s_{m})}
W^{+}=\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
\pi_{m+1}(a|s)
\alpha_{m}(s,a)
W^{+}
W^{+}
s=s_{m},a\neq a_{m}
\displaystyle\frac{\pi_{m+1}(a|s)}{\pi_{m}(a|s)}=\frac{\frac{e^{\theta_{m}(s,a%
)}}{Z_{m}(s)}}{\frac{e^{\theta_{m+1}(s,a)}}{Z_{m+1}(s)}}=\frac{\frac{e^{\theta%
_{m}(s,a)}}{Z_{m}(s)}}{\frac{e^{\theta_{m}(s,a)}}{Z_{m+1}(s)}}=\frac{Z_{m}(s)}%
{Z_{m+1}(s)}
\displaystyle\frac{\pi_{m+1}(a|s)}{\pi_{m}(a|s)}=\frac{\frac{e^{\theta_{m}(s,a%
)}}{Z_{m}(s)}}{\frac{e^{\theta_{m+1}(s,a)}}{Z_{m+1}(s)}}=\frac{\frac{e^{\theta%
_{m}(s,a)}}{Z_{m}(s)}}{\frac{e^{\theta_{m}(s,a)}}{Z_{m+1}(s)}}=\frac{Z_{m}(s)}%
{Z_{m+1}(s)}
\sum_{a\neq a_{m}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)=-W^{+}
\displaystyle\sum_{a\neq a_{m}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)=\sum_{%
a\neq a_{m}}\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(a|s)=\left(%
\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot(1-\pi_{m}(a_{m}|s))=-W^{+}
\displaystyle\sum_{a\neq a_{m}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)=\sum_{%
a\neq a_{m}}\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(a|s)=\left(%
\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot(1-\pi_{m}(a_{m}|s))=-W^{+}
s=s_{m},a\neq a_{m}
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\frac{Z_{m}(s)\cdot\pi_{m}{(a|s)}}{Z_%
{m+1}(s)}-\pi_{m}(a|s)=\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(%
a|s)=\frac{-W^{+}}{1-\pi_{m}(a_{m}|s)}\cdot\pi_{m}(a|s)
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\frac{Z_{m}(s)\cdot\pi_{m}{(a|s)}}{Z_%
{m+1}(s)}-\pi_{m}(a|s)=\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(%
a|s)=\frac{-W^{+}}{1-\pi_{m}(a_{m}|s)}\cdot\pi_{m}(a|s)
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s_{m},a_{m})\right\}
A^{m}(s_{m},a_{m})<0
\pi_{m+1}(a|s)-\pi_{m}(a|s)
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}-W^{-}&\text{, if }s=s_{%
m},a=a_{m}\\
W^{-}\cdot\frac{\pi_{m}(a|s)}{1-\pi_{m}(a_{m}|s_{m})}&\text{, if }s=s_{m},a%
\neq a_{m}\\
0&\text{, else }\end{cases}
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\begin{cases}-W^{-}&\text{, if }s=s_{%
m},a=a_{m}\\
W^{-}\cdot\frac{\pi_{m}(a|s)}{1-\pi_{m}(a_{m}|s_{m})}&\text{, if }s=s_{m},a%
\neq a_{m}\\
0&\text{, else }\end{cases}
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}
W^{-}=\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_{m}|s_{m}))^{2}}{\pi_{m}(a_{%
m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
\pi_{m+1}(a|s)
\alpha_{m}(s,a)
W^{-}
W^{-}
s=s_{m},a\neq a_{m}
\displaystyle\frac{\pi_{m+1}(a|s)}{\pi_{m}(a|s)}=\frac{\frac{e^{\theta_{m}(s,a%
)}}{Z_{m}(s)}}{\frac{e^{\theta_{m+1}(s,a)}}{Z_{m+1}(s)}}=\frac{\frac{e^{\theta%
_{m}(s,a)}}{Z_{m}(s)}}{\frac{e^{\theta_{m}(s,a)}}{Z_{m+1}(s)}}=\frac{Z_{m}(s)}%
{Z_{m+1}(s)}
\displaystyle\frac{\pi_{m+1}(a|s)}{\pi_{m}(a|s)}=\frac{\frac{e^{\theta_{m}(s,a%
)}}{Z_{m}(s)}}{\frac{e^{\theta_{m+1}(s,a)}}{Z_{m+1}(s)}}=\frac{\frac{e^{\theta%
_{m}(s,a)}}{Z_{m}(s)}}{\frac{e^{\theta_{m}(s,a)}}{Z_{m+1}(s)}}=\frac{Z_{m}(s)}%
{Z_{m+1}(s)}
\sum_{a\neq a_{m}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)=W^{-}
\displaystyle\sum_{a\neq a_{m}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)=\sum_{%
a\neq a_{m}}\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(a|s)=\left(%
\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot(1-\pi_{m}(a_{m}|s))=W^{-}
\displaystyle\sum_{a\neq a_{m}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)=\sum_{%
a\neq a_{m}}\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(a|s)=\left(%
\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot(1-\pi_{m}(a_{m}|s))=W^{-}
s=s_{m},a\neq a_{m}
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\frac{Z_{m}(s)\cdot\pi_{m}{(a|s)}}{Z_%
{m+1}(s)}-\pi_{m}(a|s)=\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(%
a|s)=\frac{W^{-}}{1-\pi_{m}(a_{m}|s)}\cdot\pi_{m}(a|s)
\displaystyle\pi_{m+1}(a|s)-\pi_{m}(a|s)=\frac{Z_{m}(s)\cdot\pi_{m}{(a|s)}}{Z_%
{m+1}(s)}-\pi_{m}(a|s)=\left(\frac{Z_{m}(s)}{Z_{m+1}(s)}-1\right)\cdot\pi_{m}(%
a|s)=\frac{W^{-}}{1-\pi_{m}(a_{m}|s)}\cdot\pi_{m}(a|s)
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s_{m},a_{m})\right\}
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{%
m},a_{m})&\text{, if }A^{m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{%
m})}\cdot(-A^{m}(s_{m},a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{%
m},a_{m})&\text{, if }A^{m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{%
m})}\cdot(-A^{m}(s_{m},a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle\text{where }\begin{cases}(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq%
\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}\\
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\end{cases}
\displaystyle\text{where }\begin{cases}(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq%
\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}\\
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{m}(s_{m},a_{m})>%
0\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{m}(s_{m},a_{m})>%
0\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
A^{m}(s,a)>0
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\frac{1}{1-\gamma}\cdot\sum_{s%
\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s)\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s)\cdot A%
^{m}(s,a)
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s%
)\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\sum_{s\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s)\sum%
_{a\in\mathcal{A}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\sum_{s\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s)\sum%
_{a\in\mathcal{A}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)\cdot A^{m}(s,a)
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\sum_{a\in\mathcal%
{A}}\left(\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})\right)\cdot A^{m}(s_{m},a)
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\sum_{a\in\mathcal%
{A}}\left(\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})\right)\cdot A^{m}(s_{m},a)
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[W^{+}\cdot A%
^{m}(s_{m},a_{m})-\sum_{a\neq a_{m}}\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[W^{+}\cdot A%
^{m}(s_{m},a_{m})-\sum_{a\neq a_{m}}\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[W^{+}\cdot A%
^{m}(s_{m},a_{m})-\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\sum_{a\neq a_{m}}%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[W^{+}\cdot A%
^{m}(s_{m},a_{m})-\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\sum_{a\neq a_{m}}%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[W^{+}\cdot A%
^{m}(s_{m},a_{m})+\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{m}(a_{m}|s_{m}%
)\cdot A^{m}(s_{m},a_{m})\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[W^{+}\cdot A%
^{m}(s_{m},a_{m})+\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{m}(a_{m}|s_{m}%
)\cdot A^{m}(s_{m},a_{m})\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi%
_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{m},a_{m})
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi%
_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{m},a_{m})
\displaystyle\geq\frac{d^{\pi_{m+1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}
\displaystyle\geq\frac{d^{\pi_{m+1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}
A(s,a)
\pi_{m+1}(a|s)=\pi_{m}(a|s)
\quad\forall s\neq s_{m}
A(s,a)
A^{m}(s,a)<0
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\frac{1}{1-\gamma}\cdot\sum_{s%
\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s)\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s)\cdot A%
^{m}(s,a)
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s%
)\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\sum_{s\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s)\sum%
_{a\in\mathcal{A}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)\cdot A^{m}(s,a)
\displaystyle=\frac{1}{1-\gamma}\sum_{s\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s)\sum%
_{a\in\mathcal{A}}\left(\pi_{m+1}(a|s)-\pi_{m}(a|s)\right)\cdot A^{m}(s,a)
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\sum_{a\in\mathcal%
{A}}\left(\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})\right)\cdot A^{m}(s_{m},a)
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\sum_{a\in\mathcal%
{A}}\left(\pi_{m+1}(a|s_{m})-\pi_{m}(a|s_{m})\right)\cdot A^{m}(s_{m},a)
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[-W^{-}\cdot A%
^{m}(s_{m},a_{m})+\sum_{a\neq a_{m}}\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{m})}\cdot%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[-W^{-}\cdot A%
^{m}(s_{m},a_{m})+\sum_{a\neq a_{m}}\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{m})}\cdot%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[-W^{-}\cdot A%
^{m}(s_{m},a_{m})+\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\sum_{a\neq a_{m}}%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[-W^{-}\cdot A%
^{m}(s_{m},a_{m})+\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\sum_{a\neq a_{m}}%
\pi_{m}(a|s_{m})\cdot A^{m}(s_{m},a)\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[-W^{-}\cdot A%
^{m}(s_{m},a_{m})-\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{m}(a_{m}|s_{m}%
)\cdot A^{m}(s_{m},a_{m})\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\left[-W^{-}\cdot A%
^{m}(s_{m},a_{m})-\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{m})}\cdot\pi_{m}(a_{m}|s_{m}%
)\cdot A^{m}(s_{m},a_{m})\right]
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi%
_{m}(a_{m}|s_{m})}\cdot(-A^{m}(s_{m},a_{m}))
\displaystyle=\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi%
_{m}(a_{m}|s_{m})}\cdot(-A^{m}(s_{m},a_{m}))
\displaystyle\geq d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}%
(s_{m},a_{m})^{2}
\displaystyle\geq d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}%
(s_{m},a_{m})^{2}
A(s,a)
\pi_{m+1}(a|s)=\pi_{m}(a|s)
\quad\forall s\neq s_{m}
A(s,a)
\pi_{\theta}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
|B_{m}|=1
\bigcup_{i=1}^{|\mathcal{S}||\mathcal{A}|}B_{m\cdot|\mathcal{S}||\mathcal{A}|+%
i}=\mathcal{S}\times\mathcal{A}
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{|\mathcal{S}||\mathcal{A}%
|}{c}\cdot\frac{1}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{|\mathcal{S}||\mathcal{A}%
|}{c}\cdot\frac{1}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq|\mathcal{S}||%
\mathcal{A}|\cdot\min{\left\{\sqrt{\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}%
{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq|\mathcal{S}||%
\mathcal{A}|\cdot\min{\left\{\sqrt{\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}%
{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}^{-1}\cdot%
{\min}\left\{\frac{\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)}{|\mathcal{S}||%
\mathcal{A}|}\right\}>0
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
V^{*}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
m\geq 1
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{%
m},a_{m})&\text{, if }A^{m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{%
m})}\cdot(-A^{m}(s_{m},a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{%
m},a_{m})&\text{, if }A^{m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{%
m})}\cdot(-A^{m}(s_{m},a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle\text{where }\begin{cases}(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq%
\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}\\
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\end{cases}
\displaystyle\text{where }\begin{cases}(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq%
\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}\\
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{m}(s_{m},a_{m})>%
0\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{m}(s_{m},a_{m})>%
0\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\end{cases}
V^{*}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
(\tilde{s_{m}},\tilde{a_{m}})
\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}\leq\left(\frac{1}{1-\gamma}\cdot A^{m%
}(\tilde{s_{m}},\tilde{a_{m}})\right)^{2}
m\geq 1
A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
V^{*}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}
(\tilde{s_{m}},\tilde{a_{m}})
(m+T)
T\in\left[0,|\mathcal{S}||\mathcal{A}|\right)\bigcap\mathbb{N}
m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}
V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\geq A^{m}(\tilde{s_{m}},\tilde{a_{m}})
\displaystyle A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}\leq\left(V^{\pi_{m+T}}(s)%
-V^{\pi_{m}}(s)\right)^{2}
\displaystyle A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle\leq\left(V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=\left(\sum_{k=m}^{m+T-1}\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)%
\right)\right)^{2}
\displaystyle=\left(\sum_{k=m}^{m+T-1}\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)%
\right)\right)^{2}
\displaystyle=\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s))+\sum%
\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s))\right)^{2}
\displaystyle=\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s))+\sum%
\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s))\right)^{2}
\displaystyle=\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-\gamma}%
\cdot\frac{W^{k+}}{1-\pi_{k}(a_{k}|s_{k})}\cdot A^{k}(s_{k},a_{k})\right.
\displaystyle=\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-\gamma}%
\cdot\frac{W^{k+}}{1-\pi_{k}(a_{k}|s_{k})}\cdot A^{k}(s_{k},a_{k})\right.
\displaystyle\left.\quad\quad+\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-\gamma}%
\cdot\frac{W^{k-}}{1-\pi_{k}(a_{k}|s_{k})}\cdot(-A^{k}(s_{k},a_{k}))\right)^{2}
\displaystyle\left.\quad\quad+\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-\gamma}%
\cdot\frac{W^{k-}}{1-\pi_{k}(a_{k}|s_{k})}\cdot(-A^{k}(s_{k},a_{k}))\right)^{2}
\displaystyle\leq T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k+}}{1-\pi_{k}(a_{k}|s_{k})}\cdot A^{k}(s_{k},a_{k})%
\right)^{2}\right.
\displaystyle\leq T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k+}}{1-\pi_{k}(a_{k}|s_{k})}\cdot A^{k}(s_{k},a_{k})%
\right)^{2}\right.
\displaystyle\left.\quad\quad\enspace+\sum\limits_{\begin{subarray}{c}k\in[m,m%
+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k-}}{1-\pi_{k}(a_{k}|s_{k})}\cdot A^{k}(s_{k},a_{k})%
\right)^{2}\right)
\displaystyle\left.\quad\quad\enspace+\sum\limits_{\begin{subarray}{c}k\in[m,m%
+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k-}}{1-\pi_{k}(a_{k}|s_{k})}\cdot A^{k}(s_{k},a_{k})%
\right)^{2}\right)
\displaystyle=T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k+}}{1-\pi_{k}(a_{k}|s_{k})}\right)^{2}\cdot A^{k}(s_{k},%
a_{k})^{2}\right.
\displaystyle=T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k+}}{1-\pi_{k}(a_{k}|s_{k})}\right)^{2}\cdot A^{k}(s_{k},%
a_{k})^{2}\right.
\displaystyle\left.\quad\quad\enspace+\sum\limits_{\begin{subarray}{c}k\in[m,m%
+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k-}}{1-\pi_{k}(a_{k}|s_{k})}\right)^{2}\cdot A^{k}(s_{k},%
a_{k})^{2}\right)
\displaystyle\left.\quad\quad\enspace+\sum\limits_{\begin{subarray}{c}k\in[m,m%
+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})}{1-%
\gamma}\cdot\frac{W^{k-}}{1-\pi_{k}(a_{k}|s_{k})}\right)^{2}\cdot A^{k}(s_{k},%
a_{k})^{2}\right)
\displaystyle=T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k+}}{1-\gamma}\right)^{2}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_%
{k})}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_{k})}\right.
\displaystyle=T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k+}}{1-\gamma}\right)^{2}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_%
{k})}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_{k})}\right.
\displaystyle\left.\quad\quad\quad+\sum\limits_{\begin{subarray}{c}k\in[m,m+T-%
1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k-}}{1-\gamma}\right)^{2}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_%
{k})}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_{k})}\right)
\displaystyle\left.\quad\quad\quad+\sum\limits_{\begin{subarray}{c}k\in[m,m+T-%
1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k-}}{1-\gamma}\right)^{2}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_%
{k})}\cdot\frac{|A^{k}(s_{k},a_{k})|}{1-\pi_{k}(a_{k}|s_{k})}\right)
\displaystyle\leq T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k+}}{1-\gamma}\right)^{2}\cdot\frac{1}{1-\gamma}\cdot\frac{1-\gamma}{d^{\pi_%
{k+1}}_{s}(s_{k})\cdot W^{k+}}\cdot\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right%
)\right.
\displaystyle\leq T\cdot\left(\sum\limits_{\begin{subarray}{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k+}}{1-\gamma}\right)^{2}\cdot\frac{1}{1-\gamma}\cdot\frac{1-\gamma}{d^{\pi_%
{k+1}}_{s}(s_{k})\cdot W^{k+}}\cdot\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right%
)\right.
\displaystyle\left.\quad\quad\quad+\sum\limits_{\begin{subarray}{c}k\in[m,m+T-%
1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k-}}{1-\gamma}\right)^{2}\cdot\frac{1}{1-\gamma}\cdot\frac{1-\gamma}{d^{\pi_%
{k+1}}_{s}(s_{k})\cdot W^{k-}}\cdot\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right%
)\right)
\displaystyle\left.\quad\quad\quad+\sum\limits_{\begin{subarray}{c}k\in[m,m+T-%
1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}\left(\frac{d^{\pi_{k+1}}_{s}(s_{k})\cdot W%
^{k-}}{1-\gamma}\right)^{2}\cdot\frac{1}{1-\gamma}\cdot\frac{1-\gamma}{d^{\pi_%
{k+1}}_{s}(s_{k})\cdot W^{k-}}\cdot\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right%
)\right)
\displaystyle=\frac{T}{(1-\gamma)^{2}}\cdot\left(\sum\limits_{\begin{subarray}%
{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}d^{\pi_{k+1}}_{s}(s_{k})\cdot W^{k+}\cdot%
\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right)\right.
\displaystyle=\frac{T}{(1-\gamma)^{2}}\cdot\left(\sum\limits_{\begin{subarray}%
{c}k\in[m,m+T-1]\\
A^{k}(s_{k},a_{k})>0\end{subarray}}d^{\pi_{k+1}}_{s}(s_{k})\cdot W^{k+}\cdot%
\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right)\right.
\displaystyle\left.\qquad\qquad\qquad+\sum\limits_{\begin{subarray}{c}k\in[m,m%
+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}d^{\pi_{k+1}}_{s}(s_{k})\cdot W^{k-}\cdot%
\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right)\right)
\displaystyle\left.\qquad\qquad\qquad+\sum\limits_{\begin{subarray}{c}k\in[m,m%
+T-1]\\
A^{k}(s_{k},a_{k})<0\end{subarray}}d^{\pi_{k+1}}_{s}(s_{k})\cdot W^{k-}\cdot%
\left(V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right)\right)
\displaystyle\leq\frac{T}{(1-\gamma)^{2}}\cdot\underset{k\in[m,m+T-1]}{\max}%
\left\{\mathbbm{1}\left\{A^{k}(s_{k},a_{k})>0\right\}\cdot d^{\pi_{k+1}}_{s}(s%
_{k})\cdot W^{k+}+\mathbbm{1}\left\{A^{k}(s_{k},a_{k})<0\right\}\cdot d^{\pi_{%
k+1}}_{s}(s_{k})\cdot W^{k-}\right\}
\displaystyle\leq\frac{T}{(1-\gamma)^{2}}\cdot\underset{k\in[m,m+T-1]}{\max}%
\left\{\mathbbm{1}\left\{A^{k}(s_{k},a_{k})>0\right\}\cdot d^{\pi_{k+1}}_{s}(s%
_{k})\cdot W^{k+}+\mathbbm{1}\left\{A^{k}(s_{k},a_{k})<0\right\}\cdot d^{\pi_{%
k+1}}_{s}(s_{k})\cdot W^{k-}\right\}
\displaystyle\quad\cdot\left(\sum_{k=m}^{m+T-1}V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right)
\displaystyle\quad\cdot\left(\sum_{k=m}^{m+T-1}V^{\pi_{k+1}}(s)-V^{\pi_{k}}(s)\right)
\displaystyle\leq c_{m}\cdot\frac{T}{(1-\gamma)^{2}}\cdot\left(V^{\pi_{m+T}}(s%
)-V^{\pi_{m}}(s)\right)
\displaystyle\leq c_{m}\cdot\frac{T}{(1-\gamma)^{2}}\cdot\left(V^{\pi_{m+T}}(s%
)-V^{\pi_{m}}(s)\right)
\displaystyle\leq c_{m}\cdot\frac{T}{(1-\gamma)^{2}}\cdot\left(V^{\pi_{m+T+1}}%
(s)-V^{\pi_{m}}(s)\right)
\displaystyle\leq c_{m}\cdot\frac{T}{(1-\gamma)^{2}}\cdot\left(V^{\pi_{m+T+1}}%
(s)-V^{\pi_{m}}(s)\right)
\displaystyle\leq 2\cdot{\max}\left\{\frac{2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})},%
\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}\cdot\left(V^{\pi_{m+T+1}}(s)-V^{%
\pi_{m}}(s)\right)
\displaystyle\leq 2\cdot{\max}\left\{\frac{2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})},%
\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}\cdot\left(V^{\pi_{m+T+1}}(s)-V^{%
\pi_{m}}(s)\right)
c_{m}=\underset{k\in[m,m+T-1]}{\max}\left\{c_{k1},c_{k2}\right\}\in[0,1]
c_{k1}=\mathbbm{1}\left\{A^{k}(s_{k},a_{k})>0\right\}\cdot d^{\pi_{k+1}}_{s}(s%
_{k})\cdot W^{k+}
c_{k2}=\mathbbm{1}\left\{A^{k}(s_{k},a_{k})<0\right\}\cdot d^{\pi_{k+1}}_{s}(s%
_{k})\cdot W^{k-}
V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)<A^{m}(\tilde{s_{m}},\tilde{a_{m}})
\displaystyle A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}=\left(\left(Q^{\pi_{m}}(%
\tilde{s_{m}},\tilde{a_{m}})-V^{\pi_{m+T}}(s)\right)+\left(V^{\pi_{m+T}}(s)-V^%
{\pi_{m}}(s)\right)\right)^{2}
\displaystyle A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle=\left(\left(Q^{\pi_{m}}(\tilde{s_{m}},\tilde{a_{m}})-V^{\pi_{m+T%
}}(s)\right)+\left(V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\right)\right)^{2}
\displaystyle\leq\left(\left(Q^{\pi_{m+T}}(\tilde{s_{m}},\tilde{a_{m}})-V^{\pi%
_{m+T}}(s)\right)+\left(V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\right)\right)^{2}
\displaystyle\leq\left(\left(Q^{\pi_{m+T}}(\tilde{s_{m}},\tilde{a_{m}})-V^{\pi%
_{m+T}}(s)\right)+\left(V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\right)\right)^{2}
\displaystyle=\left(A^{m+T}(\tilde{s_{m}},\tilde{a_{m}})+\left(V^{\pi_{m+T}}(s%
)-V^{\pi_{m}}(s)\right)\right)^{2}
\displaystyle=\left(A^{m+T}(\tilde{s_{m}},\tilde{a_{m}})+\left(V^{\pi_{m+T}}(s%
)-V^{\pi_{m}}(s)\right)\right)^{2}
\displaystyle\leq\left(A^{m+T}(\tilde{s_{m}},\tilde{a_{m}})^{2}+\left(V^{\pi_{%
m+T}}(s)-V^{\pi_{m}}(s)\right)^{2}\right)\cdot(1^{2}+1^{2})
\displaystyle\leq\left(A^{m+T}(\tilde{s_{m}},\tilde{a_{m}})^{2}+\left(V^{\pi_{%
m+T}}(s)-V^{\pi_{m}}(s)\right)^{2}\right)\cdot(1^{2}+1^{2})
\displaystyle\leq 2\cdot\left(\frac{2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})}\cdot\left%
(V^{\pi_{m+T+1}}(s)-V^{\pi_{m+T}}(s)\right)\right.
\displaystyle\leq 2\cdot\left(\frac{2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})}\cdot\left%
(V^{\pi_{m+T+1}}(s)-V^{\pi_{m+T}}(s)\right)\right.
\displaystyle\left.\quad\quad\enspace+c_{m}\cdot\frac{T}{(1-\gamma)^{2}}\cdot%
\left(V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\right)\right)
\displaystyle\left.\quad\quad\enspace+c_{m}\cdot\frac{T}{(1-\gamma)^{2}}\cdot%
\left(V^{\pi_{m+T}}(s)-V^{\pi_{m}}(s)\right)\right)
\displaystyle\leq 2\cdot{\max}\left\{\frac{2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})},%
\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}\cdot\left(V^{\pi_{m+T+1}}(s)-V^{%
\pi_{m}}(s)\right)
\displaystyle\leq 2\cdot{\max}\left\{\frac{2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})},%
\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}\cdot\left(V^{\pi_{m+T+1}}(s)-V^{%
\pi_{m}}(s)\right)
V^{\pi}(s)
Q^{\pi}(s,a)
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)\geq V^{%
\pi_{m+T+1}}(s)-V^{\pi_{m}}(s)\geq\frac{1}{2}\cdot\frac{1}{{\max}\left\{\frac{%
2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}}%
\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)\geq V^{%
\pi_{m+T+1}}(s)-V^{\pi_{m}}(s)\geq\frac{1}{2}\cdot\frac{1}{{\max}\left\{\frac{%
2}{d^{\pi_{m+T+1}}_{s}(s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}}%
\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}
V^{*}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)\geq%
\frac{(1-\gamma)^{2}}{2}\cdot\frac{1}{{\max}\left\{\frac{2}{d^{\pi_{m+T+1}}_{s%
}(s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}}\cdot\left(V^{*}(s)-V^%
{\pi_{m}}(s)\right)^{2}
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
\displaystyle\geq\frac{(1-\gamma)^{2}}{2}\cdot\frac{1}{{\max}\left\{\frac{2}{d%
^{\pi_{m+T+1}}_{s}(s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}}\cdot%
\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{d^{\pi_{m+T+1}}_%
{s}(s_{m+T})}{2},\frac{(1-\gamma)^{2}}{c_{m}\cdot T}\right\}\cdot\left(V^{*}(s%
)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{d^{\pi_{m+T+1}}_%
{s}(s_{m+T})}{2},\frac{(1-\gamma)^{2}}{c_{m}\cdot T}\right\}\cdot\left(V^{*}(s%
)-V^{\pi_{m}}(s)\right)^{2}
\mu
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(\mu)-V^{\pi_{m}}(\mu)\geq%
\frac{(1-\gamma)^{2}}{2}\cdot\frac{1}{{\max}\left\{\frac{2}{d^{\pi_{m+T+1}}_{%
\mu}(s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}}\cdot\left(V^{*}(%
\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(\mu)-V^{\pi_{m}}(\mu)
\displaystyle\geq\frac{(1-\gamma)^{2}}{2}\cdot\frac{1}{{\max}\left\{\frac{2}{d%
^{\pi_{m+T+1}}_{\mu}(s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^{2}}\right\}}%
\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle=\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{d^{\pi_{m+T+1}}_%
{\mu}(s_{m+T})}{2},\frac{(1-\gamma)^{2}}{c_{m}\cdot T}\right\}\cdot\left(V^{*}%
(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{d^{\pi_{m+T+1}}_%
{\mu}(s_{m+T})}{2},\frac{(1-\gamma)^{2}}{c_{m}\cdot T}\right\}\cdot\left(V^{*}%
(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle\geq\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{(1-\gamma)%
\cdot\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)^{2}}{|\mathcal{S}||\mathcal{A}|}%
\right\}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{(1-\gamma)%
\cdot\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)^{2}}{|\mathcal{S}||\mathcal{A}|}%
\right\}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\underbrace{\frac{(1-\gamma)^{3}}{2}\cdot{\min}\left\{\frac{%
\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)}{|\mathcal{S}||\mathcal{A}|}\right\}}_{:%
=c^{\prime}>0}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\underbrace{\frac{(1-\gamma)^{3}}{2}\cdot{\min}\left\{\frac{%
\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)}{|\mathcal{S}||\mathcal{A}|}\right\}}_{:%
=c^{\prime}>0}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
d^{\pi}_{\mu}(s)\geq(1-\gamma)\cdot\mu(s)
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(\mu)-V^{\pi_{m}}(\mu)=(V^{\pi^{*}}(\mu)%
-V^{\pi_{m}}(\mu))-(V^{\pi^{*}}(\mu)-V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(%
\mu))
\displaystyle\delta_{m+|\mathcal{S}||\mathcal{A}|}\leq\delta_{m}-c^{\prime}%
\cdot\delta_{m}^{2}\quad\text{where $\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(%
\mu)$ for all $m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}$}
\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)
m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}
\displaystyle\delta_{m+|\mathcal{S}||\mathcal{A}|}\leq\delta_{m}-c^{\prime}%
\cdot\delta_{m}^{2}\quad\text{where $\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(%
\mu)$ for all $m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}$}
\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)
m\equiv 0\pmod{|\mathcal{S}||\mathcal{A}|}
\displaystyle V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq\frac{1}{c^{\prime}}\cdot\frac{1}%
{\max\left\{\left\lfloor\frac{m}{|\mathcal{S}||\mathcal{A}|}\right\rfloor,1%
\right\}}\leq\frac{1}{c^{\prime}}\cdot\min\left\{\frac{|\mathcal{S}||\mathcal{%
A}|}{m},1\right\}\leq\frac{|\mathcal{S}||\mathcal{A}|}{c^{\prime}}\cdot\frac{1%
}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq\frac{1}{c^{\prime}}\cdot\frac{1}%
{\max\left\{\left\lfloor\frac{m}{|\mathcal{S}||\mathcal{A}|}\right\rfloor,1%
\right\}}\leq\frac{1}{c^{\prime}}\cdot\min\left\{\frac{|\mathcal{S}||\mathcal{%
A}|}{m},1\right\}\leq\frac{|\mathcal{S}||\mathcal{A}|}{c^{\prime}}\cdot\frac{1%
}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq|\mathcal{S}||%
\mathcal{A}|\cdot\min{\left\{\sqrt{\frac{M}{c^{\prime}\cdot(1-\gamma)}},\frac{%
\log M+1}{c^{\prime}}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq|\mathcal{S}||%
\mathcal{A}|\cdot\min{\left\{\sqrt{\frac{M}{c^{\prime}\cdot(1-\gamma)}},\frac{%
\log M+1}{c^{\prime}}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
c^{\prime}=\frac{(1-\gamma)^{3}}{2}\cdot{\min}\left\{\frac{\min_{s}{\mu(s)}}{2%
},\frac{(1-\gamma)}{|\mathcal{S}||\mathcal{A}|}\right\}>0
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{1-\gamma}\cdot\left\|%
\frac{1}{\mu}\right\|_{\infty}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)%
\leq\frac{|\mathcal{S}||\mathcal{A}|}{c}\cdot\frac{1}{m},\quad\text{for all $m%
\geq 1$}
m\geq 1
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{1-\gamma}\cdot\left\|%
\frac{1}{\mu}\right\|_{\infty}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)%
\leq\frac{|\mathcal{S}||\mathcal{A}|}{c}\cdot\frac{1}{m},\quad\text{for all $m%
\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq|\mathcal{S}||%
\mathcal{A}|\cdot\min{\left\{\sqrt{\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}%
{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq|\mathcal{S}||%
\mathcal{A}|\cdot\min{\left\{\sqrt{\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}%
{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}^{-1}\cdot%
{\min}\left\{\frac{\min_{s}{\mu(s)}}{2},\frac{(1-\gamma)}{|\mathcal{S}||%
\mathcal{A}|}\right\}>0
\pi_{\theta}
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s,a):(s,a)\in\mathcal{S}\times\mathcal{A}\right\}
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{c}\cdot\frac{1}{m},%
\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{c}\cdot\frac{1}{m},%
\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\min{\left\{\sqrt{%
\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m%
\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\min{\left\{\sqrt{%
\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m%
\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{|\mathcal{A}|}\cdot\left\|\frac{1}{\mu}\right\|_{%
\infty}^{-1}\cdot\underset{s}{min}\left\{\mu(s)\right\}>0
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
V^{*}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s,a):(s,a)\in\mathcal{S}\times\mathcal{A}\right\}
\pi_{m+1}(a|s)
\displaystyle\pi_{m+1}(a|s)=\begin{cases}\frac{1}{|s_{m}^{+}|+\underset{A^{m}(%
s,a)=0}{\sum}\pi_{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}&\text%
{, if }A^{m}(s,a)>0\\
\frac{\pi_{m}(a)}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}&\text{, if }A^{m}(s,a)=0\\
\frac{\pi_{m}(a)^{2}}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}&\text{, if }A^{m}(s,a)<0\end{cases}
\displaystyle\pi_{m+1}(a|s)=\begin{cases}\frac{1}{|s_{m}^{+}|+\underset{A^{m}(%
s,a)=0}{\sum}\pi_{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}&\text%
{, if }A^{m}(s,a)>0\\
\frac{\pi_{m}(a)}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}&\text{, if }A^{m}(s,a)=0\\
\frac{\pi_{m}(a)^{2}}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}&\text{, if }A^{m}(s,a)<0\end{cases}
s_{m}^{+}:=\left\{a\in\mathcal{S}\>|\>A^{m}(s,a)>0\right\}
A^{m}(s,a)>0
\displaystyle\pi_{m+1}(a|s)=\frac{e^{\theta_{m}(s,a)+\ln\frac{1}{\pi_{m}(a|s)}%
}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{e^{\theta_{m}(%
s,a)+\ln\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{e^{\theta_{%
m}(s,a)}}}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{%
\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}%
}{\sum}e^{\theta_{m+1}(s,a)}}
\displaystyle\pi_{m+1}(a|s)=\frac{e^{\theta_{m}(s,a)+\ln\frac{1}{\pi_{m}(a|s)}%
}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{e^{\theta_{m}(%
s,a)+\ln\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{e^{\theta_{%
m}(s,a)}}}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{%
\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}%
}{\sum}e^{\theta_{m+1}(s,a)}}
A^{m}(s,a)=0
\displaystyle\pi_{m+1}(a|s)=\frac{e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{%
A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{e^{\theta_{m}(s,a)}\cdot\underset{a\in%
\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{%
\theta_{m}(s,a)}\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\pi_{m}%
(a|s)\cdot\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset%
{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}
\displaystyle\pi_{m+1}(a|s)=\frac{e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{%
A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{e^{\theta_{m}(s,a)}\cdot\underset{a\in%
\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{%
\theta_{m}(s,a)}\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\pi_{m}%
(a|s)\cdot\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset%
{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}
A^{m}(s,a)<0
\displaystyle\pi_{m+1}(a|s)=\frac{e^{\theta_{m}(s,a)-\ln\frac{1}{\pi_{m}(a|s)}%
}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{e^{2\cdot%
\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}\underset%
{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\pi_{m}(a|s)^{2}\cdot\frac{%
\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}%
}{\sum}e^{\theta_{m+1}(s,a)}}
\displaystyle\pi_{m+1}(a|s)=\frac{e^{\theta_{m}(s,a)-\ln\frac{1}{\pi_{m}(a|s)}%
}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{e^{2\cdot%
\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}\underset%
{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\pi_{m}(a|s)^{2}\cdot\frac{%
\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}%
}{\sum}e^{\theta_{m+1}(s,a)}}
\underset{a\in\mathcal{A}}{\sum}\pi_{m+1}(a|s)=1
\displaystyle\underset{A^{m}(s,a)>0}{\sum}\pi_{m+1}(a|s)+\underset{A^{m}(s,a)=%
0}{\sum}\pi_{m+1}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m+1}(a|s)
\displaystyle\underset{A^{m}(s,a)>0}{\sum}\pi_{m+1}(a|s)+\underset{A^{m}(s,a)=%
0}{\sum}\pi_{m+1}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m+1}(a|s)
\displaystyle=|s_{m}^{+}|\cdot\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_%
{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}+\underset{A^%
{m}(s,a)=0}{\sum}\pi_{m}(a|s)\cdot\frac{\underset{a\in\mathcal{A}}{\sum}e^{%
\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}\cdot\frac{\underset{a\in\mathcal%
{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}%
(s,a)}}
\displaystyle=|s_{m}^{+}|\cdot\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_%
{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}+\underset{A^%
{m}(s,a)=0}{\sum}\pi_{m}(a|s)\cdot\frac{\underset{a\in\mathcal{A}}{\sum}e^{%
\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}\cdot\frac{\underset{a\in\mathcal%
{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}%
(s,a)}}
\displaystyle=\left(|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}\right)\cdot\frac{\underset{a\in%
\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{%
\theta_{m+1}(s,a)}}=1,
\displaystyle=\left(|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+%
\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}\right)\cdot\frac{\underset{a\in%
\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{\underset{a\in\mathcal{A}}{\sum}e^{%
\theta_{m+1}(s,a)}}=1,
s_{m}^{+}:=\left\{a\in\mathcal{S}\>|\>A^{m}(s,a)>0\right\}
\displaystyle\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{%
\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{1}{|s_{m}^{+}|+%
\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}%
(a|s)^{2}}.
\displaystyle\frac{\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m}(s,a)}}{%
\underset{a\in\mathcal{A}}{\sum}e^{\theta_{m+1}(s,a)}}=\frac{1}{|s_{m}^{+}|+%
\underset{A^{m}(s,a)=0}{\sum}\pi_{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}%
(a|s)^{2}}.
{\alpha_{m}(s,a)=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
B_{m}=\left\{(s,a):(s,a)\in\mathcal{S}\times\mathcal{A}\right\}
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\frac{1}{|\mathcal{A}|}\cdot%
\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m}}_{s}(s^{\prime})\sum_{a\in s_{m}^{{}%
^{\prime}+}}A^{m}(s^{\prime},a)^{2}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\frac{1}{|\mathcal{A}|}\cdot%
\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m}}_{s}(s^{\prime})\sum_{a\in s_{m}^{{}%
^{\prime}+}}A^{m}(s^{\prime},a)^{2}
s_{m}^{{}^{\prime}+}:=\left\{a\in\mathcal{S}\>|\>A^{m}(s^{\prime},a)>0\right\}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\frac{1}{1-\gamma}\cdot\sum_{s^{%
\prime}\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s^{\prime})\sum_{a\in\mathcal{A}}\pi_{%
m+1}(a|s^{\prime})\cdot A^{m}(s^{\prime},a)
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m+%
1}}_{s}(s^{\prime})\sum_{a\in\mathcal{A}}\pi_{m+1}(a|s^{\prime})\cdot A^{m}(s^%
{\prime},a)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m+%
1}}_{s}(s^{\prime})\cdot\frac{1}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_%
{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m+%
1}}_{s}(s^{\prime})\cdot\frac{1}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_%
{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}
\displaystyle\quad\cdot\left(\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{\prime},%
a)+\sum_{a\notin s_{m}^{{}^{\prime}+}}\pi_{m}(a|s^{\prime})^{2}\cdot A^{m}(s^{%
\prime},a)\right)
\displaystyle\quad\cdot\left(\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{\prime},%
a)+\sum_{a\notin s_{m}^{{}^{\prime}+}}\pi_{m}(a|s^{\prime})^{2}\cdot A^{m}(s^{%
\prime},a)\right)
\displaystyle\geq\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_%
{m+1}}_{s}(s^{\prime})\cdot\frac{1}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}%
\pi_{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}
\displaystyle\geq\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_%
{m+1}}_{s}(s^{\prime})\cdot\frac{1}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}%
\pi_{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}
\displaystyle\quad\cdot\left(\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{\prime},%
a)+\sum_{a\notin s_{m}^{{}^{\prime}+}}\pi_{m}(a|s^{\prime})\cdot A^{m}(s^{%
\prime},a)\right)
\displaystyle\quad\cdot\left(\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{\prime},%
a)+\sum_{a\notin s_{m}^{{}^{\prime}+}}\pi_{m}(a|s^{\prime})\cdot A^{m}(s^{%
\prime},a)\right)
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m+%
1}}_{s}(s^{\prime})\cdot\frac{1}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_%
{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}
\displaystyle=\frac{1}{1-\gamma}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m+%
1}}_{s}(s^{\prime})\cdot\frac{1}{|s_{m}^{+}|+\underset{A^{m}(s,a)=0}{\sum}\pi_%
{m}(a|s)+\underset{A^{m}(s,a)<0}{\sum}\pi_{m}(a|s)^{2}}
\displaystyle\quad\cdot\left(\sum_{a\in s_{m}^{{}^{\prime}+}}(1-\pi_{m}(a|s^{%
\prime}))\cdot A^{m}(s^{\prime},a)\right)
\displaystyle\quad\cdot\left(\sum_{a\in s_{m}^{{}^{\prime}+}}(1-\pi_{m}(a|s^{%
\prime}))\cdot A^{m}(s^{\prime},a)\right)
\displaystyle\geq\frac{1}{1-\gamma}\cdot\frac{1}{|\mathcal{A}|}\cdot\sum_{s^{%
\prime}\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s^{\prime})\cdot\left(\sum_{a\in s_{m}%
^{{}^{\prime}+}}(1-\pi_{m}(a|s^{\prime}))\cdot A^{m}(s^{\prime},a)\right)
\displaystyle\geq\frac{1}{1-\gamma}\cdot\frac{1}{|\mathcal{A}|}\cdot\sum_{s^{%
\prime}\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s^{\prime})\cdot\left(\sum_{a\in s_{m}%
^{{}^{\prime}+}}(1-\pi_{m}(a|s^{\prime}))\cdot A^{m}(s^{\prime},a)\right)
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^%
{\pi_{m+1}}_{s}(s^{\prime})\cdot\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{%
\prime},a)^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^%
{\pi_{m+1}}_{s}(s^{\prime})\cdot\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{%
\prime},a)^{2}
A(s,a)
A(s,a)
V^{*}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\frac{1}{|\mathcal{A}|}\cdot%
\sum_{s^{\prime}\in\mathcal{S}}d^{\pi_{m+1}}_{s}(s^{\prime})\cdot\sum_{a\in s_%
{m}^{{}^{\prime}+}}A^{m}(s^{\prime},a)^{2}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot\sum_{s^{\prime}\in\mathcal{S}}d^%
{\pi_{m+1}}_{s}(s^{\prime})\cdot\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{%
\prime},a)^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{s}(\tilde{s_{m}})%
\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{s}(\tilde{s_{m}})%
\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle=\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{s}(\tilde{s_{m}})%
\cdot(1-\gamma)^{2}\cdot(\frac{1}{1-\gamma})^{2}\cdot A^{m}(\tilde{s_{m}},%
\tilde{a_{m}})^{2}
\displaystyle=\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{s}(\tilde{s_{m}})%
\cdot(1-\gamma)^{2}\cdot(\frac{1}{1-\gamma})^{2}\cdot A^{m}(\tilde{s_{m}},%
\tilde{a_{m}})^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{s}(\tilde{s_{m}})%
\cdot(1-\gamma)^{2}\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{s}(\tilde{s_{m}})%
\cdot(1-\gamma)^{2}\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\mu
\displaystyle V^{\pi_{m+1}}(\mu)-V^{\pi_{m}}(\mu)\geq\frac{1}{|\mathcal{A}|}%
\cdot d^{\pi_{m+1}}_{\mu}(\tilde{s_{m}})\cdot(1-\gamma)^{2}\cdot\left(V^{*}(%
\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle V^{\pi_{m+1}}(\mu)-V^{\pi_{m}}(\mu)
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot d^{\pi_{m+1}}_{\mu}(\tilde{s_{m}%
})\cdot(1-\gamma)^{2}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot\mu(\tilde{s_{m}})\cdot(1-\gamma)%
^{3}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\frac{1}{|\mathcal{A}|}\cdot\mu(\tilde{s_{m}})\cdot(1-\gamma)%
^{3}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\underbrace{\frac{(1-\gamma)^{3}}{|\mathcal{A}|}\cdot%
\underset{s^{\prime}\in\mathcal{S}}{\min}\left\{\mu(s^{\prime})\right\}}_{:=c^%
{\prime}>0}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
\displaystyle\geq\underbrace{\frac{(1-\gamma)^{3}}{|\mathcal{A}|}\cdot%
\underset{s^{\prime}\in\mathcal{S}}{\min}\left\{\mu(s^{\prime})\right\}}_{:=c^%
{\prime}>0}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)^{2}
d^{\pi}_{\mu}(s)\geq(1-\gamma)\cdot\mu(s)
V^{\pi_{m+1}}(\mu)-V^{\pi_{m}}(\mu)=(V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu))-(V^{%
\pi^{*}}(\mu)-V^{\pi_{m+1}}(\mu))
\displaystyle\delta_{m+1}\leq\delta_{m}-c^{\prime}\cdot\delta_{m}^{2}\quad%
\text{where $\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)$}
\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)
\displaystyle\delta_{m+1}\leq\delta_{m}-c^{\prime}\cdot\delta_{m}^{2}\quad%
\text{where $\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)$}
\delta_{m}=V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)
\displaystyle V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq\frac{1}{c^{\prime}}\cdot\frac{1}%
{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq\frac{1}{c^{\prime}}\cdot\frac{1}%
{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq\min{\left\{\sqrt{%
\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}{c^{\prime}}\right\}},\quad\text{%
for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\mu)-V^{\pi_{m}}(\mu)\leq\min{\left\{\sqrt{%
\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}{c^{\prime}}\right\}},\quad\text{%
for all $m\geq 1$}
m\geq 1
c^{\prime}=\frac{(1-\gamma)^{3}}{|\mathcal{A}|}\cdot\underset{s}{min}\left\{%
\mu(s)\right\}>0
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{1-\gamma}\cdot\left\|%
\frac{1}{\mu}\right\|_{\infty}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)%
\leq\frac{1}{c}\cdot\frac{1}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\frac{1}{1-\gamma}\cdot\left\|%
\frac{1}{\mu}\right\|_{\infty}\cdot\left(V^{*}(\mu)-V^{\pi_{m}}(\mu)\right)%
\leq\frac{1}{c}\cdot\frac{1}{m},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\min{\left\{\sqrt{%
\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m%
\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}V^{*}(\rho)-V^{\pi_{m}}(\rho)\leq\min{\left\{\sqrt{%
\frac{M}{c\cdot(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m%
\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{|\mathcal{A}|}\cdot\left\|\frac{1}{\mu}\right\|_{%
\infty}^{-1}\cdot\underset{s}{min}\left\{\mu(s)\right\}>0
{\alpha_{m}(s,a)}
\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})
\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})
{\alpha_{m}(s,a)}=\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
\sum_{a\in s_{m}^{{}^{\prime}+}}A^{m}(s^{\prime},a)^{2}
A^{m}(s^{\prime},a)^{2}
V^{\pi^{*}}(s)-V^{\pi_{m}}(s)
\pi_{m+1}(a_{m}|s_{m})\rightarrow 1
\pi_{\theta}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
|B_{m}|=1
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(%
\rho)-V^{\pi_{m}}(\rho)\right]\leq\frac{1}{c}\cdot\frac{1}{m},\quad\text{for %
all $m\geq 1$}
m\geq 1
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(%
\rho)-V^{\pi_{m}}(\rho)\right]\leq\frac{1}{c}\cdot\frac{1}{m},\quad\text{for %
all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}%
}\left[V^{*}(\rho)-V^{\pi_{m}}(\rho)\right]\leq\min{\left\{\sqrt{\frac{M}{c%
\cdot(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}%
}\left[V^{*}(\rho)-V^{\pi_{m}}(\rho)\right]\leq\min{\left\{\sqrt{\frac{M}{c%
\cdot(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}^{-1}\cdot%
\underset{(s,a)}{min}\left\{d_{gen}(s,a)\cdot\mu(s)\right\}>0
d_{gen}:\mathcal{S}\times\mathcal{A}\rightarrow(0,1)
d_{gen}(s,a)=\mathbb{P}((s,a)\in B_{m})
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
(s_{m},a_{m})
\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(\mu)-V^{\pi_{m%
}}(\mu)\right]
\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi_{m+1}}(\mu)-V%
^{\pi_{m}}(\mu)\right]
m\geq 1
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{%
m},a_{m})&\text{, if }A^{m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{%
m})}\cdot(-A^{m}(s_{m},a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{+}}{1-\pi_{m}(a_{m}|s_{m})}\cdot A^{m}(s_{%
m},a_{m})&\text{, if }A^{m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{W^{-}}{1-\pi_{m}(a_{m}|s_{%
m})}\cdot(-A^{m}(s_{m},a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle\text{where }\begin{cases}(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq%
\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}\\
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\end{cases}
\displaystyle\text{where }\begin{cases}(1-\pi_{m}(a_{m}|s_{m}))\geq W^{+}\geq%
\frac{(1-\pi_{m}(a_{m}|s_{m}))^{2}}{2-\pi_{m}(a_{m}|s_{m})}\\
\pi_{m}(a_{m}|s_{m})\geq W^{-}\geq\frac{\pi_{m}(a_{m}|s_{m})\cdot(1-\pi_{m}(a_%
{m}|s_{m}))^{2}}{\pi_{m}(a_{m}|s_{m})^{2}-\pi_{m}(a_{m}|s_{m})+1}\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{m}(s_{m},a_{m})>%
0\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{m}(s_{m},a_{m})>%
0\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\end{cases}
d_{gen}(s,a)
m
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}&\text{, if }A^{%
m}(s_{m},a_{m})>0\text{, w.p. }d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{%
m}(s_{m},a_{m})>0\text{, w.p. }d_{gen}(s,a)\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\text{, w.p. }d_{gen}(s,a)\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\geq\begin{cases}\frac{d^{\pi_{m+%
1}}_{s}(s_{m})}{2}\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}&\text{, if }A^{%
m}(s_{m},a_{m})>0\text{, w.p. }d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{2}\cdot A^{m}(s_{m},a_{m})^{2}&\text{, if }A^{%
m}(s_{m},a_{m})>0\text{, w.p. }d_{gen}(s,a)\\
d^{\pi_{m+1}}_{s}(s_{m})\cdot\pi_{m}(a_{m}|s_{m})\cdot A^{m}(s_{m},a_{m})^{2}&%
\text{, if }A^{m}(s_{m},a_{m})<0\text{, w.p. }d_{gen}(s,a)\end{cases}
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi_%
{m+1}}(s)-V^{\pi_{m}}(s)\right]=\sum_{(s^{\prime},a^{\prime})\in\mathcal{S}%
\times\mathcal{A}}d_{gen}(s^{\prime},a^{\prime})\cdot\left[V^{\pi_{m+1}}(s)-V^%
{\pi_{m}}(s)\>|\>(s_{m},a_{m})=(s^{\prime},a^{\prime})\right]
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi_%
{m+1}}(s)-V^{\pi_{m}}(s)\right]
\displaystyle=\sum_{(s^{\prime},a^{\prime})\in\mathcal{S}\times\mathcal{A}}d_{%
gen}(s^{\prime},a^{\prime})\cdot\left[V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)\>|\>(s_{%
m},a_{m})=(s^{\prime},a^{\prime})\right]
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\left[V^{\pi_{m+1}}%
(s)-V^{\pi_{m}}(s)\>|\>(s_{m},a_{m})=(\tilde{s_{m}},\tilde{a_{m}})\right]
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\left[V^{\pi_{m+1}}%
(s)-V^{\pi_{m}}(s)\>|\>(s_{m},a_{m})=(\tilde{s_{m}},\tilde{a_{m}})\right]
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{2}\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{2}\cdot A^{m}(\tilde{s_{m}},\tilde{a_{m}})^{2}
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{2}\cdot(1-\gamma)^{2}\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{2}\cdot(1-\gamma)^{2}\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}_{s}%
(s_{m})}{2}\cdot(1-\gamma)^{2}\cdot\underset{({s_{m}},{a_{m}})\sim d_{gen}}{%
\mathbb{E}}\left[V^{*}(s)-V^{\pi_{m}}(s)\right]^{2}
\displaystyle=d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}_{s}%
(s_{m})}{2}\cdot(1-\gamma)^{2}\cdot\underset{({s_{m}},{a_{m}})\sim d_{gen}}{%
\mathbb{E}}\left[V^{*}(s)-V^{\pi_{m}}(s)\right]^{2}
m
(s_{m},a_{m})
m
\mu
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi_%
{m+1}}(\mu)-V^{\pi_{m}}(\mu)\right]\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})%
\cdot\frac{d^{\pi_{m+1}}_{\mu}(s_{m})}{2}\cdot(1-\gamma)^{2}\cdot\underset{({s%
_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right%
]^{2}
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi_%
{m+1}}(\mu)-V^{\pi_{m}}(\mu)\right]
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{d^{\pi_{m+1}}%
_{\mu}(s_{m})}{2}\cdot(1-\gamma)^{2}\cdot\underset{({s_{m}},{a_{m}})\sim d_{%
gen}}{\mathbb{E}}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]^{2}
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{\mu(s_{m})}{2%
}\cdot(1-\gamma)^{3}\cdot\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]^{2}
\displaystyle\geq d_{gen}(\tilde{s_{m}},\tilde{a_{m}})\cdot\frac{\mu(s_{m})}{2%
}\cdot(1-\gamma)^{3}\cdot\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]^{2}
\displaystyle\geq\underbrace{\underset{(s^{\prime},a^{\prime})\in\mathcal{S}%
\times\mathcal{A}}{\min}\left\{d_{gen}(s^{\prime},a^{\prime})\cdot\mu(s^{%
\prime})\right\}\cdot\frac{(1-\gamma)^{3}}{2}}_{:=c^{\prime}>0}\cdot\underset{%
({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)%
\right]^{2}
\displaystyle\geq\underbrace{\underset{(s^{\prime},a^{\prime})\in\mathcal{S}%
\times\mathcal{A}}{\min}\left\{d_{gen}(s^{\prime},a^{\prime})\cdot\mu(s^{%
\prime})\right\}\cdot\frac{(1-\gamma)^{3}}{2}}_{:=c^{\prime}>0}\cdot\underset{%
({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)%
\right]^{2}
d^{\pi}_{\mu}\geq(1-\gamma)\cdot\mu(s)
\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi_{m+1}}(\mu)-V%
^{\pi_{m}}(\mu)\right]=\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)\right]-\underset{({s_{m}},{a_{m}})\sim
d%
_{gen}}{\mathbb{E}}\left[V^{\pi^{*}}(\mu)-V^{\pi_{m+1}}(\mu)\right]
\displaystyle\delta_{m+1}\leq\delta_{m}-c^{\prime}\cdot\delta_{m}^{2}\quad%
\text{where $\delta_{m}=\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)\right]$}
\delta_{m}=\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi^{*%
}}(\mu)-V^{\pi_{m}}(\mu)\right]
\displaystyle\delta_{m+1}\leq\delta_{m}-c^{\prime}\cdot\delta_{m}^{2}\quad%
\text{where $\delta_{m}=\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{\pi^{*}}(\mu)-V^{\pi_{m}}(\mu)\right]$}
\delta_{m}=\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{\pi^{*%
}}(\mu)-V^{\pi_{m}}(\mu)\right]
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(%
\mu)-V^{\pi_{m}}(\mu)\right]\leq\frac{1}{c^{\prime}}\cdot\frac{1}{m},\quad%
\text{for all $m\geq 1$}
m\geq 1
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(%
\mu)-V^{\pi_{m}}(\mu)\right]\leq\frac{1}{c^{\prime}}\cdot\frac{1}{m},\quad%
\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}%
}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]\leq\min{\left\{\sqrt{\frac{M}{c^{%
\prime}\cdot(1-\gamma)}},\frac{\log M+1}{c^{\prime}}\right\}},\quad\text{for %
all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}%
}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]\leq\min{\left\{\sqrt{\frac{M}{c^{%
\prime}\cdot(1-\gamma)}},\frac{\log M+1}{c^{\prime}}\right\}},\quad\text{for %
all $m\geq 1$}
m\geq 1
c^{\prime}=\frac{(1-\gamma)^{3}}{2}\cdot\underset{(s,a)}{\min}\left\{d_{gen}(s%
,a)\cdot\mu(s)\right\}>0
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(%
\rho)-V^{\pi_{m}}(\rho)\right]\leq\frac{1}{1-\gamma}\cdot\left\|\frac{1}{\mu}%
\right\|_{\infty}\cdot\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right])\leq\frac{1}{c}\cdot\frac{1}{m},\quad%
\text{for all $m\geq 1$}
m\geq 1
\displaystyle\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}\left[V^{*}(%
\rho)-V^{\pi_{m}}(\rho)\right]\leq\frac{1}{1-\gamma}\cdot\left\|\frac{1}{\mu}%
\right\|_{\infty}\cdot\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}}%
\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right])\leq\frac{1}{c}\cdot\frac{1}{m},\quad%
\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}%
}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]\leq\min{\left\{\sqrt{\frac{M}{c\cdot%
(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
\displaystyle\sum_{m=1}^{M}\underset{({s_{m}},{a_{m}})\sim d_{gen}}{\mathbb{E}%
}\left[V^{*}(\mu)-V^{\pi_{m}}(\mu)\right]\leq\min{\left\{\sqrt{\frac{M}{c\cdot%
(1-\gamma)}},\frac{\log M+1}{c}\right\}},\quad\text{for all $m\geq 1$}
m\geq 1
c=\frac{(1-\gamma)^{4}}{2}\cdot\left\|\frac{1}{\mu}\right\|_{\infty}^{-1}\cdot%
\underset{(s,a)}{min}\left\{d_{gen}(s,a)\cdot\mu(s)\right\}>0
\theta_{m+1}(s,a)=\theta_{m}(s,a)+\alpha^{(m)}(s,a)\cdot\operatorname{sign}(A^%
{(m)}(s,a))\cdot\mathbb{I}\{a=a_{m}\},
N^{(k)}(s,a)=\sum^{k}_{m=0}\mathbb{I}\{(s,a)\in\mathcal{B}_{m}\}
\alpha^{(m)}(s,a)
\displaystyle\alpha^{(m)}(s,a)=\begin{cases}\log\big{(}\frac{1}{\pi^{(m)}(a%
\rvert s)}\big{)},&\text{ if }A^{(m)}(s,a)\leq 0\\
\log\big{(}\frac{\beta}{1-\beta}\cdot\frac{1}{\pi^{(m)}(a\rvert s)}\big{)},&%
\text{ if }A^{(m)}(s,a)>0\text{ and }\pi^{(m)}(a\rvert s)<\beta\\
\zeta\log\big{(}\frac{N^{(m)}(s,a)+1}{{N^{(k)}(s,a)}}\big{)},&\text{ otherwise%
 }\end{cases}
\displaystyle\alpha^{(m)}(s,a)=\begin{cases}\log\big{(}\frac{1}{\pi^{(m)}(a%
\rvert s)}\big{)},&\text{ if }A^{(m)}(s,a)\leq 0\\
\log\big{(}\frac{\beta}{1-\beta}\cdot\frac{1}{\pi^{(m)}(a\rvert s)}\big{)},&%
\text{ if }A^{(m)}(s,a)>0\text{ and }\pi^{(m)}(a\rvert s)<\beta\\
\zeta\log\big{(}\frac{N^{(m)}(s,a)+1}{{N^{(k)}(s,a)}}\big{)},&\text{ otherwise%
 }\end{cases}
\displaystyle\alpha^{(k)}(\pi^{(k)}(a\rvert s))=\begin{cases}\log\big{(}\frac{%
1}{\pi^{(k)}(a\rvert s)}\big{)},&\text{ if }A^{(k)}(s,a)\leq 0\\
\log\big{(}\frac{\beta}{1-\beta}\cdot\frac{1}{\pi^{(k)}(a\rvert s)}\big{)},&%
\text{ if }A^{(k)}(s,a)>0\text{ and }\pi^{(k)}(a\rvert s)<\beta\\
\zeta\log\big{(}\frac{N^{(k)}(s,a)+1}{{N^{(k)}(s,a)}}\big{)},&\text{ otherwise%
 }\end{cases}
\displaystyle\alpha^{(k)}(\pi^{(k)}(a\rvert s))=\begin{cases}\log\big{(}\frac{%
1}{\pi^{(k)}(a\rvert s)}\big{)},&\text{ if }A^{(k)}(s,a)\leq 0\\
\log\big{(}\frac{\beta}{1-\beta}\cdot\frac{1}{\pi^{(k)}(a\rvert s)}\big{)},&%
\text{ if }A^{(k)}(s,a)>0\text{ and }\pi^{(k)}(a\rvert s)<\beta\\
\zeta\log\big{(}\frac{N^{(k)}(s,a)+1}{{N^{(k)}(s,a)}}\big{)},&\text{ otherwise%
 }\end{cases}
0<\beta\leq\frac{1}{\lvert\operatorname{\mathcal{A}}\rvert+1}
0<\zeta\leq\frac{1}{\lvert\operatorname{\mathcal{A}}\rvert}
V_{k}(s)\rightarrow V^{*}(s)
k\rightarrow\infty
s\in\operatorname{\mathcal{S}}
k
a
\pi^{(k)}(a\rvert s)<\beta
A^{(k)}(s,a)>0
\pi^{(k+1)}(a\rvert s)>\beta
a
\pi^{(k)}(a\rvert s)<\beta
A^{(k)}(s,a)>0
\displaystyle\theta^{(k+1)}_{s,a}=\theta^{(k)}_{s,a}+\log\big{(}\frac{\beta}{1%
-\beta}\cdot\frac{1}{\pi^{(k)}(a\rvert s)}\big{)}
\displaystyle\theta^{(k+1)}_{s,a}
\displaystyle=\theta^{(k)}_{s,a}+\log\big{(}\frac{\beta}{1-\beta}\cdot\frac{1}%
{\pi^{(k)}(a\rvert s)}\big{)}
\displaystyle=\theta^{(k)}_{s,a}+\log\Big{(}\frac{\beta}{1-\beta}\cdot\frac{%
\sum_{a^{\prime}\in\operatorname{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}}%
)}{\exp(\theta^{(k)}_{s,a})}\Big{)}
\displaystyle=\theta^{(k)}_{s,a}+\log\Big{(}\frac{\beta}{1-\beta}\cdot\frac{%
\sum_{a^{\prime}\in\operatorname{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}}%
)}{\exp(\theta^{(k)}_{s,a})}\Big{)}
\displaystyle=\log\Big{(}\frac{\beta}{1-\beta}\cdot\sum_{a^{\prime}\in%
\operatorname{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}})\Big{)}.
\displaystyle=\log\Big{(}\frac{\beta}{1-\beta}\cdot\sum_{a^{\prime}\in%
\operatorname{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}})\Big{)}.
\displaystyle\pi^{(k+1)}(a\rvert s)=\frac{\frac{\beta}{1-\beta}\cdot\sum_{a^{%
\prime}\in\operatorname{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}})}{\frac{%
\beta}{1-\beta}\cdot\sum_{a^{\prime}\in\operatorname{\mathcal{A}}}\exp(\theta^%
{(k)}_{s,a^{\prime}})+\sum_{a^{\prime\prime}\in\operatorname{\mathcal{A}},a^{%
\prime\prime}\neq a}\exp(\theta^{(k)}_{s,a^{\prime\prime}})}
\displaystyle\pi^{(k+1)}(a\rvert s)
\displaystyle=\frac{\frac{\beta}{1-\beta}\cdot\sum_{a^{\prime}\in\operatorname%
{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}})}{\frac{\beta}{1-\beta}\cdot%
\sum_{a^{\prime}\in\operatorname{\mathcal{A}}}\exp(\theta^{(k)}_{s,a^{\prime}}%
)+\sum_{a^{\prime\prime}\in\operatorname{\mathcal{A}},a^{\prime\prime}\neq a}%
\exp(\theta^{(k)}_{s,a^{\prime\prime}})}
\displaystyle=\frac{\frac{\beta}{1-\beta}}{\frac{\beta}{1-\beta}+(1-\pi^{(k)}(%
a\rvert s))}>\beta.
\displaystyle=\frac{\frac{\beta}{1-\beta}}{\frac{\beta}{1-\beta}+(1-\pi^{(k)}(%
a\rvert s))}>\beta.
s\in\operatorname{\mathcal{S}}
s
\displaystyle E_{0}:=\Big{\{}\omega:I_{s}^{+}(\omega)\neq\varnothing\Big{\}},
\displaystyle E_{0}:=
\displaystyle\Big{\{}\omega:I_{s}^{+}(\omega)\neq\varnothing\Big{\}},
\displaystyle E_{1}:=\Big{\{}\omega:\lim_{k\rightarrow\infty}\pi_{s,a}^{(k)}(%
\omega)=0,\forall a\in I_{s}^{-}(\omega)\Big{\}},
\displaystyle E_{1}:=
\displaystyle\Big{\{}\omega:\lim_{k\rightarrow\infty}\pi_{s,a}^{(k)}(\omega)=0%
,\forall a\in I_{s}^{-}(\omega)\Big{\}},
\displaystyle{E}_{1,1}:=\Big{\{}\omega:\exists a\in I_{s}^{-}\text{ with }N^{(%
\infty)}_{s,a}(\omega)=\infty\Big{\}},
\displaystyle{E}_{1,1}:=
\displaystyle\Big{\{}\omega:\exists a\in I_{s}^{-}\text{ with }N^{(\infty)}_{s%
,a}(\omega)=\infty\Big{\}},
\displaystyle E_{1,2}:=\Big{\{}\omega:\exists a\in I_{s}^{+}\text{ with }N^{(%
\infty)}_{s,a}(\omega)=\infty\Big{\}},
\displaystyle E_{1,2}:=
\displaystyle\Big{\{}\omega:\exists a\in I_{s}^{+}\text{ with }N^{(\infty)}_{s%
,a}(\omega)=\infty\Big{\}},
\displaystyle E_{1,3}:=\Big{\{}\omega:\exists a^{\prime}\in I_{s}^{0}(\omega)%
\text{ with }N^{(\infty)}_{s,a^{\prime}}(\omega)=\infty\Big{\}}.
\displaystyle E_{1,3}:=
\displaystyle\Big{\{}\omega:\exists a^{\prime}\in I_{s}^{0}(\omega)\text{ with%
 }N^{(\infty)}_{s,a^{\prime}}(\omega)=\infty\Big{\}}.
a\in\operatorname{\mathcal{A}}
N^{(\infty)}_{s,a}=\infty
E_{1,1}\cup E_{1,2}\cup E_{1,3}=\Omega
{E}_{1}^{c}
{E}_{1}^{c}=({E}_{1}^{c}\cap E_{1,1})\cup({E}_{1}^{c}\cap E_{1,2})\cup({E}_{1}%
^{c}\cap E_{1,3})
\operatorname{\mathbb{P}}({E}_{1}^{c}\rvert E_{0})\leq\sum_{i=1}^{3}%
\operatorname{\mathbb{P}}({E}_{1}^{c}\cap E_{1,i}\rvert E_{0}).
\operatorname{\mathbb{P}}(E_{0})>0
\operatorname{\mathbb{P}}({E}_{1}^{c}\cap{E}_{1,1}\rvert E_{0})=0
E_{0}
\omega
a^{\prime}\in I_{s}^{+}(\omega)
B_{0}
\theta^{(k)}(s,a^{\prime})\geq B_{0}
k\geq T^{+}_{s,a^{\prime}}(\omega)
a^{\prime\prime}\in I_{s}^{-}(\omega)
\theta^{(k)}(s,a^{\prime\prime})
k\geq T^{-}_{s,a^{\prime\prime}}
\pi^{(k)}(s,a^{\prime\prime})\leq\frac{\exp\Big{(}\theta^{\big{(}T^{-}_{s,a^{%
\prime\prime}}\big{)}}(s,a^{\prime\prime})\Big{)}}{\exp\Big{(}\theta^{\big{(}T%
^{-}_{s,a^{\prime\prime}}\big{)}}(s,a^{\prime\prime})\Big{)}+\exp(B_{0})}
k\geq\max\{T^{+}_{s,a^{\prime}},T^{-}_{s,a^{\prime\prime}}\}
(s,a^{\prime\prime})
\operatorname{\mathcal{B}}^{(k)}
k\geq\max\{T^{+}_{s,a^{\prime}},T^{-}_{s,a^{\prime\prime}}\}
\theta^{(k+1)}_{s,a^{\prime\prime}}-\theta^{(k)}_{s,a^{\prime\prime}}\leq-\log%
\bigg{(}\frac{\exp\big{(}\theta^{(T^{-}_{s,a^{\prime\prime}})}(s,a^{\prime%
\prime})\big{)}+\exp(B_{0})}{\exp\big{(}\theta^{(T^{-}_{s,a^{\prime\prime}})}(%
s,a^{\prime\prime})\big{)}}\bigg{)}.
\omega\in E_{0}
a^{\prime\prime}\in I_{s}^{-}(\omega)
N_{s,a^{\prime\prime}}^{(\infty)}(\omega)=\infty
\theta^{(k)}_{s,a^{\prime\prime}}(\omega)\rightarrow-\infty
k\rightarrow\infty
\operatorname{\mathbb{P}}(E_{1}^{c}\cap E_{1,1}\rvert E_{0})=0
\operatorname{\mathbb{P}}(E_{0})>0
\operatorname{\mathbb{P}}({E}_{1}^{c}\cap{E}_{1,2}\rvert E_{0})=0
\operatorname{\mathbb{P}}(E_{1}^{c}\cap E_{1,2}\rvert E_{0})=\operatorname{%
\mathbb{P}}(E_{1}^{c}\cap E_{1,1}^{c}\cap E_{1,2}\rvert E_{0})
a\in I_{s}^{+}
N^{(\infty)}_{s,a}(\omega)=\infty
N_{s,a^{\prime}}^{(\infty)}
a^{\prime}\in I_{s}^{-}
\theta^{(k)}_{s,a^{\prime}}
k\in\mathbb{N}
\{k_{m}\}_{m=1}^{\infty}
(s,a)
\pi^{(k_{m})}(a\rvert s)\rightarrow 1
m\rightarrow\infty
E_{0}
I_{s}^{+}
I_{s}^{-}
\theta^{(k)}_{s,a^{\prime}}
a^{\prime}\in I_{s}^{-}
\pi^{(k_{m})}(a\rvert s)\rightarrow 1
\theta^{(k_{m})}_{s,a}\rightarrow\infty,\text{ as }m\rightarrow\infty.
\theta^{(k_{m})}_{s,a}
m
a\in I_{s}^{+}
\theta^{(k)}_{s,a}\rightarrow\infty,\text{ as }k\rightarrow\infty
\lim_{k\rightarrow\infty}\pi^{(k)}(a^{\prime}\rvert s)=0
a^{\prime}\in I_{s}^{-}
\pi^{(k_{m})}(a\rvert s)\nrightarrow 1
m\rightarrow\infty
A^{(k_{m})}(s,a)
m
a\in I_{s}^{+}
\pi^{(k_{m})}(a\rvert s)\geq\beta
\theta^{(k_{m}+1)}_{s,a}-\theta^{(k_{m})}_{s,a}\geq\zeta\log(\frac{N^{(k_{m})}%
(s,a)+1)}{N^{(k_{m})}(s,a)})=\zeta\log(\frac{m+1}{m})
\pi^{(k_{m})}(a\rvert s)<\beta
\theta^{(k_{m}+1)}_{s,a}-\theta^{(k_{m})}_{s,a}\geq\log(\frac{1}{1-\beta})>%
\zeta\log(\frac{m+1}{m})
m
\theta^{(k_{m})}(s,a)\rightarrow\infty
m\rightarrow\infty
\theta^{(k_{m})}_{s,a}
m
a\in I_{s}^{+}
\theta^{(k)}_{s,a}\rightarrow\infty
k\rightarrow\infty
\theta^{(k)}_{s,a^{\prime}}
a^{\prime}\in I_{s}^{-}
\lim_{k\rightarrow\infty}\pi^{(k)}(a^{\prime}\rvert s)=0
a^{\prime}\in I_{s}^{-}
\operatorname{\mathbb{P}}(E_{0})>0
\operatorname{\mathbb{P}}({E}_{1}^{c}\cap{E}_{1,3}\rvert E_{0})=0
\operatorname{\mathbb{P}}({E}_{1}^{c}\cap{E}_{1,3}\rvert E_{0})=\operatorname{%
\mathbb{P}}({E}_{1}^{c}\cap E_{1,2}^{c}\cap E_{1,1}^{c}\cap{E}_{1,3}\rvert E_{%
0})
E_{1,1}^{c}\cap E_{1,2}^{c}
I_{s}^{+}\cup I_{s}^{-}
\operatorname{\mathcal{B}}^{(k)}
T_{0}\in\mathbb{N}
\operatorname{\mathcal{B}}^{(k)}
I_{s}^{0}
k\geq T_{0}
\sum_{a\in I_{s}^{0}}\pi^{(k)}(a\rvert s)\rightarrow 1
k\rightarrow\infty
\epsilon>0
\sum_{a\in I_{s}^{0}}\pi^{(k)}(a\rvert s)\leq 1-\epsilon
k
\lim_{k\rightarrow\infty}\pi^{(k)}(a^{\prime}\rvert s)=0
a^{\prime}\in I_{s}^{-}
\operatorname{\mathbb{P}}({E}_{1}^{c}\cap E_{1,2}^{c}\cap E_{1,1}^{c}\cap{E}_{%
1,3}\rvert E_{0})=0
\operatorname{\mathbb{P}}(E_{0})>0
\operatorname{\mathbb{P}}(E_{1}\rvert E_{0})=1
\operatorname{\mathbb{P}}(E_{1}^{c}\rvert E_{0})=0
\displaystyle E_{2}:=\Big{\{}\omega:\lim_{k\rightarrow\infty}\pi_{s,a}^{(k)}(%
\omega)=0,\forall a\in I_{s}^{+}(\omega)\Big{\}},
\displaystyle E_{2}:=
\displaystyle\Big{\{}\omega:\lim_{k\rightarrow\infty}\pi_{s,a}^{(k)}(\omega)=0%
,\forall a\in I_{s}^{+}(\omega)\Big{\}},
\displaystyle E_{3}:=\Big{\{}\omega:\exists a\in I_{s}^{+}(\omega)\text{ with %
}N^{(\infty)}_{s,a}(\omega)=\infty\Big{\}}
\displaystyle E_{3}:=
\displaystyle\Big{\{}\omega:\exists a\in I_{s}^{+}(\omega)\text{ with }N^{(%
\infty)}_{s,a}(\omega)=\infty\Big{\}}
\operatorname{\mathbb{P}}(E_{0})>0
\operatorname{\mathbb{P}}(E_{2}\rvert E_{0})=1
\operatorname{\mathbb{P}}(E_{0})>0
\operatorname{\mathbb{P}}(E_{2}\cap E_{3}\rvert E_{0})=0
E_{2}
a\in I_{s}^{+}
\epsilon>0
T_{a,\epsilon}
\pi_{s,a}^{(k)}<\epsilon
k\geq T_{a,\epsilon}
E_{3}
\pi_{s,a}^{(k)}>\beta
\operatorname{\mathbb{P}}(E_{2}\cap E_{3}\rvert E_{0})=0
\operatorname{\mathbb{P}}(E_{2}\cap E_{3}^{c}\rvert E_{0})=1
E_{0}
E_{3}^{c}
E_{3}^{c}
E_{3}^{c}:=\big{\{}\omega:\exists\tau(\omega)<\infty\text{ such that }%
\operatorname{\mathcal{B}}^{(k)}\subseteq I_{s}^{0}\cup I_{s}^{-},\forall k%
\geq\tau(\omega)\big{\}}.
\theta^{(k)}_{s,\max}:=\max_{a\in\operatorname{\mathcal{A}}}\theta^{(k)}_{s,a}.
t\in\mathbb{N}
K\in\mathbb{N}
\theta_{s,\max}^{(t+K)}-\theta_{s,\max}^{(t)}\leq\log(K+1),
\theta_{s,a}
\theta^{(k)}_{s,a}<\theta^{(k)}_{s,\max}
\pi^{(k)}(a\rvert s)<\beta
a
\displaystyle\theta^{(k+1)}_{s,a}\leq\theta^{(k)}_{s,a}+\log\Big{(}\frac{\beta%
}{(1-\beta)\cdot\pi^{(k)}(a\rvert s)}\Big{)}
\displaystyle\theta^{(k+1)}_{s,a}
\displaystyle\leq\theta^{(k)}_{s,a}+\log\Big{(}\frac{\beta}{(1-\beta)\cdot\pi^%
{(k)}(a\rvert s)}\Big{)}
\displaystyle\leq\log\Big{(}\frac{\beta}{(1-\beta)}\cdot\lvert\operatorname{%
\mathcal{A}}\rvert\exp({\theta^{(k)}_{s,\max}})\Big{)},
\displaystyle\leq\log\Big{(}\frac{\beta}{(1-\beta)}\cdot\lvert\operatorname{%
\mathcal{A}}\rvert\exp({\theta^{(k)}_{s,\max}})\Big{)},
\displaystyle\leq\log\Big{(}\frac{\frac{1}{\lvert\operatorname{\mathcal{A}}%
\rvert+1}}{(1-\frac{1}{\lvert\operatorname{\mathcal{A}}\rvert+1})}\cdot\lvert%
\operatorname{\mathcal{A}}\rvert\exp({\theta^{(k)}_{s,\max}})\Big{)}
\displaystyle\leq\log\Big{(}\frac{\frac{1}{\lvert\operatorname{\mathcal{A}}%
\rvert+1}}{(1-\frac{1}{\lvert\operatorname{\mathcal{A}}\rvert+1})}\cdot\lvert%
\operatorname{\mathcal{A}}\rvert\exp({\theta^{(k)}_{s,\max}})\Big{)}
\displaystyle=\theta^{(k)}_{s,\max},
\displaystyle=\theta^{(k)}_{s,\max},
\theta^{(k)}_{s,\max}
\beta
A^{(k)}(s,a)>0
\theta_{s,\max}^{(k)}
\theta^{(k)}_{s,a}<\theta^{(k)}_{s,\max}
\pi^{(k)}(a\rvert s)\geq\beta
a
\displaystyle\theta^{(k+1)}_{s,a}\leq\theta^{(k)}_{s,a}+\zeta\log\Big{(}\frac{%
N^{(k)}_{s,a}+1}{N^{(k)}_{s,a}}\Big{)},
\displaystyle\theta^{(k+1)}_{s,a}
\displaystyle\leq\theta^{(k)}_{s,a}+\zeta\log\Big{(}\frac{N^{(k)}_{s,a}+1}{N^{%
(k)}_{s,a}}\Big{)},
A^{(k)}(s,a)>0
\theta^{(k)}_{s,a}=\theta^{(k)}_{s,\max}
\displaystyle\theta^{(k+1)}_{s,a}\leq\theta^{(k)}_{s,a}+\zeta\log\Big{(}\frac{%
N^{(k)}_{s,a}+1}{N^{(k)}_{s,a}}\Big{)},
\displaystyle\theta^{(k+1)}_{s,a}
\displaystyle\leq\theta^{(k)}_{s,a}+\zeta\log\Big{(}\frac{N^{(k)}_{s,a}+1}{N^{%
(k)}_{s,a}}\Big{)},
A^{(k)}(s,a)>0
\theta^{(k+1)}_{s,\max}-\theta^{(k)}_{s,\max}\leq\zeta\sum_{a\in\operatorname{%
\mathcal{A}}}\log\Big{(}\frac{N^{(k+1)}_{s,a}}{N^{(k)}_{s,a}}\Big{)},\quad%
\forall k.
t\in\mathbb{N}
\theta_{s,\max}^{(k)}
t
(t+K)
\displaystyle\theta_{s,\max}^{(t+K)}-\theta_{s,\max}^{(t)}\leq\sum_{k=t}^{t+K-%
1}\zeta\sum_{a\in\operatorname{\mathcal{A}}}\log\Big{(}\frac{N^{(k+1)}_{s,a}}{%
N^{(k)}_{s,a}}\Big{)}
\displaystyle\theta_{s,\max}^{(t+K)}-\theta_{s,\max}^{(t)}
\displaystyle\leq\sum_{k=t}^{t+K-1}\zeta\sum_{a\in\operatorname{\mathcal{A}}}%
\log\Big{(}\frac{N^{(k+1)}_{s,a}}{N^{(k)}_{s,a}}\Big{)}
\displaystyle\leq\zeta\cdot\sum_{a\in\operatorname{\mathcal{A}}}\log\Big{(}%
\frac{N^{(t)}_{s,a}+K}{N^{(t)}_{s,a}}\Big{)}
\displaystyle\leq\zeta\cdot\sum_{a\in\operatorname{\mathcal{A}}}\log\Big{(}%
\frac{N^{(t)}_{s,a}+K}{N^{(t)}_{s,a}}\Big{)}
\displaystyle\leq\log(K+1),
\displaystyle\leq\log(K+1),
\zeta\leq\frac{1}{\lvert\operatorname{\mathcal{A}}\rvert}
\theta_{s,\max}^{(t+K)}-\theta_{s,\max}^{(t)}\leq\log(K+1)
I_{s}^{\dagger}\subset\operatorname{\mathcal{A}}
E_{4}(I_{s}^{\dagger}):=\big{\{}\omega:\text{ For every }a\in I_{s}^{\dagger},%
N^{(\infty)}(s,a)<\infty\big{\}}.
I_{s}^{\dagger}\subset\operatorname{\mathcal{A}}
\operatorname{\mathbb{P}}(E_{4}(I_{s}^{\dagger}))=0
I_{s}^{\dagger}\subset\operatorname{\mathcal{A}}
n\in\mathbb{N}
E_{4,n}(I_{s}^{\dagger}):=\big{\{}\omega:\text{ For every }a\in I_{s}^{\dagger%
},(s,a)\notin\operatorname{\mathcal{B}}^{(k)},\forall k\geq n\big{\}}.
\{E_{4,n}(I_{s}^{\dagger})\}_{n=1}^{\infty}
E_{4,1}(I_{s}^{\dagger})\subseteq E_{4,2}(I_{s}^{\dagger})\cdots\subseteq E_{4%
,n}(I_{s}^{\dagger})\subseteq E_{4,n+1}(I_{s}^{\dagger})\cdots
E_{4}(I_{s}^{\dagger})=\bigcup_{n=1}^{\infty}E_{4,n}(I_{s}^{\dagger})
\operatorname{\mathbb{P}}(E_{4}(I_{s}^{\dagger}))=\operatorname{\mathbb{P}}(%
\lim_{n\rightarrow\infty}E_{4,n}(I_{s}^{\dagger}))=\lim_{n\rightarrow\infty}%
\operatorname{\mathbb{P}}(E_{4,n}(I_{s}^{\dagger})).
\operatorname{\mathbb{P}}(E_{4,n}(I_{s}^{\dagger}))
\displaystyle\log\big{(}\operatorname{\mathbb{P}}(E_{4,n}(I_{s}^{\dagger}))%
\big{)}\leq\log\bigg{(}\prod_{k\geq n}\frac{\sum_{a^{\prime}\in I_{s}^{0}\cup I%
_{s}^{-}}\exp(\theta_{s,a\textquoteright}^{(k)})}{\sum_{a^{\prime}\in I_{s}^{0%
}\cup I_{s}^{-}}\exp(\theta_{s,a\textquoteright}^{(k)})+\sum_{a\in I_{s}^{+}}%
\exp(\theta_{s,a}^{(k)})}\bigg{)}
\displaystyle\log\big{(}\operatorname{\mathbb{P}}(E_{4,n}(I_{s}^{\dagger}))%
\big{)}
\displaystyle\leq\log\bigg{(}\prod_{k\geq n}\frac{\sum_{a^{\prime}\in I_{s}^{0%
}\cup I_{s}^{-}}\exp(\theta_{s,a\textquoteright}^{(k)})}{\sum_{a^{\prime}\in I%
_{s}^{0}\cup I_{s}^{-}}\exp(\theta_{s,a\textquoteright}^{(k)})+\sum_{a\in I_{s%
}^{+}}\exp(\theta_{s,a}^{(k)})}\bigg{)}
\displaystyle\leq\log\bigg{(}\prod_{k\geq n}\frac{\lvert\operatorname{\mathcal%
{A}}\rvert\exp(\theta_{s,\max}^{(k)})}{\lvert\operatorname{\mathcal{A}}\rvert%
\exp(\theta_{s,\max}^{(k)})+\sum_{a\in I_{s}^{+}}\exp(\theta_{s,a}^{(n)})}%
\bigg{)}
\displaystyle\leq\log\bigg{(}\prod_{k\geq n}\frac{\lvert\operatorname{\mathcal%
{A}}\rvert\exp(\theta_{s,\max}^{(k)})}{\lvert\operatorname{\mathcal{A}}\rvert%
\exp(\theta_{s,\max}^{(k)})+\sum_{a\in I_{s}^{+}}\exp(\theta_{s,a}^{(n)})}%
\bigg{)}
\displaystyle\leq\log\bigg{(}\prod_{m\geq 1}\frac{\lvert\operatorname{\mathcal%
{A}}\rvert\exp\big{(}\theta_{s,\max}^{(n)}+\log(m+1)\big{)}}{\lvert%
\operatorname{\mathcal{A}}\rvert\exp\big{(}\theta_{s,\max}^{(n)}+\log(m+1)\big%
{)}+\sum_{a\in I_{s}^{+}}\exp(\theta_{s,a}^{(n)})}\bigg{)}
\displaystyle\leq\log\bigg{(}\prod_{m\geq 1}\frac{\lvert\operatorname{\mathcal%
{A}}\rvert\exp\big{(}\theta_{s,\max}^{(n)}+\log(m+1)\big{)}}{\lvert%
\operatorname{\mathcal{A}}\rvert\exp\big{(}\theta_{s,\max}^{(n)}+\log(m+1)\big%
{)}+\sum_{a\in I_{s}^{+}}\exp(\theta_{s,a}^{(n)})}\bigg{)}
\displaystyle\leq\sum_{m\geq 1}\log\bigg{(}1-\frac{\sum_{a\in I_{s}^{+}}\exp(%
\theta_{s,a}^{(n)})}{\lvert\operatorname{\mathcal{A}}\rvert(m+1)\exp(\theta_{s%
,\max}^{(n)})}\bigg{)}=-\infty,
\displaystyle\leq\sum_{m\geq 1}\log\bigg{(}1-\frac{\sum_{a\in I_{s}^{+}}\exp(%
\theta_{s,a}^{(n)})}{\lvert\operatorname{\mathcal{A}}\rvert(m+1)\exp(\theta_{s%
,\max}^{(n)})}\bigg{)}=-\infty,
\theta^{(k)}_{s,\max}
E_{4,n}(I_{s}^{\dagger})
\operatorname{\mathbb{P}}(E_{4,n}(I_{s}^{\dagger}))=0
n\in\mathbb{N}
\operatorname{\mathbb{P}}(E_{4}(I_{s}^{\dagger}))=0
E_{0}
E_{3}^{c}
\operatorname{\mathbb{P}}(E_{2}\cap E_{3}^{c}\rvert E_{0})=1
I_{s}^{\dagger}\subset\operatorname{\mathcal{A}}
I_{s}^{\dagger}
\operatorname{\mathbb{P}}(E_{0})=0
K
\left[K\right]
\pi_{\theta}:[K]\rightarrow[0,1]
r\in\mathbb{R}^{K}
r(a)\in[0,1),\forall a\in[K]
r\in\mathbb{R}^{K}
\pi^{*}
J(\theta)=\mathbb{E}_{{a\sim\pi_{\theta}(\cdot)}}[r(a)].
\theta_{m+1}(s,a)=\theta_{m}(s,a)+\eta\cdot\operatorname{sign}(A(s,a))\cdot%
\mathbb{I}\{a=a_{m}\}
\eta
K=3
r=[1,0.99,-1]
\pi_{1}
\pi_{1}(a)=\frac{1}{K},\forall a\in[K]
\operatorname{\mathbb{P}}(\pi_{\infty}(a_{2})=1)>0
\pi_{1}(a_{1})=\pi_{1}(a_{3})
r(a_{1})=-r(a_{3})
a_{2}
t
A_{m}(a_{2})>0,\forall m\leq t
\pi_{m}(a_{2})
a_{2}
\mathcal{E}_{t}
a_{2}
t
b_{s}
\operatorname{\mathbb{P}}(\mathcal{E}_{t})\geq\prod_{s=1}^{t}b_{s}>0
\mathcal{B}_{m}=\left\{a_{m}=a_{2}\right\}
a_{2}
m
\mathcal{E}_{t}=\mathcal{B}_{1}\cap\cdots\cap\mathcal{B}_{t}
a_{2}
t
\left\{\mathcal{E}_{t}\right\}_{t\geq 1}
\lim_{t\rightarrow\infty}\operatorname{\mathbb{P}}\left(\mathcal{E}_{t}\right)%
=\operatorname{\mathbb{P}}(\mathcal{E})
b_{t}
b_{t}=\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)\right\}}{%
\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\frac{\exp\left\{\eta\right\}}{\eta}%
\right\}.
\pi_{m}(a_{1})=\pi_{m}(a_{3}),\forall 1\leq m\leq t
\theta_{1}(a_{1})=\theta_{1}(a_{3})
a_{2}
t
\forall 1\leq m\leq t
\displaystyle\pi_{m}(a_{1})=\frac{\exp(\theta_{m}(a_{1}))}{\sum_{a}\exp(\theta%
_{m}(a))}
\displaystyle\pi_{m}(a_{1})=\frac{\exp(\theta_{m}(a_{1}))}{\sum_{a}\exp(\theta%
_{m}(a))}
\displaystyle=\frac{\exp(\theta_{1}(a_{1}))}{\sum_{a}\exp(\theta_{m}(a))}=%
\frac{\exp(\theta_{1}(a_{3}))}{\sum_{a}\exp(\theta_{m}(a))}
\displaystyle=\frac{\exp(\theta_{1}(a_{1}))}{\sum_{a}\exp(\theta_{m}(a))}=%
\frac{\exp(\theta_{1}(a_{3}))}{\sum_{a}\exp(\theta_{m}(a))}
\displaystyle=\pi_{m}(a_{3}).
\displaystyle=\pi_{m}(a_{3}).
1\leq m\leq t
A_{m}(a_{2})\geq 0
\displaystyle A_{m}(a_{2})=r(a_{2})-\sum_{a}\pi_{m}(a)\cdot r(a)
\displaystyle A_{m}(a_{2})=r(a_{2})-\sum_{a}\pi_{m}(a)\cdot r(a)
\displaystyle\quad=(1-\pi_{m}(a_{2}))r(a_{2})-\sum_{a\neq a_{2}}\pi_{m}(a)%
\cdot r(a)
\displaystyle\quad=(1-\pi_{m}(a_{2}))r(a_{2})-\sum_{a\neq a_{2}}\pi_{m}(a)%
\cdot r(a)
\displaystyle\quad=(1-\pi_{m}(a_{2}))r(a_{2})-\sum_{a\neq a_{2}}\pi_{m}(a)%
\cdot r(a)
\displaystyle\quad=(1-\pi_{m}(a_{2}))r(a_{2})-\sum_{a\neq a_{2}}\pi_{m}(a)%
\cdot r(a)
\displaystyle\quad=(1-\pi_{m}(a_{2}))r(a_{2})\geq 0,
\displaystyle\quad=(1-\pi_{m}(a_{2}))r(a_{2})\geq 0,
r(a_{1})=-1\cdot r(a_{3})
\theta_{t}(a_{2})=\theta_{1}(a_{2})+\eta\cdot(t-1)
\displaystyle\theta_{t}(a_{2})=\theta_{1}(a_{2})+\eta\cdot\sum_{s=1}^{t-1}%
\operatorname{sign}(A_{s}(a_{2}))\cdot\mathbb{I}\{a_{2}=a_{s}\}
\displaystyle\theta_{t}(a_{2})=\theta_{1}(a_{2})+\eta\cdot\sum_{s=1}^{t-1}%
\operatorname{sign}(A_{s}(a_{2}))\cdot\mathbb{I}\{a_{2}=a_{s}\}
\displaystyle=\theta_{1}(a_{2})+\eta\cdot\sum_{s=1}^{t-1}1
\displaystyle=\theta_{1}(a_{2})+\eta\cdot\sum_{s=1}^{t-1}1
\displaystyle=\theta_{1}(a_{2})+\eta\cdot(t-1).
\displaystyle=\theta_{1}(a_{2})+\eta\cdot(t-1).
x\in(0,1)
1-x\geq\exp\left\{\frac{-x}{1-x}\right\}
\displaystyle 1-x=\exp\{\log(1-x)\}
\displaystyle 1-x
\displaystyle=\exp\{\log(1-x)\}
\displaystyle\geq\exp\left\{1-e^{-\log(1-x)}\right\}\quad\left(y\geq 1-e^{-y}\right)
\displaystyle\geq\exp\left\{1-e^{-\log(1-x)}\right\}\quad\left(y\geq 1-e^{-y}\right)
\displaystyle=\exp\left\{\frac{-1}{1/x-1}\right\}
\displaystyle=\exp\left\{\frac{-1}{1/x-1}\right\}
\displaystyle=\exp\left\{\frac{-x}{1-x}\right\}.
\displaystyle=\exp\left\{\frac{-x}{1-x}\right\}.
x
\frac{a}{b}
a<b
1-\frac{a}{b}\geq\exp\left\{\frac{-a}{b-a}\right\}.
\pi_{t}(a_{2})\geq\exp\left\{\frac{-\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)%
\right\}}{\exp\left\{\theta_{t}(a_{2})\right\}}\right\}
\displaystyle\pi_{t}(a_{2})=1-\sum_{a\neq a_{2}}\pi_{t}(a)
\displaystyle\pi_{t}(a_{2})=1-\sum_{a\neq a_{2}}\pi_{t}(a)
\displaystyle=1-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)\right\}}{\exp%
\left\{\theta_{t}(a_{2})\right\}+\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)%
\right\}}
\displaystyle=1-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)\right\}}{\exp%
\left\{\theta_{t}(a_{2})\right\}+\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)%
\right\}}
\displaystyle\geq\exp\left\{\frac{-\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)%
\right\}}{\exp\left\{\theta_{t}(a_{2})\right\}}\right\},
\displaystyle\geq\exp\left\{\frac{-\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)%
\right\}}{\exp\left\{\theta_{t}(a_{2})\right\}}\right\},
\displaystyle\prod_{t=1}^{\infty}\pi_{t}(a_{2})\geq\prod_{t=1}^{\infty}\exp%
\left\{\frac{-\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)\right\}}{\exp\left\{%
\theta_{t}(a_{2})\right\}}\right\}
\displaystyle\prod_{t=1}^{\infty}\pi_{t}(a_{2})\geq\prod_{t=1}^{\infty}\exp%
\left\{\frac{-\sum_{a\neq a_{2}}\exp\left\{\theta_{t}(a)\right\}}{\exp\left\{%
\theta_{t}(a_{2})\right\}}\right\}
\displaystyle=\prod_{t=1}^{\infty}\exp\left\{\frac{-\sum_{a\neq a_{2}}\exp%
\left\{\theta_{1}(a)\right\}}{\exp\left\{\theta_{1}(a_{2})+\eta\cdot(t-1)%
\right\}}\right\}
\displaystyle=\prod_{t=1}^{\infty}\exp\left\{\frac{-\sum_{a\neq a_{2}}\exp%
\left\{\theta_{1}(a)\right\}}{\exp\left\{\theta_{1}(a_{2})+\eta\cdot(t-1)%
\right\}}\right\}
\displaystyle=\exp\left\{\sum_{t=1}^{\infty}\frac{-\sum_{a\neq a_{2}}\exp\left%
\{\theta_{1}(a)\right\}}{\exp\left\{\theta_{1}(a_{2})+\eta\cdot(t-1)\right\}}\right\}
\displaystyle=\exp\left\{\sum_{t=1}^{\infty}\frac{-\sum_{a\neq a_{2}}\exp\left%
\{\theta_{1}(a)\right\}}{\exp\left\{\theta_{1}(a_{2})+\eta\cdot(t-1)\right\}}\right\}
\displaystyle=\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)%
\right\}}{\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\exp\left\{\eta\right\}%
\cdot\sum_{t=1}^{\infty}\frac{1}{\exp\left\{\eta\cdot t\right\}}\right\}
\displaystyle=\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)%
\right\}}{\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\exp\left\{\eta\right\}%
\cdot\sum_{t=1}^{\infty}\frac{1}{\exp\left\{\eta\cdot t\right\}}\right\}
\displaystyle\geq\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)%
\right\}}{\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\exp\left\{\eta\right\}%
\cdot\int_{t=0}^{\infty}\frac{1}{\exp\left\{\eta\cdot t\right\}}\right\}
\displaystyle\geq\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)%
\right\}}{\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\exp\left\{\eta\right\}%
\cdot\int_{t=0}^{\infty}\frac{1}{\exp\left\{\eta\cdot t\right\}}\right\}
\displaystyle=\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)%
\right\}}{\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\frac{\exp\left\{\eta%
\right\}}{\eta}\right\}
\displaystyle=\exp\left\{-\frac{\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)%
\right\}}{\exp\left\{\theta_{1}(a_{2})\right\}}\cdot\frac{\exp\left\{\eta%
\right\}}{\eta}\right\}
\displaystyle=\Omega(1),
\displaystyle=\Omega(1),
\sum_{a\neq a_{2}}\exp\left\{\theta_{1}(a)\right\}\in\Theta(1)
\exp\left\{\theta_{1}(a_{2})\right\}\in\Theta(1)
\frac{\exp\left\{\eta\right\}}{\eta}\in\Theta(1)
V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
\alpha\in\mathbb{R}
\alpha>0
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{(e^{\alpha}-1)\cdot\pi_{m}(a_{m}|s_{m})}{(e^{%
\alpha}-1)\cdot\pi_{m}(a_{m}|s_{m})+1}\cdot A^{m}(s_{m},a_{m})&\text{, if }A^{%
m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{(1-e^{-\alpha})\cdot\pi_{m%
}(a_{m}|s_{m})}{(e^{-\alpha}-1)\cdot\pi_{m}(a_{m}|s_{m})+1}\cdot(-A^{m}(s_{m},%
a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\displaystyle V^{\pi_{m+1}}(s)-V^{\pi_{m}}(s)=\begin{cases}\frac{d^{\pi_{m+1}}%
_{s}(s_{m})}{1-\gamma}\cdot\frac{(e^{\alpha}-1)\cdot\pi_{m}(a_{m}|s_{m})}{(e^{%
\alpha}-1)\cdot\pi_{m}(a_{m}|s_{m})+1}\cdot A^{m}(s_{m},a_{m})&\text{, if }A^{%
m}(s_{m},a_{m})>0\\
\frac{d^{\pi_{m+1}}_{s}(s_{m})}{1-\gamma}\cdot\frac{(1-e^{-\alpha})\cdot\pi_{m%
}(a_{m}|s_{m})}{(e^{-\alpha}-1)\cdot\pi_{m}(a_{m}|s_{m})+1}\cdot(-A^{m}(s_{m},%
a_{m}))&\text{, if }A^{m}(s_{m},a_{m})<0\\
\end{cases}
\alpha\in\mathbb{R}
\alpha>0
\alpha\in\mathbb{R}
\alpha>0
\pi_{m}(a_{m}|s_{m})\rightarrow 0
\pi_{m+1}(a_{m}|s_{m})-\pi_{m}(a_{m}|s_{m})\rightarrow 0
\alpha\in\mathbb{R}
\alpha>0
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)\geq%
\frac{(1-\gamma)^{2}}{2}\cdot\frac{1}{{\max}\left\{\frac{(1-\pi_{m+T}(a_{m+T}|%
s_{m+T}))\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})+1}{(1-\gamma)\cdot%
(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})},\frac{c_{m}\cdot T}{(1-\gamma)^%
{2}}\right\}}\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
\displaystyle\geq\frac{(1-\gamma)^{2}}{2}\cdot\frac{1}{{\max}\left\{\frac{(1-%
\pi_{m+T}(a_{m+T}|s_{m+T}))\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})+%
1}{(1-\gamma)\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})},\frac{c_{m}%
\cdot T}{(1-\gamma)^{2}}\right\}}\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle=\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{(1-\gamma)\cdot(%
e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})}{(1-\pi_{m+T}(a_{m+T}|s_{m+T}))%
\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})+1},\frac{(1-\gamma)^{2}}{c_%
{m}\cdot T}\right\}
\displaystyle=\frac{(1-\gamma)^{2}}{2}\cdot{\min}\left\{\frac{(1-\gamma)\cdot(%
e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})}{(1-\pi_{m+T}(a_{m+T}|s_{m+T}))%
\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})+1},\frac{(1-\gamma)^{2}}{c_%
{m}\cdot T}\right\}
\displaystyle\quad\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
\displaystyle\quad\cdot\left(V^{*}(s)-V^{\pi_{m}}(s)\right)^{2}
c_{m}=\underset{k\in[m,m+T-1]}{\max}\left\{c_{k1},c_{k2}\right\}\in[0,1]
c_{k1}=\mathbbm{1}\left\{A^{k}(s_{k},a_{k})>0\right\}\cdot d^{\pi_{k+1}}_{s}(s%
_{k})\cdot\frac{(e^{\alpha}-1)\cdot\pi_{k}(a_{k}|s_{k})\cdot(1-\pi_{k}(a_{k}|s%
_{k}))}{(e^{\alpha}-1)\cdot\pi_{k}(a_{k}|s_{k})+1}
c_{k2}=\mathbbm{1}\left\{A^{k}(s_{k},a_{k})<0\right\}\cdot d^{\pi_{k+1}}_{s}(s%
_{k})\cdot\frac{(1-e^{-\alpha})\cdot\pi_{k}(a_{k}|s_{k})\cdot(1-\pi_{k}(a_{k}|%
s_{k}))}{(e^{-\alpha}-1)\cdot\pi_{m+T}(a_{m}|s_{m})+1}
\frac{(1-\gamma)\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})}{(1-\pi_{m+%
T}(a_{m+T}|s_{m+T}))\cdot(e^{\alpha}-1)\cdot\pi_{m+T}(a_{m+T}|s_{m+T})+1}
\frac{(1-\gamma)^{2}}{c_{m}\cdot T}
\pi_{m+T}(a_{m+T}|s_{m+T})
V^{\pi_{m+|\mathcal{S}||\mathcal{A}|}}(s)-V^{\pi_{m}}(s)
\pi_{m+T}(a_{m+T}|s_{m+T})\rightarrow 0
(|\mathcal{S}||\mathcal{A}|)^{1000}
{\alpha_{m}(s,a)\geq\log(\frac{1}{\pi_{\theta_{m}}(a\rvert s)})}
K=4
r=[10,9.9,9.9,0]
\pi_{1}(a)=\frac{1}{K},\forall a\in[K]
a_{2},a_{3}
\theta_{1}=[0,3,3,0]
\pi_{1}\approx[0.0237,0.4762,0.4762,0.0237]
\lvert B_{m}\rvert=1
\alpha_{m}(s,a)
\alpha_{m}(s,a)
N=10
=0.001
\mathcal{S}\mathcal{A}
\mathcal{S}\times\mathcal{A}
S_{1}
S_{2}
S_{0}
S_{n}
S_{n-1}
S_{3}
0.1
0.1
0
100
0.1
0
0.1
n+1
1
0.1
S_{n-1}
S_{n}
100
n+1
1
0.1
S_{n-1}
S_{n}
100
\epsilon
\epsilon_{start}
A(s,a)
\theta^{b}
\theta
\theta^{Q}
\theta^{Q^{\prime}}
N_{\text{rollouts}}
r=[(s_{t},a_{t}),...,(s_{t+l},a_{t+l})]
l
(s,a)
R
l
R
Q_{\text{retrace}}
\log\frac{1}{\pi}
\pi\rightarrow 0
\alpha(s,a)=\min(\log\frac{1}{\pi(a\mid s)},\text{clip})
\tau_{\theta}
\tau_{Q}
\tau_{Q}
\tau_{\theta}
0.25
0.8
\pi_{\theta}
\theta\in\mathcal{S}\times\mathcal{A}
m=1,\cdots,M
|\mathcal{B}|
((s_{0},a_{0}),...,(s_{|\mathcal{B}|},a_{|\mathcal{B}|}))
i=1,\cdots,|\mathcal{B}|
\theta_{m+1}(s_{i},a_{i})\leftarrow\theta_{m}(s_{i},a_{i})+\alpha_{m}(s_{i},a_%
{i})\operatorname{sign}\left(A^{m}(s_{i},a_{i})\right)
f_{\theta}
\pi_{\theta}(a|s)=\frac{f_{\theta}(s,a)}{\sum_{a^{\prime}\in\mathcal{A}}f_{%
\theta}(s,a^{\prime})}
m=1,\cdots,M
\left((s_{0},a_{0}),...,(s_{|\mathcal{B}|},a_{|\mathcal{B}|}\right))
A^{\pi_{m}}
\hat{\theta}
\hat{\pi}
\hat{\theta}
\nabla_{\theta}L=\nabla_{\theta}D_{KL}\left(\pi_{f_{\theta_{m}}}\|\hat{\pi}\right)
f(s,a\mid\theta^{b})
Q(s,a\mid\theta^{Q})
R
f(s,a\mid\theta)\leftarrow f(s,a\mid\theta^{b})
Q(s,a|\theta^{Q^{\prime}})\leftarrow Q(s,a|\theta^{Q})
m=1,\cdots,M
\pi_{\theta}(a\mid s)=\frac{e^{f(s,a\mid\theta)}}{\sum_{a^{\prime}\in\mathcal{%
A}}e^{f\left(s,a^{\prime}\mid\theta\right)}}
N_{rollouts}
l
\pi_{\theta_{b}}
{\epsilon}
R
len(R)>R_{max}
=1,...,\mathcal{G}
r
R
Q_{retrace}(s,a)
(s,a)\in r
\theta^{Q}_{Loss}\leftarrow\sum_{(s,a)\in r}(Q_{retrace}(s,a)-Q_{\theta^{Q}}(s%
,a))^{2}
\theta_{Loss}\leftarrow D_{KL}\left(\pi_{m}(\cdot\mid s)\mid\pi_{\hat{\theta}}%
(\cdot\mid s\right)
Q(s,a\mid\theta^{Q})
\nabla_{\theta^{Q}}\theta^{Q}_{Loss}
f(s,a\mid\theta^{b})
\nabla_{\theta}\theta_{Loss}
\theta^{Q^{\prime}}\leftarrow\tau_{Q}\theta^{Q}+(1-\tau_{Q})\theta^{Q^{\prime}}
\theta\leftarrow\tau_{\theta}\theta^{b}+(1-\tau_{\theta})\theta
