encoder:X\mapsto Z
f:Z\mapsto C
VQ:C\mapsto Q
decoder:Q\mapsto Y
D
K
S
H
D
i
i
N
\boldsymbol{x}
\boldsymbol{z}=encoder(\boldsymbol{x})
\boldsymbol{c}=f(\boldsymbol{z})
\boldsymbol{c}
\boldsymbol{q}=VQ(\boldsymbol{c})
\boldsymbol{\hat{y}}=decoder(\boldsymbol{q})
t
t
G
V
d
\boldsymbol{c}
\boldsymbol{\rm l}\in\mathbb{R}^{G\times V}
v
g
\overline{p}_{g,v}=\frac{\exp(\overline{l}_{g,v}+n_{v})/\tau}{\sum_{k=1}^{V}%
\exp(\overline{l}_{g,k}+n_{k})/\tau},
\tau
n_{v}=-\log(-\log(u))
u
i
i={\rm argmax}_{v}p_{g,v}
\boldsymbol{\rm l}
L_{d}
L_{d}=\frac{1}{GV}\sum_{g=1}^{G}\sum_{v=1}^{V}\overline{p}_{g,v}\log\overline{%
p}_{g,v}.
L_{\rm total}
L_{\rm se}
L_{d}
L_{\rm total}=L_{\rm se}+\lambda L_{d},
\lambda
L_{\rm se}
\ell_{1}
L_{\rm se}
L_{\rm se}=\frac{1}{T}\left(\left\|\boldsymbol{y}-\boldsymbol{\hat{y}}\right\|%
_{1}+\sum_{i=1}^{M}L_{\rm stft}^{(i)}(\boldsymbol{y},\boldsymbol{\hat{y}})%
\right),
\displaystyle L_{\rm stft}(\boldsymbol{y},\boldsymbol{\hat{y}})=L_{\rm sc}(%
\boldsymbol{y},\boldsymbol{\hat{y}})+L_{\rm mag}(\boldsymbol{y},\boldsymbol{%
\hat{y}}),
\displaystyle L_{\rm stft}(\boldsymbol{y},\boldsymbol{\hat{y}})
\displaystyle=L_{\rm sc}(\boldsymbol{y},\boldsymbol{\hat{y}})+L_{\rm mag}(%
\boldsymbol{y},\boldsymbol{\hat{y}}),
\displaystyle L_{\rm sc}(\boldsymbol{y},\boldsymbol{\hat{y}})=\frac{\left\||{%
\rm STFT}(\boldsymbol{y})|-|{\rm STFT}(\boldsymbol{\hat{y}})|\right\|_{F}}{%
\left\|{\rm STFT}(\boldsymbol{y})\right\|_{F}},
\displaystyle L_{\rm sc}(\boldsymbol{y},\boldsymbol{\hat{y}})
\displaystyle=\frac{\left\||{\rm STFT}(\boldsymbol{y})|-|{\rm STFT}(%
\boldsymbol{\hat{y}})|\right\|_{F}}{\left\|{\rm STFT}(\boldsymbol{y})\right\|_%
{F}},
\displaystyle L_{\rm mag}(\boldsymbol{y},\boldsymbol{\hat{y}})=\frac{1}{T}%
\left\|\log|{\rm STFT}(\boldsymbol{y})|-\log|{\rm STFT}(\boldsymbol{\hat{y}})|%
\right\|_{1}.
\displaystyle L_{\rm mag}(\boldsymbol{y},\boldsymbol{\hat{y}})
\displaystyle=\frac{1}{T}\left\|\log|{\rm STFT}(\boldsymbol{y})|-\log|{\rm STFT%
}(\boldsymbol{\hat{y}})|\right\|_{1}.
M
\|\cdot\|
L_{\rm stft}^{(i)}
\in
D
N
H
G
V
\lambda
2\times 10^{-4}
V
