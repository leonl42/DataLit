1)
2)
1)
2)
3)
M
I
T
f_{s}(\cdot;\mathbf{w}):\mathbb{R}^{n}\rightarrow\mathbb{R}^{d}
\mathbf{w}
n
d
p\in[I]
\mathcal{I}_{p}=\left\{\left(x_{p}^{k},y_{p}^{k}\right)\right\}_{k=1}^{|%
\mathcal{I}_{p}|}
x_{p}^{k}
k
p
y_{p}^{k}
q\in[T]
\mathcal{T}_{q}=\left\{\left(x_{q}^{k},y_{q}^{k}\right)\right\}_{k=1}^{|%
\mathcal{T}_{q}|}
m\in[M]
\mathcal{M}_{m}=\left\{\left(i_{m}^{k},t_{m}^{k}\right)\right\}_{k=1}^{|%
\mathcal{M}_{m}|}
(i_{m}^{k},t_{m}^{k})
k
\mathcal{P}=\left\{\left({i}^{(k)},t^{(k)}\right)\right\}_{k=1}^{|\mathcal{P}|}
\left(i^{(k)},t^{(k)}\right)
f_{c}(\cdot;\mathbf{w}_{c}):\mathbb{R}^{n}\rightarrow\mathbb{R}^{d}
d
1)
2)
c
c
{\bm{t}}^{(j)}_{\rm global}\in\mathbb{R}^{d},j=1,\dots,|\mathcal{P}|
k
i^{(k)}
c
{\bm{i}}_{\rm local}^{(k)}\in\mathbb{R}^{d}
{\bm{i}}_{\rm local}^{(k)}
1)
2)
{\bm{i}}_{\rm local}^{(k)}
{\bm{t}}^{(k)}_{\rm global}
{\bm{t}}^{(j)}_{\rm global},j=1,\dots,|\mathcal{P}|,\neq k
\ell_{\rm inter}^{(k)}=-\log\frac{\exp\left({{\bm{i}}_{\rm local}^{(k)}}^{\!\!%
\top}\cdot{\bm{t}}_{\rm global}^{(k)}\right)}{\sum_{j=1}^{|\mathcal{P}|}\exp%
\left({{\bm{i}}_{\rm local}^{(k)}}^{\top}\cdot{\bm{t}}_{\rm global}^{(j)}%
\right)}
\triangleright
\mathcal{P}
T
C
E
f_{s}
f_{c}
\mathcal{D}_{c}
c
p
\mathbf{w}^{T}
t=0,1,\dots,T-1
{\bm{I}}_{\rm glob},{\bm{T}}_{\rm glob}
\leftarrow f_{s}(\mathcal{P};\mathbf{w}^{t})
{\bm{I}}_{\rm local},{\bm{T}}_{\rm local}\leftarrow
S_{t}\leftarrow
\max(p\cdot C,1)
c
S_{t}
{\bm{I}}_{\rm glob},{\bm{T}}_{\rm glob}
c
{\bm{I}}_{c},{\bm{T}}_{c}\leftarrow
c
t
{\bm{I}}_{\rm glob}
{\bm{T}}_{\rm glob}
{\bm{I}}_{\rm local},{\bm{T}}_{\rm local}\leftarrow{\bm{I}}_{\rm local}+{\bm{I%
}}_{c},\ {\bm{T}}_{\rm local}+{\bm{T}}_{c}
\mathbf{w}^{t}
\mathcal{P}
{\bm{I}},{\bm{T}}\leftarrow
{\bm{I}}_{\rm local},{\bm{T}}_{\rm local}
{\bm{I}}_{\rm glob},{\bm{T}}_{\rm glob}
\mathbf{w}^{t+1}\leftarrow\mathbf{w}^{t}
{\bm{I}},{\bm{T}}
c
t
{\bm{I}}_{\rm glob}
{\bm{T}}_{\rm glob}
i=0,1,\dots,E-1
\mathbf{w}_{c}^{(t,i+1)}\leftarrow\mathbf{w}_{c}^{(t,i)}-\eta_{c}\nabla%
\mathcal{L}_{\rm local}^{(c)}(\mathcal{D}_{c},{\bm{I}}_{\rm glob},{\bm{T}}_{%
\rm glob};\mathbf{w}_{c}^{(t,i)})
{\bm{I}}_{c},{\bm{T}}_{c}\leftarrow f_{c}(\mathcal{P};\mathbf{w}_{c}^{(t,E)})
{\bm{I}}_{c},{\bm{T}}_{c}
c
{\bm{i}}_{\rm global}^{(j)},j=1,\dots,|\mathcal{P}|
k
{\bm{i}}_{\rm local}^{(k)}
{\bm{i}}_{\rm global}^{(k)}
{\bm{i}}_{\rm local}^{(k)}
{\bm{i}}_{\rm prev}^{(k)}
\ell_{\rm intra}^{(k)}=-\log\frac{\exp\left({{\bm{i}}_{\rm local}^{(k)}}^{\!\!%
\top}\cdot{\bm{i}}_{\rm global}^{(k)}\right)}{\exp\left({{\bm{i}}_{\rm local}^%
{(k)}}^{\!\!\top}\cdot{\bm{i}}_{\rm global}^{(k)}\right)+\exp\left({{\bm{i}}_{%
\rm local}^{(k)}}^{\!\!\top}\cdot{\bm{i}}_{\rm prev}^{(k)}\right)}
c
\mathcal{L}_{\rm local}^{(c)}=\frac{1}{|\mathcal{I}_{c}|}\sum_{k}\ell(x_{c}^{k%
},y_{c}^{k};\mathbf{w}_{c})+\gamma\cdot\frac{1}{|\mathcal{P}|}\left(\sum_{k}%
\ell_{\rm inter}^{(k)}+\sum_{k}\ell_{\rm intra}^{(k)}\right)
\ell(x_{c}^{k},y_{c}^{k};\mathbf{w}_{c})
\gamma
k
\left(i^{(k)},t^{(k)}\right)
\mathcal{P}
{\bm{i}}^{(j)}_{\rm global},{\bm{t}}^{(j)}_{\rm global}\in\mathbb{R}^{d},j=1,%
\dots,|\mathcal{P}|
k
{\bm{i}}_{\rm local}^{\left(k,c\right)},c\in[C=I+M]
(k,c)
k
c
{\bm{i}}_{\rm local}^{\left(k,c\right)}
{\bm{t}}^{(k)}_{\rm global}
{\bm{t}}^{(j)}_{\rm global},j\neq k
s^{(k,c)}=\log\frac{\exp\left({{\bm{i}}_{\rm local}^{(k,c)}}^{\!\!\top}\cdot{%
\bm{t}}_{\rm global}^{(k)}\right)}{\sum_{j=1}^{|\mathcal{P}|}\bm{1}_{[j\neq k]%
}\exp\left({{\bm{i}}_{\rm local}^{(k,c)}}^{\top}\cdot{\bm{t}}_{\rm global}^{(j%
)}\right)}
{\bm{t}}_{\rm global}^{(k)}
{\bm{t}}_{\rm global}^{(j)}
\rm softmax
{\bm{i}}_{\rm local}^{\left(k,c\right)}
\displaystyle\alpha^{(k,1)},\alpha^{(k,2)},\dots,\alpha^{(k,C)}={\mathrm{%
softmax}}(s^{(k,1)},s^{(k,2)},\dots,s^{(k,C)})
\displaystyle\alpha^{(k,1)},\alpha^{(k,2)},\dots,\alpha^{(k,C)}
\displaystyle={\mathrm{softmax}}(s^{(k,1)},s^{(k,2)},\dots,s^{(k,C)})
\displaystyle{\bm{i}}^{(k)}=\sum_{c}\alpha^{(k,c)}\cdot{\bm{i}}^{(k,c)}_{\rm
local}
\displaystyle{\bm{i}}^{(k)}
\displaystyle=\sum_{c}\alpha^{(k,c)}\cdot{\bm{i}}^{(k,c)}_{\rm local}
\ell_{2}
f(i^{(k)};\mathbf{w})
{\bm{i}}^{(k)}
\mathbf{w}:=\mathbf{w}-\alpha\cdot\frac{1}{|\mathcal{P}|}\sum_{k=1}^{|\mathcal%
{P}|}\nabla\left\|f(i^{(k)};\mathbf{w})-{\bm{i}}^{(k)}\right\|_{2}
\alpha
1)
2)
\alpha
1)
2)
3)
4)
5)
6)
7)
d
1)
2)
3)
