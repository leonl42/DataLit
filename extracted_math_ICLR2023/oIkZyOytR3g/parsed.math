-1
-10
(S,A,p,r)
S
A
p
r
\{s_{t},a_{t},r_{t}\}_{t=0}^{T}
s_{t}
a_{t}
r_{t}
t
T
\tau=(R_{t-K+1},s_{t-K+1},a_{t-K+1},\cdots,\\
R_{t-1},s_{t-1},a_{t-1},R_{t},s_{t}).
K
R
R_{t}=\sum_{t^{\prime}=t}^{T}r_{t^{\prime}}
s
a
a_{t}
\mu(a|s)
\hat{Q}^{k+1}\leftarrow\\
\arg\min_{Q}\alpha\left(\mathbb{E}_{s\sim\mathcal{D},a\sim\mu(a|s)}[Q(s,a)]-%
\mathbb{E}_{s,a\sim\mathcal{D}}[Q(s,a)]\right)\\
+\frac{1}{2}\mathbb{E}_{\footnotesize\begin{matrix}s,a,s^{\prime}\sim\mathcal{%
D}\\
a^{\prime}\sim\mu(a^{\prime}|s^{\prime})\end{matrix}}\left[\left(r(s,a)+\gamma%
\hat{Q}^{k}(s^{\prime},a^{\prime})-Q(s,a)\right)^{2}\right],
\mathcal{D}
\gamma
\hat{Q}^{\mu}:=\lim_{k\rightarrow\infty}\hat{Q}^{k}
V(s)
\mathbb{E}_{\mu(a|s)}[\hat{Q}^{\mu}(s,a)]\leq V^{\mu}(s)
R_{t-1}=r_{t-1}+R_{t}
R_{T}=0
\hat{V}(s_{t})=\mathbb{E}_{a\sim\pi(a|s_{t})}[\hat{Q}(s_{t},a)]
\pi
\hat{V}(s_{t})
R_{t}
R_{t-1}
r_{t-1}+\hat{V}(s_{t})
r_{t-1}+R_{t}
R_{t}=r_{t}+R_{t+1}
\{\hat{R}_{t-K+1},\cdots,\hat{R}_{t-1},\hat{R}_{t}\}
\hat{R}_{t}=R_{t}
\hat{R}_{t^{\prime}}=r_{t}^{\prime}+\hat{R}_{t^{\prime}+1}
t^{\prime}=t-K+1
r_{1:T}
\hat{V}(s)
T
R_{1:T}
R_{T}\leftarrow 0
\tau\leftarrow T
\tau>0
R_{\tau-1}\leftarrow r_{\tau-1}+\max(R_{\tau},\hat{V}(s_{\tau}))
\tau\leftarrow\tau-1
r_{t-K+1:t}
t
R_{t}
K
\hat{R}_{1:T}
\hat{R}_{t}\leftarrow R_{t}
\tau\leftarrow t-1
\tau>t-K
\hat{R}_{\tau}\leftarrow r_{\tau}+\hat{R}_{\tau+1}
\tau\leftarrow\tau-1
s_{t}
a_{t}
Q^{*}(s_{t},a_{t})
\arg\max_{a}Q^{*}(s_{t},a)
s_{t}
\max_{a}Q^{*}(s_{t},a)
Q^{*}(s,a)
Q^{*}(s,a)
\textbf{40.0}\pm 0.0
15.9\pm 4.4
\textbf{42.2}\pm 6.3
\mathbf{216.7}\pm 80.7
196.4\pm 39.6
190.1\pm 37.8
\mathbf{94.7}\pm 23.1
31.0\pm 21.3
57.3\pm 8.2
\mathbf{41.8}\pm 13.6
8.2\pm 4.4
13.3\pm 5.6
\mathbf{49.6}\pm 8.4
2.3\pm 0.9
31.0\pm 19.8
307.6\pm 43.5
346.2\pm 14.3
\mathbf{325.7}\pm 61.4
\mathbf{72.7}\pm 10.1
-6.8\pm 10.9
58.6\pm 3.3
\mathbf{70.9}\pm 9.2
31.5\pm 3.7
42.3\pm 7.1
\mathbf{90.9}\pm 19.4
45.3\pm 11.2
62.2\pm 9.9
23.3\pm 1.0
5.2
\mathbf{57.3}\pm 2.4
60.7\pm 4.5
50.7\pm 5.0
1.0\pm 1.0
-
42.2\pm 0.2
-
\mathbf{42.4}\pm 0.5
0.0\pm 0.4
-
\mathbf{69.9}\pm 2.0
-
63.7\pm 6.4
7.7\pm 5.9
2.0
\mathbf{50.8}\pm 14.3
78.5\pm 3.7
38.7\pm 26.7
7.8\pm 6.9
-
\mathbf{33.0}\pm 4.8
-
32.8\pm 7.3
3.2\pm 1.7
-
\mathbf{51.6}\pm 24.6
-
29.6\pm 15.5
\mathbf{69.4}\pm 13.1
64.6
60.3\pm 5.5
67.6\pm 1.0
66.5\pm 6.3
\mathbf{49.2}\pm 0.5
49.1
42.1\pm 0.5
42.1\pm 0.1
42.3\pm 0.4
\mathbf{83.0}\pm 0.6
82.9
73.3\pm 2.5
74.0\pm 1.4
67.1\pm 3.2
\mathbf{96.2}\pm 7.9
97.8
63.7\pm 12.2
82.7\pm 7.0
52.1\pm 20.3
\mathbf{49.8}\pm 0.5
47.3
34.1\pm 1.1
36.6\pm 0.8
35.6\pm 0.5
\mathbf{76.5}\pm 21.1
86.1
60.2\pm 13.9
66.6\pm 3.0
58.2\pm 5.1
X
X
X=0
X=40
50
60-50\%
\gamma=0.99
\gamma
\begin{split}R_{\tau-1}&\leftarrow r_{\tau-1}+\gamma\max(R_{\tau},\hat{V}(s_{%
\tau}))\\
\hat{R}_{\tau}&\leftarrow r_{\tau}+\gamma\hat{R}_{\tau+1}\end{split}
\gamma=0.99
\gamma=0.999
\gamma=0.99
\gamma=0.999
\gamma=0.99
\gamma=0.999
\mathbf{94.7}\pm 23.1
31.0\pm 21.3
57.3\pm 8.2
82.9\pm 8.8
41.8\pm 13.6
8.2\pm 4.4
13.3\pm 5.6
\mathbf{48.5}\pm 9.4
49.6\pm 8.4
2.3\pm 0.9
31.0\pm 19.8
\mathbf{62.0}\pm 13.4
\gamma
\gamma
\gamma
\gamma
\alpha
\alpha
29.6\pm 15.5
46.9\pm 13.8
\begin{split}trajectory1=[&s_{0}{=}S,a_{0}{=}up,r_{0}{=}{-}1,\\
&s_{1}{=}1,a_{1}{=}down,r_{1}{=}{-}1,\\
&s_{2}{=}2,a_{2}{=}right,r_{2}{=}{-}1,\\
&s_{3}{=}G,a_{3}{=}\text{N/A},r_{3}{=}0]\\
trajectory2=[&s_{0}{=}S,a_{0}{=}right,r_{0}{=}{-}11,\\
&s_{1}{=}2,a_{1}{=}down,r_{1}{=}{-}10,\\
&s_{2}{=}F,a_{2}{=}\text{N/A},r_{2}{=}0].\end{split}
r_{t}
R_{t}=\sum_{\tau=0}^{T}r_{\tau},
R_{t}
t
T
\begin{split}trajectory1=[&s_{0}{=}S,a_{0}{=}up,r_{0}{=}{-}1,R_{0}{=}{-}3,\\
&s_{1}{=}1,a_{1}{=}down,r_{1}{=}{-}1,R_{1}{=}{-}2,\\
&s_{2}{=}2,a_{2}{=}right,r_{2}{=}{-}1,R_{2}{=}{-}1,\\
&s_{3}{=}G,a_{3}{=}\text{N/A},r_{3}{=}0,R_{3}{=}0]\\
trajectory2=[&s_{0}{=}S,a_{0}{=}right,r_{0}{=}{-}1,R_{0}{=}{-}11,\\
&s_{1}{=}2,a_{1}{=}down,r_{1}{=}{-}10,R_{1}{=}{-}10,\\
&s_{2}{=}F,a_{2}{=}\text{N/A},r_{2}{=}0,R_{2}{=}0].\end{split}
[s_{t},R_{t}]
a_{t}
K=1
t=0
a=up
[s{=}S,R{=}{-}3]
a=right
[s{=}S,R{=}{-}11]
-2
t=0
[s{=}S,R{=}{-}2]
[s{=}S,R{=}{-}2]
[s{=}S,R{=}{-}3]
[s{=}S,R{=}{-}11]
a=up
a=right
=100-10*5
=100-10*5
=100-10*5
\alpha
K
\alpha
\alpha=10.0
\alpha=5.0
\alpha=10.0
\alpha=5.0
\alpha
\alpha
\alpha=10.0
\alpha=5.0
\alpha=2.5
\alpha=1.25
68.7\pm 16.4
72.5\pm 9.5
\mathbf{83.6}\pm 3.8
48.9\pm 2.4
51.8\pm 2.4
\mathbf{57.0}\pm 1.1
83.3\pm 0.5
\mathbf{86.2}\pm 0.5
43.5\pm 43.6
\mathbf{95.4}\pm 11.6
87.5\pm 24.7
90.7\pm 14.5
49.9\pm 2.9
51.8\pm 2.7
\mathbf{54.3}\pm 0.2
\mathbf{88.9}\pm 3.7
50.6\pm 36.3
16.8\pm 14.2
\alpha
\alpha
\alpha=10.0
\alpha=5.0
\alpha=2.5
\alpha=1.25
\mathbf{68.6}\pm 7.5
65.3\pm 1.3
57.5\pm 6.6
\mathbf{42.2}\pm 0.5
\mathbf{42.2}\pm 0.05
42.1\pm 0.4
65.9\pm 3.6
\mathbf{70.1}\pm 2.4
68.8\pm 6.9
55.3\pm 28.0
40.2\pm 5.9
\mathbf{64.0}\pm 22.9
\mathbf{35.7}\pm 0.6
35.5\pm 0.4
33.0\pm 0.5
59.1\pm 2.8
\mathbf{64.3}\pm 5.9
45.2\pm 39.5
\alpha=10.0
\alpha=1.0
\alpha=1.0
\alpha
\alpha
\alpha=10.0
\alpha=2.0
\alpha=1.0
27.3\pm 12.2
66.1\pm 9.8
\mathbf{96.0}\pm 32.2
-3.5\pm 1.3
\mathbf{36.6}\pm 3.7
35.9\pm 15.3
-2.5\pm 0.0
40.8\pm 6.0
\mathbf{53.2}\pm 7.0
V^{*}(s_{t})
\hat{V}(s_{t})
R_{t}
\hat{V}(s_{t})>R_{t}
\hat{V}(s_{t})
R_{t}
\begin{split}\hat{V}(s_{t})&>R_{t}\\
V^{*}(s_{t})-\hat{V}(s_{t})&<V^{*}(s_{t})-R_{t}.\end{split}
\hat{V}(s_{t})
V^{*}(s_{t})
V^{*}(s_{t})\geq\hat{V}(s_{t})
|V^{*}(s_{t})-\hat{V}(s_{t})|<|V^{*}(s_{t})-R_{t}|.
\hat{V}(s_{t})
R_{t}
42.2\pm 6.3
29.7\pm 13.8
65.3\pm 2.0
65.7\pm 3.9
42.2\pm 2.3
42.4\pm 0.1
71.3\pm 2.4
80.2\pm 10.8
35.0\pm 24.2
23.0\pm 5.0
