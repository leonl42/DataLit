\triangleright
\triangleright
c
\alpha
\beta
\operatorname{supp}(\alpha)=\operatorname{supp}(\beta)=\mathbb{R}^{n}
\breve{T}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
\breve{T}\in\operatorname*{arg\,inf}_{T\in{\mathcal{T}}(\alpha,\beta)}\mathop{%
\mathbb{E}}_{x\sim\alpha}\|x-T(x)\|^{2}_{2},
{\mathcal{T}}(\alpha,\beta)\vcentcolon=\{T:T_{\#}\alpha=\beta\}
\#
T_{\#}\alpha(B)\vcentcolon=\alpha(T^{-1}(B))
\alpha
T
B
\breve{T}
{\mathcal{T}}
f:\mathbb{R}^{n}\rightarrow\mathbb{R}
\invbreve{f}\in\operatorname*{arg\,sup}_{f\in L^{1}(\alpha)}\;-\mathop{\mathbb%
{E}}_{x\sim\alpha}[f(x)]-\mathop{\mathbb{E}}_{y\sim\beta}[f^{\star}(y)]
L^{1}(\alpha)
\alpha
f^{\star}
f
f^{\star}(y)\vcentcolon=-\inf_{x\in{\mathcal{X}}}J_{f}(x;y)\quad\text{with %
objective}\quad J_{f}(x;y)\vcentcolon=f(x)-\langle x,y\rangle.
\breve{x}(y)
L^{1}(\alpha)
\invbreve{f}
\invbreve{f}
\breve{T}
\breve{T}(x)=\nabla_{x}\invbreve{f}(x)
\breve{T}^{-1}(y)=\nabla_{y}\invbreve{f}^{\star}(y)
f
f
f
f_{\theta}
\theta
\max_{\theta}{\mathcal{V}}(\theta)\quad\text{where}\quad{\mathcal{V}}(\theta)%
\vcentcolon=-\mathop{\mathbb{E}}_{x\sim\alpha}[f_{\theta}(x)]-\mathop{\mathbb{%
E}}_{y\sim\beta}[f_{\theta}^{\star}(y)]=-\mathop{\mathbb{E}}_{x\sim\alpha}[f_{%
\theta}(x)]+\mathop{\mathbb{E}}_{y\sim\beta}\left[J_{f_{\theta}}(\breve{x}(y))%
\right],
J
\breve{x}(y)
\sup
\max
\nabla_{\theta}{\mathcal{V}}
\displaystyle\nabla_{\theta}{\mathcal{V}}(\theta)=\nabla_{\theta}\left[-%
\mathop{\mathbb{E}}_{x\sim\alpha}[f_{\theta}(x)]+\mathop{\mathbb{E}}_{y\sim%
\beta}\left[J_{f_{\theta}}(\breve{x}(y))\right]\right]
\displaystyle\nabla_{\theta}{\mathcal{V}}(\theta)
\displaystyle=\nabla_{\theta}\left[-\mathop{\mathbb{E}}_{x\sim\alpha}[f_{%
\theta}(x)]+\mathop{\mathbb{E}}_{y\sim\beta}\left[J_{f_{\theta}}(\breve{x}(y))%
\right]\right]
\displaystyle=-\mathop{\mathbb{E}}_{x\sim\alpha}[\nabla_{\theta}f_{\theta}(x)]%
+\mathop{\mathbb{E}}_{y\sim\beta}[\nabla_{\theta}f_{\theta}(\breve{x}(y))]
\displaystyle=-\mathop{\mathbb{E}}_{x\sim\alpha}[\nabla_{\theta}f_{\theta}(x)]%
+\mathop{\mathbb{E}}_{y\sim\beta}[\nabla_{\theta}f_{\theta}(\breve{x}(y))]
\breve{x}(y)
\operatorname*{arg\,min}
f
f
f
\alpha
\beta
f^{\star}
\beta
{\mathcal{V}}
\breve{x}
J(\breve{x}(y);y)\leq J(x;y)
x
f_{\theta}
\tilde{x}_{\phi}(y)
\textsc{conjugate}(f,y,x_{\rm init}=\tilde{x}_{\phi}(y))
y\sim\beta
{\mathcal{V}}
\tilde{x}_{\varphi}(y)
\varphi
\tilde{x}_{\phi}(y)\approx\breve{x}(y)
y\sim\beta
\tilde{x}_{\varphi}(y)
y\sim\beta
\tilde{x}_{\varphi}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
\tilde{x}_{\varphi}(y)\approx\breve{x}(y)
\tilde{x}_{\varphi}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
\tilde{x}_{\varphi}=\nabla_{y}g_{\varphi}
g_{\varphi}:\mathbb{R}^{n}\rightarrow\mathbb{R}
g_{\varphi}
g_{\varphi}
\operatorname*{arg\,min}
\breve{x}(y)=\nabla_{y}f^{\star}(y)
\alpha
\beta
f_{\theta}
\tilde{x}_{\varphi}
\{x_{j}\}\sim\alpha
\{y_{j}\}\sim\beta
j\in[N]
\tilde{x}_{\varphi}(y_{j})
\breve{x}(y_{j})=\textsc{conjugate}(f,y_{j},x_{\rm init}=\tilde{x}_{\varphi}(y%
_{j}))
\nabla_{\theta}{\mathcal{V}}
\nabla_{\varphi}{\mathcal{L}}
f_{\theta}
\tilde{x}_{\varphi}
\propto\|\nabla J_{f}(x)\|_{2}^{2}
J_{f}(x;y)
\|x-x^{\star}(y)\|_{2}^{2}
x^{\star}(y)
\tilde{x}_{\varphi}
\varphi
J_{f}
\beta
\min_{\varphi}{\mathcal{L}}_{\rm obj}(\varphi)\;\text{where}\;{\mathcal{L}}_{%
\rm obj}(\varphi)\vcentcolon=\mathop{\mathbb{E}}_{y\sim\beta}J_{f}(\tilde{x}_{%
\varphi}(y);y).
{\mathcal{L}}_{\rm obj}
\nabla_{\varphi}{\mathcal{L}}_{\rm obj}
{\mathcal{V}}
\theta
f_{\theta}
{\mathcal{L}}_{\rm obj}
\varphi
\tilde{x}_{\varphi}\vcentcolon=\nabla g_{\varphi}
\breve{x}
\tilde{x}_{\varphi}
\max_{\theta}\min_{\varphi}{\mathcal{V}}_{\rm MM}(\theta,\varphi)\;{\rm where}%
\;{\mathcal{V}}_{\rm MM}(\theta,\varphi)\vcentcolon=-\mathop{\mathbb{E}}_{x%
\sim\alpha}[f_{\theta}(x)]+\mathop{\mathbb{E}}_{y\sim\beta}[J_{f_{\theta}}(%
\tilde{x}_{\varphi}(y);y)].
{\mathcal{V}}_{\rm MM}
\theta
{\mathcal{V}}_{\rm MM}(\theta,\varphi)
{\mathcal{V}}(\theta)
\tilde{x}_{\varphi}=\breve{x}
\nabla_{\varphi}{\mathcal{V}}_{\rm MM}(\theta,\varphi)=\nabla_{\varphi}{%
\mathcal{L}}_{\rm obj}(\varphi)=\nabla_{\varphi}J_{f_{\theta}}(\tilde{x}_{%
\varphi}(y);y)
{\mathcal{V}}(\theta)
\nabla_{x}J_{f}(x;y)=\nabla_{x}f(x)-y=0
\min_{\varphi}{\mathcal{L}}_{\rm cycle}(\varphi)\;\text{where}\;{\mathcal{L}}_%
{\rm cycle}(\varphi)\vcentcolon=\mathop{\mathbb{E}}_{y\sim\beta}\|\nabla_{x}J_%
{f}(\tilde{x}_{\varphi}(y);y)\|_{2}^{2}=\mathop{\mathbb{E}}_{y\sim\beta}\|%
\nabla_{x}f(\tilde{x}_{\varphi}(y))-y\|_{2}^{2}.
{\mathcal{V}}
\theta
f_{\theta}
{\mathcal{L}}_{\rm cycle}
\varphi
\tilde{x}_{\varphi}\vcentcolon=\nabla g_{\varphi}
f_{\theta}
f_{\theta}
\tilde{x}_{\varphi}
\tilde{x}_{\varphi}
f_{\theta}
f_{\theta}
\min_{\varphi}{\mathcal{L}}_{\rm reg}(\varphi)\;\text{where}\;{\mathcal{L}}_{%
\rm reg}(\varphi)\vcentcolon=\mathop{\mathbb{E}}_{y\sim\beta}\|\tilde{x}_{%
\varphi}(y)-\breve{x}(y)\|_{2}^{2}.
{\mathcal{L}}_{\rm reg}
J
x\leftarrow x_{\rm init}
x
\nabla_{x}J_{f}(x;y)
\breve{x}(y)=x
\textsc{conjugate}(f,y,x_{\rm init})
\textsc{conjugate}(f,y,x_{\rm init})
f
{\mathcal{L}}^{2}
T
T^{\star}
{\mathcal{L}}^{2}\text{-UVP}(T;\alpha,\beta)\vcentcolon=100\cdot\|T-T^{\star}%
\|^{2}_{{\mathcal{L}}^{2}(\alpha)}/\mathrm{Var}(\beta)\%.
{\mathcal{L}}^{2}
{\mathcal{L}}^{2}
{\mathcal{L}}^{2}
{\mathcal{L}}^{2}
{\mathcal{L}}^{2}
{\mathcal{L}}^{2}
n=2
n=4
n=8
n=16
n=32
n=64
n=128
n=256
n=2
n=4
n=8
n=16
n=32
n=64
n=128
n=256
0.28
\pm 0.09
0.90
\pm 0.11
2.23
\pm 0.20
3.03
\pm 0.06
5.32
\pm 0.14
8.79
\pm 0.16
5.66
\pm 0.45
4.34
\pm 0.14
0.27
\pm 0.09
0.78
\pm 0.12
1.78
\pm 0.26
2.00
\pm 0.11
0.26
\pm 0.09
0.77
\pm 0.11
1.63
\pm 0.28
1.15
\pm 0.14
2.02
\pm 0.10
4.48
\pm 0.89
1.65
\pm 0.10
5.93
\pm 9.43
0.26
\pm 0.09
0.79
\pm 0.12
1.63
\pm 0.30
1.12
\pm 0.11
1.92
\pm 0.19
4.40
\pm 0.79
1.64
\pm 0.11
2.24
\pm 0.13
0.26
\pm 0.09
0.78
\pm 0.12
1.64
\pm 0.29
1.14
\pm 0.12
1.93
\pm 0.20
4.41
\pm 0.74
1.69
\pm 0.11
2.21
\pm 0.15
0.26
\pm 0.09
0.79
\pm 0.11
1.62
\pm 0.29
1.14
\pm 0.12
1.95
\pm 0.21
4.55
\pm 0.62
1.88
\pm 0.26
0.26
\pm 0.09
0.79
\pm 0.14
1.62
\pm 0.31
1.08
\pm 0.14
1.89
\pm 0.19
4.23
\pm 0.76
1.59
\pm 0.12
1.99
\pm 0.15
0.35
\pm 0.07
0.81
\pm 0.12
1.61
\pm 0.32
1.09
\pm 0.11
1.85
\pm 0.20
4.42
\pm 0.68
1.63
\pm 0.08
1.99
\pm 0.16
n=2
n=4
n=8
n=16
n=32
n=64
n=128
n=256
0.05
\pm 0.00
0.35
\pm 0.01
1.51
\pm 0.08
0.03
\pm 0.00
0.22
\pm 0.01
0.60
\pm 0.03
0.80
\pm 0.11
2.09
\pm 0.31
2.08
\pm 0.40
0.67
\pm 0.05
0.59
\pm 0.04
0.03
\pm 0.00
0.22
\pm 0.01
0.61
\pm 0.04
0.77
\pm 0.10
1.97
\pm 0.38
2.08
\pm 0.39
0.67
\pm 0.05
0.65
\pm 0.07
0.18
\pm 0.03
0.69
\pm 0.56
1.62
\pm 2.82
0.06
\pm 0.01
0.26
\pm 0.02
0.63
\pm 0.07
0.81
\pm 0.10
1.99
\pm 0.32
2.21
\pm 0.32
0.77
\pm 0.05
0.66
\pm 0.07
0.22
\pm 0.01
0.28
\pm 0.02
0.61
\pm 0.07
0.80
\pm 0.10
2.07
\pm 0.38
2.37
\pm 0.46
0.77
\pm 0.06
0.75
\pm 0.09
{\bf 3.3}
{\bf 3.1}
{\bf 3.0}
{\bf 1.8}
{\bf 2.7}
{\bf 1.5}
{\bf 3.0}
{\bf 4.4}
{\mathcal{L}}^{2}
{\mathcal{L}}^{2}
26.50
\pm 60.14
0.29
\pm 0.59
0.29
\pm 0.15
0.69
\pm 0.90
0.65
\pm 0.02
0.21
\pm 0.00
0.11
\pm 0.04
0.62
\pm 0.01
0.20
\pm 0.00
0.09
\pm 0.00
0.65
\pm 0.02
0.21
\pm 0.00
0.11
\pm 0.05
0.61
\pm 0.01
0.20
\pm 0.00
0.09
\pm 0.00
0.66
\pm 0.01
0.21
\pm 0.00
0.12
\pm 0.00
0.62
\pm 0.01
0.20
\pm 0.00
0.09
\pm 0.01
{\bf 2.3}
{\bf 2.0}
{\bf 2.4}
\beta
\beta
\alpha
(\nabla f^{\star})_{\#}\beta\approx\alpha
(12228)^{10}
c
(\nabla f)_{\#}\alpha
(\nabla f^{\star})_{\#}\beta
f
f^{*}
{\mathcal{G}}
\leftarrow((1-t)I+t\nabla f^{\star})_{\#}{\mathcal{G}}\rightarrow
(\nabla f^{\star})_{\#}{\mathcal{G}}
{\mathcal{G}}
\nabla f^{\star}
{\mathcal{G}}
\nabla f^{\star}
y
\breve{x}(y)
J(x;y)
\nabla_{y}f^{\star}(y)=\breve{x}(y)
J
J(x;y)
J(y;y)
J(x;y)
\nabla_{y}f^{\star}(y)=\breve{x}(y)
J
J(x;y)
J(y;y)
\beta
(\nabla f^{\star})_{\#}\beta
\leftarrow((1-t)I+t\nabla f^{\star})_{\#}\beta\rightarrow
J
x_{0}
B_{0}
k\leftarrow 0
p_{k}=-B_{k}^{-1}\nabla_{x}J_{k}(x_{k})
x_{k+1}=x_{k}+\alpha_{k}p_{k}
\alpha_{k}
B_{k}
k\leftarrow k+1
x_{k}\approx\breve{x}
\alpha
g(\alpha)
g(\alpha)\geq 0
\alpha^{\star}
\alpha
g(\alpha)
\alpha^{\star}
\breve{x}\in\operatorname*{arg\,min}_{x}J(x)
J:\mathbb{R}^{n}\rightarrow\mathbb{R}
\breve{x}
B_{k}\approx\nabla^{2}J(x_{k})
p_{k}=-B_{k}^{-1}\nabla_{x}J_{k}(x_{k})
x_{k+1}=x_{k}+\alpha_{k}p_{k}
\alpha_{k}
B_{k+1}=B_{k}-\dfrac{B_{k}s_{s}s_{k}^{\top}B_{k}}{s_{k}^{\top}B_{k}s_{k}}+%
\dfrac{y_{k}y_{k}^{\top}}{y_{k}^{\top}s_{k}},
y_{k}=\nabla_{x}J(x_{k+1})-\nabla_{x}J(x_{k})
s_{k}=x_{k+1}-x_{k}
B_{k}
H_{k}\vcentcolon=B_{k}^{-1}
H_{k}
[y_{k},s_{k}]
H_{k}
n\times n
x_{k}
p_{k}
\tau
c_{1}
\alpha_{0}
\alpha\leftarrow\alpha_{\rm init}
J(x_{k}+\alpha_{j}p_{k})>J(x_{k})+c_{1}\alpha_{j}p_{k}^{\top}\nabla_{x}J(x_{k})
\alpha\leftarrow\tau\alpha
\alpha
x_{k}
p_{k}
\tau
c_{1}
\alpha_{0}
M
\alpha_{m}=\tau^{-m}
m\in[M]
g(\alpha_{m})
g(\alpha_{m})<0
\alpha
\max\alpha_{m}\ \operatorname*{subject\;to}\ g(\alpha_{m})>0
\alpha_{k}
x_{k+1}=x_{k}+\alpha_{k}p_{k}
\displaystyle J(x_{k}+\alpha_{k}p_{k})\leq J(x_{k})+c_{1}\alpha_{k}p_{k}^{\top%
}\nabla_{x}J(x_{k})
\displaystyle J(x_{k}+\alpha_{k}p_{k})
\displaystyle\leq J(x_{k})+c_{1}\alpha_{k}p_{k}^{\top}\nabla_{x}J(x_{k})
\displaystyle-p_{x}^{\top}\nabla_{x}J(x_{k}+\alpha_{x}p_{x})\leq-c_{2}p_{x}^{%
\top}\nabla_{x}J(x_{k})
\displaystyle-p_{x}^{\top}\nabla_{x}J(x_{k}+\alpha_{x}p_{x})
\displaystyle\leq-c_{2}p_{x}^{\top}\nabla_{x}J(x_{k})
0<c_{1}<c_{2}<1
\displaystyle J(x_{k}+\alpha_{k}p_{k})\leq J(x_{k})+c_{1}\alpha_{k}p_{k}^{\top%
}\nabla_{x}J(x_{k})
\displaystyle J(x_{k}+\alpha_{k}p_{k})
\displaystyle\leq J(x_{k})+c_{1}\alpha_{k}p_{k}^{\top}\nabla_{x}J(x_{k})
\displaystyle|p_{x}^{\top}\nabla_{x}J(x_{k}+\alpha_{x}p_{x})|\leq c_{2}|p_{x}^%
{\top}\nabla_{x}J(x_{k})|
\displaystyle|p_{x}^{\top}\nabla_{x}J(x_{k}+\alpha_{x}p_{x})|
\displaystyle\leq c_{2}|p_{x}^{\top}\nabla_{x}J(x_{k})|
J(x_{k}+\alpha_{k}p_{k})\leq J(x_{k})+c_{1}\alpha_{k}p_{k}^{\top}\nabla_{x}J(x%
_{k}).
g(\alpha)\vcentcolon=f(x_{k})+c_{1}\alpha p_{k}^{\top}\nabla f(x_{k})-f(x_{k}+%
\alpha p_{k})\geq 0
y_{k}^{\top}s_{k}>0
y_{k}^{\top}s_{k}>0
\alpha_{k}(x_{k},p_{k})=\max\alpha\quad\operatorname*{subject\;to}\quad J(x_{k%
}+\alpha p_{k})\leq J(x_{k})+c_{1}\alpha p_{k}^{\top}\nabla_{x}J(x_{k}).
\tau
\alpha
J
\alpha_{m}
g(\alpha_{m})\geq 0
N
M
NM
M
M=10
\breve{x}
\|\nabla J(\breve{x})\|_{\infty}\leq 0.1
c_{1}=10^{-4}
c_{2}=0.9
\tau=2/3
M=15
\breve{x}
\|\nabla J(\breve{x})\|_{\infty}\leq 0.1
c_{1}=10^{-4}
c_{2}=0.9
\tau=2/3
M=15
4803.40
6.21
156.69
8.56
119.41
8.56
776.52
7.78
233.39
7.97
225.30
8.65
154.90
8.58
\approx\!30
50
\nabla_{x}f_{\theta}(x)\approx x
\tilde{x}_{\varphi}(y)\approx y
\tilde{x}_{\varphi}
f_{\theta}
f_{\theta}
f_{\theta}
\mathop{\mathbb{E}}_{x\sim\alpha}f_{\theta}(x)
\mathop{\mathbb{E}}_{y\sim\beta}f_{\theta}(\breve{x}(y))
\breve{x}
x\sim\alpha
\tau=1.5
M=10
\beta=[0.9,0.999]
10^{-5}
D
D
f_{\theta}
f_{\theta}
\max(2D,64)
\max(2D,64)
\max(D,32)
\tilde{x}_{\varphi}
\alpha
\beta
f_{\theta}
\tilde{x}_{\varphi}=\nabla g_{\varphi}
\alpha
\beta
\approx\!10
50
\approx\!2
3
{\mathcal{L}}^{2}
10^{9}
n=64
n=128
n=256
n=64
n=128
n=256
n=64
n=128
n=256
y
\breve{x}(y)
J(x;y)
\nabla_{y}f^{\star}(y)=\breve{x}(y)
J
J(x;y)
J(y;y)
J(x;y)
\nabla_{y}f^{\star}(y)=\breve{x}(y)
J
J(x;y)
J(y;y)
\tau=1.5
M=30
f_{\theta}
f_{\theta}
\tilde{x}_{\varphi}
\alpha
\beta
\breve{T}(x)=\nabla_{x}\invbreve{f}(x)
f^{\star}
\beta
(\nabla f^{\star})_{\#}\beta
\leftarrow((1-t)I+t\nabla f^{\star})_{\#}\beta\rightarrow
\beta
(\nabla f^{\star})_{\#}\beta
\leftarrow((1-t)I+t\nabla f^{\star})_{\#}\beta\rightarrow
