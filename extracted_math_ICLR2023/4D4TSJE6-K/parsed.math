100
80
k
\beta
100
80
k
k
100
x\in\mathcal{X}
\mathcal{E}:\mathcal{Y}\rightarrow\mathcal{Z}
y\in\mathcal{Y}
z^{*}\in\mathcal{Z}
\mathcal{E}(y)=z^{*}
x
y^{*}
P_{\theta}
(x,y^{*})
\mathcal{L}_{\mbox{MLE}}(x,y^{*},P_{\theta})=-\log P_{\theta}(y^{*}|x)
y^{*}
y^{*}
x
\hat{y}
y^{*}
\hat{z}=z^{*}
\hat{y}^{\prime}
\hat{y}^{\prime}_{\leq 5}
\hat{s}^{\prime}_{5}
s^{*}_{5}
y^{*}
y^{*}
P_{\theta}(y|x)
\mathcal{E}:\mathcal{Y}\rightarrow\mathcal{Z}
(x,y^{*},z^{*})
\mathcal{B}
x
|\mathcal{B}|=0
\mathcal{B}\leftarrow\mathcal{B}+\{y^{*}\}
\hat{Y}\leftarrow\textit{SampleSolutions}(x,P_{\theta},\mathcal{B})
\hat{y}
\hat{Y}
\hat{z}\leftarrow\mathcal{E}(\hat{y})
\textit{isCorrect}(\hat{z},z^{*})
\textit{isDuplicate}(\hat{y},\mathcal{B})
\mathcal{B}\leftarrow\mathcal{B}+\hat{y}
\theta\xleftarrow{\text{update}}\nabla_{\theta}\mathcal{L}(x,\mathcal{B},P_{%
\theta})
x
\mathcal{B}
\mathcal{B}
x
(x,y^{*},z^{*})
\hat{Y}=\{\hat{y}_{i}\}_{i=1}^{n}\sim P_{\theta}(\hat{y}|x)
\hat{Y}
\hat{Y}
\hat{Y}^{*}=\{\hat{y}|\hat{y}\in\hat{Y};\mathcal{E}(\hat{y})=z^{*}\}
y^{*}
\mathcal{L}(x,\mathcal{B},P_{\theta})
\nabla_{\theta}(x,\mathcal{B},P_{\theta})
-\log P_{\theta}(y^{*}|x)
-\nabla_{\theta}\log P_{\theta}(y^{*}|x)
-\sum_{\hat{y}\in\mathcal{B}}\log P_{\theta}(\hat{y}|x)
-\sum_{\hat{y}\in\mathcal{B}}\nabla_{\theta}\log P_{\theta}(\hat{y}|x)
-\log\sum_{\hat{y}\in\mathcal{B}}P_{\theta}(\hat{y}|x)
-\sum_{\hat{y}\in\mathcal{B}}\frac{P_{\theta}(\hat{y}|x)}{\sum_{\tilde{y}\in%
\mathcal{B}}P_{\theta}(\tilde{y}|x)}\nabla_{\theta}\log P_{\theta}(\hat{y}|x)
\beta
-\frac{1}{\beta}\log\sum_{y}P_{\theta}(\hat{y}|x)^{\beta}
-\sum_{\hat{y}\in\mathcal{B}}\frac{P_{\theta}(\hat{y}|x)^{\beta}}{\sum_{\tilde%
{y}\in\mathcal{B}}P_{\theta}(\tilde{y}|x)^{\beta}}\nabla_{\theta}\log P_{%
\theta}(\hat{y}|x)
\mathcal{B}
\mathcal{B}=\{y^{*}\}
\mathcal{B}
\mathcal{B}=\{y^{*}\}
\mathcal{B}
P_{\theta}(y|x)
Q(y|x)=\frac{1}{|\mathcal{B}|}\cdot\mathbbm{1}_{\mathcal{B}}(y)
\mathbbm{1}(\cdot)
P_{\theta}(z^{*}|x)
\mathcal{B}
\hat{y}\in\mathcal{B}
P_{\theta}(\hat{y}|x)
\mathcal{B}
\beta
\beta
\beta
\beta\in(0,1]
\beta=1
\beta\rightarrow 0
y_{\leq i}
y_{>i}
y_{\leq i}||y_{>i}
y=(u_{1},...,u_{t})
u_{i}
i
s_{i}
i
y_{\leq i}=(u_{1},...,u_{i})
y_{\leq i}
s_{i}
y_{\leq i}
y^{\prime}_{\leq j}
s_{i}=s^{\prime}_{j}
y_{\leq i}
y^{*}_{\leq j}
\mathcal{B}
\textit{PartiallyCorrect}(y_{\leq i})\Longleftrightarrow\exists y^{*}\in%
\mathcal{B}.~{}~{}\exists j\leq|y^{*}|~{}s.t.~{}s^{*}_{j}=s_{i}
x
\hat{y}\sim P_{\theta}(\hat{y}|x)
y^{0}
\mathcal{B}
\textit{SampleSolutions}(x,P_{\theta},\mathcal{B})
P_{\theta}(y|x)
x
\mathcal{B}
\hat{Y}
\hat{y}_{\leq i}\in\mathcal{B}\setminus\{\hat{y}|\mathcal{E}(\hat{y})=z^{*}\}
Y_{p}\sim P_{\theta}(\hat{y}_{>i}|\hat{y}_{\leq i},x)
\hat{Y}\leftarrow\{[\hat{y}_{\leq i}||\hat{y}_{>i}]\}_{\hat{y}_{>i}\in Y_{p}}
\hat{Y}
\hat{y}
z^{*}
\hat{y}_{\leq i}
\rightarrow
\hat{y}_{\leq i}
\mathcal{B}
\hat{y}
\mathcal{B}
\hat{y}
y_{\leq i}
y_{>i}
P_{\theta}(y_{\leq i}|x)
y_{>i}
\triangleright
\triangleright
k
k
k
k
k
k
1
k
k
k
100
\beta=0.25
\beta
100
\beta=0.25
\beta
k
k
k
100
80
1
k
k
\beta
k
k
1
80
80
k
k
\beta=0.25
\beta
\{0.1,0.25,0.5,0.9\}
k
n
T=0.8
n=80
n=100
n
\{5,10,20,50\}
n
T=0.2
k
|\hat{Y}|=1
T=0.8
1
100
1
100
{}^{\dagger}~{}
\mathbf{\mathcal{B}}
\mathbf{k}
k
k
k
k
k
k
\beta
\beta
\beta=0.25
\beta
\beta=0.25
\beta
100
k
k
1
\mathcal{B}
\mathcal{B}=\{y^{0},y^{*}\}
(s^{*}_{1},s^{*}_{2},...,s^{*}_{t})
s_{i}^{*}=\mathcal{T}(y_{\leq i})
\mathcal{M}=\{s_{i}^{*}\rightarrow\{y_{\leq i}\}\}_{i=1}^{t}
P_{\theta}(y|x)
(x,y^{*},z^{*})
\mathcal{T}:\mathcal{Y}\rightarrow\mathcal{S}
\hat{Y}\leftarrow\textit{SampleSolutions}(x,P_{\theta},\mathcal{B})
\hat{y}
\hat{Y}
i\leftarrow|\hat{y}|
i\neq 0
i\leftarrow i-1
s_{i}\leftarrow\mathcal{T}(\hat{y}_{\leq i})
\hat{y}_{\leq i}
\textit{PartialCorrectnessCriteria}(s_{i},\mathcal{M})
Y_{S}\leftarrow\mathcal{M}(s_{i})
s_{i}
\textit{isDuplicate}(\hat{y}_{\leq i},Y_{S})
\mathcal{B}\leftarrow\textit{updateBuffer}(\hat{y}_{\leq i},\mathcal{B})
\mathcal{M}\leftarrow\textit{updateMapping}(\hat{y}_{\leq i},\mathcal{M})
\theta\xleftarrow{\text{update}}\nabla_{\theta}\mathcal{L}(x,\mathcal{B},P_{%
\theta})
\triangleright
\mathcal{M}
\mathcal{M}:\mathcal{S}\rightarrow\mathcal{Y}^{n}
\triangleright
\textit{PartialCorrectnessCriteria}(s_{i},\mathcal{M})
\mathcal{M}
\hat{y}_{\leq i}
s_{i}\in\mathcal{M}
\triangleright
\textit{isDuplicate}(\hat{y}_{\leq i},Y_{S})
\mathcal{B}
Y_{S}
\triangleright
\textit{updateBuffer}(\hat{y}_{\leq i},\mathcal{B})
\mathcal{B}
\hat{y}_{\leq i}
\triangleright
\textit{updateMapping}(\hat{y}_{\leq i},\mathcal{M})
\hat{y}_{\leq i}
\mathcal{M}
\mathcal{M}
k
k
k
1
5
k
k
k
k
k
\{5,10,20\}
\{50,100\}
k
k
1
k
k
1
\{5,10,20\}
k
k
100
k
k
\{50,100\}
