q_{i}
x_{i}^{+}
x_{i}^{-}
q_{i}
q_{i}
x_{i}^{+}
x_{i}^{-}
p^{+}_{i}
p^{-}_{i}
x_{i}^{+}
x_{i}^{-}
0
1
\tilde{p}_{i}=0.5\cdot(p_{i}^{+}+(1-p_{i}^{-}))
q_{i}
x_{i}^{+}
x_{i}^{-}
q_{i}
q_{i}
x_{i}^{+}
x_{i}^{-}
p^{+}_{i}
p^{-}_{i}
x_{i}^{+}
x_{i}^{-}
0
1
\tilde{p}_{i}=0.5\cdot(p_{i}^{+}+(1-p_{i}^{-}))
q_{1},\ldots,q_{n}
q_{i}
q_{i}
\phi(x)\in\mathbb{R}^{d}
x
q_{1},\ldots,q_{n}
\phi(\cdot)
q_{i}
x_{i}^{+}
x_{i}^{-}
\phi(x_{i}^{+})
\phi(x_{i}^{-})
p_{i}^{+}
p_{i}^{-}
q_{1},\ldots,q_{n}
\phi(\cdot)
\phi(\cdot)
\phi(\cdot)
q_{1},\ldots,q_{n}
q_{1},\ldots,q_{n}
\phi(\cdot)
q_{i}
q_{i}
q_{i}
q_{i}
q_{i}
x_{i}^{+}
x_{i}^{-}
x_{i}^{+}
x_{i}^{-}
x_{i}^{+}
q_{i}
x_{i}^{-}
q_{i}
(x_{i}^{+},x_{i}^{-})
\phi(x_{i}^{+})
\phi(x_{i}^{-})
\phi(\cdot)
\phi(x_{i}^{+})
\phi(x_{i}^{-})
x_{i}^{+}
x_{i}^{-}
x_{i}^{+}
x_{i}^{-}
\{\phi(x_{i}^{+})\}
\{\phi(x_{i}^{-})\}
\tilde{\phi}(x)
\tilde{\phi}(x_{i}^{+}):=\phi(x_{i}^{+})-\mu^{+}\,;\quad\tilde{\phi}(x_{i}^{-}%
):=\phi(x_{i}^{-})-\mu^{-},
\mu^{+},\mu^{-}\in\mathbb{R}^{d}
\{\phi(x_{i}^{+})\}_{i=1}^{n}
\{\phi(x_{i}^{-})\}_{i=1}^{n}
\{\tilde{\phi}(x_{i}^{+})\}
\{\tilde{\phi}(x_{i}^{-})\}
p_{\theta,b}(\tilde{\phi})
\tilde{\phi}(x)
0
1
x
\sigma(\cdot)
p_{\theta,b}(\tilde{\phi})=\sigma(\theta^{T}\tilde{\phi}+b)
\theta,b
p
1
L_{\text{consistency}}(\theta,b;q_{i}):=\left[p_{\theta,b}(x_{i}^{+})-(1-p_{%
\theta,b}(x_{i}^{-}))\right]^{2}
p(x^{+})=p(x^{-})=0.5
L_{\text{confidence}}(\theta,b;q_{i}):=\min\{p_{\theta,b}(x_{i}^{+}),p_{\theta%
,b}(x_{i}^{-})\}^{2}
L_{\text{confidence}}
L_{\text{CCS}}(\theta,b):=\frac{1}{n}\sum_{i=1}^{n}L_{\text{consistency}}(%
\theta,b;q_{i})+L_{\text{confidence}}(\theta,b;q_{i})
L_{\text{confidence}}
p(x_{i}^{+})
1-p(x_{i}^{-})
q_{i}
x_{i}
\tilde{p}(q_{i}):=\frac{1}{2}(p(x_{i}^{+})+(1-p(x_{i}^{-}))
q_{i}
\tilde{p}(q_{i})
0.5
\tilde{p}(q_{i})>0.5
L_{\text{CCS}}
10
60\%
40\%
50/50
(\tilde{\phi}(x^{+}),\tilde{\phi}(x^{-}))
0.01
l_{+}
l_{-}
l_{+}>l_{-}
l_{+}>l_{-}+\gamma
\gamma\in\mathbb{R}
5\%
8
13
9
x_{i}^{+}
q_{i}
x_{i}^{-}
q_{i}
71.2\%
67.2\%
2\%
0.3\%
77.6\%\rightarrow 84.8\%
80.4\%
70.9\%
9.5\%
82.1\%\rightarrow 83.8\%
71.8\%
0.6\%
81.0\%
73.5\%
k
k
32
k=1,2,4,\cdots
32
k
k
k
k
x^{+}_{i}
x^{-}_{i}
\tilde{\phi}(x_{i}^{+})
\tilde{\phi}(x_{i}^{-})
\{\tilde{\phi}(x_{i}^{+})-\tilde{\phi}(x_{i}^{-})\}_{i=1}^{n}
0
\{\tilde{\phi}(x_{i}^{+})-\tilde{\phi}(x_{i}^{-})\}_{i=1}^{n}
q_{1},\ldots,q_{n}
x
x^{\prime}
x\wedge x^{\prime}
x\vee x^{\prime}
9.5\%
1.7\%
9.5\%
1.7\%
100
100
100
100
100
x^{+}
93.7\%
94\%
x^{+}
x^{-}
l_{pos}^{+}-l_{neg}^{+}
x^{+}
l_{pos}^{-}-l_{neg}^{-}
x^{-}
(l_{pos}^{+}-l_{neg}^{+})-(l_{pos}^{-}-l_{neg}^{-})
71.6\%
94\%
\#\text{Samples}=1,8,64
1,8,64
1,8,64
1,8,64
1,8,64
\tilde{\phi}(x_{i}^{+})=\phi(x_{i}^{+})-\mu^{+}
\mu^{+}
\{\phi(x_{i}^{+})\}_{i=1}^{n}
\tilde{\phi}(x_{i}^{-})
\{\phi(x_{i}^{+})\}_{i=1}^{n}
\sqrt{d}
\tilde{\phi}(x_{i}^{-})
x^{+}
x^{-}
S
\mathbf{m}=\text{transformers.AutoModel}(\text{mdl})
\mathbf{t}=\text{transformers.AutoTokenizer}(\text{mdl})
\mathcal{C}^{+},C^{-}=[],[]
(x^{+},x^{-})\textbf{ in }S
{}^{-}=\mathbf{t}
(x^{+})
\mathbf{t}
(x^{-})
\phi^{+}=m(\text{token}^{+},\text{output\_hiddenstates = True})\text{[``hidden%
\_states'']}[\text{idx}][-1]
\phi^{-}=m(\text{token}^{-},\text{output\_hiddenstates = True})\text{[``hidden%
\_states'']}[\text{idx}][-1]
\mathcal{C}^{+}\text{.append}(\phi^{+}),\mathcal{C}^{-}\text{.append}(\phi^{-})
[\mathcal{C}^{+},\mathcal{C}^{-}]
\theta
b
L_{CCS}(\theta,b)
b
1
\theta
d+1
\theta
T=10
E=1000
\eta=0.01
\mathcal{C}=\{\tilde{\phi}(x_{i}^{+})-\tilde{\phi}(x_{i}^{-})\}_{i=1}^{n}
0
0
0
0
\displaystyle L(\theta)=\frac{\text{var}\{\theta^{T}c_{i}|\theta^{T}c_{i}<0\}+%
\text{var}\{\theta^{T}c_{i}|\theta^{T}c_{i}\geq 0\}}{\text{var}\{\theta^{T}c_{%
i}\}}
\displaystyle L(\theta)=\frac{\text{var}\{\theta^{T}c_{i}|\theta^{T}c_{i}<0\}+%
\text{var}\{\theta^{T}c_{i}|\theta^{T}c_{i}\geq 0\}}{\text{var}\{\theta^{T}c_{%
i}\}}
c_{i}:=\tilde{\phi}(x_{i}^{+})-\tilde{\phi}(x_{i}^{-})
\text{var}\{z_{i}\}
\{z_{i}\}_{i=1}^{n}\subset\mathbb{R}
L(\theta)
T
\theta
E
\theta
\theta
\theta
T
S_{1},...,S_{n}
T=E=20
0.1
40\%
1000
500
9
10
5
180
3800
9
5
\frac{1}{2\sqrt{3800}}\approx 0.8\%
W=\frac{\mu_{0}-\hat{\mu}}{se(\hat{\mu})^{2}}\geq\frac{\mu_{0}-\hat{\mu}}{(0.0%
08)^{2}}
\mu_{0}
\hat{\mu}
W
\chi^{2}
\displaystyle x^{+}=\text{[prefix] Q: Is the sentiment of ``[text]'' [label0] %
or [label1]? A: [label0]}
\displaystyle x^{+}
\displaystyle=\text{[prefix] Q: Is the sentiment of ``[text]'' [label0] or [%
label1]? A: [label0]}
\displaystyle x^{-}=\text{[prefix] Q: Is the sentiment of ``[text]'' [label0] %
or [label1]? A: [label1]}
\displaystyle x^{-}
\displaystyle=\text{[prefix] Q: Is the sentiment of ``[text]'' [label0] or [%
label1]? A: [label1]}
\displaystyle x^{+}=\text{Q: Is the sentiment of ``I loved this movie.'' %
positive or negative? A: positive}
\displaystyle x^{+}
\displaystyle=\text{Q: Is the sentiment of ``I loved this movie.'' positive or%
 negative? A: positive}
\displaystyle x^{-}=\text{Q: Is the sentiment of ``I loved this movie.'' %
positive or negative? A: negative}
\displaystyle x^{-}
\displaystyle=\text{Q: Is the sentiment of ``I loved this movie.'' positive or%
 negative? A: negative}
\mathcal{C}
500
500
x^{+}
x^{-}
x^{+}
x^{-}
x^{+}
x^{-}
x^{+}
x^{-}
x^{+}
x^{-}
x^{+}
x^{-}
