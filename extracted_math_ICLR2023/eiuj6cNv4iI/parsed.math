\times
q
T_{q}
q
\Theta
\displaystyle T_{q}^{*}=\arg\max p(T_{q}|q,\Theta).
\displaystyle T_{q}^{*}=\arg\max p(T_{q}|q,\Theta).
\Theta
\Theta
\theta
\gamma
V
C
C
\theta
\gamma
\Theta=(\theta,\gamma)
T_{q}
n
(t_{1},\cdots,t_{n})
V=(v_{1},\cdots,v_{k})\in C
t
V
V^{\tau}
t^{\leftarrow{V^{\tau}}}
\displaystyle T_{q}^{*}=(t_{1}^{\leftarrow{V^{\tau_{1}}}},\cdots,t_{n}^{%
\leftarrow{V^{\tau_{n}}}})=\operatorname*{arg\,max}p(T_{q}|q,\theta,\gamma),%
\quad\gamma:=V\in C.
\displaystyle T_{q}^{*}=(t_{1}^{\leftarrow{V^{\tau_{1}}}},\cdots,t_{n}^{%
\leftarrow{V^{\tau_{n}}}})=\operatorname*{arg\,max}p(T_{q}|q,\theta,\gamma),%
\quad\gamma:=V\in C.
\theta
V^{\tau}=\emptyset
q
\gamma
T^{*}_{q}
>0.3
>256
\displaystyle P_{\text{ST}}=\frac{|({\mathcal{Q}}\cup{\mathcal{T}})\cap{%
\mathcal{V}}-{\mathcal{S}}|}{|{\mathcal{T}}-{\mathcal{S}}|},
\displaystyle P_{\text{ST}}=\frac{|({\mathcal{Q}}\cup{\mathcal{T}})\cap{%
\mathcal{V}}-{\mathcal{S}}|}{|{\mathcal{T}}-{\mathcal{S}}|},
{\mathcal{Q}}
q
{\mathcal{T}}
t^{\leftarrow{V^{\tau}}}
V^{\tau}
{\mathcal{V}}
V^{\tau}
{\mathcal{S}}
t
V^{\tau}
P_{\text{ST}}>\rho
P_{\text{ST}}
\text{stride}=1,\text{max\_length}=256
P_{\text{ST}}
q
V
C
T_{q}
P_{\text{ST}}
V
C
s=(w_{1},\cdots,w_{n})
{\mathbf{s}}\in\mathbb{R}^{|D|}
|D|=30522
{\mathbf{s}}
({\mathbf{h}}_{1},\cdots,{\mathbf{h}}_{n})
\displaystyle{\mathbf{w}}_{i}=\mathbf{E}\mathbf{W}{\mathbf{h}}_{i}^{\top}+{%
\mathbf{b}},\quad i\in[1,n],\quad{\mathbf{s}}=\max\limits_{i\in[1,n]}\log(1+%
\text{ReLU}({\mathbf{w}}_{i})),
\displaystyle{\mathbf{w}}_{i}=\mathbf{E}\mathbf{W}{\mathbf{h}}_{i}^{\top}+{%
\mathbf{b}},\quad i\in[1,n],\quad{\mathbf{s}}=\max\limits_{i\in[1,n]}\log(1+%
\text{ReLU}({\mathbf{w}}_{i})),
\mathbf{W}\in\mathbb{R}^{768\times 768}
{\mathbf{b}}\in\mathbb{R}^{|D|}
\mathbf{E}\in\mathbb{R}^{768\times|D|}
q
d
g(q,d)
{\mathbf{s}}_{q}
{\mathbf{s}}_{d}
q
d^{+}
d^{-}
\displaystyle{\mathbf{P}}(q,d^{+},{{\mathcal{D}}})=\frac{{\mathbf{e}}^{f(q,d^{%
+})}}{{\mathbf{e}}^{f(q,d^{+})}+\sum_{d^{-}\in{{\mathcal{D}}}}{{\mathbf{e}}}^{%
f(q,d^{-})}},
\displaystyle{\mathbf{P}}(q,d^{+},{{\mathcal{D}}})=\frac{{\mathbf{e}}^{f(q,d^{%
+})}}{{\mathbf{e}}^{f(q,d^{+})}+\sum_{d^{-}\in{{\mathcal{D}}}}{{\mathbf{e}}}^{%
f(q,d^{-})}},
{\mathcal{D}}
d^{-}
\lambda_{q}
\lambda_{d}
\displaystyle\mathcal{L}=\mathcal{L}_{\texttt{{rank}}}+\lambda_{q}\mathcal{L}_%
{\texttt{L1}}+\lambda_{d}\mathcal{L}_{\texttt{FLOPS}}.
\displaystyle\mathcal{L}=\mathcal{L}_{\texttt{{rank}}}+\lambda_{q}\mathcal{L}_%
{\texttt{L1}}+\lambda_{d}\mathcal{L}_{\texttt{FLOPS}}.
\lambda_{q}
\mathcal{L}_{\texttt{FLOPS}}
\lambda_{d}
(d_{m},d_{n})
|D|
({\mathbf{s}}_{m},{\mathbf{s}}_{n})
\displaystyle d_{T}(d_{m},d_{n})=\texttt{distance}({\mathbf{s}}_{m},{\mathbf{s%
}}_{n})=\frac{|{{\mathbf{s}}^{\prime}_{m}-{\mathbf{s}}^{\prime}_{n}}|}{|{%
\mathbf{s}}^{\prime}_{m}|+|{\mathbf{s}}^{\prime}_{n}|},\quad{\mathbf{s}}^{%
\prime}[s_{j}>\mu]=1,\quad j\in|D|,
\displaystyle d_{T}(d_{m},d_{n})=\texttt{distance}({\mathbf{s}}_{m},{\mathbf{s%
}}_{n})=\frac{|{{\mathbf{s}}^{\prime}_{m}-{\mathbf{s}}^{\prime}_{n}}|}{|{%
\mathbf{s}}^{\prime}_{m}|+|{\mathbf{s}}^{\prime}_{n}|},\quad{\mathbf{s}}^{%
\prime}[s_{j}>\mu]=1,\quad j\in|D|,
{\mathbf{s}}=(s_{1},\cdots,s_{j})
{\mathbf{s}}^{\prime}
{\mathbf{s}}
\mu
(d_{m},d_{n})
d_{T}\to 0
d_{T}\to 1
k
(d_{1},\cdots,d_{k})
d_{i}
d_{T}(d_{1},d_{i})>0.9,i\in[2,k]
d_{i}
d_{T}(d_{i},d_{j})<0.1,j\in[1,i-1]
q
k
\{v_{1},v_{2},\cdots,v_{k}\}
\displaystyle x_{i}=\texttt{[query]}q\texttt{[ref\_i]}v_{i}.
\displaystyle x_{i}=\texttt{[query]}q\texttt{[ref\_i]}v_{i}.
\displaystyle{\mathbf{h}}_{i}=\texttt{Encoder}(x_{i}),\quad i=1,2,\cdots,k.
\displaystyle{\mathbf{h}}_{i}=\texttt{Encoder}(x_{i}),\quad i=1,2,\cdots,k.
T^{*}
\displaystyle T^{*}\sim\texttt{Decoder}(T^{*},{\mathbf{h}})=\prod_{n=1}^{|T^{*%
}|}p(T^{*}|T^{*}_{<n},{\mathbf{h}}),
\displaystyle T^{*}\sim\texttt{Decoder}(T^{*},{\mathbf{h}})
\displaystyle=\prod_{n=1}^{|T^{*}|}p(T^{*}|T^{*}_{<n},{\mathbf{h}}),
\displaystyle{\mathbf{h}}=[{\mathbf{h}}_{1};{\mathbf{h}}_{2};\cdots;{\mathbf{h%
}}_{k}].
\displaystyle{\mathbf{h}}
\displaystyle=[{\mathbf{h}}_{1};{\mathbf{h}}_{2};\cdots;{\mathbf{h}}_{k}].
\displaystyle{\mathcal{L}}_{\text{NLL}}(x,T^{*})=-\sum_{n=1}^{|T^{*}|}\log p(T%
^{*}_{n}|T^{*}_{<n},x).
\displaystyle{\mathcal{L}}_{\text{NLL}}(x,T^{*})=-\sum_{n=1}^{|T^{*}|}\log p(T%
^{*}_{n}|T^{*}_{<n},x).
\langle
\rangle
n
0\to 5
(\lambda_{q},\lambda_{d})
P_{\text{ST}}
\displaystyle P_{r}=\frac{1}{n}\sum\frac{|{\mathcal{T}}\cap{\mathcal{V}}-S|}{|%
{\mathcal{V}}-{\mathcal{S}}|},
\displaystyle P_{r}=\frac{1}{n}\sum\frac{|{\mathcal{T}}\cap{\mathcal{V}}-S|}{|%
{\mathcal{V}}-{\mathcal{S}}|},
n
{\mathcal{T}}
{\mathcal{V}}
{\mathcal{S}}
n
n
n
