\mathbf{x}
\mathbf{x}^{+}
\mathbf{x}^{-}
E=\textit{max}\{0,g+\lVert\hat{\mathbf{y}}_{\mathbf{x}}-\hat{\mathbf{y}}_{%
\mathbf{x}^{+}}\rVert_{2}-\lVert\hat{\mathbf{y}}_{\mathbf{x}}-\hat{\mathbf{y}}%
_{\mathbf{x}_{-}}\rVert_{2}\}
\hat{\mathbf{y}}_{\mathbf{x}}
\hat{\mathbf{y}}_{\mathbf{x^{-}}}
\hat{\mathbf{y}}_{\mathbf{x^{+}}}
\mathbf{x},\mathbf{x}_{-},\mathbf{x}_{+}
g
l_{2}
\mathcal{X}
N
d
M
\mathcal{C}_{1},\mathcal{C}_{2},\cdots,\mathcal{C}_{M}
M
K
\mathbf{c}_{m}(1)
\mathbf{c}_{m}(2)
\ldots
\mathbf{c}_{m}(K)\in\mathbb{R}^{d/M}
i_{m}(\cdot)\,:\,\mathbb{R}^{d/M}\,\to\,[K]
[K]
\{1,\,2,\,3,\,\ldots,\,K\}
\mathbf{x}\mapsto(i_{1}(\mathbf{x}),\cdots,i_{M}(\mathbf{x}))
q_{m}
q_{m}(\mathbf{x})=\mathbf{c}_{m}(i(\mathbf{x}))
m
\mathbf{x}
q(\mathbf{x})
E=\frac{1}{N}\sum_{\mathbf{x}\in\mathcal{X}}||\mathbf{x}-[q_{1}(\mathbf{x}),%
\cdots,q_{M}(\mathbf{x})]^{T}||^{2}.
M
\mathbf{q}
M
\mathbf{q}=[\mathbf{q}_{1}^{\top},\,\cdots,\,\mathbf{q}_{M}^{\top}]^{\top}
\lVert\mathbf{q}_{m}-\mathbf{c}_{m}(k)\rVert^{2}
k\in[K]
m\in[M]
\mathbf{x}\in\mathcal{X}
\mathbf{q}
\mathbf{x}
(M-1)
M
\lVert\mathbf{q}-\mathbf{x}\rVert^{2}\approx\sum_{m=1}^{M}\lVert\mathbf{q}_{m}%
-\mathbf{c}_{m}(i_{m}(\mathbf{x}))\rVert^{2}
E(\cdot)
Q(\mathbf{y})=\lVert\mathbf{y}-q(\mathbf{y})\rVert^{2}
E^{\prime}(\mathbf{y})=E(\mathbf{y})+\lambda Q(\mathbf{y})
\begin{split}\frac{\partial E^{\prime}(\mathbf{y})}{\partial\mathbf{y}}&=\frac%
{\partial E(\mathbf{y})}{\partial\mathbf{y}}+\lambda\frac{\partial Q(\mathbf{y%
})}{\partial\mathbf{y}}\\
&=\frac{\partial E(\mathbf{y})}{\partial\mathbf{y}}+2\lambda(\mathbf{y}-q(%
\mathbf{y}))\\
&=\frac{\partial E(\mathbf{y})}{\partial\mathbf{y}}+2\lambda\epsilon_{\mathbf{%
y}}\end{split}
\epsilon_{\mathbf{y}}
\mathbf{y}
\mathcal{C}
\mathcal{C}
\partial E/\partial\mathbf{y}
\Delta\mathbf{c}
\partial E/\partial\mathbf{y}
\Delta\mathbf{c}
l_{2}
\begin{split}&E^{\prime}(\mathbf{y})=\lambda_{1}E(\mathbf{y})+\lambda_{2}%
\lVert\mathbf{y}-\mathbf{c}\rVert^{2},\\
&\text{s.t. }\text{arg}\max_{\mathbf{c}\in\mathcal{C}}(\frac{\partial E(%
\mathbf{y})}{\partial\mathbf{y}})^{T}\frac{\partial E^{\prime}(\mathbf{y})}{%
\partial\mathbf{y}}\cdot f(\lVert\mathbf{c}-\mathbf{y}\rVert^{2})\end{split}
f(\cdot)\in\mathbb{R}^{+}
\mathbf{y}
f\left(d\right)=e^{-d^{2}/\sigma}
\sigma
l_{2}
\mathbf{y}
\mathbf{c}=q(\mathbf{y})
\mathbf{y}
\frac{\partial E}{\partial\mathbf{y}}
\mathbf{c}\in\mathcal{C}
\mathbf{y}
\begin{split}&\arg\max_{\mathbf{c}}(\frac{\partial E}{\partial\mathbf{y}})^{T}%
\cdot\Delta\mathbf{c},\quad\\
&\text{where}\quad\Delta\mathbf{c}=f(\lVert\mathbf{c}-\mathbf{y}\rVert^{2})%
\frac{(\mathbf{c}-\mathbf{y})}{\lVert\mathbf{c}-\mathbf{y}\rVert}\end{split}
\Delta\mathbf{y}
\mathbf{c}
\begin{split}\Delta\mathbf{y}&=\lambda_{1}\frac{\partial E}{\partial\mathbf{y}%
}+\lambda_{2}\Delta\mathbf{c},\\
\text{where }&\lambda_{1}=(1-\frac{((\frac{\partial E}{\partial\mathbf{y}})^{T%
}\Delta\mathbf{c})^{2}}{\lVert\Delta\mathbf{c}\rVert^{2}\lVert\frac{\partial E%
}{\partial\mathbf{y}}\rVert})\lambda,\\
&\lambda_{2}=\frac{(\frac{\partial E}{\partial\mathbf{y}})^{T}\Delta\mathbf{c}%
}{\lVert\Delta\mathbf{c}\rVert}\end{split}
\lambda_{2}
\mathbf{c}
\lambda_{1}
\lambda_{2}\Delta\mathbf{c}
\lambda
\mathcal{C}
\mathcal{C}
256\times 256
32\times 32
28\times 28
l_{1}
l_{2}
\lambda=0.036
l_{2}
M=4,K=256
l_{2}
l_{2}
\mathcal{C}
(\partial E/\partial\mathbf{y})^{T}\cdot\Delta\mathbf{c}<0
\lambda_{1}=\lambda
\lambda_{2}=0
