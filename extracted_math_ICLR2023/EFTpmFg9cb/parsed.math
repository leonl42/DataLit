k
x
y
y=\underset{y^{\prime}}{\arg\max}~{}p_{\theta}(y^{\prime}|x)
p_{\theta}(y^{\prime}|x)
\theta
x
y
\mathcal{D}^{\mathrm{train}}
e
x
y^{*}
e=(x,~{}y^{*})
\mathrm{NLL}_{\mathrm{\theta}}(e)=-\log p_{\theta}(y^{*}|x).
k
\theta^{(1)}
2\leq t\leq T
\mathcal{L}_{t}
k
\theta^{(t-1)}
\theta^{(t)}
\mathcal{L}_{t}
R
R(y,~{}y^{*})
y
y^{*}
t
\mathcal{L}_{t}
\mathcal{L}^{\prime}_{t}
e=(x,~{}y^{*})\in\mathcal{L}^{\prime}_{t}
k
\theta^{(t-1)}
\mathcal{L}^{\prime}_{t}
k
e
R(y,~{}y^{*})
k
y
\tilde{y}
k
k
k
C(y,~{}y*)
y_{+}
r_{+}=R(y_{+},~{}y^{*})
r=R(y,~{}y^{*})
~{}y
~{}y*
y
y_{+}
~{}y^{*}
y_{+}
r_{+}\geq r
y_{+}
y_{+}
e
\tilde{e}=(x,~{}y^{*},~{}r^{*},~{}\tilde{y},~{}\tilde{r},~{}\tilde{y}_{+},~{}%
\tilde{r}_{+})
r^{*}=R(y^{*},~{}y^{*})
\tilde{r}=R(\tilde{y},~{}y^{*})
\tilde{r}_{+}=R(\tilde{y}_{+},~{}y^{*})
\tilde{y}
\tilde{y}_{+}
\tilde{e}\in\mathcal{L}_{t}
\mathrm{CML}_{\theta}(x,~{}\tilde{y},~{}\tilde{r},~{}\tilde{y}_{+},~{}\tilde{r%
}_{+})=\max(0,~{}m-\log p(\tilde{y}_{+}|x)+\log p(\tilde{y}|x)),
m
\alpha
m=\alpha(\tilde{r}_{+}-\tilde{r})
\mathrm{CML}
\tilde{y}_{+}
\tilde{y}
\mathrm{CML}
y^{*}
y^{*}
y^{*}
\tilde{y}_{+}
y^{*}
\mathrm{CML}
\mathrm{CRL}_{\theta}(e^{\prime})=\mathrm{CML}_{\theta}(x,~{}\tilde{y},~{}%
\tilde{r},~{}\tilde{y}_{+},~{}\tilde{r}_{+})+\mathrm{CML}_{\theta}(x,~{}\tilde%
{y}_{+},~{}\tilde{r}_{+},~{}y^{*},~{}r^{*}).
\mathrm{NLL}
\lambda\times\mathrm{NLL}_{\mathrm{\theta}}(e)+(1.0-\lambda)\times\mathrm{CRL}%
_{\theta}(e^{\prime}),
\lambda\in[0,1.0]
\mathrm{NLL}_{\mathrm{\theta}}(e)
\lambda
\beta
R(y,~{}y^{*})=\beta\times\mathrm{precision}(y,~{}y^{*})+\mathrm{recall}(y,~{}y%
^{*}),
~{}~{}y^{*}=~{}
~{}y_{1}=~{}
~{}y_{2}=~{}
\mathrm{precision}
\mathrm{precision}(y_{1},~{}y^{*})=\mathrm{precision}(y_{2},~{}y^{*})=0
\mathrm{precision}^{\prime}(y,~{}y^{*})=\frac{\mathrm{TP}-c\times\mathrm{FP}}{%
\mathrm{TP}+\mathrm{FP}},
c
\geq 0
c=0
y_{1}
y_{2}
\mathrm{precision}^{\prime}(y_{1},~{}y^{*})=\frac{0-c\times 3}{0+3}=-c<\mathrm%
{precision}^{\prime}(y_{2},~{}y^{*})=0.
(c,\beta)=(2,4)
y_{+}=C(y,~{}y^{*})
R(y_{+},~{}y^{*})\geq R(y,~{}y^{*})
~{}y
~{}y^{*}
y_{1}
~{}y
y_{1}
C
y,~{}y^{*}
y_{\mathrm{R}}=\mathrm{REPLACE}(y,~{}y^{*})
y_{\mathrm{D}}=\mathrm{DROP}(y_{\mathrm{R}},~{}y^{*})
y_{\mathrm{D}}==y^{*}
y_{+}=\mathrm{DROP}(y,~{}y^{*})
y_{+}=y_{\mathrm{D}}
y_{+}
\mathrm{NLL}_{\theta}
k
\mathrm{CML}_{\theta}(x,~{}\tilde{y},~{}\tilde{r},~{}\tilde{y}_{+},~{}\tilde{r%
}_{+})
\theta^{(t)}
\mathcal{D}^{\mathrm{val}}
T=9
\mathcal{L}_{t}
k=5
k
\tilde{y}
(\alpha,\lambda)=(0.5,0.1)
k
k
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm 0.076
\pm 0.016
\pm 0.051
\pm 0.011
\pm 0.008
\pm 0.005
\pm 0.092
\pm 0.073
\pm 0.010
\pm 0.049
\pm 0.023
\pm 0.019
\pm 0.005
\pm 0.009
\pm 0.006
\pm 0.011
\pm 0.007
\pm 0.011
\pm 0.004
\pm 0.007
\lambda
\lambda
k
k
k
k
\lambda
\lambda
\lambda=0.1
\lambda=0.0
\lambda>0
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\lambda
\lambda
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
R_{\mathrm{PR}}
\mathrm{JAC}(y,~{}y^{*})=\frac{|Y\cap Y^{*}|}{|Y\cup Y^{*}|}=\frac{\mathrm{TP}%
}{\mathrm{TP}+\mathrm{FP}+\mathrm{FN}},
Y
Y^{*}
\mathrm{precision}^{\prime}
c
R_{\mathrm{JAC}}(y,~{}y^{*})=\frac{|Y\cap Y^{*}|-c\times|Y\setminus Y^{*}|}{|Y%
\cup Y^{*}|}=\frac{\mathrm{TP}-c\times\mathrm{FP}}{\mathrm{TP}+\mathrm{FP}+%
\mathrm{FN}},
\mathrm{TVE}(y,~{}y^{*})=\frac{|Y\cap Y^{*}|}{|Y\cap Y^{*}|+\gamma\times|Y%
\setminus Y^{*}|+\omega\times|Y^{*}\setminus Y|}=\frac{\mathrm{TP}}{\mathrm{TP%
}+\gamma\times\mathrm{FP}+\omega\times\mathrm{FN}},
\gamma
\omega
R_{\mathrm{TVE}}(y,~{}y^{*})=\frac{|Y\cap Y^{*}|-c\times|Y\setminus Y^{*}|}{|Y%
\cap Y^{*}|+\gamma\times|Y\setminus Y^{*}|+\omega\times|Y^{*}\setminus Y|}=%
\frac{\mathrm{TP}-c\times\mathrm{FP}}{\mathrm{TP}+\gamma\times\mathrm{FP}+%
\omega\times\mathrm{FN}}.
R_{\mathrm{JAC}}
R_{\mathrm{TVE}}
(\beta+1.0)
R_{\mathrm{JAC}}
R_{\mathrm{JAC}}
R_{\mathrm{JAC}}
c=1.0
R_{\mathrm{TVE}}
c=1.0
\gamma=0.5
\omega=1.0
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
R_{\mathrm{JAC}}
R_{\mathrm{JAC}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
R_{\mathrm{TVE}}
R_{\mathrm{TVE}}
R_{\mathrm{PR}}
R_{\mathrm{JAC}}
R_{\mathrm{TVE}}
R_{\mathrm{PR}}
R_{\mathrm{JAC}}
R_{\mathrm{TVE}}
