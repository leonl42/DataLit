G(\tau_{i})-V^{\mu}(s_{i,0})
G(\tau_{i})
i
V^{\mu}(s_{i,0})
\mu
s_{i,0}
(\mathcal{S},\mathcal{A},R,P,\rho_{0})
\mathcal{S}
\mathcal{A}
R:\mathcal{S}\times\mathcal{A}\to\mathbb{R}
P:\mathcal{S}\times\mathcal{A}\to\Delta_{\mathcal{S}}
\rho_{0}:\Delta_{\mathcal{S}}
\Delta_{\mathcal{X}}
\mathcal{X}
s_{0}\sim\rho_{0}
t
s_{t}
a_{t}\sim\pi(.|s_{t})
\pi:\mathcal{S}\to\Delta_{\mathcal{A}}
r_{t}=R(s_{t},a_{t})
s_{t+1}\sim P(s_{t+1}|s_{t},a_{t})
\pi
J(\pi)
s_{0}\sim\rho_{0}
\displaystyle J(\pi)=\mathbb{E}\left[\sum^{\infty}_{t=0}R(s_{t},a_{t})\;\bigg{%
|}\;s_{0}\sim\rho_{0},a_{t}\sim\pi(.|s_{t}),s_{t+1}\sim P(.|s_{t},a_{t})\right].
\displaystyle J(\pi)=\mathbb{E}\left[\sum^{\infty}_{t=0}R(s_{t},a_{t})\;\bigg{%
|}\;s_{0}\sim\rho_{0},a_{t}\sim\pi(.|s_{t}),s_{t+1}\sim P(.|s_{t},a_{t})\right].
\mathcal{D}
\mu:\mathcal{S}\to\Delta_{\mathcal{A}}
\pi
J(\pi)\geq J(\mu)
\mathcal{D}
\displaystyle\mathcal{D}=\Big{\{}(s_{i,0},a_{i,0},r_{i,0},\cdots s_{i,T_{i}})%
\leavevmode\nobreak\ \Big{|}\leavevmode\nobreak\ \begin{matrix}s_{i,0}\sim\rho%
_{0},&a_{i,t}\sim\mu(.|s_{i,t}),\\
r_{i,t}=R(s_{i,t},a_{i,t}),&s_{i,t+1}\sim P(.|s_{i,t},a_{i,t})\end{matrix}\Big%
{\}},
\displaystyle\mathcal{D}=\Big{\{}(s_{i,0},a_{i,0},r_{i,0},\cdots s_{i,T_{i}})%
\leavevmode\nobreak\ \Big{|}\leavevmode\nobreak\ \begin{matrix}s_{i,0}\sim\rho%
_{0},&a_{i,t}\sim\mu(.|s_{i,t}),\\
r_{i,t}=R(s_{i,t},a_{i,t}),&s_{i,t+1}\sim P(.|s_{i,t},a_{i,t})\end{matrix}\Big%
{\}},
\tau_{i}=(s_{i,0},a_{i,0},r_{i,0},\cdots s_{i,T_{i}+1})
i
\mathcal{D}
(i,t)
t
i
T_{i}
\tau_{i}
\mu
i
\pi
Q:\mathcal{S}\times\mathcal{A}\to\mathbb{R}
\pi
Q(s,a)
a
s
\pi
\pi
\mathcal{D}
Q
\pi
\displaystyle Q\leftarrow\operatorname*{arg\,min}_{Q}\mathbb{E}\Big{[}\left(r_%
{t}+\gamma\mathbb{E}_{a^{\prime}\sim\pi(.|s_{t+1})}\left[{Q}(s_{t+1},a^{\prime%
})\right]-Q(s_{t},a_{t})\right)^{2}\leavevmode\nobreak\ \Big{|}\leavevmode%
\nobreak\ \textrm{Uni}(\mathcal{D})\Big{]}
\displaystyle Q
\displaystyle\leftarrow\operatorname*{arg\,min}_{Q}\mathbb{E}\Big{[}\left(r_{t%
}+\gamma\mathbb{E}_{a^{\prime}\sim\pi(.|s_{t+1})}\left[{Q}(s_{t+1},a^{\prime})%
\right]-Q(s_{t},a_{t})\right)^{2}\leavevmode\nobreak\ \Big{|}\leavevmode%
\nobreak\ \textrm{Uni}(\mathcal{D})\Big{]}
\displaystyle\pi\leftarrow\operatorname*{arg\,max}_{\pi}\mathbb{E}\Big{[}{Q}(s%
_{t},a)\leavevmode\nobreak\ \Big{|}\leavevmode\nobreak\ \textrm{Uni}(\mathcal{%
D}),a\sim\pi(.|s_{t})\Big{]},
\displaystyle\pi
\displaystyle\leftarrow\operatorname*{arg\,max}_{\pi}\mathbb{E}\Big{[}{Q}(s_{t%
},a)\leavevmode\nobreak\ \Big{|}\leavevmode\nobreak\ \textrm{Uni}(\mathcal{D})%
,a\sim\pi(.|s_{t})\Big{]},
\mathbb{E}[\leavevmode\nobreak\ \cdot\leavevmode\nobreak\ |\leavevmode\nobreak%
\ \textrm{Uni}(\mathcal{D})]
\mathcal{D}:=\{\tau_{0},\tau_{1},\cdots\tau_{N-1}\}
\{\mu_{0},\mu_{1},\cdots\mu_{N-1}\}
\{G(\tau_{0}),G(\tau_{1}),\cdots G(\tau_{N-1})\}
\tau_{i}
\mu_{i}
N
T_{i}
\tau_{i}
G(\tau_{i})=\sum^{T_{i}-1}_{t=0}r_{i,t}
X
X
X-\mathbb{E}[X]
\displaystyle\mathbb{V}_{+}[X]\doteq\mathbb{E}\left[\left(X-\mathbb{E}[X]%
\right)^{2}_{+}\right]\quad\text{with}\quad x_{+}=\max\{x,0\}.
\displaystyle\mathbb{V}_{+}[X]
\displaystyle\doteq\mathbb{E}\left[\left(X-\mathbb{E}[X]\right)^{2}_{+}\right]%
\quad\text{with}\quad x_{+}=\max\{x,0\}.
\mathcal{D}
\mathcal{B}
\mathbb{V}_{+}[\mathcal{B}(p)]=p(1-p)^{2}
p
p
p=\frac{1}{3}
p=0
p=1
\mathbb{V}_{+}[\mathcal{B}(p)]=p(1-p)^{2}
\bar{G}
\mathbb{V}_{+}[\mathcal{B}(p)]=p(1-p)^{2}
\bar{G}
\mathcal{D}
\mathcal{D}
J(\mu)
\mu
\mathcal{D}
\mu
\{\mu_{0},\mu_{1},\cdots\mu_{N-1}\}
\pi
J(\pi)\geq J(\mu)
J(\mu)
\pi
\mu
(s_{t+1},a^{\prime})\notin\mathcal{D}
J(\pi)
J(\mu)
\pi
\mu
J(\mu)
J(\mu)
\mathcal{D}
d_{\mathcal{W}}(s,a)=\sum^{N-1}_{i=0}w_{i}d_{\mu_{i}}(s)\mu_{i}(a|s)
w_{i}
i
\tau_{i}
\mu_{i}
\mathcal{W}\doteq\{w_{0},\cdots w_{N-1}\}
d_{\mu_{i}}(s)
\mu_{i}
\mathcal{W}
d_{\mathcal{W}}
\mathcal{W}
\mu_{\mathcal{W}}(a|s)=\frac{d_{\mathcal{W}}(s,a)}{\sum^{N-1}_{i=0}w_{i}d_{\mu%
_{i}}(s)}
w_{i}=\frac{1}{N},\leavevmode\nobreak\ \forall w_{i}\in\mathcal{W}
\mu
\mathcal{D}
w_{i}
w_{i,t},\forall t\in\llbracket 0,T_{i}-1\rrbracket
\displaystyle w_{i,t}\doteq\frac{w_{i}}{\sum_{i=0}^{N-1}T_{i}w_{i}},\qquad%
\qquad\sum_{i=0}^{N-1}\sum_{t=0}^{T_{i}-1}w_{i,t}=\sum_{i=0}^{N-1}T_{i}\frac{w%
_{i}}{\sum_{i=0}^{N-1}T_{i}w_{i}}=1.
\displaystyle w_{i,t}\doteq\frac{w_{i}}{\sum_{i=0}^{N-1}T_{i}w_{i}},\qquad%
\qquad\sum_{i=0}^{N-1}\sum_{t=0}^{T_{i}-1}w_{i,t}=\sum_{i=0}^{N-1}T_{i}\frac{w%
_{i}}{\sum_{i=0}^{N-1}T_{i}w_{i}}=1.
\mathcal{W}\doteq\{w_{i}\}_{i\in\llbracket 0,N-1\rrbracket}\in\Delta_{N}
J(\mu_{\mathcal{W}})\geq J(\mu)
\Delta_{N}
N
J(\mu_{\mathcal{W}})=\sum^{N-1}_{i=0}w_{i}J(\mu_{i})
J(\mu_{i})
G(\tau_{i})
J(\mu_{i})
J(\mu_{\mathcal{W}})
\displaystyle\mathbb{P}\left[\left|J(\mu_{\mathcal{W}})-\textstyle\sum^{N-1}_{%
i=0}w_{i}G(\tau_{i})\right|>\epsilon\right]\leq 2\exp\left(\frac{2\epsilon^{2}%
}{G_{\mathrel{\scalebox{0.5}{$\top$}}}^{2}\sum^{N-1}_{i=0}w_{i}^{2}}\right),
\displaystyle\mathbb{P}\left[\left|J(\mu_{\mathcal{W}})-\textstyle\sum^{N-1}_{%
i=0}w_{i}G(\tau_{i})\right|>\epsilon\right]\leq 2\exp\left(\frac{2\epsilon^{2}%
}{G_{\mathrel{\scalebox{0.5}{$\top$}}}^{2}\sum^{N-1}_{i=0}w_{i}^{2}}\right),
G_{\mathrel{\scalebox{0.5}{$\top$}}}\doteq G_{\textsc{max}}-G_{\textsc{min}}
1
J(\mu_{\mathcal{W}})
w_{i}
\mu_{i}
w_{i}
G_{i}
J(\mu_{W})
\rho_{0}
P
\mu_{i}
\mu_{i}
\rho_{0}
P
\rho_{0}
G(\tau_{i})=J(\mu_{i})
\mu_{i}
\tau_{i}
\mu_{i}
\mathcal{W}
J(\mu_{\mathcal{W}})
\displaystyle\max_{\mathcal{W}\in\Delta_{N}}\sum_{i=0}^{N-1}w_{i}G(\tau_{i}),
\displaystyle\max_{\mathcal{W}\in\Delta_{N}}
\displaystyle\sum_{i=0}^{N-1}w_{i}G(\tau_{i}),
w_{i}
i
\tau_{i}
\displaystyle\max_{\mathcal{W}\in\Delta_{N}}\sum_{i=0}^{N-1}w_{i}G(\tau_{i})-%
\alpha\sum_{i=0}^{N-1}w_{i}\log w_{i},
\displaystyle\max_{\mathcal{W}\in\Delta_{N}}
\displaystyle\sum_{i=0}^{N-1}w_{i}G(\tau_{i})-\alpha\sum_{i=0}^{N-1}w_{i}\log w%
_{i},
\alpha\in\mathbb{R}^{+}
\alpha
\alpha\to 0
\alpha\to\infty
G(\tau_{i})
\mathcal{W}
\displaystyle w_{i}=\dfrac{\exp G(\tau_{i})/\alpha}{\sum_{\tau_{i}\in\mathcal{%
D}}\exp G(\tau_{i})/\alpha}.
\displaystyle w_{i}=\dfrac{\exp G(\tau_{i})/\alpha}{\sum_{\tau_{i}\in\mathcal{%
D}}\exp G(\tau_{i})/\alpha}.
\alpha
\alpha
G(\tau_{i})
G(\tau_{i})\leftarrow\frac{G(\tau_{i})-\min_{j}G(\tau_{j})}{\max_{j}G(\tau_{j}%
)-\min_{j}G(\tau_{j})}
\rho_{0}
\sum_{w_{i}\in\mathcal{W}}w_{i}A(\tau_{i})
A(\tau_{i})
\tau_{i}
A(\tau_{i})=G(\tau_{i})-\hat{V}^{\mu}(s_{i,0})
\hat{V}^{\mu}(s_{i,0})
\mu
s_{i,0}
\hat{V}^{\mu}\leftarrow\operatorname*{arg\,min}_{V}\mathbb{E}\big{[}(G(\tau_{i%
})-V(s_{i,0}))^{2}\leavevmode\nobreak\ |\leavevmode\nobreak\ \textrm{Uni}(%
\mathcal{D})\big{]}
G(\tau_{i})
A(\tau_{i})
\mathcal{W}
\displaystyle w_{i}=\dfrac{\exp A(\tau_{i})/\alpha}{\sum_{\tau_{i}\in\mathcal{%
D}}\exp A(\tau_{i})/\alpha},\leavevmode\nobreak\ \leavevmode\nobreak\ A(\tau_{%
i})=G(\tau_{i})-\hat{V}^{\mu}(s_{i,0}).
\displaystyle w_{i}=\dfrac{\exp A(\tau_{i})/\alpha}{\sum_{\tau_{i}\in\mathcal{%
D}}\exp A(\tau_{i})/\alpha},\leavevmode\nobreak\ \leavevmode\nobreak\ A(\tau_{%
i})=G(\tau_{i})-\hat{V}^{\mu}(s_{i,0}).
x
x
10
10\%
\alpha
20
(X-X_{Random})/(X_{Expert}-X_{Random})
X
X_{Random}
X_{Expert}
\sigma\%
(1-\sigma\%)
\sigma\in\{1,5,10,50\}
1/3
32
\sigma
\sigma\%
\sigma
\sigma\%=1\%
\sigma\%
1\%\leq\sigma\%\leq 10\%
\sigma\%
1\%\leq\sigma\%\leq 10\%
\sigma
\sigma
\sigma
50\%
\pi
h_{t}=\langle s_{0},a_{0},r_{0}\dots,s_{t-1},a_{t-1},r_{t-1},s_{t}\rangle
\pi(\cdot|h_{t})\in\Delta_{\mathcal{A}}
\Delta_{\mathcal{A}}
\mathcal{A}
\Pi
\Pi_{\textsc{d}}
\pi
s_{t}
\pi(\cdot|h_{t})=\pi(\cdot|s_{t})\in\Delta_{\mathcal{A}}
\pi
\Pi_{\textsc{m}}
\Pi_{\textsc{dm}}
\beta
\beta\in\Pi
\displaystyle\mathcal{J}(\beta)=\mathbb{E}\left[R_{\tau}\;\big{|}\;\tau\sim p_%
{0},\beta,p\right]=\mathbb{E}\left[R_{\tau}\;\big{|}\;\beta_{\tau}\sim\beta,%
\tau\sim p_{0},\beta_{\tau},p\right]=\mathbb{E}\left[\mathcal{J}(\beta_{\tau})%
\;\big{|}\;\beta_{\tau}\sim\beta\right].
\displaystyle\mathcal{J}(\beta)
\displaystyle=\mathbb{E}\left[R_{\tau}\;\big{|}\;\tau\sim p_{0},\beta,p\right]%
=\mathbb{E}\left[R_{\tau}\;\big{|}\;\beta_{\tau}\sim\beta,\tau\sim p_{0},\beta%
_{\tau},p\right]=\mathbb{E}\left[\mathcal{J}(\beta_{\tau})\;\big{|}\;\beta_{%
\tau}\sim\beta\right].
\beta_{\tau}
\mathcal{W}
\displaystyle\mathcal{J}(\beta_{\mathcal{W}})=\sum_{i=0}^{N-1}w_{i}\mathcal{J}%
(\beta_{\tau_{i}}).
\displaystyle\mathcal{J}(\beta_{\mathcal{W}})
\displaystyle=\sum_{i=0}^{N-1}w_{i}\mathcal{J}(\beta_{\tau_{i}}).
\beta_{\mathcal{W}}^{\textsc{m}}
\beta_{\mathcal{W}}
\gamma<1
\gamma<1
\beta_{\mathcal{W}}^{\textsc{m}}
\hat{\beta}_{\mathcal{W}}^{\textsc{m}}
N
\frac{2r_{\mathrel{\scalebox{0.5}{$\top$}}}}{1-\gamma}\sqrt{\frac{3|\mathcal{S%
}||\mathcal{A}|+4\log\frac{1}{\delta}}{2N^{2}\sum_{i=0}^{N-1}w_{i}^{2}}}
N
N^{2}\sum_{i=0}^{N-1}w_{i}^{2}
1-\delta
2r_{\mathrel{\scalebox{0.5}{$\top$}}}
\mathcal{A}=\{a_{1},a_{2}\}
a_{1}
a_{2}
p=0.5
a_{2}
w_{i}
\displaystyle w_{i}=\frac{\mathds{1}[G(\tau_{i})>0.8]}{\sum_{j}\mathds{1}[G(%
\tau_{j})>0.8]}.
\displaystyle w_{i}=\frac{\mathds{1}[G(\tau_{i})>0.8]}{\sum_{j}\mathds{1}[G(%
\tau_{j})>0.8]}.
\displaystyle\mathcal{J}(\mu_{\mathcal{W}})=\sum_{i=0}^{N-1}w_{i}\mathcal{J}(%
\mu_{i})=\mathcal{J}(\mu(a_{2})=1)=0.5
\displaystyle\mathcal{J}(\mu_{\mathcal{W}})
\displaystyle=\sum_{i=0}^{N-1}w_{i}\mathcal{J}(\mu_{i})=\mathcal{J}(\mu(a_{2})%
=1)=0.5
\displaystyle\sum^{N-1}_{i=0}w_{i}G(\tau_{i})=\sum_{i=0}^{N-1}\frac{\mathds{1}%
[G(\tau_{i})>0.8]}{\sum_{j}\mathds{1}[G(\tau_{j})>0.8]}=1,
\displaystyle\sum^{N-1}_{i=0}w_{i}G(\tau_{i})
\displaystyle=\sum_{i=0}^{N-1}\frac{\mathds{1}[G(\tau_{i})>0.8]}{\sum_{j}%
\mathds{1}[G(\tau_{j})>0.8]}=1,
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
\sigma=1
\sigma=5
\sigma=10
\sigma=50
10\%
a\sim\mathcal{A}
\alpha
\alpha=0.1
\alpha=0.2
V^{\mu}
(s_{i,0},G(\tau_{i}))\leavevmode\nobreak\ \forall\tau_{i}\in\mathcal{D}
E
D_{E}
D_{E}
E
[g_{1},g_{2},\cdots]
25\%
25\%
m
\displaystyle P(X_{m}\geq Y_{m})=\dfrac{1}{N^{2}}\sum^{N}_{i=1}\sum^{N}_{j=1}S%
(x_{m,i},y_{m,j}),\leavevmode\nobreak\ \leavevmode\nobreak\ S(x_{m,i},y_{m,j})%
=\begin{cases}1,x_{m,i}>y_{m,j}\\
\frac{1}{2},x_{m,i}=y_{m,j}\\
0,x_{m,i}<y_{m,j},\end{cases}
\displaystyle P(X_{m}\geq Y_{m})=\dfrac{1}{N^{2}}\sum^{N}_{i=1}\sum^{N}_{j=1}S%
(x_{m,i},y_{m,j}),\leavevmode\nobreak\ \leavevmode\nobreak\ S(x_{m,i},y_{m,j})%
=\begin{cases}1,x_{m,i}>y_{m,j}\\
\frac{1}{2},x_{m,i}=y_{m,j}\\
0,x_{m,i}<y_{m,j},\end{cases}
m
x_{m,i}
y_{m,j}
X
Y
\frac{1}{M}\sum^{M-1}_{m=0}P(X_{m}\geq Y_{m})
PI
PI
80\%
\alpha
\alpha
0.1
\alpha
\alpha
\llbracket 0.01,1.0\rrbracket
\alpha
\alpha
\llbracket 0.01,1.0\rrbracket
PI
PI(X>\textit{Uniform})
X\in\{\textit{Half},\textit{Top-10\%},\textit{RW},\textit{AW}\}
PI(\textit{AW}>\textit{Uniform})
PI(\textit{RW}>\textit{Uniform})
PI(\textit{RW}>\textit{Uniform})=70\%
70\%
PI
PI(\textit{AW}>\textit{Uniform})
PI(\textit{RW}>\textit{Uniform})
PI(\textit{AW}>\textit{Uniform})
PI(\textit{RW}>\textit{Uniform})
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=1
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=5
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=10
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
\sigma=50
