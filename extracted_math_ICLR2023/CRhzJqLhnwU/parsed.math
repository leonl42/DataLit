\alpha=0.1
\alpha=0.1
\alpha=1000
\alpha=1000
K
i
N_{i}
\{(\mathbf{x}_{j},y_{j})\}_{j=1}^{N_{i}}
\mathbf{x}_{j}
y_{j}
w
w=\underset{w}{\arg\min}\sum_{i=1}^{K}\alpha_{i}\mathcal{L}_{i}(w),\quad%
\mathcal{L}_{i}(w)=\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(F_{w}(\mathbf{x}_{j})%
,y_{j}),
\alpha_{i}=N_{i}/\sum_{i=1}^{K}N_{i}
\ell(F_{w}(\mathbf{x}_{j}),y_{j})
F_{w}()
\mathcal{L}_{i}(w)
i
w^{*}
w^{*}
i
w_{i}
w_{i}=\underset{w^{*}}{\arg\min}\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(F_{w^{*}%
}(\mathbf{x}_{j}),y_{j}),
w_{\text{PE}}=\underset{w_{\text{PE}}}{\arg\min}~{}\frac{1}{M}\sum_{j=1}^{M}%
\ell(F_{w_{\text{FM}},w_{\text{PE}}}(\mathbf{x}_{j}),y_{j}),
w_{\text{FM}}
w_{\text{PE}}
\{(\mathbf{x},y)\}^{M}
M
\mathbf{x}
\mathbf{p}
\mathbf{z}^{l}:=[z_{\text{cls}}^{l},z_{1}^{l},\ldots,z_{N}^{l}]
\displaystyle\mathbf{z}^{0}=\text{Tokenizer}(\mathbf{x})+\mathbf{p},
\displaystyle\mathbf{z}^{0}
\displaystyle=\text{Tokenizer}(\mathbf{x})+\mathbf{p},
\displaystyle\mathbf{z}^{l}=\text{MSA}(\text{LN}(\mathbf{z}^{l-1}))+\mathbf{z}%
^{l-1},\quad l=1\cdots L,
\displaystyle\mathbf{z}^{l}
\displaystyle=\text{MSA}(\text{LN}(\mathbf{z}^{l-1}))+\mathbf{z}^{l-1},\quad l%
=1\cdots L,
\displaystyle\mathbf{z}^{l}=\text{MLP}(\text{LN}(\mathbf{z}^{l}))+\mathbf{z}^{%
l},\quad l=1\cdots L.
\displaystyle\mathbf{z}^{l}
\displaystyle=\text{MLP}(\text{LN}(\mathbf{z}^{l}))+\mathbf{z}^{l},\quad l=1%
\cdots L.
z_{\text{cls}}^{l}
\displaystyle z_{\text{cls}}^{l}\leftarrow h^{l}_{l+1}\quad\text{with}\quad h^%
{l}=\text{Accumulator{}}_{\phi}([z_{\text{client}},z_{\text{cls}}^{0}+p^{%
\prime}_{0},\ldots,z_{\text{cls}}^{l}+p^{\prime}_{l}]),
\displaystyle z_{\text{cls}}^{l}\leftarrow h^{l}_{l+1}\quad\text{with}\quad h^%
{l}=\text{Accumulator{}}_{\phi}([z_{\text{client}},z_{\text{cls}}^{0}+p^{%
\prime}_{0},\ldots,z_{\text{cls}}^{l}+p^{\prime}_{l}]),
\phi
h^{l}_{l+1}
l+1
h^{l}
\mathbf{p}^{\prime}:=[p^{\prime}_{0},\ldots,p^{\prime}_{L}]
z_{\text{cls}}^{l}
\mathbf{z}^{l+1}
z_{\text{cls}}^{l}
z_{\text{cls}}^{l}
l
\displaystyle\hat{y}^{l}=\text{MLP-head}_{\psi}(h^{l}_{0}+z_{\text{cls}}^{l}),
\displaystyle\hat{y}^{l}=\text{MLP-head}_{\psi}(h^{l}_{0}+z_{\text{cls}}^{l}),
\psi
w_{\text{PE}}=(\phi,\psi)
\underset{w_{\text{PE}}}{\arg\min}\sum_{i=1}^{K}\frac{\alpha_{i}}{M}\sum_{j=1}%
^{M}\ell(\hat{y}^{l_{i}}_{j},y_{j}),
l_{i}
i
i
i
L_{i}
l_{i}
l_{i}=L_{i}
l_{i}
\{1,\ldots,L_{i}\}
(\phi,\psi)
z_{\text{client}}
i
\hat{y}^{L_{i}}
L_{i}
\hat{y}^{l_{i}}
l_{i}
L_{i}
l_{i}<L_{i}
\alpha=1000.0
\alpha=1.0,0.1
10\%
1\%
16\times 16
1000.0
1.0
0.1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
1000.0
1.0
0.1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
l\in[0,\cdots,11]
1000.0
1.0
0.1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
1000.0
1.0
0.1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
60\%
\alpha=0.1
l\in[1,12]
l
l
s\in[0,5]
40*3.17
40*2.99
\alpha=0.1
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
{}_{\text{frozen}}
