768\times 512
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
K
\tilde{\bm{z}}
\tilde{\bm{z}}
768\times 512
F
Q
G
F
\bm{x}
\bm{z}
Q
\bm{z}
\tilde{\bm{z}}
G
\tilde{\bm{z}}
\bm{\hat{x}}
H
\tilde{\bm{z}}
\bm{s}
H^{-1}
H
F
Q
G
F
\bm{x}
\bm{z}
Q
\bm{z}
\tilde{\bm{z}}
G
\tilde{\bm{z}}
\bm{\hat{x}}
H
\tilde{\bm{z}}
\bm{s}
H^{-1}
H
\bm{x}
\bm{s}
\bm{s}
\bm{\hat{x}}
\bm{s}
\bm{x}
\bm{\hat{x}}
d(\bm{x},\bm{\hat{x}})
d(\cdot,\cdot)
\bm{x}
\bm{z}
F
\bm{z}=F(\bm{x};\phi)
Q
\tilde{\bm{z}}=Q(\bm{z})
Q
\tilde{\bm{z}}
G
\bm{\hat{x}}=G(\tilde{\bm{z}};\theta)
\phi
\theta
F
G
\theta
\phi
\displaystyle L(\theta,\phi)\coloneqq\mathbb{E}_{p(\bm{x})}\left[d(\bm{x},G(Q(%
F(\bm{x};\phi));\theta))\right],
\displaystyle L(\theta,\phi)\coloneqq\mathbb{E}_{p(\bm{x})}\left[d(\bm{x},G(Q(%
F(\bm{x};\phi));\theta))\right],
\mathbb{E}_{p(\bm{x})}[\cdot]
\tilde{\bm{z}}
\log_{2}p(\tilde{\bm{z}})
\tilde{\bm{z}}
p(\tilde{\bm{z}})
\tilde{\bm{z}}
p(\tilde{\bm{z}};\omega)
\omega
\omega
p(\tilde{\bm{z}})
p(\tilde{\bm{z}};\omega)
\displaystyle H(p,p_{\omega})\coloneqq-\mathbb{E}_{p(\tilde{\bm{z}})}[\log_{2}%
p(\tilde{\bm{z}};\omega)].
\displaystyle H(p,p_{\omega})\coloneqq-\mathbb{E}_{p(\tilde{\bm{z}})}[\log_{2}%
p(\tilde{\bm{z}};\omega)].
\phi,\theta
\omega
\phi,\theta
\omega
\phi
\theta
\omega
F
\phi
p(\tilde{\bm{z}};\omega)
F
G
\bm{z}
\tilde{\bm{z}}
F
G
Q
F
G
\bm{z}
\tilde{\bm{z}}
F
G
Q
F
G
Q
F
G
\displaystyle F:\bm{x}\mapsto\{\bm{z}^{(i)}\}_{i=1}^{M},
\displaystyle F
\displaystyle:\bm{x}\mapsto\{\bm{z}^{(i)}\}_{i=1}^{M},
\displaystyle Q:\{\bm{z}^{(i)}\}_{i=1}^{M}\mapsto\{\tilde{\bm{z}}^{(i)}\}_{i=1%
}^{M}
\displaystyle Q
\displaystyle:\{\bm{z}^{(i)}\}_{i=1}^{M}\mapsto\{\tilde{\bm{z}}^{(i)}\}_{i=1}^%
{M}
\displaystyle G:\{\tilde{\bm{z}}^{(i)}\}_{i=1}^{M}\mapsto\bm{\hat{x}},
\displaystyle G
\displaystyle:\{\tilde{\bm{z}}^{(i)}\}_{i=1}^{M}\mapsto\bm{\hat{x}},
\displaystyle\bm{z}^{(i)}\in\mathbb{R}^{C^{(i)}\times H^{(i)}\times W^{(i)}},
\displaystyle\bm{z}^{(i)}
\displaystyle\in\mathbb{R}^{C^{(i)}\times H^{(i)}\times W^{(i)}},
\displaystyle\tilde{\bm{z}}^{(i)}\in\{0,\dots,N-1\}^{C^{(i)}\times H^{(i)}%
\times W^{(i)}},
\displaystyle\tilde{\bm{z}}^{(i)}
\displaystyle\in\{0,\dots,N-1\}^{C^{(i)}\times H^{(i)}\times W^{(i)}},
\bm{z}^{(i)}
\tilde{\bm{z}}^{(i)}
i
i=1,\cdots,M
H^{(i)}\times W^{(i)}
C^{(i)}
i
H^{(i)}>H^{(i+1)}
W^{(i)}>W^{(i+1)}
\tilde{\bm{z}}
\{0,\dots,N-1\},~{}N\in\mathbb{N}
M=4
F
G
\phi
\theta
{\rm round}(x)
{\rm round}_{\rm soft}(x)
{\rm round}(x)
{\rm round}_{\rm soft}(x)
\bm{z}
\bm{z}
\bm{z}
p(\tilde{\bm{z}};\omega)
\tilde{\bm{z}}
\bm{z}
[0,u]
(u>0)
[0,N-1]
\frac{N-1}{u}
u=4
{\rm round}(x)=\lceil x-0.5\rceil,
\lceil a\rceil
a
\displaystyle{\rm round}_{\rm soft}(x)=x-\alpha\frac{\sin(2\pi x)}{2\pi},
\displaystyle{\rm round}_{\rm soft}(x)=x-\alpha\frac{\sin(2\pi x)}{2\pi},
\alpha=\frac{1}{2}
{\rm round}_{\rm soft}(x)
{\rm round}(x)
\theta
\phi
H\colon\tilde{\bm{z}}\mapsto\bm{s}
\tilde{\bm{z}}
\bm{s}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}=(z_{1},\cdots,z_{I})
I=\sum_{i=1}^{M}C^{(i)}\times H^{(i)}\times W^{(i)}
p(\tilde{\bm{z}})
p(\tilde{\bm{z}})=p(z_{1})\prod_{i=2}^{I}p(z_{i}|z_{1},\cdots,z_{i-1}).
z_{i}
N
N
z_{i}
p(z_{i}|z_{1},z_{2},\cdots,z_{i-1})
z_{i}
p(z_{i}|z_{1},\cdots,z_{i-1})
i\geq 2
\tilde{\bm{z}}
z_{i}
\tilde{\bm{z}}
K
\bm{v}^{(k)}\quad(k=1,2,\cdots,K)
k
I_{k}
p(\tilde{\bm{z}})
p(\tilde{\bm{z}})\simeq p(\bm{v}^{(1)})\prod_{k=2}^{K}\prod_{i=1}^{I_{k}}p(v^{%
(k)}_{i}|\bm{v}^{(1)},\cdots,\bm{v}^{(k-1)}).
N
K
K\ll N
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\bm{v}^{(1)}
\bm{v}^{(1)}
\bm{v}^{(1)}
i
\bm{v}^{(i)}
i
\bm{v}^{(i)}
p(\tilde{\bm{z}})
p(\tilde{\bm{z}};\omega):=\prod_{i}p(z_{i};\omega_{i})
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
\tilde{\bm{z}}
1{,}024\times 1{,}024
512\times 512
1{,}024\times 1{,}024
\tilde{\bm{z}}
\tilde{\bm{z}}
z^{(i)}
i
z^{(i)}
i
512\times 768
512\times 768
768\times 512
6
C^{(i)}
\tilde{\bm{z}}^{(i)}
H^{(i)}\times W^{(i)}
C^{(i)}\approx C^{(i+1)}/4
C^{(i)}\times H^{(i)}\times W^{(i)}\approx C^{(i+1)}\times H^{(i+1)}\times W^{%
(i+1)}
C^{(i)}
C^{(i)}\in[0,C^{(i+1)}]
7
13
7
13
4
p(v^{(k)}_{i}|\bm{v}^{(1)},\cdots,\bm{v}^{(k-1)})
(k=2,\cdots,K)
K
\{8,10,12\}
K-2
K
z^{(1)}
z^{(1)}
z^{(1)}
\bm{s}
24
6
\alpha=0.001
\beta_{1}=0.9
\beta_{2}=0.999
\alpha
C^{(1)}
C^{(2)}
C^{(3)}
C^{(4)}
\times
\times
\times
\times
