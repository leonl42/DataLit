50\%
75.4\%
73.4\%
64.1\%
86.1\%
85.5\%
85.4\%
70\%
64.1\%
73.4\%
75.4\%
50\%
70\%
s(\mathbf{x})=\nabla_{\mathbf{x}}\log p(\mathbf{x})
50\%
50\%
n
\{\mathbf{x}\}_{i=1}^{n}
\mathbf{x}_{i}^{1},\mathbf{x}_{i}^{2}\in\mathbb{R}^{h\times w\times 3}
T=(h/p)\times(w/p)
p\times p
\mathbf{x}_{i,\text{patch}}^{1},\mathbf{x}_{i,\text{patch}}^{2}\in\mathbb{R}^{%
T\times p\times p\times 3}
p
h
w
\mathbf{M}_{i}^{1},\mathbf{M}_{i}^{2}\in\{0,1\}^{T}
1
t\in\{1,\ldots T\}
t
m
T^{\prime}=m\cdot T
m=50\%
T^{\prime}
\mathbf{z}^{1}_{i},\mathbf{z}_{i}^{2}\in\mathbb{R}^{T^{\prime}\times d}
T\times d
\hat{\mathbf{x}}^{1}_{i},\hat{\mathbf{x}}^{2}_{i}
\mathbb{R}^{h\times w\times 3}
\mathbf{z}^{1}_{i},\mathbf{z}_{i}^{2}\in\mathbb{R}^{T^{\prime}\times d}
d
\mathbb{R}^{r}
r<d
\mathbf{u}^{1}_{i},\mathbf{u}_{i}^{2}\in\mathbb{R}^{r}
i=1,\ldots n
i
2n-2
\mathcal{N}_{i}=\{\mathbf{u}^{1}_{j},\mathbf{u}^{2}_{j}\}_{j\neq i}
\mathcal{L}_{\text{InfoNCE}}=\frac{1}{2n}\sum_{v=1,2}\sum_{i=1}^{n}-\log\frac{%
e^{{\mathbf{u}^{1}_{i}}^{\top}\mathbf{u}^{2}_{i}/\tau}}{e^{{\mathbf{u}^{1}_{i}%
}^{\top}\mathbf{u}^{2}_{i}/\tau}+\sum_{\mathbf{u}^{-}\in\mathcal{N}_{i}}e^{{%
\mathbf{u}^{v}_{i}}^{\top}\mathbf{u}^{-}/\tau}}
\tau>0
\tau=0.1
\hat{\mathbf{x}}^{1}_{i},\hat{\mathbf{x}}^{2}_{i}
i=1,\ldots,n
\mathcal{L}_{\text{rec}}=\frac{1}{2n}\sum_{v=1,2}\sum_{i=1}^{n}\|\mathbf{M}_{i%
}^{v}\circ(\mathbf{x}^{v}_{i}-\hat{\mathbf{x}}^{v}_{i})\|_{2}^{2}
\circ
t
\mathbf{x}^{v}_{i}-\hat{\mathbf{x}}^{v}_{i}
(\mathbf{M}_{i}^{v})_{t}\in\{0,1\}
\mathbf{x}_{i}^{v}\leftarrow\mathbf{x}_{i}^{v}+\sigma_{i}^{v}\mathbf{e}^{v}_{i}
\mathbf{e}^{v}_{i}\sim\mathcal{N}(\mathbf{0},I)
\sigma_{i}^{v}
[0,\sigma_{\text{max}}]
\sigma_{i}^{v}
\sigma_{i}^{v}
\sigma_{i}^{v}
\mathbf{p}_{i}^{v}\in\mathbb{R}^{d}
\mathbf{z}_{i}^{v}\in\mathbb{R}^{T\times d}
(\mathbf{z}_{i}^{v})_{t}\leftarrow(\mathbf{z}_{i}^{v})_{t}+\mathbf{p}_{i}^{v}
t=1\ldots,T
\mathbf{x}^{v}_{i}
\mathcal{L}_{\text{denoise}}=\frac{1}{2n}\sum_{v=1,2}\sum_{i=1}^{n}\|(1-%
\mathbf{M}_{i}^{v})\circ(\sigma_{i}^{v}\mathbf{e}^{v}_{i}-\hat{\mathbf{x}}^{v}%
_{i})\|_{2}^{2}
\sigma
\sigma
\sigma
\sigma
\circ
\mathcal{L}_{\text{rec}}
\sigma_{i}^{v}
0.7\%
1\%
68.4\%
68.6\%
\mathcal{L}_{\text{CAN}}=\lambda_{\text{InfoNCE}}\mathcal{L}_{\text{InfoNCE}}+%
\lambda_{\text{rec}}\mathcal{L}_{\text{rec}}+\lambda_{\text{denoise}}\mathcal{%
L}_{\text{denoise}}
0\leq\lambda_{\text{InfoNCE}},\lambda_{\text{rec}},\lambda_{\text{denoise}}
\lambda_{\text{InfoNCE}}+\lambda_{\text{rec}}+\lambda_{\text{denoise}}=1
\lambda_{\text{rec}}=(1-\lambda_{\text{InfoNCE}})\cdot\lambda
\lambda_{\text{denoise}}=(1-\lambda_{\text{InfoNCE}})\cdot(1-\lambda)
0\leq\lambda\leq 1
\mathcal{L}_{\text{rec}},\mathcal{L}_{\text{denoise}}
\mathcal{L}_{\text{InfoNCE}}
\lambda
\lambda_{\text{InfoNCE}}
\times
\times
1281167/[\text{batch size}]
4
2
41\%
75.4\%
71.8\%
64.1\%
86.1\%
85.5\%
85.4\%
75.4\%
77.3\%
\times
\times
\times
83.6\%
83.0\%
83.9\%
74.8\%
70.4\%
\sigma_{\text{max}}
\sigma_{\text{max}}
\mathcal{L}_{\text{InfoNCE}}
\mathcal{L}_{\text{rec}}
\mathcal{L}_{\text{InfoNCE}}
\mathcal{L}_{\text{rec}}
\downarrow
\downarrow
50\%
50\%
75\%
50\%
\lambda_{\text{InfoNCE}}
\lambda_{\text{InfoNCE}}
\lambda_{\text{InfoNCE}}=0.03
[0,\sigma_{\text{max}}]
\lambda
\sigma_{\text{max}}=0.05
10
25
5000
1
5
\{1,5,10,25\}
75\%
384\times 384
4
2
wd=0.1/2=0.05
lr=1.25\times 10^{-4}/4=3.125\times 10^{-5}
lr=1.5\times 10^{-4}/4=3.75\times 10^{-5}
wd=0.05/2=0.025
wd=0.05
\beta_{1},\beta_{2}{=}0.9,0.95
\beta_{1},\beta_{2}{=}0.9,0.95
\beta_{1},\beta_{2}{=}0.9,0.95
\beta_{1},\beta_{2}{=}0.9,0.95
\beta_{1},\beta_{2}{=}0.9,0.999
