(\mathcal{S},\mathcal{A},P,\gamma,r)
\mathcal{S}
\mathcal{A}
P
\gamma
r:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
\pi\in\Pi:\mathcal{S}\times\mathcal{A}\rightarrow[0,\infty)
a_{t}
s_{t}
t
\Pi
r_{t}:=r(s_{t},a_{t})
s_{t+1}
\mathbb{E}_{s_{0}\sim p_{0},\tau_{0}\sim\pi}[\sum_{t=0}^{\infty}\gamma^{t}r_{t}]
\tau_{t}=(s_{t},a_{t},s_{t+1},a_{t+1}\cdots)
J_{SAC}(\pi)=\mathbb{E}_{\tau_{0}\sim\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}(r%
_{t}+\beta\mathcal{H}(\pi(\cdot|s_{t})))\right],
\mathcal{H}
\beta\in(0,\infty)
Q
{\cal H}(\pi(\cdot|s_{t}))
r_{t}
r_{t}
\beta
t
{\cal H}(\pi(\cdot|s_{t}))
\pi(\cdot|s_{t})
\pi(\cdot|s_{t})
s_{t}
q_{mix}^{\pi,\alpha}(\cdot|s):=\alpha\pi(\cdot|s)+(1-\alpha)q(\cdot|s),
\alpha\in[0,1]
\pi(\cdot|s)
q(\cdot|s)
\mathcal{D}
J(\pi)=\mathbb{E}_{\tau_{0}\sim\pi}\left[\sum_{t=0}^{\infty}\gamma^{t}(r_{t}+%
\beta\mathcal{H}(q_{mix}^{\pi,\alpha}(\cdot|s_{t})))\right],
{\cal H}(q_{mix}^{\pi,\alpha}(\cdot|s_{t}))
q_{mix}^{\pi,\alpha}(\cdot|s_{t})
\pi(\cdot|s_{t})
q(\cdot|s_{t})
q(\cdot|s_{t})
\mathcal{H}(q_{mix}^{\pi,\alpha})
s_{t}
\displaystyle\mathcal{H}(q_{mix}^{\pi,\alpha})=-\int_{a\in\mathcal{A}}(\alpha%
\pi+(1-\alpha)q)\log(\underbrace{\alpha\pi+(1-\alpha)q}_{=q_{mix}^{\pi,\alpha}})
\displaystyle\mathcal{H}(q_{mix}^{\pi,\alpha})=-\int_{a\in\mathcal{A}}(\alpha%
\pi+(1-\alpha)q)\log(\underbrace{\alpha\pi+(1-\alpha)q}_{=q_{mix}^{\pi,\alpha}})
\displaystyle=\int\alpha\pi\log\frac{\alpha\pi}{\alpha\pi+(1-\alpha)q}+\int(1-%
\alpha)q\log\frac{(1-\alpha)q}{\alpha\pi+(1-\alpha)q}
\displaystyle=\int\alpha\pi\log\frac{\alpha\pi}{\alpha\pi+(1-\alpha)q}+\int(1-%
\alpha)q\log\frac{(1-\alpha)q}{\alpha\pi+(1-\alpha)q}
\displaystyle~{}~{}~{}~{}-\int\alpha\pi\log(\alpha\pi)-\int(1-\alpha)q\log((1-%
\alpha)q)
\displaystyle~{}~{}~{}~{}-\int\alpha\pi\log(\alpha\pi)-\int(1-\alpha)q\log((1-%
\alpha)q)
\displaystyle=D_{JS}^{\alpha}(\pi||q)+\alpha\mathcal{H}(\pi)+(1-\alpha)%
\mathcal{H}(q)+\mbox{constant},
\displaystyle=D_{JS}^{\alpha}(\pi||q)+\alpha\mathcal{H}(\pi)+(1-\alpha)%
\mathcal{H}(q)+\mbox{constant},
D_{JS}^{\alpha}(\pi||q){:=}\alpha\int\pi\log\frac{\pi}{\alpha\pi+(1-\alpha)q}+%
(1-\alpha)\int q\log\frac{q}{\alpha\pi+(1-\alpha)q}
\alpha
D_{JS}^{\alpha}
\alpha=\frac{1}{2}
\alpha=0
1
\alpha=1
\mathcal{H}(q_{mix}^{\pi,\alpha})
\alpha\in(0,1)
{\cal H}(\pi)
q
D_{JS}^{\alpha}(\pi||q)
q
q
q
q
q
q
q
\displaystyle J_{\pi_{old}}(\pi(\cdot|s_{t})):=\beta\{\mathbb{E}_{a_{t}\sim\pi%
}\left[Q^{\pi_{old}}(s_{t},a_{t})+\alpha(\log R^{\pi,\alpha}(s_{t},a_{t})-\log%
\alpha\pi(a_{t}|s_{t}))\right]
\displaystyle J_{\pi_{old}}(\pi(\cdot|s_{t})):=\beta\{\mathbb{E}_{a_{t}\sim\pi%
}\left[Q^{\pi_{old}}(s_{t},a_{t})+\alpha(\log R^{\pi,\alpha}(s_{t},a_{t})-\log%
\alpha\pi(a_{t}|s_{t}))\right]
\displaystyle~{}~{}\hskip 110.00017pt+(1-\alpha)\mathbb{E}_{a_{t}\sim q}\left[%
\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})\right]\}.
\displaystyle~{}~{}\hskip 110.00017pt+(1-\alpha)\mathbb{E}_{a_{t}\sim q}\left[%
\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})\right]\}.
\displaystyle\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t})):=\beta\mathbb{E}_{a_{t}%
\sim\pi}[Q^{\pi_{old}}(s_{t},a_{t})+\alpha(\log R^{\pi_{old},\alpha}(s_{t},a_{%
t})-\log\pi(a_{t}|s_{t}))],
\displaystyle\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t})):=\beta\mathbb{E}_{a_{t}%
\sim\pi}[Q^{\pi_{old}}(s_{t},a_{t})+\alpha(\log R^{\pi_{old},\alpha}(s_{t},a_{%
t})-\log\pi(a_{t}|s_{t}))],
Q
Q^{\pi}
\displaystyle Q^{\pi}(s_{t},a_{t}):=\frac{1}{\beta}r_{t}
\displaystyle Q^{\pi}(s_{t},a_{t})
\displaystyle:=\frac{1}{\beta}r_{t}
\displaystyle+\mathbb{E}_{\tau_{t+1}\sim\pi}\biggl{[}\sum_{l=t+1}^{\infty}%
\gamma^{l-t-1}\biggl{(}\frac{1}{\beta}r_{l}+\mathcal{H}(q_{mix}^{\pi,\alpha}(%
\cdot|s_{l}))\biggr{)}\biggr{]},
\displaystyle+\mathbb{E}_{\tau_{t+1}\sim\pi}\biggl{[}\sum_{l=t+1}^{\infty}%
\gamma^{l-t-1}\biggl{(}\frac{1}{\beta}r_{l}+\mathcal{H}(q_{mix}^{\pi,\alpha}(%
\cdot|s_{l}))\biggr{)}\biggr{]},
\mathcal{H}(q_{mix}^{\pi,\alpha}(\cdot|s_{l}))
Q^{\pi}(s_{t},a_{t})
\mathcal{H}(q_{mix}^{\pi,\alpha}(\cdot|s_{l}))
q
R^{\pi,\alpha}(s_{t},a_{t})=\frac{\alpha\pi(a_{t}|s_{t})}{\alpha\pi(a_{t}|s_{t%
})+(1-\alpha)q(a_{t}|s_{t})},
q
\mathcal{H}(q_{mix}^{\pi,\alpha}(\cdot|s_{t}))
\displaystyle\mathcal{H}(q_{mix}^{\pi,\alpha})=\alpha{\mathbb{E}}_{a_{t}\sim%
\pi(\cdot|s_{t})}[\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})]
\displaystyle\mathcal{H}(q_{mix}^{\pi,\alpha})=\alpha{\mathbb{E}}_{a_{t}\sim%
\pi(\cdot|s_{t})}[\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})]
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q(\cdot|s_{t})}[\log R^{\pi,%
\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})].
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q(\cdot|s_{t})}[\log R^{\pi,%
\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})].
{\cal H}(q_{mix}^{\pi,\alpha})
-\alpha{\mathbb{E}}_{a_{t}\sim\pi(\cdot|s_{t})}\log q_{mix}^{\pi,\alpha}
-(1-\alpha){\mathbb{E}}_{a_{t}\sim q(\cdot|s_{t})}\log q_{mix}^{\pi,\alpha}
\log q_{mix}^{\pi,\alpha}
\log\frac{\alpha\pi(a_{t}|s_{t})}{R^{\pi,\alpha}(s_{t},a_{t})}
{\cal H}(q_{mix}^{\pi,\alpha})
R^{\pi,\alpha}
\pi
{\mathbb{E}}_{a_{t}\sim q(\cdot|s_{t})}
{\cal H}(q_{mix}^{\pi,\alpha})
R^{\pi,\alpha}
\pi
Q:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
Q
Q^{\pi}
\mathcal{T}^{\pi}Q(s_{t},a_{t}):=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+1%
}\sim P}[V(s_{t+1})],
V(s_{t})
{\mathbb{E}}_{a_{t}\sim\pi}[Q(s_{t},a_{t})]
{\cal H}(q_{mix}^{\pi,\alpha})
s_{t}
\displaystyle V(s_{t})=\mathbb{E}_{a_{t}\sim\pi}[Q(s_{t},a_{t})+\alpha\log R^{%
\pi,\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi(a_{t}|s_{t})]
\displaystyle V(s_{t})
\displaystyle=\mathbb{E}_{a_{t}\sim\pi}[Q(s_{t},a_{t})+\alpha\log R^{\pi,%
\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi(a_{t}|s_{t})]
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{\pi,\alpha}(s_{t},a_{%
t})-\log\alpha\pi(a_{t}|s_{t})],
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{\pi,\alpha}(s_{t},a_{%
t})-\log\alpha\pi(a_{t}|s_{t})],
{\cal H}(q_{mix}^{\pi,\alpha})
\pi
R^{\pi,\alpha}(s_{t},a_{t})
\pi
V(s_{t})
\mathcal{T}^{\pi}Q(s_{t},a_{t})
Q(s_{t},a_{t})
\mathcal{T}^{\pi}
Q
Q^{\pi}
Q^{\pi_{old}}(\cdot,\cdot)
\pi_{old}
\pi_{old}
\pi
J_{\pi_{old}}(\pi(\cdot|s_{t}))
\pi
J_{\pi_{old}}(\pi)
Q^{\pi_{old}}
\pi_{old}
J_{\pi_{old}}(\pi)
\pi
s_{t}
J(\pi)
\pi
R^{\pi,\alpha}
\log(\alpha\pi)
\pi
\pi_{old}
\pi_{new}
\pi_{new}=\mathop{\arg\max}_{\pi\in\Pi}~{}J_{\pi_{old}}(\pi).
\pi_{new}
Q^{\pi_{new}}(s_{t},a_{t})\geq Q^{\pi_{old}}(s_{t},a_{t})
\forall(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
\pi^{*}
Q^{\pi^{*}}(s_{t},a_{t})\geq Q^{\pi^{\prime}}(s_{t},a_{t})
\forall~{}\pi^{\prime}\in\Pi
\forall~{}(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
\pi^{*}
J
\pi
R^{\pi,\alpha}
\pi
\pi_{\theta}
\theta
R^{\pi,\alpha}
\pi
({\cal S},{\cal A})
[0,1)
\pi
R^{\pi,\alpha}
\theta
({\cal S},{\cal A})
[0,1)
\theta
R^{\pi_{\theta},\alpha}(s_{t},a_{t})
(s_{t},a_{t})
\theta
R^{\pi_{\theta},\alpha}
(s_{t},a_{t},\theta)
\theta
R^{\pi_{\theta},\alpha}(s_{t},a_{t})
(s_{t},a_{t},\theta)
R^{\pi,\alpha}
\pi
R^{\pi_{old},\alpha}
\pi_{old}
\pi
R^{\pi,\alpha}
\pi_{old}
\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))
\pi_{old}
\theta
\pi_{\theta}
J_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\tilde{J}_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\theta
\theta=\theta_{old}
s_{t}\in\mathcal{S}
\theta_{old}
\pi_{old}
D_{KL}(\pi(\cdot|s_{t})||\exp(Q^{\pi_{old}}(s_{t},\cdot)/\alpha+R^{\pi_{old},%
\alpha}(s_{t},\cdot))=-\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))/\beta
\pi_{new}(\cdot|s_{t})\propto\exp(Q^{\pi_{old}}(s_{t},\cdot)/\alpha+R^{\pi_{%
old},\alpha}(s_{t},\cdot))
\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))
{\mathbb{E}}_{a_{t}\sim q}
\pi
\log\pi
\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))
\theta
\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))
\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))
R^{\alpha}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
R^{\pi,\alpha}
\pi
R^{\alpha}
\displaystyle J_{ratio}(R^{\alpha}(s_{t},\cdot))=\alpha\mathbb{E}_{a_{t}\sim%
\pi(\cdot|s_{t})}[\log R^{\alpha}(s_{t},a_{t})]
\displaystyle J_{ratio}(R^{\alpha}(s_{t},\cdot))=\alpha\mathbb{E}_{a_{t}\sim%
\pi(\cdot|s_{t})}[\log R^{\alpha}(s_{t},a_{t})]
\displaystyle~{}~{}~{}~{}~{}~{}~{}\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim q(%
\cdot|s_{t})}[\log(1-R^{\alpha}(s_{t},a_{t}))].
\displaystyle~{}~{}~{}~{}~{}~{}~{}\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim q(%
\cdot|s_{t})}[\log(1-R^{\alpha}(s_{t},a_{t}))].
R^{\alpha}
J_{ratio}(R^{\alpha})
s
J_{ratio}(R^{\alpha}(s,\cdot))=\int_{a}[c_{1}\log R^{\alpha}(s,a)+c_{2}\log(1-%
R^{\alpha}(s,a))]da
c_{1}=\alpha\pi
c_{2}=(1-\alpha)q
a
f(R^{\alpha}(s,a))=c_{1}\log R^{\alpha}(s,a)+c_{2}\log(1-R^{\alpha}(s,a))
R^{\alpha}(s,a)
R^{\alpha}(s,a)=c_{1}/(c_{1}+c_{2})=\alpha\pi/(\alpha\pi+(1-\alpha)q)
J_{ratio}(R^{\alpha})
R^{\alpha}(s_{t},a_{t})=\alpha\pi/(\alpha\pi+(1-\alpha)q)
J_{ratio}(R^{\alpha})
\pi
R^{\alpha}
Q
V
\theta
\eta
\phi
\psi
\tilde{J}_{\pi_{old}}(\pi)
J_{ratio}(R^{\alpha})
\hat{J}_{\pi}(\theta)
\pi_{\theta}
\hat{J}_{R^{\alpha}}(\eta)
R^{\alpha}_{\eta}
\displaystyle\hat{J}_{\pi}(\theta)=\mathbb{E}_{s_{t}\sim\mathcal{D},~{}a_{t}%
\sim\pi_{\theta}}[Q_{\phi}(s_{t},a_{t})+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{%
t})
\displaystyle\hat{J}_{\pi}(\theta)
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D},~{}a_{t}\sim\pi_{\theta}}[Q_{%
\phi}(s_{t},a_{t})+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{t})
\displaystyle~{}~{}-\alpha\log\pi_{\theta}(a_{t}|s_{t})],
\displaystyle~{}~{}-\alpha\log\pi_{\theta}(a_{t}|s_{t})],
\displaystyle\hat{J}_{R^{\alpha}}(\eta)=\mathbb{E}_{s_{t}\sim\mathcal{D}}[%
\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\log R_{\eta}^{\alpha}(s_{t},a_{t})]
\displaystyle\hat{J}_{R^{\alpha}}(\eta)
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D}}[\alpha\mathbb{E}_{a_{t}\sim\pi%
_{\theta}}[\log R_{\eta}^{\alpha}(s_{t},a_{t})]
\displaystyle~{}~{}+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\log(1-R_{\eta%
}^{\alpha}(s_{t},a_{t}))]],
\displaystyle~{}~{}+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\log(1-R_{\eta%
}^{\alpha}(s_{t},a_{t}))]],
{\cal D}
\mathcal{T}^{\pi}
\hat{L}_{Q}(\phi)
\hat{L}_{V}(\psi)
Q_{\phi}
V_{\psi}
\displaystyle\hat{L}_{Q}(\phi)=\mathbb{E}_{(s_{t},~{}a_{t})\sim\mathcal{D}}%
\left[\frac{1}{2}(Q_{\phi}(s_{t},a_{t})-\hat{Q}(s_{t},a_{t}))^{2}\right],
\displaystyle\hat{L}_{Q}(\phi)
\displaystyle=\mathbb{E}_{(s_{t},~{}a_{t})\sim\mathcal{D}}\left[\frac{1}{2}(Q_%
{\phi}(s_{t},a_{t})-\hat{Q}(s_{t},a_{t}))^{2}\right],
\displaystyle\hat{L}_{V}(\psi)=\mathbb{E}_{s_{t}\sim\mathcal{D}}\left[\frac{1}%
{2}(V_{\psi}(s_{t})-\hat{V}(s_{t}))^{2}\right],
\displaystyle\hat{L}_{V}(\psi)
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D}}\left[\frac{1}{2}(V_{\psi}(s_{t%
})-\hat{V}(s_{t}))^{2}\right],
\hat{Q}
\hat{V}
\displaystyle\hat{Q}(s_{t},a_{t})=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+%
1}\sim P}[V_{\bar{\psi}}(s_{t+1})]
\displaystyle\hat{Q}(s_{t},a_{t})=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+%
1}\sim P}[V_{\bar{\psi}}(s_{t+1})]
\displaystyle\hat{V}(s_{t})=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},%
a_{t})
\displaystyle\hat{V}(s_{t})=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},%
a_{t})
\displaystyle\hskip 65.00009pt+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{t})-%
\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle\hskip 65.00009pt+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{t})-%
\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\log R_{\eta}^{%
\alpha}(s_{t},a_{t})-\log\alpha\pi_{\theta}(a_{t}|s_{t})].
\displaystyle\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\log R_{\eta}^{%
\alpha}(s_{t},a_{t})-\log\alpha\pi_{\theta}(a_{t}|s_{t})].
\bar{\psi}
V_{\bar{\psi}}
\psi
Q
Q_{\phi_{i}},~{}i=1,2
\hat{L}_{Q}(\phi_{i})
Q
\alpha=1
\alpha=0
0<\alpha<1
Q
\beta
\alpha
\beta
\theta
\eta
\psi
\bar{\psi}
\xi
\phi_{i},~{}i=1,2
\tau
N
\pi_{\theta}
\tau
\mathcal{D}
M
\mathcal{D}
\hat{J}_{\pi}(\theta)
\hat{J}_{R^{\alpha}}(\eta)
\hat{L}_{Q}(\phi_{i})
\hat{L}_{V}(\psi)
\theta\leftarrow\theta+\delta\nabla_{\theta}\hat{J}_{\pi}(\theta)
\eta\leftarrow\eta+\delta\nabla_{\eta}\hat{J}_{R^{\alpha}}(\eta)
\phi_{i}\leftarrow\phi_{i}-\delta\nabla_{\phi_{i}}\hat{L}_{Q}(\phi_{i}),~{}i=1,2
\psi\leftarrow\psi-\delta\nabla_{\psi}\hat{L}_{V}(\psi)
\bar{\psi}
\psi
\alpha
\hat{L}_{\alpha}(\xi)
\xi\leftarrow\xi-\delta\nabla_{\xi}\hat{L}_{\alpha}(\xi)
\alpha
\alpha
\pi
q
\alpha
\alpha
\alpha
\alpha
\min_{\alpha}\mathcal{H}(q_{mix}^{\pi,\alpha})
\small\max_{\pi}\mathbb{E}_{\tau_{0}\sim\pi}\left[\sum_{t}\gamma^{t}(r_{t}+%
\beta\min_{\alpha}[\mathcal{H}(q_{mix}^{\pi,\alpha})-\alpha c])\right]
c
\alpha
\alpha
\alpha
\alpha
\xi
\alpha
\hat{L}_{\alpha}(\xi)=\mathbb{E}_{s_{t}\sim\mathcal{D}}[\mathcal{H}(q_{mix}^{%
\pi_{\theta},\alpha_{\xi}})-\alpha_{\xi}c]
\alpha
J_{SAC}(\pi)+\alpha_{d}D(\pi||q)
D
J_{SAC}(\pi)
\alpha_{d}
\delta_{d}=0.2
D_{JS}^{\alpha}
J_{SAC}(\pi)
\pi
q
\pi
q
D_{JS}^{\alpha}
J(\pi)
\pi
q
\pi
q
J(\pi)
q
J_{SAC}(\pi)
J_{SAC}(\pi)
\alpha=0.5
100\times 100
(x,y)
(dx,dy)
[-1,1]\times[-1,1]
(x+dx,y+dy)
(0.5,0.5)
30
\times
\sigma
\times
D_{JS}^{\alpha}
D_{JS}^{\alpha}
\alpha
D_{JS}^{\alpha}(\pi||q)
\alpha=0.5
\alpha
D_{JS}^{\alpha}(\pi||q)
\alpha=0.5
D
D
\alpha=0.5
10
\sigma
D_{JS}^{\alpha}(\pi||q)
q
\alpha
\alpha=0.5
0.8
\alpha
\alpha
\alpha=0.8
\alpha=0.5
\alpha
\alpha
\alpha
\alpha
\alpha
\alpha
D_{JS}(\pi||q)
\mathcal{H}(\pi)
\alpha
D_{JS}(\pi||q)
\alpha
D_{JS}(\pi||q)
\alpha
\alpha
\alpha
\alpha
q
q
\mathcal{D}
q
d^{\pi}
\pi
q
q
q
q
q
\mathcal{D}
N=
q
\mathcal{D}
q^{\prime}
N^{\prime}
\mathcal{D}^{\prime}
\mathcal{D}
N^{\prime}\leq
N^{\prime}
q^{\prime}
\hat{J}_{R^{\alpha}}(\eta)
\hat{V}(s_{t})
q^{\prime}
\displaystyle\hat{J}_{R^{\alpha}}(\eta)=\mathbb{E}_{s_{t}\sim\mathcal{D}}[%
\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\log R_{\eta}^{\alpha}(s_{t},a_{t})]
\displaystyle\hat{J}_{R^{\alpha}}(\eta)=\mathbb{E}_{s_{t}\sim\mathcal{D}}[%
\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\log R_{\eta}^{\alpha}(s_{t},a_{t})]
\displaystyle\hskip 58.50009pt+(1-\alpha)\mathbb{E}_{a_{t}\sim q^{\prime}}[%
\log(1-R_{\eta}^{\alpha}(s_{t},a_{t}))]],
\displaystyle\hskip 58.50009pt+(1-\alpha)\mathbb{E}_{a_{t}\sim q^{\prime}}[%
\log(1-R_{\eta}^{\alpha}(s_{t},a_{t}))]],
\displaystyle\hat{V}(s_{t})=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},%
a_{t})
\displaystyle\hat{V}(s_{t})=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},%
a_{t})
\displaystyle\hskip 58.50009pt+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{t})-%
\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle\hskip 58.50009pt+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{t})-%
\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q^{\prime}}[\log R_{\eta}^{%
\alpha}(s_{t},a_{t})-\log\alpha\pi_{\theta}(a_{t}|s_{t})],
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q^{\prime}}[\log R_{\eta}^{%
\alpha}(s_{t},a_{t})-\log\alpha\pi_{\theta}(a_{t}|s_{t})],
s_{t}
\mathcal{D}
q^{\prime}
\mathcal{D^{\prime}}
s_{t}
\mathcal{D}
\mathcal{D}^{\prime}
q^{\prime}
q^{\prime}
\mathcal{D}
q^{\prime}
q^{\prime}
N^{\prime}
N^{\prime}=
q
N^{\prime}=
q
q
c
\beta
q_{mix}^{\pi,\alpha}=\alpha\pi+(1-\alpha)q
q
s_{0}
N_{a}
\mathcal{A}=\{A_{1},\cdots,A_{N_{a}}\}
s_{1}
r
N_{a}
N_{a}-1
\mathbf{R}=\{(s_{0},A_{1},r(s_{0},A_{1})),\cdots,(s_{0},A_{N_{a}-1},r(s_{0},A_%
{N_{a}-1}))\}
A_{N_{a}}
Q
1/{N_{a}}
N_{a}
A_{N_{a}}
q
q(a_{0}|s_{0})=1/(N_{a}-1)
a_{0}\in\{A_{1},\cdots,A_{N_{a}-1}\}
q(A_{N_{a}}|s_{0})=0
q_{mix}^{\pi,\alpha}=\alpha\pi+(1-\alpha)q
\alpha=1/{N_{a}}
\pi(A_{N_{a}}|s_{0})=1
q_{mix}^{\pi,\alpha}
A_{N_{a}}
\alpha
\alpha
\pi
Q^{\pi}
Q
Q_{k+1}=\mathcal{T}^{\pi}Q_{k}
k\geq 0
\pi
Q_{0}
Q
R^{\pi,\alpha}(s_{t},a_{t})\in(0,1)
(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
\{Q_{k}\}
Q^{\pi}
r_{\pi,t}:=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+1}\sim P}[\mathbb{E}_{a%
_{t+1}\sim\pi}[\alpha\log R^{\pi,\alpha}(s_{t+1},a_{t+1})-\alpha\log\alpha\pi(%
a_{t+1}|s_{t+1})]+(1-\alpha)\mathbb{E}_{a_{t+1}\sim q}[\log R^{\pi,\alpha}(s_{%
t+1},a_{t+1})-\log\alpha\pi(a_{t+1}|s_{t+1})]]
Q^{\pi}
\mathcal{T}^{\pi}Q(s_{t},a_{t})=r_{\pi,t}+\gamma\mathbb{E}_{s+1\sim P,~{}a_{t+%
1\sim\pi}}[Q(s_{t+1},a_{t+1})]
R^{\pi,\alpha}\in(0,1)
r_{\pi,t}
\square
\pi_{new}
\pi_{new}=\underset{\pi}{\arg\max}~{}J_{\pi_{old}}(\pi)
J_{\pi_{old}}(\pi)
Q^{\pi_{new}}(s_{t},a_{t})\geq Q^{\pi_{old}}(s_{t},a_{t})
\forall~{}(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
\pi_{new}=\underset{\pi}{\arg\max}~{}J_{\pi_{old}}(\pi)
J_{\pi_{old}}(\pi_{new})\geq J_{\pi_{old}}(\pi_{old})
J_{\pi_{old}}(\pi_{new})
J_{\pi_{old}}(\pi_{old})
J_{\pi_{old}}(\pi)
\displaystyle J_{\pi_{old}}(\pi_{new}(\cdot|s_{t}))=\mathbb{E}_{a_{t}\sim\pi_{%
new}}[Q^{\pi_{old}}(s_{t},a_{t})+\alpha\log R^{\pi_{new},\alpha}(s_{t},a_{t})-%
\alpha\log\alpha\pi_{new}(a_{t}|s_{t})]
\displaystyle J_{\pi_{old}}(\pi_{new}(\cdot|s_{t}))
\displaystyle=\mathbb{E}_{a_{t}\sim\pi_{new}}[Q^{\pi_{old}}(s_{t},a_{t})+%
\alpha\log R^{\pi_{new},\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{new}(a_{t}|s%
_{t})]
\displaystyle\quad\quad\quad\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{%
\pi_{new},\alpha}(s_{t},a_{t})-\log\alpha\pi_{new}(a_{t}|s_{t})]
\displaystyle\quad\quad\quad\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{%
\pi_{new},\alpha}(s_{t},a_{t})-\log\alpha\pi_{new}(a_{t}|s_{t})]
\displaystyle\geq J_{\pi_{old}}(\pi_{old}(\cdot|s_{t}))
\displaystyle\geq J_{\pi_{old}}(\pi_{old}(\cdot|s_{t}))
\displaystyle=\mathbb{E}_{a_{t}\sim\pi_{old}}[Q^{\pi_{old}}(s_{t},a_{t})+%
\alpha\log R^{\pi_{old},\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{old}(a_{t}|s%
_{t})]
\displaystyle=\mathbb{E}_{a_{t}\sim\pi_{old}}[Q^{\pi_{old}}(s_{t},a_{t})+%
\alpha\log R^{\pi_{old},\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{old}(a_{t}|s%
_{t})]
\displaystyle\quad\quad\quad\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{%
\pi_{old},\alpha}(s_{t},a_{t})-\log\alpha\pi_{old}(a_{t}|s_{t})]
\displaystyle\quad\quad\quad\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{%
\pi_{old},\alpha}(s_{t},a_{t})-\log\alpha\pi_{old}(a_{t}|s_{t})]
\displaystyle=V^{\pi_{old}}(s_{t})
\displaystyle=V^{\pi_{old}}(s_{t})
V^{\pi}(s_{t})
\displaystyle Q^{\pi_{old}}(s_{t},a_{t})=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}%
_{s_{t+1}\sim P}[V^{\pi_{old}}(s_{t+1})]
\displaystyle Q^{\pi_{old}}(s_{t},a_{t})=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}%
_{s_{t+1}\sim P}[V^{\pi_{old}}(s_{t+1})]
\displaystyle\quad\stackrel{{\scriptstyle(a)}}{{\leq}}\frac{1}{\beta}r_{t}+%
\gamma\mathbb{E}_{s_{t+1}\sim P}\{\mathbb{E}_{a_{t+1}\sim\pi_{new}}[%
\underbrace{Q^{\pi_{old}}(s_{t+1},a_{t+1})}_{=\frac{1}{\beta}r_{t+1}+\gamma%
\mathbb{E}_{s_{t+2}\sim P}[V^{\pi_{old}}(s_{t+2})]}+\alpha\log R^{\pi_{new},%
\alpha}(s_{t+1},a_{t+1})-\alpha\log\alpha\pi_{new}(a_{t+1}|s_{t+1})]
\displaystyle\quad\stackrel{{\scriptstyle(a)}}{{\leq}}\frac{1}{\beta}r_{t}+%
\gamma\mathbb{E}_{s_{t+1}\sim P}\{\mathbb{E}_{a_{t+1}\sim\pi_{new}}[%
\underbrace{Q^{\pi_{old}}(s_{t+1},a_{t+1})}_{=\frac{1}{\beta}r_{t+1}+\gamma%
\mathbb{E}_{s_{t+2}\sim P}[V^{\pi_{old}}(s_{t+2})]}+\alpha\log R^{\pi_{new},%
\alpha}(s_{t+1},a_{t+1})-\alpha\log\alpha\pi_{new}(a_{t+1}|s_{t+1})]
\displaystyle\hskip 90.00015pt+(1-\alpha)\mathbb{E}_{a_{t+1}\sim q}[\log R^{%
\pi_{new},\alpha}(s_{t+1},a_{t+1})-\log\alpha\pi_{new}(a_{t+1}|s_{t+1})]\}
\displaystyle\hskip 90.00015pt+(1-\alpha)\mathbb{E}_{a_{t+1}\sim q}[\log R^{%
\pi_{new},\alpha}(s_{t+1},a_{t+1})-\log\alpha\pi_{new}(a_{t+1}|s_{t+1})]\}
\displaystyle\quad~{}~{}\vdots
\displaystyle\quad~{}~{}\vdots
\displaystyle\quad\leq Q^{\pi_{new}}(s_{t},a_{t}),~{}~{}~{}\mbox{for each $(s_%
{t},a_{t})\in\mathcal{S}\times\mathcal{A}$},
(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
\displaystyle\quad\leq Q^{\pi_{new}}(s_{t},a_{t}),~{}~{}~{}\mbox{for each $(s_%
{t},a_{t})\in\mathcal{S}\times\mathcal{A}$},
(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
V^{\pi_{old}}(s_{t+1})
Q^{\pi_{old}}(s_{t+1},a_{t+1})
\frac{1}{\beta}r_{t+1}+\gamma\mathbb{E}_{s_{t+2}\sim P}[V^{\pi_{old}}(s_{t+2})]
V^{\pi_{old}}(s_{t+2})
\square
\pi^{*}
Q^{\pi^{*}}(s_{t},a_{t})\geq Q^{\pi^{\prime}}(s_{t},a_{t})
\forall~{}\pi^{\prime}\in\Pi
\forall~{}(s_{t},a_{t})\in\mathcal{S}\times\mathcal{A}
\pi^{*}
J
J_{\pi^{*}}(\pi^{*})\geq J_{\pi}(\pi)
\pi\in\Pi
\Pi
\{\pi_{i},i=0,1,2,\cdots|~{}\pi_{i}\in\Pi\}
\pi_{i+1}=\mathop{\arg\max}_{\pi\in\Pi}J_{\pi_{i}}(\pi)~{}~{}~{}~{}~{}~{}~{}~{%
}\mbox{with an arbitrary initial policy}~{}\pi_{0},
J_{\pi_{i}}(\pi)
\{\pi_{i},i=0,1,2,\cdots\}
\mathcal{S}
\{\pi_{i},i=0,1,2,\cdots\}
(s,a)\in\mathcal{S}\times\mathcal{A}
Q^{\pi_{i}}(s,a)
\gamma
\{Q^{\pi_{i}}(s,a),i=0,1,2,\cdots\}
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))
J_{\pi_{i}}(\pi_{i+1}(\cdot|s))
J_{\pi_{old}}(\pi)
\displaystyle J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))=\beta\{\mathbb{E}_{a\sim\pi_{i%
+1}}\left[Q^{\pi_{i+1}}(s,a)+\alpha(\log R^{\pi_{i+1},\alpha}(s,a)-\log\alpha%
\pi_{i+1}(a|s))\right]
\displaystyle J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))
\displaystyle=\beta\{\mathbb{E}_{a\sim\pi_{i+1}}\left[Q^{\pi_{i+1}}(s,a)+%
\alpha(\log R^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{i+1}(a|s))\right]
\displaystyle~{}~{}\hskip 20.00003pt+(1-\alpha)\mathbb{E}_{a\sim q}\left[\log R%
^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{i+1}(a|s)\right]\}
\displaystyle~{}~{}\hskip 20.00003pt+(1-\alpha)\mathbb{E}_{a\sim q}\left[\log R%
^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{i+1}(a|s)\right]\}
\displaystyle J_{\pi_{i}}(\pi_{i+1}(\cdot|s))=\beta\{\mathbb{E}_{a\sim\pi_{i+1%
}}\left[Q^{\pi_{i}}(s,a)+\alpha(\log R^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{%
i+1}(a|s))\right]
\displaystyle J_{\pi_{i}}(\pi_{i+1}(\cdot|s))
\displaystyle=\beta\{\mathbb{E}_{a\sim\pi_{i+1}}\left[Q^{\pi_{i}}(s,a)+\alpha(%
\log R^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{i+1}(a|s))\right]
\displaystyle~{}~{}\hskip 20.00003pt+(1-\alpha)\mathbb{E}_{a\sim q}\left[\log R%
^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{i+1}(a|s)\right]\}.
\displaystyle~{}~{}\hskip 20.00003pt+(1-\alpha)\mathbb{E}_{a\sim q}\left[\log R%
^{\pi_{i+1},\alpha}(s,a)-\log\alpha\pi_{i+1}(a|s)\right]\}.
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))
J_{\pi_{i}}(\pi_{i+1}(\cdot|s))
\beta\mathbb{E}_{a\sim\pi_{i+1}}[Q^{\pi_{i+1}}(s,a)]
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))
\beta\mathbb{E}_{a\sim\pi_{i+1}}[Q^{\pi_{i}}(s,a)]
J_{\pi_{i}}(\pi_{i+1}(\cdot|s))
\{Q^{\pi_{i}}(s,a),i=0,1,2,\cdots\}
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))\geq J_{\pi_{i}}(\pi_{i+1}(\cdot|s)).
s\in\mathcal{S}
J_{\pi_{i}}(\pi_{i+1}(\cdot|s))\geq J_{\pi_{i}}(\pi_{i}(\cdot|s))
\pi_{i+1}
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s))\geq J_{\pi_{i}}(\pi_{i+1}(\cdot|s))\geq J_{%
\pi_{i}}(\pi_{i}(\cdot|s))
s\in\mathcal{S}
\{J_{\pi_{i}}(\pi_{i}(\cdot|s)),i=0,1,2,\cdots\}
s\in\mathcal{S}
J_{\pi_{i}}(\pi_{i}(\cdot|s))
i
Q
\mathbb{E}_{a\sim\pi_{i+1}}[Q^{\pi_{i+1}}(s,a)]
\mathcal{H}(q_{mix}^{\pi_{i+1},\alpha})
J_{\pi_{i}}(\pi_{i})
\pi_{old}=\pi_{i}
\pi=\pi_{i}
J(\pi_{i})
J
\{J_{\pi_{i}}(\pi_{i})\}
J
\{\pi_{i},i=0,1,2,\cdots\}
\{Q^{\pi_{i}}(s,a),i=0,1,2,\cdots\}
\{J_{\pi_{i}}(\pi_{i}(\cdot|s)),i=0,1,2,\cdots\}
Q^{*}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
J^{*}:\mathcal{S}\rightarrow\mathbb{R}
J^{*}(s)\geq J_{\pi_{i}}(\pi_{i}(\cdot|s))
i
\{J_{\pi_{i}}(\pi_{i}(\cdot|s)),i=0,1,2,\cdots\}
s\in\mathcal{S}
\epsilon>0
{N}(s)(>0)
s
J_{\pi_{i}}(\pi_{i}(\cdot|s))\geq J^{*}(s)-\frac{\epsilon(1-\gamma)}{\gamma}
i\geq{N}(s)
\mathcal{S}
\bar{N}=\max_{s}N(s)
J_{\pi_{i}}(\pi_{i}(\cdot|s))\geq J^{*}(s)-\frac{\epsilon(1-\gamma)}{\gamma},~%
{}~{}~{}\forall s\in\mathcal{S},~{}\forall i\geq\bar{N}
J_{\pi_{i}}(\pi_{i}(\cdot|s))\geq J_{\pi_{i}}(\pi^{\prime}(\cdot|s))-\frac{%
\epsilon(1-\gamma)}{\gamma},~{}~{}~{}~{}\forall s\in\mathcal{S},~{}\forall i%
\geq\bar{N},~{}\forall\pi^{\prime}\in\Pi.
s^{\prime}\in\mathcal{S}
\pi^{\prime}\in\Pi
J_{\pi_{i}}(\pi^{\prime}(\cdot|s^{\prime}))\stackrel{{\scriptstyle(b)}}{{>}}J_%
{\pi_{i}}(\pi_{i}(\cdot|s^{\prime}))+\frac{\epsilon(1-\gamma)}{\gamma}%
\stackrel{{\scriptstyle(c)}}{{\geq}}J^{*}(s^{\prime}),
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s^{\prime}))\stackrel{{\scriptstyle(d)}}{{\geq}}%
J_{\pi_{i}}(\pi_{i+1}(\cdot|s^{\prime}))=\max_{\pi}J_{\pi_{i}}(\pi(\cdot|s^{%
\prime}))\stackrel{{\scriptstyle(e)}}{{\geq}}J_{\pi_{i}}(\pi^{\prime}(\cdot|s^%
{\prime})),
\pi_{i+1}
J_{\pi_{i+1}}(\pi_{i+1}(\cdot|s^{\prime}))\geq J_{\pi_{i}}(\pi_{i+1}(\cdot|s^{%
\prime}))\geq J_{\pi_{i}}(\pi^{\prime}(\cdot|s^{\prime}))>J_{\pi_{i}}(\pi_{i}(%
\cdot|s^{\prime}))+\frac{\epsilon(1-\gamma)}{\gamma}\geq J^{*}(s^{\prime}).
J^{*}(s^{\prime})
J_{\pi_{i}}(\pi_{i}(\cdot|s^{\prime}))
Q^{\pi_{i}}(s_{t},a_{t})
(s_{t},a_{t})
i\geq\bar{N}
\displaystyle Q^{\pi_{i}}(s_{t},a_{t})=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{%
s_{t+1}\sim P}[V^{\pi_{i}}(s_{t+1})]
\displaystyle Q^{\pi_{i}}(s_{t},a_{t})
\displaystyle=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+1}\sim P}[V^{\pi_{i}%
}(s_{t+1})]
\displaystyle=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+1}\sim P}[J_{\pi_{i}%
}(\pi_{i}(\cdot|s_{t+1}))]
\displaystyle=\frac{1}{\beta}r_{t}+\gamma\mathbb{E}_{s_{t+1}\sim P}[J_{\pi_{i}%
}(\pi_{i}(\cdot|s_{t+1}))]
\displaystyle\stackrel{{\scriptstyle(f)}}{{\geq}}\frac{1}{\beta}r_{t}+\gamma%
\mathbb{E}_{s_{t+1}\sim P}\left[J_{\pi_{i}}(\pi^{\prime}(\cdot|s_{t+1}))-\frac%
{\epsilon(1-\gamma)}{\gamma}\right],~{}~{}~{}\forall\pi^{\prime}\in\Pi,
\displaystyle\stackrel{{\scriptstyle(f)}}{{\geq}}\frac{1}{\beta}r_{t}+\gamma%
\mathbb{E}_{s_{t+1}\sim P}\left[J_{\pi_{i}}(\pi^{\prime}(\cdot|s_{t+1}))-\frac%
{\epsilon(1-\gamma)}{\gamma}\right],~{}~{}~{}\forall\pi^{\prime}\in\Pi,
\displaystyle\stackrel{{\scriptstyle(g)}}{{=}}\frac{1}{\beta}r_{t}+\gamma%
\mathbb{E}_{s_{t+1}\sim P}\{\mathbb{E}_{a_{t+1}\sim\pi}[Q^{\pi_{i}}(s_{t+1},a_%
{t+1})+\alpha\log R^{\pi^{\prime},\alpha}(s_{t+1},a_{t+1})-\alpha\log\alpha\pi%
^{\prime}(a_{t+1}|s_{t+1})]
\displaystyle\stackrel{{\scriptstyle(g)}}{{=}}\frac{1}{\beta}r_{t}+\gamma%
\mathbb{E}_{s_{t+1}\sim P}\{\mathbb{E}_{a_{t+1}\sim\pi}[Q^{\pi_{i}}(s_{t+1},a_%
{t+1})+\alpha\log R^{\pi^{\prime},\alpha}(s_{t+1},a_{t+1})-\alpha\log\alpha\pi%
^{\prime}(a_{t+1}|s_{t+1})]
\displaystyle\hskip 90.00014pt+(1-\alpha)\mathbb{E}_{a_{t+1}\sim q}[\log R^{%
\pi^{\prime},\alpha}(s_{t+1},a_{t+1})-\log\alpha\pi^{\prime}(a_{t+1}|s_{t+1})]%
\}-\epsilon(1-\gamma)
\displaystyle\hskip 90.00014pt+(1-\alpha)\mathbb{E}_{a_{t+1}\sim q}[\log R^{%
\pi^{\prime},\alpha}(s_{t+1},a_{t+1})-\log\alpha\pi^{\prime}(a_{t+1}|s_{t+1})]%
\}-\epsilon(1-\gamma)
\displaystyle~{}~{}\vdots
\displaystyle~{}~{}\vdots
\displaystyle\stackrel{{\scriptstyle(h)}}{{\geq}}Q^{\pi^{\prime}}(s_{t},a_{t})%
-\epsilon,~{}~{}~{}\forall\pi^{\prime}\in\Pi,
\displaystyle\stackrel{{\scriptstyle(h)}}{{\geq}}Q^{\pi^{\prime}}(s_{t},a_{t})%
-\epsilon,~{}~{}~{}\forall\pi^{\prime}\in\Pi,
J_{\pi_{i}}(\pi^{\prime})
Q^{\pi_{i}}(s_{t+1},a_{t+1})
Q^{\pi_{i}}(s_{t+1},a_{t+1})=\frac{1}{\beta}r_{t+1}+\gamma\mathbb{E}_{s_{t+2}%
\sim P}[V^{\pi_{i}}(s_{t+2})]
V^{\pi_{i}}(s_{t+2})=J_{\pi_{i}}(\pi_{i}(\cdot|s_{t+2}))
-\epsilon(1-\gamma)-\epsilon\gamma(1-\gamma)-\epsilon\gamma^{2}(1-\gamma)-%
\cdots=-\epsilon
\forall s\in\mathcal{S}
J_{\pi_{i}}(\pi_{i}(\cdot|s_{t+1})),~{}J_{\pi_{i}}(\pi_{i}(\cdot|s_{t+2})),~{}%
J_{\pi_{i}}(\pi_{i}(\cdot|s_{t+3})),~{}\cdots
J_{\pi_{i}}(\pi^{\prime}(\cdot|s_{t+1})),~{}J_{\pi_{i}}(\pi^{\prime}(\cdot|s_{%
t+2})),~{}J_{\pi_{i}}(\pi^{\prime}(\cdot|s_{t+3})),~{}\cdots
s_{t+1},~{}s_{t+2},~{}s_{t+3},\cdots
\mathcal{S}
\epsilon>0
i\rightarrow\infty
Q^{\pi_{\infty}}(s,a)\geq Q^{\pi^{\prime}}(s,a),~{}~{}~{}\forall\pi^{\prime}%
\in\Pi,~{}~{}~{}\forall~{}(s,a)\in\mathcal{S}\times\mathcal{A}
\{Q^{\pi_{i}}(s,a),i=0,1,2,\cdots\}
J_{\pi^{\prime}}(\pi^{\prime}(\cdot|s))
J_{\pi_{\infty}}(\pi^{\prime}(\cdot|s))
Q^{\pi_{\infty}}(s,a)
Q^{\pi^{\prime}}(s,a)
J_{\pi^{\prime}}(\pi^{\prime}(\cdot|s))
J_{\pi_{\infty}}(\pi^{\prime}(\cdot|s))
J_{\pi_{\infty}}(\pi^{\prime}(\cdot|s))\geq J_{\pi^{\prime}}(\pi^{\prime}(%
\cdot|s))
J_{\pi_{i}}(\pi_{i}(\cdot|s))\geq J_{\pi_{i}}(\pi^{\prime}(\cdot|s))-\frac{%
\epsilon(1-\gamma)}{\gamma}
\epsilon>0
i\rightarrow\infty
J_{\pi_{\infty}}(\pi_{\infty}(\cdot|s))\geq J_{\pi_{\infty}}(\pi^{\prime}(%
\cdot|s)).
J_{\pi_{\infty}}(\pi_{\infty}(\cdot|s))\geq J_{\pi_{\infty}}(\pi^{\prime}(%
\cdot|s))\geq J_{\pi^{\prime}}(\pi^{\prime}(\cdot|s)),~{}~{}\forall~{}\pi^{%
\prime}\in\Pi,~{}~{}~{}\forall~{}s\in\mathcal{S}.
J_{\pi}(\pi)
\pi_{old}=\pi
\pi=\pi
J(\pi)
J
\pi_{\infty}
\pi^{*}
J
\{\pi_{i}\}
\pi^{*}
\square
J_{\pi_{i}}(\pi_{i}(\cdot|s))\rightarrow J^{*}(s)
s
J_{\pi_{old}}(\pi)
\displaystyle J_{\pi_{old}}(\pi(\cdot|s_{t})):=\beta\{\mathbb{E}_{a_{t}\sim\pi%
}\left[Q^{\pi_{old}}(s_{t},a_{t})+\alpha(\log R^{\pi,\alpha}(s_{t},a_{t})-\log%
\alpha\pi(a_{t}|s_{t}))\right]
\displaystyle J_{\pi_{old}}(\pi(\cdot|s_{t})):=\beta\{\mathbb{E}_{a_{t}\sim\pi%
}\left[Q^{\pi_{old}}(s_{t},a_{t})+\alpha(\log R^{\pi,\alpha}(s_{t},a_{t})-\log%
\alpha\pi(a_{t}|s_{t}))\right]
\displaystyle~{}~{}\hskip 110.00017pt+(1-\alpha)\mathbb{E}_{a_{t}\sim q}\left[%
\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})\right]\},
\displaystyle~{}~{}\hskip 110.00017pt+(1-\alpha)\mathbb{E}_{a_{t}\sim q}\left[%
\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})\right]\},
\pi
R^{\pi,\alpha}
R^{\pi,\alpha}(s_{t},a_{t})
\pi
J_{\pi_{old}}(\pi)
\tilde{J}_{\pi_{old}}(\pi)
R^{\pi_{old},\alpha}(s_{t},a_{t})
\pi_{old}
J_{\pi_{old}}(\pi)
\tilde{J}_{\pi_{old}}(\pi)
\theta=\theta_{old}
\pi_{\theta}
R^{\pi,\alpha}(s_{t},a_{t})
\log R^{\pi,\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t})=\log(1-R^{\pi,%
\alpha}(s_{t},a_{t}))-\log((1-\alpha)q(a_{t}|s_{t}))
R^{\pi,\alpha}(s_{t},a_{t})=\frac{\alpha\pi(a_{t}|s_{t})}{\alpha\pi(a_{t}|s_{t%
})+(1-\alpha)q(a_{t}|s_{t})},
1-R^{\pi,\alpha}(s_{t},a_{t})=\frac{(1-\alpha)q(a_{t}|s_{t})}{\alpha\pi(a_{t}|%
s_{t})+(1-\alpha)q(a_{t}|s_{t})}.
\displaystyle\log\frac{1}{\alpha\pi(a_{t}|s_{t})+(1-\alpha)q(a_{t}|s_{t})}=%
\log R^{\pi,\alpha}(s_{t},a_{t})-\log(\alpha\pi(a_{t}|s_{t}))
\displaystyle\log\frac{1}{\alpha\pi(a_{t}|s_{t})+(1-\alpha)q(a_{t}|s_{t})}
\displaystyle=\log R^{\pi,\alpha}(s_{t},a_{t})-\log(\alpha\pi(a_{t}|s_{t}))
\displaystyle=\log(1-R^{\pi,\alpha}(s_{t},a_{t}))-\log((1-\alpha)q(a_{t}|s_{t}%
)).
\displaystyle=\log(1-R^{\pi,\alpha}(s_{t},a_{t}))-\log((1-\alpha)q(a_{t}|s_{t}%
)).
\square
\tilde{J}_{\pi_{old}}(\pi(\cdot|s_{t}))
\pi_{old}
\theta
\pi_{\theta}
J_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\tilde{J}_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\theta
\theta=\theta_{old}
s_{t}\in\mathcal{S}
\theta_{old}
\pi_{old}
\pi_{\theta}
\displaystyle J_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))=\beta(\mathbb{%
E}_{a_{t}\sim\pi_{\theta}}[Q^{\pi_{\theta_{old}}}(s_{t},a_{t})+\alpha\log R^{%
\pi_{\theta},\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle J_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\displaystyle=\beta(\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q^{\pi_{\theta_{old}}}(%
s_{t},a_{t})+\alpha\log R^{\pi_{\theta},\alpha}(s_{t},a_{t})-\alpha\log\alpha%
\pi_{\theta}(a_{t}|s_{t})]
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{\pi_{\theta},\alpha}(%
s_{t},a_{t})-\log\alpha\pi_{\theta}(a_{t}|s_{t})])
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log R^{\pi_{\theta},\alpha}(%
s_{t},a_{t})-\log\alpha\pi_{\theta}(a_{t}|s_{t})])
\displaystyle\stackrel{{\scriptstyle(1)}}{{=}}\beta(\mathbb{E}_{a_{t}\sim\pi_{%
\theta}}[Q^{\pi_{\theta_{old}}}(s_{t},a_{t})+\alpha\log R^{\pi_{\theta},\alpha%
}(s_{t},a_{t})-\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle\stackrel{{\scriptstyle(1)}}{{=}}\beta(\mathbb{E}_{a_{t}\sim\pi_{%
\theta}}[Q^{\pi_{\theta_{old}}}(s_{t},a_{t})+\alpha\log R^{\pi_{\theta},\alpha%
}(s_{t},a_{t})-\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log(1-R^{\pi_{\theta},\alpha%
}(s_{t},a_{t}))-\log(1-\alpha)q(a_{t}|s_{t})])
\displaystyle+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log(1-R^{\pi_{\theta},\alpha%
}(s_{t},a_{t}))-\log(1-\alpha)q(a_{t}|s_{t})])
\displaystyle\tilde{J}_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))=\beta%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q^{\pi_{\theta_{old}}}(s_{t},a_{t})+\alpha%
\log R^{\pi_{\theta_{old}},\alpha}(s_{t},a_{t})-\alpha\log\pi_{\theta}(a_{t}|s%
_{t})],
\displaystyle\tilde{J}_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\displaystyle=\beta\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q^{\pi_{\theta_{old}}}(s%
_{t},a_{t})+\alpha\log R^{\pi_{\theta_{old}},\alpha}(s_{t},a_{t})-\alpha\log%
\pi_{\theta}(a_{t}|s_{t})],
(1)
Q^{\pi_{\theta_{old}}}
\log\pi_{\theta}
\theta
\nabla_{\theta}\{\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\log R^{\pi_{\theta}%
,\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log(1-R^{\pi_{\theta},\alpha})]%
\}=\nabla_{\theta}\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\alpha\log R^{\pi_{\theta%
_{old}},\alpha}]
\theta=\theta_{old}
\theta=\theta_{old}
\displaystyle\nabla_{\theta}\{\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\log R^%
{\pi_{\theta},\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log(1-R^{\pi_{%
\theta},\alpha})]\}
\displaystyle\nabla_{\theta}\{\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\log R^%
{\pi_{\theta},\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\log(1-R^{\pi_{%
\theta},\alpha})]\}
\displaystyle=\nabla_{\theta}\left\{\alpha\int_{a_{t}}\pi_{\theta}\log R^{\pi_%
{\theta},\alpha}da_{t}+(1-\alpha)\int_{a_{t}}q\log(1-R^{\pi_{\theta},\alpha})%
da_{t}\right\}
\displaystyle=\nabla_{\theta}\left\{\alpha\int_{a_{t}}\pi_{\theta}\log R^{\pi_%
{\theta},\alpha}da_{t}+(1-\alpha)\int_{a_{t}}q\log(1-R^{\pi_{\theta},\alpha})%
da_{t}\right\}
\displaystyle=\alpha\int_{a_{t}}(\nabla_{\theta}\pi_{\theta})\log R^{\pi_{%
\theta},\alpha}da_{t}+\alpha\int_{a_{t}}\pi_{\theta}(\nabla_{\theta}\log R^{%
\pi_{\theta},\alpha})da_{t}+(1-\alpha)\int_{a_{t}}q\nabla_{\theta}\log(1-R^{%
\pi_{\theta},\alpha})da_{t}
\displaystyle=\alpha\int_{a_{t}}(\nabla_{\theta}\pi_{\theta})\log R^{\pi_{%
\theta},\alpha}da_{t}+\alpha\int_{a_{t}}\pi_{\theta}(\nabla_{\theta}\log R^{%
\pi_{\theta},\alpha})da_{t}+(1-\alpha)\int_{a_{t}}q\nabla_{\theta}\log(1-R^{%
\pi_{\theta},\alpha})da_{t}
\displaystyle=\alpha\int_{a_{t}}(\nabla_{\theta}\pi_{\theta})|_{\theta=\theta_%
{old}}\log R^{\pi_{\theta},\alpha}|_{\theta=\theta_{old}}da_{t}+\alpha\int_{a_%
{t}}\pi_{\theta}(\nabla_{\theta}\log R^{\pi_{\theta},\alpha})da_{t}+(1-\alpha)%
\int_{a_{t}}q\nabla_{\theta}\log(1-R^{\pi_{\theta},\alpha})da_{t}
\displaystyle=\alpha\int_{a_{t}}(\nabla_{\theta}\pi_{\theta})|_{\theta=\theta_%
{old}}\log R^{\pi_{\theta},\alpha}|_{\theta=\theta_{old}}da_{t}+\alpha\int_{a_%
{t}}\pi_{\theta}(\nabla_{\theta}\log R^{\pi_{\theta},\alpha})da_{t}+(1-\alpha)%
\int_{a_{t}}q\nabla_{\theta}\log(1-R^{\pi_{\theta},\alpha})da_{t}
\displaystyle=\alpha\nabla_{\theta}\int_{a_{t}}\pi_{\theta}\log R^{\pi_{\theta%
_{old}},\alpha}da_{t}+\alpha\int_{a_{t}}\pi_{\theta}(\nabla_{\theta}\log R^{%
\pi_{\theta},\alpha})da_{t}+(1-\alpha)\int_{a_{t}}q\nabla_{\theta}\log(1-R^{%
\pi_{\theta},\alpha})da_{t}
\displaystyle=\alpha\nabla_{\theta}\int_{a_{t}}\pi_{\theta}\log R^{\pi_{\theta%
_{old}},\alpha}da_{t}+\alpha\int_{a_{t}}\pi_{\theta}(\nabla_{\theta}\log R^{%
\pi_{\theta},\alpha})da_{t}+(1-\alpha)\int_{a_{t}}q\nabla_{\theta}\log(1-R^{%
\pi_{\theta},\alpha})da_{t}
\displaystyle=\nabla_{\theta}\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\alpha\log R^{%
\pi_{\theta_{old}},\alpha}]+\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\nabla_{%
\theta}\log R^{\pi_{\theta},\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\nabla%
_{\theta}\log(1-R^{\pi_{\theta},\alpha})].
\displaystyle=\nabla_{\theta}\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\alpha\log R^{%
\pi_{\theta_{old}},\alpha}]+\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\nabla_{%
\theta}\log R^{\pi_{\theta},\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\nabla%
_{\theta}\log(1-R^{\pi_{\theta},\alpha})].
\displaystyle\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\nabla_{\theta}\log R^{%
\pi_{\theta},\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\nabla_{\theta}\log(1%
-R^{\pi_{\theta},\alpha})]
\displaystyle\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}[\nabla_{\theta}\log R^{%
\pi_{\theta},\alpha}]+(1-\alpha)\mathbb{E}_{a_{t}\sim q}[\nabla_{\theta}\log(1%
-R^{\pi_{\theta},\alpha})]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]+(1-\alpha)%
\mathbb{E}_{a_{t}\sim q}\left[\frac{\nabla_{\theta}(1-R^{\pi_{\theta},\alpha})%
}{(1-R^{\pi_{\theta},\alpha})}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]+(1-\alpha)%
\mathbb{E}_{a_{t}\sim q}\left[\frac{\nabla_{\theta}(1-R^{\pi_{\theta},\alpha})%
}{(1-R^{\pi_{\theta},\alpha})}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-(1-\alpha)%
\mathbb{E}_{a_{t}\sim q}\left[\frac{\nabla_{\theta}R^{\pi_{\theta},\alpha}}{(1%
-R^{\pi_{\theta},\alpha})}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-(1-\alpha)%
\mathbb{E}_{a_{t}\sim q}\left[\frac{\nabla_{\theta}R^{\pi_{\theta},\alpha}}{(1%
-R^{\pi_{\theta},\alpha})}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-(1-\alpha)%
\mathbb{E}_{a_{t}\sim q}\left[\frac{\alpha\pi_{\theta}+(1-\alpha)q}{(1-\alpha)%
q}\cdot\nabla_{\theta}R^{\pi_{\theta},\alpha}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-(1-\alpha)%
\mathbb{E}_{a_{t}\sim q}\left[\frac{\alpha\pi_{\theta}+(1-\alpha)q}{(1-\alpha)%
q}\cdot\nabla_{\theta}R^{\pi_{\theta},\alpha}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-\mathbb{E}_{a_%
{t}\sim q}\left[\frac{\alpha\pi_{\theta}+(1-\alpha)q}{q}\cdot\nabla_{\theta}R^%
{\pi_{\theta},\alpha}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-\mathbb{E}_{a_%
{t}\sim q}\left[\frac{\alpha\pi_{\theta}+(1-\alpha)q}{q}\cdot\nabla_{\theta}R^%
{\pi_{\theta},\alpha}\right]
\displaystyle\stackrel{{\scriptstyle(2)}}{{=}}\alpha\mathbb{E}_{a_{t}\sim\pi_{%
\theta}}\left[\frac{\nabla_{\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},%
\alpha}}\right]-\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\pi_{\theta}+(1-%
\alpha)q}{\pi_{\theta}}\cdot\nabla_{\theta}R^{\pi_{\theta},\alpha}\right]
\displaystyle\stackrel{{\scriptstyle(2)}}{{=}}\alpha\mathbb{E}_{a_{t}\sim\pi_{%
\theta}}\left[\frac{\nabla_{\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},%
\alpha}}\right]-\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\pi_{\theta}+(1-%
\alpha)q}{\pi_{\theta}}\cdot\nabla_{\theta}R^{\pi_{\theta},\alpha}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-\alpha\mathbb{%
E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\pi_{\theta}+(1-\alpha)q}{\alpha\pi_{%
\theta}}\cdot\nabla_{\theta}R^{\pi_{\theta},\alpha}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-\alpha\mathbb{%
E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\pi_{\theta}+(1-\alpha)q}{\alpha\pi_{%
\theta}}\cdot\nabla_{\theta}R^{\pi_{\theta},\alpha}\right]
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-\alpha\mathbb{%
E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{\theta}R^{\pi_{\theta},\alpha}}{%
R^{\pi_{\theta},\alpha}}\right]=0,
\displaystyle=\alpha\mathbb{E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{%
\theta}R^{\pi_{\theta},\alpha}}{R^{\pi_{\theta},\alpha}}\right]-\alpha\mathbb{%
E}_{a_{t}\sim\pi_{\theta}}\left[\frac{\nabla_{\theta}R^{\pi_{\theta},\alpha}}{%
R^{\pi_{\theta},\alpha}}\right]=0,
\mathbb{E}_{a_{t}\sim q}[f(s_{t},a_{t})]=\mathbb{E}_{a_{t}\sim\pi_{\theta}}%
\left[\frac{q(a_{t}|s_{t})}{\pi_{\theta}(a_{t}|s_{t})}f(s_{t},a_{t})\right]
(2)
J_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
J_{\pi_{\theta_{old}}}(\pi_{\theta}(\cdot|s_{t}))
\theta=\theta_{old}
\square
\hat{V}(s_{t})=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},a_{t})+\alpha%
\log R_{\eta}^{\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]%
+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\log R_{\eta}^{\alpha}(s_{t},a_{t%
})-\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\pi
\mathcal{D}
a_{t}\sim\mathcal{D}
\displaystyle\hat{V}(s_{t})=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},%
a_{t})+\alpha\log R_{\eta}^{\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{\theta}(%
a_{t}|s_{t})]
\displaystyle\hat{V}(s_{t})
\displaystyle=\mathbb{E}_{a_{t}\sim\pi_{\theta}}[Q_{\phi}(s_{t},a_{t})+\alpha%
\log R_{\eta}^{\alpha}(s_{t},a_{t})-\alpha\log\alpha\pi_{\theta}(a_{t}|s_{t})]
\displaystyle\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\mathrm{clip}(%
\log R_{\eta}^{\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t});-d,d)],
\displaystyle\quad+(1-\alpha)\mathbb{E}_{a_{t}\sim\mathcal{D}}[\mathrm{clip}(%
\log R_{\eta}^{\alpha}(s_{t},a_{t})-\log\alpha\pi(a_{t}|s_{t});-d,d)],
d=\mathrm{dim}(\mathcal{A})
\mathrm{clip}(x;-d,d)
[-d,d]
R^{\pi_{\theta},\alpha}\in(\epsilon,1-\epsilon)
\log R^{\pi_{\theta},\alpha}
\log(1-R^{\pi_{\theta},\alpha})
R^{\alpha}
(\epsilon,1-\epsilon)
\epsilon>0
q
\pi
\hat{J}_{\pi}(\theta)
a_{t}\sim\pi_{\theta}
\theta
a_{t}=f_{\theta}(\epsilon_{t};s_{t})
f
\theta
\epsilon_{t}
\mathcal{N}
\hat{J}_{\pi}(\theta)
\nabla_{\theta}\hat{J}_{\pi}(\theta)=\mathbb{E}_{s_{t}\sim\mathcal{D},~{}%
\epsilon_{t}\sim\mathcal{N}}[\nabla_{a}(Q_{\phi}(s_{t},a)+\alpha\log R_{\eta}^%
{\alpha}(s_{t},a)-\alpha\log\pi_{\theta}(a|s_{t}))|_{a=f_{\theta}(\epsilon_{t}%
;s_{t})}\nabla_{\theta}f_{\theta}(\epsilon_{t};s_{t})-\alpha(\nabla_{\theta}%
\log\pi_{\theta})(f_{\theta}(\epsilon_{t};s_{t})|s_{t})]
\alpha
\alpha
\alpha
s_{t}
\xi
\alpha=\alpha_{\xi}(s_{t})
\alpha_{\xi}(s_{t})
\xi
\alpha
\displaystyle\hat{L}_{\alpha}(\xi)=\mathbb{E}_{s_{t}\sim\mathcal{D}}[\mathcal{%
H}(q_{mix}^{\pi_{\theta},\alpha_{\xi}})-\alpha_{\xi}c]
\displaystyle\hat{L}_{\alpha}(\xi)
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D}}[\mathcal{H}(q_{mix}^{\pi_{%
\theta},\alpha_{\xi}})-\alpha_{\xi}c]
\alpha
\alpha
\alpha_{\xi}(s_{t})
\hat{L}_{\alpha}(\xi)
\xi
\displaystyle\nabla_{\xi}\hat{L}_{\alpha}(\xi)=\nabla_{\xi}\mathbb{E}_{s_{t}%
\sim\mathcal{D}}[\mathcal{H}(q_{mix}^{\pi_{\theta},\alpha_{\xi}})-\alpha_{\xi}c]
\displaystyle\nabla_{\xi}\hat{L}_{\alpha}(\xi)=\nabla_{\xi}\mathbb{E}_{s_{t}%
\sim\mathcal{D}}[\mathcal{H}(q_{mix}^{\pi_{\theta},\alpha_{\xi}})-\alpha_{\xi}c]
\displaystyle=\nabla_{\xi}\mathbb{E}_{s_{t}\sim\mathcal{D}}[\alpha_{\xi}%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{%
\xi})q)-c]+(1-\alpha_{\xi})\mathbb{E}_{a_{t}\sim q}[-\log(\alpha_{\xi}\pi_{%
\theta}+(1-\alpha_{\xi})q)]]
\displaystyle=
\displaystyle\nabla_{\xi}\mathbb{E}_{s_{t}\sim\mathcal{D}}[\alpha_{\xi}\mathbb%
{E}_{a_{t}\sim\pi_{\theta}}[-\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi})q)-%
c]+(1-\alpha_{\xi})\mathbb{E}_{a_{t}\sim q}[-\log(\alpha_{\xi}\pi_{\theta}+(1-%
\alpha_{\xi})q)]]
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D}}[(\nabla_{\xi}\alpha_{\xi})(%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{%
\xi})q)-c]-\mathbb{E}_{a_{t}\sim q}[-\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{%
\xi})q)])]
\displaystyle=
\displaystyle\mathbb{E}_{s_{t}\sim\mathcal{D}}[(\nabla_{\xi}\alpha_{\xi})(%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{%
\xi})q)-c]-\mathbb{E}_{a_{t}\sim q}[-\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{%
\xi})q)])]
\displaystyle+\mathbb{E}_{s_{t}\sim\mathcal{D}}[\alpha_{\xi}\mathbb{E}_{a_{t}%
\sim\pi_{\theta}}[-\nabla_{\xi}\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi})q%
)]+(1-\alpha_{\xi})\mathbb{E}_{a_{t}\sim q}[-\nabla_{\xi}\log(\alpha_{\xi}\pi_%
{\theta}+(1-\alpha_{\xi})q)]]
\displaystyle+\mathbb{E}_{s_{t}\sim\mathcal{D}}[\alpha_{\xi}\mathbb{E}_{a_{t}%
\sim\pi_{\theta}}[-\nabla_{\xi}\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi})q%
)]+(1-\alpha_{\xi})\mathbb{E}_{a_{t}\sim q}[-\nabla_{\xi}\log(\alpha_{\xi}\pi_%
{\theta}+(1-\alpha_{\xi})q)]]
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D}}[(\nabla_{\xi}\alpha_{\xi})(%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log\alpha_{\xi}\pi_{\theta}+\log R^{\pi_{%
\theta},\alpha_{\xi}}-c]-\mathbb{E}_{a_{t}\sim q}[\log R^{\pi_{\theta},\alpha_%
{\xi}}-\log\alpha_{\xi}\pi_{\theta}])]
\displaystyle=
\displaystyle\mathbb{E}_{s_{t}\sim\mathcal{D}}[(\nabla_{\xi}\alpha_{\xi})(%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log\alpha_{\xi}\pi_{\theta}+\log R^{\pi_{%
\theta},\alpha_{\xi}}-c]-\mathbb{E}_{a_{t}\sim q}[\log R^{\pi_{\theta},\alpha_%
{\xi}}-\log\alpha_{\xi}\pi_{\theta}])]
\displaystyle+\mathbb{E}_{s_{t}\sim\mathcal{D}}\bigg{[}\underset{=0}{%
\underbrace{\int_{a_{t}\in\mathcal{A}}(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi%
})q)[-\nabla_{\xi}\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi})q)}}]\bigg{]}
\displaystyle+\mathbb{E}_{s_{t}\sim\mathcal{D}}\bigg{[}\underset{=0}{%
\underbrace{\int_{a_{t}\in\mathcal{A}}(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi%
})q)[-\nabla_{\xi}\log(\alpha_{\xi}\pi_{\theta}+(1-\alpha_{\xi})q)}}]\bigg{]}
\displaystyle=\mathbb{E}_{s_{t}\sim\mathcal{D}}[(\nabla_{\xi}\alpha_{\xi})(%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log\alpha_{\xi}\pi_{\theta}+\log R^{\pi_{%
\theta},\alpha_{\xi}}-c]-\mathbb{E}_{a_{t}\sim q}[\log R^{\pi_{\theta},\alpha_%
{\xi}}-\log\alpha_{\xi}\pi_{\theta}])]
\displaystyle=
\displaystyle\mathbb{E}_{s_{t}\sim\mathcal{D}}[(\nabla_{\xi}\alpha_{\xi})(%
\mathbb{E}_{a_{t}\sim\pi_{\theta}}[-\log\alpha_{\xi}\pi_{\theta}+\log R^{\pi_{%
\theta},\alpha_{\xi}}-c]-\mathbb{E}_{a_{t}\sim q}[\log R^{\pi_{\theta},\alpha_%
{\xi}}-\log\alpha_{\xi}\pi_{\theta}])]
R^{\pi_{\theta},\alpha_{\xi}}
R_{\eta}^{\alpha_{\xi}}
\alpha
\alpha
\alpha
0.5\leq\alpha\leq 0.99
\alpha
R_{\eta}^{\alpha}
\beta
\Pi
\beta
D
\delta
3\cdot 10^{-4}
\gamma
0.99
0.999
N
1000
M
256
10^{6}
V_{\bar{\psi}}
0.005
\pi_{\theta}
Q_{\phi}
V_{\psi}
V_{\bar{\psi}}
\alpha_{\xi}
R_{\eta}^{\alpha}
\cdot
\alpha_{\xi}
\cdot
10^{-3}
c
\alpha
\cdot
-2.0\cdot\mathrm{dim}(\mathcal{A})
\beta
\beta
D
\cdot
\beta
\beta
r_{t}^{int}=||\hat{f}(s_{t+1})-f(s_{t+1})||^{2}
r_{t}^{ext}
r_{t}=r_{t}^{ext}+c^{int}r_{t}^{int}
\hat{f}
f
2
256
20
c^{int}=5
\mathcal{H}(d^{\pi^{mix}})
d^{\pi}
\pi
r_{MaxEnt(State)}(s)=-(\log d^{\pi_{mix}}(s)+c_{s})
c_{s}
d^{\pi_{mix}}
100
d^{\pi_{mix}}
c^{int}=0.02
\sigma=0.3
\alpha
D_{JS}^{\alpha}
\alpha=0.5
x,y
x,z
0.01
(-10,10)
R
\alpha
D_{JS}^{\alpha}
\alpha
D_{JS}^{\alpha}
\alpha=0.5
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha=0.5
\alpha=0.8
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha=0.5
\alpha
\alpha=0.5
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
c
c
\beta
\beta
c
\alpha
c
\alpha
{\cal H}(\pi)
D_{JS}^{\alpha}
0
-0.5d
-1.0d
-2.0d
d=\mathrm{dim}(\mathcal{A})
\alpha
c
c=-2.0\cdot\mathrm{dim}(\mathcal{A})
-2.0d
c=-2.0d
\beta
\beta
\beta
\alpha=0.5
\beta
\beta=0.1
0.2
0.4
\beta
\beta
\beta
\alpha\beta
\alpha=0.5
\beta=0.4
\beta=0.2
\alpha=0.5
\beta=0.4
\beta=0.2
\mathcal{H}(\pi)
D_{JS}^{\alpha}(\pi||q)
\delta_{d}=0.5
c
c
c
\beta
\beta
\beta
