S
A_{1},...,A_{N}
O_{1},...,O_{N}
i\in\{1,...,N\}
a_{i}\in A_{i}
\mathbf{u}\in U
\mathbf{u}
P_{s}:S\times U\rightarrow S
o\in O
O_{p}:S\rightarrow O
r:S\times U\rightarrow R
Q_{tot}=E_{s_{t+1}:\infty,a_{t+1}:\infty}[R_{t}|s_{t},\mathbf{u_{t}}]
R_{t}=\sum^{\infty}_{j=0}\gamma^{j}r_{t+j}
Q_{tot}(\mathbf{\tau_{t}},\mathbf{u_{t}})\approx Q_{tot}(s_{t},\mathbf{u_{t}})
\tau_{i}^{t}
(o_{i}^{0},a_{i}^{0},...,o_{i}^{t})
\mathbf{\tau_{t}}=\{\tau_{i}^{t}\}_{i\in A}
Z
j
z_{j}\in Z
\mathbf{z}
N,M,K_{j}
j
i\in\{1,...,N\}
\hat{r_{i}}
(o_{i}^{t},u^{t-}_{i},a_{i}^{t})
u^{t-}_{i}
i
\begin{array}[]{c}r_{tot}(s_{t},\mathbf{u_{t}})=\sum_{i=1}^{N}(\hat{r_{i}}(o_{%
i}^{t},u^{t-}_{i},a_{i}^{t})+(2^{(N-K_{i})}-1)\times\epsilon).\end{array}
r_{tot}
K_{i}
i
(2^{(N-K_{i})}-1)\times\epsilon
\epsilon
\begin{array}[]{c}r_{tot}(s_{t},u_{t})=\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t}%
)+\sum_{i<j=2}^{i<j=N}r_{2}(o_{i}^{t},o_{j}^{t},a_{i}^{t},a_{j}^{t})+...+r_{N}%
(o_{1}^{t},...,o_{N}^{t},a_{1}^{t},...,a_{N}^{t}).\end{array}
r_{k}
r_{k}
W(x)
\epsilon
\epsilon
\hat{r_{i}}(o_{i}^{t},u_{i}^{t-},a_{i}^{t})
\begin{array}[]{c}\hat{r_{i}}(o_{i}^{t},u_{i}^{t-},a_{i}^{t})=r_{1}^{i}(o_{i}^%
{t},a_{i}^{t})+\sum_{j=1,j\neq i}^{K_{i}}r_{2}^{i}(o_{i}^{t},a_{j}^{t},a_{i}^{%
t})+...+r_{K_{i}}^{i}(o_{i}^{t},a_{1}^{t},...,a_{K_{i}}^{t},a_{i}^{t}).\end{array}
r_{k}^{i}=r_{k}^{i}(o_{i}^{t},a_{j}^{t},...a_{k}^{t},a_{i}^{t})
r_{k}^{i}
\begin{array}[]{c}r_{k}^{i}(o_{i}^{t},a_{j}^{t},...a_{k}^{t},a_{i}^{t})=\frac{%
1}{k}r_{k}(o_{i}^{t},o_{j}^{t},...,o_{k}^{t},a_{j}^{t},...a_{k}^{t},a_{i}^{t})%
.\end{array}
r_{k}
(i,j,..,k;j<i<k)
r_{k}
\begin{array}[]{c}\hat{r_{i}}(o_{i}^{t},u_{i}^{t-},a_{i}^{t})=r_{1}(o_{i}^{t},%
a_{i}^{t})+\frac{1}{2}\sum_{j=1,j\neq i}^{K_{i}}r_{2}(o_{i}^{t},o_{j}^{t},a_{j%
}^{t},a_{i}^{t})+...+\frac{1}{K_{i}}r_{K_{i}}(o_{i}^{t},o_{1}^{t},...,o_{K_{i}%
}^{t},a_{1}^{t},...,a_{K_{i}}^{t},a_{i}^{t}).\end{array}
\begin{array}[]{c}\sum_{i=1}^{N}(\hat{r_{i}}(o_{i}^{t},u^{t-}_{i},a_{i}^{t})+(%
2^{(N-K_{i})}-1)\times\epsilon)\\
=\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t})+\sum_{i=1}^{N}\frac{1}{2}\sum_{j=1,j%
\neq i}^{K_{i}}r_{2}(o_{i}^{t},o_{j}^{t},a_{j}^{t},a_{i}^{t})+...+\sum_{i=1}^{%
N}(C_{(N-K_{i})}^{2}+C_{(N-K_{i})}^{3}+...+C_{(N-K_{i})}^{N-K_{i}})\times%
\epsilon\\
=\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t})+\frac{1}{2}\sum_{i=1}^{N}\sum_{j=1,j%
\neq i}^{K_{i}}r_{2}(o_{i}^{t},o_{j}^{t},a_{j}^{t},a_{i}^{t})+\sum_{i=1}^{N}%
\sum_{j=1,j\neq i}^{N-K_{i}}\epsilon+...\end{array}
\epsilon
i
\begin{array}[]{c}\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t})+\frac{1}{2}\sum_{i=%
1}^{N}\sum_{j=1,j\neq i}^{K_{i}}r_{2}(o_{i}^{t},o_{j}^{t},a_{j}^{t},a_{i}^{t})%
+\sum_{i=1}^{N}\sum_{j=1,j\neq i}^{N-K_{i}}\epsilon+...\\
=\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t})+\frac{1}{2}\sum_{i=1}^{N}\sum_{j=1,j%
\neq i}^{N}r_{2}(o_{i}^{t},o_{j}^{t},a_{j}^{t},a_{i}^{t})+...\\
=\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t})+\frac{1}{2}\sum_{i<j=2}^{i<j=N}2%
\times r_{2}(o_{i}^{t},o_{j}^{t},a_{j}^{t},a_{i}^{t})+...\\
=\sum_{i=1}^{N}r_{1}(o_{i}^{t},a_{i}^{t})+\sum_{i<j=2}^{i<j=N}r_{2}(o_{i}^{t},%
o_{j}^{t},a_{j}^{t},a_{i}^{t})+...=r_{tot}(s_{t},u_{t}).\end{array}
\begin{array}[]{c}r_{tot}(s_{t},u_{t})=\sum_{i=1}^{N}(\hat{r_{i}}(o_{i}^{t},u^%
{t-}_{i},a_{i}^{t})+(2^{(N-K_{i})}-1)\times\epsilon).\end{array}
\hat{r_{i}}
i
i
i
i
i
i
\mathbf{S}
\mathbf{A_{i}}
\mathbf{K_{i}}
\mathbf{T_{i}=A_{i}+K_{i}}
\mathbf{T_{i}}
i
\mathbf{S=S-T_{i}}
i
z
j
i
\pi_{h}(z_{j}|o_{i}^{t};\theta)
\theta
o_{i}^{t}
i
z_{j}\sim\pi_{h}(z_{j}|o_{i}^{t};\theta)
\pi_{l}(a_{k}^{t}|\tau_{k}^{t},z_{j};\mu)
\mu
j
z_{j}
a_{k}
u_{j}
j
u_{j}\sim(\pi_{l}(a_{0}^{t}|\tau_{0}^{t},z_{j};\mu)...\pi_{l}(a_{K_{j}}^{t}|%
\tau_{K_{j}}^{t},z_{j};\mu))
K_{j}
K_{j}
j
o_{i}^{t+1}
z_{j}
o_{i}^{t}
\begin{array}[]{c}I(o_{i}^{t+1};z_{j}\mid o_{i}^{t})=H(z_{j}\mid o_{i}^{t})-H(%
z_{j}\mid o_{i}^{t+1},o_{i}^{t})=H(o_{i}^{t+1}\mid o_{i}^{t})-H(o_{i}^{t+1}%
\mid o_{i}^{t},z_{j})=I(z_{j};o_{i}^{t+1}\mid o_{i}^{t}).\end{array}
I
H
z_{j}
o_{i}^{t}
o_{i}^{t+1}
\begin{array}[]{c}I(z_{j};o_{i}^{t+1}\mid o_{i}^{t})=\mathbb{E}_{z_{j},o_{i}^{%
t},o_{i}^{t+1}}[\log\frac{q_{\phi}(z_{j}\mid o_{i}^{t},o_{i}^{t+1})}{p(z_{j}%
\mid o_{i}^{t})}]+\mathbb{E}_{o_{i}^{t},z_{j}}[D_{KL}(p(z_{j}\mid o_{i}^{t},o_%
{i}^{t+1}))\|q_{\phi}(z_{j}\mid o_{i}^{t},o_{i}^{t+1})))]\\
\geq\mathbb{E}_{z_{j},o_{i}^{t},o_{i}^{t+1}}[\log\frac{q_{\phi}(z_{j}\mid o_{i%
}^{t},o_{i}^{t+1})}{p(z_{j}\mid o_{i}^{t})}].\end{array}
q_{\phi}(z_{j}\mid o_{i}^{t},o_{i}^{t+1})
\phi
p
\mathcal{L}_{I}^{j}=\mathbb{E}_{o_{i}^{t},o_{i}^{t+1}}\left[D_{\mathrm{KL}}%
\left[p\left(z_{j}\mid o_{i}^{t}\right)\|q_{\phi}\left(z_{j}\mid o_{i}^{t+1},o%
_{i}^{t}\right)\right]\right].
D_{\mathrm{KL}}
\begin{array}[]{c}I(z_{j};o_{i}^{t+1}\mid o_{i}^{t})=\mathbb{E}_{z_{j},o_{i}^{%
t},o_{i}^{t+1}}[\log\frac{p_{\phi}(z_{j}\mid o_{i}^{t},o_{i}^{t+1})}{p(z_{j}%
\mid o_{i}^{t})}].\end{array}
\begin{array}[]{c}\mathbb{E}_{z_{j},o_{i}^{t},o_{i}^{t+1}}[\log\frac{p_{\phi}(%
z_{j}\mid o_{i}^{t},o_{i}^{t+1})}{p(z_{j}\mid o_{i}^{t})}]=\mathbb{E}_{z_{j},o%
_{i}^{t},o_{i}^{t+1}}[\log\frac{q_{\phi}(z_{j}\mid o_{i}^{t},o_{i}^{t+1})}{p(z%
_{j}\mid o_{i}^{t})}]+\mathbb{E}_{o_{i}^{t},z_{j}}[D_{KL}(p(z_{j}\mid o_{i}^{t%
},o_{i}^{t+1}))\|q_{\phi}(z_{j}\mid o_{i}^{t},o_{i}^{t+1})))]\\
\geq\mathbb{E}_{z_{j},o_{i}^{t},o_{i}^{t+1}}[\log\frac{q_{\phi}(z_{j}\mid o_{i%
}^{t},o_{i}^{t+1})}{p(z_{j}\mid o_{i}^{t})}].\end{array}
\begin{array}[]{c}\mathbb{E}_{z_{j},o_{i}^{t},o_{i}^{t+1}}[\log\frac{q_{\phi}(%
z_{j}\mid o_{i}^{t},o_{i}^{t+1})}{p(z_{j}\mid o_{i}^{t})}]=\mathbb{E}_{z_{j},o%
_{i}^{t},o_{i}^{t+1}}\left[\log q_{\phi}\left(z_{j}\mid o_{i}^{t+1},o_{i}^{t}%
\right)\right]+\mathbb{E}_{o_{i}^{t}}\left[H\left(z_{j}\mid o_{i}^{t}\right)%
\right]\\
=\mathbb{E}_{o_{i}^{t+1},o_{i}^{t}}\left[\int p\left(z_{j}\mid o_{i}^{t+1},o_{%
i}^{t}\right)\log q_{\phi}\left(z_{j}\mid o_{i}^{t+1},o_{i}^{t}\right)dz_{j}%
\right]+\mathbb{E}_{o_{i}^{t}}\left[H\left(z_{j}\mid o_{i}^{t}\right)\right]\\
=-\mathbb{E}_{o_{i}^{t+1},o_{i}^{t}}[CE\left[p\left(z_{j}\mid o_{i}^{t}\right)%
\|q_{\phi}\left(z_{j}\mid o_{i}^{t+1},o_{i}^{t}\right)\right]+\mathbb{E}_{o_{i%
}^{t}}\left[H\left(z_{j}\mid o_{i}^{t}\right)\right].\end{array}
CE
\begin{array}[]{c}\mathcal{L}_{I}^{j}=\mathbb{E}_{o_{i}^{t+1},o_{i}^{t}}\left[%
CE\left[p\left(z_{j}\mid o_{i}^{t}\right)\|q_{\phi}\left(z_{j}\mid o_{i}^{t+1}%
,o_{i}^{t}\right)-H\left(z_{j}\mid o_{i}^{t}\right)\right]\right.\\
=\mathbb{E}_{o_{i}^{t+1},o_{i}^{t}}\left[D_{\mathrm{KL}}\left[p\left(z_{j}\mid
o%
_{i}^{t}\right)\|q_{\phi}\left(z_{j}\mid o_{i}^{t+1},o_{i}^{t}\right)\right]%
\right].\end{array}
I(o_{k}^{t+1};z_{j})
\mathcal{L}_{A}^{j}=\frac{1}{K_{j}}\sum_{k=0}^{K_{j}}\mathbb{E}_{o_{i}^{t},o_{%
k}^{t+1}}\left[D_{\mathrm{KL}}\left[p\left(z_{j}\mid o_{i}^{t}\right)\|q_{\phi%
}\left(z_{j}\mid o_{k}^{t+1},o_{i}^{t}\right)\right]\right].
o_{i}^{t+1}
z_{j}^{-}
z_{j}^{-}
z
\mathcal{L}_{D}^{j}=-\mathbb{E}_{o_{i}^{t},o_{i}^{t+1}}\left[D_{\mathrm{KL}}%
\left[p\left(z_{j}^{-}\mid o_{i}^{t}\right)\|q_{\phi}\left(z_{j}^{-}\mid o_{i}%
^{t+1},o_{i}^{t}\right)\right]\right].
\begin{array}[]{c}\mathcal{L}_{TD}^{l}=\mathbb{E}_{\pi_{l}}[Q_{tot}^{l}(s_{t},%
\mathbf{z_{t}},\mathbf{u}_{t})-y_{t}^{l}]^{2}\\
y_{t}^{l}=r_{t}+\gamma\max_{\mathbf{u}_{t+1}}Q_{tot}^{l}\left(s_{t+1},\mathbf{%
z_{t+1}},\mathbf{u}_{t+1}\right)\\
\mathcal{L}_{TD}^{h}=\mathbb{E}_{\pi_{h}}[Q_{tot}^{h}(s_{t},\mathbf{z}_{t})-y_%
{t}^{h}]^{2}\\
y_{t}^{h}=r_{t}+\gamma\max_{\mathbf{z}_{t+1}}Q_{tot}^{h}\left(s_{t+1},\mathbf{%
z}_{t+1}\right).\end{array}
\begin{array}[]{c}\mathcal{L}_{TD}^{h}(\theta)+\mathcal{L}_{TD}^{l}(\mu)+\sum_%
{j=0}^{j=M}(\mathcal{L}_{I}^{j}(\mu,\phi)+\lambda_{1}\mathcal{L}_{A}^{j}(\mu,%
\phi)+\lambda_{2}\mathcal{L}_{D}^{j}(\mu,\phi)).\end{array}
M
\lambda_{1},\lambda_{2}
\theta,\mu,\phi
Q_{j}
\pi_{l}^{*}
r_{tot}(s,\mathbf{z})=\sum_{j=0}^{j=M}r_{j}(o_{i}^{t},z_{j})
r_{j}
j
\begin{array}[]{c}Q_{tot}^{h}(s,\mathbf{z})=\mathbb{E}\left[\sum_{t=0}^{\infty%
}\gamma^{t}r\left({s},\mathbf{z}\right)\mid\pi_{h},\pi_{l}^{*}\right]=\mathbb{%
E}\left[\sum_{t=0}^{\infty}\gamma^{t}\sum_{j=0}^{M}(r_{j}(o_{i}^{t},z_{j}))%
\mid\pi_{h},\pi_{l}^{*}\right]\\
=\sum_{j=0}^{M}Q_{j}(s,\mathbf{z})\approx\sum_{j=0}^{M}Q_{j}(o_{i}^{t},z_{j}).%
\end{array}
\begin{array}[]{c}Q_{tot}^{h}(s,\mathbf{z})=\sum_{j=0}^{M}Q_{j}(s,\mathbf{z})%
\approx\sum_{j=0}^{M}\alpha_{j}Q_{j}(o_{i}^{t},z_{j})\\
\alpha_{j}=\frac{K_{j}\cdot I(o_{i}^{t+1};z_{j}\mid o_{i}^{t})}{\sum_{j=0}^{j=%
K_{j}}(I(o_{i}^{t+1};z_{j}\mid o_{i}^{t}))}.\end{array}
\alpha_{j}
\begin{array}[]{c}\mathcal{L}_{TD}^{h}(s_{t},\mathbf{z}_{t})=\mathbb{E}_{\pi_{%
h}}[Q_{tot}^{h}(s_{t},\mathbf{z}_{t})-(r_{t}+\gamma\max_{\mathbf{z}_{t+1}}Q_{%
tot}^{h}\left(s_{t+1},\mathbf{z}_{t+1}\right))]^{2}\\
=[\sum_{j=0}^{M}\alpha_{j}Q_{j}(o_{i}^{t},z_{t})-(r_{t}+\gamma\sum_{j=0}^{M}%
\alpha_{j}Q_{j}^{T}(o^{t+1}_{i},z^{*}_{j}))]^{2}.\end{array}
z^{*}_{j}
Q_{j}^{T}
\alpha_{j}
\begin{array}[]{c}\mathcal{L}_{TD}^{h}(s_{t},\mathbf{z}_{t})=[\sum_{j=0}^{M}(%
\alpha_{j}Q_{j}(o_{i}^{t},z_{t})-\frac{r_{t}}{M}-\gamma\alpha_{j}Q_{j}^{T}(o^{%
t+1}_{i},z^{*}_{j}))]^{2}.\end{array}
\begin{array}[]{c}y_{TD}=\sum_{j=0}^{M}(\alpha_{j}Q_{j}(o_{i}^{t},z_{t})-\frac%
{r_{t}}{M}-\gamma\alpha_{j}Q_{j}^{T}(o^{t+1}_{i},z^{*}_{j})).\end{array}
\begin{array}[]{c}\frac{\partial\mathcal{L}_{TD}^{h}(s_{t},\mathbf{z}_{t})}{%
\partial\theta}=2\cdot y_{TD}\cdot\sum_{j=0}^{M}\alpha_{j}\frac{\partial Q_{j}%
}{\partial\theta}.\end{array}
\alpha_{j}
\times
\times
\times
10\times 10
\epsilon
\epsilon
\lambda_{1},\lambda_{2}
