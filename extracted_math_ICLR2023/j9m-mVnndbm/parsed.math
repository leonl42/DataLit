\dagger
\mathbf{x}
\mathbf{y}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
\mathbf{x}
\mathbf{y}
\mathbf{x}
\mathbf{y}
{\hat{\mathbf{z}}}
\mathbf{y}\leftrightarrow\mathbf{x}\leftrightarrow{\hat{\mathbf{z}}}
p({\hat{\mathbf{z}}}|\mathbf{x},\mathbf{y})=p({\hat{\mathbf{z}}}|\mathbf{x})
\mathbf{z}
\mathbf{x}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
{\hat{\mathbf{x}}}
p({\hat{\mathbf{z}}}|\mathbf{x})
q({\hat{\mathbf{z}}}|\mathbf{x})
p(\mathbf{x})
\displaystyle\mathbb{E}_{p(\mathbf{x})}D_{kl}[q({\hat{\mathbf{z}}}|\mathbf{x})%
||p({\hat{\mathbf{z}}}|\mathbf{x})]=\mathbb{E}_{p(\mathbf{x})}\mathbb{E}_{q({%
\hat{\mathbf{z}}}|\mathbf{x})}[\cancelto{0}{\log q({\hat{\mathbf{z}}}|\mathbf{%
x})}
\displaystyle\mathbb{E}_{p(\mathbf{x})}D_{kl}[q({\hat{\mathbf{z}}}|\mathbf{x})||
\displaystyle p({\hat{\mathbf{z}}}|\mathbf{x})]=\mathbb{E}_{p(\mathbf{x})}%
\mathbb{E}_{q({\hat{\mathbf{z}}}|\mathbf{x})}[\cancelto{0}{\log q({\hat{%
\mathbf{z}}}|\mathbf{x})}
\displaystyle-\log p(\mathbf{x}|{\hat{\mathbf{z}}})-\log p({\hat{\mathbf{z}}})%
]+\operatorname*{const}
\displaystyle-\log p(\mathbf{x}|{\hat{\mathbf{z}}})-\log p({\hat{\mathbf{z}}})%
]+\operatorname*{const}
D_{kl}[\cdot||\cdot]
\mathbf{x}
\mathbf{z}
\mathbf{z}
\mathcal{U}(-\frac{1}{2},\frac{1}{2})
q({\hat{\mathbf{z}}}|\mathbf{x})=\prod_{i}\mathcal{U}(z_{i}-\frac{1}{2},z_{i}+%
\frac{1}{2})
\log q({\hat{\mathbf{z}}}|\mathbf{x})=0
\mathbf{x}
{\hat{\mathbf{x}}}
{\hat{\mathbf{z}}}
I({\hat{\mathbf{z}}},\mathbf{y})
{\hat{\mathbf{z}}}
\mathbf{y}
I({\hat{\mathbf{z}}},\mathbf{y})
\mathbf{y}
{\hat{\mathbf{z}}}
\displaystyle I({\hat{\mathbf{z}}},\mathbf{y})=H(\mathbf{y})-H(\mathbf{y}|{%
\hat{\mathbf{z}}})
\displaystyle I({\hat{\mathbf{z}}},\mathbf{y})
\displaystyle=H(\mathbf{y})-H(\mathbf{y}|{\hat{\mathbf{z}}})
\displaystyle=H(\mathbf{y})+\sum_{\mathbf{y},{\hat{\mathbf{z}}}}p(\mathbf{y},{%
\hat{\mathbf{z}}})\log p(\mathbf{y}|{\hat{\mathbf{z}}})
\displaystyle=H(\mathbf{y})+\sum_{\mathbf{y},{\hat{\mathbf{z}}}}p(\mathbf{y},{%
\hat{\mathbf{z}}})\log p(\mathbf{y}|{\hat{\mathbf{z}}})
H(\cdot)
p(\mathbf{y}|{\hat{\mathbf{z}}})
q(\mathbf{y}|{\hat{\mathbf{z}}})
D_{kl}[p(\mathbf{y}|{\hat{\mathbf{z}}})||q(\mathbf{y}|{\hat{\mathbf{z}}})]\geq
0
\sum_{\mathbf{y}}p(\mathbf{y}|{\hat{\mathbf{z}}})\log p(\mathbf{y}|{\hat{%
\mathbf{z}}})\geq\sum_{\mathbf{y}}p(\mathbf{y}|{\hat{\mathbf{z}}})\log q(%
\mathbf{y}|{\hat{\mathbf{z}}})
I({\hat{\mathbf{z}}},\mathbf{y})\geq H(\mathbf{y})+\sum_{\mathbf{y},{\hat{%
\mathbf{z}}}}p(\mathbf{y},{\hat{\mathbf{z}}})\log q(\mathbf{y}|{\hat{\mathbf{z%
}}})
H(\mathbf{y})
{\hat{\mathbf{z}}}
\sum_{\mathbf{y},{\hat{\mathbf{z}}}}p(\mathbf{y},{\hat{\mathbf{z}}})\log q(%
\mathbf{y}|{\hat{\mathbf{z}}})
I({\hat{\mathbf{z}}},\mathbf{y})
p(\mathbf{y},{\hat{\mathbf{z}}})
\sum_{\mathbf{x}}p(\mathbf{x},\mathbf{y},{\hat{\mathbf{z}}})=\sum_{\mathbf{x}}%
p(\mathbf{x},\mathbf{y})p({\hat{\mathbf{z}}}|\mathbf{x})
\sum_{\mathbf{y},{\hat{\mathbf{z}}}}p(\mathbf{y},{\hat{\mathbf{z}}})\log q(%
\mathbf{y}|{\hat{\mathbf{z}}})
\mathbb{E}_{p(\mathbf{x},\mathbf{y})}\mathbb{E}_{p({\hat{\mathbf{z}}}|\mathbf{%
x})}\log q(\mathbf{y}|{\hat{\mathbf{z}}})
q(\mathbf{y}|{\hat{\mathbf{z}}})
{\hat{\mathbf{y}}}
{\hat{\mathbf{z}}}
p({\hat{\mathbf{z}}}|\mathbf{x})
q({\hat{\mathbf{z}}}|\mathbf{x})
\mathbb{E}_{p(\mathbf{x})}D_{kl}[q({\hat{\mathbf{z}}}|\mathbf{x})||p({\hat{%
\mathbf{z}}}|\mathbf{x})]=\mathbb{E}_{p(\mathbf{x},\mathbf{y})}D_{kl}[q({\hat{%
\mathbf{z}}}|\mathbf{x})||p({\hat{\mathbf{z}}}|\mathbf{x})]
\mathbb{E}_{p(\mathbf{x},\mathbf{y})}\{-\alpha\mathbb{E}_{q({\hat{\mathbf{z}}}%
|\mathbf{x})}\log q(\mathbf{y}|{\hat{\mathbf{z}}})+D_{kl}[q({\hat{\mathbf{z}}}%
|\mathbf{x})||p({\hat{\mathbf{z}}}|\mathbf{x})]\}
\alpha
p(\mathbf{x}|{\hat{\mathbf{z}}})
\mathcal{N}(\mathbf{x}|{\hat{\mathbf{x}}},(2\beta)^{-1}\mathbf{1})
\mathbb{E}_{p(\mathbf{x},\mathbf{y})}\mathbb{E}_{q({\hat{\mathbf{z}}}|\mathbf{%
x})}[-\alpha\log q(\mathbf{y}|{\hat{\mathbf{z}}})+\beta\|\mathbf{x}-{\hat{%
\mathbf{x}}}\|^{2}_{2}-\log p({\hat{\mathbf{z}}})]
\alpha
\mathbf{y}
\beta
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
I({\hat{\mathbf{z}}},\mathbf{x})
N=128
M=192
N=128
M=192
2
5\times 5
\mathbf{x}\in\mathbb{R}^{H\times W\times 3}
C=384
L=12
N=128
C=384
L=12
N=128
\mathbf{z}\in\mathbb{R}^{\frac{H}{16}\times\frac{W}{16}\times M}
{\hat{\mathbf{z}}}
p({\hat{\mathbf{z}}}|\mathbf{h}_{{\hat{\mathbf{z}}}})
{\hat{\mathbf{z}}}
\mathbf{h}_{{\hat{\mathbf{z}}}}
{\hat{\mathbf{z}}}
16
16\times 16
p({\hat{\mathbf{z}}}|\mathbf{h}_{{\hat{\mathbf{z}}}})
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
{\hat{\mathbf{x}}}
{\hat{\mathbf{x}}}
{\hat{\mathbf{z}}}
C
1\times 1
{\hat{\mathbf{z}}}_{0}\in\mathbb{R}^{\frac{H}{16}\times\frac{W}{16}\times C}
{\hat{\mathbf{z}}}_{0}\in\mathbb{R}^{\frac{HW}{16^{2}}\times C}
{\hat{\mathbf{z}}}_{0}
\mathbf{p}
{\hat{\mathbf{z}}}_{0}
{\tilde{\mathbf{z}}}_{0}={\hat{\mathbf{z}}}_{0}+\mathbf{p}
{\tilde{\mathbf{c}}}_{0}
[{\tilde{\mathbf{c}}}_{0};{\tilde{\mathbf{z}}}_{0}]\in\mathbb{R}^{(\frac{HW}{1%
6^{2}}+1)\times C}
L
\displaystyle[{\tilde{\mathbf{c}}}^{\prime}_{i};{\tilde{\mathbf{z}}}^{\prime}_%
{i}]=\operatorname*{MSA}(\operatorname*{LN}([{\tilde{\mathbf{c}}}_{i-1};{%
\tilde{\mathbf{z}}}_{i-1}]))+[{\tilde{\mathbf{c}}}_{i-1};{\tilde{\mathbf{z}}}_%
{i-1}]
\displaystyle[{\tilde{\mathbf{c}}}^{\prime}_{i};{\tilde{\mathbf{z}}}^{\prime}_%
{i}]
\displaystyle=\operatorname*{MSA}(\operatorname*{LN}([{\tilde{\mathbf{c}}}_{i-%
1};{\tilde{\mathbf{z}}}_{i-1}]))+[{\tilde{\mathbf{c}}}_{i-1};{\tilde{\mathbf{z%
}}}_{i-1}]
\displaystyle[{\tilde{\mathbf{c}}}_{i};{\tilde{\mathbf{z}}}_{i}]=\operatorname%
*{FFN}(\operatorname*{LN}([{\tilde{\mathbf{c}}}^{\prime}_{i};{\tilde{\mathbf{z%
}}}^{\prime}_{i}]))+[{\tilde{\mathbf{c}}}^{\prime}_{i};{\tilde{\mathbf{z}}}^{%
\prime}_{i}]~{}~{}~{}~{}i=1,\ldots,L
\displaystyle[{\tilde{\mathbf{c}}}_{i};{\tilde{\mathbf{z}}}_{i}]
\displaystyle=\operatorname*{FFN}(\operatorname*{LN}([{\tilde{\mathbf{c}}}^{%
\prime}_{i};{\tilde{\mathbf{z}}}^{\prime}_{i}]))+[{\tilde{\mathbf{c}}}^{\prime%
}_{i};{\tilde{\mathbf{z}}}^{\prime}_{i}]~{}~{}~{}~{}i=1,\ldots,L
\operatorname*{MSA}(\cdot)
\operatorname*{FFN}(\cdot)
\operatorname*{LN}(\cdot)
{\tilde{\mathbf{c}}}_{i}
{\tilde{\mathbf{z}}}_{i}
{\tilde{\mathbf{c}}}_{L}
q(\mathbf{y}|{\hat{\mathbf{z}}})
q(\mathbf{y}|{\hat{\mathbf{z}}})=\operatorname*{Softmax}(\operatorname*{FFN}(%
\operatorname*{LN}({\tilde{\mathbf{c}}}_{L})))
\operatorname*{Softmax}(\cdot)
\operatorname*{FFN}(\cdot)
C
{\hat{\mathbf{x}}}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}_{0}
{\tilde{\mathbf{z}}}_{i}
{\hat{\mathbf{z}}}_{0}
[{\tilde{\mathbf{z}}}_{1},{\tilde{\mathbf{z}}}_{2},{\tilde{\mathbf{z}}}_{3}]
[{\tilde{\mathbf{z}}}_{1},{\tilde{\mathbf{z}}}_{2},{\tilde{\mathbf{z}}}_{3}]
\{{\tilde{\mathbf{z}}}_{i}(i>3)\}
\displaystyle{\hat{\mathbf{z}}}^{\prime\prime}_{0}=\mathrm{Conv}_{1}^{0}({\hat%
{\mathbf{z}}}_{0}),~{}~{}{\tilde{\mathbf{z}}}^{\prime\prime}_{1}=\mathrm{Conv}%
_{1}^{1}({\tilde{\mathbf{z}}}_{1})
\displaystyle{\hat{\mathbf{z}}}^{\prime\prime}_{0}
\displaystyle=\mathrm{Conv}_{1}^{0}({\hat{\mathbf{z}}}_{0}),~{}~{}{\tilde{%
\mathbf{z}}}^{\prime\prime}_{1}=\mathrm{Conv}_{1}^{1}({\tilde{\mathbf{z}}}_{1})
\displaystyle{\tilde{\mathbf{z}}}^{\prime\prime}_{2}=\mathrm{Conv}_{1}^{2}({%
\tilde{\mathbf{z}}}_{2}),~{}~{}{\tilde{\mathbf{z}}}^{\prime\prime}_{3}=\mathrm%
{Conv}_{1}^{3}({\tilde{\mathbf{z}}}_{3})
\displaystyle{\tilde{\mathbf{z}}}^{\prime\prime}_{2}
\displaystyle=\mathrm{Conv}_{1}^{2}({\tilde{\mathbf{z}}}_{2}),~{}~{}{\tilde{%
\mathbf{z}}}^{\prime\prime}_{3}=\mathrm{Conv}_{1}^{3}({\tilde{\mathbf{z}}}_{3})
\displaystyle{\hat{\mathbf{z}}}_{f}=\mathrm{Conv}_{2}([{\hat{\mathbf{z}}}^{%
\prime\prime}_{0};~{}{\tilde{\mathbf{z}}}^{\prime\prime}_{1};~{}{\tilde{%
\mathbf{z}}}^{\prime\prime}_{2};~{}{\tilde{\mathbf{z}}}^{\prime\prime}_{3}])
\displaystyle{\hat{\mathbf{z}}}_{f}=\mathrm{Conv}_{2}([{\hat{\mathbf{z}}}^{%
\prime\prime}_{0};~{}{\tilde{\mathbf{z}}}^{\prime\prime}_{1};~{}{\tilde{%
\mathbf{z}}}^{\prime\prime}_{2};~{}{\tilde{\mathbf{z}}}^{\prime\prime}_{3}])
\mathrm{Conv}_{1}^{i}(\cdot)
1\times 1
\frac{C}{4}
\mathrm{Conv}_{2}(\cdot)
1\times 1
C
{\hat{\mathbf{z}}}_{f}
{\hat{\mathbf{z}}}_{f}
2
5\times 5
{\hat{\mathbf{x}}}
\mathbf{z}
{\hat{\mathbf{z}}}
\alpha=1
\beta=0.001
\mathbf{z}
{\hat{\mathbf{z}}}
\alpha
\beta
\frac{\alpha}{\beta}
1000
1,281,167
50,000
1010
265,213
3030
\mathbf{z}
{\hat{\mathbf{z}}}
\alpha=1
\beta=0.001
224\times 224
300
1024
0.001
5
100
512
0.0005
2
\mathbf{z}
{\hat{\mathbf{z}}}
\frac{\alpha}{\beta}=100
\alpha\in\{0.1,0.3,0.6\}
{\hat{\mathbf{z}}}
0.0001
300
1024
5
0.0001
300
512
2
-
-
-
-
-
-
-
-
-
-
-
-
31.7
31.5
\frac{\alpha}{\beta}=100
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
{\hat{\mathbf{z}}}
\frac{\alpha}{\beta}
\frac{\alpha}{\beta}\in\{50,100,200\}
\frac{\alpha}{\beta}
\frac{\alpha}{\beta}
{\hat{\mathbf{z}}}_{0}
-\alpha\log q(\mathbf{y}|{\hat{\mathbf{z}}})
\beta\|\mathbf{x}-{\hat{\mathbf{x}}}\|^{2}_{2}
p({\hat{\mathbf{z}}}|\mathbf{h}_{{\hat{\mathbf{z}}}})
{\hat{\mathbf{z}}}
\mathbf{h}_{{\hat{\mathbf{z}}}}
{\hat{\mathbf{z}}}
p({\hat{\mathbf{z}}}|\mathbf{h}_{{\hat{\mathbf{z}}}})=\mathcal{N}({\hat{%
\mathbf{z}}}|\boldsymbol{\mu},\boldsymbol{\sigma})
\boldsymbol{\mu}
\boldsymbol{\sigma}
\mathbf{h}_{{\hat{\mathbf{z}}}}
\mathbf{h}_{{\hat{\mathbf{z}}}}
{\hat{\mathbf{z}}}
-
-
{\hat{\mathbf{z}}}_{0}
{\tilde{\mathbf{z}}}_{1}
{\tilde{\mathbf{z}}}_{2}
{\tilde{\mathbf{z}}}_{3}
{\hat{\mathbf{z}}}_{0}
{\tilde{\mathbf{z}}}_{1}
{\tilde{\mathbf{z}}}_{2}
{\tilde{\mathbf{z}}}_{3}
{\hat{\mathbf{z}}}_{0}
{\tilde{\mathbf{z}}}_{1}
{\tilde{\mathbf{z}}}_{2}
{\tilde{\mathbf{z}}}_{3}
{\hat{\mathbf{z}}}_{0}
{\tilde{\mathbf{z}}}_{1}
{\tilde{\mathbf{z}}}_{2}
{\tilde{\mathbf{z}}}_{3}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
{\hat{\mathbf{z}}}
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
\times
\times
\times
\times
\times
\checkmark
