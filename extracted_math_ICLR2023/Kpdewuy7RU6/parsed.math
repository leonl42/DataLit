\dagger
1\times 3
3\times 1
1\times 1
1\times K
K\times 1
K\times K
3\times 3
1\times 1
3\times 3
K\times K
1\times 1
K\times K
K\times K
3\times 3
3\times 3
3\times 3
1\times 3
3\times 1
W_{l}^{(t)}
l
t
W_{l}^{(t)}
(c_{{out}_{l}},c_{{in}_{l}},k_{x_{l}},k_{y_{l}})
c_{{out}_{l}}
c_{{in}_{l}}
(k_{x_{l}},k_{y_{l}})
\mathcal{L}_{train}
\partial\mathcal{L}/\partial W_{l}^{(t)}
\partial\mathcal{L}/\partial W
(m,n,o,p)
\partial\mathcal{L}/\partial W_{m,n,o,p}
l
W_{l}
W_{l}^{(t+1)}\Leftarrow W_{l}^{(t)}-\lambda^{(t)}\ f\left(\frac{\partial%
\mathcal{L}}{\partial W_{l}^{(t)}},\ W_{l}^{(t)},\ ...,\frac{\partial\mathcal{%
L}}{\partial W_{l}^{(0)}},\ W_{l}^{(0)}\right),
\lambda^{(t)}
f(\cdot)
G_{l}^{(t)}
W_{l}^{(t+1)}\Leftarrow W_{l}^{(t)}-\lambda^{(t)}f\left(G_{l}^{(t)}\odot\frac{%
\partial\mathcal{L}}{\partial W_{l}^{(t)}},\ W_{l}^{(t)},\ ...,\ G_{l}^{(0)}%
\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(0)}},\ W_{l}^{(0)}\right),
G_{l}^{(t)}
(k_{x_{l}},k_{y_{l}})
\odot
c_{{out}_{l}}
c_{{in}_{l}}
G_{l}^{(t)}
G_{l}^{(t)}
G_{l}^{(t)}
G_{l}^{(t)}
N
k_{x_{l}}\times k_{y_{l}}
l
W_{l}^{(t)}\in\mathbb{R}^{c_{{out}_{l}}\times c_{{in}_{l}}\times k_{x_{l}}%
\times k_{y_{l}}}
X^{(t)}_{l}
Y^{(t)}_{l}
t
N
n
(k_{x_{l}},k_{y_{l}})
M_{l,n}\in\{0,1\}^{k_{x_{l}}\times k_{y_{l}}}
l
W_{l}^{(t)}
N
n
W_{l,n}^{(t)}
M_{l,n}
\displaystyle Y_{l}^{(t)}=W_{l}^{(t)}\ast X_{l}^{(t)}=\left(\sum_{n=1}^{N_{l}}%
M_{l,n}\odot W_{l,n}^{(t)}\right)\ast X_{l}^{(t)}=\sum_{n=1}^{N_{l}}\left(%
\left(M_{l,n}\odot W_{l,n}^{(t)}\right)\ast X_{l}^{(t)}\right),
\displaystyle Y_{l}^{(t)}
\displaystyle=W_{l}^{(t)}\ast X_{l}^{(t)}=\left(\sum_{n=1}^{N_{l}}M_{l,n}\odot
W%
_{l,n}^{(t)}\right)\ast X_{l}^{(t)}=\sum_{n=1}^{N_{l}}\left(\left(M_{l,n}\odot
W%
_{l,n}^{(t)}\right)\ast X_{l}^{(t)}\right),
\odot
c_{{out}_{l}}
c_{{in}_{l}}
W_{l}
N
W_{l}
W_{l}^{(t+1)}
\displaystyle W_{l}^{(t+1)}\Leftarrow W_{l}^{(t)}-\lambda^{(t)}\sum_{n=1}^{N_{%
l}}\left(M_{l,n}\odot f\left(\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(t)}%
},\ W_{l,n}^{(t)},\ ...,\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(0)}},\ W%
_{l,n}^{(0)}\right)\right)
\displaystyle W_{l}^{(t+1)}\Leftarrow W_{l}^{(t)}-\lambda^{(t)}\sum_{n=1}^{N_{%
l}}\left(M_{l,n}\odot f\left(\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(t)}%
},\ W_{l,n}^{(t)},\ ...,\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(0)}},\ W%
_{l,n}^{(0)}\right)\right)
N
G_{l}
f(\cdot)
l
N
W_{l,n}^{(t)}
M_{l,n}
n=1,\ldots,N
\displaystyle W_{l}^{(t+1)}\Leftarrow W_{l}^{(t)}-\lambda^{(t)}f\left(G_{l}%
\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(t)}},\ W_{l}^{(t)},\ ...,G_{l%
}\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(0)}},\ W_{l}^{(0)}\right)
\displaystyle W_{l}^{(t+1)}\Leftarrow W_{l}^{(t)}-\lambda^{(t)}f\left(G_{l}%
\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(t)}},\ W_{l}^{(t)},\ ...,G_{l%
}\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(0)}},\ W_{l}^{(0)}\right)
G_{l}=\sum_{n=1}^{N}{M_{l,n}}
(i,j)
P
Q_{i,j}
P
Q_{i,j}
(i,j)
S_{l}
S_{l}
G_{l}
G_{l}
(i,j)
P
Q_{i,j}
P
Q_{i,j}
(i,j)
S_{l}
S_{l}
G_{l}
G_{l}
(i,j)
P_{l}
Q_{l,i,j}
l
(i,j)
(i,j)
(i,j)
S_{l}(i,j)
\tilde{I}(\cdot;\cdot)
P_{l}
Q_{l,i,j}
\displaystyle S_{l}(i,j)=\tilde{I}(P_{l};Q_{l,i,j}),
\displaystyle S_{l}(i,j)=\tilde{I}(P_{l};Q_{l,i,j}),
(i,j)
(k_{x_{l}},k_{y_{l}})
S_{l}(i,j)
\tilde{I}(\cdot)
H(\cdot)
\displaystyle\tilde{I}(P_{l},Q_{l,i,j})=\frac{H(P_{l})+H(Q_{l,i,j})-H(P_{l},Q_%
{l,i,j})}{H(P_{l},Q_{l,i,j})}
\displaystyle\tilde{I}(P_{l},Q_{l,i,j})=\frac{H(P_{l})+H(Q_{l,i,j})-H(P_{l},Q_%
{l,i,j})}{H(P_{l},Q_{l,i,j})}
H(P_{l},Q_{l,i,j})
P
Q_{i,j}
P_{l}
Q_{l,i,j}
P_{l}
Q_{l,i,j}
P_{l}
Q_{l,i,j}
(i,j)
G_{l}
S_{l}
k
\displaystyle G_{l}=\frac{k\times S_{l}}{(k-1)S_{l}+1}~{},
\displaystyle G_{l}=\frac{k\times S_{l}}{(k-1)S_{l}+1}~{},
k
G_{l}
94.90_{\pm 0.07}
94.97_{\pm 0.06}
95.00_{\pm 0.1}
95.22_{\pm 0.13}
95.00_{\pm 0.06}
95.20_{\pm 0.05}
73.70_{\pm 0.1}
74.04_{\pm 0.08}
74.40_{\pm 0.1}
74.37_{\pm 0.11}
74.10_{\pm 0.2}
75.50_{\pm 0.1}
1\times 10^{-4}
k
k
k\in\{2,3,4,5,6,7\}
k
k
1\%
1\times 10^{-4}
k
7\times 7
7\times 7
1\times 1,1\times 3,...,3\times 5,...
7\times 7,1\times 7,7\times 1,1\times 1
71.13_{\pm 0.04}
70.99
71.58
71.50_{\pm 0.03}
71.65_{\pm 0.05}
74.17_{\pm 0.05}
74.33
74.68
74.40_{\pm 0.03}
74.62_{\pm 0.05}
76.95_{\pm 0.05}
76.71
77.08
77.11_{\pm 0.03}
77.10_{\pm 0.01}
5\times 10^{-4}
(i,j)
(i,j)
k
k\in\{1,2,3,4,5,6\}
k
3\times 3
\alpha
\beta
\alpha,\beta\in\{0.8,1.0,1.25,1.7,5.0,10,100\}
69.6_{\pm 0.1}
71.0_{\pm 0.1}
71.1_{\pm 0.2}
71.5_{\pm 0.1}
k
k
k
k
k=5
k=5
k
5\times 10^{-4}
k=5
70.8_{\pm 0.1}
73.2_{\pm 0.1}
74.7_{\pm 0.1}
76.1_{\pm 0.1}
74.9_{\pm 0.1}
76.2_{\pm 0.1}
74.6_{\pm 0.1}
76.1_{\pm 0.2}
77.8_{\pm 0.1}
78.8_{\pm 0.1}
79.0_{\pm 0.3}
80.0_{\pm 0.2}
79.1_{\pm 0.2}
79.6_{\pm 0.2}
72.4_{\pm 0.1}
72.8_{\pm 0.2}
73.9_{\pm 0.1}
74.2_{\pm 0.2}
78.4_{\pm 0.1}
79.6_{\pm 0.1}
79.3_{\pm 0.2}
80.3_{\pm 0.2}
75.7_{\pm 0.1}
76.3_{\pm 0.1}
77.4_{\pm 0.1}
77.9_{\pm 0.1}
\alpha=48
79.1_{\pm 0.1}
79.9_{\pm 0.2}
\alpha=84
81.1_{\pm 0.1}
81.6_{\pm 0.1}
\alpha=270
83.3_{\pm 0.1}
83.6_{\pm 0.1}
79.0_{\pm 0.1}
80.0_{\pm 0.1}
68.3_{\pm 0.1}
70.7_{\pm 0.1}
71.0_{\pm 0.1}
73.2_{\pm 0.1}
69.2_{\pm 0.2}
70.8_{\pm 0.1}
66.2_{\pm 0.1}
66.2_{\pm 0.2}
66.2_{\pm 0.1}
67.0_{\pm 0.1}
68.8_{\pm 0.2}
70.4_{\pm 0.2}
68.4_{\pm 0.2}
69.9_{\pm 0.1}
69.2_{\pm 0.1}
70.2_{\pm 0.1}
69.8_{\pm 0.1}
71.1_{\pm 0.1}
75.8_{\pm 0.2}
76.3_{\pm 0.1}
77.6_{\pm 0.1}
78.5_{\pm 0.1}
75.8_{\pm 0.2}
76.4_{\pm 0.1}
72.2_{\pm 0.2}
72.3_{\pm 0.2}
72.2_{\pm 0.2}
72.9_{\pm 0.1}
75.1_{\pm 0.1}
76.2_{\pm 0.1}
74.9_{\pm 0.1}
75.8_{\pm 0.1}
75.6_{\pm 0.1}
76.0_{\pm 0.1}
76.2_{\pm 0.2}
76.8_{\pm 0.1}
70.4_{\pm 0.2}
71.1_{\pm 0.1}
70.8_{\pm 0.1}
72.5_{\pm 0.2}
68.8_{\pm 0.2}
70.8_{\pm 0.1}
71.0_{\pm 0.1}
72.4_{\pm 0.2}
70.8_{\pm 0.1}
73.2_{\pm 0.1}
68.6_{\pm 0.2}
71.6_{\pm 0.1}
71.0_{\pm 0.1}
73.0_{\pm 0.1}
70.1_{\pm 0.2}
73.2_{\pm 0.1}
68.2_{\pm 0.1}
71.3_{\pm 0.1}
77.5_{\pm 0.2}
78.1_{\pm 0.1}
77.5_{\pm 0.1}
78.0_{\pm 0.2}
75.2_{\pm 0.1}
75.6_{\pm 0.1}
77.8_{\pm 0.2}
78.4_{\pm 0.1}
77.8_{\pm 0.1}
78.8_{\pm 0.1}
76.2_{\pm 0.1}
76.7_{\pm 0.1}
78.0_{\pm 0.1}
78.7_{\pm 0.1}
77.9_{\pm 0.1}
79.0_{\pm 0.1}
76.4_{\pm 0.1}
77.2_{\pm 0.2}
X
SGS
E
N_{e}
N_{b}
L
e=0,...,(E-1)
e
N_{e}
b\leftarrow
N_{b}
X
b
l
X_{l}
l
L
(i,j)
l
P,Q_{(i,j)}\leftarrow
X_{l}
SGS_{l,(i,j)}\leftarrow
P
(i,j)
Q_{(i,j)}
(x,y)
(X,Y)
(x,y)
l
L
(i,j)
l
l
(i,j)
SGS_{l,(i,j)}
7\times 7
7\times 7
\displaystyle f\left(\frac{\partial\mathcal{L}}{\partial W_{l}^{(t)}},\ W_{l}^%
{(t)},\ ...,\frac{\partial\mathcal{L}}{\partial W_{l}^{(0)}},\ W_{l}^{(0)}%
\right)=\sum_{\tau=0}^{t}\left(\gamma^{(\tau)}\frac{\partial\mathcal{L}}{%
\partial W_{l}^{(\tau)}}+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle f\left(\frac{\partial\mathcal{L}}{\partial W_{l}^{(t)}},\ W_{l}^%
{(t)},\ ...,\frac{\partial\mathcal{L}}{\partial W_{l}^{(0)}},\ W_{l}^{(0)}%
\right)=\sum_{\tau=0}^{t}\left(\gamma^{(\tau)}\frac{\partial\mathcal{L}}{%
\partial W_{l}^{(\tau)}}+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
W_{l}^{(t)}
\partial\mathcal{L}/\partial W_{l}^{(t)}
l
t
f(\cdot)
\gamma^{(\tau)}
\zeta^{(\tau)}
t=0
\displaystyle Y_{l}=W_{l}^{(0)}\ast X_{l}=\left(\sum_{n=1}^{N}M_{l,n}\odot W_{%
l,n}^{(0)}\right)\ast X_{l}=\sum_{n=1}^{N}\left(\left(M_{l,n}\odot W_{l,n}^{(0%
)}\right)\ast X_{l}\right)
\displaystyle Y_{l}
\displaystyle=W_{l}^{(0)}\ast X_{l}=\left(\sum_{n=1}^{N}M_{l,n}\odot W_{l,n}^{%
(0)}\right)\ast X_{l}=\sum_{n=1}^{N}\left(\left(M_{l,n}\odot W_{l,n}^{(0)}%
\right)\ast X_{l}\right)
\forall(t\geq 0)
\displaystyle W_{l}^{(t)}=\sum_{n=1}^{N}M_{l,n}\odot W_{l,n}^{(t)}
\displaystyle W_{l}^{(t)}=\sum_{n=1}^{N}M_{l,n}\odot W_{l,n}^{(t)}
\forall(t\leq t_{0})
t_{0}=0
t=t_{0}+1
\forall(t\leq(t_{0}+1))
t=0
\forall(t\geq 0)
\forall(t\leq t_{0})
W_{l}^{t_{0}+1}
\displaystyle W_{l}^{(t_{0}+1)}\Leftarrow\sum_{n=1}^{N}M_{l,n}\odot\left(W_{n,%
l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(\gamma^{(\tau)}\frac{%
\partial\mathcal{L}}{\partial W_{l,n}^{(\tau)}}+\zeta^{(\tau)}W_{l,n}^{(t_{0})%
}\right)\right),
\displaystyle W_{l}^{(t_{0}+1)}
\displaystyle\Leftarrow\sum_{n=1}^{N}M_{l,n}\odot\left(W_{n,l}^{(t_{0})}-%
\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(\gamma^{(\tau)}\frac{\partial%
\mathcal{L}}{\partial W_{l,n}^{(\tau)}}+\zeta^{(\tau)}W_{l,n}^{(t_{0})}\right)%
\right),
\displaystyle=\sum_{n=1}^{N}\left(M_{l,n}\odot W_{l,n}^{(t_{0})}\right)-%
\lambda^{(t_{0})}\sum_{n=1}^{N}\left(M_{l,n}\odot\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(\tau)}}+\zeta^{(%
\tau)}W_{l,n}^{(\tau)}\right)\right)
\displaystyle=\sum_{n=1}^{N}\left(M_{l,n}\odot W_{l,n}^{(t_{0})}\right)-%
\lambda^{(t_{0})}\sum_{n=1}^{N}\left(M_{l,n}\odot\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(\tau)}}+\zeta^{(%
\tau)}W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{n=1}^{N}\left(M_{l,n}%
\odot\sum_{\tau=0}^{t_{0}}\left(\gamma^{(\tau)}\frac{\partial\mathcal{L}}{%
\partial W_{l,n}^{(\tau)}}+\zeta^{(\tau)}W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{n=1}^{N}\left(M_{l,n}%
\odot\sum_{\tau=0}^{t_{0}}\left(\gamma^{(\tau)}\frac{\partial\mathcal{L}}{%
\partial W_{l,n}^{(\tau)}}+\zeta^{(\tau)}W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{n=1}^{N}\left(\sum_{\tau=%
0}^{t_{0}}\left(\gamma^{(\tau)}M_{l,n}\odot\frac{\partial\mathcal{L}}{\partial
W%
_{l,n}^{(\tau)}}+\zeta^{(\tau)}M_{l,n}\odot W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{n=1}^{N}\left(\sum_{\tau=%
0}^{t_{0}}\left(\gamma^{(\tau)}M_{l,n}\odot\frac{\partial\mathcal{L}}{\partial
W%
_{l,n}^{(\tau)}}+\zeta^{(\tau)}M_{l,n}\odot W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(\sum%
_{n=1}^{N}\left(\gamma^{(\tau)}M_{l,n}\odot\frac{\partial\mathcal{L}}{\partial
W%
_{l,n}^{(\tau)}}+\zeta^{(\tau)}M_{l,n}\odot W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(\sum%
_{n=1}^{N}\left(\gamma^{(\tau)}M_{l,n}\odot\frac{\partial\mathcal{L}}{\partial
W%
_{l,n}^{(\tau)}}+\zeta^{(\tau)}M_{l,n}\odot W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}}{%
\partial W_{l,n}^{(\tau)}}\right)+\zeta^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}%
\odot W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}}{%
\partial W_{l,n}^{(\tau)}}\right)+\zeta^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}%
\odot W_{l,n}^{(\tau)}\right)\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}}{%
\partial W_{l,n}^{(\tau)}}\right)+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}}{%
\partial W_{l,n}^{(\tau)}}\right)+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
t
\displaystyle\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(t)}}=\frac{\partial%
\mathcal{L}}{\partial W_{l}^{(t)}}
\displaystyle\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(t)}}=\frac{\partial%
\mathcal{L}}{\partial W_{l}^{(t)}}
X^{(t)}
{\partial\mathcal{L}/\partial Y^{(t)}}
W
\displaystyle Y^{(t)}=W^{(t)}\ast X^{(t)}
\displaystyle Y^{(t)}
\displaystyle=W^{(t)}\ast X^{(t)}
\displaystyle Y(c_{o},h,w)^{(t)}=\sum_{c_{i}=0}^{C_{i}-1}\sum_{k_{h}=0}^{K_{H}%
-1}\sum_{k_{w}=0}^{K_{W}-1}W(c_{o},c_{i},k_{h},k_{w})^{(t)}X(c_{i},h+k_{h},w+k%
_{w})^{(t)}
\displaystyle Y(c_{o},h,w)^{(t)}
\displaystyle=\sum_{c_{i}=0}^{C_{i}-1}\sum_{k_{h}=0}^{K_{H}-1}\sum_{k_{w}=0}^{%
K_{W}-1}W(c_{o},c_{i},k_{h},k_{w})^{(t)}X(c_{i},h+k_{h},w+k_{w})^{(t)}
\displaystyle Y_{c_{o},h,w}^{(t)}=W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}X_{c_{i},h,%
k_{h},w,k_{w}}^{(t)}
\displaystyle Y_{c_{o},h,w}^{(t)}
\displaystyle=W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}X_{c_{i},h,k_{h},w,k_{w}}^{(t)}
\displaystyle\frac{\partial\mathcal{L}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{%
(t)}}=\sum_{k,i,j}\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\frac{%
\partial Y_{k,i,j}^{(t)}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}}
\displaystyle\frac{\partial\mathcal{L}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{%
(t)}}
\displaystyle=\sum_{k,i,j}\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}%
\frac{\partial Y_{k,i,j}^{(t)}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\frac{%
\partial Y_{k,i,j}^{(t)}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\frac{%
\partial Y_{k,i,j}^{(t)}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\frac{%
\partial W_{k,l,m,n}^{(t)}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}}X_{l,i,%
m,j,n}^{(t)}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\frac{%
\partial W_{k,l,m,n}^{(t)}}{\partial W_{c_{o},c_{i},k_{h},k_{w}}^{(t)}}X_{l,i,%
m,j,n}^{(t)}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\delta_{k,c_%
{o}}\delta_{l,c_{i}}\delta_{m,k_{h}}\delta_{n,k_{w}}X_{l,i,m,j,n}^{(t)}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{k,i,j}^{(t)}}\delta_{k,c_%
{o}}\delta_{l,c_{i}}\delta_{m,k_{h}}\delta_{n,k_{w}}X_{l,i,m,j,n}^{(t)}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{c_{o},i,j}^{(t)}}X_{c_{i}%
,i,k_{h},j,k_{w}}^{(t)}
\displaystyle=\frac{\partial\mathcal{L}}{\partial Y_{c_{o},i,j}^{(t)}}X_{c_{i}%
,i,k_{h},j,k_{w}}^{(t)}
\displaystyle=\sum_{i,j}\frac{\partial\mathcal{L}}{\partial Y_{c_{o},i,j}^{(t)%
}}X_{c_{i},i,k_{h},j,k_{w}}^{(t)}\quad\Rightarrow\quad\frac{\partial\mathcal{L%
}}{\partial W^{(t)}}=g\!\left(\frac{\partial\mathcal{L}}{dY^{(t)}},X^{(t)}\right)
\displaystyle=\sum_{i,j}\frac{\partial\mathcal{L}}{\partial Y_{c_{o},i,j}^{(t)%
}}X_{c_{i},i,k_{h},j,k_{w}}^{(t)}\quad\Rightarrow\quad\frac{\partial\mathcal{L%
}}{\partial W^{(t)}}=g\!\left(\frac{\partial\mathcal{L}}{dY^{(t)}},X^{(t)}\right)
\displaystyle Y^{(t_{0})}=\sum_{n=1}^{N}\left(\left(M_{n}\odot W_{n}^{(t_{0})}%
\right)\ast X^{(t_{0})}\right)=\sum_{n=1}^{N}Y_{n}^{(t_{0})}\quad\Rightarrow%
\quad\frac{\partial\mathcal{L}}{\partial Y_{n}^{(t_{0})}}=\frac{\partial%
\mathcal{L}}{\partial Y^{(t_{0})}}
\displaystyle Y^{(t_{0})}=\sum_{n=1}^{N}\left(\left(M_{n}\odot W_{n}^{(t_{0})}%
\right)\ast X^{(t_{0})}\right)=\sum_{n=1}^{N}Y_{n}^{(t_{0})}\quad\Rightarrow%
\quad\frac{\partial\mathcal{L}}{\partial Y_{n}^{(t_{0})}}=\frac{\partial%
\mathcal{L}}{\partial Y^{(t_{0})}}
\displaystyle\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(t)}}=g\!\left(\frac%
{\partial\mathcal{L}}{dY_{n}^{(t)}},X^{(t)}\right)=g\!\left(\frac{\partial%
\mathcal{L}}{dY^{(t)}},X^{(t)}\right)=\frac{\partial\mathcal{L}}{\partial W_{l%
}^{(t)}}
\displaystyle\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(t)}}=g\!\left(\frac%
{\partial\mathcal{L}}{dY_{n}^{(t)}},X^{(t)}\right)=g\!\left(\frac{\partial%
\mathcal{L}}{dY^{(t)}},X^{(t)}\right)=\frac{\partial\mathcal{L}}{\partial W_{l%
}^{(t)}}
\displaystyle W_{l}^{(t_{0}+1)}\Leftarrow W_{l}^{(t_{0})}-\lambda^{(t_{0})}%
\sum_{\tau=0}^{t_{0}}\left(\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot%
\frac{\partial\mathcal{L}}{\partial W_{l,n}^{(\tau)}}\right)+\zeta^{(\tau)}W_{%
l}^{(\tau)}\right)
\displaystyle W_{l}^{(t_{0}+1)}
\displaystyle\Leftarrow W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}%
\left(\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}%
}{\partial W_{l,n}^{(\tau)}}\right)+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}}{%
\partial W_{l}^{(\tau)}}\right)+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\odot\frac{\partial\mathcal{L}}{%
\partial W_{l}^{(\tau)}}\right)+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\right)\odot\frac{\partial\mathcal{L%
}}{\partial W_{l}^{(\tau)}}+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}\sum_{n=1}^{N}\left(M_{l,n}\right)\odot\frac{\partial\mathcal{L%
}}{\partial W_{l}^{(\tau)}}+\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}G_{l}\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(\tau)}}+%
\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle=W_{l}^{(t_{0})}-\lambda^{(t_{0})}\sum_{\tau=0}^{t_{0}}\left(%
\gamma^{(\tau)}G_{l}\odot\frac{\partial\mathcal{L}}{\partial W_{l}^{(\tau)}}+%
\zeta^{(\tau)}W_{l}^{(\tau)}\right)
\displaystyle\begin{bmatrix}K_{-1,-1}&K_{-1,\ 0}&K_{-1,+1}\\
K_{\ \ 0,-1}&K_{\ \ 0,\ 0}&K_{\ \ 0,+1}\\
K_{+1,-1}&K_{+1,\ 0}&K_{+1,+1}\\
\end{bmatrix}\coloneqq\begin{bmatrix}1/\beta&1/\alpha&1/\beta\\
1/\alpha&1&1/\alpha\\
1/\beta&1/\alpha&1/\beta\\
\end{bmatrix}\times\frac{9}{1+{4}/{a}+{4}/{b}}
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
k=5
k=5
