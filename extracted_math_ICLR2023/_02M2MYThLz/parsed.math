h
h
h
d\mathbf{X}_{t}=\mu(\mathbf{X}_{t})\,dt+\sigma(\mathbf{X}_{t})\,d\mathbf{B}_{t}
\mathbf{y}_{k}
\mathbf{X}_{t_{k}}
t_{k}\equiv k\,T
k\geq 1
\pi_{k}(d\mathbf{x})=\mathbb{P}(\mathbf{X}_{t_{k}}\in d\mathbf{x}|\mathbf{y}_{%
1},\ldots,\mathbf{y}_{k})
\mathbf{y}_{k}
h
h
h
A,B\in\mathbb{R}^{d,d}
\langle A,B\rangle_{\mathrm{F}}=\sum_{i,j=1}^{d}A_{i,j}B_{i,j}
\mathbf{u},\mathbf{v}\in\mathbb{R}^{d}
\langle\mathbf{u},\mathbf{v}\rangle=\sum_{i=1}^{d}u_{i}v_{i}
F
G
[FG](\mathbf{x})\equiv F(\mathbf{x})G(\mathbf{x})
\varphi:\mathbb{R}^{d}\to\mathbb{R}
\nabla\varphi(\mathbf{x})\in\mathbb{R}^{d}
\nabla^{2}\varphi(\mathbf{x})\in\mathbb{R}^{d,d}
x_{0}
\delta(d\mathbf{x};\mathbf{x}_{0})
\{\mathbf{X}_{t}\}_{t\geq 0}
\mathcal{X}=\mathbb{R}^{d}
\rho_{0}(d\mathbf{x})
\displaystyle d\mathbf{X}_{t}=\mu(\mathbf{X}_{t})\,dt+\sigma(\mathbf{X}_{t})\,%
d\mathbf{B}_{t},
\displaystyle d\mathbf{X}_{t}=\mu(\mathbf{X}_{t})\,dt+\sigma(\mathbf{X}_{t})\,%
d\mathbf{B}_{t},
\mu:\mathbb{R}^{d}\to\mathbb{R}^{d}
\sigma:\mathbb{R}^{d}\to\mathbb{R}^{d,d}
p_{s}(d\widehat{\mathbf{x}}\mid\mathbf{x})
\mathbb{P}(\mathbf{X}_{t+s}\in A\mid\mathbf{X}_{t}=\mathbf{x})=\int_{A}p_{s}(d%
\widehat{\mathbf{x}}\mid\mathbf{x})
s,t>0
A\subset\mathcal{X}
\{\mathbf{B}_{t}\}_{t\geq 0}
\mathbb{R}^{d}
\{\mathbf{X}_{t}\}_{t\geq 0}
t_{k}=kT
k\geq 1
T>0
\mathcal{Y}
\mathbf{Y}_{k}\in\mathcal{Y}
t_{k}
g:\mathcal{X}\times\mathcal{Y}\to\mathbb{R}_{+}
A\subset\mathcal{Y}
\mathbb{P}(\mathbf{Y}_{k}\in A\mid\mathbf{X}_{t_{k}}=\mathbf{x}_{k})=\int_{A}g%
(\mathbf{x}_{k},\mathbf{y})\,d\mathbf{y}
d\mathbf{y}
\mathcal{Y}
\mathcal{L}
\{\mathbf{X}_{t}\}_{t\geq 0}
\mathcal{L}\varphi=\langle\mu,\nabla\varphi\rangle+\frac{1}{2}\,\langle\sigma%
\sigma^{\top},\nabla^{2}\varphi\rangle_{\mathrm{F}}
\varphi:\mathcal{X}\to\mathbb{R}
\pi_{k}(d\mathbf{x})=\mathbb{P}(\mathbf{X}_{t_{k}}\in d\mathbf{x}\mid\mathbf{y%
}_{1},\ldots,\mathbf{y}_{k}).
\pi_{0}(d\mathbf{x})\equiv\rho_{0}(d\mathbf{x})
t=0
M\geq 1
\mathbf{x}^{1:M}_{t}=(\mathbf{x}^{1}_{t},\ldots,\mathbf{x}^{M}_{t})\in\mathcal%
{X}^{M}
\mathbf{x}^{j}_{0}\in\mathcal{X}
1\leq j\leq M
\rho_{0}(d\mathbf{x})
\pi_{0}(d\mathbf{x})\approx M^{-1}\sum_{j=1}^{M}\delta(d\mathbf{x};\mathbf{x}^%
{j}_{0})
\pi_{k}
k\geq 1
t_{k}
\pi_{k}(d\mathbf{x})\approx M^{-1}\sum_{j=1}^{M}\delta(d\mathbf{x};\mathbf{x}^%
{j}_{t_{k}})
\mathbf{x}^{1:M}_{t_{k}}
\widehat{\mathbf{x}}^{j}_{t_{k+1}}\sim q_{k+1}(d\widehat{\mathbf{x}}\mid%
\mathbf{x}^{j}_{t_{k}})
q_{k+1}(d\widehat{\mathbf{x}}\mid\mathbf{x})
q_{k+1}^{\text{BPF}}(d\widehat{\mathbf{x}}\mid\mathbf{x})=\mathbb{P}(\mathbf{X%
}_{t_{k+1}}\in d\widehat{\mathbf{x}}\mid\mathbf{X}_{t_{k}}=\mathbf{x})
q^{\text{FA-APF}}_{k+1}(d\widehat{\mathbf{x}}\mid\mathbf{x})=\mathbb{P}(%
\mathbf{X}_{t_{k+1}}\in d\widehat{\mathbf{x}}\mid\mathbf{X}_{t_{k}}=\mathbf{x}%
,\mathbf{Y}_{{k+1}}=\mathbf{y}_{k+1}).
\widehat{\mathbf{x}}^{j}_{t_{k+1}}
\overline{W}^{j}_{{k+1}}=W^{j}_{{k+1}}/\sum_{i=1}^{M}W^{i}_{{k+1}}
W^{j}_{{k+1}}
\displaystyle W^{j}_{{k+1}}=\frac{p_{T}(d\widehat{\mathbf{x}}^{j}_{t_{k+1}}%
\mid\mathbf{x}^{j}_{t_{k}})}{q_{k+1}(d\widehat{\mathbf{x}}^{j}_{t_{k+1}}\mid%
\mathbf{x}^{j}_{t_{k}})}\,g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},\mathbf{y}_{k+1%
}).
\displaystyle W^{j}_{{k+1}}=\frac{p_{T}(d\widehat{\mathbf{x}}^{j}_{t_{k+1}}%
\mid\mathbf{x}^{j}_{t_{k}})}{q_{k+1}(d\widehat{\mathbf{x}}^{j}_{t_{k+1}}\mid%
\mathbf{x}^{j}_{t_{k}})}\,g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},\mathbf{y}_{k+1%
}).
\displaystyle W^{j,\text{BPF}}_{{k+1}}=g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},%
\mathbf{y}_{k+1}),
\displaystyle W^{j,\text{BPF}}_{{k+1}}=g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},%
\mathbf{y}_{k+1}),
\displaystyle W^{j,\text{FA-APF}}_{{k+1}}=\mathbb{E}[g(\mathbf{X}_{t_{k+1}},%
\mathbf{y}_{k+1})\mid\mathbf{X}_{t_{k}}=\mathbf{x}^{j}_{t_{k}}].
\displaystyle W^{j,\text{FA-APF}}_{{k+1}}=\mathbb{E}[g(\mathbf{X}_{t_{k+1}},%
\mathbf{y}_{k+1})\mid\mathbf{X}_{t_{k}}=\mathbf{x}^{j}_{t_{k}}].
\pi_{{k+1}}(d\mathbf{x})\approx\sum_{j=1}^{M}\overline{W}^{j}_{{k+1}}\,\delta(%
d\mathbf{x};\mathbf{x}^{j}_{t_{k+1}})
\mathbf{x}^{1:M}_{t_{k+1}}
\mathbb{P}(\mathbf{x}^{j}_{t_{k+1}}=\widehat{\mathbf{x}}^{i}_{t_{k+1}})=%
\overline{W}^{i}_{{k+1}}
\mathbf{x}^{1:M}_{t_{k+1}}
t_{k+1}
\pi_{{k+1}}(d\mathbf{x})\approx M^{-1}\sum_{j=1}^{M}\delta(d\mathbf{x};\mathbf%
{x}^{j}_{t_{k+1}})
\mathbf{x}^{1:M}_{t_{k+1}}
\widehat{\mathbf{x}}^{1:M}_{t_{k+1}}
\widehat{\mathbb{P}}(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})=\prod_{k=1}^{K}\{M^%
{-1}\sum_{j=1}^{M}W^{j}_{{k}}\}
K\geq 1
\mathbb{P}(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})
\mathbb{E}[\log\widehat{\mathbb{P}}(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})]
q^{\text{FA-APF}}_{k+1}(d\widehat{\mathbf{x}}\mid\mathbf{x}\})
[0,T]
\mathbf{X}_{[0,T]}=\{\mathbf{X}_{t}\}_{t\in[0,T]}
\mathbf{Y}_{T}=\mathbf{y}
\mathbf{Y}_{T}=\mathbf{y}
\mathbf{c}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\mathbf{y}\in\mathcal{Y}
\{\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}\}_{t\in[0,T]}
\mathcal{L}^{\mathbf{c},\mathbf{y},t}\varphi(\mathbf{x})=\mathcal{L}\varphi(%
\mathbf{x})+\langle[\sigma\mathbf{c}](\mathbf{x},\mathbf{y},t),\nabla\varphi(%
\mathbf{x})\rangle
\displaystyle d\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}=\underbrace{\mu(\mathbf{%
X}^{\mathbf{c},\mathbf{y}}_{t})\,dt+\sigma(\mathbf{X}^{\mathbf{c},\mathbf{y}}_%
{t})\,d\mathbf{B}_{t}}_{\text{(original dynamics)}}\;+\;\underbrace{[\sigma\,%
\mathbf{c}](\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t)\,dt}_{\text{(%
control drift term)}}.
\displaystyle d\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}=\underbrace{\mu(\mathbf{%
X}^{\mathbf{c},\mathbf{y}}_{t})\,dt+\sigma(\mathbf{X}^{\mathbf{c},\mathbf{y}}_%
{t})\,d\mathbf{B}_{t}}_{\text{(original dynamics)}}\;+\;\underbrace{[\sigma\,%
\mathbf{c}](\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t)\,dt}_{\text{(%
control drift term)}}.
[\sigma\,\mathbf{c}](\mathbf{x},\mathbf{y},t)=\sigma(\mathbf{x},\mathbf{y},t)%
\mathbf{c}(\mathbf{x},\mathbf{y},t)
\mathbb{P}_{[0,T]}
\mathbb{P}^{\mathbf{c},\mathbf{y}}_{[0,T]}
\mathrm{C}([0,T],\mathbb{R}^{d})
(d\mathbb{P}_{[0,T]}/d\mathbb{P}^{\mathbf{c},\mathbf{y}}_{[0,T]})(\mathbf{X}_{%
[0,T]})
\displaystyle\exp{\left\{-\frac{1}{2}\int_{0}^{T}\|\mathbf{c}(\mathbf{X}_{t},%
\mathbf{y},t)\|^{2}\,dt-\int_{0}^{T}\langle\mathbf{c}(\mathbf{X}_{t},\mathbf{y%
},t),d\mathbf{B}_{t}\rangle\right\}}.
\displaystyle\exp{\left\{-\frac{1}{2}\int_{0}^{T}\|\mathbf{c}(\mathbf{X}_{t},%
\mathbf{y},t)\|^{2}\,dt-\int_{0}^{T}\langle\mathbf{c}(\mathbf{X}_{t},\mathbf{y%
},t),d\mathbf{B}_{t}\rangle\right\}}.
\mathbf{c}_{\star}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\mathbf{y}\in\mathcal{Y}
\mathbf{X}^{\mathbf{c}_{\star},\mathbf{y}}_{[0,T]}
\mathbf{X}_{[0,T]}
\mathbf{Y}_{T}=\mathbf{y}
\displaystyle h(\mathbf{x},\mathbf{y},t)=\mathbb{E}[g(\mathbf{X}_{T},\mathbf{y%
})\mid\mathbf{X}_{t}=\mathbf{x}]
\displaystyle h(\mathbf{x},\mathbf{y},t)=\mathbb{E}[g(\mathbf{X}_{T},\mathbf{y%
})\mid\mathbf{X}_{t}=\mathbf{x}]
\mathbf{Y}_{T}=\mathbf{y}
\mathbf{x}\in\mathcal{X}
t\in[0,T]
h:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}_{+}
\displaystyle(\partial_{t}+\mathcal{L})h=0,
\displaystyle(\partial_{t}+\mathcal{L})h=0,
h(\mathbf{x},\mathbf{y},T)=g(\mathbf{x},\mathbf{y})
h
\displaystyle\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla%
\log h](\mathbf{x},\mathbf{y},t).
\displaystyle\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla%
\log h](\mathbf{x},\mathbf{y},t).
h
h
h
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
\mathbf{y}\in\mathcal{Y}
\mathcal{X}
h
\|\mathbf{x}\|
v(\mathbf{x},\mathbf{y},t)=-\log[h(\mathbf{x},\mathbf{y},t)]
h
\displaystyle(\partial_{t}+\mathcal{L})v=\frac{1}{2}\,\|\sigma^{\top}\nabla v%
\|^{2},\;v(\mathbf{x},\mathbf{y},T)=-\log[g(\mathbf{x},\mathbf{y})].
\displaystyle(\partial_{t}+\mathcal{L})v=\frac{1}{2}\,\|\sigma^{\top}\nabla v%
\|^{2},\;v(\mathbf{x},\mathbf{y},T)=-\log[g(\mathbf{x},\mathbf{y})].
\{\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}\}_{t\in[0,T]}
\mathbf{c}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\{V_{t}\}_{t\in[0,T]}
V_{t}=v(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t)
\mathbf{c}(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
\partial_{t}v+\mathcal{L}v+\langle\sigma\mathbf{c},\nabla v\rangle=(1/2)\,\|%
\sigma^{\top}\nabla v\|^{2}+\langle\mathbf{c},\sigma^{\top}\nabla v\rangle
\mathbf{Y}_{T}=\mathbf{y}
0\leq s\leq T
\displaystyle\begin{aligned} V_{T}=V_{s}+\int_{s}^{T}{\left(\frac{1}{2}\,\|%
\mathbf{Z}_{t}\|^{2}+\langle\mathbf{c},\mathbf{Z}_{t}\rangle\right)}\,dt+\int_%
{s}^{T}\langle\mathbf{Z}_{t},d\mathbf{B}_{t}\rangle\quad\end{aligned}
\displaystyle\begin{aligned} V_{T}=V_{s}+\int_{s}^{T}{\left(\frac{1}{2}\,\|%
\mathbf{Z}_{t}\|^{2}+\langle\mathbf{c},\mathbf{Z}_{t}\rangle\right)}\,dt+\int_%
{s}^{T}\langle\mathbf{Z}_{t},d\mathbf{B}_{t}\rangle\quad\end{aligned}
\mathbf{Z}_{t}=[\sigma^{\top}\nabla v](\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},%
\mathbf{y},t)
V_{T}=-\log[g(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{T},\mathbf{y})]
(V_{t},\mathbf{Z}_{t})
\mathbf{c}
\mathbf{y}
(V_{t},\mathbf{Z}_{t})
\displaystyle-\log[g(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{T},\mathbf{y})]=
\displaystyle-\log[g(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{T},\mathbf{y})]=
\displaystyle V_{s}+\int_{s}^{T}{\left\{\frac{1}{2}\,\|\mathbf{Z}_{t}\|^{2}+%
\langle\mathbf{c},\mathbf{Z}_{t}\rangle\right\}}dt+\int_{s}^{T}\langle\mathbf{%
Z}_{t},d\mathbf{B}_{t}\rangle.
\displaystyle V_{s}+\int_{s}^{T}{\left\{\frac{1}{2}\,\|\mathbf{Z}_{t}\|^{2}+%
\langle\mathbf{c},\mathbf{Z}_{t}\rangle\right\}}dt+\int_{s}^{T}\langle\mathbf{%
Z}_{t},d\mathbf{B}_{t}\rangle.
\mu
\sigma
(V_{t},\mathbf{Z}_{t})
h
\{\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}\}_{t\in[0,T]}
\mathbf{c}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\{\mathbf{B}_{t}\}_{t\geq 0}
N_{0}:\mathcal{X}\times\mathcal{Y}\to\mathbb{R}
N:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\{V_{t}\}_{t\in[0,T]}
\displaystyle V_{s}-V_{0}=
\displaystyle V_{s}-V_{0}=
\displaystyle\int_{0}^{s}{\left\{\frac{1}{2}\,\|\mathbf{Z}_{t}\|^{2}+\langle%
\mathbf{c}(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t),\mathbf{Z}_{t}%
\rangle\right\}}dt+\int_{0}^{s}\langle\mathbf{Z}_{t},d\mathbf{B}_{t}\rangle,
\displaystyle\int_{0}^{s}{\left\{\frac{1}{2}\,\|\mathbf{Z}_{t}\|^{2}+\langle%
\mathbf{c}(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t),\mathbf{Z}_{t}%
\rangle\right\}}dt+\int_{0}^{s}\langle\mathbf{Z}_{t},d\mathbf{B}_{t}\rangle,
V_{0}
\{\mathbf{Z}_{t}\}_{t\in[0,T]}
\displaystyle V_{0}=N_{0}(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{0},\mathbf{y}),%
\quad\mathbf{Z}_{t}=N(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t).
\displaystyle V_{0}=N_{0}(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{0},\mathbf{y}),%
\quad\mathbf{Z}_{t}=N(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t},\mathbf{y},t).
\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}
V_{t}
\mathbf{B}_{t}
\mathbf{X}^{\mathbf{c},\mathbf{y}}_{0}\in\mathcal{X}
\mathbf{y}\in\mathcal{Y}
V_{T}=-\log[g(\mathbf{X}^{\mathbf{c},\mathbf{y}}_{T},\mathbf{y})]
(\mathbf{x},\mathbf{y},t)\in\mathcal{X}\times\mathcal{Y}\times[0,T]
\displaystyle N_{0}(\mathbf{x},\mathbf{y})=-\log h(\mathbf{x},\mathbf{y},0),
\displaystyle N_{0}(\mathbf{x},\mathbf{y})=-\log h(\mathbf{x},\mathbf{y},0),
\displaystyle N(\mathbf{x},\mathbf{y},t)=-[\sigma^{\top}\nabla\log h](\mathbf{%
x},\mathbf{y},t).
\displaystyle N(\mathbf{x},\mathbf{y},t)=-[\sigma^{\top}\nabla\log h](\mathbf{%
x},\mathbf{y},t).
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=-N(\mathbf{x},\mathbf{y},t).
N_{0}(\cdot,\cdot)
N(\cdot,\cdot,\cdot)
\theta_{0}\in\Theta_{0}
\theta\in\Theta
\displaystyle\mathcal{L}(\theta_{0},\theta;\mathbf{c})=\mathbb{E}{\left[{\left%
(V_{T}+\log[g(\mathbf{X}^{\mathbf{c},\mathbf{Y}}_{T},\mathbf{Y})]\right)}^{2}%
\right]}.
\displaystyle\mathcal{L}(\theta_{0},\theta;\mathbf{c})=\mathbb{E}{\left[{\left%
(V_{T}+\log[g(\mathbf{X}^{\mathbf{c},\mathbf{Y}}_{T},\mathbf{Y})]\right)}^{2}%
\right]}.
\{\mathbf{B}_{t}\}_{t\geq 0}
\mathbf{X}^{\mathbf{c},\mathbf{Y}}_{0}\sim\eta_{\mathbf{X}}(d\mathbf{x})
\mathbf{Y}\sim\eta_{\mathbf{Y}}(d\mathbf{y})
T
\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}
V_{t}
\eta_{\mathbf{X}}
\eta_{\mathbf{Y}}
\pi_{k},k\geq 1
\eta_{\mathbf{Y}}
N_{0}
N
J\geq 1
\mathbf{c}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
(\theta_{0},\theta)\in\Theta_{0}\times\Theta
\mathbf{B}^{j}_{[0,T]}
\mathbf{X}^{j}_{0}\sim\eta_{\mathbf{X}}(d\mathbf{x})
\mathbf{Y}^{j}\sim\eta_{\mathbf{Y}}(d\mathbf{y})
1\leq j\leq J
j
\mathbf{X}^{j}_{[0,T]}
\mathbf{X}^{j}_{0}
\mathbf{c}(\cdot,\mathbf{Y}^{j},\cdot)
\mathbf{B}^{j}_{[0,T]}
j
V^{j}_{[0,T]}
\mathbf{B}^{j}_{[0,T]}
(\theta_{0},\theta)\in\Theta_{0}\times\Theta
\displaystyle\widehat{\mathcal{L}}=J^{-1}\sum_{j=1}^{J}(V^{j}_{T}+\log[g(%
\mathbf{X}^{j}_{T},\mathbf{Y}^{j})])^{2}
\displaystyle\widehat{\mathcal{L}}=J^{-1}\sum_{j=1}^{J}(V^{j}_{T}+\log[g(%
\mathbf{X}^{j}_{T},\mathbf{Y}^{j})])^{2}
\partial_{\theta_{0}}\widehat{\mathcal{L}}
\partial_{\theta}\widehat{\mathcal{L}}
(\theta_{0},\theta)
\mathbf{c}
(\theta_{0},\theta)
\mathbf{c}
N_{0}
N
N_{0}
N
d
v(\mathbf{x},\mathbf{y},t)=\langle\mathbf{x},a(\mathbf{y},t)\mathbf{x}\rangle+%
\langle b(\mathbf{y},t),\mathbf{x}\rangle+c(\mathbf{y},t)
N(\mathbf{x},\mathbf{y},t)
N(\mathbf{x},\mathbf{y},T)=-[\sigma^{\top}\nabla\log g](\mathbf{x},\mathbf{y})
N(\mathbf{x},\mathbf{y},t)=(1-t/T)\widetilde{N}(\mathbf{x},\mathbf{y},t)-(t/T)%
[\sigma^{\top}\nabla\log g](\mathbf{x},\mathbf{y})
\widetilde{N}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\mathbf{c}(\mathbf{x},\mathbf{y},t)\equiv\mathbf{0}_{d}\in\mathbb{R}^{d}
(\mathbf{x},\mathbf{y},t)\in\mathcal{X}\times\mathcal{Y}\times[0,T]
\mathbf{c}_{\star}
(\theta_{0},\theta)\in\Theta_{0}\times\Theta
\mathbf{c}(\mathbf{x},\mathbf{y},t)=-N(\mathbf{x},\mathbf{y},t)
\mathbf{X}^{\mathbf{c},\mathbf{y}}_{t}
N_{0}
N
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla\log h](%
\mathbf{x},\mathbf{y},t)
\widehat{\mathbf{c}}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
\widehat{\mathbf{c}}(\mathbf{x},\mathbf{y},t)=-N(\mathbf{x},\mathbf{y},t)
N(\cdot,\cdot,\cdot)
\theta\in\Theta
\widehat{V}_{0}:\mathcal{X}\times\mathcal{Y}\to\mathbb{R}
v(\mathbf{x},\mathbf{y},0)=-\log h(\mathbf{x},\mathbf{y},0)
\widehat{V}_{0}(\mathbf{x},\mathbf{y})=N_{0}(\mathbf{x},\mathbf{y})
N_{0}(\cdot,\cdot)
\theta_{0}\in\Theta_{0}
M\geq 1
t_{k}\geq 0
\pi_{k}(d\mathbf{x})\approx M^{-1}\sum_{j=1}^{M}\delta(d\mathbf{x};\mathbf{x}^%
{j}_{t_{k}})
\mathbf{Y}_{{k+1}}=\mathbf{y}_{k+1}
\mathbf{x}^{1:M}_{t_{k}}
(\mathbf{x},t)\mapsto\widehat{\mathbf{c}}(\mathbf{x},\mathbf{y}_{k+1},t-t_{k})
\widehat{\mathbf{x}}^{j}_{t_{k+1}}
\widehat{\mathbf{x}}^{j}_{t_{k+1}}=\widehat{\mathbf{X}}^{j}_{t_{k+1}}
\{\widehat{\mathbf{X}}^{j}_{t}\}_{t\in[t_{k},t_{k+1}]}
\displaystyle d\widehat{\mathbf{X}}^{j}_{t}=\underbrace{\mu(\widehat{\mathbf{X%
}}^{j}_{t})\,dt+\sigma(\widehat{\mathbf{X}}^{j}_{t})\,d\mathbf{B}^{j}_{t}}_{%
\text{(original dynamics)}}+\underbrace{[\sigma\widehat{\mathbf{c}}](\widehat{%
\mathbf{X}}^{j}_{t},\mathbf{y}_{k+1},t-t_{k})\,dt}_{\text{(approximately %
optimal control)}}
\displaystyle d\widehat{\mathbf{X}}^{j}_{t}=\underbrace{\mu(\widehat{\mathbf{X%
}}^{j}_{t})\,dt+\sigma(\widehat{\mathbf{X}}^{j}_{t})\,d\mathbf{B}^{j}_{t}}_{%
\text{(original dynamics)}}+\underbrace{[\sigma\widehat{\mathbf{c}}](\widehat{%
\mathbf{X}}^{j}_{t},\mathbf{y}_{k+1},t-t_{k})\,dt}_{\text{(approximately %
optimal control)}}
\widehat{\mathbf{X}}^{j}_{t_{k}}=\mathbf{x}^{j}_{t_{k}}
\widehat{\mathbf{x}}^{j}_{t_{k+1}}
\overline{W}^{j}_{k+1}=W^{j}_{k+1}/\sum_{i=1}^{M}W^{i}_{k+1}
W^{j}_{k+1}=(d\mathbb{P}_{[t_{k},t_{k+1}]}/d\mathbb{P}^{\widehat{\mathbf{c}},%
\mathbf{y}_{k+1}}_{[t_{k},t_{k+1}]})(\widehat{\mathbf{X}}_{[t_{k},t_{k+1}]}^{j%
})\times g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},\mathbf{y}_{k+1})
\mathbb{P}_{[t_{k},t_{k+1}]}
\mathbb{P}^{\widehat{\mathbf{c}},\mathbf{y}_{k+1}}_{[t_{k},t_{k+1}]}
[t_{k},t_{k+1}]
W^{j}_{k+1}
\displaystyle\exp{\left\{-\frac{1}{2}\int_{t_{k}}^{t_{k+1}}\|\mathbf{Z}^{j}_{t%
}\|^{2}\,dt+\int_{t_{k}}^{t_{k+1}}\langle\mathbf{Z}^{j}_{t},d\mathbf{B}^{j}_{t%
}\rangle\right\}}g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},\mathbf{y}_{k+1})
\displaystyle\exp{\left\{-\frac{1}{2}\int_{t_{k}}^{t_{k+1}}\|\mathbf{Z}^{j}_{t%
}\|^{2}\,dt+\int_{t_{k}}^{t_{k+1}}\langle\mathbf{Z}^{j}_{t},d\mathbf{B}^{j}_{t%
}\rangle\right\}}g(\widehat{\mathbf{x}}^{j}_{t_{k+1}},\mathbf{y}_{k+1})
\mathbf{Z}^{j}_{t}=-\widehat{\mathbf{c}}(\widehat{\mathbf{X}}^{j}_{t},\mathbf{%
y}_{k+1},t-t_{k})
\{V^{j}_{t}\}_{t\in[t_{k},t_{k+1}]}
\displaystyle dV^{j}_{t}=-\frac{1}{2}\|\mathbf{Z}^{j}_{t}\|^{2}\,dt+\langle%
\mathbf{Z}^{j}_{t},d\mathbf{B}^{j}_{t}\rangle
\displaystyle dV^{j}_{t}=-\frac{1}{2}\|\mathbf{Z}^{j}_{t}\|^{2}\,dt+\langle%
\mathbf{Z}^{j}_{t},d\mathbf{B}^{j}_{t}\rangle
V^{j}_{t_{k}}=\widehat{V}_{0}(\mathbf{x}^{j}_{t_{k}},\mathbf{y}_{k+1})
W^{j}_{k+1}
\displaystyle\exp\Big{\{}\underbrace{V^{j}_{t_{k+1}}+\log g(\widehat{\mathbf{x%
}}^{j}_{t_{k+1}},\mathbf{y}_{k+1})}_{\approx 0}-\widehat{V}_{0}(\mathbf{x}^{j}%
_{t_{k}},\mathbf{y}_{k+1})\Big{\}},
\displaystyle\exp\Big{\{}\underbrace{V^{j}_{t_{k+1}}+\log g(\widehat{\mathbf{x%
}}^{j}_{t_{k+1}},\mathbf{y}_{k+1})}_{\approx 0}-\widehat{V}_{0}(\mathbf{x}^{j}%
_{t_{k}},\mathbf{y}_{k+1})\Big{\}},
\{V^{j}_{t}\}_{t\in[t_{k},t_{k+1}]}
\widehat{\mathbf{c}}(\mathbf{x},\mathbf{y},t)\equiv\mathbf{c}_{\star}(\mathbf{%
x},\mathbf{y},t)
\widehat{V}_{0}(\mathbf{x},\mathbf{y})\equiv-\log h(\mathbf{x},\mathbf{y},0)
\mathbf{Y}_{{k+1}}=\mathbf{y}_{k+1}
t_{k+1}
\mathbf{x}^{1:M}_{t_{k}}
t_{k}
j
\widehat{\mathbf{X}}^{j}_{[t_{k},t_{k+1}]}
\widehat{\mathbf{X}}^{j}_{t_{k}}=\mathbf{x}^{j}_{t_{k}}
\widehat{\mathbf{c}}(\cdot,\mathbf{y}_{k+1},t-t_{k})
\mathbf{B}^{j}_{[t_{k},t_{k+1}]}
\widehat{\mathbf{x}}^{j}_{t_{k+1}}=\widehat{\mathbf{X}}^{j}_{t_{k+1}}
j
V^{j}_{[t_{k},t_{k+1}]}
V^{j}_{t_{k}}=\widehat{V}_{0}(\mathbf{x}^{j}_{t_{k}},\mathbf{y}_{k+1})
\mathbf{Z}^{j}_{t}=-\widehat{\mathbf{c}}(\widehat{\mathbf{X}}^{j}_{t},\mathbf{%
y}_{k+1},t-t_{k})
\mathbf{B}^{j}_{[t_{k},t_{k+1}]}
W_{k+1}^{j}
\overline{W}^{j}_{{k+1}}=W^{j}_{{k+1}}/\sum_{i=1}^{M}W^{i}_{{k+1}}
\mathbf{x}^{1:M}_{t_{k+1}}
t_{k+1}
\widehat{\mathbf{x}}^{1:M}_{t_{k+1}}
\overline{W}^{1:M}_{{k+1}}
M\to\infty
h
h
h
2000
0.01
1000
10
100
T=1
0.02
T
\mathbb{E}[\log\widehat{p}(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})]
\textrm{Var}[\log\widehat{p}(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})]
\widehat{p}(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})
p(\mathbf{y}_{1},\ldots,\mathbf{y}_{K})
K
M
K
d
\mu(\mathbf{x})=-\mathbf{x}
\sigma(\mathbf{x})=\mathbf{I}_{d}
g(\mathbf{x},\mathbf{y})=\mathcal{N}(\mathbf{y};\mathbf{x},\sigma_{\mathbf{Y}}%
^{2}\mathbf{I}_{d})
\eta_{\mathbf{X}}=\mathcal{N}(\mathbf{0}_{d},\mathbf{I}_{d}/2)
\eta_{\mathbf{Y}}=\mathcal{N}(\mathbf{0}_{d},(1/2+\sigma_{\mathbf{Y}}^{2})%
\mathbf{I}_{d})
\sigma_{\mathbf{Y}}\in\{0.125,0.25,0.5,1.0\}
d\in\{1,2,4,8,16,32\}
1
4
\sigma_{\mathbf{Y}}
d=1
\sigma_{\mathbf{Y}}
\sigma_{\mathbf{Y}}
K
K=100
\sigma_{\mathbf{Y}}=0.25
d
\sigma_{\mathbf{Y}}=0.5
d>4
d
K
d
d=1
100
d=1
100
\sigma_{\mathbf{Y}}=0.5
100
\sigma_{\mathbf{Y}}=0.5
100
\{\mathbf{P}_{t}\}_{t\geq 0}
\displaystyle d\mathbf{P}_{t}=(\theta_{3}^{2}/2+\theta_{1}-\theta_{2}\mathbf{P%
}_{t})\mathbf{P}_{t}\,dt+\theta_{3}\mathbf{P}_{t}\,d\mathbf{B}_{t}.
\displaystyle d\mathbf{P}_{t}=(\theta_{3}^{2}/2+\theta_{1}-\theta_{2}\mathbf{P%
}_{t})\mathbf{P}_{t}\,dt+\theta_{3}\mathbf{P}_{t}\,d\mathbf{B}_{t}.
\mathbf{X}_{t}=\log(\mathbf{P}_{t})/\theta_{3}
\{\mathbf{X}_{t}\}_{t\geq 0}
\mu(\mathbf{x})=\theta_{1}/\theta_{3}-(\theta_{2}/\theta_{3})\exp(\theta_{3}%
\mathbf{x})
\sigma(\mathbf{x})=1
g(\mathbf{x},\mathbf{y})=\mathcal{NB}(\mathbf{y};\theta_{4},\exp(\theta_{3}%
\mathbf{x}))
\mathbf{y}\in\mathbb{N}_{0}
\theta_{4}>0
\exp(\theta_{3}\mathbf{x})
(\theta_{1},\theta_{2},\theta_{3},\theta_{4})
2(\theta_{3}^{2}/2+\theta_{1})/\theta_{3}^{2}-1
2\theta_{2}/\theta_{3}^{2}
\eta_{\mathbf{X}}
\eta_{\mathbf{Y}}
\theta_{4}\in\{1.069,4.303,17.631,78.161\}
1
4
K=100
\theta_{4}=17.631
\theta_{4}
\theta_{4}
\theta_{4}
K
100
100
\mathbf{X}_{t}=(\mathbf{X}_{t,1},\mathbf{X}_{t,2})
\displaystyle\mu(\mathbf{x})=\begin{pmatrix}\mathbf{x}_{1}^{4}/(2^{-4}+\mathbf%
{x}_{1}^{4})+2^{-4}/(2^{-4}+\mathbf{x}_{2}^{4})-\mathbf{x}_{1}\\
\mathbf{x}_{2}^{4}/(2^{-4}+\mathbf{x}_{2}^{4})+2^{-4}/(2^{-4}+\mathbf{x}_{1}^{%
4})-\mathbf{x}_{2}\end{pmatrix}
\displaystyle\mu(\mathbf{x})=\begin{pmatrix}\mathbf{x}_{1}^{4}/(2^{-4}+\mathbf%
{x}_{1}^{4})+2^{-4}/(2^{-4}+\mathbf{x}_{2}^{4})-\mathbf{x}_{1}\\
\mathbf{x}_{2}^{4}/(2^{-4}+\mathbf{x}_{2}^{4})+2^{-4}/(2^{-4}+\mathbf{x}_{1}^{%
4})-\mathbf{x}_{2}\end{pmatrix}
\sigma(\mathbf{x})=\sqrt{0.1}\mathbf{I}_{d}
\mathbf{X}_{0}=(1,1)
g(\mathbf{x},\mathbf{y})=\mathcal{N}(\mathbf{y};\mathbf{x},\sigma_{\mathbf{Y}}%
^{2}\mathbf{I}_{2})
\eta_{\mathbf{X}}
\eta_{\mathbf{Y}}
2000
K
\sigma_{\mathbf{Y}}\in\{0.25,0.5,1.0,2.0\}
1
4
\sigma_{\mathbf{Y}}=0.5
100
100
h
h
\mathbf{X}_{[0,T]}\mid(\mathbf{Y}_{T}=\mathbf{y})
\widehat{\mathbf{X}}_{[0,T]}
\displaystyle h(\mathbf{x},\mathbf{y},t)=\mathbb{E}[g(\mathbf{X}_{T},\mathbf{y%
})\mid\mathbf{X}_{t}=\mathbf{x}]=\int_{\mathcal{X}}g(\mathbf{x}_{T},\mathbf{y}%
)\,p_{T-t}(d\mathbf{x}_{T}\mid\mathbf{x})
\displaystyle h(\mathbf{x},\mathbf{y},t)=\mathbb{E}[g(\mathbf{X}_{T},\mathbf{y%
})\mid\mathbf{X}_{t}=\mathbf{x}]=\int_{\mathcal{X}}g(\mathbf{x}_{T},\mathbf{y}%
)\,p_{T-t}(d\mathbf{x}_{T}\mid\mathbf{x})
\mathbf{Y}_{T}=\mathbf{y}
\mathbf{x}\in\mathcal{X}
t\in[0,T]
h:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}_{+}
\displaystyle(\partial_{t}+\mathcal{L})h=0,
\displaystyle(\partial_{t}+\mathcal{L})h=0,
h(\mathbf{x},\mathbf{y},T)=g(\mathbf{x},\mathbf{y})
(\mathbf{x},\mathbf{y})\in\mathcal{X}\times\mathcal{Y}
\varphi:\mathcal{X}\to\mathbb{R}
\delta>0
\displaystyle\begin{aligned} \mathbb{E}[\varphi(\widehat{\mathbf{X}}_{t+\delta%
})|\widehat{\mathbf{X}}_{t}=\mathbf{x}]&=\mathbb{E}[\varphi(\mathbf{X}_{t+%
\delta})\,g(\mathbf{X}_{T},\mathbf{y})\mid\mathbf{X}_{t}=\mathbf{x}]~{}/~{}%
\mathbb{E}[g(\mathbf{X}_{T},\mathbf{y})|\mathbf{X}_{t}=\mathbf{x}]\\
&=\mathbb{E}[\varphi(\mathbf{X}_{t+\delta})\,h(\mathbf{X}_{t+\delta},\mathbf{y%
},t+\delta)\mid\mathbf{X}_{t}=\mathbf{x}]~{}/~{}h(\mathbf{x},\mathbf{y},t)\\
&=\varphi(\mathbf{x})+\delta{\left\{\frac{\mathcal{L}[\varphi\,h]}{h}\right\}}%
(\mathbf{x},\mathbf{y},t)+O(\delta^{2}).\end{aligned}
\displaystyle\begin{aligned} \mathbb{E}[\varphi(\widehat{\mathbf{X}}_{t+\delta%
})|\widehat{\mathbf{X}}_{t}=\mathbf{x}]&=\mathbb{E}[\varphi(\mathbf{X}_{t+%
\delta})\,g(\mathbf{X}_{T},\mathbf{y})\mid\mathbf{X}_{t}=\mathbf{x}]~{}/~{}%
\mathbb{E}[g(\mathbf{X}_{T},\mathbf{y})|\mathbf{X}_{t}=\mathbf{x}]\\
&=\mathbb{E}[\varphi(\mathbf{X}_{t+\delta})\,h(\mathbf{X}_{t+\delta},\mathbf{y%
},t+\delta)\mid\mathbf{X}_{t}=\mathbf{x}]~{}/~{}h(\mathbf{x},\mathbf{y},t)\\
&=\varphi(\mathbf{x})+\delta{\left\{\frac{\mathcal{L}[\varphi\,h]}{h}\right\}}%
(\mathbf{x},\mathbf{y},t)+O(\delta^{2}).\end{aligned}
h
\mathcal{L}[\varphi\,h]/h=\mathcal{L}\varphi+\langle\sigma\sigma^{\top}\nabla%
\log h,\nabla\varphi\rangle
\delta\rightarrow 0
\mathcal{L}\varphi+\langle\sigma\sigma^{\top}\nabla\log h,\nabla\varphi\rangle
\widehat{\mathbf{X}}_{[0,T]}
\displaystyle\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla%
\log h](\mathbf{x},\mathbf{y},t)
\displaystyle\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla%
\log h](\mathbf{x},\mathbf{y},t)
p_{t}(d\hat{\mathbf{x}}\mid\mathbf{x})=\mathcal{N}(\hat{\mathbf{x}};\mu_{%
\mathbf{X}}(\mathbf{x},t),\sigma_{\mathbf{X}}^{2}(t)\mathbf{I}_{d})d\hat{%
\mathbf{x}}
t>0
\mu_{\mathbf{X}}(\mathbf{x},t)=\mathbf{x}\exp(-t)
\sigma_{\mathbf{X}}^{2}(t)=\{1-\exp(-2t)\}/2
\displaystyle h(\mathbf{x},\mathbf{y},t)=\int_{\mathbb{R}^{d}}\mathcal{N}(%
\mathbf{y};\mathbf{x}_{T},\sigma_{\mathbf{Y}}^{2}\mathbf{I}_{d})\,\mathcal{N}(%
\mathbf{x}_{T};\mu_{\mathbf{X}}(\mathbf{x},T-t),\sigma_{\mathbf{X}}^{2}(T-t)%
\mathbf{I}_{d})d\mathbf{x}_{T}
\displaystyle h(\mathbf{x},\mathbf{y},t)=\int_{\mathbb{R}^{d}}\mathcal{N}(%
\mathbf{y};\mathbf{x}_{T},\sigma_{\mathbf{Y}}^{2}\mathbf{I}_{d})\,\mathcal{N}(%
\mathbf{x}_{T};\mu_{\mathbf{X}}(\mathbf{x},T-t),\sigma_{\mathbf{X}}^{2}(T-t)%
\mathbf{I}_{d})d\mathbf{x}_{T}
\displaystyle=(2\pi)^{-d/2}\sigma_{\mathbf{X}}^{-d}(T-t)\sigma_{\mathbf{Y}}^{-%
d}\sigma_{h}^{d}(T-t)\exp\left\{\frac{1}{2}\sigma_{h}^{2}(T-t)\left\|\frac{\mu%
_{\mathbf{X}}(\mathbf{x},T-t)}{\sigma_{\mathbf{X}}^{2}(T-t)}+\frac{\mathbf{y}}%
{\sigma_{\mathbf{Y}}^{2}}\right\|^{2}\right\}
\displaystyle=(2\pi)^{-d/2}\sigma_{\mathbf{X}}^{-d}(T-t)\sigma_{\mathbf{Y}}^{-%
d}\sigma_{h}^{d}(T-t)\exp\left\{\frac{1}{2}\sigma_{h}^{2}(T-t)\left\|\frac{\mu%
_{\mathbf{X}}(\mathbf{x},T-t)}{\sigma_{\mathbf{X}}^{2}(T-t)}+\frac{\mathbf{y}}%
{\sigma_{\mathbf{Y}}^{2}}\right\|^{2}\right\}
\displaystyle\times\exp\left\{-\frac{\|\mu_{\mathbf{X}}(\mathbf{x},T-t)\|^{2}}%
{2\sigma_{\mathbf{X}}^{2}(T-t)}-\frac{\|\mathbf{y}\|^{2}}{2\sigma_{\mathbf{Y}}%
^{2}}\right\}
\displaystyle\times\exp\left\{-\frac{\|\mu_{\mathbf{X}}(\mathbf{x},T-t)\|^{2}}%
{2\sigma_{\mathbf{X}}^{2}(T-t)}-\frac{\|\mathbf{y}\|^{2}}{2\sigma_{\mathbf{Y}}%
^{2}}\right\}
\sigma_{h}^{2}(t)=\{\sigma_{\mathbf{X}}^{-2}(t)+\sigma_{\mathbf{Y}}^{-2}\}^{-1}
v(\mathbf{x},\mathbf{y},t)=-\log[h(\mathbf{x},\mathbf{y},t)]
\displaystyle\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla%
\log h](\mathbf{x},\mathbf{y},t)
\displaystyle\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla%
\log h](\mathbf{x},\mathbf{y},t)
\displaystyle=\frac{\sigma_{h}^{2}(T-t)\exp\{-(T-t)\}}{\sigma_{\mathbf{X}}^{2}%
(T-t)}\left\{\frac{\mu_{\mathbf{X}}(\mathbf{x},T-t)}{\sigma_{\mathbf{X}}^{2}(T%
-t)}+\frac{\mathbf{y}}{\sigma_{\mathbf{Y}}^{2}}\right\}-\frac{\exp\{-(T-t)\}}{%
\sigma_{\mathbf{X}}^{2}(T-t)}\mu_{\mathbf{X}}(\mathbf{x},T-t).
\displaystyle=\frac{\sigma_{h}^{2}(T-t)\exp\{-(T-t)\}}{\sigma_{\mathbf{X}}^{2}%
(T-t)}\left\{\frac{\mu_{\mathbf{X}}(\mathbf{x},T-t)}{\sigma_{\mathbf{X}}^{2}(T%
-t)}+\frac{\mathbf{y}}{\sigma_{\mathbf{Y}}^{2}}\right\}-\frac{\exp\{-(T-t)\}}{%
\sigma_{\mathbf{X}}^{2}(T-t)}\mu_{\mathbf{X}}(\mathbf{x},T-t).
\mathbf{X}_{T}
\mathbf{X}_{0}=\mathbf{x}_{0}
\mathbf{Y}_{T}=\mathbf{y}
\mathcal{N}(\mu_{h}(\mathbf{x}_{0},\mathbf{y},T),\sigma_{h}^{2}(T)\mathbf{I}_{%
d})
\displaystyle\mu_{h}(\mathbf{x}_{0},\mathbf{y},T)=\sigma_{h}^{2}(T)\left\{%
\frac{\mu_{\mathbf{X}}(\mathbf{x}_{0},T)}{\sigma_{\mathbf{X}}^{2}(T)}+\frac{%
\mathbf{y}}{\sigma_{\mathbf{Y}}^{2}}\right\}.
\displaystyle\mu_{h}(\mathbf{x}_{0},\mathbf{y},T)=\sigma_{h}^{2}(T)\left\{%
\frac{\mu_{\mathbf{X}}(\mathbf{x}_{0},T)}{\sigma_{\mathbf{X}}^{2}(T)}+\frac{%
\mathbf{y}}{\sigma_{\mathbf{Y}}^{2}}\right\}.
M\geq 1
\pi_{k}(d\mathbf{x})=M^{-1}\sum_{j=1}^{M}\delta(d\mathbf{x};\mathbf{x}^{j}_{t_%
{k}})
t_{k}\geq 0
\mathbf{Y}_{k+1}=\mathbf{y}_{k+1}
t_{k+1}
t_{k}=s_{0}<s_{1}<\cdots<s_{P}=t_{k+1}
\{G_{p}\}_{p=0}^{P}
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})\prod_{p=1}^{P}G_{p}(%
\mathbf{x}_{s_{p-1}},\mathbf{x}_{s_{p}},\mathbf{y}_{k+1})=g(\mathbf{x}_{t_{k+1%
}},\mathbf{y}_{k+1}).
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})\prod_{p=1}^{P}G_{p}(%
\mathbf{x}_{s_{p-1}},\mathbf{x}_{s_{p}},\mathbf{y}_{k+1})=g(\mathbf{x}_{t_{k+1%
}},\mathbf{y}_{k+1}).
p\in\{1,\ldots,P\}
\mathbf{x}^{1:M}_{s_{p}}
\widehat{\mathbf{x}}^{j}_{s_{p+1}}\sim p_{\Delta s_{p+1}}(d\widehat{\mathbf{x}%
}\mid\mathbf{x}^{j}_{s_{p}})
\Delta s_{p+1}=s_{p+1}-s_{p}
\widehat{\mathbf{x}}^{j}_{s_{p+1}}
\overline{W}^{j}_{{p+1}}=W^{j}_{{p+1}}/\sum_{i=1}^{M}W^{i}_{{p+1}}
\displaystyle W^{j}_{{p}}=G_{p}(\mathbf{x}_{s_{p-1}}^{j},\widehat{\mathbf{x}}_%
{s_{p}}^{j},\mathbf{y}_{k+1}),\quad p\in\{1,\ldots,P-1\},
\displaystyle W^{j}_{{p}}
\displaystyle=G_{p}(\mathbf{x}_{s_{p-1}}^{j},\widehat{\mathbf{x}}_{s_{p}}^{j},%
\mathbf{y}_{k+1}),\quad p\in\{1,\ldots,P-1\},
\displaystyle W^{j}_{{P}}=G_{P}(\mathbf{x}_{s_{P-1}}^{j},\widehat{\mathbf{x}}_%
{s_{P}}^{j},\mathbf{y}_{k+1})G_{0}(\widehat{\mathbf{x}}_{s_{P}}^{j},\mathbf{y}%
_{k+2}),\quad\mbox{if }t_{k+1}\mbox{ is not the final observation time},
\displaystyle W^{j}_{{P}}
\displaystyle=G_{P}(\mathbf{x}_{s_{P-1}}^{j},\widehat{\mathbf{x}}_{s_{P}}^{j},%
\mathbf{y}_{k+1})G_{0}(\widehat{\mathbf{x}}_{s_{P}}^{j},\mathbf{y}_{k+2}),%
\quad\mbox{if }t_{k+1}\mbox{ is not the final observation time},
\displaystyle W^{j}_{{P}}=G_{P}(\mathbf{x}_{s_{P-1}}^{j},\widehat{\mathbf{x}}_%
{s_{P}}^{j},\mathbf{y}_{k+1}),\quad\mbox{if }t_{k+1}\mbox{ is the final %
observation time.}
\displaystyle W^{j}_{{P}}
\displaystyle=G_{P}(\mathbf{x}_{s_{P-1}}^{j},\widehat{\mathbf{x}}_{s_{P}}^{j},%
\mathbf{y}_{k+1}),\quad\mbox{if }t_{k+1}\mbox{ is the final observation time.}
\{G_{p}\}_{p=0}^{P}
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})=h(\mathbf{x}_{s_{0}},%
\mathbf{y}_{k+1},s_{0}),\quad G_{p}(\mathbf{x}_{s_{p-1}},\mathbf{x}_{s_{p}},%
\mathbf{y}_{k+1})=\frac{h(\mathbf{x}_{s_{p}},\mathbf{y}_{k+1},s_{p})}{h(%
\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1},s_{p-1})},
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})=h(\mathbf{x}_{s_{0}},%
\mathbf{y}_{k+1},s_{0}),\quad G_{p}(\mathbf{x}_{s_{p-1}},\mathbf{x}_{s_{p}},%
\mathbf{y}_{k+1})=\frac{h(\mathbf{x}_{s_{p}},\mathbf{y}_{k+1},s_{p})}{h(%
\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1},s_{p-1})},
p\in\{1,\ldots,P\}
h:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}_{+}
h
h(\mathbf{x}_{t_{k+1}},\mathbf{y}_{k+1},t_{k+1})=g(\mathbf{x}_{t_{k+1}},%
\mathbf{y}_{k+1})
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})=g(\mathbf{x}_{s_{0}},%
\mathbf{y}_{k+1})^{\lambda_{0}},\quad G_{p}(\mathbf{x}_{s_{p-1}},\mathbf{x}_{s%
_{p}},\mathbf{y}_{k+1})=\frac{g(\mathbf{x}_{s_{p}},\mathbf{y}_{k+1})^{\lambda_%
{p}}}{g(\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1})^{\lambda_{p-1}}},
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})=g(\mathbf{x}_{s_{0}},%
\mathbf{y}_{k+1})^{\lambda_{0}},\quad G_{p}(\mathbf{x}_{s_{p-1}},\mathbf{x}_{s%
_{p}},\mathbf{y}_{k+1})=\frac{g(\mathbf{x}_{s_{p}},\mathbf{y}_{k+1})^{\lambda_%
{p}}}{g(\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1})^{\lambda_{p-1}}},
p\in\{1,\ldots,P\}
\{\lambda_{p}\}_{p=0}^{P}
\lambda_{P}=1
\lambda_{p}=0
p\in\{1,\ldots,P-1\}
\{\lambda_{p}\}_{p=0}^{P}
\mathbf{c}_{\star}:\mathcal{X}\times\mathcal{Y}\times[0,T]\to\mathbb{R}^{d}
h
\{\mathbf{X}_{s_{p}}\}_{p=1}^{P}
\mathbf{X}_{s_{0}}=\mathbf{x}_{s_{0}}
\mathbf{Y}_{k+1}=\mathbf{y}_{k+1}
\displaystyle\prod_{p=1}^{P}p_{\Delta s_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}%
_{s_{p-1}})g(\mathbf{x}_{s_{P}},\mathbf{y}_{k+1}).
\displaystyle\prod_{p=1}^{P}p_{\Delta s_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}%
_{s_{p-1}})g(\mathbf{x}_{s_{P}},\mathbf{y}_{k+1}).
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})\prod_{p=1}^{P}p_{%
\Delta s_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}})G_{p}(\mathbf{x}_{s_%
{p-1}},\mathbf{x}_{s_{p}},\mathbf{y}_{k+1}).
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})\prod_{p=1}^{P}p_{%
\Delta s_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}})G_{p}(\mathbf{x}_{s_%
{p-1}},\mathbf{x}_{s_{p}},\mathbf{y}_{k+1}).
\{p_{\Delta s_{p}}\}_{p=1}^{P}
\{G_{p}\}_{p=0}^{P}
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})\prod_{p=1}^{P}p_{%
\Delta s_{p}}^{h}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}}),
\displaystyle G_{0}(\mathbf{x}_{s_{0}},\mathbf{y}_{k+1})\prod_{p=1}^{P}p_{%
\Delta s_{p}}^{h}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}}),
\{p_{\Delta s_{p}}^{h}\}_{p=1}^{P}
\displaystyle p_{\Delta s_{p}}^{h}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}}%
)=\frac{p_{\Delta s_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}})h(\mathbf%
{x}_{s_{p}},\mathbf{y}_{k+1},s_{p})}{h(\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1},s%
_{p-1})}
\displaystyle p_{\Delta s_{p}}^{h}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}}%
)=\frac{p_{\Delta s_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}})h(\mathbf%
{x}_{s_{p}},\mathbf{y}_{k+1},s_{p})}{h(\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1},s%
_{p-1})}
p\in\{1,\ldots,P\}
h(\mathbf{x}_{s_{p-1}},\mathbf{y}_{k+1},s_{p-1})=\int_{\mathcal{X}}p_{\Delta s%
_{p}}(d\mathbf{x}_{s_{p}}\mid\mathbf{x}_{s_{p-1}})h(\mathbf{x}_{s_{p}},\mathbf%
{y}_{k+1},s_{p})
\{p_{\Delta s_{p}}^{h}\}_{p=1}^{P}
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)=[\sigma^{\top}\nabla\log h](%
\mathbf{x},\mathbf{y},t)
\{p_{\Delta s_{p}}^{h}\}_{p=1}^{P}
G_{0}
h
h
N_{0}(\mathbf{x},\mathbf{y})
N(\mathbf{x},\mathbf{y},t)
v(\mathbf{x},\mathbf{y},0)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
\delta t=T/M
h
h
\delta t=T/M
I
J_{\textrm{obs}}
J_{\textrm{mini}}
\eta_{\mathbf{X}}(d\mathbf{x})
\eta_{\mathbf{Y}}(d\mathbf{y})
\mathbf{X}_{0}
V_{0}
\mathbf{Y}
m=1
M
\delta\mathbf{B}\sim\mathcal{N}(\mathbf{0}_{d},\delta t\mathbf{I}_{d})
\mathbf{Z}_{(m-1)\delta t}=N(\mathbf{X}_{(m-1)\delta t},\mathbf{Y},(m-1)\delta
t)
\mathbf{c}(\mathbf{X}_{(m-1)\delta t},\mathbf{Y},(m-1)\delta t)=\mathbf{0}_{d}
\mathbf{c}(\mathbf{X}_{(m-1)\delta t},\mathbf{Y},(m-1)\delta t)=-\mathbf{Z}_{(%
m-1)\delta t}
V_{m\delta t}=V_{(m-1)\delta t}+{\left(\frac{1}{2}\,\|\mathbf{Z}_{(m-1)\delta t%
}\|^{2}+\langle\mathbf{c}(\mathbf{X}_{(m-1)\delta t},\mathbf{Y},(m-1)\delta t)%
,\mathbf{Z}_{(m-1)\delta t}\rangle\right)}\delta t+\langle\mathbf{Z}_{(m-1)%
\delta t},\delta\mathbf{B}\rangle
\mathbf{X}_{m\delta t}=\mathbf{X}_{(m-1)\delta t}+{\left(\mu(\mathbf{X}_{(m-1)%
\delta t})+\sigma(\mathbf{X}_{(m-1)\delta t})\mathbf{c}(\mathbf{X}_{(m-1)%
\delta t},\mathbf{Y},(m-1)\delta t)\right)}\delta t+\sigma(\mathbf{X}_{(m-1)%
\delta t})\delta\mathbf{B}
\mathbf{X}_{T},V_{T}
\theta_{0}\in\Theta_{0}
N_{0}(\mathbf{x},\mathbf{y})
\theta\in\Theta
N(\mathbf{x},\mathbf{y},t)
J=J_{\textrm{obs}}\times J_{\textrm{{mini}}}
i=1
I
\mathbf{X}^{j}_{0}\sim\eta_{\mathbf{X}}(d\mathbf{x})
j=1
J
\mathbf{Y}^{j}\sim\eta_{\mathbf{Y}}(d\mathbf{y})
j=1
J_{\textrm{obs}}
(\mathbf{Y}^{j})_{j=1}^{J}=(\mathbf{Y}^{j})_{j=1}^{J_{\textrm{obs}}}.\texttt{%
repeat}((J_{\textrm{{mini}}},1))
J
J_{\textrm{{mini}}}
V_{0}^{j}=N_{0}(\mathbf{X}_{0}^{j},\mathbf{Y}^{j})
j=1
J
\mathbf{X}_{T}^{j},V_{T}^{j}=
\mathbf{X}_{0}^{j}
V_{0}^{j}
\mathbf{Y}^{j}
j=1
J
\widehat{\mathcal{L}}=J^{-1}\sum_{j=1}^{J}(V^{j}_{T}+\log[g(\mathbf{X}^{j}_{T}%
,\mathbf{Y}^{j})])^{2}
\widehat{\mathcal{L}}.\texttt{backward}()
\partial_{\theta_{0}}\widehat{\mathcal{L}}
\partial_{\theta}\widehat{\mathcal{L}}
\texttt{optimizer.step}()
(\theta_{0},\theta)
\texttt{optimizer.zero\_grad}()
N_{0}(\mathbf{x},\mathbf{y})
N(\mathbf{x},\mathbf{y},t)
500
500
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
500
y
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
500
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
500
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
500
y
d=1
\sigma_{\mathbf{Y}}=1.0
d=1
\sigma_{\mathbf{Y}}=1.0
2000
2000
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
y
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
y
d=1
\sigma_{\mathbf{Y}}=1.0
d=1
\sigma_{\mathbf{Y}}=1.0
500
500
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
500
y
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
500
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
500
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
500
y
\theta_{4}=1.069
\theta_{4}=1.069
2000
2000
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
y
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
y
\theta_{4}=1.069
\theta_{4}=1.069
2000
2000
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
y
N_{0}(\mathbf{x},\mathbf{y})
v(\mathbf{x},\mathbf{y},0)
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
y
-N(\mathbf{x},\mathbf{y},t)
\mathbf{c}_{\star}(\mathbf{x},\mathbf{y},t)
y
\sigma_{\mathbf{Y}}=0.5
\sigma_{\mathbf{Y}}=0.5
