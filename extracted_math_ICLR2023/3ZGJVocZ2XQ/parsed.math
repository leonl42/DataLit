\mathcal{S},\mathcal{A},\mathcal{P},\mathcal{R}
\mathcal{S}
\mathcal{A}
\mathcal{P}:\mathcal{S}\ \times\ \mathcal{A}\ \times\ \mathcal{S}\ \to\ [0,1]
P_{s,s^{\prime}}^{a}
s^{\prime}
a
s
\mathcal{R}:\mathcal{S}\ \times\ \mathcal{A}\ \times\mathcal{S}\ \to\ \mathbb{R}
R_{s,s^{\prime}}^{a}
s
s^{\prime}
a
\pi:\ \mathcal{S}\to\mathcal{A}
V_{\pi}(s)
\pi_{1}
\pi_{2}
V_{\pi_{1}}(s)\leq V_{\pi_{2}}(s)
s\in\mathcal{S}
\exists s_{1}\in\mathcal{S}
V_{\pi_{1}}(s_{1})<V_{\pi_{2}}(s_{1})
\pi^{*}
N
\pi
s_{0}
\displaystyle V_{\pi}^{N}(s)=\mathbb{E}[R(s_{N})+\sum_{k=0}^{N-1}R(s_{k},\pi(s%
_{k}),s_{k+1})\ |\ s_{0}=s]
\displaystyle V_{\pi}^{N}(s)=\mathbb{E}[R(s_{N})+\sum_{k=0}^{N-1}R(s_{k},\pi(s%
_{k}),s_{k+1})\ |\ s_{0}=s]
R(s_{N})
s_{N}
\{s_{0},s_{1},\ldots,s_{N}\}
s
P_{s_{k},s_{k+1}}^{\pi(s_{k})}
V^{*N}(s)
\pi^{*}(s)
\displaystyle V^{*N}(s)=\max_{\pi}v_{\pi}^{N}(s)
\displaystyle V^{*N}(s)
\displaystyle=\max_{\pi}v_{\pi}^{N}(s)
\displaystyle\pi^{*}(s)=\mathop{\mbox{{\rm argmax}}}\limits_{\pi}v_{\pi}^{N}(s)
\displaystyle\pi^{*}(s)
\displaystyle=\mathop{\mbox{{\rm argmax}}}\limits_{\pi}v_{\pi}^{N}(s)
\gamma
0\leq\gamma<1
t
\gamma^{t}
\displaystyle V_{\pi}(s)=\mathbb{E}[\sum_{k=0}^{\infty}\gamma^{k}R(s_{k},\pi(s%
_{k}),s_{k+1})\ |\ s_{0}=s]
\displaystyle V_{\pi}(s)=\mathbb{E}[\sum_{k=0}^{\infty}\gamma^{k}R(s_{k},\pi(s%
_{k}),s_{k+1})\ |\ s_{0}=s]
R_{ss^{\prime}}^{a}
M
v_{\pi}(s)\leq\sum_{t=0}^{\infty}\gamma^{t}M=\frac{M}{1-\gamma}
\pi
\gamma=1
\displaystyle\tilde{V}_{\pi}^{N}\lim_{N\to\infty}\frac{1}{N}V_{\pi}^{N}(s)
\displaystyle\tilde{V}_{\pi}^{N}\lim_{N\to\infty}\frac{1}{N}V_{\pi}^{N}(s)
V_{\pi}^{N}(s)
N
\pi
s
V^{*}(s)
\displaystyle V^{*}(s)=\max_{a\in\mathcal{A}}\mathbb{E}[R(s,a,s^{\prime})+%
\gamma V^{*}(s^{\prime})].
\displaystyle V^{*}(s)=\max_{a\in\mathcal{A}}\mathbb{E}[R(s,a,s^{\prime})+%
\gamma V^{*}(s^{\prime})].
V(s)
s
\left|\mathcal{S}\right|
\left|\mathcal{A}\right|
(s_{t},a_{t},r_{t},s_{t+1})
V=(V(1),\ldots,V(\left|S\right|))
TV
\displaystyle(TV)(s)=\max_{a\in\mathcal{A}}\sum_{s^{\prime}\in\mathcal{S}}p_{%
ss^{\prime}}^{a}(R(s,a,s^{\prime})+\gamma V(s^{\prime}))
\displaystyle(TV)(s)=\max_{a\in\mathcal{A}}\sum_{s^{\prime}\in\mathcal{S}}p_{%
ss^{\prime}}^{a}(R(s,a,s^{\prime})+\gamma V(s^{\prime}))
V
\pi
T_{\pi}V
\displaystyle(T_{\pi}V)(s)=\sum_{s^{\prime}\in\mathcal{S}}p_{ss^{\prime}}^{\pi%
(s)}(R(s,\pi(s),s^{\prime})+\gamma V(s^{\prime}))
\displaystyle(T_{\pi}V)(s)=\sum_{s^{\prime}\in\mathcal{S}}p_{ss^{\prime}}^{\pi%
(s)}(R(s,\pi(s),s^{\prime})+\gamma V(s^{\prime}))
\pi
\left|\mathcal{S}\right|\times\left|\mathcal{S}\right|
P_{\pi}
(i,j)
p_{i,j}^{\pi(i)}
T_{\pi}V
\displaystyle T_{\pi}V=R_{\pi}+\gamma P_{\pi}V
\displaystyle T_{\pi}V=R_{\pi}+\gamma P_{\pi}V
\displaystyle R_{\pi}(s)=\sum_{s^{\prime}\in\mathcal{S}}p_{ss^{\prime}}^{\pi(s%
)}R(s,\pi(s),s^{\prime})
\displaystyle R_{\pi}(s)=\sum_{s^{\prime}\in\mathcal{S}}p_{ss^{\prime}}^{\pi(s%
)}R(s,\pi(s),s^{\prime})
T^{k}
T_{\pi}^{k}
T
T_{\pi}
k
T_{\pi}
T
V^{*}
V=T\ V
\lim_{k\to\infty}T^{k}V=V^{*}
V
T_{\pi}V^{*}=TV^{*}
V
\lim_{k\to\infty}T_{\pi}^{k}V=V_{\pi}
V_{\pi}
V=T_{\pi}\ V
T
\rho
\left|\mathcal{S}\right|
\beta<1
\displaystyle\left\lVert TV-TV^{\prime}\right\rVert_{\rho}\leq\beta\left\lVert
V%
-V^{\prime}\right\rVert_{\rho}
\displaystyle\left\lVert TV-TV^{\prime}\right\rVert_{\rho}\leq\beta\left\lVert
V%
-V^{\prime}\right\rVert_{\rho}
V
V^{\prime}
\left\lVert V\right\rVert_{\rho}=\max_{s\in\mathcal{S}}\frac{\left|V(s)\right|%
}{\rho(s)}
V^{*}
T^{k}V
V
\lim_{k\to\infty}T^{k}V=V^{*}
N
V_{0}
t=0
V_{t}=TV_{t-1}
e_{t}=\left\lVert V_{t}-V_{t-1}\right\rVert_{max}
t=t\ +\ 1
e_{t}<\epsilon
\pi(s)=\mathop{\mbox{{\rm argmax}}}\limits_{a\in\mathcal{A}}\sum_{s^{\prime}%
\in\mathcal{S}}P_{ss^{\prime}}^{a}[R(s,a,s^{\prime})+\gamma V_{t}(s^{\prime})]
\epsilon=\epsilon^{\prime}\frac{1-\gamma}{2\gamma}
\frac{\epsilon^{\prime}}{2}
\epsilon^{\prime}
O(\left|\mathcal{A}\right|\left|\mathcal{S}\right|^{2})
\left|\mathcal{S}\right|
\left|\mathcal{A}\right|
\pi_{0}
t=0
V_{\pi_{t}}
\pi_{t+1}(s)=\mathop{\mbox{{\rm argmax}}}\limits_{a\in\mathcal{A}}\sum_{s^{%
\prime}}P_{ss^{\prime}}^{a}(R_{ss^{\prime}}^{a}+\gamma V_{\pi_{t}}(s^{\prime}))
s\in\mathcal{S}
t=t\ +\ 1
\pi_{t+1}(s)=\pi_{t}(s)
s\in\mathcal{S}
\mathcal{S}
\mathcal{S}
\rho
P_{\pi}
\mathcal{N}
\mathcal{T}=\mathcal{S}-\mathcal{N}
\displaystyle\begin{array}[]{rll}V_{\pi}(\mathcal{N})&=(I-P_{\pi}(\mathcal{N},%
\mathcal{N}))^{-1}(R_{\pi}(\mathcal{N})+P_{\pi}(\mathcal{N},\mathcal{T})R_{\pi%
}(\mathcal{T}))&\mbox{Stochastic Shortest Path}\\
V_{\pi}&=(I-\gamma P_{\pi})^{-1}R_{\pi}&\mbox{Discounted Reward}\\
\tilde{V}_{\pi}&=(1-P_{\pi})^{-1}(R_{\pi}-\rho)&\mbox{Average Reward}\end{array}
\displaystyle\begin{array}[]{rll}V_{\pi}(\mathcal{N})&=(I-P_{\pi}(\mathcal{N},%
\mathcal{N}))^{-1}(R_{\pi}(\mathcal{N})+P_{\pi}(\mathcal{N},\mathcal{T})R_{\pi%
}(\mathcal{T}))&\mbox{Stochastic Shortest Path}\\
V_{\pi}&=(I-\gamma P_{\pi})^{-1}R_{\pi}&\mbox{Discounted Reward}\\
\tilde{V}_{\pi}&=(1-P_{\pi})^{-1}(R_{\pi}-\rho)&\mbox{Average Reward}\end{array}
O(\left|\mathcal{S}\right|^{3})
O(\left|\mathcal{A}\right|\left|\mathcal{S}\right|^{2})
\displaystyle\begin{array}[]{rl}\mbox{Variables: }&V(s),\quad\forall s\in%
\mathcal{S}\\
\mbox{Minimize: }&\sum\rho(s)V{s}\\
\mbox{Subject to: }&V(s)\geq\sum_{s^{\prime}}P_{ss^{\prime}}^{a}(R_{ss^{\prime%
}}^{a}+\gamma V_{\pi_{t}}(s^{\prime}))\quad\forall s\in\mathcal{S},\forall a%
\in\mathcal{A}\end{array}
\displaystyle\begin{array}[]{rl}\mbox{Variables: }&V(s),\quad\forall s\in%
\mathcal{S}\\
\mbox{Minimize: }&\sum\rho(s)V{s}\\
\mbox{Subject to: }&V(s)\geq\sum_{s^{\prime}}P_{ss^{\prime}}^{a}(R_{ss^{\prime%
}}^{a}+\gamma V_{\pi_{t}}(s^{\prime}))\quad\forall s\in\mathcal{S},\forall a%
\in\mathcal{A}\end{array}
\rho
\left|\mathcal{A}\right|\left|\mathcal{S}\right|
\left|\mathcal{S}\right|
s
a
V(s)
\displaystyle V_{\pi}(s_{t})=\mathbb{E}[\sum_{m=0}^{\infty}\gamma^{m}g(s_{t+m}%
,s_{t+m+1})]
\displaystyle V_{\pi}(s_{t})
\displaystyle=\mathbb{E}[\sum_{m=0}^{\infty}\gamma^{m}g(s_{t+m},s_{t+m+1})]
\displaystyle=\mathbb{E}[g(s_{t},s_{t+1})+\gamma V_{\pi}(s_{t+1})]
\displaystyle=\mathbb{E}[g(s_{t},s_{t+1})+\gamma V_{\pi}(s_{t+1})]
\displaystyle\hat{V}(s_{t})=(1-\alpha_{t})\hat{V}(s_{t})+\alpha_{t}(g(s_{t},s_%
{t+1})+\gamma\hat{V}(s_{t+1})-\hat{V}(s_{t}))
\displaystyle\hat{V}(s_{t})
\displaystyle=(1-\alpha_{t})\hat{V}(s_{t})+\alpha_{t}(g(s_{t},s_{t+1})+\gamma%
\hat{V}(s_{t+1})-\hat{V}(s_{t}))
\displaystyle=(1-\alpha_{t})\hat{V}(s)+\alpha_{t}d_{t}
\displaystyle=(1-\alpha_{t})\hat{V}(s)+\alpha_{t}d_{t}
\alpha_{t}\in(0,1)
d_{t}=g(s_{t},s_{t+1})+\gamma\hat{V}(s_{t+1})-\hat{V}(s_{t})
g(s_{t},\pi(s_{t}),s_{t+1})+\gamma\hat{V}(s_{t+1})
\hat{V}(s_{t})
L
L+1
\displaystyle V_{\pi}(s_{t})=\mathbb{E}[\sum_{m=0}^{L}\gamma^{m}g(s_{t+m},s_{t%
+m+1})+V_{\pi}(s_{t+L+1})]
\displaystyle V_{\pi}(s_{t})
\displaystyle=\mathbb{E}[\sum_{m=0}^{L}\gamma^{m}g(s_{t+m},s_{t+m+1})+V_{\pi}(%
s_{t+L+1})]
L
L
L
\lambda<1
(1-\lambda)\lambda^{L}
L
\displaystyle V_{\pi}(s_{t})=(1-\lambda)\mathbb{E}[\sum_{L=0}^{\infty}\lambda^%
{L}(\sum_{m=0}^{L}\gamma^{m}g(s_{t+m},s_{t+m+1})+V_{\pi}(s_{t+L+1}))]
\displaystyle V_{\pi}(s_{t})
\displaystyle=(1-\lambda)\mathbb{E}[\sum_{L=0}^{\infty}\lambda^{L}(\sum_{m=0}^%
{L}\gamma^{m}g(s_{t+m},s_{t+m+1})+V_{\pi}(s_{t+L+1}))]
\displaystyle=\mathbb{E}[(1-\lambda)\sum_{m=0}^{\infty}g(s_{t+m},s_{t+m+1})%
\sum_{L=m}^{\infty}\lambda^{m}+\sum_{L=0}^{\infty}(\lambda^{L}-\lambda^{L+1})V%
_{\pi}(s_{t+L+1})]
\displaystyle=\mathbb{E}[(1-\lambda)\sum_{m=0}^{\infty}g(s_{t+m},s_{t+m+1})%
\sum_{L=m}^{\infty}\lambda^{m}+\sum_{L=0}^{\infty}(\lambda^{L}-\lambda^{L+1})V%
_{\pi}(s_{t+L+1})]
\displaystyle=\mathbb{E}[\sum_{m=0}^{\infty}\lambda^{m}\gamma^{m}d_{m+t}]+V_{%
\pi}(s_{t})
\displaystyle=\mathbb{E}[\sum_{m=0}^{\infty}\lambda^{m}\gamma^{m}d_{m+t}]+V_{%
\pi}(s_{t})
\displaystyle\hat{V}(s_{t})=(1-\alpha_{t})\hat{V}(s_{t})+\alpha_{t}\sum_{m=t}^%
{\infty}(\lambda\gamma)^{m-t}d_{m}
\displaystyle\hat{V}(s_{t})=(1-\alpha_{t})\hat{V}(s_{t})+\alpha_{t}\sum_{m=t}^%
{\infty}(\lambda\gamma)^{m-t}d_{m}
\lambda
\lambda
\lambda
\lambda
0
V_{\pi}
\lambda
Q(s,a)
\displaystyle Q_{t+1}(s,a)=(1-\alpha_{t})Q_{t}(s,a)+\alpha_{t}(g(s,a,s^{\prime%
})+\gamma\max_{a^{\prime}\in\mathcal{A}}Q_{t}(s^{\prime},a^{\prime}))
\displaystyle Q_{t+1}(s,a)=(1-\alpha_{t})Q_{t}(s,a)+\alpha_{t}(g(s,a,s^{\prime%
})+\gamma\max_{a^{\prime}\in\mathcal{A}}Q_{t}(s^{\prime},a^{\prime}))
s^{\prime}
g(s,a,s^{\prime})
(s,a)
P_{ss^{\prime}}^{a}
Q(s,a)
V(s)
\left|\mathcal{S}\right|
\pi
\pi
V(s)
\displaystyle\hat{V}(s,w)=\phi(s)^{\prime}w,\quad\forall s\in\mathcal{S}
\displaystyle\hat{V}(s,w)=\phi(s)^{\prime}w,\quad\forall s\in\mathcal{S}
w
\phi(i)
\left|\mathcal{D}\right|
s
V\approx\hat{V}=\Phi w
\Phi
\left|\mathcal{S}\right|\times\left|\mathcal{D}\right|
\phi(s)
s\in\mathcal{S}
V
\mathcal{D}
\left|\mathcal{D}\right|
\Phi
\Phi
\left|\mathcal{D}\right|
\Pi
\left\lVert\cdot\right\rVert_{\rho}
\displaystyle\left\lVert V\right\rVert_{\rho}=\sqrt{\sum_{s\in\mathcal{S}}\rho%
_{s}V^{2}(s)},
\displaystyle\left\lVert V\right\rVert_{\rho}=\sqrt{\sum_{s\in\mathcal{S}}\rho%
_{s}V^{2}(s)},
\rho
\Pi V
\left\lVert V-\Phi\ w\right\rVert_{\rho}
\displaystyle\Pi V=\Phi\ w_{\Phi}
\displaystyle\Pi V
\displaystyle=\Phi\ w_{\Phi}
\displaystyle w_{V}=\mathop{\mbox{{\rm argmin}}}\limits_{w\in\mathbb{E}^{%
\mathbb{D}}}\left\lVert V-\Phi\ w\right\rVert_{\rho}^{2}
\displaystyle w_{V}
\displaystyle=\mathop{\mbox{{\rm argmin}}}\limits_{w\in\mathbb{E}^{\mathbb{D}}%
}\left\lVert V-\Phi\ w\right\rVert_{\rho}^{2}
\displaystyle\Pi=\Phi(\Phi^{\prime}D_{\rho}\Phi)^{-1}D_{\rho}
\displaystyle\Pi=\Phi(\Phi^{\prime}D_{\rho}\Phi)^{-1}D_{\rho}
D_{\rho}
\left|\mathcal{S}\right|\times\left|\mathcal{S}\right|
\rho(s)
T_{\pi}
\displaystyle\Phi\ w=\Pi T_{\pi}(\Phi\ w)
\displaystyle\Phi\ w
\displaystyle=\Pi T_{\pi}(\Phi\ w)
\displaystyle\Phi\ w=\Pi[R_{\pi}+\gamma P_{\pi}\Phi\ w]
\displaystyle\Phi\ w
\displaystyle=\Pi[R_{\pi}+\gamma P_{\pi}\Phi\ w]
\phi\ w_{\Phi}
V_{\pi}
\Phi
w_{\Phi}
\displaystyle[\Phi^{\prime}D_{\rho}(I-\gamma P_{\pi})\Phi]\ w_{\phi}=\Phi^{%
\prime}D_{\rho}R_{\pi}
\displaystyle[\Phi^{\prime}D_{\rho}(I-\gamma P_{\pi})\Phi]\ w_{\phi}
\displaystyle=\Phi^{\prime}D_{\rho}R_{\pi}
\displaystyle Aw_{\phi}=b
\displaystyle Aw_{\phi}
\displaystyle=b
w=A^{-1}b
T_{\pi}
\Pi T_{\pi}
\left\lVert\cdot\right\rVert_{\rho}
\rho
P_{\pi}
\Pi T_{\pi}
w_{0}
\displaystyle\Phi\ w_{t+1}=\Pi T_{\pi}(\Phi\ w_{t})
\displaystyle\Phi\ w_{t+1}=\Pi T_{\pi}(\Phi\ w_{t})
\left|\mathcal{S}\right|
T_{\pi}(\Phi\ w_{t})
\left|\mathcal{S}\right|
\rho
\pi
t
\displaystyle\hat{A}_{t}=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})(\phi(s_{k})-%
\gamma\phi(s_{k+1}))^{\prime}
\displaystyle\hat{A}_{t}
\displaystyle=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})(\phi(s_{k})-\gamma\phi(s_%
{k+1}))^{\prime}
\displaystyle\hat{b}_{t}=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})R(s_{k},s_{k+1})
\displaystyle\hat{b}_{t}
\displaystyle=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})R(s_{k},s_{k+1})
\hat{A}_{t}
\hat{b}_{t}
\displaystyle w_{t}=\hat{A}_{t}^{-1}\hat{b}_{t}
\displaystyle w_{t}=\hat{A}_{t}^{-1}\hat{b}_{t}
\lambda
\lambda<1
\displaystyle\hat{A}_{t}^{\lambda}=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})\sum_%
{m=k}^{t}\gamma^{m-k}\lambda^{m-k}(\phi(s_{m})-\gamma\phi(s_{m+1}))^{\prime}
\displaystyle\hat{A}_{t}^{\lambda}
\displaystyle=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})\sum_{m=k}^{t}\gamma^{m-k}%
\lambda^{m-k}(\phi(s_{m})-\gamma\phi(s_{m+1}))^{\prime}
\displaystyle\hat{b}_{t}^{\lambda}=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})\sum_%
{m=k}^{t}\gamma^{m-k}\lambda^{m-k}R(s_{m},s_{m+1})
\displaystyle\hat{b}_{t}^{\lambda}
\displaystyle=\frac{1}{t+1}\sum_{k=0}^{t}\phi(s_{k})\sum_{m=k}^{t}\gamma^{m-k}%
\lambda^{m-k}R(s_{m},s_{m+1})
w_{t}=(\hat{A}_{t}^{\lambda})^{-1}\hat{b}_{t}^{\lambda}
\lambda
\Phi
\displaystyle\begin{array}[]{rl}\mbox{Variables: }&w_{1},\ldots,w_{\left|%
\mathcal{D}\right|}\\
\mbox{Minimize: }&\sum_{s}\rho(s)\sum_{i}w_{i}\phi_{i}{s}\\
\mbox{Subject to: }&\sum_{i}w_{i}\phi_{i}(s)\geq\sum_{s^{\prime}}P_{ss^{\prime%
}}^{a}(R_{ss^{\prime}}^{a}+\gamma\sum_{i}w_{i}\phi_{i}(s^{\prime}))\quad%
\forall s\in\mathcal{S},\forall a\in\mathcal{A}\end{array}
\displaystyle\begin{array}[]{rl}\mbox{Variables: }&w_{1},\ldots,w_{\left|%
\mathcal{D}\right|}\\
\mbox{Minimize: }&\sum_{s}\rho(s)\sum_{i}w_{i}\phi_{i}{s}\\
\mbox{Subject to: }&\sum_{i}w_{i}\phi_{i}(s)\geq\sum_{s^{\prime}}P_{ss^{\prime%
}}^{a}(R_{ss^{\prime}}^{a}+\gamma\sum_{i}w_{i}\phi_{i}(s^{\prime}))\quad%
\forall s\in\mathcal{S},\forall a\in\mathcal{A}\end{array}
\rho
\left|\mathcal{S}\right|
\left|\mathcal{D}\right|
\mathcal{D}
\left|\mathcal{S}\right|\times\left|\mathcal{A}\right|
\{s_{t},a_{t},r_{t},s_{t+1}\}_{t=1}^{N_{T}}
a
s
s
T_{K}
\displaystyle\hat{V}(s)=T_{K}V(s)=\max_{a\in\mathcal{A}}\hat{Q}(s,a)
\displaystyle\hat{V}(s)
\displaystyle=T_{K}V(s)=\max_{a\in\mathcal{A}}\hat{Q}(s,a)
\displaystyle\hat{Q}(s,a)=\sum_{t\in\{t:a_{t}=a\}}K_{a}(s_{t},s)[r_{t}+\gamma V%
(s_{t+1})]
\displaystyle\hat{Q}(s,a)
\displaystyle=\sum_{t\in\{t:a_{t}=a\}}K_{a}(s_{t},s)[r_{t}+\gamma V(s_{t+1})]
t
a_{t}=a
K_{a}(s_{t},s)
s
a
\sum_{t\in\{t:a_{t}=a\}}K_{a}(s_{t},s)=1
T_{K}
T_{K}
\displaystyle K_{a}(s_{t},s)=\exp[-\frac{d^{2}(s_{t},s)}{2\sigma^{2}}]
\displaystyle K_{a}(s_{t},s)=\exp[-\frac{d^{2}(s_{t},s)}{2\sigma^{2}}]
N_{T}\to\infty
\sigma\to 0
d(s_{t},s)
N_{T}^{2})
k
O(n)
k\ll n
n
K_{a}(s_{t},s)
T+1
r_{T+1}=V(X_{T+1})=0
s_{t}
\displaystyle V(s_{t})=r_{t}+\gamma r_{t+1}+\ldots+\gamma^{T-t}r_{T}-\epsilon_%
{t}
\displaystyle V(s_{t})=r_{t}+\gamma r_{t+1}+\ldots+\gamma^{T-t}r_{T}-\epsilon_%
{t}
\epsilon_{t}\sim\mathbb{N}(0,\sigma_{t}^{2}))
\displaystyle Z_{T}r_{1:T}=V_{1:T}+\epsilon_{1:T}
\displaystyle Z_{T}r_{1:T}
\displaystyle=V_{1:T}+\epsilon_{1:T}
\displaystyle r_{1:T}=H_{T+1}V_{1:T}+\epsilon^{\prime}_{1:T}
\displaystyle r_{1:T}
\displaystyle=H_{T+1}V_{1:T}+\epsilon^{\prime}_{1:T}
\displaystyle Z_{T}=\left[\begin{array}[]{ccccc}1&\gamma&\gamma^{2}&\ldots&%
\gamma^{T}\\
0&1&\gamma&\ldots&\gamma^{T-1}\\
\ldots&&&\ldots\\
0&0&0&\ldots&1\end{array}\right]\quad H_{T}=Z^{-1}_{T-1}=\left[\begin{array}[]%
{ccccc}1&-\gamma&0&\ldots&0\\
0&1&-\gamma&\ldots&0\\
\ldots&&&\ldots\\
0&0&\ldots&1&-\gamma\end{array}\right]
\displaystyle Z_{T}=\left[\begin{array}[]{ccccc}1&\gamma&\gamma^{2}&\ldots&%
\gamma^{T}\\
0&1&\gamma&\ldots&\gamma^{T-1}\\
\ldots&&&\ldots\\
0&0&0&\ldots&1\end{array}\right]\quad H_{T}=Z^{-1}_{T-1}=\left[\begin{array}[]%
{ccccc}1&-\gamma&0&\ldots&0\\
0&1&-\gamma&\ldots&0\\
\ldots&&&\ldots\\
0&0&\ldots&1&-\gamma\end{array}\right]
\epsilon_{t}\sim\mathbb{N}(0,\sigma^{2})
\epsilon^{\prime}_{1:T}\sim\mathbb{N}(0,\sigma^{2}H_{T}H_{T}^{T})
r_{1:T}=\{r_{t}\}_{t=1:T}
V(s^{*})
\displaystyle\left(\begin{array}[]{c}Z_{T}\ r_{1:T}\\
V(s^{*})\end{array}\right)=\mathbb{N}\left[\left(\begin{array}[]{c}0\\
0\end{array}\right),\left[\begin{array}[]{cc}K_{T}&K_{T}(s^{*})\\
K_{T}(s^{*})^{T}&K(s^{*},s^{*})\end{array}\right]\right]
\displaystyle\left(\begin{array}[]{c}Z_{T}\ r_{1:T}\\
V(s^{*})\end{array}\right)=\mathbb{N}\left[\left(\begin{array}[]{c}0\\
0\end{array}\right),\left[\begin{array}[]{cc}K_{T}&K_{T}(s^{*})\\
K_{T}(s^{*})^{T}&K(s^{*},s^{*})\end{array}\right]\right]
K_{T}
T\times T
K_{T}(s^{*})
T\times 1
s_{t}
s^{*}
s^{*}
\displaystyle\hat{V}(s^{*})=K_{T}(s^{*})^{T}(K_{T}+\sigma I)^{-1}\ r_{1:T}
\displaystyle\hat{V}(s^{*})
\displaystyle=K_{T}(s^{*})^{T}(K_{T}+\sigma I)^{-1}\ r_{1:T}
\displaystyle\rm{VAR}(\hat{V}(s^{*}))=K(s^{*},s^{*})-K_{T}(s^{*})^{T}(K_{T}+%
\sigma I)^{-1}K_{T}(s^{*})
\displaystyle\rm{VAR}(\hat{V}(s^{*}))
\displaystyle=K(s^{*},s^{*})-K_{T}(s^{*})^{T}(K_{T}+\sigma I)^{-1}K_{T}(s^{*})
r_{t}
s_{t}
s_{t}
a_{t}
\mathcal{S}
d
s=\{s_{1},\ldots,s_{d}\}
Aw=b
k
b
k-1
A
\displaystyle Krylov_{k}(A,b)=\mathrm{span}\{b,Ab,A^{2}b,\ldots,A^{k-1}b\}
\displaystyle Krylov_{k}(A,b)=\mathrm{span}\{b,Ab,A^{2}b,\ldots,A^{k-1}b\}
b=R_{\pi}
\displaystyle(1-A)^{-1}b=(I+A+A^{2}+\ldots)b=\prod_{k=0}^{\infty}(I+A^{2^{k}})b
\displaystyle(1-A)^{-1}b=(I+A+A^{2}+\ldots)b=\prod_{k=0}^{\infty}(I+A^{2^{k}})b
\displaystyle V_{\pi}=(1-\gamma P_{\pi})^{-1}R_{\pi}=\prod_{k=0}^{\infty}(I+(%
\gamma P_{\pi})^{2^{k}})R_{\pi}
\displaystyle V_{\pi}=(1-\gamma P_{\pi})^{-1}R_{\pi}=\prod_{k=0}^{\infty}(I+(%
\gamma P_{\pi})^{2^{k}})R_{\pi}
\Phi_{k}
\phi_{k+1}=R+\gamma P\Phi_{k}w_{\Phi_{k}}-\Phi_{k}w_{\Phi_{k}}
\Phi
R_{\pi}^{\Phi}
P_{\pi}^{\Phi}
\displaystyle R_{\pi}^{\Phi}=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}D_{%
\rho}R_{\pi}
\displaystyle R_{\pi}^{\Phi}
\displaystyle=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}D_{\rho}R_{\pi}
\displaystyle P_{\pi}^{\Phi}=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}D_{%
\rho}P_{\pi}\Phi
\displaystyle P_{\pi}^{\Phi}
\displaystyle=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}D_{\rho}P_{\pi}\Phi
R_{\pi}^{\Phi}
R_{\pi}
\Phi
\left\lVert\cdot\right\rVert_{\rho}
P_{\pi}^{\Phi}
\Phi P_{\Pi}^{\Phi}\approx P_{\Pi}\Phi
\Phi
k
\pi_{0}
t=0
\Phi
R_{\pi_{t}}^{\Phi}
P_{\pi_{t}}^{\Phi}
(1-\gamma P_{\pi_{t}}^{\Phi})w_{\Phi}=R_{\pi_{t}}^{\Phi}
V_{\pi_{t}}^{\Phi}=\Phi w_{\Phi}
\pi_{t+1}
\displaystyle\pi_{t+1}(s)=\mathop{\mbox{{\rm argmax}}}\limits_{a\in\mathcal{A}%
}\sum_{s^{\prime}}P_{ss^{\prime}}^{a}(R_{ss^{\prime}}^{a}+\gamma V_{\pi_{t}}^{%
\Phi}(s^{\prime}))
\displaystyle\pi_{t+1}(s)=\mathop{\mbox{{\rm argmax}}}\limits_{a\in\mathcal{A}%
}\sum_{s^{\prime}}P_{ss^{\prime}}^{a}(R_{ss^{\prime}}^{a}+\gamma V_{\pi_{t}}^{%
\Phi}(s^{\prime}))
t=t+1
\pi_{t}=\pi_{t+1}
\pi_{t+1}
\mathcal{S}
m
\mathcal{S}_{1},\ldots,\mathcal{S}_{m}
\cup_{i=1}^{m}\mathcal{S}_{i}=\mathcal{S}
\mathcal{S}_{i}\cap\mathcal{S}_{j}=\emptyset
i\neq j
\Phi
V^{k+1}
V^{k+1}
\displaystyle V^{k+1}=V^{k}+\Phi\ w_{\Phi}
\displaystyle V^{k+1}=V^{k}+\Phi\ w_{\Phi}
w_{\Phi}
\displaystyle w_{\Phi}=(I-\gamma P_{\Pi}^{\Phi})^{-1}R_{\Pi}^{\Phi}
\displaystyle w_{\Phi}
\displaystyle=(I-\gamma P_{\Pi}^{\Phi})^{-1}R_{\Pi}^{\Phi}
\displaystyle P_{\Pi}^{\Phi}=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}P_{%
\pi}\Phi
\displaystyle P_{\Pi}^{\Phi}
\displaystyle=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}P_{\pi}\Phi
\displaystyle R_{\Pi}^{\Phi}=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}(T(V%
^{k})-V^{k})
\displaystyle R_{\Pi}^{\Phi}
\displaystyle=(\Phi^{\prime}D_{\rho}\Phi)^{-1}\Phi^{\prime}(T(V^{k})-V^{k})
\Phi
s
t
s,\pi_{t-1}(s)
s^{\prime}
r
R_{t}
P_{t}
\pi_{t}
\{s_{t},a_{t},r_{t},s_{t+1}\}
\{s_{t}\}
\{r_{t}\}
\{s_{t}\}
\{s_{t+1}\}
\chi^{2}
\epsilon
\Phi
K_{a}(s,s^{\prime})
s
