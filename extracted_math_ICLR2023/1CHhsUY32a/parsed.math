\mathbf{x}_{i}
k
\mathcal{A}_{i}
p(\mathbf{x})
p(\mathbf{x})\approx\frac{1}{M}\sum_{i}p(\mathbf{x}|\mathbf{h}_{i})
M
\mathbf{h}_{i}=f_{\theta}(\mathbf{x}_{i})
\mathbf{x}_{i}
f
\theta
p(\mathbf{x}|\mathbf{h}_{i})
G
\mathbf{z}\sim\mathcal{N}(0,I)
\mathbf{h}_{i}
G(\mathbf{z},\mathbf{h}_{i})
\mathbf{h}_{i}
\mathbf{x}_{j}
\mathbf{x}_{i}
\mathcal{A}_{i}
\min_{G}\max_{D}\;\mathbb{E}_{\mathbf{x}_{i}\sim p(\mathbf{x}),\mathbf{x}_{j}%
\sim\mathcal{A}_{i}}\left[\ln D(\mathbf{x}_{j},\mathbf{h}_{i})\right]\;+\\
\hskip 5.0pt\mathbb{E}_{\mathbf{x}_{i}\sim p(\mathbf{x}),\mathbf{z}\sim%
\mathcal{N}(0,I)}\left[\ln(1-D(G(\mathbf{z},\mathbf{h}_{i}),\mathbf{h}_{i}))%
\right],
\mathbf{x}_{j}\sim\mathcal{A}_{i}
\mathbf{x}_{j}
\mathcal{A}_{i}
C=[\mathbf{s},\mathcal{O}]
\mathbf{s}
\mathcal{O}
\mathcal{O}=\{(\mathbf{o}_{c},\mathbf{b}_{c})\}_{c=1}^{O}
\mathbf{o}_{c}
\mathbf{b}_{c}
\mathbf{o}_{c}
\mathcal{D}=\{(C_{i},\mathbf{x}_{i})\}_{i=1}^{M}
C_{i}
\mathbf{x}_{i}
p(\mathbf{x}|C_{i})
p(\mathbf{x}|C_{i})
p(\mathbf{x}|\mathbf{H}_{i})
\mathbf{H}_{i}
C_{i}
f
\phi
\mathbf{h}^{s}_{i}=f_{\phi}(\mathbf{s}_{i})
\mathbf{h}^{o}_{i,c}=f_{\phi}(\mathbf{o}_{i,c})
\mathbf{h}^{s}_{i}
\mathbf{h}^{o}_{i,c}
\mathbf{H}_{i}
\mathbf{b}_{i,c}
G(\mathbf{Z}_{i},\mathbf{H}_{i})
\mathbf{Z}_{i}
\mathbf{H}_{i}
\mathbf{\hat{x}}
\mathbf{z}^{s}\sim\mathcal{N}(0,\mathbf{I})
O
\mathbf{z}^{o}_{c}\sim\mathcal{N}(0,\mathbf{I})
\mathbf{Z}_{i}
\mathbf{b}_{i,c}
\mathbf{x}_{i}
\mathbf{o}_{i,c}
\mathcal{D}
k
\mathcal{A}^{x}_{i}
\mathcal{A}^{o}_{i,c}
\mathbf{x}_{i}
\mathbf{o}_{i,c}
\mathbf{h}^{x}_{i}
\mathbf{h}^{o}_{i,c}
\mathbf{h}^{x}_{i}=f_{\phi}(\mathbf{x}_{i})
D^{g}(\mathbf{x},\mathbf{h}^{x}_{i})
\mathcal{A}^{x}_{i}
\mathbf{H}_{i}
D^{o}(\mathbf{o},\mathbf{h}^{o}_{i,c})
\mathcal{A}^{o}_{i,c}
\mathbf{b}_{i,c}
\mathbf{H}_{i}
\mathbf{H}_{i}
C_{i}
\mathbf{s}_{i}
\mathbf{o}_{i,0}
\mathbf{o}_{i,1}
\mathbf{h}^{s}_{i}
\mathbf{h}^{o}_{i,0}
\mathbf{h}^{o}_{i,1}
\mathbf{b}_{i,0}
\mathbf{b}_{i,1}
\mathbf{H}_{i}
G
\mathbf{H}_{i}
\mathbf{Z}_{i}
\mathbf{\hat{x}}
D^{g}
D^{o}
C_{i}
\mathbf{s}_{i}
\mathbf{o}_{i,0}
\mathbf{o}_{i,1}
\mathbf{h}^{s}_{i}
\mathbf{h}^{o}_{i,0}
\mathbf{h}^{o}_{i,1}
\mathbf{b}_{i,0}
\mathbf{b}_{i,1}
\mathbf{H}_{i}
G
\mathbf{H}_{i}
\mathbf{Z}_{i}
\mathbf{\hat{x}}
D^{g}
D^{o}
\min_{G}\max_{\{D^{g},D^{o}\}}\;(1-\lambda)\mathcal{L}^{g}(G,D^{g})+\lambda%
\mathcal{L}^{o}(G,D^{o}),
\mathcal{L}^{g}
\mathcal{L}^{o}
\lambda
\mathcal{L}^{g}=\mathbb{E}_{(C_{i},\mathbf{x}_{i})\sim\mathcal{D},\mathbf{x}_{%
n}\sim\mathcal{A}^{x}_{i}}\left[\log D^{g}(\mathbf{x}_{n},\mathbf{h}^{x}_{i})%
\right]\;+\mathbb{E}_{(C_{i},\mathbf{x}_{i})\sim\mathcal{D},\mathbf{Z}_{i}\sim%
\mathcal{N}(0,\mathbf{I})}\left[\log(1-D^{g}(\hat{\mathbf{x}},\mathbf{h}^{x}_{%
i})\right].
\displaystyle\mathcal{L}^{o}=\mathbb{E}_{(C_{i},\mathbf{x}_{i})\sim\mathcal{D}%
,(\mathbf{o}_{i,c},\mathbf{b}_{i,c})\sim\mathcal{C}_{i},\mathbf{o}_{n}\sim%
\mathcal{A}^{o}_{i,c}}\left[\log D^{o}(\mathbf{o}_{n},\mathbf{h}^{o}_{i,c})%
\right]+\;\mathbb{E}_{(C_{i},\mathbf{x}_{i})\sim\mathcal{D},(\mathbf{o}_{i,c},%
\mathbf{b}_{i,c})\sim\mathcal{C}_{i},\mathbf{Z}_{i}\sim\mathcal{N}(0,\mathbf{I%
})}\left[\log(1-D^{o}(\hat{\mathbf{o}}_{i,c},\mathbf{h}^{o}_{i,c}))\right],
\displaystyle\mathcal{L}^{o}
\displaystyle=
\displaystyle\mathbb{E}_{(C_{i},\mathbf{x}_{i})\sim\mathcal{D},(\mathbf{o}_{i,%
c},\mathbf{b}_{i,c})\sim\mathcal{C}_{i},\mathbf{o}_{n}\sim\mathcal{A}^{o}_{i,c%
}}\left[\log D^{o}(\mathbf{o}_{n},\mathbf{h}^{o}_{i,c})\right]
\displaystyle+\;\mathbb{E}_{(C_{i},\mathbf{x}_{i})\sim\mathcal{D},(\mathbf{o}_%
{i,c},\mathbf{b}_{i,c})\sim\mathcal{C}_{i},\mathbf{Z}_{i}\sim\mathcal{N}(0,%
\mathbf{I})}\left[\log(1-D^{o}(\hat{\mathbf{o}}_{i,c},\mathbf{h}^{o}_{i,c}))%
\right],
\hat{\mathbf{o}}_{i,c}
\hat{\mathbf{x}}
\mathbf{b}_{i,c}
\mathbf{Z}_{i}\sim\mathcal{N}(0,\mathbf{I})
\mathbf{x}_{i}
\mathbf{s}_{i}
\mathbf{x}_{i}
\mathbf{H}_{i}
\times
\mathbf{h}^{x}_{i}
\mathbf{h}^{o}_{i,c}
\lambda
\times
\times
\downarrow
\pm
\pm
\downarrow
\pm
\pm
\uparrow
\pm
\pm
\uparrow
\pm
\pm
\times
\times
\downarrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
O
\times
\times
256\!\times\!256
256\!\times\!256
\sim
\times
\times
\sim
\mathbf{H}_{i}
(B,D,H,W)
B
D
D=2048
H
W
\mathbf{H}_{i}
\mathbf{Z}_{i}
1\!\times\!1
256\!\times\!256
256\!\times\!256
1\!\times\!2048
1\!\times\!2048
7\!\times 7\!\times\!2048
\mathcal{A}^{x}_{i}
\mathcal{A}^{o}_{i,c}
\sim
\lambda=0.5
\times
\times
256\!\times\!256
\mathbf{h}_{i}^{s}
\mathbf{h}_{i}^{o}
\mathcal{A}_{i}^{x}
\mathcal{A}^{o}_{i,c}
\downarrow
\downarrow
\times
\pm
\pm
\pm
\pm
\times
\pm
\pm
\pm
\pm
\times
\times
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
256\!\times\!256
256\!\times\!256
256\!\times\!256
\downarrow
\downarrow
\uparrow
\uparrow
\times
\times
\times
\times
\mathcal{A}^{o}_{i,c}
\lambda
128\!\times\!128
\mathbf{H}_{i}
128\!\times\!128
128\!\times\!128
\lambda
k^{o}
k^{o}=5
\lambda
\lambda
\lambda
\lambda=0.5
\pm
\pm
\pm
\pm
\lambda
k^{o}
\mathcal{A}^{o}_{i,c}
\lambda=0.0
\lambda
k^{o}
\mathcal{A}^{o}_{i,c}
\lambda=0.0
\lambda
k^{o}
\downarrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
128\!\times\!128
128\!\times\!128
\downarrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
128\!\times\!128
128\!\times\!128
\downarrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
128\!\times\!128
K
128\!\times\!128
128\!\times\!128
\downarrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
128\!\times\!128
128\!\times\!128
128\!\times\!128
128\!\times\!128
