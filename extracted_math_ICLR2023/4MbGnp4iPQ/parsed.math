C
BB=\{B_{1},BB_{2},\ldots,BB_{N}\}\subset C
R=\{R_{1},R_{2},\ldots,R_{M}\}
R
R:BB_{1}\times BB_{2}\rightarrow C
(BB_{1},BB_{2})\mapsto Y,
BB_{1}
BB_{2}
R
Y
P2=R_{2}(P1,B_{3})
P1=R_{1}(B1,B_{2})
R_{1}
B_{1}
B_{2}
R_{2}
B_{3}
R_{1}(B_{1},B_{2})
G=(\mathcal{V},\mathcal{E})
v\in\mathcal{V}
e\in\mathcal{E}
\mathcal{C}_{G}
C\in\mathcal{C}_{G}
L
\tau
\{\mathbf{x}_{v}^{k}\in\mathbb{R}^{3}\mid v\in\mathcal{V},k\in\{1,2,\ldots,n_{%
v}\}\}
\mathbf{x}_{v}^{k}=(x_{v}^{k},y_{v}^{k},z_{v}^{k})
k
v
n_{v}
v
\mathbf{p}=[p_{1},p_{2},p_{3},p_{4},p_{5},p_{6}]
n
\mathbf{f}=[f_{1},f_{2},\ldots,f_{n}]
f_{i}\in\{0,1\}
\sum_{i=1}^{n}f_{i}=1
\mathbf{h}=\{\mathbf{h}_{0},\ldots,\mathbf{h}_{M-1}\}
\mathbf{x}^{\prime}=\{\mathbf{x}_{0}^{\prime},\ldots,\mathbf{x}_{M-1}^{\prime}\}
\mathcal{E}=(e_{ij})
\mathbf{h}^{l+1}
\mathbf{x}^{\prime l+1}
\mathbf{h}^{l+1},\mathbf{x}^{\prime l+1}=\text{EGCL}(\mathbf{h},\mathbf{x}^{%
\prime},\mathcal{E})
\displaystyle m_{ij}=\phi_{e}\left(\mathbf{h}_{i}^{l},\mathbf{h}_{j}^{l},\left%
\|\mathbf{x}_{i}^{\prime}-\mathbf{x}_{j}^{\prime}\right\|_{2}^{2},a_{ij}\right)
\displaystyle m_{ij}
\displaystyle=\phi_{e}\left(\mathbf{h}_{i}^{l},\mathbf{h}_{j}^{l},\left\|%
\mathbf{x}_{i}^{\prime}-\mathbf{x}_{j}^{\prime}\right\|_{2}^{2},a_{ij}\right)
\displaystyle\mathbf{x}_{i}^{\prime l+1}=\mathbf{x}_{i}^{\prime}+\sum_{j\neq i%
}(\mathbf{x}_{i}^{\prime}-\mathbf{x}_{j}^{\prime})\phi_{x}(m_{ij})
\displaystyle\mathbf{x}_{i}^{\prime l+1}
\displaystyle=\mathbf{x}_{i}^{\prime}+\sum_{j\neq i}(\mathbf{x}_{i}^{\prime}-%
\mathbf{x}_{j}^{\prime})\phi_{x}(m_{ij})
\displaystyle m_{i}=\sum_{j\in\mathcal{N}(i)}m_{ij}
\displaystyle m_{i}
\displaystyle=\sum_{j\in\mathcal{N}(i)}m_{ij}
\displaystyle\mathbf{h}_{i}^{l+1}=\phi_{h}\left(\mathbf{h}_{i}^{l},m_{i}\right)
\displaystyle\mathbf{h}_{i}^{l+1}
\displaystyle=\phi_{h}\left(\mathbf{h}_{i}^{l},m_{i}\right)
\left\|\mathbf{x}_{i}^{\prime}-\mathbf{x}_{j}^{\prime}\right\|_{2}^{2}
\phi_{e}
\mathbf{h}^{l+1}
[\texttt{fp},start]
f_{p}\in\{0,1\}^{1024}
\mathbf{h}_{i}^{(0)}=\text{PE}(i)+\begin{cases}\bm{\epsilon}_{\text{start}},%
\text{type}(T_{i})=\text{START}\\
\text{MLP}_{\text{fp}}(p_{i}),\text{type}(T_{i})=\text{BB}\\
\end{cases}
\text{MultiHead}(Q,K,V)=\text{Concat}(\text{head}_{1},...,\text{head}_{h})W^{O}
\text{where head}_{i}=\text{Attention}(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V}),
W_{i}^{Q}\in\mathbb{R}^{d_{\text{model}}\times d_{k}},W_{i}^{K}\in\mathbb{R}^{%
d_{\text{model}}\times d_{k}},W_{i}^{V}\in\mathbb{R}^{d_{\text{model}}\times d%
_{v}},
W^{O}\in\mathbb{R}^{hd_{v}\times d_{\text{model}}}
N=7
h=8
Z
BB_{i+1}
Z
BB_{i+1}\sim\text{Softmax}(\text{Linear}(Z_{i}))
Z_{i}
BB_{i+1}
R_{i+1}
R_{i+1}\sim\text{Softmax}(\text{Linear}(\text{Concat}(Z_{i},\text{Embedding}(%
BB_{i+1}))))
BB_{i+1}
R_{i+1}
\ell
L_{\text{bb}}=\frac{1}{n}\sum_{j=0}^{l-1}\text{CE}(\hat{BB}_{i+1},BB_{i+1}),
L_{\text{rxn}}=\frac{1}{m}\sum_{i=0}^{\ell-1}\text{CE}(\hat{r}_{i+1},r_{i+1}).
L=L_{\text{bb}}+L_{\text{rxn}}
