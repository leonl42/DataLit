s_{i}\in\{1,\cdots 20\}
{\bm{x}}_{i}\in{\mathbb{R}}^{3}
{\bm{O}}_{i}\in\mathrm{SO(3)}
i\in\{1,\cdots N\}
N
{\bm{x}}_{i}
{\bm{O}}_{i}
{\bm{s}}_{i}=\operatorname{onehot}(s_{i})
{\bm{m}}_{i}\in{\mathbb{R}}^{c_{m}}
{\bm{z}}_{ij}\in{\mathbb{R}}^{c_{z}}
N
{\mathcal{P}}=\{({\bm{s}}_{i},{\bm{x}}_{i},{\bm{O}}_{i})\}_{i=1}^{N}
\{{\bm{m}}_{i}\}\in{\mathbb{R}}^{N\times{c_{m}}}
\{{\bm{z}}_{ij}\}\in{\mathbb{R}}^{N\times N\times{c_{z}}}
\{{\bm{m}}_{i}\}\in{\mathbb{R}}^{N\times{c_{m}}}
\{{\bm{z}}_{ij}\}\in{\mathbb{R}}^{N\times N\times{c_{z}}}
N
{\mathcal{P}}=\{({\bm{s}}_{i},{\bm{x}}_{i},{\bm{O}}_{i})\}_{i=1}^{N}
\{{\bm{m}}_{i}\}
\{{\bm{z}}_{ij}\}
c
L
l^{\mathrm{th}}
\{{\bm{m}}_{i}^{l}\}
\{{\bm{z}}_{ij}^{l}\}
\operatorname{MHA}
{\bm{z}}_{ij}^{l}
{\bm{m}}_{i}^{l+1}
{\bm{m}}_{j}^{l+1}
\displaystyle{\bm{m}}_{i}^{l+1}=\operatorname{MHA}(\{{\bm{m}}_{i}^{l}\},\{{\bm%
{z}}_{ij}^{l}\}),
\displaystyle{\bm{m}}_{i}^{l+1}
\displaystyle=\operatorname{MHA}(\{{\bm{m}}_{i}^{l}\},\{{\bm{z}}_{ij}^{l}\}),
\displaystyle{\bm{z}}_{ij}^{l+0.5}={\bm{z}}_{ij}^{l}+\operatorname{Linear}({%
\bm{m}}_{i}^{l+1}\otimes{\bm{m}}_{j}^{l+1}),
\displaystyle{\bm{z}}_{ij}^{l+0.5}
\displaystyle={\bm{z}}_{ij}^{l}+\operatorname{Linear}({\bm{m}}_{i}^{l+1}%
\otimes{\bm{m}}_{j}^{l+1}),
\otimes
\displaystyle\hat{{\bm{a}}}_{ij},\hat{{\bm{b}}}_{ij}=\sigma({\bm{z}}_{ij}^{l+0%
.5})\odot\operatorname{Linear}({\bm{z}}_{ij}^{l+0.5}),\quad{\bm{q}}_{ij},{\bm{%
k}}_{ij},{\bm{v}}_{ij},{\bm{b}}_{ij}=\operatorname{Linear}({\bm{z}}_{ij}^{l+0.%
75}),
\displaystyle\hat{{\bm{a}}}_{ij},\hat{{\bm{b}}}_{ij}
\displaystyle=\sigma({\bm{z}}_{ij}^{l+0.5})\odot\operatorname{Linear}({\bm{z}}%
_{ij}^{l+0.5}),\quad{\bm{q}}_{ij},{\bm{k}}_{ij},{\bm{v}}_{ij},{\bm{b}}_{ij}=%
\operatorname{Linear}({\bm{z}}_{ij}^{l+0.75}),
\displaystyle{\bm{z}}_{ij}^{l+0.75}={\bm{z}}_{ij}^{l+0.5}+\sigma({\bm{z}}_{ij}%
^{l+0.5})\odot\operatorname{Linear}\big{(}\sum\limits_{k}\hat{{\bm{a}}}_{ik}%
\odot\hat{{\bm{b}}}_{jk}+\hat{{\bm{a}}}_{ki}\odot\hat{{\bm{b}}}_{kj}\big{)},
\displaystyle{\bm{z}}_{ij}^{l+0.75}
\displaystyle={\bm{z}}_{ij}^{l+0.5}+\sigma({\bm{z}}_{ij}^{l+0.5})\odot%
\operatorname{Linear}\big{(}\sum\limits_{k}\hat{{\bm{a}}}_{ik}\odot\hat{{\bm{b%
}}}_{jk}+\hat{{\bm{a}}}_{ki}\odot\hat{{\bm{b}}}_{kj}\big{)},
\displaystyle{\bm{z}}_{ij}^{l+1}={\bm{z}}_{ij}^{l+0.75}+\sigma({\bm{z}}_{ij}^{%
l+0.75})\odot\sum\limits_{k}(\alpha_{ijk}{\bm{v}}_{ik}+\alpha_{ijk}{\bm{v}}_{%
kj}),
\displaystyle{\bm{z}}_{ij}^{l+1}
\displaystyle={\bm{z}}_{ij}^{l+0.75}+\sigma({\bm{z}}_{ij}^{l+0.75})\odot\sum%
\limits_{k}(\alpha_{ijk}{\bm{v}}_{ik}+\alpha_{ijk}{\bm{v}}_{kj}),
\sigma(\cdot)=\operatorname{sigmoid}(\operatorname{Linear}(\cdot))
\alpha_{ijk}=\operatorname{softmax}_{k}\big{(}\frac{1}{\sqrt{c}}{\bm{q}}_{ij}^%
{\top}({\bm{k}}_{ik}+{\bm{k}}_{kj})+{\bm{b}}_{jk}+{\bm{b}}_{ki}\big{)}
{\bm{z}}_{ij}
{\bm{z}}_{ik}
{\bm{z}}_{kj}
k
\Delta_{ijk}
\alpha_{ijk}
\Delta_{ijk}
L
\{{\bm{m}}_{i}^{L}\}
\{{\bm{z}}_{ij}^{L}\}
\operatorname{SeqIPA}
\operatorname{SeqIPA}
T
t^{\mathrm{th}}
{\mathcal{P}}^{t}=\{({\bm{s}}_{i}^{t},{\bm{x}}_{i}^{t},{\bm{O}}_{i}^{t})\}_{i=%
1}^{N}
t^{\mathrm{th}}
\{{\bm{m}}_{i}^{t}\}
\{{\bm{z}}_{ij}^{t}\}
\{{\bm{m}}_{i}^{0}\}
\{{\bm{z}}_{ij}^{0}\}
{\bm{s}}_{i}^{0}=\frac{1}{20}\cdot\bm{1}
{\bm{x}}_{i}^{0}=(0,0,0)
{\bm{O}}_{i}^{0}={\bm{I}}_{\bm{3}}
c
\operatorname{MLP_{e}}:{\mathbb{R}}^{20}\rightarrow{\mathbb{R}}^{c},{\bm{s}}_{%
i}^{t+0.5}=\operatorname{MLP_{e}}({\bm{s}}_{i}^{t})
\operatorname{SeqIPA}
\operatorname{SeqIPA}
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}=\operatorname{SeqIPA}(\{{%
\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\},\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i%
}^{t}\},\{{\bm{O}}_{i}^{t}\}).
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}=\operatorname{SeqIPA}(\{{%
\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\},\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i%
}^{t}\},\{{\bm{O}}_{i}^{t}\}).
\operatorname{SeqIPA}
\operatorname{SeqIPA}
\{{\bm{x}}_{i}^{t}\}
\{{\bm{O}}_{i}^{t}\}
\{{\bm{x}}_{i}^{t}\}
\{\hat{{\bm{x}}}_{i}^{t}\}
\{{\bm{O}}_{i}^{t}\}
\{{\bm{O}}_{i}^{t}\}
\{\hat{{\bm{x}}}_{i}^{t}\}
{\bm{O}}_{i}^{t}
\hat{{\bm{O}}}_{i}^{t}
{\bm{O}}_{i}^{t}
\hat{{\bm{O}}}_{i}^{t}
\displaystyle\hat{{\bm{x}}}_{i}^{t}=\operatorname{MLP_{x}}({\bm{m}}_{i}^{t+1},%
{\bm{m}}_{i}^{0}),\quad{\bm{x}}_{i}^{t+1}={\bm{x}}_{i}^{t}+{\bm{O}}_{i}^{t}%
\hat{{\bm{x}}}_{i}^{t},
\displaystyle\hat{{\bm{x}}}_{i}^{t}
\displaystyle=\operatorname{MLP_{x}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0}),%
\quad{\bm{x}}_{i}^{t+1}={\bm{x}}_{i}^{t}+{\bm{O}}_{i}^{t}\hat{{\bm{x}}}_{i}^{t},
\displaystyle\hat{{\bm{O}}}_{i}^{t}=\operatorname{convert}\big{(}\operatorname%
{MLP_{o}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0})\big{)},\quad{\bm{O}}_{i}^{t+1}=%
{\bm{O}}_{i}^{t}\hat{{\bm{O}}}_{i}^{t},
\displaystyle\hat{{\bm{O}}}_{i}^{t}
\displaystyle=\operatorname{convert}\big{(}\operatorname{MLP_{o}}({\bm{m}}_{i}%
^{t+1},{\bm{m}}_{i}^{0})\big{)},\quad{\bm{O}}_{i}^{t+1}={\bm{O}}_{i}^{t}\hat{{%
\bm{O}}}_{i}^{t},
\operatorname{convert}
\operatorname{MLP_{s}}
\displaystyle{\bm{s}}_{i}^{t+1}=\operatorname{softmax}\big{(}\lambda\cdot%
\operatorname{MLP_{s}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0},{\bm{s}}_{i}^{t+0.5%
})\big{)},
\displaystyle{\bm{s}}_{i}^{t+1}
\displaystyle=\operatorname{softmax}\big{(}\lambda\cdot\operatorname{MLP_{s}}(%
{\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0},{\bm{s}}_{i}^{t+0.5})\big{)},
\lambda
(t+1)^{\mathrm{th}}
{\mathcal{P}}^{t}=\{({\bm{s}}_{i}^{t},{\bm{x}}_{i}^{t},{\bm{O}}_{i}^{t})\}_{i=%
1}^{N}
{\mathcal{P}}^{t+1}=\{({\bm{s}}_{i}^{t+1},{\bm{x}}_{i}^{t+1},{\bm{O}}_{i}^{t+1%
})\}_{i=1}^{N}
{\mathcal{P}}^{t}
C_{\alpha}
\chi_{1},\chi_{2},\chi_{3},\chi_{4}
t^{\mathrm{th}}
\{{\bm{x}}_{ij}^{t}\}
j\in\{1,2,3\}
(N,C_{\alpha},C)
\mathrm{true}
\ell_{\mathrm{ce}}
\displaystyle{\mathcal{L}}_{\mathrm{type}}=\frac{1}{T\cdot N}\sum\limits_{t=1}%
^{T}\sum\limits_{i=1}^{N}\ell_{\mathrm{ce}}({\bm{s}}_{i}^{t},{\bm{s}}_{i}^{%
\mathrm{true}}),
\displaystyle{\mathcal{L}}_{\mathrm{type}}
\displaystyle=\frac{1}{T\cdot N}\sum\limits_{t=1}^{T}\sum\limits_{i=1}^{N}\ell%
_{\mathrm{ce}}({\bm{s}}_{i}^{t},{\bm{s}}_{i}^{\mathrm{true}}),
\displaystyle{\mathcal{L}}_{\mathrm{pos}}=\frac{1}{T\cdot N\cdot 3N}\sum%
\limits_{t=1}^{T}\sum\limits_{k=1}^{N}\sum\limits_{i,j}\|\rho_{k}^{t}({\bm{x}}%
_{ij}^{t})-\rho_{k}^{\mathrm{true}}({\bm{x}}_{ij}^{\mathrm{true}})\|_{2},
\displaystyle{\mathcal{L}}_{\mathrm{pos}}
\displaystyle=\frac{1}{T\cdot N\cdot 3N}\sum\limits_{t=1}^{T}\sum\limits_{k=1}%
^{N}\sum\limits_{i,j}\|\rho_{k}^{t}({\bm{x}}_{ij}^{t})-\rho_{k}^{\mathrm{true}%
}({\bm{x}}_{ij}^{\mathrm{true}})\|_{2},
\rho_{k}^{t}({\bm{x}}_{ij}^{t})=({\bm{O}}_{k}^{t})^{-1}({\bm{x}}_{ij}^{t}-{\bm%
{x}}_{k}^{t})
k^{\mathrm{th}}
t
{\bm{x}}_{k}^{t}
{\bm{O}}_{k}^{t}
\rho_{k}^{\mathrm{true}}
{\mathcal{L}}={\mathcal{L}}_{\mathrm{type}}+{\mathcal{L}}_{\mathrm{pos}}
{\mathcal{P}}^{0}
\uparrow
\downarrow
\uparrow
\downarrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\downarrow
\downarrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\downarrow
\downarrow
\uparrow
\beta-
\alpha-
\beta-
\alpha-
\operatorname{SeqIPA}
(t+1)^{\mathrm{th}}
{\mathcal{P}}^{t}=\{({\bm{s}}_{i}^{t},{\bm{x}}_{i}^{t},{\bm{O}}_{i}^{t})\}_{i=%
1}^{N}
\{{\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\}
\operatorname{SeqIPA}
\displaystyle{\bm{s}}_{i}^{t+0.5}=\operatorname{MLP_{e}}({\bm{s}}_{i}^{t}),
\displaystyle{\bm{s}}_{i}^{t+0.5}
\displaystyle=\operatorname{MLP_{e}}({\bm{s}}_{i}^{t}),
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}=\operatorname{SeqIPA}(\{{%
\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\},\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i%
}^{t}\},\{{\bm{O}}_{i}^{t}\}),
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}
\displaystyle=\operatorname{SeqIPA}(\{{\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\}%
,\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\}),
\displaystyle\hat{{\bm{x}}}_{i}^{t}=\operatorname{MLP_{x}}({\bm{m}}_{i}^{t+1},%
{\bm{m}}_{i}^{0}),\quad{\bm{x}}_{i}^{t+1}={\bm{x}}_{i}^{t}+\Delta{{\bm{x}}_{i}%
^{t}}={\bm{x}}_{i}^{t}+{\bm{O}}_{i}^{t}\hat{{\bm{x}}}_{i}^{t},
\displaystyle\hat{{\bm{x}}}_{i}^{t}
\displaystyle=\operatorname{MLP_{x}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0}),%
\quad{\bm{x}}_{i}^{t+1}={\bm{x}}_{i}^{t}+\Delta{{\bm{x}}_{i}^{t}}={\bm{x}}_{i}%
^{t}+{\bm{O}}_{i}^{t}\hat{{\bm{x}}}_{i}^{t},
\displaystyle\hat{{\bm{O}}}_{i}^{t}=\operatorname{convert}\big{(}\operatorname%
{MLP_{o}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0})\big{)},\quad{\bm{O}}_{i}^{t+1}=%
{\bm{O}}_{i}^{t}\hat{{\bm{O}}}_{i}^{t},
\displaystyle\hat{{\bm{O}}}_{i}^{t}
\displaystyle=\operatorname{convert}\big{(}\operatorname{MLP_{o}}({\bm{m}}_{i}%
^{t+1},{\bm{m}}_{i}^{0})\big{)},\quad{\bm{O}}_{i}^{t+1}={\bm{O}}_{i}^{t}\hat{{%
\bm{O}}}_{i}^{t},
\displaystyle{\bm{s}}_{i}^{t+1}=\operatorname{softmax}\big{(}\lambda\cdot%
\operatorname{MLP_{s}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0},{\bm{s}}_{i}^{t+0.5%
})\big{)}.
\displaystyle{\bm{s}}_{i}^{t+1}
\displaystyle=\operatorname{softmax}\big{(}\lambda\cdot\operatorname{MLP_{s}}(%
{\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0},{\bm{s}}_{i}^{t+0.5})\big{)}.
{\mathcal{X}},{\mathcal{O}},{\mathcal{S}}
\displaystyle\Delta{\bm{x}}_{i}^{t}={\mathcal{X}}({\mathcal{P}}^{t}),
\displaystyle\Delta{\bm{x}}_{i}^{t}
\displaystyle={\mathcal{X}}({\mathcal{P}}^{t}),
\displaystyle{\bm{O}}_{i}^{t+1}={\mathcal{O}}({\mathcal{P}}^{t}),
\displaystyle{\bm{O}}_{i}^{t+1}
\displaystyle={\mathcal{O}}({\mathcal{P}}^{t}),
\displaystyle{\bm{s}}_{i}^{t+1}={\mathcal{S}}({\mathcal{P}}^{t}).
\displaystyle{\bm{s}}_{i}^{t+1}
\displaystyle={\mathcal{S}}({\mathcal{P}}^{t}).
{\mathcal{X}},{\mathcal{O}},{\mathcal{S}}
\{{\bm{m}}_{i}^{t}\}
\{{\bm{z}}_{ij}^{t}\}
{\mathcal{X}},{\mathcal{O}},{\mathcal{S}}
\operatorname{SeqIPA}
{\mathcal{T}}_{{\bm{R}},{\bm{r}}}
{\mathcal{P}}^{t}=\{({\bm{s}}_{i}^{t},{\bm{x}}_{i}^{t},{\bm{O}}_{i}^{t})\}_{i=%
1}^{N}
{\bm{R}}\in\mathrm{SO(3)}
{\bm{r}}\in{\mathbb{R}}^{3}
{\mathcal{X}},{\mathcal{O}},{\mathcal{S}}
\displaystyle{\mathcal{X}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})={\bm{R}}{\mathcal{X}}({\mathcal{P}}^{t}),
\displaystyle{\mathcal{X}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})
\displaystyle={\bm{R}}{\mathcal{X}}({\mathcal{P}}^{t}),
\displaystyle{\mathcal{O}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})={\bm{R}}{\mathcal{O}}({\mathcal{P}}^{t}),
\displaystyle{\mathcal{O}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})
\displaystyle={\bm{R}}{\mathcal{O}}({\mathcal{P}}^{t}),
\displaystyle{\mathcal{S}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})={\mathcal{S}}({\mathcal{P}}^{t}),
\displaystyle{\mathcal{S}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})
\displaystyle={\mathcal{S}}({\mathcal{P}}^{t}),
{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}^{t})=\{({\bm{s}}_{i}^{t},{\bm{%
x}}_{i}^{t}+{\bm{r}},{\bm{R}}{\bm{O}}_{i}^{t})\}_{i=1}^{N}
\operatorname{SeqIPA}
\hat{{\bm{x}}}_{i}^{t}
\displaystyle{\mathcal{X}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})={\bm{R}}{\bm{O}}_{i}^{t}\hat{{\bm{x}}}_{i}^{t}={\bm{R}}{\mathcal{X}}({%
\mathcal{P}}^{t}).
\displaystyle{\mathcal{X}}\circ{\mathcal{T}}_{{\bm{R}},{\bm{r}}}({\mathcal{P}}%
^{t})
\displaystyle={\bm{R}}{\bm{O}}_{i}^{t}\hat{{\bm{x}}}_{i}^{t}={\bm{R}}{\mathcal%
{X}}({\mathcal{P}}^{t}).
\{{\bm{m}}_{i}\}\in{\mathbb{R}}^{N\times{c_{m}}}
\{{\bm{z}}_{ij}\}\in{\mathbb{R}}^{N\times N\times{c_{z}}}
L
\{{\bm{m}}_{i}^{l}\}
\{{\bm{z}}_{ij}^{l}\}
L
\operatorname{SeqIPA}
\{{\bm{m}}_{i}\}\in{\mathbb{R}}^{N\times{c_{m}}}
\{{\bm{z}}_{ij}\}\in{\mathbb{R}}^{N\times N\times{c_{z}}}
{\bm{m}}_{i}^{0},{\bm{z}}_{ij}^{0}\leftarrow\operatorname{Linear}({\bm{m}}_{i}%
),\operatorname{Linear}({\bm{z}}_{ij})
{\bm{m}}_{i}^{0}\in{\mathbb{R}}^{c},{\bm{z}}_{ij}^{0}\in{\mathbb{R}}^{c}
l\leftarrow 0
L-1
{\bm{m}}_{i}^{l+1}\leftarrow\operatorname{MHA}(\{{\bm{m}}_{i}^{l}\},\{{\bm{z}}%
_{ij}^{l}\})
{\bm{z}}_{ij}^{l+0.5}\leftarrow{\bm{z}}_{ij}^{l}+\operatorname{Linear}({\bm{m}%
}_{i}^{l+1}\otimes{\bm{m}}_{j}^{l+1})
{\bm{z}}_{ij}^{l+0.75}\leftarrow{\bm{z}}_{ij}^{l+0.5}+\operatorname{%
TriangleUpdate_{1}}(\{{\bm{z}}_{ij}^{l+0.5})\}
{\bm{z}}_{ij}^{l+1}\leftarrow{\bm{z}}_{ij}^{l+0.75}+\operatorname{%
TriangleUpdate_{2}}(\{{\bm{z}}_{ij}^{l+0.75})\}
{\bm{m}}_{i}^{0},{\bm{z}}_{ij}^{0}\leftarrow{\bm{m}}_{i}^{L},{\bm{z}}_{ij}^{L}
{\mathcal{P}}^{0}\leftarrow\{({\bm{s}}_{i}^{0},{\bm{x}}_{i}^{0},{\bm{O}}_{i}^{%
0})\}_{i=1}^{N}\leftarrow\{(\frac{1}{20}\cdot\bm{1},(0,0,0),{\bm{I}}_{\bm{3}})%
\}_{i=1}^{N}
{\mathcal{P}}^{0}
t\leftarrow 0
T-1
{\bm{s}}_{i}^{t+0.5}\leftarrow\operatorname{MLP_{e}}({\bm{s}}_{i}^{t})
{\bm{s}}_{i}^{t+0.5}\in{\mathbb{R}}^{c}
{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}\leftarrow\operatorname{SeqIPA}(\{{\bm{m%
}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\},\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i}^{t}%
\},\{{\bm{O}}_{i}^{t}\})
\hat{{\bm{x}}}_{i}^{t}\leftarrow\operatorname{MLP_{x}}({\bm{m}}_{i}^{t+1},{\bm%
{m}}_{i}^{0})
{\bm{x}}_{i}^{t+1}\leftarrow{\bm{x}}_{i}^{t}+{\bm{O}}_{i}^{t}\hat{{\bm{x}}}_{i%
}^{t}
\hat{{\bm{O}}}_{i}^{t}\leftarrow\operatorname{convert}\big{(}\operatorname{MLP%
_{o}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0})\big{)}
{\bm{O}}_{i}^{t+1}\leftarrow{\bm{O}}_{i}^{t}\hat{{\bm{O}}}_{i}^{t}
{\bm{s}}_{i}^{t+1}\leftarrow\operatorname{softmax}\big{(}\lambda\cdot%
\operatorname{MLP_{s}}({\bm{m}}_{i}^{t+1},{\bm{m}}_{i}^{0},{\bm{s}}_{i}^{t+0.5%
})\big{)}
{\mathcal{P}}^{t+1}\leftarrow\{({\bm{s}}_{i}^{t+1},{\bm{x}}_{i}^{t+1},{\bm{O}}%
_{i}^{t+1})\}_{i=1}^{N}
\{{\mathcal{P}}^{t}\}_{t=1}^{T}
\operatorname{SeqIPA}
\operatorname{SeqIPA}
\{{\bm{s}}_{i}^{t+0.5}\}
\{{\bm{m}}_{i}^{t}\}
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}=\operatorname{SeqIPA}(\{{%
\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\},\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i%
}^{t}\},\{{\bm{O}}_{i}^{t}\})
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}
\displaystyle=\operatorname{SeqIPA}(\{{\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\}%
,\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\})
\displaystyle=\operatorname{IPA}(\{{\bm{m}}_{i}^{t}+{\bm{s}}_{i}^{t+0.5}\},\{{%
\bm{z}}_{ij}^{t}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\}).
\displaystyle=\operatorname{IPA}(\{{\bm{m}}_{i}^{t}+{\bm{s}}_{i}^{t+0.5}\},\{{%
\bm{z}}_{ij}^{t}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\}).
\{{\bm{s}}_{i}^{t+0.5}\}
\{{\bm{m}}_{i}^{t}\}
{\bm{m}}_{i}^{t}
{\bm{z}}_{ij}^{t}
\displaystyle\bar{{\bm{m}}}_{i},\bar{{\bm{z}}}_{ij}=\operatorname{Linear}({\bm%
{s}}_{i}^{t+0.5}),\operatorname{Linear}({\bm{s}}_{i}^{t+0.5}+{\bm{s}}_{j}^{t+0%
.5})
\displaystyle\bar{{\bm{m}}}_{i},\bar{{\bm{z}}}_{ij}
\displaystyle=\operatorname{Linear}({\bm{s}}_{i}^{t+0.5}),\operatorname{Linear%
}({\bm{s}}_{i}^{t+0.5}+{\bm{s}}_{j}^{t+0.5})
\displaystyle\bar{{\bm{m}}}_{i},\bar{{\bm{z}}}_{ij}=\operatorname{Encoder}(\{%
\bar{{\bm{m}}}_{i}\},\{\bar{{\bm{z}}}_{ij}\}),
\displaystyle\bar{{\bm{m}}}_{i},\bar{{\bm{z}}}_{ij}
\displaystyle=\operatorname{Encoder}(\{\bar{{\bm{m}}}_{i}\},\{\bar{{\bm{z}}}_{%
ij}\}),
\displaystyle{\bm{m}}_{i}^{t+0.5},{\bm{z}}_{ij}^{t+0.5}={\bm{m}}_{i}^{t}+\bar{%
{\bm{m}}}_{i},{\bm{z}}_{ij}^{t}+\bar{{\bm{z}}}_{ij},
\displaystyle{\bm{m}}_{i}^{t+0.5},{\bm{z}}_{ij}^{t+0.5}
\displaystyle={\bm{m}}_{i}^{t}+\bar{{\bm{m}}}_{i},{\bm{z}}_{ij}^{t}+\bar{{\bm{%
z}}}_{ij},
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}=\operatorname{SeqIPA}(\{{%
\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\},\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i%
}^{t}\},\{{\bm{O}}_{i}^{t}\})
\displaystyle{\bm{m}}_{i}^{t+1},{\bm{z}}_{ij}^{t+1}
\displaystyle=\operatorname{SeqIPA}(\{{\bm{m}}_{i}^{t}\},\{{\bm{z}}_{ij}^{t}\}%
,\{{\bm{s}}_{i}^{t+0.5}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\})
\displaystyle=\operatorname{IPA}(\{{\bm{m}}_{i}^{t+0.5}\},\{{\bm{z}}_{ij}^{t+0%
.5}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\}).
\displaystyle=\operatorname{IPA}(\{{\bm{m}}_{i}^{t+0.5}\},\{{\bm{z}}_{ij}^{t+0%
.5}\},\{{\bm{x}}_{i}^{t}\},\{{\bm{O}}_{i}^{t}\}).
{\bm{m}}_{i}^{t}
{\bm{z}}_{ij}^{t}
\operatorname{SeqIPA}
L=8
T=8
\lambda
\lambda
\chi_{1},\chi_{2},\chi_{3},\chi_{4}
\beta-
\beta-
\beta-
n
n
i
i-2,i-1,i,i+1,i+2
\beta-
\operatorname{SeqIPA}
\operatorname{IPA}
\{{\bm{m}}_{i}^{T}\}
\operatorname{SeqIPA}
T-
T=8
\operatorname{SeqIPA}
\uparrow
\downarrow
\uparrow
\downarrow
\downarrow
\downarrow
\uparrow
\{{\bm{m}}_{i}\}
\{{\bm{z}}_{ij}\}
\{{\bm{m}}_{i}\}
\{{\bm{z}}_{ij}\}
