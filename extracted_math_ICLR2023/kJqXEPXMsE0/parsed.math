n
n-1
{\mathcal{P}}=\{({\bm{x}}_{P}^{(i)},{\bm{v}}_{P}^{(i)})\}_{i=1}^{N_{P}}
N_{P}
{\bm{x}}_{P}\in{\mathbb{R}}^{3}
{\bm{v}}_{P}\in{\mathbb{R}}^{N_{f}}
{\mathcal{M}}=\{({\bm{x}}_{L}^{(i)},{\bm{v}}_{L}^{(i)})\}_{i=1}^{N_{M}}
{{M}}=[{\mathbf{x}},{\mathbf{v}}]
[\cdot,\cdot]
{\mathbf{x}}\in{\mathbb{R}}^{M\times 3}
{\mathbf{v}}\in{\mathbb{R}}^{M\times K}
p_{\theta}({{M}}_{0}|{\mathcal{P}})=\int p_{\theta}({{M}}_{0:T}|{\mathcal{P}})%
d{{M}}_{1:T}
{{M}}_{1},{{M}}_{2},\cdots,{{M}}_{T}
{{M}}_{0}\sim p({{M}}_{0}|{\mathcal{P}})
\theta
\displaystyle q({{M}}_{1:T}|{{M}}_{0},{\mathcal{P}})=\Pi_{t=1}^{T}q({{M}}_{t}|%
{{M}}_{t-1},{\mathcal{P}})p_{\theta}({{M}}_{0:T-1}|{{M}}_{T},{\mathcal{P}})=%
\Pi_{t=1}^{T}p_{\theta}({{M}}_{t-1}|{{M}}_{t},{\mathcal{P}})
\displaystyle q({{M}}_{1:T}|{{M}}_{0},{\mathcal{P}})=\Pi_{t=1}^{T}q({{M}}_{t}|%
{{M}}_{t-1},{\mathcal{P}})
\displaystyle p_{\theta}({{M}}_{0:T-1}|{{M}}_{T},{\mathcal{P}})=\Pi_{t=1}^{T}p%
_{\theta}({{M}}_{t-1}|{{M}}_{t},{\mathcal{P}})
\theta
\theta
{\mathcal{N}}
{\mathbf{x}}
{\mathcal{C}}
{\mathbf{v}}
t
\beta_{1},\dots,\beta_{T}
q({{M}}_{t}|{{M}}_{t-1},{\mathcal{P}})={\mathcal{N}}({\mathbf{x}}_{t};\sqrt{1-%
\beta_{t}}{\mathbf{x}}_{t-1},\beta_{t}{\mathbf{I}})\cdot{\mathcal{C}}({\mathbf%
{v}}_{t}|(1-\beta_{t}){\mathbf{v}}_{t-1}+\beta_{t}/K).
\alpha_{t}=1-\beta_{t}
\bar{\alpha}_{t}=\Pi_{s=1}^{t}\alpha_{s}
q({{M}}_{t}|{{M}}_{0})
\displaystyle q({\mathbf{x}}_{t}|{\mathbf{x}}_{0})={\mathcal{N}}({\mathbf{x}}_%
{t};\sqrt{\bar{\alpha}_{t}}{\mathbf{x}}_{0},(1-\bar{\alpha}_{t}){\mathbf{I}})q%
({\mathbf{v}}_{t}|{\mathbf{v}}_{0})={\mathcal{C}}({\mathbf{v}}_{t}|\bar{\alpha%
}_{t}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t})/K).
\displaystyle q({\mathbf{x}}_{t}|{\mathbf{x}}_{0})={\mathcal{N}}({\mathbf{x}}_%
{t};\sqrt{\bar{\alpha}_{t}}{\mathbf{x}}_{0},(1-\bar{\alpha}_{t}){\mathbf{I}})
\displaystyle q({\mathbf{v}}_{t}|{\mathbf{v}}_{0})={\mathcal{C}}({\mathbf{v}}_%
{t}|\bar{\alpha}_{t}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t})/K).
\displaystyle q({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{0})={%
\mathcal{N}}({\mathbf{x}}_{t-1};\tilde{\bm{\mu}}_{t}({\mathbf{x}}_{t},{\mathbf%
{x}}_{0}),\tilde{\beta}_{t}{\mathbf{I}})q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{t},%
{\mathbf{v}}_{0})={\mathcal{C}}({\mathbf{v}}_{t-1}|\tilde{\bm{c}}_{t}({\mathbf%
{v}}_{t},{\mathbf{v}}_{0})).
\displaystyle q({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{0})={%
\mathcal{N}}({\mathbf{x}}_{t-1};\tilde{\bm{\mu}}_{t}({\mathbf{x}}_{t},{\mathbf%
{x}}_{0}),\tilde{\beta}_{t}{\mathbf{I}})
\displaystyle q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{t},{\mathbf{v}}_{0})={%
\mathcal{C}}({\mathbf{v}}_{t-1}|\tilde{\bm{c}}_{t}({\mathbf{v}}_{t},{\mathbf{v%
}}_{0})).
\tilde{\bm{\mu}}_{t}({\mathbf{x}}_{t},{\mathbf{x}}_{0})=\frac{\sqrt{\bar{%
\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}{\mathbf{x}}_{0}+\frac{\sqrt{%
\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{\alpha}_{t}}{\mathbf{x}}_{t}
\tilde{\beta}_{t}=\frac{1-\bar{\alpha}_{t-1}}{1-\bar{\alpha}_{t}}\beta_{t}
\tilde{\bm{c}}_{t}({\mathbf{v}}_{t},{\mathbf{v}}_{0})=\bm{c}^{\star}/\sum_{k=1%
}^{K}c_{k}^{\star}
\bm{c}^{\star}({\mathbf{v}}_{t},{\mathbf{v}}_{0})=[\alpha_{t}{\mathbf{v}}_{t}+%
(1-\alpha_{t})/K]\odot[\bar{\alpha}_{t-1}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t-1%
})/K]
{{M}}_{0}
{{M}}_{T}
\theta
p_{\theta}({{M}}_{t-1}|{{M}}_{t},{\mathcal{P}})={\mathcal{N}}({\mathbf{x}}_{t-%
1};\bm{\mu}_{\theta}([{\mathbf{x}}_{t},{\mathbf{v}}_{t}],t,{\mathcal{P}}),%
\sigma_{t}^{2}I)\cdot{\mathcal{C}}({\mathbf{v}}_{t-1}|\bm{c}_{\theta}([{%
\mathbf{x}}_{t},{\mathbf{v}}_{t}],t,{\mathcal{P}})).
p_{\theta}({{M}}_{0}|{\mathcal{P}})
T_{g}
T_{g}
p_{\theta}(T_{g}({{M}}_{0}|{\mathcal{P}}))=p_{\theta}({{M}}_{0}|{\mathcal{P}})
p({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})
{\mathbf{x}}_{t}(t=1,\dots,T)
{\mathbf{x}}_{P}
\bm{\mu}_{\theta}([{\mathbf{x}}_{t},{\mathbf{v}}_{t}],t,{\mathcal{P}})
\bm{c}_{\theta}([{\mathbf{x}}_{t},{\mathbf{v}}_{t}],t,{\mathcal{P}})
[{\mathbf{x}}_{0},{\mathbf{v}}_{0}]
\bm{\mu}_{\theta}
\bm{c}_{\theta}
[\hat{{\mathbf{x}}}_{0},\hat{{\mathbf{v}}}_{0}]=\phi_{\theta}({{M}}_{t},t,{%
\mathcal{P}})=\phi_{\theta}([{\mathbf{x}}_{t},{\mathbf{v}}_{t}],t,{\mathcal{P}%
}).
l
{\mathbf{h}}
{\mathbf{x}}
\displaystyle{\mathbf{h}}^{l+1}_{i}={\mathbf{h}}^{l}_{i}+\sum_{j\in{\mathcal{V%
}},i\neq j}f_{h}(d^{l}_{ij},{\mathbf{h}}^{l}_{i},{\mathbf{h}}^{l}_{j},{\mathbf%
{e}}_{ij};\theta_{h})
\displaystyle{\mathbf{h}}^{l+1}_{i}
\displaystyle={\mathbf{h}}^{l}_{i}+\sum_{j\in{\mathcal{V}},i\neq j}f_{h}(d^{l}%
_{ij},{\mathbf{h}}^{l}_{i},{\mathbf{h}}^{l}_{j},{\mathbf{e}}_{ij};\theta_{h})
\displaystyle{\mathbf{x}}^{l+1}_{i}={\mathbf{x}}^{l}_{i}+\sum_{j\in{\mathcal{V%
}},i\neq j}({\mathbf{x}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{%
\mathbf{h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})%
\cdot\mathds{1}_{\text{mol}}
\displaystyle{\mathbf{x}}^{l+1}_{i}
\displaystyle={\mathbf{x}}^{l}_{i}+\sum_{j\in{\mathcal{V}},i\neq j}({\mathbf{x%
}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{\mathbf{h}}^{l+1}_{i},{%
\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})\cdot\mathds{1}_{\text{mol}}
d_{ij}=\|{\mathbf{x}}_{i}-{\mathbf{x}}_{j}\|
i
j
{\mathbf{e}}_{ij}
\mathds{1}_{\text{mol}}
{\mathbf{h}}^{0}
{\mathbf{h}}^{L}
\hat{\mathbf{v}}_{0}
\hat{{\mathbf{x}}}_{0}
{\mathbf{x}}_{t}
{\mathbf{x}}_{t-1}
{\mathbf{x}}_{0}
q
p
q({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{0})
p_{\theta}({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t})
L_{t-1}^{(x)}=\frac{1}{2\sigma_{t}^{2}}\|\tilde{\bm{\mu}}_{t}({\mathbf{x}}_{t}%
,{\mathbf{x}}_{0})-\bm{\mu}_{\theta}([{\mathbf{x}}_{t},{\mathbf{v}}_{t}],t,{%
\mathcal{P}})\|^{2}+C=\gamma_{t}\|{\mathbf{x}}_{0}-\hat{\mathbf{x}}_{0}\|^{2}+C
\gamma_{t}=\frac{\bar{\alpha}_{t-1}\beta_{t}^{2}}{2\sigma_{t}^{2}(1-\bar{%
\alpha}_{t})^{2}}
C
\gamma_{t}=1
L_{t-1}^{(v)}=\sum_{k}\bm{c}({\mathbf{v}}_{t},{\mathbf{v}}_{0})_{k}\log\frac{%
\bm{c}({\mathbf{v}}_{t},{\mathbf{v}}_{0})_{k}}{\bm{c}({\mathbf{v}}_{t},\hat{%
\mathbf{v}}_{0})_{k}}.
L=L_{t-1}^{(x)}+\lambda L_{t-1}^{(v)}
[\hat{{\mathbf{x}}}_{0},\hat{{\mathbf{v}}}_{0}]
\phi_{\theta}
[{\mathbf{x}}_{0},{\mathbf{v}}_{0}]
{\mathbf{x}}
{\mathbf{h}}
{\mathbf{h}}^{L}
\hat{{\mathbf{v}}}_{0}
\displaystyle{\mathbf{h}}^{l+1}_{i}={\mathbf{h}}^{l}_{i}+\sum_{j\in{\mathcal{V%
}},i\neq j}f_{h}(d^{l}_{ij},{\mathbf{h}}^{l}_{i},{\mathbf{h}}^{l}_{j},{\mathbf%
{e}}_{ij};\theta_{h})_{\,l=1\dots L-1}\hat{{\mathbf{v}}}_{0}=\texttt{softmax}(%
\text{MLP}({\mathbf{h}}^{L})).
\displaystyle{\mathbf{h}}^{l+1}_{i}={\mathbf{h}}^{l}_{i}+\sum_{j\in{\mathcal{V%
}},i\neq j}f_{h}(d^{l}_{ij},{\mathbf{h}}^{l}_{i},{\mathbf{h}}^{l}_{j},{\mathbf%
{e}}_{ij};\theta_{h})_{\,l=1\dots L-1}
\displaystyle\hat{{\mathbf{v}}}_{0}=\texttt{softmax}(\text{MLP}({\mathbf{h}}^{%
L})).
\hat{{\mathbf{v}}}_{0}
{\mathbf{h}}^{L}
<1
f_{h}
f_{x}
-
=
-
=
-
=
:
:
\downarrow
\downarrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\hat{{\mathbf{v}}}_{0}
{\mathbf{h}}^{L}
{\mathbf{h}}^{L}
({\mathcal{M}},{\mathcal{P}})
p_{\theta}({\mathcal{M}}|{\mathcal{P}})
p({{M}}_{T}|{\mathcal{P}})
p_{\theta}({{M}}_{t-1}|{{M}}_{t},{\mathcal{P}})
\displaystyle p({\mathbf{x}}_{T},{\mathbf{x}}_{P})=p(T_{g}({\mathbf{x}}_{T},{%
\mathbf{x}}_{P}))
\displaystyle p({\mathbf{x}}_{T},{\mathbf{x}}_{P})
\displaystyle=p(T_{g}({\mathbf{x}}_{T},{\mathbf{x}}_{P}))
\displaystyle p({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})=p(T_{g}(%
{\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_{P}))
\displaystyle p({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})
\displaystyle=p(T_{g}({\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_%
{P}))
T_{g}
{\mathbf{x}}_{t}
{\mathbf{x}}_{P}
T_{g}({\mathbf{x}})
T_{g}({\mathbf{x}})={\bm{R}}{\mathbf{x}}+{\bm{b}}
{\bm{R}}\in{\mathbb{R}}^{3\times 3}
{\bm{b}}\in{\mathbb{R}}^{3}
{\mathbf{h}}
{\mathbf{x}}
\displaystyle{\mathbf{h}}^{l+1}_{i}={\mathbf{h}}^{l}_{i}+\sum_{j\in{\mathcal{V%
}},i\neq j}f_{h}(d^{l}_{ij},{\mathbf{h}}^{l}_{i},{\mathbf{h}}^{l}_{j},{\mathbf%
{e}}_{ij};\theta_{h})
\displaystyle{\mathbf{h}}^{l+1}_{i}
\displaystyle={\mathbf{h}}^{l}_{i}+\sum_{j\in{\mathcal{V}},i\neq j}f_{h}(d^{l}%
_{ij},{\mathbf{h}}^{l}_{i},{\mathbf{h}}^{l}_{j},{\mathbf{e}}_{ij};\theta_{h})
\displaystyle{\mathbf{x}}^{l+1}_{i}={\mathbf{x}}^{l}_{i}+\sum_{j\in{\mathcal{V%
}},i\neq j}({\mathbf{x}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{%
\mathbf{h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})%
\cdot\mathds{1}_{\text{mol}}
\displaystyle{\mathbf{x}}^{l+1}_{i}
\displaystyle={\mathbf{x}}^{l}_{i}+\sum_{j\in{\mathcal{V}},i\neq j}({\mathbf{x%
}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{\mathbf{h}}^{l+1}_{i},{%
\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})\cdot\mathds{1}_{\text{mol}}
d_{ij}
T_{g}
\displaystyle\hat{d}_{ij}^{2}=\|T_{g}({{\mathbf{x}}}_{i})-T_{g}({{\mathbf{x}}}%
_{j})\|^{2}=\|({\bm{R}}{\mathbf{x}}_{i}+{\bm{b}})-({\bm{R}}{\mathbf{x}}_{j}+{%
\bm{b}})\|^{2}=\|{\bm{R}}{\mathbf{x}}_{i}-{\bm{R}}{\mathbf{x}}_{j}\|^{2}
\displaystyle\hat{d}_{ij}^{2}
\displaystyle=\|T_{g}({{\mathbf{x}}}_{i})-T_{g}({{\mathbf{x}}}_{j})\|^{2}=\|({%
\bm{R}}{\mathbf{x}}_{i}+{\bm{b}})-({\bm{R}}{\mathbf{x}}_{j}+{\bm{b}})\|^{2}=\|%
{\bm{R}}{\mathbf{x}}_{i}-{\bm{R}}{\mathbf{x}}_{j}\|^{2}
\displaystyle=({\mathbf{x}}_{i}-{\mathbf{x}}_{j})^{\top}{\bm{R}}^{\top}{\bm{R}%
}({\mathbf{x}}_{i}-{\mathbf{x}}_{j})=({\mathbf{x}}_{i}-{\mathbf{x}}_{j})^{\top%
}\mathbf{I}({\mathbf{x}}_{i}-{\mathbf{x}}_{j})=\|{\mathbf{x}}_{i}-{\mathbf{x}}%
_{j}\|^{2}=d_{ij}^{2}
\displaystyle=({\mathbf{x}}_{i}-{\mathbf{x}}_{j})^{\top}{\bm{R}}^{\top}{\bm{R}%
}({\mathbf{x}}_{i}-{\mathbf{x}}_{j})=({\mathbf{x}}_{i}-{\mathbf{x}}_{j})^{\top%
}\mathbf{I}({\mathbf{x}}_{i}-{\mathbf{x}}_{j})=\|{\mathbf{x}}_{i}-{\mathbf{x}}%
_{j}\|^{2}=d_{ij}^{2}
{\mathbf{h}}_{i},{\mathbf{h}}_{j},{\mathbf{e}}_{ij}
{\mathbf{h}}^{l}_{i}
l=1,\dots,L
{\mathbf{x}}
\displaystyle\phi_{\theta}(T({\mathbf{x}}^{l}))=T({\mathbf{x}}^{l}_{i})+\sum_{%
j\in{\mathcal{V}},i\neq j}(T({\mathbf{x}}^{l}_{i})-T({\mathbf{x}}^{l}_{j}))f_{%
x}(d^{l}_{ij},{\mathbf{h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};%
\theta_{x})\cdot\mathds{1}_{\text{mol}}
\displaystyle\phi_{\theta}(T({\mathbf{x}}^{l}))
\displaystyle=T({\mathbf{x}}^{l}_{i})+\sum_{j\in{\mathcal{V}},i\neq j}(T({%
\mathbf{x}}^{l}_{i})-T({\mathbf{x}}^{l}_{j}))f_{x}(d^{l}_{ij},{\mathbf{h}}^{l+%
1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})\cdot\mathds{1}_{%
\text{mol}}
\displaystyle={\bm{R}}{\mathbf{x}}^{l}_{i}+{\bm{b}}+\sum_{j\in{\mathcal{V}},i%
\neq j}{\bm{R}}({\mathbf{x}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{%
\mathbf{h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})%
\cdot\mathds{1}_{\text{mol}}
\displaystyle={\bm{R}}{\mathbf{x}}^{l}_{i}+{\bm{b}}+\sum_{j\in{\mathcal{V}},i%
\neq j}{\bm{R}}({\mathbf{x}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{%
\mathbf{h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})%
\cdot\mathds{1}_{\text{mol}}
\displaystyle={\bm{R}}\left({\mathbf{x}}^{l}_{i}+\sum_{j\in{\mathcal{V}},i\neq
j%
}{\bm{R}}({\mathbf{x}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{\mathbf{%
h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})\cdot\mathds%
{1}_{\text{mol}}\right)+{\bm{b}}
\displaystyle={\bm{R}}\left({\mathbf{x}}^{l}_{i}+\sum_{j\in{\mathcal{V}},i\neq
j%
}{\bm{R}}({\mathbf{x}}^{l}_{i}-{\mathbf{x}}^{l}_{j})f_{x}(d^{l}_{ij},{\mathbf{%
h}}^{l+1}_{i},{\mathbf{h}}^{l+1}_{j},{\mathbf{e}}_{ij};\theta_{x})\cdot\mathds%
{1}_{\text{mol}}\right)+{\bm{b}}
\displaystyle={\bm{R}}{\mathbf{x}}_{i}^{l+1}+{\bm{b}}
\displaystyle={\bm{R}}{\mathbf{x}}_{i}^{l+1}+{\bm{b}}
\displaystyle=T(\phi_{\theta}({\mathbf{x}}^{l}))
\displaystyle=T(\phi_{\theta}({\mathbf{x}}^{l}))
[\hat{\mathbf{x}}_{0},\hat{\mathbf{v}}_{0}]
L
\hat{\mathbf{x}}_{0}
{\mathbf{x}}_{t}
\hat{\mathbf{x}}_{t-1}
\hat{\mathbf{x}}_{t-1}=\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha%
}_{t}}\hat{\mathbf{x}}_{0}+\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-%
\bar{\alpha}_{t}}{\mathbf{x}}_{t}
\hat{\mathbf{x}}_{t-1}
{\mathbf{x}}_{t}
\displaystyle\bm{\mu}_{\theta}(T({\mathbf{x}}_{t}),t)=\frac{\sqrt{\bar{\alpha}%
_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}T(\hat{\mathbf{x}}_{0})+\frac{\sqrt{%
\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{\alpha}_{t}}T({\mathbf{x}}_{t})
\displaystyle\bm{\mu}_{\theta}(T({\mathbf{x}}_{t}),t)
\displaystyle=\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}T(%
\hat{\mathbf{x}}_{0})+\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{%
\alpha}_{t}}T({\mathbf{x}}_{t})
\displaystyle=\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}{%
\bm{R}}(\hat{\mathbf{x}}_{0})+\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1%
-\bar{\alpha}_{t}}{\bm{R}}({\mathbf{x}}_{t})+\tilde{{\bm{b}}}
\displaystyle=\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}{%
\bm{R}}(\hat{\mathbf{x}}_{0})+\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1%
-\bar{\alpha}_{t}}{\bm{R}}({\mathbf{x}}_{t})+\tilde{{\bm{b}}}
\tilde{{\bm{b}}}=\left(\frac{\sqrt{\bar{\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha%
}_{t}}+\frac{\sqrt{\alpha_{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{\alpha}_{t}}%
\right){\bm{b}}
{\bm{b}}
\bm{\mu}_{\theta}({\bm{R}}({\mathbf{x}}_{t}),t)={\bm{R}}(\bm{\mu}_{\theta}({%
\mathbf{x}}_{t},t))
T
q({\mathbf{x}}_{T}|{\mathbf{x}}_{P})
q({\mathbf{x}}_{T}|{\mathbf{x}}_{P})\sim{\mathcal{N}}(C_{P}\otimes\bm{1}_{N_{P%
}},I_{3\cdot N_{P}})
C_{P}=\frac{1}{N_{P}}\sum{\mathbf{x}}_{P}
\otimes
I_{k}
k\times k
\bm{1}_{k}
k
C_{P}=0
\hat{{\mathbf{x}}}_{P}=Q{\mathbf{x}}_{P}
Q=I_{3}\otimes(I_{N}-\frac{1}{N}\bm{1}_{N}\bm{1}_{N}^{T})
q(\hat{{\mathbf{x}}}_{T}|\hat{{\mathbf{x}}}_{P})
T
\hat{{\mathbf{x}}}_{T}
p(\hat{{\mathbf{x}}}_{T}|\hat{{\mathbf{x}}}_{P})
({\mathbf{x}}_{T},{\mathbf{x}}_{P})
(\hat{{\mathbf{x}}}_{T},\hat{{\mathbf{x}}}_{P})=Q({\mathbf{x}}_{T},{\mathbf{x}%
}_{P}),\quad\text{where}\quad Q=I_{3}\otimes\begin{pmatrix}I_{M}&-\frac{1}{N}%
\bm{1}_{M}\bm{1}_{N}^{T}\\
\bm{0}&I_{N}-\frac{1}{N}\bm{1}_{N}\bm{1}_{N}^{T}\end{pmatrix}
p(\hat{{\mathbf{x}}}_{T}|\hat{{\mathbf{x}}}_{P})
\hat{p}
\hat{p}({\mathbf{x}}_{T}|{\mathbf{x}}_{P})=p(Q({\mathbf{x}}_{T},{\mathbf{x}}_{%
P}))
T_{g}({\mathbf{x}})={\bm{R}}{\mathbf{x}}+{\bm{b}}
Q\cdot T_{g}({\mathbf{x}}_{T},{\mathbf{x}}_{P})=Q\cdot{\bm{R}}({\mathbf{x}}_{T%
},{\mathbf{x}}_{P})
Q
{\bm{R}}
\|Q\cdot R{\mathbf{x}}\|^{2}=\|{\mathbf{x}}\|^{2}
p
\hat{p}(T_{g}({\mathbf{x}}_{T},{\mathbf{x}}_{P}))=\hat{p}({\mathbf{x}}_{T},{%
\mathbf{x}}_{P})
p_{\theta}({{M}}_{0}|{\mathcal{P}})
\displaystyle p({\mathbf{x}}_{T},{\mathbf{x}}_{P})=p(T_{g}({\mathbf{x}}_{T},{%
\mathbf{x}}_{P}))
\displaystyle p({\mathbf{x}}_{T},{\mathbf{x}}_{P})
\displaystyle=p(T_{g}({\mathbf{x}}_{T},{\mathbf{x}}_{P}))
\displaystyle p({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})=p(T_{g}(%
{\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_{P}))
\displaystyle p({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})
\displaystyle=p(T_{g}({\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_%
{P}))
\displaystyle p_{\theta}(T_{g}({\mathbf{x}}_{0},{\mathbf{x}}_{P}))=\int p(T_{g%
}({\mathbf{x}}_{T},{\mathbf{x}}_{P}))\sum_{t=1}^{T}p_{\theta}(T_{g}({\mathbf{x%
}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_{P})))
\displaystyle p_{\theta}(T_{g}({\mathbf{x}}_{0},{\mathbf{x}}_{P}))
\displaystyle=\int p(T_{g}({\mathbf{x}}_{T},{\mathbf{x}}_{P}))\sum_{t=1}^{T}p_%
{\theta}(T_{g}({\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_{P})))
\displaystyle=\int p({\mathbf{x}}_{T},{\mathbf{x}}_{P})\sum_{t=1}^{T}p_{\theta%
}(T_{g}({\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_{P})))
\displaystyle=\int p({\mathbf{x}}_{T},{\mathbf{x}}_{P})\sum_{t=1}^{T}p_{\theta%
}(T_{g}({\mathbf{x}}_{t-1})|T_{g}({\mathbf{x}}_{t},{\mathbf{x}}_{P})))
\displaystyle\leftarrow\text{Apply \tikz[baseline=(char.base)]{
\node[shape=circle,draw,inner sep=0.5pt] (char) {1};}}
\displaystyle\leftarrow\text{Apply \tikz[baseline=(char.base)]{
\node[shape=circle,draw,inner sep=0.5pt] (char) {1};}}
\displaystyle=\int p({\mathbf{x}}_{T},{\mathbf{x}}_{P})\sum_{t=1}^{T}p_{\theta%
}({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})
\displaystyle=\int p({\mathbf{x}}_{T},{\mathbf{x}}_{P})\sum_{t=1}^{T}p_{\theta%
}({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},{\mathbf{x}}_{P})
\displaystyle\leftarrow\text{Apply \tikz[baseline=(char.base)]{
\node[shape=circle,draw,inner sep=0.5pt] (char) {2};}}
\displaystyle\leftarrow\text{Apply \tikz[baseline=(char.base)]{
\node[shape=circle,draw,inner sep=0.5pt] (char) {2};}}
\displaystyle=p_{\theta}({\mathbf{x}}_{0},{\mathbf{x}}_{P})
\displaystyle=p_{\theta}({\mathbf{x}}_{0},{\mathbf{x}}_{P})
\displaystyle q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{t},{\mathbf{v}}_{0})=\frac{q(%
{\mathbf{v}}_{t}|{\mathbf{v}}_{t-1},{\mathbf{v}}_{0})q({\mathbf{v}}_{t-1}|{%
\mathbf{v}}_{0})}{\sum\limits_{{\mathbf{v}}_{t-1}}q({\mathbf{v}}_{t}|{\mathbf{%
v}}_{t-1},{\mathbf{v}}_{0})q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})}
\displaystyle q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{t},{\mathbf{v}}_{0})
\displaystyle=\frac{q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1},{\mathbf{v}}_{0})q({%
\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})}{\sum\limits_{{\mathbf{v}}_{t-1}}q({%
\mathbf{v}}_{t}|{\mathbf{v}}_{t-1},{\mathbf{v}}_{0})q({\mathbf{v}}_{t-1}|{%
\mathbf{v}}_{0})}
\displaystyle=\frac{q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1})q({\mathbf{v}}_{t-1}%
|{\mathbf{v}}_{0})}{\sum\limits_{{\mathbf{v}}_{t-1}}q({\mathbf{v}}_{t}|{%
\mathbf{v}}_{t-1})q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})}
\displaystyle=\frac{q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1})q({\mathbf{v}}_{t-1}%
|{\mathbf{v}}_{0})}{\sum\limits_{{\mathbf{v}}_{t-1}}q({\mathbf{v}}_{t}|{%
\mathbf{v}}_{t-1})q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})}
q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1})
q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})
\displaystyle q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1})={\mathcal{C}}({\mathbf{v}%
}_{t}|\alpha_{t}{\mathbf{v}}_{t-1}+(1-\alpha_{t})/K)
\displaystyle q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1})
\displaystyle={\mathcal{C}}({\mathbf{v}}_{t}|\alpha_{t}{\mathbf{v}}_{t-1}+(1-%
\alpha_{t})/K)
\displaystyle q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})={\mathcal{C}}({\mathbf{v}%
}_{t-1}|\bar{\alpha}_{t-1}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t-1})/K)
\displaystyle q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})
\displaystyle={\mathcal{C}}({\mathbf{v}}_{t-1}|\bar{\alpha}_{t-1}{\mathbf{v}}_%
{0}+(1-\bar{\alpha}_{t-1})/K)
{\mathcal{C}}({\mathbf{v}}_{t}|\alpha_{t}{\mathbf{v}}_{t-1}+(1-\alpha_{t})/K)
\alpha_{t}+(1-\alpha_{t})/K
{\mathbf{v}}_{t}={\mathbf{v}}_{t-1}
(1-\alpha_{t})/K
{\mathcal{C}}({\mathbf{v}}_{t}|\alpha_{t}{\mathbf{v}}_{t-1}+(1-\alpha_{t})/K)=%
{\mathcal{C}}({\mathbf{v}}_{t-1}|\alpha_{t}{\mathbf{v}}_{t}+(1-\alpha_{t})/K)
\bm{c}^{\star}({\mathbf{v}}_{t},{\mathbf{v}}_{0})
\displaystyle\bm{c}^{\star}({\mathbf{v}}_{t},{\mathbf{v}}_{0})=q({\mathbf{v}}_%
{t}|{\mathbf{v}}_{t-1})q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{0})
\displaystyle\bm{c}^{\star}({\mathbf{v}}_{t},{\mathbf{v}}_{0})
\displaystyle=q({\mathbf{v}}_{t}|{\mathbf{v}}_{t-1})q({\mathbf{v}}_{t-1}|{%
\mathbf{v}}_{0})
\displaystyle=[\alpha_{t}{\mathbf{v}}_{t}+(1-\alpha_{t})/K]\odot[\bar{\alpha}_%
{t-1}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t-1})/K]
\displaystyle=[\alpha_{t}{\mathbf{v}}_{t}+(1-\alpha_{t})/K]\odot[\bar{\alpha}_%
{t-1}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t-1})/K]
q({\mathbf{v}}_{t-1}|{\mathbf{v}}_{t},{\mathbf{v}}_{0})={\mathcal{C}}({\mathbf%
{v}}_{t-1}|\tilde{\bm{c}}_{t}({\mathbf{v}}_{t},{\mathbf{v}}_{0}))
\tilde{\bm{c}}_{t}({\mathbf{v}}_{t},{\mathbf{v}}_{0})=\bm{c}^{\star}/\sum_{k=1%
}^{K}c_{k}^{\star}
\{{\mathcal{P}},{\mathcal{M}}\}_{i=1}^{N}
\phi_{\theta}
\phi_{\theta}
t\in{\mathcal{U}}(0,\dots,T)
{\mathbf{x}}_{0}
{\mathbf{x}}_{t}
{\mathbf{x}}_{t}=\sqrt{\bar{\alpha}_{t}}{\mathbf{x}}_{0}+(1-\bar{\alpha}_{t})\epsilon
\epsilon\in{\mathcal{N}}(0,\bm{I})
{\mathbf{v}}_{0}
{\mathbf{v}}_{t}
\log\bm{c}=\log\left(\bar{\alpha}_{t}{\mathbf{v}}_{0}+(1-\bar{\alpha}_{t})/K\right)
{\mathbf{v}}_{t}=\texttt{one\_hot}(\operatorname*{arg\,max}_{i}[g_{i}+\log c_{%
i}])
g\sim\text{Gumbel}(0,1)
[\hat{\mathbf{x}}_{0},\hat{\mathbf{v}}_{0}]
[{\mathbf{x}}_{t},{\mathbf{v}}_{t}]
\phi_{\theta}
[\hat{\mathbf{x}}_{0},\hat{\mathbf{v}}_{0}]=\phi_{\theta}([{\mathbf{x}}_{t},{%
\mathbf{v}}_{t}],t,{\mathcal{P}})
\bm{c}({\mathbf{v}}_{t},{\mathbf{v}}_{0})
\bm{c}({\mathbf{v}}_{t},\hat{\mathbf{v}}_{0})
L=\|{\mathbf{x}}_{0}-\hat{\mathbf{x}}_{0}\|^{2}+\alpha\text{ KL}(\bm{c}({%
\mathbf{v}}_{t},{\mathbf{v}}_{0})\parallel\bm{c}({\mathbf{v}}_{t},\hat{\mathbf%
{v}}_{0}))
\theta
L
{\mathcal{P}}
\phi_{\theta}
{\mathcal{M}}
{\mathcal{M}}
{\mathbf{x}}_{T}
{\mathbf{v}}_{T}
{\mathbf{x}}_{T}\in{\mathcal{N}}(0,\bm{I})
{\mathbf{v}}_{T}=\texttt{one\_hot}(\operatorname*{arg\,max}_{i}g_{i})
g\sim\text{Gumbel}(0,1)
t
T,T-1,\dots,1
[\hat{\mathbf{x}}_{0},\hat{\mathbf{v}}_{0}]
[{\mathbf{x}}_{t},{\mathbf{v}}_{t}]
\phi_{\theta}
[\hat{\mathbf{x}}_{0},\hat{\mathbf{v}}_{0}]=\phi_{\theta}([{\mathbf{x}}_{t},{%
\mathbf{v}}_{t}],t,{\mathcal{P}})
{\mathbf{x}}_{t-1}
p_{\theta}({\mathbf{x}}_{t-1}|{\mathbf{x}}_{t},\hat{\mathbf{x}}_{0})
{\mathbf{v}}_{t-1}
p_{\theta}({\mathbf{v}}_{t-1}|{\mathbf{v}}_{t},\hat{\mathbf{v}}_{0})
l
k
l-1
k=32
\beta
\beta_{1}=\texttt{1e-7}
\beta_{T}=\texttt{2e-3}
\beta
s=0.01
\alpha=100
|
|
|
|
|
|
-0.56
p\leq 10^{-80}
\uparrow
\uparrow
\uparrow
\uparrow
