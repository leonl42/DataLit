\mathtt{MSA}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
y
x
\mathtt{MSA}
\mathtt{MLP}
y
x
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{MSA}
-\sum\tfrac{1}{N}\log\tfrac{1}{N}\approx 5.3
N=197
\mathtt{MSA}
\mathtt{softmax}
\mathbf{A}=\sigma(\lambda\mathbf{S})\in\mathbb{R}^{N\times N}
\mathbf{S}\in\mathbb{R}^{N\times N}
\lambda>0
{\mathbf{a}}=\sigma(\lambda{\mathbf{s}})\in\mathbb{R}^{N}
{\mathbf{a}}
{\mathbf{s}}
\mathbf{J}_{jk}:={\partial{\mathbf{a}}_{j}}/{\partial{\mathbf{s}}_{k}}=\lambda%
(1_{j=k}{\mathbf{a}}_{j}-{\mathbf{a}}_{j}{\mathbf{a}}_{k})
1\leq j,k\leq N
\mathbf{J}\in\mathbb{R}^{N\times N}
||\mathbf{J}||_{*}=\sum_{i=1}^{N}\nu_{i}
\{\nu_{i}\}
\mathbf{J}
\mathbf{J}
||\mathbf{J}||_{*}=\sum_{j}\lambda({\mathbf{a}}_{j}-{\mathbf{a}}_{j}^{2})
\sum_{j}{\mathbf{a}}_{j}=1
{\mathbf{a}}_{j}\geq 0
j
||\mathbf{J}||_{*}
{\mathbf{a}}_{j}=1/N
j
\mathtt{MSA}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
N
\mathbf{X}\in\mathbb{R}^{N\times d}
\mathtt{CB}
\mathtt{CB}({\mathbf{x}}_{i})=\frac{{\mathbf{x}}_{i}+\frac{1}{N}\sum_{j=1}^{N}%
{\mathbf{x}}_{j}}{2}\quad\text{for every token $i$},
i
{\mathbf{x}}_{i}\in\mathbb{R}^{d}
i^{\text{th}}
\mathbf{X}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}
\mathtt{PyTorch}
\mathtt{Tensorflow}
\mathtt{JAX}
\mathtt{CB}
\mbox{\boldmath$\Lambda$}\in\mathbb{R}^{d}
\mathtt{CB_{S}}({\mathbf{x}}_{i})={\mathbf{x}}_{i}+\mbox{\boldmath$\Lambda$}%
\odot\left(\frac{1}{N}\sum_{j=1}^{N}{\mathbf{x}}_{j}\right)
\odot
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{MSA}
\mathtt{CB}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{CB}
\mathtt{<Front>-FClayer-<Mid>-FClayer-<End>}
\mathtt{CB}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{Mid}
\mathtt{End}
\mathtt{Mid}
\mathtt{End}
\mathtt{MLP}
\mathtt{Front}
\mathtt{End}
\mathtt{CB}
\mathtt{End}
\mathtt{MLP}
\mathtt{CB}
10^{-3}\cdot\mathrm{(batch\ size)}/1024
0.05
\mathtt{PyTorch}
\mathtt{timm}
\mathtt{torchprofile}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{MLP}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{MLP}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
6\cdot 10^{-5}
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB_{S}}
112\times 112
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{CB}^{\dagger}
\mathtt{CB}
\mathtt{CB}^{\dagger}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}^{\dagger}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}^{\dagger}
\mathtt{CB}^{\dagger}
\mathtt{CB}^{\dagger}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{dist}=E_{i\neq j,\{i,j\}\in[1,N]}(a_{ij}||{\mathbf{p}}_{i}-{\mathbf{p}%
}_{j}||_{1})
N
a_{ij}
i
j
{\mathbf{p}}_{i}
i
\mathtt{CB}
\mathtt{CB}
\Lambda
\mathtt{CB_{S}}
90\%
10\%
|\lambda_{0.1}|/|\lambda_{0.9}|
\mathtt{MSA}
\mathtt{MSA}
\mathtt{CB}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
-
\mathtt{CB}
\mathtt{CB}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB_{S}}
\mathtt{CB}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{LN}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
x
y
\mathtt{CB}
12\times 197
x
y
\mathtt{CB}
12\times 197
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
x
y
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
+\ \mathtt{CB}
+\ \mathtt{CB_{S}}
+\ \mathtt{CB}
\mathtt{CB}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\pm
\pm
\pm
\pm
\pm
\pm
\mathtt{CB}
\mathtt{CB}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{<Front>}
\mathtt{CB}
\mathtt{<Front>}
\mathtt{MLP}
\mathtt{<End>}
\mathtt{CB}
\mathtt{<End>}
\mathtt{MLP}
\mathtt{<Mid>}
\mathtt{<End>}
\mathtt{<Mid>}
\mathtt{<End>}
\mathtt{CB}
\mathtt{<Mid>}
\mathtt{<End>}
\mathtt{CB}
\mathtt{<End>}
\mathtt{CB}
\mathtt{<Mid>}
\mathtt{<End>}
\mathtt{CB},\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{CB},\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB},\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{CB},\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}
\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{<Front>-FClayer-<Mid>-FClayer-<End>}
\mathtt{CB},\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{MLP}
\mathtt{MLP}
\mathtt{<Front>-FClayer-<Mid>-FClayer-<End>}
\mathtt{CB},\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{CB}
\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{gate}}({\mathbf{x}}_{i})={\mathbf{x}}_{i}({\mathbf{x}}_{0%
}+\mathbf{1})\text{ for every token $i$}
i
{\mathbf{x}}_{0}
\mathbf{1}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{CB}_{\texttt{hybrid}}({\mathbf{x}}_{i})={\mathbf{x}}_{i}{\mathbf{x}}_{%
0}+\mathtt{CB}({\mathbf{x}}_{i})\text{ for every token $i$}
i
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{MLP}
\mathtt{MSA}
\mathtt{MLP}
\mathtt{CB}
\mathtt{MLP}
\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{MLP}
\mathtt{<Front>-FClayer-<Mid>-FClayer-<End>}
\mathtt{Front}
\mathtt{Mid}
\mathtt{End}
\mathtt{End}
\mathtt{CB}
\mathtt{CB}_{\texttt{gate}}
\mathtt{Front}
\mathtt{CB}_{\texttt{hybrid}}
\mathtt{CB}
\mathtt{CB}_{\texttt{gate}}
\mathtt{CB}_{\texttt{hybrid}}
