\mathcal{IG}_{\text{SO(3)}}
\mathcal{IG}_{\text{SO(3)}}
\mathop{}\!\mathrm{exp}:\mathfrak{so}(3)\rightarrow
\mathop{}\!\mathrm{log}:\text{SO(3)}\rightarrow\mathfrak{so}(3)
\mathfrak{so}(3)
\mathop{}\!\mathrm{d}\mathbf{x}=\mathbf{f}(\mathbf{x},t)\mathop{}\!\mathrm{d}t%
+g(t)\mathop{}\!\mathrm{d}\mathbf{w},
\mathbf{w}
\mathbf{f}(\cdot\ ,t):\text{SO(3)}\rightarrow T_{\mathbf{x}}
g(\cdot):\mathbb{R}\rightarrow\mathbb{R}
T_{\mathbf{x}}
t=0
\mathbf{x}(0)\sim p_{\text{data}}
p_{t}
\mathbf{x}(t)
t>0
p_{0}=p_{\text{data}}
T
p_{T}
\mathrm{d}\mathbf{x}=[\mathbf{f}(\mathbf{x},t)-g(t)^{2}\nabla\log p_{t}(%
\mathbf{x})]\mathrm{d}t+g(t)\mathrm{d}\bar{\mathbf{w}},
\bar{\mathbf{w}}
\nabla\log p_{t}(\mathbf{x})\in T_{\mathbf{x}}
t
\mathrm{d}\mathbf{x}=[\mathbf{f}(\mathbf{x},t)-g(t)^{2}\nabla\log p_{t}(%
\mathbf{x})]\mathrm{d}t.
p_{T}
\{p_{t}\}_{0\leq t<T}
p_{0}
t=0
t=T
p_{t}
f_{\epsilon}(\omega)=\sum_{\ell=0}^{\infty}(2\ell+1)\exp(-l(l+1)\epsilon^{2})%
\frac{\sin((\ell+1/2)\omega)}{\sin(\omega/2)}
\omega=|\bm{\omega}|\in\left(-\pi,\pi\right]
\bm{\omega}
\epsilon
\epsilon>1
\ell_{\max}=5
\epsilon
\epsilon<1
f_{\epsilon}(\omega)\simeq\sqrt{\pi}\epsilon^{-3/2}e^{\frac{\epsilon}{4}-\frac%
{(\omega/2)^{2}}{\epsilon}}\\
\left(\frac{\omega-e^{-\frac{\pi^{2}}{\epsilon}}\left((\omega-2\pi)e^{\pi%
\omega/\epsilon}+(\omega+2\pi)e^{-\pi\omega/\epsilon}\right)}{2\sin(\omega/2)}\right)
\epsilon\geq 1
\epsilon<1
f_{\epsilon}
\mathcal{IG}_{\text{SO(3)}}
\bm{\mu}\in\text{SO(3)}
\epsilon
\mathbf{x}\in\text{SO(3)}
\mathcal{IG}_{\text{SO(3)}}(\bm{\mu},\epsilon)
\mathcal{IG}_{\text{SO(3)}}(\mathbf{x};\bm{\mu},\epsilon)=f_{\epsilon}(\arccos%
\left[2^{-1}(\text{tr}(\bm{\mu}^{T}\mathbf{x})-1)\right])\;.
\mathcal{IG}_{\text{SO(3)}}(\bm{\mu},\epsilon)
\frac{1-\cos(\omega)}{\pi}f_{\epsilon}(\omega)
\left(-\pi,\pi\right]
\mathbf{x}\sim\mathcal{IG}_{\text{SO(3)}}(\cdot;\bm{\mu},\epsilon)
\mathcal{S}^{2}
\mathbf{v}
\bm{\omega}=\omega\mathbf{v}
\bm{x}=\bm{\mu}\mathop{}\!\mathrm{exp}(\bm{\omega})
\mathcal{IG}_{\text{SO(3)}}(\mu,\epsilon)
\mathcal{IG}_{\text{SO(3)}}
\epsilon_{1}
\epsilon_{2}
\mathcal{IG}_{\text{SO(3)}}
\epsilon_{1}+\epsilon_{2}
\epsilon
\mathcal{U}_{\text{SO(3)}}
\epsilon
\mathcal{IG}_{\text{SO(3)}}(\mathbf{I},\epsilon)
\mathcal{N}(0,\sigma^{2}\mathbf{I})
\mathbb{R}^{3}
\epsilon=\frac{\sigma^{2}}{2}
\mathop{}\!\mathrm{d}\mathbf{x}=\mathbf{f}(\mathbf{x},t)\mathop{}\!\mathrm{d}t
h
\mathbf{x}_{0}
\{t_{n}\}_{n=0}^{N}
N
n\in\{0,\ldots,N-1\}
\mathbf{y}_{1}=h\ \mathbf{f}(\mathbf{x}_{n},\ t_{n})
\mathbf{y}_{2}=h\ \mathbf{f}(\mathop{}\!\mathrm{exp}(\frac{1}{2}\mathbf{y}_{1}%
)\mathbf{x}_{n},\ t_{n}+\frac{1}{2}h)
\mathbf{x}_{n+1}=\mathop{}\!\mathrm{exp}(\mathbf{y}_{2})\mathbf{x}_{n}
\{\mathbf{x}_{n}\}_{n=0}^{N}
t=T
t=3T/4
t=T/2
t=T/4
t=0
\mathcal{U}_{SO(3)}
t=T
t=0
\mathcal{U}_{SO(3)}
t=T
t=0
\mathbf{f(\bm{x},t)}=0
g(t)=\sqrt{\frac{\mathop{}\!\mathrm{d}\epsilon(t)}{\mathop{}\!\mathrm{d}t}}
\epsilon(t)
\mathop{}\!\mathrm{d}\mathbf{x}=\sqrt{\frac{\mathop{}\!\mathrm{d}\epsilon(t)}{%
\mathop{}\!\mathrm{d}t}}\mathop{}\!\mathrm{d}\mathbf{w}\;.
\epsilon(t)=t
\mathcal{U}_{\text{SO(3)}}
T
p_{\epsilon}(\tilde{\bm{x}}|\bm{x})=\mathcal{IG}_{\text{SO(3)}}(\tilde{\bm{x}}%
;\bm{x},\epsilon)
\bm{x},\tilde{\bm{x}}\in
p_{\epsilon}(\bm{x})=\int_{SO(3)}p_{\text{data}}(\bm{x}^{\prime})p_{\epsilon}(%
\bm{x}|\tilde{\bm{x}})\mathop{}\!\mathrm{d}\bm{x}\;,
p_{t}
t
p_{\epsilon(t)}=p_{t}
p_{0}
\mathbf{x}_{T}\sim\mathcal{U}_{SO(3)}
t=0
t
\nabla\log p_{\epsilon(t)}
\{X_{i}\}_{i=0}^{3}
T_{\mathbf{e}}
p_{\epsilon}(\bm{x}|\tilde{\bm{x}})
\nabla_{X_{i}}\log p_{\epsilon}(\tilde{\mathbf{x}}|\mathbf{x})=\left.\frac{%
\mathrm{d}}{\mathrm{d}s}\log p_{\epsilon}(\tilde{\mathbf{x}}\mathop{}\!\mathrm%
{exp}(sX_{i})|\mathbf{x})\right|_{s=0}\;,
\mathcal{IG}_{\text{SO(3)}}
s_{\theta}(\mathbf{x},\epsilon):\text{SO(3)}\times\mathbb{R}^{+\star}%
\rightarrow\mathbb{R}^{3}
\mathcal{L}_{DSM}=\mathbb{E}_{p_{\text{data}}(\mathbf{x})}\mathbb{E}_{\epsilon%
\sim\mathcal{N}(0,\sigma_{\epsilon}^{2})}\mathbb{E}_{p_{|\epsilon|}(\tilde{%
\mathbf{x}}|\mathbf{x})}\\
\left[|\epsilon|\ \parallel s_{\theta}(\tilde{\mathbf{x}},\epsilon)-\nabla_{X}%
\log p_{|\epsilon|}(\tilde{\mathbf{x}}|\mathbf{x})\parallel_{2}^{2}\right]
\epsilon\sim\mathcal{N}(0,\sigma_{\epsilon}^{2})
s_{\theta}(\mathbf{x},\epsilon)=\nabla\log p_{\epsilon}
\mathbf{x}_{T}\sim\mathcal{U}_{\text{SO(3)}}\qquad;\qquad\mathop{}\!\mathrm{d}%
\mathbf{x}_{t}=-\frac{1}{2}\frac{\mathop{}\!\mathrm{d}\epsilon(t)}{\mathop{}\!%
\mathrm{d}t}s_{\theta}(\mathbf{x}_{t},\epsilon(t))\mathop{}\!\mathrm{d}t
t=0
\mathop{}\!\mathrm{d}\mathbf{x}=-\frac{1}{2}\beta(t)\mathbf{x}\mathop{}\!%
\mathrm{d}t+\sqrt{\beta(t)}\mathop{}\!\mathrm{d}\mathbf{w},
\beta(t)
(0,1)
\mathcal{IG}_{\text{SO(3)}}
\mu_{\theta}(\mathbf{x},t),\epsilon_{\theta}(\mathbf{x},t)
N
\{t_{i}\}_{i=0}^{N}
\mathbf{x}_{N}\sim\mathcal{IG}_{\text{SO(3)}}(\mathbf{I},1)
i=\{N,N-1,\ldots,1\}
\mathbf{x}_{i-1}\sim p_{\theta}(\cdot;\mathbf{x}_{i})=\mathcal{IG}_{\text{SO(3%
)}}(\cdot;\mu_{\theta}(\mathbf{x}_{i},t_{i}),\epsilon_{\theta}(\mathbf{x}_{i},%
t_{i}))
\{\mathbf{x}_{n}\}_{n=0}^{N}
\{\mathbf{x}_{i}\}_{i=0}^{N}
\{0\leq t_{i}\leq T\}_{i=0}^{n}
p(\mathbf{x}_{0:N})=p(\mathbf{x}_{0})p_{\beta_{1}}(\mathbf{x}_{1}|\mathbf{x}_{%
0})\ldots p_{\beta_{N}}(\mathbf{x}_{N}|\mathbf{x}_{N-1})
p_{\beta_{i+1}}(\mathbf{x}_{i+1}|\mathbf{x}_{i})=\mathcal{IG}_{\text{SO(3)}}(%
\mathbf{x}_{i+1};\sqrt{1-\beta_{i+1}}\mathbf{x}_{i},\beta_{i+1})
p_{\theta}(\bm{x}_{i-1}|\bm{x}_{i})
p_{\theta}(\mathbf{x}_{0:N})=p_{\theta}(\bm{x}_{N})p_{\theta}(\mathbf{x}_{N-1}%
|\mathbf{x}_{N})\ldots p_{\theta}(\mathbf{x}_{0}|\mathbf{x}_{1}).
p_{\theta}(\bm{x}_{i-1}|\bm{x}_{i})=\mathcal{IG}_{\text{SO(3)}}(\bm{x}_{i-1};%
\bm{x}_{i}\ \bm{\delta}_{\theta}(\bm{x}_{i},t_{i}),\epsilon_{\theta}(\bm{x}_{i%
},t_{i}))
\bm{\delta}_{\theta}:\text{SO(3)}\times\mathbb{R}^{+}\rightarrow\text{SO(3)}
\bm{x}_{i}
\epsilon_{\theta}:\text{SO(3)}\times\mathbb{R}^{+}\rightarrow\mathbb{R}^{+}
\bm{\delta}_{\theta}
p_{0}
p_{T}
p_{\theta}(\bm{x}_{i-1}|\bm{x}_{i})
p_{\theta}(\mathbf{x}_{i-1}|\mathbf{x}_{i})
p(\mathbf{x}_{{i-1}}|\mathbf{x}_{i},\mathbf{x}_{0})
\mathbf{x}_{0}
\mathcal{IG}_{\text{SO(3)}}
p(x_{t-1}|x_{t},x_{0})
\mathbb{E}\left[-\log p_{\theta}(\mathbf{x}_{0})\right]\leq\\
\mathbb{E}_{p}\left[-\log p(\mathbf{x}_{N})-\sum_{i\geq 1}\log\frac{p_{\theta}%
(\mathbf{x}_{i-1}|\mathbf{x}_{i})}{p(\mathbf{x}_{i}|\mathbf{x}_{i-1})}\right]=%
:\mathcal{L_{\mathrm{ELBO}}}
\log p_{\theta}(\mathbf{x}_{i-1}|\mathbf{x}_{i})
\mathbf{x}_{i-1},\mathbf{x}_{i}
\mathcal{L}_{DDPM}:=\\
\sum_{i\geq 0}\mathbb{E}_{p_{\text{data}}(\mathbf{x}_{0})}\mathbb{E}_{p_{%
\epsilon}(\mathbf{x}_{i}|\mathbf{x}_{0})}\mathbb{E}_{p_{\epsilon_{i}}(\mathbf{%
x}_{i+1}|\mathbf{x}_{i})}\left[-\log p_{\theta}(\mathbf{x}_{i}|\mathbf{x}_{i+1%
})\right]
\mathcal{IG}_{\text{SO(3)}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\sim 0.5
\sim 1
k
\sim 0.5
\sim 1
k
0.5
1
\ell_{t|0}
\bf{T}
p(\bf{x}_{\text{galaxy}}|\bf{T})
\bf{x}_{\text{galaxy}}\in\text{SO(3)}
\bf{T}
s_{\theta}(\bf{x}_{\text{galaxy}}|\bf{T})
\nabla_{\bf{x}_{\text{galaxy}}}\mathrm{log}\,\big{[}p(\bf{x}_{\text{galaxy}}|%
\bf{T})\big{]}\approx s_{\theta}(\bf{x}_{\text{galaxy}}|\bf{T})
\omega(r)
a
b
c
\omega(r)
a
b
c
\bf{T}
\omega(r)
\omega(r)
\omega(r)
\omega(r)
\mathbb{R}^{n}
\mathbb{R}^{n}
\mathbb{R}^{n}
10^{-4}
\beta_{1}=0.90
\beta_{2}=0.95
\in\mathbb{R}^{3\mathrm{x}3}
\alpha,\beta,\psi
\mathbf{\gamma}=a+b\mathbf{i}+c\mathbf{j}+d\mathbf{k}
a,b,c,d
\sqrt{a^{2}+b^{2}+c^{2}+d^{2}}=1
\mathbf{i}+\mathbf{j}+\mathbf{k}
\mathbf{\theta}=\theta\mathbf{e}=(\theta_{1},\theta_{2},\theta_{3})=\theta(e_{%
1},e_{2},e_{3})
\theta
\mathbf{e}
\theta=\pi
\gamma_{1}
\gamma_{2}
\gamma_{1}\cdot\gamma_{2}=(a_{1}+b_{1}\mathbf{i}+c_{1}\mathbf{j}+d_{1}\mathbf{%
k})\cdot(a_{2}+b_{2}\mathbf{i}+c_{2}\mathbf{j}+d_{2}\mathbf{k})
\gamma_{1}
\gamma_{2}
\gamma_{0}=1+0\mathbf{i}+0\mathbf{j}+0\mathbf{k}
\gamma*
\gamma*=a-b\mathbf{i}-c\mathbf{j}-d\mathbf{k}
\mathbf{x}
\mathcal{N}(\mathbf{\mu};\sigma^{2}\mathbf{I})
\mathbf{x}=\mathbf{\mu}+\sigma^{2}\cdot\delta
\delta\sim\mathcal{N}(0;\textbf{I})
\gamma=\theta\cdot\epsilon^{\delta}
\gamma^{a}=\mathrm{exp}(\mathrm{ln}(\gamma)a)
\sqrt{\alpha}\cdot\mathbf{x}+\sqrt{(1-\alpha)}\delta
\mathbf{x}=\mathbf{x}^{\sqrt{\alpha}}\cdot\delta^{\sqrt{(1-\alpha)}}
\mathcal{R}^{n}
\mathcal{S}^{n}
R^{n}
z=0
\log_{10}(M_{*}/M_{\odot})\geq 9
\phi
T_{ij}(\mathbf{r})=\frac{\partial^{2}\phi(\mathbf{r})}{\partial r_{i}\partial r%
_{j}},
\phi
c
\mathbf{r_{c}}
\delta(\mathbf{r_{c}})=\frac{\rho_{c}}{\langle\rho_{c}\rangle}-1.
\nabla^{2}\phi(\mathbf{r})=4\pi G\bar{\rho}\delta(\mathbf{r}),
G
\hat{\phi}(\mathbf{k})=-4\pi G\bar{\rho}\frac{\hat{\delta}(\mathbf{k})}{k^{2}},
\hat{T}_{ij}(\mathbf{k})=4\pi G\bar{\rho}\frac{k_{i}k_{j}}{k^{2}}\hat{\delta}(%
\mathbf{k}).
\gamma
\hat{T}_{ij}(\mathbf{k})=4\pi G\bar{\rho}\frac{k_{i}k_{j}}{k^{2}}\hat{\delta}(%
\mathbf{k})\;\;e^{-k^{2}\gamma^{2}/2}.
\gamma
1024^{3}
L_{\text{box}}/1024=0.073
\omega(r)=\langle|\hat{e}({\bf x})\cdot\hat{r}({\bf x})|^{2}\rangle-\frac{1}{3%
}=\sum_{i\neq j}|\hat{e}_{i}\cdot\hat{r}_{ij}|^{2}-\frac{1}{3}
\bf x
\hat{e}
\hat{r}
r
\frac{1}{3}
