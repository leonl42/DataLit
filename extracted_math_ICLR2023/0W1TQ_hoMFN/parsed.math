4\times
15\times
N
\mathcal{M}^{E}:=\left<\mathcal{U},\mathcal{E},\mathfrak{g},\mathcal{A},%
\mathbb{P},\mathcal{R},\gamma\right>
\mathcal{U}
\mathcal{E}
\mathfrak{g}
\mathcal{A}
\mathcal{S}\vcentcolon=\mathcal{U}\times\mathcal{E}^{N}
\mathbf{s}=(u,e_{1},\cdots,e_{N})
\mathcal{G}\vcentcolon=\mathfrak{g}^{N}
\mathbf{g}=(g_{1},\ldots,g_{N})
\displaystyle\mathcal{R}\left(\mathbf{s},\mathbf{g}\right):=\mathcal{R}\left(%
\{\tilde{r}(e_{i},g_{i},u)\}_{i=1}^{N}\right)
\displaystyle\mathcal{R}\left(\mathbf{s},\mathbf{g}\right)
\displaystyle:=\mathcal{R}\left(\{\tilde{r}(e_{i},g_{i},u)\}_{i=1}^{N}\right)
\displaystyle\mathbb{P}(\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})\vcentcolon=%
\mathbb{P}\left(\left(u^{\prime},\{e_{i}^{\prime}\}_{i=1}^{N}\right)|\left(u,%
\{e_{i}\}_{i=1}^{N}\right),\mathbf{a}\right)
\displaystyle\mathbb{P}(\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})
\displaystyle\vcentcolon=\mathbb{P}\left(\left(u^{\prime},\{e_{i}^{\prime}\}_{%
i=1}^{N}\right)|\left(u,\{e_{i}\}_{i=1}^{N}\right),\mathbf{a}\right)
\mathbf{s},\mathbf{s}^{\prime}\in\mathcal{S}
\mathbf{a}\in\mathcal{A}
\mathbf{g}\in\mathcal{G}
\tilde{r}_{i}=\tilde{r}(e_{i},g_{i},u)
\pi^{\star}:\mathcal{S}\times\mathcal{G}\rightarrow\mathcal{A}
\pi^{\star}\vcentcolon=\arg\max_{\pi}\ \ \left\{J(\pi):=\mathbb{E}_{\pi}\left[%
\sum_{t=0}^{\infty}\gamma^{t}\mathcal{R}(\mathbf{s}_{t},\mathbf{g})\right]%
\right\},
\sigma\in S_{N}
N
\mathcal{R}(\sigma\mathbf{s},\sigma\mathbf{g})=\mathcal{R}(\mathbf{s},\mathbf{%
g})
\mathbb{P}(\sigma\mathbf{s}^{\prime}|\sigma\mathbf{s},\mathbf{a})=\mathbb{P}(%
\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})
\mathbf{s},\mathbf{s}^{\prime}\in\mathcal{S}
\mathbf{a}\in\mathcal{A}
\displaystyle\sigma\mathbf{s}\vcentcolon=(u,e_{\sigma(1)},\cdots,e_{\sigma(N)})
\displaystyle\sigma\mathbf{s}
\displaystyle\vcentcolon=(u,e_{\sigma(1)},\cdots,e_{\sigma(N)})
\displaystyle\sigma\mathbf{g}\vcentcolon=(g_{\sigma(1)},\cdots,g_{\sigma(N)})
\displaystyle\sigma\mathbf{g}
\displaystyle\vcentcolon=(g_{\sigma(1)},\cdots,g_{\sigma(N)})
N
\pi^{\star}:\mathcal{S}\times\mathcal{G}\rightarrow\mathcal{A}
Q^{\star}:\mathcal{S}\times\mathcal{A}\times\mathcal{G}\rightarrow\mathbb{R}
\sigma\in S_{N}
\displaystyle\pi^{\star}(\sigma\mathbf{s},\sigma\mathbf{g})=\pi^{\star}(%
\mathbf{s},\mathbf{g})
\displaystyle\pi^{\star}(\sigma\mathbf{s},\sigma\mathbf{g})
\displaystyle=\pi^{\star}(\mathbf{s},\mathbf{g})
\displaystyle Q^{\star}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})=Q^{\star%
}(\mathbf{s},\mathbf{a},\mathbf{g})
\displaystyle Q^{\star}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})
\displaystyle=Q^{\star}(\mathbf{s},\mathbf{a},\mathbf{g})
\pi:(\mathbf{s},\mathbf{g})\mapsto\mathbf{a}
\mathbf{s}=(u,e_{1},\cdots,e_{N})
u
e_{i}
(g_{1},\cdots,g_{N})
N
y_{i}=(u,e_{i},g_{i})
y_{i}
\phi(\cdot)
\rho(\cdot)
\text{SA}(\cdot)
z_{1},\cdots,z_{N}
z_{i}
\rho(\cdot)
\pi:(\mathbf{s},\mathbf{g})\mapsto\mathbf{a}
\mathbf{s}=(u,e_{1},\cdots,e_{N})
u
e_{i}
(g_{1},\cdots,g_{N})
N
y_{i}=(u,e_{i},g_{i})
y_{i}
\phi(\cdot)
\rho(\cdot)
\text{SA}(\cdot)
z_{1},\cdots,z_{N}
z_{i}
\rho(\cdot)
\pi(\mathbf{s},\mathbf{g})
(\mathbf{s},\mathbf{g})
\text{vec}(\mathbf{s},\mathbf{g})\vcentcolon=\text{Concatenate}(\underbrace{u,%
e_{1},\cdots,e_{N}}_{=\mathbf{s}},\underbrace{g_{1},\cdots,g_{N}}_{=\mathbf{g}})
\text{MLP}(\cdot)
\pi(\mathbf{s},\mathbf{g})\vcentcolon=\text{MLP}(\text{vec}(\mathbf{s},\mathbf%
{g}))
N
M>N
(e_{N+1},\cdots,e_{M})=(0,\cdots,0)
(g_{N+1},\cdots,g_{M})=(0,\cdots,0)
x=\{x_{1},\cdots,x_{N}\}
\text{DS}(x)\vcentcolon=\rho\left(\sum_{i}\phi(x_{i})\right),
\rho
\phi
\text{DS}(\cdot)
x
\rho,\phi
\pi^{\star}
\{(e_{1},g_{1}),\cdots,(e,g_{N})\}
u
u
\displaystyle\pi(\mathbf{s},\mathbf{g})\vcentcolon=\text{DS}\left(\{y_{i}\}_{i%
=1}^{N}\right)
\displaystyle\pi(\mathbf{s},\mathbf{g})
\displaystyle\vcentcolon=\text{DS}\left(\{y_{i}\}_{i=1}^{N}\right)
\displaystyle y_{i}\vcentcolon=\text{Concatenate}(\underbrace{u,e_{i}}_{\in%
\mathbf{s}},\underbrace{g_{i}}_{\in\mathbf{g}})
\displaystyle y_{i}
\displaystyle\vcentcolon=\text{Concatenate}(\underbrace{u,e_{i}}_{\in\mathbf{s%
}},\underbrace{g_{i}}_{\in\mathbf{g}})
\pi^{\star}
\rho
(x_{1},\cdots,x_{N})
(q_{i})_{i=1}^{N}
(k_{i})_{i=1}^{N}
(v_{i})_{i=1}^{N}
(h_{i})_{i=1}^{N}
h_{i}=\sum_{j=1}^{N}\text{softmax}\left\{(q_{i}\cdot k_{l})_{l=1}^{N}\right\}_%
{j}v_{j}
\mathbf{s}
y=(y_{1},\cdots,y_{N})
y_{i}
i
\text{SA}(\cdot)
y
z=(z_{1},\cdots,z_{N})
z_{i}
\mathbf{a}\in\mathcal{A}
\rho(\cdot)
z
N
N
N
N
N
100\%
N
95\%
5
N
95\%
5
N=1,2,3
N=1,2
N
5000
100\%
1000
95\%
95\%
N=3
N\in\{1,\ldots,6\}
N=2
N\in\{1,\ldots,3\}
N
3
3
95\%
5
95\%
5
35\%
5\%
60\%
100\%
48\%
\pi^{\star}:\mathcal{S}\times\mathcal{G}\rightarrow\mathcal{A}
Q^{\star}:\mathcal{S}\times\mathcal{A}\times\mathcal{G}\rightarrow\mathbb{R}
\sigma\in S_{N}
\displaystyle\pi^{\star}(\sigma\mathbf{s},\sigma\mathbf{g})=\pi^{\star}(%
\mathbf{s},\mathbf{g})
\displaystyle\pi^{\star}(\sigma\mathbf{s},\sigma\mathbf{g})=\pi^{\star}(%
\mathbf{s},\mathbf{g})
\displaystyle Q^{\star}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})=Q^{\star%
}(\mathbf{s},\mathbf{a},\mathbf{g})
\displaystyle Q^{\star}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})=Q^{\star%
}(\mathbf{s},\mathbf{a},\mathbf{g})
\displaystyle\mathcal{R}(\mathbf{s},\mathbf{a},\mathbf{g})=\mathcal{R}(\sigma%
\mathbf{s},\mathbf{a},\sigma\mathbf{g})
\displaystyle\mathcal{R}(\mathbf{s},\mathbf{a},\mathbf{g})=\mathcal{R}(\sigma%
\mathbf{s},\mathbf{a},\sigma\mathbf{g})
\displaystyle\mathbb{P}(\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})=\mathbb{P}(%
\sigma\mathbf{s}^{\prime}|\sigma\mathbf{s},\mathbf{a})
\displaystyle\mathbb{P}(\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})=\mathbb{P}(%
\sigma\mathbf{s}^{\prime}|\sigma\mathbf{s},\mathbf{a})
\sigma\mathbf{s}
\sigma\mathbf{g}
\mathcal{U}
\mathcal{E}
\mathcal{S}=\mathcal{U}\times\mathcal{E}^{N}
Q^{\star}
Q^{\star}_{k}
k
Q^{\star}_{0}\equiv 0
Q^{\star}_{k}\mapsto Q^{\star}_{k+1}
\displaystyle Q^{\star}_{k+1}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})=%
\mathcal{R}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})+\gamma\max_{\mathbf{%
a}^{\prime}}\sum_{\mathbf{s}^{\prime}\in\mathcal{S}}\mathbb{P}(\mathbf{s}^{%
\prime}|\sigma\mathbf{s},\mathbf{a})Q^{\star}_{k}(\mathbf{s}^{\prime},\mathbf{%
a}^{\prime})
\displaystyle Q^{\star}_{k+1}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})
\displaystyle=\mathcal{R}(\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})+\gamma%
\max_{\mathbf{a}^{\prime}}\sum_{\mathbf{s}^{\prime}\in\mathcal{S}}\mathbb{P}(%
\mathbf{s}^{\prime}|\sigma\mathbf{s},\mathbf{a})Q^{\star}_{k}(\mathbf{s}^{%
\prime},\mathbf{a}^{\prime})
\displaystyle=\mathcal{R}(\mathbf{s},\mathbf{a},\mathbf{g})+\gamma\max_{%
\mathbf{a}^{\prime}}\sum_{\mathbf{s}^{\prime}\in\mathcal{S}}\mathbb{P}(\sigma^%
{-1}\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})Q^{\star}_{k}(\sigma^{-1}\mathbf%
{s}^{\prime},\mathbf{a}^{\prime})
\displaystyle=\mathcal{R}(\mathbf{s},\mathbf{a},\mathbf{g})+\gamma\max_{%
\mathbf{a}^{\prime}}\sum_{\mathbf{s}^{\prime}\in\mathcal{S}}\mathbb{P}(\sigma^%
{-1}\mathbf{s}^{\prime}|\mathbf{s},\mathbf{a})Q^{\star}_{k}(\sigma^{-1}\mathbf%
{s}^{\prime},\mathbf{a}^{\prime})
\displaystyle=\mathcal{R}(\mathbf{s},\mathbf{a},\mathbf{g})+\gamma\max_{%
\mathbf{a}^{\prime}}\sum_{\mathbf{s}^{\prime}\in\mathcal{S}}\mathbb{P}(\mathbf%
{s}^{\prime}|\mathbf{s},\mathbf{a})Q^{\star}_{k}(\mathbf{s}^{\prime},\mathbf{a%
}^{\prime})
\displaystyle=\mathcal{R}(\mathbf{s},\mathbf{a},\mathbf{g})+\gamma\max_{%
\mathbf{a}^{\prime}}\sum_{\mathbf{s}^{\prime}\in\mathcal{S}}\mathbb{P}(\mathbf%
{s}^{\prime}|\mathbf{s},\mathbf{a})Q^{\star}_{k}(\mathbf{s}^{\prime},\mathbf{a%
}^{\prime})
\displaystyle=Q^{\star}_{k+1}(\mathbf{s},\mathbf{a},\mathbf{g})
\displaystyle=Q^{\star}_{k+1}(\mathbf{s},\mathbf{a},\mathbf{g})
Q^{\star}_{k}
k=0,1,\cdots
Q^{\star}_{k}\xrightarrow[k\rightarrow\infty]{}Q^{\star}
Q^{\star}_{k}
\sigma^{-1}\mathbf{s}^{\prime}
\mathbf{s}^{\prime}\in\mathcal{S}
\mathbf{s}^{\prime}\in\mathcal{S}
f(\cdot)
\sum_{\mathbf{s}\in\mathcal{S}}f(\sigma^{-1}\mathbf{s})=\sum_{u\in\mathcal{U}}%
\sum_{e_{1}\in\mathcal{E}}\cdots\sum_{e_{N}\in\mathcal{E}}f(u,e_{\sigma^{-1}(1%
)},\cdots,e_{\sigma^{-1}(N)})=\sum_{\mathbf{s}\in\mathcal{S}}f(\mathbf{s})
Q^{\star}
\pi^{\star}
\pi^{\star}(\sigma\mathbf{s},\sigma\mathbf{g})=\arg\max_{\mathbf{a}}Q^{\star}(%
\sigma\mathbf{s},\mathbf{a},\sigma\mathbf{g})=\arg\max_{\mathbf{a}}Q^{\star}(%
\mathbf{s},\mathbf{a},\mathbf{g})=\pi^{\star}(\mathbf{s},\mathbf{g})
[-1,1]
20
50
2\times 50+2\times 20=140
\theta\in[-0.7,0.7]
\theta^{\star}\in\{-0.7,0.7\}
|\theta-\theta^{\star}|
\theta
\theta^{\star}
0
-1
16
2
5
80\%
\eta
\epsilon
\tilde{a}\sim\begin{cases}a+\mathcal{N}(0,\eta),&\text{with prob }1-\epsilon\\
\text{Uniform}(-1,1),&\text{with prob }\epsilon\end{cases}
50\times\textsc{parallel envs}
\eta,\epsilon
\eta,\epsilon
\eta_{0}
\epsilon_{0}
.01\times\eta_{0}
.01\times\epsilon_{0}
100
150
\eta_{0},\epsilon_{0}
\theta^{\text{target}}\leftarrow(1-\tau)\theta+\tau\theta^{\text{target}}
\tau
256
A
N
M
H
\gamma
10^{6}
2:5
\eta_{0}
\epsilon_{0}
\tau
\times 3
\times 3
\phi
\times 3
\phi
\times 2
\rho
\rho
\times 2
\times 2
\rho
\rho
M\in\{1000,2000,3000,4000,5000\}
M\times T
\mathcal{D}=\{(\mathbf{s}_{i},\mathbf{a}_{i})\}_{i=1}^{M\times T}
\arg\min_{\pi}J(\pi)\vcentcolon=\frac{1}{|\mathcal{D}|}\sum_{(\mathbf{s},%
\mathbf{a})\sim\mathcal{D}}||\pi(\mathbf{s})-\mathbf{a}||^{2}
0.001
0.0001
60,000
128
N
N
N
N
10
N\in\{1,2,3\}
N\in\{1,2,3\}
N\in\{1,2,3\}
\rho
\rho
\rho
\rho
\phi
\rho
\phi
\rho
\phi
\rho
\phi
\rho
\rho
\rho
\rho
15\%
