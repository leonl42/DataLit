T
\langle{\mathbb{S}},{\mathbb{A}},P(s,a,s^{\prime}),R(s,a,s^{\prime}),T,\mu_{0}%
,\gamma\rangle
{\mathbb{S}}
{\mathbb{A}}
P:{\mathbb{S}}\times{\mathbb{A}}\times{\mathbb{S}}\rightarrow[0,1]
R:{\mathbb{S}}\times{\mathbb{A}}\times{\mathbb{S}}\rightarrow[0,1]
T
\mu_{0}
\gamma
\pi_{\theta}:{\mathbb{S}}\times{\mathbb{A}}\rightarrow[0,1]
\theta
\pi_{\theta}
\displaystyle J=\mathbb{E}_{\begin{subarray}{c}s_{0}\sim\mu_{0}\\
a_{t}\sim\pi_{\theta}(\cdot|s_{t})\\
s_{t+1}\sim P(\cdot|s_{t},a_{t})\end{subarray}}\bigg{[}\sum^{T-1}_{t=0}\gamma^%
{t}R(s_{t},a_{t},s_{t+1})\bigg{]}
\displaystyle J
\displaystyle=\mathbb{E}_{\begin{subarray}{c}s_{0}\sim\mu_{0}\\
a_{t}\sim\pi_{\theta}(\cdot|s_{t})\\
s_{t+1}\sim P(\cdot|s_{t},a_{t})\end{subarray}}\bigg{[}\sum^{T-1}_{t=0}\gamma^%
{t}R(s_{t},a_{t},s_{t+1})\bigg{]}
\displaystyle=\mathbb{E}_{\mu_{0},\pi_{\theta}}\bigg{[}\sum^{T-1}_{t=0}\gamma^%
{t}R(s_{t},a_{t},s_{t+1})\bigg{]}
\displaystyle=\mathbb{E}_{\mu_{0},\pi_{\theta}}\bigg{[}\sum^{T-1}_{t=0}\gamma^%
{t}R(s_{t},a_{t},s_{t+1})\bigg{]}
s_{t+1}
P(\cdot|s_{t},a_{t})
a_{t}
\pi_{\theta}(\cdot|s_{t})
s_{0}
\mu_{0}
\theta
\theta
\theta_{i+1}=\theta_{i}+\alpha\nabla_{\theta}J_{i}
\nabla_{\theta}J
\displaystyle\nabla_{\theta}J=\mathbb{E}_{\mu_{0},\pi_{\theta}}\big{[}A^{\pi_{%
\theta}}_{t}\nabla_{\theta}\log\pi_{\theta}(a_{t}|s_{t})\big{]};
\displaystyle\text{ with }A^{\pi_{\theta}}_{t}=Q^{\pi_{\theta}}(s_{t},a_{t})-V%
^{\pi_{\theta}}(s_{t})
\displaystyle Q^{\pi_{\theta}}(s,a)=\mathbb{E}_{\pi_{\theta}}\bigg{[}\sum^{T-1%
}_{k=0}\gamma^{k}R(s_{t+k},a_{t+k},s_{t+k+1})\big{|}s_{t}=s,a_{t}=a\bigg{]}
\displaystyle V^{\pi_{\theta}}(s)=\mathbb{E}_{\pi_{\theta}}\bigg{[}\sum^{T-1}_%
{k=0}\gamma^{k}R(s_{t+k},a_{t+k},s_{t+k+1})\big{|}s_{t}=s\bigg{]}
V^{\pi_{\theta}}(s)
s
\pi_{\theta}
Q^{\pi_{\theta}}(s,a)
a
s
\pi_{\theta}
{\mathbb{A}}({\bm{s}})
{\bm{s}}
\langle{\mathbb{S}},{\mathbb{A}},P({\bm{s}},a,{\bm{s}}^{\prime}),R({\bm{s}},a,%
{\bm{s}}^{\prime}),T,\mu_{0},\gamma\rangle
d(s,s^{\prime})
\varepsilon
{\mathbb{I}}({\bm{s}})
{\bm{s}}
\forall a\in{\mathbb{I}}({\bm{s}})\subseteq{\mathbb{A}};\text{P}(d({\bm{s}}_{t%
+1},{\bm{s}}_{t})\leq\varepsilon|{\bm{s}}_{t}={\bm{s}},a_{t}=a)=1
a
\omega_{a}=\langle\mathcal{I}_{\omega_{a}},\pi_{\omega_{a}},\beta_{\omega_{a}}\rangle
a\in{\mathbb{A}}
\mathcal{I}_{\omega_{a}}=\{{\bm{s}}\;:a\notin{\mathbb{I}}({\bm{s}})\;\forall{%
\bm{s}}\in{\mathbb{S}}\}
\pi_{\omega_{a}}({\bm{s}},a)=1\;\forall{\bm{s}}\in{\mathbb{S}}
\beta_{\omega_{a}}({\bm{s}})=1\;\forall s\in{\mathbb{S}}
\mathcal{I}
C({\bm{s}},a)
a
{\bm{s}}
\omega_{a}
\omega_{a}
\displaystyle\mathcal{I}_{\omega_{a}}=\{{\bm{s}}:C(s,a)\geq\tau\;\forall s\in{%
\mathbb{S}}\}
\displaystyle\text{with }C({\bm{s}},a)=P(a\notin{\mathbb{I}}({\bm{s}}))
{\bm{m}}:{\mathbb{S}}\rightarrow{\mathbb{R}}^{|{\mathbb{A}}|}
C(\cdot,\cdot)
C
\tau
0.5
0
1
\pi_{\theta}
\displaystyle\pi^{\text{mask}}_{\theta}(\cdot|{\bm{s}},\pi_{\theta},{\bm{m}}({%
\bm{s}}))=\texttt{softmax}({\bm{m}}({\bm{s}})\cdot\pi_{\theta}(\cdot|{\bm{s}}))
\displaystyle\text{with }\;\;m_{i}({\bm{s}})=\begin{cases}0&\text{ if }C({\bm{%
s}},a_{i})<\tau\\
1&\text{otherwise}\end{cases}\;\;\forall i\in\{1..|{\mathbb{A}}|\}
C
C
\theta_{0}
\phi_{0}
\epsilon_{0}
\theta_{K}
\phi_{K}
{\mathbb{D}}\leftarrow\{\}
k=1,2,\ldots,K
=1,2,\ldots,N
\pi_{\theta_{k}}
\mathcal{C}_{\phi_{k}}
\epsilon_{k}
{\mathbb{D}}
\mathcal{C}_{\phi_{k}}
\hat{R}_{t}
\hat{A}_{t}
V_{k}
1,2,\ldots,M
{\mathbb{D}}
\mathcal{L}^{\text{Policy}}
\theta
\mathcal{L}^{\mathcal{C}}
\phi
\mathcal{L}^{\mathcal{C}}
\epsilon_{k+1}
\epsilon_{k}
k
\theta_{K}
\phi_{K}
\pi_{\theta}
\mathcal{C}_{\phi}
\epsilon
{\mathbb{D}}
\tau=0.5
{\bm{s}}_{0}
t=1,2,...,T
{\bm{m}}_{t}\leftarrow\bm{1}
\textsc{random}(0,1)\leq\epsilon
a\in{\mathbb{A}}
{m}_{t_{a}}\leftarrow\mathcal{C}_{\phi}(a,{\bm{s}}_{t})\geq\tau
a_{t}\sim\textsc{softmax}({\bm{m}}_{t}\cdot\mathbf{\pi_{\theta}({\bm{s}}_{t})})
a_{t}
r_{t}
{\bm{s}}_{t+1}
y_{t}\leftarrow\bm{1}_{{\bm{s}}_{t+1}\neq{\bm{s}}_{t}}
a_{t}
{\mathbb{D}}\leftarrow{\mathbb{D}}\cup\{\langle{\bm{s}}_{t},a_{t},r_{t},{\bm{s%
}}_{t+1},y_{t},{\bm{m}}_{t}\rangle\}
\mathcal{C}_{\phi}
\phi
a
{\bm{s}}
\epsilon
\epsilon
\mathcal{C}_{\phi}
\pi
5
2
d({\bm{s}}_{t+1},{\bm{s}})=1-\bm{1}_{{\bm{s}}_{t+1}={\bm{s}}}
74\%
36\%
3
5
\epsilon=0.5
C
C
\epsilon
0.25
0.25
\epsilon=0.25
100,000
64
10
3\cdot 10^{-4}
1\cdot 10^{-4}
C
\epsilon
\epsilon
\epsilon
\epsilon=0.75
\epsilon
\epsilon=0.1
\epsilon
