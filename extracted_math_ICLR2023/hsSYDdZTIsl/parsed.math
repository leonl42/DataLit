m
w_{1},w_{2},...,w_{m}
n
e_{1},e_{2},...,e_{n}
D
\mathbf{h}_{w_{1}},\mathbf{h}_{w_{2}},...,\mathbf{h}_{w_{m}}
\mathbf{h}_{w}\in\mathbb{R}^{D}
\mathbf{h}_{e_{1}},\mathbf{h}_{e_{2}},...,\mathbf{h}_{e_{n}}
\mathbf{h}_{e}\in\mathbb{R}^{D}
\mathbf{A}\in\mathbb{R}^{V_{w}\times D}
V_{w}
\mathbf{B}\in\mathbb{R}^{V_{e}\times H}
\mathbf{U}\in\mathbb{R}^{H\times D}
V_{e}
\mathbf{B}\mathbf{U}
i
\mathbf{C}_{i}\in\mathbb{R}^{D}
\mathbf{D}_{i}\in\mathbb{R}^{D}
\mathbf{e}\in\mathbb{R}^{D}
\mathbf{x}_{1},\mathbf{x}_{2},...,\mathbf{x}_{k}
\mathbf{x}_{i}\in\mathbb{R}^{D}
\mathbf{y}_{1},\mathbf{y}_{2},...,\mathbf{y}_{k}
\mathbf{y}_{i}\in\mathbb{R}^{L}
k=m+n
i
\mathbf{y}_{i}
\displaystyle\mathbf{y}_{i}=\sum^{k}_{j=1}\alpha_{ij}\mathbf{V}\mathbf{x}_{j}
\displaystyle\mathbf{y}_{i}
\displaystyle=\sum^{k}_{j=1}\alpha_{ij}\mathbf{V}\mathbf{x}_{j}
\displaystyle e_{ij}=\frac{\mathbf{K}\mathbf{x}_{j}^{\top}\mathbf{Q}\mathbf{x}%
_{i}}{\sqrt{L}}
\displaystyle e_{ij}
\displaystyle=\frac{\mathbf{K}\mathbf{x}_{j}^{\top}\mathbf{Q}\mathbf{x}_{i}}{%
\sqrt{L}}
\displaystyle\alpha_{ij}=\mathrm{softmax}(e_{ij})
\displaystyle\alpha_{ij}
\displaystyle=\mathrm{softmax}(e_{ij})
\mathbf{Q}\in\mathbb{R}^{L\times D}
\mathbf{K}\in\mathbb{R}^{L\times D}
\mathbf{V}\in\mathbb{R}^{L\times D}
e_{ij}
\mathbf{x}_{i}
\mathbf{x}_{j}
e_{ij}
\displaystyle e_{ij}=\begin{cases}\mathbf{K}\mathbf{x}_{j}^{\top}\mathbf{Q}%
\mathbf{x}_{i},&\text{\small{if both }}\mathbf{x}_{i}\text{\small{ and }}%
\mathbf{x}_{j}\text{\small{ are words}}\\
\mathbf{K}\mathbf{x}_{j}^{\top}\mathbf{Q}_{w2e}\mathbf{x}_{i},&\text{\small{if%
 }}\mathbf{x}_{i}\text{\small{ is word and }}\mathbf{x}_{j}\text{\small{ is %
entity}}\\
\mathbf{K}\mathbf{x}_{j}^{\top}\mathbf{Q}_{e2w}\mathbf{x}_{i},&\text{\small{if%
 }}\mathbf{x}_{i}\text{\small{ is entity and }}\mathbf{x}_{j}\text{\small{ is %
word}}\\
\mathbf{K}\mathbf{x}_{j}^{\top}\mathbf{Q}_{e2e}\mathbf{x}_{i},&\text{\small{if%
 both }}\mathbf{x}_{i}\text{\small{ and }}\mathbf{x}_{j}\text{\small{ are %
entities}}\\
\end{cases}
\mathbf{Q}_{w2e}
\mathbf{Q}_{e2w}
\mathbf{Q}_{e2e}\in\mathbb{R}^{L\times D}
\displaystyle\mathbf{\hat{y}}=\mathrm{softmax}(\mathbf{B}\mathbf{T}\mathbf{m}+%
\mathbf{b}_{o})
\displaystyle\mathbf{\hat{y}}=\mathrm{softmax}(\mathbf{B}\mathbf{T}\mathbf{m}+%
\mathbf{b}_{o})
\displaystyle\mathbf{m}=\mathrm{layer\_norm}\big{(}\mathrm{gelu}(\mathbf{W}_{h%
}\mathbf{h}_{e}+\mathbf{b}_{h})\big{)}
\displaystyle\mathbf{m}=\mathrm{layer\_norm}\big{(}\mathrm{gelu}(\mathbf{W}_{h%
}\mathbf{h}_{e}+\mathbf{b}_{h})\big{)}
\mathbf{h}_{e}
\mathbf{T}\in\mathbb{R}^{H\times D}
\mathbf{W}_{h}\in\mathbb{R}^{D\times D}
\mathbf{b}_{o}\in\mathbb{R}^{V_{e}}
\mathbf{b}_{h}\in\mathbb{R}^{D}
\text{gelu}(\cdot)
\text{layer\_norm}(\cdot)
{}_{\text{LARGE}}
D=1024
L=64
H=256
V_{w}=50K
V_{e}=500K
\mathbf{Q}_{w2e}
\mathbf{Q}_{e2w}
\mathbf{Q}_{e2e}
\mathbf{Q}_{w2e}
\mathbf{Q}_{e2w}
\mathbf{Q}_{e2e}
\mathbf{Q}
q_{1},q_{2},...,q_{j}
p_{1},p_{2},...,p_{l}
q_{1},q_{2},...,q_{j}
p_{1},p_{2},...,p_{l}
\leq 512
\beta_{1}
\beta_{2}
\epsilon
\beta_{1}
\beta_{2}
\epsilon
\beta_{1}
\beta_{2}
\epsilon
