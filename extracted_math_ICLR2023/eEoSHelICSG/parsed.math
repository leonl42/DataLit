{\bm{x}}
{\bm{X}}
\|\cdot\|
{\bm{M}}
\|{\bm{M}}\|_{F}
{\bm{M}}
{\bm{M}}^{\intercal}
{\bm{M}}^{\dagger}
{\bm{I}}
\bm{1}
{\bm{M}}
{\bm{M}}_{+}
N
{\bm{x}}_{i}\in\mathcal{X}
i\in[N]
k:\mathcal{X}\times\mathcal{X}\to\mathbb{R}
\Phi({\bm{x}})=k({\bm{x}},\cdot)
\mathcal{H}
\langle\cdot,\cdot\rangle_{\mathcal{H}}
\|\cdot\|_{\mathcal{H}}
{\bm{K}}_{s,s}\in\mathbb{R}^{N\times N}
({\bm{K}}_{s,s})_{ij}=k({\bm{x}}_{i},{\bm{x}}_{j})
{\bm{W}}:\mathcal{H}\to\mathbb{R}^{K}
{\bm{z}}_{i}={\bm{W}}\Phi({\bm{x}}_{i})
{\bm{Z}}
\Phi({\bm{x}}_{i})
\|{\bm{W}}\|_{\mathcal{H}}=\sqrt{\sum_{i=1}^{K}\langle{\bm{W}}_{i},{\bm{W}}_{i%
}\rangle_{\mathcal{H}}^{2}}
{\bm{W}}_{i}\in\mathcal{H}
i
{\bm{W}}
k^{*}(\cdot,\cdot)
{\bm{A}}\in\{0,1\}^{N\times N}
{\bm{A}}\in\mathbb{R}^{N\times N}
{\bm{x}}_{i}
{\bm{x}}_{j}
{\bm{A}}_{ij}=1
i
j
{\bm{D}}_{{\bm{A}}}
i
i
{\bm{A}}
\displaystyle\mathcal{L}_{\rm vic}=\alpha\sum_{k=1}^{K}\max\left(0,1-\sqrt{%
\mathrm{Cov}({\bm{Z}})_{k,k}}\right)+\beta\sum_{j=1,j\not=k}^{K}\mathrm{Cov}({%
\bm{Z}})^{2}_{k,j}+\frac{\gamma}{N}\sum_{i=1}^{N}\sum_{j=1}^{N}({\bm{A}})_{i,j%
}\|{\bm{Z}}_{i,.}-{\bm{Z}}_{j,.}\|_{2}^{2}.
\displaystyle\mathcal{L}_{\rm vic}=
\displaystyle\alpha\sum_{k=1}^{K}\max\left(0,1-\sqrt{\mathrm{Cov}({\bm{Z}})_{k%
,k}}\right)+\beta\sum_{j=1,j\not=k}^{K}\mathrm{Cov}({\bm{Z}})^{2}_{k,j}+\frac{%
\gamma}{N}\sum_{i=1}^{N}\sum_{j=1}^{N}({\bm{A}})_{i,j}\|{\bm{Z}}_{i,.}-{\bm{Z}%
}_{j,.}\|_{2}^{2}.
K
K
k:\mathcal{X}\times\mathcal{X}\to\mathbb{R}
k^{*}:\mathcal{X}\times\mathcal{X}\to\mathbb{R}
{\bm{x}}
{\bm{x}}^{\prime}
k^{*}({\bm{x}},{\bm{x}}^{\prime})
{\bm{x}}
{\bm{x}}^{\prime}
{\bm{x}}
{\bm{x}}^{\prime}
{\bm{W}}^{*}:\mathcal{H}\to\mathbb{R}^{K}
k^{*}(\cdot,\cdot)
{\bm{W}}^{*}
{\bm{x}}_{1},\dots,{\bm{x}}_{N}\in\mathcal{X}
k(\cdot,\cdot)
\Phi:\mathcal{X}\to\mathcal{H}
\mathcal{H}
{\bm{W}}:\mathcal{H}\to\mathbb{R}^{K}
\mathcal{W}
\mathcal{R}({\bm{W}}\Phi({\bm{x}}_{1}),\dots,{\bm{W}}\Phi({\bm{x}}_{N}))\in%
\mathbb{R}
r:[0,\infty)\to\mathbb{R}
{\bm{W}}^{*}=\operatorname*{arg\,min}_{{\bm{W}}\in\mathcal{W}}\mathcal{R}({\bm%
{W}}\Phi({\bm{x}}_{1}),\dots,{\bm{W}}\Phi({\bm{x}}_{N}))+r\left(\|{\bm{W}}\|_{%
\mathcal{H}}\right).
\begin{split}\text{optimal representation: }&{\bm{W}}^{*}\Phi({\bm{x}})={\bm{M%
}}{\bm{k}}_{{\bm{X}},{\bm{x}}}\\
\text{induced kernel: }&k^{*}({\bm{x}},{\bm{x}}^{\prime})=\left({\bm{M}}{\bm{k%
}}_{{\bm{X}},{\bm{x}}}\right)^{\intercal}{\bm{M}}{\bm{k}}_{{\bm{X}},{\bm{x}}^{%
\prime}}={\bm{k}}_{{\bm{X}},{\bm{x}}}^{\intercal}{\bm{M}}^{\intercal}{\bm{M}}{%
\bm{k}}_{{\bm{X}},{\bm{x}}^{\prime}},\end{split}
{\bm{M}}\in\mathbb{R}^{K\times N}
{\bm{k}}_{{\bm{X}},{\bm{x}}}\in\mathbb{R}^{N}
[{\bm{k}}_{{\bm{X}},{\bm{x}}}]_{i}=k({\bm{x}}_{i},{\bm{x}})
{\bm{M}}\in\mathbb{R}^{K\times N}
\mathcal{L}_{VIC}=\left\|{\bm{Z}}^{\intercal}\left({\bm{I}}-\frac{1}{N}\bm{1}%
\bm{1}^{\intercal}\right){\bm{Z}}-{\bm{I}}\right\|_{F}^{2}+\beta\operatorname{%
Tr}\left[{\bm{Z}}^{\intercal}{\bm{L}}{\bm{Z}}\right],
\beta\in\mathbb{R}^{+}
{\bm{L}}={\bm{D}}_{{\bm{A}}}-{\bm{A}}
K\geq N
\begin{split}k^{*}({\bm{x}},{\bm{x}}^{\prime})&={\bm{k}}_{{\bm{x}},s}{\bm{K}}_%
{s,s}^{-1}\left({\bm{I}}-\frac{1}{N}\bm{1}\bm{1}^{\intercal}-\frac{\beta}{2}{%
\bm{L}}\right)_{+}{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,{\bm{x}}^{\prime}},\end{split}
(\cdot)_{+}
{\bm{k}}_{{\bm{x}},s}\in\mathbb{R}^{1\times N}
i
k({\bm{x}},{\bm{x}}_{i})
{\bm{k}}_{s,{\bm{x}}}
{\bm{K}}_{s,s}\in\mathbb{R}^{N\times N}
i,j
k({\bm{x}}_{i},{\bm{x}}_{j})
K<N
K
{\bm{I}}-\frac{1}{N}\bm{1}\bm{1}^{\intercal}-\frac{\beta}{2}{\bm{L}}
k^{*}({\bm{x}},{\bm{x}}^{\prime})={\bm{k}}_{{\bm{x}},s}{\bm{K}}_{s,s}^{-1}{\bm%
{C}}_{:,\leq K}{\bm{D}}_{\leq K,\leq K}{\bm{C}}_{:,\leq K}^{\intercal}{\bm{K}}%
_{s,s}^{-1}{\bm{k}}_{s,{\bm{x}}^{\prime}},
{\bm{C}}{\bm{D}}{\bm{C}}^{\intercal}={\bm{I}}-\frac{1}{N}\bm{1}\bm{1}^{%
\intercal}-\frac{\beta}{2}{\bm{L}}
{\bm{C}}_{:,\leq K}
K
{\bm{C}}
{\bm{D}}_{\leq K,\leq K}^{1/2}
K\times K
K
\mathcal{L}_{sc}=\left\|{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{%
\intercal}-\left({\bm{I}}+{\bm{A}}\right)\right\|_{F}^{2},
{\bm{A}}
K\geq N
k^{*}({\bm{x}},{\bm{x}}^{\prime})={\bm{k}}_{{\bm{x}},s}{\bm{K}}_{s,s}^{-1}%
\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,{\bm{x}}^{%
\prime}},
({\bm{I}}+{\bm{A}})_{+}
{\bm{I}}+{\bm{A}}
{\bm{A}}_{ij}=1
{\bm{x}}_{i}
{\bm{x}}_{j}
{\bm{I}}+{\bm{A}}
K<N
{\bm{I}}+{\bm{A}}
K
k^{*}({\bm{x}},{\bm{x}}^{\prime})={\bm{k}}_{{\bm{x}},s}{\bm{K}}_{s,s}^{-1}{\bm%
{C}}_{:,\leq K}{\bm{D}}_{\leq K,\leq K}{\bm{C}}_{:,\leq K}^{\intercal}{\bm{K}}%
_{s,s}^{-1}{\bm{k}}_{s,{\bm{x}}^{\prime}},
{\bm{C}}{\bm{D}}{\bm{C}}^{\intercal}={\bm{I}}+{\bm{A}}
{\bm{C}}_{:,\leq K}
K
{\bm{C}}
{\bm{D}}_{\leq K,\leq K}^{1/2}
K\times K
K
k^{*}({\bm{x}},{\bm{x}}^{\prime})={\bm{k}}_{{\bm{x}},s}{\bm{B}}{\bm{k}}_{s,{%
\bm{x}}^{\prime}},
{\bm{B}}\in\mathbb{R}^{N\times N}
{\bm{B}}^{*}
N
n_{\text{batches}}
b
i
j
{\bm{x}}^{(j)}_{i}
{\bm{x}}_{i}
i
{\bm{K}}_{s,s}\in\mathbb{R}^{N\times N}
[{\bm{K}}_{s,s}]_{i,j}=k({\bm{x}}_{i},{\bm{x}}_{j})
{\bm{K}}_{s,s_{j}}\in\mathbb{R}^{N\times b}
j
[{\bm{K}}_{s,s_{j}}]_{a,b}=k({\bm{x}}_{a},{\bm{x}}^{(j)}_{b})
{\bm{A}}^{(j)}
j
\mathcal{L}=\sum_{j=1}^{n_{\text{batches}}}\left\|{\bm{K}}_{s_{j},s}{\bm{B}}{%
\bm{K}}_{s,s_{j}}-\left({\bm{I}}+{\bm{A}}^{(j)}\right)\right\|_{F}^{2}+\alpha%
\operatorname{Tr}({\bm{B}}{\bm{K}}_{s,s}),
\alpha\in\mathbb{R^{+}}
\alpha\to 0
K>b
\begin{split}\min_{{\bm{B}}\in\mathbb{R}^{N\times N}}&\operatorname{Tr}({\bm{B%
}}{\bm{K}}_{s,s})\\
\text{s.t. }&{\bm{K}}_{s_{j},s}{\bm{B}}{\bm{K}}_{s,s_{j}}=\left({\bm{I}}+{\bm{%
A}}^{(j)}\right)_{+}\;\;\;\;\forall j\in\{1,2,\dots,n_{\text{batches}}\}\\
&{\bm{B}}\succeq 0,\;\operatorname{rank}({\bm{B}})=K,\end{split}
({\bm{I}}+{\bm{A}}^{(j)})_{+}
{\bm{I}}+{\bm{A}}^{(j)}
\operatorname{rank}({\bm{B}})=K
k^{*}({\bm{x}}_{i},{\bm{x}}_{j})
i
j
{\bm{A}}_{ij}=1
k^{*}({\bm{x}}_{i},{\bm{x}}_{j})=1
{\bm{A}}
1
k(\cdot,\cdot)
\Phi(\cdot)
\mathcal{H}
\{{\bm{x}}_{1},{\bm{x}}_{2},\dots\bm{x}_{N}\}
k({\bm{x}}_{i},{\bm{x}}_{i})=1
{\bm{A}}
{\bm{K}}_{s,s}
{\bm{x}}
{\bm{x}}^{\prime}
i
j
{\bm{A}}_{ij}
\|\Phi({\bm{x}})-\Phi({\bm{x}}_{i})\|_{\mathcal{H}}\leq\frac{\Delta}{5\||{\bm{%
K}}_{s,s}^{-1}\|\sqrt{N}}
\|\Phi({\bm{x}}^{\prime})-\Phi({\bm{x}}_{j})\|_{\mathcal{H}}\leq\frac{\Delta}{%
5\||{\bm{K}}_{s,s}^{-1}\|\sqrt{N}}
k^{*}({\bm{x}},{\bm{x}}^{\prime})\geq 1-\Delta
N
\|{\bm{K}}_{s,s}^{-1}\|
2
k^{*}({\bm{x}},\cdot)={\bm{M}}{\bm{k}}_{s,{\bm{x}}}
N_{t}
\{{\bm{x}}^{(t)}_{i},y_{i}\}
k^{*}(\cdot,\cdot)
f^{*}({\bm{x}})=\left[k^{*}({\bm{x}},{\bm{x}}^{(t)}_{1}),k^{*}({\bm{x}},{\bm{x%
}}^{(t)}_{2}),\dots,k^{*}({\bm{x}},{\bm{x}}^{(t)}_{N_{t}})\right]\cdot{\bm{K}}%
_{t,t}^{*-1}{\bm{y}},
{\bm{K}}_{t,t}^{*-1}
i,j
k^{*}({\bm{x}}^{(t)}_{i},{\bm{x}}^{(t)}_{j})
{\bm{y}}
s_{N}({\bm{K}})
s_{N}({\bm{K}})=\frac{\operatorname{Tr}({\bm{K}})}{N}{\bm{y}}^{\intercal}{\bm{%
K}}^{-1}{\bm{y}},
{\bm{y}}
{\bm{K}}
O(\sqrt{s_{N}({\bm{K}})/N})
k(\cdot,\cdot)
0
1
s_{N}({\bm{K}})
k({\bm{x}},{\bm{x}}^{\prime})=1
{\bm{x}},{\bm{x}}^{\prime}
k({\bm{x}},{\bm{x}}^{\prime})=0
{\bm{x}},{\bm{x}}^{\prime}
s_{N}({\bm{K}}^{*})
N
m_{-1}
m_{+1}
-1
+1
{\bm{K}}^{*}
k^{*}({\bm{x}},{\bm{x}}^{\prime})=1
{\bm{x}},{\bm{x}}^{\prime}
k^{*}({\bm{x}},{\bm{x}}^{\prime})=0
s_{N}({\bm{K}}^{*})=m_{-1}+m_{+1}=O(1)
s_{N}({\bm{K}})
N\in\{16,64,256\}
\ell_{2}
0.001
50k
N
N\in\{16,64,256\}
\ell_{2}
0.001
50k
N
{\bm{L}}
k(x_{1},x_{2})>d
{\bm{L}}_{ij}=-1
k(x_{i},x_{j})>d
{\bm{L}}_{ij}=0
{\bm{L}}
x
\beta=0.4
d
d
100
100
10,000
100
\ell_{2}
K
\beta
K
K
\ell_{2}
\beta
100
100
10,000
100
\ell_{2}
K
\beta
K
K
\ell_{2}
\beta
28\times 28
N=16
N=256
50,000
K
\ell_{2}
\beta
\beta
K
K
\ell_{2}
{\bm{x}}_{i}\in\mathcal{X}
i\in[N]
N
k:\mathcal{X}\times\mathcal{X}\to\mathbb{R}
\Phi:\mathcal{X}\to\mathcal{H}
\mathcal{H}
r:[0,\infty)\to\mathbb{R}
{\bm{W}}:\mathcal{H}\to\mathbb{R}^{K}
\mathcal{R}\left({\bm{W}}\Phi({\bm{x}}_{1}),\dots,{\bm{W}}\Phi({\bm{x}}_{N})%
\right)+r\left(\|{\bm{W}}\|_{\mathcal{H}}\right),
\mathcal{R}({\bm{W}}\Phi({\bm{x}}_{1}),\dots,{\bm{W}}\Phi({\bm{x}}_{N}))
{\bm{W}}^{*}
\{\Phi({\bm{x}}_{i}),\;i\in\{1,\dots,N\}\}
\bm{\phi}\in\mathcal{H}
{\bm{W}}^{*}\bm{\phi}=\bm{0}\;\text{ if }\;\langle\bm{\phi},\Phi({\bm{x}}_{i})%
\rangle_{\mathcal{H}}=0\;\;\forall i\in[N].
{\bm{W}}={\bm{W}}_{\parallel}+{\bm{W}}_{\bot}
{\bm{W}}_{\bot}\Phi({\bm{x}}_{i})=\bm{0}
i\in[N]
\mathcal{L}
\begin{split}\mathcal{L}({\bm{W}}_{\parallel}+{\bm{W}}_{\bot})&=\mathcal{R}%
\left(({\bm{W}}_{\parallel}+{\bm{W}}_{\bot})\Phi({\bm{x}}_{1}),\dots,({\bm{W}}%
_{\parallel}+{\bm{W}}_{\bot})\Phi({\bm{x}}_{N})\right)+r\left(\|{\bm{W}}_{%
\parallel}+{\bm{W}}_{\bot}\|_{\mathcal{H}}\right)\\
&=\mathcal{R}\left({\bm{W}}_{\parallel}\Phi({\bm{x}}_{1}),\dots,{\bm{W}}_{%
\parallel}\Phi({\bm{x}}_{N})\right)+r\left(\|{\bm{W}}_{\parallel}+{\bm{W}}_{%
\bot}\|_{\mathcal{H}}\right).\end{split}
{\bm{W}}_{\bot}
\begin{split}r(\|{\bm{W}}_{\parallel}+{\bm{W}}_{\bot}\|_{\mathcal{H}})&=r\left%
(\sqrt{\|{\bm{W}}_{\parallel}\|_{\mathcal{H}}^{2}+\|{\bm{W}}_{\bot}\|_{%
\mathcal{H}}^{2}}\right)\\
&\geq r(\|{\bm{W}}_{\parallel}\|_{\mathcal{H}}).\end{split}
{\bm{W}}^{\bot}=0
{\bm{M}}:={\bm{I}}-\frac{1}{N}\bm{1}\bm{1}^{\intercal}
{\bm{X}}\in\mathbb{R}^{N\times D}
i
\Phi({\bm{x}}_{i})
{\bm{X}}=\begin{bmatrix}\text{---}&\Phi({\bm{x}}_{1})^{\intercal}&\text{---}\\
\text{---}&\Phi({\bm{x}}_{2})^{\intercal}&\text{---}\\
&\vdots&\\
\text{---}&\Phi({\bm{x}}_{N})^{\intercal}&\text{---}\end{bmatrix}
C^{*}=\min_{{\bm{W}}\in\mathbb{R}^{K\times D}}\left\|{\bm{W}}{\bm{X}}^{%
\intercal}{\bm{M}}{\bm{X}}{\bm{W}}^{\intercal}-{\bm{I}}\right\|_{F}^{2}+\beta%
\operatorname{Tr}\left[{\bm{W}}{\bm{X}}^{\intercal}{\bm{L}}{\bm{X}}{\bm{W}}^{%
\intercal}\right].
\begin{split}C({\bm{W}})&=\left\|{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}{\bm{X}}{%
\bm{W}}^{\intercal}-{\bm{I}}\right\|_{F}^{2}+\beta\operatorname{Tr}\left[{\bm{%
W}}{\bm{X}}^{\intercal}{\bm{L}}{\bm{X}}{\bm{W}}^{\intercal}\right]\\
&=\left\|{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}{\bm{X}}{\bm{W}}^{\intercal}-{\bm%
{I}}\right\|_{F}^{2}+\operatorname{Tr}\left[{\bm{W}}{\bm{X}}^{\intercal}\left(%
\beta{\bm{L}}+2{\bm{M}}-2{\bm{M}}\right){\bm{X}}{\bm{W}}^{\intercal}\right]\\
&=K+\|{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}{\bm{X}}{\bm{W}}^{\intercal}\|_{F}^{%
2}-2\operatorname{Tr}\left[{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}{\bm{X}}{\bm{W}%
}^{\intercal}\right]\\
&\;\;\;\;+\operatorname{Tr}\left[{\bm{W}}{\bm{X}}^{\intercal}\left(\beta{\bm{L%
}}+2{\bm{M}}-2{\bm{M}}\right){\bm{X}}{\bm{W}}^{\intercal}\right]\\
&=K+\|{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}{\bm{X}}{\bm{W}}^{\intercal}\|_{F}^{%
2}-\operatorname{Tr}\left[{\bm{W}}{\bm{X}}^{\intercal}\left(2{\bm{M}}-\beta{%
\bm{L}}\right){\bm{X}}{\bm{W}}^{\intercal}\right]\\
&=K+\|{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}\|_{F}^{%
2}-\operatorname{Tr}\left[{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{%
\intercal}{\bm{M}}\left(2{\bm{M}}-\beta{\bm{L}}\right)\right].\end{split}
C^{\prime}({\bm{W}})
C^{\prime}({\bm{W}})=\|{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal%
}{\bm{M}}-\left({\bm{M}}-\beta{\bm{L}}/2\right)\|_{F}^{2}.
{\bm{M}}
{\bm{M}}(2{\bm{M}}-\beta{\bm{L}})=2{\bm{M}}-\beta{\bm{L}}
{\bm{L}}
K
{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}
K
{\bm{M}}-\beta{\bm{L}}/2
{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}{\bm{X}}{\bm{W}}^{\intercal}
{\bm{W}}^{*}
{\bm{W}}^{*}=\left[{\bm{X}}^{(s)^{+}}{\bm{C}}_{:,\leq K}\left({\bm{I}}-{\bm{D}%
}\right)_{\leq K,\leq K}^{1/2}\right]^{\intercal},
\frac{1}{N}\bm{1}\bm{1}^{\intercal}+\frac{\beta}{2}{\bm{L}}
{\bm{C}}{\bm{D}}{\bm{C}}^{\intercal}=\frac{1}{N}\bm{1}\bm{1}^{\intercal}+\frac%
{\beta}{2}{\bm{L}}
{\bm{C}}_{:,\leq K}
K
{\bm{C}}
\left({\bm{I}}-{\bm{D}}\right)_{\leq K,\leq K}^{1/2}
K\times K
\left({\bm{I}}-{\bm{D}}\right)
{\bm{X}}^{(s)^{+}}
{\bm{X}}
{\bm{I}}-{\bm{D}}
\beta
\left({\bm{I}}-{\bm{D}}\right)^{1/2}
\beta
{\bm{W}}
{\bm{W}}^{\intercal}{\bm{W}}
{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal}{\bm{M}}
N-1
N
{\bm{W}}^{*}
\begin{split}k^{*}({\bm{x}},{\bm{x}}^{\prime})&:=({\bm{W}}^{*}{\bm{x}})^{%
\intercal}({\bm{W}}^{*}{\bm{x}}^{\prime})\\
&={\bm{x}}^{\intercal}{\bm{X}}^{(s)^{+}}{\bm{C}}_{:,\leq K}\left({\bm{I}}-{\bm%
{D}}\right)_{\leq K,\leq K}^{1/2}\left({\bm{I}}-{\bm{D}}\right)_{\leq K,\leq K%
}^{1/2}{\bm{C}}_{:,\leq K}^{\intercal}\left({\bm{X}}^{(s)^{+}}\right)^{%
\intercal}{\bm{x}}^{\prime}\\
&={\bm{k}}_{{\bm{x}},s}{\bm{K}}_{s,s}^{-1}{\bm{C}}_{:,\leq K}\left({\bm{I}}-{%
\bm{D}}\right)_{\leq K,\leq K}{\bm{C}}_{:,\leq K}^{\intercal}{\bm{K}}_{s,s}^{-%
1}{\bm{k}}_{s,{\bm{x}}^{\prime}}.\end{split}
{\bm{W}}^{*}
{\bm{W}}^{\intercal}{\bm{W}}
\begin{split}\min_{{\bm{B}}\in\mathbb{R}^{D\times D}}&\operatorname{Tr}({\bm{B%
}})\\
\text{s.t. }&{\bm{X}}{\bm{B}}{\bm{X}}^{\intercal}{\bm{M}}={\bm{C}}_{:,\leq K}%
\left({\bm{I}}-{\bm{D}}\right)_{\leq K,\leq K}^{1/2}{\bm{C}}_{:,\leq K}^{%
\intercal}:={\bm{P}}_{K}\\
&{\bm{B}}\succeq 0\end{split}
{\bm{P}}_{K}={\bm{C}}_{:,\leq K}\left({\bm{I}}-{\bm{D}}\right)_{\leq K,\leq K}%
^{1/2}{\bm{C}}_{:,\leq K}^{\intercal}
{\bm{X}}
{\bm{X}}
{\bm{B}}={\bm{W}}^{\intercal}{\bm{W}}
\begin{split}\max_{{\bm{Y}}\in\mathbb{R}^{N\times N}}&\operatorname{Tr}({\bm{Y%
}}^{\intercal}{\bm{P}}_{K})\\
\text{s.t. }&{\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}{\bm{M}}{\bm{X}}\succeq 0%
\end{split}
{\bm{W}}^{*}
{\bm{B}}^{*}=\left({\bm{W}}^{*}\right)^{\intercal}{\bm{W}}^{*}={\bm{X}}^{+}{%
\bm{P}}_{K}\left({\bm{X}}^{+}\right)^{\intercal}
{\bm{Y}}^{*}=\left({\bm{X}}^{+}\right)^{\intercal}{\bm{X}}^{+}
\begin{split}\text{Primal feasibility: }&{\bm{X}}{\bm{B}}^{*}{\bm{X}}^{%
\intercal}{\bm{M}}={\bm{P}}_{K},\;\;{\bm{B}}^{*}\succeq 0\\
\text{Dual feasibility: }&{\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}^{*}{\bm{M}}{%
\bm{X}}\succeq 0\\
\text{Complementary slackness: }&\left({\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}^{%
*}{\bm{M}}{\bm{X}}\right){\bm{B}}^{*}=0.\end{split}
\begin{split}\left({\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}^{*}{\bm{M}}{\bm{X}}%
\right){\bm{B}}^{*}&={\bm{X}}^{+}{\bm{L}}_{K}\left({\bm{X}}^{+}\right)^{%
\intercal}-{\bm{X}}^{\intercal}\left({\bm{X}}^{+}\right)^{\intercal}{\bm{X}}^{%
+}{\bm{M}}{\bm{X}}{\bm{X}}^{+}{\bm{L}}_{K}\left({\bm{X}}^{+}\right)^{\intercal%
}\\
&={\bm{X}}^{+}{\bm{L}}_{K}\left({\bm{X}}^{+}\right)^{\intercal}-{\bm{X}}^{+}{%
\bm{M}}{\bm{L}}_{K}\left({\bm{X}}^{+}\right)^{\intercal}\\
&={\bm{X}}^{+}{\bm{L}}_{K}\left({\bm{X}}^{+}\right)^{\intercal}-{\bm{X}}^{+}{%
\bm{L}}_{K}\left({\bm{X}}^{+}\right)^{\intercal}\\
&=0.\end{split}
{\bm{M}}{\bm{L}}_{K}={\bm{L}}_{K}
{\bm{M}}
{\bm{L}}_{K}
\left\|{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal}-\left({\bm{I}}%
+{\bm{A}}\right)\right\|_{F}^{2}
{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal}
{\bm{X}}{\bm{W}}^{\intercal}{\bm{W}}{\bm{X}}^{\intercal}
\left({\bm{I}}+{\bm{A}}\right)
\left({\bm{I}}+{\bm{A}}\right)_{+}
{\bm{A}}
{\bm{v}}_{i}
e_{i}
\left({\bm{I}}+{\bm{A}}\right)_{+}=\sum_{i:e_{i}\geq-1}(e_{i}+1){\bm{v}}_{i}{%
\bm{v}}_{i}^{\dagger}
K<N
\left({\bm{I}}+{\bm{A}}\right)_{+}=\sum_{i=1}^{K}\max(e_{i}+1,0){\bm{v}}_{i}{%
\bm{v}}_{i}^{\dagger},
e_{i}
\begin{split}\min_{{\bm{B}}\in\mathbb{R}^{D\times D}}&\operatorname{Tr}({\bm{B%
}})\\
\text{s.t. }&{\bm{X}}{\bm{B}}{\bm{X}}^{\intercal}=\left({\bm{I}}+{\bm{A}}%
\right)_{+}\\
&{\bm{B}}\succeq 0\end{split}
\begin{split}\max_{{\bm{Y}}\in\mathbb{R}^{N\times N}}&\operatorname{Tr}\left({%
\bm{Y}}^{\intercal}({\bm{I}}+{\bm{A}})_{+}\right)\\
\text{s.t. }&{\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}{\bm{X}}\succeq 0\end{split}
{\bm{B}}^{*}={\bm{X}}^{+}({\bm{I}}+{\bm{A}})_{+}\left({\bm{X}}^{+}\right)^{\intercal}
{\bm{Y}}^{*}=\left({\bm{X}}^{+}\right)^{\intercal}{\bm{X}}^{+}
\begin{split}\text{Primal feasibility: }&{\bm{X}}{\bm{B}}^{*}{\bm{X}}^{%
\intercal}=\left({\bm{I}}+{\bm{A}}\right)_{+},\;\;{\bm{B}}^{*}\succeq 0\\
\text{Dual feasibility: }&{\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}^{*}{\bm{X}}%
\succeq 0\\
\text{Complementary slackness: }&\left({\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}^{%
*}{\bm{X}}\right){\bm{B}}^{*}=0.\end{split}
\begin{split}\left({\bm{I}}-{\bm{X}}^{\intercal}{\bm{Y}}^{*}{\bm{X}}\right){%
\bm{B}}^{*}&={\bm{X}}^{+}({\bm{I}}+{\bm{A}})_{+}\left({\bm{X}}^{+}\right)^{%
\intercal}-{\bm{X}}^{\intercal}\left({\bm{X}}^{+}\right)^{\intercal}{\bm{X}}^{%
+}{\bm{X}}{\bm{X}}^{+}({\bm{I}}+{\bm{A}})_{+}\left({\bm{X}}^{+}\right)^{%
\intercal}\\
&={\bm{X}}^{+}({\bm{I}}+{\bm{A}})_{+}\left({\bm{X}}^{+}\right)^{\intercal}-{%
\bm{X}}^{+}({\bm{I}}+{\bm{A}})_{+}\left({\bm{X}}^{+}\right)^{\intercal}\\
&=0.\end{split}
{\bm{X}}^{+}{\bm{X}}
{\bm{X}}
k^{*}({\bm{x}},{\bm{x}}^{\prime})
k^{*}({\bm{x}},{\bm{x}}^{\prime})={\bm{k}}_{{\bm{x}},s}{\bm{B}}{\bm{k}}_{{\bm{%
x}}^{\prime},s}^{\intercal},
{\bm{k}}_{{\bm{x}},s}
i
k({\bm{x}},{\bm{x}}_{i})
{\bm{x}}
i
{\bm{B}}\in\mathbb{R}^{N\times N}
n_{\text{batches}}
N
b
i
k
{\bm{x}}^{(k)}_{i}
{\bm{x}}_{i}
i
{\bm{K}}_{s,s}\in\mathbb{R}^{N\times N}
[{\bm{K}}_{s,s}]_{i,j}=k({\bm{x}}_{i},{\bm{x}}_{j})
{\bm{K}}_{s,s_{k}}\in\mathbb{R}^{N\times b}
[{\bm{K}}_{s,s_{k}}]_{i,j}=k({\bm{x}}_{i},{\bm{x}}^{(k)}_{j})
{\bm{K}}_{s_{k},s}\in\mathbb{R}^{b\times N}
{\bm{K}}_{s,s_{k}}
{\bm{A}}^{(k)}
k
{\bm{L}}^{(k)}
K
{\bm{B}}
\mathcal{L}=\sum_{j=1}^{n_{\text{batches}}}\left\|{\bm{K}}_{s_{j},s}{\bm{B}}{%
\bm{K}}_{s,s_{j}}\left({\bm{I}}-\frac{1}{b}\bm{1}\bm{1}^{\intercal}\right)-%
\left({\bm{I}}-\frac{1}{b}\bm{1}\bm{1}^{\intercal}-\beta{\bm{L}}^{(j)}/2\right%
)\right\|_{F}^{2}+\alpha\operatorname{Tr}({\bm{B}}{\bm{K}}_{s,s}),
\alpha\in\mathbb{R}^{+}
\operatorname{Tr}({\bm{B}}{\bm{K}}_{s,s})
{\bm{B}}
{\bm{M}}={\bm{I}}-\frac{1}{b}\bm{1}\bm{1}^{\intercal}
\alpha\to 0
K
{\bm{K}}_{s_{j},s}{\bm{B}}{\bm{K}}_{s,s_{j}}{\bm{M}}=\left({\bm{M}}-\beta{\bm{%
L}}^{(j)}/2\right)_{K},
\left({\bm{M}}-\beta{\bm{L}}^{(j)}/2\right)_{K}
{\bm{M}}-\beta{\bm{L}}^{(j)}/2
K
\begin{split}\min_{{\bm{B}}\in\mathbb{R}^{N\times N}}&\operatorname{Tr}({\bm{B%
}}{\bm{K}}_{s,s})\\
\text{s.t. }&{\bm{K}}_{s_{i},s}{\bm{B}}{\bm{K}}_{s,s_{i}}{\bm{M}}=\left({\bm{M%
}}-\beta{\bm{L}}^{(j)}/2\right)_{K}\;\;\;\;\forall i\in\{1,2,\dots,n_{\text{%
batches}}\}\\
&{\bm{B}}\succeq 0,\;\operatorname{rank}({\bm{B}})=K,\end{split}
\operatorname{rank}({\bm{B}})=K
\mathcal{L}=\sum_{j=1}^{n_{\text{batches}}}\left\|{\bm{K}}_{s_{j},s}{\bm{B}}{%
\bm{K}}_{s,s_{j}}-\left({\bm{I}}+{\bm{A}}^{(j)}\right)\right\|_{F}^{2}+\alpha%
\operatorname{Tr}({\bm{B}}{\bm{K}}_{s},s)
\alpha\in\mathbb{R^{+}}
K
{\bm{K}}_{s_{j},s}{\bm{B}}{\bm{K}}_{s,s_{j}}-\left({\bm{I}}+{\bm{A}}^{(j)}%
\right)_{K},
\left({\bm{I}}+{\bm{A}}^{(j)}\right)_{K}
{\bm{I}}+{\bm{A}}^{(j)}
K
\alpha\to 0
\begin{split}\min_{{\bm{B}}\in\mathbb{R}^{N\times N}}&\operatorname{Tr}({\bm{B%
}}{\bm{K}}_{s,s})\\
\text{s.t. }&{\bm{K}}_{s_{i},s}{\bm{B}}{\bm{K}}_{s,s_{i}}=\left({\bm{I}}+{\bm{%
A}}^{(i)}\right)_{K}\;\;\;\;\forall i\in\{1,2,\dots,n_{\text{batches}}\}\\
&{\bm{B}}\succeq 0,\;\operatorname{rank}({\bm{B}})=K.\end{split}
{\bm{A}}
{\bm{A}}=\begin{bmatrix}0&1&&&&&\\
1&0&&&&&\\
&&0&1&&&\\
&&1&0&&&\\
&&&&\ddots&&\\
&&&&&0&1\\
&&&&&1&0\end{bmatrix}.
\|{\bm{k}}_{s,{\bm{x}}_{a}}-{\bm{k}}_{s,{\bm{x}}_{b}}\|
\|\Phi({\bm{x}}_{a})-\Phi({\bm{x}}_{b})\|
k(\cdot,\cdot)
\Phi(\cdot)
\mathcal{H}
\{{\bm{x}}_{i}\}_{i=1}^{N}
k({\bm{x}}_{i},{\bm{x}}_{i})=1
{\bm{K}}_{s,s}
\|\Phi({\bm{x}}_{a})-\Phi({\bm{x}}_{b})\|_{\mathcal{H}}\leq\epsilon
\left\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,{\bm{x}}_{a}}-{\bm{K}}_{s,s}^{-1}{\bm{k}%
}_{s,{\bm{x}}_{a}}\right\|\leq\|{\bm{K}}_{s,s}^{-1}\|\sqrt{N}\epsilon
\begin{split}\left\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,{\bm{x}}_{a}}-{\bm{K}}_{s,s%
}^{-1}{\bm{k}}_{s,{\bm{x}}_{a}}\right\|&\leq\left\|{\bm{K}}_{s,s}^{-1}\right\|%
\left\|{\bm{k}}_{s,{\bm{x}}_{a}}-{\bm{k}}_{s,{\bm{x}}_{a}}\right\|\\
&=\left\|{\bm{K}}_{s,s}^{-1}\right\|\left[\sum_{i=1}^{N}(\langle\Phi({\bm{x}}_%
{i}),\Phi({\bm{x}}_{a})\rangle_{\mathcal{H}}-\langle\Phi({\bm{x}}_{i}),\Phi({%
\bm{x}}_{b})\rangle_{\mathcal{H}})^{2}\right]^{1/2}\\
&=\left\|{\bm{K}}_{s,s}^{-1}\right\|\left[\sum_{i=1}^{N}(\langle\Phi({\bm{x}}_%
{i}),\Phi({\bm{x}}_{a})-\Phi({\bm{x}}_{b})\rangle_{\mathcal{H}})^{2}\right]^{1%
/2}\\
&\leq\left\|{\bm{K}}_{s,s}^{-1}\right\|\left[\sum_{i=1}^{N}\|\Phi({\bm{x}}_{i}%
)\|_{\mathcal{H}}^{2}\|\Phi({\bm{x}}_{a})-\Phi({\bm{x}}_{b})\|_{\mathcal{H}}^{%
2}\right]^{1/2}\\
&=\left\|{\bm{K}}_{s,s}^{-1}\right\|\sqrt{N}\epsilon\end{split}
{\bm{K}}_{s,s}^{-1}{\bm{x}}_{i}={\bm{e}}_{i}
{\bm{e}}_{i}
1
i
\begin{split}k^{*}({\bm{x}},{\bm{x}}^{\prime})&={\bm{k}}_{{\bm{x}},s}{\bm{K}}_%
{s,s}^{-1}\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,{%
\bm{x}}^{\prime}}\\
&=({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i}+{\bm{e}}_{i})^{\intercal}%
\left({\bm{I}}+{\bm{A}}\right)_{+}({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x^{\prime}}-%
{\bm{e}}_{j}+{\bm{e}}_{j})\\
&={\bm{e}}_{i}^{\intercal}\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_{j}+({\bm%
{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i})^{\intercal}\left({\bm{I}}+{\bm{A}}%
\right)_{+}{\bm{e}}_{j}+{\bm{e}}_{i}^{\intercal}\left({\bm{I}}+{\bm{A}}\right)%
_{+}({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x^{\prime}}-{\bm{e}}_{j})\\
&\;\;\;\;\;+({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i})^{\intercal}\left(%
{\bm{I}}+{\bm{A}}\right)_{+}({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x^{\prime}}-{\bm{e%
}}_{j}).\end{split}
{\bm{e}}_{i}^{\intercal}\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_{j}=1
{\bm{A}}_{ij}=1
\begin{split}k^{*}({\bm{x}},{\bm{x}}^{\prime})&=1+({\bm{K}}_{s,s}^{-1}{\bm{k}}%
_{s,x}-{\bm{e}}_{i})^{\intercal}\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_{j}%
+{\bm{e}}_{i}^{\intercal}\left({\bm{I}}+{\bm{A}}\right)_{+}({\bm{K}}_{s,s}^{-1%
}{\bm{k}}_{s,x^{\prime}}-{\bm{e}}_{j})\\
&\;\;\;\;\;+({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i})^{\intercal}\left(%
{\bm{I}}+{\bm{A}}\right)_{+}({\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x^{\prime}}-{\bm{e%
}}_{j})\\
&\geq 1-\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i}\|\left\|\left({\bm{I}%
}+{\bm{A}}\right)_{+}{\bm{e}}_{j}\right\|+\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x^{%
\prime}}-{\bm{e}}_{j}\|\left\|\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_{i}%
\right\|\\
&\;\;\;\;\;+\left\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i}\right\|\left%
\|\left({\bm{I}}+{\bm{A}}\right)_{+}\right\|\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x%
^{\prime}}-{\bm{e}}_{j}\|.\\
\end{split}
\|\Phi({\bm{x}})-\Phi({\bm{x}}_{i})\|\leq\epsilon=\frac{\Delta}{5\||{\bm{K}}_{%
s,s}^{-1}\|\sqrt{N}}
\|\Phi({\bm{x}}^{\prime})-\Phi({\bm{x}}_{j})\|\leq\epsilon=\frac{\Delta}{5\||{%
\bm{K}}_{s,s}^{-1}\|\sqrt{N}}
\begin{split}k^{*}({\bm{x}},{\bm{x}}^{\prime})&\geq 1-\|{\bm{K}}_{s,s}^{-1}{%
\bm{k}}_{s,x}-{\bm{e}}_{i}\|\left\|\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_%
{j}\right\|+\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x^{\prime}}-{\bm{e}}_{j}\|\left\|%
\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_{i}\right\|\\
&\;\;\;\;\;+\left\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x}-{\bm{e}}_{i}\right\|\left%
\|\left({\bm{I}}+{\bm{A}}\right)_{+}\right\|\|{\bm{K}}_{s,s}^{-1}{\bm{k}}_{s,x%
^{\prime}}-{\bm{e}}_{j}\|\\
&\geq 1-2\sqrt{2}\|{\bm{K}}_{s,s}^{-1}\|\sqrt{N}\epsilon-2\|{\bm{K}}_{s,s}^{-1%
}\|^{2}N\epsilon^{2}\\
&\geq 1-(2\sqrt{2}+2)\|{\bm{K}}_{s,s}^{-1}\|\sqrt{N}\epsilon\\
&\geq 1-5\|{\bm{K}}_{s,s}^{-1}\|\sqrt{N}\epsilon\\
&=1-\Delta.\end{split}
{\bm{A}}
\left\|\left({\bm{I}}+{\bm{A}}\right)_{+}{\bm{e}}_{i}\right\|=\sqrt{2}
\left\|\left({\bm{I}}+{\bm{A}}\right)_{+}\right\|=2
m_{+1}
m_{-1}
\{1,2,\dots,m_{+1}
m_{-1}\}
\#(i)
i
{\bm{K}}^{*}
m_{+1}+m_{-1}
i
\frac{1}{\#(i)}\bm{1}_{\#(i)}\bm{1}_{\#(i)}^{\intercal}
\bm{1}_{k}
k
{\bm{K}}^{*}
\begin{bmatrix}\frac{1}{\#(1)}\bm{1}_{\#(1)}\bm{1}_{\#(1)}^{\intercal}&&&\\
&\frac{1}{\#(2)}\bm{1}_{\#(2)}\bm{1}_{\#(2)}^{\intercal}&&\\
&&\ddots&\\
&&&\frac{1}{\#(m_{+1}+m_{-1})}\bm{1}_{\#(m_{+1}+m_{-1})}\bm{1}_{\#(m_{+1}+m_{-%
1})}^{\intercal}\\
\end{bmatrix}.
1
{\bm{y}}_{m_{i}}\in\mathbb{R}^{\#(i)}
i
\begin{split}{\bm{y}}^{\intercal}({\bm{K}}^{*})^{-1}{\bm{y}}&=\sum_{i=1}^{m_{+%
1}+m_{-1}}\#(i)^{-1}\left(\langle\bm{1}_{\#(i)},{\bm{y}}_{m_{i}}\rangle\right)%
^{2}\\
&=\sum_{i=1}^{m_{+1}+m_{-1}}\#(i)^{-1}(\sqrt{\#(i)})^{2}\\
&=m_{+1}+m_{-1}.\end{split}
{\bm{w}}
\ell(y,y^{\prime})=|\min(1,\max(-1,y))-y^{\prime}|
y^{\prime}
\{-1,1\}
y
y=\langle{\bm{w}},{\bm{x}}\rangle
{\bm{x}}
{\bm{w}}
{\bm{w}}=\sum_{i=1}^{N_{t}}\left[{\bm{K}}_{t,t}^{*-1}{\bm{y}}\right]_{i}\phi%
\left({\bm{x}}_{i}^{(t)}\right),
\phi({\bm{x}}_{i}^{(t)})
{\bm{x}}_{i}^{(t)}
\|{\bm{w}}\|=\sqrt{{\bm{y}}^{\intercal}{\bm{K}}_{t,t}^{*-1}{\bm{y}}}.
\mathcal{X}
\mathcal{Y}
\mathcal{D}
\mathcal{X}\times\mathcal{Y}
{\bm{x}}_{1},\dots,{\bm{x}}_{N}
y_{1},\dots,y_{N_{t}}
{\bm{y}}
y_{i}
N
\mathcal{D}
{\bm{w}}=\sqrt{\frac{\operatorname{Tr}({\bm{K}})}{N}}\sum_{i=1}^{N_{t}}\left[{%
\bm{K}}^{-1}{\bm{y}}\right]_{i}\phi\left({\bm{x}}_{i}^{(t)}\right)
L
\ell:\mathcal{Y}\times\mathcal{Y}\to[0,b]
1-\delta
\delta>0
\mathbb{E}_{{\bm{x}},y\sim\mathcal{D}}\left[\ell(\langle{\bm{w}},{\bm{x}}%
\rangle,y)\right]-\frac{1}{N_{t}}\sum_{i=1}^{N_{t}}\ell(\langle{\bm{w}},{\bm{x%
}}_{i}\rangle,y_{i})\leq\frac{2\sqrt{2}L+3b}{\sqrt{2}}\frac{\sqrt{%
\operatorname{\operatorname{Tr}}({\bm{K}}){\bm{y}}^{\intercal}{\bm{K}}^{-1}{%
\bm{y}}}}{N}+3b\sqrt{\frac{\log(2/(\delta(e-1)))}{2N}}
G
Z
[0,1]
N
z_{1},\dots,z_{n}
Z
\delta>0
1-\delta
\mathbb{E}_{z}[g(z)]-\frac{1}{N}\sum_{i=1}^{N}g(z_{i})\leq 2\widehat{\mathfrak%
{R}}_{S}(G)+3\sqrt{\frac{\log(2/\delta)}{2N}},
\widehat{\mathfrak{R}}_{S}(G)
G
\widehat{\mathfrak{R}}_{S}(G)=\mathbb{E}_{\sigma}\left[\sup_{g\in G}\frac{1}{N%
}\sum_{i=1}^{N}\sigma_{i}g(z_{i})\right],
\sigma_{i}
\{-1,+1\}
\Phi:\mathbb{R}\to\mathbb{R}
L
G
\widehat{\mathfrak{R}}_{S}(\Phi\circ G)\leq L\widehat{\mathfrak{R}}_{S}(G).
G_{\gamma}
G_{\gamma}=\{\langle{\bm{w}},\cdot\rangle:\|{\bm{w}}\|^{2}\leq\gamma\}
{\bm{x}}_{1},\dots,{\bm{x}}_{N}
y_{1},\dots,y_{N}
\epsilon_{{\bm{w}}}({\bm{x}}_{i})=\ell(\langle{\bm{w}},{\bm{x}}\rangle,y_{i})%
\in[0,b]
G_{\gamma}
\gamma\in\{1,2,3,\dots\}
\|{\bm{w}}\|
\ell
[0,b]
1/b
[0,1]
\epsilon_{{\bm{w}}}({\bm{x}}_{i})
G_{\gamma}
\gamma\in\{1,2,3,\dots\}
\delta_{\gamma}=\delta(e-1)e^{-\gamma}
\mathbb{E}_{{\bm{x}}}[\epsilon_{{\bm{w}}}({\bm{x}})]-\frac{1}{N}\sum_{i=1}^{N}%
\epsilon_{{\bm{w}}}({\bm{x}}_{i})\leq 2\mathbb{E}_{\sigma}\left[\sup_{\|{\bm{v%
}}\|^{2}\leq\gamma}\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}\epsilon_{{\bm{v}}}({\bm%
{x}}_{i})\right]+3b\sqrt{\frac{\log(2/(\delta(e-1)))+\gamma}{2N}}.
\gamma
1-\delta(e-1)e^{-\gamma}
\gamma
1-\sum_{\gamma=1}^{\infty}\delta_{\gamma}=1-\sum_{\gamma=1}^{\infty}\delta(e-1%
)e^{-\gamma}=1-\delta
\gamma=\lceil\|{\bm{w}}\|^{2}\rceil
\mathbb{E}_{{\bm{x}}}[\epsilon_{{\bm{w}}}({\bm{x}})]-\frac{1}{N}\sum_{i=1}^{N}%
\epsilon_{{\bm{w}}}({\bm{x}}_{i})\leq 2\mathbb{E}_{\sigma}\left[\sup_{\|{\bm{v%
}}\|^{2}\leq\lceil\|{\bm{w}}\|^{2}\rceil}\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}%
\epsilon_{{\bm{v}}}({\bm{x}}_{i})\right]+3b\sqrt{\frac{\log(2/(\delta(e-1)))+%
\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}.
\begin{split}\mathbb{E}_{{\bm{x}}}[\epsilon_{{\bm{w}}}({\bm{x}})]-\frac{1}{N}%
\sum_{i=1}^{N}\epsilon_{{\bm{w}}}({\bm{x}}_{i})&\leq 2\mathbb{E}_{\sigma}\left%
[\sup_{\|{\bm{v}}\|^{2}\leq\lceil\|{\bm{w}}\|^{2}\rceil}\frac{1}{N}\sum_{i=1}^%
{N}\sigma_{i}\epsilon_{{\bm{v}}}({\bm{x}}_{i})\right]+3b\sqrt{\frac{\log(2/(%
\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}\\
&\leq 2L\mathbb{E}_{\sigma}\left[\sup_{\|{\bm{v}}\|^{2}\leq\lceil\|{\bm{w}}\|^%
{2}\rceil}\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}\langle{\bm{v}},{\bm{x}}_{i}%
\rangle\right]+3b\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}%
\rceil}{2N}}\\
&\leq 2L\mathbb{E}_{\sigma}\left[\sup_{\|{\bm{v}}\|^{2}\leq\lceil\|{\bm{w}}\|^%
{2}\rceil}\|{\bm{v}}\|\left\|\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}{\bm{x}}_{i}%
\right\|\right]+3b\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}%
\rceil}{2N}}\\
&\leq 2L\mathbb{E}_{\sigma}\left[\lceil\|{\bm{w}}\|\rceil\left\|\frac{1}{N}%
\sum_{i=1}^{N}\sigma_{i}{\bm{x}}_{i}\right\|\right]+3b\sqrt{\frac{\log(2/(%
\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}.\end{split}
\left\|\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}{\bm{x}}_{i}\right\|
\begin{split}\mathbb{E}_{{\bm{x}}}[\epsilon_{{\bm{w}}}({\bm{x}})]-\frac{1}{N}%
\sum_{i=1}^{N}\epsilon_{{\bm{w}}}({\bm{x}}_{i})&\leq 2L\mathbb{E}_{\sigma}%
\left[\lceil\|{\bm{w}}\|\rceil\left\|\frac{1}{N}\sum_{i=1}^{N}\sigma_{i}{\bm{x%
}}_{i}\right\|\right]+3b\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{%
2}\rceil}{2N}}\\
&=\frac{2L}{N}\lceil\|{\bm{w}}\|\rceil\mathbb{E}_{\sigma}\left[\sqrt{\sum_{i=1%
}^{N}\sum_{j=1}^{N}\sigma_{i}\sigma_{j}k({\bm{x}}_{i},{\bm{x}}_{j})}\right]+3b%
\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}\\
&\leq\frac{2L}{N}\lceil\|{\bm{w}}\|\rceil\sqrt{\mathbb{E}_{\sigma}\left[\sum_{%
i=1}^{N}\sum_{j=1}^{N}\sigma_{i}\sigma_{j}k({\bm{x}}_{i},{\bm{x}}_{j})\right]}%
+3b\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}\\
&=\frac{2L}{N}\sqrt{\sum_{i=1}^{N}k({\bm{x}}_{i},{\bm{x}}_{i})}+3b\sqrt{\frac{%
\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}\\
&=\frac{2L}{N}\lceil\|{\bm{w}}\|\rceil\sqrt{\operatorname{Tr}({\bm{K}})}+3b%
\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}\rceil}{2N}}.\end{split}
\operatorname{Tr}({\bm{K}})=N
\begin{split}\mathbb{E}_{{\bm{x}}}[\epsilon_{{\bm{w}}}({\bm{x}})]-\frac{1}{N}%
\sum_{i=1}^{N}\epsilon_{{\bm{w}}}({\bm{x}}_{i})&\leq\frac{2L}{\sqrt{N}}\lceil%
\|{\bm{w}}\|\rceil+3b\sqrt{\frac{\log(2/(\delta(e-1)))+\lceil\|{\bm{w}}\|^{2}%
\rceil}{2N}}\\
&\leq\frac{2L}{\sqrt{N}}\lceil\|{\bm{w}}\|\rceil+3b\sqrt{\frac{\log(2/(\delta(%
e-1)))}{2N}}+3b\frac{\lceil\|{\bm{w}}\|\rceil}{\sqrt{2N}}\\
&=\frac{2\sqrt{2}L+3b}{\sqrt{2N}}\lceil\|{\bm{w}}\|\rceil+3b\sqrt{\frac{\log(2%
/(\delta(e-1)))}{2N}}.\end{split}
\|{\bm{w}}\|^{2}={\bm{y}}^{\intercal}{\bm{K}}^{-1}{\bm{y}}
\operatorname{Tr}({\bm{K}})=N
{\bm{A}}
{\bm{A}}
k(x_{1},x_{2})=\text{exp}(-\frac{\|x_{1}-x_{2}\|^{2}}{2\sigma^{2}})
{\bm{A}}
k(x_{1},x_{2})>d
{\bm{A}}_{ij}=1
{\bm{A}}_{ij}=0
A
0
x
\sigma
d
d
3\times 3
3\times 3
s_{N}({\bm{K}})
10000
100
100
s_{N}({\bm{K}})
s_{N}({\bm{K}})
s_{N}({\bm{K}})
s_{N}({\bm{K}})
10000
100
100
s_{N}({\bm{K}})
s_{N}({\bm{K}})
s_{N}({\bm{K}})
s_{N}({\bm{K}})
s_{N}({\bm{K}})=\frac{\operatorname{Tr}({\bm{K}})}{N}{\bm{y}}^{\intercal}{\bm{%
K}}^{-1}{\bm{y}},
{\bm{y}}
{\bm{K}}
O(\sqrt{s_{N}({\bm{K}})/N})
s_{N}({\bm{K}})
{\bm{y}}
s_{N}({\bm{K}})
