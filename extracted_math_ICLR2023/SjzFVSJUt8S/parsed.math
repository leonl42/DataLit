10^{6}
8
(\mathcal{S},\mathcal{A},\mathcal{P}_{T},\mathcal{R},\gamma,p_{0})
\mathcal{S}
\mathcal{A}
\mathcal{P}_{T}:\mathcal{S}\times\mathcal{A}\to\mathcal{S}
\mathcal{R}:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\to\mathbb{R}
\gamma\in(0,1)
p_{0}
t
a_{t}\in\mathcal{A}
s_{t}\in\mathcal{S}
s_{t+1}
r_{t}
(s_{t},a_{t},r_{t},s_{t+1})
(s_{1},a_{1},r_{1},s_{2},a_{2},r_{2},...)
\pi:\mathcal{S}\to\mathcal{A}
R=\mathbb{E}[\sum_{t=1}^{\infty}\gamma^{t}r_{t}]
\mathcal{B}
t
(s_{t},a_{t},r_{t},s_{t+1})
\mathcal{B}
\mathcal{B}_{i}
\mathcal{B}
i
\{\mathcal{B}_{i}\}
\mathcal{T}
\Lambda
\mathcal{B}
\phi
\{\mathcal{B}_{i}\}
\mathcal{B}
\Lambda
\phi:\mathcal{B}\to\{\mathcal{B}_{i}\}
\Lambda
\mathcal{T}
\mathcal{B}^{s}
1
\mathcal{B}^{s}
1
1
\mathcal{B}_{i}
\mathcal{B}
\textbf{f}_{\mathcal{B}_{i}}
i
\phi(\textbf{f}_{\mathcal{B}_{i}}|\theta^{\phi})\in(0,1)
\phi
\theta^{\phi}
\mathcal{B}_{i}
\phi
\bm{\lambda}
\bm{\lambda}=\{\phi(\textbf{f}_{\mathcal{B}_{i}}|\theta^{\phi})|\mathcal{B}_{i%
}\in\mathcal{B}\}\in\mathbb{R}^{N},
N
\mathcal{B}
\bm{\lambda}_{i}
\mathcal{B}_{i}
\bm{\lambda}
\mathcal{B}^{s}
\displaystyle\begin{split}\textbf{I}&\sim\mathrm{Bernoulli}(\bm{\lambda}),\\
\mathcal{B}^{s}&=\{\mathcal{B}_{i}|\mathcal{B}_{i}\in\mathcal{B}\wedge\textbf{%
I}_{i}=1\},\end{split}
\displaystyle\begin{split}\textbf{I}&\sim\mathrm{Bernoulli}(\bm{\lambda}),\\
\mathcal{B}^{s}&=\{\mathcal{B}_{i}|\mathcal{B}_{i}\in\mathcal{B}\wedge\textbf{%
I}_{i}=1\},\end{split}
\mathrm{Bernoulli}(\cdot)
\textbf{I}_{i}\in\{0,1\}
\mathcal{B}^{s}
\mathcal{B}
1
\mathcal{B}_{i}
\textbf{I}_{i}=1
\mathcal{B}^{s}
\mathcal{B}^{s}
\pi
\phi
\mathcal{B}
t
a_{t}
\pi
s_{t}
a_{t}
s_{t+1}
r_{t}
(s_{t},a_{t},r_{t},s_{t+1})
\mathcal{B}
r^{c}_{\pi}
r^{c}_{\pi^{\prime}}
\neq
\mathcal{B}^{s}
r^{c}_{\pi}
r^{c}_{\pi^{\prime}}
\mathcal{B}
r^{c}_{\pi^{\prime}}\leftarrow r^{c}_{\pi}
\{\mathcal{B}^{s}_{i}\}
\mathcal{B}^{s}
\pi
\pi
{\lambda}
\{\mathcal{B}_{i}\}
r^{r}=r^{c}_{\pi}-r^{c}_{\pi^{\prime}},
r^{c}_{\pi^{\prime}}
r^{c}_{\pi}
\pi^{\prime}
\pi
\pi
r^{c}_{\pi}
100
\mathcal{J}=\mathbb{E}_{\textbf{I}}[r^{r}].
\mathcal{J}
\theta^{\phi}
\displaystyle\begin{split}\bigtriangledown_{\theta^{\phi}}\mathcal{J}&=%
\bigtriangledown_{\theta^{\phi}}\mathbb{E}_{\textbf{I}}[r^{r}]\\
&=\mathbb{E}_{\textbf{I}}[r^{r}\bigtriangledown_{\theta^{\phi}}\log\mathcal{P}%
(\textbf{I}|\phi)],\end{split}
\displaystyle\begin{split}\bigtriangledown_{\theta^{\phi}}\mathcal{J}&=%
\bigtriangledown_{\theta^{\phi}}\mathbb{E}_{\textbf{I}}[r^{r}]\\
&=\mathbb{E}_{\textbf{I}}[r^{r}\bigtriangledown_{\theta^{\phi}}\log\mathcal{P}%
(\textbf{I}|\phi)],\end{split}
\mathcal{P}(\textbf{I}|\phi)
\phi
\phi
\phi(\textbf{f}_{\mathcal{B}_{i}}|\theta^{\phi})
\bm{\lambda}
\log\mathcal{P}(\textbf{I}|\phi)
\displaystyle\begin{split}\log\mathcal{P}(\textbf{I}|\phi)&=\sum_{i=1}^{N}\log%
\mathcal{P}(\textbf{I}_{i}|\phi)\\
&=\sum_{i=1}^{N}[\textbf{I}_{i}\log\phi+(1-\textbf{I}_{i})\log(1-\phi)],\end{split}
\displaystyle\begin{split}\log\mathcal{P}(\textbf{I}|\phi)&=\sum_{i=1}^{N}\log%
\mathcal{P}(\textbf{I}_{i}|\phi)\\
&=\sum_{i=1}^{N}[\textbf{I}_{i}\log\phi+(1-\textbf{I}_{i})\log(1-\phi)],\end{split}
N
\mathcal{B}
\textbf{I}_{i}
\mathcal{B}_{i}
\bigtriangledown_{\theta^{\phi}}\mathcal{J}\approx r^{r}\sum_{i=1}^{N}%
\bigtriangledown_{\theta^{\phi}}[\textbf{I}_{i}\log\phi+(1-\textbf{I}_{i})\log%
(1-\phi)].
\phi
r^{r}
\mathcal{B}
\sum_{j:\mathcal{B}_{j}\in\mathcal{B}^{batch}}r^{r}\bigtriangledown_{\theta^{%
\phi}}[\textbf{I}_{j}\log\phi+(1-\textbf{I}_{j})\log(1-\phi)],
\mathcal{B}^{batch}
\mathcal{B}
r^{c}_{\pi}
r^{c}_{\pi^{\prime}}
\mathcal{B}
\mathcal{B}^{s}
\{\mathcal{B}_{i}\}
\mathcal{B}
\mathcal{B}^{s}
\mathcal{B}
\mu(s|\theta^{\mu})
Q(s_{t},a_{t}|\theta^{Q})
\theta^{\mu}
\theta^{Q}
\theta^{Q}
\theta^{Q}
\mathcal{L}(\theta^{Q})=\frac{1}{N}\sum_{t}(y_{t}-Q(s_{t},a_{t}|\theta^{Q}))^{%
2},
y_{t}=r(s_{t},a_{t})+\gamma Q(s_{t+1},\mu(s_{t+1}|\theta^{\mu})|\theta^{Q}).
\mathcal{J}
\theta^{\mu}
\displaystyle\begin{split}\bigtriangledown_{\theta^{\mu}}\mathcal{J}&\approx%
\mathbb{E}_{s_{t}}[\bigtriangledown_{\theta^{\mu}}Q(s_{t},\mu(s_{t}|\theta^{%
\mu})|\theta^{Q})]\\
&=\mathbb{E}_{s_{t}}[\bigtriangledown_{\mu}Q(s_{t},\mu(s_{t}|\theta_{\mu})|%
\theta^{Q})\bigtriangledown_{\theta_{\mu}}\mu(s_{t}|\theta^{\mu})].\end{split}
\displaystyle\begin{split}\bigtriangledown_{\theta^{\mu}}\mathcal{J}&\approx%
\mathbb{E}_{s_{t}}[\bigtriangledown_{\theta^{\mu}}Q(s_{t},\mu(s_{t}|\theta^{%
\mu})|\theta^{Q})]\\
&=\mathbb{E}_{s_{t}}[\bigtriangledown_{\mu}Q(s_{t},\mu(s_{t}|\theta_{\mu})|%
\theta^{Q})\bigtriangledown_{\theta_{\mu}}\mu(s_{t}|\theta^{\mu})].\end{split}
\displaystyle\theta^{Q^{\prime}}\leftarrow\tau\theta^{Q}+(1-\tau)\theta^{Q^{%
\prime}},
\displaystyle\theta^{Q^{\prime}}\leftarrow\tau\theta^{Q}+(1-\tau)\theta^{Q^{%
\prime}},
\displaystyle\theta^{\mu^{\prime}}\leftarrow\tau\theta^{\mu}+(1-\tau)\theta^{%
\mu^{\prime}},
\displaystyle\theta^{\mu^{\prime}}\leftarrow\tau\theta^{\mu}+(1-\tau)\theta^{%
\mu^{\prime}},
\tau\in(0,1]
Q^{\prime}
\mu^{\prime}
\pm
\pm
\tau=0.001
10^{-4}
10^{-3}
\theta=0.15
\sigma=0.2
64
10^{6}
100
50
\alpha
\beta
1
10^{-4}
5
2\times 10^{6}
8
5
8
4
8
2\times 10^{6}
