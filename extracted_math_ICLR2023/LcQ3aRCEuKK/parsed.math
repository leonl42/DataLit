SO(3)
\mathbb{R}^{3}
Z
\mathbb{P}_{Z}
Z
X
Z
Z
X
z
x=\mathsf{Dec}(z)
Z
Z
SO(3)
SO(3)
\Delta\!
\Delta\!
d
\mathbb{R}^{3}
SO(3)
\mathbb{RP}^{d}
\Delta\!
\Delta\!
\Delta\!
\beta
\beta
Z
\mathbb{P}_{Z}
Z
\mathbb{Q}_{Z}^{\alpha}
Z
\alpha
\mathcal{A}
\mathbb{P}_{X}^{\beta}
X
\beta
\mathcal{B}
\mathcal{B}
\boldsymbol{\alpha}
X
\mathcal{A}
\boldsymbol{\beta}
Z
\mathcal{B}
\mathcal{L}(x)=-\mathbb{E}_{z\sim\mathbb{Q}_{Z}^{\boldsymbol{\alpha}(x)}}\left%
[\log{p_{X}^{\boldsymbol{\beta}(z)}(x)}\right]\\
+D_{\mathrm{KL}}\left(\mathbb{Q}_{Z}^{\boldsymbol{\alpha}(x)}||\mathbb{P}_{Z}%
\right).
Z
X
Z
\mathbb{Q}^{\alpha}_{Z}
Z
\epsilon_{1}
\epsilon_{2}
\epsilon_{3}
\epsilon_{4}
z
z_{1}
z_{2}
z_{3}
z_{4}
Z
Z
\mathbb{R}^{2}
\tau=1
Z
\mathbb{R}^{2}
\tau=1
\tau>0
z\in Z
\tau
\sqrt{\tau}\epsilon_{1}
\epsilon_{1}
\mathbb{R}^{n}
z+\sqrt{\tau}\epsilon_{1}
z_{1}=P(z+\sqrt{\tau}\epsilon_{1})
P:\mathbb{R}^{n}\to Z
x\in\mathbb{R}^{n}
Z
x
\tau>0
\epsilon_{2}
z_{2}=P(P(z+\sqrt{\tau}\epsilon_{1})+\sqrt{\tau}\epsilon_{2})
P
P(x)
x
x
Z
\tau>0
\tau_{N}
0
N\to\infty
N\in\mathbb{N}
\tau_{N}
W^{N}:[0,\infty)\to Z
W^{N}
N\to\infty
W
W
W
A
Z
W(t)
z
A
t
\mathbb{Q}_{Z}^{t,z}
A
q_{Z}(t;z,\cdot)
q_{Z}
q_{Z}
u_{0}:Z\to\mathbb{R}
\begin{cases}\partial_{t}u=\tfrac{1}{2}\Delta u&\text{on }(0,\infty)\times Z\\
u(t=0,\cdot)=u_{0}&\text{on }Z\end{cases}
u(t,z)=\int_{Z}u_{0}(y)q_{Z}(t;z,y)dy.
\Delta\!
\mathbb{Q}_{Z}^{t,z}
\mathbb{P}_{Z}
\mathbf{z}:X\to Z
\mathbf{t}:X\to(0,\infty)
-\mathbb{E}_{z\sim\mathbb{Q}_{Z}^{\mathbf{t}(x),\mathbf{z}(x)}}\left[\log p_{X%
}^{\boldsymbol{\beta}(z)}(x)\right]+D_{\mathrm{KL}}\left(\mathbb{Q}_{Z}^{%
\mathbf{t}(x),\mathbf{z}(x)}\|\mathbb{P}_{Z}\right).
\Gamma
\mathbb{P}_{\Gamma}
g:\Gamma\times(0,\infty)\times Z
g(\gamma,t,z)
\mathbb{Q}_{Z}^{t,z}
g
Z=S^{2}
\mathbb{R}^{3}
\mathbb{Q}_{S^{2}}^{t,z}
\gamma
z
T:S^{2}\to SO(3)
y\in S^{2}
T(y)
g
g(\gamma,z)=T(z)\big{[}\exp_{\mathsf{SP}}(\gamma)\big{]}.
\mathbb{P}_{\Gamma}
g(\gamma,z)
\mathbb{Q}_{S^{2}}^{t,z}
T
z
\mathbb{R}^{n}
N
g:\mathcal{E}^{N}\times(0,\infty)\times Z\to Z
\begin{split}&g(\epsilon_{1},\dots,\epsilon_{N},t,z)=\\
&P\left(\cdots P\left(P\left(z+\sqrt{\tfrac{t}{N}}\epsilon_{1}\right)+\sqrt{%
\tfrac{t}{N}}\epsilon_{2}\right)\cdots+\sqrt{\tfrac{t}{N}}\epsilon_{N}\right).%
\end{split}
\epsilon_{1},\dots,\epsilon_{N}
y=g(\epsilon_{1},\dots,\epsilon_{N},z)
q_{Z}(t;z,\cdot)
t
N
\epsilon_{1},\dots,\epsilon_{N}
q_{Z}
\Delta\!
d
R
\mathsf{Sc}
d(d-1)/R^{2}
\begin{split}&q_{S^{d}}(t;z,y)=\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{r^{2}}%
{2t}\right)\times\left(\frac{r}{\sin{r}}\right)^{\frac{d-1}{2}}\\
&\,\left(1+\frac{\mathsf{Sc}\,t}{8dr^{2}}[3-d+(d-1)r^{2}+(d-3)r\cot r]+O(t^{2}%
)\right)\end{split}
r
y
z
\begin{split}D_{\mathrm{KL}}(\mathbb{Q}^{t,z}\|\mathbb{P}_{Z})&=\int_{Z}q_{Z}(%
t;z,y)\log q_{Z}(t;z,y)dy\\
&\qquad+\log\mathrm{Vol}(Z)\\
&=-\frac{d}{2}\log(2\pi t)-\frac{d}{2}+\log\mathrm{Vol}(Z)\\
&\qquad+\frac{1}{4}\mathsf{Sc}\,t+o(t).\end{split}
t
SO(3)\cong\mathbb{RP}^{3}
\mathbb{RP}^{2}
\mathbb{R}^{3}
3
2
SO(3)\cong\mathbb{RP}^{3}
\mathbb{RP}^{2}
\mathbb{R}^{3}
3
2
\Delta\!
10
\Delta\!
10
\times 10^{-2}
S^{2}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbb{R}\mathbb{P}^{3}
\pm
\pm
\pm
\pm
\mathbb{R}\mathbb{P}^{2}
\pm
\pm
\pm
\pm
\mathbb{R}^{3}
\pm
\pm
\pm
\pm
\mathbb{R}^{2}
\pm
\pm
\pm
\pm
\Delta\!
10
\Delta\!
10
\times 10^{-2}
S^{2}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbb{R}\mathbb{P}^{3}
\pm
\pm
\pm
\pm
\mathbb{R}\mathbb{P}^{2}
\pm
\pm
\pm
\pm
\mathbb{R}^{3}
\pm
\pm
\pm
\pm
\mathbb{R}^{2}
\pm
\pm
\pm
\pm
\Delta\!
d
\mathbb{R}^{3}
SO(3)
\mathbb{RP}^{d}
z
t
P
z
\tanh
t
\Delta\!
\Delta\!
SO(3)
\mathbb{RP}^{3}
SO(3)
\mathbb{RP}^{3}
\mathbb{RP}^{d}
S^{d}
\mathbb{R}^{d+1}
s
-s
\mathbb{RP}^{3}
\mathbb{RP}^{d}
S^{d}
x
L
z^{(1)},\dots,z^{(L)}
\mathbb{Q}_{Z}^{\mathbf{t}(x),\mathbf{z}(x)}
x
\log{p_{X}^{\boldsymbol{\beta}}(x)}\approx\log\left(\frac{1}{L}{\sum_{l=1}^{L}%
\frac{p_{X}^{\boldsymbol{\beta}(z^{(l)})}(x)p_{Z}(z^{(l)})}{q_{Z}(\mathbf{t}(x%
);\mathbf{z}(x),z^{(l)})}}\right).
L=100
\Delta\!
\Delta\!
\Delta\!
\times
\mathsf{pic}:[-\pi,\pi]^{2}\to\mathbb{R}
\mathsf{pic}(\theta,\phi)=\cos(\theta)+\cos(\phi).
L^{2}([-\pi,\pi]^{2})
\Delta\!
\Delta\!
1
-1
\Delta\!
S^{2}
\mathbb{RP}^{2}
\mathbb{RP}^{3}
\mathbb{R}^{3}
\Delta\!
\mathsf{pic}:[-\pi,\pi]^{2}\to\mathbb{R}
a_{k,\ell}
\mathsf{pic}(\theta,\phi)=\mathrm{Re}\left(\sum_{k,\ell=-N}^{N}\gamma^{|k|+|%
\ell|-1}a_{k,\ell}\exp(ik\theta+i\ell\phi)\right)
\gamma\in(0,1]
\Delta\!
\Delta\!
\Delta\!
N\gtrsim 10
\gamma\gtrsim 0.3
\Delta\!
\Delta\!
\Delta\!
\Delta\!
\Delta\!
\Delta\!
\Delta\!
\Delta\!
\beta
\beta
\Delta
S^{2}
\Delta
\Delta
\mathcal{S}^{2}
\Delta
\Delta\!
10
S^{2}
\Delta\!
10
S^{2}
S^{2}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbb{R}\mathbb{P}^{3}
\pm
\pm
\pm
\pm
\mathbb{R}\mathbb{P}^{2}
\pm
\pm
\pm
\pm
\mathbb{R}^{3}
\pm
\pm
\pm
\pm
\mathbb{R}^{2}
\pm
\pm
\pm
\pm
S^{2}
\pm
\pm
\pm
\pm
\pm
\int_{Z}q_{Z}(t;z,w)\log q_{Z}(t;z,w)dw.
\begin{split}q_{Z}(t;z,w)&:=\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{r^{2}}{2t%
}\right)\left(u_{0}(z,w)+tu_{1}(z,w)+o(t)\right)\\
&=\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{r^{2}}{2t}\right)u_{0}(z,w)\left(1+%
t\frac{u_{1}(z,w)}{u_{0}(z,w)}+o(t)\right),\end{split}
r
z
w
o(t)
t
u_{j}(z,w)
z
w
y^{i}
z
z
y^{i}=0
r^{2}=|y|^{2}
u_{j}
y^{i}
k
y^{i}
k/2
t
q_{Z}
\log q_{Z}(t;z,w)=J_{1}(t;z,w)+J_{2}(t;z,w)+J_{3}(t;z,w)+J_{4}(t;z,w)
\begin{split}J_{1}(t;z,w)&:=-\frac{d}{2}\log(2\pi t)\\
J_{2}(t;z,w)&:=-\frac{r^{2}}{2t}\\
J_{3}(t;z,w)&:=\log u_{0}(z,w)\\
J_{4}(t;z,w)&:=\log\left(1+t\frac{u_{1}(z,w)}{u_{0}(z,w)}+o(t)\right)\\
&=t\frac{u_{1}(z,w)}{u_{0}(z,w)}+o(t)\end{split}
J_{4}
\theta(z,w)=\sqrt{\det(g_{ij}(w))}
g_{ij}
y^{i}
z
u_{0}
u_{0}(z,w)=\frac{1}{\sqrt{\theta(z,w)}}
y^{i}
z
\theta(0,y)=1-\frac{1}{6}\mathrm{Ric}_{ij}y^{i}y^{j}+O(|y|^{3}),
\sqrt{\theta(0,y)}=1-\frac{1}{12}\mathrm{Ric}_{ij}y^{i}y^{j}+O(|y|^{3}).
u_{0}
u_{0}(0,y)=\frac{1}{\sqrt{\theta(0,y)}}=1+\frac{1}{12}\mathrm{Ric}_{ij}y^{i}y^%
{j}+O(|y|^{3}).
u_{1}
\frac{1}{2}
u_{1}(z,w)=\frac{1}{2}\theta^{-1/2}(z,w)\int_{0}^{1}\theta^{1/2}\Big{(}z,\exp_%
{z}\big{(}\tau\exp_{z}^{-1}(w)\big{)}\Big{)}\Delta u_{0}\Big{(}z,\exp_{z}\big{%
(}\tau\exp_{z}^{-1}(w)\big{)}\Big{)}d\tau
\exp_{z}
z
u_{1}(z,w)/u_{0}(z,w)
t
u_{1}(z,w)/u_{0}(z,w)
u_{1}(z,w)
\Delta u_{0}(0,y)=\frac{1}{12}2\mathrm{tr}(\mathrm{Ric})+O(|y|)=\frac{1}{6}%
\mathsf{Sc}+O(|y|),
u_{1}(0,y)=\frac{1}{12}\mathsf{Sc}+O(|y|)
\frac{u_{1}(0,y)}{u_{0}(0,y)}=\frac{1}{12}\mathsf{Sc}+O(|y|).
\int_{Z}q_{Z}(t;z,w)\log q_{Z}(t;z,w)dw
J_{i}
\begin{split}\int_{Z}q_{Z}(t;z,w)J_{1}(t;z,w)dw&=-\frac{d}{2}\int_{Z}q_{Z}(t;z%
,w)\log\left(2\pi t\right)dw\\
&=-\frac{d}{2}\log(2\pi t).\end{split}
\begin{split}\int_{Z}q_{Z}(t;z,w)J_{4}(t;z,w)dw&=\int_{Z}q_{Z}(t;z,w)\frac{1}{%
12}\mathsf{Sc}\,t\,dw+o(t)\\
&=\frac{1}{12}\mathsf{Sc}\,t+o(t).\end{split}
\begin{split}&\int_{Z}q_{Z}(t;z,w)J_{2}(t;z,w)dw=-\int_{Z}q_{Z}(t;z,w)\frac{r^%
{2}}{2t}dw\\
&=-\int_{\mathbb{R}^{d}}\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{|y|^{2}}{2t}%
\right)\frac{|y|^{2}}{2t}\frac{1}{\sqrt{\theta(0,y)}}\left(1+t\frac{u_{1}(0,y)%
}{u_{0}(0,y)}+o(t)\right)\theta(0,y)dy\\
&=-\int_{\mathbb{R}^{d}}\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{|y|^{2}}{2t}%
\right)\frac{|y|^{2}}{2t}\left(1+t\frac{u_{1}(0,y)}{u_{0}(0,y)}+o(t)\right)%
\sqrt{\theta(0,y)}dy.\end{split}
u_{1}(z,w)/u_{0}(z,w)
\sqrt{\theta(0,y)}
\begin{split}&\left(1+t\frac{u_{1}(0,y)}{u_{0}(0,y)}+o(t)\right)\sqrt{\theta(0%
,y)}\\
&=\left(1+t\left(\frac{1}{12}\mathsf{Sc}+O(|y|)\right)+o(t)\right)\left(1-%
\frac{1}{12}\mathrm{Ric}_{ij}y^{i}y^{j}+O(|y|^{3})\right).\end{split}
O(|y|^{k})
O(t^{k/2})
\begin{split}&\int_{Z}q_{Z}(t;z,w)J_{2}(t;z,w)dw\\
&=-\int_{\mathbb{R}^{d}}\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{|y|^{2}}{2t}%
\right)\frac{|y|^{2}}{2t}\left(1+\frac{1}{12}\mathsf{Sc}\,t-\frac{1}{12}%
\mathrm{Ric}_{ij}\,y^{i}y^{j}\right)dy+o(t).\end{split}
t
i
\begin{split}&\int_{\mathbb{R}^{d}}\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{|y%
|^{2}}{2t}\right)|y|^{2}(y^{i})^{2}dy\\
&=\int_{\mathbb{R}}\frac{1}{\sqrt{2\pi t}}\exp\left(-\frac{(y^{i})^{2}}{2t}%
\right)(y^{i})^{4}dy\\
&\quad+\sum_{j\neq i}\left(\int_{\mathbb{R}}\frac{1}{\sqrt{2\pi t}}\exp\left(-%
\frac{(y^{j})^{2}}{2t}\right)(y^{j})^{2}dy^{j}\right)\left(\int_{\mathbb{R}}%
\frac{1}{\sqrt{2\pi t}}\exp\left(-\frac{(y^{i})^{2}}{2t}\right)(y^{i})^{2}dy^{%
i}\right)\\
&=3t^{2}+(d-1)t^{2}.\end{split}
\begin{split}&\int_{Z}q_{Z}(t;z,w)J_{2}(t;z,w)dw\\
&=-\frac{d}{2}-\frac{d}{24}\mathsf{Sc}\,t+\frac{1}{24}t(3+(d-1))\sum_{i=1}^{d}%
\mathrm{Ric}_{ii}\\
&=-\frac{d}{2}-\frac{d}{24}\mathsf{Sc}\,t+\frac{1}{24}\mathsf{Sc}\,t(d+2)\\
&=-\frac{d}{2}+\frac{1}{12}\mathsf{Sc}\,t.\end{split}
\begin{split}\int_{Z}q_{Z}(t;z,w)J_{3}(t;z,w)dw&=\int_{Z}q_{Z}(t;z,w)\log u_{0%
}(z,w)dw\\
&=\int_{\mathbb{R}^{d}}\frac{1}{(2\pi t)^{d/2}}\exp\left(-\frac{|y|^{2}}{2t}%
\right)\frac{1}{12}\mathrm{Ric}_{ij}y^{i}y^{j}dy+o(t)\\
&=\frac{1}{12}\mathsf{Sc}\,t+o(t).\end{split}
\int_{Z}q_{Z}(t;z,w)\log q_{z}(t;z,w)dw=-\frac{d}{2}\log(2\pi t)-\frac{d}{2}+%
\frac{1}{4}\mathsf{Sc}\,t+o(t).
