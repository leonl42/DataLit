\leq
\%
\leq
\%
\leq
\%
h_{c}
h_{c}
\mathcal{G}^{mol}=\{(\bm{a}_{i}^{mol},\bm{r}_{i}^{mol})\}
\mathcal{G}^{pro}=\{(\bm{a}_{j}^{pro},\bm{r}_{j}^{pro})\}
\mathcal{G}^{mol}
\mathcal{G}^{pro}
\bm{a}_{i}^{mol}
\bm{a}_{j}^{pro}
\bm{r}_{i}^{mol},\bm{r}_{j}^{pro}\in\mathbb{R}^{3}
p(\mathcal{G}^{mol}|\mathcal{G}^{pro})
\phi
\mathcal{G}_{t}^{mol}
t
\displaystyle\mathcal{G}_{t}^{mol}=\phi(\mathcal{G}_{t-1}^{mol},\mathcal{G}^{%
pro}),~{}t>1
\displaystyle\mathcal{G}_{t}^{mol}=\phi(\mathcal{G}_{t-1}^{mol},\mathcal{G}^{%
pro}),~{}t>1
\displaystyle\mathcal{G}_{1}^{mol}=\phi(\mathcal{G}^{pro}),~{}t=1.
\displaystyle\mathcal{G}_{1}^{mol}=\phi(\mathcal{G}^{pro}),~{}t=1.
\mathcal{G}_{t}^{mol}
V_{\mathcal{M}}=\{\mathcal{M}_{i}\}
\mathcal{G}^{mol}=(\mathcal{V,E})
\mathcal{V}
\mathcal{E}
\mathcal{M}_{i}=(\mathcal{V}_{i},\mathcal{E}_{i})
\mathcal{V}=\bigcup_{i}\mathcal{V}_{i}
\mathcal{E}=\bigcup_{i}\mathcal{E}_{i}
\mathcal{G}^{mol}
\mathcal{G}_{1},\cdots,\mathcal{G}_{n}
\mathcal{G}_{i}
\tau
\tau
V_{\mathcal{M}}
\mathcal{G}_{i}
\mathcal{C}_{t-1}^{a}
K_{a}
\mathcal{G}_{t-1}^{mol}\bigcup\mathcal{G}^{pro}
{\bm{h}^{(0)}_{k}}
\bm{e}_{ij}
L
l
(1\leq l\leq L)
\bm{h}_{i}^{(l)}
\bm{r}_{ij}^{(l)}=\operatorname{Concat}(\bm{h}_{j}^{(l)},\bm{e}_{ij}^{(l)})
\operatorname{Concat}(\cdot)
\bm{q}_{i}^{(l)}=\mathbf{W}_{Q}\bm{h}_{i}^{(l)},~{}\bm{k}_{ij}^{(l)}=\mathbf{W%
}_{K}\bm{r}_{ij}^{(l)},~{}\bm{v}_{ij}^{(l)}=\mathbf{W}_{V}\bm{r}_{ij}^{(l)},
\mathbf{W}_{Q},\mathbf{W}_{K}
\mathbf{W}_{V}
m\in\{1,2,\dots,M\}
M
\text{head}_{i}^{m}=\sum_{j\in\mathcal{N}(i)}\operatorname{Softmax}\left(\frac%
{{\bm{q}_{i}^{(l)}}^{\top}\cdot\bm{k}_{ij}^{(l)}}{\sqrt{d}}\right)\bm{v}_{ij}^%
{(l)},
\mathcal{N}(i)
i
\mathcal{C}^{a}_{t-1}
d
\operatorname{MHA}_{i}=\operatorname{Concat}\left({\rm head}_{i}^{1},\ldots,{%
\rm head}_{i}^{M}\right)\mathbf{W}_{O},
\mathbf{W}_{O}
\{{\bm{h}}_{i}\}
K_{r}
\mathcal{C}_{t-1}^{res}
i
res_{i}
{\bm{f}}_{i}
{\bm{h}}_{k}
\tilde{{\bm{f}}}_{i}={\rm Concat}\left({\bm{f}}_{i},\sum_{k\in res_{i}}%
\nolimits\bm{h}_{k}\right).
\bm{e}_{ij}^{res}
\{{\bm{f}}_{i}\}
\{{\bm{h}}_{i}\}
W_{ij}
i
j
W_{ij}=C_{ij}\left({\rm log}\frac{1+N}{1+N_{i}}+1\right),
C_{ij}
j
i
N
N_{i}
i
j
i
\pi
\pi
\pi
W_{ij}
\rm{H}
\gamma
\cdot,\cdot
S
\rm{H}
\gamma
\mathcal{P}
c
\mathcal{P}
S
\rm{H},\mathcal{P}
\mathcal{P}\leftarrow c\cdot\mathcal{P}\cdot\gamma+S^{\top}\rm{H}\cdot(1-\gamma)
c\leftarrow c\cdot\gamma+S^{\top}\bm{1}\cdot(1-\gamma)
\mathcal{P}\leftarrow\mathcal{P}/c
{\bm{h}}_{c}
K_{p}
\hat{\bm{h}}_{c}
\hat{\bm{h}}_{c}
t=1
t\geq 2
t=1
t\geq 2
t-1
\mathcal{M}_{f}
P_{m}=\mathop{\rm softmax}\limits_{\mathcal{M}\in V_{\mathcal{M}}}({\rm MLP}^{%
\mathcal{M}}({\rm e}(\mathcal{M}_{f}),\sum_{i\in\mathcal{M}_{f}}{\bm{h}}_{i},%
\hat{\bm{h}}_{c})\cdot{\rm e}(\mathcal{M}))
P_{m}
V_{\mathcal{M}}
{\rm e}(\mathcal{M})
\sum_{i\in\mathcal{M}_{f}}{\bm{h}}_{i}
\hat{{\bm{h}}}_{c}
t=1
C
{\rm GIN}(\cdot)
P_{a}
P_{a}=\mathop{\rm softmax}\limits_{\mathcal{G}^{\prime}\in C}({\rm MLP}^{a}({%
\rm GIN}(\mathcal{G}^{\prime}),\hat{\bm{h}}_{c})).
|C|\approx 3
X,Y
Y
\Delta\alpha
\Delta\alpha={\rm MLP}^{\alpha}({\bm{h}}_{X},{\bm{h}}_{Y},{\bm{h}}_{\mathcal{G%
}}){\rm mod}2\pi,
{\bm{h}}_{X}
{\bm{h}}_{Y}
X
Y
{\bm{h}}_{\mathcal{G}}
\Delta\alpha
\Delta\alpha
XY
U[0,1]
\mathcal{L}_{focal}
\mathcal{L}_{motif}
\mathcal{L}_{attach}
\mathcal{L}_{\alpha}
\mathcal{L}_{d}
\mathcal{L}=\mathcal{L}_{focal}+\mathcal{L}_{motif}+\mathcal{L}_{attach}+%
\mathcal{L}_{\alpha}+\mathcal{L}_{d}.
\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K_{a}
K_{r}
M
d
\tau
|V_{\mathcal{M}}|=890
\gamma=0.9
N
|V_{\mathcal{M}}|
N
|V_{\mathcal{M}}|
\%
\&
N
|V_{\mathcal{M}}|
\tau
|V_{\mathcal{M}}|
N
|V_{\mathcal{M}}|
L
{\bm{h}}^{(l)}
l
\displaystyle{\bm{h}}^{\prime(l-1)}={\rm MHA(LN(}{\bm{h}}^{(l-1)}))+{\bm{h}}^{%
(l-1)}
\displaystyle{\bm{h}}^{\prime(l-1)}
\displaystyle={\rm MHA(LN(}{\bm{h}}^{(l-1)}))+{\bm{h}}^{(l-1)}
\displaystyle{\bm{h}}^{(l)}={\rm FFN(LN(}{\bm{h}}^{\prime(l-1)}))+{\bm{h}}^{%
\prime(l-1)},\;\;(0\leq l<L).
\displaystyle{\bm{h}}^{(l)}
\displaystyle={\rm FFN(LN(}{\bm{h}}^{\prime(l-1)}))+{\bm{h}}^{\prime(l-1)},\;%
\;(0\leq l<L).
K_{r}
f_{p}\in\{0,1\}
f_{h}\in[-4.5,4.5]
f_{v}\in[60.1,227.8]
f_{c}\in\{-1,0,1\}
f_{d}\in\{0,1\}
f_{a}\in\{0,1\}
{\bm{f}}_{i}
i
x_{i}
{\bm{O}}_{i}=[{\bm{c}}_{i},{\bm{n}}_{i},{\bm{c}}_{i}\times{\bm{n}}_{i}]
{\bm{u}}_{i}=\frac{{\bm{x}}_{i}-{\bm{x}}_{i-1}}{\lVert{\bm{x}}_{i}-{\bm{x}}_{i%
-1}\rVert},\quad{\bm{c}}_{i}=\frac{{\bm{u}}_{i}-{\bm{u}}_{i+1}}{\lVert{\bm{u}}%
_{i}-{\bm{u}}_{i+1}\rVert},\quad{\bm{n}}_{i}=\frac{{\bm{u}}_{i}\times{\bm{u}}_%
{i+1}}{\lVert{\bm{u}}_{i}\times{\bm{u}}_{i+1}\rVert}.
i
j
\bm{e}_{ij}^{res}={\rm Concat}\bigg{(}E_{\mathrm{pos}}(i-j),\quad\mathrm{RBF}(%
\|{\bm{x}}_{i}-{\bm{x}}_{j}\|),\quad{\bm{O}}_{i}^{\top}\frac{{\bm{x}}_{j}-{\bm%
{x}}_{i}}{\|{\bm{x}}_{i}-{\bm{x}}_{j}\|},\quad{\bm{q}}({\bm{O}}_{i}^{\top}{\bm%
{O}}_{j})\bigg{)}.
\bm{e}_{ij}^{res}
E_{\mathrm{pos}}(i-j)
\mathrm{RBF}(\cdot)
{\bm{x}}_{j}
i
{\bm{q}}({\bm{O}}_{i}^{\top}{\bm{O}}_{j})
{\bm{q}}(\cdot)
{\bm{O}}_{i}^{\top}{\bm{O}}_{j}
\bm{e}_{ij}^{res}
\gamma=0.9
W_{ij}
x_{v}^{l}={\rm MLP}(x_{v}^{l-1}+\frac{1}{\sum_{u\in\mathcal{N}(v)}{W}_{uv}}%
\sum_{u\in\mathcal{N}(v)}{W}_{uv}x_{u}^{l-1}),
x_{v}^{l}
v
l
\mathcal{N}(v)
{W}_{uv}
\hat{\bm{h}}_{c}
\hat{\bm{h}}_{c}
{\bm{D}}\in\mathbb{R}^{(n^{\prime}+m^{\prime})\times(n^{\prime}+m^{\prime})}
{\bm{D}}_{i,j}=\begin{cases}\|\bm{r}_{i}-\bm{r}_{j}\|&i,j\leq n^{\prime}\\
{\rm MLP}^{d}(\bm{h}^{(0)}_{i},\bm{h}^{(0)}_{j})&i\leq n^{\prime},j>n^{\prime}%
\\
\|\bm{r}_{i}-\bm{r}_{j}\|&i,j>n^{\prime},\\
\end{cases}
n^{\prime}
m^{\prime}
\bm{r}_{i}
{\rm MLP}^{d}
{\bm{D}}
\tilde{{\bm{D}}}_{i,j}=0.5({\bm{D}}_{i,1}^{2}+{\bm{D}}_{1,j}^{2}-{\bm{D}}_{i,j%
}^{2}),\quad\tilde{{\bm{D}}}={\bm{U}}{\bm{S}}{\bm{U}}^{\top}
{\bm{S}}
\bm{r}_{i}
\tilde{{\bm{r}}}_{i}=[{\bm{X}}_{i,1},{\bm{X}}_{i,2},{\bm{X}}_{i,3}],\quad{\bm{%
X}}={\bm{U}}\sqrt{{\bm{S}}}.
\{\tilde{{\bm{r}}}_{i}\}
{\bm{D}}
\{{\bm{R}},{\bm{t}}\}
\{\tilde{{\bm{r}}}_{1},\cdots,\tilde{{\bm{r}}}_{n^{\prime}}\}
\{{\bm{r}}_{1},\cdots,{\bm{r}}_{n^{\prime}}\}
{\bm{r}}_{i}={\bm{R}}\tilde{{\bm{r}}}_{i}+{\bm{t}},~{}i>n^{\prime}.
t>1
\Delta\alpha
R_{3\times 3}
t_{3\times 1}
X,Y
Y
{\bm{r}}_{X}
{\bm{r}}_{Y}
{\bm{n}}
\frac{{\bm{r}}_{Y}-{\bm{r}}_{X}}{\|{\bm{r}}_{Y}-{\bm{r}}_{X}\|}
n_{x},n_{y}
n_{z}
x,y
z
x_{0},y_{0}
z_{0}
{\bm{r}}_{X}
R_{3\times 3}=\left[\begin{array}[]{ccc}n_{x}^{2}K+cos(\Delta\alpha)&n_{x}n_{y%
}K-n_{z}sin(\Delta\alpha)&n_{x}n_{z}K+n_{y}sin(\Delta\alpha)\\
n_{x}n_{y}K+n_{z}sin(\Delta\alpha)&n_{y}^{2}K+cos(\Delta\alpha)&n_{y}n_{z}K-n_%
{x}sin(\Delta\alpha)\\
n_{x}n_{z}K-n_{y}sin(\Delta\alpha)&n_{y}n_{x}K+n_{x}sin(\Delta\alpha)&n_{z}^{2%
}K+cos(\Delta\alpha)\end{array}\right],
t_{3\times 1}=\left[\begin{array}[]{c}(x_{0}-n_{x}M)K+(n_{z}y_{0}-n_{y}z_{0})%
sin(\Delta\alpha)\\
(y_{0}-n_{y}M)K+(n_{x}z_{0}-n_{z}x_{0})sin(\Delta\alpha)\\
(z_{0}-n_{z}M)K+(n_{y}x_{0}-n_{x}y_{0})sin(\Delta\alpha)\\
\end{array}\right].
K=1-cos(\Delta\alpha)
M=n_{x}x_{0}+n_{y}y_{0}+n_{z}z_{0}
{\bm{r}}_{i}
{\bm{r}}_{i}^{\prime}=R{\bm{r}}_{i}+t
\%
>
<T
\geq T
T
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\gamma
K_{p}
\gamma
\%
\tau
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\gamma
K_{p}
\gamma
K_{p}
