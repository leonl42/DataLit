P
\times
P
P^{2}
I_{LQ}\in\mathbb{R}^{H\times D\times C_{in}}
H
D
C_{in}
\times
F_{0}\in\mathbb{R}^{H\times D\times C}
C
\times
F_{1}
F_{R}=F_{0}+F_{1}
I_{HQ}
F_{R}
N_{G}
N_{B}
x_{l-1}
x{{}^{\prime}}_{l}
x_{l}
l
\begin{split}x{{}^{\prime}}_{l}&={\rm MSA}({\rm LN}(x_{l-1}))+x_{l-1},\\
x_{l}&={\rm MLP}({\rm LN}(x{{}^{\prime}}_{l}))+x{{}^{\prime}}_{l}.\end{split}
\times
F_{R}
I_{HQ}
I_{HQ}={\rm Conv}({\rm Upsample}(F_{R})).
I_{HQ}={\rm Conv}(F_{R})+I_{LQ}.
L_{2}
L_{1}
L_{1}
L_{1}
\mathcal{L}=\lVert I_{HQ}-I_{G}\rVert_{1},
I_{HQ}
I_{G}
\varepsilon
10^{-3}
\mathcal{L}=\sqrt{\lVert I_{HQ}-I_{G}\rVert^{2}+\varepsilon^{2}}.
{\rm MSA}(X)={\rm Softmax}(\frac{QK^{T}}{\sqrt{C}})V,
Q,K,V\in\mathbb{R}^{N\times C}
X\in\mathbb{R}^{N\times C}
N
C
1
H
\times
D
P
\hat{X}\in\mathbb{R}^{h\times w\times C}
h=\frac{H}{P}
w=\frac{D}{P}
\Omega({\rm MSA})=4hwC^{2}+2(hw)^{2}C.
W
\times
W
W
\times
W
\frac{h}{W}
\times
\frac{w}{W}
\displaystyle\Omega({\rm D\mbox{-}MSA})=(4W^{2}C^{2}+2W^{4}C)\times\frac{h}{W}%
\times\frac{w}{W}=4hwC^{2}+2W^{2}hwC.
\displaystyle\Omega({\rm D\mbox{-}MSA})=(4W^{2}C^{2}+2W^{4}C)\times\frac{h}{W}%
\times\frac{w}{W}=4hwC^{2}+2W^{2}hwC.
I
\frac{h}{I}
\times
\frac{w}{I}
I
\times
I
\displaystyle\Omega({\rm S\mbox{-}MSA})=(4\frac{h}{I}\times\frac{w}{I}C^{2}+2(%
\frac{h}{I}\times\frac{w}{I})^{2}C)\times I\times I=4hwC^{2}+2\frac{h}{I}\frac%
{w}{I}hwC.
\displaystyle\Omega({\rm S\mbox{-}MSA})=(4\frac{h}{I}\times\frac{w}{I}C^{2}+2(%
\frac{h}{I}\times\frac{w}{I})^{2}C)\times I\times I=4hwC^{2}+2\frac{h}{I}\frac%
{w}{I}hwC.
W^{2}\ll hw
\frac{h}{I}\frac{w}{I}<hw
6
3
3
\times
1
1
\times
200
\times
200
90^{\circ}
180^{\circ}
270^{\circ}
\times
\times
\times
32
8
\beta_{1}=0.9
\beta_{2}=0.999
\times 10^{-4}
500
250
400
450
475
1
(8,8,8,8,8,8)
(8,8,6,6,4,4)
(4,4,4,4,4,4)
(8,8,8,8,8,8)
(8,8,6,6,4,4)
(4,4,4,4,4,4)
\times
100
(4,4,4,4,4,4)
(16,16,12,12,8,8)
(18,18,13,13,7,7)
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
15
25
50
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
q
\sigma
\sigma
