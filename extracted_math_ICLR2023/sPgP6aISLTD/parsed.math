{\beta\text{-VAE}}
\beta
\beta
\beta
{\mathcal{M}=(\mathcal{S},\mathcal{A},P,R,\gamma)}
\mathcal{S}
\mathcal{A}
{P:\mathcal{S}\times\mathcal{S}\times\mathcal{A}\rightarrow[0,1]}
{R:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}}
\gamma\in[0,1)
\mathbf{a}_{t}\in\mathcal{A}
t
\mathbf{s}_{t}\in\mathcal{S}
\mathbf{a}_{t}\sim\pi(\mathbf{s}_{t})
{P(\mathbf{s}_{t+1}|\mathbf{s}_{t},\mathbf{a}_{t})}
{r_{t}=R(\mathbf{s}_{t},\mathbf{a}_{t})}
\pi
\max_{\pi}\mathbb{E}_{P,\pi}[\sum_{t=0}^{\infty}[\gamma^{t}r_{t}]]
\mathbf{o}_{t}\in\mathcal{O}
t
\mathbf{s}_{t}\in\mathcal{S}
\mathbf{s}_{t}
\mathbf{s}_{t}
\mathbf{s}_{t}
\mathbf{o}_{t}
\mathbf{o}_{t}
\mathbf{s}_{t}
\mathbf{h}:\mathcal{S}\rightarrow\mathcal{O}
\mathbf{o}_{t}=\mathbf{h}(\mathbf{s}_{t})
\mathbf{z}_{t}\in\mathcal{Z}
\mathbf{s}_{t}
\mathbf{o}_{t}
\mathbf{z}_{t}=\mathbf{f}(\mathbf{o}_{t})
\mathbf{z}_{t}=\mathbf{f}(\mathbf{o}_{t})
\mathbf{z}(\mathbf{o}_{t})
z^{i}
i
\mathbf{z}
\mathbf{o}_{t}
\tilde{e}\in\{e,e^{\prime}\}
\tilde{t}\in\{t+1,t^{\prime},t^{\prime\prime}\}
\tilde{e}\in\{e,e^{\prime}\}
\tilde{t}\in\{t+1,t^{\prime},t^{\prime\prime}\}
f_{\theta}:\mathcal{O}\rightarrow\mathcal{Z}
\mathbf{o}_{t}
\mathbf{o}_{t+1}
g_{\phi}:\mathcal{Z}\times\mathcal{Z}\rightarrow\mathbb{R}
\mathbf{z}_{t}
\mathbf{s}_{t}
{\text{dim}(\mathcal{S})\leq\text{dim}(\mathcal{Z})\ll\text{dim}(\mathcal{O})}
N
B=\{(o_{t},o_{t+1})_{i}\}_{i=1}^{N}
B\sim\mathcal{D}
B=\mathcal{D}
\theta
f_{\theta^{\prime}}:\mathcal{O}\rightarrow\mathcal{Z}
\mathbf{o}_{t+1}
\theta^{\prime}=\tau\theta^{\prime}+(1-\tau)\theta
(o_{t},o_{\tilde{t}})
\tilde{t}\neq t+1
B=\{...,(\mathbf{o}_{t}^{e},\mathbf{o}_{t+1}^{e}),...\}\sim\mathcal{D}
Z_{\text{obs}}
B
\mathbf{z}_{t}^{e}=f_{\theta}(\mathbf{o}_{t}^{e})
Z_{\text{next\_obs}}
B
\mathbf{z}_{t+1}^{e}=f_{\theta^{\prime}}(\mathbf{o}_{t+1}^{e})
B
\mathbf{x}_{t}\leftarrow(\mathbf{z}_{t}^{e},\mathbf{z}_{t+1}^{e})
X\leftarrow X\cup\mathbf{x}_{t}
\mathbf{z}_{t^{\prime}}^{e^{\prime}}\sim Z_{\text{next\_obs}}
e^{\prime}\neq e
\mathbf{x}^{\prime}_{t}\leftarrow(\mathbf{z}_{t}^{e},\mathbf{z}_{t^{\prime}}^{%
e^{\prime}})
X^{\prime}\leftarrow X^{\prime}\cup\mathbf{x}^{\prime}_{t}
\mathbf{o}_{t^{\prime\prime}}^{e}\sim\mathcal{D}
t^{\prime\prime}\notin\{t,t+1\}
\mathbf{z}_{t^{\prime\prime}}^{e}=f_{\theta^{\prime}}(\mathbf{o}_{t^{\prime%
\prime}}^{e})
\mathbf{x}^{\prime\prime}_{t}\leftarrow(\mathbf{z}_{t}^{e},\mathbf{z}_{t^{%
\prime\prime}}^{e})
X^{\prime\prime}\leftarrow X^{\prime\prime}\cup\mathbf{x}^{\prime\prime}_{t}
\mathbf{x}\in\{X,X^{\prime},X^{\prime\prime}\}
y=g_{\phi}(\mathbf{x})
L_{\text{TED}}(\mathbf{x},l)
L_{\text{TED}}\leftarrow\text{mean}(L_{\text{TED}}(\mathbf{x}))
\theta
\phi
\theta^{\prime}=\tau\theta^{\prime}+(1-\tau)\theta
L_{\text{TED}}
\phi
\theta
\theta^{\prime}
B\sim\mathcal{D}
X
X^{\prime}
X^{\prime\prime}
(\mathbf{o}_{t}^{e},\mathbf{o}_{t+1}^{e})\in B
e
\mathbf{x}_{t}=(\mathbf{o}_{t}^{e},\mathbf{o}_{t+1}^{e})
e
\mathbf{x}^{\prime}_{t}=(\mathbf{o}_{t}^{e},\mathbf{o}_{t^{\prime}}^{e^{\prime%
}})
{\mathbf{o}_{t^{\prime}}^{e^{\prime}}\sim\mathcal{B}}
e^{\prime}\neq e
f_{\theta}
\mathbf{z}(\mathbf{o}_{t}^{e})
\mathbf{x}^{\prime}_{t}
\mathbf{x}_{t}
\mathbf{x}^{\prime\prime}_{t}=(\mathbf{o}_{t}^{e},\mathbf{o}_{t^{\prime\prime}%
}^{e})
\mathbf{o}_{t^{\prime\prime}}^{e}\sim\mathcal{D}
\mathbf{x}_{t}
\mathbf{x}^{\prime\prime}_{t}
\{X,X^{\prime},X^{\prime\prime}\}
\mathbf{x}_{t}\in X
\mathbf{x}^{\prime}_{t}\in X^{\prime}
\mathbf{x}^{\prime\prime}_{t}\in X^{\prime\prime}
y(\mathbf{x}_{t})=\mathbf{g}_{\phi}(\mathbf{x}^{1}_{t},\mathbf{x}^{2}_{t})=%
\sum_{i=1}^{n}|k^{i}_{1}z^{i}(\mathbf{x}^{1}_{t})+k^{i}_{2}z^{i}(\mathbf{x}^{2%
}_{t})+b^{i}|-(\bar{k}^{i}z^{i}(\mathbf{x}^{1}_{t})+\bar{b}^{i})^{2}+c
{\mathbf{x}_{t}\in\{X,X^{\prime},X^{\prime\prime}\}}
n
\mathbf{z}(\mathbf{o}_{t}^{e})
{\mathbf{x}_{t}=(\mathbf{x}^{1}_{t},\mathbf{x}^{2}_{t})}
{\phi=\{\mathbf{k}_{1},\mathbf{k}_{2},\mathbf{b},\mathbf{\bar{k}},\mathbf{\bar%
{b}},c\}}
\theta
{\mathbf{x}_{t}\in X}
l=1
{\mathbf{x}^{\prime}_{t}\in X^{\prime}}
{\mathbf{x}^{\prime\prime}_{t}\in X^{\prime\prime}}
l=0
{\mathbf{x}_{t}\in\{X,X^{\prime},X^{\prime\prime}\}}
\mathcal{L}_{\text{TED}}(\mathbf{x}_{t},l)=-\alpha(2l\log\sigma(y(\mathbf{x}_{%
t}))-(1-l)\log(1-\sigma(y(\mathbf{x}_{t})))
\sigma
{\mathbf{x}^{\prime}_{t}\in X^{\prime}}
{\mathbf{x}^{\prime\prime}_{t}\in X^{\prime\prime}}
B
{\mathbf{x}_{t}\in X}
2
\alpha
\mathbf{s}_{t}
y=\mathbf{g}_{\phi}(\mathbf{x}^{1}_{t},\mathbf{x}^{2}_{t})
z^{i}
z^{j\neq i}
\mathcal{L}_{\text{TED}}
\mathbf{o}_{t}
B
\mathbf{z}_{\text{diff}}=\sum_{b=1}^{B}|\mathbf{z}(\mathbf{o}^{(b)}_{t})-%
\mathbf{z}(\mathbf{o}^{(b)}_{\tilde{t}})|
\mathbf{o}^{(b)}_{t}
\mathbf{o}^{(b)}_{\tilde{t}}
\textbf{z}_{\text{diff}}
1.0
\alpha
\alpha=100
\alpha=200
\alpha=50
\alpha
\alpha
t
t+1
t+k
k>1
\pi
\mathcal{D}
Q:\mathcal{O}\times\mathcal{A}\rightarrow\mathbb{R}
L_{Q}=\mathbb{E}_{(\mathbf{o}_{t},\mathbf{a}_{t},\mathbf{o}_{t+1},r_{t})\sim%
\mathcal{D}}\left[\left(Q(\mathbf{o}_{t},\mathbf{a}_{t})-r_{t}-\gamma\bar{V}(%
\mathbf{o}_{t+1}))\right)^{2}\right]
\bar{V}
\bar{V}(\mathbf{o}_{t+1})=\mathbb{E}_{\mathbf{a}_{t+1}\sim\pi}\left[\min_{i=1,%
2}\bar{Q}_{i}(\mathbf{o}_{t+1},\pi(\mathbf{o}_{t+1}))-\alpha_{\text{SAC}}\log%
\pi(\mathbf{a}_{t+1}|\mathbf{o}_{t+1})\right]
\bar{Q}
Q_{1}
Q_{2}
\pi
L_{\pi}=\mathbb{E}_{\mathbf{o}_{t}\sim\mathcal{D}}\left[\mathbb{E}_{\mathbf{a}%
_{t}\sim\pi}\left[{\alpha}_{\text{SAC}}\log(\pi(\mathbf{a}_{t}|\mathbf{o}_{t})%
)-\min_{i=1,2}\bar{Q}_{i}(\mathbf{o}_{t},\mathbf{a}_{t})\right]\right]
(\mathbf{o}_{t},\mathbf{o}_{t+1})\sim\mathcal{D}
L_{Q}^{\text{SVEA}}=\alpha_{\text{SVEA}}L_{Q}(o_{t},a_{t},o_{t+1})+\beta_{%
\text{SVEA}}L_{Q}(o_{t}^{\text{aug}},a_{t},o_{t+1})
\pi
\pi_{\psi}
L_{\pi}^{\text{CLIP}}=-\mathbb{E}_{(\mathbf{o}_{t},\mathbf{a}_{t},\mathbf{o}_{%
t+1},r_{t})\sim\pi}\left[\min(\rho_{t}A_{t},\text{clip}(\rho_{t}(\psi),1-%
\epsilon 1+\epsilon)A_{t})\right]
\rho_{t}(\psi)
A_{t}
A_{t}=Q^{\pi}(o_{t},a_{t})-V^{\pi}(o_{t})
\pi
Q
3\times 3
\mathcal{L}_{Q}
\mathcal{L}_{Q}
\mathcal{L}_{\text{TED}}
\mathcal{L}_{\text{ENC}}=\mathcal{L}_{Q}+\mathcal{L}_{\text{TED}}
\mathcal{L}_{\text{ENC}}
\pi
Q
\bf{k}_{1}
\bf{k}_{2}
\bar{\bf{k}}
\bf{b}
\bar{\bf{b}}
c
\alpha
\alpha
\alpha
\alpha
\tau
[-10,2]
B=32
\mathcal{L}=\mathcal{L}_{\text{PPO}}+\mathcal{L}_{\text{TED}}
\mathcal{L}
\gamma
\lambda
\alpha
