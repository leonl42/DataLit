\mathcal{M}=(S,A,\mathcal{P},r,\rho_{0},\gamma)
S
A
r:S\times A\to\mathbb{R}
\mathcal{P}:S\times A\to\Delta(S)
\rho_{0}
\gamma
\pi:S\times A\to\mathbb{R}
R=\mathbb{E}\sum_{t=0}^{T-1}\gamma^{t}r(s_{t},a_{t})
a_{t}\sim\pi(s_{t},\cdot),s_{t+1}\sim\mathcal{P}(\cdot|s_{t},a_{t})
V(s)
V(s_{t})\leftarrow V(s_{t})+\alpha[r(s_{t+1},a)+\gamma V(s_{t+1})-V(s_{t})]
\lambda
Q
Q^{*}(s,a)=r(s,a)+\sum_{s^{\prime}\in S}\mathcal{P}(s^{\prime}|s,a)\max_{a^{%
\prime}\in A}Q^{*}(s^{\prime},a^{\prime}).
Q(s_{t},a_{t})
Q(s_{t},a_{t})+\alpha[\mathcal{R}_{t+1}+\gamma\max_{a}Q(s_{t+1},a)-Q(s_{t},a_{%
t})].
a^{*}(s)=\operatorname*{arg\,max}_{a}Q(s,a)
s
\mathcal{B}Q(s,a)\coloneqq\mathbb{E}[r(s,a)]+\gamma\mathbb{E}_{\mathcal{P}}[%
\max_{a^{\prime}}Q(s^{\prime},a^{\prime})]
\mathcal{L}_{i}(\theta_{i})=\mathbb{E}_{e\sim\mathcal{D}}[(r(s,a)+\gamma\max_{%
a^{\prime}}Q(s^{\prime},a^{\prime},\theta_{\textrm{target}})-Q(s,a,\theta_{i})%
)^{2}]
\mathcal{D}
e=\{s_{t},a_{t},r_{t},s_{t+1}\}
\mathcal{D}=\{e_{1},e_{2},\dots e_{N}\}
\displaystyle\theta_{i+1}=\theta_{i}+\alpha(r(s_{t},a_{t},s_{t+1})+\gamma%
\mathcal{Q}(s_{t+1},\operatorname*{arg\,max}_{a}\mathcal{Q}(s_{t+1},a;\theta^{%
\textrm{target}}_{i-1});\theta^{\textrm{target}}_{i-1})
\displaystyle\theta_{i+1}=\theta_{i}+\alpha(r(s_{t},a_{t},s_{t+1})+\gamma%
\mathcal{Q}(s_{t+1},
\displaystyle\operatorname*{arg\,max}_{a}\mathcal{Q}(s_{t+1},a;\theta^{\textrm%
{target}}_{i-1});\theta^{\textrm{target}}_{i-1})
\displaystyle\qquad\qquad\qquad-\mathcal{Q}(s_{t},a_{t};\theta_{i}))\nabla_{%
\theta_{i}}\mathcal{Q}(s_{t},a_{t};\theta_{i}).
\displaystyle\qquad\qquad\qquad-\mathcal{Q}(s_{t},a_{t};\theta_{i}))\nabla_{%
\theta_{i}}\mathcal{Q}(s_{t},a_{t};\theta_{i}).
\pi_{\theta}
g=\mathbb{E}_{t}\big{[}\nabla_{\theta}\log\pi_{\theta}(s_{t},a_{t})(Q(s_{t},a_%
{t})-\max_{a}Q(s_{t},a))\big{]}
Q(s_{t},a_{t})
t
\displaystyle\max_{\theta}\mathbb{E}_{s\sim\rho_{\theta_{\textrm{old}}};a\sim%
\pi_{\theta_{\textrm{old}}}(s,\cdot)}\left[\dfrac{\pi_{\theta}(s,a)}{\pi_{%
\theta_{\textrm{old}}}(s,a)}Q_{\theta_{\textrm{old}}}(s,a)\right]\>\>\textrm{%
subject to}\>\>\mathbb{E}_{s\sim\rho_{\theta_{\textrm{old}}}}\mathcal{D}_{KL}(%
\pi_{\theta}(s,\cdot)||\pi_{\textrm{old}}(s,\cdot))\leq\delta
\displaystyle\max_{\theta}\mathbb{E}_{s\sim\rho_{\theta_{\textrm{old}}};a\sim%
\pi_{\theta_{\textrm{old}}}(s,\cdot)}\left[\dfrac{\pi_{\theta}(s,a)}{\pi_{%
\theta_{\textrm{old}}}(s,a)}Q_{\theta_{\textrm{old}}}(s,a)\right]\>\>\textrm{%
subject to}\>\>
\displaystyle\mathbb{E}_{s\sim\rho_{\theta_{\textrm{old}}}}\mathcal{D}_{KL}(%
\pi_{\theta}(s,\cdot)||\pi_{\textrm{old}}(s,\cdot))\leq\delta
\mathcal{A}
\pi
\mathcal{M}
\mathcal{A}
t
\pi_{t}
s_{t}
a_{t}\sim\pi_{t}(s_{t},\cdot)
s^{\prime}_{t}\sim\mathcal{P}(\cdot\mid s_{t},a_{t})
r_{t}=r(s_{t},a_{t},s^{\prime}_{t})
\mathcal{A}
\mathcal{M}
H_{t}=(\pi_{0},s_{0},a_{0},s^{\prime}_{0},r_{0}),\dots(\pi_{t},s_{t},a_{t},s^{%
\prime}_{t},r_{t})
\pi_{t}
s_{t}
t
H_{t-1}
\mathcal{A}
t=T
\pi=\pi_{T}
\mathbb{A}
\Pi
\pi
\mathcal{M}
\pi_{t}
(s_{t},a_{t})
a_{t}\sim\pi_{t}(s_{t},\cdot)
a_{t}
s_{t}
s^{\prime}_{t}
s_{t+1}=s^{\prime}_{t}
s_{t+1}
\pi_{t+1}
H_{t}
\mathcal{M}=(S,A,P,r,\rho_{0},\gamma)
\pi_{T}
\hat{\pi}_{T}
T
\mathcal{G}^{\textrm{base}}
\pi_{T}
\hat{\pi}_{T}
\mathcal{M}
\displaystyle\mathcal{G}^{\textrm{base}}(\pi_{T},\hat{\pi}_{T})=\mathbb{E}_{a_%
{t}\sim\pi_{T}(s_{t},\cdot)}\left[\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},a_{t},s%
_{t+1})\right]
\displaystyle\mathcal{G}^{\textrm{base}}(\pi_{T},\hat{\pi}_{T})=\mathbb{E}_{a_%
{t}\sim\pi_{T}(s_{t},\cdot)}
\displaystyle\left[\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},a_{t},s_{t+1})\right]
\displaystyle\qquad\quad-\mathbb{E}_{\hat{a}_{t}\sim\hat{\pi}_{T}(\hat{s}_{t},%
\cdot)}\left[\sum_{t=0}^{\infty}\gamma^{t}r(\hat{s}_{t},\hat{a}_{t},\hat{s}_{t%
+1})\right]
\displaystyle\qquad\quad-\mathbb{E}_{\hat{a}_{t}\sim\hat{\pi}_{T}(\hat{s}_{t},%
\cdot)}\left[\sum_{t=0}^{\infty}\gamma^{t}r(\hat{s}_{t},\hat{a}_{t},\hat{s}_{t%
+1})\right]
T
\mathcal{M}
\mathcal{A}
\mathcal{M}=(S,A,P,r,\rho_{0},\gamma)
\mathcal{G}_{\mathbb{A}}
F:\mathbb{A}\to\mathbb{A}
F(\mathcal{A})
\mathcal{M}
\mathcal{A}
\mathcal{M}=(S,A,P,r,\rho_{0},\gamma)
\mathcal{G}_{R}
F_{t}:(\Pi\times S\times A\times S\times\mathbb{R})^{t}\times\mathbb{R}\to%
\mathbb{R}
\mathcal{A}
\mathcal{M}
t
\hat{r}_{t}(s_{t},a_{t},s^{\prime}_{t})=F_{t-1}(H_{t-1},r_{t})
H_{t-1}
\mathcal{A}
\mathcal{A}
\mathcal{M}=(S,A,P,r,\rho_{0},\gamma)
\mathcal{G}_{S}
F_{t}:(\Pi\times S\times A\times S\times\mathbb{R})^{t}\times S\to S
\mathcal{A}
\mathcal{M}
t
\hat{s}_{t}=F_{t-1}(H_{t-1},s_{t})
H_{t-1}
\mathcal{A}
\mathcal{A}
\mathcal{M}=(S,A,P,r,\rho_{0},\gamma)
\mathcal{G}_{\mathcal{P}}
F_{t}:(\Pi\times S\times A\times S\times\mathbb{R})^{t}\times(S\times A\times S%
)\to\mathbb{R}
\mathcal{A}
\mathcal{M}
t
\hat{P}(s_{t},a_{t},s^{\prime}_{t})=F_{t-1}(H_{t-1},s_{t},a_{t},s^{\prime}_{t})
H_{t-1}
\mathcal{A}
\mathcal{A}
\mathcal{M}=(S,A,\mathcal{P},r,\rho_{0},\gamma)
\mathcal{G}_{\pi}
F_{t}:(\Pi\times S\times A\times S\times\mathbb{R})^{t}\times S\times\Delta(A)%
\to\Delta(A)
\mathcal{A}
\mathcal{M}
\mathcal{A}
t
\hat{\pi_{t}}(s_{t},\cdot)=F_{t-1}(H_{t-1},s_{t},\pi_{t}(s_{t},\cdot))
H_{t-1}
\mathcal{A}
\hat{\pi}
\mathcal{M}
F_{t}
F_{t}
\hat{\pi}
\mathcal{M}
F_{t}
H_{t}
\hat{\pi}
\mathcal{G}_{S}^{\pi}
Q
\gamma c
\gamma>\dfrac{1}{1+c}
\mathbb{E}[\max_{i}[X_{i}]]\neq\max_{i}[\mathbb{E}[X_{i}]]\>\>\textrm{where}\>%
\>X=\{X_{1},X_{2},\dots,X_{N}\}
Q^{\textrm{I}}(s,a)\leftarrow Q^{\textrm{I}}(s,a)+\alpha(s,a)(r(s,a)+\gamma Q^%
{\textrm{II}}(s^{\prime},\max_{a}Q^{\textrm{I}}(s^{\prime},a))-Q^{\textrm{I}}(%
s^{\prime},a))
Q^{\textrm{II}}(s,a)\leftarrow Q^{\textrm{II}}(s,a)+\alpha(s,a)(r(s,a)+\gamma Q%
^{\textrm{I}}(s^{\prime},\max_{a}Q^{\textrm{II}}(s^{\prime},a))-Q^{\textrm{II}%
}(s^{\prime},a)).
\epsilon
Q
\epsilon
\mathcal{G}_{\pi}
\epsilon
\epsilon
1-\epsilon
\epsilon
\mathcal{A}
\mathcal{B}
\mathcal{A}
\mathcal{A}
\mathcal{A}
\mathcal{G}_{S}
\mathcal{G}_{S}
\mathcal{G}_{\mathbb{A}}
\mathcal{G}_{\mathbb{A}}
L_{2}/L_{1}
L_{2}/L_{1}
\mathcal{G}_{\mathbb{A}}
\mathcal{G}_{\mathbb{A}}
\mathcal{G}_{\mathbb{A}}
\mathcal{G}_{\mathbb{A}}
L_{2}/L_{1}
\mathcal{G}_{\mathcal{P}}
\mathcal{G}_{R}
\ell_{2}
\ell_{2}
\ell_{2}
\mathcal{G}_{\mathbb{A}}
\mathcal{G}_{R}
\mathcal{G}^{S}
\mathcal{G}_{\mathcal{P}}
\mathcal{G}^{S}
\mathcal{G}_{\mathcal{P}}
L_{\textrm{M}}
\mathnormal{\displaystyle s_{\textrm{adv}}=s+\epsilon\cdot\frac{\nabla_{x}J(%
\displaystyle s,Q(s,a))}{\left\lVert\nabla_{s}J(s,Q(s,a))\right\rVert_{p}},}
\displaystyle v_{t+1}=\mu\cdot v_{t}+\dfrac{\nabla_{s_{\textrm{adv}}}J(s_{%
\textrm{adv}}^{t}+\mu\cdot v_{t},a)}{\lVert\nabla_{s_{\textrm{adv}}}J(s_{%
\textrm{adv}}^{t}+\mu\cdot v_{t},a)\rVert_{1}}
\displaystyle v_{t+1}=\mu\cdot v_{t}
\displaystyle+\dfrac{\nabla_{s_{\textrm{adv}}}J(s_{\textrm{adv}}^{t}+\mu\cdot v%
_{t},a)}{\lVert\nabla_{s_{\textrm{adv}}}J(s_{\textrm{adv}}^{t}+\mu\cdot v_{t},%
a)\rVert_{1}}
\displaystyle s_{\textrm{adv}}^{t+1}=s_{\textrm{adv}}^{t}+\alpha\cdot\dfrac{v_%
{t+1}}{\lVert v_{t+1}\rVert_{2}}
\displaystyle s_{\textrm{adv}}^{t+1}
\displaystyle=s_{\textrm{adv}}^{t}+\alpha\cdot\dfrac{v_{t+1}}{\lVert v_{t+1}%
\rVert_{2}}
J(s_{\textrm{adv}},a)
s_{\textrm{adv}}
\mu
R^{\textrm{agent}}=\mathbb{E}_{s_{0}\sim\rho;a^{\textrm{agent}}\sim\pi^{%
\textrm{agent}};a^{\textrm{adv}}\sim\pi^{\textrm{adv}}}[\sum_{t=0}^{T-1}r^{%
\textrm{agent}}(s,a^{\textrm{agent}},a^{\textrm{adv}})]
\pi^{\textrm{adv}}
\pi^{\textrm{agent}}
r^{\textrm{agent}}
R^{\textrm{agent}^{*}}=\min_{\pi^{\textrm{adv}}}\max_{\pi^{\textrm{agent}}}R^{%
\textrm{agent}}(\pi^{\textrm{agent}},\pi^{\textrm{adv}})=\max_{\pi^{\textrm{%
agent}}}\min_{\pi^{\textrm{adv}}}R^{\textrm{agent}}(\pi^{\textrm{agent}},\pi^{%
\textrm{adv}})
\mathcal{G}_{\mathcal{P}}
\ell_{p}
Q
\mathcal{H}(r_{i}+\gamma\max_{a}\hat{Q}_{\hat{\theta}}(s_{i},a;\theta)-Q_{%
\theta}(s_{i},a_{i};\theta))+\kappa\mathcal{R}(\theta)
\mathcal{H}
\hat{Q}
\kappa
\mathcal{R}(\theta)
\displaystyle\max\{\max_{\hat{s}\in B(s)}\max_{a\neq\operatorname*{arg\,max}_{%
a^{\prime}}Q(s,a^{\prime})}Q_{\theta}(\hat{s},a)-Q_{\theta}(\hat{s},%
\operatorname*{arg\,max}_{a^{\prime}}Q(s,a^{\prime})),-c\}.
\displaystyle\max\{\max_{\hat{s}\in B(s)}\max_{a\neq\operatorname*{arg\,max}_{%
a^{\prime}}Q(s,a^{\prime})}Q_{\theta}(\hat{s},a)-Q_{\theta}(\hat{s},%
\operatorname*{arg\,max}_{a^{\prime}}Q(s,a^{\prime})),-c\}.
B(s)
\ell_{p}
\epsilon
\mathcal{G}_{S}^{S}
\eta^{*}=\operatorname*{arg\,max}_{\eta}\mathbb{E}_{\varepsilon\sim\rho(%
\varepsilon)}\mathbb{E}_{\theta_{0}\sim\rho(\theta_{0})}[\mathbb{E}_{\theta_{N%
}}[\sum_{t=0}^{\infty}\gamma^{t}r_{t}]]
\eta
\rho(\varepsilon)
\rho(\theta_{0})
\mathbb{E}_{\theta_{N}}[\sum_{t=0}^{\infty}\gamma^{t}r_{t}]
\mathcal{G}_{\mathbb{A}}
\mathcal{G}_{R}
r(s,a)
r^{\prime}(s,a)
\mathcal{G}_{S}
\mathcal{G}_{\pi}
\mathcal{G}_{\pi}
\mathcal{G}_{R}
\displaystyle\textrm{max}\sum_{s\in S_{\rho}}\min_{a\in A}\{p(\mathbb{E}_{s^{%
\prime}\sim\mathcal{P}(s,a_{1}|\cdot)}\mathcal{V}^{\pi}(s^{\prime})-\mathbb{E}%
_{s^{\prime}\sim\mathcal{P}(s,a|\cdot)}\mathcal{V}^{\pi}(s^{\prime}))\}
\displaystyle\textrm{max}\sum_{s\in S_{\rho}}
\displaystyle\min_{a\in A}\{p(\mathbb{E}_{s^{\prime}\sim\mathcal{P}(s,a_{1}|%
\cdot)}\mathcal{V}^{\pi}(s^{\prime})-\mathbb{E}_{s^{\prime}\sim\mathcal{P}(s,a%
|\cdot)}\mathcal{V}^{\pi}(s^{\prime}))\}
\displaystyle\textrm{s.t.}\>\>|\alpha_{i}|\leq 1\>,\>i=1,2,\dots,d
\displaystyle\textrm{s.t.}\>\>|\alpha_{i}|\leq 1\>,\>i=1,2,\dots,d
p(x)=x
x\geq 0
p(x)=2x
\mathcal{V}^{\pi}=\alpha_{1}\mathcal{V}^{\pi}_{1}+\alpha_{2}\mathcal{V}^{\pi}_%
{2}+\dots+\alpha_{d}\mathcal{V}^{\pi}_{d}
Q
