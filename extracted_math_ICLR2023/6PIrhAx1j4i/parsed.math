{}q(x_{t}|x_{t-1})\coloneqq\mathcal{N}(x_{t};\sqrt{1-\beta_{t}}x_{t-1},\beta_{%
t}I),
\beta_{1},\dots,\beta_{t}
x_{t}
x_{0}
x_{t}=\sqrt{\bar{\alpha}_{t}}x_{0}+\sqrt{1-\bar{\alpha}_{t}}\mathbf{z}
\mathbf{z}\sim\mathcal{N}(0,I)
\alpha_{t}\coloneqq 1-\beta_{t}
\bar{\alpha}_{t}\coloneqq\prod_{s=1}^{t}\alpha_{s}
{}p_{\theta}(x_{t-1}|x_{t})\coloneqq\mathcal{N}(x_{t};a_{\theta}(x_{t},t),%
\sigma_{t}).
\epsilon_{\theta}(x_{t},t)
x_{t}
t
x_{t}
\sigma_{t}
\epsilon_{\theta}(x_{t},t)
s_{\theta}(x_{t},t)
s_{\theta}(x_{t},t)=\frac{\epsilon_{\theta}(x_{t},t)}{\sqrt{1-\bar{\alpha}_{t}}}
s_{\theta^{*}}(x_{t},t)\approx\nabla_{x}\log p_{t}(x_{t})
p_{t}(x_{t})
t
\theta^{*}
x_{t-1}=\frac{1}{\sqrt{\alpha_{t}}}\left(x_{t}-\frac{1-\alpha_{t}}{\sqrt{1-%
\bar{\alpha}_{t}}}\epsilon_{\theta}\left(x_{t},t\right)\right)+\sigma_{t}%
\mathbf{z},
x_{T}\sim\mathcal{N}(0,I)
\mathbf{z}\sim\mathcal{N}(0,I)
p_{t}
{}x_{t-1}=\sqrt{\bar{\alpha}_{t-1}}\left(\frac{x_{t}-\sqrt{1-\bar{\alpha}_{t}}%
\epsilon_{\theta}(x_{t},t)}{\sqrt{\bar{\alpha}_{t}}}\right)+\sqrt{1-\bar{%
\alpha}_{t-1}}\cdot\epsilon_{\theta}(x_{t},t).
x_{T}\sim\mathcal{N}(0,I)
T
{}dx=-\frac{1}{2}\beta(t)xdt+\sqrt{\beta(t)}dw.
dx
x
dt
w
dw
p_{0}
{}dx=-\frac{\beta(t)}{2}\left[x+\nabla_{x}\log p_{t}(x)\right]dt,
p_{t}
\nabla_{x}\log p_{t}(x)
p_{0}
{}\frac{\partial p_{t}}{\partial t}=\frac{\beta(t)}{2}\left[\nabla_{x}\cdot(xp%
_{t})+\nabla^{2}_{x}p_{t}\right].
\beta(t)
dt\coloneqq\frac{\beta(t)}{2}dt,
{}\frac{\partial p_{t}}{\partial t}=\nabla_{x}\cdot(xp_{t})+\nabla^{2}_{x}p_{t}.
\beta(t)
{}dx=-\left[x+\nabla_{x}\log p_{t}(x)\right]dt.
\mu_{0}
t
E_{\mu_{0}}(t,\cdot)
x\sim\mu_{0}
E_{\mu_{0}}(t,x)
t
t\to\infty
E_{\mu_{0}}(x)\coloneqq\lim_{t\to\infty}E_{\mu_{0}}(t,x).
E_{\mu_{0}}
\mu_{t}
E_{\mu}
\mu_{0}
\pi\coloneqq\mu_{\infty}\sim\mathcal{N}(0,I)
\{\mu_{t}\}_{t=0}^{\infty}
\mathcal{N}(0,I)
\mu_{0}\sim\mathcal{N}(a,I)
a\in\mathbb{R}^{n}
I\in\mathbb{R}^{n\times n}
\mu_{t}\sim\mathcal{N}(ae^{-t},I).
\frac{dx}{dt}=-ae^{-t}
t\to\infty
E_{\mu_{0}}(x)=x-a
\mu_{0}
\mathcal{N}(0,I)
2d
\mu
E_{\mu}
2d
\mu
E_{\mu}
\mu
\nu
X
Y
\mu
\nu
\gamma\in\mathcal{P}(X\times Y)
\mu
\nu
\Pi(\mu,\nu)
\int c(x,y)\gamma(x,y)dxdy\to\min_{\gamma\in\Pi(\mu,\nu)},
c(x,y)
\mu,\nu
S:X\rightarrow Y
\int c(x,S(x))\mu(x)dx\to\inf_{S},
\mu
S
\nu=S_{{\#}}\mu
S_{{\#}}\mu
(S_{{\#}}\mu)(A)=\mu(S^{-1}(A))
A
c(x,y)=\|x-y\|^{2}
W_{2}(\cdot,\cdot)
\mu_{0}\sim\mathcal{N}(a(0),\Sigma(0))
E_{\mu_{0}}
\mu_{0}
\mathcal{N}(0,I)
E_{\mu_{0}}(x)=\Sigma(0)^{-\nicefrac{{1}}{{2}}}(x-a(0)).
p_{0}(x)\equiv p(x,0)
N
p
d
\mathcal{P}
\mathcal{P}[n_{1},n_{2},\ldots,n_{d}]\approx\sum_{r_{1}=1}^{R_{1}}\sum_{r_{2}=%
1}^{R_{2}}\cdots\sum_{r_{d-1}=1}^{R_{d-1}}\mathcal{G}_{1}[1,n_{1},r_{1}]%
\mathcal{G}_{2}[r_{1},n_{2},r_{2}]\ldots\mathcal{G}_{d}[r_{d-1},n_{d},1],
n_{k}=1,2,\ldots,N
k=1,2,\ldots,d
\mathcal{G}_{k}\in\mathbb{R}^{R_{k-1}\times N\times R_{k}}
R_{0},R_{1},\ldots,R_{d}
R_{0}=R_{d}=1
\mathcal{G}_{1},\mathcal{G}_{2},\ldots,\mathcal{G}_{d}
d\times N\times\max_{1\leq k\leq d}{R_{k}^{2}}
N^{d}
m=1,2,\ldots,\frac{t_{max}}{h}
p(x,mh)
X_{0}
p_{0}(x)
X_{1}
X_{0}
X_{1}
x_{i}\in X_{0}
E_{p}(x_{i})\in X_{1}
d
a_{1}\in\mathbb{R}^{d},a_{2}\in\mathbb{R}^{d},Q_{1}\in\mathbb{R}^{d\times d},Q%
_{2}\in\mathbb{R}^{d\times d}
Q_{1}
Q_{2}
p(x)
x\in\mathbb{R}^{d}
\displaystyle p(x)=\frac{1}{Z}\exp{(-q_{1}(x)-q_{2}(x))},
\displaystyle p(x)
\displaystyle=\frac{1}{Z}\exp{(-q_{1}(x)-q_{2}(x))},
\displaystyle q_{1}(x)=(x-a_{1})^{T}Q_{1}(x-a_{1}),\quad q_{2}(x)=\left((x-a_{%
2})^{2}\right)^{T}Q_{2}(x-a_{2})^{2},
\displaystyle q_{1}(x)
\displaystyle=(x-a_{1})^{T}Q_{1}(x-a_{1}),\quad q_{2}(x)=\left((x-a_{2})^{2}%
\right)^{T}Q_{2}(x-a_{2})^{2},
q_{2}
q_{2}
4
Z
5
p(x)=\frac{1}{K}\sum_{i=1}^{K}p_{i}(x),\quad K\sim\text{Uniform}(5),
p_{i}
2
d=2
2
3
d>3
\hat{p}(x)=\frac{1}{Z}q(x)\cdot(2\pi)^{-\frac{d}{2}}\cdot\textit{exp}\left(-%
\frac{||x||^{2}}{2}\right),
Z
q(x)
\mathcal{U}(0,1)
2
1
d=2,3,7
d=2
d=3
d=7
[-8,8]^{d}
[0,5]
100
d
2
\varepsilon_{rel}(p)=\frac{\mathrm{Cost}(E_{p})-\mathrm{Cost}(OT)}{\mathrm{%
Cost}(OT)},
100
100
(0,0)
2
2
2
2
d
\varepsilon_{rel}(p)
2
250
250
5.7\cdot 10^{-15}
3
100
100
2.2\cdot 10^{-15}
7
50
50
2.1\cdot 10^{-15}
\mathcal{N}(0,I)
L_{2}
\mathcal{N}(0,I)
L_{2}
15000
70.000
1000
1000
3\cdot 10^{5}
10^{6}
25\cdot 10^{3}
256\times 256
256
\mathcal{N}(0,I)
\mathbb{R}^{256\times 256\times 3}
500
\mathbb{R}^{256\times 256\times 3}
t=0
\rho_{0}
t=1
\rho_{1}
A=\int_{0}^{1}\left(\sum_{x}|\dot{x}(t)|^{2}\right)dt,
x
v_{t}
\inf_{\rho,v}\left\{\int_{0}^{1}\int\rho_{t}(x)\left|v_{t}(x)\right|^{2}dxdt;%
\ \frac{\partial\rho_{t}}{\partial t}+\nabla\cdot\left(\rho_{t}v_{t}\right)=0\right\}
\{\rho_{t}\}_{t=0}^{1}
\rho_{0}
\rho_{1}
t=0
t=1
\{v_{t}\}_{t=0}^{1}
\rho_{t}
W_{2}(\rho_{0},\rho_{1})^{2}
t\to\infty
\mu_{0}
\mu_{t}
\mu_{t}\sim\mathcal{N}(a(t),\Sigma(t))
\frac{d\Sigma(t)}{dt}=2(I-\Sigma(t));\quad\frac{da(t)}{dt}=-a(t),
\Sigma(t)=I+e^{-2t}(\Sigma(0)-I);\quad a(t)=e^{-t}a(0).
a(0)=0
a(t)\equiv 0
{}\frac{dx}{dt}=-(I-\Sigma^{-1}(t))x.
\Sigma(t)
x(t)=\exp{\left(-\int_{0}^{t}I-\Sigma^{-1}(\tau)d\tau\right)}x(0),
\exp
\Sigma(0)
\Sigma(0)=U^{T}\Lambda U
\Lambda=\text{diag}(\lambda_{1},\dots,\lambda_{d})
U^{T}U=I
{}x(t)=U^{T}\text{diag}(f(\lambda_{1},t),f(\lambda_{2},t),\dots f(\lambda_{d},%
t))Ux(0),
f(\lambda,t)
f(\lambda,t)=\exp{\left(-\int_{0}^{t}1-(1+e^{-2\tau}(\lambda-1))^{-1}d\tau%
\right)},
\begin{split}f(\lambda,t)&=\exp\left(-t+\frac{1}{2}\log{(\lambda-1+e^{2t})}-%
\frac{1}{2}\log\lambda\right)\\
&=\sqrt{\frac{\lambda-1+e^{2t}}{\lambda e^{2t}}}=\sqrt{\frac{e^{-2t}(\lambda-1%
)+1}{\lambda}}.\end{split}
\lim_{t\to\infty}f(\lambda,t)=\lambda^{-\nicefrac{{1}}{{2}}}
E_{\mu_{0}}(x)=\Sigma(0)^{-\nicefrac{{1}}{{2}}}x
\mu_{0}
\mathcal{N}(0,I)
{}\frac{dx}{dt}=-(I-\Sigma^{-1}(t))x-\Sigma^{-1}(t)a(t).
Z(t)
Z(t)=U^{T}\text{diag}(f(\lambda_{1},t),f(\lambda_{2},t),\dots f(\lambda_{d},t)%
)U,
f(\lambda,t)=\sqrt{\frac{e^{-2t}(\lambda-1)+1}{\lambda}}.
0
\bar{x}(t)=-Z(t)\int_{0}^{t}Z^{-1}(\tau)\Sigma^{-1}(\tau)a(\tau)d\tau.
\Sigma(t)=I+e^{-2t}(\Sigma(0)-I);\quad a(t)=e^{-t}a(0).
\bar{x}(t)=\left(-Z(t)\int_{0}^{t}Z^{-1}(\tau)\Sigma^{-1}(\tau)e^{-\tau}d\tau%
\right)a(0).
\bar{x}(t)=U^{T}\text{diag}(g(\lambda_{1},t),g(\lambda_{2},t),\dots,g(\lambda_%
{d},t))Ua(0),
\begin{split}g(\lambda,t)&=-f(\lambda,t)\int_{0}^{t}\frac{e^{-\tau}}{(1+e^{-2%
\tau}(\lambda-1))f(\lambda,\tau)}d\tau\\
&=-\frac{f(\lambda,t)}{\lambda}\int_{0}^{t}\frac{e^{-\tau}}{f^{3}(\lambda,\tau%
)}d\tau\\
&=-\sqrt{\lambda}f(\lambda,t)\int_{0}^{t}\frac{e^{-\tau}}{\left(e^{-2\tau}(%
\lambda-1)+1\right)^{\nicefrac{{3}}{{2}}}}d\tau.\end{split}
\lim_{t\to\infty}g(\lambda,t)=-\frac{1}{\sqrt{\lambda}}.
\lim_{t\to\infty}\bar{x}(t)=-\Sigma(0)^{-\nicefrac{{1}}{{2}}}a(0).
E_{\mu_{0}}(x)=\Sigma(0)^{-\nicefrac{{1}}{{2}}}x-\Sigma(0)^{-\nicefrac{{1}}{{2%
}}}a(0)=\Sigma^{-\nicefrac{{1}}{{2}}}(0)(x-a(0)),
\mu_{0}
\mathcal{N}(0,1)
\widehat{V}p(x,t)\equiv\nabla_{x}^{2}p(x,t),\quad\widehat{W}p(x,t)\equiv\nabla%
_{x}\left(x\,p(x,t)\right),
m
m=1,2,\ldots,M
p_{m+1}=e^{h\left(\widehat{V}+\widehat{W}\right)}p_{m}\approx e^{\frac{h}{2}%
\widehat{V}}e^{h\widehat{W}}e^{\frac{h}{2}\widehat{V}}p_{m},
h
p_{m}(x)=p(x,mh)
m
\frac{\partial p_{D}^{(1)}}{\partial t}=\nabla_{x}^{2}p_{D}^{(1)},\quad p_{D}^%
{(1)}(\,\cdot\,,t_{m})=\rho_{m}(\,\cdot\,),
\frac{\partial p_{C}}{\partial t}=\nabla_{x}(xp_{C}),\quad p_{C}(\,\cdot\,,t_{%
m})=p_{C}^{(1)}(\,\cdot\,,t_{m}+\frac{h}{2}),
\frac{\partial p_{D}^{(2)}}{\partial t}=\nabla_{x}^{2}p_{D}^{(2)},\quad p_{D}^%
{(2)}(\,\cdot\,,t_{m})=p_{C}(\,\cdot\,,t_{m}+h),
\rho_{m+1}(\,\cdot\,)=p_{D}^{(2)}(\,\cdot\,,t_{m}+\frac{h}{2})
p_{m}
m
p(x,mh)
