d^{O}
d^{E}
d^{*}
d^{O}
d^{E}
d^{*}
\min_{\pi}\mathrm{D}_{\mathrm{KL}}(d^{\pi}(s)\|d^{E}(s)),
d
\pi
E
f
f
\mathcal{M}=(S,A,R,T,\mu_{0},\gamma)
S
A
R(s,a)
s^{\prime}\sim T(s,a)
\mu_{0}(s)
\gamma\in(0,1]
\pi:S\rightarrow\Delta(A)
d^{\pi}(s,a):\mathcal{S}\times\mathcal{A}\rightarrow[0,1]
\pi
\begin{split}d^{\pi}(s,a)\coloneqq\;&(1-\gamma)\sum_{t=0}^{\infty}\gamma^{t}%
\text{Pr}(s_{t}=s,a_{t}=a\mid\\
&s_{0}\sim\mu_{0},a_{t}\sim\pi(s_{t}),s_{t+1}\sim T(s_{t},a_{t}))\end{split}
\pi
d^{\pi}(s)=\sum_{a}d^{\pi}(s,a)
d^{\pi}(s,a)=(1-\gamma)\mu_{0}(s)\pi(a\mid s)+\gamma\cdot\mathcal{T}^{\pi}_{%
\star}d^{\pi}(s,a),
\mathcal{T}^{\pi}_{\star}
\mathcal{T}^{\pi}_{\star}d^{\pi}(s,a)\coloneqq\pi(a\mid s)\sum_{\tilde{s},%
\tilde{a}}T(s\mid\tilde{s},\tilde{a})d(\tilde{s},\tilde{a})
f
f
f
p,q\in\Delta(\mathcal{X})
\mathcal{X}
f
p
q
\mathrm{D}_{f}(p\|q)=\mathbb{E}_{x\sim q}\left[f\left(\frac{p(x)}{q(x)}\right)\right]
f
f(x)=x\log x
f
\Omega
\langle\cdot,\cdot\rangle
f_{\star}:\Omega_{\star}\rightarrow\mathbb{R}
f:\Omega\rightarrow\mathbb{R}
f_{\star}(y)\coloneqq\max_{x\in\Omega}\langle x,y\rangle-f(x)
x^{*}
f_{\star}(y)
x^{*}=fâ€™_{\star}(y)
f
f
D_{f}(p\|q)
y:\mathcal{X}\rightarrow\mathbb{R}
\displaystyle\mathrm{D}_{\star,f}(y)=\max_{p\in\Delta(\mathcal{X})}\mathbb{E}_%
{x\sim p}[y(x)]-\mathrm{D}_{f}(p\|q)
\displaystyle\mathrm{D}_{\star,f}(y)
\displaystyle=\max_{p\in\Delta(\mathcal{X})}\mathbb{E}_{x\sim p}[y(x)]-\mathrm%
{D}_{f}(p\|q)
\displaystyle=\mathbb{E}_{x\sim q}[f_{\star}(y(x))]
\displaystyle=\mathbb{E}_{x\sim q}[f_{\star}(y(x))]
p^{*}
\mathrm{D}_{\star,f}(y)
p^{*}(x)=q(x)f^{\prime}_{\star}(y(x)).
f
f
\min_{\pi}\mathrm{D}_{f}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
d^{E}
\mathcal{D}^{E}\coloneqq\{(s^{(i)},a^{(i)})\}_{i=1}^{N}
\mathcal{M}
\mathcal{D}^{O}\coloneqq\{\tau_{i}\}_{i=1}^{M}
\tau^{(i)}=(s_{0}^{(i)},a_{0}^{(i)},s_{1}^{(i)},...)
s_{0}^{(i)}\sim\mu_{0}
\mathcal{D}^{O}
d^{O}(s,a)
f
f
\min_{\pi}\mathrm{D}_{\mathrm{KL}}(d^{\pi}(s)\|d^{E}(s)),
\pi
d^{\pi}
d^{O}
d^{O}(s)>0
d^{E}(s)>0
f
d^{O}
\begin{split}&\mathrm{D}_{\mathrm{KL}}(d^{\pi}(s)\|d^{E}(s))\leq\\
&\mathbb{E}_{s\sim d^{\pi}}\left[\log\left(\frac{d^{O}(s)}{d^{E}(s)}\right)%
\right]+\mathrm{D}_{\mathrm{KL}}(d^{\pi}(s,a)\|d^{O}(s,a))\end{split}
f
\mathrm{D}_{f}\geq\mathrm{D}_{\mathrm{KL}}
\begin{split}&\mathrm{D}_{\mathrm{KL}}(d^{\pi}(s)\|d^{E}(s))\leq\\
&\mathbb{E}_{s\sim d^{\pi}}\left[\log\left(\frac{d^{O}(s)}{d^{E}(s)}\right)%
\right]+\mathrm{D}_{f}(d^{\pi}(s,a)\|d^{O}(s,a))\end{split}
f
R(s)=\log\frac{d^{E}(s)}{d^{O}(s)}
f
R(s)=\log\frac{d^{E}(s)}{d^{O}(s)}
R(s)
d^{E}(s)
d^{O}(s)
c:\mathcal{S}\rightarrow(0,1)
\min_{c}\mathbb{E}_{s\sim d^{E}}\left[\log c(s)\right]+\mathbb{E}_{s\sim d^{O}%
}\left[\log 1-c(s)\right]
c^{\star}(s)=\frac{d^{O}(s)}{d^{E}(s)+d^{O}(s)}
R(s)=-\log\left(\frac{1}{c^{\star}(s)}-1\right)
d^{\pi}
\displaystyle(\mathrm{P})\quad\max_{d(s,a)\geq 0}\mathbb{E}_{s\sim d(s,a)}%
\left[R(s)\right]-\mathrm{D}_{f}(d\|d^{O})
\displaystyle(\mathrm{P})\quad
\displaystyle\max_{d(s,a)\geq 0}\mathbb{E}_{s\sim d(s,a)}\left[R(s)\right]-%
\mathrm{D}_{f}(d\|d^{O})
\displaystyle\text{s.t. }\sum_{a}d(s,a)=(1-\gamma)\mu_{0}(s)+\gamma\mathcal{T}%
_{\star}d(s),\forall s\in S
\displaystyle\text{s.t. }\sum_{a}d(s,a)=(1-\gamma)\mu_{0}(s)+\gamma\mathcal{T}%
_{\star}d(s),\forall s\in S
\mathcal{T}_{\star}d(s)=\sum_{\bar{s},\bar{a}}T(s\mid\bar{s},\bar{a})d(\bar{s}%
,\bar{a})
d
d(s,a)
\forall s\in\mathcal{S},d(s)>0
\begin{split}(\mathrm{D})\quad&\max_{d(s,a)\geq 0}\min_{V(s)\geq 0}\mathbb{E}_%
{s\sim d}\left[R(s)\right]-\mathrm{D}_{f}(d\|d^{O})\\
&+\sum_{s}V(s)\left((1-\gamma)\mu_{0}(s)+\gamma\mathcal{T}_{\star}d(s)-\sum_{a%
}d(s,a)\right)\end{split}
V(s)
\mathcal{T}_{\star}
\mathcal{T}
\sum_{s}V(s)\cdot\mathcal{T}_{\star}d(s)=\sum_{s,a}d(s,a)\cdot(\mathcal{T}V)(s%
,a)
\begin{split}(\mathrm{D})\quad&\max_{d(s,a)\geq 0}\min_{V(s)\geq 0}(1-\gamma)%
\mathbb{E}_{s\sim\mu_{0}}[V(s)]\\
&+\mathbb{E}_{(s,a)\sim d}\left[R(s)+\gamma\mathcal{T}V(s,a)-V(s)\right]\\
&-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))\\
\end{split}
\begin{split}(\mathrm{D})\quad&\min_{V(s)\geq 0}\max_{d(s,a)\geq 0}(1-\gamma)%
\mathbb{E}_{s\sim\mu_{0}}[V(s)]\\
&+\mathbb{E}_{(s,a)\sim d}\left[\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s)\right)%
\right]\\
&-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))\end{split}
V:\mathcal{S}\rightarrow\mathbb{R}_{\geq 0}
d^{O}
d
\begin{split}(\mathrm{D})\quad&\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu%
_{0}}[V(s)]\\
&+\mathbb{E}_{(s,a)\sim d^{O}}\left[f_{\star}\left(R(s)+\gamma\mathcal{T}V(s,a%
)-V(s)\right)\right]\end{split}
V^{*}
\frac{d^{*}(s,a)}{d^{O}(s,a)}=f^{\prime}_{\star}(R(s)+\gamma\mathcal{T}V^{*}(s%
,a)-V^{*}(s))
D_{f}(d(s,a)\|d^{O}(s,a))
R(s)+\gamma\mathcal{T}V(s,a)-V(s)
f
\chi^{2}
\pi
\begin{split}&\min_{\pi}-\mathbb{E}_{(s,a)\sim d^{*}}[\log\pi(a\mid s)]\\
=&\min_{\pi}-\mathbb{E}_{(s,a)\sim d^{O}}[\xi^{*}(s,a)\log\pi(a\mid s)]\end{split}
\xi^{*}(s,a)=\frac{d^{*}(s,a)}{d^{O}(s,a)}
V(s)
c^{*}(s)
R(s)
V(s)
\xi^{*}(s,a)
\pi
R(s)=\log\frac{d^{E}(s)}{d^{O}(s)}\in\mathbb{R}_{+}^{|\mathcal{S}|}
\mathcal{T}\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|\times|\mathcal{S}|}
\mathcal{B}\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|\times|\mathcal{S}|}
(\mathcal{T}V)(s,a)=\sum_{s^{\prime}}T(s^{\prime}|s,a)V(s^{\prime})
(\mathcal{B}V)(s,a)=V(s)
\mu_{0}\in\Delta(|\mathcal{S}|)
D=\mathrm{diag}(d^{O})\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|\times|\mathcal%
{S}||\mathcal{A}|}
\chi^{2}
\begin{split}V^{*}=&\left((\gamma\mathcal{T}-\mathcal{B})^{\top}D(\gamma%
\mathcal{T}-\mathcal{B})\right)^{-1}\\
&\left((\gamma-1)\mu_{0}+(\mathcal{B}-\gamma\mathcal{T})^{\top}D(I+BR)\right)%
\end{split}
S^{*}=\{s^{*}\sim p_{U}(s_{t}\mid e_{t}=1)\}
e\in\{0,1\}
\mathcal{D}=\{(s,a,s^{\prime})\}
U
\arg\max_{\pi}\log p^{\pi}(e_{t+}=1)=\log\mathbb{E}_{s\sim\mu_{0}}\left[p^{\pi%
}(e_{t+}=1|s_{0})\right]
d^{\pi}(s)
d^{\pi}(s)>0
s\in\mathcal{S}^{*}
\sum_{s\in\mathcal{S}^{*}}d^{\pi}(s)
\sum_{s\notin\mathcal{S}^{*}}d^{\pi}(s)
\max_{\pi}\log\mathbb{E}_{s\sim\mu_{0}}\left[p^{\pi}(e_{t+}=1|s_{0})\right]=%
\max_{d\geq 0}\log\mathbb{E}_{s\sim d(s)}\left[p(e|s)\right]
r(s)=p(e\mid s)
\displaystyle\begin{split}&\log\mathbb{E}_{s\sim d(s)}\left[p_{U}(e\mid s)%
\right]\\
\geq&\mathbb{E}_{s\sim d(s)}\left[\log p_{U}(e\mid s)\right]\\
=&\mathbb{E}_{s\sim d(s)}\left[\log\frac{p_{U}(s\mid e)p_{U}(e)}{p_{U}(s)}%
\right]\\
=&\mathbb{E}_{s\sim d(s)}\left[\log\frac{p_{U}(s\mid e)}{d(s)}\right]+\mathbb{%
E}_{s\sim d(s)}\left[\log\frac{d(s)}{p_{U}(s)}\right]+\mathrm{const.}\\
=&-\mathrm{D}_{\mathrm{KL}}\left(d(s)\|p_{U}(s\mid e)\right)+\mathrm{D}_{%
\mathrm{KL}}\left(d(s)\|p_{U}(s)\right)+\mathrm{const.}\\
\geq&-\mathrm{D}_{\mathrm{KL}}\left(d(s)\|p_{U}(s\mid e)\right)+\mathrm{const.%
}\\
\end{split}
\displaystyle\begin{split}&\log\mathbb{E}_{s\sim d(s)}\left[p_{U}(e\mid s)%
\right]\\
\geq&\mathbb{E}_{s\sim d(s)}\left[\log p_{U}(e\mid s)\right]\\
=&\mathbb{E}_{s\sim d(s)}\left[\log\frac{p_{U}(s\mid e)p_{U}(e)}{p_{U}(s)}%
\right]\\
=&\mathbb{E}_{s\sim d(s)}\left[\log\frac{p_{U}(s\mid e)}{d(s)}\right]+\mathbb{%
E}_{s\sim d(s)}\left[\log\frac{d(s)}{p_{U}(s)}\right]+\mathrm{const.}\\
=&-\mathrm{D}_{\mathrm{KL}}\left(d(s)\|p_{U}(s\mid e)\right)+\mathrm{D}_{%
\mathrm{KL}}\left(d(s)\|p_{U}(s)\right)+\mathrm{const.}\\
\geq&-\mathrm{D}_{\mathrm{KL}}\left(d(s)\|p_{U}(s\mid e)\right)+\mathrm{const.%
}\\
\end{split}
\min_{d\geq 0}\mathrm{D}_{\mathrm{KL}}\left(d(s)\|p_{U}(s\mid e)\right),
p_{U}(s\mid e)
f
xy
\leq 200
\approx
\chi^{2}
f
xy
\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\xi(s,a)
\mathrm{D}_{\mathrm{KL}}(d^{\pi}(s)\|d^{E}(s))\leq\mathrm{D}_{\mathrm{KL}}(d^{%
\pi}(s,a)\|d^{E}(s,a))
\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a,s^{\prime})\|d^{E}(s,a,s^{\prime})%
\right)=\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right).
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a,s^{\prime})\|d^{E}(s,a,%
s^{\prime})\right)
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a,s^{\prime})\|d^{E}(s,a,%
s^{\prime})\right)
\displaystyle=\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s,a,%
s^{\prime})\log\frac{d^{\pi}(s,a)\cdot T(s^{\prime}\mid s,a)}{d^{E}(s,a)\cdot T%
(s^{\prime}\mid s,a)}ds^{\prime}dads
\displaystyle=
\displaystyle\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s,a,s%
^{\prime})\log\frac{d^{\pi}(s,a)\cdot T(s^{\prime}\mid s,a)}{d^{E}(s,a)\cdot T%
(s^{\prime}\mid s,a)}ds^{\prime}dads
\displaystyle=\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s,a,%
s^{\prime})\log\frac{d^{\pi}(s,a)}{d^{E}(s,a)}ds^{\prime}dads
\displaystyle=
\displaystyle\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s,a,s%
^{\prime})\log\frac{d^{\pi}(s,a)}{d^{E}(s,a)}ds^{\prime}dads
\displaystyle=\int_{\mathcal{S}\times\mathcal{A}}d^{\pi}(s,a)\log\frac{d^{\pi}%
(s,a)}{d^{E}(s,a)}dads
\displaystyle=
\displaystyle\int_{\mathcal{S}\times\mathcal{A}}d^{\pi}(s,a)\log\frac{d^{\pi}(%
s,a)}{d^{E}(s,a)}dads
\displaystyle=\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
\displaystyle=
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
\displaystyle=\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a,s^{\prime})\|d^{E}(s,a%
,s^{\prime})\right)
\displaystyle=
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a,s^{\prime})\|d^{E}(s,a,%
s^{\prime})\right)
\displaystyle=\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s,a,%
s^{\prime})\log\frac{d^{\pi}(s,a)\cdot T(s^{\prime}\mid s,a)}{d^{E}(s,a)\cdot T%
(s^{\prime}\mid s,a)}ds^{\prime}dads
\displaystyle=
\displaystyle\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s,a,s%
^{\prime})\log\frac{d^{\pi}(s,a)\cdot T(s^{\prime}\mid s,a)}{d^{E}(s,a)\cdot T%
(s^{\prime}\mid s,a)}ds^{\prime}dads
\displaystyle=\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s)%
\pi(a\mid s)T(s^{\prime}\mid s,a)\log\frac{d^{\pi}(s,a)\cdot T(s^{\prime}\mid s%
,a)}{d^{E}(s,a)\cdot T(s^{\prime}\mid s,a)}ds^{\prime}dads
\displaystyle=
\displaystyle\int_{\mathcal{S}\times\mathcal{A}\times\mathcal{S}}d^{\pi}(s)\pi%
(a\mid s)T(s^{\prime}\mid s,a)\log\frac{d^{\pi}(s,a)\cdot T(s^{\prime}\mid s,a%
)}{d^{E}(s,a)\cdot T(s^{\prime}\mid s,a)}ds^{\prime}dads
\displaystyle=\int d^{\pi}(s)\pi(a\mid s)T(s^{\prime}\mid s,a)\log\frac{d^{\pi%
}(s)}{d^{E}(s)}ds^{\prime}dads+\int d^{\pi}(s)\pi(a\mid s)T(s^{\prime}\mid s,a%
)\log\frac{\pi(a\mid s)T(s^{\prime}\mid s,a)}{\pi^{E}(a\mid s)T(s^{\prime}\mid
s%
,a)}ds^{\prime}dads
\displaystyle=
\displaystyle\int d^{\pi}(s)\pi(a\mid s)T(s^{\prime}\mid s,a)\log\frac{d^{\pi}%
(s)}{d^{E}(s)}ds^{\prime}dads+\int d^{\pi}(s)\pi(a\mid s)T(s^{\prime}\mid s,a)%
\log\frac{\pi(a\mid s)T(s^{\prime}\mid s,a)}{\pi^{E}(a\mid s)T(s^{\prime}\mid s%
,a)}ds^{\prime}dads
\displaystyle=\int d^{\pi}(s)\log\frac{d^{\pi}(s)}{d^{E}(s)}ds+\int d^{\pi}(s)%
\pi(a\mid s)\log\frac{\pi(a\mid s)}{\pi^{E}(a\mid s)}dads
\displaystyle=
\displaystyle\int d^{\pi}(s)\log\frac{d^{\pi}(s)}{d^{E}(s)}ds+\int d^{\pi}(s)%
\pi(a\mid s)\log\frac{\pi(a\mid s)}{\pi^{E}(a\mid s)}dads
\displaystyle=\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)+%
\mathrm{D}_{\mathrm{KL}}\left(\pi(a\mid s)\|\pi^{E}(a\mid s)\right)
\displaystyle=
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)+\mathrm%
{D}_{\mathrm{KL}}\left(\pi(a\mid s)\|\pi^{E}(a\mid s)\right)
\displaystyle\geq\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)
\displaystyle\geq
\displaystyle\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)
\displaystyle D_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)
\displaystyle D_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)
\displaystyle=\int d^{\pi}(s)\log\frac{d^{\pi}(s)}{d^{E}(s)}\cdot\frac{d^{O}(s%
)}{d^{O}(s)}ds,\quad\text{we assume that $d^{O}(s)>0$ whenever $d^{E}(s)>0$.}
d^{O}(s)>0
d^{E}(s)>0
\displaystyle=
\displaystyle\int d^{\pi}(s)\log\frac{d^{\pi}(s)}{d^{E}(s)}\cdot\frac{d^{O}(s)%
}{d^{O}(s)}ds,\quad\text{we assume that $d^{O}(s)>0$ whenever $d^{E}(s)>0$.}
d^{O}(s)>0
d^{E}(s)>0
\displaystyle=\int d^{\pi}(s)\log\frac{d^{O}(s)}{d^{E}(s)}ds+\int d^{\pi}(s)%
\log\frac{d^{\pi}(s)}{d^{O}(s)}ds
\displaystyle=
\displaystyle\int d^{\pi}(s)\log\frac{d^{O}(s)}{d^{E}(s)}ds+\int d^{\pi}(s)%
\log\frac{d^{\pi}(s)}{d^{O}(s)}ds
\displaystyle\leq\mathbb{E}_{s\sim d^{\pi}}\left[\log\frac{d^{O}(s)}{d^{E}(s)}%
\right]+\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
\displaystyle\leq
\displaystyle\mathbb{E}_{s\sim d^{\pi}}\left[\log\frac{d^{O}(s)}{d^{E}(s)}%
\right]+\mathrm{D}_{\mathrm{KL}}\left(d^{\pi}(s,a)\|d^{E}(s,a)\right)
\mathrm{D}_{f}\geq\mathrm{D}_{\mathrm{KL}}
D_{\mathrm{KL}}\left(d^{\pi}(s)\|d^{E}(s)\right)\leq\mathbb{E}_{s\sim d^{\pi}}%
\left[\log\frac{d^{O}(s)}{d^{E}(s)}\right]+\mathrm{D}_{f}\left(d^{\pi}(s,a)\|d%
^{E}(s,a)\right)
\min_{V(s)\geq 0}\max_{d(s,a)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+%
\mathbb{E}_{(s,a)\sim d}\left[\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s)\right)%
\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle\min_{V(s)\geq 0}\max_{d(s,a)\geq 0}(1-\gamma)\mathbb{E}_{s\sim%
\mu_{0}}[V(s)]+\mathbb{E}_{(s,a)\sim d}\left[\left(R(s)+\gamma\mathcal{T}V(s,a%
)-V(s)\right)\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle\min_{V(s)\geq 0}\max_{d(s,a)\geq 0}(1-\gamma)\mathbb{E}_{s\sim%
\mu_{0}}[V(s)]+\mathbb{E}_{(s,a)\sim d}\left[\left(R(s)+\gamma\mathcal{T}V(s,a%
)-V(s)\right)\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle=\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\max_%
{d(s,a)\geq 0}+\mathbb{E}_{(s,a)\sim d}\left[\left(R(s)+\gamma\mathcal{T}V(s,a%
)-V(s)\right)\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle=
\displaystyle\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\max_{%
d(s,a)\geq 0}+\mathbb{E}_{(s,a)\sim d}\left[\left(R(s)+\gamma\mathcal{T}V(s,a)%
-V(s)\right)\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle=\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+%
\mathbb{E}_{(s,a)\sim d^{O}}\left[f_{\star}\left(R(s)+\gamma\mathcal{T}V(s,a)-%
V(s)\right)\right]
\displaystyle=
\displaystyle\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+%
\mathbb{E}_{(s,a)\sim d^{O}}\left[f_{\star}\left(R(s)+\gamma\mathcal{T}V(s,a)-%
V(s)\right)\right]
D_{f}(d(s,a)\|d^{O}(s,a))
R(s)+\gamma\mathcal{T}V(s,a)-V(s)
V^{\star}
\xi^{\star}
\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\mathbb{E}_{(s,a)%
\sim d^{O}}\left[f_{\star}\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s)\right)\right]
\displaystyle\max_{d(s,a)\geq 0}\mathbb{E}_{s\sim d}\left[\log\left(\frac{d^{E%
}(s)}{d^{O}(s)}\right)\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle\max_{d(s,a)\geq 0}\mathbb{E}_{s\sim d}\left[\log\left(\frac{d^{E%
}(s)}{d^{O}(s)}\right)\right]-\mathrm{D}_{f}(d(s,a)\|d^{O}(s,a))
\displaystyle\text{s.t. }\sum_{a}d(s,a)=(1-\gamma)\mu_{0}(s)+\gamma\mathcal{T}%
_{\star}d(s),\forall s\in S
\displaystyle\text{s.t. }\sum_{a}d(s,a)=(1-\gamma)\mu_{0}(s)+\gamma\mathcal{T}%
_{\star}d(s),\forall s\in S
\delta_{\mathcal{X}}(x)
\delta_{\mathcal{X}}(x)=\begin{cases}0&x\in\mathcal{X}\\
\infty&\text{otherwise}\end{cases}
g:\mathbb{R}^{|\mathcal{S}|}\rightarrow\mathbb{R}
g(\cdot)\coloneqq\delta_{\{(1-\gamma)\mu_{0}\}}(\cdot)
g
g_{\star}(\cdot)=(1-\gamma)\mathbb{E}_{\mu_{0}}[\cdot]
h(\cdot)\coloneqq\mathrm{D}+f(\cdot\|d^{O})
h_{\star}(\cdot)=\mathbb{E}_{(s,a)\sim d^{O}}[f_{\star}(\cdot)]
A\coloneqq\gamma\mathcal{T}_{\star}-I
\min_{V}g_{\star}(V)+h_{\star}(A_{\star}V+R)
\displaystyle\min_{V}g_{\star}(V)+h_{\star}(A_{\star}V+R)
\displaystyle\min_{V}g_{\star}(V)+h_{\star}(A_{\star}V+R)
\displaystyle=\min_{V}\max_{d}g_{\star}(V)+\langle d,A_{\star}V+R\rangle-h(d)
\displaystyle=
\displaystyle\min_{V}\max_{d}g_{\star}(V)+\langle d,A_{\star}V+R\rangle-h(d)
\displaystyle=\min_{V}\max_{d}g_{\star}(V)+\langle d,A_{\star}V\rangle+\langle
d%
,R\rangle-h(d)
\displaystyle=
\displaystyle\min_{V}\max_{d}g_{\star}(V)+\langle d,A_{\star}V\rangle+\langle d%
,R\rangle-h(d)
\displaystyle=\max_{d}\left(\min_{V}g_{\star}(V)+\langle d,A_{\star}V\rangle%
\right)+\langle d,R\rangle-h(d)
\displaystyle=
\displaystyle\max_{d}\left(\min_{V}g_{\star}(V)+\langle d,A_{\star}V\rangle%
\right)+\langle d,R\rangle-h(d)
\displaystyle=\max_{d}\left(\min_{V}g_{\star}(V)+\langle Ad,V\rangle\right)+%
\langle d,R\rangle-h(d)
\displaystyle=
\displaystyle\max_{d}\left(\min_{V}g_{\star}(V)+\langle Ad,V\rangle\right)+%
\langle d,R\rangle-h(d)
\displaystyle=\max_{d}\left(\max_{V}-g_{\star}(V)+\langle-Ad,V\rangle\right)+%
\langle d,R\rangle-h(d)
\displaystyle=
\displaystyle\max_{d}\left(\max_{V}-g_{\star}(V)+\langle-Ad,V\rangle\right)+%
\langle d,R\rangle-h(d)
\displaystyle=\max_{d}g(-Ad)+\langle d,R\rangle-h(d)
\displaystyle=
\displaystyle\max_{d}g(-Ad)+\langle d,R\rangle-h(d)
h_{\star}
g_{\star}
g(-Ad)
\displaystyle g(-Ad)=\delta_{\{(1-\gamma)\mu_{0}\}}\left(d-\gamma\mathcal{T}_{%
\star}d\right)
\displaystyle g(-Ad)=\delta_{\{(1-\gamma)\mu_{0}\}}\left(d-\gamma\mathcal{T}_{%
\star}d\right)
\displaystyle\Leftrightarrow\sum_{a}d(s,a)=(1-\gamma)\mu_{0}(s)+\gamma\mathcal%
{T}_{\star}d(s),\forall s\in S
\displaystyle\Leftrightarrow
\displaystyle\sum_{a}d(s,a)=(1-\gamma)\mu_{0}(s)+\gamma\mathcal{T}_{\star}d(s)%
,\forall s\in S
d^{*}
V^{*}
d^{*}=h^{\prime}_{\star}(-A_{\star}V^{*}+R)
g,h
A
d^{*}=\mathbb{E}_{(s,a)\sim d^{O}}\left[f_{\star}\left((R(s)+\gamma\mathcal{T}%
V(s,a)-V(s)\right)\right],
d^{*}(s,a)=f_{\star}\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s)\right)\cdot d^{O}(%
s,a),\forall s,a\in\mathcal{S}\times\mathcal{A},
f
f
\chi^{2}
f(x)=\frac{1}{2}(x-1)^{2}
\chi^{2}
f_{\star}(x)=\frac{1}{2}(x+1)^{2}
f^{\prime}_{\star}(x)=x+1
\begin{split}&\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\frac%
{1}{2}\mathbb{E}_{(s,a)\sim d^{O}}\left[\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s%
)+1\right)^{2}\right]\end{split}
\xi^{*}(s,a)=\frac{d^{*}(s,a)}{d^{O}(s,a)}=\max\left(0,R(s,a)+\gamma\mathcal{T%
}V^{*}(s,a)-V^{*}(s)+1\right)
f(x)=x\log x
\mathrm{D}_{\star,f}(y)=\log\mathbb{E}_{x\sim q}[\mathrm{exp}y(x)]
\begin{split}&\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\log%
\mathbb{E}_{(s,a)\sim d^{O}}\left[\mathrm{exp}\left(R(s)+\gamma\mathcal{T}V(s,%
a)-V(s)\right)\right]\end{split}
\xi^{*}(s,a)=\frac{d^{*}(s,a)}{d^{O}(s,a)}=\mathrm{softmax}\left(R+\gamma%
\mathcal{T}V^{*}(s,a)-V^{*}(s)\right)
d^{E}(s)\in\Delta(|\mathcal{S}|)
\pi_{b}
\mathcal{D}^{O}
\hat{\mathcal{M}}
\hat{T}(s,a,s^{\prime})=\frac{n(s,a,s^{\prime})}{n(s,a)}
\hat{\mathcal{M}}
d^{O}\in\Delta(|\mathcal{S}||\mathcal{A}|)
R\in\mathbb{R}_{+}^{|\mathcal{S}|}
R(s)=\log\frac{d^{E}(s)}{d^{O}(s)}
\chi^{2}
V(s)\in\mathbb{R}_{+}^{|\mathcal{S}|}
\begin{split}&\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\frac%
{1}{2}\mathbb{E}_{(s,a)\sim d^{O}}\left[\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s%
)+1\right)^{2}\right]\end{split}
\mathcal{T}\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|\times|\mathcal{S}|}
\mathcal{B}\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|\times|\mathcal{S}|}
(\mathcal{T}V)(s,a)=\sum_{s^{\prime}}T(s^{\prime}|s,a)V(s^{\prime})
(\mathcal{B}V)(s,a)=V(s)
\mu_{0}\in\Delta(|\mathcal{S}|)
D=\mathrm{diag}(d^{O})\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|\times|\mathcal%
{S}||\mathcal{A}|}
\begin{split}&\min_{V(s)\geq 0}(1-\gamma)\mathbb{E}_{s\sim\mu_{0}}[V(s)]+\frac%
{1}{2}\mathbb{E}_{(s,a)\sim d^{O}}\left[\left(R(s)+\gamma\mathcal{T}V(s,a)-V(s%
)+1\right)^{2}\right]\\
\Rightarrow&\min_{V(s)}(1-\gamma)\mu_{0}^{\top}V+\frac{1}{2}\mathbb{E}_{(s,a)%
\sim d^{O}}\left[\left(\underbrace{\mathcal{B}R(s,a)+\gamma\mathcal{T}V(s,a)-%
\mathcal{B}V(s,a)}_{r_{V}(s,a)}+1\right)^{2}\right]\\
\Rightarrow&\min_{V(s)}(1-\gamma)\mu_{0}^{\top}V+\frac{1}{2}(r_{V}+I)^{\top}D(%
r_{V}+I)\end{split}
r_{V}\in\mathbb{R}^{|\mathcal{S}||\mathcal{A}|}
I
\mathbb{R}^{|\mathcal{S}||\mathcal{A}|}
J(V)\coloneqq(1-\gamma)\mu_{0}^{\top}V+\frac{1}{2}(r_{V}+I)^{\top}D(r_{V}+I)
J(V)
V
\displaystyle\frac{\partial J(V)}{\partial V}=\frac{\partial}{\partial V}\left%
((1-\gamma)\mu_{0}^{\top}V+\frac{1}{2}(r_{V}+I)^{\top}D(r_{V}+I)\right)
\displaystyle\frac{\partial J(V)}{\partial V}=
\displaystyle\frac{\partial}{\partial V}\left((1-\gamma)\mu_{0}^{\top}V+\frac{%
1}{2}(r_{V}+I)^{\top}D(r_{V}+I)\right)
\displaystyle=\frac{\partial}{\partial V}\left((1-\gamma)\mu_{0}^{\top}V+\frac%
{1}{2}r_{V}^{\top}Dr_{V}+r_{V}^{\top}DI+I^{\top}DI\right)
\displaystyle=
\displaystyle\frac{\partial}{\partial V}\left((1-\gamma)\mu_{0}^{\top}V+\frac{%
1}{2}r_{V}^{\top}Dr_{V}+r_{V}^{\top}DI+I^{\top}DI\right)
\displaystyle=(1-\gamma)\mu_{0}+(\gamma\mathcal{T}-\mathcal{B})^{\top}Dr_{V}+(%
\gamma\mathcal{T}-\mathcal{B})^{\top}DI
\displaystyle=
\displaystyle(1-\gamma)\mu_{0}+(\gamma\mathcal{T}-\mathcal{B})^{\top}Dr_{V}+(%
\gamma\mathcal{T}-\mathcal{B})^{\top}DI
\displaystyle=(1-\gamma)\mu_{0}+(\gamma\mathcal{T}-\mathcal{B})^{\top}D(%
\mathcal{B}R+(\gamma\mathcal{T}-\mathcal{B})V)+(\gamma\mathcal{T}-\mathcal{B})%
^{\top}DI
\displaystyle=
\displaystyle(1-\gamma)\mu_{0}+(\gamma\mathcal{T}-\mathcal{B})^{\top}D(%
\mathcal{B}R+(\gamma\mathcal{T}-\mathcal{B})V)+(\gamma\mathcal{T}-\mathcal{B})%
^{\top}DI
V
V^{*}
\begin{split}&(\gamma\mathcal{T}-\mathcal{B})^{\top}D(\gamma\mathcal{T}-%
\mathcal{B})V=(\gamma-1)\mu_{0}+(\mathcal{B}-\gamma\mathcal{T})^{\top}D(I+BR)%
\\
\Rightarrow&V^{*}=\left((\gamma\mathcal{T}-\mathcal{B})^{\top}D(\gamma\mathcal%
{T}-\mathcal{B})\right)^{-1}\left((\gamma-1)\mu_{0}+(\mathcal{B}-\gamma%
\mathcal{T})^{\top}D(I+BR)\right)\end{split}
\xi^{*}(s,a)=\frac{d^{*}(s,a)}{d^{O}(s,a)}
\xi^{*}(s,a)=\mathcal{B}R(s,a)+\gamma\mathcal{T}V^{*}(s,a)-\mathcal{B}V^{*}(s,%
a)+1
V^{*}
\mathcal{T}
\hat{\mathcal{T}}
\hat{\mathcal{T}}(s^{\prime}\mid s,a):=\frac{n(s,a,s^{\prime})}{n}
R_{\max}=\max_{s}\log\frac{d^{E}(s)}{d^{O}(s)}
D_{\min}=\min_{s,a}d^{O}(s,a)
\hat{\mathcal{T}}(s^{\prime}\mid s,a):=\frac{n(s,a,s^{\prime})}{n}
\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\leq\frac{1}{(1-\gamma)^{2}D_%
{\min}}
A^{\top}DA
\delta\in\mathbb{R}_{>0}
\geq 1-\delta
\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}\leq\left(\frac{2(2+R_{\max})(2+%
\gamma)\gamma}{(1-\gamma)^{4}D_{\min}^{2}}\right)\sqrt{\frac{2S}{n}\log\frac{4%
SA}{\delta}}
V^{*}
\hat{V}
\begin{split}V^{*}&=\left((\gamma\mathcal{T}-\mathcal{B})^{\top}D(\gamma%
\mathcal{T}-\mathcal{B})\right)^{-1}\left((\gamma-1)\mu_{0}+(\mathcal{B}-%
\gamma\mathcal{T})^{\top}D(I+BR)\right)\\
\hat{V}&=\left((\gamma\hat{\mathcal{T}}-\mathcal{B})^{\top}D(\gamma\hat{%
\mathcal{T}}-\mathcal{B})\right)^{-1}\left((\gamma-1)\mu_{0}+(\mathcal{B}-%
\gamma\hat{\mathcal{T}})^{\top}D(I+BR)\right)\\
\end{split}
A:=\gamma\mathcal{T}-B
\hat{A}:=\gamma\hat{\mathcal{T}}-B
\displaystyle V^{*}-\hat{V}=\left(A^{\top}DA\right)^{-1}\left((\gamma-1)\mu_{0%
}-A^{\top}D(I+BR)\right)-\left(\hat{A}^{\top}D\hat{A}\right)^{-1}\left((\gamma%
-1)\mu_{0}-\hat{A}^{\top}D(I+BR)\right)
\displaystyle V^{*}-\hat{V}
\displaystyle=\left(A^{\top}DA\right)^{-1}\left((\gamma-1)\mu_{0}-A^{\top}D(I+%
BR)\right)-\left(\hat{A}^{\top}D\hat{A}\right)^{-1}\left((\gamma-1)\mu_{0}-%
\hat{A}^{\top}D(I+BR)\right)
\displaystyle=(A^{\top}DA)^{-1}(\gamma-1)\mu_{0}
\displaystyle=(A^{\top}DA)^{-1}(\gamma-1)\mu_{0}
\displaystyle-(A^{\top}DA)^{-1}A^{\top}D(I+BR)-(\hat{A}^{\top}D\hat{A})^{-1}(%
\gamma-1)\mu_{0}+(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)
\displaystyle-
\displaystyle(A^{\top}DA)^{-1}A^{\top}D(I+BR)-(\hat{A}^{\top}D\hat{A})^{-1}(%
\gamma-1)\mu_{0}+(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)
\left\lVert\cdot\right\rVert_{\infty}
\displaystyle\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}=\lVert(A^{\top}DA)%
^{-1}(\gamma-1)\mu_{0}-(A^{\top}DA)^{-1}A^{\top}D(I+BR)-(\hat{A}^{\top}D\hat{A%
})^{-1}(\gamma-1)\mu_{0}
\displaystyle\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}=
\displaystyle\lVert(A^{\top}DA)^{-1}(\gamma-1)\mu_{0}-(A^{\top}DA)^{-1}A^{\top%
}D(I+BR)-(\hat{A}^{\top}D\hat{A})^{-1}(\gamma-1)\mu_{0}
\displaystyle+(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)\rVert_{\infty}
\displaystyle+
\displaystyle(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)\rVert_{\infty}
\displaystyle\leq\left\lVert(A^{\top}DA)^{-1}(\gamma-1)\mu_{0}-(\hat{A}^{\top}%
D\hat{A})^{-1}(\gamma-1)\mu_{0}\right\rVert_{\infty}
\displaystyle\leq
\displaystyle\left\lVert(A^{\top}DA)^{-1}(\gamma-1)\mu_{0}-(\hat{A}^{\top}D%
\hat{A})^{-1}(\gamma-1)\mu_{0}\right\rVert_{\infty}
\displaystyle+\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)-(A%
^{\top}DA)^{-1}A^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+
\displaystyle\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)-(A^%
{\top}DA)^{-1}A^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle\leq(1-\gamma)\left\lVert(A^{\top}DA)^{-1}-(\hat{A}^{\top}D\hat{A%
})^{-1}\right\rVert_{\infty}
\displaystyle\leq
\displaystyle(1-\gamma)\left\lVert(A^{\top}DA)^{-1}-(\hat{A}^{\top}D\hat{A})^{%
-1}\right\rVert_{\infty}
\displaystyle+\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)-(A%
^{\top}DA)^{-1}A^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+
\displaystyle\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)-(A^%
{\top}DA)^{-1}A^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle=(1-\gamma)\left\lVert(A^{\top}DA)^{-1}-(\hat{A}^{\top}D\hat{A})^%
{-1}\right\rVert_{\infty}
\displaystyle=
\displaystyle(1-\gamma)\left\lVert(A^{\top}DA)^{-1}-(\hat{A}^{\top}D\hat{A})^{%
-1}\right\rVert_{\infty}
\displaystyle+\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)-(A%
^{\top}DA)^{-1}\hat{A}^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+
\displaystyle\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}\hat{A}^{\top}D(I+BR)-(A^%
{\top}DA)^{-1}\hat{A}^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+\left\lVert(A^{\top}DA)^{-1}\hat{A}^{\top}D(I+BR)-(A^{\top}DA)^{%
-1}A^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+
\displaystyle\left\lVert(A^{\top}DA)^{-1}\hat{A}^{\top}D(I+BR)-(A^{\top}DA)^{-%
1}A^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle\leq(1-\gamma)\left\lVert(A^{\top}DA)^{-1}-(\hat{A}^{\top}D\hat{A%
})^{-1}\right\rVert_{\infty}
\displaystyle\leq
\displaystyle(1-\gamma)\left\lVert(A^{\top}DA)^{-1}-(\hat{A}^{\top}D\hat{A})^{%
-1}\right\rVert_{\infty}
\displaystyle+\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}-(A^{\top}DA)^{-1}\right%
\rVert_{\infty}\left\lVert\hat{A}^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+
\displaystyle\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}-(A^{\top}DA)^{-1}\right%
\rVert_{\infty}\left\lVert\hat{A}^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\left\lVert(%
\hat{A}-A)^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle+
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\left\lVert(\hat%
{A}-A)^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle\left\lVert\hat{A}^{\top}D(I+BR)\right\rVert_{\infty}\leq\left%
\lVert\hat{A}^{\top}D\right\rVert_{\infty}\left\lVert(I+BR)\right\rVert_{%
\infty}\leq(1+R_{\max})
\displaystyle\left\lVert\hat{A}^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle\leq\left\lVert\hat{A}^{\top}D\right\rVert_{\infty}\left\lVert(I+%
BR)\right\rVert_{\infty}\leq(1+R_{\max})
\displaystyle\left\lVert(\hat{A}-A)^{\top}D(I+BR)\right\rVert_{\infty}\leq%
\left\lVert(\hat{A}-A)^{\top}D\right\rVert_{\infty}\ \left\lVert(I+BR)\right%
\rVert_{\infty}\leq\left\lVert(\hat{A}-A)^{\top}D\right\rVert_{\infty}(1+R_{%
\max})
\displaystyle\left\lVert(\hat{A}-A)^{\top}D(I+BR)\right\rVert_{\infty}
\displaystyle\leq\left\lVert(\hat{A}-A)^{\top}D\right\rVert_{\infty}\ \left%
\lVert(I+BR)\right\rVert_{\infty}\leq\left\lVert(\hat{A}-A)^{\top}D\right%
\rVert_{\infty}(1+R_{\max})
\left\lVert\hat{A}^{\top}D\right\rVert_{\infty}=\max_{s^{\prime}}\sum_{s,a}%
\left\lvert(\gamma\hat{\mathcal{T}}(s^{\prime}\mid s,a)-\mathbf{1}(s^{\prime}=%
s))D(s,a)\right\rvert\leq\max_{s^{\prime},s,a}\left\lvert\gamma\hat{\mathcal{T%
}}(s^{\prime}\mid s,a)-\mathbf{1}(s^{\prime}=s)\right\rvert=1
\sum_{s,a}D(s,a)=1
\begin{split}\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}&\leq\left((1-%
\gamma)+(1+R_{\max})\right)\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}-(A^{\top}%
DA)^{-1}\right\rVert_{\infty}\\
&+(1+R_{\max})\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\left\lVert(%
\hat{A}-A)^{\top}D\right\rVert_{\infty}\end{split}
\displaystyle\left\lVert(\hat{A}-A)^{\top}D\right\rVert_{\infty}
\displaystyle\left\lVert(\hat{A}-A)^{\top}D\right\rVert_{\infty}
\displaystyle=\gamma\left\lVert(\hat{\mathcal{T}}-\mathcal{T})^{\top}D\right%
\rVert_{\infty}
\displaystyle=
\displaystyle\gamma\left\lVert(\hat{\mathcal{T}}-\mathcal{T})^{\top}D\right%
\rVert_{\infty}
\displaystyle=\gamma\max_{s^{\prime}}\sum_{s,a}\left\lvert(\hat{\mathcal{T}}(s%
^{\prime}\mid s,a)-\mathcal{T}(s^{\prime}\mid s,a))D(s,a)\right\rvert
\displaystyle=
\displaystyle\gamma\max_{s^{\prime}}\sum_{s,a}\left\lvert(\hat{\mathcal{T}}(s^%
{\prime}\mid s,a)-\mathcal{T}(s^{\prime}\mid s,a))D(s,a)\right\rvert
\displaystyle\leq\gamma\max_{s^{\prime},s,a}\left\lvert(\hat{\mathcal{T}}(s^{%
\prime}\mid s,a)-\mathcal{T}(s^{\prime}\mid s,a))\right\rvert
\displaystyle\leq
\displaystyle\gamma\max_{s^{\prime},s,a}\left\lvert(\hat{\mathcal{T}}(s^{%
\prime}\mid s,a)-\mathcal{T}(s^{\prime}\mid s,a))\right\rvert
\displaystyle\leq\gamma\max_{s,a}\left\lVert\hat{\mathcal{T}}(\cdot\mid s,a)-%
\mathcal{T}(\cdot\mid s,a)\right\rVert_{1}
\displaystyle\leq
\displaystyle\gamma\max_{s,a}\left\lVert\hat{\mathcal{T}}(\cdot\mid s,a)-%
\mathcal{T}(\cdot\mid s,a)\right\rVert_{1}
\displaystyle\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}-(A^{\top}DA)^{-1}\right%
\rVert_{\infty}
\displaystyle\left\lVert(\hat{A}^{\top}D\hat{A})^{-1}-(A^{\top}DA)^{-1}\right%
\rVert_{\infty}
\displaystyle=\left\lVert(A^{\top}DA)^{-1}(A^{\top}DA-\hat{A}^{\top}D\hat{A})(%
\hat{A}^{\top}D\hat{A})^{-1}\right\rVert_{\infty}
\displaystyle=
\displaystyle\left\lVert(A^{\top}DA)^{-1}(A^{\top}DA-\hat{A}^{\top}D\hat{A})(%
\hat{A}^{\top}D\hat{A})^{-1}\right\rVert_{\infty}
\displaystyle\leq\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\left\lVert A%
^{\top}DA-\hat{A}^{\top}D\hat{A}\right\rVert_{\infty}\left\lVert(\hat{A}^{\top%
}D\hat{A})^{-1}\right\rVert_{\infty}
\displaystyle\leq
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\left\lVert A^{%
\top}DA-\hat{A}^{\top}D\hat{A}\right\rVert_{\infty}\left\lVert(\hat{A}^{\top}D%
\hat{A})^{-1}\right\rVert_{\infty}
\displaystyle\leq\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left%
\lVert A^{\top}DA-\hat{A}^{\top}D\hat{A}\right\rVert_{\infty}
\displaystyle\leq
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left\lVert A%
^{\top}DA-\hat{A}^{\top}D\hat{A}\right\rVert_{\infty}
\displaystyle=\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left\lVert
A%
^{\top}DA-A^{\top}D\hat{A}+A^{\top}D\hat{A}-\hat{A}^{\top}D\hat{A}\right\rVert%
_{\infty}
\displaystyle=
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left\lVert A%
^{\top}DA-A^{\top}D\hat{A}+A^{\top}D\hat{A}-\hat{A}^{\top}D\hat{A}\right\rVert%
_{\infty}
\displaystyle=\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left(\left%
\lVert A^{\top}D(A-\hat{A})\right\rVert_{\infty}+\left\lVert(A-\hat{A})^{\top}%
D\hat{A}\right\rVert_{\infty}\right)
\displaystyle=
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left(\left%
\lVert A^{\top}D(A-\hat{A})\right\rVert_{\infty}+\left\lVert(A-\hat{A})^{\top}%
D\hat{A}\right\rVert_{\infty}\right)
\displaystyle\leq\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left(%
\left\lVert A^{\top}D\right\rVert_{\infty}\left\lVert A-\hat{A}\right\rVert_{%
\infty}+\left\lVert(A-\hat{A})^{\top}D\right\rVert_{\infty}\left\lVert\hat{A}%
\right\rVert_{\infty}\right)
\displaystyle\leq
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left(\left%
\lVert A^{\top}D\right\rVert_{\infty}\left\lVert A-\hat{A}\right\rVert_{\infty%
}+\left\lVert(A-\hat{A})^{\top}D\right\rVert_{\infty}\left\lVert\hat{A}\right%
\rVert_{\infty}\right)
\displaystyle\leq\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left(%
\gamma\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{\mathcal{T}}(\cdot%
\mid s,a)\right\rVert_{1}+(1+\gamma)\gamma\max_{s,a}\left\lVert\mathcal{T}(%
\cdot\mid s,a)-\hat{\mathcal{T}}(\cdot\mid s,a)\right\rVert_{1}\right)
\displaystyle\leq
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left(\gamma%
\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{\mathcal{T}}(\cdot\mid s,%
a)\right\rVert_{1}+(1+\gamma)\gamma\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s%
,a)-\hat{\mathcal{T}}(\cdot\mid s,a)\right\rVert_{1}\right)
\displaystyle=\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left((2+%
\gamma)\gamma\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{\mathcal{T}}%
(\cdot\mid s,a)\right\rVert_{1}\right)
\displaystyle=
\displaystyle\left\lVert(A^{\top}DA)^{-1}\right\rVert^{2}_{\infty}\left((2+%
\gamma)\gamma\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{\mathcal{T}}%
(\cdot\mid s,a)\right\rVert_{1}\right)
\left\lVert A-\hat{A}\right\rVert_{\infty}=\gamma\max_{s,a}\left\lVert T(\cdot%
\mid s,a)-\hat{\mathcal{T}}(\cdot\mid s,a)\right\rVert_{1}
\left\lVert A\right\rVert_{\infty}=\max_{s,a}\sum_{s^{\prime}}\left\lvert%
\gamma\mathcal{T}(s^{\prime}\mid s,a)-\mathbf{1}(s^{\prime}=s)\right\rvert\leq%
\max_{s,a}\sum_{s^{\prime}\neq s}\left\lvert\gamma\mathcal{T}(s^{\prime}\mid s%
,a)\right\rvert+1\leq 1+\gamma
\begin{split}\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}&\leq\left((1-%
\gamma)+(1+R_{\max})\right)(2+\gamma)\gamma\left\lVert(A^{\top}DA)^{-1}\right%
\rVert^{2}_{\infty}\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{%
\mathcal{T}}(\cdot\mid s,a)\right\rVert_{1}\\
&+(1+R_{\max})\gamma\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}\max_{s,a%
}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{\mathcal{T}}(\cdot\mid s,a)\right%
\rVert_{1}\end{split}
\delta\in[0,1)
1-\delta/2
\max_{s,a}\left\lVert\mathcal{T}(\cdot\mid s,a)-\hat{\mathcal{T}}(\cdot\mid s,%
a)\right\rVert_{1}\leq\sqrt{\frac{2S}{n}\ln\frac{4SA}{\delta}}
\left\lVert(A^{\top}DA)^{-1}\right\rVert_{\infty}=\frac{1}{\inf_{\left\lVert x%
\right\rVert=1}\left\lVert(A^{\top}DA)x\right\rVert_{\infty}}\leq\frac{1}{(1-%
\gamma)^{2}D_{\min}}
1-\delta
\displaystyle\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}\leq\left(\frac{(2+%
R_{\max})(2+\gamma)\gamma}{(1-\gamma)^{4}D_{\min}^{2}}+\frac{(1+R_{\max})%
\gamma}{(1-\gamma)^{2}D_{\min}}\right)\sqrt{\frac{2S}{n}\ln\frac{4SA}{\delta}}
\displaystyle\left\lVert V^{*}-\hat{V}\right\rVert_{\infty}
\displaystyle\leq\left(\frac{(2+R_{\max})(2+\gamma)\gamma}{(1-\gamma)^{4}D_{%
\min}^{2}}+\frac{(1+R_{\max})\gamma}{(1-\gamma)^{2}D_{\min}}\right)\sqrt{\frac%
{2S}{n}\ln\frac{4SA}{\delta}}
\displaystyle\leq\left(\frac{2(2+R_{\max})(2+\gamma)\gamma}{(1-\gamma)^{4}D_{%
\min}^{2}}\right)\sqrt{\frac{2S}{n}\ln\frac{4SA}{\delta}}
\displaystyle\leq\left(\frac{2(2+R_{\max})(2+\gamma)\gamma}{(1-\gamma)^{4}D_{%
\min}^{2}}\right)\sqrt{\frac{2S}{n}\ln\frac{4SA}{\delta}}
1
d(s)\approx 0.915
0.01
\sum_{s\in\mathcal{S}^{*}}d^{\pi}(s)\gg\sum_{s\notin\mathcal{S}^{*}}d^{\pi}(s)
\chi^{2}
\chi^{2}
V_{\theta}
\pi_{\phi}
\theta
\phi
\mathcal{D}^{E}
\mathcal{D}^{O}
f
f
c_{\psi}
V_{\theta}
\pi_{\phi}
c_{\psi}
\mathcal{D}^{E}
\mathcal{D}^{O}
\{s_{t}^{i},a_{t}^{i},s_{t+1}^{i}\}_{i=1}^{N}\sim\mathcal{D}^{O},\{s_{0}^{i}\}%
_{i=1}^{M}\sim\mathcal{D}^{O}(\mu_{0})
R_{i}=c_{\theta}(s^{i}_{t}),i=1,...,N
\mathcal{L}(\theta)\coloneqq(1-\gamma)\frac{1}{M}\sum_{i=1}^{M}V_{\theta}(s_{0%
}^{i})+\frac{1}{N}f_{\star}\left(R^{i}+\gamma V(s_{t+1}^{i})-V(s^{i}_{t})\right)
V_{\theta}
V_{\theta}\leftarrow V_{\theta}-\eta_{V}\nabla\mathcal{L}(\theta)
\{s_{t}^{i},a_{t}^{i},s_{t+1}^{i}\}_{i=1}^{N}\sim\mathcal{D}^{O}
\xi^{*}(s^{i},a^{i})=f^{\prime}_{\star}\left(R(s^{i})+\gamma V(s_{t+1}^{i})-V(%
s_{t}^{i})\right),i=1,...,N
\pi_{\psi}
\mathcal{T}V
f
f
f
\chi^{2}
f
\chi^{2}
f
\alpha
R(s)=0
\xi(s,a)
f
\frac{|\text{max\_original}-\text{max\_mismatched}|}{\text{max\_original}}
