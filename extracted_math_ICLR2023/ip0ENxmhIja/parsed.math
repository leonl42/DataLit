|
\mathcal{O}(1)
\mathcal{O}([\text{\# bins $\approx 10^{3}$}]\cdot[\text{\# grid points = 1,00%
0}])
\approx 10^{3}
\mathcal{O}([\text{\# samples}\approx 50]\cdot[\text{sample complexity}])
\mathcal{O}([\text{\# knots}\approx 30])
\mathcal{O}(\text{\# knots}\cdot[\log\text{precision}\approx 15])
\{(x_{i},y_{i})\}_{i=1}^{N}
N
f_{X,Y}(x,y)
\mathcal{D}_{\text{train}}=\{(x_{i},y_{i})\}_{i=1}^{N_{\text{train}}}
\mathcal{D}_{\text{cal}}=\{(x_{i},y_{i})\}_{i=N_{\text{train}}+1}^{N_{\text{%
train}}+N_{\text{cal}}}
\hat{f}(x)
\mathcal{D}_{\text{train}}
\mathcal{S}(x,y)
y
u(x)
\hat{f}(x)
Y\mid X
\mathcal{S}(x,y)=-\hat{f}(y\mid x)
\alpha\in[0,1]
1-\alpha
(x_{\text{test}},y_{\text{test}})
\mathcal{D}_{\text{cal}}
\mathcal{C}(x)
\mathbb{P}[y_{\text{test}}\in\mathcal{C}(x_{\text{test}})]\geq 1-\alpha,
(x_{\text{test}},y_{\text{test}})
\mathcal{D}_{\text{cal}}
(x_{\text{test}},y_{\text{test}})
\mathcal{S}_{\text{cal}}=\{\mathcal{S}(x,y)\colon(x,y)\in\mathcal{D}_{\text{%
cal}}\}
\hat{q}=\textsc{quantile}\left[\mathcal{S}_{\text{cal}},\frac{\lceil(N_{\text{%
cal}}+1)(1-\alpha)\rceil)}{N_{\text{cal}}}\right].
\mathcal{C}(x_{\text{test}})=\{y\colon\mathcal{S}(x_{\text{test}},y)\leq\hat{q%
}\}.
y
\hat{q}
\hat{q}
y
\mathcal{C}(x)
y
y
\hat{f}(y\mid x)=f(y\mid x)
f(Y\mid X)
n=2
Y
0\leq y<1
x
\textsc{NN${}_{\theta_{e}}$}(x)=z
{}_{\theta_{e}}
x
z
K
n(K-1)+1
n
(t_{i},t_{i+1})
n+1
i
h_{i}^{j}
j
(1,\ldots,n+1)
h_{i}^{n+1}=h_{i+1}^{1}
n-1
t_{i}
t_{i+1}
\tau_{i}^{j}=t_{i}+(j-1)\cdot\frac{(t_{i+1}-t_{i})}{n}\ \text{, where $j=1,%
\ldots,n+1$}.
j=1,\ldots,n+1
n
p_{i}(y)
\{(\tau_{i}^{j},h_{i}^{j})\}_{j=1}^{n+1}
h_{i}^{1}
h_{i}^{n+1}
h_{i}^{j}
p_{i}(y)>0
\bar{p}_{i}(y)=\max\left(p_{i}(y),0\right)
x
\mathcal{O}(Kn)
p_{i}(y)
\hat{f}_{\theta}(y\mid x)=\bar{p}_{\ell}(y)\ /\ \sum_{i=1}^{K-1}\int_{t_{i}}^{%
t_{i+1}}\bar{p}_{i}(y^{\prime})dy^{\prime},
\ell
t_{\ell}\leq y<t_{\ell+1}
\ell
\mathcal{O}(\log K)
\mathcal{O}(Kn)
\hat{f}_{\theta}(y\mid x)
\{\theta_{e},\theta_{t},\theta_{h}\}
(x,y)\in\mathcal{D}_{\text{train}}
\mathbb{I}
[0,1]
d>1
f\colon(\mathbb{I}^{d-1}\times\mathbb{I})\to\mathbb{R}\geq 0
\epsilon>0
\hat{f}(x,y)\colon(\mathbb{I}^{d-1}\times\mathbb{I})\to\mathbb{R}\geq 0
\sup_{(x,y)\in\mathbb{I}^{d}}|f(x,y)-\hat{f}(x,y)|<\epsilon
f
[0,1]^{d}
f
\mathcal{S}_{\hat{f}}(x,y)=-\hat{f}_{\theta}(y\mid x)
\mathcal{S}_{\textsc{HPD}}(x,y)
y
\mathcal{S}_{\hat{f}}(x,y)=-\hat{f}_{\theta}(y\mid x)
y
\mathcal{O}(Kn)
K
\hat{q}
\hat{q}
\mathcal{C}_{\textsc{ND}}(x)
y
\hat{f}_{\theta}(y\mid x)>-\hat{q}
\mathcal{C}_{\textsc{ND}}(x)
\mathcal{O}(Kn)
y\mid x
\mathcal{C}_{\textsc{ND}}(x)
-\hat{q}
y
\mathcal{C}_{\textsc{ND}}(x)
\mathcal{C}_{\textsc{ND}}(x)
-\hat{q}
y
\mathcal{C}_{\textsc{ND}}(x)
y
\mathcal{S}_{\textsc{HPD}}(x,y)=-\int_{y^{\prime}\colon\hat{f}_{\theta}(y^{%
\prime}\mid x)\leq\hat{f}_{\theta}(y\mid x)}\hat{f}_{\theta}(y^{\prime}\mid x)%
dy^{\prime}.
y
y
\mathcal{O}(Kn)
\hat{q}
\mathcal{C}_{\textsc{HPD}}(x)=\left\{y\colon\int_{y^{\prime}\colon\hat{f}_{%
\theta}(y^{\prime}\mid x)\leq\hat{f}_{\theta}(y\mid x)}\hat{f}_{\theta}(y^{%
\prime}\mid x)dy^{\prime}>-\hat{q}\right\}.
\mathcal{O}\left(Kn\log_{2}\frac{1}{\epsilon}\right)
\epsilon
\hat{q}
[0,1]
\hat{q}
2\hat{q}
\mathscr{P}=\bigcup_{i=1}^{m}[a_{i},b_{i}]\subseteq[0,1]
a_{i}<b_{i}<a_{i+1}
1\leq m\leq M
m
M
K=4M+2
\hat{q}\colon 0<-\hat{q}\cdot|\mathscr{P}|<1
K
\mathcal{C}_{\textsc{ND}}(x)=\mathscr{P}
x
0<-\hat{q}<1
K
\mathcal{C}_{\textsc{HPD}}(x)=\mathscr{P}
x
\alpha
1-\alpha
Y\mid x
\alpha
\hat{q}
\mathcal{C}(x)=[\hat{f}_{\alpha}(x)-\hat{q},\hat{f}_{1-\alpha}(x)+\hat{q}]
y
y
1.00\pm 0.01
0.99\pm 0.00
0.20\pm 0.01
0.98\pm 0.02
0.91\pm 0.02
0.87\pm 0.02
0.89\pm 0.01
0.89\pm 0.01
0.84\pm 0.09
0.89\pm 0.01
0.98\pm 0.00
0.14\pm 0.01
0.74\pm 0.01
0.70\pm 0.01
0.66\pm 0.01
0.91\pm 0.01
0.89\pm 0.01
0.74\pm 0.09
0.23\pm 0.00
0.59\pm 0.00
0.16\pm 0.01
0.81\pm 0.01
0.82\pm 0.02
0.79\pm 0.02
0.89\pm 0.01
\underline{0.28\pm 0.00}
0.57\pm 0.11
0.26\pm 0.00
\mathbf{0.53\pm 0.00}
0.38\pm 0.00
0.66\pm 0.03
0.59\pm 0.07
0.77\pm 0.01
0.94\pm 0.01
0.31\pm 0.01
0.56\pm 0.08
(n=1
\mathbf{0.20\pm 0.00}
0.59\pm 0.02
\mathbf{0.09\pm 0.00}
0.57\pm 0.01
\underline{0.55\pm 0.01}
\underline{0.52\pm 0.01}
0.90\pm 0.01
\mathbf{0.27\pm 0.00}
\underline{0.46\pm 0.09}
(n=1
0.24\pm 0.00
0.62\pm 0.02
0.15\pm 0.01
0.87\pm 0.01
0.82\pm 0.01
0.87\pm 0.02
0.93\pm 0.01
0.29\pm 0.00
0.60\pm 0.11
(n=2
\underline{0.22\pm 0.00}
\underline{0.55\pm 0.01}
\underline{0.10\pm 0.00}
\mathbf{0.32\pm 0.04}
\mathbf{0.35\pm 0.03}
\mathbf{0.37\pm 0.03}
\mathbf{0.83\pm 0.01}
0.28\pm 0.00
\mathbf{0.38\pm 0.08}
(n=2
0.23\pm 0.00
0.58\pm 0.01
0.19\pm 0.01
\underline{0.45\pm 0.04}
1.11\pm 0.20
0.64\pm 0.14
\underline{0.84\pm 0.01}
0.28\pm 0.01
0.54\pm 0.11
0.47\pm 0.01
0.52\pm 0.00
0.06\pm 0.01
0.52\pm 0.00
0.43\pm 0.01
0.41\pm 0.01
0.76\pm 0.01
0.69\pm 0.01
0.48\pm 0.07
0.47\pm 0.01
0.53\pm 0.00
0.08\pm 0.01
0.53\pm 0.00
0.46\pm 0.01
0.43\pm 0.01
0.73\pm 0.01
0.67\pm 0.01
0.49\pm 0.07
0.80\pm 0.01
0.84\pm 0.00
\underline{0.37\pm 0.01}
0.53\pm 0.01
0.51\pm 0.01
0.50\pm 0.01
0.81\pm 0.01
0.87\pm 0.01
0.65\pm 0.07
0.75\pm 0.01
\mathbf{0.85\pm 0.00}
0.02\pm 0.00
0.01\pm 0.01
0.00\pm 0.00
0.03\pm 0.01
0.81\pm 0.03
0.86\pm 0.00
0.42\pm 0.15
(n=1
0.83\pm 0.01
0.83\pm 0.01
0.24\pm 0.01
0.52\pm 0.01
0.50\pm 0.01
0.47\pm 0.01
\underline{0.81\pm 0.01}
\mathbf{0.87\pm 0.00}
0.63\pm 0.08
(n=1
\mathbf{0.86\pm 0.00}
0.83\pm 0.01
0.25\pm 0.01
\mathbf{0.61\pm 0.00}
\mathbf{0.60\pm 0.01}
\mathbf{0.61\pm 0.01}
\mathbf{0.83\pm 0.01}
\underline{0.87\pm 0.00}
\mathbf{0.68\pm 0.07}
(n=2
0.80\pm 0.01
0.84\pm 0.01
0.21\pm 0.01
0.56\pm 0.01
0.53\pm 0.01
0.49\pm 0.01
0.76\pm 0.01
0.87\pm 0.00
0.63\pm 0.08
(n=2
\underline{0.85\pm 0.01}
\underline{0.84\pm 0.01}
\mathbf{0.42\pm 0.01}
\underline{0.57\pm 0.02}
\underline{0.59\pm 0.02}
\underline{0.54\pm 0.02}
0.77\pm 0.01
0.86\pm 0.01
\underline{0.68\pm 0.06}
y
y
y
y
n=1,2
(n=2)
x
n=1
n=2
\hat{q}
\mathbb{I}
[0,1]
d>1
f\colon(\mathbb{I}^{d-1}\times\mathbb{I})\to\mathbb{R}\geq 0
\epsilon>0
\hat{f}(x,y)\colon(\mathbb{I}^{d-1}\times\mathbb{I})\to\mathbb{R}\geq 0
\sup_{(x,y)\in\mathbb{I}^{d}}|f(x,y)-\hat{f}(x,y)|<\epsilon
(0,1)
\phi\in\mathbb{R}^{K}
K
s(\phi,y)
y\in\mathbb{I}
\mathscr{S}(x)\colon\mathbb{I}^{d-1}\to\mathbb{R}^{K}
x
x\in\mathbb{I}^{d-1}
\sup_{y\in\mathbb{I}}|f(x,y)-s(\mathscr{S}(x),y)|<\epsilon/3.
\mathscr{S}(x)
K
E\colon(\mathbb{I}^{d-1}\times\mathbb{R}^{K})\to\mathbb{R}\geq 0
E(x,\phi)=\sup_{y\in\mathbb{I}}|s(\mathscr{S}(x),y)-s(\phi,y)|.
E
\phi
\delta
x\in\mathbb{I}^{d-1}
\mathscr{S}^{\prime}(x)\colon\mathbb{I}^{d-1}\to\mathbb{R}^{K}
||\mathscr{S}^{\prime}(x)-\mathscr{S}(x)||_{\infty}<\delta
E\left(x,\mathscr{S}^{\prime}(x)\right)=\sup_{y\in\mathbb{I}}|s\left(\mathscr{%
S}(x),y\right)-s\left(\mathscr{S}^{\prime}(x),y\right)|<\epsilon/3.
\mathscr{S}^{\prime}(x)
\mathbb{R}
\mathbb{I}^{d-1}
\mathscr{N}\colon\mathbb{I}^{d-1}\to\mathbb{R}^{K}
\sup_{x\in\mathbb{I}^{d-1}}||\mathscr{N}(x)-\mathscr{S}(x)||_{\infty}<\delta.
\displaystyle\sup_{(x,y)\in\mathbb{I}^{d}}|s(\mathscr{N}(x),y)-f(x,y)|\leq\sup%
_{(x,y)\in\mathbb{I}^{d}}|f(x,y)-s(\mathscr{S}(x),y)|+\sup_{(x,y)\in\mathbb{I}%
^{d}}|s(\mathscr{N}(x),y)-s(\mathscr{S}(x),y)|
\displaystyle\sup_{(x,y)\in\mathbb{I}^{d}}|s(\mathscr{N}(x),y)-f(x,y)|
\displaystyle\leq\sup_{(x,y)\in\mathbb{I}^{d}}|f(x,y)-s(\mathscr{S}(x),y)|+%
\sup_{(x,y)\in\mathbb{I}^{d}}|s(\mathscr{N}(x),y)-s(\mathscr{S}(x),y)|
\displaystyle\leq 2\epsilon/3<\epsilon.
\displaystyle\leq 2\epsilon/3<\epsilon.
\mathscr{P}=\bigcup_{i=1}^{m}[a_{i},b_{i}]\subseteq[0,1]
a_{i}<b_{i}<a_{i+1}
1\leq m\leq M
m
M
K=4M+2
\hat{q}\colon 0<-\hat{q}\cdot|\mathscr{P}|<1
K
\mathcal{C}_{\textsc{ND}}(x)=\mathscr{P}
x
0<-\hat{q}<1
K
\mathcal{C}_{\textsc{HPD}}(x)=\mathscr{P}
x
\mathscr{P}
\mathscr{P}
\{t_{i}\}_{i=1}^{K}
\{h_{i}\}_{i=1}^{K}
\hat{f}_{\theta}
\hat{q}
\mathscr{P}
\hat{f}_{\theta}
\mathcal{C}_{\textsc{ND}}(x)=\{y\colon\hat{f}_{\theta}(y\mid x)>-\hat{q}\}
[a_{1},b_{1}]
c=-\hat{q}
(t_{1},h_{1})=(0,0)
(t_{2},h_{2})=(a_{1},0)
(t_{3},h_{3})=(a_{1},c+\epsilon)
(t_{4},h_{4})=(b_{1},c+\epsilon)
c>\epsilon>0
\{\hat{f}_{\theta}(y\mid x)>c\ \colon y\in[0,b_{1}]\}
[a_{1},b_{1}]
\int_{0}^{b_{1}}\hat{f}_{\theta}(y\mid x)dy=(c+\epsilon)(b_{1}-a_{1})
\{t_{i},h_{i}\}
i=1,\ldots,4m
(t_{4m},h_{4m})=(b_{m},0)
(t_{4m+1},h_{4m+1})=(b_{m},1)
m<M
\mathcal{P}
\epsilon
\int\hat{f}_{\theta}(y\mid x)dy=1
\epsilon=\frac{1}{|\mathcal{P}|}-c
\int_{0}^{1}\hat{f}_{\theta}(y\mid x)dy=\sum_{i=1}^{m}(b_{i}-a_{i})(c+\epsilon%
)=(c+\epsilon)|\mathcal{P}|=1,
(t_{1},h_{1})=(0,0)
(t_{2},h_{2})=(0,a_{i})
(t_{3},h_{3})=(a_{1},\epsilon)
(t_{4},h_{4})=(b_{1},\epsilon)
0<\epsilon
(t_{4(i-1)+1},h_{4(i-1)+1})=(t_{4i},0)
(t_{4(i-1)+2},h_{4(i-1)+2})=(a_{i},0)
(t_{4(i-1)+3},h_{4(i-1)+3})=(a_{i},\epsilon)
(t_{4(i-1)+4},h_{4(i-1)+4})=(b_{i},0)
i=1,\ldots,m
m<M
(1,0)
\mathcal{C}_{\textsc{HPD}}(x)=\left\{y\colon\int_{y^{\prime}\colon\hat{f}_{%
\theta}(y^{\prime}\mid x)\leq\hat{f}_{\theta}(y\mid x)}\hat{f}_{\theta}(y^{%
\prime}\mid x)dy^{\prime}>c\right\},
c=-\hat{q}
\hat{f}_{\theta}=0
\mathscr{P}
\mathcal{C}_{\textsc{HPD}}(x)
\mathscr{P}
\int\hat{f}_{\theta}(y\mid x)=\epsilon|\mathscr{(}P)|
\epsilon=1/|\mathscr{P}|
y\in\mathscr{P}
\int_{y^{\prime}\in\mathscr{P})}\hat{f}_{\theta}(y^{\prime}\mid x)dy^{\prime}=1
\hat{f}_{\theta}(y\mid x)=\epsilon
y\in\mathscr{P}
\mathscr{P}=\mathcal{C}_{\textsc{HPD}}(x)
x
\textsc{NN${}_{\theta_{e}}$}(x)=z
{}_{\theta_{e}}
z
\{t_{i}\}_{i=1}^{K}
K
\epsilon
z
v_{i}
w_{i}
w_{i}=\epsilon+(1-\epsilon*K)v_{i}.
\epsilon
(n=2)
(n=1)
z
(n=2)
(n=1)
z
a_{i},b_{i},c_{i})
a_{i}y^{2}+b_{i}y+c
[t_{i},t_{i+1}
(n=1)
\frac{1}{2}(t_{i+1}-t_{i})(h_{i}+h_{i+1})
(n=2)
\bar{p}_{i}(y)=\max[a_{i}y^{2}+b_{i}y+c,0]
[t_{i},t_{i+1}]
(a_{i}/3y^{3}+b_{i}/2y^{2}+c_{i}y)\biggr{\rvert}_{t_{i}}^{t_{i+1}}
r_{i}^{1}<r_{i}^{2}
[t_{i},t_{i+1}]
\hat{q}
\hat{f}_{\theta}(y\mid x)
-\hat{q}
p_{i}(y)+\hat{q}
[t_{i},t_{i+1}]
(n=1)
(n=2)
[t_{i},t_{i+1}]
(c_{i}-b_{i}^{2}/(4a)>0)
[t_{i},r_{i}^{1}]
[r_{i}^{2},t_{i+1}]
\mathcal{C}_{\textsc{ND}}(x)
\hat{q}
\ell_{0}=0
u_{0}=\sup_{y}\hat{f}_{\theta}(y\mid x)
m_{i}=(u_{i}+\ell_{i})/2
F_{i}=\int_{\{y\colon\hat{f}_{\theta}(y\mid x)<m_{i}\}}\hat{f}_{\theta}(y\mid x%
)dy.
F_{i}<-\hat{q}
ell_{i+1}=m_{i}
u_{i+1}=u_{i}
ell_{i+1}=\ell_{i}
u_{i+1}=m_{i}
F_{1}5\approx-\hat{q}
\{y\colon\hat{f}_{\theta}(y\mid x)>F_{1}5\}
x
y
y
y
y
y
x
[1e-1,5e-2,1e-2,5e-3,1e-3]
[0.3,0.5,0.7,0.9]
[1e-1,5e-2,1e-2,5e-3,1e-3]
[50,200,350,500]
[1e-1,5e-2,1e-2,5e-3,1e-3]
[5,10,15,20]
[1e-1,5e-2,1e-2,5e-3,1e-3]
[11,21,31,51]
(n=1)
[5e-2,1e-2,5e-3,1e-3,5e-4]
[11,21,31,51]
(n=2)
[1e-2,5e-3,1e-3,5e-4,1e-4]
[11,21,31,51]
1e-4
y
y
y
y\mid x
y
Y
x
\sigma(x)=0.1+xU,
U
[0,1]
x
x
y
\sigma
y
-\sigma
