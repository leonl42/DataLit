\tau
\gamma_{ij}
i,j
i^{th}
\ell_{i}=-\log\frac{\sum_{j=1}^{B}\mathbf{1}_{[j\neq i]}\gamma_{ij}\cdot\exp%
\left(\operatorname{sim}\left(\boldsymbol{z}_{i},\boldsymbol{z}_{j}\right)%
\cdot\tau\right)}{\sum_{k=1}^{B}\mathbf{1}_{[k\neq i]}\exp\left(\operatorname{%
sim}\left(\boldsymbol{z}_{i},\boldsymbol{z}_{k}\right)\cdot\tau\right)},
O(N^{2})
O(N)
O(N)
x_{i}
\hat{\mu_{i}}
\hat{\mu_{j}}
i\neq j
\hat{\mu}
\mu
\hat{\mu}
\hat{\mu}
\mu
\hat{\mu}
C
x_{i},x_{j}
\hat{\mu}
\ell_{proxy}=\log{\sum_{a=1}^{C}\sum_{b=1}^{C}\mathbf{1}_{[a\neq b]}\exp\left(%
\operatorname{sim}\left(\boldsymbol{\hat{\mu}}_{a},\boldsymbol{\hat{\mu}}_{b}%
\right)\cdot\tau\right)},
\ell_{proxy}
i
j
\sum_{i=1}^{N}
\sum_{a=1}^{C}
N\gg C
\ell_{proxy}
O(N)
O(N^{2})
third
\hat{\mu}
\ell_{Pcontrast}=-\frac{1}{N}\sum_{i=1}^{N}\log\sum_{j=1}^{N}\mathbf{1}_{[j%
\neq i]}\gamma_{ij}\exp\left(\operatorname{sim}\left(\boldsymbol{z}_{i},%
\boldsymbol{z}_{j}\right)\cdot\tau\right)\\
+\ell_{proxy},
\log 2
N\gg clusters
N
Z=\{z_{1},z_{2},z_{3}\dots z_{N}\}
\mu=\{\mu_{1},\mu_{2}\dots\mu_{C}\}
\operatorname{label}(z_{i})
\mu_{a}=\sum_{i=1}^{N}\mathbf{1}_{[i\in\operatorname{label}(z_{i})=a]}\cdot z_%
{i}
\tau
\operatorname{similarity}(i,j,z_{i},z_{j})=\operatorname{sim}(z_{i},z_{j})%
\begin{cases}0,&\text{$i=j$}\\
\frac{z_{i}\cdot z_{j}}{\|z_{i}\|\|z_{j}\|},&\text{$i\neq j$}\\
\end{cases}
\operatorname{sim}(z_{i},z_{j})
\operatorname{similarity}(i,j,z_{i},z_{j})
loss_{NN}=\frac{1}{N}\sum_{i=1}^{N}\log\left[\sum_{j=1}^{N}\exp(\operatorname{%
sim}(i,j,z_{i},z_{j})\tau)\right],
loss_{CC}=\frac{1}{C}\sum_{a=1}^{C}\log\left[\sum_{b=1}^{M}\exp(\operatorname{%
sim}(a,b,\mu_{a},\mu_{b})\tau)\right]
0\leq\operatorname{sim}\leq 1.0
\displaystyle\frac{loss_{NN}}{loss_{CC}}>\frac{\log(N)}{\log\left[1+(C-1)e^{%
\tau}\right]}
\displaystyle\frac{loss_{NN}}{loss_{CC}}>\frac{\log(N)}{\log\left[1+(C-1)e^{%
\tau}\right]}
N
C
\tau
ratio=1.0
ratio>1.0
N
C
\tau
ratio=1.0
ratio>1.0
C>1
log(x):x>0
N>1+(C-1)e^{\tau}
\tau
loss_{NN}>loss_{CC}
loss_{NN}
loss_{CC}
loss_{CC}
loss_{CC}
\hat{\mu}
\hat{\mu}
\mu
z
\operatorname{label}
\operatorname{label()}
z
\hat{\mu_{c}}=\frac{1}{N}\sum_{i=1}^{N}\mathbf{1}_{[i\in\operatorname{label}(c%
)]}z_{i},
\operatorname{label(c)}
softmax()
mean()
q_{iu}
z_{i}
\mu_{u}
t
q_{iu}=\frac{(1+\left\|z_{i}-{\mu}_{u}\right\|^{2}/\eta)^{-\frac{\eta+1}{2}}}{%
\sum_{u^{\prime}}(1+\left\|z_{i}-{\mu}_{u^{\prime}}\right\|^{2}/\eta)^{-\frac{%
\eta+1}{2}}},
\eta
t
\mu
K
Q=[q_{iu}]
\eta
Q
P
Q
p_{iu}=\frac{q_{iu}^{2}/\sum_{i}q_{iu}}{\sum_{k}{(q_{ik}^{2}/\sum_{i}q_{ik})}},
\sum_{i}q_{iu}
u
Q
P
Q
P
Q
P
Q
loss_{cluster}=KL(P||Q)=\sum_{i}\sum_{u}p_{iu}log\frac{p_{iu}}{q_{iu}},
\alpha>0
\beta>0
\rm{\acrshort{OURMODEL}:}\quad L_{final}=\alpha\ell_{Pcontrast}(K,\tau)+\beta
loss%
_{cluster},
d
d_{1},d_{2},\cdots,d_{L}
O_{AE}=\mathcal{O}(Nd^{2}d^{2}_{1}...d^{2}_{L/2})
K
O_{cluster}=\mathcal{O}(NK+N\log N)
\|z\|_{2}^{2}
z_{i}\cdot z_{j}
E
O_{+}=\mathcal{O}(NEd_{z})
E
d_{z}
O_{-}=\mathcal{O}(CC)
C
N\gg C
\alpha
\beta
\tau
10^{-3}
10^{-3}
10^{-4}
10^{-3}
10^{-3}
10^{-3}
\mathbf{A}
C\cdot C
500-500-2000-10
30
10^{-3}
10^{-4}
256
K
200
\pm
r
\pm
r
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
r
\pm
r
K
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\hat{\mu}
\mu
\hat{\mu}
\mu
0\cdots 9
\hat{\mu}\neq\mu
0.001
N
x_{i},x_{j}
2(N-1)
0(N)
Z=\{z_{1},z_{2},z_{3}\dots z_{N}\}
\mu=\{\mu_{1},\mu_{2}\dots\mu_{C}\}
\operatorname{label}(z_{i})
\mu_{a}=\sum_{i=1}^{N}\mathbf{1}_{[i\in\operatorname{label}(z_{i})=a]}\cdot z_%
{i}
\tau
\operatorname{similarity}(i,j,z_{i},z_{j})=\operatorname{sim}(z_{i},z_{j})%
\begin{cases}0,&\text{$i=j$}\\
\frac{z_{i}\cdot z_{j}}{\|z_{i}\|\|z_{j}\|},&\text{$i\neq j$}\\
\end{cases}
\operatorname{sim}(z_{i},z_{j})
\operatorname{similarity}(i,j,z_{i},z_{j})
\tau
\gamma_{ij}
i,j
i^{th}
\ell_{i}=+\log{\sum_{j=1}^{B}\mathbf{1}_{[j\neq i]}\exp\left(\operatorname{sim%
}\left(\boldsymbol{z}_{i},\boldsymbol{z}_{j}\right)\tau\right)}-\log{\sum_{j=1%
}^{B}\mathbf{1}_{[j\neq i]}\gamma_{ij}\exp\left(\operatorname{sim}\left(%
\boldsymbol{z}_{i},\boldsymbol{z}_{j}\right)\tau\right)},
i
N
N
loss_{NN}=\frac{1}{N}\sum_{i=1}^{N}log\left[\sum_{j=1}^{N}e^{\operatorname{sim%
}(i,j,z_{i},z_{j})\tau}\right],
\operatorname{sim()}
e
\exp()
e^{0}=1
i=j
\displaystyle loss_{NN}=\frac{1}{N}\Bigg{[}\Bigg{.}log\left(\quad\quad 1\quad%
\quad+e^{sim(z_{1},z_{2})\tau}+e^{sim(z_{1},z_{3})\tau}+e^{sim(z_{1},z_{4})%
\tau}\ldots+e^{sim(z_{1},z_{N})\tau}\right)+
\displaystyle loss_{NN}=\frac{1}{N}\Bigg{[}\Bigg{.}
\displaystyle log\left(\quad\quad 1\quad\quad+e^{sim(z_{1},z_{2})\tau}+e^{sim(%
z_{1},z_{3})\tau}+e^{sim(z_{1},z_{4})\tau}\ldots+e^{sim(z_{1},z_{N})\tau}%
\right)+
\displaystyle log\left(e^{sim(z_{2},z_{1})\tau}+\quad\quad 1\quad\quad+e^{sim(%
z_{2},z_{3})\tau}+e^{sim(z_{2},z_{4})\tau}\ldots+e^{sim(z_{2},z_{N})\tau}%
\right)+
\displaystyle log\left(e^{sim(z_{2},z_{1})\tau}+\quad\quad 1\quad\quad+e^{sim(%
z_{2},z_{3})\tau}+e^{sim(z_{2},z_{4})\tau}\ldots+e^{sim(z_{2},z_{N})\tau}%
\right)+
\displaystyle log\left(e^{sim(z_{3},z_{1})\tau}+e^{sim(z_{3},z_{2})\tau}+\quad%
\quad 1\quad\quad+e^{sim(z_{3},z_{4})\tau}\ldots+e^{sim(z_{3},z_{N})\tau}%
\right)+
\displaystyle log\left(e^{sim(z_{3},z_{1})\tau}+e^{sim(z_{3},z_{2})\tau}+\quad%
\quad 1\quad\quad+e^{sim(z_{3},z_{4})\tau}\ldots+e^{sim(z_{3},z_{N})\tau}%
\right)+
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\cdots
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\cdots
\displaystyle log\left(e^{sim(z_{N},z_{1})\tau}+e^{sim(z_{N},z_{2})\tau}+e^{%
sim(z_{N},z_{3})\tau}+e^{sim(z_{N},z_{4})\tau}\ldots+\quad 1\right)\Bigg{.}%
\Bigg{]}
\displaystyle log\left(e^{sim(z_{N},z_{1})\tau}+e^{sim(z_{N},z_{2})\tau}+e^{%
sim(z_{N},z_{3})\tau}+e^{sim(z_{N},z_{4})\tau}\ldots+\quad 1\right)\Bigg{.}%
\Bigg{]}
loss_{CC}=\frac{1}{C}\sum_{a=1}^{C}log\left[\sum_{b=1}^{M}e^{\operatorname{sim%
}(a,b,\mu_{a},\mu_{b})\tau}\right]
\displaystyle loss_{CC}=\frac{1}{C}\Bigg{[}\Bigg{.}log\left(\quad\quad 1\quad%
\quad+e^{sim(\mu_{1},\mu_{2})\tau}+e^{sim(\mu_{1},\mu_{3})\tau}+e^{sim(\mu_{1}%
,\mu_{4})\tau}\ldots+e^{sim(\mu_{1},\mu_{C})\tau}\right)+
\displaystyle loss_{CC}=\frac{1}{C}\Bigg{[}\Bigg{.}
\displaystyle log\left(\quad\quad 1\quad\quad+e^{sim(\mu_{1},\mu_{2})\tau}+e^{%
sim(\mu_{1},\mu_{3})\tau}+e^{sim(\mu_{1},\mu_{4})\tau}\ldots+e^{sim(\mu_{1},%
\mu_{C})\tau}\right)+
\displaystyle log\left(e^{sim(\mu_{2},\mu_{1})\tau}+\quad\quad 1\quad\quad+e^{%
sim(\mu_{2},\mu_{3})\tau}+e^{sim(\mu_{2},\mu_{4})\tau}\ldots+e^{sim(\mu_{2},%
\mu_{C})\tau}\right)+
\displaystyle log\left(e^{sim(\mu_{2},\mu_{1})\tau}+\quad\quad 1\quad\quad+e^{%
sim(\mu_{2},\mu_{3})\tau}+e^{sim(\mu_{2},\mu_{4})\tau}\ldots+e^{sim(\mu_{2},%
\mu_{C})\tau}\right)+
\displaystyle log\left(e^{sim(\mu_{3},\mu_{1})\tau}+e^{sim(\mu_{3},\mu_{2})%
\tau}+\quad\quad 1\quad\quad+e^{sim(\mu_{3},\mu_{4})\tau}\ldots+e^{sim(\mu_{3}%
,\mu_{C})\tau}\right)+
\displaystyle log\left(e^{sim(\mu_{3},\mu_{1})\tau}+e^{sim(\mu_{3},\mu_{2})%
\tau}+\quad\quad 1\quad\quad+e^{sim(\mu_{3},\mu_{4})\tau}\ldots+e^{sim(\mu_{3}%
,\mu_{C})\tau}\right)+
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\cdots
\displaystyle\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\quad\cdots
\displaystyle log\left(e^{sim(\mu_{C},\mu_{1})\tau}+e^{sim(\mu_{C},\mu_{2})%
\tau}+e^{sim(\mu_{C},\mu_{3})\tau}+e^{sim(\mu_{C},\mu_{4})\tau}\ldots+\quad 1%
\right)\Bigg{.}\Bigg{]}
\displaystyle log\left(e^{sim(\mu_{C},\mu_{1})\tau}+e^{sim(\mu_{C},\mu_{2})%
\tau}+e^{sim(\mu_{C},\mu_{3})\tau}+e^{sim(\mu_{C},\mu_{4})\tau}\ldots+\quad 1%
\right)\Bigg{.}\Bigg{]}
loss_{NN}^{min}>loss_{CC}^{max}
\frac{loss_{NN}}{loss_{CC}}>1
0\leq\operatorname{sim}\leq 1.0
min
\operatorname{sim}_{min}=0
\displaystyle loss_{NN}^{min}=\frac{1}{N}\Bigg{[}\Bigg{.}log\left(1+e^{0}+e^{0%
}+\ldots+e^{0}\right)+\cdots+log\left(1+e^{0}+e^{0}+\ldots+e^{0}\right)\Bigg{]}
\displaystyle loss_{NN}^{min}
\displaystyle=\frac{1}{N}\Bigg{[}\Bigg{.}log\left(1+e^{0}+e^{0}+\ldots+e^{0}%
\right)+\cdots+log\left(1+e^{0}+e^{0}+\ldots+e^{0}\right)\Bigg{]}
\displaystyle=log\left[1+(N-1)e^{0}\right]
\displaystyle=log\left[1+(N-1)e^{0}\right]
\displaystyle=log(N)
\displaystyle=log(N)
max
\operatorname{sim}_{max}=1.0
\displaystyle loss_{CC}^{max}=\frac{1}{C}\Bigg{[}\Bigg{.}log\left(1+e^{1.\tau}%
+e^{1.\tau}+\ldots+e^{1.\tau}\right)+\cdots+log\left(1+e^{1.\tau}+e^{1.\tau}+%
\ldots+e^{1.\tau}\right)\Bigg{]}
\displaystyle loss_{CC}^{max}
\displaystyle=\frac{1}{C}\Bigg{[}\Bigg{.}log\left(1+e^{1.\tau}+e^{1.\tau}+%
\ldots+e^{1.\tau}\right)+\cdots+log\left(1+e^{1.\tau}+e^{1.\tau}+\ldots+e^{1.%
\tau}\right)\Bigg{]}
\displaystyle=log\left[1+(C-1)e^{\tau}\right]
\displaystyle=log\left[1+(C-1)e^{\tau}\right]
\displaystyle\frac{loss_{NN}}{loss_{CC}}>\frac{log(N)}{log\left[1+(C-1)e^{\tau%
}\right]}
\displaystyle\frac{loss_{NN}}{loss_{CC}}>\frac{log(N)}{log\left[1+(C-1)e^{\tau%
}\right]}
loss_{NN}
loss_{CC}
\tau
\alpha
R
\tau,\alpha,R
0.001
\tau
\alpha
R
\tau,\alpha,R
0.001
\tau
\alpha
R
\tau
\alpha
R
