L_{i}
L_{i}
L
\mathbf{x}
\omega_{o}
L(\mathbf{x},\bm{\omega}_{o})=\int_{\bm{\omega}_{i}\in\Omega^{+}}f(\mathbf{x},%
\bm{\omega}_{o},\bm{\omega}_{i})L_{i}(\mathbf{x},\bm{\omega}_{i})(\bm{\omega}_%
{i}\cdot\bm{n}_{x})d\bm{\omega}_{i}
f(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})
L_{i}(\mathbf{x},\bm{\omega_{i}})
\bm{\omega_{i}}
\displaystyle\begin{split}L(\mathbf{x},\bm{\omega}_{o}\!)\!=\!\smashoperator[%
lr]{\int_{\bm{\omega}_{i}\in\Omega^{+}}^{}}\!f_{s}(\mathbf{x},\bm{\omega}_{o},%
\bm{\omega}_{i})L_{i}^{d}(\mathbf{x},\bm{\omega}_{i})(\bm{\omega}_{i}\!\cdot\!%
\bm{n}_{x})d\bm{\omega}_{i}\!+\!\smashoperator[lr]{\int_{\bm{\omega}_{i}\in%
\Omega}^{}}\!f_{ss}(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{id}(%
\mathbf{x},\bm{\omega}_{i})(\bm{\omega}_{i}\!\cdot\!\bm{n}_{x})d\bm{\omega}_{i%
}\end{split}
\displaystyle\begin{split}L(\mathbf{x},\bm{\omega}_{o}\!)\!=\!\smashoperator[%
lr]{\int_{\bm{\omega}_{i}\in\Omega^{+}}^{}}\!f_{s}(\mathbf{x},\bm{\omega}_{o},%
\bm{\omega}_{i})L_{i}^{d}(\mathbf{x},\bm{\omega}_{i})(\bm{\omega}_{i}\!\cdot\!%
\bm{n}_{x})d\bm{\omega}_{i}\!+\!\smashoperator[lr]{\int_{\bm{\omega}_{i}\in%
\Omega}^{}}\!f_{ss}(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{id}(%
\mathbf{x},\bm{\omega}_{i})(\bm{\omega}_{i}\!\cdot\!\bm{n}_{x})d\bm{\omega}_{i%
}\end{split}
f_{s}
f_{ss}
N=800
l=1
3\text{ (color channels)}\times 4\text{ (basis)}=12
100\times 150
C_{k}^{m}
z^{l}
\mathbf{x}
\bm{\omega}
\gamma\in\mathbb{R}
\eta\in\mathbb{R}^{3}
\rho
f_{ss}
f_{sd}
f_{sss}
\bm{p}
L(\mathbf{\hat{x}},\bm{\omega}_{o})=\int_{0}^{\infty}\tau\left(t\right)\cdot%
\sigma\left(\mathbf{p}(t)\right)\cdot L\left(\mathbf{p}(t),\bm{\omega}_{o}%
\right)\,dt
L(\mathbf{\hat{x}},\bm{\omega}_{o})
\mathbf{\hat{x}}
\bm{\omega}_{o}
\sigma(\mathbf{x})
\tau(x)=\exp(-\int_{0}^{x}\sigma(\bm{p}(t))dt)
x
\bm{p}(t)
\bm{\omega}_{o}
\mathbf{\hat{x}}
\bm{p}(t)=\mathbf{\hat{x}}\!+t\bm{\omega}_{o}
\mathbf{x_{0}}
\mathbf{x}
\bm{\omega}
\sigma
\sigma(\mathbf{x})=\alpha_{\sigma}\cdot\exp{(-d_{G}(\mathbf{x})^{2}/(2\delta^{%
2}))}
d_{G}(\mathbf{x})
\mathbf{x}
\mathbf{x_{0}}
\alpha_{\sigma}
\delta
L(\mathbf{x}\!,\bm{\omega}_{o})
\displaystyle L(\mathbf{x},\bm{\omega}_{o})\!=\!\underbrace{\smashoperator[lr]%
{\int_{\bm{\omega}_{i}\in\Omega_{+}}^{}}f_{ss}(\mathbf{x},\bm{\omega}_{o},\bm{%
\omega}_{i})L_{i}^{d}(\mathbf{x},\bm{\omega}_{i})|\bm{\omega}_{i}\cdot\mathbf{%
n_{x}}|d\bm{\omega}_{i}}_{\text{surface specular reflectance with direct light%
}}\!+\!\underbrace{\smashoperator[lr]{\int_{\bm{\omega}_{i}\in\Omega_{+}}^{}}f%
_{sd}(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{d}(\mathbf{x},\bm{%
\omega}_{i})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i}}_{\text{%
surface diffuse reflectance with direct light}}
\displaystyle L(\mathbf{x},\bm{\omega}_{o})
\displaystyle\!=\!\underbrace{\smashoperator[lr]{\int_{\bm{\omega}_{i}\in%
\Omega_{+}}^{}}f_{ss}(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{d}(%
\mathbf{x},\bm{\omega}_{i})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i%
}}_{\text{surface specular reflectance with direct light}}\!+\!\underbrace{%
\smashoperator[lr]{\int_{\bm{\omega}_{i}\in\Omega_{+}}^{}}f_{sd}(\mathbf{x},%
\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{d}(\mathbf{x},\bm{\omega}_{i})|\bm{%
\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i}}_{\text{surface diffuse %
reflectance with direct light}}
\displaystyle\!+\!\underbrace{\smashoperator[lr]{\int_{\bm{\omega}_{i}\in%
\Omega}^{}}f_{sss}(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{id}(%
\mathbf{x},\bm{\omega}_{i})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i%
}}_{\text{subsurface scattering with indirect light}}
\displaystyle\!+\!\underbrace{\smashoperator[lr]{\int_{\bm{\omega}_{i}\in%
\Omega}^{}}f_{sss}(\mathbf{x},\bm{\omega}_{o},\bm{\omega}_{i})L_{i}^{id}(%
\mathbf{x},\bm{\omega}_{i})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i%
}}_{\text{subsurface scattering with indirect light}}
L_{i}^{d}(\mathbf{x},\bm{\omega}_{i})
L_{i}^{id}(\mathbf{x},\bm{\omega}_{i})
\bm{\omega}_{i}
\mathbf{x}
f_{ss}
f_{sd}
f_{sss}
\displaystyle L(\mathbf{x},\bm{\omega}_{o})\!=\!\underbrace{\gamma_{\mathbf{x}%
}\cdot\!\int_{\bm{\omega}_{i}\in\Omega_{+}}L_{i}^{d}(\mathbf{x},\bm{\omega}_{i%
})|\bm{\omega}_{o}\!\cdot\!R(\bm{\omega}_{i},\mathbf{n_{x}})|^{e}d\bm{\omega}_%
{i}}_{\text{surface specular reflectance with direct light}}+\underbrace{\frac%
{\rho_{\mathbf{x}}^{s}}{\pi}\cdot\!\int_{\bm{\omega}_{i}\in\Omega_{+}}L_{i}^{d%
}(\mathbf{x},\bm{\omega}_{i})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_%
{i}}_{\text{surface diffuse reflectance with direct light}}
\displaystyle L(\mathbf{x},\bm{\omega}_{o})
\displaystyle\!=\!\underbrace{\gamma_{\mathbf{x}}\cdot\!\int_{\bm{\omega}_{i}%
\in\Omega_{+}}L_{i}^{d}(\mathbf{x},\bm{\omega}_{i})|\bm{\omega}_{o}\!\cdot\!R(%
\bm{\omega}_{i},\mathbf{n_{x}})|^{e}d\bm{\omega}_{i}}_{\text{surface specular %
reflectance with direct light}}+\underbrace{\frac{\rho_{\mathbf{x}}^{s}}{\pi}%
\cdot\!\int_{\bm{\omega}_{i}\in\Omega_{+}}L_{i}^{d}(\mathbf{x},\bm{\omega}_{i}%
)|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i}}_{\text{surface diffuse %
reflectance with direct light}}
\displaystyle\!+\underbrace{\frac{\rho_{\mathbf{x}}^{ss}+\eta_{\mathbf{x}}}{%
\pi}\cdot\!\int_{\bm{\omega}_{i}\in\Omega}L_{i}^{id}(\mathbf{x},\bm{\omega}_{i%
})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i}}_{\text{subsurface %
scattering with indirect light}}
\displaystyle\!+\underbrace{\frac{\rho_{\mathbf{x}}^{ss}+\eta_{\mathbf{x}}}{%
\pi}\cdot\!\int_{\bm{\omega}_{i}\in\Omega}L_{i}^{id}(\mathbf{x},\bm{\omega}_{i%
})|\bm{\omega}_{i}\cdot\mathbf{n_{x}}|d\bm{\omega}_{i}}_{\text{subsurface %
scattering with indirect light}}
\gamma_{\mathbf{x}}
\eta_{\mathbf{x}}
\mathbf{x}
R(\bm{\omega}_{i},\mathbf{n_{x}})
\bm{\omega}_{i}
\mathbf{n_{x}}
e
\rho_{\mathbf{x}}^{s}
\rho_{\mathbf{x}}^{ss}
\mathbf{x}
\sigma
\alpha_{\sigma}
\delta
10
0.5
64
37
63
800
z\in\mathbb{R}^{3}
z^{l}\in\mathbb{R}^{6\times 15000}
\gamma\in\mathbb{R}
\eta\in\mathbb{R}^{3}
C_{k}^{m}\in\mathbb{R}^{12}
\tau
50,000
2.6
l=1
l=1
l=1
l=1
l=1
\times
\times
800\times 800
800\times 800
\uparrow
\uparrow
\downarrow
37,160
800\times 800
20,736
3008\times 4096
\alpha_{\sigma}
\delta
\alpha_{\sigma}
\delta
\alpha_{\sigma}
\delta
\delta
\delta
\alpha_{\sigma}
800\times 800
1440\times 1440
2880\times 2880
5760\times 5760
