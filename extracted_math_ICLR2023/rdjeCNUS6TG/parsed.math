X_{1:\tau}=(x_{1},\dots,x_{\tau})\in\mathbb{R}^{\tau\times d}
\tau
d
DA=\left\{X_{1:\tau}^{i}\right\}_{i=1}^{N}
N
\hat{X}_{1:\tau}^{i}=G(Z_{i})
Z_{i}=(z_{1}^{i},\dots,z_{t}^{i})\in\mathbb{R}^{\tau\times d\times T}
DA
T
{x_{j}}={\zeta_{j}}+\sum\limits_{i=1}^{m}{{s_{i,j}}+{e_{j}}},\ \ \ j=0,1,\dots%
,\tau-1,
x_{j}
\zeta_{j}
s_{i,j}
i
e_{j}
j
p(.|y)
y
\hat{x}_{0}
x_{t}
\hat{x}_{0}
x_{t}
{\rm i}
{\rm ii}
{\rm iii}
x_{0}\sim q(x)
x_{T}\sim{\cal N}(0,\mathbf{I})
q({x_{t}}|{x_{t-1}})={\cal N}({{x_{t}};\sqrt{1-{\beta_{t}}}{x_{t-1}},{\beta_{t%
}}{\mathbf{I}}})
{\beta_{t}}\in(0,1)
t
{p_{\theta}}({x_{t-1}}|{x_{t}})={\cal N}({x_{t-1}};{\mu_{\theta}}({x_{t}},t),%
\Sigma_{\theta}({x_{t}},t))
x_{T}
\mu_{\theta}(x_{t},t)
t
\mu_{\theta}(x_{t},t)
{\cal L}({x_{0}})=\sum\limits_{t=1}^{T}{\mathop{\mathbb{E}}\limits_{q({x_{t}}|%
{x_{0}})}{{\left\|{\mu({x_{t}},{x_{0}})-{\mu_{\theta}}({x_{t}},t)}\right\|}^{2%
}}},
\mu({x_{t}},{x_{0}})
q({x_{t-1}}|{x_{0},x_{t}})
\mu_{\theta}(x_{t},t)
\hat{x}_{0}(x_{t},t,\theta)
\epsilon_{\theta}(x_{t},t)
w_{(\cdot)}^{i,t}
i\in{1,\dots,D}
t
V_{tr}^{t}
V_{tr}^{t}=\sum\limits_{i=1}^{D}{(\bm{C}\cdot{\rm{Linear}}(w_{tr}^{i,t})+{\cal
X%
}_{tr}^{i,t})},\ \ \ \bm{C}=[1,c,\ldots,{c^{p}}]
{\cal X}_{tr}^{i,t}
i^{th}
\cdot
\bm{C}
c=[0,1,2,\dots,\tau-2,\tau-1]^{T}/\tau
p
p=3
\&
x_{t}
\displaystyle A_{i,t}^{(k)}=\left|{{\cal F}{{(w_{seas}^{i,t})}_{k}}}\right|,\ %
\ \Phi_{i,t}^{(k)}=\phi\left({{\cal F}{{(w_{seas}^{i,t})}_{k}}}\right),
\displaystyle A_{i,t}^{(k)}
\displaystyle=\left|{{\cal F}{{(w_{seas}^{i,t})}_{k}}}\right|,\ \ \Phi_{i,t}^{%
(k)}=\phi\left({{\cal F}{{(w_{seas}^{i,t})}_{k}}}\right),
\displaystyle\kappa_{i,t}{}^{(1)},\cdots,\kappa_{i,t}^{(K)}=\mathop{\arg{\rm{%
TopK}}}\limits_{k\in\{1,\cdots,\left\lfloor{\tau/2}\right\rfloor+1\}}\{A_{i,t}%
^{(k)}\},
\displaystyle\kappa_{i,t}
{}^{(1)},\cdots,\kappa_{i,t}^{(K)}=\mathop{\arg{\rm{TopK}}}\limits_{k\in\{1,%
\cdots,\left\lfloor{\tau/2}\right\rfloor+1\}}\{A_{i,t}^{(k)}\},
\displaystyle{S_{i,t}}=\sum\limits_{k=1}^{K}{A_{i,t}^{\kappa_{i,t}^{(k)}}}%
\left[{\cos({2\pi{f_{\kappa_{i,t}^{(k)}}}\tau c+\Phi_{i,t}^{\kappa_{i,t}^{(k)}%
}})+\cos({2\pi{{\bar{f}}_{\kappa_{i,t}^{(k)}}}\tau c+\bar{\Phi}_{i,t}^{\kappa_%
{i,t}^{(k)}}})}\right],
\displaystyle{S_{i,t}}=\sum\limits_{k=1}^{K}{A_{i,t}^{\kappa_{i,t}^{(k)}}}
\displaystyle\left[{\cos({2\pi{f_{\kappa_{i,t}^{(k)}}}\tau c+\Phi_{i,t}^{%
\kappa_{i,t}^{(k)}}})+\cos({2\pi{{\bar{f}}_{\kappa_{i,t}^{(k)}}}\tau c+\bar{%
\Phi}_{i,t}^{\kappa_{i,t}^{(k)}}})}\right],
\arg{\rm{TopK}}
K
K
A_{i,t}^{(k)}
\Phi_{i,t}^{(k)}
k
\cal F
f_{k}
k
\bar{(\cdot)}
(\cdot)
{\hat{x}_{0}}({x_{t}},t,\theta)=V_{tr}^{t}+\sum\limits_{i=1}^{D}{{S_{i,t}}}+R,
R
\hat{x}_{0}
\hat{x}_{0}
\hat{x}_{0}({x_{t}},t,\theta)
{x_{t-1}}=\frac{{\sqrt{{{\bar{\alpha}}_{t-1}}}{\beta_{t}}}}{{1-{{\bar{\alpha}}%
_{t}}}}{\hat{x}_{0}}({x_{t}},t,\theta)+\frac{{\sqrt{{\alpha_{t}}}(1-{{\bar{%
\alpha}}_{t-1}})}}{{1-{{\bar{\alpha}}_{t}}}}{x_{t}}+\frac{{1-{{\bar{\alpha}}_{%
t-1}}}}{{1-{{\bar{\alpha}}_{t}}}}{\beta_{t}}{z_{t}},
{z_{t}}\sim{\cal N}(0,\mathbf{I})
\alpha_{t}=1-\beta_{t}
\bar{\alpha}_{t}=\prod\limits_{s=1}^{t}\alpha_{s}
{\cal L}_{simple}={\mathbb{E}_{t,{x_{0}}}}\left[{w_{t}{{\left\|{{x_{0}}-{{\hat%
{x}}_{0}}({x_{t}},t,\theta)}\right\|}^{2}}}\right],\ \ \ w_{t}=\frac{{\lambda{%
\alpha_{t}}(1-{{\bar{\alpha}}_{t}})}}{{\beta_{t}^{2}}},
\lambda
t
{\cal L}_{\theta}={\mathbb{E}_{t,{x_{0}}}}\left[{w_{t}\left[{\lambda_{1}{\left%
\|{{x_{0}}-{{\hat{x}}_{0}}({x_{t}},t,\theta)}\right\|}^{2}}+{\lambda_{2}{\left%
\|{{\cal{FFT}}(x_{0})-{\cal{FFT}}({\hat{x}}_{0}}({x_{t}},t,\theta))\right\|}^{%
2}}\right]}\right],
\cal{FFT}
\lambda_{1}
\lambda_{2}
x_{0}
y
p({x_{0:T}}|y)=\prod\nolimits_{t=1}^{T}{p({x_{t-1}}|{x_{t}},y)}
p({x_{t-1}}|{x_{t}},y)\propto p({x_{t-1}}|{x_{t}})\ p(y|{x_{t-1}},{x_{t}})
x_{t-1}
{\nabla_{{x_{t-1}}}}\log p({x_{t-1}}|{x_{t}},y)={\nabla_{{x_{t-1}}}}\log p({x_%
{t-1}}|{x_{t}})+{\nabla_{{x_{t-1}}}}\log p(y|{x_{t-1}}),
\log p({x_{t-1}}|{x_{t}})
\log p(y|{x_{t-1}})
{\nabla_{{x_{t-1}}}}\log p(y|{x_{0|{t-1}}})
x_{a}
x_{b}
{{{\tilde{x}}}_{0}}({x_{t}},t,\theta)={{{\hat{x}}}_{0}}({x_{t}},t,\theta)+\eta%
{\nabla_{{x_{t}}}}(\left\|{{x_{a}}-{{{{\hat{x}}}}_{a}}({x_{t}},t,\theta)}%
\right\|_{2}^{2}+\gamma\log p({x_{t-1}}|{x_{t}})),
\gamma
\eta
{{{\tilde{x}}}_{a}}({x_{t}},t,\theta):=\sqrt{{{\bar{\alpha}}_{t}}}x_{a}+\sqrt{%
1-{{\bar{\alpha}}_{t}}}\epsilon
x_{t-1}
{\tilde{x}}_{0}
\mathbf{Stocks}
\mathbf{ETTh}
\mathbf{Energy}
\mathbf{fMRI}
\mathbf{Sines}
\mathbf{MuJoCo}
\&
\&
\&
\&
\%
1^{st}
2^{nd}
1^{st}
2^{nd}
1^{st}
2^{nd}
r
w
48-w
\%
\%
\%
\%
\%
\%
\sim
\%
\%
\epsilon
\epsilon
\epsilon
q
x_{0}\in\mathbb{R}^{d}
x_{0},\dots,x_{T}
\mathbb{R}^{d}
q({x_{t}}|{x_{t-1}}):={\cal N}({{x_{t}};\sqrt{1-{\beta_{t}}}{x_{t-1}},{\beta_{%
t}}I}),\ \ q({x_{1:T}}|{x_{0}}):=\prod\limits_{t=1}^{T}{q({x_{t}}|{x_{t-1}})},
\beta_{t}\in\left(0,1\right)
t
x_{1\dots T}
x_{0}
x_{T}
\alpha_{t}:=1-\beta_{t}
\bar{\alpha}_{t}:=\prod\limits_{s=1}^{t}\alpha_{s}
x_{t}
t
q({x_{t}}|{x_{0}}):={\cal N}({x_{t}};\sqrt{{\bar{\alpha}_{t}}}{x_{0}},(1-{\bar%
{\alpha}_{t}})I).
\epsilon\sim{\cal N}(0,I)
x_{t}=\sqrt{{{\bar{\alpha}}_{t}}}x_{0}+\sqrt{1-{{\bar{\alpha}}_{t}}}\epsilon.
x_{T}
{p_{\theta}}({x_{t-1}}|{x_{t}}):={\cal N}({x_{t-1}};{\mu_{\theta}}({x_{t}},t),%
\Sigma_{\theta}({x_{t}},t))
x_{0}
{\mathbb{E}_{{x_{0}}}}[\log{p_{\theta}}({x_{0}})]
{{\cal L}_{vlb}}:=\underbrace{-\log{p_{\theta}}({x_{0}}|{x_{1}})}_{{\cal L}_{0%
}}+\sum\limits_{t=2}^{T}{\underbrace{{D_{KL}}(q({x_{t-1}}|{x_{t}},{x_{0}})\ ||%
\ {p_{\theta}}({x_{t-1}}|{x_{t}}))}_{{\cal L}_{t-1}}}+\underbrace{{D_{KL}}(q({%
x_{T}}|{x_{0}})\ ||\ p({x_{T}}))}_{{\cal L}_{T}}.
{\cal L}_{t-1}
{\mu_{\theta}}({x_{t}},t)
{\mu_{\theta}}({x_{t}},t)
{{\cal L}_{origin}}:={\mathbb{E}_{t,{x_{0}}}}\left[\frac{1}{{2{{\Sigma_{\theta%
}^{2}}({x_{t}},t)}}}{\left\|{\hat{\mu}({x_{t}},{x_{0}})-{\mu_{\theta}}({x_{t}}%
,t)}\right\|^{2}}\right],
\hat{\mu}({x_{t}},{x_{0}})
q({x_{t}}|{x_{t-1},x_{0}})
q({x_{t-1}}|{x_{t}},{x_{0}})={\cal N}({x_{t-1}};\frac{{\sqrt{{{\bar{\alpha}}_{%
t-1}}}{\beta_{t}}}}{{1-{{\bar{\alpha}}_{t}}}}{x_{0}}+\frac{{\sqrt{{\alpha_{t}}%
}(1-{{\bar{\alpha}}_{t-1}})}}{{1-{{\bar{\alpha}}_{t}}}}{x_{t}},{\frac{{1-{{%
\bar{\alpha}}_{t-1}}}}{{1-{{\bar{\alpha}}_{t}}}}{\beta_{t}}}\mathbf{I}).
\epsilon
{{\cal L}_{simple}}={\mathbb{E}_{t,{x_{0}},\epsilon}}\left[{{{\left\|{\epsilon%
-{\epsilon_{\theta}}({x_{t}},t)}\right\|}^{2}}}\right].
x_{0}
\epsilon
{\nabla_{{x_{t}}}}\log{q_{t}}({x_{t}}|{x_{0}})\approx-\frac{1}{{1-{{\bar{%
\alpha}}_{t}}}}({x_{t}}-\sqrt{{{\bar{\alpha}}_{t}}}{x_{0}})=-\frac{1}{{\sqrt{1%
-{{\bar{\alpha}}_{t}}}}}\epsilon.
p_{\theta}(x_{t-1}|x_{t})
{x_{t-1}}=\frac{1}{{\sqrt{{\alpha_{t}}}}}({x_{t}}-\frac{{1-{\alpha_{t}}}}{{%
\sqrt{1-{{\bar{\alpha}}_{t}}}}}{\epsilon_{\theta}}({x_{t}},t))+{\sigma_{t}}z,
\sigma_{t}
z
\%
\%
\sim
\%
\%
\sim
\%
cosine
(\beta_{1},\beta_{2})=(0.9,0.96)
\gamma
\%
\gamma\in
\gamma\in
\gamma
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
x=[x^{\rm{ob}},x^{\rm{ta}}]
x^{\rm{ob}}
x^{\rm{ta}}
p_{\theta}(x)
{x_{t}}
\Omega\left({x_{t}}\right)
\bar{\Omega}\left({x_{t}}\right)
{p_{t}}\left({\bar{\Omega}\left({{x_{t}}}\right)|\Omega\left({{x_{0}}}\right)=%
{y}}\right)\approx{p_{t}}\left(\left[\bar{\Omega}\left({{x_{t}}}\right);\Omega%
\left({{x_{t}}}\right)\right]\right)
\hat{\Omega}\left({{x_{t}}}\right)
{p_{t}}\left(\Omega\left({{x_{t}}}\right)|\Omega\left({{x_{0}}={y}}\right)\right)
\left[\bar{\Omega}\left({{x_{t}}}\right);\Omega\left({{x_{t}}}\right)\right]
x_{t}^{\rm{ob}}
q(x_{t}^{\rm{ob}}|x^{\rm{ob}})
x_{t}^{\rm{ta}}
p_{\theta}(x_{t}|x_{t+1})
x_{t}^{\rm{ob}}
x_{t}^{\rm{ta}}
x_{t}^{\rm{ob}}
t
a_{t}{\rm Laynorm}(w)+b_{t}
w
a_{t}
b_{t}
{\rm{Replace}}\left(\cdot\right)
t
\eta
x_{a}
\gamma
x_{T}\sim{\cal N}(0,\mathbf{I})
t
T
\left[\hat{x}_{a},\hat{x}_{b}\right]\leftarrow{\hat{x}}_{0}({x_{t}},t,\theta)
{\cal L}_{1}=\left\|{{x_{a}}-{{{{\hat{x}}}}_{a}}}\right\|_{2}^{2}
x_{t-1}\leftarrow{\cal N}(\mu\left({\hat{x}}_{0}({x_{t}},t,\theta),x_{t}\right%
),\Sigma)
{\cal L}_{2}=\left\|{x_{t-1}-\mu\left({\hat{x}}_{0}({x_{t}},t,\theta),x_{t}%
\right)}\right\|_{2}^{2}/\Sigma
{{{\tilde{x}}}_{0}}={{{\hat{x}}}_{0}}({x_{t}},t,\theta)+\eta{\nabla_{{x_{t}}}}%
({\cal L}_{1}+\gamma{\cal L}_{2})
x_{t-1}\leftarrow{\cal N}(\mu\left({{\tilde{x}}}_{0},x_{t}\right),\Sigma)
x_{t-1}\leftarrow
\left(x_{a},x_{t-1},t\right)
\eta
x_{a}
\gamma
K
x_{T}\sim{\cal N}(0,\mathbf{I})
t
T
i
K[t]
\left[\hat{x}_{a},\hat{x}_{b}\right]\leftarrow{\hat{x}}_{0}({x_{t}},t,\theta)
{\cal L}_{1}=\left\|{{x_{a}}-{{{{\hat{x}}}}_{a}}}\right\|_{2}^{2}
x_{t-1}\leftarrow{\cal N}(\mu\left({\hat{x}}_{0}({x_{t}},t,\theta),x_{t}\right%
),\Sigma)
{\cal L}_{2}=
\left\|{x_{t-1}-\mu\left({\hat{x}}_{0}({x_{t}},t,\theta),x_{t}\right)}\right\|%
_{2}^{2}/\Sigma
{x_{t}}=x_{t}+\eta{\nabla_{{x_{t}}}}({\cal L}_{1}+\gamma{\cal L}_{2})
x_{t-1}\leftarrow{\cal N}(\mu\left({\hat{x}}_{0}({x_{t}},t,\theta),x_{t}\right%
),\Sigma)
x_{t-1}\leftarrow
\left(x_{a},x_{t-1},t\right)
\_
\&
\mid
-
\mid
i^{th}
j^{th}
{{\mathop{\rm cov}}_{i,j}}=\frac{1}{T}\sum\limits_{t=1}^{T}{X_{i}^{t}X_{i}^{t}%
}-\left({\frac{1}{T}\sum\limits_{t=1}^{T}{X_{i}^{t}}}\right)\left({\frac{1}{T}%
\sum\limits_{t=1}^{T}{X_{j}^{t}}}\right).
\frac{1}{{10}}\sum\limits_{i,j}^{d}{\left|{\frac{{{\mathop{\rm cov}}_{i,j}^{r}%
}}{{\sqrt{{\mathop{\rm cov}}_{i,i}^{r}}{\mathop{\rm cov}}_{j,j}^{r}}}-\frac{{{%
\mathop{\rm cov}}_{i,j}^{f}}}{{\sqrt{{\mathop{\rm cov}}_{i,i}^{f}}{\mathop{\rm
cov%
}}_{j,j}^{f}}}}\right|},
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
\%
