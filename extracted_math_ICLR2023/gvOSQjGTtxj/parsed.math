\mathcal{M}=\langle\mathcal{S},\mathcal{A},p,r,\mu_{0},\gamma\rangle
\mathcal{S}
\mathcal{A}
p:\mathcal{S}\times\mathcal{A}\mathrel{\text{\char 59\relax}}\mathcal{S}
r:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
\mu_{0}
\gamma\in[0,1]
s\in\cS
\pi(s)
\cA
J(\pi,\mathcal{M}):=\mathbb{E}_{s_{0}\sim\mu_{0},a_{t}\sim\pi,\,s_{t>0}\sim p}%
[\sum_{t=0}^{H}\gamma^{t}r(s_{t},a_{t})]
H
\pi
(s,a)\in\cS\times\cA
s
a
\pi
Q^{\pi}(s,a)=\mathbb{E}_{a_{t>0}\sim\pi,s_{t>0}\sim p}\big{[}\sum_{t=0}^{H}%
\gamma^{t}r(s_{t},a_{t})\mid s_{0}=s,a_{0}=a\big{]}
a_{0}
V^{\pi}(s)=\mathbb{E}_{a_{t}\sim\pi,s_{t>0}\sim p}\big{[}\sum_{t=0}^{H}\gamma^%
{t}r(s_{t},a_{t})\mid s_{0}=s\big{]}
\mathcal{D}=\{(s_{t}^{i},a_{t}^{i},r_{t}^{i},s_{t+1}^{i})\}_{i=1}^{N}
N
\pi^{\beta}
\mathcal{M}
J(\pi,\mathcal{M})
\pi\not=\pi^{\beta}
\mathcal{D}
\hat{p}
\hat{r}
\mathcal{L}(\mathcal{D};\hat{p})=\frac{1}{N}\sum_{i=1}^{N}\log\hat{p}(s^{i}_{t%
+1}|s^{i}_{t},a^{i}_{t})
\hat{\mathcal{M}}=\langle\mathcal{S},\mathcal{A},\hat{p},\hat{r},\mu_{0},\gamma\rangle
\mathcal{S},\mathcal{A}
\mathcal{M}
\hat{p}
\hat{r}
\mathcal{D}
\hat{\pi}=\argmax_{\pi}J(\pi,\hat{\mathcal{M}})
\mathcal{M}
J(\pi,\hat{\mathcal{M}})
J(\pi,\mathcal{M})
\mathcal{L}(\mathcal{D};\hat{p})
\pi
s_{t+1},r_{t}\sim\hat{p}_{\theta}(.|s_{t},a_{t})=\mathcal{N}\big{(}\mu_{\theta%
}(s_{t},a_{t}),\sigma_{\theta}(s_{t},a_{t})\big{)}
\theta
\sigma_{\theta}=\mathrm{Diag}(\exp(l_{\theta}))
l_{\theta}
y
(s_{t},a_{t})
\hat{p}_{\theta}(s_{t+1}|s_{t},a_{t})=\hat{p}_{\theta_{1}}(s^{1}_{t+1}|s_{t},a%
_{t})\prod^{d_{s}}_{j=2}\hat{p}_{\theta_{j}}(s^{j}_{t+1}|s^{1}_{t+1},\ldots,s^%
{j-1}_{t+1},s_{t},a_{t})
d_{s}
\cS
\hat{u}(s,a)
D\in\mathbb{N}^{*}-\{1\}
\mathcal{D}_{\ell}
\ell\in\{1,\ldots,D\}
\mathcal{D}
\hat{p}
\hat{p}
J(\pi,\mathcal{M})\geq\mathbb{E}_{a\sim\pi,\,s\sim\hat{p}}\big{[}r(s,a)-\gamma%
|G^{\pi}_{\hat{\mathcal{M}}}(s,a)|\big{]}
G^{\pi}_{\hat{\mathcal{M}}}(s,a)
\mathbb{E}_{s^{\prime}\sim\hat{p}(s,a)}[V^{\pi}_{\cM}(s^{\prime})]-\mathbb{E}_%
{s^{\prime}\sim p(s,a)}[V^{\pi}_{\cM}(s^{\prime})]
\pi
\cM
G^{\pi}_{\hat{\mathcal{M}}}(s,a)
G^{\pi}_{\hat{\mathcal{M}}}(s,a)\leq\sup_{f\in\mathcal{F}}\mid\mathbb{E}_{s^{%
\prime}\sim\hat{p}}[f(s^{\prime})]-\mathbb{E}_{s^{\prime}\sim p}[f(s^{\prime})]\mid
\mathcal{F}
\tilde{r}(s,a)=\hat{r}(s,a)-\lambda\hat{u}(s,a)
\hat{u}(s,a)=\max_{\ell=1,\ldots,N}\|\sigma^{\ell}_{\theta}(s,a)\|_{F}
\lambda
\tilde{\mathcal{M}}=\langle\mathcal{S},\mathcal{A},\hat{p},\tilde{r},\mu_{0},\gamma\rangle
\cD
\tilde{\mathcal{M}}
\cD
\lambda
h
B
\hat{u}(s,a)
\hat{p}
\cD
\pi
\cD_{model}
1,2,\ldots,B
s_{0}
\cD
i=1,2,\ldots,h
a_{i}\sim\pi(s_{i})
s_{i+1},r_{i}\sim\hat{p}(s_{i},a_{i})
\tilde{r}_{i}=r_{i}-\lambda\hat{u}(s_{i},a_{i})
(s_{i},a_{i},\tilde{r}_{i},s_{i+1})
\cD_{model}
\cD_{model}
\pi
\hat{u}(s,a)=\max_{\ell=1,\ldots,N}\|\sigma^{\ell}_{\theta}(s,a)\|_{F}
\hat{u}(s,a)=\max_{\ell=1,\ldots,N}\|\sigma^{\ell}_{\theta}(s,a)\|_{F}
\hat{u}(s,a)=\max_{l,l^{\prime}}\|\mu^{l}_{\theta_{l}}(s,a)-\mu^{l^{\prime}}_{%
\theta_{l^{\prime}}}(s,a)\|_{2}
l\neq l^{\prime}\in{1,\ldots,D}
\hat{u}(s,a)=\sqrt{\frac{1}{D}\sum_{l}^{D}\left((\sigma^{l}_{\theta_{l}}(s,a))%
^{2}+(\mu^{l}_{\theta_{l}}(s,a))^{2}\right)-(\bar{\mu}(s,a))^{2}}
\bar{\mu}(s,a)=\frac{1}{D}\sum_{l}^{D}\mu^{l}_{\theta_{l}}(s,a)
D
d_{s}\in\mathbb{N}^{*}
D\in\mathbb{N}^{*}
d_{s}
\mathcal{S}
D
D\in\mathbb{N}^{*}
D\in\mathbb{N}^{*}
\sigma_{\theta}
\cD
\hat{p}
L
L
L\in\{1,\ldots,20\}
R(\{(s_{t},a_{t},r_{t},s_{t+1})\}_{t=1}^{H})=\sum_{t=1}^{H}r_{t}
H
\hat{p}
\%
\downarrow
\uparrow
/
\downarrow
\uparrow
/
\uparrow
/10^{-4}
\downarrow
/10^{-4}
\uparrow
/10^{-3}
\downarrow
/10^{-4}
\uparrow
/10^{-3}
\downarrow
0.5
L
L
(L)
(L)
L\in\{1,\ldots,20\}
L
\pm
90\%
\pm
90\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\rho
r
\rho=1
r=1
\rho=1.0
r=0.93
(1)
\rho=1.0
r=0.83
\pm
90\%
\pm
90\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\hat{p}^{\ell}_{\theta}=\mathcal{N}(\mu^{\ell}_{\theta},\sigma^{\ell}_{\theta}%
)\}^{D}_{\ell=1}
h\in\{1,5\}
10^{-3}
3\times 10^{-4}
10^{-3}
3\times 10^{-4}
50
100
200
100
200
500
1
2
2
3
4
\%
h\in\{1,5,50,100\}
\lambda\in\{0.1,1,5,25\}
u\in\{
\}
h
\lambda
u
3\times 10^{-4}
500
3
5
0.1
10^{-3}
200
2
100
1.0
3\times 10^{-4}
500
3
5
5
3\times 10^{-4}
500
3
5
0.1
10^{-3}
200
1
5
0.1
3\times 10^{-4}
500
3
50
25
3\times 10^{-4}
500
3
5
0.1
10^{-3}
200
2
100
0.1
3\times 10^{-4}
500
3
50
5
10^{-3}
200
1
100
0.1
3\times 10^{-4}
200
3
5
0.1
11
x
x
\|a_{t}\|_{2}^{2}
\dot{x}_{t}-0.1\times\|a_{t}\|_{2}^{2}+\mathbf{1}\{\text{state is healthy}\}
p(s_{t+1}|s_{t},a_{t})=p_{1}(s^{1}_{t+1}|\bx_{t}^{1})\prod_{j=2}^{d_{\text{s}}%
}{\text{$p_{j}(s^{j}_{t+1}|\bx_{t}^{j})$}}\quad\text{where}\quad\bx_{t}^{j}=%
\big{(}s^{1}_{t+1},\ldots,s^{j-1}_{t+1},s_{t},a_{t}\big{)}.
\cD
N
\cD
\text{R2}(\cD;\theta;j\in\{1,\ldots,d_{s}\})=1-\frac{\frac{1}{N}\sum_{i=1}^{N}%
\left(s^{j}_{i,t+1}-\mu^{j}_{\theta}(s^{j}_{i,t},a_{i,t})\right)^{2}}{\frac{1}%
{N}\sum_{i=1}^{N}\left(s^{j}_{i,t+1}-\bar{s}^{j}_{t+1}\right)^{2}}
\theta
\bar{s}^{j}_{t+1}
j^{\text{th}}
s_{t+1}
\cD
\cL(\cD;\theta;j\in\{1,\ldots,d_{s}\})=\frac{1}{N}\sum_{i=1}^{N}\log p^{j}_{%
\theta}\left(s_{i,t+1}|s_{i,t},a_{i,t}\right)
p_{\theta}
\mathcal{N}\big{(}\mu_{\theta}(s_{t},a_{t}),\sigma_{\theta}(s_{t},a_{t})\big{)}
\cL
\cL_{\text{baseline}}
\cD
\text{LR}(\cD;\theta;j\in\{1,\ldots,d_{s}\})=\frac{e^{\cL(\cD;\theta;j\in\{1,%
\ldots,d_{s}\})}}{e^{\cL_{\text{baseline}}(\cD;j\in\{1,\ldots,d_{s}\})}}
p_{\min}=1.47\times 10^{-6}
LR
\text{OR}(\cD;\theta;j\in\{1,\ldots,d_{s}\})=1-\frac{|\big{\{}(s_{t},a_{t},s_{%
t+1})\in\cD:p^{j}_{\theta}(s_{t+1}|s_{t},a_{t})>p_{\min}\big{\}}|}{N}
F_{\theta}(s_{t+1}|s_{t},a_{t})
\cF_{\theta,j}(x)=\frac{\big{|}\big{\{}(s_{t},a_{t},s_{t+1})\in\cD|F^{j}_{%
\theta}(s_{t+1}|s_{t},a_{t})\leq x\big{\}}\big{|}}{N}
x\in[0,1]
U(x)
[0,1]
\cD
\begin{split}\text{KS}(\cD;\theta;j\in\{1,\ldots,d_{s}\})&=\\
&\max_{i\in\{1,\ldots,N\}}\left|\cF_{\theta,j}(F^{j}_{\theta}(s_{i,t+1}|s_{i,t%
},a_{i,t}))-U(F^{j}_{\theta}(s_{i,t+1}|s_{i,t},a_{i,t}))\right|\end{split}
L
L
n\in\N
L_{\max}
\cY_{L}=[\hat{\bs}_{\ell,t+1:t+L_{\max}}]_{\ell=1}^{n}
L
L=0,\ldots,L_{\max}
\hat{\mu}_{\theta}(s_{t+L}|s_{t},a_{t})=\frac{1}{n}\sum_{\hat{\bs}\in\cY_{L}}%
\hat{s}_{t+L}
L
F_{\theta}(s_{t+L}|s_{t},a_{t})=\frac{|\{\hat{\bs}\in\cY_{L}:\hat{s}_{t+L}\leq
s%
_{t+L}\}|}{n}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
L
L
L
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
1
1
10
10
20
20
L
