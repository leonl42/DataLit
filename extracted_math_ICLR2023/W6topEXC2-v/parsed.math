\epsilon
2.24\%
5.25\%
f_{\theta}:\mathbb{R}^{M}\rightarrow\mathbb{R}^{C}
M
C
f_{\theta}
\Delta
\Delta
L_{2}
L_{\infty}
\epsilon
\Delta=\{\delta\ :\ \lVert\delta\rVert_{c\in\{2,\infty\}}\leq\epsilon\}
\mathbf{x}
y
\Delta
\hat{\mathbf{x}}
\hat{\mathbf{x}}=\mathbf{x}+\delta\ s.t.\ \delta\in\Delta,y_{pred}\neq y
y_{pred}
\hat{\mathbf{x}}
\hat{\mathbf{x}}
p_{\theta}(y|\hat{\mathbf{x}})
\hat{\mathbf{x}}
p_{\theta}(\hat{y}|\hat{\mathbf{x}})\ s.t.\ \hat{y}\neq y
\hat{\mathbf{x}}
\hat{y}
Repeat:\delta=Proj_{\epsilon}(\delta+\alpha\nabla_{\delta}\mathcal{L}(f_{%
\theta}(\mathbf{x}+\delta_{t}),y)).
Proj_{\epsilon}
\Delta
\alpha
\mathcal{L}(\cdot)
\mathcal{L}_{CE}(\mathbf{z},y)=-\log\frac{\exp(\mathbf{z}_{y})}{\sum_{i=1}^{C}%
\exp(\mathbf{z}_{i})},
\mathbf{z}_{y}
\mathbf{z}_{i}
y
i
\min_{\theta}\sum_{(\mathbf{x},y)\in D}\max_{\delta\in\Delta}\mathcal{L}(f_{%
\theta}(\mathbf{x}+\delta),y).
\Delta
\mathcal{L}
\mathcal{L}(\mathbf{z},y)=\mathbf{I}(\texttt{argmax}_{i}(\mathbf{z}_{i})=y)
\mathbf{I}
\theta
\delta
\delta
\theta
\epsilon
\epsilon
\epsilon
f_{\theta}
\nabla_{\mathbf{x}}f_{\theta}(\mathbf{x})_{y}
f_{\theta}(\mathbf{x})_{y}
y
f_{\theta}(\mathbf{x})
\theta
(\mathbf{x},y)
D
g(\mathbf{x},y_{t})
\begin{split}\mathcal{L}_{total}(\mathbf{x},y)=&\mathcal{L}_{CE}\left(f_{%
\theta}(\mathbf{x}),y\right)+\\
&\lambda\sum_{y_{t}=1}^{C}\mathcal{L}_{cos}\left(\nabla_{\mathbf{x}}f_{\theta}%
(\mathbf{x})_{y_{t}},g(\mathbf{x},y_{t})\right),\end{split}
\mathcal{L}_{CE}
\lambda
C
\mathcal{L}_{cos}
\mathcal{L}_{cos}(\mathbf{v},\mathbf{u})=1-\frac{\mathbf{v}^{\top}\mathbf{u}}{%
\texttt{max}(\lVert\mathbf{v}\rVert_{2}\cdot\lVert\mathbf{u}\rVert_{2},%
\varepsilon)},
\varepsilon
\epsilon
g(\cdot,\cdot)
g(\mathbf{x},y_{t})
\mathbf{x}\in D
{y_{t}\in\{1,2,\dots,C\}}
g(\mathbf{x},y_{t})
y_{t}
\mathbf{r}_{y_{t}}
{g(\mathbf{x},y_{t})=\mathbf{r}_{y_{t}}-\mathbf{x}}
\mathbf{r}_{y_{t}}
y_{t}
y_{t}
\mathbf{r}_{y_{t}}
y_{t}
\mathbf{x}
y_{t}\in\{1,2\dots,C\}
\mathbf{r}_{y_{t}}(\mathbf{x})
y_{t}
L_{2}
\mathbf{r}(\mathbf{x},y_{t})=\operatorname*{arg\,min}_{\hat{\mathbf{x}}\in D_{%
y_{t}}\ \textrm{s.t.}\ \hat{\mathbf{x}}\neq\mathbf{x}}\lVert\hat{\mathbf{x}}-%
\mathbf{x}\rVert_{2},
D_{y_{t}}
y_{t}
\mathbf{x}
\left\{\mathbf{x}_{t}\right\}_{t=1}^{T}
\left\{p_{t}(\mathbf{x}_{t})\right\}_{t=1}^{T}
p_{t}(\cdot)
t
\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t})
\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t}|y)
g(\cdot,\cdot)
\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t}|y)=\nabla_{\mathbf{x}_{t}}\log p(%
y|\mathbf{x}_{t})+\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t}),
\nabla_{\mathbf{x}_{t}}\log p(y|\mathbf{x}_{t})=\nabla_{\mathbf{x}_{t}}\log p(%
\mathbf{x}_{t}|y)-\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t}).
\log p(y|\mathbf{x}_{t})
\mathbf{x}
\mathbf{x}_{t}
{\log p(y|\mathbf{x})\approx\log p(y|\mathbf{x}_{t})}
t
t
t
75.5\%
0.0\%
L_{\infty}
L_{2}
\epsilon=8/255
L_{\infty}
\epsilon=0.5
L_{2}
L_{2}
L_{\infty}
L_{2}
L_{\infty}
L_{2}
\mathbf{+12.94\%}
L_{2}
\mathbf{+18.03\%}
85.75\%
80.51\%
L_{2}
L_{\infty}
\epsilon=0.5
\epsilon=8/255
\mathbf{93.61\%}
00.00\%
00.00\%
79.46\%
46.63\%
13.50\%
81.41\%
47.25\%
11.24\%
80.65\%
42.12\%
07.51\%
78.56\%
55.39\%
23.97\%
{L_{\infty}}
82.49\%
56.57\%
\mathbf{37.59\%}
{L_{2}}
86.79\%
\mathbf{60.82\%}
19.63\%
80.51\%
00.87\%
00.01\%
78.06\%
15.47\%
00.21\%
78.98\%
13.73\%
00.17\%
79.00\%
13.91\%
00.15\%
\mathbf{85.75\%}
\mathbf{61.02\%}
22.1\%
{L_{\infty}}
62.20\%
42.80\%
\mathbf{24.62\%}
{L_{2}}
72.81\%
42.99\%
08.13\%
96\times 96
5,000
8,000
\epsilon=4/255
L_{\infty}
\epsilon=0.5
L_{2}
\mathbf{+19.8\%}
L_{2}
\mathbf{+19.63\%}
10
100
10
L_{2}
L_{2}
L_{\infty}
\mathbf{82.60\%}
00.00\%
00.00\%
70.66\%
58.90\%
33.71\%
74.79\%
\mathbf{65.96\%}
\mathbf{43.53\%}
{L_{\infty}}
54.90\%
46.33\%
28.30\%
{L_{2}}
54.99\%
46.04\%
23.33\%
\mathbf{74.36\%}
00.00\%
00.00\%
58.89\%
19.94\%
02.78\%
55.94\%
29.25\%
08.24\%
{L_{\infty}}
52.92\%
26.31\%
\mathbf{14.63\%}
{L_{2}}
58.05\%
\mathbf{30.51\%}
08.03\%
\epsilon
\epsilon
L_{2}
L_{\infty}
\epsilon
0.5
8/255
\epsilon
55.39\%
\epsilon=0.5
60.82\%
L_{2}
L_{2}
\epsilon=1.0
L_{2}
\epsilon=1.0
\epsilon
L_{2}
L_{\infty}
\epsilon=1
\epsilon=16/255
\mathbf{93.61\%}
00.00\%
00.00\%
78.56\%
\mathbf{30.43\%}
01.92\%
{L_{\infty}}
82.49\%
25.26\%
\mathbf{08.02\%}
{L_{2}}
86.79\%
18.81\%
00.50\%
\lambda
\lambda
L_{2},\epsilon=0.5
L_{\infty},\epsilon=8/255
\mathbf{+0.91\%}
\mathbf{+2.24\%}
L_{2}
L_{\infty}
\mathbf{+3.89\%}
\mathbf{+5.25\%}
L_{2}
L_{\infty}
L_{2}
L_{\infty}
\epsilon=0.5
\epsilon=8/255
L_{2}
86.79\%
60.82\%
19.63\%
85.54\%
61.73\%
23.52\%
\Delta
L_{\infty}
83.04\%
57.41\%
43.54\%
84.59\%
62.66\%
45.78\%
\Delta
\lambda
\lambda
\epsilon
\mathbf{x}_{T}
\mathbf{x}_{0}
t\in\{T,T-1,\dots,1\}
\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t})
\mathbf{x}_{t}
\mathbf{x}_{0}
\sigma_{t}
y
\nabla_{\mathbf{x}_{t}}\log p(\mathbf{x}_{t}|y)
L_{2},\epsilon=0.5
128
\lambda=0.5
64
\lambda=0.5
L_{2}
\mathbf{92.32\%}
00.20\%
81.93\%
\mathbf{42.03\%}
\mathbf{92.47\%}
00.11\%
82.05\%
\mathbf{41.49\%}
\mathbf{90.82\%}
02.50\%
79.22\%
\mathbf{35.79\%}
\mathbf{72.05\%}
00.50\%
63.04\%
\mathbf{35.97\%}
L_{2}
L_{\infty}
L_{2}
\epsilon=0.5
L_{2}
100,000
64\times 64\times 3
200
L_{2}
L_{\infty}
\mathbf{61.19\%}
02.37\%
00.00\%
50.04\%
19.21\%
03.14\%
57.40\%
\mathbf{25.21\%}
\mathbf{05.50\%}
\mathbf{x}=[x_{1},x_{2}]
x_{2}-2x_{1}=0
\mathbb{R}^{2}
y\in\{0,1\}
x_{1}\sim N(c,1),x_{2}=2*x_{1}
c
\{-50,-10,30\}
\{-30,10,50\}
(2\rightarrow 32\rightarrow 2)
100
128
0.01
L_{2}
\epsilon=15
2
\epsilon
32\times 32\times 3
96\times 96\times 3
C
C=10
C=100
C
C+1
1/C
C
t
t
t
t
t
t
t
t
t
t
100
0.01
0.9
0.0001
4
0.5
64
32
\lambda
\lambda
\lambda
7
1.5*\frac{\epsilon}{7}
L_{2}
\lambda
\lambda
0.2
0.1
0.2
0.1
0.2
0.5
0.2
0.1
1.5
3
1
1
L2,\epsilon=0.5
L_{\infty},\epsilon=8/255
\lambda
0.2
0.5
L_{2}
L_{\infty}
1
t
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
\epsilon
