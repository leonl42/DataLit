3.86
\approx 10
2.63
\approx 20
6.99
\approx 160
7.16
4000
\{(\bm{x}_{n},t_{n})\}
\bm{x}
t
\sigma
\bm{x}_{n}
t=t_{n}
t=0
t_{n}
0
t=t_{n}
t=0
t=T
t=0
\sigma
\sigma
3.86
\approx 10
2.63
\approx 20
6.99
\approx 160
p(\bm{x})
\sigma
p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})=\mathcal{N}(\bm{x}\mid\tilde{\bm{x}},%
\sigma^{2}\bm{I})
\displaystyle\min_{\theta}\mathbb{E}_{p(\tilde{\bm{x}})}\mathbb{E}_{p_{\sigma}%
(\bm{x}\mid\tilde{\bm{x}})}\left[\|{\bm{s}}_{\theta}(\bm{x})-\nabla_{\bm{x}}%
\log p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})\|_{2}^{2}\right]
\displaystyle\min_{\theta}\mathbb{E}_{p(\tilde{\bm{x}})}\mathbb{E}_{p_{\sigma}%
(\bm{x}\mid\tilde{\bm{x}})}\left[\|{\bm{s}}_{\theta}(\bm{x})-\nabla_{\bm{x}}%
\log p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})\|_{2}^{2}\right]
{\bm{s}}_{\theta}(\bm{x})
\int p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})p(\tilde{\bm{x}})\,d\tilde{\bm{x}}
{\bm{s}}_{\theta}(\bm{x},\sigma)
\displaystyle\min_{\theta}\mathbb{E}_{\lambda(\sigma)}\mathbb{E}_{p(\tilde{\bm%
{x}})}\mathbb{E}_{p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})}\left[\|{\bm{s}}_{%
\theta}(\bm{x},\sigma)-\nabla_{\bm{x}}\log p_{\sigma}(\bm{x}\mid\tilde{\bm{x}}%
)\|_{2}^{2}\right]
\displaystyle\min_{\theta}\mathbb{E}_{\lambda(\sigma)}\mathbb{E}_{p(\tilde{\bm%
{x}})}\mathbb{E}_{p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})}\left[\|{\bm{s}}_{%
\theta}(\bm{x},\sigma)-\nabla_{\bm{x}}\log p_{\sigma}(\bm{x}\mid\tilde{\bm{x}}%
)\|_{2}^{2}\right]
\lambda(\sigma)
(\sigma_{\min},\sigma_{\max})
\int p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})p(\tilde{\bm{x}})\,d\tilde{\bm{x}}
p(\bm{x})
\sigma\rightarrow 0
p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})
\bm{x}
p(\bm{x})
\nabla_{\bm{x}}\log p(\bm{x})
p(\bm{x})
\{\bm{x}_{n}\}_{n=1}^{\infty}
\displaystyle\bm{x}_{n+1}=\bm{x}_{n}+(\eta/2)\cdot\nabla_{\bm{x}}\log p(\bm{x}%
_{n})+\sqrt{\eta}\cdot\bm{\epsilon}
\displaystyle\bm{x}_{n+1}=\bm{x}_{n}+(\eta/2)\cdot\nabla_{\bm{x}}\log p(\bm{x}%
_{n})+\sqrt{\eta}\cdot\bm{\epsilon}
{\bm{\epsilon}}\sim\mathcal{N}(\bm{0},\bm{I})
\{\bm{x}_{n}\}_{n=1}^{\infty}
p(\bm{x})
\eta
p(\bm{x},\bm{y})
(\bm{x}_{n},\bm{y}_{n})
\bm{x}_{n+1}
p(\bm{x}\mid\bm{y}_{n})
\bm{y}_{n+1}
p(\bm{y}\mid\bm{x}_{n+1})
\{\sigma_{i}\}_{i=1}^{N}
\int p_{\sigma_{i}}(\bm{x}\mid\tilde{\bm{x}})p(\tilde{\bm{x}})\,d\tilde{\bm{x}}
p(\bm{x})
i=N,N-1,\ldots,1
p(\bm{x})
\mathbb{R}^{d}
\bm{x}_{0}\sim p(\bm{x})
\displaystyle d\bm{x}=\bm{f}(\bm{x},t)\,dt+g(t)\,d\bm{w}
\displaystyle d\bm{x}=\bm{f}(\bm{x},t)\,dt+g(t)\,d\bm{w}
\bm{f}:\mathbb{R}^{d}\times[0,T]\rightarrow\mathbb{R}^{d}
g:[0,T]\rightarrow\mathbb{R}
\bm{w}
T
\bm{x}(0)=\bm{x}_{0}
t=0
t=T
\displaystyle d\bm{x}=[\bm{f}(\bm{x},t)-g(t)^{2}\nabla_{\bm{x}}\log p_{t}(\bm{%
x})]\,dt+g(t)\,d\bar{\bm{w}}
\displaystyle d\bm{x}=[\bm{f}(\bm{x},t)-g(t)^{2}\nabla_{\bm{x}}\log p_{t}(\bm{%
x})]\,dt+g(t)\,d\bar{\bm{w}}
p_{t}(\bm{x})
\bm{x}(t)
\bar{\bm{w}}
t=T
t=0
\bm{x}_{T}
\bm{x}(T)=\bm{x}_{T}
t=T
t=0
p(\bm{x})
\displaystyle d\bm{x}=\left[\bm{f}(\bm{x},t)-(1/2)\cdot g(t)^{2}\nabla_{\bm{x}%
}\log p_{t}(\bm{x})\right]\,dt
\displaystyle d\bm{x}=\left[\bm{f}(\bm{x},t)-(1/2)\cdot g(t)^{2}\nabla_{\bm{x}%
}\log p_{t}(\bm{x})\right]\,dt
t=T
t=0
p(\bm{x})
\displaystyle d\bm{x}=\sqrt{\frac{d[\sigma^{2}(t)]}{dt}}\,d\bm{w}.
\displaystyle d\bm{x}=\sqrt{\frac{d[\sigma^{2}(t)]}{dt}}\,d\bm{w}.
\sigma(t)
t
\sigma_{\min}
\sigma_{\max}
\displaystyle\textstyle p_{t}(\bm{x})=\int p_{\sigma(t)}(\bm{x}\mid\tilde{\bm{%
x}})p(\tilde{\bm{x}})\,d\tilde{\bm{x}}
\displaystyle\textstyle p_{t}(\bm{x})=\int p_{\sigma(t)}(\bm{x}\mid\tilde{\bm{%
x}})p(\tilde{\bm{x}})\,d\tilde{\bm{x}}
\sigma_{\min}
p_{0}(\bm{x})\approx p(\bm{x})
\sigma_{\max}
p_{T}(\bm{x})\approx\mathcal{N}(\bm{x}\mid\bm{0},\sigma_{\max}^{2}\bm{I})
{\bm{s}}_{\theta}(\bm{x},\sigma)
\nabla_{\bm{x}}\log p_{t}(\bm{x})\approx{\bm{s}}_{\theta}(\bm{x},\sigma(t))
\bm{x}_{T}\sim\mathcal{N}(\bm{x}\mid\bm{0},\sigma_{\max}^{2}\bm{I})
\bm{x}(T)=\bm{x}_{T}
t=T
t=0
p(\bm{x})
\mathcal{X}\subseteq\mathbb{R}^{d}
t=0
t=T
\sigma(t)
\sigma_{\min}
\sigma_{\max}
\sigma(0)=\sigma_{\min}
\sigma(T)=\sigma_{\max}
\sigma(t)
\SS=[\sigma_{\min},\sigma_{\max}]
p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})=\mathcal{N}(\bm{x}\mid\tilde{\bm{x}},%
\sigma^{2}\bm{I})
\bm{x}(t)
p_{t}(\bm{x})
p_{t}(\bm{x})=\int p_{\sigma(t)}(\bm{x}\mid\tilde{\bm{x}})p(\tilde{\bm{x}})\,d%
\tilde{\bm{x}}
\mathcal{X}\times\SS
\mathcal{X}
\sigma
\sigma(t)
t
\mathcal{X}\times\mathcal{S}
p(\bm{x})
d
d
p(\bm{x})
p_{\sigma}(\bm{x}\mid\tilde{\bm{x}})
\sigma
p(\bm{x})
\mathcal{X}
\sigma
\mathcal{X}\times\SS
\sigma
\mathcal{X}\times\SS
\sigma
\displaystyle\textstyle\hat{p}(\bm{x}\mid\sigma)\coloneqq\int p_{\sigma}(\bm{x%
}\mid\tilde{\bm{x}})p(\tilde{\bm{x}})\,d\bm{\tilde{x}}.
\displaystyle\textstyle\hat{p}(\bm{x}\mid\sigma)\coloneqq\int p_{\sigma}(\bm{x%
}\mid\tilde{\bm{x}})p(\tilde{\bm{x}})\,d\bm{\tilde{x}}.
\hat{p}(\sigma)
\SS
\displaystyle\hat{p}(\bm{x},\sigma)=\hat{p}(\bm{x}\mid\sigma)\cdot\hat{p}(%
\sigma).
\displaystyle\hat{p}(\bm{x},\sigma)=\hat{p}(\bm{x}\mid\sigma)\cdot\hat{p}(%
\sigma).
\hat{p}(\sigma)
\sigma
\hat{p}(\bm{x},\sigma)
\{(\bm{x}_{n},\sigma_{n})\}
\mathcal{X}\times\SS
\displaystyle\sigma_{n}\sim\hat{p}(\sigma),\qquad\bm{x}_{n}\sim\hat{p}(\bm{x}%
\mid\sigma_{n}).
\displaystyle\sigma_{n}\sim\hat{p}(\sigma),\qquad\bm{x}_{n}\sim\hat{p}(\bm{x}%
\mid\sigma_{n}).
\sigma_{n}\gg\sigma_{\min}
\bm{x}_{n}
\sigma_{n}^{2}
\sigma_{n}\approx\sigma_{\min}
\bm{x}_{n}
p(\bm{x})
p(\bm{x})
(\bm{x}_{n},\sigma_{n})
\sigma_{n}\approx\sigma_{\min}
t=T
t=0
p_{T}(\bm{x})
p_{0}(\bm{x})\approx p(\bm{x})
t=t_{2}
t=t_{1}
t_{1}<t_{2}
p_{t_{2}}(\bm{x})
p_{t_{1}}(\bm{x})
\hat{p}(\bm{x},\sigma)
(\bm{x}_{n},\sigma_{n})\sim\hat{p}(\bm{x},\sigma)
t_{n}\coloneqq\sigma^{-1}(\sigma_{n})
\displaystyle\bm{x}_{n}\sim p_{t_{n}}(\bm{x})
\displaystyle\bm{x}_{n}\sim p_{t_{n}}(\bm{x})
\bm{x}(t_{n})=\bm{x}_{n}
t=t_{n}
t=0
p_{0}(\bm{x})\approx p(\bm{x})
\{(\bm{x}_{n},\sigma_{n})\}
\mathcal{X}\times\SS
\mathcal{X}
\{\bm{x}_{n}\}
\sigma_{n}\ll\sigma_{\max}
n
t_{n}\ll T
n
T
\hat{s}_{\theta}(\bm{x},\sigma):\mathbb{R}^{d}\times\mathbb{R}\rightarrow%
\mathbb{R}^{d}\times\mathbb{R}
\hat{p}(\bm{x},\sigma)
\nu>0
\displaystyle\min_{\theta}\mathbb{E}_{\bm{\epsilon}\sim\mathcal{N}(\bm{0}_{d+1%
},\nu^{2}\bm{I}_{d+1})}\mathbb{E}_{\hat{p}(\bm{x},\sigma)}[\|\hat{s}_{\theta}(%
\bm{x}-\epsilon_{1:d},\sigma-\epsilon_{d+1})-\bm{\epsilon}/\nu^{2}\|_{2}^{2}]
\displaystyle\min_{\theta}\mathbb{E}_{\bm{\epsilon}\sim\mathcal{N}(\bm{0}_{d+1%
},\nu^{2}\bm{I}_{d+1})}\mathbb{E}_{\hat{p}(\bm{x},\sigma)}[\|\hat{s}_{\theta}(%
\bm{x}-\epsilon_{1:d},\sigma-\epsilon_{d+1})-\bm{\epsilon}/\nu^{2}\|_{2}^{2}]
(\bm{x}_{n},\sigma_{n})
\bm{x}
\bm{x}_{n+1}\sim\hat{p}(\bm{x}\mid\sigma_{n})
\sigma
\sigma_{n+1}\sim\hat{p}(\sigma\mid\bm{x}_{n+1})
\bm{x}
(\bm{x}_{n},\sigma_{n})
s_{\theta}(\bm{x},\sigma)
\bm{x}_{n+1}
\hat{p}(\bm{x}\mid\sigma_{n})
\displaystyle\nabla_{\bm{x}}\log\hat{p}(\bm{x}\mid\sigma_{n})\approx s_{\theta%
}(\bm{x},\sigma_{n})
\displaystyle\nabla_{\bm{x}}\log\hat{p}(\bm{x}\mid\sigma_{n})\approx s_{\theta%
}(\bm{x},\sigma_{n})
\bm{x}
\displaystyle\bm{x}_{n+1}=\bm{x}_{n}+(\eta/2)\cdot s_{\theta}(\bm{x}_{n},%
\sigma_{n})+\sqrt{\eta}\cdot\bm{\epsilon}
\displaystyle\bm{x}_{n+1}=\bm{x}_{n}+(\eta/2)\cdot s_{\theta}(\bm{x}_{n},%
\sigma_{n})+\sqrt{\eta}\cdot\bm{\epsilon}
\bm{\epsilon}\sim\mathcal{N}(\bm{0},\bm{I})
\eta
\sigma
\bm{x}_{n+1}
\sigma_{n+1}\sim\hat{p}(\sigma\mid\bm{x}_{n+1})
q_{\phi}(\sigma\mid\bm{x})
\hat{p}(\sigma\mid\bm{x})
\displaystyle\max_{\phi}\mathbb{E}_{\hat{p}(\bm{x},\sigma)}[\log q_{\phi}(%
\sigma\mid\bm{x})].
\displaystyle\max_{\phi}\mathbb{E}_{\hat{p}(\bm{x},\sigma)}[\log q_{\phi}(%
\sigma\mid\bm{x})].
[\sigma_{\min},\sigma_{\max}]
M
\tau_{1}=\sigma_{\min}<\tau_{2}<\cdots<\tau_{M}=\sigma_{\max}
\tau_{m}
1\leq m\leq M
m
\tau_{m}^{2}
m
\sigma_{n+1}
m
\bm{x}_{n+1}
\sigma_{n+1}=\tau_{m}
\sigma_{n+1}\sim q_{\phi}(\sigma\mid\bm{x}_{n+1})
\sigma
q_{\phi}
q_{\phi}
100\sim 1000
{\bm{s}}_{\theta}
q_{\phi}
s_{\theta}
q_{\phi}
\{(\bm{x}_{n},\sigma_{n})\}_{n=1}^{\infty}
\hat{p}(\bm{x},\sigma)
(\bm{x}_{0},\sigma_{0})
\bm{x}_{0}
\sigma_{0}\sim q_{\phi}(\sigma\mid\bm{x}_{0})
\bm{x}_{0}
0.25
\bm{x}_{0}
n_{skip}
n_{skip}>1
n_{skip}
n_{den}
n_{skip}+n_{den}
n_{skip}
n_{skip}
\sigma
\hat{p}(\sigma)
\hat{p}(\sigma)\propto 1/\sigma
\sigma
p(\bm{x})
\mathcal{X}\times\SS
1k
\eta
1k
432
50k
10k
4
2.4
3.86
10.11
2.63
20.11
4.17
10
2.86
20
6.99
158.96
7.16
4000
n
n_{den}
\eta
\bm{\eta}
\bm{n}_{\bm{den}}/\bm{n}
\eta
n_{den}/n
n_{den}
n_{skip}=n-n_{den}
n_{den}/n
0
1
n_{den}/n
\eta
\eta
\bm{n}_{\bm{den}}/\bm{n}
\eta
n_{den}/n
10\leq\text{NFE}\leq 50
n_{den}/n
\text{NFE}>50
n_{den}/n
n_{skip}
n_{skip}
n_{den}/n
n_{den}/n>0.5
n_{den}>n_{skip}
n_{den}
\eta
n
n_{skip}
n_{den}=n-n_{skip}
\bm{\eta}
n_{den}/n
\eta
\eta
\eta
\eta\in[0.05,1.0]
\eta
d
\kappa\coloneqq\eta/\sqrt{d}
\eta
\eta
\eta\sqrt{d}
\eta/\sqrt{d}
\kappa
\kappa
d
\eta=\sqrt{d}\kappa
\eta\in[0.05,1.0]
\kappa\in[0.0009,0.018]
\eta\in[0.4,8.0]
\kappa
[0,1]
q_{\phi}
q_{\phi}
(\sigma_{\min},\sigma_{\max})
1k
\sigma_{\min}(\sigma_{\max}/\sigma_{\min})^{t}
t
[0,1]
q_{\phi}
q_{\phi}
0.001
1k
\eta=0.0001
\eta=1.0
n_{skip}=1
n_{den}=20
0.25
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
0.5
3.86
0.01
153.48
59.98
0.5
2.45
0.5
2.63
0.01
35.58
83.74
0.5
2.58
0.5
2.44
0.01
15.75
128.99
0.5
2.55
0.01
6.8
0.05
5.25
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
0.5
6.99
0.01
300.18
0.01
306.98
0.5
3.17
0.01
94.98
0.01
47.83
0.5
2.64
0.01
22.1
0.02
12.73
0.5
2.19
0.01
8.61
0.05
4.79
0.1
4.45
0.1
2.69
1.0
2.64
1.0
2.22
1.0
2.14
0.25
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
0.8
14.11
0.25
28.37
125.95
0.8
15.29
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
n_{den}
n_{skip}
\eta
0.8
8.78
0.1
26.43
0.8
23.19
n_{den}=131
n_{skip}=27
\eta=4.0
6.99
