T
T
{T}
T
T
q(\mathbf{x}_{0})
\mathbb{R}^{L}
L
q(\mathbf{x}_{T})\sim\mathcal{N}(\mathbf{0},\mathbf{I})
T
\mathbf{x}_{t}\in\mathbb{R}^{L}
t=0,1,\cdots,T
t
\mathbf{x}_{0}
\mathbf{x}_{T}
\beta_{1},\cdots,\beta_{T}
q(\mathbf{x}_{1:T}|\mathbf{x}_{0})=\prod_{t\geq 1}q(\mathbf{x}_{t}|\mathbf{x}_%
{t-1}),
q(\mathbf{x}_{t}|\mathbf{x}_{t-1}):=\mathcal{N}(\mathbf{x}_{t};\sqrt{1-\beta_{%
t}}\mathbf{x}_{t-1},\beta_{t}\mathbf{I}).
\theta
p_{\theta}(\mathbf{x}_{0:T})=p(\mathbf{x}_{T})\prod_{t\geq 1}p_{\theta}(%
\mathbf{x}_{t-1}|\mathbf{x}_{t}).
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t}):=\mathcal{N}(\mathbf{x}_{t-1};%
\mathbf{\mu}_{\theta}(\mathbf{x}_{t}),\sigma_{t}^{2}\mathbf{I})
\mu_{\theta}(\mathbf{x}_{t},t)
\sigma_{t}^{2}\mathbf{I}
\theta
\mathbf{x}_{T}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\mathbf{x}_{t-1}\sim p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
t=T,T-1,\cdots,1
\mathbf{x}_{0}
p_{\theta}(\mathbf{x}_{0})=\int p_{\theta}(\mathbf{x}_{0:T})\text{d}\mathbf{x}%
_{1:T}
\leq\log p_{\theta}(\mathbf{x}_{0})
q(\mathbf{x}_{t-1}|\mathbf{x}_{t})
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
\text{ELBO}=\sum_{t\geq 1}\mathbb{E}_{q_{(}{\mathbf{x}_{t}})}[D_{KL}(q(\mathbf%
{x}_{t-1}|\mathbf{x}_{t})||p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})]+c
D_{KL}
c
\theta
q(\mathbf{x}_{t-1}|\mathbf{x}_{t})
\beta_{t}
T
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
T
\beta_{t}
(a)
\mathbf{y}
\mathbf{x}_{0}
T
T\leq 4
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
q(\mathbf{x}_{t-1}|\mathbf{x}_{t})
D_{\text{adv}}
\min_{\theta}\sum_{t\geq 1}\mathbb{E}_{q(\mathbf{x}_{t})}[D_{\text{adv}}(q(%
\mathbf{x}_{t-1}|\mathbf{x}_{t})||p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x_{t}}))],
D_{\text{adv}}
s
c
D_{\phi}(\mathbf{x}_{t-1},\mathbf{x}_{t},t,s)
\phi
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})
\mathbf{x}_{t-1}
\mathbf{x}_{t}
p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t}):=q(\mathbf{x}_{t-1}|\mathbf{x}_{t}%
,\mathbf{x}_{0}=f_{\theta}(\mathbf{x}_{t},t))
\mathbf{x}_{0}
\mathbf{x}_{t}
f_{\theta}(\mathbf{x}_{t},t)
\theta
\mathbf{x}^{\prime}_{t-1}
q(\mathbf{x}^{\prime}_{t-1}|\mathbf{x}^{\prime}_{0},\mathbf{x}_{t})
\mathbf{x}^{\prime}_{0}
\mathbf{x}_{0}
(\mathbf{x}^{\prime}_{t-1},\mathbf{x}_{t})
D_{\text{adv}}
(\mathbf{x}_{t-1},\mathbf{x}_{t})
z\sim\mathcal{N}(\mathbf{0},\mathbf{I})
f_{\theta}(\mathbf{x}_{t},t)
G_{\theta}(\mathbf{x}_{t},\mathbf{y},t,s)
\mathbf{x}_{0}
\mathbf{x}_{t}
\mathbf{y}
t
s
\begin{split}\mathcal{L}_{D}=\sum_{t\geq 1}\mathbb{E}_{q(\mathbf{x}_{t})q(%
\mathbf{x}_{t-1}|\mathbf{x}_{t})}[(D_{\phi}(\mathbf{x}_{t-1},\mathbf{x}_{t},t,%
s)-1)^{2}]\\
+\mathbb{E}_{p_{\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})}[D_{\phi}(\mathbf{x}_%
{t-1},\mathbf{x}_{t},t,s)^{2}].\end{split}
\mathcal{L}_{fm}
\mathcal{L}_{fm}
l_{1}
\mathcal{L}_{fm}=\mathbb{E}_{q(\mathbf{x}_{t})}[\sum_{i=1}^{N}||D_{\phi}^{i}(%
\mathbf{x}_{t-1},\mathbf{x}_{t},t,s)-D_{\phi}^{i}(\mathbf{x}^{\prime}_{t-1},%
\mathbf{x}_{t},t,s)||_{1}]
N
\begin{split}\mathcal{L}_{recon}=\mathcal{L}_{mel}(\mathbf{x}_{0},\mathbf{x}^{%
\prime}_{0})+\lambda_{d}\mathcal{L}_{duration}(\mathbf{d},\hat{\mathbf{d}})+\\
\lambda_{p}\mathcal{L}_{pitch}(\mathbf{p},\hat{\mathbf{p}})+\lambda_{e}%
\mathcal{L}_{energy}(\mathbf{e},\hat{\mathbf{e}}),\end{split}
\mathbf{d}
\mathbf{p}
\mathbf{e}
\mathbf{\hat{d}}
\mathbf{\hat{p}}
\mathbf{\hat{e}}
\lambda_{d}
\lambda_{p}
\lambda_{e}
\mathcal{L}_{mel}
\mathcal{L}_{duration}
\mathcal{L}_{pitch}
\mathcal{L}_{energy}
\mathcal{L}_{G}=\mathcal{L}_{adv}+\mathcal{L}_{recon}+\lambda_{fm}\mathcal{L}_%
{fm},
\mathcal{L}_{adv}=\sum_{t\geq 1}\mathbb{E}_{q(\mathbf{x}_{t})}\mathbb{E}_{p_{%
\theta}(\mathbf{x}_{t-1}|\mathbf{x}_{t})}[(D_{\phi}(\mathbf{x}_{t-1},\mathbf{x%
}_{t},t,s)-1)^{2}],
\lambda_{fm}
\lambda_{fm}=\mathcal{L}_{recon}/\mathcal{L}_{fm}
G_{\psi}^{\text{base}}(\mathbf{y},s)
\psi
\min_{\psi}\sum_{t\geq 0}\mathbb{E}_{q(\mathbf{x}_{t})}[\text{Div}(q_{\text{%
diff}}^{t}(G^{\text{base}}_{\psi}(\mathbf{y},s)),q_{\text{diff}}^{t}(\mathbf{x%
}_{0}))],
\text{Div}(\cdot,\cdot)
q_{\text{diff}}^{t}(\cdot)
t
\mathbf{x}_{t}=q_{\text{diff}}^{t}(\mathbf{x}_{0})
q_{\text{diff}}^{0}(\cdot)
\hat{\mathbf{x}}_{0}
D_{\text{adv}}(q(\mathbf{x}_{t-1}|\mathbf{x}_{t})||p_{\theta}(\mathbf{x}_{t-1}%
|\mathbf{x_{t}}))
D_{\text{adv}}(q(\mathbf{x}_{t-1}|\mathbf{x}_{t})||p_{\theta}(\mathbf{x}_{t-1}%
|\mathbf{x}_{t},\hat{\mathbf{x}}_{0}))
\hat{\mathbf{x}}_{0}
\hat{\mathbf{x}}_{1}
\hat{\mathbf{x}}_{1}
F_{0}
F_{0}
\uparrow
\downarrow
\downarrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
T
\pm
T
\pm
T
\pm
\pm
F_{0}
F_{0}
\mathbf{x}_{t}
t
c
0.2
F_{0}
l_{2}
T
\beta_{1}=0.5
\beta_{2}=0.9
10^{-4}
2\times 10^{-4}
\beta_{1}=0.9
\beta_{2}=0.98
240=8\times 5\times 3\times 2
F_{0}
F_{0}
F_{0}
T
F_{0}
T
T
T
T
F_{0}
T
T
\hat{\mathbf{x}}_{0}
\mathbf{x}_{0}
\hat{\mathbf{x}}_{0}
\mathbf{x}_{0}
T
T
T
\hat{\mathbf{x}}_{1}
\mathbf{x}_{1}
\hat{\mathbf{x}}_{1}
\mathbf{x}_{1}
T
-\mathcal{L}_{fm}
-\mathcal{L}_{mel}
-\mathcal{L}_{fm}-\mathcal{L}_{mel}
+
\mathbf{z}
a
F_{0}
b
F_{0}
a
F_{0}
b
F_{0}
T
T
\mathcal{L}_{mel}
\mathcal{L}_{fm}
\mathbf{z}
\mathcal{L}_{mel}
\mathcal{L}_{fm}
\mathcal{L}_{fm}
\mathcal{L}_{mel}
T
F_{0}
a
F_{0}
b
\mathbf{z}
a
T
b
\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\mathbf{z}
\mathbf{w}
\mathbf{w}
\mathbf{\gamma}
\mathbf{\beta}
\mathbf{\gamma}
\mathbf{\beta}
\mathbf{h}_{norm}
\mathbf{h}_{norm}*\mathbf{\gamma}+\mathbf{\beta}
a
b
\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
a
b
\mathbf{z}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\mathbf{x}_{0}\sim q(\mathbf{x})
q(\mathbf{x}_{1:T}|\mathbf{x}_{0})=\prod_{t\geq 1}q(\mathbf{x}_{t}|\mathbf{x}_%
{t-1}),\quad q(\mathbf{x}_{t}|\mathbf{x}_{t-1}):=\mathcal{N}(\mathbf{x}_{t};%
\sqrt{1-\beta_{t}}\mathbf{x}_{t-1},\beta_{t}\mathbf{I}).
\alpha_{t}=1-\beta_{t}
\bar{\alpha}_{t}=\prod_{i=1}^{t}\alpha_{i}
\mathbf{x}_{t}
t
q(\mathbf{x}_{t}|\mathbf{x}_{0})=\mathcal{N}(\mathbf{x}_{t};\sqrt{\bar{\alpha}%
_{t}}\mathbf{x}_{0},(1-\bar{\alpha}_{t})\mathbf{I}).
\mathbf{x}_{0}
\begin{split}q(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})&=q(\mathbf{x}_{%
t}|\mathbf{x}_{t-1},\mathbf{x}_{0})\frac{q(\mathbf{x}_{t-1}|\mathbf{x}_{0})}{q%
(\mathbf{x}_{t}|\mathbf{x}_{0})}\\
&=\frac{q(\mathbf{x}_{t}|\mathbf{x}_{t-1})q(\mathbf{x}_{t-1}|\mathbf{x}_{0})}{%
q(\mathbf{x}_{t}|\mathbf{x}_{0})}\\
&=\frac{\mathcal{N}(\mathbf{x}_{t};\sqrt{\alpha_{t}}\mathbf{x}_{t-1},\beta_{t}%
\mathbf{I})\mathcal{N}(\mathbf{x}_{t-1};\sqrt{\bar{\alpha}_{t}}\mathbf{x}_{0},%
(1-\bar{\alpha}_{t-1})\mathbf{I})}{\mathcal{N}(\mathbf{x}_{t};\sqrt{\bar{%
\alpha}_{t}}\mathbf{x}_{0},(1-\bar{\alpha}_{t})\mathbf{I})}\\
&\propto\exp{(-\frac{1}{2}(\frac{(\mathbf{x}_{t}-\sqrt{\alpha_{t}}\mathbf{x}_{%
t-1})^{2}}{\beta_{t}}+\frac{(\mathbf{x}_{t-1}-\sqrt{\bar{\alpha}_{t-1}}\mathbf%
{x}_{0})^{2}}{1-\sqrt{\bar{\alpha}_{t-1}}}-\frac{(\mathbf{x}_{t}-\sqrt{\bar{%
\alpha}_{t}}\mathbf{x}_{0})^{2}}{1-\sqrt{\bar{\alpha}_{t}}}))}\\
&=\exp{(-\frac{1}{2}((\frac{\alpha_{t}}{\beta_{t}}+\frac{1}{1-\bar{\alpha}_{t-%
1}})\mathbf{x}_{t-1}^{2})-(\frac{2\sqrt{\alpha_{t}}}{\beta_{t}}\mathbf{x}_{t}+%
\frac{2\sqrt{\bar{\alpha}_{t}}}{1-\sqrt{\bar{\alpha}_{t}}}\mathbf{x}_{0})%
\mathbf{x}_{t-1}+C(\mathbf{x}_{t},\mathbf{x}_{0}))},\end{split}
C(\mathbf{x}_{t},\mathbf{x}_{0})
\mathbf{x}_{t-1}
q(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})
q(\mathbf{x}_{t-1}|\mathbf{x}_{t},\mathbf{x}_{0})=\mathcal{N}(\mathbf{x}_{t-1}%
;\tilde{\mathbf{\mu}}_{t}(\mathbf{x}_{t},\mathbf{x}_{0}),\tilde{\beta}_{t}%
\mathbf{I})
\tilde{\mathbf{\mu}}_{t}(\mathbf{x}_{t},\mathbf{x}_{0})
\tilde{\beta}_{t}
\tilde{\mathbf{\mu}}_{t}(\mathbf{x}_{t},\mathbf{x}_{0})=\frac{\sqrt{\bar{%
\alpha}_{t-1}}\beta_{t}}{1-\bar{\alpha}_{t}}\mathbf{x}_{0}+\frac{\sqrt{\alpha_%
{t}}(1-\bar{\alpha}_{t-1})}{1-\bar{\alpha}_{t}}\mathbf{x}_{t}\quad\text{and}%
\quad\tilde{\beta}_{t}=\frac{1-\bar{\alpha}_{t-1}}{1-\bar{\alpha}_{t}}\beta_{t}.
\beta_{1},\cdots,\beta_{T}
t\in\{1,\cdots,T\}
\beta_{t}
\beta_{t}=1-\exp(-\frac{\beta_{\text{min}}}{T}-0.5(\beta_{\text{max}}-\beta_{%
\text{min}})\frac{2t-1}{T^{2}}),
\beta_{\text{min}}=0.1
\beta_{\text{min}}=40
T
T
T
G_{\theta}
\theta
D_{\phi}
\phi
\beta_{1},\cdots,\beta_{T}
T
\mathcal{D}_{train}=\{(\mathbf{x}_{0},\mathbf{y},\mathbf{s},\mathbf{d},\mathbf%
{p},\mathbf{e})_{i}\}_{i=1}^{N}
N
\theta
\phi
M
\mathcal{D}_{train}
\mathcal{S}=\{(\mathbf{x}_{0},\mathbf{y},\mathbf{s},\mathbf{d},\mathbf{p},%
\mathbf{e})_{i}\}_{j=1}^{M}
\mathcal{S}
t
[0,\cdots,T]
\mathbf{x}_{t}
\mathbf{x}_{t-1}
\mathbf{x}_{0}
t
\mathbf{x}_{t}
\mathbf{x}_{t-1}
\mathcal{S}
G_{\theta}
\mathcal{O}=\{(\mathbf{x}^{\prime}_{0},\hat{\mathbf{d}},\hat{\mathbf{p}},\hat{%
\mathbf{e}})_{i}\}_{j=1}^{M}
\mathbf{x}^{\prime}_{t-1}
\mathbf{x}^{\prime}_{0}
\mathcal{O}
\mathcal{L}_{D}
\mathcal{L}_{D}
\phi
\mathcal{L}_{G}
\mathcal{L}_{G}
\theta
G_{\theta}
G_{\theta}
(\mathbf{y},s)
\mathbf{x}_{T}\sim\mathcal{N}(\mathbf{0},\mathbf{I})
\mathbf{x}_{t}\leftarrow\mathbf{x}_{T}
t=T,T-1,...,1
(\mathbf{x}_{t},\mathbf{y},s,t)
G_{\theta}
\mathbf{x}^{\prime}_{0}
\mathbf{x}^{\prime}_{t-1}
\mathbf{x}^{\prime}_{0}
\mathbf{x}_{t}
\mathbf{x}_{t}\leftarrow\mathbf{x}^{\prime}_{t-1}
\mathbf{x}_{t}
G_{\psi}^{\text{base}}
\psi
G_{\theta}
\theta
D_{\phi}
\phi
\beta_{1},\cdots,\beta_{T}
T
\mathcal{D}_{train}=\{(\mathbf{x}_{0},\mathbf{y},\mathbf{s},\mathbf{d},\mathbf%
{p},\mathbf{e})_{i}\}_{i=1}^{N}
N
N_{\text{iter}}
\psi
\theta
\phi
i=1,2,...,N_{\text{iter}}
M
\mathcal{D}_{train}
\mathcal{S}=\{(\mathbf{x}_{0},\mathbf{y},\mathbf{s},\mathbf{d},\mathbf{p},%
\mathbf{e})_{i}\}_{j=1}^{M}
\mathcal{S}
G_{\psi}^{\text{base}}
\mathcal{O}=\{(\hat{\mathbf{x}}_{0},\hat{\mathbf{d}},\hat{\mathbf{p}},\hat{%
\mathbf{e}})_{i}\}_{j=1}^{M}
\mathcal{L}_{recon}
\mathcal{L}_{recon}
\psi
G_{\theta}
\theta
\psi
M
\mathcal{D}_{train}
\mathcal{S}=\{(\mathbf{x}_{0},\mathbf{y},\mathbf{s},\mathbf{d},\mathbf{p},%
\mathbf{e})_{i}\}_{j=1}^{M}
\mathcal{S}
t
[0,\cdots,T]
\mathbf{x}_{t}
\mathbf{x}_{t-1}
\mathbf{x}_{0}
t
\mathbf{x}_{t}
\mathbf{x}_{t-1}
\mathcal{S}
G_{\theta}
\mathcal{O}=\{(\mathbf{x}^{\prime}_{0},\hat{\mathbf{d}},\hat{\mathbf{p}},\hat{%
\mathbf{e}})_{i}\}_{j=1}^{M}
\mathbf{x}^{\prime}_{t-1}
\mathbf{x}^{\prime}_{0}
\mathcal{O}
\mathcal{L}_{D}
\mathcal{L}_{D}
\phi
\mathcal{L}_{G}
\mathcal{L}_{G}
\theta
G_{\theta}
G_{\theta}
(\mathbf{y},s)
(\mathbf{y},s)
\hat{\mathbf{x}}_{0}
\hat{\mathbf{x}}_{1}
\hat{\mathbf{x}}_{0}
(\hat{\mathbf{x}}_{1},y,s,t=1)
G_{\theta}
\mathbf{x}^{\prime}_{0}
\mathbf{x}^{\prime}_{0}
T
T
