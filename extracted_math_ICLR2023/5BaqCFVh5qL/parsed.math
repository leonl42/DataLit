n
\mathcal{X}=\{(\mathbf{x}_{i},y_{i})\},i=1,\ldots,n
\mathbf{x}\in\mathbb{R}^{d}
d
y\in\mathcal{Y}=\{1,\ldots,L\}
L
f(\cdot):\mathcal{X}\rightarrow\mathbb{R}^{L}
P_{\mathbf{x}}(y=\arg\max_{y^{\prime}\in\mathcal{Y}}f_{y^{\prime}}(\mathbf{x}))
\mathcal{L}_{CE}(\cdot)
\mathcal{L}_{CE}(y,f(\mathbf{x}))=\log\left(\sum_{y^{\prime}}e^{f_{y^{\prime}}%
(\mathbf{x})}\right)-f_{y}(\mathbf{x}).
\mathcal{A}
K
K
L
g=(a,y)\in\mathcal{A}\times\mathcal{Y}
a
y
GBA(f)=\frac{1}{KL}\sum_{g\in\mathcal{G}}\mathbf{P}_{\mathbf{x}|(y,a)=g}\left(%
y=\arg\max_{y^{\prime}\in\mathcal{Y}}f_{y^{\prime}}(\mathbf{x})\right).
\hat{p}
\hat{p}
\hat{f}(\cdot)
\mathcal{L}_{GCE}=\frac{1-\hat{p}(\mathbf{x})^{q}}{q},
\hat{p}(\mathbf{x})
\hat{f}
q\in[0,1)
\hat{p}(x)
\hat{f}
\mathbf{P}(x,y,a)
f^{\ast}\in\operatorname*{arg\,max}_{f}GBA(f)
P(y,a)
(y,a)
P(y,a|\mathbf{x})
(y,a)
\mathbf{x}
\arg\max_{y\in\mathcal{Y}}f^{\ast}_{y}(\mathbf{x})=\arg\max_{y}\sum_{a}\frac{P%
(y,a|\mathbf{x})}{P(y,a)}=\arg\max_{y}\sum_{a}\frac{P(y|a,\mathbf{x})P(a|%
\mathbf{x})}{P(y,a)}
\mathbf{x}
P(a|\mathbf{x})
1
a=a_{\mathbf{x}}
0
\arg\max_{y\in\mathcal{Y}}f^{\ast}_{y}(\mathbf{x})=\arg\max_{y}P(y|a_{\mathbf{%
x}},\mathbf{x})/P(y,a_{\mathbf{x}}).
a_{\mathbf{x}}
P(y|a_{\mathbf{x}},\mathbf{x})
P(y|a_{\mathbf{x}},\mathbf{x})\propto\exp(f(\mathbf{x}))
f
\displaystyle\arg\max_{y\in\mathcal{Y}}f^{\ast}_{y}(\mathbf{x})=\arg\max_{y\in%
\mathcal{Y}}\exp(f_{y}(\mathbf{x}))/P(y,a_{\mathbf{x}}),
\displaystyle\arg\max_{y\in\mathcal{Y}}f^{\ast}_{y}(\mathbf{x})
\displaystyle=\arg\max_{y\in\mathcal{Y}}\exp(f_{y}(\mathbf{x}))/P(y,a_{\mathbf%
{x}}),
\displaystyle=\arg\max_{y\in\mathcal{Y}}(f_{y}(\mathbf{x})-\ln P(y,a_{\mathbf{%
x}})).
\displaystyle=\arg\max_{y\in\mathcal{Y}}(f_{y}(\mathbf{x})-\ln P(y,a_{\mathbf{%
x}})).
f^{\ast}
f
\ln P(y,a_{\mathbf{x}})
f(\mathbf{x})+\ln\hat{P}_{y,a_{\mathbf{x}}}
f(\mathbf{x})
\hat{P}_{y,a_{\mathbf{x}}}
P(y,a_{\mathbf{x}})
f^{\ast}
\mathcal{L}_{LC}(y,f(\mathbf{x}))=\log\left(\sum_{y^{\prime}}e^{f_{y^{\prime}}%
(\mathbf{x})+\ln\hat{P}_{y^{\prime},a_{\mathbf{x}}}}\right)-\left(f_{y}(%
\mathbf{x})+\ln\hat{P}_{y,a_{\mathbf{x}}}\right).
P(a|\mathbf{x})
(y,a_{\mathbf{x}})
(y,a_{\mathbf{x}})
\displaystyle\mathcal{L}_{LC}(y,f(\mathbf{x}))=\log\left(1+\sum_{y^{\prime}%
\neq y}e^{f_{y^{\prime}}(\mathbf{x})-f_{y}(\mathbf{x})+\ln\left(\hat{P}_{y^{%
\prime},a_{\mathbf{x}}}/\hat{P}_{y,a_{\mathbf{x}}}\right)}\right).
\displaystyle\mathcal{L}_{LC}(y,f(\mathbf{x}))=\log\left(1+\sum_{y^{\prime}%
\neq y}e^{f_{y^{\prime}}(\mathbf{x})-f_{y}(\mathbf{x})+\ln\left(\hat{P}_{y^{%
\prime},a_{\mathbf{x}}}/\hat{P}_{y,a_{\mathbf{x}}}\right)}\right).
\ln\left(\hat{P}_{y^{\prime},a_{\mathbf{x}}}/\hat{P}_{y,a_{\mathbf{x}}}\right)
\hat{P}_{y,a_{\mathbf{x}}}
\mathbf{x}
a_{\mathbf{x}}
P(y,a)
P(y,a)=\int_{\mathbf{x}}P(y,a,\mathbf{x})d\mathbf{x}=\int_{\mathbf{x}}P(y,a|%
\mathbf{x})P(\mathbf{x})d\mathbf{x}\approx\frac{1}{N}\sum_{\mathbf{x}}P(y,a|%
\mathbf{x}).
N
(\mathbf{x}_{i},y_{i},a_{i})
y_{i}
P(y,a|\mathbf{x}_{i})=\left\{\begin{array}[]{cc}P(a|\mathbf{x}_{i}),&\text{if}%
\ y=y_{i},\\
0&\text{otherwise.}\end{array}\right.
j
y^{(j)}
j
a^{(j)}
j=[1,\ldots,L]
L=K
L
K
P(a|\mathbf{x}_{i})
\hat{f}(\mathbf{x}_{i})
j
\hat{f}(\mathbf{x})
\hat{f}_{j}(\mathbf{x}_{i})
P(a=a^{(j)}|\mathbf{x}_{i})=\frac{\exp(\hat{f}_{j}(\mathbf{x}_{i}))}{\sum_{k=1%
}^{K}\exp(\hat{f}_{k}(\mathbf{x}_{i}))}.
P(y,a)
a_{\mathbf{x}}=\arg\max_{a}P(a|\mathbf{x})
y^{(1)}
y^{(2)}
a^{(1)}
y^{(j)},j>2
a^{(j-1)}
a^{(1)}
\hat{f}_{j}(\mathbf{x})\propto P(y^{(j)},a^{(1)}|\mathbf{x}),j=1,2
\hat{f}_{j}(\mathbf{x})\propto P(a^{(j-1)}|\mathbf{x}),j>2
P(a=a^{(1)}|\mathbf{x}_{i})
y^{(1)}
y^{(2)}
a^{(1)}
\displaystyle P(a=a^{(1)}|\mathbf{x}_{i})=P(y^{(1)},a=a^{(1)}|\mathbf{x}_{i})+%
P(y^{(2)},a=a^{(1)}|\mathbf{x}_{i})
\displaystyle P(a=a^{(1)}|\mathbf{x}_{i})
\displaystyle=P(y^{(1)},a=a^{(1)}|\mathbf{x}_{i})+P(y^{(2)},a=a^{(1)}|\mathbf{%
x}_{i})
\displaystyle=[\exp(\hat{f}_{1}(\mathbf{x}_{i}))+\exp(\hat{f}_{2}(\mathbf{x}_{%
i}))]/\sum_{k=1}^{K}\exp(\hat{f}_{k}(\mathbf{x}_{i})).
\displaystyle=[\exp(\hat{f}_{1}(\mathbf{x}_{i}))+\exp(\hat{f}_{2}(\mathbf{x}_{%
i}))]/\sum_{k=1}^{K}\exp(\hat{f}_{k}(\mathbf{x}_{i})).
\;a_{\mathbf{x}}=\arg\max_{a}P(a|\mathbf{x})
y^{(1)}
a^{(1)}
a^{(2)}
P(a=a^{(j)}|\mathbf{x}_{i})=\frac{w_{j}}{w_{1}+w_{2}}\exp(\hat{f}_{1}(\mathbf{%
x}_{i}))/\sum_{k=1}^{K}\exp(\hat{f}_{k}(\mathbf{x}_{i})),j=1,2
w
\mathbf{P}(y,a)
\mathcal{Y}
\mathcal{A}
j
y^{(j)}
j
a^{(j)}
(\mathbf{x}_{i},y_{i})
\arg\max_{y^{\prime}}\hat{f}_{y}^{\prime}(\mathbf{x}_{i})\neq y_{i}
\mathbf{x}_{i}
\mathbf{x}_{j}
y_{i}=y_{j}
\mathbf{x}_{i}
(\mathbf{x}^{\prime}_{i},y_{i})
\mathbf{x}^{\prime}_{i}=\lambda\mathbf{x}_{i}+(1-\lambda)\mathbf{x}_{j},\quad%
\hat{P}^{\prime}_{y_{i},.}=\lambda\hat{P}_{y_{i},a^{(i)}}+(1-\lambda)\hat{P}_{%
y_{j},a^{(j)}},
\lambda\sim U(0.5,1)
\beta=(0.9,0.999)
1\times 10^{-2}
1\times 10^{-3}
1\times 10^{-4}
q
\rightarrow
>1
<1
\ll 1
>1
<1
\ll 1
P(y,a)
(y,a)
P(y,a|\mathbf{x})
(y,a)
\mathbf{x}
y=\arg\max_{y^{\prime}}\sum_{a}\frac{P(y^{\prime},a|\mathbf{x})}{P(y^{\prime},%
a)}=\arg\max_{y}\sum_{a}\frac{P(y|a,\mathbf{x})P(a|\mathbf{x})}{P(y,a)}
c=\arg\max_{y^{\prime}\in\mathcal{Y}}f_{y^{\prime}}(\mathbf{x})
(y^{(j)},a^{(k)})
Acc(y^{(j)},a^{(k)})=\int_{\mathbf{x}}\frac{P(y=y^{(j)},a=a^{(k)}|\mathbf{x})P%
(c=y^{(j)}|\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}P(\mathbf{x})d\mathbf{x}.
GBA=\frac{1}{KL}\int_{\mathbf{x}}\sum_{y^{(j)}}\sum_{a^{(k)}}\frac{P(y=y^{(j)}%
,a=a^{(k)}|\mathbf{x})P(c=y^{(j)}|\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}P(%
\mathbf{x})d\mathbf{x}.
P(c=y^{(j)}|\mathbf{x})
\mathbf{x}
\displaystyle\sum_{y^{(j)}}\sum_{a^{(k)}}\frac{P(y=y^{(j)},a=a^{(k)}|\mathbf{x%
})P(c=y^{(j)}|\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}
\displaystyle\sum_{y^{(j)}}\sum_{a^{(k)}}\frac{P(y=y^{(j)},a=a^{(k)}|\mathbf{x%
})P(c=y^{(j)}|\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}
\displaystyle=\sum_{y^{(j)}}\left(\sum_{a^{(k)}}\frac{P(y=y^{(j)},a=a^{(k)}|%
\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}\right)P(c=y^{(j)}|\mathbf{x}),
\displaystyle=
\displaystyle\sum_{y^{(j)}}\left(\sum_{a^{(k)}}\frac{P(y=y^{(j)},a=a^{(k)}|%
\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}\right)P(c=y^{(j)}|\mathbf{x}),
\mathbf{x}
\mathbf{x}
P(c=y^{(j)}|\mathbf{x})
\sum_{a^{(k)}}\frac{P(y=y^{(j)},a=a^{(k)}|\mathbf{x})}{P(y=y^{(j)},a=a^{(k)})}
y
\mathcal{Y}
P(c=y^{(j)}|\mathbf{x})=\left\{\begin{array}[]{ccc}1,&\text{if}\ y^{(j)}=\arg%
\max_{y^{\prime}}\sum_{a^{(k)}}\frac{P(y=y^{\prime},a=a^{(k)}|\mathbf{x})}{P(y%
=y^{\prime},a=a^{(k)})}\\
0,&\text{Otherwise.}\end{array}\right.
(X,Y)
\hat{f}_{{\theta}}
f_{{\theta}}
\#
K
\#
T
\alpha
1
K
\{(\mathbf{x},y)\}
\hat{f}(\theta)
\{(\mathbf{x},y)\}
(\mathbf{x},y)\in\{(\mathbf{x},y)\}
p^{(\mathbf{x},y)}
(\mathbf{x},y)
{a_{\mathbf{x}}}:=\operatorname*{arg\,max}p^{(\mathbf{x},y)}
\hat{P}_{y,a_{\mathbf{x}}}:=\alpha\hat{P}_{y,a_{\mathbf{x}}}+(1-\alpha)p^{(%
\mathbf{x},y)}_{a_{\mathbf{x}}}
\tau:=0.5\cdot\exp(-5(1-\textit{epoch})/T)^{2}
\{\mathbf{x},y,\hat{P}^{(\mathbf{x})}\}=\text{GroupMixup}(\{\mathbf{x},y,{a_{%
\mathbf{x}}}\},\hat{P},\tau)
(\mathbf{x},y,\hat{P}^{(\mathbf{x})})\in\{\mathbf{x},y,\hat{P}^{(\mathbf{x})}\}
1
c
f(\mathbf{x})_{c}:=f(\mathbf{x})_{c}+\log\hat{P}^{(\mathbf{x})}_{c,{a_{\mathbf%
{x}}}}
\theta
f_{\theta}(\mathbf{x})
\{\mathbf{x},y,{a_{\mathbf{x}}}\},\hat{P},\tau
\{(\bar{x},\bar{y},a_{\bar{x}})\}
y\neq{a_{\mathbf{x}}}
\{(\bar{x},\bar{y},{a_{\bar{x}}})\}:=\text{shuffle}(\{(\bar{x},\bar{y},a_{\bar%
{x}})\})
\lambda\sim\text{Uniform}(1-2\tau,1-\tau)
i,(\mathbf{x},y,{a_{\mathbf{x}}})\in\text{enumerate}(\{(\mathbf{x},y,{a_{%
\mathbf{x}}})\})
(\bar{x},\bar{y},{a_{\bar{x}}})
\{(\bar{x},\bar{y},{a_{\bar{x}}})\}
y=\bar{y}
\mathbf{x}:=\lambda\mathbf{x}+(1-\lambda)\bar{x}
y:=y
\hat{P}^{(\mathbf{x})}:=\lambda\hat{P}_{y,\mathbf{x}}+(1-\lambda)\hat{P}_{y,%
\bar{x}}
\mathbf{x}
f(\mathbf{x}):\mathbb{R}^{d}\rightarrow\mathbb{R}^{k}
k
(x,y)
\displaystyle m(x,y)=f(\mathbf{x})_{y}-\max_{j\neq y}f(\mathbf{x})_{j}.
\displaystyle m(x,y)=f(\mathbf{x})_{y}-\max_{j\neq y}f(\mathbf{x})_{j}.
g=(a,y)
\displaystyle m_{g}=\min_{i\in g}m(\mathbf{x}_{i},y_{i}).
\displaystyle m_{g}=\min_{i\in g}m(\mathbf{x}_{i},y_{i}).
\beta=(0.9,0.999)
1\times 10^{-4}
1\times 10^{-4}
1\times 10^{-2}
1\times 10^{-3}
1\times 10^{-4}
5\times 10^{-4}
0.5\%
1\times 10^{-3}
q
0.7
T
\alpha
\mathbf{65.32}
78.05
84.24
\mathbf{90.3}
65.06
\mathbf{78.57}
\mathbf{84.5}
\mathbf{90.3}
72.02
79.5
83.24
90.83
\mathbf{72.26}
\mathbf{80.1}
\mathbf{84.1}
\mathbf{91.25}
q
q
q
q
q
q
q
q
q
