n
f({\bm{x}};{\bm{\theta}})
{\bm{x}}
{\bm{\theta}}
{\bm{\theta}}
{\bm{x}}
f({\bm{x}};{\bm{\theta}})
{\bm{x}}={\bm{x}}^{I}:{\bm{x}}^{T}
{\bm{x}}^{I}
{\bm{x}}^{T}
f_{\text{ATR}}({\bm{x}}^{I},{\bm{Z}}_{bank})
f_{\text{ATR}}
{\bm{x}}_{t}
{\bm{S}}=\{{\bm{s}}_{1},...,{\bm{s}}_{N}\}
{\bm{s}}_{n}
\mathbf{0}
{\bm{S}}^{out}=\{{\bm{s}}^{o}1,...,{\bm{s}}^{o}_{N}\}
{\bm{s}}^{o}_{n}
\mathbf{0}
h_{p}=0
n=0
T
g(\cdot)
\epsilon
0.01
l_{atr}
h_{p}
<
1.0
n
<
T
{\bm{p}}
\text{sigmoid}(g({\bm{S}}))
p
\text{mean}({\bm{p}})
h_{p}
p
>
1.0
\epsilon
r
h_{p}
{\bm{S}}^{out}
{\bm{S}}
r
n
{\bm{S}}
g({\bm{S}})
{\bm{S}}^{out}
{\bm{S}}
p
h_{p}
p
l_{act}
n
r
l_{act}
{\bm{S}}^{o}
\text{sigmoid}(g(\cdot))
h_{p}
h_{p}
{\bm{S}}
p
p_{sum}=\sum_{t=1}^{T}p_{t}
l_{act}
l_{act}
n
r
n
n
r
r
p_{sum}=\sum_{t=1}^{T}p_{t}
\sum_{t=1}^{T-1}p_{t}
>
1.0
\epsilon
n
1.0
n
l=l_{main}+\lambda l_{act}
l_{main}
\lambda
\mathbb{R}^{B\times H}
B
H
{\bm{Z}}_{bank}\in\mathbb{R}^{B\times H}
p_{sum}=\sum_{t=1}^{T}p_{t}=1.0
p_{t}
p_{t}
t^{\mathrm{th}}
t^{\mathrm{th}}
1.0
\mathrm{LayerNorm}(\cdot)
g(\cdot)
p_{t}
\mathrm{LayerNorm}(p_{t}{\bm{z}}_{t})
\approx
\mathrm{LayerNorm}({\bm{z}}_{t})
g(\cdot)
h_{p}=0
states=[]
{\bm{q}}\in\mathbb{R}^{1\times h}
{\bm{Z}}_{bank}\in\mathbb{R}^{C\times H}
{\bm{m}}
\mathbf{0}
{\bm{m}}\in\mathbb{R}^{1\times C}
{\bm{m}}
T
\tau
l_{atr}
h_{p}<\tau
{\bm{d}}
{\bm{q}}
\cdot
{\bm{Z}}_{bank}[:,:h]^{T}
{\bm{d}}
\in
\mathbb{R}^{1\times C}
{\bm{d}}
{\bm{d}}
\odot
1.0
{\bm{m}}
K
{\bm{d}}
{\bm{i}}\in\mathbb{R}^{1\times K}
K
\frac{T}{\tau}
K
{\bm{d}}
{\bm{i}}
{\bm{w}}
{\bm{w}}\in\mathbb{R}^{1\times K}
{\bm{w}}
\text{softmax}(\frac{{\bm{w}}}{\sqrt{h}})
K
{\bm{Z}}_{bank}
{\bm{i}}
\{{\bm{s}}_{1},...,{\bm{s}}_{K}\}
{\bm{s}}
\sum^{K}_{k=1}w_{k}{\bm{s}}_{k}
states
{\bm{s}}
h_{p}
\text{max}({\bm{w}})
>
\tau
h_{p}
\text{max}({\bm{w}})
l_{atr}
1.0
\sum_{k=1}^{K}w_{k}^{2}
l_{collect}
h_{p}
{\bm{i}}
{\bm{m}}
\text{sum}((\text{one-hot}({\bm{i}}),\text{axis=0})
{\bm{q}}
\frac{1}{2}
{\bm{s}}
{\bm{q}}
{\bm{q}}
{\bm{s}}
l_{atr}
states
{\bm{q}}\in\mathbb{R}^{H}
{\bm{Z}}_{bank}\in\mathbb{R}^{B\times H}
{\bm{d}}
{\bm{q}}
{\bm{Z}}_{bank}
{\bm{q}}
{\bm{q}}[:h]
{\bm{Z}}_{bank}[:,:h]
h
h
{\bm{q}}
{\bm{Z}}_{bank}[b,:h]
{\bm{Z}}_{bank}[b,:]
b^{\mathrm{th}}
{\bm{d}}
{\bm{m}}
K
{\bm{d}}
{\bm{w}}\in\mathbb{R}^{1\times K}
{\bm{w}}
\{{\bm{s}}_{1},...,{\bm{s}}_{K}\}
{\bm{Z}}_{bank}
{\bm{s}}
K
{\bm{w}}
h_{p}
\tau
\text{max}({\bm{w}})
{\bm{q}}
l=l_{main}+\lambda l_{atr}
\lambda
l_{atr}
\sqrt{h}
\text{LayerNorm}(\cdot)
{\bm{x}}=[x_{1},x_{2},...,x_{N}]
x_{n}
1
-1
0
1
{\bm{x}}
{\bm{s}}
T
T
{\bm{x}}
1
K
2
K
2
T
2\tau
\frac{N}{2}
N
T
2.3
{\bm{Z}}_{bank}=h_{2}(h_{1}({\bm{X}}_{p})+{\bm{E}}_{pos})
{\bm{X}}_{p}
h_{1}
h_{2}
{\bm{E}}_{pos}
{\bm{Z}}_{bank}
\small{\bm{X}}^{\prime}=\mathrm{MSA}(\mathrm{LayerNorm}({\bm{X}}))+{\bm{X}}
\small{\bm{X}}^{\prime\prime}=\mathrm{FFN}(\mathrm{LayerNorm}({\bm{X}}^{\prime%
}))+{\bm{X}}^{\prime}
\mathrm{MSA}(\cdot)
\mathrm{FFN}(\cdot)
{\bm{X}}
p_{t}{\bm{z}}_{t}
p_{t}
t^{\mathrm{th}}
{\bm{z}}_{t}
\mathrm{LayerNorm(\cdot)}
\small\mathrm{LayerNorm}(p_{t}{\bm{z}}_{t})=\frac{p_{t}{\bm{z}}_{t}-\frac{1}{H%
}\sum_{h=1}^{H}p_{t}z_{t,h}}{\sqrt{\frac{1}{H}\sum_{h=1}^{H}(p_{t}z_{t,h}-\sum%
_{j=1}^{H}p_{t}z_{t,j})^{2}+\epsilon}}*\gamma+\beta
\epsilon
\displaystyle\mathrm{LayerNorm}(p_{t}{\bm{z}}_{t})\approx\frac{{\bm{z}}_{t}-%
\frac{1}{H}\sum_{h=1}^{H}z_{t,h}}{\sqrt{\frac{1}{H}\sum_{h=1}^{H}(z_{t,h}-\sum%
_{j=1}^{H}z_{t,j})^{2}+\epsilon}}*\gamma+\beta=\mathrm{LayerNorm}({\bm{z}}_{t})
\displaystyle\mathrm{LayerNorm}(p_{t}{\bm{z}}_{t})
\displaystyle\approx\frac{{\bm{z}}_{t}-\frac{1}{H}\sum_{h=1}^{H}z_{t,h}}{\sqrt%
{\frac{1}{H}\sum_{h=1}^{H}(z_{t,h}-\sum_{j=1}^{H}z_{t,j})^{2}+\epsilon}}*%
\gamma+\beta=\mathrm{LayerNorm}({\bm{z}}_{t})
p_{t}
p_{t}
\mathrm{LayerNorm(\cdot)}
p_{t}
g(\cdot)
g(\cdot)
p_{t}
1.0
p
T
\tau
\lambda
C
\tau
\times
(\beta_{1},\beta_{2})
(0.9,0.999)
{\bm{q}}
{\bm{q}}
\lambda
\epsilon
\epsilon
\lambda
\lambda
0.01
{\bm{m}}
\mathbf{0}+{\bm{b}}
{\bm{b}}\in\mathbb{R}^{1\times C}
b_{c}\sim\mathrm{Bernoulli}(p)
p
0.1
p
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
\checkmark
0.4\times
0.3\times
T
T
10
1e+4
10
1.3\%
