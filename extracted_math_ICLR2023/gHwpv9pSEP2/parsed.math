{\mathcal{P}}_{1}
{\mathcal{P}}_{2}
{\mathcal{P}}_{3}
{\mathcal{P}}_{1}
{\mathcal{P}}_{2}
{\mathcal{P}}_{3}
{\mathcal{P}}^{\prime}
{\mathcal{P}}_{1}
{\mathcal{P}}_{2}
({\mathcal{P}}_{1},{\mathcal{P}}_{2})
({\mathcal{P}}_{1},{\mathcal{P}}_{3})
({\mathcal{P}}_{2},{\mathcal{P}}_{3})
{\mathcal{G}}=({\mathcal{V}},{\mathcal{E}})
v\in{\mathcal{V}}
e\in{\mathcal{E}}
i
{\bm{H}}_{v}^{i}=({\bm{N}}_{S}^{i},{\bm{N}}_{V}^{i})
{\bm{N}}_{S}^{i}
{\bm{N}}_{V}^{i}\in\mathbb{R}^{3\times 3}
C_{\alpha}
{\bm{N}}_{V,1}^{i}=C_{\alpha_{i+1}}-C_{\alpha_{i}}
{\bm{N}}_{V,2}^{i}=C_{\alpha_{i-1}}-C_{\alpha_{i}}
{\bm{N}}_{V,3}^{i}=\sqrt{\frac{1}{3}}\frac{(\mathbf{n}\times\mathbf{c})}{\|%
\mathbf{n}\times\mathbf{c}\|_{2}}-\sqrt{\frac{2}{3}}\frac{(\mathbf{n}+\mathbf{%
c})}{\|\mathbf{n}+\mathbf{c}\|_{2}},
\mathbf{n}=N_{i}-C_{\alpha_{i}}
\mathbf{c}=C_{i}-C_{\alpha_{i}}
v_{i}
v_{j}
{\bm{H}}_{e}^{ij}
{\bm{E}}_{S}^{ij}\in\mathbb{R}^{32}
\|C_{\alpha_{j}}-C_{\alpha_{i}}\|_{2}
v_{i}
v_{j}
{\bm{E}}_{V}^{ij}\in\mathbb{R}^{3}
C_{\alpha_{i}}-C_{\alpha_{j}}
{\mathcal{G}}
{\bm{H}}_{S}
{\bm{H}}_{V}
({\bm{H}}_{S}^{\prime},{\bm{H}}_{V}^{\prime})={\rm GVP}({\bm{H}}_{S},{\bm{H}}_%
{V}).
\rm GVP(\cdot)
(\ell+1)
0\leq\ell<L
\displaystyle{\bm{H}}_{S}^{(\ell+1)}=\sigma\big{(}{\bm{W}}_{1}\cdot{\rm concat%
}({\rm norm}({\bm{W}}_{2}{\bm{H}}_{V}^{(\ell)}),{\bm{H}}_{3})+{\bm{b}}\big{)},
\displaystyle{\bm{H}}_{S}^{(\ell+1)}
\displaystyle=\sigma\big{(}{\bm{W}}_{1}\cdot{\rm concat}({\rm norm}({\bm{W}}_{%
2}{\bm{H}}_{V}^{(\ell)}),{\bm{H}}_{3})+{\bm{b}}\big{)},
\displaystyle{\bm{H}}_{V}^{(\ell+1)}=\sigma\big{(}{\rm norm}({\bm{V}}^{(\ell+1%
)})\big{)}\odot{\bm{V}}^{(\ell+1)},
\displaystyle{\bm{H}}_{V}^{(\ell+1)}
\displaystyle=\sigma\big{(}{\rm norm}({\bm{V}}^{(\ell+1)})\big{)}\odot{\bm{V}}%
^{(\ell+1)},
\displaystyle\text{where }{\bm{V}}^{(\ell+1)}={\bm{W}}_{4}{\bm{W}}_{2}{\bm{H}}%
_{V}^{(\ell)}.
\displaystyle\text{where }{\bm{V}}^{(\ell+1)}
\displaystyle={\bm{W}}_{4}{\bm{W}}_{2}{\bm{H}}_{V}^{(\ell)}.
{\bm{W}}_{1},{\bm{W}}_{1},{\bm{W}}_{3},{\bm{W}}_{4}
{\bm{b}}
\odot
{\rm norm}(\cdot)
{\mathbb{L}}_{2}
\sigma(\cdot)
\ell=0
({\bm{H}}_{S}^{(0)},{\bm{H}}_{V}^{(0)})=({\bm{H}}_{S},{\bm{H}}_{V})
\ell+1=L
({\bm{H}}_{S}^{\prime},{\bm{H}}_{V}^{\prime})=({\bm{H}}_{S}^{(L)},{\bm{H}}_{V}%
^{(L)})
L=3
\rm GVP(\cdot)
({\bm{H}}_{S}^{\prime},{\bm{H}}_{V}^{\prime})
{\bm{H}}={\rm concat}({\bm{H}}_{S}^{\prime},{\bm{H}}_{V}^{\prime})
i
i\rightarrow j
\displaystyle\mathbf{h}_{m}^{ij}:={\rm GVP}\left(\mathrm{concat}\left(\mathbf{%
h}_{\mathbf{v}}^{j},\mathbf{h}_{e}^{ij}\right)\right)
\displaystyle\mathbf{h}_{m}^{ij}
\displaystyle:={\rm GVP}\left(\mathrm{concat}\left(\mathbf{h}_{\mathbf{v}}^{j}%
,\mathbf{h}_{e}^{ij}\right)\right)
\displaystyle\mathbf{h}_{\mathbf{v}}^{i}\leftarrow\mathrm{LayerNorm}\left(%
\mathbf{h}_{\mathbf{v}}^{i}+\frac{1}{k}\mathrm{Dropout}\left(\sum_{j:\mathbf{e%
}_{ij}\in\mathcal{E}}\mathbf{h}_{m}^{ij}\right)\right),
\displaystyle\mathbf{h}_{\mathbf{v}}^{i}
\displaystyle\leftarrow\mathrm{LayerNorm}\left(\mathbf{h}_{\mathbf{v}}^{i}+%
\frac{1}{k}\mathrm{Dropout}\left(\sum_{j:\mathbf{e}_{ij}\in\mathcal{E}}\mathbf%
{h}_{m}^{ij}\right)\right),
\mathbf{h}
{\bm{H}}_{S}^{\prime}
{\bm{H}}_{V}^{\prime}
k
i
{\bm{h}}_{v}^{i}
{\bm{h}}_{m}^{ij}
i
i\to j
\mathbf{h_{v}^{i}}\leftarrow\text{LayerNorm}\left(\mathbf{h_{v}^{i}}+\text{%
Dropout}\left({\rm GVP}^{\prime}\left(\mathbf{h_{v}^{i}}\right)\right)\right),
{\rm GVP}^{\prime}
L=2
{\rm GVP}^{\prime}
6
\displaystyle y=\mathbf{W}(\text{ReLU}(\text{DropOut}(\mathbf{W}\mathbf{H}_{S}%
))).
\displaystyle y=\mathbf{W}(\text{ReLU}(\text{DropOut}(\mathbf{W}\mathbf{H}_{S}%
))).
\displaystyle\mathbf{h_{v}}=\big{\|}\frac{1}{n}\sum_{i=1}^{n}\mathbf{h_{v}^{i}%
}\big{\|}.
\displaystyle\mathbf{h_{v}}=\big{\|}\frac{1}{n}\sum_{i=1}^{n}\mathbf{h_{v}^{i}%
}\big{\|}.
({\mathcal{P}}_{1},{\mathcal{P}}_{2})
({\bm{h}}_{1},{\bm{h}}_{2})
\displaystyle{\rm sim}({\mathcal{P}}_{1},{\mathcal{P}}_{2})=\frac{{\bm{h}}_{1}%
\cdot{\bm{h}}_{2}}{\|{\bm{h}}_{1}\|\cdot\|{\bm{h}}_{2}\|}.
\displaystyle{\rm sim}({\mathcal{P}}_{1},{\mathcal{P}}_{2})=\frac{{\bm{h}}_{1}%
\cdot{\bm{h}}_{2}}{\|{\bm{h}}_{1}\|\cdot\|{\bm{h}}_{2}\|}.
{\bm{N}}_{S}
0
p
{\bm{N}}_{S}
{\bm{N}}_{S}
1-p
p
{\mathcal{P}}_{1}
{\mathcal{P}}_{3}
{\mathcal{P}}^{\prime}
{\mathcal{P}}^{\prime}
({\mathcal{P}}_{1},{\mathcal{P}}_{3})
{\mathcal{P}}_{1}
{\mathcal{P}}_{3}
m
n
256
{\bm{H}}_{1}\in\mathbb{R}^{m\times 256}
{\bm{H}}_{3}\in\mathbb{R}^{n\times 256}
{\rm sim}({\mathcal{P}}_{1},{\mathcal{P}}_{3})=\frac{{\bm{H}}_{1}\cdot{\bm{H}}%
_{3}}{\|{\bm{H}}_{1}\|\cdot\|{\bm{H}}_{3}\|}
{\rm sim}({\mathcal{P}}_{1},{\mathcal{P}}_{3})\in\mathbb{R}^{m\times n}
\mu
s
{\bm{H}}^{\prime}\in{\bm{H}}
s\times s
m\times n
{\bm{H}}^{\prime}
{\rm mean}({\rm diag}({\bm{H}}^{\prime}))>\mu
{\bm{H}}^{\prime}
d
{\bm{H}}^{\prime}
{\bm{H}}^{\prime}_{1},{\bm{H}}^{\prime}_{3}
d
\mu=10
s=0.8
d=5
p
p
C_{\alpha}
N
20\%
14,654
10,000
10,000
14654\times 14654
1
0.0001
50
5
10,000
6
0.2
256
{\bm{N}}_{S}
32
{\bm{N}}_{V}
64
{\bm{E}}_{S}
2
{\bm{E}}_{V}
{\bm{N}}_{S}
0
40\%
31,070
200
20\%
14654\times 14654
30,000
1
30,000
p
1-p
1\%
p=0.5
6
