{\bm{x}}_{0}\in\mathbb{R}^{n}\sim q\in\mathcal{D}(\mathbb{R}^{n})
{\bm{x}}_{T}
{\bm{x}}_{1}
{\bm{x}}_{0}
{\bm{x}}_{0}
{\bm{x}}_{t}\sim q(\cdotp|{\bm{x}}_{t-1},t)
\beta_{1},...,\beta_{T}
{\bm{x}}_{t}\sim q(\cdotp|\,{\bm{x}}_{t-1},t)=\mathcal{N}(\sqrt{1-\beta_{t}}{%
\bm{x}}_{t-1},\beta_{t}{\bm{I}}).
{\bm{x}}_{t}
t\geq 1
{\bm{x}}_{0}
{\bm{x}}_{t}=\sqrt{\alpha_{t}}{\bm{x}}_{t-1}+\sqrt{1-\alpha_{t}}\epsilon_{t}=%
\sqrt{\overline{\alpha}_{t}}{\bm{x}}_{0}+\sqrt{1-\overline{\alpha}_{t}}\epsilon,
\alpha_{t}:=1-\beta_{t}
\overline{\alpha}_{t}:=\prod_{s=1}^{t}\alpha_{s}
\epsilon_{t}\sim\mathcal{N}\big{(}0,{\bm{I}}\big{)}
\epsilon\sim\mathcal{N}\big{(}0,{\bm{I}}\big{)}
{\bm{x}}_{T}\sim\mathcal{N}(0,{\bm{I}})
\theta
{\bm{x}}_{t-1}\sim p_{\theta}(\cdotp|{\bm{x}}_{t})=\mathcal{N}\big{(}{\bm{\mu}%
}_{\theta}({\bm{x}}_{t},t),\sigma(t)^{2}{\bm{I}}\big{)}
\hat{{\bm{x}}}_{0}({\bm{x}}_{t},t,\theta)
{\bm{x}}_{0}
\beta_{1},...,\beta_{T}
{\bm{\mu}}_{\theta}({\bm{x}}_{t},t)=\frac{\sqrt{\overline{\alpha}_{t-1}}\beta_%
{t}}{1-\overline{\alpha}_{t}}\hat{{\bm{x}}}_{0}({\bm{x}}_{t},t,\theta)+\frac{%
\sqrt{\alpha_{t}}(1-\overline{\alpha}_{t-1})}{1-\overline{\alpha}_{t}}{\bm{x}}%
_{t},\qquad\sigma(t)^{2}=\frac{1-\overline{\alpha}_{t-1}}{1-\overline{\alpha}_%
{t}}\beta_{t}\cdot
\log p_{\theta}({\bm{x}}_{0})
{\bm{x}}_{0}
\hat{{\bm{x}}}_{0}({\bm{x}}_{t},t,\theta)
\mathcal{L}_{\text{diffusion}}=\mathbb{E}_{{\bm{x}}_{0}\sim q({\bm{x}}_{0}),\,%
t\sim\mathcal{U}(1,T)}\|{\bm{x}}_{0}-\hat{{\bm{x}}}_{0}({\bm{x}}_{t},t,\theta)%
\|^{2}\cdot
{\bm{w}}=(w_{1},\ldots,w_{N})
w_{i}
\mathbb{R}^{V}
\left\{1,...,V\right\}
w
{\bm{e}}_{w}\in\mathbb{R}^{D}
\sqrt{D}
D
{\bm{E}}\in\mathbb{R}^{D\times V}
q_{{\bm{V}}}({\bm{x}}_{0}|{\bm{w}})=\mathcal{N}({\bm{E}}{\bm{w}},\sigma_{0}^{2%
}{\bm{I}})
\sigma_{0}
\beta_{1}
p_{\bm{R}}({\bm{w}}|{\bm{x}}_{0})=\prod_{k=1}^{N}\mathrm{Cat}(w_{k}|{\bm{E}}^{%
\prime}({\bm{x}}_{0})_{k})
{\bm{R}}\in\mathbb{R}^{V\times D}
{\bm{E}}^{\top}
\mathrm{Cat}(w_{k}|{\bm{l}})
k
{\bm{l}}\in\mathbb{R}^{V}
\mathcal{L}_{\text{diffusion}}
p_{\theta}({\bm{w}})
p_{\theta}({\bm{w}}|{\bm{x}}_{0})
\mathcal{L}_{\text{recon}}=\mathbb{E}_{{\bm{w}}\sim\mathcal{D},{\bm{x}}_{0}%
\sim q_{{\bm{V}}}({\bm{w}})}[-\log p_{\bm{R}}({\bm{w}}|{\bm{x}}_{0})],\qquad%
\text{with}\qquad\mathcal{L}_{\text{total}}=\mathcal{L}_{\text{diffusion}}+%
\mathcal{L}_{\text{recon}}.
{\bm{E}}
\mathcal{L}_{\mathrm{recon}}
{\bm{R}}
T=1000
\overline{{\bm{x}}}_{0}
d_{\text{embed}}
{\bm{R}}
\mathbb{R}^{V}
w_{i}
i=\operatorname*{arg\,max}_{1\leq j\leq V}({\bm{R}}\,\overline{{\bm{x}}}_{0})
T
T
t
\overline{{\bm{x}}}_{0}^{t}=\hat{{\bm{x}}}_{0}({\bm{x}}_{t},t,\theta)
{\bm{x}}_{0}
{\bm{x}}_{t}
{\bm{x}}_{0}
\tilde{{\bm{x}}}_{0}^{t+1}
\tilde{\bm{x}}_{0}^{t}=\hat{{\bm{x}}}_{0}({\bm{x}}_{t},\tilde{\bm{x}}_{0}^{t+1%
},t,\theta)
{\bm{x}}_{t}
\tilde{{\bm{x}}}_{0}^{t+1}
\overline{{\bm{x}}}_{0}^{t}=\hat{\bm{x}}_{0}({\bm{x}}_{t},0,t,\theta)
\overline{{\bm{x}}}_{0}^{t}
\tilde{{\bm{x}}}_{0}^{t}=\hat{{\bm{x}}}_{0}({\bm{x}}_{t},\overline{{\bm{x}}}_{%
0}^{t},t,\theta)
{\bm{x}}_{0}
{\bm{x}}_{0}
{\bm{x}}
{\bm{c}}
{\bm{c}}
{\bm{m}}
{\bm{m}}
L
M
n
[1,M]
n-1
(i_{1},...,i_{n-1})
0<i_{1}<...<i_{n-1}<L
(i_{1},...,i_{n-1})
n
\mathbb{E}[i_{k}|n]=\frac{k}{n}L
{\bm{m}}
{\bm{m}}
50\%
n=1
{\bm{m}}
\tilde{{\bm{x}}}_{0}
\hat{\bm{x}}_{0}({\bm{x}}_{t},{\bm{c}},\tilde{\bm{x}}_{0}^{t+1},t,\theta)
{\bm{c}}
{\bm{c}}
\hat{{\bm{x}}}_{0}
\emptyset
\hat{{\bm{x}}}_{0}({\bm{x}}_{t},{\bm{c}},\tilde{{\bm{x}}}_{0}^{t+1},t,\theta)
\hat{{\bm{x}}}_{0}({\bm{x}}_{t},0,0,t,\theta)
\tilde{{\bm{x}}}_{0,s}^{t}=\hat{{\bm{x}}}_{0}\big{(}{\bm{x}}_{t},0,0,t,\theta%
\big{)}+s\,\cdot\,\Big{(}\hat{{\bm{x}}}_{0}\big{(}{\bm{x}}_{t},{\bm{c}},\tilde%
{{\bm{x}}}_{0}^{t+1},t,\theta\big{)}-\hat{{\bm{x}}}_{0}\big{(}{\bm{x}}_{t},0,0%
,t,\theta\big{)}\Big{)},
s\geq 1
\tilde{{\bm{x}}}_{0}^{t+1}
150
d_{\text{model}}=896
d_{\text{embed}}
d_{\text{embed}}
d_{\text{model}}
\beta_{1}=2.10^{-3}
\sigma_{0}=10^{-2}
T=1000
135
10^{6}
420
2.10^{6}
\{1,2,4,8\}
p
\{1.00,0.95,0.90,0.85\}
p
\{1,2,4,8\}
p
\{1.00,0.95,0.90,0.85\}
p
p
0.8
4
p=0.95
p=0.95
\pm
\pm
\pm
\pm
6.70\,\pm\,0.04
1.81\,\pm\,0.15
420
256
4.20
3.68
{\bm{x}}\in\mathbb{R}^{N\times D}
d_{\text{model}}
t
d_{\text{model}}
d_{\text{model}}\times d_{\text{model}}
{\bm{E}}^{\prime}
y\in\mathbb{R}^{N\times d_{\text{model}}}
(y_{i})_{1\leq i\leq N}
{\bm{x}}
\hat{{\bm{x}}}_{0}
d_{\text{model}}
{\bm{x}}_{0}
{\bm{x}}_{t}
t
{\bm{E}}
{\bm{w}}_{t}
\mathcal{N}({\bm{w}}_{0})
{\bm{w}}_{0}={\bm{x}}_{0}
r_{t}
{\bm{w}}_{t}
\mathcal{N}({\bm{w}}_{0})
{\bm{w}}_{t}
r_{t}
{\bm{w}}_{t}
{\bm{w}}_{0}
{\bm{w}}_{0}
\mathbb{R}^{896}
d_{\text{embed}}=896
