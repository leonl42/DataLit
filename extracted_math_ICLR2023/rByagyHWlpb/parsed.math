\displaystyle{\bm{V}}
\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}
\displaystyle{\bm{P}}_{\phi}(\displaystyle{\bm{K}},\displaystyle{\bm{Q}})=%
\operatorname{softmax}\left(\frac{\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{%
T}}{\sqrt{d}}\right)
\operatorname{Attention}\left(\displaystyle{\bm{P}}_{\phi}(\displaystyle{\bm{K%
}},\displaystyle{\bm{Q}}),\displaystyle{\bm{V}}\right)=\displaystyle{\bm{P}}_{%
\phi}(\displaystyle{\bm{K}},\displaystyle{\bm{Q}})\displaystyle{\bm{V}}
\displaystyle{\bm{P}}_{\phi}(\displaystyle{\bm{K}},\displaystyle{\bm{Q}})
\displaystyle{\bm{P}}_{\phi}(\displaystyle{\bm{K}},\displaystyle{\bm{Q}})
\displaystyle{\bm{P}}_{\phi}
\displaystyle{\bm{Q}}\in\displaystyle\mathbb{R}^{n\times d}
\displaystyle{\bm{K}}\in\displaystyle\mathbb{R}^{n\times d}
\displaystyle{\bm{V}}\in\displaystyle\mathbb{R}^{n\times d}
\displaystyle{\bm{P}}_{\phi}\in\displaystyle\mathbb{R}^{n\times n}
n
d
O\left(n^{2}d\right)
n
d
n
\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}
d
\displaystyle{\bm{P}}_{\phi}\in\displaystyle\mathbb{R}^{n\times n}
\displaystyle{\bm{P}}_{\phi}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{P}}_{\phi}
H(\displaystyle{\bm{P}}_{\phi}|\ \displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T%
})=H(\operatorname{softmax}\left(\frac{\displaystyle{\bm{Q}}\displaystyle{\bm{%
K}}^{T}}{\sqrt{d}}\right)|\ \displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T})=0
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{P}}_{\phi}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{P}}_{\phi}
H(\displaystyle{\bm{P}}_{\phi}|\ \operatorname{basis_{r}}(\operatorname{basis_%
{c}}(\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T})),\displaystyle{\bm{W}}_{r%
}^{\prime},\ \displaystyle{\bm{W}}_{c}^{\prime})=0
\operatorname{basis_{r}}
\operatorname{basis_{c}}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}
\operatorname{Rank}\left(\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}\right)%
\leq\operatorname{max}\left(\operatorname{Rank}\left(\displaystyle{\bm{Q}}%
\right),\operatorname{Rank}\left(\displaystyle{\bm{K}}\right)\right)\leq%
\operatorname{min}\left(n,d\right)
\operatorname{Rank}()
\operatorname{basis_{r}}(\operatorname{basis_{c}}(\displaystyle{\bm{Q}}%
\displaystyle{\bm{K}}^{T}))
\displaystyle\mathbb{R}^{\operatorname{min}\left(n,d\right)\times\operatorname%
{min}\left(n,d\right)}
\displaystyle{\bm{P}}_{\phi}
{\displaystyle{\bm{P}}_{\phi}}^{\prime}{\in\displaystyle\mathbb{R}}^{d_{p}%
\times d_{p}}
(d_{p}\leq\operatorname{min}\left(n,d\right))
\displaystyle{\bm{W}}_{r}^{\prime}\in\displaystyle\mathbb{R}^{n\times d_{p}}
\displaystyle{\bm{W}}_{c}^{\prime}\in\displaystyle\mathbb{R}^{n\times d_{p}}
\displaystyle{\bm{P}}_{\phi}=\displaystyle{\bm{W}}_{r}^{\prime}{\displaystyle{%
\bm{P}}_{\phi}}^{\prime}{\displaystyle{\bm{W}}_{c}^{\prime}}^{T}
{\displaystyle{\bm{P}}_{\phi}}^{\prime}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{Q}}\in\displaystyle\mathbb{R}^{n\times d},\displaystyle{\bm{%
K}}\in\displaystyle\mathbb{R}^{n\times d}
\displaystyle{\bm{Q}}_{l}\in\displaystyle\mathbb{R}^{d_{p}\times d}
\displaystyle{\bm{K}}_{l}\in\displaystyle\mathbb{R}^{d_{p}\times d}
{\displaystyle{\bm{P}}_{\phi}}^{\prime}
\displaystyle{\bm{Q}}_{l}
\displaystyle{\bm{K}}_{l}
\displaystyle{\bm{P}}_{\phi}={\bm{W}}_{r}^{\prime}{\displaystyle{\bm{P}}_{\phi%
}}^{\prime}{\displaystyle{\bm{W}}_{c}^{\prime}}^{T}={\bm{W}}_{r}^{\prime}\left%
(\operatorname{softmax}\left(\frac{\displaystyle{\bm{Q}}_{l}\displaystyle{\bm{%
K}}_{l}^{T}}{\sqrt{d}}\right)\right){\displaystyle{\bm{W}}_{c}^{\prime}}^{T}
\displaystyle{\bm{P}}_{\phi}
\displaystyle={\bm{W}}_{r}^{\prime}{\displaystyle{\bm{P}}_{\phi}}^{\prime}{%
\displaystyle{\bm{W}}_{c}^{\prime}}^{T}={\bm{W}}_{r}^{\prime}\left(%
\operatorname{softmax}\left(\frac{\displaystyle{\bm{Q}}_{l}\displaystyle{\bm{K%
}}_{l}^{T}}{\sqrt{d}}\right)\right){\displaystyle{\bm{W}}_{c}^{\prime}}^{T}
\displaystyle={\bm{W}}_{r}^{\prime}\left(\operatorname{softmax}\left(\frac{(%
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}})(\displaystyle{\bm{K}}^{T}{%
\displaystyle{\bm{W}}_{c}}^{T})}{\sqrt{d}}\right)\right){\displaystyle{\bm{W}}%
_{c}^{\prime}}^{T}
\displaystyle={\bm{W}}_{r}^{\prime}\left(\operatorname{softmax}\left(\frac{(%
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}})(\displaystyle{\bm{K}}^{T}{%
\displaystyle{\bm{W}}_{c}}^{T})}{\sqrt{d}}\right)\right){\displaystyle{\bm{W}}%
_{c}^{\prime}}^{T}
\displaystyle{\bm{W}}_{r}\in\displaystyle\mathbb{R}^{d_{p}\times n}
\displaystyle{\bm{W}}_{c}\in\displaystyle\mathbb{R}^{d_{p}\times n}
\displaystyle{\bm{W}}_{r}^{\prime}\in\displaystyle\mathbb{R}^{n\times d_{p}}
\displaystyle{\bm{W}}_{c}^{\prime}\in\displaystyle\mathbb{R}^{n\times d_{p}}
{\displaystyle{\bm{P}}_{\phi}}^{\prime}
\displaystyle{\bm{P}}_{\phi}
\displaystyle{\bm{W}}_{r}^{\prime}
{\displaystyle{\bm{W}}_{c}^{\prime}}^{T}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{V}}
\displaystyle{\bm{V}}_{DBA}
\displaystyle{\bm{V}}_{DBA}
{\displaystyle{\bm{P}}_{\phi}}^{\prime}
\displaystyle{\bm{W}}_{r}^{\prime}
\operatorname{DBA}\left(\displaystyle{\bm{K}},\displaystyle{\bm{Q}},%
\displaystyle{\bm{V}}\right)=\displaystyle{\bm{W}}_{r}^{\prime}{(\displaystyle%
{\bm{P}}_{\phi}}^{\prime}{(\displaystyle{\bm{W}}_{c}^{\prime}}^{T}%
\displaystyle{\bm{V}}))=\displaystyle{\bm{W}}_{r}^{\prime}\left({\displaystyle%
{\bm{P}}_{\phi}}^{\prime}\displaystyle{\bm{V}}_{DBA}\right)
\displaystyle{\bm{V}}_{DBA}={\displaystyle{\bm{W}}_{c}^{\prime}}^{T}%
\displaystyle{\bm{V}}\in\displaystyle\mathbb{R}^{d_{p}\times d}
d
\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}
d_{in}\geq 10log\left(d_{p}\right)/\left(\epsilon^{2}-\epsilon^{3}\right)
\displaystyle\operatorname{Pr}\left(\left|\left|\left(\displaystyle{\bm{W}}_{r%
}\displaystyle{\bm{Q}}\right)\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}%
\left(\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)-\left(%
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(\displaystyle{\bm{K%
}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\leq\epsilon\left|%
\left|\left(\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(%
\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\right)
\displaystyle\operatorname{Pr}\left(\left|\left|\left(\displaystyle{\bm{W}}_{r%
}\displaystyle{\bm{Q}}\right)\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}%
\left(\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)-\left(%
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(\displaystyle{\bm{K%
}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\leq\epsilon\left|%
\left|\left(\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(%
\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\right)
\displaystyle>1-o\left(1\right)
\displaystyle>1-o\left(1\right)
\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}
d
d_{in}
\displaystyle{\bm{Q}}_{l}\in\displaystyle\mathbb{R}^{d_{p}\times d}
\displaystyle{\bm{K}}_{l}\in\displaystyle\mathbb{R}^{d_{p}\times d}
\displaystyle{\bm{Q}}_{DBA}\in\displaystyle\mathbb{R}^{d_{p}\times d_{in}}
\displaystyle{\bm{K}}_{DBA}\in\displaystyle\mathbb{R}^{d_{p}\times d_{in}}
\displaystyle\operatorname{DBA}\left({\bm{K}},{\bm{Q}},{\bm{V}}\right)={\bm{W}%
}_{r}^{\prime}\left(\left(\operatorname{softmax}\left(\frac{((\displaystyle{%
\bm{W}}_{r}\displaystyle{\bm{Q}})\displaystyle{\bm{R}})({\displaystyle{\bm{R}}%
}^{T}(\displaystyle{\bm{K}}^{T}{\displaystyle{\bm{W}}_{c}}^{T}))}{\sqrt{d_{in}%
}}\right)\right)\left({\displaystyle{\bm{W}}_{c}^{\prime}}^{T}\displaystyle{%
\bm{V}}\right)\right)
\displaystyle\operatorname{DBA}\left({\bm{K}},{\bm{Q}},{\bm{V}}\right)
\displaystyle={\bm{W}}_{r}^{\prime}\left(\left(\operatorname{softmax}\left(%
\frac{((\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}})\displaystyle{\bm{R}})(%
{\displaystyle{\bm{R}}}^{T}(\displaystyle{\bm{K}}^{T}{\displaystyle{\bm{W}}_{c%
}}^{T}))}{\sqrt{d_{in}}}\right)\right)\left({\displaystyle{\bm{W}}_{c}^{\prime%
}}^{T}\displaystyle{\bm{V}}\right)\right)
\displaystyle={\bm{W}}_{r}^{\prime}\left(\operatorname{softmax}\left(\frac{%
\displaystyle{\bm{Q}}_{DBA}\displaystyle{\bm{K}}_{DBA}^{T}}{\sqrt{d_{in}}}%
\right){\bm{V}}_{DBA}\right)
\displaystyle={\bm{W}}_{r}^{\prime}\left(\operatorname{softmax}\left(\frac{%
\displaystyle{\bm{Q}}_{DBA}\displaystyle{\bm{K}}_{DBA}^{T}}{\sqrt{d_{in}}}%
\right){\bm{V}}_{DBA}\right)
\displaystyle{\bm{R}}
\displaystyle{\bm{W}}_{r}
\displaystyle{\bm{W}}_{c}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{R}}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{W}}_{r}
\displaystyle{\bm{W}}_{c}
\displaystyle{\bm{Z}}\in\displaystyle\mathbb{R}^{d_{p}\times d}
\displaystyle{\bm{W}}_{r}=\varphi\left({\bm{Z}}{\bm{Q}}^{T}\right)
\displaystyle{\bm{W}}_{r}=\varphi\left({\bm{Z}}{\bm{Q}}^{T}\right)
\displaystyle{\bm{W}}_{c}=\varphi({\bm{Z}}{\bm{K}}^{T})
\displaystyle{\bm{W}}_{c}=\varphi({\bm{Z}}{\bm{K}}^{T})
\varphi
\varphi
\operatorname{softmax}
\displaystyle{\bm{W}}_{r}
\displaystyle{\bm{W}}_{c}
\displaystyle{\bm{W}}_{r}
\displaystyle{\bm{W}}_{c}
\displaystyle{\bm{W}}_{r}
\displaystyle{\bm{W}}_{c}
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}
\displaystyle{\bm{K}}^{T}{\displaystyle{\bm{W}}_{c}}^{T}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{W}}_{r}
\displaystyle{\bm{W}}_{c}
\displaystyle{\bm{W}}_{r}^{\prime}
\displaystyle{\bm{W}}_{c}^{\prime}
\displaystyle{\bm{Z}}
\displaystyle{\bm{X}}_{1}
\operatorname{H_{1}}
\displaystyle{\bm{Q}}_{1}
\displaystyle{\bm{X}}_{2}
\operatorname{H_{2}}
\displaystyle{\bm{K}}_{2}
\displaystyle{\bm{V}}_{2}
\operatorname{H_{1}}
\operatorname{H_{2}}
\displaystyle{\bm{Q}}_{1}
\displaystyle{\bm{K}}_{2}
\operatorname{Cross-Attention}\left(\displaystyle{\bm{K}}_{2},\displaystyle{%
\bm{Q}}_{1},\displaystyle{\bm{V}}_{2}\right)=\operatorname{softmax}\left(\frac%
{\displaystyle{\bm{Q}}_{1}\displaystyle{\bm{K}}_{2}^{T}}{\sqrt{d}}\right)%
\displaystyle{\bm{V}}_{2}
\displaystyle{\bm{X}}_{2}
\displaystyle{\bm{K}}_{2}
\displaystyle{\bm{V}}_{2}
\displaystyle{\bm{W}}_{r2}\displaystyle{\bm{X}}_{2}
\displaystyle{\bm{Z}}_{1}
\displaystyle{\bm{K}}_{2}
\displaystyle{\bm{V}}_{2}
\displaystyle{\bm{X}}_{1}
\displaystyle{\bm{Q}}_{1}
\displaystyle{\bm{W}}_{r2}\displaystyle{\bm{X}}_{2}
\displaystyle{\bm{K}}_{2}
\displaystyle{\bm{V}}_{2}
\displaystyle{\bm{Q}}_{1}
\displaystyle{\bm{W}}_{r1}
\displaystyle{\bm{Z}}_{1}
\displaystyle{\bm{W}}_{r1}=\varphi({\bm{Z}}_{1}{\bm{Q}}_{1}^{T})=\varphi(%
\operatorname{Linear}({\bm{W}}_{r2}{\bm{X}}_{2}){\bm{Q}}_{1}^{T})
\displaystyle{\bm{W}}_{r1}=\varphi({\bm{Z}}_{1}{\bm{Q}}_{1}^{T})=\varphi(%
\operatorname{Linear}({\bm{W}}_{r2}{\bm{X}}_{2}){\bm{Q}}_{1}^{T})
\operatorname{Linear()}
\displaystyle{\bm{W}}_{r2}\displaystyle{\bm{X}}_{2}
\displaystyle{\bm{Z}}_{1}
\displaystyle{\bm{W}}_{r1}
\displaystyle{\bm{Q}}_{1}
\operatorname{H_{2}}
d
(\displaystyle{\bm{Q}}_{DBA})_{1}
(\displaystyle{\bm{K}}_{DBA})_{2}
(\displaystyle{\bm{V}}_{DBA})_{2}
\operatorname{H_{2}}
\operatorname{H_{1}}
\uparrow
\downarrow
\uparrow
\pm
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\pm
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\uparrow
\pm
\operatorname{nPara}
\operatorname{nPara}
\operatorname{nPara}
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\pm
\pm
\pm
\pm
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\downarrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
X\in\displaystyle\mathbb{R}^{n\times d}
n
\mathbb{R}^{n\times d}
\mathbb{R}^{d_{p}\times d}
\displaystyle{\bm{R}}\in\displaystyle\mathbb{R}^{d\times d_{in}}
1\leq d_{in}\leq d
i.i.d.
\displaystyle\mathcal{N}(0,\ 1/d)
\displaystyle{\mathbf{x}},\displaystyle{\mathbf{y}}\in\displaystyle\mathbb{R}^%
{d}
\operatorname{Pr}\left(\left|\left|\displaystyle{\mathbf{x}}\displaystyle{\bm{%
R}}\displaystyle{\bm{R}}^{T}\displaystyle{\mathbf{y}}^{T}-\displaystyle{%
\mathbf{x}}\displaystyle{\mathbf{y}}^{T}\right|\right|\leq\epsilon\left|\left|%
\displaystyle{\mathbf{x}}\displaystyle{\mathbf{y}}^{T}\right|\right|\right)>1-%
2e^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}/4}
\displaystyle\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{Q}}%
\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}{\displaystyle{\bm{k}}_{i}}^{T}-%
\displaystyle{\bm{Q}}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\leq\epsilon%
\left|\left|\displaystyle{\bm{Q}}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\right)
\displaystyle\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{Q}}%
\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}{\displaystyle{\bm{k}}_{i}}^{T}-%
\displaystyle{\bm{Q}}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\leq\epsilon%
\left|\left|\displaystyle{\bm{Q}}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\right)
\displaystyle\geq 1-\sum_{\displaystyle{\bm{q}}_{i}\in\displaystyle{\bm{Q}}}%
\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{q}}_{i}\displaystyle{\bm{%
R}}\displaystyle{\bm{R}}^{T}{\displaystyle{\bm{k}}_{i}}^{T}-\displaystyle{\bm{%
q}}_{i}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|>\epsilon\left|\left|%
\displaystyle{\bm{q}}_{i}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\right)>%
1-2ne^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}/4}
\displaystyle\geq 1-\sum_{\displaystyle{\bm{q}}_{i}\in\displaystyle{\bm{Q}}}%
\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{q}}_{i}\displaystyle{\bm{%
R}}\displaystyle{\bm{R}}^{T}{\displaystyle{\bm{k}}_{i}}^{T}-\displaystyle{\bm{%
q}}_{i}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|>\epsilon\left|\left|%
\displaystyle{\bm{q}}_{i}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\right)>%
1-2ne^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}/4}
\displaystyle{\bm{K}}
n
\displaystyle\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{Q}}%
\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}\displaystyle{\bm{K}}^{T}-%
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}\right|\right|\leq\epsilon\left|%
\left|\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}\right|\right|\right)
\displaystyle\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{Q}}%
\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}\displaystyle{\bm{K}}^{T}-%
\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}\right|\right|\leq\epsilon\left|%
\left|\displaystyle{\bm{Q}}\displaystyle{\bm{K}}^{T}\right|\right|\right)
\displaystyle\geq 1-\sum_{\displaystyle{\bm{k}}_{i}\in\displaystyle{\bm{K}}}{%
\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{Q}}\displaystyle{\bm{R}}%
\displaystyle{\bm{R}}^{T}{\displaystyle{\bm{k}}_{i}}^{T}-\displaystyle{\bm{Q}}%
{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|>\epsilon\left|\left|%
\displaystyle{\bm{Q}}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\right)>}1\ %
-2n^{2}e^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}/4}
\displaystyle\geq 1-\sum_{\displaystyle{\bm{k}}_{i}\in\displaystyle{\bm{K}}}{%
\operatorname{Pr}\left(\left|\left|\displaystyle{\bm{Q}}\displaystyle{\bm{R}}%
\displaystyle{\bm{R}}^{T}{\displaystyle{\bm{k}}_{i}}^{T}-\displaystyle{\bm{Q}}%
{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|>\epsilon\left|\left|%
\displaystyle{\bm{Q}}{\displaystyle{\bm{k}}_{i}}^{T}\right|\right|\right)>}1\ %
-2n^{2}e^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}/4}
\displaystyle\operatorname{Pr}\left(\left|\left|\left(\displaystyle{\bm{W}}_{r%
}\displaystyle{\bm{Q}}\right)\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}%
\left(\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)-\left(%
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(\displaystyle{\bm{K%
}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\leq\epsilon\left|%
\left|\left(\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(%
\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\right)
\displaystyle\operatorname{Pr}\left(\left|\left|\left(\displaystyle{\bm{W}}_{r%
}\displaystyle{\bm{Q}}\right)\displaystyle{\bm{R}}\displaystyle{\bm{R}}^{T}%
\left(\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)-\left(%
\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(\displaystyle{\bm{K%
}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\leq\epsilon\left|%
\left|\left(\displaystyle{\bm{W}}_{r}\displaystyle{\bm{Q}}\right)\left(%
\displaystyle{\bm{K}}^{T}\displaystyle{\bm{W}}_{c}^{T}\right)\right|\right|\right)
\displaystyle>1\ -2{d_{p}}^{2}e^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}%
/4}
\displaystyle>1\ -2{d_{p}}^{2}e^{-\left(\epsilon^{2}-\epsilon^{3}\right)d_{in}%
/4}
d_{in}\geq 10log\left(d_{p}\right)/\left(\epsilon^{2}-\epsilon^{3}\right)
\displaystyle\mathbb{R}^{768}
i^{th}
x_{i}\in\displaystyle\mathbb{R}^{2048}
\mathbb{R}^{n\times d}
\mathbb{R}^{d_{p}\times d}
\mathbb{R}^{n\times d}
d
d_{ffn}
d_{p}
d_{in}
d
d_{ffn}
d_{p}
d_{in}
d
d_{ffn}
d_{p}
d_{in}
d
d
d_{p}
d_{in}
d_{p}
d_{in}
d_{p}
d_{in}
d_{p}
d_{in}
d_{p}
d_{in}
d_{p}
d_{in}
d_{in}=24
d_{p}
d_{p}=16
d_{in}
d_{p}
d_{p}
d_{in}
d_{p}=16
d_{in}=24
d_{p}
d_{in}
d_{p}
d_{in}
\uparrow
\downarrow
\uparrow
d_{p}
n
\pm
\pm
\pm
\pm
\pm
d_{in}
d
\pm
\pm
\pm
\pm
d_{p}
d_{in}
d_{p}
d_{in}
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
\uparrow
d_{p}
n
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
d_{in}
d
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
