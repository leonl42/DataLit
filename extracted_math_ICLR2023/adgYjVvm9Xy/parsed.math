\ell_{2}
2-3\times
f
g(x)=\arg\max_{c}\mathbb{P}_{\delta\sim\mathcal{N}(0,\sigma^{2}I)}(f(x+\delta)%
=c)
x
\{x^{\prime}\in\mathbb{R}^{d}:f(x^{\prime})=c\}
\mathcal{N}(x,\sigma^{2}I)
\sigma
\mathcal{N}(x,\sigma^{2}I)
f
c_{A}
p_{A}=\mathbb{P}(f(x+\delta)=c_{A})
c_{B}
p_{B}=\max_{c\neq c_{A}}\mathbb{P}(f(x+\delta)=c)
x
g
r(g;\sigma)=\frac{\sigma}{2}(\Phi^{-1}(p_{A})-\Phi^{-1}(p_{B})),
\Phi^{-1}
p_{A}
p_{B}
p_{A}
p_{B}
\ell_{2}
F_{\theta}
\theta
x\in\mathbb{R}^{d}
\mathcal{Y}
G_{\theta}
\displaystyle G_{\theta}(x):=\mathbb{E}_{\delta\sim\mathcal{N}(0,\sigma^{2}I)}%
[F_{\theta}(x+\delta)].
\displaystyle G_{\theta}(x):=\mathbb{E}_{\delta\sim\mathcal{N}(0,\sigma^{2}I)}%
[F_{\theta}(x+\delta)].
G_{\theta}
\sigma
G_{\theta}
F_{\theta}
\widehat{x}
\ell_{2}
x
G_{\theta}
\displaystyle\textbf{SmoothAdv}:\quad\min_{\theta}\max_{\left\|\widehat{x}-x%
\right\|_{2}\leq\epsilon}J_{\theta}(\widehat{x}):=-\log[G_{\theta}(\widehat{x}%
)]_{y},
\displaystyle\textbf{SmoothAdv}:\quad\min_{\theta}\max_{\left\|\widehat{x}-x%
\right\|_{2}\leq\epsilon}J_{\theta}(\widehat{x}):=-\log[G_{\theta}(\widehat{x}%
)]_{y},
[G_{\theta}(\widehat{x})]_{y}
y
\displaystyle\text{(Stochastic estimator)}\quad\nabla_{x}J(\widehat{x})\approx%
-\nabla_{x}\log\bigg{(}\frac{1}{m}\sum_{i=1}^{m}[F_{\theta}\left(\widehat{x}+%
\delta_{i}\right)]_{y}\bigg{)},
\displaystyle\text{(Stochastic estimator)}\quad\nabla_{x}J(\widehat{x})\approx%
-\nabla_{x}\log\bigg{(}\frac{1}{m}\sum_{i=1}^{m}[F_{\theta}\left(\widehat{x}+%
\delta_{i}\right)]_{y}\bigg{)},
\delta_{i},i=1,...,m
\mathcal{N}\left(0,\sigma^{2}I\right)
x
m
\widehat{x}={\arg\min}_{\left\|\widehat{x}-x\right\|_{2}\leq\epsilon}\big{[}G_%
{\theta}(\widehat{x})\big{]}_{y}
[G(\widehat{x})]_{y}
\displaystyle\text{(One-point estimator)}\quad\nabla_{x}\big{[}G_{\theta}\left%
(\widehat{x}\right)\big{]}_{y}\approx\frac{1}{m}\sum_{i=1}^{m}\left[\frac{%
\delta_{i}}{\sigma^{2}}\cdot[F_{\theta}\left(\widehat{x}+\delta_{i}\right)]_{y%
}\right].
\displaystyle\text{(One-point estimator)}\quad\nabla_{x}\big{[}G_{\theta}\left%
(\widehat{x}\right)\big{]}_{y}\approx\frac{1}{m}\sum_{i=1}^{m}\left[\frac{%
\delta_{i}}{\sigma^{2}}\cdot[F_{\theta}\left(\widehat{x}+\delta_{i}\right)]_{y%
}\right].
\frac{\delta_{i}}{\sigma^{2}}\cdot[F_{\theta}\left(\widehat{x}+\delta_{i}%
\right)]_{y}
\widehat{x}+\delta_{i}
\quad\#
t=1,2,\ldots
S_{t}
k\in S_{t}
\theta_{t+1}^{k}\leftarrow
\left(k,\theta_{t}\right)
\theta_{t+1}^{k}
\theta_{t+1}\leftarrow\sum_{k\in S_{t}}\frac{n_{k}}{n}\theta_{t+1}^{k}
(k,\theta):
\quad\#
k
i=1,2,...,E
b
\theta\leftarrow
\left(\theta,b\right)
\quad\#
(\theta,b):
\quad\#
\left(x^{(1)},y^{(1)}\right),\left(x^{(2)},y^{(2)}\right),\ldots,\left(x^{(b)}%
,y^{(b)}\right)
\{\delta_{i}^{(j)}\}_{i=1}^{m}\sim\mathcal{N}\left(0,\sigma^{2}I\right)
x^{(j)},j=1,...,b
L\leftarrow[]
\quad\#
1\leq j\leq b
\widehat{x}^{(j)}
{x}^{(j)}
\{\delta_{i}^{(j)}\}_{i=1}^{m}
\{(\widehat{x}^{(j)}+\delta_{1}^{(j)},y^{(j)}),\ldots,(\widehat{x}^{(j)}+%
\delta_{m}^{(j)},y^{(j)})\}
L
\theta
L
G_{\theta}
\ell_{2}
r
\sigma=\{0.12,0.25,0.5\}
\epsilon=\{64,128,256\}
\sigma
\gamma_{\text{device}}
\gamma_{\text{device}}=0.1,0.5
\sigma=0.25,\epsilon=128
\gamma_{\text{device}}
\sigma=0.5
\epsilon=128
\sigma
\ell_{2}
\sigma,\epsilon
\sigma=0.25
\epsilon=128
\sigma=0.25
\epsilon=128
\sigma=0.5
\epsilon=128
\sigma=0.5
\epsilon=128
\sigma=0.25,\epsilon=128
1000
10\%
\gamma_{\text{device}}\ \text{in }(0,1)
\gamma_{\text{device}}
(1-\gamma_{\text{device}})
\gamma_{\text{device}}=0.1,0.5
m=2
2
0.01
0.01
30
60
20
1000
150
\alpha=0.001
0.1\%
\sigma=0.25
\epsilon=128
\sigma=0.25
\epsilon=128
\sigma=0.5
\epsilon=128
\sigma=0.5
\epsilon=128
\gamma_{\text{device}}=0.1,0.5
\sigma
\epsilon
\sigma=0.12
\epsilon=128
\sigma=0.12
\epsilon=128
\sigma=0.12
\epsilon=64
\sigma=0.12
\epsilon=64
\sigma=0.25
\epsilon=64
\sigma=0.25
\epsilon=64
\sigma=0.5
\epsilon=64
\sigma=0.5
\epsilon=64
\sigma=0.12
\epsilon=256
\sigma=0.12
\epsilon=256
\sigma=0.25
\epsilon=256
\sigma=0.25
\epsilon=256
\sigma=0.5
\epsilon=256
\sigma=0.5
\epsilon=256
