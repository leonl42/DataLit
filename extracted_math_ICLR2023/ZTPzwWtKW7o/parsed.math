12
f(\bm{x}):\bm{x}\in\mathbb{R}^{D}\rightarrow\bm{z}\in\mathbb{R}^{K}
\bm{z}:=[z_{1},...,z_{K}]
K
\bm{x}
f
C_{f}(\bm{x})=\operatorname*{arg\,max}_{i=1,...,K}z_{i}
y
\bm{x}
\hat{\bm{x}}
f
C_{f}(\hat{\bm{x}})\neq y
\hat{\bm{x}}
\bm{x}
\ell_{\infty}
\epsilon
\|\hat{\bm{x}}-\bm{x}\|_{\infty}\leq\epsilon
\ell_{\infty}
\ell_{p}
\hat{\bm{x}}
\hat{\bm{x}}=\operatorname*{arg\,max}_{\bm{x}^{\prime}}\mathcal{L}(f(\bm{x}^{%
\prime}),y),\quad\text{s.t.}\;\|\bm{x}^{\prime}-\bm{x}\|_{\infty}\leq\epsilon,
\mathcal{L}
f(\bm{x})
\mathcal{L}
\mathcal{L}_{ce}(f(\bm{x}),y)=-\log p_{y}
p_{y}=\nicefrac{{e^{z_{y}}}}{{\sum_{i=1}^{K}e^{z_{i}}}}
y
\mathcal{L}_{cw}(f(\bm{x}),y)=\max_{i\neq y}z_{i}-z_{y}
\hat{\bm{x}}_{t+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}\big{(}\hat{\bm{x}}_{t}%
+\alpha_{t}\cdot\mathrm{sign}(\nabla_{\bm{x}}\mathcal{L}(f(\hat{\bm{x}}_{t}),y%
))\big{)},
\mathcal{B}_{\epsilon}(\bm{x})=\{\bm{x}^{\prime}:\|\bm{x}^{\prime}-\bm{x}\|_{%
\infty}\leq\epsilon\}
\ell_{\infty}
\bm{x}
\epsilon
\Pi(\cdot)
\alpha_{t}
t
\hat{\bm{x}}_{0}
\mathcal{B}_{\epsilon}(\bm{x})
\alpha
\{f_{1},f_{2},f_{3}\}
\{f_{1},f_{2}\}/\{f_{3}\},\{f_{1},f_{3}\}/\{f_{2}\}
\{f_{2},f_{3}\}/\{f_{1}\}
\phi
\{f_{1},f_{2},f_{3}\}
\{f_{1},f_{2}\}/\{f_{3}\},\{f_{1},f_{3}\}/\{f_{2}\}
\{f_{2},f_{3}\}/\{f_{1}\}
\phi
m_{\phi}
\phi
\mathcal{L}
(\bm{x},y)
f
m_{\phi}
\hat{\bm{x}}_{t+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}\left(\hat{\bm{x}}_{t}+%
\alpha_{t}\cdot\bm{g}_{t}\right),\quad[\bm{g}_{t},\bm{h}_{t+1}]=m_{\phi}\left(%
\nabla_{t},\bm{h}_{t}\right),
\alpha_{t}
\nabla_{t}=\nabla_{\bm{x}}\mathcal{L}(f(\hat{\bm{x}}_{t}),y)
\mathcal{L}
\hat{\bm{x}}_{t}
\bm{h}_{t}
\bm{g}_{t}
\hat{\bm{x}}_{t}
\tanh
\bm{g}_{t}
\epsilon
m_{\phi}
\mathcal{F}
f
\mathcal{D}
(\bm{x},y)
\phi
\mathcal{J}(\phi;\mathcal{F},\mathcal{D})=\mathbb{E}_{f\sim\mathcal{F},(\bm{x}%
,y)\sim\mathcal{D}}\left[\sum_{t=1}^{T}w_{t}\mathcal{L}(f(\hat{\bm{x}}_{t}),y)%
\right],
\hat{\bm{x}}_{t}
m_{\phi}
w_{t}\in\mathbb{R}_{\geq 0}
t
T
w_{t}=\mathbf{1}[t=T]
w_{t}
m_{\phi}
\phi
f
(\bm{x},y)
\phi
\ell_{\infty}
\mathcal{B}_{\epsilon}(\bm{x})
\ell_{\infty}
\nabla_{\bm{x}^{\prime}}\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}(\bm{x}^{\prime})=I
I
m_{\phi}
\bm{g}_{t}
\mathcal{N}(\mathrm{sign}(\nabla_{t}),\frac{1}{2\lambda_{t}})
\mathrm{sign}(\nabla_{t})
\nicefrac{{1}}{{2\lambda_{t}}}
\lambda_{t}
\ell_{2}
\lambda_{t}\|\bm{g}_{t}-\mathrm{sign}(\nabla_{t})\|_{2}^{2}
\mathcal{J}(\phi;\mathcal{F},\mathcal{D})=\mathbb{E}_{f\sim\mathcal{F},(\bm{x}%
,y)\sim\mathcal{D}}\left[\sum_{t=1}^{T}\Big{(}w_{t}\mathcal{L}(f(\hat{\bm{x}}_%
{t}),y)-\lambda_{t}\|\bm{g}_{t}-\mathrm{sign}(\nabla_{t})\|_{2}^{2}\Big{)}%
\right],
\{\lambda_{t}\}_{t=1}^{T}
\phi
\mathcal{D}
(\bm{x},y)
\mathcal{F}=\{f_{j}\}_{j=1}^{N}
\mathcal{J}
T
B
\beta
\gamma
\mu
\phi
N-n
\mathcal{F}
\hat{\mathcal{F}}
{\color[rgb]{1,.5,0}\bar{\mathcal{F}}}=\mathcal{F}\backslash{\color[rgb]{0,0,1%
}\hat{\mathcal{F}}}
n
f_{r}
\hat{\mathcal{F}}
\mathcal{B}_{r}=\{(\bm{x}^{r_{i}},y^{r_{i}})\}_{i=1}^{B}
\mathcal{D}
(\bm{x}^{r_{i}},y^{r_{i}})\in\mathcal{B}_{r}
\hat{\bm{x}}_{t}^{r_{i}}
\phi
f_{r}
t=1
T
\mathcal{J}(\phi;{\color[rgb]{0,0,1}\hat{\mathcal{F}}},\mathcal{D})
f_{r}
\hat{\mathcal{F}}
\mathcal{B}_{r}
\phi^{\prime}=\phi+\beta\nabla_{\phi}\mathcal{J}(\phi;{\color[rgb]{0,0,1}\hat{%
\mathcal{F}}},\mathcal{D})
f_{e}
{\color[rgb]{1,.5,0}\bar{\mathcal{F}}}
\mathcal{B}_{e}=\{(\bm{x}^{e_{i}},y^{e_{i}})\}_{i=1}^{B}
\mathcal{D}
(\bm{x}^{e_{i}},y^{e_{i}})\in\mathcal{B}_{e}
\hat{\bm{x}}_{t}^{e_{i}}
\phi^{\prime}
f_{e}
t=1
T
\mathcal{J}(\phi^{\prime};{\color[rgb]{1,.5,0}\bar{\mathcal{F}}},\mathcal{D})
f_{e}
{\color[rgb]{1,.5,0}\bar{\mathcal{F}}}
\mathcal{B}_{e}
\phi\leftarrow\phi+\gamma\nabla_{\phi}(\mathcal{J}(\phi;{\color[rgb]{0,0,1}%
\hat{\mathcal{F}}},\mathcal{D})+\mu\mathcal{J}(\phi^{\prime};{\color[rgb]{%
1,.5,0}\bar{\mathcal{F}}},\mathcal{D}))
N
\mathcal{F}
\mathcal{F}
\mathcal{F}
\hat{\mathcal{F}}
N-n
\bar{\mathcal{F}}
n
\mathcal{J}(\phi;{\color[rgb]{0,0,1}\hat{\mathcal{F}}},\mathcal{D})
\phi
\mathcal{J}(\phi;{\color[rgb]{1,.5,0}\bar{\mathcal{F}}},\mathcal{D})
\phi
\phi^{\prime}=\phi+\beta\nabla_{\phi}\mathcal{J}(\phi;{\color[rgb]{0,0,1}\hat{%
\mathcal{F}}},\mathcal{D}),
\beta
\phi^{\prime}
\mathcal{J}(\phi^{\prime};{\color[rgb]{1,.5,0}\bar{\mathcal{F}}},\mathcal{D})
\max\limits_{\phi}\mathcal{J}(\phi;{\color[rgb]{0,0,1}\hat{\mathcal{F}}},%
\mathcal{D})+\mu\mathcal{J}(\phi+\beta\nabla_{\phi}\mathcal{J}(\phi;{\color[%
rgb]{0,0,1}\hat{\mathcal{F}}},\mathcal{D});{\color[rgb]{1,.5,0}\bar{\mathcal{F%
}}},\mathcal{D}),
\mu
\ell_{\infty}
\ell_{2}
T=20
\alpha=2/255
100
20
w_{t}=1
\lambda_{t}=0.1
\lambda_{t}
\beta=0.0001
\gamma=0.001
\mu=1.0
B=32
\mathcal{L}
\epsilon=8/255
\lambda_{t}:=\lambda=0.0
0.01
0.1
0.5
1.0
\lambda>0
\lambda=0
\lambda
\lambda=0.1
T=20
T=20
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\lambda
\lambda
10
\mathcal{L}
\hat{\bm{x}}_{0}
1,000
2,000
5,000
10,000
1
100
20
20
20
20
20
\epsilon=0.031
\epsilon=8/255
\bm{\Delta}
\epsilon=0.031
\epsilon=8/255
\bm{\Delta}
\textrm{PGD}_{\textrm{CE}}
\textrm{PGD}_{\textrm{CW}}
\bm{\Delta}
\epsilon
\textrm{PGD}_{\textrm{CE}}
\bm{\Delta}
12
100
2/255
20
9
2
100
100
20
12
\epsilon=8/255
\epsilon=4/255
T=10
\bm{g}_{t}
\mathcal{L}
\hat{\bm{x}}_{t}
\bm{g}_{t}
\mathcal{L}
p_{y}
\hat{\bm{x}}_{t}
p(y|\bm{g}_{t})=\frac{1}{p_{y}}
p(y|\bm{g}_{t})
p(y|\bm{g}_{t})
\bm{g}_{t}
p(\bm{g}_{t})\sim\mathcal{N}(\mathrm{sign}(\nabla_{t}),\frac{1}{2\lambda_{t}})
\bm{g}_{t}
p(\bm{g}_{t}|y)\sim p(y|\bm{g}_{t})p(\bm{g}_{t}).
\displaystyle\operatorname*{arg\,max}\log p(\bm{g}_{t}|y)=\operatorname*{arg\,%
max}\{-\log p_{y}+\lambda_{t}\|\bm{g}_{t}-\mathrm{sign}(\nabla_{t})\|_{2}^{2}\}
\displaystyle\operatorname*{arg\,max}\log p(\bm{g}_{t}|y)=
\displaystyle\operatorname*{arg\,max}\{-\log p_{y}+\lambda_{t}\|\bm{g}_{t}-%
\mathrm{sign}(\nabla_{t})\|_{2}^{2}\}
\displaystyle=\operatorname*{arg\,max}\{\mathcal{L}(f(\hat{\bm{x}}_{t}),y)-%
\mathrm{sign}(\nabla_{t})\|_{2}^{2}\}.
\displaystyle=
\displaystyle\operatorname*{arg\,max}\{\mathcal{L}(f(\hat{\bm{x}}_{t}),y)-%
\mathrm{sign}(\nabla_{t})\|_{2}^{2}\}.
\hat{\bm{x}}_{t+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}\big{(}\hat{\bm{x}}_{t}%
+\alpha_{t}\cdot\mathrm{sign}(\nabla_{\bm{x}}\mathcal{L}(f(\hat{\bm{x}}_{t}),y%
))\big{)},
\mathcal{B}_{\epsilon}(\bm{x})=\{\bm{x}^{\prime}:\|\bm{x}^{\prime}-\bm{x}\|_{%
\infty}\leq\epsilon\}
\ell_{\infty}
\bm{x}
\epsilon
\Pi(\cdot)
\alpha_{t}
t
\mathcal{L}
\mathcal{L}_{ce}(f(\bm{x}),y)=-\log p_{y}
p_{y}=\nicefrac{{e^{z_{y}}}}{{\sum_{i=1}^{K}e^{z_{i}}}}
y
\mathcal{L}_{cw}(f(\bm{x}),y)=\max_{i\neq y}z_{i}-z_{y}
\bm{g}_{t+1}=\mu\cdot\bm{g}_{t}+\frac{\nabla_{\bm{x}}\mathcal{L}(f(\hat{\bm{x}%
}_{t}),y)}{\|\nabla_{\bm{x}}\mathcal{L}(f(\hat{\bm{x}}_{t}),y)\|_{1}};\;\hat{%
\bm{x}}_{t+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}(\hat{\bm{x}}_{t}+\alpha%
\cdot\mathrm{sign}(\bm{g}_{t+1})),
\alpha
\mu
\bm{x}_{t}^{nes}=\hat{\bm{x}}_{t}+\alpha\cdot\mu\cdot\bm{g}_{t};\;\bm{g}_{t+1}%
=\mu\cdot\bm{g}_{t}+\frac{\nabla_{\bm{x}}\mathcal{L}(f(\bm{x}_{t}^{nes}),y)}{%
\|\nabla_{\bm{x}}\mathcal{L}(f(\bm{x}^{nes}_{t}),y)\|_{1}};\hat{\bm{x}}_{t+1}=%
\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}(\hat{\bm{x}}_{t}+\alpha\cdot\mathrm{sign}%
(\bm{g}_{t+1})).
\bm{g}^{\prime}_{t}=\mathrm{G}\left(\mathcal{L}(f(\hat{\bm{x}}_{t}),y)\right);%
\;\;\hat{\bm{x}}_{t+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}\left(\hat{\bm{x}}_%
{t}+\alpha_{t}\cdot\bm{g}^{\prime}_{t}\right),
\mathrm{G}
\mathcal{L}_{DLR}(f(\bm{x}),y)=-\frac{z_{y}-\max_{i\neq y}z_{i}}{z_{\pi_{1}}-z%
_{\pi_{3}}}\text{,}
z
\pi
z
\textrm{APGD}_{\textrm{CE}}
\textrm{APGD}_{\textrm{DLR}}
\hat{\bm{x}}_{k+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}\big{(}\hat{\bm{x}}_{k}%
+\alpha_{t}\cdot\mathrm{sign}(\mathrm{v_{ODS}}(\hat{\bm{x}}_{k},f,\mathrm{w}_{%
d}))\big{)},\;\mathrm{v_{ODS}}(\hat{\bm{x}}_{k},f,\mathrm{w}_{d})=\frac{\nabla%
_{\bm{x}}(\mathrm{w}_{d}^{T}f(\hat{\bm{x}}_{k}))}{\|\nabla_{\bm{x}}(\mathrm{w}%
_{d}^{T}f(\hat{\bm{x}}_{k}))\|_{2}},
\mathrm{v_{ODS}}(\cdot)
\mathrm{w}_{d}
[-1,1]^{C}
9
\hat{\bm{x}}_{t+1}=\Pi_{\mathcal{B}_{\epsilon}(\bm{x})}\big{(}\hat{\bm{x}}_{t}%
-\alpha_{t}\cdot\mathrm{sign}(\nabla_{\bm{x}}\mathcal{L}(f(\hat{\bm{x}}_{t}),y%
^{c}))\big{)},
y^{c}
\ell_{2}
\ell_{\infty}
\ell_{2}
\epsilon=0.1
T=20
\alpha=0.025
20
\ell_{2}
\ell_{2}
\ell_{2}
\pm
\pm
\pm
\pm
\mu
\mu
\mu
\mu
1.0
\mu
\mu
\mu
m
n
m
n
