132
\bullet
\bullet
\bullet
\ell(\mathbf{w},\mathbf{x}_{n},\mathbf{y}_{n})
\left\{\mathbf{x}_{n},\mathbf{y}_{n}\right\}_{n=1}^{N}
N
x_{n}\in X
T:X\rightarrow X
\eta
B
\displaystyle\mathbf{w}_{t+1}=\mathbf{w}_{t}-\eta\frac{1}{B}\sum_{n\in\mathcal%
{B}\left(k\left(t\right)\right)}\nabla_{\mathbf{w}}\ell\left(\mathbf{w}_{t},T(%
\mathbf{x}_{n}),\mathbf{y}_{n}\right)
\displaystyle\mathbf{w}_{t+1}=\mathbf{w}_{t}-\eta\frac{1}{B}\sum_{n\in\mathcal%
{B}\left(k\left(t\right)\right)}\nabla_{\mathbf{w}}\ell\left(\mathbf{w}_{t},T(%
\mathbf{x}_{n}),\mathbf{y}_{n}\right)
k\left(t\right)
\left[N/B\right]\triangleq\left\{1,\dots,N/B\right\}
\mathcal{B}\left(k\right)
k
B
N
M
T_{i}
i\in\left[M\right]
\displaystyle\mathbf{w}_{t+1}=\mathbf{w}_{t}-\eta\frac{1}{M\cdot B}\sum_{i=1}^%
{M}\sum_{n\in\mathcal{B}\left(k\left(t\right)\right)}\nabla_{\mathbf{w}}\ell%
\left(\mathbf{w}_{t},T_{i}(\mathbf{x}_{n}),\mathbf{y}_{n}\right)
\displaystyle\mathbf{w}_{t+1}=\mathbf{w}_{t}-\eta\frac{1}{M\cdot B}\sum_{i=1}^%
{M}\sum_{n\in\mathcal{B}\left(k\left(t\right)\right)}\nabla_{\mathbf{w}}\ell%
\left(\mathbf{w}_{t},T_{i}(\mathbf{x}_{n}),\mathbf{y}_{n}\right)
M\cdot B
B
M
M\cdot B
M
f\left(\mathbf{w}\right)=\frac{1}{N}\sum_{n=1}^{N}\ell\left(\mathbf{w},\mathbf%
{x}_{n},\mathbf{y}_{n}\right)\,,
\left\{\mathbf{x}_{n},\mathbf{y}_{n}\right\}_{n=1}^{N}
N
\ell
B
\mathbf{w}_{t+1}=\mathbf{w}_{t}-\eta\frac{1}{B}\sum_{n\in\mathcal{B}\left(k%
\left(t\right)\right)}\nabla_{\mathbf{w}}\ell\left(\mathbf{w}_{t},\mathbf{x}_{%
n},\mathbf{y}_{n}\right)\,.
B
N
k\left(t\right)
\left\{1,\dots,N/B\right\}
\mathbf{w}^{*}
\forall n:\nabla_{\mathbf{w}}\ell\left(\mathbf{w}^{*},\mathbf{x}_{n},\mathbf{y%
}_{n}\right)=0
\mathbf{w}^{*}
\mathbf{w}_{t+1}=\mathbf{w}_{t}-\eta\frac{1}{B}\sum_{n\in\mathcal{B}\left(k%
\left(t\right)\right)}\mathbf{H}_{n}\mathbf{w}_{t}\,\,,
\mathbf{w}^{*}=0
\mathbf{H}_{n}\triangleq\nabla_{\mathbf{w}}^{2}\ell\left(\mathbf{w},\mathbf{x}%
_{n},\mathbf{y}_{n}\right)
\mathbf{H}_{n}
k
\left\langle\mathbf{H}\right\rangle_{k}\triangleq\frac{1}{B}\sum_{n\in\mathcal%
{B}\left(k\right)}\mathbf{H}_{n}
\left\{\left\langle\mathbf{H}\right\rangle_{k}\right\}_{k=1}^{N/B}
\lambda_{\max}=\max_{k\in\left[N/B\right]}\max_{\forall\mathbf{v}:\left\|%
\mathbf{v}\right\|=1}\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle_{k}%
\mathbf{v}.
\lambda_{\max}
\lambda_{\max}<\frac{2}{\eta}\,.
\lambda_{\max}
\lambda_{\max}
\mathbf{H}_{n}
\lambda_{\max}
\left<\mathbf{H}\right>_{k}
\mathbf{H}_{n}
\lambda_{\max}
\mathbf{H}_{n}
\lambda_{\max}
T\left(x_{n}\right)
1/\sqrt{B}
B
\lambda_{\max}
T
\displaystyle{\mathbb{E}}_{n\in\left[N\right]}\left[\mathrm{Corr}\left(\nabla_%
{\mathbf{w}}^{(n)},\nabla_{\mathbf{w}}\ell\left(\mathbf{w},T\left(x_{n}\right)%
,y_{n}\right)\right)\right]
\displaystyle{\mathbb{E}}_{n\in\left[N\right]}\left[\mathrm{Corr}\left(\nabla_%
{\mathbf{w}}^{(n)},\nabla_{\mathbf{w}}\ell\left(\mathbf{w},T\left(x_{n}\right)%
,y_{n}\right)\right)\right]
\displaystyle>{\mathbb{E}}_{n,m\in\left[N\right],\,n\neq m}\left[\mathrm{Corr}%
\left(\nabla_{\mathbf{w}}^{(n)},\nabla_{\mathbf{w}}^{(m)}\right)\right]
\displaystyle>{\mathbb{E}}_{n,m\in\left[N\right],\,n\neq m}\left[\mathrm{Corr}%
\left(\nabla_{\mathbf{w}}^{(n)},\nabla_{\mathbf{w}}^{(m)}\right)\right]
\nabla_{\mathbf{w}}^{(n)}\triangleq\nabla_{\mathbf{w}}\ell\left(\mathbf{w},x_{%
n},y_{n}\right)
T
\rho
\rho\left(x,T\left(x\right)\right)
\rho\left(x,y\right)
\rho\left(z,w\right)
0
5
93
9.63\%
63.24\%
95.43\%
\rho\left(x,T\left(x\right)\right)
0.99\pm 0
0.56\pm 0.09
0.13\pm 0.13
\rho\left(x,T\left(x\right)\right)
0.99\pm 0
0.51\pm 0.08
0.09\pm 0.08
\rho\left(x,y\right)
0.99\pm 0
0.42\pm 0.06
0.04\pm 0.03
\rho\left(z,w\right)
0.11\pm 0.01
0.04\pm 0.06
0\pm 0.02
5
93
\left<\mathbf{H}\right>_{k}
\lambda_{\max}
L^{2}
L^{2}
B=64
M=1
M\in\{2,4,8,16,32\}
L^{2}
B=64
M=1
M\in\{2,4,8,16,32\}
\times
M\cdot B
M
50,000
10,000
32\times 32
10
100
4
32\times 32
0.5
9\cdot 9\cdot 2=162
M\approx 10
\times 30^{2}
B=64
M\in\{2,4,8,16,32\}
64\cdot M
B=64
M\in\{2,4,8,16,32\}
64\cdot M
B=64
M\in\{2,4,8,16,32\}
64\cdot M
M
M
M\cdot B
94.15\%
23
93.07\%
100
0.5\%
93.07\%
8\%
100\%
[3/4,4/3]
p=0.5
0.1
10
30,60,
80
90
10^{-4}
M=4
M=8
4\%
2\%
75.7\%
35
0.6\%
90
30-60
0.1
0.1
76.86\%
15,20,
22
75.7\%
23
p=0.4
p=0.25
M=10
0.2
M
M
M
B=256
M=4
M=10
M=1
1.43\pm 0.13
M=4
1.47\pm 0.13
M=10
1.46\pm 0.14
B=256
M=4
M=10
M=1
1.43\pm 0.13
M=4
1.47\pm 0.13
M=10
1.46\pm 0.14
40
M=4
16
M=10
40
64
M=4
M=10
B=256
32
\ell_{2}
{\mathbb{E}}\mathbf{w}_{t+1}=\left(\mathbf{I}-\eta\left\langle\mathbf{H}\right%
\rangle\right){\mathbb{E}}\mathbf{w}_{t}\,,
\left\langle\mathbf{H}\right\rangle\triangleq\frac{1}{N}\sum_{n=1}^{N}\mathbf{%
H}_{n}
\bar{\lambda}_{\max}<\frac{2}{\eta}\>,
\bar{\lambda}_{\max}
\left\langle\mathbf{H}\right\rangle
\mathbf{H}_{n}=0
k
\lambda_{\max}=\max_{\forall\mathbf{v}:\left\|\mathbf{v}\right\|=1}\mathbf{v}^%
{\top}\left\langle\mathbf{H}\right\rangle_{k}\mathbf{v}\,,
k
k
\bar{\lambda}_{\max}=\lambda_{\max}
\bar{\lambda}_{\max}=\lambda_{\max}
\displaystyle\mathbf{w}_{t+1}^{\top}\mathbf{w}_{t+1}=\mathbf{w}_{t}^{\top}%
\left(\mathbf{I}-\eta\left\langle\mathbf{H}\right\rangle_{k\left(t\right)}%
\right)^{\top}\left(\mathbf{I}-\eta\left\langle\mathbf{H}\right\rangle_{k\left%
(t\right)}\right)\mathbf{w}_{t}\,.
\displaystyle\mathbf{w}_{t+1}^{\top}\mathbf{w}_{t+1}
\displaystyle=\mathbf{w}_{t}^{\top}\left(\mathbf{I}-\eta\left\langle\mathbf{H}%
\right\rangle_{k\left(t\right)}\right)^{\top}\left(\mathbf{I}-\eta\left\langle%
\mathbf{H}\right\rangle_{k\left(t\right)}\right)\mathbf{w}_{t}\,.
\displaystyle=\mathbf{w}_{t}^{\top}\left(\mathbf{I}-2\eta\left\langle\mathbf{H%
}\right\rangle_{k\left(t\right)}+\eta^{2}\left\langle\mathbf{H}\right\rangle_{%
k\left(t\right)}\left\langle\mathbf{H}\right\rangle_{k\left(t\right)}\right)%
\mathbf{w}_{t}\,.
\displaystyle=\mathbf{w}_{t}^{\top}\left(\mathbf{I}-2\eta\left\langle\mathbf{H%
}\right\rangle_{k\left(t\right)}+\eta^{2}\left\langle\mathbf{H}\right\rangle_{%
k\left(t\right)}\left\langle\mathbf{H}\right\rangle_{k\left(t\right)}\right)%
\mathbf{w}_{t}\,.
\left\langle\mathbf{H}^{2}\right\rangle\triangleq\frac{1}{N/B}\sum_{k=0}^{N/B}%
\left\langle\mathbf{H}\right\rangle_{k}\left\langle\mathbf{H}\right\rangle_{k}\,.
\displaystyle{\mathbb{E}}\left\|\mathbf{w}_{t+1}\right\|^{2}={\mathbb{E}}\left%
[\mathbf{w}_{t+1}^{\top}\left(\mathbf{I}-2\eta\left\langle\mathbf{H}\right%
\rangle+\eta^{2}\left\langle\mathbf{H}^{2}\right\rangle\right)\mathbf{w}_{t}%
\right]\,.
\displaystyle{\mathbb{E}}\left\|\mathbf{w}_{t+1}\right\|^{2}
\displaystyle={\mathbb{E}}\left[\mathbf{w}_{t+1}^{\top}\left(\mathbf{I}-2\eta%
\left\langle\mathbf{H}\right\rangle+\eta^{2}\left\langle\mathbf{H}^{2}\right%
\rangle\right)\mathbf{w}_{t}\right]\,.
\mathbf{H}_{n}
\mathbf{z}
\left\langle\mathbf{H}\right\rangle
\left\langle\mathbf{H}^{2}\right\rangle
\mathbf{H}_{n}
\forall n
\mathcal{V}\triangleq\left\{\mathbf{v}\in\mathbb{R}^{d}|\left\|\mathbf{v}%
\right\|=1,\text{$\left\langle\mathbf{H}\right\rangle$}\mathbf{z}=0\right\}
\bar{\mathcal{\mathcal{V}}}
\max_{\mathbf{v}\in\mathcal{\bar{V}}}\mathbf{v}^{\top}\left(\mathbf{I}-2\eta%
\left\langle\mathbf{H}\right\rangle+\eta^{2}\left\langle\mathbf{H}^{2}\right%
\rangle\right)\mathbf{v}<1\,.
B
\forall\mathbf{v}\in\bar{\mathcal{\mathcal{V}}}:
\displaystyle\begin{split}\mathbf{v}^{\top}\left\langle\mathbf{\mathbf{H}}^{2}%
\right\rangle\mathbf{v}&=\frac{1}{N}\sum_{k=0}^{N/B}\sum_{n\in\mathcal{B}\left%
(k\right)}\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle_{k}\mathbf{H}_{%
m}\mathbf{v}\\
&\leq\frac{1}{N}\sum_{n=1}^{N}\lambda_{\max}\mathbf{v}^{\top}\mathbf{H}_{n}%
\mathbf{v}\\
&=\lambda_{\max}\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle\mathbf{v}%
\,.\end{split}
\displaystyle\begin{split}\mathbf{v}^{\top}\left\langle\mathbf{\mathbf{H}}^{2}%
\right\rangle\mathbf{v}&=\frac{1}{N}\sum_{k=0}^{N/B}\sum_{n\in\mathcal{B}\left%
(k\right)}\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle_{k}\mathbf{H}_{%
m}\mathbf{v}\\
&\leq\frac{1}{N}\sum_{n=1}^{N}\lambda_{\max}\mathbf{v}^{\top}\mathbf{H}_{n}%
\mathbf{v}\\
&=\lambda_{\max}\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle\mathbf{v}%
\,.\end{split}
\lambda_{\max}>\bar{\lambda}_{\max}
\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle^{2}\mathbf{v}\leq\lambda_%
{\max}\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle\mathbf{v}\,.
\forall\mathbf{v}\in\bar{\mathcal{\mathcal{V}}}:
\displaystyle\mathbf{v}^{\top}\left[\left(\mathbf{I}-2\eta\left\langle\mathbf{%
H}\right\rangle\right)+\eta^{2}\left\langle\mathbf{H}^{2}\right\rangle\right]%
\mathbf{v}
\displaystyle\mathbf{v}^{\top}\left[\left(\mathbf{I}-2\eta\left\langle\mathbf{%
H}\right\rangle\right)+\eta^{2}\left\langle\mathbf{H}^{2}\right\rangle\right]%
\mathbf{v}
\displaystyle=1-2\eta\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle%
\mathbf{v}+\eta^{2}\mathbf{v}^{\top}\left\langle\mathbf{H}^{2}\right\rangle%
\mathbf{v}\,
\displaystyle=
\displaystyle 1-2\eta\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle%
\mathbf{v}+\eta^{2}\mathbf{v}^{\top}\left\langle\mathbf{H}^{2}\right\rangle%
\mathbf{v}\,
\displaystyle\overset{\left(1\right)}{\leq}1-2\eta\mathbf{v}^{\top}\left%
\langle\mathbf{H}\right\rangle\mathbf{v}+\eta^{2}\lambda_{\max}\mathbf{v}^{%
\top}\left\langle\mathbf{H}\right\rangle\mathbf{v}
\displaystyle\overset{\left(1\right)}{\leq}
\displaystyle 1-2\eta\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle%
\mathbf{v}+\eta^{2}\lambda_{\max}\mathbf{v}^{\top}\left\langle\mathbf{H}\right%
\rangle\mathbf{v}
\displaystyle=1-\eta\left(2-\eta\lambda_{\max}\right)\mathbf{v}^{\top}\left%
\langle\mathbf{H}\right\rangle\mathbf{v}\,,
\displaystyle=
\displaystyle 1-\eta\left(2-\eta\lambda_{\max}\right)\mathbf{v}^{\top}\left%
\langle\mathbf{H}\right\rangle\mathbf{v}\,,
\left(1\right)
1
\mathcal{P}_{\bar{\mathcal{\mathcal{V}}}}
\bar{\mathcal{\mathcal{V}}}
\lambda_{\min}\triangleq\min_{\forall\mathbf{v}\in\bar{\mathcal{\mathcal{V}}}}%
\mathbf{v}^{\top}\left\langle\mathbf{H}\right\rangle\mathbf{v}
\left\langle\mathbf{H}\right\rangle
{\mathbb{E}}\left\|\mathcal{P}_{\bar{\mathcal{\mathcal{V}}}}\mathbf{w}_{t}%
\right\|^{2}\leq\left(1-\eta\left(2-\eta\lambda_{\max}\right)\lambda_{\min}%
\right)^{t}{\mathbb{E}}\left\|\mathcal{P}_{\bar{\mathcal{\mathcal{V}}}}\mathbf%
{w}_{0}\right\|^{2}\,.
M
M
