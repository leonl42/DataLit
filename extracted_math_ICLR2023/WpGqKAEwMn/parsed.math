x_{0}\to x_{1}\to\dots\to x_{t}\to...
\pi(x)
p(\hat{x}|x)
x
\hat{x}
x_{t}
x_{t}
\hat{x}_{t}
x_{t+1}
p(x_{t+1}|\hat{x}_{t})=\frac{p(\hat{x}_{t}|x_{t+1})\pi(x_{t+1})}{\int p(\hat{x%
}_{t}|\tilde{x}_{t+1})\pi(\tilde{x}_{t+1})d\tilde{x}_{t+1}}.
x_{t+1}
\begin{split}p(x_{t+1}|x_{t})&=\int p(x_{t+1}|\hat{x}_{t})p(\hat{x}_{t}|x_{t})%
d\hat{x}_{t}\\
&=\int\frac{p(\hat{x}_{t}|x_{t+1})p(\hat{x}_{t}|x_{t})}{\int p(\hat{x}_{t}|%
\tilde{x}_{t+1})\pi(\tilde{x}_{t+1})d\tilde{x}_{t+1}}\pi(x_{t+1})d\hat{x}_{t}.%
\end{split}
\tilde{x}_{t+1}
\pi(x)
p(x_{t+1}|x_{t})\pi(x_{t})=p(x_{t}|x_{t+1})\pi(x_{t+1}).
\pi(x)
p(\hat{x}|x)
(x,\hat{x})
p(\hat{x}|x)
p(x|\hat{x})
p(x,\hat{x})=p(\hat{x}|x)\pi(x)
q(x_{0},\dots,x_{T})
x_{0}\sim q_{d}(x_{0})
x_{T}\sim q_{n}(x_{T})
q_{d}(x)
q_{n}(x_{T})
q(x_{0},\dots,x_{T})=q_{d}(x_{0})\prod_{t=1}^{T}q(x_{t}|x_{t-1})
q(x_{t}|x_{t-1})=T_{q_{n}}(x_{t}|x_{t-1};\beta_{t})
\beta_{t}
q_{n}
\int T_{q_{n}}(y|x)q_{n}(x)dx=q_{n}(y)
t=T
q_{d}(x)
q_{n}(x)
p(x_{0},\dots,x_{T})
p(x_{0},\dots,x_{T})=p(x_{T})\prod_{t=1}^{T}p(x_{t-1}|x_{t})
p(x_{T})=q_{n}(x_{T})
p(x_{0})
x_{t>0}
K
L=-\int q_{d}(x_{0})\log{p(x_{0})}dx_{0}
L\geq K=\sum_{t=1}^{T}\int q(x_{0},\dots,x_{T})\log\left[\frac{p(x_{t-1}|x_{t}%
)}{q(x_{t}|x_{t-1})}\right]dx_{0}\dots dx_{T}-H_{q_{n}}
H_{q_{n}}
q_{n}
q(x_{t-1}|x_{t})\equiv\frac{q(x_{t}|x_{t-1})q(x_{t-1})}{\int q(x_{t}|\tilde{x}%
_{t-1})q(\tilde{x}_{t-1})d\tilde{x}_{t-1}}=\frac{q(x_{t}|x_{t-1})q(x_{t-1})}{q%
(x_{t})}
q(x_{t-1})
q(x_{t})
t-1
t
K
K=-\sum_{t=1}^{T}\mathbb{E}_{x_{t}\sim q}D_{KL}\left[q(x_{t-1}|x_{t})||p(x_{t-%
1}|x_{t})\right]+C_{q}
D_{KL}
C_{q}
K
p(x_{t-1}|x_{t})=q(x_{t-1}|x_{t})=\frac{q(x_{t}|x_{t-1})q(x_{t-1})}{\int q(x_{%
t}|\tilde{x}_{t-1})q(\tilde{x}_{t-1})d\tilde{x}_{t-1}}.
t-1
q(x_{t}|x_{t-1})=T_{q_{n}}(x_{t}|x_{t-1};\beta_{t})
t-1
q(x_{t-1})
t-1
p_{t-1}(x|y)
t-1
q_{t-1}(x)
x_{T}\to\hat{x}_{T}\to x_{T-1}\to\dots\to x_{t}\to\hat{x}_{t}\to x_{t-1}\to%
\dots\to x_{0}
x_{T}\sim q_{n}(x_{T})
\hat{x}_{t}
x_{t}
T_{q_{n}}(\hat{x}_{t}|x_{t};\beta_{t})
\hat{x}_{t}\to x_{t-1}
p_{t-1}
t-1
p_{s,t-1}(x_{t-1}|x_{t})
\begin{split}p_{s,t-1}(x_{t-1}|x_{t})&=\int p_{t-1}(x_{t-1}|\hat{x}_{t})T_{q_{%
n}}(\hat{x}_{t}|x_{t};\beta_{t})d\hat{x}_{t}\\
&=\int\frac{T_{q_{n}}(\hat{x}_{t}|x_{t-1};\beta_{t})T_{q_{n}}(\hat{x}_{t}|x_{t%
};\beta_{t})}{\int T_{q_{n}}(\hat{x}_{t}|\tilde{x}_{t-1};\beta_{t})q_{t-1}(%
\tilde{x}_{t-1})d\tilde{x}_{t-1}}q_{t-1}(x_{t-1})d\hat{x}_{t}.\end{split}
q_{t-1}
p_{s,t-1}(x_{t}|x_{t-1})q_{t-1}(x_{t-1})=p_{s,t-1}(x_{t-1}|x_{t})q_{t-1}(x_{t}).
p_{s,0}
q_{0}(x)=q_{d}(x)
\pi(x)
p_{s}(x_{0})
\begin{split}p_{s}(x_{0})&=\int p_{s,0}(x_{0}|x_{1})\dots p_{s,T-1}(x_{T-1}|x_%
{T})q_{n}(x_{T})dx_{1\dots T}\\
&=q_{d}(x_{0})\int p_{s,0}(x_{1}|x_{0})\frac{q_{1}(x_{1})}{q_{d}(x_{1})}\dots p%
_{s,T-1}(x_{T}|x_{T-1})\frac{q_{n}(x_{T})}{q_{T-1}(x_{T})}dx_{1\dots T}.\end{split}
p_{s}(x_{0})
q_{d}(x_{0})
x_{T}
x_{T-1}
x_{1}
x_{T}
\int p_{s,T-1}(x_{T}|x_{T-1})\frac{q_{n}(x_{T})}{q_{T-1}(x_{T})}dx_{T}=\int%
\frac{T(\hat{x}|x_{T-1};\beta_{T})}{q_{T}(\hat{x})}\int T(\hat{x}|x_{T};\beta_%
{T})q_{n}(x_{T})dx_{T}d\hat{x}.
q_{n}
T_{q_{n}}
q_{T}(x)=q_{n}(x)
\hat{x}
1
x_{T-1}
\hat{x}
\int p_{s,T-2}(x_{T-1}|x_{T-2})\frac{q_{T-1}(x_{T-1})}{q_{T-2}(x_{T-1})}dx_{T-%
1}=\int\frac{T(\hat{x}|x_{T-2};\beta_{T-1})}{q_{T-1}(\hat{x})}\int T(\hat{x}|x%
_{T-1};\beta_{T-1})q_{T-1}(x_{T-1}).
q_{T-1}
\{\beta_{t}\}
q_{0}=q_{d}
q_{t>0}=q_{n}
p_{0}
p_{0}
\beta_{T-1}
q_{T-1}
q_{T-1}(\hat{x})\approx\int dx_{T-1}T(\hat{x}|x_{T-1};\beta_{T-1})q_{T-1}(x_{T%
-1}),
p_{s}(x_{0})\approx q_{d}(x_{0})
\{\beta_{t}\}
\beta_{t}
(x,y)
-0.5\leq x,y\leq 0.5
41\times 41
\sigma_{t}=0.03+0.04*(t/T)
0.07
p_{t}=0.01+0.99*(t/T)
T
\sigma_{t}=0.01+0.04*(t/T)
T
D_{KL}[q_{d}(x_{0})||p_{s}(x_{0})]
\max_{t}D_{KL}[q_{t+1}(x)||q_{t}(x)]
t
\beta_{t}=\beta_{min}+(\beta_{max}-\beta_{min})*t/T
\beta_{min}=0.0001,\beta_{max}=0.02
T\in[50,500]
T
\begin{split}K&=\sum_{t=1}^{T}\int q(x_{0},\dots,x_{T})\log\left[\frac{p(x_{t-%
1}|x_{t})}{q(x_{t}|x_{t-1})}\right]dx_{0}\dots dx_{T}-H_{q_{n}}\\
&=\sum_{t=1}^{T}\int q(x_{0},\dots,x_{T})\log\left[\frac{p(x_{t-1}|x_{t})q(x_{%
t-1})}{q(x_{t-1}|x_{t})q(x_{t})}\right]dx_{0}\dots dx_{T}-H_{q_{n}}\\
&=\sum_{t=1}^{T}\int q(x_{0},\dots,x_{T})\log\left[\frac{p(x_{t-1}|x_{t})}{q(x%
_{t-1}|x_{t})}\right]dx_{0}\dots dx_{T}+C_{q}\end{split}
C_{q}=\sum_{t=1}^{T}\int q(x_{0},\dots,x_{T})\log(q(x_{t-1})/q(x_{t}))-H_{q_{n}}
p
\int q(x_{0},\dots,x_{T})dx_{0}\dots dx_{t-1}dx_{t+2}\dots dx_{T}=q(x_{t}|x_{t%
-1})q(x_{t-1})
q(x_{t-1})=\int q(x_{t-1}|x_{t-2})\dots q(x_{1}|x_{0})q_{n}(x_{0})dx_{0}\dots
dx%
_{t-2}
t-1
\begin{split}K&=\sum_{t=1}^{T}\int q(x_{t}|x_{t-1})q(x_{t-1})\log\left[\frac{p%
(x_{t-1}|x_{t})}{q(x_{t-1}|x_{t})}\right]dx_{t-1}dx_{t}+C_{q}\\
&=-\sum_{t=1}^{T}\int q(x_{t-1}|x_{t})q(x_{t})\log\left[\frac{q(x_{t-1}|x_{t})%
}{p(x_{t-1}|x_{t})}\right]dx_{t-1}dx_{t}+C_{q}\\
&=-\mathbb{E}_{x_{t}\sim q}D_{KL}\left[q(x_{t-1}|x_{t})||p(x_{t-1}|x_{t})%
\right]]+C_{q}\end{split}
