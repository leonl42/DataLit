N
\mathcal{D}_{i}
i
\mathcal{D}=\bigcup_{i=1}^{N}\mathcal{D}_{i}
\underset{\boldsymbol{\mathcal{\omega}}}{\min}\left[{\mathcal{L}(\bf{%
\boldsymbol{\omega}})}\overset{def}{=}\sum_{i=1}^{N}{\frac{|\mathcal{D}_{i}|}{%
|\mathcal{D}|}{\mathcal{L}_{i}}(\bf{\boldsymbol{\omega}})}\right],
\mathcal{L}_{i}({\bf\boldsymbol{\omega}})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}%
}[{\ell}_{i}(f(x;{\bf\boldsymbol{\omega}}),y)]
i
f(x;{\bf\boldsymbol{\omega}})
x
{\bf\boldsymbol{\omega}}
{\ell}_{i}
i
|\mathcal{D}_{i}|
\mathcal{D}_{i}
|\mathcal{D}|
\mathcal{D}
\mathcal{D}
\{\mathcal{D}_{\textit{i}}\}^{N}_{i=1}
\mathcal{L}_{\bf cal}=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{p(%
y)\cdot e^{f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{\sum_{c}{p(c)%
\cdot e^{f(x;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right),
p(y)
y
f(x;{\bf\boldsymbol{\omega}})[c]
p(c)
p(m)
{p(m)\cdot e^{f(x;{\bf\boldsymbol{\omega}})[m]}}
\beta
\beta
\mathcal{L}_{\bf dis}=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\sum_{o\in\mathbb{O%
}}{q^{g}(o;x)\log\left[\frac{q(o;x)}{q^{g}(o;x)}\right]},
\text{where}\;q(o;x)=\frac{\exp(f(x;{\bf\boldsymbol{\omega}})[o])}{\sum_{c\in%
\mathbb{O}}{\exp(f(x;{\bf\boldsymbol{\omega}})[c])}}
o
q^{g}(o;x)=\frac{\exp(f(x;{\bf\boldsymbol{\omega}^{g}})[o])}{\sum_{c\in\mathbb%
{O}}{\exp(f(\it{x};{\bf\boldsymbol{\omega}^{g}})[c]}}
\mathbb{O}
\boldsymbol{\omega}^{g}
\mathcal{L}^{c}_{\bf logit}=\log\left(\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}%
\mathbb{I}({y\neq c})\cdot e^{f(x;\boldsymbol{\omega})[c]}\right),
\mathbb{I}
{y\neq c}
\mathcal{L}^{c}_{\bf logit}
p(c)
\mathcal{L}_{\bf logit}=\sum_{c}p(c)\cdot\mathcal{L}^{c}_{\bf logit}.
\beta=0.5
\beta=0.1
\beta=0.05
\beta=0.5
\beta=0.1
\beta=0.05
\beta=0.5
\beta=0.1
\beta=0.05
\beta=0.5
\beta=0.1
\beta=0.05
\pm 0.00
\pm 0.00
\pm 0.44
\pm 0.55
\pm 0.75
\pm 0.95
\pm 0.34
\pm 0.35
\pm 0.09
\pm 0.40
\pm 0.27
\pm 0.47
\pm 0.00
\pm 0.00
\pm 0.24
\pm 0.78
\pm 1.33
\pm 0.41
\pm 0.60
\pm 0.22
\pm 0.20
\pm 0.50
\pm 0.51
\pm 0.17
\pm 0.01
\pm 0.12
\pm 0.21
\pm 0.35
\pm 0.43
\pm 0.77
\pm 0.11
\pm 0.32
\pm 0.41
\pm 0.36
\pm 0.53
\pm 0.35
\pm 0.49
\pm 0.48
\pm 1.08
\pm 0.52
\pm 1.15
\pm 0.51
\pm 0.39
\pm 0.19
\pm 0.18
\pm 0.23
\pm 0.15
\pm 0.18
\pm 0.01
\pm 0.05
\pm 0.18
\pm 0.63
\pm 0.53
\pm 0.97
\pm 0.30
\pm 0.20
\pm 0.11
\pm 0.21
\pm 0.37
\pm 0.58
\pm 0.00
\pm 0.01
\pm 0.40
\pm 0.68
\pm 0.35
\pm 0.57
\pm 0.20
\pm 0.25
\pm 0.06
\pm 0.43
\pm 0.25
\pm 0.20
\pm 0.00
\pm 0.00
\pm 0.42
\pm 1.33
\pm 0.32
\pm 1.05
\pm 0.25
\pm 0.19
\pm 0.14
\pm 1.42
\pm 1.02
\pm 0.23
\pm 0.04
\pm 0.17
\pm 0.71
\pm 0.19
\pm 0.22
\pm 0.27
\pm 0.15
\pm 0.50
\pm 0.19
\pm 1.05
\pm 0.21
\pm 0.26
\pm 0.02
\pm 0.08
\pm 0.50
\pm 0.55
\pm 0.42
\pm 0.69
\pm 0.36
\pm 0.37
\pm 0.24
\pm 0.53
\pm 0.26
\pm 0.46
\pm 0.03
\pm 0.12
\pm 0.53
\pm 0.34
\pm 0.19
\pm 0.29
\pm 0.30
\pm 0.35
\pm 0.19
\pm 0.48
\pm 0.25
\pm 0.27
\pm 0.01
\pm 0.11
\pm 0.47
\pm 0.29
\pm 0.21
\pm 0.28
\pm 0.28
\pm 0.34
\pm 0.13
\pm 0.44
\pm 0.21
\pm 0.21
\pm 0.00
\pm 0.00
\pm 0.28
\pm 0.22
\pm 0.16
\pm 0.47
\pm 0.25
\pm 0.20
\pm 0.08
\pm 0.23
\pm 0.16
\pm 0.20
\pm 0.00
\pm 0.00
\pm 0.12
\pm 0.14
\pm 0.04
\pm 0.28
\pm 0.80
\pm 0.18
\pm 0.01
\pm 0.12
\pm 0.13
\pm 0.15
s
s
s=2
s=20
s=40
\pm 0.77
\pm 0.03
\pm 0.12
\pm 0.59
\pm 0.10
\pm 0.93
\pm 1.00
\pm 0.06
\pm 0.73
\pm 0.26
\pm 0.06
\pm 0.19
\pm 0.26
\pm 0.03
\pm 1.00
\pm 1.49
\pm 0.03
\pm 0.06
\pm 1.18
\pm 0.01
\pm 0.10
\pm 0.19
\pm 0.01
\pm 0.07
\pm 0.64
\pm 0.03
\pm 0.10
\pm 0.34
\pm 0.02
\pm 0.08
\pm 0.28
\pm 0.01
\pm 0.06
\pm 0.45
\pm 0.02
\pm 0.06
\pm 0.
\pm 0.01
\pm 0.04
\mathcal{L}({\bf\boldsymbol{\omega}})=\mathcal{L}_{\bf cal}+\lambda\cdot%
\mathcal{L}_{\bf dis}+\mathcal{L}_{\bf logit},
\lambda
\mathcal{L}_{\bf cal}
\mathcal{L}_{\bf logit}
\mathcal{L}_{\bf dis}
s
D(\beta)
\beta
\beta\in\{0.1,0.05\}
\beta\in\{0.1,0.05\}
10^{-5}
10^{-4}
\lambda
\mathbf{R}
\mathbf{E}
\mathbf{N}
\mathbf{R}
\mathbf{E}
\mathbf{N}
\beta\in\{0.5,0.1,0.05\}
\beta=0.05
\beta=0.05
\beta
\beta
\beta
\beta
\beta
\beta
\beta=0.05
R
\{0.5,1.0\}
\lambda
\beta=0.05
\lambda
\beta=0.05
\lambda
\beta=0.05
\beta=0.05
\mathcal{L}_{\bf dis}
\mathcal{L}_{\bf logit}
E
\{10,20\}
E
E
E
\beta
\lambda
\lambda
\lambda
\lambda\in\{0.05,0.1,0.25,0.5,1\}
\lambda
\beta=0.05
\beta=0.05
T
N
R
E
B
\eta
\boldsymbol{\mathcal{\omega}}^{T}
\boldsymbol{\mathcal{\omega}}^{0}
m\leftarrow\max(\lfloor R\cdot N\rfloor,1)
t=1,2,\cdots,T-1
M_{t}\leftarrow
m
i\in M_{t}
\boldsymbol{\mathcal{\omega}}^{t}_{i}=\boldsymbol{\mathcal{\omega}}^{t}
\boldsymbol{\mathcal{\omega}}^{t+1}_{i}\leftarrow
\boldsymbol{\mathcal{\omega}}^{t}_{i}
\boldsymbol{\mathcal{\omega}}^{t+1}=\boldsymbol{\mathcal{\omega}}^{t}+\sum_{i%
\in M_{t}}{\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}(\boldsymbol{\mathcal{\omega%
}}^{t+1}_{i}-\boldsymbol{\mathcal{\omega}}^{t}_{i})}
\boldsymbol{\mathcal{\omega}}^{t}_{i}
e=1,2,\cdots,E
\mathcal{B}_{i}=\{\textit{x},\textit{y}\}\in\mathcal{D}_{i}
\mathcal{L}_{\bf cal}(\bf\boldsymbol{\omega};\mathcal{B}_{\textit{i}})=-%
\mathbb{E}_{(\textit{x},\textit{y})\sim\mathcal{B}_{\textit{i}}}\log\left(%
\frac{\textit{p}(\textit{y})\cdot e^{\textit{f}(\textit{x};{\bf\boldsymbol{%
\omega}})\left[\textit{y}\right]}}{\sum_{\textit{c}}{\textit{p}(\textit{c})%
\cdot e^{\textit{f}(\textit{x};{\bf\boldsymbol{\omega}})[\textit{c}]}}}\right)
\mathcal{L}_{\bf dis}(\bf\boldsymbol{\omega};\mathcal{B}_{\textit{i}})=\mathbb%
{E}_{(\textit{x},\textit{y})\sim\mathcal{B}_{\textit{i}}}\sum_{\textit{o}\in%
\mathbb{O}}{\textit{q}^{g}(\textit{o};\textit{x})\log\left[\frac{\textit{q}(%
\textit{o};\textit{x})}{\textit{q}^{g}(\textit{o};\textit{x})}\right]}
\mathcal{L}^{c}_{\bf logit}(\bf\boldsymbol{\omega};\mathcal{B}_{\textit{i}})=%
\log\left(\mathbb{E}_{(\textit{x},\textit{y})\sim\mathcal{B}_{\textit{i}}}%
\mathbb{I}({\textit{y}\neq\textit{c}})\cdot e^{\textit{f}(\textit{x};%
\boldsymbol{\omega})[\textit{c}]}\right)
\mathcal{L}_{\bf logit}(\bf\boldsymbol{\omega};\mathcal{B}_{\textit{i}})=\sum%
\textit{p}(\textit{c})\cdot\mathcal{L}^{\textit{c}}_{\bf logit}(\bf\boldsymbol%
{\omega};\mathcal{B}_{\textit{i}})
\mathcal{L}({\bf\boldsymbol{\omega}}^{t}_{i};\mathcal{B}_{i})=\mathcal{L}_{\bf
cal%
}({\bf\boldsymbol{\omega}}^{t}_{i};\mathcal{B}_{i})+\lambda\cdot\mathcal{L}_{%
\bf dis}({\bf\boldsymbol{\omega}}^{t}_{i};\mathcal{B}_{i})+\mathcal{L}_{\bf
logit%
}({\bf\boldsymbol{\omega}}^{t}_{i};\mathcal{B}_{i})
\boldsymbol{\mathcal{\omega}}^{t}_{i}=\boldsymbol{\mathcal{\omega}}^{t}_{i}-%
\eta\nabla{\mathcal{L}({\bf\boldsymbol{\omega}}^{t}_{i};\mathcal{B}_{i})}
\boldsymbol{\mathcal{\omega}}^{t}_{i}
\beta
\beta
\beta=0.5,0.1,0.05
\beta=0.5,0.1,0.05
\beta=0.5,0.1,0.05
\beta=0.1
\beta=0.1
224^{2}\times 3
112^{2}\times 32
112^{2}\times 16
56^{2}\times 24
28^{2}\times 32
14^{2}\times 64
14^{2}\times 96
7^{2}\times 160
7^{2}\times 320
2d1\times 1
7^{2}\times 1280
7\times 7
1\times 1\times 1280
2d1\times 1
h\times w\times k
\times
h\times w\times(tk)
h\times w\times tk
3\times 3
\frac{h}{s}\times\frac{w}{s}\times(tk)
\frac{h}{s}\times\frac{w}{s}\times k^{\prime}
\frac{h}{s}\times\frac{w}{s}\times tk
1\times 1
\frac{h}{s}\times\frac{w}{s}\times(tk)
\frac{h}{s}\times\frac{w}{s}\times k^{\prime}
\mu
\mu
\tau
\epsilon
\tau
\alpha
\rho
\beta
\beta
deco
\beta
cluster
\rho
c_{o}s
\beta=0.1
\beta=0.1
\beta=0.1
\beta=0.05
\beta=0.1
\beta=0.05
\beta=0.1
\beta=0.05
\beta
\beta
\beta
\beta
\beta=0.1
\beta=0.05
\beta
\beta
\beta
\beta
\beta
\beta
\mathbf{R}
\mathbf{E}
\mathbf{N}
\beta=0.05
\mathbf{R}
\{0.3,0.5,0.8,1.0\}
\mathbf{E}
\{5,10,15,20\}
\mathbf{N}
\{10,20,30,50\}
\mathbf{R}
\mathbf{E}
\mathbf{N}
\beta=0.05
\mathbf{R}
\{0.3,0.5,0.8,1.0\}
\mathbf{E}
\{5,10,15,20\}
\mathbf{N}
\{10,20,30,50\}
E
\beta=0.05
\beta=0.05
{Drift}=\frac{\sum_{i=1}^{N}{\Arrowvert m_{i}\Arrowvert^{2}}}{\Arrowvert\sum_{%
i=1}^{N}{m_{i}}\Arrowvert^{2}},m_{i}=\omega_{i}^{T}-\omega^{T}
\beta=0.1
\beta=0.1
\displaystyle\mathcal{L}_{\bf cal}=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log%
\left(\frac{p(y)\cdot e^{f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{%
\sum_{c}{p(c)\cdot e^{f(x;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right)
\displaystyle\mathcal{L}_{\bf cal}
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{p(y)\cdot e%
^{f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{\sum_{c}{p(c)\cdot e^{f(x%
;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right)
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{\ln{p(y%
)}}\cdot e^{f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{\sum_{c}{e^{\ln%
{p(c)}}\cdot e^{f(x;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right)
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{\ln{p(y%
)}}\cdot e^{f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{\sum_{c}{e^{\ln%
{p(c)}}\cdot e^{f(x;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right)
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{\ln{p(y%
)}+f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{\sum_{c}{e^{\ln{p(c)}+f(%
x;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right),
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{\ln{p(y%
)}+f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]}}{\sum_{c}{e^{\ln{p(c)}+f(%
x;{\bf\boldsymbol{\omega}})[\it{c}]}}}\right),
p(y)=\frac{n_{y}}{n}
n_{y}
y
i
n
i
\displaystyle\mathcal{L}_{\bf cal}=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log%
\left(\frac{e^{\ln{\left(\frac{n_{y}}{n}\right)}+f(x;{\bf\boldsymbol{\omega}})%
\left[\it{y}\right]}}{\sum_{c}{e^{\ln{\left(\frac{n_{c}}{n}\right)}+f(x;{\bf%
\boldsymbol{\omega}})[\it{c}]}}}\right)
\displaystyle\mathcal{L}_{\bf cal}
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{\ln{%
\left(\frac{n_{y}}{n}\right)}+f(x;{\bf\boldsymbol{\omega}})\left[\it{y}\right]%
}}{\sum_{c}{e^{\ln{\left(\frac{n_{c}}{n}\right)}+f(x;{\bf\boldsymbol{\omega}})%
[\it{c}]}}}\right)
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{f(x;{%
\bf\boldsymbol{\omega}})\left[\it{y}\right]+\ln{n_{y}}-\ln{n}}}{\sum_{c}{e^{f(%
x;{\bf\boldsymbol{\omega}})[\it{c}]+\ln{n_{c}}+\ln{n}}}}\right)
\displaystyle=-\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}\log\left(\frac{e^{f(x;{%
\bf\boldsymbol{\omega}})\left[\it{y}\right]+\ln{n_{y}}-\ln{n}}}{\sum_{c}{e^{f(%
x;{\bf\boldsymbol{\omega}})[\it{c}]+\ln{n_{c}}+\ln{n}}}}\right)
n
n_{y}
n_{y}
\mathcal{L}_{\bf cal}(y,f(x))=-\log\left(\frac{e^{f_{y}(x)-\tau\cdot n_{y}^{(-%
1/4)}}}{\sum_{c\neq y}{e^{f_{c}(x)-\tau\cdot n_{y}^{(-1/4)}}}}\right),
\ln{n_{y}}
-\tau\cdot n_{y}^{(-1/4)}
{n_{y}}
