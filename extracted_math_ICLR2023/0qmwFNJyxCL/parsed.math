>8\%
1\%
\ell_{p}
{\mathcal{D}}_{l}=\{(\bar{x},y)|\bar{x}\in{\mathbb{R}}^{n},y\in[K]\}
\ell_{p}
{\mathcal{L}}_{\rm sup-AT}(f)=\mathbb{E}_{\bar{x},y}\max_{\delta_{\bar{x}}\in%
\Delta}\,\ell_{\rm CE}(f(\bar{x}+\delta_{\bar{x}}),y),\quad\ell_{\rm CE}(f(%
\cdot),y)=-\log\frac{\exp(f(\cdot)[y])}{\sum_{k=1}^{K}\exp(f(\cdot)[k])}.
f:{\mathbb{R}}^{n}\to{\mathbb{R}}^{K}
(\bar{x}+\delta_{\bar{x}},y)
\Delta=\{\delta:\|\delta\|_{p}\leq\varepsilon\}
\bar{x}\in\mathcal{X}
x,x^{+}
A(\cdot|\bar{x})
M
\{x_{m}^{-}\}_{m=1}^{M}
A(\cdot)=\mathbb{E}_{\bar{x}}A(\cdot|\bar{x})
g:{\mathcal{X}}\to{\mathcal{Z}}
(x,x^{+},\{x_{m}^{-}\})
\displaystyle\min_{g}{\mathcal{L}}_{\rm NCE}(g)=\ \mathbb{E}_{x,x^{+},\{x^{-}_%
{m}\}}\ell_{\rm NCE}(x,x^{+},\{x^{-}_{m}\};g),
\displaystyle\min_{g}
\displaystyle{\mathcal{L}}_{\rm NCE}(g)=\ \mathbb{E}_{x,x^{+},\{x^{-}_{m}\}}%
\ell_{\rm NCE}(x,x^{+},\{x^{-}_{m}\};g),
\displaystyle\ell_{\rm NCE}(x,x^{+},\{x^{-}_{m}\};g)=-\log\frac{\exp(%
\operatorname{sim}(g(x),g(x^{+}))/\tau)}{\sum_{m}\exp(\operatorname{sim}(g(x),%
g(x^{-}_{m}))/\tau)}.
\displaystyle\ell_{\rm NCE}(x,x^{+},\{x^{-}_{m}\};g)=-\log\frac{\exp(%
\operatorname{sim}(g(x),g(x^{+}))/\tau)}{\sum_{m}\exp(\operatorname{sim}(g(x),%
g(x^{-}_{m}))/\tau)}.
\operatorname{sim}(\cdot,\cdot
\tau
\ell_{\rm AdvNCE}(x,x^{+},\{x^{-}_{m}\};g)=\max_{\delta,\delta^{+},\{\delta^{-%
}_{m}\}\in\Delta}\ell_{\rm NCE}(x+\delta,x^{+}+\delta^{+},\{x^{-}_{m}+\delta^{%
-}_{m}\};g),
g
g_{c}
g_{a}
\displaystyle\ell_{\rm ACL}(x,x^{+},\{x^{-}_{m}\};g)=\ell_{\rm NCE}(x,x^{+},\{%
x^{-}_{m}\};g_{c})+\ell_{\rm AdvNCE}(x,x^{+},\{x^{-}_{m}\};g_{a}).
\displaystyle\ell_{\rm ACL}(x,x^{+},\{x^{-}_{m}\};g)
\displaystyle=\ell_{\rm NCE}(x,x^{+},\{x^{-}_{m}\};g_{c})+\ell_{\rm AdvNCE}(x,%
x^{+},\{x^{-}_{m}\};g_{a}).
g_{a}
\varepsilon=8/255
\ell_{\infty}
2\cdot\varepsilon=16/255
\mathcal{T}(s)
s\in[0,1]
s=0
s=1
s\in(0,1)
s
\mathcal{T}(s)
s\in[0,1]
s
s\in[0,1]
s
s
s
s=0.5
s
s(t)
t
s(t)
s(t)
\displaystyle s(t)=1-\lfloor\frac{t}{K}\rfloor\cdot\frac{K}{T},\quad t=0,\dots%
,T-1,
\displaystyle s(t)
\displaystyle=1-\lfloor\frac{t}{K}\rfloor\cdot\frac{K}{T},\quad t=0,\dots,T-1,
T
K
\lfloor\cdot\rfloor
s(t)
s=1
s=0
K/T
K
\ell_{\rm NCE}
\ell_{\rm AdvNCE}
w(t)
t
\displaystyle{\mathcal{L}}_{\rm DYNACL}(g;t)=(1-w(t)){\mathcal{L}}_{\rm NCE}(g%
_{c};s(t))+(1+w(t)){\mathcal{L}}_{\rm AdvNCE}(g_{a};s(t)).
\displaystyle{\mathcal{L}}_{\rm DYNACL}(g;t)=(1-w(t)){\mathcal{L}}_{\rm NCE}(g%
_{c};s(t))+(1+w(t)){\mathcal{L}}_{\rm AdvNCE}(g_{a};s(t)).
w(t)
s(t)
w(t)=\lambda(1-s(t)),~{}~{}t=0,\dots,T-1,
\lambda\in[0,1]
t=0
s(t)
w(t)
\ell_{\rm NCE}
\ell_{\rm AdvNCE}
(t=T)
1-\lambda
1+\lambda
\lambda
\lambda=0
g_{c}
g_{a}
\{\hat{y}_{i}\}
g_{c}
h:{\mathbb{R}}^{m}\to{\mathbb{R}}^{k}
k
g_{a}
h\circ g_{a}
(x,\hat{y})
25
K=50
\lambda=2/3
\to
\times
\times
\times
\times
12\%
32.7
105.0
29.4
30.3
K
\lambda
\lambda=0
\lambda>0
1\%
\lambda=2/3
K
\lambda
K
\lambda
K
K
K
\lambda
\lambda
\lambda
\mathcal{T}(s)
s
g
h
\mathcal{T(\cdot)}
T
T^{\prime},T^{\prime\prime}
g
t
\in\{1,2,\cdots,T\}
\mathcal{X}
\mathcal{X}
\mathcal{T}(s(t))
\mathcal{L}\leftarrow\mathcal{L}_{DYNACL}(g;t)
g
\mathcal{L}
g_{c}
\{\hat{y}_{i}\}=\operatorname{k\_means}(\{x_{i}\};g_{c})
g_{a}
epoch
\in\{1,2,\cdots,T^{\prime}\}
h\circ g_{a},\{x_{i}\},\{\hat{y}_{i}\}
g_{a}
epoch
\in\{1,2,\cdots,T^{\prime\prime}\}
h\circ g_{a},\{x_{i}\},\{\hat{y}_{i}\}
\ell_{\infty}
\varepsilon
\ell_{\infty}
D
2\cdot 8/255=16/255
\mathcal{X}_{tr}
\mathcal{X}_{ts}
10,15,20,50
\mathcal{X}_{tr}
\mathcal{X}_{ts}
f(x,y)
x,y
1-f(x,y)
\ell_{2}
s
K=50
\lambda=2/3
25
0.01
0.1
25
0.1
88.15\%
65.78\%
s
s=0.3
s=0.3
1\rightarrow 0
s
s
\times
\times
\times
\times
\times
\times
{\mathcal{X}}
l(x;\theta)
|l(x;\theta)|\leq M
P
Q
W_{c}(P,Q):=\inf_{M\in\Pi(P,Q)}\mathbb{E}_{M}\left[c\left(X,X^{\prime}\right)\right]
\Pi(P,Q)
P
Q
c:X\to X
c(x,x)=0,\forall\ x\in{\mathcal{X}}
\phi_{\gamma}\left(\theta;x_{0}\right):=\sup_{x\in\mathcal{X}}\left\{\ell(%
\theta;x)-\gamma c\left(x,x_{0}\right)\right\}
x
\gamma
\ell_{p}
P_{\rm test}
P_{\rm aug}
\hat{P}_{\rm aug}
n
\hat{P}_{\rm aug}
\hat{P}_{\rm test}
t>0
1-e^{-t}
\theta\in\Theta,\rho\geq 0,\gamma\geq 0
\sup_{P:W_{c}\left(P_{\rm test},P_{\rm aug}\right)\leq\rho}\mathbb{E}_{P_{\rm
test%
}}[\ell(\theta;X)]\leq\gamma\rho+\mathbb{E}_{\widehat{P}_{\rm aug}}\left[\phi_%
{\gamma}(\theta;X)\right]+\epsilon_{n}(t).
\epsilon_{n}(t):=\gamma b_{1}\sqrt{\frac{M}{n}}\int_{0}^{1}\sqrt{\log N\left(%
\mathcal{F},M\epsilon,\|\cdot\|_{L^{\infty}(\mathcal{X})}\right)}d\epsilon+b_{%
2}M\sqrt{\frac{t}{n}}
{\mathcal{F}}
N({\mathcal{F}},\varepsilon,\|\cdot\|)
b_{1}
b_{2}
\rho
\rho
\rho
s
1
0
\rho
0
s=0
P
Q
\ell:\Theta\times\mathcal{X}\rightarrow\mathbb{R}
c:\mathcal{X}\times\mathcal{X}\rightarrow\mathbb{R}_{+}
\phi_{\gamma}\left(\theta;z_{0}\right)=
\sup_{z\in\mathcal{X}}\left\{\ell(\theta;z)-\gamma c\left(z,z_{0}\right)\right\}
(2\mathrm{~{}b})
Q
\rho>0
\sup_{P:W_{c}(P,Q)\leq\rho}\mathbb{E}_{P}[\ell(\theta;X)]=\inf_{\gamma\geq 0}%
\left\{\gamma\rho+\mathbb{E}_{Q}\left[\phi_{\gamma}(\theta;X)\right]\right\}
\gamma\geq 0
\sup_{P}\left\{\mathbb{E}_{P}[\ell(\theta;X)]-\gamma W_{c}(P,Q)\right\}=%
\mathbb{E}_{Q}\left[\phi_{\gamma}(\theta;X)\right].
\sup_{P_{\rm test}:W_{c}(P_{\rm test},P_{\rm aug})\leq\rho}\mathbb{E}_{P_{\rm
test%
}}[\ell(\theta;X)]\leq\gamma\rho+\mathbb{E}_{P_{\rm aug}}\left[\phi_{\gamma}(%
\theta;X)\right]
\rho>0
P_{\rm aug}
\gamma\geq 0
\mathbb{E}_{\widehat{P}_{\rm aug}}\left[\phi_{\gamma}(\theta;X)\right]
\phi_{\gamma}(\theta;z)\in\left[-M,M\right]
-M\leq\ell(\theta;x)\leq\phi_{\gamma}(\theta;x)\leq\sup_{x}\ell(\theta;x)\leq M
\theta\mapsto F_{n}(\theta)
