\mathcal{T}(.)
t
t
\mathcal{T}(.)
t
t
\mathcal{F}
\bm{x}
c\times h\times w
c,h
w
n
\mathcal{F}=(f_{1}\circ f_{2}\circ f_{3}\circ\ldots f_{n})
f_{i}
\bm{x}
N
P_{t}\in\mathbb{R}^{N\times D}
D
\mathcal{I}_{cls}\in\mathbb{R}^{1\times D}
\mathcal{F}
\mathcal{F}(\bm{x})\in\mathbb{R}^{(N+1)\times D}
\tilde{\mathcal{I}}_{cls}
g_{s}
\mathbb{R}^{1\times D}
\mathbb{R}^{1\times C_{s}}
C_{s}
\mathcal{I}_{cls}
\mathcal{I}^{t}_{cls}\in\mathbb{R}^{1\times D}
t\times c\times h\times w
t
g_{t}
\mathbb{R}^{1\times D}
\mathbb{R}^{1\times C_{t}}
C_{t}
t\times N
\mathcal{I}^{t}_{cls}
g_{t}
\mathcal{O}\left((t\times N)^{2}\times D\right)
t\times N
N
t_{i}\times c\times h\times w
t_{i}
\mathbb{R}^{1\times D}
\mathcal{T}
\mathcal{T}
\mathcal{I}^{t}_{cls}
g_{t}
\mathcal{I}_{cls}
\mathcal{I}_{cls}
\mathcal{I}^{t}_{cls}
\mathcal{T}
t
t
\bm{x}
\bm{x}\in\mathbb{R}^{t\times N\times D}
\mathcal{T}
N
t
\mathcal{T}(\bm{x})\in\mathbb{R}^{t\times D}
\times
\times
\bm{x}
\bm{x}\in\mathbb{R}^{t\times N\times D}
\mathcal{T}(\bm{x})\in\mathbb{R}^{t\times D}
\bm{x}_{i}\sim\bm{x}
\bm{x}_{i}\in\mathbb{R}^{N\times D}
\mathcal{T}(\bm{x})
\mathcal{I}^{t}_{cls}
\mathcal{I}_{cls}
\mathcal{F}
\mathcal{F}(\bm{x})=\mathcal{F}\left(\left[\mathcal{I}^{t}_{cls},\mathcal{T}(%
\bm{x}),\mathcal{I}_{cls},\bm{x}_{i}\right]\right)
t
g_{t}
\tilde{\mathcal{I}}^{tp}_{cls}
\mathcal{T}
\mathcal{I}^{t}_{cls}
15
0.005
10
11^{\texttt{th}}
14^{\texttt{th}}
\mathcal{I}_{cls}
\mathcal{F}
\tilde{\mathcal{I}}^{tp}_{cls}
\tilde{\mathcal{I}}_{cls}
\tilde{\mathcal{I}}^{tp}_{cls}
\tilde{\mathcal{I}}_{cls}
\bm{x^{\prime}}
\bm{x}
\displaystyle{\text{find}\;\;\bm{x^{\prime}}}\;\;\text{such that}\;\;\mathcal{%
F}(\bm{x^{\prime}})_{argmax}\neq y,\;\;\;\;\text{and}\;\;\|\bm{x}-\bm{x^{%
\prime}}\|_{p}\leq\epsilon,
\displaystyle{\text{find}\;\;\bm{x^{\prime}}}\;\;\text{such that}\;\;\mathcal{%
F}(\bm{x^{\prime}})_{argmax}\neq y,\;\;\;\;\text{and}\;\;\|\bm{x}-\bm{x^{%
\prime}}\|_{p}\leq\epsilon,
y
\epsilon
p
\text{maximize}\;\;\mathcal{L}=\mathcal{L}_{s}-\mathcal{L}_{ss},
\mathcal{L}_{s}
\mathcal{L}_{s}
\mathcal{L}_{ss}
\mathcal{L}_{s}
\mathcal{L}_{ss}
\mathcal{L}_{s}=-\sum_{j=1}^{C_{t}}y_{j}log\left(\tilde{\mathcal{I^{\prime}}}^%
{tp}_{cls}\circ g_{t}\right),\;\;\;\mathcal{L}_{ss}=\frac{\tilde{\mathcal{I^{%
\prime}}}_{cls}^{\top}\tilde{\mathcal{I}}_{cls}}{\|\tilde{\mathcal{I^{\prime}}%
}_{cls}\|\|\tilde{\mathcal{I}}_{cls}\|}
\times
\times
\times
\downarrow
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-26.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-37.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-24.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-57.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-41.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-77.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-26.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-38.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-26.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-57.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-39.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-13.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-76.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-15.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-39.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-57.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-37.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-41.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-13.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-75.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-13.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-40.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-28.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-58.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-37.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-40.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-77.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-24.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-13.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-16.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-20.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-44.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-34.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-31.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-77.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-13.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-14.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-14.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-15.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-21.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-9.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-58.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-4.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-16.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-33.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-19.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-14.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-31.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-9.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-56.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-4.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-34.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-19.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-20.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-15.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-18.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-23.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-55.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-4.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-44.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-24.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-22.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-16.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-19.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-63.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-7.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-8.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-26.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-8.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-16.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-7.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-55.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-4.7)}}}
\epsilon\leq 16
\epsilon\leq 16
\downarrow
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-23.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-37.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-24.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-23.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-38.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-34.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-11.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-73.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-11.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-43.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-28.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-24.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-38.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-33.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-73.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-11.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-25.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-43.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-30.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-26.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-39.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-31.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-35.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-72.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-42.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-50.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-28.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-40.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-32.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-73.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-14.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-30.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-14.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-34.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-72.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-10.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-28.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-42.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-24.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-42.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-32.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-73.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-9.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-46.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-32.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-27.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-43.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-32.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-38.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-12.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-71.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-9.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-35.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-46.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-35.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-28.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-42.6)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-34.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-39.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-13.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-72.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-8.5)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-45.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-51.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-39.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.3)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-47.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-34.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-42.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-14.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-73.7)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-16.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-17.2)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-36.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-18.9)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-20.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-33.4)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-31.8)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-29.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-11.0)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-72.1)}}}
{}_{\text{{\color[rgb]{0.55,0.0,0.0}(-7.4)}}}
\epsilon\leq 16
\epsilon\leq 16
l_{\infty}
\epsilon\leq 16
-
-
-
\times
\times
-
-
\times
\times
\times
\times
\times
\mathcal{T}(.)
\downarrow
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\downarrow
\downarrow
\downarrow
\downarrow
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\downarrow
\mathcal{L}_{ss}
\downarrow
\times
\times
\times
\times
\times
\times
\mathbb{R}^{384}
\mathbb{R}^{2}
\mathbb{R}^{768}
\mathbb{R}^{2}
\times 56
\times
\times
\times 56
\times
\times
