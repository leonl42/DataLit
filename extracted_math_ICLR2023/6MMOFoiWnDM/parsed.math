d_{x}
X_{i,t}\in{\mathbb{R}^{{d_{x}}}}
Y_{i,t}
{T_{i,t}}\in\left[{0,1}\right]
T_{i,t}=1
T_{i,t}=0
d_{s}
S_{i}\in{\mathbb{R}^{d_{s}}}
{{\mathbf{\bar{H}}}_{t}}={{{{\mathbf{\bar{X}}}_{t}},{{\mathbf{\bar{T}}}_{t-1}}%
,{{\mathbf{\bar{Y}}}_{t}},S}}
{{\mathbf{\bar{X}}}_{t}}=[{{X_{1}},\ldots,{X_{t}}}]
{{\mathbf{\bar{T}}}_{t-1}}=[{{T_{1}},\ldots,{T_{t-1}}}]
{{\mathbf{\bar{Y}}}_{t}}=[{{Y_{1}},\ldots,{Y_{t}}}]
\tau\geq 1
\tau
{{\mathbf{\tilde{T}}}_{({t,t+\tau-1})}}=[{{{\tilde{T}}_{t}},...,{{\tilde{T}}_{%
t+\tau-1}}}]
\tau
{Y_{t+\tau}}\left({{{{\mathbf{\tilde{T}}}}_{\left({t,t+\tau-1}\right)}}}\right)
f(\bullet)
\tau
E({{Y_{t+\tau}}({{{\mathbf{\tilde{T}}}}_{({t,t+\tau-1})}})|{{{\mathbf{\bar{H}}%
}}_{t}}})=f({\tau,{{{\mathbf{\tilde{T}}}}_{({t,t+\tau-1})}},{{{\mathbf{\bar{H}%
}}}_{t}}})
f(\bullet)
{Y_{i,t+1}}({{T_{i,t}}=1})
{Y_{i,t+1}}({{T_{i,t}}=0})
Y({{\mathbf{\bar{T}}}})=Y({{{{\mathbf{\bar{T}}}}^{*}}})
{\mathbf{\bar{T}}}={{\mathbf{\bar{T}}}^{*}}
{{\mathbf{\bar{T}}}^{*}}
P({{{{\mathbf{\bar{H}}}}_{t}}={{\bar{h}}_{t}}})\neq 0
P({{T_{t}}|{{{\mathbf{\bar{H}}}}_{t}}={{\bar{h}}_{t}}})>0
{\bar{h}_{t}}
({{Y_{t+1}}(1),Y_{t+1}(0)})\bot{T_{t}}|{{\mathbf{\bar{H}}}_{t}}
E({{Y_{t+\tau}}|{{{\mathbf{\bar{T}}}}_{t-1}},S})={\beta_{0}}+{{\bm{\beta}}_{1}%
}{{\mathbf{\bar{T}}}_{t}}+{{\bm{\beta}}_{2}}S\otimes{{\mathbf{\bar{T}}}_{t}}+{%
{\bm{\beta}}_{3}}S
\bm{\beta}
\bm{\beta_{1}}
\bm{\beta_{2}}
{\mathbf{SW}}({t,\tau})=\frac{{\prod\limits_{t=1}^{t+\tau}{pr({{T_{t}}|{{{%
\mathbf{\bar{T}}}}_{t-1}}})}}}{{\prod\limits_{t=1}^{t+\tau}{pr({{T_{t}}|{{{%
\mathbf{\bar{H}}}}_{t}}})}}}
pr(\cdot)
pr({{T_{t}}|{{{\mathbf{\bar{T}}}}_{t-1}}})
pr({{T_{t}}|{{{\mathbf{\bar{H}}}}_{t}}})
P({{T_{t}}|{{{\mathbf{\bar{H}}}}_{t}}})=P({{T_{t}}|{{{\mathbf{\bar{T}}}}_{t-1}%
}})
T_{t}^{k}
\Phi
P({\Phi({{{{\mathbf{\bar{H}}}}_{t}}})|{T_{t}}=T_{t}^{1}})=\cdots=P({\Phi({{{{%
\mathbf{\bar{H}}}}_{t}}})|{T_{t}}=T_{t}^{k}})
{\mathbf{\bar{H}}}
\mathbf{\tilde{T}}_{t,t+\tau-1}
\mathbf{\hat{Y}_{({t+1:t+\tau})}}
{\hat{T}_{ps}}=pr({T|{\mathbf{\bar{T}}}})
\hat{Y}
{\hat{T}_{hps}}=pr({T|{\mathbf{\bar{H}}}})
\hat{Y}_{t+1}
\mathbf{\bar{H}}_{t}
d_{h}
h_{t}
\displaystyle{h_{t}}=Linear(Concat({{\mathbf{\bar{X}}}_{t}},{{\mathbf{\bar{T}}%
}_{t-1}},{{\mathbf{\bar{Y}}}_{t}},S_{t}))
\displaystyle{h_{t}}
\displaystyle=Linear(Concat({{\mathbf{\bar{X}}}_{t}},{{\mathbf{\bar{T}}}_{t-1}%
},{{\mathbf{\bar{Y}}}_{t}},S_{t}))
\displaystyle{\mathbf{h}}_{t}^{0}={[{{h_{1}},\ldots,{h_{t}}}]^{T}}
\displaystyle{\mathbf{h}}_{t}^{0}
\displaystyle={[{{h_{1}},\ldots,{h_{t}}}]^{T}}
\displaystyle{\mathbf{h}}_{t}^{l}=TransEncoderBlock_{l}({{\mathbf{h}}_{t}^{l-1%
}})
\displaystyle{\mathbf{h}}_{t}^{l}
\displaystyle=TransEncoderBlock_{l}({{\mathbf{h}}_{t}^{l-1}})
\displaystyle{\mathbf{\Phi}}_{t}=ELU({Linear({{\mathbf{h}}_{t}^{l}})})
\displaystyle{\mathbf{\Phi}}_{t}
\displaystyle=ELU({Linear({{\mathbf{h}}_{t}^{l}})})
{\mathbf{h}}_{t}^{l}\in{\mathbb{R}^{t\times{d_{h}}}}
l\in\{1,2,...,L\}
{{\mathbf{\Phi}}_{t}}\in{\mathbb{R}^{t\times{d_{h}}}}
{\hat{Y}_{t+\tau}}
\tau\geq 2
{\mathbf{\bar{T}}}_{t-1}
{\mathbf{\bar{Y}}}_{t}
{\hat{Y}_{t+1}}
h_{t}
{{\mathbf{\tilde{T}}}_{({t,t+\tau-1})}}
\displaystyle{h_{t+\tau}}=Linear({Concat({{T_{t+\tau-2}},{Y_{t+\tau-2}},S,{{%
\hat{Y}}_{t+\tau-1}}})})
\displaystyle{h_{t+\tau}}
\displaystyle=Linear({Concat({{T_{t+\tau-2}},{Y_{t+\tau-2}},S,{{\hat{Y}}_{t+%
\tau-1}}})})
\displaystyle{\mathbf{h}}_{t+\tau}^{0}={[{{h_{t+1}},\ldots,{h_{t+\tau}}}]^{T}}
\displaystyle{\mathbf{h}}_{t+\tau}^{0}
\displaystyle={[{{h_{t+1}},\ldots,{h_{t+\tau}}}]^{T}}
\displaystyle{\mathbf{h}}_{t+\tau}^{l}=TransDecoderBloc{k_{l}}({{\mathbf{h}}_{%
t+\tau}^{l-1},{{\mathbf{\Phi}}_{t}}})
\displaystyle{\mathbf{h}}_{t+\tau}^{l}
\displaystyle=TransDecoderBloc{k_{l}}({{\mathbf{h}}_{t+\tau}^{l-1},{{\mathbf{%
\Phi}}_{t}}})
\displaystyle{{\mathbf{\Phi}}_{t+\tau}}=ELU({Linear({{\mathbf{h}}_{t+\tau}^{l}%
})})
\displaystyle{{\mathbf{\Phi}}_{t+\tau}}
\displaystyle=ELU({Linear({{\mathbf{h}}_{t+\tau}^{l}})})
{\mathcal{D}_{y}}({\Phi({{{{\mathbf{\bar{H}}}}_{t}}}),{{\tilde{T}}_{({t+\tau-1%
})}}})
{\mathcal{D}_{ps}}({{{{\mathbf{\bar{T}}}}_{t-1}}})
{\mathcal{D}_{hps}}({\Phi({{{{\mathbf{\bar{H}}}}_{t}}})})
\mathbf{h^{l}}
d_{a}
Attentio{n^{i}}({{Q^{i}},{K^{i}},{V^{i}}})=\operatorname{softmax}({\frac{{{Q^{%
i}}{K^{i}}^{\top}}}{{\sqrt{{d_{a}}}}}})V
MultiHead({Q,K,V})=Concat({head_{1}},...,{head_{i}}){W^{O}}
head_{i}=Attention^{i}({Q^{i}}W_{i}^{Q},{K^{i}}W_{i}^{K},{V^{i}}W_{i}^{V})
W_{i}^{Q}\in\mathbb{R}^{d_{h}\times d_{a}}
W_{i}^{K}\in\mathbb{R}^{d_{h}\times d_{a}}
W_{i}^{V}\in\mathbb{R}^{d_{h}\times d_{a}}
W^{O}\in{\mathbb{R}^{{i}{d_{h}}\times d_{a}}}
\displaystyle Self(Q,K,V)=[{Q,K,V}]
\displaystyle Self(Q,K,V)
\displaystyle=[{Q,K,V}]
\displaystyle=[Linear({\mathbf{h}}^{l-1}),Linear({\mathbf{h}}^{l-1}),Linear({%
\mathbf{h}}^{l-1})]
\displaystyle=[Linear({\mathbf{h}}^{l-1}),Linear({\mathbf{h}}^{l-1}),Linear({%
\mathbf{h}}^{l-1})]
\displaystyle Cross(Q,K,V)=[{Q,K,V}]
\displaystyle Cross(Q,K,V)
\displaystyle=[{Q,K,V}]
\displaystyle=[Linear({\mathbf{h}}^{l-1}),Linear({\mathbf{\Phi}}),Linear({%
\mathbf{\phi}})]
\displaystyle=[Linear({\mathbf{h}}^{l-1}),Linear({\mathbf{\Phi}}),Linear({%
\mathbf{\phi}})]
-\infty
FFL(\mathbf{\alpha})=Linear(ReLU(Linear(\mathbf{\alpha})))
\mathbf{\alpha}
\mathbf{\alpha}=LayerNorm(\mathbf{\alpha}+Sublayer(\mathbf{\alpha}))
\displaystyle PE_{(t,2d)}=sin(t/{1000^{2d/{d_{h}}}})
\displaystyle PE_{(t,2d)}
\displaystyle=sin(t/{1000^{2d/{d_{h}}}})
\displaystyle PE_{(t,2d+1)}=cos(t/{1000^{2d/{d_{h}}}})
\displaystyle PE_{(t,2d+1)}
\displaystyle=cos(t/{1000^{2d/{d_{h}}}})
\mathcal{L}_{t,y}({{\theta_{Y}},{\theta_{R}}})={\|Y_{t+1}-{\mathcal{D}_{y}}({{%
\Phi_{t}}({{{{\mathbf{\bar{H}}}}_{t}};{\theta_{R}}});{\theta_{Y}}})}\|^{2}
\mathcal{L}{{}_{t,ps}}({{\theta_{T}},{\theta_{PS}}})=-\sum\limits_{k=1}^{K}{{%
\mathcal{I}_{\{{T_{t}}=T_{t}^{k}\}}}\log{\mathcal{D}_{ps}}(L({{{{\mathbf{\bar{%
T}}}}_{t-1}};{\theta_{T}}});{\theta_{PS}})}
\mathcal{I}
L(\bullet)
\mathcal{L}{{}_{t,hps}}({{\theta_{R}},{\theta_{HPS}}})=-\sum\limits_{k=1}^{K}{%
\frac{1}{K}}\log{\mathcal{D}_{hps}}(\Phi_{t}({{{{\mathbf{\bar{H}}}}_{t}};{%
\theta_{R}}});{\theta_{HPS}})
\displaystyle{R_{t}}({{\theta_{R}},{\theta_{Y}},{\theta_{T}},{\theta_{PS}},{%
\theta_{HPS}}})
\displaystyle{R_{t}}({{\theta_{R}},{\theta_{Y}},{\theta_{T}},{\theta_{PS}},{%
\theta_{HPS}}})
\displaystyle=\mathcal{L}{{}_{t,Y}}({{\theta_{R}},{\theta_{Y}}})+\lambda({%
\mathcal{L}{{}_{t,ps}}({{\theta_{T}},{\theta_{PS}}})+\mathcal{L}{{}_{t,hps}}({%
{\theta_{R}},{\theta_{HPS}}})})
\displaystyle=\mathcal{L}{{}_{t,Y}}({{\theta_{R}},{\theta_{Y}}})+\lambda({%
\mathcal{L}{{}_{t,ps}}({{\theta_{T}},{\theta_{PS}}})+\mathcal{L}{{}_{t,hps}}({%
{\theta_{R}},{\theta_{HPS}}})})
\lambda
\Delta
\eta
{{\mathbf{\bar{H}}}_{t}}=\{{{{\mathbf{\bar{X}}}_{t}},{{\mathbf{\bar{T}}}_{t-1}%
},{{\mathbf{\bar{Y}}}_{t}},S}\}
{{\mathbf{\tilde{T}}}_{({t,t+\tau-1})}}
{{\mathbf{\Theta}}_{E}},{\mathbf{\Theta}}_{D}
{{\mathbf{\Theta}}_{E}}={\left({{\theta_{R}},{\theta_{Y}},{\theta_{T}},{\theta%
_{PS}},{\theta_{HPS}}}\right)_{E}}
{({{\theta_{R}},{\theta_{T}},{\theta_{PS}}})_{E}}\leftarrow{({{\theta_{R}},{%
\theta_{T}},{\theta_{PS}}})_{E}}-\eta\Delta({\frac{1}{B}\sum\nolimits_{B}\!{%
\sum\nolimits_{t}\!{({\mathcal{L}{{}_{t,y}}\!+\lambda\mathcal{L}{{}_{t,ps}}})}%
}})
{({{\theta_{R}},{\theta_{Y}},{\theta_{HPS}}})_{E}}\leftarrow{({{\theta_{R}},{%
\theta_{Y}},{\theta_{HPS}}})_{E}}-\eta\Delta({\frac{1}{B}\sum\nolimits_{B}{%
\sum\nolimits_{t}{({\mathcal{L}{{}_{t,y}}+\lambda\mathcal{L}{{}_{t,hps}}})}}})
Encoder({\mathbf{\bar{H}}}_{i,t};{\mathbf{\Theta}}_{E})
{\mathbf{\Phi},\mathbf{M}}
({{\Phi_{i,t}},{M_{i,t}},{{\hat{Y}}_{i,t+1}}})=Encoder({{\mathbf{\bar{H}}}_{i,%
t}};{{\mathbf{\Theta}}_{E}})
{{\mathbf{\Theta}}_{D}}={\left({{\theta_{R}},{\theta_{Y}},{\theta_{T}},{\theta%
_{PS}},{\theta_{HPS}}}\right)_{D}}
\{{{{\mathbf{T}}_{t:t+{\tau_{\max}}-1}},{{\mathbf{Y}}_{t+2:t+{\tau_{\max}}}},S%
}\}\cup\{{{{\mathbf{\Phi}}_{t}},{{\mathbf{M}}_{t}},{{{\mathbf{\hat{Y}}}}_{t+1}%
}}\}
{({{\theta_{R}},{\theta_{T}},{\theta_{PS}}})_{D}}\leftarrow{({{\theta_{R}},{%
\theta_{T}},{\theta_{PS}}})_{D}}-\eta\Delta({\frac{1}{B}\sum\nolimits_{B}{\sum%
\nolimits_{t=2}^{{\tau_{\max}}}{({\mathcal{L}{{}_{t,y}}+\lambda\mathcal{L}{{}_%
{t,ps}}})}}})
{({{\theta_{R}},{\theta_{Y}},{\theta_{HPS}}})_{D}}\leftarrow{({{\theta_{R}},{%
\theta_{Y}},{\theta_{HPS}}})_{D}}-\eta\Delta({\frac{1}{B}\sum\nolimits_{B}{%
\sum\nolimits_{t=2}^{{\tau_{\max}}}{({\mathcal{L}{{}_{t,y}}+\lambda\mathcal{L}%
{{}_{t,hps}}})}}})
Decoder({\mathbf{\bar{H}}}_{i,t};{\mathbf{\Theta}}_{D})
\displaystyle Y(t)=({{\beta_{1}}{X_{t}}-{\beta_{2}}{T_{t}}+\varepsilon})\times
Y%
({t-1})
\displaystyle Y(t)
\displaystyle=({{\beta_{1}}{X_{t}}-{\beta_{2}}{T_{t}}+\varepsilon})\times Y({t%
-1})
\displaystyle+Base(t)\times{({Y({t-1})}/{Base({t-1})})^{g(d)}}
\displaystyle+Base(t)\times{({Y({t-1})}/{Base({t-1})})^{g(d)}}
({{\beta_{1}}{X_{t}}-{\beta_{2}}{T_{t}}+\varepsilon})\times Y({t-1})
{X_{t}}\sim N({0,1})
\beta_{1}=0.1
T_{t}
T_{t}=1
T_{t}=0
X_{t}
\displaystyle T_{t}=\begin{cases}1&\text{ if }\overleftarrow{X}_{t}\geq%
\overleftarrow{x}_{10th}\\
0&\text{ if }\overleftarrow{X}_{t}<\overleftarrow{x}_{10th}\end{cases}
\displaystyle T_{t}=\begin{cases}1&\text{ if }\overleftarrow{X}_{t}\geq%
\overleftarrow{x}_{10th}\\
0&\text{ if }\overleftarrow{X}_{t}<\overleftarrow{x}_{10th}\end{cases}
\displaystyle\overleftarrow{X}_{t,\omega}=\frac{1}{\min(t,\omega)}\sum_{\max(0%
,t-\omega)}^{t}X_{t}
\displaystyle\overleftarrow{X}_{t,\omega}=\frac{1}{\min(t,\omega)}\sum_{\max(0%
,t-\omega)}^{t}X_{t}
\overleftarrow{X}_{t,\omega}
\overleftarrow{x}_{10th}
\overleftarrow{X}_{t}
\beta_{2}
\beta_{2}=[0.2,0.4,0.8]
p_{c}=[0.6,0.3,0.1]
Base(t)
Base(t)=\Psi-\lambda\times\frac{exp(-(\phi(t)-\mu)^{2}/{2\sigma^{2}}}{\sigma%
\sqrt{2\pi}}
\Psi
\lambda
\mu
\sigma
\Psi=80
\mu=6
\sigma=1
\phi(t)\in\{1,2,\dots,12\}
\phi(t)={t\%360}/30
t\in\{1,2,\dots,720\}
({Y({t-1})}/{Base({t-1})})^{g(d)}
g(d)
g(d)=\begin{cases}1.25-0.25d&\text{if }1\leq d=(t-t_{c})\leq 5\\
0&\text{others}\end{cases}
t_{c}
\mathbf{{\tilde{T}}}_{(t,t+\tau-1)}
Y_{t+1}
t+\tau_{max}-1
\tau_{max}=2
\mathbf{{\tilde{T}}}_{(t,t+1)}=\{[1,0],[0,1],[0,0]\}
\displaystyle{C\!R\!M\!S\!E}_{t}=\sqrt{\frac{1}{N}\!\sum_{i=1}^{N}(c_{\tau}\!-%
\!\hat{c}_{\tau})^{2}}
\displaystyle{C\!R\!M\!S\!E}_{t}
\displaystyle=\sqrt{\frac{1}{N}\!\sum_{i=1}^{N}(c_{\tau}\!-\!\hat{c}_{\tau})^{%
2}}
\displaystyle=\sqrt{\frac{1}{N}\!\sum_{i=1}^{N}((Y_{true,\tau}^{1}\!-\!Y_{true%
,\tau}^{0}))\!-\!(Y_{pred,\tau}^{1}\!-Y_{pred,\tau}^{0}))^{2}}
\displaystyle=\sqrt{\frac{1}{N}\!\sum_{i=1}^{N}((Y_{true,\tau}^{1}\!-\!Y_{true%
,\tau}^{0}))\!-\!(Y_{pred,\tau}^{1}\!-Y_{pred,\tau}^{0}))^{2}}
c_{\tau}
\hat{c}_{\tau}
Y^{1}
Y^{0}
\tau_{max}
\omega=5
\omega=5
\tau=1
\tau=2
\tau=3
\tau=4
\tau=5
\tau=6
\omega
\omega
\tau_{max}=5
\omega=5
\omega=5
\tau=1
\tau=2
\tau=3
\tau=4
\tau=5
\tau=1
\tau=2
\tau=3
\tau=4
\tau=5
\tau=6
\omega=5
\omega=5
\tau=1
\tau=2
\tau=3
\tau=4
\tau=5
\tau=6
