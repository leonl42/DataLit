{{\bf{x}}}
t
{{\bf{x}}}_{t}
\hat{y}_{t}
y_{t}
{{\bf{x}}}_{t+1}
\{({{\bf{x}}}_{1},y_{1}),\ldots,({{\bf{x}}}_{t},y_{t})\}
{{\bf{x}}}_{t}
y_{t}
{{\bf{x}}}_{t}
{{\bf{h}}}_{t}\in R^{d}
{\boldsymbol{\beta}}_{y}\in R^{d}
y
r_{ty}
y
x_{t}
\begin{split}r_{ty}=\frac{\exp({\boldsymbol{\beta}}_{y}{{\bf{h}}}_{t})}{\sum_{%
z}\exp({\boldsymbol{\beta}}_{z}{{\bf{h}}}_{t})}=\text{softmax}({\boldsymbol{%
\beta}}{{\bf{h}}}_{t})\end{split}
N
m
\ell_{m}
m
{{\bf{v}}}_{m}
m
{\alpha}_{m}
{{\bf{v}}}_{m}
\ell_{m}
y
y
y
{{\bf{x}}}_{t}
{{\bf{h}}}_{t}
{{\bf{x}}}_{t}
{{\bf{h}}}_{t}
K({{\bf{h}}}_{t},{{\bf{v}}}_{m})=\exp(\lambda~{}\text{cosine}({{\bf{h}}}_{t},{%
{\bf{v}}}_{m}))
{{\bf{h}}}_{t}
y
M_{ty}
\alpha_{ty}
\begin{split}M_{ty},\alpha_{ty}=\sum_{m:\ell_{m}=y}w_{tm}\{{{\bf{v}}}_{m},{%
\alpha}_{m}\}\\
w_{tm}=\frac{K({{\bf{h}}}_{t},{{\bf{v}}}_{m})}{\sum_{m^{\prime}:\ell_{m^{%
\prime}}=y}K({{\bf{h}}}_{t},{{\bf{v}}}_{m^{\prime}})}\end{split}
y
M_{ty}
y
{s}_{ty}=\frac{\alpha_{ty}^{\delta}K({{\bf{h}}}_{t},M_{ty})}{\sum_{y^{\prime}}%
\alpha_{ty^{\prime}}^{\delta}K({{\bf{h}}}_{t},M_{ty^{\prime}})}
\delta
\alpha_{ty}
y
r_{ty}
{s}_{ty}
\theta
\theta
\theta
\theta
{{\bf{h}}}_{t}
e^{m}_{t-1},e^{pcn}_{t-1}
\begin{split}\theta_{ty}&=\sigma(W_{\theta}\mu_{ty}+b_{\theta})\\
\mu_{ty}&=\text{RNN}(\mu_{t-1,y},\{{{\bf{h}}}_{t},e^{pcn}_{t-1},e^{m}_{t-1},r_%
{t-1,y},{s}_{t-1,y}\})\\
\end{split}
{{\bf{x}}}_{t}
P_{t}(y|{{\bf{x}}}_{t})\propto(1-\theta_{ty})r_{ty}+\theta_{ty}{s}_{ty}
P_{t}(y|{{\bf{x}}})
\theta_{ty}
t,y
y_{t}
{{\bf{x}}}_{t}
\alpha
\log P_{t}(y_{t}|{{\bf{x}}}_{t})-\max_{y\neq y_{t}}\log(y|{{\bf{x}}}_{t})
{{\bf{v}}}_{m}
\alpha_{m}
m
t
y_{t}
{{\bf{v}}}_{m}={{\bf{v}}}_{m}+w_{tm}{{{\bf{h}}}_{t}}
w_{tm}
{{\bf{h}}}_{t}
m
\alpha_{m}
w_{tm}
{{\bf{h}}}_{t}
y_{t}
\alpha_{m}
y_{t}
y_{t},P_{t}(y|{{\bf{x}}}_{t}),{{\bf{h}}}_{t},M_{t}=\{(\ell_{m},{{\bf{h}}}_{m},%
\alpha_{m})\}
\hat{y}={\text{argmax}}_{y}P_{t}(y|{{\bf{x}}}_{t})
\tilde{y}={\text{argmax}}_{y\neq y_{t}}P_{t}(y|{{\bf{x}}}_{t})
{\text{l}oss}_{t}=-\min(0,\log P_{t}(y_{t}|{{\bf{x}}}_{t})-\log P_{t}(\tilde{y%
}|{{\bf{x}}}_{t})-\text{margin})
{\text{l}oss}_{t}=0
C
(\ell_{y_{t}},{{\bf{h}}}_{t},1)
j={\text{argmin}}_{m:\ell_{m}=y_{t}}\alpha_{m}
{{\bf{w}}}_{t}=\text{softmax}\{\text{Cosine}({{\bf{h}}}_{t}^{T}{{\bf{v}}}_{m})%
:\ell_{m}=y_{t}\}
{{\bf{v}}}_{m}={{\bf{v}}}_{m}+w_{tm}{{{\bf{h}}}_{t}}~{}~{}~{}~{}\forall m:\ell%
_{m}=y_{t}
\alpha_{m}=\alpha_{m}*\text{decay}+w_{tm}~{}~{}~{}~{}\forall m:\ell_{m}=y_{t}
y_{t}\neq\hat{y}
|m:\ell_{m}=y_{t}|>1
j
C
\bf{h}
\bf{h}
\alpha_{ty}^{\delta}K({{\bf{h}}}_{t},\bf{h})
\bf{h}
\alpha
{{\bf{x}}}_{t}
{{\bf{h}}}_{m}
\alpha_{m}
x_{1},\ldots,x_{n}
y_{t}
t
x_{t+1}
y_{t-1}
y_{t-1}
\theta_{ty}
t
y
\frac{10}{7}
63\%
{{\bf{h}}}_{t}
