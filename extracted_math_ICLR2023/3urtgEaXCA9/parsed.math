u
u
u
\tau_{m}\frac{du}{dt}=-(u-u_{rest})+R\cdot I(t),\text{for}\,u<V_{th}
I
V_{th}
R
\tau_{m}
u
V_{th}
t^{f}
u
s(t)=\sum_{t^{f}}\delta(t-t^{f})
I_{i}(t)=\sum_{j}w_{ij}s_{j}(t)+b_{i}
i,j
w_{ij}
b_{i}
\left\{\begin{aligned} &u_{i}\left[t+1\right]=\lambda(u_{i}[t]-V_{th}s_{i}[t])%
+\sum_{j}w_{ij}s_{j}[t]+b_{i},\\
&s_{i}[t+1]=H(u_{i}\left[t+1\right]-V_{th}).\\
\end{aligned}\right.
H(x)
s_{i}[t]
t
\lambda<1
1-\frac{1}{\tau_{m}}
\mathbf{s}^{l+1}[t]
(l+1)
\mathbf{s}^{l}[t]
l
\mathbf{u}^{l+1}[t+1]=\lambda(\mathbf{u}^{l+1}[t]-V_{th}\mathbf{s}^{l+1}[t])+%
\mathbf{W}^{l}\mathbf{s}^{l}[t+1]+\mathbf{b}^{l}
\hat{\mathbf{a}}^{l}[t]=\sum_{\tau\leq t}\lambda^{t-\tau}\mathbf{s}^{l}[\tau]
\mathbf{g}_{\mathbf{u}^{l+1}}[t]=\left(\frac{\partial\mathcal{L}[t]}{\partial%
\mathbf{s}^{N}[t]}\prod_{i=0}^{N-l-2}\frac{\partial\mathbf{s}^{N-i}[t]}{%
\partial\mathbf{s}^{N-i-1}[t]}\frac{\partial\mathbf{s}^{l+1}[t]}{\partial%
\mathbf{u}^{l+1}[t]}\right)^{\top}
\nabla_{\mathbf{W}^{l}}\mathcal{L}[t]=\mathbf{g}_{\mathbf{u}^{l+1}}[t]{\hat{%
\mathbf{a}}^{l}[t]}^{\top}
{\frac{\partial\mathbf{s}^{l}[t]}{\partial\mathbf{u}^{l}[t]}}
\mathbf{g}_{\mathbf{u}^{l+1}}[t]
\bm{\theta}
\mathcal{L}(\bm{\theta})
\mathbf{z}
\nabla^{ZO}\mathcal{L}(\bm{\theta})=\frac{\mathcal{L}(\bm{\theta}+\alpha%
\mathbf{z})-\mathcal{L}(\bm{\theta}-\alpha\mathbf{z})}{2\alpha}\mathbf{z}%
\approx\mathbf{z}\mathbf{z}^{\top}\nabla\mathcal{L}(\bm{\theta}),
\mathbf{z}
\alpha
\nabla^{ZO}\mathcal{L}(\bm{\theta})=\frac{\mathcal{L}(\bm{\theta}+\alpha%
\mathbf{z})-\mathcal{L}(\bm{\theta})}{\alpha}\mathbf{z}.
\mathbf{z}
\alpha\rightarrow 0
\nabla^{ZO}\mathcal{L}(\bm{\theta})
\nabla\mathcal{L}(\bm{\theta})
\mathbb{E}_{\mathbf{z}}\left[\nabla^{ZO}\mathcal{L}(\bm{\theta})\right]=\nabla%
\mathcal{L}(\bm{\theta})
\mathbf{z}
\mathcal{L}(\bm{\theta})
{}_{\text{sp}}
\nabla^{ZO_{sp}}\mathcal{L}(\bm{\theta})=\frac{\mathcal{L}(\bm{\theta}+\alpha%
\mathbf{z})}{\alpha}\mathbf{z}.
\mathbf{z}
\alpha\rightarrow 0
\nabla^{ZO_{sp}}\mathcal{L}(\bm{\theta})
\nabla\mathcal{L}(\bm{\theta})
\mathbf{z}
f(\cdot;\bm{\theta})
\mathcal{L}(\cdot)
\mathbf{x}
\mathbf{o}=f(\mathbf{x};\bm{\theta})
\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}})
\mathbf{y}_{\mathbf{x}}
\mathcal{L}\circ f
\mathcal{L}(\cdot)
f(\cdot;\bm{\theta})
\nabla_{\mathbf{o}}\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}})=\mathbf{o}-%
\mathbf{y}_{\mathbf{x}}
\sigma
\nabla_{\mathbf{o}}\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}})=\sigma(%
\mathbf{o})-\mathbf{y}_{\mathbf{x}}
f(\cdot;\bm{\theta})
\mathbf{e}=\nabla_{\mathbf{o}}\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}})
\mathcal{L}\circ f(\mathbf{x})
f(\cdot;\bm{\theta})
\mathcal{L}(\cdot)
\mathcal{L}(\cdot)
\nabla^{ZO}_{\bm{\theta}}\mathcal{L}\approx\frac{\left<\nabla_{\mathbf{o}}%
\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}}),\tilde{\mathbf{o}}-\mathbf{o}%
\right>}{\alpha}\mathbf{z}=\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha}%
\nabla_{\mathbf{o}}\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}}),
\mathbf{o}=f(\mathbf{x};\bm{\theta}),\tilde{\mathbf{o}}=f(\mathbf{x};\bm{%
\theta}+\alpha\mathbf{z})
\Delta\mathbf{o}=\tilde{\mathbf{o}}-\mathbf{o}
\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha}
\mathbf{z}
\displaystyle\mathbf{M}\coloneqq\lambda\mathbf{M}+(1-\lambda)\mathbf{z}\frac{{%
\Delta\mathbf{o}}^{\top}}{\alpha},
\displaystyle\mathbf{M}
\displaystyle\coloneqq\lambda\mathbf{M}+(1-\lambda)\mathbf{z}\frac{{\Delta%
\mathbf{o}}^{\top}}{\alpha},
\displaystyle\nabla^{PZO}_{\bm{\theta}}\mathcal{L}=\mathbf{M}\nabla_{\mathbf{o%
}}\mathcal{L}(\mathbf{o},\mathbf{y}_{\mathbf{x}}).
\displaystyle\nabla^{PZO}_{\bm{\theta}}\mathcal{L}
\displaystyle=\mathbf{M}\nabla_{\mathbf{o}}\mathcal{L}(\mathbf{o},\mathbf{y}_{%
\mathbf{x}}).
\mathbf{z}
\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha}
\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right]
\mathbf{J}_{f}(\mathbf{x})
f
\mathbf{x}
\mathbf{M}
\mathbf{M}
\mathbf{M}\coloneqq\lambda\mathbf{M}+(1-\lambda)\mathbf{z}\frac{{\tilde{%
\mathbf{o}}}^{\top}}{\alpha},\vspace{-1mm}
\frac{{\tilde{\mathbf{o}}}^{\top}}{\alpha}
\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right]
\mathbf{z}
\alpha\rightarrow 0
\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha}
\mathbf{z}\frac{{\tilde{\mathbf{o}}}^{\top}}{\alpha}
{\mathbf{J}_{f}^{\top}(\mathbf{x})}
\mathbf{x}
\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right]
\alpha\mathbf{z}
\mathbf{z}
\tilde{\mathbf{o}}
\nabla_{\mathbf{o}}\mathcal{L}(\tilde{\mathbf{o}},\mathbf{y}_{\mathbf{x}})
\tilde{\mathbf{o}}
\mathbf{x}^{l+1}
\mathbf{x}^{l+1}=\phi\left(\mathbf{W}^{l}\mathbf{x}^{l}\right)
\nabla_{\mathbf{W}^{l}}\mathcal{L}=\left(\nabla_{\mathbf{x}^{l+1}}\mathcal{L}%
\odot\phi^{\prime}\left(\mathbf{W}^{l}\mathbf{x}^{l}\right)\right){\mathbf{x}^%
{l}}^{\top}
\mathbf{M}
\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right]
\bm{\epsilon}
\mathbf{M}
\mathbf{M}
\mathbf{M}=\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}%
\right]+\mathbf{\epsilon}
d
\bm{\theta}
m
\mathbf{o}
m\ll d
B
\beta=\mathrm{Var}\left[z_{i}^{2}\right]
V_{\bm{\theta}}=\frac{1}{d}\sum_{i}\mathrm{Var}\left[(\nabla_{\bm{\theta}}%
\mathcal{L}_{\mathbf{x}})_{i}\right],S_{\bm{\theta}}=\frac{1}{d}\sum_{i}%
\mathbb{E}\left[(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}})_{i}\right]^{2},%
V_{L}=\mathrm{Var}\left[\mathcal{L}_{\mathbf{x}}\right],S_{L}=\mathbb{E}\left[%
\mathcal{L}_{\mathbf{x}}\right]^{2}
V_{\mathbf{o}}=\frac{1}{m}\sum_{i}\mathrm{Var}\left[(\nabla_{\mathbf{o}}%
\mathcal{L}_{\mathbf{x}})_{i}\right],S_{\mathbf{o}}=\frac{1}{m}\sum_{i}\mathbb%
{E}\left[(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}})_{i}\right]^{2}
\mathcal{L}_{\mathbf{x}}
\mathbf{x}
\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}
\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}
\bm{\theta}
\mathbf{o}
\bm{\epsilon}
V_{\bm{\epsilon}}
V_{\mathbf{o},\mathbf{M}}=\frac{1}{d}\sum_{i,j}\mathrm{Var}\left[(\nabla_{%
\mathbf{o}}\mathcal{L}_{\mathbf{x}})_{j}\right](\mathbb{E}_{\mathbf{x}}\left[{%
\mathbf{J}_{f}^{\top}(\mathbf{x})}\right])_{i,j}
\frac{1}{B}\left((d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+\frac{1}{%
\alpha^{2}}V_{L}+\frac{1}{\alpha^{2}}S_{L}\right)+O(\alpha^{2}),
\frac{1}{B}\left(mV_{\bm{\epsilon}}V_{\mathbf{o}}+mV_{\bm{\epsilon}}S_{\mathbf%
{o}}+V_{\mathbf{o},\mathbf{M}}\right).
V_{\bm{\theta}}
V_{\mathbf{o},\mathbf{M}}
V_{\bm{\theta}}
V_{\bm{\epsilon}}
d
\mathbf{x}
{\mathbf{J}_{f}^{\top}(\mathbf{x})}
L_{J}
\mathbf{e}(\mathbf{x})
L_{e}
\mathbf{x}_{i}
\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_%
{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert>\frac{1}{2}L_{J}L_{e}\Delta%
_{\mathbf{x}}+e_{\bm{\epsilon}}
\Delta_{\mathbf{x}}=\mathbb{E}_{\mathbf{x}_{i},\mathbf{x}_{j}}\left[\left%
\lVert\mathbf{x}_{i}-\mathbf{x}_{j}\right\rVert^{2}\right]
e_{\bm{\epsilon}}=\left\lVert\bm{\epsilon}\mathbb{E}_{\mathbf{x}_{i}}\left[%
\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\left<\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})}%
\mathbf{e}(\mathbf{x}_{i})\right],\mathbb{E}_{\mathbf{x}_{i}}\left[\mathbf{M}%
\mathbf{e}(\mathbf{x}_{i})\right]\right>>0
\Delta W_{i,j}\propto\hat{a}_{i}[t]\psi(u_{j}[t])\left(-g_{j}^{t}\right),
W_{i,j}
i
j
\hat{a}_{i}[t]
\psi(u_{j}[t])
g_{j}^{t}
\Delta t
\hat{a}_{i}[t+\Delta t]\psi(u_{j}[t+\Delta t])g_{j}^{t}
\hat{a}_{i}[t]\psi(u_{j}[t])
\mathbf{z}
1
-1
0.5
\mathbf{z}
\mathbf{z}
\mathbf{z}
-\mathbf{z}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
{}_{\text{sp}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
T=30
T=20
T=10
T=6
{}_{\text{sp}}
{}_{\text{sp}}
i
i
{}_{\text{sp}}
i
i
{}_{\text{sp}}
1/\alpha
\mathbf{M}
\alpha
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
{}_{\text{sp}}
65.15\%
{}_{\text{sp}}
{}_{\text{sp}}
N
n
m
m\ll n
N
n
m
m\ll n
O\left((N-1)n^{2}+mn\right)
O\left((N-1)n^{2}+mn\right)
O\left(Nmn\right)
O\left(Nmn\right)
{}_{\text{sp}}
O(Nn)
O(Nn)
O\left(Nmn\right)
O\left(Nmn\right)
\alpha\rightarrow 0
\nabla^{ZO}\mathcal{L}(\bm{\theta})=\mathbf{z}\mathbf{z}^{\top}\nabla\mathcal{%
L}(\bm{\theta})
\mathbf{z}
\mathbb{E}\left[\mathbf{z}\mathbf{z}^{\top}\right]=\mathbf{I}
\mathbb{E}_{\mathbf{z}}\left[\nabla^{ZO}\mathcal{L}(\bm{\theta})\right]=\nabla%
\mathcal{L}(\bm{\theta})
\mathbb{E}_{\mathbf{z}}\left[\nabla^{ZO}\mathcal{L}(\bm{\theta})\right]=%
\mathbb{E}_{\mathbf{z}}\left[\frac{\mathcal{L}(\bm{\theta}+\alpha\mathbf{z})-%
\mathcal{L}(\bm{\theta})}{\alpha}\mathbf{z}\right]=\mathbb{E}_{\mathbf{z}}%
\left[\frac{\mathcal{L}(\bm{\theta}+\alpha\mathbf{z})}{\alpha}\mathbf{z}\right%
]-\frac{\mathcal{L}(\mathbf{\theta})}{\alpha}\mathbb{E}_{\mathbf{z}}\left[%
\mathbf{z}\right]=\mathbb{E}_{\mathbf{z}}\left[\frac{\mathcal{L}(\bm{\theta}+%
\alpha\mathbf{z})}{\alpha}\mathbf{z}\right]=\mathbb{E}_{\mathbf{z}}\left[%
\nabla^{ZO_{sp}}\mathcal{L}(\bm{\theta})\right]
\mathbb{E}_{\mathbf{z}}\left[\nabla^{ZO_{sp}}\mathcal{L}(\bm{\theta})\right]=%
\nabla\mathcal{L}(\bm{\theta})
\alpha\rightarrow 0
\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha}=\mathbf{z}\left(\mathbf{J}_%
{f}(\mathbf{x})\mathbf{z}\right)^{\top}=\mathbf{z}\mathbf{z}^{\top}\mathbf{J}_%
{f}^{\top}(\mathbf{x})
\mathbb{E}\left[\mathbf{z}\mathbf{z}^{\top}\right]=\mathbf{I}
\mathbb{E}_{\mathbf{z}}\left[\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha%
}\middle|\mathbf{x}\right]=\mathbf{J}_{f}^{\top}(\mathbf{x})
\mathbb{E}_{\mathbf{x},\mathbf{z}}\left[\mathbf{z}\frac{{\Delta\mathbf{o}}^{%
\top}}{\alpha}\right]=\mathbb{E}_{\mathbf{x}}\left[\mathbf{J}_{f}^{\top}(%
\mathbf{x})\right]
\mathbb{E}_{\mathbf{z}}\left[\mathbf{z}\frac{{\tilde{\mathbf{o}}}^{\top}}{%
\alpha}\middle|\mathbf{x}\right]=\mathbb{E}_{\mathbf{z}}\left[\mathbf{z}\frac{%
{\Delta\mathbf{o}}^{\top}}{\alpha}+\mathbf{z}\frac{{\mathbf{o}}^{\top}}{\alpha%
}\middle|\mathbf{x}\right]=\mathbb{E}_{\mathbf{z}}\left[\mathbf{z}\frac{{%
\Delta\mathbf{o}}^{\top}}{\alpha}\middle|\mathbf{x}\right]+\mathbb{E}_{\mathbf%
{z}}\left[\mathbf{z}\right]\frac{{\mathbf{o}}^{\top}}{\alpha}=\mathbb{E}_{%
\mathbf{z}}\left[\mathbf{z}\frac{{\Delta\mathbf{o}}^{\top}}{\alpha}\middle|%
\mathbf{x}\right]=\mathbf{J}_{f}^{\top}(\mathbf{x})
\mathbb{E}_{\mathbf{x},\mathbf{z}}\left[\mathbf{z}\frac{{\tilde{\mathbf{o}}}^{%
\top}}{\alpha}\right]=\mathbb{E}_{\mathbf{x}}\left[\mathbf{J}_{f}^{\top}(%
\mathbf{x})\right]
\nabla_{\bm{\theta}}^{ZO}\mathcal{L}=\mathbf{z}\mathbf{z}^{\top}\nabla_{\bm{%
\theta}}\mathcal{L}+O(\alpha)
\mathrm{Var}(xy)=\mathrm{Var}(x)\mathrm{Var}(y)+\mathrm{Var}(x){\mathbb{E}(y)}%
^{2}+\mathrm{Var}(y){\mathbb{E}(x)}^{2}
x
y
\mathbb{E}[z_{i}^{2}]=\mathrm{Var}[z_{i}]+{\mathbb{E}[z_{i}]}^{2}=1
\mathbf{x}
\displaystyle\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}^{ZO}\mathcal{L}_{%
\mathbf{x}}\right)_{i}\right]=\mathrm{Var}\left[\sum_{j=1}^{d}z_{i}z_{j}\left(%
\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+O(\alpha^{2})
\displaystyle\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}^{ZO}\mathcal{L}_{%
\mathbf{x}}\right)_{i}\right]
\displaystyle=\mathrm{Var}\left[\sum_{j=1}^{d}z_{i}z_{j}\left(\nabla_{\bm{%
\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+O(\alpha^{2})
\displaystyle=\mathrm{Var}\left[z_{i}^{2}\left(\nabla_{\bm{\theta}}\mathcal{L}%
_{\mathbf{x}}\right)_{i}\right]+\sum_{j\neq i}\mathrm{Var}\left[z_{i}z_{j}%
\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+O(\alpha^%
{2})
\displaystyle=\mathrm{Var}\left[z_{i}^{2}\left(\nabla_{\bm{\theta}}\mathcal{L}%
_{\mathbf{x}}\right)_{i}\right]+\sum_{j\neq i}\mathrm{Var}\left[z_{i}z_{j}%
\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+O(\alpha^%
{2})
\displaystyle=\mathrm{Var}\left[z_{i}^{2}\right]\mathrm{Var}\left[\left(\nabla%
_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]+\mathrm{Var}\left[z_{%
i}^{2}\right]{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x%
}}\right)_{i}\right]}^{2}+\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal%
{L}_{\mathbf{x}}\right)_{i}\right]{\mathbb{E}\left[z_{i}^{2}\right]}^{2}
\displaystyle=\mathrm{Var}\left[z_{i}^{2}\right]\mathrm{Var}\left[\left(\nabla%
_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]+\mathrm{Var}\left[z_{%
i}^{2}\right]{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x%
}}\right)_{i}\right]}^{2}+\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal%
{L}_{\mathbf{x}}\right)_{i}\right]{\mathbb{E}\left[z_{i}^{2}\right]}^{2}
\displaystyle\quad+\sum_{j\neq i}\left(\mathrm{Var}\left[z_{i}z_{j}\right]%
\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j%
}\right]+\mathrm{Var}\left[z_{i}z_{j}\right]{\mathbb{E}\left[\left(\nabla_{\bm%
{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}+\mathrm{Var}\left[%
\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]{\mathbb{E%
}\left[z_{i}z_{j}\right]}^{2}\right)+O(\alpha^{2})
\displaystyle\quad+\sum_{j\neq i}\left(\mathrm{Var}\left[z_{i}z_{j}\right]%
\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j%
}\right]+\mathrm{Var}\left[z_{i}z_{j}\right]{\mathbb{E}\left[\left(\nabla_{\bm%
{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}+\mathrm{Var}\left[%
\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]{\mathbb{E%
}\left[z_{i}z_{j}\right]}^{2}\right)+O(\alpha^{2})
\displaystyle=(\beta+1)\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}%
_{\mathbf{x}}\right)_{i}\right]+\beta{\mathbb{E}\left[\left(\nabla_{\bm{\theta%
}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]}^{2}+\sum_{j\neq i}\left(\mathrm{%
Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]%
+{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j%
}\right]}^{2}\right)+O(\alpha^{2})
\displaystyle=(\beta+1)\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}%
_{\mathbf{x}}\right)_{i}\right]+\beta{\mathbb{E}\left[\left(\nabla_{\bm{\theta%
}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]}^{2}+\sum_{j\neq i}\left(\mathrm{%
Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]%
+{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j%
}\right]}^{2}\right)+O(\alpha^{2})
\displaystyle=\beta\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{%
\mathbf{x}}\right)_{i}\right]+(\beta-1){\mathbb{E}\left[\left(\nabla_{\bm{%
\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]}^{2}+\sum_{j=1}^{d}\left(%
\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j%
}\right]+{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}%
\right)_{j}\right]}^{2}\right)+O(\alpha^{2}).
\displaystyle=\beta\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{%
\mathbf{x}}\right)_{i}\right]+(\beta-1){\mathbb{E}\left[\left(\nabla_{\bm{%
\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]}^{2}+\sum_{j=1}^{d}\left(%
\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j%
}\right]+{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}%
\right)_{j}\right]}^{2}\right)+O(\alpha^{2}).
\mathrm{mVar}
\displaystyle\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{ZO}\mathcal{L}_{\mathbf{%
x}}\right]=\frac{1}{d}\sum_{i=1}^{d}\mathrm{Var}\left[\left(\nabla_{\bm{\theta%
}}^{ZO}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]
\displaystyle\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{ZO}\mathcal{L}_{\mathbf{%
x}}\right]
\displaystyle=\frac{1}{d}\sum_{i=1}^{d}\mathrm{Var}\left[\left(\nabla_{\bm{%
\theta}}^{ZO}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]
\displaystyle=\frac{\beta}{d}\sum_{i=1}^{d}\mathrm{Var}\left[\left(\nabla_{\bm%
{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]+\frac{\beta-1}{d}\sum_{i=1%
}^{d}{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right%
)_{i}\right]}^{2}+\sum_{j=1}^{d}\left(\mathrm{Var}\left[\left(\nabla_{\bm{%
\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+{\mathbb{E}\left[\left(%
\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}\right)+O(%
\alpha^{2})
\displaystyle=\frac{\beta}{d}\sum_{i=1}^{d}\mathrm{Var}\left[\left(\nabla_{\bm%
{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}\right]+\frac{\beta-1}{d}\sum_{i=1%
}^{d}{\mathbb{E}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right%
)_{i}\right]}^{2}+\sum_{j=1}^{d}\left(\mathrm{Var}\left[\left(\nabla_{\bm{%
\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+{\mathbb{E}\left[\left(%
\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}\right)+O(%
\alpha^{2})
\displaystyle=(d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+O(\alpha^{2}).
\displaystyle=(d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+O(\alpha^{2}).
B
B
\frac{1}{B}\left((d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}\right)+O(%
\alpha^{2})
\nabla_{\bm{\theta}}^{ZO_{sp}}\mathcal{L}=\nabla_{\bm{\theta}}^{ZO}\mathcal{L}%
+\frac{\mathcal{L}_{\mathbf{x}}}{\alpha}\mathbf{z}
\displaystyle\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{ZO_{sp}}\mathcal{L}_{%
\mathbf{x}}\right]=\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{ZO}\mathcal{L}_{%
\mathbf{x}}\right]+\mathrm{mVar}\left[\frac{\mathcal{L}_{\mathbf{x}}}{\alpha}%
\mathbf{z}\right]
\displaystyle\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{ZO_{sp}}\mathcal{L}_{%
\mathbf{x}}\right]
\displaystyle=\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{ZO}\mathcal{L}_{\mathbf%
{x}}\right]+\mathrm{mVar}\left[\frac{\mathcal{L}_{\mathbf{x}}}{\alpha}\mathbf{%
z}\right]
\displaystyle=(d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+O(\alpha^{2}%
)+\frac{1}{\alpha^{2}}\left(\mathrm{Var}\left[\mathcal{L}_{\mathbf{x}}\right]%
\mathrm{Var}\left[z_{i}\right]+\mathrm{Var}\left[\mathcal{L}_{\mathbf{x}}%
\right]{\mathbb{E}\left[z_{i}\right]}^{2}+\mathrm{Var}\left[z_{i}\right]{%
\mathbb{E}\left[\mathcal{L}_{\mathbf{x}}\right]}^{2}\right)
\displaystyle=(d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+O(\alpha^{2}%
)+\frac{1}{\alpha^{2}}\left(\mathrm{Var}\left[\mathcal{L}_{\mathbf{x}}\right]%
\mathrm{Var}\left[z_{i}\right]+\mathrm{Var}\left[\mathcal{L}_{\mathbf{x}}%
\right]{\mathbb{E}\left[z_{i}\right]}^{2}+\mathrm{Var}\left[z_{i}\right]{%
\mathbb{E}\left[\mathcal{L}_{\mathbf{x}}\right]}^{2}\right)
\displaystyle=(d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+\frac{1}{%
\alpha^{2}}V_{L}+\frac{1}{\alpha^{2}}S_{L}+O(\alpha^{2}).
\displaystyle=(d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+\frac{1}{%
\alpha^{2}}V_{L}+\frac{1}{\alpha^{2}}S_{L}+O(\alpha^{2}).
B
\frac{1}{B}\left((d+\beta)V_{\bm{\theta}}+(d+\beta-1)S_{\bm{\theta}}+\frac{1}{%
\alpha^{2}}V_{L}+\frac{1}{\alpha^{2}}S_{L}\right)+O(\alpha^{2})
\nabla^{PZO}_{\bm{\theta}}\mathcal{L}=\mathbf{M}\nabla_{\mathbf{o}}\mathcal{L}%
_{\mathbf{x}}=\left(\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(%
\mathbf{x})}\right])+\bm{\epsilon}\right)\nabla_{\mathbf{o}}\mathcal{L}_{%
\mathbf{x}}
\displaystyle\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}^{PZO}\mathcal{L}_{%
\mathbf{x}}\right)_{i}\right]=\mathrm{Var}\left[\sum_{j=1}^{m}\left(\mathbb{E}%
_{\mathbf{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right])\right)_{i,j}%
\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+\mathrm{%
Var}\left[\sum_{j=1}^{m}\epsilon_{i,j}\left(\nabla_{\mathbf{o}}\mathcal{L}_{%
\mathbf{x}}\right)_{j}\right]
\displaystyle\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}^{PZO}\mathcal{L}_{%
\mathbf{x}}\right)_{i}\right]
\displaystyle=\mathrm{Var}\left[\sum_{j=1}^{m}\left(\mathbb{E}_{\mathbf{x}}%
\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right])\right)_{i,j}\left(\nabla_{%
\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+\mathrm{Var}\left[\sum_{%
j=1}^{m}\epsilon_{i,j}\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)%
_{j}\right]
\displaystyle=\sum_{j=1}^{m}\left(\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}%
^{\top}(\mathbf{x})}\right])\right)_{i,j}\mathrm{Var}\left[\left(\nabla_{%
\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+\sum_{j=1}^{m}\left(V_{%
\bm{\epsilon}}\mathrm{Var}\left[\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{%
x}}\right)_{j}\right]+V_{\bm{\epsilon}}{\mathbb{E}\left[\left(\nabla_{\mathbf{%
o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}\right).
\displaystyle=\sum_{j=1}^{m}\left(\mathbb{E}_{\mathbf{x}}\left[{\mathbf{J}_{f}%
^{\top}(\mathbf{x})}\right])\right)_{i,j}\mathrm{Var}\left[\left(\nabla_{%
\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+\sum_{j=1}^{m}\left(V_{%
\bm{\epsilon}}\mathrm{Var}\left[\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{%
x}}\right)_{j}\right]+V_{\bm{\epsilon}}{\mathbb{E}\left[\left(\nabla_{\mathbf{%
o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}\right).
\displaystyle\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{PZO}\mathcal{L}_{\mathbf%
{x}}\right]=\frac{1}{d}\sum_{i=1}^{d}\sum_{j=1}^{m}\left(\mathbb{E}_{\mathbf{x%
}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right])\right)_{i,j}\mathrm{Var}%
\left[\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+\sum%
_{j=1}^{m}\left(V_{\bm{\epsilon}}\mathrm{Var}\left[\left(\nabla_{\mathbf{o}}%
\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+V_{\bm{\epsilon}}{\mathbb{E}\left[%
\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}\right)
\displaystyle\mathrm{mVar}\left[\nabla_{\bm{\theta}}^{PZO}\mathcal{L}_{\mathbf%
{x}}\right]
\displaystyle=\frac{1}{d}\sum_{i=1}^{d}\sum_{j=1}^{m}\left(\mathbb{E}_{\mathbf%
{x}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x})}\right])\right)_{i,j}\mathrm{Var}%
\left[\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+\sum%
_{j=1}^{m}\left(V_{\bm{\epsilon}}\mathrm{Var}\left[\left(\nabla_{\mathbf{o}}%
\mathcal{L}_{\mathbf{x}}\right)_{j}\right]+V_{\bm{\epsilon}}{\mathbb{E}\left[%
\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}\right]}^{2}\right)
\displaystyle=mV_{\bm{\epsilon}}V_{\mathbf{o}}+mV_{\bm{\epsilon}}S_{\mathbf{o}%
}+V_{\mathbf{o},\mathbf{M}}.
\displaystyle=mV_{\bm{\epsilon}}V_{\mathbf{o}}+mV_{\bm{\epsilon}}S_{\mathbf{o}%
}+V_{\mathbf{o},\mathbf{M}}.
B
\frac{1}{B}\left(mV_{\bm{\epsilon}}V_{\mathbf{o}}+mV_{\bm{\epsilon}}S_{\mathbf%
{o}}+V_{\mathbf{o},\mathbf{M}}\right)
\beta=\mathrm{Var}\left[z_{i}^{2}\right]=\mathbb{E}(z_{i}^{4})-{\mathbb{E}(z_{%
i}^{2})}^{2}=\mathbb{E}(z_{i}^{4})-1
z_{i}
\mathbb{E}(z_{i}^{4})=3
\beta=2
\mathbb{E}(z_{i}^{4})=1
\beta=0
\bm{\epsilon}
\mathbf{z}\frac{{\tilde{\mathbf{o}}}^{\top}}{\alpha}
\mathbb{E}_{\mathbf{x}}\left[\mathbf{J}_{f}^{\top}(\mathbf{x})\right]
V_{\bm{\theta}}
V_{\mathbf{o},\mathbf{M}}
\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i}=\left(\mathbf{J}%
_{f}^{\top}(\mathbf{x})\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{i}
\mathbf{J}_{i,j}
\nabla_{j}
\left(\mathbf{J}_{f}^{\top}(\mathbf{x})\right)_{i,j}
\left(\nabla_{\mathbf{o}}\mathcal{L}_{\mathbf{x}}\right)_{j}
\mathrm{Var}\left[\left(\nabla_{\bm{\theta}}\mathcal{L}_{\mathbf{x}}\right)_{i%
}\right]=\mathrm{Var}\left[\sum_{j=1}^{m}\mathbf{J}_{i,j}\nabla_{j}\right]=%
\sum_{j}\mathrm{Var}\left[\mathbf{J}_{i,j}\nabla_{j}\right]+\sum_{j_{1},j_{2}}%
\mathrm{Cov}\left[\mathbf{J}_{i,j_{1}}\nabla_{j_{1}},\mathbf{J}_{i,j_{2}}%
\nabla_{j_{2}}\right]=\sum_{j}\left[\mathrm{Var}\left[\nabla_{j}\right]\mathbb%
{E}\left[\mathbf{J}_{i,j}^{2}\right]+\mathrm{Var}\left[\mathbf{J}_{i,j}\right]%
\mathbb{E}\left[\nabla_{j}\right]^{2}+2\mathrm{Cov}\left[\mathbf{J}_{i,j},%
\nabla_{j}\right]\mathbb{E}\left[\mathbf{J}_{i,j}\right]\mathbb{E}\left[\nabla%
_{j}\right]\right]+\sum_{j_{1},j_{2}}\mathrm{Cov}\left[\mathbf{J}_{i,j_{1}}%
\nabla_{j_{1}},\mathbf{J}_{i,j_{2}}\nabla_{j_{2}}\right]
\mathbb{E}\left[\nabla_{j}\right]=0
\sum_{j}\mathrm{Var}\left[\nabla_{j}\right]\mathbb{E}\left[\mathbf{J}_{i,j}^{2%
}\right]
V_{\bm{\theta}}
\frac{1}{d}\sum_{i,j}\mathrm{Var}\left[\nabla_{j}\right]\mathbb{E}\left[%
\mathbf{J}_{i,j}^{2}\right]
V_{\mathbf{o},\mathbf{M}}=\frac{1}{d}\sum_{i,j}\mathrm{Var}\left[(\nabla_{%
\mathbf{o}}\mathcal{L}_{\mathbf{x}})_{j}\right](\mathbb{E}_{\mathbf{x}}\left[{%
\mathbf{J}_{f}^{\top}(\mathbf{x})}\right])_{i,j}
V_{\mathbf{o},\mathbf{M}}
V_{\bm{\theta}}
\mathbf{J}_{f}^{\top}(\mathbf{x})
V_{\mathbf{o},\mathbf{M}}
V_{\bm{\theta}}
d
{\mathbf{J}_{f}^{\top}(\mathbf{x})}
L_{J}
\mathbf{e}(\mathbf{x})
L_{e}
\left\lVert\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})-\mathbf{J}_{f}^{\top}(\mathbf%
{x}_{j})\right\rVert\leq L_{J}\left\lVert\mathbf{x}_{i}-\mathbf{x}_{j}\right\rVert
\left\lVert\mathbf{e}(\mathbf{x}_{i})-\mathbf{e}(\mathbf{x}_{j})\right\rVert%
\leq L_{e}\left\lVert\mathbf{x}_{i}-\mathbf{x}_{j}\right\rVert
\frac{1}{2n^{2}}\sum_{i,j}(a_{i}-a_{j})(b_{i}-b_{j})=\frac{1}{n}\sum_{i}a_{i}b%
_{i}-\frac{1}{n^{2}}\sum_{i,j}a_{i}b_{j}
\displaystyle\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top%
}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]-\mathbb{E}_{\mathbf{x}_{i}%
}\left[\left(\mathbb{E}_{\mathbf{x}_{j}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x%
}_{j})}\right]+\bm{\epsilon}\right)\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top%
}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]-\mathbb{E}_{\mathbf{x}_{i}%
}\left[\left(\mathbb{E}_{\mathbf{x}_{j}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x%
}_{j})}\right]+\bm{\epsilon}\right)\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle=\left\lVert\frac{1}{n}\sum_{\mathbf{x}_{i}}\widetilde{\mathbf{J_%
{f}}}(\mathbf{x}_{i})\mathbf{e}(\mathbf{x}_{i})-\left(\frac{1}{n}\sum_{\mathbf%
{x}_{i}}\widetilde{\mathbf{J_{f}}}(\mathbf{x}_{i})\right)\left(\frac{1}{n}\sum%
_{\mathbf{x}_{i}}\mathbf{e}(\mathbf{x}_{i})\right)-\bm{\epsilon}\mathbb{E}_{%
\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle=
\displaystyle\left\lVert\frac{1}{n}\sum_{\mathbf{x}_{i}}\widetilde{\mathbf{J_{%
f}}}(\mathbf{x}_{i})\mathbf{e}(\mathbf{x}_{i})-\left(\frac{1}{n}\sum_{\mathbf{%
x}_{i}}\widetilde{\mathbf{J_{f}}}(\mathbf{x}_{i})\right)\left(\frac{1}{n}\sum_%
{\mathbf{x}_{i}}\mathbf{e}(\mathbf{x}_{i})\right)-\bm{\epsilon}\mathbb{E}_{%
\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle=\left\lVert\frac{1}{2n^{2}}\sum_{\mathbf{x}_{i},\mathbf{x}_{j}}%
\left(\widetilde{\mathbf{J_{f}}}(\mathbf{x}_{i})-\widetilde{\mathbf{J_{f}}}(%
\mathbf{x}_{j})\right)\left(\mathbf{e}(\mathbf{x}_{i})-\mathbf{e}(\mathbf{x}_{%
j})\right)-\bm{\epsilon}\mathbb{E}_{\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}%
_{i})\right]\right\rVert
\displaystyle=
\displaystyle\left\lVert\frac{1}{2n^{2}}\sum_{\mathbf{x}_{i},\mathbf{x}_{j}}%
\left(\widetilde{\mathbf{J_{f}}}(\mathbf{x}_{i})-\widetilde{\mathbf{J_{f}}}(%
\mathbf{x}_{j})\right)\left(\mathbf{e}(\mathbf{x}_{i})-\mathbf{e}(\mathbf{x}_{%
j})\right)-\bm{\epsilon}\mathbb{E}_{\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}%
_{i})\right]\right\rVert
\displaystyle\leq\frac{1}{2n^{2}}\sum_{\mathbf{x}_{i},\mathbf{x}_{j}}\left%
\lVert\left(\widetilde{\mathbf{J_{f}}}(\mathbf{x}_{i})-\widetilde{\mathbf{J_{f%
}}}(\mathbf{x}_{j})\right)\right\rVert\left\lVert\left(\mathbf{e}(\mathbf{x}_{%
i})-\mathbf{e}(\mathbf{x}_{j})\right)\right\rVert+\left\lVert\bm{\epsilon}%
\mathbb{E}_{\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle\leq
\displaystyle\frac{1}{2n^{2}}\sum_{\mathbf{x}_{i},\mathbf{x}_{j}}\left\lVert%
\left(\widetilde{\mathbf{J_{f}}}(\mathbf{x}_{i})-\widetilde{\mathbf{J_{f}}}(%
\mathbf{x}_{j})\right)\right\rVert\left\lVert\left(\mathbf{e}(\mathbf{x}_{i})-%
\mathbf{e}(\mathbf{x}_{j})\right)\right\rVert+\left\lVert\bm{\epsilon}\mathbb{%
E}_{\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle\leq\frac{1}{2n^{2}}\sum_{\mathbf{x}_{i},\mathbf{x}_{j}}L_{J}L_{e%
}{\left\lVert\mathbf{x}_{i}-\mathbf{x}_{j}\right\rVert}^{2}+\left\lVert\bm{%
\epsilon}\mathbb{E}_{\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle\leq
\displaystyle\frac{1}{2n^{2}}\sum_{\mathbf{x}_{i},\mathbf{x}_{j}}L_{J}L_{e}{%
\left\lVert\mathbf{x}_{i}-\mathbf{x}_{j}\right\rVert}^{2}+\left\lVert\bm{%
\epsilon}\mathbb{E}_{\mathbf{x}_{i}}\left[\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle=\frac{1}{2}L_{J}L_{e}\Delta_{\mathbf{x}}+e_{\bm{\epsilon}}
\displaystyle=
\displaystyle\frac{1}{2}L_{J}L_{e}\Delta_{\mathbf{x}}+e_{\bm{\epsilon}}
\displaystyle<\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{%
\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert.
\displaystyle<
\displaystyle\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top%
}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert.
\displaystyle\left<\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(%
\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right],\mathbb{E}_{\mathbf{x}_{i}}%
\left[\mathbf{M}\mathbf{e}(\mathbf{x}_{i})\right]\right>
\displaystyle\left<\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(%
\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right],\mathbb{E}_{\mathbf{x}_{i}}%
\left[\mathbf{M}\mathbf{e}(\mathbf{x}_{i})\right]\right>
\displaystyle={\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{%
\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert}^{2}-\left%
<\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})}%
\mathbf{e}(\mathbf{x}_{i})\right],\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}%
_{f}^{\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]-\mathbb{E}_{%
\mathbf{x}_{i}}\left[\mathbf{M}\mathbf{e}(\mathbf{x}_{i})\right]\right>
\displaystyle=
\displaystyle{\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{%
\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert}^{2}-\left%
<\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})}%
\mathbf{e}(\mathbf{x}_{i})\right],\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}%
_{f}^{\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]-\mathbb{E}_{%
\mathbf{x}_{i}}\left[\mathbf{M}\mathbf{e}(\mathbf{x}_{i})\right]\right>
\displaystyle\geq{\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^%
{\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert}^{2}-%
\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_%
{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert\left\lVert\mathbb{E}_{%
\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf%
{x}_{i})\right]-\mathbb{E}_{\mathbf{x}_{i}}\left[\left(\mathbb{E}_{\mathbf{x}_%
{j}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{j})}\right]+\bm{\epsilon}\right)%
\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle\geq
\displaystyle{\left\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{%
\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert}^{2}-\left%
\lVert\mathbb{E}_{\mathbf{x}_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})}%
\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert\left\lVert\mathbb{E}_{\mathbf{x}%
_{i}}\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{i})}\mathbf{e}(\mathbf{x}_{i})%
\right]-\mathbb{E}_{\mathbf{x}_{i}}\left[\left(\mathbb{E}_{\mathbf{x}_{j}}%
\left[{\mathbf{J}_{f}^{\top}(\mathbf{x}_{j})}\right]+\bm{\epsilon}\right)%
\mathbf{e}(\mathbf{x}_{i})\right]\right\rVert
\displaystyle>0.
\displaystyle>
\displaystyle 0.
L_{J}
L_{J}=0
u[t]-V_{th}
u[t]-V_{th}
s_{i}[t]
\{0,1\}
1
p(s_{i}[t]=1)=F(u_{i}[t]-V_{th})
s_{i}[t]=H(u_{i}\left[t\right]-V_{th}-z_{i})
z_{i}
F
F
\mathbf{x}
n
\mathbf{W}
\mathbf{O}
\mathbb{E}_{\mathbf{x}}[\mathcal{L}(\mathbf{s})]
\mathbf{s}=H(\mathbf{u}-V_{th}),\mathbf{u}=\mathbf{W}\mathbf{x}
\mathbb{E}_{\mathbf{x}}[\mathbb{E}_{\mathbf{s}\sim p(\mathbf{s}|\mathbf{x},%
\mathbf{W})}[\mathcal{L}(\mathbf{s})]].
\mathbf{u}
\displaystyle\frac{\partial}{\partial\mathbf{u}}\mathbb{E}_{\mathbf{s}\sim p(%
\mathbf{s}|\mathbf{W})}[\mathcal{L}(\mathbf{s})]=\frac{\partial}{\partial%
\mathbf{u}}\sum_{\mathbf{s}}\left(\prod_{i}p(\mathbf{s}_{i}|\mathbf{W})\right)%
\mathcal{L}(\mathbf{s})
\displaystyle\frac{\partial}{\partial\mathbf{u}}\mathbb{E}_{\mathbf{s}\sim p(%
\mathbf{s}|\mathbf{W})}[\mathcal{L}(\mathbf{s})]
\displaystyle=\frac{\partial}{\partial\mathbf{u}}\sum_{\mathbf{s}}\left(\prod_%
{i}p(\mathbf{s}_{i}|\mathbf{W})\right)\mathcal{L}(\mathbf{s})
\displaystyle=\sum_{\mathbf{s}}\sum_{i}\left(\prod_{i^{\prime}\neq i}p(\mathbf%
{s}_{i^{\prime}}|\mathbf{W})\right)\left(\frac{\partial}{\partial\mathbf{u}}p(%
\mathbf{s}_{i}|\mathbf{W})\right)\mathcal{L}(\mathbf{s}).
\displaystyle=\sum_{\mathbf{s}}\sum_{i}\left(\prod_{i^{\prime}\neq i}p(\mathbf%
{s}_{i^{\prime}}|\mathbf{W})\right)\left(\frac{\partial}{\partial\mathbf{u}}p(%
\mathbf{s}_{i}|\mathbf{W})\right)\mathcal{L}(\mathbf{s}).
s_{i}
\mathbf{s}_{\lnot i}
s_{i}
s_{i}
\{0,1\}
\mathbf{s}_{\lnot i}
\displaystyle\sum_{s_{i}\in\{0,1\}}\frac{\partial p(s_{i}|\mathbf{W})}{%
\partial\mathbf{u}}\mathcal{L}([\mathbf{s}_{\lnot i},s_{i}])=\frac{\partial p(%
\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}\mathcal{L}(\mathbf{s})+\frac{%
\partial(1-p(\mathbf{s}_{i}|\mathbf{W}))}{\partial\mathbf{u}}\mathcal{L}(%
\mathbf{s}_{\downarrow i})
\displaystyle\sum_{s_{i}\in\{0,1\}}\frac{\partial p(s_{i}|\mathbf{W})}{%
\partial\mathbf{u}}\mathcal{L}([\mathbf{s}_{\lnot i},s_{i}])
\displaystyle=\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}%
\mathcal{L}(\mathbf{s})+\frac{\partial(1-p(\mathbf{s}_{i}|\mathbf{W}))}{%
\partial\mathbf{u}}\mathcal{L}(\mathbf{s}_{\downarrow i})
\displaystyle=\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}%
\left(\mathcal{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right),
\displaystyle=\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}%
\left(\mathcal{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right),
\mathbf{s}
s_{i}
s_{i}
\mathbf{s}_{\downarrow i}
\mathbf{s}_{i}
\mathbf{s}
\sum_{s_{i}}p(s_{i}|\mathbf{W})=1
\displaystyle\frac{\partial}{\partial\mathbf{u}}\mathbb{E}_{\mathbf{s}\sim p(%
\mathbf{s}|\mathbf{W})}[\mathcal{L}(\mathbf{s})]=\sum_{i}\sum_{\mathbf{s}_{%
\lnot i}}\left(\prod_{i^{\prime}\neq i}p(\mathbf{s}_{i^{\prime}}|\mathbf{W})%
\right)\sum_{s_{i}}\left(\frac{\partial}{\partial\mathbf{u}}p(s_{i}|\mathbf{W}%
)\right)\mathcal{L}([\mathbf{s}_{\lnot i},s_{i}])
\displaystyle\frac{\partial}{\partial\mathbf{u}}\mathbb{E}_{\mathbf{s}\sim p(%
\mathbf{s}|\mathbf{W})}[\mathcal{L}(\mathbf{s})]
\displaystyle=\sum_{i}\sum_{\mathbf{s}_{\lnot i}}\left(\prod_{i^{\prime}\neq i%
}p(\mathbf{s}_{i^{\prime}}|\mathbf{W})\right)\sum_{s_{i}}\left(\frac{\partial}%
{\partial\mathbf{u}}p(s_{i}|\mathbf{W})\right)\mathcal{L}([\mathbf{s}_{\lnot i%
},s_{i}])
\displaystyle=\sum_{i}\sum_{\mathbf{s}_{\lnot i}}\left(\prod_{i^{\prime}\neq i%
}p(\mathbf{s}_{i^{\prime}}|\mathbf{W})\right)\sum_{s_{i}}p(s_{i}|\mathbf{W})%
\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}\left(\mathcal%
{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right)
\displaystyle=\sum_{i}\sum_{\mathbf{s}_{\lnot i}}\left(\prod_{i^{\prime}\neq i%
}p(\mathbf{s}_{i^{\prime}}|\mathbf{W})\right)\sum_{s_{i}}p(s_{i}|\mathbf{W})%
\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}\left(\mathcal%
{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right)
\displaystyle=\sum_{\mathbf{s}}\left(\prod_{i}p(\mathbf{s}_{i}|\mathbf{W})%
\right)\sum_{i}\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}%
}\left(\mathcal{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right)
\displaystyle=\sum_{\mathbf{s}}\left(\prod_{i}p(\mathbf{s}_{i}|\mathbf{W})%
\right)\sum_{i}\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}%
}\left(\mathcal{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right)
\displaystyle=\mathbb{E}_{\mathbf{s}\sim p(\mathbf{s}|\mathbf{W})}\sum_{i}%
\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}\left(\mathcal%
{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right).
\displaystyle=\mathbb{E}_{\mathbf{s}\sim p(\mathbf{s}|\mathbf{W})}\sum_{i}%
\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}\left(\mathcal%
{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\right).
\mathbf{s}
\frac{\partial p(\mathbf{s}_{i}|\mathbf{W})}{\partial\mathbf{u}}=F^{\prime}(%
\mathbf{u},V_{th}),
F^{\prime}
F
\mathcal{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})
\mathcal{L}(\mathbf{s})-\mathcal{L}(\mathbf{s}_{\downarrow i})\approx\frac{%
\partial\mathcal{L}(\mathbf{s})}{\partial\mathbf{s}_{i}}
\frac{\partial\mathcal{L}(\mathbf{s})}{\partial\mathbf{s}}
\frac{1}{\sqrt{d_{n}}}
d_{n}
\mathbf{o}=\mathbf{O}\mathbf{s}
\mathbf{s}_{i}
O(\frac{1}{\sqrt{d_{n}}})
\frac{\partial\mathcal{L}(\mathbf{s})}{\partial\mathbf{s}}
\mathbf{s}^{l}
\mathbf{r}^{l}=\mathbf{R}^{l}\mathbf{s}^{l}
\mathcal{L}(\mathbf{r}^{l},\mathbf{y})
\mathbf{s}^{l}
\mathbf{R}^{l}
34\times 34
34\times 34\times 2\times T
T
300ms
1\mu s
3ms
48\times 48
48\times 48
28\times 28
32\times 32\times 3
224\times 224
256\times 256
224\times 224
\mathbf{u}^{N}[T]=\sum_{t=1}^{T}\mathbf{o}[t]
\mathbf{o}[t]=\mathbf{W}^{N-1}\mathbf{s}^{N-1}[t]+\mathbf{b}^{N}
\mathcal{L}(\mathbf{o}[t],\mathbf{y})
V_{th}=1
\lambda=0.5
\psi(u)=\frac{1}{a_{1}}\frac{e^{(V_{th}-u)/a_{1}}}{(1+e^{(V_{th}-u)/a_{1}})^{2}}
a_{1}=0.25
\alpha
0.2
0.01
\alpha
1/\alpha
\mathbf{M}
\tilde{\mathbf{o}}
\alpha
\Delta\mathbf{o}
\alpha
\alpha
\mathbf{M}
\alpha
\lambda=0.99999
\lambda=0.999999
0.01
var=\frac{\sum\lVert\mathbf{g}_{i}-\overline{\mathbf{g}}\rVert^{2}}{n}
\mathbf{g}_{i}
\overline{\mathbf{g}}
n
{}_{\text{sp}}
1.42\times 10^{9}
2.91\times 10^{9}
2.84\times 10^{9}
2.41\times 10^{9}
\mathbf{0.53\times 10^{9}}
0.76\times 10^{9}
1.40\times 10^{9}
1.16\times 10^{9}
1.12\times 10^{9}
\mathbf{0.30\times 10^{9}}
