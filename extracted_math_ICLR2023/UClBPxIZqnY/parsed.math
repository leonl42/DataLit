m
n
m
n
O(mn)
\min
\min
\Delta
\gamma>0
A^{\ast}_{\gamma}=\mathbb{E}_{\gamma}[A]=\nabla_{\Delta}\textbf{dtw}_{\gamma}(%
\mathbf{X},\mathbf{Y})
A^{\ast}_{\gamma}
A^{\ast}_{\gamma}
\nabla^{2}_{\Delta}\textbf{dtw}_{\gamma}(\mathbf{X},\mathbf{Y})
\bm{\Omega}
\gamma=0
\phi^{\ast}
\gamma>0
\bm{\Omega}
\gamma=0
\bm{\phi}
\gamma>0
\bm{\Omega}
\gamma=0
\bm{\phi}
\mathbf{x}:[0,1]\rightarrow\mathbb{R}^{d}
\mathbf{t}\in[0,1]^{N}
0=t_{1}<t_{2}<\dots<t_{N}\leq 1
\mathbf{X}=\{\mathbf{x}_{1},\dots,\mathbf{x}_{N}\}\in\mathbb{R}^{N\times d}
[0,1]
\phi:[0,1]\rightarrow[0,1]
\phi^{\prime}(t)\geq 0
t
\mathbf{x}\circ\phi
\mathbf{x}
\mathbf{x}
\mathbf{y}
\phi
\mathbf{y}\circ\phi\approx\mathbf{x}
\mathbf{x}
\mathbf{y}
\mathbf{y}
\phi
\mathbf{x}
\mathbf{y}
\begin{array}[]{rl}\text{minimise}&f(\mathbf{x},\mathbf{y},\lambda,\phi)%
\triangleq\mathcal{L}(\mathbf{x},\mathbf{y},\phi)+\lambda\mathcal{R}(\phi)\\
\text{subject to}&\underbrace{s^{\text{min}}(t)\leq\phi^{\prime}(t)\leq s^{%
\text{max}}(t)}_{\textbf{local constraints}},\quad\underbrace{b(t)^{\text{min}%
}\leq\phi(t)\leq b(t)^{\text{max}}}_{\textbf{global constraints}}\quad\forall t%
.\end{array}
f
\mathcal{L}
\mathcal{R}
\lambda\geq 0
\phi
\mathbf{x}
\mathbf{y}
f
\phi
\lambda=0
\lambda=0
\phi
\phi(t)\in[0,1]
t
\phi(0)=0,\phi(1)=1
\mathbf{y}
\mathbf{x}
\mathcal{L}
\mathcal{L}(\mathbf{x},\mathbf{y},\phi)=\int_{0}^{1}L\big{(}\mathbf{x}(t)-%
\mathbf{y}(\phi(t))\big{)}\text{d}t,
L:\mathbb{R}^{d}\rightarrow\mathbb{R}
L(\cdot)\triangleq\|\cdot\|_{2}^{2}
\mathbf{x}
\mathbf{y}
\mathcal{R}
\mathcal{R}(\phi)=\int_{0}^{1}R\big{(}\phi^{\prime}(t)-1\big{)}\text{d}t,
R:\mathbb{R}\rightarrow\mathbb{R}
\phi^{\prime}(t)=1
R(u)=u^{2}
\lambda
\phi
\lambda
\phi
\phi
\phi
m
0=t_{1}<t_{2}<\dots<t_{m}=1
\mathbf{y}
\phi
\bm{\phi}=(\phi_{1},\dots,\phi_{m})\in\mathbb{R}^{m}
\phi_{i}=\phi(t_{i})
\begin{array}[]{rl}\text{minimise}&\hat{f}(\mathbf{x},\mathbf{y},\lambda,\bm{%
\phi})\triangleq\hat{\mathcal{L}}(\mathbf{x},\mathbf{y},\bm{\phi})+\lambda\hat%
{\mathcal{R}}(\bm{\phi})\\
\text{subject to}&s^{\text{min}}_{i}\leq\frac{\phi_{i+1}-\phi_{i}}{\Delta t_{i%
}}\leq s^{\text{max}}_{i},\quad b_{i}^{\text{min}}\leq\phi_{i}\leq b_{i}^{%
\text{max}}\quad\forall i,\end{array}
\Delta t_{i}=t_{i+1}-t_{i}
\hat{\mathcal{L}}
\hat{\mathcal{L}}(\mathbf{x},\mathbf{y},\bm{\phi})=\sum_{i=1}^{m-1}\frac{L_{i+%
1}+L_{i}}{2}\Delta t_{i},\quad L_{i}\coloneqq L(\mathbf{x}(t_{i})-\mathbf{y}(%
\phi_{i})),
\bm{\phi}
\hat{f}
L
R
\mathbf{x}(\phi_{i})
\mathbf{x}
\hat{\mathcal{R}}
\hat{\mathcal{R}}(\bm{\phi})=\sum_{i=1}^{m-1}R\left(\frac{\phi_{i+1}-\phi_{i}}%
{\Delta t_{i}}-1\right)\Delta t_{i},
\phi^{\prime}
\mathcal{R}
\bm{\phi}\in\mathbb{R}^{m}
\bm{\phi}^{\star}=\text{DecDTW}(\mathbf{x},\mathbf{y},\lambda,\mathbf{s^{\text%
{min}}},\mathbf{s^{\text{max}}},\mathbf{b^{\text{min}}},\mathbf{b^{\text{max}}})
\mathbf{x},\mathbf{y}
\lambda
\mathbf{s^{\text{min}}}=\{s_{i}^{\text{min}}\}_{i=1}^{m}
\mathbf{s^{\text{max}}}=\{s_{i}^{\text{max}}\}_{i=1}^{m}
\mathbf{b^{\text{min}}}=\{b_{i}^{\text{min}}\}_{i=1}^{m}
\mathbf{b^{\text{max}}}=\{b_{i}^{\text{max}}\}_{i=1}^{m}
\bm{\phi}^{\star}
J(\bm{\phi}^{\star})
\bm{\phi}^{\star}
\bm{\phi}^{\text{gt}}
J=\hat{f}
\bm{\phi}
\mathbb{R}^{m}
\bm{\phi}^{\star}
M
\bm{\phi}^{\star}
\bm{\phi}^{\star}
\bm{\phi}^{\star}
\mathbf{z}=\{\mathbf{x},\mathbf{y},\lambda,\mathbf{s^{\text{min}}},\mathbf{s^{%
\text{max}}},\mathbf{b^{\text{min}}},\mathbf{b^{\text{max}}}\}\in\mathbb{R}^{n}
\mathbf{x},\mathbf{y}
\mathbf{X},\mathbf{Y}
\lambda
\tilde{h}=[h_{1},\dots,h_{p}]
h_{i}:\mathbb{R}^{n}\times\mathbb{R}^{m}\rightarrow\mathbb{R}
h_{i}(\cdot)\leq 0
t_{j}
h_{i}(\mathbf{z},\bm{\phi})=\phi_{j+1}-\phi_{j}-\Delta t_{j}s_{j}^{\text{max}}\leq
0
H
L
R
\text{rank}(D_{\bm{\phi}}\tilde{h}(\mathbf{z},\bm{\phi}))=p
D\bm{\phi}(\mathbf{z})=H^{-1}A^{\top}(AH^{-1}A^{\top})^{-1}(AH^{-1}B-C)-H^{-1}B,
D\phi(\mathbf{z})\in\mathbb{R}^{m\times n}
\bm{\phi}
\mathbf{z}
\begin{array}[]{rl}A=D_{\bm{\phi}}\tilde{h}(\mathbf{z},\bm{\phi})\in\mathbb{R}%
^{p\times m}&B=D_{\mathbf{z}\bm{\phi}}^{2}\hat{f}(\mathbf{z},\bm{\phi})\in%
\mathbb{R}^{m\times n}\\
C=D_{\mathbf{z}}\tilde{h}(\mathbf{z},\bm{\phi})\in\mathbb{R}^{p\times n}&H=D_{%
\bm{\phi}\bm{\phi}}^{2}\hat{f}(\mathbf{z},\bm{\phi})\in\mathbb{R}^{m\times m}.%
\end{array}
\hat{f}
\mathbf{z}
\mathbf{x},\mathbf{y},\lambda
\tilde{h}
\mathbf{s^{\text{min}}},\mathbf{s^{\text{max}}},\mathbf{b^{\text{min}}},%
\mathbf{b^{\text{max}}}
B
H
\tilde{h}
\{\mathbf{z},\bm{\phi}\}
\phi:[0,S)\rightarrow[0,T)
\phi
\phi^{\text{gt}}
\operatorname*{TimeErr}
\operatorname*{TimeDev}
\operatorname*{TimeErr}(\phi,\phi^{\text{gt}})=\frac{1}{S}\!\int_{0}^{S}\!\!|%
\phi(s)-\phi^{\text{gt}}(s)|\text{d}s,\quad\operatorname*{TimeDev}(\phi,\phi^{%
\text{gt}})=\sqrt{\frac{1}{S}\!\int_{0}^{S}\!\!(\phi(s)-\phi^{\text{gt}}(s))^{%
2}\text{d}s}.
\operatorname*{TimeErr}
\bm{\Omega}
\operatorname*{TimeErr}
\operatorname*{TimeErr}
\operatorname*{TimeErr}
\operatorname*{TimeErr}
\{I_{i}^{r}\}_{i=1}^{N}
\mathbf{t}^{r}\in\mathbb{R}^{N}
\{\mathbf{x}_{i}^{r}\}_{i=1}^{N}
\{I_{i}^{q}\}_{i=1}^{M}
\mathbf{t}^{q}\in\mathbb{R}^{M}
\mathbf{X}^{q}=\{\mathbf{x}_{i}^{q}\}_{i=1}^{N}
f_{\theta}
\theta
\mathbf{Z}^{r}=\{f_{\theta}(I_{i}^{r})\}_{i=1}^{N}\in\mathbb{R}^{N\times d}
\mathbf{Z}^{q}=\{f_{\theta}(I_{i}^{q})\}_{i=1}^{M}\in\mathbb{R}^{M\times d}
\mathbf{x}^{r}
\mathbf{x}^{q}
\mathbf{z}^{r}
\mathbf{z}^{q}
\theta
G(\mathbf{x}^{r}(\bm{\phi}),\mathbf{X}^{q})
\bm{\phi}=\text{DTW}(\mathbf{z}^{r},\mathbf{z}^{q};\theta)
\phi_{i}=\phi(t_{i}^{q})
\mathbf{x}^{r}(\bm{\phi})=\{\mathbf{x}^{r}(\phi_{i})\}_{i=1}^{M}
G
G(\mathbf{X}^{1},\mathbf{X}^{2})=\max\{\|\mathbf{x}_{i}^{1}-\mathbf{x}_{i}^{2}%
\|_{2}^{2}:i=1,\dots,M\}
\thicksim
\thicksim
\thicksim
\thicksim
\thicksim
\thicksim
\bm{\Omega}
\leq 5
n
n
O(mn)
O(mn)
O(mM)
O(mM^{2})
M=n
i
\phi_{i}
M
\{\phi_{i,j}\}_{j=1}^{M}
b_{i}^{\text{min}},b_{i}^{\text{max}}
mM
\phi_{i-1,j},\phi_{i,k}
j,k
(m-1)\times M^{2}
s_{i}^{\text{min}},s_{i}^{\text{max}}
\infty
O(mM^{2})
\eta=0.125
M=\max(50,n)
n
\mathbf{X}
\eta
M
\eta
M
r
\bm{\phi}^{\star}
\bm{\phi}^{\star}
\bm{\phi}^{\star}_{NLP}
\hat{f}
\bm{\phi}
\phi
\mathbf{y}
\mathbf{x}
\hat{f}
\phi
\mathbf{y}
\mathbf{x}
\hat{f}
D\phi(\mathbf{z})
J(\bm{\phi})
\bm{\phi}^{\text{gt}}
DJ(\mathbf{z})=v^{\top}D\bm{\phi}(\mathbf{z})
v^{\top}=J(\bm{\phi})\in\mathbb{R}^{1\times m}
v^{\top}D\bm{\phi}(\mathbf{z})
H^{-1}A^{\top}
H
\hat{f}
\hat{\mathcal{R}}
v^{\top}H^{-1}
O(m)
B
C
B
\mathbf{s^{\text{min}}},\mathbf{s^{\text{max}}},\mathbf{b^{\text{min}}},%
\mathbf{b^{\text{max}}}
\hat{f}
\mathbf{x},\mathbf{y},\lambda
C
\mathbf{x},\mathbf{y},\lambda
\bm{\phi}
\mathbf{s^{\text{min}}},\mathbf{s^{\text{max}}},\mathbf{b^{\text{min}}},%
\mathbf{b^{\text{max}}}
\{\mathbf{x},\mathbf{y},\lambda\}
\{\mathbf{s^{\text{min}}},\mathbf{s^{\text{max}}},\mathbf{b^{\text{min}}},%
\mathbf{b^{\text{max}}}\}
C
B
\phi^{\star}
\phi
\phi^{\star}
M
M=n
\thicksim
N
\mathbb{R}^{N\times d}
\mathbb{R}^{N\times d_{1}}
d_{1}=128
0\leq\alpha\leq 1
\bm{\Omega}
\bm{\Omega}
\operatorname*{TimeErr}
\operatorname*{TimeErr}
\lambda=0.1,0.7,0.9
\operatorname*{TimeErr}
\gamma=1
\gamma
\alpha=0
\gamma=0.1
\thicksim
\thicksim
\thicksim
\bm{\Omega}
i,j
i
j
\times
\times
\lambda=0.1
\gamma=1
\gamma=0.1
\alpha=0
\gamma=1
\operatorname*{TimeErr}
\lambda
\leq 5
>5
\operatorname*{TimeErr}
