\widetilde{\mathcal{O}}(\sqrt{T})
\widetilde{\mathcal{O}}(\sqrt{T})
\gamma
\widetilde{\mathcal{O}}(\sqrt{T})
1/(1-\gamma)
\widetilde{\mathcal{O}}(\sqrt{T})
\gamma
\gamma
1/(1-\gamma)
\widetilde{\mathcal{O}}(T^{2/3})
1/(1-\gamma)
\widetilde{\mathcal{O}}(\sqrt{T})
1/(1-\gamma)
\widetilde{\mathcal{O}}(\sqrt{T})
\widetilde{\mathcal{O}}(\text{sp}(v^{\ast})\sqrt{d^{3}T})
\widetilde{\mathcal{O}}(\sqrt{T})
T
\text{poly}(d,S,A,T)
d
S
A
T
d,S,A,T
\widetilde{\mathcal{O}}(\sqrt{T})
T^{d}
d
\widetilde{\mathcal{O}}(T^{2/3})
\widetilde{\mathcal{O}}(\sqrt{T})
\widetilde{\mathcal{O}}(\cdot)
\text{poly}(\cdot)
\text{sp}(v^{\ast})\sqrt{d^{3}T}
T^{d},A,d
\sqrt{\text{sp}(v^{\ast})}(dT)^{\frac{3}{4}}
T,A,d
\sqrt{\text{sp}(v^{\ast})^{3}d^{3}T}
T^{d},A,d
d\sqrt{t_{\text{mix}}^{3}T}
T,A,d
\gamma
\text{sp}(v^{\ast})\sqrt{d^{3}T}
T,S,A,d
\Omega(d\sqrt{\text{sp}(v^{\ast})T})
\|\bm{x}\|_{A}=\sqrt{x^{T}Ax}
\bm{x}\in\mathbb{R}^{d}
A\in\mathbb{R}^{d\times d}
a\vee b=\max\{a,b\}
a\wedge b=\min\{a,b\}
\Delta(\mathcal{X})
\mathcal{X}
[n]=\{1,\dots,n\}
[m:n]=\{m,m+1,\dots,n\}
\text{sp}(v)=\max_{s,s^{\prime}}|v(s)-v(s^{\prime})|
\mathcal{M}=(\mathcal{S},\mathcal{A},P,r)
\mathcal{S}
\mathcal{A}
P:\mathcal{S}\times\mathcal{A}\rightarrow\Delta(\mathcal{S})
r:\mathcal{S}\times\mathcal{A}\rightarrow[0,1]
\mathcal{S}
\mathcal{A}
r
P
T
s_{1}\in\mathcal{S}
t=1,\dots,T
a_{t}\in\mathcal{A}
r(s_{t},a_{t})
s_{t+1}
s_{t+1}
P(\cdot|s_{t},a_{t})
\pi:\mathcal{S}\rightarrow\Delta(\mathcal{A})
\pi(a|s)
a
s
\pi
s
\textstyle J^{\pi}(s)\coloneqq\liminf_{T\rightarrow\infty}\frac{1}{T}\mathbb{E%
}^{\pi}\left[\sum_{t=1}^{T}r(s_{t},a_{t})|s_{1}=s\right]
\mathbb{E}^{\pi}[\cdot]
(s_{1},a_{1},s_{2},a_{2},\dots)
P
\pi
\pi^{\ast}
J^{\pi}(s_{1})
J^{\ast}(s_{1})\coloneqq J^{\pi^{\ast}}(s_{1})
R_{T}\coloneqq\textstyle\sum_{t=1}^{T}(J^{\ast}(s_{1})-r(s_{t},a_{t})).
J^{\ast}\in\mathbb{R}
v^{\ast}:\mathcal{S}\rightarrow\mathbb{R}
q^{\ast}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
(s,a)\in\mathcal{S}\times\mathcal{A}
\displaystyle J^{\ast}+q^{\ast}(s,a)=r(s,a)+Pv^{\ast}(s,a)
\displaystyle J^{\ast}+q^{\ast}(s,a)
\displaystyle=r(s,a)+Pv^{\ast}(s,a)
\displaystyle v^{\ast}(s)=\max_{a\in\mathcal{A}}q^{\ast}(s,a).
\displaystyle v^{\ast}(s)
\displaystyle=\max_{a\in\mathcal{A}}q^{\ast}(s,a).
\pi^{\ast}
\operatorname*{argmax}_{a}q^{\ast}(s,a)
s\in\mathcal{S}
\pi^{\ast}
J^{\pi^{\ast}}(s_{1})=J^{\ast}
s_{1}\in\mathcal{S}
R_{T}=\sum_{t=1}^{T}(J^{\ast}-r(s_{t},a_{t}))
v^{\ast}(s)
q^{\ast}(s,a)
s
(s,a)
\text{sp}(v^{\ast})
\text{sp}(v^{\ast})
\gamma\in[0,1)
\gamma
\gamma
1
\pi
\displaystyle V^{\pi}(s)=\mathbb{E}^{\pi}\left[\sum_{t=1}^{\infty}\gamma^{t-1}%
r(s_{t},a_{t})|s_{1}=s\right]
\displaystyle V^{\pi}(s)
\displaystyle=\mathbb{E}^{\pi}\left[\sum_{t=1}^{\infty}\gamma^{t-1}r(s_{t},a_{%
t})|s_{1}=s\right]
\displaystyle Q^{\pi}(s,a)=\mathbb{E}^{\pi}\left[\sum_{t=1}^{\infty}\gamma^{t-%
1}r(s_{t},a_{t})|s_{1}=s,a_{1}=a\right].
\displaystyle Q^{\pi}(s,a)
\displaystyle=\mathbb{E}^{\pi}\left[\sum_{t=1}^{\infty}\gamma^{t-1}r(s_{t},a_{%
t})|s_{1}=s,a_{1}=a\right].
\gamma
V^{\ast}(s)=\max_{\pi}V^{\pi}(s),\quad Q^{\ast}(s,a)=\max_{\pi}Q^{\pi}(s,a).
\gamma\in[0,1)
V^{\ast}
\gamma
\text{sp}(V^{\ast})\leq 2\text{sp}(v^{\ast})
|(1-\gamma)V^{\ast}(s)-J^{\ast}|\leq(1-\gamma)\text{sp}(v^{\ast})~{}~{}\text{%
for all}~{}s\in\mathcal{S}
J^{\ast}
(1-\gamma)
\gamma
\gamma
\mathcal{S}
\mathcal{A}
\gamma
\beta\sqrt{1/N_{t}(s,a)}
N_{t}(s,a)
(s,a)
Q_{t}\geq Q^{\ast}
t=1,\dots,T
V_{t}
H
V_{t}
0
\frac{1}{1-\gamma}
[0,H]
\frac{1}{1-\gamma}
\widetilde{O}(\sqrt{T})
\gamma
\gamma=1-1/\sqrt{T}
H=2\cdot\text{sp}(v^{\ast})
\gamma\in[0,1)
H
\beta
Q_{1}(s,a),V_{1}(s)\leftarrow\frac{1}{1-\gamma}
N_{0}(s,a,s^{\prime})\leftarrow 0,N_{0}(s,a)\leftarrow 1
(s,a,s^{\prime})\in\mathcal{S}\times\mathcal{A}\times\mathcal{S}
s_{1}
t=1,\dots,T
a_{t}=\operatorname*{argmax}_{a}Q_{t}(s_{t},a)
r(s_{t},a_{t})
s_{t+1}
N_{t}(s_{t},a_{t},s_{t+1})\leftarrow N_{t-1}(s_{t},a_{t},s_{t+1})+1
N_{t}(s_{t},a_{t})\leftarrow N_{t-1}(s_{t},a_{t})+1
N_{t}
N_{t-1}
\widehat{P}_{t}(s^{\prime}|s,a)\leftarrow N_{t}(s,a,s^{\prime})/N_{t}(s,a),~{}%
~{}\forall(s,a)\in\mathcal{S}\times\mathcal{A}
Q_{t+1}(s,a)\leftarrow(r(s,a)+\gamma(\widehat{P}_{t}V_{t})(s,a)+\beta\sqrt{1/N%
_{t}(s,a)})\wedge Q_{t}(s,a),~{}~{}\forall(s,a)\in\mathcal{S}\times\mathcal{A}
\widetilde{V}_{t+1}(s)\leftarrow(\max_{a}Q_{t+1}(s,a))\wedge V_{t}(s),~{}~{}%
\forall s\in\mathcal{S}
V_{t+1}(s)\leftarrow\widetilde{V}_{t+1}(s)\wedge(\min_{s^{\prime}}\widetilde{V%
}_{t+1}(s^{\prime})+H),~{}~{}\forall s\in\mathcal{S}
\gamma
\gamma
c>0
\delta\in(0,1)
\gamma=1-\sqrt{1/T}
H=2\cdot sp(v^{\ast})
\beta=cH\sqrt{S\log(SAT/\delta)}
1-\delta
R_{T}\leq\mathcal{O}\left(\text{sp}(v^{\ast})\sqrt{S^{2}AT\log(SAT/\delta)}%
\right).
c
\beta
\sqrt{S}
c
\delta\in(0,1)
1-\delta
|(\widehat{P}_{t}-P)V_{t}(s,a)|\leq c\cdot\text{sp}(v^{\ast})\sqrt{S\log(SAT/%
\delta)/N_{t}(s,a)}
(s,a,t)\in\mathcal{S}\times\mathcal{A}\times[T]
1-\delta
V_{t}(s)\geq V^{\ast}(s),\quad Q_{t}(s,a)\geq Q^{\ast}(s,a)
(s,a,t)\in\mathcal{S}\times\mathcal{A}\times[T]
t=2,\dots,T
\displaystyle r(s_{t},a_{t})\geq Q_{t}(s_{t},a_{t})-\gamma(\widehat{P}_{t-1}V_%
{t-1})(s_{t},a_{t})-\beta\sqrt{1/N_{t-1}(s_{t},a_{t})}
\displaystyle r(s_{t},a_{t})
\displaystyle\geq Q_{t}(s_{t},a_{t})-\gamma(\widehat{P}_{t-1}V_{t-1})(s_{t},a_%
{t})-\beta\sqrt{1/N_{t-1}(s_{t},a_{t})}
\displaystyle\geq V_{t}(s_{t})-\gamma(PV_{t-1})(s_{t},a_{t})-2\beta\sqrt{1/N_{%
t-1}(s_{t},a_{t})}
\displaystyle\geq V_{t}(s_{t})-\gamma(PV_{t-1})(s_{t},a_{t})-2\beta\sqrt{1/N_{%
t-1}(s_{t},a_{t})}
V_{t}(s_{t})\leq\widetilde{V}_{t}(s_{t})\leq\max_{a}Q_{t}(s_{t},a)=Q_{t}(s_{t}%
,a_{t})
\displaystyle R_{T}=TJ^{\ast}-\sum_{t=1}^{T}r(s_{t},a_{t})
\displaystyle R_{T}
\displaystyle=TJ^{\ast}-\sum_{t=1}^{T}r(s_{t},a_{t})
\displaystyle\leq J^{\ast}-\sum_{t=2}^{T}(J^{\ast}-V_{t}(s_{t})+\gamma(PV_{t-1%
})(s_{t},a_{t})+2\beta\sqrt{1/N_{t-1}(s_{t},a_{t})})
\displaystyle\leq J^{\ast}-\sum_{t=2}^{T}(J^{\ast}-V_{t}(s_{t})+\gamma(PV_{t-1%
})(s_{t},a_{t})+2\beta\sqrt{1/N_{t-1}(s_{t},a_{t})})
\displaystyle=J^{\ast}+\underbrace{\sum_{t=2}^{T}(J^{\ast}-(1-\gamma)V_{t}(s_{%
t}))}_{(a)}+\gamma\underbrace{\sum_{t=2}^{T}(V_{t-1}(s_{t+1})-V_{t}(s_{t}))}_{%
(b)}
\displaystyle=J^{\ast}+\underbrace{\sum_{t=2}^{T}(J^{\ast}-(1-\gamma)V_{t}(s_{%
t}))}_{(a)}+\gamma\underbrace{\sum_{t=2}^{T}(V_{t-1}(s_{t+1})-V_{t}(s_{t}))}_{%
(b)}
\displaystyle\hskip 28.45274pt+\gamma\underbrace{\sum_{t=2}^{T}(PV_{t-1}(s_{t}%
,a_{t})-V_{t-1}(s_{t+1}))}_{(c)}+2\underbrace{\beta\sum_{t=2}^{T}1/\sqrt{1/N_{%
t-1}(s_{t},a_{t})}}_{(d)}.
\displaystyle\hskip 28.45274pt+\gamma\underbrace{\sum_{t=2}^{T}(PV_{t-1}(s_{t}%
,a_{t})-V_{t-1}(s_{t+1}))}_{(c)}+2\underbrace{\beta\sum_{t=2}^{T}1/\sqrt{1/N_{%
t-1}(s_{t},a_{t})}}_{(d)}.
(a),(b),(c),(d)
\bm{(a)}
\displaystyle\sum_{t=2}^{T}(J^{\ast}-(1-\gamma)V_{t}(s_{t}))\leq\sum_{t=2}^{T}%
(J^{\ast}-(1-\gamma)V^{\ast}(s_{t}))
\displaystyle\sum_{t=2}^{T}(J^{\ast}-(1-\gamma)V_{t}(s_{t}))
\displaystyle\leq\sum_{t=2}^{T}(J^{\ast}-(1-\gamma)V^{\ast}(s_{t}))
\displaystyle\leq T(1-\gamma)\text{sp}(v^{\ast}),
\displaystyle\leq T(1-\gamma)\text{sp}(v^{\ast}),
J^{\ast}
(1-\gamma)V^{\ast}(s)
\bm{(b)}
V_{t}(s)
t
s\in\mathcal{S}
t
1
T
\frac{1}{1-\gamma}
\displaystyle\sum_{t=2}^{T}(V_{t-1}(s_{t+1})-V_{t}(s_{t}))\leq\frac{1}{1-%
\gamma}+\sum_{t=2}^{T}(V_{t-1}(s_{t+1})-V_{t+1}(s_{t+1}))
\displaystyle\sum_{t=2}^{T}(V_{t-1}(s_{t+1})-V_{t}(s_{t}))
\displaystyle\leq\frac{1}{1-\gamma}+\sum_{t=2}^{T}(V_{t-1}(s_{t+1})-V_{t+1}(s_%
{t+1}))
\displaystyle\leq\frac{1}{1-\gamma}+\sum_{s\in\mathcal{S}}\sum_{t=2}^{T}(V_{t-%
1}(s)-V_{t+1}(s))\leq\frac{2S}{1-\gamma}.
\displaystyle\leq\frac{1}{1-\gamma}+\sum_{s\in\mathcal{S}}\sum_{t=2}^{T}(V_{t-%
1}(s)-V_{t+1}(s))\leq\frac{2S}{1-\gamma}.
S
S
\bm{(c)}
(c)
\text{sp}(v^{\ast})
1-\delta
(c)
\text{sp}(v^{\ast})\sqrt{2T\log\frac{1}{\delta}}
\frac{1}{1-\gamma}
\widetilde{\mathcal{O}}(\frac{1}{1-\gamma}\sqrt{T})
\widetilde{\mathcal{O}}(\sqrt{T})
\bm{(d)}
(d)
\displaystyle\beta\sum_{t=2}^{T}\sqrt{1/N_{t-1}(s_{t},a_{t})}\leq\beta\sum_{s%
\in\mathcal{S},a\in\mathcal{A}}\sum_{n=1}^{N_{T}(s,a)}\sqrt{\frac{1}{n}}
\displaystyle\beta\sum_{t=2}^{T}\sqrt{1/N_{t-1}(s_{t},a_{t})}
\displaystyle\leq\beta\sum_{s\in\mathcal{S},a\in\mathcal{A}}\sum_{n=1}^{N_{T}(%
s,a)}\sqrt{\frac{1}{n}}
\displaystyle\leq 2c\cdot\text{sp}(v^{\ast})\sqrt{S^{2}AT\log(SAT/\delta)},
\displaystyle\leq 2c\cdot\text{sp}(v^{\ast})\sqrt{S^{2}AT\log(SAT/\delta)},
\sum_{s,a}N_{T}(s,a)=T
N_{T}(s,a)=T/SA
s,a
\delta
1-\delta
\displaystyle R_{T}\leq\mathcal{O}\Big{(}T(1-\gamma)\text{sp}(v^{\ast})+\frac{%
S}{1-\gamma}+\text{sp}(v^{\ast})\sqrt{T\log(1/\delta)}+\text{sp}(v^{\ast})%
\sqrt{S^{2}AT\log(SAT/\delta)}\Big{)}.
\displaystyle R_{T}
\displaystyle\leq\mathcal{O}\Big{(}T(1-\gamma)\text{sp}(v^{\ast})+\frac{S}{1-%
\gamma}+\text{sp}(v^{\ast})\sqrt{T\log(1/\delta)}+\text{sp}(v^{\ast})\sqrt{S^{%
2}AT\log(SAT/\delta)}\Big{)}.
\gamma
\frac{1}{1-\gamma}=\sqrt{T}
R_{T}\leq\mathcal{O}\left(\text{sp}(v^{\ast})\sqrt{S^{2}AT\log(SAT/\delta)}%
\right),
d
\bm{\varphi}:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}^{d}
(s,a)\in\mathcal{S}\times\mathcal{A}
r(s,a)=\langle\bm{\varphi}(s,a),\bm{\theta}\rangle,\quad P(s^{\prime}|s,a)=%
\langle\bm{\varphi}(s,a),\bm{\mu}(s^{\prime})\rangle
\bm{\mu}(s^{\prime})=(\mu_{1}(s^{\prime}),\dots,\mu_{d}(s^{\prime}))
s^{\prime}\in\mathcal{S}
d
\mathcal{S}
\bm{\theta}\in\mathbb{R}^{d}
\displaystyle\|\bm{\varphi}(s,a)\|_{2}\leq 1~{}\text{for all}~{}(s,a)\in%
\mathcal{S}\times\mathcal{A},
\displaystyle\|\bm{\varphi}(s,a)\|_{2}\leq 1~{}\text{for all}~{}(s,a)\in%
\mathcal{S}\times\mathcal{A},
\displaystyle\quad\|\bm{\theta}\|_{2}\leq\sqrt{d},\quad\|\bm{\mu}(\mathcal{S})%
\|_{2}\leq\sqrt{d}.
\displaystyle\quad\|\bm{\theta}\|_{2}\leq\sqrt{d},\quad\|\bm{\mu}(\mathcal{S})%
\|_{2}\leq\sqrt{d}.
P
d
\bm{\varphi}
P
|\mathcal{S}|
\bm{\mu}
P
Pv(s,a)
\bm{\varphi}(s,a)
v:\mathcal{S}\rightarrow\mathbb{R}
Pv(s,a)=\langle\bm{\varphi}(s,a),\bm{w}^{\ast}_{v}\rangle
\bm{w}^{\ast}_{v}
\displaystyle Pv(s,a)\coloneqq\textstyle\int_{s^{\prime}\in\mathcal{S}}v(s^{%
\prime})P(ds^{\prime}|s,a)
\displaystyle Pv(s,a)
\displaystyle\coloneqq\textstyle\int_{s^{\prime}\in\mathcal{S}}v(s^{\prime})P(%
ds^{\prime}|s,a)
\displaystyle=\int_{s^{\prime}\in\mathcal{S}}v(s^{\prime})\langle\bm{\varphi}(%
s,a),\bm{\mu}(ds^{\prime})\rangle
\displaystyle=\int_{s^{\prime}\in\mathcal{S}}v(s^{\prime})\langle\bm{\varphi}(%
s,a),\bm{\mu}(ds^{\prime})\rangle
\displaystyle=\langle\bm{\varphi}(s,a),\int_{s^{\prime}\in\mathcal{S}}v(s^{%
\prime})\bm{\mu}(ds^{\prime})\rangle.
\displaystyle=\langle\bm{\varphi}(s,a),\int_{s^{\prime}\in\mathcal{S}}v(s^{%
\prime})\bm{\mu}(ds^{\prime})\rangle.
\gamma\in(0,1)
\lambda>0
H
\beta
t\leftarrow 1
k\leftarrow 1
t_{k}\leftarrow 1
\Lambda_{1}\leftarrow\lambda I
\bar{\Lambda}_{0}\leftarrow\lambda I
Q^{1}_{t}(\cdot,\cdot)\leftarrow\frac{1}{1-\gamma}
t\in[T]
s_{1}
t=1,\dots,T
a_{t}=\operatorname*{argmax}_{a}Q^{k}_{t}(s_{t},a)
r(s_{t},a_{t})
s_{t+1}
\bar{\Lambda}_{t}\leftarrow\bar{\Lambda}_{t-1}+\bm{\varphi}(s_{t},a_{t})\bm{%
\varphi}(s_{t},a_{t})^{T}
2\det(\Lambda_{k})<\det(\bar{\Lambda}_{t})
k\leftarrow k+1
t_{k}\leftarrow t+1
\Lambda_{k}\leftarrow\bar{\Lambda}_{t}
T-t_{k}+1
\widetilde{V}_{T+1}^{k}(\cdot)\leftarrow\frac{1}{1-\gamma}
V^{k}_{T+1}(\cdot)\leftarrow\frac{1}{1-\gamma}
u=T,T-1,\dots,t_{k}
\bm{w}^{k}_{u+1}\leftarrow\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{\varphi}(%
s_{\tau},a_{\tau})(V^{k}_{u+1}(s_{\tau+1})-\min_{s^{\prime}}\widetilde{V}_{u+1%
}^{k}(s^{\prime})))
Q^{k}_{u}(\cdot,\cdot)\leftarrow\left(r(\cdot,\cdot)+\gamma(\langle\bm{\varphi%
}(\cdot,\cdot),\bm{w}^{k}_{u+1}\rangle+\min_{s^{\prime}}\widetilde{V}_{u+1}^{k%
}(s^{\prime})+\beta\|\bm{\varphi}(\cdot,\cdot)\|_{\Lambda_{k}^{-1}})\right)%
\wedge\frac{1}{1-\gamma}
\widetilde{V}^{k}_{u}(\cdot)\leftarrow\max_{a}Q^{k}_{u}(\cdot,a)
V^{k}_{u}(\cdot)\leftarrow\widetilde{V}^{k}_{u}(\cdot)\wedge(\min_{s^{\prime}}%
\widetilde{V}_{u}^{k}(s^{\prime})+H)
\gamma
\gamma
S
\sum_{t=1}^{T}(V_{t-1}(s_{t+1})-V_{t}(s_{t}))
t
T
S
\gamma
1/(1-\gamma)
V_{u}^{k}(s^{\prime})
\bm{\varphi}(s,a)
\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
V_{u}^{k}(\cdot)-\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
V_{u}^{k}(\cdot)
\|\bm{w}_{u}^{k}\|_{2}
\text{sp}(v^{\ast})
1/(1-\gamma)
\widetilde{\mathcal{O}}(\sqrt{T})
\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
\bm{w}_{u}^{k}
\langle\bm{\varphi}(\cdot,\cdot),\bm{w}_{u}^{k}\rangle+\min_{s^{\prime}}%
\widetilde{V}_{u}^{k}(s^{\prime})
\gamma
t
Q_{t}
Q
\sum_{t}V_{t-1}(s_{t+1})-V_{t}(s_{t})
V_{t}
t
V_{t}
V_{t-1}
V_{t}
T
t
Q_{T},Q_{T-1},\dots,Q_{t}
T-t
t
Q_{t}
Q_{t-1}
Q_{t}
\sum_{t=1}^{T}V_{t+1}(s_{t+1})-V_{t}(s_{t})
T
T
T
\gamma=1-\sqrt{\log(T)/T}
\lambda=1
H=2\cdot\text{sp}(v^{\ast})
\beta=2c_{\beta}\cdot\text{sp}(v^{\ast})d\sqrt{\log(dT/\delta)}
1-\delta
R_{T}\leq\mathcal{O}(\text{sp}(v^{\ast})\sqrt{d^{3}T\log(dT/\delta)}).
c_{\beta}
\sqrt{d}
\bar{\Lambda}_{t}
\mathcal{O}(d\log_{2}T)
T
u
\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
\widetilde{V}_{u}^{k}(s^{\prime})
s^{\prime}\in\mathcal{S}
\mathcal{O}(d^{2}SA)
\mathcal{O}(d^{2}+A)
\mathcal{O}((\log_{2}T)d^{2}SAT)
\mathcal{O}((\log_{2}T)T^{d})
S
S
S
\min_{s^{\prime}}V^{\ast}(s^{\prime})
\min_{s^{\prime}}V_{u}^{k}(s^{\prime})
\min_{s^{\prime}\in\{s_{1},\dots,s_{t}\}}V_{u}^{k}(s^{\prime})
\beta\|\bm{\phi}(\cdot,\cdot)\|_{\Lambda_{k}^{-1}}
\beta
V_{t}
Q_{t}
V^{\ast}
Q^{\ast}
1-\delta
c_{\beta}
\beta=c_{\beta}\cdot Hd\sqrt{\log(dT/\delta)}
|\langle\bm{\phi},\bm{w}_{u}^{k}-\bm{w}_{u}^{k}{}^{\ast}\rangle|\leq\beta\|\bm%
{\phi}\|_{\Lambda_{k}^{-1}}
k
\bm{\phi}\in\mathbb{R}^{d}
\bm{w}_{u}^{k}{}^{\ast}\coloneqq\int(V_{u}^{k}(s)-\min_{s^{\prime}}V_{u}^{k}(s%
^{\prime}))d\bm{\mu}(s)
\langle\bm{\varphi}(s,a),\bm{w}_{u}^{k}{}^{\ast}\rangle=PV_{u}^{k}(s,a)-\min_{%
s^{\prime}}V_{u}^{k}(s^{\prime})
H=2\cdot\text{sp}(v^{\ast})
1-\delta
k=1,2,\dots
u=t_{k},\dots,T+1
(s,a)\in\mathcal{S}\times\mathcal{A}
V_{u}^{k}(s)\geq V^{\ast}(s),\quad Q_{u}^{k}(s,a)\geq Q^{\ast}(s,a).
t
k
t
t+1
k
Q^{k}_{u}(\cdot,\cdot)
t=t_{k},\dots,T+1
(s,a)\in\mathcal{S}\times\mathcal{A}
\displaystyle r(s,a)\geq Q^{k}_{t}(s,a)-\gamma(\langle\bm{\varphi}(s,a),\bm{w}%
^{k}_{t+1}\rangle+\min_{s^{\prime}}V^{k}_{t+1}(s^{\prime})
\displaystyle r(s,a)
\displaystyle\geq Q^{k}_{t}(s,a)-\gamma(\langle\bm{\varphi}(s,a),\bm{w}^{k}_{t%
+1}\rangle+\min_{s^{\prime}}V^{k}_{t+1}(s^{\prime})
\displaystyle\hskip 85.35826pt-\beta\|\bm{\varphi}(s,a)\|_{\Lambda_{k}^{-1}})
\displaystyle\hskip 85.35826pt-\beta\|\bm{\varphi}(s,a)\|_{\Lambda_{k}^{-1}})
\displaystyle\geq Q^{k}_{t}(s,a)-\gamma PV^{k}_{t+1}(s,a)-4\beta\|\bm{\varphi}%
(s,a)\|_{\bar{\Lambda}_{t}^{-1}}
\displaystyle\geq Q^{k}_{t}(s,a)-\gamma PV^{k}_{t+1}(s,a)-4\beta\|\bm{\varphi}%
(s,a)\|_{\bar{\Lambda}_{t}^{-1}}
\|\bm{x}\|_{\Lambda_{k}^{-1}}\leq 2\|\bm{x}\|_{\Lambda_{t}^{-1}}
k
\displaystyle R^{k}=\sum_{t=t_{k}}^{t_{k+1}-1}(J^{\ast}-r(s_{t},a_{t}))
\displaystyle R^{k}
\displaystyle=\sum_{t=t_{k}}^{t_{k+1}-1}(J^{\ast}-r(s_{t},a_{t}))
\displaystyle\leq\sum_{t=t_{k}}^{t_{k+1}-1}(J^{\ast}-Q^{k}_{t}(s_{t},a_{t})+%
\gamma PV_{t+1}^{k}(s_{t},a_{t})+4\beta\|\bm{\varphi}(s_{t},a_{t})\|_{\Lambda_%
{t}^{-1}})
\displaystyle\leq\sum_{t=t_{k}}^{t_{k+1}-1}(J^{\ast}-Q^{k}_{t}(s_{t},a_{t})+%
\gamma PV_{t+1}^{k}(s_{t},a_{t})+4\beta\|\bm{\varphi}(s_{t},a_{t})\|_{\Lambda_%
{t}^{-1}})
\displaystyle=\underbrace{\sum_{t=t_{k}}^{t_{k+1}-1}(J^{\ast}-(1-\gamma)V^{k}_%
{t+1}(s_{t+1}))}_{(a)}+\gamma\underbrace{\sum_{t=t_{k}}^{t_{k+1}-1}(V^{k}_{t+1%
}(s_{t+1})-Q^{k}_{t}(s_{t},a_{t}))}_{(b)}
\displaystyle=\underbrace{\sum_{t=t_{k}}^{t_{k+1}-1}(J^{\ast}-(1-\gamma)V^{k}_%
{t+1}(s_{t+1}))}_{(a)}+\gamma\underbrace{\sum_{t=t_{k}}^{t_{k+1}-1}(V^{k}_{t+1%
}(s_{t+1})-Q^{k}_{t}(s_{t},a_{t}))}_{(b)}
\displaystyle\hskip 56.9055pt+~{}\gamma\underbrace{\sum_{t=t_{k}}^{t_{k+1}-1}(%
PV^{k}_{t+1}(s_{t},a_{t})-V^{k}_{t+1}(s_{t+1}))}_{(c)}+4\beta\underbrace{\sum_%
{t=t_{k}}^{t_{k+1}-1}\|\bm{\varphi}(s_{t},a_{t})\|_{\Lambda_{t}^{-1}}}_{(d)}
\displaystyle\hskip 56.9055pt+~{}\gamma\underbrace{\sum_{t=t_{k}}^{t_{k+1}-1}(%
PV^{k}_{t+1}(s_{t},a_{t})-V^{k}_{t+1}(s_{t+1}))}_{(c)}+4\beta\underbrace{\sum_%
{t=t_{k}}^{t_{k+1}-1}\|\bm{\varphi}(s_{t},a_{t})\|_{\Lambda_{t}^{-1}}}_{(d)}
r(s_{t},a_{t})
(a)
T(1-\gamma)\text{sp}(v^{\ast})
V^{k}_{u}(s_{t+1})\geq V^{\ast}(s_{t+1})
(d)
\mathcal{O}(\beta\sqrt{dT\log T})
(c)
\mathcal{O}(\text{sp}(v^{\ast})\sqrt{T\log(1/\delta)})
\text{sp}(V^{k}_{u})\leq 2\cdot\text{sp}(v^{\ast})
(b)
\displaystyle V^{k}_{t+1}(s_{t+1})\leq\widetilde{V}^{k}_{t+1}(s_{t+1})
\displaystyle V^{k}_{t+1}(s_{t+1})
\displaystyle\leq\widetilde{V}^{k}_{t+1}(s_{t+1})
\displaystyle=\max_{a}Q^{k}_{t+1}(s_{t+1},a)
\displaystyle=\max_{a}Q^{k}_{t+1}(s_{t+1},a)
\displaystyle=Q^{k}_{t+1}(s_{t+1},a_{t+1})
\displaystyle=Q^{k}_{t+1}(s_{t+1},a_{t+1})
t
t+1
k
a_{t+1}
Q^{k}_{t+1}(s_{t+1},\cdot)
\displaystyle\sum_{t=t_{k}}^{t_{k+1}-1}(V^{k}_{t+1}(s_{t+1})-Q^{k}_{t}(s_{t},a%
_{t}))\leq\frac{1}{1-\gamma}+\sum_{t=t_{k}}^{t_{k+1}-2}(Q^{k}_{t+1}(s_{t+1},a_%
{t+1})-Q^{k}_{t}(s_{t},a_{t}))
\displaystyle\sum_{t=t_{k}}^{t_{k+1}-1}(V^{k}_{t+1}(s_{t+1})-Q^{k}_{t}(s_{t},a%
_{t}))
\displaystyle\leq\frac{1}{1-\gamma}+\sum_{t=t_{k}}^{t_{k+1}-2}(Q^{k}_{t+1}(s_{%
t+1},a_{t+1})-Q^{k}_{t}(s_{t},a_{t}))
\displaystyle\leq\mathcal{O}\left(\frac{1}{1-\gamma}\right)
\displaystyle\leq\mathcal{O}\left(\frac{1}{1-\gamma}\right)
Q^{k}_{t}\leq\frac{1}{1-\gamma}
\mathcal{O}(d\log(T))
\beta=\mathcal{O}(\text{sp}(v^{\ast})d\sqrt{\log(dT/\delta)}
\displaystyle R_{T}\leq\mathcal{O}\Big{(}T(1-\gamma)\text{sp}(v^{\ast})+\frac{%
d}{1-\gamma}\log(T)+\text{sp}(v^{\ast})\sqrt{T\log(1/\delta)}+\text{sp}(v^{%
\ast})\sqrt{d^{3}T\log(dT/\delta)}\Big{)}.
\displaystyle R_{T}
\displaystyle\leq\mathcal{O}\Big{(}T(1-\gamma)\text{sp}(v^{\ast})+\frac{d}{1-%
\gamma}\log(T)+\text{sp}(v^{\ast})\sqrt{T\log(1/\delta)}+\text{sp}(v^{\ast})%
\sqrt{d^{3}T\log(dT/\delta)}\Big{)}.
\gamma=1-\frac{\sqrt{\log T}}{\sqrt{T}}
R_{T}\leq\mathcal{O}\left(\text{sp}(v^{\ast})\sqrt{d^{3}T\log(dT/\delta)}%
\right).
\widetilde{\mathcal{O}}(\sqrt{T})
\{\varepsilon_{t}\}_{t=1}^{\infty}
\{\mathcal{F}_{t}\}_{t=0}^{\infty}
\varepsilon_{t}|\mathcal{F}_{t-1}
\sigma
\{Z_{t}\}_{t=0}^{\infty}
\mathbb{R}
Z_{t}\in\mathcal{F}_{t-1}
W>0
\delta>0
1-\delta
t\geq 0
\frac{(\sum_{s=1}^{t}Z_{s}\varepsilon_{s})^{2}}{W+\sum_{s=1}^{t}Z_{s}^{2}}\leq
2%
\sigma^{2}\log\left(\frac{\sqrt{W+\sum_{s=1}^{t}Z_{t}^{2}}}{\delta\sqrt{W}}%
\right).
|(\widehat{P}_{t}-P)V_{t}(s,a)|
t\in[T]
V_{t}
V_{t}
\mathcal{V}_{\text{tabular}}=\{v\in\mathbb{R}^{\mathcal{S}}:\text{sp}(v)\leq 2%
\text{sp}(v^{\ast}),~{}v(s)\in[0,\textstyle\frac{1}{1-\gamma}]~{}\text{for all%
}~{}s\in\mathcal{S}\}.
\mathcal{V}_{\text{tabular}}
\mathcal{V}_{\text{tabular}}
V\in\mathcal{V}_{\text{tabular}}
C
\delta\in(0,1)
1-\delta
|(\widehat{P}_{t}-P)V(s,a)|\leq C\text{sp}(v^{\ast})\sqrt{\frac{\log(SAT/%
\delta)}{N_{t}(s,a)}}
(s,a)\in\mathcal{S}\times\mathcal{A}
t=1,\dots,T
(s,a)\in\mathcal{S}\times\mathcal{A}
(\widehat{P}_{t}-P)V(s,a)=\frac{1}{N_{t}(s,a)}\sum_{\tau=1}^{t}\mathbb{I}\{s_{%
\tau}=s,a_{\tau}=a\}[V(s_{\tau+1})-PV(s,a)].
\varepsilon_{t}=\mathbb{I}\{s_{t}=s,a_{t}=a\}[V(s_{t+1})-PV(s,a)]
Z_{t}=\mathbb{I}\{s_{t}=s,a_{t}=a\}
W=1
\varepsilon_{t}
2\text{sp}(v^{\ast})
\text{sp}(v^{\ast})
C
1-\frac{\delta}{SA}
t=1,\dots,T
\displaystyle|(\widehat{P}_{t}-P)V(s,a)|\leq\frac{2\sum_{s=1}^{t}Z_{s}%
\varepsilon_{s}}{1+\sum_{s=1}^{t}Z_{t}^{2}}
\displaystyle|(\widehat{P}_{t}-P)V(s,a)|
\displaystyle\leq\frac{2\sum_{s=1}^{t}Z_{s}\varepsilon_{s}}{1+\sum_{s=1}^{t}Z_%
{t}^{2}}
\displaystyle\leq C\text{sp}(v^{\ast})\sqrt{\frac{\log(SA\sqrt{N_{t}(s,a)}/%
\delta)}{N_{t}(s,a)}}
\displaystyle\leq C\text{sp}(v^{\ast})\sqrt{\frac{\log(SA\sqrt{N_{t}(s,a)}/%
\delta)}{N_{t}(s,a)}}
\displaystyle\leq C\text{sp}(v^{\ast})\sqrt{\frac{\log(SAT/\delta)}{N_{t}(s,a)%
}}.
\displaystyle\leq C\text{sp}(v^{\ast})\sqrt{\frac{\log(SAT/\delta)}{N_{t}(s,a)%
}}.
(s,a)\in\mathcal{S}\times\mathcal{A}
\mathcal{N_{\epsilon}}
\epsilon
\mathcal{V}_{\text{tabular}}
\text{dist}(V,V^{\prime})=\|V-V^{\prime}\|_{\infty}
\mathcal{V}_{\text{tabular}}
\{v\in\mathbb{R}^{\mathcal{S}}:v(s)\in[0,\frac{1}{1-\gamma}]~{}\text{for all}~%
{}s\in\mathcal{S}\}
\epsilon
(\frac{1}{\epsilon(1-\gamma)})^{|\mathcal{S}|}
\log\mathcal{N}_{\epsilon}\leq S\log\frac{1}{\epsilon(1-\gamma)}.
V\in\mathcal{V}
\widetilde{V}
\epsilon
V=\widetilde{V}+\Delta_{V}
\sup_{s}|\Delta_{V}(s)|\leq\epsilon
|(\widehat{P}_{t}-P)V_{t}(s,a)|\leq|(\widehat{P}_{t}-P)\widetilde{V}(s,a)|+|(%
\widehat{P}_{t}-P)\Delta_{V}(s,a)|\leq|(\widehat{P}_{t}-P)\widetilde{V}(s,a)|+%
2\epsilon.
|(\widehat{P}_{t}-P)V_{t}(s,a)|\leq C\text{sp}(v^{\ast})\sqrt{\frac{\log(SAT%
\mathcal{N}_{\epsilon}/\delta)}{N_{t}(s,a)}}+2\epsilon\leq C\text{sp}(v^{\ast}%
)\sqrt{\frac{S\log\frac{SAT}{\delta\epsilon(1-\gamma)}}{N_{t}(s,a)}}+2\epsilon.
\epsilon=\frac{1}{\sqrt{T}}
t\geq 1
t=1
V_{1}(\cdot)=\frac{1}{1-\gamma}
Q_{1}(\cdot,\cdot)=\frac{1}{1-\gamma}
V_{1},\dots,V_{t}\geq V^{\ast}
Q_{1},\dots,Q_{t}\geq Q^{\ast}
Q_{t+1}(s,a)\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
Q^{\ast}(s,a)=r(s,a)+\gamma(PV^{\ast})(s,a).
(s,a)\in\mathcal{S}\times\mathcal{A}
Q_{t+1}
Q_{t+1}(s,a)=Q_{t}(s,a)
Q_{t+1}(s,a)=r(s,a)+\gamma(\widehat{P}_{t}V_{t})(s,a)+\beta\sqrt{1/N_{t}(s,a)}
Q_{t+1}(s,a)=r(s,a)+\gamma(\widehat{P}_{t}V_{t}-PV^{\ast})(s,a)+\beta\sqrt{1/N%
_{t}(s,a)}
Q_{t+1}(s,a)-Q^{\ast}(s,a)=\gamma(\widehat{P}_{t}V_{t}-PV^{\ast})(s,a)+\beta%
\sqrt{1/N_{t}(s,a)}.
\displaystyle(\widehat{P}_{t}V_{t}-PV^{\ast})(s,a)=(\widehat{P}_{t}-P)V_{t}(s,%
a)+P(V_{t}-V^{\ast})(s,a)
\displaystyle(\widehat{P}_{t}V_{t}-PV^{\ast})(s,a)
\displaystyle=(\widehat{P}_{t}-P)V_{t}(s,a)+P(V_{t}-V^{\ast})(s,a)
\displaystyle\geq P(V_{t}-V^{\ast})(s,a)-C\cdot\text{sp}(v^{\ast})\sqrt{\frac{%
S\log(SAT/\delta)}{N_{t}(s,a)}}.
\displaystyle\geq P(V_{t}-V^{\ast})(s,a)-C\cdot\text{sp}(v^{\ast})\sqrt{\frac{%
S\log(SAT/\delta)}{N_{t}(s,a)}}.
\beta
Q_{t+1}(s,a)-Q^{\ast}(s,a)\geq P(V_{t}-V^{\ast})(s,a)\geq 0.
V_{t+1}(s)\geq V^{\ast}(s)
\widetilde{V}_{t+1}
\widetilde{V}_{t+1}(s)=V_{t}(s)
\widetilde{V}_{t+1}(s)=\max_{a}Q_{t+1}(s,a)
\widetilde{V}_{t+1}(s)=\max_{a}Q_{t+1}(s,a)
Q
\widetilde{V}_{t+1}(s)-V^{\ast}(s)=\max_{a}Q_{t+1}(s,a)-Q^{\ast}(s,a_{s}^{\ast%
})\geq Q_{t+1}(s,a_{s}^{\ast})-Q^{\ast}(s,a_{s}^{\ast})\geq 0,
a_{s}^{\ast}=\operatorname*{argmax}_{a}Q^{\ast}(s,a)
V_{t+1}
V_{t+1}(s)=\widetilde{V}_{t+1}(s)\wedge(\min_{s^{\prime}}\widetilde{V}_{t+1}(s%
^{\prime})+\text{sp}(v^{\ast}))\geq\widetilde{V}_{t+1}(s)\geq V^{\ast}(s)
\{\varepsilon_{t}\}_{t=1}^{\infty}
\{\mathcal{F}_{t}\}_{t=0}^{\infty}
\varepsilon_{t}|\mathcal{F}_{t-1}
\sigma
\{\phi_{t}\}_{t=0}^{\infty}
\mathbb{R}^{d}
\phi_{t}\in\mathcal{F}_{t-1}
\Lambda_{0}
d\times d
\Lambda_{t}=\Lambda_{0}+\sum_{s=1}^{t}\phi_{s}\phi_{s}^{T}
\delta>0
1-\delta
t\geq 0
\left\|\sum_{s=1}^{t}\phi_{s}\varepsilon_{s}\right\|_{\Lambda_{t}^{-1}}^{2}%
\leq 2\sigma^{2}\log\left(\frac{\text{det}(\Lambda_{t})^{1/2}\text{det}(%
\Lambda_{0})^{-1/2}}{\delta}\right).
V:\mathcal{S}\rightarrow[0,B]
\bm{w}_{V}^{\ast}\in\mathbb{R}^{d}
PV(s,a)=\langle\varphi(s,a),\bm{w}_{V}\rangle
(s,a)\in\mathcal{S}\times\mathcal{A}
\|\bm{w}_{V}^{\ast}\|_{2}\leq B\sqrt{d}.
PV(s,a)=\int_{\mathcal{S}}V(s^{\prime})P(ds^{\prime}|s,a)=\int_{\mathcal{S}}V(%
s^{\prime})\langle\bm{\varphi}(s,a),\bm{\mu}(ds^{\prime})\rangle=\langle\bm{%
\varphi}(s,a),\int_{\mathcal{S}}V(s^{\prime})d\bm{\mu}(s^{\prime})\rangle.
\bm{w}_{V}^{\ast}=\int_{\mathcal{S}}V(s^{\prime})d\bm{\mu}(s^{\prime})
PV(s,a)=\langle\bm{\varphi}(s,a),\bm{w}_{V}\rangle
(s,a)\in\mathcal{S}\times\mathcal{A}
\bm{w}_{V}
\|\bm{w}_{V}\|_{2}=\left\|\int_{\mathcal{S}}V(s^{\prime})d\bm{\mu}(s^{\prime})%
\right\|_{2}\leq B\left\|\int_{\mathcal{S}}d\bm{\mu}(s^{\prime})\right\|_{2}%
\leq B\sqrt{d}
\bm{\mu}
V(s^{\prime})\geq 0
\bm{\mu}(\mathcal{S})
\bm{w}
y\in[0,B]
\bm{x}\in\mathbb{R}^{d}
\{(\bm{x}_{i},y_{i})\}_{i=1}^{n}
\bm{w}=\Lambda^{-1}\sum_{i=1}^{n}\bm{x}_{i}y_{i}
\Lambda=\sum_{i=1}^{n}\bm{x}\bm{x}^{T}+\lambda I
\|\bm{w}\|_{2}\leq B\sqrt{dn/\lambda}.
\bm{u}\in\mathbb{R}^{d}
\|\bm{u}\|_{2}=1
\displaystyle|\bm{u}^{T}\bm{w}|=\left|\bm{u}^{T}\Lambda^{-1}\sum_{i=1}^{n}\bm{%
x}_{i}y_{i}\right|
\displaystyle|\bm{u}^{T}\bm{w}|
\displaystyle=\left|\bm{u}^{T}\Lambda^{-1}\sum_{i=1}^{n}\bm{x}_{i}y_{i}\right|
\displaystyle\leq B\sum_{i=1}^{n}|\bm{u}^{T}\Lambda^{-1}\bm{x}_{i}|
\displaystyle\leq B\sum_{i=1}^{n}|\bm{u}^{T}\Lambda^{-1}\bm{x}_{i}|
\displaystyle\leq B\sum_{i=1}^{n}\sqrt{\bm{u}^{T}\Lambda^{-1}\bm{u}}\sqrt{\bm{%
x}_{i}^{T}\Lambda^{-1}\bm{x}_{i}}
\displaystyle\leq B\sum_{i=1}^{n}\sqrt{\bm{u}^{T}\Lambda^{-1}\bm{u}}\sqrt{\bm{%
x}_{i}^{T}\Lambda^{-1}\bm{x}_{i}}
\displaystyle\leq\frac{B}{\sqrt{\lambda}}\sum_{i=1}^{n}\sqrt{\bm{x}_{i}^{T}%
\Lambda^{-1}\bm{x}_{i}}
\displaystyle\leq\frac{B}{\sqrt{\lambda}}\sum_{i=1}^{n}\sqrt{\bm{x}_{i}^{T}%
\Lambda^{-1}\bm{x}_{i}}
\displaystyle\leq\frac{B}{\sqrt{\lambda}}\sqrt{n}\sqrt{\sum_{i=1}^{n}{\bm{x}_{%
i}^{T}\Lambda^{-1}\bm{x}_{i}}}
\displaystyle\leq\frac{B}{\sqrt{\lambda}}\sqrt{n}\sqrt{\sum_{i=1}^{n}{\bm{x}_{%
i}^{T}\Lambda^{-1}\bm{x}_{i}}}
\displaystyle\leq B\sqrt{dn/\lambda}
\displaystyle\leq B\sqrt{dn/\lambda}
\Lambda\succeq\lambda I
\|\bm{w}\|_{2}=\max_{\bm{u}:\|\bm{u}\|_{2}=1}|\bm{u}^{T}\bm{w}|
B
\|V\|_{\infty}\leq B
\text{sp}(V)\leq B
\{x_{t}\}_{t=1}^{\infty}
\mathcal{S}
\{\mathcal{F}_{t}\}_{t=0}^{\infty}
\{\phi_{t}\}_{t=0}^{\infty}
\mathbb{R}^{d}
\phi_{t}\in\mathcal{F}_{t-1}
\|\phi_{t}\|_{2}\leq 1
\Lambda_{n}=\lambda I+\sum_{t=1}^{n}\phi_{t}\phi_{t}^{T}
\delta>0
\mathcal{V}
1-\delta
n\geq 0
V\in\mathcal{V}
\text{sp}(V)\leq H
\left\|\sum_{t=1}^{n}\phi_{t}(V(x_{t})-\mathbb{E}[V(x_{t})|\mathcal{F}_{t-1}])%
\right\|_{\Lambda_{n}^{-1}}^{2}\leq 4H^{2}\left[\frac{d}{2}\log\left(\frac{n+%
\lambda}{\lambda}\right)+\log\frac{\mathcal{N}_{\varepsilon}}{\delta}\right]+%
\frac{8n^{2}\varepsilon^{2}}{\lambda}
\mathcal{N}_{\varepsilon}
\varepsilon
\mathcal{V}
\text{dist}(V,V^{\prime})=\sup_{x}|V(x)-V^{\prime}(x)|
\mathcal{V}_{\text{linear}}
\mathcal{S}
\mathbb{R}
V(\cdot)=\max_{a}\bm{w}^{T}\bm{\varphi}(\cdot,a)+v+\beta\sqrt{\bm{\varphi}(%
\cdot,a)^{T}\Lambda^{-1}\bm{\varphi}(\cdot,a)}\wedge M
(\bm{w},\beta,v,\Lambda,M)
\|\bm{w}\|\leq L
\beta\in[0,B]
v\in[0,D]
M\geq 0
\lambda_{\text{min}}(\Lambda)\geq\lambda
\|\bm{\varphi}(s,a)\|\leq 1
(s,a)
\mathcal{N}_{\varepsilon}
\varepsilon
\mathcal{V}
\text{dist}(V,V^{\prime})=\sup_{x}|V(x)-V^{\prime}(x)|
\log\mathcal{N}_{\varepsilon}\leq d\log(1+8L/\varepsilon)+\log(1+4D/%
\varepsilon)+d^{2}\log[1+8d^{1/2}B^{2}/(\lambda\varepsilon^{2})].
V_{u}^{(t)}
V^{(t)}_{T+1}(\cdot)\leftarrow\frac{1}{1-\gamma}
V^{(t)}_{T+1}(\cdot)\leftarrow\frac{1}{1-\gamma}
u=T,T-1,\dots,1
\bm{w}^{(t)}_{u+1}\leftarrow\bar{\Lambda}_{t}^{-1}\sum_{\tau=1}^{t}\bm{\varphi%
}(s_{\tau},a_{\tau})(V^{(t)}_{u+1}(s_{\tau+1})-\min_{s^{\prime}}\widetilde{V}^%
{(t)}_{u+1}(s^{\prime}))
\widetilde{Q}^{(t)}_{u}(\cdot,\cdot)\leftarrow\left(r(\cdot,\cdot)+\gamma(%
\langle\bm{\varphi}(\cdot,\cdot),\bm{w}^{(t)}_{u+1}\rangle+\min_{s^{\prime}}%
\widetilde{V}^{(t)}_{u+1}(s^{\prime})+\beta\|\bm{\varphi}(\cdot,\cdot)\|_{\bar%
{\Lambda}_{t}^{-1}})\right)\wedge\frac{1}{1-\gamma}
\widetilde{V}^{(t)}_{u}(\cdot)\leftarrow\max_{a}\widetilde{Q}^{(t)}_{u}(\cdot,a)
V^{(t)}_{u}(\cdot)\leftarrow\widetilde{V}^{(t)}_{u}(\cdot)\wedge(\min_{s^{%
\prime}}\widetilde{V}^{(t)}_{u}(s^{\prime})+H)
\|\sum_{\tau=1}^{t}\bm{\varphi}(s_{\tau},a_{\tau})[V_{u}^{(t)}(s_{\tau+1})-PV_%
{u}^{(t)}(s_{\tau},a_{\tau})]\|_{\bar{\Lambda}_{t}^{-1}}
u\in[T]
t\in[T]
(t_{k}-1,V_{u}^{k},\Lambda_{k})
(t,V_{u}^{(t)},\bar{\Lambda}_{t})
t\in[T]
\|\sum_{\tau=1}^{t_{k}-1}\bm{\varphi}(s_{\tau},a_{\tau})[V_{u}^{k}(s_{\tau+1})%
-PV_{u}^{k}(s_{\tau},a_{\tau})]\|_{\Lambda_{k}^{-1}}
k
\gamma
c_{\beta}
\beta=c_{\beta}Hd\sqrt{\log(dT/\delta)}
C
c_{\beta}
\delta\in(0,1)
\mathcal{E}
\displaystyle\forall u\in[T],~{}t\in[T]:
\displaystyle\forall u\in[T],~{}
\displaystyle t\in[T]:
\displaystyle\hskip 5.69054pt\left\|\sum_{\tau=1}^{t}\bm{\varphi}(s_{\tau},a_{%
\tau})[V_{u}^{(t)}(s_{\tau+1})-PV_{u}^{(t)}(s_{\tau},a_{\tau})]\right\|_{\bar{%
\Lambda}_{t}^{-1}}\leq C\cdot Hd\sqrt{\log((c_{\beta}+1)dT/\delta)}
\displaystyle\hskip 5.69054pt\left\|\sum_{\tau=1}^{t}\bm{\varphi}(s_{\tau},a_{%
\tau})[V_{u}^{(t)}(s_{\tau+1})-PV_{u}^{(t)}(s_{\tau},a_{\tau})]\right\|_{\bar{%
\Lambda}_{t}^{-1}}\leq C\cdot Hd\sqrt{\log((c_{\beta}+1)dT/\delta)}
P(\mathcal{E})\geq 1-\delta
t=1,\dots,T
\|\bm{w}_{t}\|_{2}\leq H\sqrt{dt/\lambda}
\varepsilon>0
(u,t)\in[T]\times[T]
1-\delta/T^{2}
\displaystyle\bigg{\|}\sum_{\tau=1}^{t}\bm{\varphi}(s_{\tau},a_{\tau})[V_{u}(s%
_{\tau+1})-PV_{u}(s_{\tau},a_{\tau})]\bigg{\|}_{\bar{\Lambda}_{t}^{-1}}^{2}
\displaystyle\bigg{\|}\sum_{\tau=1}^{t}\bm{\varphi}(s_{\tau},a_{\tau})[V_{u}(s%
_{\tau+1})-PV_{u}(s_{\tau},a_{\tau})]\bigg{\|}_{\bar{\Lambda}_{t}^{-1}}^{2}
\displaystyle\hskip 56.9055pt\leq 4H^{2}\left[\frac{2}{d}\log\left(\frac{t+%
\lambda}{\lambda}\right)+d\log\left(1+\frac{4H\sqrt{dt}}{\varepsilon\sqrt{%
\lambda}}\right)+d^{2}\log\left(1+\frac{8d^{1/2}\beta^{2}}{\varepsilon^{2}%
\lambda}\right)+\log\left(\frac{T^{2}}{\delta}\right)\right]+\frac{8t^{2}%
\varepsilon^{2}}{\lambda}
\displaystyle\hskip 56.9055pt\leq 4H^{2}\left[\frac{2}{d}\log\left(\frac{t+%
\lambda}{\lambda}\right)+d\log\left(1+\frac{4H\sqrt{dt}}{\varepsilon\sqrt{%
\lambda}}\right)+d^{2}\log\left(1+\frac{8d^{1/2}\beta^{2}}{\varepsilon^{2}%
\lambda}\right)+\log\left(\frac{T^{2}}{\delta}\right)\right]+\frac{8t^{2}%
\varepsilon^{2}}{\lambda}
\tau_{t}\leq t
(u,t)\in[T]\times[T]
\varepsilon=Hd/t
\lambda=1
C>0
c_{\beta}
1-\delta
\bigg{\|}\sum_{\tau=1}^{t}\varphi(s_{\tau},a_{\tau})[V_{u}(s_{\tau+1})-PV_{u}(%
s_{\tau},a_{\tau})]\bigg{\|}_{\bar{\Lambda}_{t}^{-1}}^{2}\leq C^{2}\cdot d^{2}%
H^{2}\log((c_{\beta}+1)dT/\delta),
\mathcal{E}
\bar{V}_{u}^{k}(s)=V_{u}^{k}(s)-\min_{s^{\prime}}V_{u}^{k}(s^{\prime})
\bm{w}_{u}^{k}=\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{\varphi}(s_{\tau},a_%
{\tau})\bar{V}_{u}^{k}(s_{\tau+1}).
\langle\bm{\phi},\bm{w}_{u}^{k}\rangle
\displaystyle\langle\bm{\phi},\bm{w}_{u}^{k}\rangle=\underbrace{\langle\bm{%
\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{\varphi}(s_{\tau},a_{\tau})P%
\bar{V}_{u}^{k}(s_{\tau},a_{\tau})\rangle}_{(a)}+\underbrace{\langle\bm{\phi},%
\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{\varphi}(s_{\tau},a_{\tau})(\bar{V}%
_{u}^{k}(s_{\tau+1})-P\bar{V}_{u}^{k}(s_{\tau},a_{\tau}))}_{(b)}.
\displaystyle\langle\bm{\phi},\bm{w}_{u}^{k}\rangle
\displaystyle=\underbrace{\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k%
}-1}\bm{\varphi}(s_{\tau},a_{\tau})P\bar{V}_{u}^{k}(s_{\tau},a_{\tau})\rangle}%
_{(a)}+\underbrace{\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm%
{\varphi}(s_{\tau},a_{\tau})(\bar{V}_{u}^{k}(s_{\tau+1})-P\bar{V}_{u}^{k}(s_{%
\tau},a_{\tau}))}_{(b)}.
\bm{w}_{u}^{k}{}^{\ast}=\int\bar{V}_{u}^{k}(s)d\bm{\mu}(s)
\bar{V}_{u}^{k}(s)\in[0,H]
s\in\mathcal{S}
\|\bm{w}_{u}^{k}{}^{\ast}\|_{2}\leq H\sqrt{d}
(a)
\displaystyle\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{%
\varphi}(s_{\tau},a_{\tau})P\bar{V}_{u}^{k}(s_{\tau},a_{\tau})\rangle=\langle%
\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{\varphi}(s_{\tau},a_{\tau%
})\bm{\varphi}(s_{\tau},a_{\tau})^{T}\bm{w}_{u}^{k}{}^{\ast}\rangle
\displaystyle\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{%
\varphi}(s_{\tau},a_{\tau})P\bar{V}_{u}^{k}(s_{\tau},a_{\tau})\rangle
\displaystyle=\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{%
\varphi}(s_{\tau},a_{\tau})\bm{\varphi}(s_{\tau},a_{\tau})^{T}\bm{w}_{u}^{k}{}%
^{\ast}\rangle
\displaystyle=\langle\bm{\phi},\bm{w}_{u}^{k}{}^{\ast}\rangle-\lambda\langle%
\bm{\phi},\Lambda_{k}^{-1}\bm{w}_{u}^{k}{}^{\ast}\rangle
\displaystyle=\langle\bm{\phi},\bm{w}_{u}^{k}{}^{\ast}\rangle-\lambda\langle%
\bm{\phi},\Lambda_{k}^{-1}\bm{w}_{u}^{k}{}^{\ast}\rangle
\displaystyle\leq\langle\bm{\phi},\bm{w}_{u}^{k}{}^{\ast}\rangle+\lambda\|\bm{%
\phi}\|_{\Lambda_{k}^{-1}}\|\bm{w}_{u}^{k}{}^{\ast}\|_{\Lambda_{k}^{-1}}
\displaystyle\leq\langle\bm{\phi},\bm{w}_{u}^{k}{}^{\ast}\rangle+\lambda\|\bm{%
\phi}\|_{\Lambda_{k}^{-1}}\|\bm{w}_{u}^{k}{}^{\ast}\|_{\Lambda_{k}^{-1}}
\displaystyle\leq\langle\bm{\phi},\bm{w}_{u}^{k}{}^{\ast}\rangle+H\sqrt{%
\lambda d}\|\bm{\phi}\|_{\Lambda_{k}^{-1}}
\displaystyle\leq\langle\bm{\phi},\bm{w}_{u}^{k}{}^{\ast}\rangle+H\sqrt{%
\lambda d}\|\bm{\phi}\|_{\Lambda_{k}^{-1}}
\mathcal{E}
(b)
\displaystyle\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{%
\varphi}(s_{\tau},a_{\tau})(\bar{V}_{u}^{k}(s_{\tau+1})-P\bar{V}_{u}^{k}(s_{%
\tau},a_{\tau}))
\displaystyle\langle\bm{\phi},\Lambda_{k}^{-1}\sum_{\tau=1}^{t_{k}-1}\bm{%
\varphi}(s_{\tau},a_{\tau})
\displaystyle(\bar{V}_{u}^{k}(s_{\tau+1})-P\bar{V}_{u}^{k}(s_{\tau},a_{\tau}))
\displaystyle\leq\|\bm{\phi}\|_{\Lambda_{k}^{-1}}\bigg{\|}\sum_{\tau=1}^{t_{k}%
-1}\bm{\varphi}(s_{\tau},a_{\tau})(V_{u}^{k}(s_{\tau+1})-PV_{u}^{k}(s_{\tau},a%
_{\tau}))\bigg{\|}_{\Lambda_{k}^{-1}}
\displaystyle\leq\|\bm{\phi}\|_{\Lambda_{k}^{-1}}\bigg{\|}\sum_{\tau=1}^{t_{k}%
-1}\bm{\varphi}(s_{\tau},a_{\tau})(V_{u}^{k}(s_{\tau+1})-PV_{u}^{k}(s_{\tau},a%
_{\tau}))\bigg{\|}_{\Lambda_{k}^{-1}}
\displaystyle\leq C\cdot Hd\sqrt{\log((c_{\beta}+1)dT/\delta)}\cdot\|\bm{\phi}%
\|_{\Lambda_{k}^{-1}}.
\displaystyle\leq C\cdot Hd\sqrt{\log((c_{\beta}+1)dT/\delta)}\cdot\|\bm{\phi}%
\|_{\Lambda_{k}^{-1}}.
\langle\bm{\phi},\bm{w}_{u}^{k}-\bm{w}_{u}^{k}{}^{\ast}\rangle\leq C\cdot Hd%
\sqrt{(\log(c_{\beta}+1)dT/\delta)}\cdot\|\bm{\phi}\|_{\Lambda_{k}^{-1}}
C
c_{\beta}
\langle\bm{\phi},\bm{w}_{u}^{k}-\bm{w}_{u}^{k}{}^{\ast}\rangle
|\langle\bm{\phi},\bm{w}_{u}^{k}-\bm{w}_{u}^{k}{}^{\ast}\rangle|\leq C\cdot Hd%
\sqrt{\log((c_{\beta}+1)dT/\delta)}\cdot\|\bm{\phi}\|_{\Lambda_{k}^{-1}}.
c_{\beta}
C\sqrt{\log(c_{\beta}+1)+\log(dT/\delta)}\leq c_{\beta}\sqrt{\log(dT/\delta)}.
\log(dT/\delta)\geq\log 2
c_{\beta}
C\sqrt{\log 2+\log(c_{\beta}+1)}\leq c_{\beta}\sqrt{\log 2}
\mathcal{E}
k>1
u=T+1,T,\dots,1
u=T+1
V_{T+1}^{k}(s)=\frac{1}{1-\gamma}\geq V^{\ast}(s)
s\in\mathcal{S}
Q_{T+1}^{k}(s,a)=\frac{1}{1-\gamma}\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
V_{u+1}^{k}(s)\geq V^{\ast}(s)
Q_{u+1}^{k}(s,a)\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
u\in[T]
\bar{V}_{u}^{k}(s)=V_{u}^{k}(s)-\min_{s^{\prime}}V_{u}^{k}(s^{\prime})
\bm{w}_{u}^{k}
\mathcal{E}
Q_{u}^{k}(s,a)
\displaystyle Q_{u}^{k}(s,a)=\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{%
w}_{u+1}^{k}\rangle+\min_{s^{\prime}}V_{u+1}^{k}(s^{\prime})+\beta\|\bm{%
\varphi}(s,a)\|_{\Lambda_{k}^{-1}}\right)\wedge\frac{1}{1-\gamma}
\displaystyle Q_{u}^{k}(s,a)
\displaystyle=\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}%
\rangle+\min_{s^{\prime}}V_{u+1}^{k}(s^{\prime})+\beta\|\bm{\varphi}(s,a)\|_{%
\Lambda_{k}^{-1}}\right)\wedge\frac{1}{1-\gamma}
\displaystyle\geq\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}%
{}^{\ast}\rangle+\min_{s^{\prime}}V_{u+1}^{k}(s^{\prime}))\right)\wedge\frac{1%
}{1-\gamma}
\displaystyle\geq\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}%
{}^{\ast}\rangle+\min_{s^{\prime}}V_{u+1}^{k}(s^{\prime}))\right)\wedge\frac{1%
}{1-\gamma}
\displaystyle=(r(s,a)+\gamma PV_{u+1}^{k}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle=(r(s,a)+\gamma PV_{u+1}^{k}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle\geq(r(s,a)+\gamma PV^{\ast}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle\geq(r(s,a)+\gamma PV^{\ast}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle=Q^{\ast}(s,a)
\displaystyle=Q^{\ast}(s,a)
\bm{w}_{u+1}^{k}{}^{\ast}
\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}{}^{\ast}\rangle=P\bar{V}_{u+1}^{k}(s%
,a)
V_{u+1}^{k}\geq V^{\ast}
Q^{\ast}\leq\frac{1}{1-\gamma}
Q_{u}^{k}(s,a)\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
V_{u}^{k}(s)\geq V^{\ast}(s)
s\in\mathcal{S}
\widetilde{V}_{u}^{k}(\cdot)=\max_{a}Q_{u}^{k}(\cdot,a)
s\in\mathcal{S}
\displaystyle\widetilde{V}_{u}^{k}(s)-V^{\ast}(s)=\max_{a}Q_{u}^{k}(s,a)-V^{%
\ast}(s)
\displaystyle\widetilde{V}_{u}^{k}(s)-V^{\ast}(s)
\displaystyle=\max_{a}Q_{u}^{k}(s,a)-V^{\ast}(s)
\displaystyle\geq Q_{u}^{k}(s,a_{s}^{\ast})-Q^{\ast}(s,a_{s}^{\ast})
\displaystyle\geq Q_{u}^{k}(s,a_{s}^{\ast})-Q^{\ast}(s,a_{s}^{\ast})
\displaystyle\geq 0
\displaystyle\geq 0
a_{s}^{\ast}=\operatorname*{argmax}_{a}Q^{\ast}(s,a)
V^{\ast}(s)=Q^{\ast}(s,a_{s}^{\ast})
\widetilde{V}_{u}^{k}(s)\geq V^{\ast}(s)
s\in\mathcal{S}
s\in\mathcal{S}
\displaystyle V_{u}^{k}(s)=\widetilde{V}_{u}^{k}(s)\wedge(\min_{s^{\prime}}%
\widetilde{V}_{u}^{k}(s^{\prime})+2\cdot\text{sp}(v^{\ast}))
\displaystyle V_{u}^{k}(s)
\displaystyle=\widetilde{V}_{u}^{k}(s)\wedge(\min_{s^{\prime}}\widetilde{V}_{u%
}^{k}(s^{\prime})+2\cdot\text{sp}(v^{\ast}))
\displaystyle\geq V^{\ast}(s)\wedge(\min_{s^{\prime}}V^{\ast}(s^{\prime})+2%
\cdot\text{sp}(v^{\ast}))
\displaystyle\geq V^{\ast}(s)\wedge(\min_{s^{\prime}}V^{\ast}(s^{\prime})+2%
\cdot\text{sp}(v^{\ast}))
\displaystyle=V^{\ast}(s)
\displaystyle=V^{\ast}(s)
\text{sp}(V^{\ast})\leq 2\cdot\text{sp}(v^{\ast})
V_{u}^{k}(s)\geq V^{\ast}(s)
Q_{u}^{k}(s,a)\geq Q^{\ast}(s,a)
u=T+1,T,\dots,1
\min_{s^{\prime}}V^{\ast}(s^{\prime})
\min_{s^{\prime}}V^{\ast}(s^{\prime})
\min_{s^{\prime}}V_{u}^{k}(s^{\prime})
\min_{s^{\prime}}V^{\ast}(s^{\prime})
\min_{s^{\prime}}V_{u}^{k}(s^{\prime})
u
k
H=2\cdot\text{sp}(v^{\ast})
1-\delta
u=1,\dots,T
(s,a)\in\mathcal{S}\times\mathcal{A}
V_{u}^{k}(s)\geq V^{\ast}(s),\quad Q_{u}^{k}(s,a)\geq Q^{\ast}(s,a).
\mathcal{E}
k>1
u=T+1,T,\dots,1
u=T+1
V_{T+1}^{k}(s)=\frac{1}{1-\gamma}\geq V^{\ast}(s)
s\in\mathcal{S}
Q_{T+1}^{k}(s,a)=\frac{1}{1-\gamma}\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
V_{u+1}^{k}(s)\geq V^{\ast}(s)
Q_{u+1}^{k}(s,a)\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
u\in[T]
\bar{V}_{u}^{k}(s)=V_{u}^{k}(s)-\min_{s^{\prime}}V^{\ast}(s^{\prime})
\bm{w}_{u+1}^{k}
\mathcal{E}
Q_{u}^{k}(s,a)
\displaystyle Q_{u}^{k}(s,a)=\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{%
w}_{u+1}^{k}\rangle+\min_{s^{\prime}}V^{\ast}(s^{\prime})+\beta\|\bm{\varphi}(%
s,a)\|_{\Lambda_{k}^{-1}}\right)\wedge\frac{1}{1-\gamma}
\displaystyle Q_{u}^{k}(s,a)
\displaystyle=\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}%
\rangle+\min_{s^{\prime}}V^{\ast}(s^{\prime})+\beta\|\bm{\varphi}(s,a)\|_{%
\Lambda_{k}^{-1}}\right)\wedge\frac{1}{1-\gamma}
\displaystyle\geq\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}%
{}^{\ast}\rangle+\min_{s^{\prime}}V^{\ast}(s^{\prime}))\right)\wedge\frac{1}{1%
-\gamma}
\displaystyle\geq\left(r(s,a)+\gamma(\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}%
{}^{\ast}\rangle+\min_{s^{\prime}}V^{\ast}(s^{\prime}))\right)\wedge\frac{1}{1%
-\gamma}
\displaystyle=(r(s,a)+\gamma PV_{u+1}^{k}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle=(r(s,a)+\gamma PV_{u+1}^{k}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle\geq(r(s,a)+\gamma PV^{\ast}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle\geq(r(s,a)+\gamma PV^{\ast}(s,a))\wedge\frac{1}{1-\gamma}
\displaystyle=Q^{\ast}(s,a)
\displaystyle=Q^{\ast}(s,a)
\bm{w}_{u+1}^{k}{}^{\ast}
\langle\bm{\varphi}(s,a),\bm{w}_{u+1}^{k}{}^{\ast}\rangle=P\bar{V}_{u+1}^{k}(s%
,a)
V_{u+1}^{k}\geq V^{\ast}
Q^{\ast}\leq\frac{1}{1-\gamma}
Q_{u}^{k}(s,a)\geq Q^{\ast}(s,a)
(s,a)\in\mathcal{S}\times\mathcal{A}
V_{u}^{k}(s)\geq V^{\ast}(s)
s\in\mathcal{S}
\widetilde{V}_{u}^{k}(\cdot)=\max_{a}\widetilde{Q}_{u}^{k}(\cdot,a)
s\in\mathcal{S}
\displaystyle\widetilde{V}_{u}^{k}(s)-V^{\ast}(s)=\max_{a}Q_{u}^{k}(s,a)-V^{%
\ast}(s)
\displaystyle\widetilde{V}_{u}^{k}(s)-V^{\ast}(s)
\displaystyle=\max_{a}Q_{u}^{k}(s,a)-V^{\ast}(s)
\displaystyle\geq Q_{u}^{k}(s,a_{s}^{\ast})-Q^{\ast}(s,a_{s}^{\ast})
\displaystyle\geq Q_{u}^{k}(s,a_{s}^{\ast})-Q^{\ast}(s,a_{s}^{\ast})
\displaystyle\geq 0
\displaystyle\geq 0
a_{s}^{\ast}=\operatorname*{argmax}_{a}Q^{\ast}(s,a)
V^{\ast}(s)=Q^{\ast}(s,a_{s}^{\ast})
\widetilde{V}_{u}^{k}(s)\geq V^{\ast}(s)
s\in\mathcal{S}
s\in\mathcal{S}
\displaystyle V_{u}^{k}(s)=\widetilde{V}_{u}^{k}(s)\wedge(\min_{s^{\prime}}V^{%
\ast}(s^{\prime})+2\cdot\text{sp}(v^{\ast}))
\displaystyle V_{u}^{k}(s)
\displaystyle=\widetilde{V}_{u}^{k}(s)\wedge(\min_{s^{\prime}}V^{\ast}(s^{%
\prime})+2\cdot\text{sp}(v^{\ast}))
\displaystyle\geq V^{\ast}(s)\wedge(\min_{s^{\prime}}V^{\ast}(s^{\prime})+2%
\cdot\text{sp}(v^{\ast}))
\displaystyle\geq V^{\ast}(s)\wedge(\min_{s^{\prime}}V^{\ast}(s^{\prime})+2%
\cdot\text{sp}(v^{\ast}))
\displaystyle=V^{\ast}(s)
\displaystyle=V^{\ast}(s)
\text{sp}(V^{\ast})\leq 2\cdot\text{sp}(v^{\ast})
V_{u}^{k}(s)\geq V^{\ast}(s)
Q_{u}^{k}(s,a)\geq Q^{\ast}(s,a)
u=T+1,T,\dots,1
\gamma
\gamma
\mathcal{O}(d\log T)
T
u
k
\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
t_{k}
V_{u}^{k}(\cdot)
V_{u}^{k}(\cdot)
d\times d
\Lambda_{k}^{-1}
d
\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
S
\widetilde{V}_{u}^{k}(\cdot)
\widetilde{V}_{u}^{k}(\cdot)
A
Q_{u}^{k}(\cdot,\cdot)
Q_{u}^{k}(\cdot,\cdot)
\mathcal{O}(d^{2})
\min_{s^{\prime}}\widetilde{V}_{u}^{k}(s^{\prime})
\mathcal{O}(d^{2}SA)
\bm{w}_{u}^{k}
V_{u+1}^{k}(\cdot)
T
\mathcal{O}(d^{2}AT)
T
d
Td
d\times d
d^{2}
\bm{w}_{u}^{k}
\mathcal{O}(d^{2}A(S+T))
T
\mathcal{O}(d^{2}A(S+T)T)
\mathcal{O}(d\log T)
\widetilde{\mathcal{O}}(d^{3}A(S+T)T)
d,S,A,T
\delta\in(0,1)
\lambda=1
\beta=20(2+\text{sp}(v^{\ast}))d\sqrt{\log(T/\delta)}
\Lambda_{1}=\lambda I
s_{1}
t=1,\dots,T
w_{t}
\displaystyle\max_{w_{t},b_{t}\in\mathbb{R}^{d},J_{t}\in\mathbb{R}}~{}~{}~{}J_%
{t}
\displaystyle\max_{w_{t},b_{t}\in\mathbb{R}^{d},J_{t}\in\mathbb{R}}~{}~{}~{}
\displaystyle J_{t}
\displaystyle\text{subject to}w_{t}=\Lambda_{t}^{-1}\sum_{\tau=1}^{t-1}(\bm{%
\varphi}(s_{\tau},a_{\tau})(r(s_{\tau},a_{\tau})-J_{t}+\max_{a}\langle\bm{%
\varphi}(s_{\tau+1},a),w_{t}\rangle)+b_{t})
\displaystyle w_{t}=\Lambda_{t}^{-1}\sum_{\tau=1}^{t-1}(\bm{\varphi}(s_{\tau},%
a_{\tau})(r(s_{\tau},a_{\tau})-J_{t}+\max_{a}\langle\bm{\varphi}(s_{\tau+1},a)%
,w_{t}\rangle)+b_{t})
\displaystyle\|b_{t}\|_{\Lambda_{t}}\leq\beta
\displaystyle\|b_{t}\|_{\Lambda_{t}}\leq\beta
\displaystyle\|w_{t}\|\leq(2+\text{sp}(v^{\ast}))\sqrt{d}
\displaystyle\|w_{t}\|\leq(2+\text{sp}(v^{\ast}))\sqrt{d}
\mathcal{O}(d\log T)
\mathcal{O}(d\log T)
w_{t}
b_{t}
J_{t}
\displaystyle G_{w}(\Delta)=\{\Delta\cdot(k_{1},\dots,k_{d}):\pm k_{1},\dots,%
\pm k_{d}\in[\lfloor(2+\text{sp}(v^{\ast}))/\Delta\rfloor]\}
\displaystyle G_{w}(\Delta)
\displaystyle=\{\Delta\cdot(k_{1},\dots,k_{d}):\pm k_{1},\dots,\pm k_{d}\in[%
\lfloor(2+\text{sp}(v^{\ast}))/\Delta\rfloor]\}
\displaystyle G_{b}(\Delta)=\{\Delta\cdot(k_{1},\dots,k_{d}):\pm k_{1},\dots,%
\pm k_{d}\in[\lfloor T\beta/(\sqrt{d}\Delta)\rfloor]\}
\displaystyle G_{b}(\Delta)
\displaystyle=\{\Delta\cdot(k_{1},\dots,k_{d}):\pm k_{1},\dots,\pm k_{d}\in[%
\lfloor T\beta/(\sqrt{d}\Delta)\rfloor]\}
\displaystyle G_{J}(\Delta)=\{\Delta k:k\in[\lfloor 1/\Delta\rfloor\}.
\displaystyle G_{J}(\Delta)
\displaystyle=\{\Delta k:k\in[\lfloor 1/\Delta\rfloor\}.
\|w\|_{2}\leq(2+\text{sp}(v^{\ast}))\sqrt{d}
\|b\|_{\Lambda_{t}}\leq\beta
w\in G_{w}(\Delta)
b\in G_{b}(\Delta)
J\in[0,1]
J\in G_{J}(\Delta)
G_{w}(\Delta)
G_{b}(\Delta)
G_{J}(\Delta)
\Delta
\|\cdot\|_{\infty}
\mathcal{B}_{d}((2+\text{sp}(v^{\ast}))\sqrt{d})
\mathcal{B}_{d}(T\beta)
[0,1]
\mathcal{B}_{d}(r)
d
r
\Delta_{t}(w,b,J)
t
\Delta_{t}(w,b,J)=w-\Lambda_{t}^{-1}\sum_{\tau=1}^{t-1}(\bm{\varphi}(s_{\tau},%
a_{\tau})(r(s_{\tau},a_{\tau})-J+\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),w%
\rangle)+b).
w_{t}^{\ast},b_{t}^{\ast},J_{t}^{\ast}
\Delta_{t}(w_{t}^{\ast},b_{t}^{\ast},J_{t}^{\ast})=0
\widetilde{w}_{t}^{\ast}\in G_{w}(\Delta)
\widetilde{b}_{t}^{\ast}\in G_{b}(\Delta)
\widetilde{J}^{\ast}\in G_{J}(\Delta)
w_{t}^{\ast},b_{t}^{\ast},J_{t}^{\ast}
\displaystyle\|\Delta_{t}(\widetilde{w}_{t}^{\ast},\widetilde{b}_{t}^{\ast},%
\widetilde{J}^{\ast})\|_{2}
\displaystyle\|\Delta_{t}(\widetilde{w}_{t}^{\ast},\widetilde{b}_{t}^{\ast},%
\widetilde{J}^{\ast})\|_{2}
\displaystyle=\|\Delta_{t}(\widetilde{w}_{t}^{\ast},\widetilde{b}_{t}^{\ast},%
\widetilde{J}^{\ast})-\Delta_{t}(w_{t}^{\ast},b_{t}^{\ast},J_{t}^{\ast})\|_{2}
\displaystyle=\|\Delta_{t}(\widetilde{w}_{t}^{\ast},\widetilde{b}_{t}^{\ast},%
\widetilde{J}^{\ast})-\Delta_{t}(w_{t}^{\ast},b_{t}^{\ast},J_{t}^{\ast})\|_{2}
\displaystyle=\|\widetilde{w}_{t}^{\ast}-w_{t}^{\ast}-\Lambda_{t}^{-1}\sum_{%
\tau=1}^{t-1}(\bm{\varphi}(s_{\tau},a_{\tau})(J_{t}^{\ast}-\widetilde{J}_{t}^{%
\ast}+\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),\widetilde{w}_{t}^{\ast}%
\rangle-\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),w_{t}^{\ast}\rangle)+%
\widetilde{b}_{t}^{\ast}-b_{t}^{\ast})\|_{2}
\displaystyle=\|\widetilde{w}_{t}^{\ast}-w_{t}^{\ast}-\Lambda_{t}^{-1}\sum_{%
\tau=1}^{t-1}(\bm{\varphi}(s_{\tau},a_{\tau})(J_{t}^{\ast}-\widetilde{J}_{t}^{%
\ast}+\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),\widetilde{w}_{t}^{\ast}%
\rangle-\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),w_{t}^{\ast}\rangle)+%
\widetilde{b}_{t}^{\ast}-b_{t}^{\ast})\|_{2}
\displaystyle\leq\|\widetilde{w}_{t}^{\ast}-w_{t}^{\ast}\|_{2}+\sum_{\tau=1}^{%
t-1}|J_{t}^{\ast}-\widetilde{J}_{t}^{\ast}|\|\Lambda_{t}^{-1}\|_{2}\|\bm{%
\varphi}(s_{\tau},a_{\tau})\|_{2}+\sum_{\tau=1}^{t-1}\max_{a}|\langle\bm{%
\varphi}(s_{\tau+1},a),\widetilde{w}_{t}^{\ast}-w_{t}^{\ast}\rangle|\|\Lambda_%
{t}^{-1}\|_{2}\|\bm{\varphi}(s_{\tau},a_{\tau})\|_{2}
\displaystyle\leq\|\widetilde{w}_{t}^{\ast}-w_{t}^{\ast}\|_{2}+\sum_{\tau=1}^{%
t-1}|J_{t}^{\ast}-\widetilde{J}_{t}^{\ast}|\|\Lambda_{t}^{-1}\|_{2}\|\bm{%
\varphi}(s_{\tau},a_{\tau})\|_{2}+\sum_{\tau=1}^{t-1}\max_{a}|\langle\bm{%
\varphi}(s_{\tau+1},a),\widetilde{w}_{t}^{\ast}-w_{t}^{\ast}\rangle|\|\Lambda_%
{t}^{-1}\|_{2}\|\bm{\varphi}(s_{\tau},a_{\tau})\|_{2}
\displaystyle\hskip 85.35826pt+\sum_{\tau=1}^{t-1}\|\widetilde{b}_{t}^{\ast}-b%
_{t}^{\ast}\|_{2}\|\Lambda_{t}^{-1}\|_{2}
\displaystyle\hskip 85.35826pt+\sum_{\tau=1}^{t-1}\|\widetilde{b}_{t}^{\ast}-b%
_{t}^{\ast}\|_{2}\|\Lambda_{t}^{-1}\|_{2}
\displaystyle\leq\Delta\sqrt{d}+T\Delta+T\Delta\sqrt{d}+T\Delta\sqrt{d}
\displaystyle\leq\Delta\sqrt{d}+T\Delta+T\Delta\sqrt{d}+T\Delta\sqrt{d}
\displaystyle\leq\mathcal{O}(T\sqrt{d}\Delta).
\displaystyle\leq\mathcal{O}(T\sqrt{d}\Delta).
\widetilde{w}_{t},\widetilde{b}_{t},\widetilde{J}_{t}
\|\Delta_{t}(\widetilde{w}_{t},\widetilde{b}_{t},\widetilde{J}_{t})\|_{2}\leq%
\|\Delta_{t}(\widetilde{w}_{t}^{\ast},\widetilde{b}_{t}^{\ast},\widetilde{J}_{%
t}^{\ast})\|_{2}\leq\mathcal{O}(T\sqrt{d}\Delta).
\sum_{t=1}^{T}\langle\bm{\varphi}(s_{t},a_{t}),\Delta_{t}(\widetilde{w}_{t},%
\widetilde{b}_{t},\widetilde{J}_{t})\rangle\leq T^{2}\sqrt{d}\Delta.
\Delta
\mathcal{O}(1/\sqrt{T^{3}})
\mathcal{O}(((1+\text{sp}(v^{\ast}))/\Delta)^{d}\times(T\beta/(\sqrt{d}\Delta)%
)^{d}\times(1/\Delta))=\widetilde{\mathcal{O}}((T(1+\text{sp}(v^{\ast}))^{2}%
\sqrt{d})^{d}(1/\Delta)^{2d+1})
\widetilde{\mathcal{O}}(T^{4d+3/2}(1+\text{sp}(v^{\ast}))^{2d}d^{d/2})
\mathcal{O}(d^{2}+T)
\widetilde{\mathcal{O}}(T^{4d+5/2}(1+\text{sp}(v^{\ast}))^{2d}d^{d/2+3})
d
\displaystyle\max_{w_{t}\in\mathbb{B}_{d}(R),J_{t}\in[0,1]}~{}~{}J_{t}
\displaystyle\max_{w_{t}\in\mathbb{B}_{d}(R),J_{t}\in[0,1]}~{}~{}
\displaystyle J_{t}
\displaystyle\text{subject to}\sum_{\tau=1}^{t-1}(\langle\bm{\varphi}(s_{\tau}%
,a_{\tau}),\bm{w}_{t}\rangle-r(s_{\tau},a_{\tau})-\max_{a}\langle\bm{\varphi}(%
s_{\tau+1},a),\bm{w}_{t}\rangle+J_{t})^{2}
\displaystyle\sum_{\tau=1}^{t-1}(\langle\bm{\varphi}(s_{\tau},a_{\tau}),\bm{w}%
_{t}\rangle-r(s_{\tau},a_{\tau})-\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),\bm%
{w}_{t}\rangle+J_{t})^{2}
\displaystyle\hskip 42.67912pt\min_{w^{\prime}\in\mathbb{B}_{d}(R),J^{\prime}%
\in[0,1]}\sum_{\tau=1}^{t-1}(\langle\bm{\varphi}(s_{\tau},a_{\tau}),\bm{w}_{t}%
\rangle-r(s_{\tau},a_{\tau})-\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),\bm{w}^%
{\prime}\rangle+J^{\prime})^{2}\leq\beta
\displaystyle\hskip 42.67912pt\min_{w^{\prime}\in\mathbb{B}_{d}(R),J^{\prime}%
\in[0,1]}\sum_{\tau=1}^{t-1}(\langle\bm{\varphi}(s_{\tau},a_{\tau}),\bm{w}_{t}%
\rangle-r(s_{\tau},a_{\tau})-\max_{a}\langle\bm{\varphi}(s_{\tau+1},a),\bm{w}^%
{\prime}\rangle+J^{\prime})^{2}\leq\beta
R=\frac{1}{2}\text{sp}(v^{\ast})\sqrt{d}
\beta=\widetilde{\mathcal{O}}(\text{sp}(v^{\ast})d)
\text{poly}(T^{d})
\bm{w}_{t}
J_{t}
\text{poly}(T,d,A)
\text{poly}(T^{d},d,A)
\Lambda_{t}=\sum_{i=1}^{t}\bm{\phi}_{i}\bm{\phi}_{i}^{T}+\lambda I
\bm{\phi}_{i}\in\mathbb{R}^{d}
\lambda>0
\sum_{i=1}^{t}\bm{\phi}_{i}^{T}\Lambda_{t}^{-1}\bm{\phi}_{i}\leq d.
\{\bm{\phi}_{t}\}_{t\geq 1}
\mathbb{R}^{d}
\|\bm{\phi}_{t}\|_{2}\leq 1
t\geq 1
\Lambda_{0}=I
\Lambda_{t}=\sum_{i=1}^{t}\bm{\phi}_{i}\bm{\phi}_{i}^{T}+I
t\geq 1
\sum_{i=1}^{t}\bm{\phi}_{i}^{T}\Lambda_{i-1}^{-1}\bm{\phi}_{i}\leq 2\log\det(%
\Lambda_{t})\leq 2d\log(1+t).
A,B\in\mathbb{R}^{d\times d}
A\succeq B
\bm{x}\in\mathbb{R}^{d}
\|\bm{x}\|_{A}\leq\|\bm{x}\|_{B}\sqrt{\frac{\det(A)}{\det(B)}}.
K
K\leq d\log_{2}\left(1+\frac{T}{\lambda d}\right).
\{\Lambda_{k}\}_{k=1}^{K}
\{\bar{\Lambda}_{t}\}_{t=0}^{T}
\text{tr}(\bar{\Lambda}_{T})=\text{tr}(\lambda I_{d})+\sum_{t=1}^{T}\text{tr}(%
\varphi(s_{t},a_{t})\varphi(s_{t},a_{t})^{T})=\lambda d+\sum_{t=1}^{T}\|%
\varphi(s_{t},a_{t})\|_{2}^{2}\leq\lambda d+T.
\det(\bar{\Lambda}_{T})\leq\left(\frac{\text{tr}(\bar{\Lambda}_{T})}{d}\right)%
^{d}\leq\left(\frac{\lambda d+T}{d}\right)^{d}.
\Lambda_{k}
\det(\bar{\Lambda}_{t})
\text{det}(\bar{\Lambda}_{T})\geq\text{det}(\Lambda_{K})\geq\text{det}(\Lambda%
_{1})\cdot 2^{K}=\lambda^{d}\cdot 2^{K}
K\leq d\log_{2}\left(1+\frac{T}{\lambda d}\right)
\widetilde{\mathcal{O}}(\cdot)
DS\sqrt{AT}
\text{sp}(v^{\ast})\sqrt{SAT}
\text{sp}(v^{\ast})S\sqrt{AT}
\sqrt{t_{\text{mix}}SAT}
\text{sp}(v^{\ast})S\sqrt{AT}
S\sqrt{DAT}
\sqrt{\text{sp}(v^{\ast})SAT}
\gamma
\text{sp}(v^{\ast})S\sqrt{AT}
\text{sp}(v^{\ast})(SA)^{\frac{1}{3}}T^{\frac{2}{3}}
\sqrt{t_{\text{mix}}^{3}\eta AT}
\text{sp}(v^{\ast})S^{5}A^{2}\sqrt{T}
\Omega(\sqrt{DSAT})
\mathcal{O}(DS\sqrt{AT})
D
\text{sp}(v^{\ast})
\mathcal{O}(\sqrt{\text{sp}(v^{\ast})SAT})
\mathcal{O}(T^{2/3})
\mathcal{O}(\sqrt{T})
\mathcal{O}(\sqrt{\text{sp}(v^{\ast})^{3}d^{3}T})
\widetilde{\mathcal{O}}(\text{sp}(v^{\ast})\sqrt{d^{3}T})
\mathcal{O}(T^{2/3})
\mathcal{O}(T^{2/3})
\mathcal{O}(T^{2/3})
