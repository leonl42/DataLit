\bullet
\bullet
\bullet
\bullet
p(y|\boldsymbol{x})
y
\boldsymbol{x}
p(\boldsymbol{x})
p(y|\boldsymbol{x})
p(\boldsymbol{x})
p(\boldsymbol{x})
\displaystyle\begin{split}\text{WAIC}&(X)=\mathbb{E}_{\alpha\sim p(\alpha)}%
\bigg{[}\mathbb{E}_{p(\boldsymbol{x})}[\log p(\boldsymbol{x}|\alpha)]\bigg{]}%
\\
&-\mathbb{V}_{\alpha\sim p(\alpha)}\bigg{[}\mathbb{E}_{p(\boldsymbol{x})}[\log
p%
(\boldsymbol{x}|\alpha)]\bigg{]}\end{split}
\displaystyle\begin{split}\text{WAIC}&(X)=\mathbb{E}_{\alpha\sim p(\alpha)}%
\bigg{[}\mathbb{E}_{p(\boldsymbol{x})}[\log p(\boldsymbol{x}|\alpha)]\bigg{]}%
\\
&-\mathbb{V}_{\alpha\sim p(\alpha)}\bigg{[}\mathbb{E}_{p(\boldsymbol{x})}[\log
p%
(\boldsymbol{x}|\alpha)]\bigg{]}\end{split}
\mathbb{E}[\cdot]
\mathbb{V}[\cdot]
\alpha
p(\alpha)
p(\alpha)
p(\alpha)
\alpha
1\times 1
3\times 3
3\times 3
3\times 3
5\times 5
3\times 3
5\times 5
\bullet
\bullet
\bullet
K
K
\mathcal{A}
\alpha\in\mathcal{A}
l_{\theta^{*}}(\alpha)
\alpha
\theta^{*}
\theta^{*}=\operatorname*{arg\,min}_{\theta}l{(\theta|\alpha)}
l(\cdot)
p_{\phi}(\alpha)
\phi
\alpha
L(\phi)=\mathbb{E}_{\alpha\sim p_{\phi}(\alpha)}[l_{\theta^{*}}(\alpha)]
L(\phi)=-\text{WAIC}(X)
M
p_{\phi}(\alpha)
\displaystyle\begin{split}\text{WAIC}&(X)\approx\sum_{i=1}^{N}\Bigg{[}\sum_{j=%
1}^{M}\log p(\boldsymbol{x}_{i}|\alpha_{j})-\\
&\bigg{(}\sum_{j=1}^{M}(\log p(\boldsymbol{x}_{i}|\alpha_{j}))^{2}-\Big{(}\sum%
_{j=1}^{M}\log p(\boldsymbol{x}_{i}|\alpha_{j})\Big{)}^{2}\bigg{)}\Bigg{]}\end%
{split}
\displaystyle\begin{split}\text{WAIC}&(X)\approx\sum_{i=1}^{N}\Bigg{[}\sum_{j=%
1}^{M}\log p(\boldsymbol{x}_{i}|\alpha_{j})-\\
&\bigg{(}\sum_{j=1}^{M}(\log p(\boldsymbol{x}_{i}|\alpha_{j}))^{2}-\Big{(}\sum%
_{j=1}^{M}\log p(\boldsymbol{x}_{i}|\alpha_{j})\Big{)}^{2}\bigg{)}\Bigg{]}\end%
{split}
p_{\phi}(\alpha)
\alpha
\boldsymbol{\phi}=[\phi_{1},\dots,\phi_{K}]
K
[o_{1},\dots,o_{K}]
\boldsymbol{b}=[b_{1},\dots,b_{K}]
\boldsymbol{\phi}
b_{i}
1
i^{th}
\boldsymbol{b}
\alpha
\boldsymbol{y}
\boldsymbol{x}
\boldsymbol{y}=\sum_{i=1}^{K}b_{i}\cdot o_{i}(\boldsymbol{x}).
\boldsymbol{b}
\tilde{\boldsymbol{b}}
\tilde{b}_{i}=\frac{\exp((\log(\phi_{i})+g_{i})/\tau)}{\sum_{j=1}^{k}\exp((%
\log(\phi_{i})+g_{i})/\tau)}\quad\text{for}\quad i=1,\dots,K.
g_{1}\dots g_{k}\sim-\log(-\log(u))
u\sim\text{Unif}(0,1)
\tau
\tau
\tilde{\boldsymbol{b}}
\tilde{\boldsymbol{b}}
K
\alpha
\tilde{\boldsymbol{b}}
\nabla_{\theta,\phi}\alpha=\nabla_{\theta,\phi}\boldsymbol{b}\approx\nabla_{%
\theta,\phi}\tilde{\boldsymbol{b}}
\tau
1\times 10^{-5}
M=4
\tau=1.5
64\times 64
\bullet
\bullet
\bullet
\displaystyle\begin{split}\mathbb{E}_{\alpha\sim p_{\phi}(\alpha)}[\log p(%
\boldsymbol{x})]&=\sum_{\alpha\in\mathcal{A}}p_{\phi}(\alpha)\log p(%
\boldsymbol{x}|\alpha)\\
&\approx\sum_{i=1}^{M}\frac{p_{\phi}(\alpha_{i})}{\sum_{j=1}^{M}p_{\phi}(%
\alpha_{j})}\log p(\boldsymbol{x}|\alpha_{i})\end{split}
\displaystyle\begin{split}\mathbb{E}_{\alpha\sim p_{\phi}(\alpha)}[\log p(%
\boldsymbol{x})]&=\sum_{\alpha\in\mathcal{A}}p_{\phi}(\alpha)\log p(%
\boldsymbol{x}|\alpha)\\
&\approx\sum_{i=1}^{M}\frac{p_{\phi}(\alpha_{i})}{\sum_{j=1}^{M}p_{\phi}(%
\alpha_{j})}\log p(\boldsymbol{x}|\alpha_{i})\end{split}
\displaystyle\begin{split}\mathbb{V}_{\alpha\sim p_{\phi}(\alpha)}&[\log p(%
\boldsymbol{x})]\approx\sum_{i=1}^{M}\frac{p_{\phi}(\alpha_{i})}{\sum_{j=1}^{M%
}p_{\phi}(\alpha_{j})}\Big{(}\mathbb{V}[\log p(\boldsymbol{x}|\alpha_{i})]\\
&+(\log p(\boldsymbol{x}|\alpha_{i}))^{2}\Big{)}-\mathbb{E}_{\alpha\sim p_{%
\phi}(\alpha)}[\log p(\boldsymbol{x})]^{2}\end{split}
\displaystyle\begin{split}\mathbb{V}_{\alpha\sim p_{\phi}(\alpha)}&[\log p(%
\boldsymbol{x})]\approx\sum_{i=1}^{M}\frac{p_{\phi}(\alpha_{i})}{\sum_{j=1}^{M%
}p_{\phi}(\alpha_{j})}\Big{(}\mathbb{V}[\log p(\boldsymbol{x}|\alpha_{i})]\\
&+(\log p(\boldsymbol{x}|\alpha_{i}))^{2}\Big{)}-\mathbb{E}_{\alpha\sim p_{%
\phi}(\alpha)}[\log p(\boldsymbol{x})]^{2}\end{split}
p_{\phi}(\alpha)
\mathbb{V}[\log p_{\alpha_{i}}(x)]
D_{in}
D_{out}
D_{in}
M=5
p_{\phi^{*}}(\alpha)
1\times 10^{-5}
D_{out}
D_{in}
D_{out}
D_{in}
D_{out}
