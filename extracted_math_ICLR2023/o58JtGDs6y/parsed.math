\{w\texttt{\#}{w}^{R}\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
\{w\texttt{\#}w\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
w=w_{1}\cdots w_{n}
\mathbf{x}_{1},\cdots,\mathbf{x}_{n}
\mathbf{h}_{t}
\mathbf{c}_{t}
\mathbf{h}_{0}=\mathbf{c}_{0}={\bm{0}}
(\mathbf{h}_{t},\mathbf{c}_{t})
\mathbf{x}_{t}
\mathbf{r}_{t-1}
(\mathbf{h}_{t},\mathbf{c}_{t})=\mathrm{LSTM}\left((\mathbf{h}_{t-1},\mathbf{c%
}_{t-1}),\begin{bmatrix}\mathbf{x}_{t}\\
\mathbf{r}_{t-1}\end{bmatrix}\right).
a_{t}
\mathbf{y}_{t}
w_{t+1}
s_{t}
\mathbf{r}_{t}
\displaystyle a_{t}=\textsc{Actions}(\mathbf{h}_{t})\mathbf{y}_{t}=\mathbf{W}_%
{\mathrm{hy}}\mathbf{h}_{t}+\mathbf{b}_{\mathrm{hy}}
\displaystyle a_{t}=\textsc{Actions}(\mathbf{h}_{t})
\displaystyle\mathbf{y}_{t}=\mathbf{W}_{\mathrm{hy}}\mathbf{h}_{t}+\mathbf{b}_%
{\mathrm{hy}}
\displaystyle s_{t}=\textsc{Stack}(s_{t-1},a_{t})\mathbf{r}_{t}=\textsc{%
Reading}(s_{t}).
\displaystyle s_{t}=\textsc{Stack}(s_{t-1},a_{t})
\displaystyle\mathbf{r}_{t}=\textsc{Reading}(s_{t}).
\cdots
\cdots
\mathbf{h}_{t-1}
\mathbf{x}_{t-1}
\mathbf{y}_{t-1}
s_{t-1}
\mathbf{h}_{t}
\mathbf{x}_{t}
\mathbf{y}_{t}
s_{t}
\mathbf{h}_{t+1}
\mathbf{x}_{t+1}
\mathbf{y}_{t+1}
\cdots
\cdots
\mathbf{r}_{t-2}
a_{t-1}
\mathbf{r}_{t-1}
a_{t}
\mathbf{r}_{t}
a_{t+1}
\mathbf{c}_{t}
\mathbf{c}_{t}
a_{t}=(\mathbf{a}_{t},\mathbf{v}_{t})
\mathbf{a}_{t}
\mathbf{v}_{t}
\mathbf{h}_{t}
Q
\Gamma
q_{0}\in Q
\bot\in\Gamma
t
\Delta[t]
\Delta[t]=\exp(\mathbf{W}_{\mathrm{a}}\mathbf{h}_{t}+\mathbf{b}_{\mathrm{a}})
q,r\in Q
u,v\in\Gamma^{\ast}
\Delta[t][q,u\rightarrow r,v]
t
u
v
r
q
u
x,y\in\Gamma
\Delta[t][q,x\rightarrow r,xy]
y
\Delta[t][q,x\rightarrow r,y]
x
y
\Delta[t][q,x\rightarrow r,\varepsilon]
x
(r,y)\in Q\times\Gamma
r
y
\tau_{i}
\pi=\tau_{1}\cdots\tau_{t}
\psi(\pi)=\prod_{i=1}^{t}\Delta[i][\tau_{i}]
\pi
\pi\leadsto t,r,y
\pi
t
r
y
\mathbf{r}_{t}\in\mathbb{R}^{|Q|\cdot|\Gamma|}
\mathbf{r}_{t}[(r,y)]=\frac{\sum_{\pi\leadsto t,r,y}\psi(\pi)}{\sum_{r^{\prime%
},y^{\prime}}\sum_{\pi\leadsto t,r^{\prime},y^{\prime}}\psi(\pi)}.
O(n^{3})
t
(i,q,x)
q
x
i
(i,q,x)
(t,r,y)
(i,q,x)
(t,r,y)
x
y
\gamma
\gamma[i\rightarrow t][q,x\rightarrow r,y]
1\leq t\leq n-1
-1\leq i\leq t-1
\displaystyle\gamma[-1\rightarrow 0][q,x\rightarrow r,y]=\mathbb{I}[q=q_{0}%
\wedge x=\bot\wedge r=q_{0}\wedge y=\bot]
\displaystyle\gamma[-1\rightarrow 0][q,x\rightarrow r,y]
\displaystyle=\mathbb{I}[q=q_{0}\wedge x=\bot\wedge r=q_{0}\wedge y=\bot]
\displaystyle\gamma[i\rightarrow t][q,x\rightarrow r,y]=\mathbb{I}[i=t\mathord%
{-}1]\;\Delta[t][q,x\rightarrow r,xy]
\displaystyle\gamma[i\rightarrow t][q,x\rightarrow r,y]
\displaystyle=\mathbb{I}[i=t\mathord{-}1]\;\Delta[t][q,x\rightarrow r,xy]
\displaystyle+\sum_{s,z}\gamma[i\rightarrow t\mathord{-}1][q,x\rightarrow s,z]%
\;\Delta[t][s,z\rightarrow r,y]
\displaystyle+\sum_{s,z}\gamma[i\rightarrow t\mathord{-}1][q,x\rightarrow s,z]%
\;\Delta[t][s,z\rightarrow r,y]
\displaystyle+\sum_{k=i+1}^{t-2}\sum_{u}\gamma[i\rightarrow k][q,x\rightarrow u%
,y]\;\gamma^{\prime}[k\rightarrow t][u,y\rightarrow r]
\displaystyle+\sum_{k=i+1}^{t-2}\sum_{u}\gamma[i\rightarrow k][q,x\rightarrow u%
,y]\;\gamma^{\prime}[k\rightarrow t][u,y\rightarrow r]
\displaystyle\gamma^{\prime}[k\rightarrow t][u,y\rightarrow r]=\sum_{s,z}%
\gamma[k\rightarrow t\mathord{-}1][u,y\rightarrow s,z]\;\Delta[t][s,z%
\rightarrow r,\varepsilon]\quad\mathrlap{(0\leq k\leq t-2).}
\displaystyle\gamma^{\prime}[k\rightarrow t][u,y\rightarrow r]
\displaystyle=\sum_{s,z}\gamma[k\rightarrow t\mathord{-}1][u,y\rightarrow s,z]%
\;\Delta[t][s,z\rightarrow r,\varepsilon]\quad\mathrlap{(0\leq k\leq t-2).}
\alpha
\alpha[t][r,y]
(t,r,y)
t
\displaystyle\alpha[-1][r,y]=\mathbb{I}[r=q_{0}\wedge y=\bot]
\displaystyle\alpha[-1][r,y]
\displaystyle=\mathbb{I}[r=q_{0}\wedge y=\bot]
\displaystyle\alpha[t][r,y]=\sum_{i=-1}^{t-1}\sum_{q,x}\alpha[i][q,x]\,\gamma[%
i\rightarrow t][q,x\rightarrow r,y]\quad(0\leq t\leq n-1)
\displaystyle\alpha[t][r,y]
\displaystyle=\sum_{i=-1}^{t-1}\sum_{q,x}\alpha[i][q,x]\,\gamma[i\rightarrow t%
][q,x\rightarrow r,y]\quad(0\leq t\leq n-1)
\displaystyle\mathbf{r}_{t}[(r,y)]=\frac{\alpha[t][r,y]}{\sum_{r^{\prime},y^{%
\prime}}\alpha[t][r^{\prime},y^{\prime}]}.
\displaystyle\mathbf{r}_{t}[(r,y)]
\displaystyle=\frac{\alpha[t][r,y]}{\sum_{r^{\prime},y^{\prime}}\alpha[t][r^{%
\prime},y^{\prime}]}.
\gamma
\alpha
|Q|
\bot
\pm\infty
N
\mathbf{h}_{t}\in\mathbb{R}^{d}
N
t
\sigma
N
L
y=\sigma(\mathbf{W}_{\mathrm{2}}\,\sigma(\mathbf{W}_{\mathrm{1}}\mathbf{h}_{|w%
|+1}+\mathbf{b}_{\mathrm{1}})+\mathbf{b}_{\mathrm{2}})
w\cdot\texttt{EOS}
y>\tfrac{1}{2}
w\in L
L
L
L
P
P
y>\frac{1}{2}
L_{1},\ldots,L_{k}
\Sigma
L_{1}\cap\cdots\cap L_{k}
k=2
P_{1}
P_{2}
L_{1}
L_{2}
P
P_{1}
P_{2}
P_{1}
P_{2}
y>\frac{1}{2}
P_{1}
P_{2}
k
(k-1)
\bm{w\texttt{\#}{w}^{R}\texttt{\#}w{}}
\bm{w\texttt{\#}{w}^{R}\texttt{\#}w{}}
\{w\texttt{\#}{w}^{R}\texttt{\#}w\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
\bm{w\texttt{\#}w{}}
\bm{w\texttt{\#}w{}}
\{w\texttt{\#}w\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
\bm{ww^{\prime}{}}
\bm{ww^{\prime}{}}
\{ww^{\prime}\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\text{ and }w^{\prime}=%
\phi(w)\}
\phi
\phi(\texttt{0})=\texttt{2}
\phi(\texttt{1})=\texttt{3}
\bm{ww{}}
\bm{ww{}}
\{ww\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
w\cdots w
w
ww^{\prime}
w
w\texttt{\#}w
L
L_{\ell}
L
\ell
w\in L
\ell
[40,80]
L_{\ell}
L_{\ell}
w
p_{L}(w)=\frac{1}{\big{|}\{\ell\in[40,80]\mid L_{\ell}\not=\emptyset\}\big{|}}%
\frac{1}{|L_{|w|}|}.
M
p_{M}(w)
p
S
H(S,p)=\frac{-\sum_{w\in S}\log p(w)}{\sum_{w\in S}(|w|+1)}.
+1
|L_{|w|}|
|w|
M
H(S,p_{M})-H(S,p_{L})
|Q|=3
|\Gamma|=3
|Q|=3
p_{L}
L_{\ell}
\ell
w\texttt{\#}{w}^{R}\texttt{\#}w
w
w\texttt{\#}{w}^{R}\texttt{\#}w
w\texttt{\#}w
w\texttt{\#}w
ww^{\prime}
ww
w\texttt{\#}{w}^{R}\texttt{\#}w
w\texttt{\#}{w}^{R}\texttt{\#}w
w\texttt{\#}w
w\texttt{\#}w
ww^{\prime}
ww^{\prime}
ww
ww
w\texttt{\#}{w}^{R}\texttt{\#}w
w\texttt{\#}w
ww^{\prime}
w\texttt{\#}{w}^{R}\texttt{\#}w
w\texttt{\#}w
ww^{\prime}
\{w\texttt{\#}{w}^{R}\mid w\in\Sigma^{\ast}\}
|\Gamma|=3
|\Sigma|=2
|\Sigma|>2
w
w
|\Gamma|
|\Gamma|
\Gamma
m
m
\Gamma\times\mathbb{R}^{m}
(\bot,\mathbf{v}_{0})
\mathbf{v}_{0}=\sigma(\mathbf{w}_{\mathrm{v}})
\mathbf{w}_{\mathrm{v}}
q,x\rightarrow r,y
q,x\rightarrow r,y
q
(x,\mathbf{u})
r
(y,\mathbf{v}_{t})
\Delta[t][q,x\rightarrow r,xy]
\mathbf{v}_{t}=\sigma(\mathbf{W}_{\mathrm{v}}\mathbf{h}_{t}+\mathbf{b}_{%
\mathrm{v}})
q,x\rightarrow r,y
q,x\rightarrow r,y
q
(x,\mathbf{u})
r
(x,\mathbf{u})
(y,\mathbf{u})
\Delta[t][q,x\rightarrow r,y]
\mathbf{u}
\mathbf{v}_{t}
x=y
q,x\rightarrow r
q,x\rightarrow r
q
(x,\mathbf{u})
r
(x,\mathbf{u})
\Delta[t][q,x\rightarrow r,\varepsilon]
\mathbf{v}(\pi)
\pi
\mathbf{r}_{t}\in\mathbb{R}^{|Q|\cdot|\Gamma|\cdot m}
(r,y)\in Q\times\Gamma
\mathbf{v}(\pi)
\pi\leadsto t,r,y
\mathbf{r}_{t}[(r,y,j)]=\frac{\sum_{\pi\leadsto t,r,y}\psi(\pi)\;\mathbf{v}(%
\pi)[j]}{\sum_{r^{\prime},y^{\prime}}\sum_{\pi\leadsto t,r^{\prime},y^{\prime}%
}\psi(\pi)}
\gamma
\alpha
\bm{\zeta}
\psi(\pi)\;\mathbf{v}(\pi)
1\leq t\leq n-1
-1\leq i\leq t-1
\displaystyle\bm{\zeta}[-1\rightarrow 0][q,x\rightarrow r,y]=\mathbb{I}[q=q_{0%
}\wedge x=\bot\wedge r=q_{0}\wedge y=\bot]\;\mathbf{v}_{0}
\displaystyle\bm{\zeta}[-1\rightarrow 0][q,x\rightarrow r,y]
\displaystyle=\mathbb{I}[q=q_{0}\wedge x=\bot\wedge r=q_{0}\wedge y=\bot]\;%
\mathbf{v}_{0}
\bm{\zeta}[-1\rightarrow 0][q,x\rightarrow r,y]=\mathbf{v}_{0}
(r,y)\in Q\times\Gamma
(q_{0},\bot)
\bm{\zeta}[-1\rightarrow 0][q,x\rightarrow r,y]=\mathbf{v}_{0}
(r,y)\in Q\times\Gamma
(q_{0},\bot)
\displaystyle\bm{\zeta}[i\rightarrow t][q,x\rightarrow r,y]=\mathbb{I}[i=t%
\mathord{-}1]\;\Delta[t][q,x\rightarrow r,xy]\;\mathbf{v}_{t}
\displaystyle\bm{\zeta}[i\rightarrow t][q,x\rightarrow r,y]
\displaystyle=\mathbb{I}[i=t\mathord{-}1]\;\Delta[t][q,x\rightarrow r,xy]\;%
\mathbf{v}_{t}
\displaystyle+\sum_{s,z}\bm{\zeta}[i\rightarrow t\mathord{-}1][q,x\rightarrow s%
,z]\;\Delta[t][s,z\rightarrow r,y]
\displaystyle+\sum_{s,z}\bm{\zeta}[i\rightarrow t\mathord{-}1][q,x\rightarrow s%
,z]\;\Delta[t][s,z\rightarrow r,y]
\displaystyle+\sum_{k=i+1}^{t-2}\sum_{u}\bm{\zeta}[i\rightarrow k][q,x%
\rightarrow u,y]\;\gamma^{\prime}[k\rightarrow t][u,y\rightarrow r].
\displaystyle+\sum_{k=i+1}^{t-2}\sum_{u}\bm{\zeta}[i\rightarrow k][q,x%
\rightarrow u,y]\;\gamma^{\prime}[k\rightarrow t][u,y\rightarrow r].
\alpha
\mathbf{r}_{t}
\displaystyle\mathbf{r}_{t}[(r,y,j)]=\frac{\bm{\eta}_{t}[r,y][j]}{\sum_{r^{%
\prime},y^{\prime}}\alpha[t][r^{\prime},y^{\prime}]}\bm{\eta}_{t}[r,y]=\sum_{i%
=-1}^{t-1}\sum_{q,x}\alpha[i][q,x]\,\bm{\zeta}[i\rightarrow t][q,x\rightarrow r%
,y]
\displaystyle\mathbf{r}_{t}[(r,y,j)]=\frac{\bm{\eta}_{t}[r,y][j]}{\sum_{r^{%
\prime},y^{\prime}}\alpha[t][r^{\prime},y^{\prime}]}
\displaystyle\bm{\eta}_{t}[r,y]=\sum_{i=-1}^{t-1}\sum_{q,x}\alpha[i][q,x]\,\bm%
{\zeta}[i\rightarrow t][q,x\rightarrow r,y]
L
k
p_{L}(w)
k
\bm{w\texttt{\#}{w}^{R}{}}
\bm{w\texttt{\#}{w}^{R}{}}
\{w\texttt{\#}{w}^{R}\mid w\in\{\texttt{0},\texttt{1},\cdots,k-1\}^{\ast}\}
\{\texttt{(}_{1},\texttt{)}_{1},\texttt{(}_{2},\texttt{)}_{2},\cdots,\texttt{(%
}_{k},\texttt{)}_{k}\}
\texttt{(}_{i}
\texttt{)}_{i}
|Q|
|\Gamma|
|Q|
|\Gamma|
m
k
w\texttt{\#}{w}^{R}
\displaystyle k
\displaystyle k
w\texttt{\#}{w}^{R}
w\texttt{\#}{w}^{R}
w\texttt{\#}{w}^{R}
w\texttt{\#}{w}^{R}
w\texttt{\#}{w}^{R}
k
w\texttt{\#}{w}^{R}
k
\mathbf{r}_{t}
Q\times\Gamma
\mathbf{r}_{t}
\mathbb{R}^{|Q|\cdot|\Gamma|}
w\texttt{\#}{w}^{R}
k=40
p_{L}
|Q|=3
|\Gamma|=3
|Q|=4
|\Gamma|=5
\downarrow
\downarrow
|\mathbf{v}_{t}|=22
\gamma
\alpha
0\leq i<t\leq n-1
\begin{split}&\gamma[i\rightarrow t][q,x\rightarrow r,y]=\\
&\qquad\begin{aligned} &\mathbb{I}[i=t\mathord{-}1]\;\Delta[t][q,x\rightarrow r%
,xy]&&\text{push}\\
&+\sum_{s,z}\gamma[i\rightarrow t\mathord{-}1][q,x\rightarrow s,z]\;\Delta[t][%
s,z\rightarrow r,y]&&\text{repl.}\\
&+\sum_{k=i+1}^{t-2}\sum_{u}\sum_{s,z}\gamma[i\rightarrow k][q,x\rightarrow u,%
y]\;\gamma[k\rightarrow t\mathord{-}1][u,y\rightarrow s,z]\;\Delta[t][s,z%
\rightarrow r,\varepsilon]&&\text{pop}\end{aligned}\end{split}
\displaystyle\alpha[0][r,y]=\mathbb{I}[r=q_{0}\wedge y=\bot]
\displaystyle\alpha[0][r,y]
\displaystyle=\mathbb{I}[r=q_{0}\wedge y=\bot]
\displaystyle\alpha[t][r,y]=\sum_{i=0}^{t-1}\sum_{q,x}\alpha[i][q,x]\,\gamma[i%
\rightarrow t][q,x\rightarrow r,y]\qquad(1\leq t\leq n).
\displaystyle\alpha[t][r,y]
\displaystyle=\sum_{i=0}^{t-1}\sum_{q,x}\alpha[i][q,x]\,\gamma[i\rightarrow t]%
[q,x\rightarrow r,y]\qquad(1\leq t\leq n).
\mathbf{r}_{t-1}
\mathbf{h}_{t}
\mathbf{y}_{t}
t=n
\Delta[t]
1\leq t\leq n-1
\gamma
\alpha
t\leq n-1
O({|Q|}^{4}{|\Gamma|}^{3}n^{3})
O({|Q|}^{2}{|\Gamma|}^{2}n^{2})
Q
\Gamma
|Q|
\gamma[k\rightarrow t\mathord{-}1][u,y\rightarrow s,z]\;\Delta[t][s,z%
\rightarrow r,\varepsilon]
\gamma^{\prime}
O({|Q|}^{3}{|\Gamma|}^{3}n^{2}+{|Q|}^{3}{|\Gamma|}^{2}n^{3})
\bot
\bot
\bot
\bot
\bot
\bot
t=-1
\pm\infty
(Q,\Sigma,\Gamma,\delta,q_{0},F,\bot)
Q
\Sigma
\Gamma
\delta\subseteq Q\times\Gamma\times(\Sigma\cup\varepsilon)\times Q\times\Gamma%
^{*}
q_{0}\in Q
F\subseteq Q
\bot\in\Gamma
q_{0}
\bot
\bot
q,r\in Q
a\in\Sigma
x,y\in\Gamma
\displaystyle q,x\xrightarrow{a}r,xy\text{push $y$ on top of $x$}
y
x
\displaystyle q,x\xrightarrow{a}r,xy
y
x
\displaystyle q,x\xrightarrow{a}r,y\text{replace $x$ with $y$}
x
y
\displaystyle q,x\xrightarrow{a}r,y
x
y
\displaystyle q,x\xrightarrow{a}r,\varepsilon\text{pop $x$.}
x
\displaystyle q,x\xrightarrow{a}r,\varepsilon
x
q,x\xrightarrow{a}r,zy
x\not=z
G
G
S
\displaystyle S\rightarrow\varepsilon
\displaystyle S
\displaystyle\rightarrow\varepsilon
\displaystyle A\rightarrow a
\displaystyle A
\displaystyle\rightarrow a
\displaystyle A\rightarrow abB_{1}\cdots B_{p}
\displaystyle A
\displaystyle\rightarrow abB_{1}\cdots B_{p}
\displaystyle p\geq 0.
\displaystyle p\geq 0.
G
A\rightarrow aA_{1}\cdots A_{m}
A_{1}\rightarrow bB_{1}\cdots B_{\ell}
A\rightarrow abB_{1}\cdots B_{\ell}A_{2}\cdots A_{m}
G
G
\displaystyle q,x\xrightarrow{a}r,xy_{1}\cdots y_{k}
\displaystyle q,x\xrightarrow{a}r,xy_{1}\cdots y_{k}
\displaystyle q,x\xrightarrow{a}r,y
\displaystyle q,x\xrightarrow{a}r,y
\displaystyle q,x\xrightarrow{a}r,\varepsilon.
\displaystyle q,x\xrightarrow{a}r,\varepsilon.
\displaystyle S\rightarrow\varepsilon
\displaystyle S
\displaystyle\rightarrow\varepsilon
\displaystyle A\rightarrow a
\displaystyle A
\displaystyle\rightarrow a
\displaystyle A\rightarrow ab
\displaystyle A
\displaystyle\rightarrow ab
\displaystyle A\rightarrow abB_{1}\cdots B_{p}\qquad p\geq 1.
\displaystyle A
\displaystyle\rightarrow abB_{1}\cdots B_{p}\qquad p\geq 1.
q_{0}
q_{\mathrm{loop}}
S
q_{\mathrm{loop}}
q_{0},\bot\xrightarrow{\varepsilon}q_{\mathrm{loop}},\bot S
G
S\rightarrow\varepsilon
q_{0}
G
A\rightarrow a
q_{\mathrm{loop}},A\xrightarrow{a}q_{\mathrm{loop}},\varepsilon
G
A\rightarrow ab
q
q_{\mathrm{loop}},A\xrightarrow{a}q,A
q,A\xrightarrow{b}q_{\text{loop}},\varepsilon
A
G
A\rightarrow abB_{1}\cdots B_{p}
p\geq 1
q
q_{\mathrm{loop}},A\xrightarrow{a}q,B_{p}
q,B_{p}\xrightarrow{b}q_{\mathrm{loop}},B_{p}B_{p-1}\cdots B_{1}
A
B_{p}B_{p-1}\cdots B_{1}
q,x\xrightarrow{a}r,xy_{1}\cdots y_{k}
q_{0},\bot\xrightarrow{\varepsilon}q_{\mathrm{loop}},\bot S
q_{\mathrm{loop}},S\xrightarrow{a}r,\alpha
q_{0},\bot\xrightarrow{a}r,\bot\alpha
P
P
k
q,x\xrightarrow{a}r,x\alpha
k=|\alpha|
\Gamma^{\prime}=\Gamma\cup\Gamma^{2}\cdots\cup\Gamma^{k}
\alpha
\alpha
q,x\xrightarrow{a}r,x\beta
q,{\framebox{\kern 1.0pt$\alpha x$\kern 1.0pt}}\xrightarrow{a}r,{\framebox{%
\kern 1.0pt$\alpha x$\kern 1.0pt}}\,{\framebox{\kern 1.0pt$\beta$\kern 1.0pt}}
\alpha\in\bigcup_{i=0}^{k-1}\Gamma^{i}
q,x\xrightarrow{a}r,y
q,{\framebox{\kern 1.0pt$\alpha x$\kern 1.0pt}}\xrightarrow{a}r,{\framebox{%
\kern 1.0pt$\alpha y$\kern 1.0pt}}
\alpha
q,x\xrightarrow{a}r,\varepsilon
q,{\framebox{\kern 1.0pt$\alpha x$\kern 1.0pt}}\xrightarrow{a}r,{\framebox{%
\kern 1.0pt$\alpha$\kern 1.0pt}}
\alpha
|\alpha|\geq 1
q,{\framebox{\kern 1.0pt$x$\kern 1.0pt}}\xrightarrow{a}r,\varepsilon
L
P
L
\pm\infty
P
L
L
P=(Q,\Sigma,\Gamma,\delta,q_{0},F,\bot)
\textit{ct}(w)
P
w
\bot
\textit{ct}(w)>0
P
q_{\mathrm{trap}}
q_{0},\bot\xrightarrow{a}q_{\mathrm{trap}},\bot
q_{\mathrm{trap}},\bot\xrightarrow{a}q_{\mathrm{trap}},\bot
a\in\Sigma
X\subseteq Q
\textit{ct}(w,X)
P
w
X
\bot
w
w\in L
\textit{ct}(w,F)\geq 1
\textit{ct}(w,F)=0
\mathbf{i}_{t}
\mathbf{f}_{t}
\mathbf{o}_{t}
\mathbf{g}_{t}
\displaystyle\mathbf{i}_{t}=\sigma(\mathbf{W}_{\mathrm{i}}\begin{bmatrix}%
\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{i}})
\displaystyle\mathbf{i}_{t}
\displaystyle=\sigma(\mathbf{W}_{\mathrm{i}}\begin{bmatrix}\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{i}})
\displaystyle\mathbf{f}_{t}=\sigma(\mathbf{W}_{\mathrm{f}}\begin{bmatrix}%
\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{f}})
\displaystyle\mathbf{f}_{t}
\displaystyle=\sigma(\mathbf{W}_{\mathrm{f}}\begin{bmatrix}\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{f}})
\displaystyle\mathbf{g}_{t}=\tanh(\mathbf{W}_{\mathrm{g}}\begin{bmatrix}%
\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{g}})
\displaystyle\mathbf{g}_{t}
\displaystyle=\tanh(\mathbf{W}_{\mathrm{g}}\begin{bmatrix}\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{g}})
\displaystyle\mathbf{o}_{t}=\sigma(\mathbf{W}_{\mathrm{o}}\begin{bmatrix}%
\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{o}})
\displaystyle\mathbf{o}_{t}
\displaystyle=\sigma(\mathbf{W}_{\mathrm{o}}\begin{bmatrix}\mathbf{x}_{t}\\
\mathbf{h}_{t-1}\end{bmatrix}+\mathbf{b}_{\mathrm{o}})
\displaystyle\mathbf{c}_{t}=\mathbf{f}_{t}\odot\mathbf{c}_{t-1}+\mathbf{i}_{t}%
\odot\mathbf{g}_{t}
\displaystyle\mathbf{c}_{t}
\displaystyle=\mathbf{f}_{t}\odot\mathbf{c}_{t-1}+\mathbf{i}_{t}\odot\mathbf{g%
}_{t}
\displaystyle\mathbf{h}_{t}=\mathbf{o}_{t}\odot\tanh(\mathbf{c}_{t})
\displaystyle\mathbf{h}_{t}
\displaystyle=\mathbf{o}_{t}\odot\tanh(\mathbf{c}_{t})
t
\mathbf{x}_{t}
P
w_{t}
\Delta[t]
-\infty
n=|w|
w
\mathbf{r}_{n}
P
w
\mathbf{h}_{n+1}
y
p=\sum_{f\in F}\mathbf{r}_{n}[(f,\bot)]=\frac{\textit{ct}(w,F)}{\textit{ct}(w)}.
p
w\in L
\mathbf{h}_{n}
\mathbf{x}_{n+1}
\mathbf{r}_{n}
\mathbf{g}_{n+1}
n+1
g^{\mathrm{accept}}_{n+1}
\mathbf{g}_{n+1}
f\in F
\mathbf{r}_{n}[(f,\bot)]
g^{\mathrm{accept}}_{n+1}=\tanh(p)
c^{\mathrm{accept}}_{n+1}=\tanh(p)
h^{\mathrm{accept}}_{n+1}=\tanh(\tanh(p))
w\in L
y
y_{1}
h^{\mathrm{accept}}_{n+1}
y_{1}=\sigma(\tanh(\tanh(p)))
\frac{1}{2}
w\in L
\frac{1}{2}
y_{1}
y
-\frac{1}{2}
y=\sigma(\sigma(\tanh(\tanh(p)))-\frac{1}{2})
\frac{1}{2}
w\in L
\frac{1}{2}
k=2
P_{1}=(Q_{1},\Sigma,\Gamma_{1},\delta_{1},s_{1},F_{1},\bot)
P_{2}=(Q_{2},\Sigma,\Gamma_{2},\delta_{2},s_{2},F_{2},\bot)
L_{1}
L_{2}
Q_{1}\cap Q_{2}=\emptyset
s_{1}
s_{2}
\displaystyle P=(Q,\Sigma,\Gamma_{1}\cup\Gamma_{2},\delta,s,F)
\displaystyle P
\displaystyle=(Q,\Sigma,\Gamma_{1}\cup\Gamma_{2},\delta,s,F)
\displaystyle Q=(Q_{1}\setminus\{s_{1}\})\cup(Q_{2}\setminus\{s_{2}\})\cup\{s\}
\displaystyle Q
\displaystyle=(Q_{1}\setminus\{s_{1}\})\cup(Q_{2}\setminus\{s_{2}\})\cup\{s\}
\displaystyle\delta(q,x,a)=\begin{cases}\delta_{1}(q,x,a)&q\in Q_{1}\setminus%
\{s_{1}\}\\
\delta_{2}(q,x,a)&q\in Q_{2}\setminus\{s_{2}\}\\
\delta_{1}(s_{1},x,a)\cup\delta_{2}(s_{2},x,a)&q=s\end{cases}
\displaystyle\delta(q,x,a)
\displaystyle=\begin{cases}\delta_{1}(q,x,a)&q\in Q_{1}\setminus\{s_{1}\}\\
\delta_{2}(q,x,a)&q\in Q_{2}\setminus\{s_{2}\}\\
\delta_{1}(s_{1},x,a)\cup\delta_{2}(s_{2},x,a)&q=s\end{cases}
\displaystyle F=\begin{cases}(F_{1}\setminus\{s_{1}\})\cup(F_{2}\setminus\{s_{%
2}\})\cup\{s\}&s_{1}\in F_{1}\wedge s_{2}\in F_{2}\\
(F_{1}\setminus\{s_{1}\})\cup(F_{2}\setminus\{s_{2}\})&\text{otherwise.}\end{cases}
\displaystyle F
\displaystyle=\begin{cases}(F_{1}\setminus\{s_{1}\})\cup(F_{2}\setminus\{s_{2}%
\})\cup\{s\}&s_{1}\in F_{1}\wedge s_{2}\in F_{2}\\
(F_{1}\setminus\{s_{1}\})\cup(F_{2}\setminus\{s_{2}\})&\text{otherwise.}\end{cases}
\Delta[t]
\delta
\textit{ct}(w)>0
\displaystyle p_{1}=\sum_{f\in F_{1}}\mathbf{r}_{n}[(f,\bot)]=\frac{\textit{ct%
}(w,F_{1})}{\textit{ct}(w)}
\displaystyle p_{1}
\displaystyle=\sum_{f\in F_{1}}\mathbf{r}_{n}[(f,\bot)]=\frac{\textit{ct}(w,F_%
{1})}{\textit{ct}(w)}
\displaystyle p_{2}=\sum_{f\in F_{2}}\mathbf{r}_{n}[(f,\bot)]=\frac{\textit{ct%
}(w,F_{2})}{\textit{ct}(w)}.
\displaystyle p_{2}
\displaystyle=\sum_{f\in F_{2}}\mathbf{r}_{n}[(f,\bot)]=\frac{\textit{ct}(w,F_%
{2})}{\textit{ct}(w)}.
n=|w|
p_{i}
g^{\mathrm{accept}}_{i,n+1}
\mathbf{g}_{n+1}
p_{1}>0
p_{1}=0
g^{\mathrm{accept}}_{i,n+1}\not=0
p_{i}
p_{i}
b=|Q|(2|\Gamma|+1)
P
c^{\mathrm{offset}}_{t}
\mathbf{c}_{t}
c^{\mathrm{offset}}_{t}
\frac{1}{b}
\frac{1}{b}
t
c^{\mathrm{offset}}_{t}=\frac{1}{b^{t}}
h^{\mathrm{offset}}_{n}
\mathbf{h}_{n}
\tanh(\frac{1}{b^{n}})
p_{i}
\frac{1}{\textit{ct}(w)}
\textit{ct}(w)\leq b^{n}
\tanh(x)<x
x>0
h^{\mathrm{offset}}_{n}
g^{\mathrm{accept}}_{i,n+1}
f\in F_{i}
\mathbf{r}_{n}[(f,\bot)]
h^{\mathrm{offset}}_{n}
-1
g^{\mathrm{accept}}_{i,n+1}=\tanh(p_{i}-h^{\mathrm{offset}}_{n}
p_{i}>0
c^{\mathrm{accept}}_{i,n+1}=g^{\mathrm{accept}}_{i,n+1}
h^{\mathrm{accept}}_{i,n+1}=\tanh(g^{\mathrm{accept}}_{i,n+1})
p_{i}>0
h^{\mathrm{accept}}_{i,n+1}
y_{i}
h^{\mathrm{accept}}_{i,n+1}
\infty
y_{i}=\sigma(\infty\cdot h^{\mathrm{accept}}_{i,n+1})
p_{i}>0
y
y_{i}
-\frac{3}{2}
y=\sigma(y_{1}+y_{2}-\frac{3}{2})
\frac{1}{2}
p_{1}>0
p_{2}>0
w\in L_{1}\cap L_{2}
\frac{1}{2}
\bm{\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}{}}
\bm{\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}{}}
\{\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}\mid n\geq 0\}
\bm{w\texttt{\#}{w}^{R}\texttt{\#}w{}}
\bm{w\texttt{\#}{w}^{R}\texttt{\#}w{}}
\{w\texttt{\#}{w}^{R}\texttt{\#}w\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
w
{w}^{R}
{w}^{R}
w
\bm{w\texttt{\#}^{n}w{}}
\bm{w\texttt{\#}^{n}w{}}
\{w\texttt{\#}^{n}w\mid\text{$w\in\{\texttt{0},\texttt{1}\}^{\ast}$, $n\geq 0$%
, and $|w|=n$}\}
w\in\{\texttt{0},\texttt{1}\}^{\ast}
n\geq 0
|w|=n
w
\texttt{\#}^{n}
w
w\texttt{\#}{w}^{R}\texttt{\#}w
\texttt{\#}^{n}
w
\bm{w\texttt{\#}w{}}
\bm{w\texttt{\#}w{}}
\{w\texttt{\#}w\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
w=uv
|u|=|v|
|w|
u
v
u
v
\bm{ww^{\prime}{}}
\bm{ww^{\prime}{}}
\{ww^{\prime}\mid\text{$w\in\{\texttt{0},\texttt{1}\}^{\ast}$ and $w^{\prime}=%
\phi(w)$}\}
w\in\{\texttt{0},\texttt{1}\}^{\ast}
w^{\prime}=\phi(w)
\phi
\phi(\texttt{0})=\texttt{2}
\phi(\texttt{1})=\texttt{3}
w\texttt{\#}w
\bm{w{w}^{R}w{}}
\bm{w{w}^{R}w{}}
\{w{w}^{R}w\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
w\texttt{\#}{w}^{R}\texttt{\#}w
|w|
\bm{ww{}}
\bm{ww{}}
\{ww\mid w\in\{\texttt{0},\texttt{1}\}^{\ast}\}
w\texttt{\#}w
|w|
[5\times{10}^{-4},1\times{10}^{-2}]
[-0.1,0.1]
(0,1)
\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}
w\texttt{\#}{w}^{R}\texttt{\#}w
w\texttt{\#}^{n}w
w{w}^{R}w
ww
w{w}^{R}w
\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}
w\texttt{\#}^{n}w
w\texttt{\#}^{n}w
ww
w{w}^{R}w
\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}
w\texttt{\#}^{n}w
w\texttt{\#}^{n}w
ww
w{w}^{R}w
\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}
\texttt{a}^{n}\texttt{b}^{n}\texttt{c}^{n}
w\texttt{\#}^{n}w
w\texttt{\#}^{n}w
w{w}^{R}w
w{w}^{R}w
w{w}^{R}
\bm{w\texttt{\#}{w}^{R}{}}
\bm{w\texttt{\#}{w}^{R}{}}
\{w\texttt{\#}{w}^{R}\mid w\in\{\texttt{0},\texttt{1},\cdots,k-1\}^{\ast}\}
\{\texttt{(}_{1},\texttt{)}_{1},\texttt{(}_{2},\texttt{)}_{2},\cdots,\texttt{(%
}_{k},\texttt{)}_{k}\}
\texttt{(}_{i}
\texttt{)}_{i}
\bm{w{w}^{R}{}}
\bm{w{w}^{R}{}}
\{w{w}^{R}\mid w\in\{\texttt{0},\texttt{1},\cdots,k-1\}^{\ast}\}
|w|
w{w}^{R}
w{w}^{R}
|w|
\Gamma
k
k\geq 40
w\texttt{\#}{w}^{R}
w{w}^{R}
\displaystyle k
w{w}^{R}
w{w}^{R}
w\texttt{\#}{w}^{R}
w{w}^{R}
\displaystyle k
w\texttt{\#}{w}^{R}
w{w}^{R}
k=40
w\texttt{\#}{w}^{R}
w{w}^{R}
k=40
w\texttt{\#}{w}^{R}
k=40
\displaystyle(q_{0},\bot)
\displaystyle(q_{0},\texttt{0})
\displaystyle(q_{0},\texttt{1})
\displaystyle(q_{1},\bot)
\displaystyle(q_{1},\texttt{0})
\displaystyle(q_{1},\texttt{1})
\displaystyle(q_{0},\bot)
\displaystyle(q_{0},\texttt{0})
\displaystyle(q_{0},\texttt{1})
\displaystyle(q_{1},\bot)
\displaystyle(q_{1},\texttt{0})
\displaystyle(q_{1},\texttt{1})
\mathbf{r}_{t}
w\texttt{\#}{w}^{R}
k=40
w
\mathbf{r}_{t}
w\texttt{\#}{w}^{R}
k=40
w
\gamma
t-i\leq D
D
\gamma
\bm{\zeta}
\bm{\zeta}
t-i\leq D
D=35
[1,100]
[0.0112,1.12]
[-0.05,0.05]
