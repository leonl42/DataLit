2
3
4
5
6
7
\boldsymbol{x}=\{x_{0},x_{1},...,x_{T_{1}-1}\}
\boldsymbol{y}=\{y_{0},y_{1},...,y_{T_{2}-1}\}
\boldsymbol{x}
\boldsymbol{h}=\{h_{0},h_{1},...,h_{T_{1}-1}\}
f
\boldsymbol{h}=f(\boldsymbol{x})
\boldsymbol{y}
\boldsymbol{h}
\boldsymbol{c}
c_{j}=\sum_{i=0}^{T_{1}-1}\alpha_{i,j}*h_{i},
\boldsymbol{\alpha}=\{\alpha_{i,j}\}\in{\mathcal{R}^{(T_{1},T_{2})}}
\boldsymbol{c}
g
\boldsymbol{y}
\boldsymbol{y}=g(\boldsymbol{c})
f
g
\alpha_{i,j}
y_{j}
x_{i}
\alpha_{i,j}
y_{j}
x_{i}
\boldsymbol{\alpha}\in\mathcal{R}^{(T_{1},T_{2})}
\boldsymbol{x}\in\mathcal{R}^{(D_{1},T_{1})}
\boldsymbol{y}\in\mathcal{R}^{(D_{2},T_{2})}
\boldsymbol{\pi}
\boldsymbol{p}=\{0,1,\cdots,T_{1}-1\}
\boldsymbol{\alpha}
\pi_{j}=\sum_{i=0}^{T_{1}-1}\alpha_{i,j}*p_{i},
0\leq j\leq T_{2}-1
\boldsymbol{\pi}\in\mathcal{R}^{T_{2}}
\displaystyle\sum_{i=0}^{T_{1}-1}\alpha_{i,j}=1
0
T_{1}-1
\boldsymbol{\alpha}
0\leq\Delta\pi_{i}\leq 1,
\Delta\pi_{i}=\pi_{i}-\pi_{i-1},1\leq i\leq T_{2}-1
\pi
\displaystyle\pi_{0}=0,
\displaystyle\pi_{0}
\displaystyle=0,
\displaystyle\pi_{T_{2}-1}=T_{1}-1.
\displaystyle\pi_{T_{2}-1}
\displaystyle=T_{1}-1.
\boldsymbol{\alpha}_{0}=\{1,0,...,0\}
\boldsymbol{\alpha}_{T_{2}-1}=\{0,0,...,1\}
\boldsymbol{\alpha}_{0}=\{\alpha_{i,j}\mid 0\leq i\leq T_{1}-1,j=0\}
\boldsymbol{\alpha}_{T_{2}-1}=\{\alpha_{i,j}\mid 0\leq i\leq T_{1}-1,j=T_{2}-1\}
\displaystyle\mathcal{L}_{\rm SMA}=\lambda_{0}\|\lvert\Delta\pi\rvert-\Delta%
\pi\|_{1}
\displaystyle\mathcal{L}_{\rm SMA}
\displaystyle=\lambda_{0}\|\lvert\Delta\pi\rvert-\Delta\pi\|_{1}
\displaystyle+\lambda_{1}\|\lvert\Delta\pi-1\rvert+(\Delta\pi-1)\|_{1}
\displaystyle+\lambda_{1}\|\lvert\Delta\pi-1\rvert+(\Delta\pi-1)\|_{1}
\displaystyle+\lambda_{2}\|\frac{\pi_{0}}{T_{1}-1}\|_{2}
\displaystyle+\lambda_{2}\|\frac{\pi_{0}}{T_{1}-1}\|_{2}
\displaystyle+\lambda_{3}\|\frac{\pi_{T_{2}-1}}{T_{1}-1}-1\|_{2},
\displaystyle+\lambda_{3}\|\frac{\pi_{T_{2}-1}}{T_{1}-1}-1\|_{2},
\|\cdot\|_{1}
\|\cdot\|_{2}
L^{1}
L^{2}
\lambda_{0},\lambda_{1},\lambda_{2},\lambda_{3}
\mathcal{L}_{\rm SMA}
\boldsymbol{\pi}
\mathcal{L}_{\rm SMA}
\boldsymbol{\alpha}
\boldsymbol{p}
\boldsymbol{\pi}^{\prime}
\boldsymbol{\alpha}
\boldsymbol{\pi}^{\prime}
\boldsymbol{\pi}
\Delta\boldsymbol{\pi}>0
\rm ReLU
\displaystyle\Delta\pi^{\prime}_{j}=\pi^{\prime}_{j}-\pi^{\prime}_{j-1},0<j%
\leq T_{2}-1,
\displaystyle\Delta\pi^{\prime}_{j}=\pi^{\prime}_{j}-\pi^{\prime}_{j-1},
\displaystyle 0<j\leq T_{2}-1,
\displaystyle\Delta\pi_{j}=\rm ReLU(\Delta\pi^{\prime}_{j}),0<j\leq T_{2}-1,
\displaystyle\Delta\pi_{j}=\rm ReLU(\Delta\pi^{\prime}_{j}),
\displaystyle 0<j\leq T_{2}-1,
\pi_{j}=\begin{cases}0,&j=0\\
\sum_{m=0}^{j}\Delta{\pi_{m}}.&0<j\leq T_{2}-1.\end{cases}
\boldsymbol{\pi}
[0,T_{1}-1]
\boldsymbol{\pi}
\displaystyle\pi^{*}_{j}=\pi_{j}*\frac{T_{1}-1}{\max(\boldsymbol{\pi})}
\displaystyle\pi^{*}_{j}
\displaystyle=\pi_{j}*\frac{T_{1}-1}{\max(\boldsymbol{\pi})}
\displaystyle=\pi_{j}*\frac{T_{1}-1}{\pi_{T_{2}-1}},
\displaystyle=\pi_{j}*\frac{T_{1}-1}{\pi_{T_{2}-1}},
\displaystyle 0\leq j\leq T_{2}-1.
\displaystyle 0\leq j\leq T_{2}-1.
\boldsymbol{\pi}^{*}
\alpha^{\prime}_{i,j}=\frac{\exp{(-\sigma^{-2}(p_{i}-\pi^{*}_{j})^{2})}}{\sum_%
{m=0}^{T_{1}-1}\exp{(-\sigma^{-2}(p_{m}-\pi^{*}_{j})^{2})}},
\sigma^{2}
\boldsymbol{\alpha^{\prime}}
\boldsymbol{\alpha}
\boldsymbol{\alpha}
\boldsymbol{\alpha^{\prime}}
\boldsymbol{\alpha^{\prime}}
\boldsymbol{\alpha}
\boldsymbol{\alpha}
\boldsymbol{\alpha}
\alpha_{i,j}=\frac{\exp{(-D^{-0.5}(\boldsymbol{q_{j}}\cdot\boldsymbol{k_{i}}))%
}}{\sum_{m=0}^{T_{1}-1}\exp{(-D^{-0.5}(\boldsymbol{q_{j}}\cdot\boldsymbol{k_{m%
}}))}},
\boldsymbol{q}
\boldsymbol{k}
D
\boldsymbol{q}
\boldsymbol{k}
\boldsymbol{\pi}
\boldsymbol{h}
\boldsymbol{\pi}
\boldsymbol{h}
\pi_{i}
\pi_{j}
(j>i)
\boldsymbol{\pi}
\boldsymbol{e}
m(\cdot)
\boldsymbol{p},\boldsymbol{q}
\boldsymbol{\pi}
\boldsymbol{e}
m(\cdot)
\boldsymbol{p},\boldsymbol{q}
\boldsymbol{\pi}
\boldsymbol{e}
m(\cdot)
\boldsymbol{\pi}=m(\boldsymbol{q})
\boldsymbol{\pi}
\boldsymbol{q}
m(\cdot)
m(\cdot)
\boldsymbol{q}=m^{-1}(\boldsymbol{\pi}),
\boldsymbol{e}
\boldsymbol{e}=m^{-1}(\boldsymbol{p}),\qquad\boldsymbol{p}=\{0,1,...,T_{1}-1\}.
m(\cdot),\boldsymbol{e},\boldsymbol{\pi}
\boldsymbol{e}
\boldsymbol{\gamma}
\boldsymbol{e}
\boldsymbol{q}
\boldsymbol{\gamma}
\gamma_{i,j}=\frac{\exp{(-\sigma^{-2}(p_{i}-\pi_{j})^{2})}}{\sum_{n=0}^{T_{2}-%
1}\exp{(-\sigma^{-2}(p_{i}-\pi_{n})^{2})}},
e_{i}=\sum_{n=0}^{T_{2}-1}\gamma_{i,n}*q_{n}.
\boldsymbol{e}
\boldsymbol{e}
\boldsymbol{e}
\boldsymbol{h}
\Delta\boldsymbol{e},(\Delta e_{i}=e_{i}-e_{i-1},1\leq i\leq T_{1}-1)
\boldsymbol{e}
\Delta\boldsymbol{e}
\boldsymbol{\pi}
\Delta\hat{\boldsymbol{e}}
\Delta\boldsymbol{e}
\mathcal{L}_{ap}=\|\log{(\Delta\hat{\boldsymbol{e}}+\epsilon)}-\log{(\Delta%
\boldsymbol{e}+\epsilon)}\|_{1},
\epsilon
\boldsymbol{h}
\boldsymbol{e}
\boldsymbol{e}
\boldsymbol{\alpha^{\prime}}
\boldsymbol{e}
\alpha^{\prime}_{i,j}=\frac{\exp{(-\sigma^{-2}(e_{i}-q_{j})^{2})}}{\sum_{m=0}^%
{T_{1}-1}\exp{(-\sigma^{-2}(e_{m}-q_{j})^{2})}},
\boldsymbol{q}=\{0,1,...,T_{2}-1\}
T_{2}
\boldsymbol{e}
T_{2}=e_{T_{1}-1}+\Delta e_{T_{1}-1}.
\boldsymbol{e}
\boldsymbol{\pi}
\boldsymbol{\alpha}
\boldsymbol{\alpha}
10
\boldsymbol{h}
\boldsymbol{\alpha}^{\prime}
1
10
270
270
1
10
270
270
f
\mathcal{N}(\boldsymbol{0},\boldsymbol{1})
f
\boldsymbol{z}
\mathcal{N}(\boldsymbol{0},\boldsymbol{1})
\boldsymbol{z}
\boldsymbol{o}
t
f
\displaystyle\boldsymbol{z}^{\prime}=t*\boldsymbol{z}+\boldsymbol{o}*(1-t),0%
\leq t\leq 1
\displaystyle\boldsymbol{z}^{\prime}=t*\boldsymbol{z}+\boldsymbol{o}*(1-t),0%
\leq t\leq 1
\displaystyle\boldsymbol{x}=f^{-1}(\boldsymbol{z}^{\prime}).
\displaystyle\boldsymbol{x}=f^{-1}(\boldsymbol{z}^{\prime}).
1
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
10,000
1\times 10^{-4}
1\times 10^{-4}
5\times 10^{-5}
95\%
95\%
z
95\%
z
\pm
\pm
\pm
\pm
\pm
\pm
\pm
95\%
z
95\%
z
\pm
\pm
\pm
\pm
\pm
6
130\times
16
54\times
500k
450k
500k
450k
\%
\%
\%
\%
t
z
\boldsymbol{\alpha}
0\leq\Delta\boldsymbol{(}\pi)\leq 1
P(y_{j},x_{i})
y_{i}
x_{i}
(y_{i},x_{i})
(y_{j+1},x_{i+1})
(y_{j+1},x_{i})
P(y_{j+1},x_{i+1}|y_{j},x_{i})+P(y_{j+1},x_{i}|y_{j},x_{i})=1,
P(y_{j+1},x_{i+1}|y_{j},x_{i})
(y_{j},x_{i})
(y_{j+1},x_{i+1})
y_{i}
x_{i}
\beta_{i,j}=P(y_{j+1},x_{i}|y_{j},x_{i}),
\alpha_{i,j}=P(y_{j},x_{i}).
\displaystyle\alpha_{i,j}=P(y_{j},x_{i}|y_{j-1},x_{i})*P(y_{j-1},x_{i})+P(y_{j%
},x_{i}|y_{j-1},x_{i-1})*P(y_{j-1},x_{i-1})
\displaystyle\alpha_{i,j}
\displaystyle=P(y_{j},x_{i}|y_{j-1},x_{i})*P(y_{j-1},x_{i})+P(y_{j},x_{i}|y_{j%
-1},x_{i-1})*P(y_{j-1},x_{i-1})
\displaystyle=P(y_{j},x_{i}|y_{j-1},x_{i})*P(y_{j-1},x_{i})+(1-P(y_{j},x_{i-1}%
)|y_{j-1},x_{i-1}))*P(y_{j-1},x_{i-1})
\displaystyle=P(y_{j},x_{i}|y_{j-1},x_{i})*P(y_{j-1},x_{i})+(1-P(y_{j},x_{i-1}%
)|y_{j-1},x_{i-1}))*P(y_{j-1},x_{i-1})
\displaystyle=\beta_{i,j-1}*\alpha_{i,j-1}+(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}.
\displaystyle=\beta_{i,j-1}*\alpha_{i,j-1}+(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}.
\displaystyle\pi_{j}=\sum_{i=0}^{T_{1}-1}\alpha_{i,j}*p_{i}
\displaystyle\pi_{j}
\displaystyle=\sum_{i=0}^{T_{1}-1}\alpha_{i,j}*p_{i}
\displaystyle=\sum_{i=0}^{T_{1}-1}\beta_{i,j-1}*\alpha_{i,j-1}*p_{i}+\sum_{i=1%
}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}*p_{i}.
\displaystyle=\sum_{i=0}^{T_{1}-1}\beta_{i,j-1}*\alpha_{i,j-1}*p_{i}+\sum_{i=1%
}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}*p_{i}.
p_{i}=p_{i-1}+1,\forall 1\leq i\leq T_{1}-1
\displaystyle\pi_{j}=\sum_{i=0}^{T_{1}-1}\beta_{i,j-1}*\alpha_{i,j-1}*p_{i}+%
\sum_{i=1}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}*(p_{i-1}+1)
\displaystyle\pi_{j}=
\displaystyle\sum_{i=0}^{T_{1}-1}\beta_{i,j-1}*\alpha_{i,j-1}*p_{i}+\sum_{i=1}%
^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}*(p_{i-1}+1)
\displaystyle=\sum_{i=0}^{T_{1}-1}\beta_{i,j-1}*\alpha_{i,j-1}*p_{i}+\sum_{i=1%
}^{T_{1}-1}\alpha_{i-1,j-1}*p_{i-1}
\displaystyle=
\displaystyle\sum_{i=0}^{T_{1}-1}\beta_{i,j-1}*\alpha_{i,j-1}*p_{i}+\sum_{i=1}%
^{T_{1}-1}\alpha_{i-1,j-1}*p_{i-1}
\displaystyle-\sum_{i=1}^{T_{1}-1}\beta_{i-1,j-1}*\alpha_{i-1,j-1}*p_{i-1}+%
\sum_{i=1}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}
\displaystyle-
\displaystyle\sum_{i=1}^{T_{1}-1}\beta_{i-1,j-1}*\alpha_{i-1,j-1}*p_{i-1}+\sum%
_{i=1}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}
\displaystyle=\pi_{j-1}+\sum_{i=1}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-%
1}.
\displaystyle=
\displaystyle\pi_{j-1}+\sum_{i=1}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}.
0\leq\sum_{i=1}^{T_{1}-1}(1-\beta_{i-1,j-1})*\alpha_{i-1,j-1}\leq\sum_{i=0}^{T%
_{1}-1}\alpha_{i,j-1}=1.
0\leq\Delta\pi_{j}\leq 1,\forall j\in[0,T_{2}-1].
1.2,1.0,0.8
z
z
\pi
Clamp(\cdot)
0\leq\Delta\pi\leq 1
\alpha
\alpha
\pi=0
p=range(0,T_{1})
i=0
T_{2}-1
\alpha_{i}=SoftAttention(x_{i},h)
\pi^{\prime}=\alpha_{i}\cdot p
\Delta\pi=Clamp(\pi^{\prime}-\pi,min=0,max=1)
\pi=\pi+\Delta\pi
\alpha_{i}=softmax(-\sigma^{-2}*(\pi-p)^{2})
out=DecoderRNN(\alpha_{i},h)
