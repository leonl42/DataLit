\displaystyle\max_{G}~{}score(\mathbf{X},G)\text{ s.t. }G\in\text{ discrete DAGs}
\displaystyle\max_{G}~{}score(\mathbf{X},G)\text{ s.t. }G\in\text{ discrete DAGs}
\mathbf{X}
\displaystyle\max_{G}~{}score(\mathbf{X},G)\text{ s.t. }h(G)=0
\displaystyle\max_{G}~{}score(\mathbf{X},G)\text{ s.t. }h(G)=0
h(G)
G
G
G
190
1
100
G=(V,E)
n
x_{1},...,x_{n}
m
\pi:[\![1,n]\!]\rightarrow[\![1,n]\!]
\pi(i)<\pi(j)
x_{\pi(j)}
x_{\pi(i)}
\mathbf{A}\in\{0,1\}^{n}
G
\mathbf{A}
\mathbf{\Pi}\in\{0,1\}^{n\times n}
\mathbf{U}\in\{0,1\}^{n\times n}
\mathbf{A}=\mathbf{\Pi}^{T}\mathbf{U}\mathbf{\Pi}
\mathbf{\Pi}
\pi
\mathbf{\mathbf{U}}
\mathbf{A}_{ij}=\mathbf{U}_{\pi(i)\pi(j)}
\mathbf{U}_{\pi(i)\pi(j)}=0
\pi(i)<\pi(j)
\mathbf{A}
G
\mathbf{\Pi}
\displaystyle\operatorname{\mathbb{P}}(\mathbf{A})=\sum_{\mathbf{\Pi}\in%
\mathcal{P}(G),\mathbf{U}\in\mathcal{U}_{n}}\operatorname{\mathbb{P}}(\mathbf{%
U})\operatorname{\mathbb{P}}(\mathbf{\Pi})\hskip 8.53581pt\text{s.t.}\hskip 8.%
53581pt\mathbf{A}=\mathbf{\Pi}^{T}\mathbf{U}\mathbf{\Pi}
\displaystyle\operatorname{\mathbb{P}}(\mathbf{A})=\sum_{\mathbf{\Pi}\in%
\mathcal{P}(G),\mathbf{U}\in\mathcal{U}_{n}}\operatorname{\mathbb{P}}(\mathbf{%
U})\operatorname{\mathbb{P}}(\mathbf{\Pi})\hskip 8.53581pt\text{s.t.}\hskip 8.%
53581pt\mathbf{A}=\mathbf{\Pi}^{T}\mathbf{U}\mathbf{\Pi}
\mathcal{P}(G)
G
\mathcal{U}_{n}
n\times n
\operatorname{\mathbb{P}}(\mathbf{\Pi})
\operatorname{\mathbb{P}}(\mathbf{U})
|\mathcal{P}(G)|
\operatorname{\mathbb{P}}(\mathbf{A})
\mathbf{A}\sim\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})
\mathbf{U}\sim\operatorname{\mathbb{P}}_{\phi}(\mathbf{U})
\mathbf{\Pi}\sim\operatorname{\mathbb{P}}_{\psi}(\mathbf{\Pi})
\psi
\phi
U_{ij}\in\{0,1\}\sim\mathrm{Ber}(p)
p\in[0,1]
\hat{U}_{ij}\in[0,1]\sim\text{Gumbel-Softmax}_{\tau}(\phi)
\phi\in[0,1]
\tau
\tau\rightarrow 0
\tau\rightarrow+\infty
U_{ij}=\arg\max[1-\hat{U}_{ij},\hat{U}_{ij}]
\hat{U}_{ij}
\mathbf{U}\in\{0,1\}^{n\times n}
\mathcal{O}(n^{2})
\mathbf{\Pi}
\hat{\mathbf{\Pi}}\in[0,1]^{n\times n}\sim\text{Gumbel-Sinkhorn}_{\tau}(%
\mathbf{\psi})
\mathbf{\psi}\in[0,1]^{n\times n}
\tau
\mathbf{\Pi}=\text{Hungarian}(\hat{\mathbf{\Pi}})
\hat{\mathbf{\Pi}}
\mathbf{\Pi}\in\{0,1\}^{n\times n}
\mathcal{O}(n^{3})
k=n
\pi=\text{Sort}(\psi+\bm{G})
\psi
\bm{G}\in\operatorname{\mathbb{R}}^{n}
\hat{\mathbf{\Pi}}=\text{SoftSort}(\psi+\bm{G})\in\operatorname{\mathbb{R}}^{n%
\times n}
\mathbf{\Pi}=\arg\max\hat{\mathbf{\Pi}}
\hat{\mathbf{\Pi}}
\mathbf{\Pi}\in\{0,1\}^{n\times n}
\mathcal{O}(n^{2})
\mathbf{\Pi}
\operatorname{\mathbb{P}}_{\psi}(\mathbf{\Pi})
\mathbf{\Pi}\sim\operatorname{\mathbb{P}}_{\psi}(\mathbf{\Pi})
\mathbf{U}
\operatorname{\mathbb{P}}_{\phi}(U_{ij})
U_{ij}\sim\operatorname{\mathbb{P}}_{\phi}(U_{ij})
\mathbf{A}
\mathbf{\Pi}
\mathbf{U}
\mathbf{A}=\mathbf{\Pi}^{T}\mathbf{U}\mathbf{\Pi}
n
\operatorname{\mathbb{P}}_{\psi}(\mathbf{\Pi})
\operatorname{\mathbb{P}}_{\phi}(U_{ij})
\mathcal{O}(n^{3})
\mathcal{O}(n^{2})
x_{i}=f^{*}_{i}(x_{\text{pa}^{*}(i)},\epsilon_{i})
\epsilon_{i}
f^{*}_{i}
x_{\text{pa}^{*}(i)}
\epsilon_{i}
x_{i}
\text{pa}^{*}(i)
i
f^{*}_{i}
\mathbf{A}^{*}
f_{i}^{*}
X_{i}=f_{i}^{*}(\mathbf{A}_{i}^{*}\circ\mathbf{X},\epsilon_{i})
\mathbb{E}_{G}[score(\mathbf{X},G)]
P_{\phi,\psi}(G)
\displaystyle\max_{\phi,\psi}~{}\mathbb{E}_{G}[score(\mathbf{X},G)]\text{ s.t.%
 }G\sim\operatorname{\mathbb{P}}_{\phi,\psi}(G)
\displaystyle\max_{\phi,\psi}~{}\mathbb{E}_{G}[score(\mathbf{X},G)]\text{ s.t.%
 }G\sim\operatorname{\mathbb{P}}_{\phi,\psi}(G)
\displaystyle\max_{\theta,\phi,\psi}\mathcal{L}=\underbrace{\mathbb{E}_{%
\mathbf{A}\sim\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})}[\log%
\operatorname{\mathbb{P}}_{\theta}(\mathbf{X}|\mathbf{A})]}_{\text{(i)}}-%
\lambda\underbrace{\text{KL}(\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})%
||\operatorname{\mathbb{P}}_{\text{prior}}(\mathbf{A}))}_{\text{(ii)}}
\displaystyle\max_{\theta,\phi,\psi}\mathcal{L}=\underbrace{\mathbb{E}_{%
\mathbf{A}\sim\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})}[\log%
\operatorname{\mathbb{P}}_{\theta}(\mathbf{X}|\mathbf{A})]}_{\text{(i)}}-%
\lambda\underbrace{\text{KL}(\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})%
||\operatorname{\mathbb{P}}_{\text{prior}}(\mathbf{A}))}_{\text{(ii)}}
\lambda\in\operatorname{\mathbb{R}}^{+}
\theta,\phi,\psi
\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})
\operatorname{\mathbb{P}}(\mathbf{A}|\phi,\psi)\approx\operatorname{\mathbb{P}%
}(\mathbf{A}|\mathcal{D})
\mathcal{D}
\mathbf{A}
\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})
\operatorname{\mathbb{P}}_{\phi,\psi}(\mathbf{A})
n
f_{i,\theta}
\mathbf{A}
\hat{X_{i}}=f_{i,\theta}(\mathbf{A}_{i}\circ\mathbf{X},\epsilon_{i})
f_{i,\theta}
\theta,\phi,\psi
\mathbf{A}
\hat{\mathbf{X}}
=||\mathbf{X}-\hat{\mathbf{X}}||_{2}
\operatorname{\mathbb{P}}_{\text{prior}}(U_{ij})
=\sum_{ij}\text{KL}(\operatorname{\mathbb{P}}_{\phi}(U_{ij}||\operatorname{%
\mathbb{P}}_{\text{prior}}(U_{ij}))
\operatorname{\mathbb{P}}_{\theta}(\mathbf{\Pi})
\mathbf{A}
\mathbf{A}^{*}
\mathbf{A}^{*}
\mathbf{A}
\operatorname{\mathbb{P}}_{\phi}(U_{ij})
\operatorname{\mathbb{P}}_{\text{prior}}(U_{ij})
A
x_{i}
x_{i}\approx\hat{x_{i}}=f_{i,\theta}(x_{\text{pa}}(i))
||x_{i}-\hat{x_{i}}||_{2}
x_{\text{pa}}(i)
x_{i}
x_{\text{pa}}(i)
x_{i}
\operatorname{\mathbb{P}}_{\psi}(\mathbf{\Pi})
\operatorname{\mathbb{P}}_{\phi}(\mathbf{U})
f_{i,\theta}
\operatorname{\mathbb{P}}_{\text{prior}}(U_{ij})\in[1e^{-2},1e^{-1}]
\lambda\in[0,1e^{-1}]
\tau=1
10
\mathbf{A}^{*}
f^{*}_{i}
\epsilon_{i}
n
\{10,50,100\}
m
\{10,40,50,100,200,400\}
n
m
\mathbf{A}^{*}
80\%/10\%/10\%
200
1
A^{*}_{ij}
S_{ij}
S_{ij}=A_{ij}
S_{ij}=A_{ij}+A_{ji}
S_{ij}=\operatorname{\mathbb{P}}_{\phi}(U_{\pi(i)\pi(j)})
S_{ij}=\operatorname{\mathbb{P}}_{\phi}(U_{\pi(i)\pi(j)})+\operatorname{%
\mathbb{P}}_{\phi}(U_{\pi(j)\pi(i)})
\pi
\mathbf{\Pi}
10
50
100
+17\%
+25\%
+13\%
+9\%
50\%
x_{i}
x_{j}
x_{j}
x_{i}
18.67\pm 0.17
48.44\pm 0.15
8.21\pm 0.15
47.83\pm 0.34
16.11\pm 0.12
50.20\pm 0.03
8.15\pm 0.07
50.19\pm 0.02
25.11\pm 0.4
56.57\pm 0.35
17.61\pm 0.47
56.35\pm 0.34
17.55\pm 0.14
51.09\pm 0.05
9.14\pm 0.09
50.81\pm 0.04
\mathbf{62.08}\pm 0.34
\mathbf{84.53}\pm 0.25
\mathbf{41.70}\pm 0.39
\mathbf{71.08}\pm 0.33
14.65\pm 0.25
49.05\pm 0.2
5.56\pm 0.09
47.47\pm 0.29
7.82\pm 0.04
49.98\pm 0.02
3.94\pm 0.02
50.05\pm 0.02
9.73\pm 0.11
52.82\pm 0.11
4.42\pm 0.04
51.04\pm 0.06
8.93\pm 0.12
50.65\pm 0.06
4.73\pm 0.1
50.52\pm 0.06
\mathbf{36.98}\pm 0.98
\mathbf{77.23}\pm 0.63
\mathbf{19.00}\pm 1.07
\mathbf{60.35}\pm 1.01
14.94\pm 0.17
51.41\pm 0.26
6.91\pm 0.12
50.31\pm 0.27
11.83\pm 0.1
50.18\pm 0.03
5.86\pm 0.06
50.02\pm 0.02
18.75\pm 0.29
54.76\pm 0.17
12.35\pm 0.32
53.31\pm 0.43
14.39\pm 0.13
51.64\pm 0.06
7.23\pm 0.12
50.97\pm 0.06
\mathbf{33.81}\pm 0.39
\mathbf{68.18}\pm 0.39
\mathbf{17.46}\pm 0.34
\mathbf{59.70}\pm 0.65
\mathbf{49.92}\pm 0.46
59.59\pm 0.57
\mathbf{23.84}\pm 0.52
51.67\pm 0.62
35.66\pm 0.32
53.57\pm 0.44
15.43\pm 0.11
50.16\pm 0.31
34.28\pm 0.32
54.57\pm 0.36
19.95\pm 0.35
55.91\pm 0.33
36.98\pm 0.25
55.13\pm 0.15
17.74\pm 0.31
51.71\pm 0.23
43.37\pm 0.55
\mathbf{59.78}\pm 0.62
22.96\pm 0.81
\mathbf{60.02}\pm 0.91
24.83\pm 0.19
66.75\pm 0.2
9.26\pm 0.11
59.61\pm 0.19
12.89\pm 0.15
49.02\pm 0.24
6.63\pm 0.15
49.11\pm 0.16
19.89\pm 0.4
62.29\pm 0.31
\mathbf{15.39}\pm 0.44
\mathbf{63.91}\pm 0.34
16.66\pm 0.38
53.93\pm 0.28
7.99\pm 0.29
52.26\pm 0.35
\mathbf{26.33}\pm 0.56
\mathbf{70.84}\pm 0.45
14.17\pm 0.76
59.84\pm 1.46
x_{i}
\hat{x_{i}}=f_{i,\theta}(x_{\text{pa}}(i))
||\mathbf{X}-\hat{\mathbf{X}}||^{2}_{2}
\hat{X_{i}}=f_{i,\theta}(\mathbf{A}_{i}\circ\mathbf{X})
\mathbf{A}
f_{i,\theta}
\mathbf{A}
\mathbf{A}^{*}
\mathbf{A}
f_{i,\theta}
\mathbf{A}
\pi
\mathbf{\Pi}
\operatorname{\mathbb{P}}_{\phi}(U_{\pi(i)\pi(j)})>.5
10
50
100
t
\operatorname{\mathbb{P}}_{\phi}(U_{\pi(i)\pi(j)})>t
\mathbf{A}
\times 5
\times 18
T\approx 10
191
100
12
100
\mathbf{0.61}\pm 0.01
0.93\pm 0.02
0.69\pm 0.01
0.58\pm 0.01
\mathbf{0.41}\pm 0.01
1.0\pm 0.02
0.49\pm 0.01
0.3\pm 0.0
0.82\pm 0.01
0.97\pm 0.0
\mathbf{0.8}\pm 0.01
0.57\pm 0.01
0.84\pm 0.01
0.97\pm 0.0
\mathbf{0.8}\pm 0.01
0.48\pm 0.01
0.96\pm 0.02
0.95\pm 0.0
\mathbf{0.84}\pm 0.0
0.54\pm 0.0
0.96\pm 0.02
0.98\pm 0.0
\mathbf{0.9}\pm 0.0
0.48\pm 0.0
\mathbf{0.74}\pm 0.01
0.95\pm 0.02
\mathbf{0.74}\pm 0.01
0.66\pm 0.01
\mathbf{0.93}\pm 0.01
0.99\pm 0.0
\mathbf{0.93}\pm 0.0
0.79\pm 0.01
\mathbf{0.9}\pm 0.01
0.95\pm 0.0
\mathbf{0.9}\pm 0.0
0.77\pm 0.0
1.16\pm 0.05
0.93\pm 0.05
\mathbf{0.86}\pm 0.04
0.84\pm 0.04
0.82\pm 0.02
0.8\pm 0.02
\mathbf{0.21}\pm 0.0
0.21\pm 0.0
||\mathbf{X}-\hat{\mathbf{X}}||^{2}_{2}
\hat{X_{i}}=f_{i,\theta}(\mathbf{A}_{i}\circ\mathbf{X})
\mathbf{A}
f_{\psi}
\mathbf{A}^{*}
||\mathbf{X}-\hat{\mathbf{X}}||^{2}_{2}
\hat{X_{i}}=f_{i,\theta}(\mathbf{A}_{i}\circ\mathbf{X})
\mathbf{A}
f_{\psi}
\mathbf{A}^{*}
2997\pm 20
596\pm 8
1997\pm 30
5191\pm 53
\mathbf{160}\pm 6
10727\pm 145
615\pm 12
1919\pm 26
4962\pm 44
\mathbf{86}\pm 3
3485\pm 110
1290\pm 19
4279\pm 73
5329\pm 63
\mathbf{190}\pm 4
3260\pm 72
1078\pm 22
5121\pm 83
5531\pm 71
\mathbf{194}\pm 3
4077\pm 50
2503\pm 54
10530\pm 212
4969\pm 38
\mathbf{138}\pm 3
5198\pm 66
2391\pm 59
10629\pm 200
5008\pm 36
\mathbf{191}\pm 7
1642\pm 17
641\pm 24
1873\pm 29
4887\pm 31
\mathbf{83}\pm 2
2969\pm 32
1138\pm 44
4611\pm 58
4901\pm 23
\mathbf{112}\pm 2
2910\pm 20
1087\pm 40
4640\pm 60
4888\pm 23
\mathbf{87}\pm 1
1570\pm 66
358\pm 13
1657\pm 36
4970\pm 26
\mathbf{67}\pm 3
8257\pm 160
461\pm 9
5120\pm 129
4926\pm 25
\mathbf{53}\pm 1
\mathbf{A}
\theta
\displaystyle\min_{G}~{}score(\mathbf{X},\mathbf{A},\theta)
\displaystyle\min_{G}~{}score(\mathbf{X},\mathbf{A},\theta)
\displaystyle\text{s.t. }h(\mathbf{A})=0
\displaystyle\text{s.t. }h(\mathbf{A})=0
h(\mathbf{A})=\text{Tr}(e^{\mathbf{A}})-n
h(\mathbf{A})=\text{Tr}(\mathbf{I}+\alpha\mathbf{A}\circ\mathbf{A})^{n}-n
\alpha\in\operatorname{\mathbb{R}}^{+}
h
\mathbf{A}\in\operatorname{\mathbb{R}}^{n\times n}
G
\displaystyle L_{c}(\mathbf{A},\theta,\lambda)=score(\mathbf{X},\mathbf{A},%
\theta)+\lambda h(\mathbf{A})+\frac{c}{2}|h(\mathbf{A})|^{2}
\displaystyle L_{c}(\mathbf{A},\theta,\lambda)=score(\mathbf{X},\mathbf{A},%
\theta)+\lambda h(\mathbf{A})+\frac{c}{2}|h(\mathbf{A})|^{2}
\lambda
c
\lambda
c
\displaystyle\mathbf{A}_{k},\theta_{k}=\arg\min_{\mathbf{A},\theta}L_{c}(%
\mathbf{A},\theta,\lambda)
\displaystyle\mathbf{A}_{k},\theta_{k}
\displaystyle=\arg\min_{\mathbf{A},\theta}L_{c}(\mathbf{A},\theta,\lambda)
\displaystyle\lambda_{k+1}=\lambda_{k}+c_{k}h(\mathbf{A}_{k})
\displaystyle\lambda_{k+1}
\displaystyle=\lambda_{k}+c_{k}h(\mathbf{A}_{k})
\displaystyle c_{k+1}=\begin{cases}\eta c_{k},\text{ if }|h(\mathbf{A}_{k})|>%
\gamma|h(\mathbf{A}_{k-1})|\\
c_{k},\text{ otherwise}\end{cases}
\displaystyle c_{k+1}
\displaystyle=\begin{cases}\eta c_{k},\text{ if }|h(\mathbf{A}_{k})|>\gamma|h(%
\mathbf{A}_{k-1})|\\
c_{k},\text{ otherwise}\end{cases}
\eta>1
\gamma>1
\eta=10
\gamma=\frac{1}{4}
h(\mathbf{A}_{k})<\epsilon\in\{1e^{-6},1e^{-8},1e^{-10}\}
\epsilon
10
\mathbf{U}
(k-1)
\phi_{1},...,\phi_{k}
\tau
\displaystyle U\sim\text{Gumbel-Softmax}_{\tau}(\phi)
\displaystyle U\sim\text{Gumbel-Softmax}_{\tau}(\phi)
\tau
0
\displaystyle\operatorname{\mathbb{P}}(\mathbf{U}|\phi,\tau)=\Gamma(k)\tau^{k-%
1}\frac{\prod_{i=1}^{k}\phi_{i}/U_{i}^{\tau+1}}{\sum_{i=1}^{k}\phi_{i}/U_{i}^{%
\tau+1}}
\displaystyle\operatorname{\mathbb{P}}(\mathbf{U}|\phi,\tau)=\Gamma(k)\tau^{k-%
1}\frac{\prod_{i=1}^{k}\phi_{i}/U_{i}^{\tau+1}}{\sum_{i=1}^{k}\phi_{i}/U_{i}^{%
\tau+1}}
\Gamma(k)
\mathbf{U}
\displaystyle U_{i}=\frac{e^{(\log(\phi_{i})+G_{i})/\tau}}{\sum_{j=1}^{k}e^{(%
\log(\phi_{j})+G_{j})/\tau}}
\displaystyle U_{i}=\frac{e^{(\log(\phi_{i})+G_{i})/\tau}}{\sum_{j=1}^{k}e^{(%
\log(\phi_{j})+G_{j})/\tau}}
G_{i}
\text{Gumbel}(0)
\text{one\_hot}(\arg\max(\mathbf{U}))
\mathbf{U}
\mathbf{\Pi}
\mathbf{\psi}\in\operatorname{\mathbb{R}}^{n\times n}
\tau
\displaystyle\mathbf{\Pi}\sim\text{Gumbel-Sinkhorn}_{\tau}(\mathbf{\psi})
\displaystyle\mathbf{\Pi}\sim\text{Gumbel-Sinkhorn}_{\tau}(\mathbf{\psi})
\tau
0
\mathbf{\Pi}
\displaystyle\mathbf{\Pi}=S(\mathbf{\psi}+\mathbf{G})
\displaystyle\mathbf{\Pi}=S(\mathbf{\psi}+\mathbf{G})
S
\mathbf{G}\in\operatorname{\mathbb{R}}^{n\times n}
\mathbf{\Pi}=\text{Hungarian}(\hat{\mathbf{\Pi}})
\mathbf{\Pi}
\pi
k
\mathbf{\psi}\in\operatorname{\mathbb{R}}^{n}
\displaystyle\pi\sim\text{Gumbel-Top-k}_{\tau}(\mathbf{\psi})
\displaystyle\pi\sim\text{Gumbel-Top-k}_{\tau}(\mathbf{\psi})
\tau
1
\displaystyle\operatorname{\mathbb{P}}(\pi|\psi,\tau)=\prod_{i=1}^{k}\frac{e^{%
\psi_{\pi_{j}}}}{\sum_{l\in N_{j}}e^{\psi_{l}}}
\displaystyle\operatorname{\mathbb{P}}(\pi|\psi,\tau)=\prod_{i=1}^{k}\frac{e^{%
\psi_{\pi_{j}}}}{\sum_{l\in N_{j}}e^{\psi_{l}}}
N_{j}=\{1,...,n\}\diagdown\{\pi_{1},...,\pi_{j-1}\}
k
\mathbf{\psi}
\pi
\displaystyle\pi=\arg\text{top-k}(\psi+\mathbf{G})
\displaystyle\pi=\arg\text{top-k}(\psi+\mathbf{G})
\arg\text{top-k}
\mathbf{G}\ \in\operatorname{\mathbb{R}}^{n}
k=n
\pi=\text{Sort}(\psi+\mathbf{G})
\mathbf{G}\in\operatorname{\mathbb{R}}^{n}\sim\text{Gumbel}(0)
\tau
\displaystyle\text{SoftSort}_{\tau}^{d}(s)=\text{Softmax}\left(\frac{-d(\text{%
sort(s)}\mathbb{1}^{T},\mathbb{1}s^{T})}{\tau}\right)
\displaystyle\text{SoftSort}_{\tau}^{d}(s)=\text{Softmax}\left(\frac{-d(\text{%
sort(s)}\mathbb{1}^{T},\mathbb{1}s^{T})}{\tau}\right)
d
d=|\cdot|
\mathbf{\Pi}_{\arg\text{sort}(s)}
\displaystyle\lim_{\tau\rightarrow 0}\text{SoftSort}_{\tau}^{d}(s)=\mathbf{\Pi%
}_{\arg\text{sort}(s)}
\displaystyle\lim_{\tau\rightarrow 0}\text{SoftSort}_{\tau}^{d}(s)=\mathbf{\Pi%
}_{\arg\text{sort}(s)}
s
\operatorname{\mathbb{R}}
\text{SoftSort}_{\tau}^{d}(s)
\arg\max(\text{SoftSort}_{\tau}^{d}(s))
\arg\text{sort}(s)
80\%/10\%/10\%
10
A^{*}
f^{*}_{i}
\epsilon_{i}
n
\{10,50,100\}
m
\{10,40,50,100,200,400\}
853
11
17
1
500
20
\operatorname{\mathbb{P}}_{\psi}(\mathbf{\Pi})
\operatorname{\mathbb{P}}_{\phi}(\mathbf{U})
f_{i,\psi}
lr\in[1e^{-4},1e^{-2}]
h\in\{8,16,64\}
\operatorname{\mathbb{P}}_{\text{prior}}(U_{ij})\in[1e^{-2},1e^{-1}]
\lambda\in[0,1e^{-1}]
\tau=1
p=10
A
Z
\eta=10
\gamma=\frac{1}{4}
lr\in[1e^{-4},1e^{-2}]
h\in\{8,16,64\}
\eta=10
\gamma=\frac{1}{4}
lr\in[1e^{-4},1e^{-2}]
h\in\{50,100,150,200\}
\lambda_{l_{1}}\in[0,60]
30
\eta=10
\gamma=\frac{1}{4}
lr\in[1e^{-4},1e^{-2}]
h\in\{8,16,64\}
A
\eta=10
\gamma=\frac{1}{4}
lr\in[1e^{-4},1e^{-2}]
h\in\{8,16,64\}
A^{*}
f_{i,\psi}
lr\in[1e^{-4},1e^{-2}]
h\in\{8,16,64\}
p=10
30
10
200
\mathcal{O}(n^{3})
\mathcal{O}(n^{2})
\mathbf{A}
\mathbf{A}^{*}
\mathbf{A}^{*}
10
4
lr\in\{10e^{-1},10e^{-2},10e^{-3},10e^{-4}\}
1.0\pm 0.0
1.0\pm 0.0
0.97\pm 0.02
0.98\pm 0.0
0.95\pm 0.04
0.98\pm 0.03
0.94\pm 0.06
0.95\pm 0.05
0.9\pm 0.1
0.96\pm 0.05
0.92\pm 0.06
0.97\pm 0.03
0.91\pm 0.06
0.95\pm 0.05
0.87\pm 0.04
0.92\pm 0.08
0.95\pm 0.03
0.99\pm 0.01
0.89\pm 0.06
0.94\pm 0.09
0.98\pm 0.03
1.0\pm 0.01
0.92\pm 0.06
0.95\pm 0.06
0.97\pm 0.03
0.98\pm 0.02
0.89\pm 0.1
0.94\pm 0.07
0.96\pm 0.04
0.99\pm 0.02
1.0\pm 0.0
1.0\pm 0.0
0.97\pm 0.0
0.99\pm 0.0
0.96\pm 0.0
0.98\pm 0.0
0.96\pm 0.0
0.97\pm 0.0
0.93\pm 0.01
0.97\pm 0.0
0.94\pm 0.0
0.98\pm 0.0
0.94\pm 0.0
0.97\pm 0.0
0.9\pm 0.0
0.94\pm 0.01
0.96\pm 0.0
0.99\pm 0.0
0.92\pm 0.0
0.95\pm 0.01
0.98\pm 0.0
1.0\pm 0.0
0.95\pm 0.0
0.97\pm 0.0
0.98\pm 0.0
0.99\pm 0.0
0.92\pm 0.01
0.96\pm 0.0
0.97\pm 0.0
0.99\pm 0.0
\mathbf{A}
\mathbf{A}*
10
4
\mathbf{A}
\mathbf{A}*
10
4
10
50
100
\mathbf{A}^{*}
\operatorname{\mathbb{P}}_{\phi}(U_{\pi(i)\pi(j)})>t
A_{ij}>t
t
44.20\pm 1.66
63.55\pm 1.06
18.35\pm 0.9
51.59\pm 1.0
28.22\pm 0.88
54.07\pm 0.63
19.47\pm 0.88
55.41\pm 0.61
\mathbf{91.17}\pm 0.69
\mathbf{96.76}\pm 0.29
\mathbf{89.96}\pm 0.69
\mathbf{97.38}\pm 0.25
44.74\pm 1.77
66.58\pm 1.03
30.23\pm 1.8
62.28\pm 1.03
82.88\pm 1.48
95.00\pm 0.51
62.61\pm 2.84
83.27\pm 1.36
85.31\pm 0.53
55.86\pm 0.69
49.26\pm 0.79
55.76\pm 0.67
83.46\pm 0.29
56.72\pm 0.43
42.86\pm 0.23
51.93\pm 0.43
\mathbf{96.47}\pm 0.14
\mathbf{89.20}\pm 0.38
\mathbf{93.54}\pm 0.39
\mathbf{95.26}\pm 0.34
84.05\pm 0.3
58.94\pm 0.31
48.92\pm 0.42
57.19\pm 0.35
94.59\pm 0.5
86.09\pm 1.07
79.42\pm 0.97
83.93\pm 0.76
16.20\pm 1.03
52.20\pm 0.78
5.52\pm 0.33
51.80\pm 0.6
4.48\pm 0.13
50.32\pm 0.08
2.35\pm 0.09
50.22\pm 0.05
42.97\pm 1.1
71.40\pm 0.7
38.07\pm 0.97
70.27\pm 0.65
11.29\pm 0.46
53.97\pm 0.24
7.66\pm 0.4
53.26\pm 0.22
\mathbf{75.70}\pm 0.8
\mathbf{97.26}\pm 0.12
\mathbf{52.95}\pm 0.95
\mathbf{80.85}\pm 0.46
7.46\pm 0.24
49.14\pm 0.39
2.85\pm 0.16
50.43\pm 0.59
2.12\pm 0.03
50.13\pm 0.09
1.10\pm 0.02
50.12\pm 0.06
19.67\pm 0.58
64.47\pm 0.5
11.63\pm 0.46
60.49\pm 0.38
8.78\pm 0.31
53.46\pm 0.16
7.41\pm 0.32
53.29\pm 0.16
\mathbf{48.38}\pm 0.88
\mathbf{94.46}\pm 0.16
\mathbf{29.34}\pm 0.93
\mathbf{72.93}\pm 0.55
38.91\pm 1.56
46.56\pm 1.56
20.04\pm 0.62
49.83\pm 0.63
24.03\pm 0.87
51.38\pm 0.81
11.78\pm 0.46
50.93\pm 0.39
\mathbf{93.14}\pm 0.75
\mathbf{97.59}\pm 0.28
\mathbf{93.01}\pm 0.77
\mathbf{98.85}\pm 0.14
48.96\pm 1.79
69.21\pm 1.05
39.42\pm 2.22
66.92\pm 1.2
77.26\pm 0.97
93.47\pm 0.4
66.35\pm 1.69
87.05\pm 1.18
7.76\pm 0.26
49.24\pm 0.58
3.36\pm 0.14
49.66\pm 0.52
3.92\pm 0.0
49.83\pm 0.0
1.96\pm 0.0
49.92\pm 0.0
21.82\pm 0.64
64.16\pm 0.51
18.12\pm 0.66
\mathbf{62.78}\pm 0.47
10.39\pm 0.23
53.37\pm 0.12
6.11\pm 0.22
52.33\pm 0.1
\mathbf{46.67}\pm 0.8
\mathbf{80.50}\pm 0.49
\mathbf{23.25}\pm 0.89
60.74\pm 0.7
\mathbf{92.60}\pm 0.17
\mathbf{98.89}\pm 0.0
\mathbf{92.56}\pm 0.17
\mathbf{98.96}\pm 0.0
87.45\pm 0.76
93.51\pm 0.4
86.63\pm 0.81
93.25\pm 0.41
11.34\pm 0.45
53.97\pm 0.24
7.71\pm 0.4
53.27\pm 0.22
90.28\pm 0.46
95.93\pm 0.24
61.13\pm 0.87
85.21\pm 0.38
49.35\pm 0.05
\mathbf{74.45}\pm 0.04
41.35\pm 0.06
\mathbf{73.60}\pm 0.04
49.85\pm 0.66
70.91\pm 0.44
\mathbf{44.78}\pm 0.74
70.78\pm 0.44
17.55\pm 0.14
51.09\pm 0.05
9.14\pm 0.09
50.81\pm 0.04
\mathbf{53.77}\pm 0.36
73.25\pm 0.25
36.54\pm 0.34
68.08\pm 0.2
\mathbf{56.00}\pm 0.0
\mathbf{79.46}\pm 0.0
\mathbf{49.97}\pm 0.0
\mathbf{78.24}\pm 0.0
38.28\pm 0.39
66.95\pm 0.24
35.39\pm 0.4
66.85\pm 0.24
9.03\pm 0.12
50.72\pm 0.06
4.76\pm 0.1
50.55\pm 0.06
44.45\pm 0.61
72.71\pm 0.23
22.32\pm 0.93
64.57\pm 0.39
\mathbf{53.66}\pm 0.16
\mathbf{79.43}\pm 0.0
\mathbf{52.86}\pm 0.16
\mathbf{79.51}\pm 0.0
49.86\pm 0.99
73.96\pm 0.52
47.71\pm 0.99
73.46\pm 0.5
10.39\pm 0.23
53.37\pm 0.12
6.11\pm 0.22
52.33\pm 0.1
50.56\pm 0.96
74.78\pm 0.52
25.41\pm 0.97
65.99\pm 0.54
\mathbf{32.45}\pm 0.13
\mathbf{63.10}\pm 0.04
\mathbf{28.45}\pm 0.13
\mathbf{63.17}\pm 0.04
29.28\pm 0.41
60.11\pm 0.24
24.74\pm 0.44
60.12\pm 0.24
14.39\pm 0.13
51.64\pm 0.06
7.23\pm 0.12
50.97\pm 0.06
30.17\pm 0.29
60.85\pm 0.17
15.78\pm 0.29
57.04\pm 0.17
32.62\pm 0.04
55.07\pm 0.06
18.69\pm 0.03
\mathbf{56.98}\pm 0.02
30.79\pm 0.2
52.07\pm 0.21
16.38\pm 0.2
52.22\pm 0.26
36.98\pm 0.25
55.13\pm 0.15
17.74\pm 0.31
51.71\pm 0.23
\mathbf{40.29}\pm 0.4
\mathbf{59.00}\pm 0.06
\mathbf{19.11}\pm 0.44
54.30\pm 0.33
18.27\pm 0.03
63.16\pm 0.03
7.57\pm 0.01
56.16\pm 0.01
16.30\pm 0.34
54.91\pm 0.21
9.55\pm 0.24
53.77\pm 0.19
17.24\pm 0.4
54.22\pm 0.32
8.78\pm 0.42
52.63\pm 0.38
\mathbf{35.11}\pm 0.91
\mathbf{76.23}\pm 0.68
\mathbf{17.84}\pm 0.98
\mathbf{64.32}\pm 1.05
\mathbf{100.00}\pm 0.0
\mathbf{100.00}\pm 0.0
\mathbf{100.00}\pm 0.0
\mathbf{100.00}\pm 0.0
94.80\pm 0.76
98.68\pm 0.22
86.34\pm 1.92
95.96\pm 0.55
45.56\pm 1.64
66.35\pm 1.02
29.69\pm 1.78
61.96\pm 1.0
88.17\pm 1.07
96.18\pm 0.43
66.17\pm 2.66
87.58\pm 1.0
89.56\pm 0.0
78.09\pm 0.0
79.56\pm 0.0
85.54\pm 0.0
\mathbf{93.79}\pm 0.38
\mathbf{84.43}\pm 0.78
\mathbf{86.00}\pm 0.55
\mathbf{89.28}\pm 0.37
84.00\pm 0.31
58.82\pm 0.32
48.77\pm 0.43
57.06\pm 0.36
93.23\pm 0.46
83.11\pm 0.92
75.98\pm 0.83
80.75\pm 0.62
\mathbf{82.17}\pm 0.0
\mathbf{95.40}\pm 0.0
75.07\pm 0.0
\mathbf{93.43}\pm 0.0
77.87\pm 0.47
90.08\pm 0.28
\mathbf{76.61}\pm 0.53
89.71\pm 0.29
8.78\pm 0.31
53.46\pm 0.16
7.41\pm 0.32
53.29\pm 0.16
79.39\pm 0.57
93.78\pm 0.21
46.11\pm 1.13
80.34\pm 0.37
\mathbf{100.00}\pm 0.0
\mathbf{100.00}\pm 0.0
\mathbf{100.00}\pm 0.0
\mathbf{100.00}\pm 0.0
90.89\pm 1.15
94.44\pm 0.7
86.85\pm 1.36
93.79\pm 0.68
48.07\pm 1.63
68.25\pm 1.0
38.96\pm 1.99
66.48\pm 1.1
83.76\pm 0.89
90.65\pm 0.52
71.25\pm 1.65
85.52\pm 0.81
42.97\pm 1.1
71.40\pm 0.7
38.07\pm 0.97
70.27\pm 0.65
87.45\pm 0.76
93.51\pm 0.4
86.63\pm 0.81
93.25\pm 0.41
75.70\pm 0.8
97.26\pm 0.12
52.95\pm 0.95
80.85\pm 0.46
90.28\pm 0.46
95.93\pm 0.24
61.13\pm 0.87
85.21\pm 0.38
25.11\pm 0.4
56.57\pm 0.35
17.61\pm 0.47
56.35\pm 0.34
49.85\pm 0.66
70.91\pm 0.44
44.78\pm 0.74
70.78\pm 0.44
62.08\pm 0.34
84.53\pm 0.25
41.70\pm 0.39
71.08\pm 0.33
53.77\pm 0.36
73.25\pm 0.25
36.54\pm 0.34
68.08\pm 0.2
9.73\pm 0.11
52.82\pm 0.11
4.42\pm 0.04
51.04\pm 0.06
38.28\pm 0.39
66.95\pm 0.24
35.39\pm 0.4
66.85\pm 0.24
36.98\pm 0.98
77.23\pm 0.63
19.00\pm 1.07
60.35\pm 1.01
44.45\pm 0.61
72.71\pm 0.23
22.32\pm 0.93
64.57\pm 0.39
21.82\pm 0.64
64.16\pm 0.51
18.12\pm 0.66
62.78\pm 0.47
49.86\pm 0.99
73.96\pm 0.52
47.71\pm 0.99
73.46\pm 0.5
46.67\pm 0.8
80.50\pm 0.49
23.25\pm 0.89
60.74\pm 0.7
50.56\pm 0.96
74.78\pm 0.52
25.41\pm 0.97
65.99\pm 0.54
18.75\pm 0.29
54.76\pm 0.17
12.35\pm 0.32
53.31\pm 0.43
29.28\pm 0.41
60.11\pm 0.24
24.74\pm 0.44
60.12\pm 0.24
33.81\pm 0.39
68.18\pm 0.39
17.46\pm 0.34
59.70\pm 0.65
30.17\pm 0.29
60.85\pm 0.17
15.78\pm 0.29
57.04\pm 0.17
34.28\pm 0.32
54.57\pm 0.36
19.95\pm 0.35
55.91\pm 0.33
30.79\pm 0.2
52.07\pm 0.21
16.38\pm 0.2
52.22\pm 0.26
43.37\pm 0.55
59.78\pm 0.62
22.96\pm 0.81
60.02\pm 0.91
40.29\pm 0.4
59.00\pm 0.06
19.11\pm 0.44
54.30\pm 0.33
19.89\pm 0.4
62.29\pm 0.31
15.39\pm 0.44
63.91\pm 0.34
16.30\pm 0.34
54.91\pm 0.21
9.55\pm 0.24
53.77\pm 0.19
26.33\pm 0.56
70.84\pm 0.45
14.17\pm 0.76
59.84\pm 1.46
35.11\pm 0.91
76.23\pm 0.68
17.84\pm 0.98
64.32\pm 1.05
91.17\pm 0.69
96.76\pm 0.29
89.96\pm 0.69
97.38\pm 0.25
94.80\pm 0.76
98.68\pm 0.22
86.34\pm 1.92
95.96\pm 0.55
82.88\pm 1.48
95.00\pm 0.51
62.61\pm 2.84
83.27\pm 1.36
88.17\pm 1.07
96.18\pm 0.43
66.17\pm 2.66
87.58\pm 1.0
96.47\pm 0.14
89.20\pm 0.38
93.54\pm 0.39
95.26\pm 0.34
93.79\pm 0.38
84.43\pm 0.78
86.00\pm 0.55
89.28\pm 0.37
94.59\pm 0.5
86.09\pm 1.07
79.42\pm 0.97
83.93\pm 0.76
93.23\pm 0.46
83.11\pm 0.92
75.98\pm 0.83
80.75\pm 0.62
19.67\pm 0.58
64.47\pm 0.5
11.63\pm 0.46
60.49\pm 0.38
77.87\pm 0.47
90.08\pm 0.28
76.61\pm 0.53
89.71\pm 0.29
48.38\pm 0.88
94.46\pm 0.16
29.34\pm 0.93
72.93\pm 0.55
79.39\pm 0.57
93.78\pm 0.21
46.11\pm 1.13
80.34\pm 0.37
93.14\pm 0.75
97.59\pm 0.28
93.01\pm 0.77
98.85\pm 0.14
90.89\pm 1.15
94.44\pm 0.7
86.85\pm 1.36
93.79\pm 0.68
77.26\pm 0.97
93.47\pm 0.4
66.35\pm 1.69
87.05\pm 1.18
83.76\pm 0.89
90.65\pm 0.52
71.25\pm 1.65
85.52\pm 0.81
5
\times 4
\times 900
2
\times 23
11.91\pm 0.09
14.42\pm 0.42
4.29\pm 0.1
150.54\pm 0.03
22292.7\pm 591.13
667.03\pm 15.59
750.14\pm 8.53
>2
6114.62\pm 495.93
\mathbf{A}^{*}
\tilde{\mathbf{A}}^{*}
\mathbf{A}^{*}
\tilde{\mathbf{A}}^{*}
\mathbf{A}^{*}
\frac{\sum_{ij}S_{ij}\mathbb{1}_{\tilde{A}_{ij}}}{\sum_{ij}S_{ij}\mathbb{1}_{%
\tilde{A}_{ij}^{*}}}
S_{ij}=\operatorname{\mathbb{P}}_{\phi}(U_{\pi(i)\pi(j)})
S_{ij}=A_{ij}
10
\tilde{\mathbf{A}}^{*}
\mathbf{A}^{*}
\tilde{\mathbf{A}}^{*}
\mathbf{A}^{*}
t
\mathbf{A}
A_{i}j=\mathbb{1}_{\operatorname{\mathbb{P}}_{\phi}(U_{ij}|\mathbf{\Pi})>t}
1
1
x_{i}
||\mathbf{X}-\hat{\mathbf{X}}||^{2}_{2}
\hat{X}_{i}=f_{i,\theta}(\mathbf{A}_{i}\circ\mathbf{X})
t
\mathbf{A}
A_{ij}=\mathbb{1}_{\operatorname{\mathbb{P}}_{\phi}(U_{ij}|\mathbf{\Pi})>t}
||\mathbf{X}-\hat{\mathbf{X}}||^{2}_{2}
\hat{X}_{i}=f_{i,\theta}(\mathbf{A}_{i}\circ\mathbf{X})
t
\mathbf{A}
A_{ij}=\mathbb{1}_{\operatorname{\mathbb{P}}_{\phi}(U_{ij}|\mathbf{\Pi})>t}
