\gamma_{1}
\gamma_{2}
\gamma_{1}
\mu
\gamma_{2}
\nu
\gamma_{1}
\gamma_{2}
\eta
\zeta
f
g
\gamma_{1}
\gamma_{2}
\gamma_{1}
\mu
\gamma_{2}
\nu
\gamma_{1}
\gamma_{2}
\eta
\zeta
f
g
\mu,\nu
\mathcal{P}(\mathcal{X})
\mathcal{X}=\mathbb{R}^{d}
c\in\mathcal{C}(\mathcal{X}^{2})
\textup{OT}(\mu,\nu)\vcentcolon=\inf_{\gamma\in\Gamma(\mu,\nu)}\int_{{\mathcal%
{X}}^{2}}c(x,y)\gamma(dx,dy),
\Gamma(\mu,\nu)=\{\gamma\in{\mathcal{M}}_{+}({\mathcal{X}}^{2}),\text{ s.t. }(%
\operatorname{Proj}_{1})_{\sharp}\gamma=\mu,(\operatorname{Proj}_{2})_{\sharp}%
\gamma=\nu\}
{\mathcal{M}}_{+}({\mathcal{X}}^{2})
\mu,\nu
\mu=\sum_{i=1}^{n}u_{i}\delta_{{\mathbf{x}}_{i}}
\nu=\sum_{j=1}^{m}v_{j}\delta_{{\mathbf{y}}_{j}}
\mathbf{u}\in\Sigma_{n},\mathbf{v}\in\Sigma_{m}
\varepsilon\geq 0
\textup{OT}_{\varepsilon}(\mu,\nu)\vcentcolon=\min_{\mathbf{P}\in U({\mathbf{u%
}},{\mathbf{v}})}\langle\mathbf{P},[c({\mathbf{x}}_{i},{\mathbf{y}}_{j})]_{ij}%
\rangle\,-\varepsilon H(\mathbf{P}),
H(\mathbf{P})\vcentcolon=-\sum_{ij}\mathbf{P}_{ij}(\log\mathbf{P}_{ij}-1)
U({\mathbf{u}},{\mathbf{v}})
\{\mathbf{P}\in\mathbb{R}^{n\times m}_{+},\mathbf{P}\mathbf{1}_{m}={\mathbf{u}%
},\mathbf{P}^{\top}\mathbf{1}_{n}={\mathbf{v}}\}
\textup{OT}_{\varepsilon}({\mathbf{u}},{\mathbf{v}},\{{\mathbf{x}}_{i}\},\{{%
\mathbf{y}}_{j}\})
\varepsilon=0
\varepsilon>0
\textup{OT}_{\varepsilon}(\mu,\mu)\neq 0
\mu
\nu
\textup{OT}_{\varepsilon}(\mu,\nu)=\inf_{T:T_{\sharp}\mu=\nu}\int_{\mathcal{X}%
}c(x,T(x))d\mu(x),
\sharp
T^{*}
\mu
\nu
c
c=\|\cdot\|^{2}_{2}
\nabla\psi
\psi:\mathcal{X}\mapsto\mathbb{R}
\nabla\psi_{\sharp}\mu=\nu
T^{*}(x)=\nabla\psi(x)
T
\nabla_{\theta}
\nabla_{\theta}\psi\sharp\mu=\nu
\textup{OT}(\mu,\nu)\vcentcolon=\sup_{\begin{subarray}{c}f,g\in\mathcal{C}(%
\mathcal{X})\\
f\oplus g\leq c\end{subarray}}\int fd\mu+\int gd\nu,
f,g
\mathcal{X}
\mathbb{R}
f\oplus g\mapsto f(x)+g(x)
f,g
\textup{OT}_{\text{n}}(\mu,\nu)=\sup_{f\text{ convex}}\mathop{\mathrm{inf}%
\vphantom{\mathrm{sup}}}_{g\text{ convex}}\underbrace{\frac{1}{2}\mathbb{E}%
\left[\|x\|+\|y\|\right]}_{\mathcal{C}_{\mu,\nu}}-\underbrace{\mathbb{E}_{\mu}%
[f(x)]-\mathbb{E}_{\nu}[\langle y,\nabla g(y)\rangle-f(\nabla g(y))]}_{%
\mathcal{V}_{\mu,\nu}(f,g)}.
f
g
\theta_{f}
\theta_{g}
\nu
\mu
\nabla g_{\theta_{g}\sharp}\mu
\nabla f_{\theta_{f}\sharp}\nu
\mu
\nu
\inf_{\gamma\in\mathcal{M}_{+}({\mathcal{X}}^{2})}\int_{{\mathcal{X}}^{2}}c(x,%
y)\gamma(dx,dy)+\tau_{1}\mathcal{D}_{f_{1}}((\operatorname{Proj}_{1})_{\sharp}%
\gamma\mid\mu)+\tau_{2}\mathcal{D}_{f_{2}}((\operatorname{Proj}_{2})_{\sharp}%
\gamma\mid\nu),
f
D_{f_{1}}
D_{f_{2}}
f_{1},f_{2}
(\tau_{1},\tau_{2})
{\mathbf{u}}
{\mathbf{v}}
\textup{UBOT}({\mathbf{u}},{\mathbf{v}})\vcentcolon=\min_{\Gamma\in\mathbb{R}_%
{+}^{n\times m}}\langle\Gamma,[c(x_{i},y_{j})]_{ij}\rangle+\tau_{1}{\mathcal{D%
}}_{f_{1}}(\Gamma\mathds{1}_{m}\mid{\mathbf{u}})+\tau_{2}{\mathcal{D}}_{f_{2}}%
(\Gamma^{\top}\mathds{1}_{m}\mid{\mathbf{v}})\,-\varepsilon H(\Gamma),
\mu
\nu
\Gamma\left(\mu,\nu\right)\stackrel{{\scriptstyle\text{ def. }}}{{=}}\left\{%
\left(\gamma_{0},\gamma_{1}\right)\in\left(\mathcal{M}_{+}\left({\mathcal{X}}^%
{2}\right)\right)^{2}:\left(\operatorname{Proj}_{1}\right)_{\sharp}\gamma_{0}=%
\mu,\left(\operatorname{Proj}_{2}\right)_{\sharp}\gamma_{1}=\nu\right\}.
C_{k}(\mu,\nu)=\inf_{(\gamma_{0},\gamma_{1})\in\Gamma\left(\mu,\nu\right)}\int
c%
(x,\tfrac{\gamma_{0}}{\gamma},y,\tfrac{\gamma_{1}}{\gamma})\mathop{}\!\mathrm{%
d}\gamma(x,y)
\gamma
\gamma_{0},\gamma_{1}\ll\gamma
\tilde{\mu}
\tilde{\nu}
\mu({\mathcal{X}})=\tilde{\nu}({\mathcal{X}})
\tilde{\mu}
\tilde{\nu}
\mu
\nu
\tilde{\mu},\tilde{\nu}\in\mathcal{M}_{+}(\mathcal{X})
T,S:\mathcal{X}\rightarrow\mathcal{X}
\tilde{\mu}=\eta\cdot\mu,\quad\tilde{\nu}=\zeta\cdot\nu,\quad T_{\sharp}\tilde%
{\mu}=\tilde{\nu},\quad S_{\sharp}\tilde{\nu}=\tilde{\mu},
\eta,\zeta:{\mathcal{X}}\rightarrow\mathbb{R}^{+}
\eta\cdot\mu
\eta(x)\mathop{}\!\mathrm{d}\mu(x)
\zeta\cdot\nu)
T,S
\tilde{\mu}
\tilde{\nu}
\eta,\zeta
\eta,\zeta
T,S
\eta
T
T_{\sharp}(\eta\cdot\mu)=T_{\sharp}\tilde{\mu}
\nu
\pi_{\textup{UB}}^{*}(\alpha,\beta)\stackrel{{\scriptstyle\mathclap{\tiny\mbox%
{def.}}}}{{=}}\operatorname*{argmin}_{\pi}\textup{UBOT}(\pi;\alpha,\beta)
T
w
(\operatorname{Proj}_{1})_{\sharp}[\pi_{\textup{UB}}^{*}(T_{\sharp}(\eta\cdot%
\mu),\nu)]=T_{\sharp}(\eta\cdot\mu)
\mathbf{e}
\sum_{j=1}^{m}[\Gamma]_{ij}=\mathbf{e}\odot\mathbf{u},\quad\text{where}%
\medspace\Gamma=\operatorname*{argmin}\textup{UBOT}(\mathbf{e}\odot\mathbf{u},%
T({\mathbf{x}}_{i}),\mathbf{v},{\mathbf{y}}_{j}).
T
{\mathbf{e}}^{*}
\Gamma\leftarrow\textup{UBOT}(\mathbf{u},T({\mathbf{x}}_{i}),\mathbf{v},{%
\mathbf{y}}_{j});\qquad\mathbf{e}\leftarrow\Gamma\mathds{1}\oslash\mathbf{u};
{\mathbf{e}}^{*}
\mathbf{u}
\mathbf{v}
S
\zeta
(\operatorname{Proj}_{2})_{\sharp}[\pi_{\textup{UB}}^{*}(S_{\sharp}(\zeta\cdot%
\nu),\mu)]=S_{\sharp}(\zeta\cdot\nu)
\Gamma\leftarrow\textup{UBOT}(\mathbf{v},S({\mathbf{y}}_{j}),\mathbf{u},{%
\mathbf{x}}_{i});\qquad\mathbf{z}\leftarrow\Gamma\mathds{1}\oslash\mathbf{v};
\mathbf{e},\mathbf{z}
\eta,\zeta
\eta({\mathbf{x}}_{i})\approx e_{i}\medspace\forall i\in\{1,\dots,n\}
\zeta({\mathbf{y}}_{j})\approx z_{j}\medspace\forall j\in\{1,\dots,m\}
\eta,\zeta
T
S
\tilde{\mu}
\tilde{\nu}
T=\nabla g
S=\nabla f
f
g
\theta_{f}
\theta_{g}
\displaystyle\mathcal{L}(f,g)=\operatorname*{\mathbb{E}}_{x\sim\tilde{\mu}}%
\left[f(\nabla g)-\langle x,\nabla g(x)\rangle\right]-\operatorname*{\mathbb{E%
}}_{y\sim\tilde{\nu}}\left[f(y)\right]
\displaystyle\mathcal{L}(f,g)
\displaystyle=\operatorname*{\mathbb{E}}_{x\sim\tilde{\mu}}\left[f(\nabla g)-%
\langle x,\nabla g(x)\rangle\right]-\operatorname*{\mathbb{E}}_{y\sim\tilde{%
\nu}}\left[f(y)\right]
\displaystyle=\int_{\mathcal{X}}\bigl{[}f(\nabla g(x))-\langle x,\nabla g(x)%
\rangle\bigr{]}\eta(x)\mathop{}\!\mathrm{d}\mu(x)-\int f(y)\zeta(y)\mathop{}\!%
\mathrm{d}\nu(y).
\displaystyle=\int_{\mathcal{X}}\bigl{[}f(\nabla g(x))-\langle x,\nabla g(x)%
\rangle\bigr{]}\eta(x)\mathop{}\!\mathrm{d}\mu(x)-\int f(y)\zeta(y)\mathop{}\!%
\mathrm{d}\nu(y).
\mathcal{L}(f,g)=\frac{1}{n}\sum_{i=1}^{n}e_{i}\left[f(\nabla g({\mathbf{x}}_{%
i}))-\langle{\mathbf{x}}_{i},\nabla g({\mathbf{x}}_{i})\rangle\right]-\sum_{j=%
1}^{m}z_{j}f({\mathbf{y}}_{j}).\vspace{-0.2cm}
f,g,\eta,\zeta
{\mathbf{x}}
u
({\mathbf{x}},u)\mapsto(\nabla g({\mathbf{x}}),\eta({\mathbf{x}})\cdot u\cdot%
\zeta(\nabla g({\mathbf{x}}))^{-1})
({\mathbf{y}},v)\mapsto(\nabla f({\mathbf{y}}),\zeta({\mathbf{y}})\cdot v\cdot%
\eta(\nabla f({\mathbf{y}}))^{-1})
\tilde{\Gamma}_{1}\stackrel{{\scriptstyle\mathclap{\tiny\mbox{def.}}}}{{=}}%
\textup{diag}({\mathbf{e}}^{-1})^{\top}\Gamma_{1}
\tilde{\Gamma}_{2}\stackrel{{\scriptstyle\mathclap{\tiny\mbox{def.}}}}{{=}}%
\textup{diag}({\mathbf{z}}^{-1})^{\top}\Gamma_{2}
\Gamma_{1},\Gamma_{2}
(\tilde{\Gamma}_{1},\tilde{\Gamma}_{2}^{\top})
\mu
\nu
f,g
\nabla g(x)\approx x
\nabla f(y)\approx y
\eta,\zeta
\{x_{i}\}_{i=1}^{n}\sim\mu
\{y_{j}\}_{j=1}^{m}\sim\nu
\hat{y}\leftarrow\nabla g(x)
\hat{x}\leftarrow\nabla f(y)
\Gamma_{1}\leftarrow\texttt{unbalanced.sinkhorn}(\hat{y},\tfrac{1}{n}\mathds{1%
}_{n},y,\tfrac{1}{m}\mathds{1}_{m})
e_{i}\leftarrow\frac{\sum_{j}\Gamma_{ij}}{\sum_{ij}\Gamma_{ij}}\cdot n
\Gamma_{2}\leftarrow\texttt{unbalanced.sinkhorn}(\hat{x},\tfrac{1}{m}\mathds{1%
}_{m},y,\tfrac{1}{n}\mathds{1}_{n})
z_{i}\leftarrow\frac{\sum_{j}\Gamma_{ij}}{\sum_{ij}\Gamma_{ij}}\cdot m
J(\theta_{g},\theta_{f})=\frac{1}{n}\sum_{i=1}^{n}e_{i}\left[f(\nabla g(x_{i})%
)-\langle x_{i},\nabla g(x_{i})\rangle\right]-\frac{1}{m}\sum_{j=1}^{m}z_{j}f(%
y_{j})
L_{\eta}(\theta_{\eta})=
(\mathbf{e},\eta(x))
L_{\zeta}(\theta_{\zeta})=
(\mathbf{z},\zeta(y))
\theta_{g}
J
\theta_{\eta}
L_{\eta}
\theta_{\zeta}
L_{\zeta}
\theta_{f}
J
\mu
\nu
\mu
\nu
T
\eta
\zeta
t=0h
t=8h
t=24h
\mu
t=0h
\nu
t=8h
t=24h
\geq 1
\leq 1
\geq 1
\leq 1
{\mathcal{D}}_{f}
{\mathcal{D}}_{f}=\ell_{2}
\ell_{1}
x\in{\mathcal{X}}
y\in{\mathcal{Y}}
g:{\mathcal{X}}\mapsto{\mathcal{Y}}
f:{\mathcal{Y}}\mapsto{\mathcal{X}}
\|x-f(g(x))\|
\|y-g(f(y))\|
\|\cdot\|
g=f^{-1}
f=g^{-1}
{\mathcal{X}}
{\mathcal{Y}}
f:{\mathcal{X}}\mapsto{\mathcal{Y}}
g:{\mathcal{Y}}\mapsto{\mathcal{X}}
\mathrm{GM}(\mu,\nu):=\inf_{\begin{subarray}{c}f:{\mathcal{X}}\mapsto{\mathcal%
{Y}},f_{\sharp}\mu=\nu\\
g:{\mathcal{Y}}\mapsto{\mathcal{X}},g_{\sharp}\nu=\mu\end{subarray}}\Delta_{{%
\mathcal{X}}}^{p}(f;\mu)+\Delta_{{\mathcal{Y}}}^{p}(g;\nu)+\Delta_{{\mathcal{X%
}},{\mathcal{Y}}}^{p}(f,g;\mu,\nu),
\displaystyle\Delta_{{\mathcal{X}}}^{p}(f;\mu)=\left(\mathbb{E}\left[|c_{%
\mathcal{X}}(x,x^{\prime})-c_{\mathcal{Y}}(f(x),f(x^{\prime}))|^{p}\right]%
\right)^{\frac{1}{p}}
\displaystyle\Delta_{{\mathcal{X}}}^{p}(f;\mu)
\displaystyle=\left(\mathbb{E}\left[|c_{\mathcal{X}}(x,x^{\prime})-c_{\mathcal%
{Y}}(f(x),f(x^{\prime}))|^{p}\right]\right)^{\frac{1}{p}}
\displaystyle\Delta_{{\mathcal{Y}}}^{p}(g;\nu)=\left(\mathbb{E}\left[|c_{%
\mathcal{X}}(y,y^{\prime})-c_{\mathcal{Y}}(g(y),g(y^{\prime}))|^{p}\right]%
\right)^{\frac{1}{p}}
\displaystyle\Delta_{{\mathcal{Y}}}^{p}(g;\nu)
\displaystyle=\left(\mathbb{E}\left[|c_{\mathcal{X}}(y,y^{\prime})-c_{\mathcal%
{Y}}(g(y),g(y^{\prime}))|^{p}\right]\right)^{\frac{1}{p}}
\displaystyle\Delta_{{\mathcal{X}},{\mathcal{Y}}}^{p}(f,g;\mu,\nu)=\left(%
\mathbb{E}\left[|c_{\mathcal{X}}(x,g(y))-c_{\mathcal{Y}}(f(x),y)|^{p}\right]%
\right)^{\frac{1}{p}}.
\displaystyle\Delta_{{\mathcal{X}},{\mathcal{Y}}}^{p}(f,g;\mu,\nu)
\displaystyle=\left(\mathbb{E}\left[|c_{\mathcal{X}}(x,g(y))-c_{\mathcal{Y}}(f%
(x),y)|^{p}\right]\right)^{\frac{1}{p}}.
\Delta_{{\mathcal{X}},{\mathcal{Y}}}^{p}
f,g
\mu
\nu
n
m
\psi
\theta
\psi_{\theta}(x)
x
\theta
L
l=\{0,...,L-1\}
z_{l+1}=\sigma_{l}(W^{x}_{l}x+W^{z}_{l}z_{l}+b_{l})\text{ and }\psi_{\theta}(x%
)=z_{L},
\sigma_{k}
\theta=\{W^{x}_{l},W^{z}_{l},b_{l}\}_{l=0}^{L-1}
W^{z}_{l}
z_{0}
W^{z}_{0}
0
T
\psi
\nabla\psi
T
\mu
\nu
p
q
q/p
t=24h
t=24h
t=8h
t=24h
t=24h
t=8h
t=24h
t=24h
t=8h
t=24h
t=8h
t=24h
\mu
\nu
T
\mu
\nu
T
log1p
x\leftarrow log(x+1)
t=8h
t=8h
t=8h
t=24h
t=8h
t=24h
t=24h
t=24h
\eta
\zeta
f
g
f
g
h
T_{\sharp}\mu=\nu
\displaystyle\sup_{h}\inf_{T}\int_{{\mathcal{X}}}c(x,T(x))\mu(x)dx+\int_{{%
\mathcal{X}}}h(y)\left(\nu-T_{\sharp}\mu\right)dy
\displaystyle\sup_{h}\inf_{T}
\displaystyle\int_{{\mathcal{X}}}c(x,T(x))\mu(x)dx+\int_{{\mathcal{X}}}h(y)%
\left(\nu-T_{\sharp}\mu\right)dy
\displaystyle=\int_{{\mathcal{X}}}[c(x,T(x))-h(T(x))]\mu(x)dx+\int_{{\mathcal{%
X}}}h(y)\nu(y)dy,
\displaystyle=
\displaystyle\int_{{\mathcal{X}}}[c(x,T(x))-h(T(x))]\mu(x)dx+\int_{{\mathcal{X%
}}}h(y)\nu(y)dy,
T
h
\xi:\mathcal{X}\rightarrow\mathbb{R}^{+}
x_{i}
c_{1}:\mathcal{X}\times\mathcal{Y}\rightarrow\mathbb{R}^{+}
c_{2}:\mathbb{R}^{+}\rightarrow\mathbb{R}^{+}
T_{\theta}
\xi_{\phi}
h_{\omega}
l(\theta,\phi,\omega)\coloneqq\frac{1}{n}\sum_{i=0}^{n}\left[c_{1}(x_{i},T_{%
\theta}(x_{i}))\xi_{\phi}(x_{i})+c_{2}(\xi_{\phi}(x_{i}))+\xi_{\phi}(x_{i})h_{%
\omega}(T_{\theta}(x_{i})-\Psi^{*}(h_{\omega}(y_{i})\right],
\Psi^{*}
f
g
\nabla g
\nabla f
g
W^{z}_{l}
R\left(\theta\right)=\lambda\sum_{W^{z}_{l}\in\theta}\left\|\max\left(-W^{z}_{%
l},0\right)\right\|_{F}^{2}.
f
W^{z}_{l}\in\theta_{f}
g
f
\eta
\zeta
\varepsilon=0.005
0.05
g
f
\eta
\zeta
10^{-4}
10^{-3}
\beta_{1}=0.5
\beta_{2}=0.9
