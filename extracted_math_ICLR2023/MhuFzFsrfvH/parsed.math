s_{1}^{e}
a_{2}^{e}
s_{2}^{e}
a_{2}^{e}
\cdots
s_{T}^{e}
s_{1}
a_{2}
s_{2}
a_{2}
\cdots
s_{T}
r_{1}
r_{2}
\cdots
r_{T}
(demo.north)!.5!(expert_{1}.north)
(unlabeled.north)!.5!(episode_{1}.north)
r_{i}
r_{i}
\mathcal{D}=\{(s^{i}_{t},a^{i}_{t},r^{i}_{t},s^{i}_{t+1})\}_{i=1}^{N}
(s^{i}_{t},a^{i}_{t},r^{i}_{t},s^{i}_{t+1})
r^{i}_{t}
(\mathcal{S},\mathcal{A},p,r,\gamma,p_{0},T)
\mathcal{S}
\mathcal{A}
p
r
\gamma
p_{0}
T
\pi
\pi
(s_{1},a_{1},s_{2},a_{2},\dots,s_{T})=:\tau
\tau=(s_{1},a_{1},s_{2},a_{2},\dots,s_{T})
a_{t}
t=1,\ldots,T-1
\mathcal{D}^{e}=\{\tau_{e}^{(n)}\}_{n=1}^{N}
\pi_{e}
\mathcal{D}^{u}=\{\tau_{\beta}^{(m)}\}_{m=1}^{M}
\pi_{\beta}
\pi
\mu_{x}=\frac{1}{T}\sum^{T}_{t=1}\delta_{x_{t}}
\mu_{y}=\frac{1}{T^{\prime}}\sum^{T^{\prime}}_{t=1}\delta_{y_{t}}
\mathcal{W}^{2}(\mu_{x},\mu_{y})=\min_{\mu\in M}\sum_{t=1}^{T}\sum_{t^{\prime}%
=1}^{T^{\prime}}c(x_{t},y_{t^{\prime}})\mu_{t,t^{\prime}},
M=\{\mu\in\mathbb{R}^{T\times T^{\prime}}:\mu\mathbf{1}=\frac{1}{T}\mathbf{1},%
\mu^{T}\mathbf{1}=\frac{1}{T^{\prime}}\mathbf{1}\}
c
\delta_{x}
x
\mu^{*}
\mu_{x}
\mu_{y}
\hat{p}_{e}=\frac{1}{T^{\prime}}\sum^{T^{\prime}}_{t=1}\delta_{s_{t}^{e}}
\hat{p}_{\pi}=\frac{1}{T}\sum^{T}_{t=1}\delta_{s_{t}^{\pi}}
\pi_{e}
\pi
\mathcal{W}^{2}(\hat{p}_{\pi},\hat{p}_{e})=\min_{\mu\in M}\sum_{t=1}^{T}\sum_{%
t^{\prime}=1}^{T^{\prime}}c(s_{t}^{\pi},s^{e}_{t^{\prime}})\mu_{t,t^{\prime}}
\mu^{*}
r_{\text{ot}}(s_{t}^{\pi})=-\sum_{t^{\prime}=1}^{T^{\prime}}c(s_{t}^{\pi},s_{t%
^{\prime}}^{e})\mu^{*}_{t,t^{\prime}},
\pi
|\mathcal{S}|=2
\hat{p}_{e}
\{s_{t^{\prime}}^{e}\}_{t^{\prime}=1}^{T^{\prime}}
{\circ}
\hat{p}_{\pi}
\{s_{t}^{\pi}\}_{t=1}^{T}
{\color[rgb]{0.35,0.87,1}\bullet}
r_{\text{ot}}
C
\mu
\hat{p}_{\pi}
\hat{p}_{e}
s_{t}^{\pi}
r_{\text{ot}}(s_{t}^{\pi})=-C_{t}^{T}\mu^{*}_{t}
s_{t}^{\pi}\in\hat{p}_{\pi}
C_{t}
s_{t}^{\pi}
\{s_{t^{\prime}}^{e}\}_{t^{\prime}=1}^{T^{\prime}}
\mu^{*}_{t}
s_{t}^{\pi}
s^{e}_{3}
s^{e}_{4}
|\mathcal{S}|=2
\hat{p}_{e}
\{s_{t^{\prime}}^{e}\}_{t^{\prime}=1}^{T^{\prime}}
{\circ}
\hat{p}_{\pi}
\{s_{t}^{\pi}\}_{t=1}^{T}
{\color[rgb]{0.35,0.87,1}\bullet}
r_{\text{ot}}
C
\mu
\hat{p}_{\pi}
\hat{p}_{e}
s_{t}^{\pi}
r_{\text{ot}}(s_{t}^{\pi})=-C_{t}^{T}\mu^{*}_{t}
s_{t}^{\pi}\in\hat{p}_{\pi}
C_{t}
s_{t}^{\pi}
\{s_{t^{\prime}}^{e}\}_{t^{\prime}=1}^{T^{\prime}}
\mu^{*}_{t}
s_{t}^{\pi}
s^{e}_{3}
s^{e}_{4}
\mathcal{D}^{u}
\mathcal{D}^{e}
\mathcal{D}^{\text{label}}
\mathcal{D}^{\text{label}}\leftarrow\emptyset
\tau^{(m)}
\mathcal{D}^{u}
C^{(m)},\mu^{*(m)}\leftarrow\SolveOT(\mathcal{D}^{e},\tau^{(m)})
t
1
T
r_{\text{OT}}(s^{(m)}_{t})\leftarrow-\sum_{t^{\prime}=1}^{T^{\prime}}C^{(m)}_{%
t,t^{\prime}}\mu^{*(m)}_{t,t^{\prime}}
\mathcal{D}^{\text{label}}\leftarrow\mathcal{D}^{\text{label}}\cup(s_{1}^{(m)}%
,a_{1}^{(m)},r_{1}^{\text{OT}},\dots,s_{T}^{(m)})
\mathcal{D}^{\text{label}}
\mathcal{D}^{u}
\mathcal{D}^{e}
\tau^{(m)}\in\mathcal{D}^{u}
C^{(m)}
\mu^{*(m)}
\mathcal{D}^{\text{label}}
\mu^{*}
Q
s(r)=\alpha\exp(\beta r)
1000
1000
1
1
1000
1000
20
Q
10
10
K=1
K=10
500
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K=1
\pm
K=1
\pm
10
2
K=1
K=10
K=1
K=10
K=1
K=10
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\frac{1000}{\text{max\_return}-\text{min\_return}}
2
1
0.99
(256,256)
3e^{-4}
0
3e^{-4}
3e^{-4}
5e^{-3}
T
1000
s(r)=5.0\cdot\exp(5.0\cdot T\cdot r/|\mathcal{A}|)
s(r)=5.0\cdot\exp(T\cdot r)
K
K=1
K=10
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K=1
K=10
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K=1
K=10
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha=\beta=5
\alpha=\beta=1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha=\beta=1
