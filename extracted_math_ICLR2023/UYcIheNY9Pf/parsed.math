V
Q
V
V
V
V
Q
Q
V
Q
Q
V
V
M
(\mathcal{S},\mathcal{A},P,r,\gamma)
S
A
P(\cdot|s,a):\mathcal{S}\times\mathcal{A}\times\mathcal{S}\to\mathbb{R}
r(s,a):\mathcal{S}\times\mathcal{A}\to\mathbb{R}
\gamma\in[0,1)
P(\cdot|s,a)=\delta(s^{\prime})
s^{\prime}
\delta(\cdot)
\pi:\mathcal{S}\times\mathcal{A}\to\mathbb{R}
\mathcal{J}(\pi)=\mathbb{E}_{s_{0}\sim\rho_{0},a_{t}\sim\pi(\cdot|s_{t}),s_{t+%
1}\sim P(\cdot|s_{t},a_{t})}\left[\sum_{t=0}^{\infty}\gamma^{t}r(s_{t},a_{t})\right]
\rho_{0}
Q
V
Q
Q
V
V^{\mu}(s)
\mathcal{D}
V
V
\max_{\phi}\mathcal{J}_{\pi}(\phi)=\mathbb{E}_{(s_{t},a_{t})\sim\mathcal{D}}%
\left[\log\pi_{\phi}(a_{t}\mid s_{t})\exp{\left(R_{t}-V^{\mu}(s_{t})\right)}%
\right].
V
V
(\mathcal{T}^{\mu}_{\tau}V)(s)\coloneqq\operatorname*{arg\,min}_{v}\mathbb{E}_%
{a\sim\mu(\cdot\mid s)}{\left[\tau[\delta]^{2}_{+}+(1-\tau)[-\delta]^{2}_{+}%
\right]}
\mu
\delta=\mathbb{E}_{s^{\prime}\sim P(\cdot\mid s,a)}{\left[r(s,a)+\gamma V(s^{%
\prime})-v\right]}
[\cdot]_{+}=\max(\cdot,0)
\tau=1/2
\tau\rightarrow 1
V^{*}
\tau
\tau
\tau
({(\mathcal{T}_{g})}_{\tau}^{\mu}V)(s)=V(s)+2\alpha\mathbb{E}_{a\sim\mu(\cdot%
\mid s)}\left[\tau\left[\delta(s,a)\right]_{+}+(1-\tau)[\delta(s,a)]_{-}\right],
\alpha
{\mathcal{T}}_{\tau}^{\mu}
{(\mathcal{T}_{g})}_{\tau}^{\mu}
V
\displaystyle\mathcal{J}_{V}(\theta)=\mathbb{E}_{(s_{t},a_{t},s_{t+1})\sim%
\mathcal{D}}\left[\left(\hat{V}(s_{t})-V_{\theta}\left(s_{t}\right)\right)^{2}%
\right],
\displaystyle\mathcal{J}_{V}(\theta)
\displaystyle=\mathbb{E}_{(s_{t},a_{t},s_{t+1})\sim\mathcal{D}}\left[\left(%
\hat{V}(s_{t})-V_{\theta}\left(s_{t}\right)\right)^{2}\right],
\displaystyle\hat{V}(s)=V_{\theta^{\prime}}(s)+2\alpha\left[\tau\left[\delta(s%
,a,s^{\prime})\right]_{+}+(1-\tau)[\delta(s,a,s^{\prime})]_{-}\right],
\displaystyle\hat{V}(s)
\displaystyle=V_{\theta^{\prime}}(s)+2\alpha\left[\tau\left[\delta(s,a,s^{%
\prime})\right]_{+}+(1-\tau)[\delta(s,a,s^{\prime})]_{-}\right],
\hat{V}
\delta(s,a,s^{\prime})=r(s,a)+\gamma V_{\theta^{\prime}}(s^{\prime})-V_{\theta%
^{\prime}}(s)
V
\hat{V}
\theta
\theta^{\prime}
\gamma_{\tau}=1-2(1-\gamma)\alpha\max\{\tau,1-\tau\}
V
Q
\hat{V}
\displaystyle\hat{R}_{t}=\begin{cases}r_{t}+\gamma\max(\hat{R}_{t+1},\hat{V}(s%
_{t+1}))&\text{if}\quad t<T,\\
r_{t}&\text{if}\quad t=T,\end{cases}
\displaystyle\hat{R}_{t}
\displaystyle=\begin{cases}r_{t}+\gamma\max(\hat{R}_{t+1},\hat{V}(s_{t+1}))&%
\text{if}\quad t<T,\\
r_{t}&\text{if}\quad t=T,\end{cases}
t
T
\hat{V}
\displaystyle\hat{R}_{t}=\max_{0<n\leq n_{\rm max}}\hat{V}_{t,n},\quad\hat{V}_%
{t,n}=\begin{cases}r_{t}+\gamma\hat{V}_{t+1,n-1}&\text{if}\quad n>0,\\
\hat{V}(s_{t})&\text{if}\quad n=0,\end{cases}
\displaystyle\hat{R}_{t}=\max_{0<n\leq n_{\rm max}}\hat{V}_{t,n},\quad\hat{V}_%
{t,n}=\begin{cases}r_{t}+\gamma\hat{V}_{t+1,n-1}&\text{if}\quad n>0,\\
\hat{V}(s_{t})&\text{if}\quad n=0,\end{cases}
n
\hat{V}_{t,n}=0
n>T
\hat{R}_{t}
\max_{\phi}\mathcal{J}_{\pi}(\phi)=\mathbb{E}_{(s_{t},a_{t})\sim\mathcal{D}}%
\left[\log\pi_{\phi}(a_{t}\mid s_{t})\cdot f\left(\hat{A}(s_{t},a_{t})\right)%
\right],
\hat{A}(s_{t},a_{t})=\hat{R}_{t}-\hat{V}(s_{t})
f
\hat{R}_{t}
\hat{V}_{t}
V
\mathcal{T}_{\tau}^{\mu}
\tau\in[0,1)
\mathcal{T}_{\tau}^{\mu}
\gamma_{\tau}
\gamma_{\tau}=1-2\alpha(1-\gamma)\min\{\tau,1-\tau\}
(\mathcal{T}_{+}^{\mu}V)(s)=V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]_{+},(%
\mathcal{T}_{-}^{\mu}V)(s)=V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]_{-}.
\|\mathcal{T}_{+}^{\mu}V_{1}-\mathcal{T}_{+}^{\mu}V_{2}\|_{\infty}\leq\|V_{1}-%
V_{2}\|_{\infty}
\mathcal{T}_{\tau}^{\mu}
\mathcal{T}_{+}^{\mu}
\mathcal{T}_{-}^{\mu}
\mathcal{T}_{\tau}^{\mu}
\gamma_{\tau}
\alpha
\tau
\alpha
\alpha
\alpha
V(s)+2\alpha\tau\delta(s,a)\leq\max\{r(s,a)+\gamma V(s^{\prime}),V(s)\}
V(s)+2\alpha(1-\tau)\delta(s,a)\geq\min\{r(s,a)+\gamma V(s^{\prime}),V(s)\}
V
2\alpha\tau\leq 1
2\alpha(1-\tau)\leq 1
\alpha\leq\frac{1}{2\max\{\tau,1-\tau\}}
\alpha=\frac{1}{2\max\{\tau,1-\tau\}}
\gamma_{\tau}=1-2\alpha\min\{\tau,1-\tau\}(1-\gamma)=1-\frac{\min\{\tau,1-\tau%
\}}{\max\{\tau,1-\tau\}}(1-\gamma)
\tau
\gamma_{\tau}
\tau\to 0
\tau\to 1
\tau
\tau
\tau=1
V
\mathcal{T}_{\tau}^{\mu}
\tau
\tau,\tau^{\prime}\in(0,1)
\tau^{\prime}\geq\tau
\mathcal{T}_{\tau^{\prime}}^{\mu}V(s)\geq\mathcal{T}_{\tau}^{\mu}V(s),\forall s\in
S
V_{\tau}^{*}
\tau
V_{\tau}^{*}
\mathcal{T}_{\tau}^{\mu}
\tau,\tau^{\prime}\in(0,1)
\tau^{\prime}\geq\tau
V_{\tau^{\prime}}^{*}(s)\geq V_{\tau}^{*}(s)
\forall s\in S
V_{\tau}^{*}
V^{*}
\tau
V^{*}
\mathcal{T}^{*}
\lim_{\tau\to 1}V_{\tau}^{*}=V^{*}
\tau
\tau
V_{\tau}^{*}
V^{*}
\gamma_{\tau}
n_{\rm max}
n_{\rm max}
\tau
\tau\in\{0.6,0.7,0.8,0.9\}
n_{\rm max}
n_{\rm max}
1,2,3,4
\mu
\mu(s)=\text{softmax}(Q^{*}(s,\cdot)/\alpha)
\alpha
0.1,0.3,1,3
\tau
\tau\in\{0.6,0.7,0.8,0.9\}
n_{\rm max}
n_{\rm max}
1,2,3,4
\mu
\mu(s)=\text{softmax}(Q^{*}(s,\cdot)/\alpha)
\alpha
0.1,0.3,1,3
(\mathcal{T}_{\rm vem}V)(s)=\max_{1\leq n\leq n_{\rm max}}\{(\mathcal{T}^{\mu}%
)^{n-1}\mathcal{T}_{\tau}^{\mu}V(s)\},
n_{\rm max}
\mathcal{T}_{\rm vem}
\mathcal{T}_{\tau}^{\mu}
\tau\in(0,1)
n_{\rm max}\in\mathbb{N}^{+}
\mathcal{T}_{\rm vem}
\gamma_{\tau}
\tau>\frac{1}{2}
\mathcal{T}_{\rm vem}
\mathcal{T}_{\tau}^{\mu}
\mathcal{T}_{\rm vem}
\mathcal{T}_{\rm vem}
\mathcal{T}_{\tau}^{\mu}
\mu
V(s)
\mathcal{T}_{\rm vem}
|\mathcal{T}_{\rm vem}V(s)-V_{\tau}^{*}(s)|\leq\gamma^{n^{*}(s)-1}\gamma_{\tau%
}\|V-V_{n^{*},\tau}^{\mu}\|_{\infty}+\|V_{n^{*},\tau}^{\mu}-V_{\tau}^{*}\|_{%
\infty},\forall s\in S,
n^{*}(s)=\operatorname*{arg\,max}_{0<n\leq n_{\rm max}}\{(\mathcal{T}^{\mu})^{%
n-1}\mathcal{T}_{\tau}^{\mu}V(s)\}
V_{n^{*},\tau}^{\mu}
(\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}
s
\mathcal{T}_{\rm vem}
\mu
V_{n^{*},\tau}^{\mu}
V_{\tau}^{*}
\gamma^{n^{*}(s)-1}\gamma_{\tau}
n^{*}(s)\approx n_{\rm max}
V_{\tau}^{*}
\mu
n^{*}(s)\approx 1
V_{\tau}^{*}
n_{\rm max}
n_{\rm max}
n_{\rm max}
\tau
\sup_{V\neq V^{\prime}}\|\mathcal{T}_{\rm vem}V-\mathcal{T}_{\rm vem}V^{\prime%
}\|_{\infty}/\|V-V^{\prime}\|_{\infty}
\|V_{\rm vem}^{*}-V^{*}\|_{\infty}
\mathbb{E}\left[\|\hat{\mathcal{T}}V-\mathcal{T}_{\rm vem}V\|_{2}^{2}\right]^{%
\frac{1}{2}}
\hat{\mathcal{T}}_{\rm vem}
\mathcal{T}_{\rm vem}
V_{\rm vem}^{*}
\mathcal{T}_{\rm vem}
n
\tau
n
\tau
n
\tau
V
V
\tau
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
V
Q
\tau\in\{0.1,0.2,...,0.9\}
\tau
\tau
\tau
\tau=0.9
\tau
\tau
10^{13}
10^{13}
n
n
n
V
V_{\theta_{1}},V_{\theta_{2}}
\pi_{\phi}
\theta_{1},\theta_{2},\phi
\theta_{1}^{\prime}\leftarrow\theta_{1},\theta_{2}^{\prime}\leftarrow\theta_{2}
\mathcal{M}
t=1
T
i\in\{1,2\}
N
\left(s_{t},a_{t},r_{t},s_{t},R_{t}^{(i)}\right)
\mathcal{M}
\theta_{i}\leftarrow\text{min}_{\theta_{i}}N^{-1}\sum\left(R_{t}^{(i)}-V_{%
\theta_{i}}(s_{t})\right)^{2}
\phi\leftarrow\text{max}_{\phi}N^{-1}\sum\nabla\log\pi_{\phi}(a_{t}|s_{t})%
\cdot f\left(\text{min}_{i}R_{t}^{(i)}-\text{mean}_{i}V_{\theta_{i}}(s_{t})\right)
t\text{ mod }u
\theta_{i}^{\prime}\leftarrow\kappa\theta_{i}+(1-\kappa)\theta_{i}^{\prime}
\tau
\mathcal{M}
s_{t},a_{t},r_{t},s_{t+1}
\text{reversed}(\tau)
i\in\{1,2\}
R_{t}^{(i)}
\mathcal{M}
\operatorname{ER}(q;\varrho,\tau)=\mathbb{E}_{Z\sim\varrho}\left[\left[\tau%
\mathbb{I}_{Z>q}+(1-\tau)\mathbb{I}_{Z\leq q}\right](Z-q)^{2}\right],
\varrho
\tau
\varrho
\displaystyle\mathcal{J}_{V}(\theta)=\mathbb{E}_{\mu}\left[\tau(r(s,a)+\gamma V%
_{\theta^{\prime}}(s^{\prime})-V_{\theta}(s))_{+}^{2}+(1-\tau)(r(s,a)+\gamma V%
_{\theta^{\prime}}(s^{\prime})-V_{\theta}(s))_{-}^{2}\right]
\displaystyle\mathcal{J}_{V}(\theta)
\displaystyle=\mathbb{E}_{\mu}\left[\tau(r(s,a)+\gamma V_{\theta^{\prime}}(s^{%
\prime})-V_{\theta}(s))_{+}^{2}+(1-\tau)(r(s,a)+\gamma V_{\theta^{\prime}}(s^{%
\prime})-V_{\theta}(s))_{-}^{2}\right]
\displaystyle=\mathbb{E}_{\mu}\left[\tau(y-V_{\theta}(s))_{+}^{2}+(1-\tau)(y-V%
_{\theta}(s))_{-}^{2}\right].
\displaystyle=\mathbb{E}_{\mu}\left[\tau(y-V_{\theta}(s))_{+}^{2}+(1-\tau)(y-V%
_{\theta}(s))_{-}^{2}\right].
\displaystyle\nabla\mathcal{J}_{V}(\theta)=\sum\mu(a\mid s)\left[-2\tau(y-V_{%
\theta})_{+}\mathbb{I}(y-V_{\theta})-2(1-\tau)(y-V_{\theta})_{+}\mathbb{I}(y-V%
_{\theta})\right]
\displaystyle\nabla\mathcal{J}_{V}(\theta)
\displaystyle=\sum\mu(a\mid s)\left[-2\tau(y-V_{\theta})_{+}\mathbb{I}(y-V_{%
\theta})-2(1-\tau)(y-V_{\theta})_{+}\mathbb{I}(y-V_{\theta})\right]
\displaystyle=\sum\mu(a\mid s)\left[-2\tau(y-V_{\theta})_{+}-2(1-\tau)(y-V_{%
\theta})_{+}\right]
\displaystyle=\sum\mu(a\mid s)\left[-2\tau(y-V_{\theta})_{+}-2(1-\tau)(y-V_{%
\theta})_{+}\right]
\displaystyle=\sum\mu(a\mid s)\left[-2\tau(\delta)_{+}-2(1-\tau)(\delta)_{+}%
\right].
\displaystyle=\sum\mu(a\mid s)\left[-2\tau(\delta)_{+}-2(1-\tau)(\delta)_{+}%
\right].
\displaystyle\hat{V}(s)=V_{\theta}(s)-\alpha\nabla\mathcal{J}_{V}(\theta)
\displaystyle\hat{V}(s)
\displaystyle=V_{\theta}(s)-\alpha\nabla\mathcal{J}_{V}(\theta)
\displaystyle=V_{\theta}(s)+2\alpha\mathbb{E}_{a\sim\mu}\left[\tau[\delta(s,a)%
]_{+}+(1-\tau)[\delta(s,a)]_{-}\right]
\displaystyle=V_{\theta}(s)+2\alpha\mathbb{E}_{a\sim\mu}\left[\tau[\delta(s,a)%
]_{+}+(1-\tau)[\delta(s,a)]_{-}\right]
\tau\in[0,1)
\mathcal{T}_{\tau}^{\mu}
\gamma_{\tau}
\gamma_{\tau}=1-2\alpha(1-\gamma)\min\{\tau,1-\tau\}
\mathcal{T}_{1/2}^{\mu}
\mu
V^{\mu}
V_{1},V_{2}
\displaystyle\mathcal{T}_{1/2}^{\mu}V_{1}(s)-\mathcal{T}_{1/2}^{\mu}V_{2}(s)
\displaystyle\mathcal{T}_{1/2}^{\mu}V_{1}(s)-\mathcal{T}_{1/2}^{\mu}V_{2}(s)
\displaystyle=V_{1}(s)+\alpha\mathbb{E}_{a\sim\mu}[\delta_{1}(s,a)]-(V_{2}(s)+%
\alpha\mathbb{E}_{a\sim\mu}[\delta_{2}(s,a)])
\displaystyle=V_{1}(s)+\alpha\mathbb{E}_{a\sim\mu}[\delta_{1}(s,a)]-(V_{2}(s)+%
\alpha\mathbb{E}_{a\sim\mu}[\delta_{2}(s,a)])
\displaystyle=(1-\alpha)(V_{1}(s)-V_{2}(s))+\alpha\mathbb{E}_{a\sim\mu}[r(s,a)%
+\gamma V_{1}(s^{\prime})-r(s,a)-\gamma V_{2}(s^{\prime})]
\displaystyle=(1-\alpha)(V_{1}(s)-V_{2}(s))+\alpha\mathbb{E}_{a\sim\mu}[r(s,a)%
+\gamma V_{1}(s^{\prime})-r(s,a)-\gamma V_{2}(s^{\prime})]
\displaystyle\leq(1-\alpha)\|V_{1}-V_{2}\|_{\infty}+\alpha\gamma\|V_{1}-V_{2}%
\|_{\infty}
\displaystyle\leq(1-\alpha)\|V_{1}-V_{2}\|_{\infty}+\alpha\gamma\|V_{1}-V_{2}%
\|_{\infty}
\displaystyle=(1-\alpha(1-\gamma))\|V_{1}-V_{2}\|_{\infty}.
\displaystyle=(1-\alpha(1-\gamma))\|V_{1}-V_{2}\|_{\infty}.
\displaystyle\mathcal{T}_{+}^{\mu}V(s)=V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]%
_{+},
\displaystyle\mathcal{T}_{+}^{\mu}V(s)=V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]%
_{+},
\displaystyle\mathcal{T}_{-}^{\mu}V(s)=V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]%
_{-}.
\displaystyle\mathcal{T}_{-}^{\mu}V(s)=V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]%
_{-}.
\|\mathcal{T}_{+}^{\mu}V_{1}-\mathcal{T}_{+}^{\mu}V_{2}\|_{\infty}\leq\|V_{1}-%
V_{2}\|_{\infty}
V_{1},V_{2}
\displaystyle\mathcal{T}_{+}^{\mu}V_{1}(s)-\mathcal{T}_{+}^{\mu}V_{2}(s)=V_{1}%
(s)-V_{2}(s)+\mathbb{E}_{a\sim\mu}[[\delta_{1}(s,a)]_{+}-[\delta_{2}(s,a)]_{+}]
\displaystyle\mathcal{T}_{+}^{\mu}V_{1}(s)-\mathcal{T}_{+}^{\mu}V_{2}(s)
\displaystyle=V_{1}(s)-V_{2}(s)+\mathbb{E}_{a\sim\mu}[[\delta_{1}(s,a)]_{+}-[%
\delta_{2}(s,a)]_{+}]
\displaystyle=\mathbb{E}_{a\sim\mu}[[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2%
}(s,a)]_{+}+V_{2}(s))].
\displaystyle=\mathbb{E}_{a\sim\mu}[[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2%
}(s,a)]_{+}+V_{2}(s))].
[\delta_{1}(s,a)]_{+}+V_{1}(s)
[\delta_{2}(s,a)]_{+}+V_{2}(s)
\delta_{1}\geq 0,\delta_{2}\geq 0
[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2}(s,a)]_{+}+V_{2}(s))=\gamma(V_{1}(s%
^{\prime})-V_{2}(s^{\prime}))
\delta_{1}<0,\delta_{2}<0
[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2}(s,a)]_{+}+V_{2}(s))=V_{1}(s)-V_{2}%
(s)
\delta_{1}\geq 0,\delta_{2}<0
\displaystyle[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2}(s,a)]_{+}+V_{2}(s))
\displaystyle[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2}(s,a)]_{+}+V_{2}(s))
\displaystyle=(r(s,a)+\gamma V_{1}(s^{\prime}))-V_{2}(s)
\displaystyle=(r(s,a)+\gamma V_{1}(s^{\prime}))-V_{2}(s)
\displaystyle<(r(s,a)+\gamma V_{1}(s^{\prime}))-(r(s,a)+\gamma V_{2}(s^{\prime%
}))
\displaystyle<(r(s,a)+\gamma V_{1}(s^{\prime}))-(r(s,a)+\gamma V_{2}(s^{\prime%
}))
\displaystyle=\gamma(V_{1}(s^{\prime})-V_{2}(s^{\prime})),
\displaystyle=\gamma(V_{1}(s^{\prime})-V_{2}(s^{\prime})),
r(s,a)+\gamma V_{2}(s^{\prime})<V_{2}(s)
\delta_{1}<0,\delta_{2}\geq 0
\displaystyle[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2}(s,a)]_{+}+V_{2}(s))
\displaystyle[\delta_{1}(s,a)]_{+}+V_{1}(s)-([\delta_{2}(s,a)]_{+}+V_{2}(s))
\displaystyle=V_{1}(s)-(r(s,a)+\gamma V_{2}(s^{\prime}))
\displaystyle=V_{1}(s)-(r(s,a)+\gamma V_{2}(s^{\prime}))
\displaystyle\leq V_{1}(s)-V_{2}(s),
\displaystyle\leq V_{1}(s)-V_{2}(s),
r(s,a)+\gamma V_{2}(s^{\prime})\geq V_{2}(s)
\mathcal{T}_{+}^{\mu}V_{1}(s)-\mathcal{T}_{+}^{\mu}V_{2}(s)\leq\|V_{1}-V_{2}\|%
_{\infty}
\mathcal{T}_{+}^{\mu},\mathcal{T}_{-}^{\mu}
\mathcal{T}_{\tau}^{\mu}
\displaystyle\mathcal{T}_{\tau}^{\mu}V(s)=V(s)+2\alpha\mathbb{E}_{a\sim\mu}[%
\tau[\delta(s,a)]_{+}+(1-\tau)[\delta(s,a)]_{-}]
\displaystyle\mathcal{T}_{\tau}^{\mu}V(s)
\displaystyle=V(s)+2\alpha\mathbb{E}_{a\sim\mu}[\tau[\delta(s,a)]_{+}+(1-\tau)%
[\delta(s,a)]_{-}]
\displaystyle=(1-2\alpha)V(s)+2\alpha\tau(V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,%
a)]_{+})+2\alpha(1-\tau)(V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]_{-})
\displaystyle=(1-2\alpha)V(s)+2\alpha\tau(V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,%
a)]_{+})+2\alpha(1-\tau)(V(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]_{-})
\displaystyle=(1-2\alpha)V(s)+2\alpha\tau\mathcal{T}_{+}^{\mu}V(s)+2\alpha(1-%
\tau)\mathcal{T}_{-}^{\mu}V(s).
\displaystyle=(1-2\alpha)V(s)+2\alpha\tau\mathcal{T}_{+}^{\mu}V(s)+2\alpha(1-%
\tau)\mathcal{T}_{-}^{\mu}V(s).
\displaystyle\mathcal{T}_{1/2}^{\mu}V(s)=V(s)+\alpha\mathbb{E}_{a\sim\mu}[%
\delta(s,a)]
\displaystyle\mathcal{T}_{1/2}^{\mu}V(s)
\displaystyle=V(s)+\alpha\mathbb{E}_{a\sim\mu}[\delta(s,a)]
\displaystyle=V(s)+\alpha(\mathcal{T}_{+}^{\mu}V(s)+\mathcal{T}_{-}^{\mu}V(s)-%
2V(s))
\displaystyle=V(s)+\alpha(\mathcal{T}_{+}^{\mu}V(s)+\mathcal{T}_{-}^{\mu}V(s)-%
2V(s))
\displaystyle=(1-2\alpha)V(s)+\alpha(\mathcal{T}_{+}^{\mu}V(s)+\mathcal{T}_{-}%
^{\mu}V(s)).
\displaystyle=(1-2\alpha)V(s)+\alpha(\mathcal{T}_{+}^{\mu}V(s)+\mathcal{T}_{-}%
^{\mu}V(s)).
\tau<\frac{1}{2}
V_{1},V_{2}
\displaystyle\mathcal{T}_{\tau}^{\mu}V_{1}(s)-\mathcal{T}_{\tau}^{\mu}V_{2}(s)
\displaystyle\mathcal{T}_{\tau}^{\mu}V_{1}(s)-\mathcal{T}_{\tau}^{\mu}V_{2}(s)
\displaystyle=(1-2\alpha)(V_{1}(s)-V_{2}(s))+2\alpha\tau(\mathcal{T}_{+}^{\mu}%
V_{1}(s)-\mathcal{T}_{+}^{\mu}V_{2}(s))+2\alpha(1-\tau)(\mathcal{T}_{-}^{\mu}V%
_{1}(s)-\mathcal{T}_{-}^{\mu}V_{2}(s))
\displaystyle=(1-2\alpha)(V_{1}(s)-V_{2}(s))+2\alpha\tau(\mathcal{T}_{+}^{\mu}%
V_{1}(s)-\mathcal{T}_{+}^{\mu}V_{2}(s))+2\alpha(1-\tau)(\mathcal{T}_{-}^{\mu}V%
_{1}(s)-\mathcal{T}_{-}^{\mu}V_{2}(s))
\displaystyle=(1-2\alpha-2\tau(1-2\alpha))(V_{1}(s)-V_{2}(s))+2\tau\left(%
\mathcal{T}^{\mu}_{1/2}V_{1}(s)-\mathcal{T}^{\mu}_{1/2}V_{2}(s)\right)+
\displaystyle=(1-2\alpha-2\tau(1-2\alpha))(V_{1}(s)-V_{2}(s))+2\tau\left(%
\mathcal{T}^{\mu}_{1/2}V_{1}(s)-\mathcal{T}^{\mu}_{1/2}V_{2}(s)\right)+
\displaystyle\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad 2%
\alpha(1-2\tau)\left(\mathcal{T}^{\mu}_{-}V_{1}(s)-\mathcal{T}^{\mu}_{-}V_{2}(%
s)\right)
\displaystyle\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad\qquad 2%
\alpha(1-2\tau)\left(\mathcal{T}^{\mu}_{-}V_{1}(s)-\mathcal{T}^{\mu}_{-}V_{2}(%
s)\right)
\displaystyle\leq(1-2\alpha-2\tau(1-2\alpha))\|V_{1}-V_{2}\|_{\infty}+2\tau(1-%
\alpha(1-\gamma))\|V_{1}-V_{2}\|_{\infty}+2\alpha(1-2\tau)\|V_{1}-V_{2}\|_{\infty}
\displaystyle\leq(1-2\alpha-2\tau(1-2\alpha))\|V_{1}-V_{2}\|_{\infty}+2\tau(1-%
\alpha(1-\gamma))\|V_{1}-V_{2}\|_{\infty}+2\alpha(1-2\tau)\|V_{1}-V_{2}\|_{\infty}
\displaystyle=(1-2\alpha\tau(1-\gamma))\|V_{1}-V_{2}\|_{\infty}
\displaystyle=(1-2\alpha\tau(1-\gamma))\|V_{1}-V_{2}\|_{\infty}
\tau>1/2
\mathcal{T}_{\tau}^{\mu}V_{1}(s)-\mathcal{T}_{\tau}^{\mu}V_{2}(s)\leq(1-2%
\alpha(1-\tau)(1-\gamma))\|V_{1}-V_{2}\|_{\infty}
\tau,\tau^{\prime}\in(0,1)
\tau^{\prime}\geq\tau
\mathcal{T}_{\tau^{\prime}}^{\mu}\geq\mathcal{T}_{\tau}^{\mu},\forall s\in S
\displaystyle\mathcal{T}_{\tau^{\prime}}^{\mu}V(s)-\mathcal{T}_{\tau}^{\mu}V(s)
\displaystyle\mathcal{T}_{\tau^{\prime}}^{\mu}V(s)-\mathcal{T}_{\tau}^{\mu}V(s)
\displaystyle=(1-2\alpha)V(s)+2\alpha\tau^{\prime}\mathcal{T}_{+}^{\mu}V(s)+2%
\alpha(1-\tau^{\prime})\mathcal{T}_{-}^{\mu}V(s)
\displaystyle=(1-2\alpha)V(s)+2\alpha\tau^{\prime}\mathcal{T}_{+}^{\mu}V(s)+2%
\alpha(1-\tau^{\prime})\mathcal{T}_{-}^{\mu}V(s)
\displaystyle\qquad\qquad\qquad-((1-2\alpha)V(s)+2\alpha\tau\mathcal{T}^{\mu}_%
{+}V(s)+2\alpha(1-\tau)\mathcal{T}_{-}^{\mu}V(s))
\displaystyle\qquad\qquad\qquad-((1-2\alpha)V(s)+2\alpha\tau\mathcal{T}^{\mu}_%
{+}V(s)+2\alpha(1-\tau)\mathcal{T}_{-}^{\mu}V(s))
\displaystyle=2\alpha(\tau^{\prime}-\tau)(\mathcal{T}^{\mu}_{+}V(s)-\mathcal{T%
}^{\mu}_{-}V(s))
\displaystyle=2\alpha(\tau^{\prime}-\tau)(\mathcal{T}^{\mu}_{+}V(s)-\mathcal{T%
}^{\mu}_{-}V(s))
\displaystyle=2\alpha(\tau^{\prime}-\tau)\mathbb{E}_{a\sim\mu}[[\delta(s,a)]_{%
+}-[\delta(s,a)]_{-}]\geq 0.
\displaystyle=2\alpha(\tau^{\prime}-\tau)\mathbb{E}_{a\sim\mu}[[\delta(s,a)]_{%
+}-[\delta(s,a)]_{-}]\geq 0.
V^{*}
\mathcal{T}^{*}
\lim_{\tau\to 1}V_{\tau}^{*}=V^{*}
V^{*}
\mathcal{T}_{+}^{\mu}
\mathcal{T}^{*}
V^{*}(s)=\max_{a}[r(s,a)+\gamma V^{*}(s^{\prime})]
\delta(s,a)\leq 0
\forall s\in S,a\in A
\mathcal{T}_{+}^{\mu}V^{*}(s)=V^{*}(s)+\mathbb{E}_{a\sim\mu}[\delta(s,a)]_{+}=%
V^{*}(s)
(1-\tau)\to 0
\mathcal{T}_{-}^{\mu}
\mathcal{T}_{\tau}^{\mu}
V_{\tau}^{*}
\tau\in(0,1)
T\in\mathbb{N}^{+}
\mathcal{T}_{\rm vem}
\gamma_{\tau}
\tau>\frac{1}{2}
\mathcal{T}_{\rm vem}
\mathcal{T}_{\tau}^{\mu}
V_{1},V_{2}
\displaystyle\mathcal{T}_{\rm vem}V_{1}(s)-\mathcal{T}_{\rm vem}V_{2}(s)=\max_%
{1\leq n\leq n_{\rm max}}\{(\mathcal{T}^{\mu})^{n-1}\mathcal{T}_{\tau}^{\mu}V_%
{1}(s)\}-\max_{1\leq n\leq T}\{(\mathcal{T}^{\mu})^{n-1}\mathcal{T}_{\tau}^{%
\mu}V_{2}(s)\}
\displaystyle\mathcal{T}_{\rm vem}V_{1}(s)-\mathcal{T}_{\rm vem}V_{2}(s)
\displaystyle=\max_{1\leq n\leq n_{\rm max}}\{(\mathcal{T}^{\mu})^{n-1}%
\mathcal{T}_{\tau}^{\mu}V_{1}(s)\}-\max_{1\leq n\leq T}\{(\mathcal{T}^{\mu})^{%
n-1}\mathcal{T}_{\tau}^{\mu}V_{2}(s)\}
\displaystyle\leq\max_{1\leq n\leq n_{\rm max}}|(\mathcal{T}^{\mu})^{n-1}%
\mathcal{T}_{\tau}^{\mu}V_{1}(s)-(\mathcal{T}^{\mu})^{n-1}\mathcal{T}_{\tau}^{%
\mu}V_{2}(s)|
\displaystyle\leq\max_{1\leq n\leq n_{\rm max}}|(\mathcal{T}^{\mu})^{n-1}%
\mathcal{T}_{\tau}^{\mu}V_{1}(s)-(\mathcal{T}^{\mu})^{n-1}\mathcal{T}_{\tau}^{%
\mu}V_{2}(s)|
\displaystyle\leq\max_{1\leq n\leq n_{\rm max}}\gamma^{n-1}\gamma_{\tau}\|V_{1%
}-V_{2}\|_{\infty}
\displaystyle\leq\max_{1\leq n\leq n_{\rm max}}\gamma^{n-1}\gamma_{\tau}\|V_{1%
}-V_{2}\|_{\infty}
\displaystyle\leq\gamma_{\tau}\|V_{1}-V_{2}\|_{\infty}.
\displaystyle\leq\gamma_{\tau}\|V_{1}-V_{2}\|_{\infty}.
V_{\tau}^{*}
\mathcal{T}_{\tau}^{\mu}
\mathcal{T}_{\rm vem}
\tau>\frac{1}{2}
V_{\tau}^{*}=\mathcal{T}_{\tau}^{\mu}V_{\tau}^{*}
V_{\tau}^{*}=\mathcal{T}_{\tau}^{\mu}V_{\tau}^{*}\geq\mathcal{T}_{1/2}^{\mu}V_%
{\tau}^{*}=\mathcal{T}^{\mu}V_{\tau}^{*}
\mathcal{T}^{\mu}
\mathcal{T}^{\mu}V_{\tau}^{*}\geq(\mathcal{T}^{\mu})^{n-1}V_{\tau}^{*},1\leq n%
\leq n_{\rm max}
\mathcal{T}_{\rm vem}V_{\tau}^{*}(s)=\max_{1\leq n\leq T}\{(\mathcal{T}^{\mu})%
^{n-1}\mathcal{T}_{\tau}^{\mu}V_{\tau}^{*}(s)\}=V_{\tau}^{*}(s)
V(s)
\mathcal{T}_{\rm vem}
|\mathcal{T}_{\rm vem}V(s)-V_{\tau}^{*}(s)|\leq\gamma^{n^{*}(s)-1}\gamma_{\tau%
}\|V-V_{n^{*},\tau}^{\mu}\|_{\infty}+\|V_{n^{*},\tau}^{\mu}-V_{\tau}^{*}\|_{%
\infty},\forall s\in S,
n^{*}(s)=\arg\max_{1\leq n\leq T}\{(\mathcal{T}^{\mu})^{n-1}\mathcal{T}_{\tau}%
^{\mu}V(s)\}
V_{n^{*},\tau}^{\mu}
(\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}
\displaystyle\mathcal{T}_{\rm vem}V(s)-V_{\tau}^{*}(s)=(\mathcal{T}^{\mu})^{n^%
{*}(s)-1}\mathcal{T}_{\tau}^{\mu}V(s)-V_{\tau}^{*}(s)
\displaystyle\mathcal{T}_{\rm vem}V(s)-V_{\tau}^{*}(s)
\displaystyle=(\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}V(s)-V_{%
\tau}^{*}(s)
\displaystyle=(\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}V(s)-(%
\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}V_{n^{*},\tau}^{\mu}(s)%
+V_{n^{*},\tau}^{\mu}(s)-V_{\tau}^{*}(s)
\displaystyle=(\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}V(s)-(%
\mathcal{T}^{\mu})^{n^{*}(s)-1}\mathcal{T}_{\tau}^{\mu}V_{n^{*},\tau}^{\mu}(s)%
+V_{n^{*},\tau}^{\mu}(s)-V_{\tau}^{*}(s)
\displaystyle\leq\gamma^{n^{*}(s)-1}\gamma_{\tau}\|V-V_{n^{*},\tau}^{\mu}\|_{%
\infty}+\|V_{n^{*},\tau}^{\mu}-V_{\tau}^{*}\|.
\displaystyle\leq\gamma^{n^{*}(s)-1}\gamma_{\tau}\|V-V_{n^{*},\tau}^{\mu}\|_{%
\infty}+\|V_{n^{*},\tau}^{\mu}-V_{\tau}^{*}\|.
V_{\tau}^{*}
\mathcal{T}_{\tau}^{\mu}
\tau,\tau^{\prime}\in(0,1)
\tau^{\prime}\geq\tau
V_{\tau^{\prime}}^{*}(s)\geq V_{\tau}^{*}(s)
\forall s\in S
\mathcal{T}_{\tau^{\prime}}^{\mu}V_{\tau}^{*}\geq\mathcal{T}_{\tau}^{\mu}V_{%
\tau}^{*}
V_{\tau}^{*}
\mathcal{T}_{\tau}^{\mu}
\mathcal{T}_{\tau}^{\mu}V_{\tau}^{*}=V_{\tau}^{*}
V_{\tau}^{*}=\mathcal{T}_{\tau}^{\mu}V_{\tau}^{*}\leq\mathcal{T}_{\tau^{\prime%
}}^{\mu}V_{\tau}^{*}
\mathcal{T}_{\tau^{\prime}}^{\mu}
V_{\tau}^{*}\leq\mathcal{T}_{\tau^{\prime}}^{\mu}V_{\tau}^{*}\leq\left(%
\mathcal{T}_{\tau^{\prime}}^{\mu}\right)^{\infty}V_{\tau}^{*}=V_{\tau^{\prime}%
}^{*}
\displaystyle\max_{\phi}J_{\pi}(\phi)=\mathbb{E}_{(s,a)\sim\mathcal{D}}\left[%
\log\pi_{\phi}(a\mid s)\cdot f\left(\hat{A}(s,a)\right)\right],
\displaystyle\max_{\phi}J_{\pi}(\phi)
\displaystyle=\mathbb{E}_{(s,a)\sim\mathcal{D}}\left[\log\pi_{\phi}(a\mid s)%
\cdot f\left(\hat{A}(s,a)\right)\right],
\displaystyle\text{where}f(\hat{A}(s,a))=\begin{cases}\hat{A}(s,a)\qquad\text{%
if}\quad\hat{A}(s,a)>0\\
\frac{\hat{A}(s,a)}{\alpha}\qquad\text{if}\quad\hat{A}(s,a)\leq 0\\
\end{cases}
\displaystyle f(\hat{A}(s,a))=\begin{cases}\hat{A}(s,a)\qquad\text{if}\quad%
\hat{A}(s,a)>0\\
\frac{\hat{A}(s,a)}{\alpha}\qquad\text{if}\quad\hat{A}(s,a)\leq 0\\
\end{cases}
\max_{\phi}J_{\pi}(\phi)=\mathbb{E}_{(s,a)\sim\mathcal{D}}\left[\log\pi_{\phi}%
(a\mid s)\cdot\frac{\exp(\frac{1}{\alpha}\hat{A}(s,a))}{\sum_{(s_{i},a_{i})%
\sim\text{Batch}}\exp(\frac{1}{\alpha}\hat{A}(s_{i},a_{i}))}\right].
\displaystyle\min_{\theta}\mathcal{J}_{Q}(\theta)=\mathbb{E}_{(s_{t},a_{t},s_{%
t+1})\sim\mathcal{D}}\left[\left(R_{t}-Q_{\theta}(s_{t},a_{t})\right)^{2}\right]
\displaystyle\min_{\theta}\mathcal{J}_{Q}(\theta)
\displaystyle=\mathbb{E}_{(s_{t},a_{t},s_{t+1})\sim\mathcal{D}}\left[\left(R_{%
t}-Q_{\theta}(s_{t},a_{t})\right)^{2}\right]
\displaystyle R_{t}=\max_{0<n\leq n_{\rm max}}Q_{t,n},\quad Q_{t,n}=\begin{%
cases}r_{t}+\gamma Q_{t+1,n-1}(s_{t+1},\hat{a}_{t+1})&\text{if}\quad n>0,\\
Q(s_{t},\hat{a}_{t})&\text{if}\quad n=0,\end{cases}
\displaystyle R_{t}
\displaystyle=\max_{0<n\leq n_{\rm max}}Q_{t,n},\quad Q_{t,n}=\begin{cases}r_{%
t}+\gamma Q_{t+1,n-1}(s_{t+1},\hat{a}_{t+1})&\text{if}\quad n>0,\\
Q(s_{t},\hat{a}_{t})&\text{if}\quad n=0,\end{cases}
\hat{a}_{t}
G_{w}(s_{t})
\displaystyle\min_{\phi}\mathcal{J}_{\xi}(\phi)=-\mathbb{E}_{s\sim\mathcal{D}}%
\left[Q_{\theta}(s,a_{i}+\xi_{\phi}(s,a_{i},\Phi))\right],\quad\{a_{i}\sim G_{%
w}(s)\}_{i=1}^{n},
\displaystyle\min_{\phi}\mathcal{J}_{\xi}(\phi)=-\mathbb{E}_{s\sim\mathcal{D}}%
\left[Q_{\theta}(s,a_{i}+\xi_{\phi}(s,a_{i},\Phi))\right],\quad\{a_{i}\sim G_{%
w}(s)\}_{i=1}^{n},
\xi_{\phi}(s,a_{i},\Phi)
a
[-\Phi,\Phi]
G_{w}(s)
\mathcal{D}
\kappa
d
T
\tau
\tau
[(\text{state dim},256),(256,256),(256,\text{action dim})]
[(\text{state dim},256),(256,256),(256,1)]
\tau
\tau
\tau
\tau
