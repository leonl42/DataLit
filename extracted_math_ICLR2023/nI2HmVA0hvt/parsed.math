\mathcal{S}:I\mapsto\mathbf{\hat{b}}\in\{0,1\}^{\mathrm{b}}
\mathcal{S}
I
N
\mathbf{\hat{b}}
\mathrm{b}
\mathcal{B}(I;\theta_{\mathcal{T}})
I
\mathbf{z}\in R^{D}
\theta_{\mathcal{T}}
\mathcal{Q}(x;\theta_{\mathcal{Q}})
D
x
M
K
B_{m}=\{\mathbf{c}^{m}_{1},\mathbf{c}^{m}_{2},...,\mathbf{c}^{m}_{K}\}
\mathbf{c}\in R^{D/M}
I_{i}
V_{i}
PE_{i}=V_{i}\times W_{PE}
EE=[CT,PE]
EE
PoE
FE
FE=dropout(EE+PoE,0.1)
dropout
W_{Q}
W_{K}
W_{V}
\xi_{t}=l_{j-1}\times W_{t}
t\in\{Q,K,V\}
l_{j-1}
\xi_{QK}
\xi_{QK}=\frac{\xi_{Q}\times\xi_{K}}{\sqrt{A_{\xi}}},
\sqrt{A_{\xi}}
A_{w}=softmax(\xi_{QK})
F_{A}=A_{w}\times\xi_{V}
F_{A}
N_{B}
T\sim\mathcal{T}
T^{\prime}\sim\mathcal{T}
2N_{B}
(\tilde{x}_{i},\tilde{x}_{j})
2(N_{B}-1)
\bm{z}\in\mathbb{R}^{D}
\bm{z}=[\bm{z}^{1},\bm{z}^{2},\cdots,\bm{z}^{M}]
\mathcal{C}=[\bm{C}^{1},\bm{C}^{2},\cdots,\bm{C}^{M}]
M
K
[{\bm{c}^{m}_{1},\bm{c}^{m}_{2},\cdots,\bm{c}^{m}_{K}}]\in\mathbb{R}^{d}
d=D/M
\bm{z}
\bm{z}^{m}\in\mathbb{R}^{d}
\hat{\bm{z}}^{m}=\sum_{i=1}^{K}p_{i}^{m}\bm{c}_{i}^{m}
p_{i}^{m}
\alpha
p^{m}_{i}=\frac{\exp\left(\alpha\cdot{\bm{z}^{m}}^{\top}\bm{c}^{m}_{i}\right)}%
{\sum_{j=1}^{K}\exp\left(\alpha\cdot{\bm{z}^{m}}^{\top}\bm{c}^{m}_{j}\right)},
\hat{\bm{z}}^{m}
\bm{z}
\hat{\bm{z}}^{m}
\hat{\bm{z}}=\text{concatenate}\left(\hat{\bm{z}}^{1},\hat{\bm{z}}^{2},\cdots,%
\hat{\bm{z}}^{M}\right)
\mathcal{L}_{\text{VCL}}=-\sum_{q=1}^{2N_{B}}\log\frac{\exp(\frac{S(q,k^{+})}{%
\tau})}{\exp(\frac{S(q,k^{+})}{\tau})+\sum_{\begin{subarray}{c}k^{-}=1,\\
k^{-}\notin\{q,k^{+}\}\end{subarray}}^{2N_{B}}{\exp(\frac{S(q,k^{-})}{\tau})}},
N_{B}
q
k^{+}
k^{-}
\tau
S
\mathcal{L}_{\text{CCL}}
\mathcal{L}_{\text{CCL}}=-\sum_{q=1}^{2N_{B}}\log\frac{\exp(\frac{S(q,k^{+})}{%
\tau})}{\exp(\frac{S(q,k^{+})}{\tau})+\sum_{\begin{subarray}{c}k^{-}=1,\\
k^{-}\notin\{q,k^{+}\}\end{subarray}}^{N_{S}-\eta}{\exp(\frac{S(q,k^{-})}{\tau%
})}},
N_{S}=2(N_{B}-1)
\eta
N_{S}-\eta
\mathcal{L}_{\text{CCL}}
\min_{\theta_{\mathcal{T}},\mathcal{C}}\mathbb{E}\,\mathcal{L}_{\text{CCL}}+%
\beta\|\theta_{\mathcal{T}}\|_{2}^{2}+\gamma\Omega_{\mathcal{C}},
\Omega_{\mathcal{C}}
\theta_{\mathcal{T}}
\beta
\gamma
\eta
\eta=0
\eta
\eta=0
\eta
\downarrow
p^{m}_{db}={\mathop{\arg\mathrm{max}}_{1\leq i\leq K}\,}{{\bm{z}^{m}_{db}}^{%
\top}\bm{c}_{i}^{m}}
x_{db}
x_{q}
M
x_{q}
x_{q}
32\times 32
\rightarrow
\downarrow
\downarrow
\downarrow
\downarrow
patchsize=32
128
50
\alpha
10
K
256
B=M\log_{2}K=8M
\eta
\eta\in\{5,10,15,20\}
(\eta)
\eta
\eta=0
\eta\in\{5,10,15,20\}
\eta=0
\eta=5
\eta=10
\eta=15
\eta=20
\eta=0
0.0034
0.0016
0.0002
0.0047
0.05
\eta
\eta
\eta
N_{B}=
\eta
N_{B}=
\eta
\eta
\downarrow
N_{B}
\rightarrow
36.73\%
35.23\%
33.61\%
41.19\%
47.78\%
45.89\%
1.28\%
0.98\%
1.01\%
\eta=0
N_{B}
\eta
\eta
N_{B}
N_{B}
\eta
\eta
\eta=0
\eta=5
\eta=10
\eta=15
\eta=20
\eta
\eta=5
4.04\%
\eta=0
