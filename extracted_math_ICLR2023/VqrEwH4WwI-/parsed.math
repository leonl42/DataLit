\phi
\pi_{z}
\psi
\phi
\pi_{z}
\psi
\mathcal{M}=(\mathcal{S},\mathcal{A},R,T)
\mathcal{S}
\mathcal{A}
R:\mathcal{S}\times\mathcal{A}\rightarrow\mathbb{R}
T:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\rightarrow\mathbb{R}_{\geq 0}
d
(\mathcal{S}_{d}
\mathcal{A}_{d}
T_{d})
d
\mathcal{M}_{d}:(\mathcal{S}_{d},\mathcal{A}_{d},R_{d},T_{d})
\mathcal{M}_{x}
x
\mathcal{M}_{y}
y
\mathcal{M}_{z}
\phi_{x}:\mathcal{S}_{x}\rightarrow\mathcal{S}_{z},\phi_{y}:\mathcal{S}_{y}%
\rightarrow\mathcal{S}_{z}
\xi_{x}:\mathcal{A}_{x}\rightarrow\mathcal{A}_{z},
\xi_{y}:\mathcal{A}_{y}\rightarrow\mathcal{A}_{z}
s_{x},s_{y}
a_{x},a_{y}
s_{z}
a_{z}
T_{z}(\phi_{d}(s_{d}),\xi_{d}(a_{d}),\phi_{d}(s_{d}^{\prime}))=T_{d}(s_{d},a_{%
d},s_{d}^{\prime})
R_{z}(\phi_{d}(s_{d}),\xi_{d}(a_{d}))=R_{d}(s_{d},a_{d})
s_{d},a_{d},s_{d}^{\prime}
d
\psi_{x}:\mathcal{A}_{z}\times\mathcal{S}_{x}\rightarrow\mathcal{A}_{x}
\psi_{y}:\mathcal{A}_{z}\times\mathcal{S}_{y}\rightarrow\mathcal{A}_{y}
s_{d}
a_{d}
\phi_{x},\phi_{y}
\xi_{x},\xi_{y}
\pi_{z}(a_{z}|s_{z}):\mathcal{S}_{z}\times\mathcal{A}_{z}\rightarrow\mathbb{R}%
_{\geq 0}
\pi_{z}(s_{z}):\mathcal{S}_{z}\rightarrow\mathcal{A}_{z}
\mathcal{K}
\mathcal{D}=\{(\mathcal{D}_{x,k},\mathcal{D}_{y,k})\}_{k=1}^{|\mathcal{K}|}
\mathcal{D}_{d,k}=\{\tau_{d,k,i}\}_{i=1}^{N}
N
\tau_{d,k,i}
d
k
k^{\prime}\not\in\mathcal{K}
x
y
s_{z}
s_{z}
s_{z}
s_{z}
\phi_{x},\phi_{y}
\xi_{x},\xi_{y}
\phi(s)
\pi(s_{z})
\psi(a_{z})
d
k
(s_{z})
(s_{z})
\displaystyle\mathcal{L}_{\text{BC}}=\mathbb{E}_{(s_{d},a_{d},d,k)\sim\mathcal%
{D}}\left[\|\psi_{d}(\pi_{z}(\phi_{d}(s_{d}),k),s_{d})-a_{d}\|^{2}\right].
(\phi_{x}(s_{x}^{t}),\psi_{x}(a_{x}^{t}))=(\xi_{y}(s_{y}^{t}),\xi_{y}(a_{y}^{t%
}))
t
\phi_{x}(s_{x}),\phi_{y}(s_{y})
\xi_{x}(a_{x}),\xi_{y}(a_{y})
\displaystyle\mathcal{L}_{\text{MMD}}=\mathbb{E}_{s_{x},s^{\prime}_{x}\sim%
\mathcal{D}_{x}}[f(\phi_{x}(s_{x}),\phi_{x}(s^{\prime}_{x}))]+\mathbb{E}_{s_{y%
},s^{\prime}_{y}\sim\mathcal{D}_{y}}[f(\phi_{y}(s_{y}),\phi_{y}(s^{\prime}_{y}%
))]
\displaystyle\mathcal{L}_{\text{MMD}}=\mathbb{E}_{s_{x},s^{\prime}_{x}\sim%
\mathcal{D}_{x}}[f(\phi_{x}(s_{x}),\phi_{x}(s^{\prime}_{x}))]
\displaystyle+\mathbb{E}_{s_{y},s^{\prime}_{y}\sim\mathcal{D}_{y}}[f(\phi_{y}(%
s_{y}),\phi_{y}(s^{\prime}_{y}))]
\displaystyle-2\mathbb{E}_{s_{x}\sim\mathcal{D}_{x},s_{y}\sim\mathcal{D}_{y}}[%
f(\phi_{x}(s_{x}),\phi_{y}(s_{y}))],
\displaystyle-2\mathbb{E}_{s_{x}\sim\mathcal{D}_{x},s_{y}\sim\mathcal{D}_{y}}[%
f(\phi_{x}(s_{x}),\phi_{y}(s_{y}))],
\mathcal{D}_{d}
d
f
f
\phi(s_{d},d)
\pi_{z}(s_{z},k)
\psi(a_{z},s_{d},d)
\lambda_{\text{MMD}},\lambda_{\text{TCC}}
\mathcal{D}=\{(s_{d},a_{d},d,k)\}
\{(s_{d},a_{d},d,k)\}\sim\mathcal{D}
\mathcal{L}_{\text{BC}}
\mathcal{L}_{\text{MMD}}
\mathcal{L}_{\text{TCC}}
\lambda_{\text{TCC}}>0
\mathcal{L}_{\text{align}}=\mathcal{L}_{\text{BC}}+\lambda_{\text{MMD}}%
\mathcal{L}_{\text{MMD}}+\lambda_{\text{TCC}}\mathcal{L}_{\text{TCC}}
\phi,\pi_{z},\psi
\mathcal{L}_{\text{align}}
s_{z}
\phi_{d}(s_{d})
U=(u_{1},\cdots u_{|U|})
V=(v_{1},\cdots v_{|V|})
u_{t}=\phi_{d_{1}}(s_{d_{1}}^{t})
v_{t}=\phi_{d_{2}}(s_{d_{2}}^{t})
u_{i}
U
V
\tilde{v}^{i}=\sum_{j}^{|V|}\text{softmax}_{j}(-\|u_{i}-v_{j}\|)\cdot v_{j}
\tilde{v}^{i}
u_{i}
\mathcal{L}_{\text{TCC}}=-\sum_{i}^{|U|}\sum_{k}^{|U|}\mathbf{1}_{k=i}\log(y_{%
k}^{i})
y_{k}^{i}=\text{softmax}_{k}(-\|\tilde{v}^{i}-u_{k}\|^{2})
\mathbf{1}
\mathcal{L}_{\text{TCC}}
\displaystyle\min_{\phi,\pi_{z},\psi}\mathcal{L}_{\text{align}}=\min_{\phi,\pi%
_{z},\psi}\mathcal{L}_{\text{BC}}+\lambda_{\text{MMD}}\mathcal{L}_{\text{MMD}}%
+\lambda_{\text{TCC}}\mathcal{L}_{\text{TCC}},
\displaystyle\min_{\phi,\pi_{z},\psi}\mathcal{L}_{\text{align}}=\min_{\phi,\pi%
_{z},\psi}\mathcal{L}_{\text{BC}}+\lambda_{\text{MMD}}\mathcal{L}_{\text{MMD}}%
+\lambda_{\text{TCC}}\mathcal{L}_{\text{TCC}},
\lambda_{\text{MMD}}
\lambda_{\text{TCC}}
k
\mathcal{D}_{x,k^{\prime}}
\displaystyle\min_{\pi_{z}}\mathcal{L}_{\text{adapt}}=\min_{\pi_{z}}\mathcal{L%
}_{\text{BC}}.
\displaystyle\min_{\pi_{z}}\mathcal{L}_{\text{adapt}}=\min_{\pi_{z}}\mathcal{L%
}_{\text{BC}}.
\pm
\pm
0.48\pm 0.36
0.68\pm 0.39
0.71\pm 0.40
\bf 1.00\pm 0.00
0.47\pm 0.08
0.28\pm 0.23
\bf 0.93\pm 0.05
0.84\pm 0.08
0.42\pm 0.19
0.62\pm 0.35
0.28\pm 0.20
0.24\pm 0.22
0.42\pm 0.47
\bf 0.60\pm 0.46
0.31\pm 0.38
0.23\pm 0.37
0.00\pm 0.00
0.00\pm 0.00
\bf 0.53\pm 0.42
0.50\pm 0.41
0.01\pm 0.03
0.01\pm 0.02
0.32\pm 0.25
0.33\pm 0.43
0.54\pm 0.26
\bf 0.70\pm 0.17
0.00\pm 0.01
0.00\pm 0.00
0.00\pm 0.00
0.17\pm 0.12
0.63\pm 0.37
\bf 0.71\pm 0.21
0.09\pm 0.15
0.00\pm 0.00
0.09\pm 0.19
0.22\pm 0.40
\bf 0.64\pm 0.13
0.58\pm 0.14
0.12\pm 0.18
0.03\pm 0.05
0.14\pm 0.12
0.08\pm 0.06
\bf 0.64\pm 0.10
0.33\pm 0.24
0.07\pm 0.01
0.00\pm 0.00
0.00\pm 0.01
0.00\pm 0.00
\pm
\pm
\bf 0.94\pm 0.05
0.92\pm 0.09
0.91\pm 0.08
0.90\pm 0.12
0.87\pm 0.10
0.92\pm 0.06
\bf 0.93\pm 0.05
0.84\pm 0.08
0.81\pm 0.13
0.88\pm 0.09
0.72\pm 0.29
0.48\pm 0.23
0.54\pm 0.26
\bf 0.70\pm 0.17
0.45\pm 0.21
0.52\pm 0.15
0.62\pm 0.24
0.52\pm 0.20
0.63\pm 0.37
\bf 0.71\pm 0.21
0.11\pm 0.17
0.39\pm 0.40
0.54\pm 0.42
0.64\pm 0.35
0.64\pm 0.13
0.58\pm 0.14
0.46\pm 0.34
\bf 0.67\pm 0.18
0.52\pm 0.29
0.50\pm 0.11
\bf 0.64\pm 0.10
0.33\pm 0.24
0.10\pm 0.12
0.43\pm 0.14
0.29\pm 0.19
0.02\pm 0.02
\phi(s_{d},d)
\pi_{z}(s_{z},k)
\psi(a_{z},s_{d},d)
k^{\prime}
\mathcal{D}_{x,k^{\prime}}=\{(s_{x},a_{x},x,k^{\prime})\}
\mathcal{D}
\pi_{z}
\phi
\psi
\{(s_{x},a_{x},x,k^{\prime})\}\sim\mathcal{D}_{x,k^{\prime}}
\mathcal{D}
\mathcal{D}_{x,k^{\prime}}
\mathcal{L}_{\text{BC}}
\pi_{z}(s_{z},k)
\bf 0.80\pm 0.30
0.10\pm 0.14
0.00\pm 0.00
0.01\pm 0.01
0.42\pm 0.38
\bf 0.45\pm 0.18
0.04\pm 0.05
0.00\pm 0.00
0.00\pm 0.00
0.25\pm 0.20
\lambda_{\text{MMD}}
\lambda_{\text{MMD}}
\lambda_{\text{MMD}}
\bf 0.71\pm 0.21
0.53\pm 0.48
\bf 0.68\pm 0.24
0.38\pm 0.25
0.64\pm 0.30
\bf 0.50\pm 0.41
0.01\pm 0.03
0.31\pm 0.24
\bf 0.70\pm 0.17
0.00\pm 0.01
0.11\pm 0.07
\bf 0.71\pm 0.21
0.09\pm 0.15
0.21\pm 0.31
0.84\pm 0.08
0.17\pm 0.20
0.70\pm 0.17
0.14\pm 0.08
\phi
\pi_{z}
\displaystyle\mathcal{L}_{\text{next\_state}}=\mathbb{E}\left[\|\pi_{z}(\phi_{%
d}(s_{d}),k)-\text{sg}[\phi_{d}(s_{d}^{\prime})]\|^{2}\right],
\displaystyle\mathcal{L}_{\text{next\_state}}=\mathbb{E}\left[\|\pi_{z}(\phi_{%
d}(s_{d}),k)-\text{sg}[\phi_{d}(s_{d}^{\prime})]\|^{2}\right],
s_{d}^{\prime}
s_{d}
d
\text{sg}[\cdot]
\psi
\displaystyle\mathcal{L}_{\text{IDM}}=\mathbb{E}\left[\|\psi(\text{sg}[\phi_{y%
}(s_{y})],s_{y}^{\prime})-a_{y}\|^{2}\right]
\displaystyle\mathcal{L}_{\text{IDM}}=\mathbb{E}\left[\|\psi(\text{sg}[\phi_{y%
}(s_{y})],s_{y}^{\prime})-a_{y}\|^{2}\right]
s_{z}
s_{z}
x
y
x
y
((x,y,v_{x},v_{y}),(a_{x},a_{y}))
((y,x,v_{y},v_{x}),(-a_{x},-a_{y}))
x
y
3\times 3\times 3
=3
=2
=1
f(a,b)=\exp(-\|a-b\|^{2}/h)
h
s_{z}
\|a-b\|
\lambda_{\text{MMD}}=0.1,\lambda_{\text{TCC}}=0.2
\lambda_{\text{MMD}}=0.1,\lambda_{\text{TCC}}=0.1
