Q_{tot}
Q^{i}
Q_{tot}
Q^{i}
Q_{tot}
Q_{tot}
Q^{i}
Q_{tot}
Q_{tot}
Q^{i}
G
G=<S,A,P,r,Z,O,n,\gamma>
s\in S
Z(s,i):S\times N\rightarrow p(O)
o^{i}\in O^{i}
i\in N\equiv\{1,...,n\}
i
a_{i}\in A_{i}
o_{i}
\pi_{i}:O_{i}\times A_{i}\rightarrow[0,1]
\vec{a}\in\vec{A}
P:S\times A_{1}\times...\times A_{n}\rightarrow S
r(s,\vec{a}):S\times\vec{A}\to{R}
J={E}_{a_{1}\sim\pi_{1},...,a_{n}\sim\pi_{n},s\sim P}\sum_{t=0}^{T}\gamma^{t}r%
_{t}(s,\vec{a})
\gamma
R_{t}=\sum_{l=0}^{T-t}\gamma^{l}r_{t+l}
R_{t}
V^{\vec{\pi}}(s_{t})={E}_{\vec{a}_{t}\sim\vec{\pi},s_{t+1}\sim P}[R_{t}|s_{t}]
Q^{\vec{\pi}}(s_{t},\vec{a}_{t})={E}_{\vec{a}_{t+1}\sim\vec{\pi},s_{t+1}\sim P%
}[R_{t}|s_{t},\vec{a}_{t}]
Q_{tot}
F:\mathbb{R}^{d}\rightarrow\mathbb{R}
x=(x_{1},...,x_{j},...,x_{d})\in\mathbb{R}^{d}
\mathbb{R}
F
d
\vec{x}
\vec{b}
A_{F}(\vec{x},\vec{b})=(c_{1},...c_{j},...,c_{d})\in\mathbb{R}^{d}
c_{j}
x_{j}
F(\vec{x})
F(\vec{b})
F(\vec{b})
F(\vec{x})
\vec{x}
\vec{b}
\tau(\alpha):[0,1]\rightarrow R^{d}
R^{d}
\vec{b}
\vec{x}
\tau(0)=\vec{b}
\tau(1)=\vec{x}
\tau
\tau(\alpha)
\alpha\in[0,1]
j
\vec{x}
c_{j}=PathIG^{\tau}_{j}(\vec{x})::=\int^{1}_{\alpha=0}\frac{\partial F(\tau(%
\alpha))}{\partial\tau_{j}(\alpha)}\frac{\partial\tau_{j}(\alpha)}{\partial%
\alpha}\mathrm{d}\alpha,
\frac{\partial F(\tau(\alpha))}{\partial\tau_{j}(\alpha)}
F
j
\tau(\alpha)=\vec{b}+\alpha(\vec{x}-\vec{b})
\alpha\in[0,1]
c_{j}
j
\vec{x}
c_{j}=IG^{\tau}_{j}(\vec{x})::=(\vec{x}_{j}-\vec{b}_{j})\int^{1}_{\alpha=0}%
\frac{\partial F(\tau(\alpha))}{\partial\tau_{j}(\alpha)}\mathrm{d}\alpha.
\vec{b}
t
T
Q_{tot}
Q_{tot}
Q^{i}
Q^{i}
Q_{tot}
Q^{i}
Q_{tot}
Q^{i}
Q_{tot}
Q_{tot}
Q_{tot}
Q^{i}
s_{T}
Q(s_{T},\varnothing)=0
\varnothing
Q_{tot}
\vec{o}
s
\small\begin{split}&Q_{tot}(\vec{o_{t}},\vec{a_{t}})=\sum_{x_{j}\in\mathbb{X}_%
{1}}PathIG^{\tau_{t}^{T}}_{j}(\vec{o_{t}},\vec{a_{t}})+...+\sum_{x_{j}\in%
\mathbb{X}_{n}}PathIG^{\tau_{t}^{T}}_{j}(\vec{o_{t}},\vec{a_{t}}).\\
\end{split}
\tau_{t}^{T}
t
T
\mathbb{X}_{i}
i
Q_{tot}
Q_{tot}
\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau}_{j}(\vec{o_{t}},\vec{a_{t}})
i
Q^{i}(\vec{o_{t}},\vec{a_{t}})
Q^{i}(\vec{o_{t}},\vec{a_{t}})\approx\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau%
_{t}^{T}}_{j}(\vec{o_{t}},\vec{a_{t}}).
\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau_{t}^{T}}_{j}(\vec{o_{t}},\vec{a_{t}})
\tau_{t}^{T}
(\vec{o}_{t+1},\vec{a}_{t+1})
(\vec{o}_{t},\vec{a}_{t})
\small\begin{split}&\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau_{t}^{T}}_{j}(%
\vec{o_{t}},\vec{a_{t}})=\\
&\sum_{x_{j}\in\mathbb{X}_{i}}IG^{\tau_{t}^{t+1}}_{j}(\vec{o},\vec{a})+\sum_{x%
_{j}\in\mathbb{X}_{i}}IG^{\tau_{t+1}^{t+2}}_{j}(\vec{o},\vec{a})+...+\sum_{x_{%
j}\in\mathbb{X}_{i}}IG^{\tau_{T-1}^{T}}_{j}(\vec{o},\vec{a}).\end{split}
Q_{tot}
Q^{i}
Q^{i}
Q_{tot}
F
\vec{x}
\vec{b}
F:R^{d}\leftarrow R
\sum_{j=1}^{|\vec{x}|}IG^{\tau}_{j}(\vec{x})=F(\vec{x})-F(\vec{b}),
j
|\vec{x}|
\tau
\vec{x}
\vec{b}
PathIG
IG
Q_{tot}
\tau_{t}^{T}
t
T
Q_{tot}(\vec{o}_{t},\vec{a}_{t})=\sum_{i=1}^{n}\sum_{x_{j}\in\mathbb{X}_{i}}%
PathIG^{\tau_{t}^{T}}_{j}(\vec{o},\vec{a}).
\vec{x}_{t}
(\vec{o}_{t},\vec{a}_{t})
\tau_{t}^{T}
(\tau_{t}^{t+1},\tau_{t+1}^{t+2},...,\tau_{T-1}^{T})
\tau_{t}^{t+1}
(\vec{o}_{t},\vec{a}_{t})
(\vec{o}_{t+1},\vec{a}_{t+1})
\small\begin{split}&\;\,Q_{tot}(\vec{o}_{t},\vec{a}_{t})=Q_{tot}(\vec{x}_{t})=%
Q_{tot}(\vec{x}_{t})-Q_{tot}(\vec{x}_{T})=Q_{tot}(\vec{x}_{t})-Q_{tot}(\vec{x}%
_{t+1})\\
&\;\,+Q_{tot}(\vec{x}_{t+1})-Q_{tot}(\vec{x}_{t+2})+...+Q_{tot}(\vec{x}_{T-1})%
-Q_{tot}(\vec{x_{T}})\\
&=\sum_{j=1}^{|\vec{x_{t}}|}IG^{\tau_{t}^{t+1}}_{j}(\vec{x})+\sum_{j=1}^{|\vec%
{x_{t}}|}IG^{\tau_{t+1}^{t+2}}_{j}(\vec{x})+...+\sum_{j=1}^{|\vec{x_{t}}|}IG^{%
\tau_{T-1}^{T}}_{j}(\vec{x})\\
&=PathIG^{\tau_{t}^{T}}_{j=1}(\vec{x})+PathIG^{\tau_{t}^{T}}_{j=2}(\vec{x})+..%
.+PathIG^{\tau_{t}^{T}}_{j=|\vec{x_{t}}|}(\vec{x})\\
&=\sum_{x_{j}\in\mathbb{X}_{1}}PathIG^{\tau_{t}^{T}}_{j}(\vec{x})+\sum_{x_{j}%
\in\mathbb{X}_{2}}PathIG^{\tau_{t}^{T}}_{j}(\vec{x})+...+\sum_{x_{j}\in\mathbb%
{X}_{n}}PathIG^{\tau_{t}^{T}}_{j}(\vec{x})\\
&=\sum_{i=1}^{n}\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau_{t}^{T}}_{j}(\vec{x}%
)=\sum_{i=1}^{n}\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau_{t}^{T}}_{j}(\vec{o}%
,\vec{a})\end{split}
Q_{tot}
\theta^{c}
\widetilde{\theta}^{c}
\theta^{\boldsymbol{\pi}}=(\theta^{1},...,\theta^{n})
e
s_{0}=
t=0
h_{0}^{i}=\boldsymbol{0}
i
s_{t}\neq
t<T
t=t+1
i
Q^{i}(o_{t,i},\cdot),h_{t}^{i}=
(o_{t,i},h_{t-1}^{i};\theta^{i})
a_{t,i}
\pi_{i}(Q^{i}(o_{t,i},\cdot),\epsilon(e))
(a_{t,1},a_{t,2},...,a_{t,n})
r_{t}
s_{t+1}
e
t=1
T
y_{t}
\widetilde{\theta}^{c}
\theta^{c}
\mathcal{L}(\theta^{c})
C
\widetilde{\theta}^{c}=\theta^{c}
e
t=1
T
e
Q_{tot}
t
\widetilde{Q}^{i}_{t}=\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau}_{x_{j}}(\vec{%
o_{t}},\vec{a_{t}})
i
\theta^{\pi}
\mathcal{L}(\theta^{i})
i
Q_{tot}
\mathcal{L}(\theta^{c})
\begin{split}\mathcal{L}(\theta^{c})&=E_{\vec{o},\vec{a},r,\vec{o}^{\prime}}[(%
Q_{tot}^{\theta^{c}}(o_{1},...,o_{n},a_{1},...,a_{n})-y)^{2}],\\
&y=r+\gamma(Q_{tot}^{\widetilde{\theta}^{c}}(o_{1}^{\prime},...,o_{n}^{\prime}%
,a_{1}^{\prime},...,a_{n}^{\prime}),\end{split}
\theta^{c}
\widetilde{\theta}^{c}
C
i
\theta^{i}
\widetilde{Q}^{i}
i
i
\begin{split}\mathcal{L}(\theta^{i})&=E_{\vec{o},\vec{a},r,\vec{o}^{\prime}}[(%
Q^{i,\theta^{i}}(o_{i},a_{i})-\widetilde{Q}^{i})^{2}],\\
&\widetilde{Q}^{i}=\sum_{x_{j}\in\mathbb{X}_{i}}PathIG^{\tau}_{j}(\vec{o},\vec%
{a}).\end{split}
\epsilon
\epsilon(e)
\epsilon(e)=\max{(\epsilon_{init}-e*\delta,0)},
e
\epsilon_{init}
\delta
\epsilon
|A|
\gamma
5\times 10^{-4}
(\vec{o}_{t},\vec{a}_{t})
(\vec{o}_{t+1},\vec{a}_{t+1})
m
\vec{x}_{t}
(\vec{o}_{t},\vec{a}_{t})
\small\begin{split}&\widetilde{IG}^{\tau_{t}^{t+1}}_{j}(\vec{o}_{t},\vec{a}_{t%
})=\widetilde{IG}^{\tau_{t}^{t+1}}_{j}(\vec{x}_{t})::=\\
&(\vec{x}_{t,j}-\vec{x}_{t+1,j})\times\sum_{k=1}^{m}\frac{\partial F(\vec{x}_{%
t+1}+\frac{k}{m}\times(\vec{x}_{t}-\vec{x}_{t+1}))}{\partial(\vec{x}_{t+1}+%
\frac{k}{m}\times(\vec{x}_{t}-\vec{x}_{t+1}))}\times\frac{1}{m}.\end{split}
m
m
\epsilon
\widetilde{m}
\overline{m}
\small{\widetilde{m}}
\small{\overline{m}}
\small{\widetilde{m}}
\small{\overline{m}}
\small{\widetilde{m}}
\small{\overline{m}}
\small{\widetilde{m}}
\small{\overline{m}}
\small{\widetilde{m}}
\small{\overline{m}}
