u\in\mathbb{R}^{n}
y=\sigma\left(\sum_{i=1}^{n}W_{i}u_{i}+b\right)=\sigma(W^{\top}u+b),
y
W_{i}
b
y_{\i}^{[\prev]}
y^{[0]}=u
y^{[1]}=y
W_{i}
y^{[1]}_{1}
y^{[0]}=u
y^{[1]}=y
W_{i}
y^{[1]}_{1}
\sigma:\mathbb{R}\rightarrow\mathbb{R}
\sigma(y)=\begin{cases}1&\text{if }y\geq 0,\\
0&\text{if }y<0.\end{cases}
\displaystyle\sigma(y)=\frac{1}{1+\exp(-y)}
\displaystyle\sigma(y)
\displaystyle=\frac{1}{1+\exp(-y)}
\displaystyle\text{sigmoid (logistic)},
\displaystyle\text{sigmoid (logistic)},
\displaystyle\sigma(y)=\tanh(y)=\frac{\exp(y)-\exp(-y)}{\exp(y)+\exp(-y)}
\displaystyle\sigma(y)
\displaystyle=\tanh(y)=\frac{\exp(y)-\exp(-y)}{\exp(y)+\exp(-y)}
\displaystyle\text{hyperbolic tangent},
\displaystyle\text{hyperbolic tangent},
\displaystyle\sigma(y)=\max\{y,0\}
\displaystyle\sigma(y)
\displaystyle=\max\{y,0\}
\displaystyle\text{rectified linear unit (ReLU)},
\displaystyle\text{rectified linear unit (ReLU)},
\displaystyle\sigma(y)=\max\{\alpha y,y\}
\displaystyle\sigma(y)
\displaystyle=\max\{\alpha y,y\}
\displaystyle\text{leaky ReLU}.
\displaystyle\text{leaky ReLU}.
\alpha=0.1
\alpha=0.1
\tanh
L
\mathcal{F}
W
b
P
P
P
\min_{W,b}\mathscr{L}(y,u,W,b)\qquad\text{s.t.}\qquad y=\mathcal{F}(u,W,b).
\mathcal{F}
u
S(u)
y
S(u)\in\mathbb{N}
S(u)\in\mathbb{R}
S(u)
256\times 256
[0,1]^{256}
u^{(i)}\in\mathbb{R}^{d}
S(u^{(i)})\in\mathbb{R}
i=1,\ldots,N
W\in\mathbb{R}^{d}
\sigma=\text{id}
y^{(i)}=W^{\top}u^{(i)},
W
y^{(i)}\approx S(u^{(i)})
\mathscr{L}(\{y^{(i)}\}_{i},\{u^{(i)}\}_{i},W):=\frac{1}{2N}\sum_{i=1}^{N}\|y^%
{(i)}-S(u^{(i)})\|^{2}.
\|\cdot\|=\|\cdot\|_{2}
U:=\begin{pmatrix}(u^{(1)})^{\top}\\
\vdots\\
(u^{(N)})^{\top}\end{pmatrix}\in\mathbb{R}^{N\times d},\qquad S:=\begin{%
pmatrix}S(u^{(1)})\\
\vdots\\
S(u^{(N)})\end{pmatrix}\in\mathbb{R}^{N},
\mathscr{L}(W)=\frac{1}{2}\|UW-S\|_{2}^{2}
W
\nabla_{W}\mathscr{L}(W)=U^{\top}UW-U^{\top}S
W=(U^{\top}U)^{-1}U^{\top}S
u
\left\{u^{(i)}\right\}_{i=1}^{N}\in\mathbb{R}^{d},
k\in\mathbb{N}
k\leq N
k\ll N
\mathscr{L}(c,\mu):=\sum_{i=1}^{N}\|u^{(i)}-\mu_{c^{(i)}}\|^{2},
\mathbb{R}^{d}
k=2
u^{(i)}
\mu_{j}
\mu_{1}
\mu_{2}
k=2
u^{(i)}
\mu_{j}
\mu_{1}
\mu_{2}
\mu_{1},\ldots,\mu_{k}
i=1:N
c^{(i)}:=\arg\min_{j}\|u^{(i)}-\mu_{j}\|^{2}
j=1:k
\mu_{j}\leftarrow\frac{\sum_{i=1}^{N}1_{\{c^{(i)}=j\}}u^{(i)}}{\sum_{i=1}^{N}1%
_{\{c^{(i)}=j\}}}
\mathscr{L}
\theta
W
b
\mathscr{L}(\theta)=\frac{1}{N}\sum_{i=1}^{N}\mathscr{L}^{(i)}(\theta),
\mathscr{L}^{(i)}
i
\mathscr{L}^{(i)}(\theta)=\frac{1}{2}\|y^{(i)}-S(u^{(i)})\|^{2}
\theta^{0}
\tau>0
k=0
\theta^{k+1}=\theta^{k}-\tau\cdot\nabla\mathscr{L}(\theta^{k})
k\leftarrow k+1
k
\|\mathscr{L}(\theta)\|<\epsilon
\epsilon>0
\|\theta^{k+1}-\theta^{k}\|<\epsilon
\tau
\theta
\tau
\theta
\mathscr{L}(\theta)
\theta^{0}
\tau>0
k=0
K
k\leq K
j\in\{1,\ldots,N\}
\theta^{k+1}=\theta^{k}-\tau\cdot\nabla\mathscr{L}^{(j)}(\theta^{k})
k\leftarrow k+1
K
\theta^{0}
\tau>0
k=0
K
b\in\mathbb{N}
k\leq K
b
j_{1},\ldots,j_{b}
\{1,\ldots,N\}
\theta^{k+1}=\theta^{k}-\tau\cdot\frac{1}{b}\sum_{i=1}^{b}\nabla\mathscr{L}^{(%
j_{i})}(\theta^{k})
k\leftarrow k+1
(g^{k})^{2}
g^{k}\odot g^{k}
(\beta_{1})^{k},(\beta_{2})^{k}
k
\beta_{1}
\beta_{2}
\theta^{0}
\tau>0
k=0
\beta_{1},\beta_{2}\in[0,1)
\epsilon>0
\widetilde{\mathscr{L}}(\theta)
m_{1}^{0}\leftarrow 0
m_{2}^{0}\leftarrow 0
\theta^{k}
g^{k+1}=\nabla_{\theta}\widetilde{\mathscr{L}}(\theta^{k})
m_{1}^{k+1}=\beta_{1}\cdot m_{1}^{k}+(1-\beta_{1})\cdot g^{k+1}
m_{2}^{k+1}=\beta_{2}\cdot m_{2}^{k}+(1-\beta_{2})\cdot(g^{k+1})^{2}
m_{1}^{k+1}\leftarrow\frac{m_{1}^{k+1}}{(1-(\beta_{1})^{k})}
m_{2}^{k+1}\leftarrow\frac{m_{2}^{k+1}}{(1-(\beta_{2})^{k})}
\theta^{k+1}=\theta^{k}-\tau\cdot\frac{m_{1}^{k+1}}{\left(\sqrt{m_{2}^{k+1}}+%
\epsilon\right)}
k\leftarrow k+1
\tau=0.001
\beta_{1}=0.9,\beta_{2}=0.999
\epsilon=10^{-8}
\widetilde{\mathscr{L}}(\theta)
r
p(u,W):=\sum_{j=0}^{r}W_{j}u^{j}=W^{\top}u,
u=(u^{0},...,u^{r})^{\top}\in\mathbb{R}^{r+1}
u
W:=(W_{0},...,W_{r})^{\top}\in\mathbb{R}^{r+1}
p
W
u
b
W
u^{(i)}
S(u^{(i)})
p
\mathscr{L}(W)=\frac{1}{2N}\sum_{i=1}^{N}\|p(u^{(i)},W)-S(u^{(i)})\|^{2}
\mathscr{L}(W)=\frac{1}{2N}\|UW-S\|^{2}
U:=\begin{pmatrix}u^{(1)}_{0}&u^{(1)}_{1}&\ldots&u^{(1)}_{r}\\
\vdots&\vdots&&\vdots\\
u^{(m)}_{0}&u^{(m)}_{1}&\ldots&u^{(m)}_{r}\end{pmatrix},\ S:=\begin{pmatrix}S(%
u^{(1)})\\
\vdots\\
S(u^{(m)}).\end{pmatrix}
W
r=0
r=1
r=3
r=9
r=0
r=1
r=3
r=9
g:\mathcal{U}^{N}\rightarrow\Theta
\mathcal{U}
\Theta
\theta=W
\hat{\theta}=(U^{\top}U)^{-1}U^{\top}S
\mathcal{U}^{N}
\hat{\theta}
\text{Var}(\hat{\theta}):=\mathbb{E}(\hat{\theta}^{2})-\mathbb{E}(\hat{\theta}%
)^{2},\ \text{Bias}(\hat{\theta}):=\mathbb{E}(\hat{\theta})-\theta,
\mathbb{E}
\text{MSE}(\hat{\theta}):=\mathbb{E}[(\hat{\theta}-{\theta})^{2}]=\text{Var}(%
\hat{\theta})+\text{Bias}(\hat{\theta})^{2}.
r
\mathscr{L}_{\lambda}(\theta):=\mathscr{L}(\theta)+\lambda\|\theta\|^{2}.
\|\cdot\|_{1}
r
\lambda
\theta
\lambda
r
\lambda
r
\lambda
\tau
4^{5}=1024
y^{[0]}\in\mathbb{N}^{2}
y^{[1]}\in\mathbb{N}
y_{\i}^{[\prev]}
y^{[0]}_{1}
y^{[0]}_{2}
y^{[0]}_{1}
y^{[0]}_{2}
y^{[1]}_{1}
y_{1}^{[1]}=\begin{cases}1,&\text{if }W_{1}y^{[0]}_{1}+W_{2}y^{[0]}_{2}+b\geq 0%
,\\
0,&\text{else }.\end{cases}
W_{1},W_{2},b
W_{1}=W_{2}=1
b=-1
W_{1},W_{2}
b
y^{[0]}_{1}
y^{[0]}_{2}
y^{[0]}_{1}
y^{[0]}_{2}
y^{[1]}_{1}
\mathcal{F}
\ell=0,\ldots,L
L
n_{\ell}
y^{[0]}=u\in\mathbb{R}^{n_{0}}
\ell
\ell+1
W^{[\ell]}\in\mathbb{R}^{n_{\ell+1}\times n_{\ell}}
b^{[\ell]}\in\mathbb{R}^{n_{\ell+1}}
\ell=0,\ldots,L-1
\sigma:\mathbb{R}\rightarrow\mathbb{R}
\sigma:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}
(y_{1},\ldots,y_{n})^{\top}\mapsto(\sigma(y_{1}),\ldots,\sigma(y_{n}))^{\top}
y^{[\ell]}=f_{\ell}(y^{[\ell-1]})=\sigma^{[\ell]}(W^{[\ell-1]}y^{[\ell-1]}+b^{%
[\ell-1]})\qquad\text{for }\ell=1,\ldots,L,
\sigma^{[\ell]}
y^{[\ell]}
\ell
y^{[L]}=\mathcal{F}(u)=f_{L}\circ f_{L-2}\circ\ldots\circ f_{1}(u).
\sigma
y^{[L]}
u
y^{[L]}=W^{[L-1]}y^{[L-1]}
W^{[L-1]}
y_{\i}^{[\prev]}
n_{0}=n_{1}=2,n_{2}=1
L=2
n_{0}=n_{1}=2,n_{2}=1
L=2
W^{[0]}=\begin{pmatrix}1&1\\
-1&-1\end{pmatrix},\quad b^{[0]}=\begin{pmatrix}-1\\
1\end{pmatrix},\quad W^{[1]}=\begin{pmatrix}1&1\end{pmatrix},\quad b^{[1]}=-2,
y^{[0]}_{1}
y^{[0]}_{2}
y^{[1]}_{1}
y^{[1]}_{2}
y^{[0]}_{1}
y^{[0]}_{2}
y^{[2]}_{1}
P_{\ell}
P_{\ell}
P_{\ell}
\displaystyle\min_{\{W^{[\ell]}\}_{\ell},\{b^{[\ell]}\}_{\ell}}\mathscr{L}%
\left(\{y^{[L](i)}\}_{i},\{u^{(i)}\}_{i},\{W^{[\ell]}\}_{\ell},\{b^{[\ell]}\}_%
{\ell}\right)
\displaystyle\min_{\{W^{[\ell]}\}_{\ell},\{b^{[\ell]}\}_{\ell}}\mathscr{L}%
\left(\{y^{[L](i)}\}_{i},\{u^{(i)}\}_{i},\{W^{[\ell]}\}_{\ell},\{b^{[\ell]}\}_%
{\ell}\right)
\displaystyle\qquad\;\text{s.t.}\qquad y^{[L](i)}=\mathcal{F}\left(u^{(i)},\{W%
^{[\ell]}\}_{\ell},\{b^{[\ell]}\}_{\ell}\right).
\displaystyle\qquad\;\text{s.t.}\qquad y^{[L](i)}=\mathcal{F}\left(u^{(i)},\{W%
^{[\ell]}\}_{\ell},\{b^{[\ell]}\}_{\ell}\right).
\theta
\underbrace{n_{0}\cdot n_{1}+\ldots+n_{L-1}\cdot n_{L}}_{\text{weights}}+%
\underbrace{n_{1}+\ldots+n_{L}.}_{\text{biases}}
y_{\i}^{[\prev]}
n_{0}=3,n_{1}=n_{2}=n_{3}=5,n_{4}=1
L=4
\theta\in\mathbb{R}^{86}.
n_{0}=3,n_{1}=n_{2}=n_{3}=5,n_{4}=1
L=4
\theta\in\mathbb{R}^{86}.
f:\mathbb{R}^{n_{0}}\rightarrow\mathbb{R}^{n_{L}}
L=2
\frac{1}{4}
\theta^{0}
\theta^{0}
\theta=0
b^{[\ell]}
W^{[\ell]}
\tanh
\frac{1}{\sqrt{n_{\ell}}}
W^{[\ell]},\ell=0,\ldots,L-1
b^{[\ell]}=0
\text{Var}(y^{[\ell+1]})=\text{Var}(y^{[\ell]})
\sqrt{\frac{2}{n_{\ell}}}.
b
y^{[\ell]}_{j}\in\mathbb{R}^{n_{\ell}}
\ell
j=1,\ldots,b
\mu^{[\ell]}=\frac{1}{b}\sum_{j=1}^{b}y^{[\ell]}_{j},\qquad(\sigma^{2})^{[\ell%
]}=\frac{1}{b}\sum_{j=1}^{b}\left\|y^{[\ell]}_{j}-\mu^{[\ell]}\right\|^{2}.
y^{[\ell]}_{j},j=1,\ldots,b
\hat{y}^{[\ell]}_{j}=\frac{y_{j}^{[\ell]}-\mu^{[\ell]}}{\sqrt{(\sigma^{2})^{[%
\ell]}+\epsilon}},
\epsilon\in\mathbb{R}
y^{[\ell+1]}_{j}=W^{[\ell]}\hat{y}^{[\ell]}_{j}+b^{[\ell]}\qquad\forall\,j=1,%
\ldots,b.
W^{[\ell]}\in\mathbb{R}^{n_{\ell+1}\times n_{\ell}}
b^{[\ell]}\in\mathbb{R}^{n_{\ell+1}}
b
b
S(u)\in\mathbb{N}
y^{[L]}\in[0,1]
P(y^{[L]}=1\,|\,u,\theta),
u
\theta
y^{[L-1]}\in\mathbb{R}
\sigma^{[L-1]}
y^{[L]}
\mathscr{L}
y^{[L]}\in[0,1]
\sigma(y)=\frac{1}{1+\exp(-y)}=\frac{\exp(y)}{\exp(y)+1}\in(0,1).
y^{[L]}\in\{0,1\}
P(y^{[L]}=S(u)\,|\,u,\theta)
S(u)
u
P\left(y^{[L]}=S(u)\,|\,u,\theta\right)=(y^{[L]})^{S(u)}(1-y^{[L]})^{(1-S(u))}.
\bar{\theta}
\displaystyle\bar{\theta}=\underset{\theta}{\operatorname{argmax}}\sum_{i=1}^{%
N}\log\left(P\left(y^{[L](i)}=S(u^{(i)})\,|\,u^{(i)},\theta\right)\right)
\displaystyle\bar{\theta}
\displaystyle=\underset{\theta}{\operatorname{argmax}}\sum_{i=1}^{N}\log\left(%
P\left(y^{[L](i)}=S(u^{(i)})\,|\,u^{(i)},\theta\right)\right)
\displaystyle=\underset{\theta}{\operatorname{argmax}}\sum_{i=1}^{N}\log\left(%
(y^{[L](i)})^{S(u^{(i)})}(1-y^{[L](i)})^{(1-S(u^{(i)}))}\right)
\displaystyle=\underset{\theta}{\operatorname{argmax}}\sum_{i=1}^{N}\log\left(%
(y^{[L](i)})^{S(u^{(i)})}(1-y^{[L](i)})^{(1-S(u^{(i)}))}\right)
\displaystyle=\underset{\theta}{\operatorname{argmax}}\sum_{i=1}^{N}S(u^{(i)})%
\cdot\log(y^{[L](i)})+(1-S(u^{(i)}))\cdot\log(1-y^{[L](i)})
\displaystyle=\underset{\theta}{\operatorname{argmax}}\sum_{i=1}^{N}S(u^{(i)})%
\cdot\log(y^{[L](i)})+(1-S(u^{(i)}))\cdot\log(1-y^{[L](i)})
\displaystyle=\underset{\theta}{\operatorname{argmin}}\sum_{i=1}^{N}%
\underbrace{-S(u^{(i)})\cdot\log(y^{[L](i)})-(1-S(u^{(i)}))\cdot\log(1-y^{[L](%
i)})}_{=:\mathcal{L}\left(y^{[L](i)},S(u^{(i)})\right),\;\textbf{Binary Cross %
Entropy Loss}},
\displaystyle=\underset{\theta}{\operatorname{argmin}}\sum_{i=1}^{N}%
\underbrace{-S(u^{(i)})\cdot\log(y^{[L](i)})-(1-S(u^{(i)}))\cdot\log(1-y^{[L](%
i)})}_{=:\mathcal{L}\left(y^{[L](i)},S(u^{(i)})\right),\;\textbf{Binary Cross %
Entropy Loss}},
y^{[L](i)}
\theta
S(u)=1
S(u)=0
\mathscr{L}\left(y^{[L]},S(u)\right)=\begin{cases}-\log(y^{[L]}),&\text{if }S(%
u)=1,\\
-\log(1-y^{[L]}),&\text{if }S(u)=0.\end{cases}
S(u)=1
S(u)=0
S(u)=1
S(u)=0
S(u)=1
y^{[L]}\nearrow 1
y^{[L]}\searrow 0
S(u)=0
y^{[L]}\searrow 0
y^{[L]}\nearrow 1
\mathscr{L}(\theta)=\frac{1}{N}\sum_{i=1}^{N}\mathcal{L}\left(y^{[L](i)}(%
\theta),S(u^{(i)})\right).
28\times 28
\{0,1,2,3,4,5,6,7,8,9\}
\Cstr[\n]_{{>}{1}{\foreach\j in{1,...,\Nnod[\prev]}{\draw[white,linewidth=1.2,%
shorten>=1](N\prev-\j)--(N\Ncnt-\i);\draw[connect](N\prev-\j)--(N\Ncnt-\i);}}{%
}\par}\path(N\lay-\N)--++(0,1+0.55)node[midway,scale=1.6]{$\vdots$};
L=4
n_{0}=784
n_{4}=10
L=4
n_{0}=784
n_{4}=10
y^{[L-1]}\in\mathbb{R}^{n}
y^{[L]}\in[0,1]^{n}
\sum_{i=1}^{n}y^{[L]}_{i}=1
n_{L-1}=n_{L}=n
\operatorname{softmax}(y)_{i}=\frac{\exp(y_{i})}{\sum_{j=1}^{n}\exp(y_{j})}\in%
(0,1),\qquad\text{for }i=1,\ldots,n.
S(u)\in\{0,1,2,3,4,5,6,7,8,9\}
S(u)\in\mathbb{N}
\mathscr{L}(\theta)=\frac{1}{N}\sum_{1=1}^{N}-\log\left(P\left(y^{[L](i)}=S(u^%
{(i)})\,|\,u^{(i)},\theta\right)\right).
\mathscr{L}
\nabla\mathscr{L}(\theta)
\theta
u
y^{[L]}
\nabla\mathscr{L}(\theta)
\theta\in\mathbb{R}^{K}
K=n_{0}\cdot n_{1}+\ldots+n_{L-1}\cdot n_{L}+n_{1}+\ldots+n_{L}.
\nabla\mathscr{L}(\theta)=\begin{pmatrix}\frac{\partial\mathscr{L}(\theta)}{%
\partial\theta_{1}}\\
\vdots\\
\frac{\partial\mathscr{L}(\theta)}{\partial\theta_{K}}\end{pmatrix}.
y^{[\prev]}
\mathscr{L}
W^{[0]}
W^{[1]}
W^{[2]}
L=3
L=3
W^{[\ell]}\in\mathbb{R}
\theta=(W^{[0]},W^{[1]},W^{[2]})^{\top}
y^{[3]}=\sigma^{[3]}(W^{[2]}y^{[2]})=\sigma^{[3]}\left(W^{[2]}\sigma^{[2]}(W^{%
[1]}y^{[1]})\right)=\sigma^{[3]}\left(W^{[2]}\sigma^{[2]}\left(W^{[1]}\sigma^{%
[1]}(W^{[0]}y^{[0]})\right)\right),
\mathscr{L}(\theta)=\mathscr{L}(y^{[3]}(\theta))=\mathscr{L}\left(\sigma^{[3]}%
\left(W^{[2]}\sigma^{[2]}\left(W^{[1]}\sigma^{[1]}(W^{[0]}y^{[0]})\right)%
\right)\right).
\displaystyle\frac{\partial\mathscr{L}}{\partial W^{[0]}}=\frac{\partial%
\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y^{[3]}}{\partial W^{[0]}}
\displaystyle\frac{\partial\mathscr{L}}{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y%
^{[3]}}{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y%
^{[3]}}{\partial y^{[2]}}\cdot\frac{\partial y^{[2]}}{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y%
^{[3]}}{\partial y^{[2]}}\cdot\frac{\partial y^{[2]}}{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y%
^{[3]}}{\partial y^{[2]}}\cdot\frac{\partial y^{[2]}}{\partial y^{[1]}}\cdot%
\frac{\partial y^{[1]}}{\partial W^{[0]}},
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y%
^{[3]}}{\partial y^{[2]}}\cdot\frac{\partial y^{[2]}}{\partial y^{[1]}}\cdot%
\frac{\partial y^{[1]}}{\partial W^{[0]}},
L
\frac{\partial\mathscr{L}}{\partial W^{[\ell]}}=\frac{\partial\mathscr{L}}{%
\partial y^{[L]}}\cdot\prod_{j=L}^{\ell+2}\frac{\partial y^{[j]}}{\partial y^{%
[j-1]}}\cdot\frac{\partial y^{[\ell+1]}}{\partial W^{[\ell]}}.
\frac{\partial\mathscr{L}}{\partial y^{[L]}}
W^{[L-1]}
W^{[L-2]}
\displaystyle\hskip 113.81102ptz^{[\ell]}=W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]}
\displaystyle\hskip 113.81102ptz^{[\ell]}
\displaystyle=W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]}
\displaystyle\in\mathbb{R}^{n_{\ell}},\hskip 113.81102pt
\displaystyle\in\mathbb{R}^{n_{\ell}},\hskip 113.81102pt
\displaystyle y^{[\ell]}=\sigma^{\ell]}(z^{[\ell]})
\displaystyle y^{[\ell]}
\displaystyle=\sigma^{\ell]}(z^{[\ell]})
\displaystyle\in\mathbb{R}^{n_{\ell}}.
\displaystyle\in\mathbb{R}^{n_{\ell}}.
\mathscr{L}
y^{[L]}
y^{[\ell]}
\ell\neq L
\ell=0,\ldots,L-1
\displaystyle\frac{\partial\mathscr{L}}{\partial W^{[\ell]}}=\frac{\partial%
\mathscr{L}}{\partial y^{[L]}}\cdot\prod_{j=L}^{\ell+2}\left(\frac{\partial y{%
[j]}}{\partial z^{[j]}}\cdot\frac{\partial z^{[j]}}{\partial y^{[j-1]}}\right)%
\cdot\frac{\partial y^{[\ell+1]}}{\partial z^{[\ell+1]}}\cdot\frac{\partial z^%
{[\ell+1]}}{\partial W^{[\ell]}},
\displaystyle\frac{\partial\mathscr{L}}{\partial W^{[\ell]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[L]}}\cdot\prod_{j=L}^{%
\ell+2}\left(\frac{\partial y{[j]}}{\partial z^{[j]}}\cdot\frac{\partial z^{[j%
]}}{\partial y^{[j-1]}}\right)\cdot\frac{\partial y^{[\ell+1]}}{\partial z^{[%
\ell+1]}}\cdot\frac{\partial z^{[\ell+1]}}{\partial W^{[\ell]}},
\displaystyle\frac{\partial\mathscr{L}}{\partial b^{[\ell]}}=\frac{\partial%
\mathscr{L}}{\partial y^{[L]}}\cdot\prod_{j=L}^{\ell+2}\left(\frac{\partial y{%
[j]}}{\partial z^{[j]}}\cdot\frac{\partial z^{[j]}}{\partial y^{[j-1]}}\right)%
\cdot\frac{\partial y^{[\ell+1]}}{\partial z^{[\ell+1]}}\cdot\frac{\partial z^%
{[\ell+1]}}{\partial b^{[\ell]}}.
\displaystyle\frac{\partial\mathscr{L}}{\partial b^{[\ell]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[L]}}\cdot\prod_{j=L}^{%
\ell+2}\left(\frac{\partial y{[j]}}{\partial z^{[j]}}\cdot\frac{\partial z^{[j%
]}}{\partial y^{[j-1]}}\right)\cdot\frac{\partial y^{[\ell+1]}}{\partial z^{[%
\ell+1]}}\cdot\frac{\partial z^{[\ell+1]}}{\partial b^{[\ell]}}.
A,B\in\mathbb{R}^{m\times n}
A\odot B\in\mathbb{R}^{m\times n}
(A\odot B)_{i,j}:=(A)_{i,j}\cdot(B)_{i,j},\qquad\text{for }i=1,\ldots,m,\,j=1,%
\ldots,n,
A
B
\sigma:\mathbb{R}^{m}\rightarrow\mathbb{R}^{m}
\sigma^{\prime}:\mathbb{R}^{m}\rightarrow\mathbb{R}^{m},\qquad z=\begin{%
pmatrix}z_{1}\\
\vdots\\
z_{m}\end{pmatrix}\mapsto\begin{pmatrix}\sigma^{\prime}(z_{1})\\
\vdots\\
\sigma^{\prime}(z_{m})\end{pmatrix}=\sigma^{\prime}(z).
a=\sigma(z)\in\mathbb{R}^{m}
\sigma
z\in\mathbb{R}^{m}
f=f(a)\in\mathbb{R}
\;\frac{\partial f}{\partial z}=\frac{\partial f}{\partial a}\odot\sigma^{%
\prime}(z)\;\;\in\mathbb{R}^{m}.
z=Wy+b\in\mathbb{R}^{m}
f=f(z)\in\mathbb{R}
W\in\mathbb{R}^{m\times n}
y\in\mathbb{R}^{n}
\displaystyle\hskip 128.0374pt\frac{\partial f}{\partial y}=W^{\top}\cdot\frac%
{\partial f}{\partial z}
\displaystyle\hskip 128.0374pt\frac{\partial f}{\partial y}
\displaystyle=W^{\top}\cdot\frac{\partial f}{\partial z}
\displaystyle\in\mathbb{R}^{n},\hskip 128.0374pt
\displaystyle\in\mathbb{R}^{n},\hskip 128.0374pt
\displaystyle\frac{\partial f}{\partial W}=\frac{\partial f}{\partial z}\cdot y%
^{\top}
\displaystyle\frac{\partial f}{\partial W}
\displaystyle=\frac{\partial f}{\partial z}\cdot y^{\top}
\displaystyle\in\mathbb{R}^{m\times n},
\displaystyle\in\mathbb{R}^{m\times n},
\displaystyle\frac{\partial f}{\partial b}=\frac{\partial f}{\partial z}
\displaystyle\frac{\partial f}{\partial b}
\displaystyle=\frac{\partial f}{\partial z}
\displaystyle\in\mathbb{R}^{m}.
\displaystyle\in\mathbb{R}^{m}.
\frac{\partial\mathscr{L}}{\partial y^{[L]}}\in\mathbb{R}^{n_{L}}
f=\mathscr{L},z=z^{[L]},a=y^{[L]}
\bar{z}^{[L]}:=\frac{\partial\mathscr{L}}{\partial z^{[L]}}=\frac{\partial%
\mathscr{L}}{\partial y^{[L]}}\odot(\sigma^{[L]})^{\prime}(z^{[L]})\qquad\in%
\mathbb{R}^{n_{L}}.
\bar{y}^{[L-1]}:=\frac{\partial\mathscr{L}}{\partial y^{[L-1]}}=\bar{z}^{[L]}%
\cdot\frac{\partial z^{[L]}}{\partial y^{[L-1]}}\qquad\in\mathbb{R}^{n_{L-1}},
f=\mathscr{L}
y=y^{[L-1]},W=W^{[L-1]},z=z^{[L]}
\bar{y}^{[L-1]}=(W^{[L-1]})^{\top}\bar{z}^{[L]}.
\bar{y}^{[L-1]}
\bar{z}^{[L-1]}
\ell=0,\ldots,L-1
\bar{W}^{[\ell]}:=\frac{\partial\mathscr{L}}{\partial W^{[\ell]}}
\bar{b}^{[\ell]}:=\frac{\partial\mathscr{L}}{\partial b^{[\ell]}}
\ell=L-1
\displaystyle\bar{W}^{[L-1]}=\bar{z}^{[L]}\cdot\frac{\partial z^{[L]}}{%
\partial W^{[L-1]}}\qquad\in\mathbb{R}^{n_{L}\times n_{L-1}},
\displaystyle\bar{W}^{[L-1]}
\displaystyle=\bar{z}^{[L]}\cdot\frac{\partial z^{[L]}}{\partial W^{[L-1]}}%
\qquad\in\mathbb{R}^{n_{L}\times n_{L-1}},
\displaystyle\bar{b}^{[L-1]}=\bar{z}^{[L]}\cdot\frac{\partial z^{[L]}}{%
\partial b^{[L-1]}}\qquad\;\,\,\in\mathbb{R}^{n_{L}}.
\displaystyle\bar{b}^{[L-1]}
\displaystyle=\bar{z}^{[L]}\cdot\frac{\partial z^{[L]}}{\partial b^{[L-1]}}%
\qquad\;\,\,\in\mathbb{R}^{n_{L}}.
\bar{y}^{[L-1]}
b=b^{[L-1]}
\displaystyle\bar{W}^{[L-1]}=\bar{z}^{[L]}(y^{[L-1]})^{\top},
\displaystyle\bar{W}^{[L-1]}
\displaystyle=\bar{z}^{[L]}(y^{[L-1]})^{\top},
\displaystyle\bar{b}^{[L-1]}=\bar{z}^{[L]}.
\displaystyle\bar{b}^{[L-1]}
\displaystyle=\bar{z}^{[L]}.
W^{[\ell]}
b^{[\ell]}
\tau
N
i=1,\ldots,N
\nabla\mathscr{L}(\theta)
\{u^{(i)},S(u^{(i)})\}_{i=1}^{N}
W^{[\ell]}
b^{[\ell]}
\ell=0,\ldots,L-1
\sigma^{[\ell]}
\ell=1,\ldots,L
\mathscr{L}(y^{[L]})
\nabla\mathscr{L}(y^{[L]})=\frac{\partial\mathscr{L}}{\partial y^{[L]}}\in%
\mathbb{R}^{n_{L}}
y^{[0](i)}=u^{(i)}\in\mathbb{R}^{n_{0}}\quad
i=1,\ldots,N
\ell=1,\ldots,L
z^{[\ell](i)}=W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]}\in\mathbb{R}^{n_{\ell}}\quad
i=1,\ldots,N
y^{[\ell](i)}=\sigma^{[\ell]}(z^{[\ell](i)})\hskip 44.10185pt\in\mathbb{R}^{n_%
{\ell}}\quad
i=1,\ldots,N
\mathscr{L}=\frac{1}{N}\sum_{1=1}^{N}\mathscr{L}(y^{[L](i)})\in\mathbb{R}
\bar{y}^{[L](i)}=\frac{1}{N}\cdot\nabla\mathscr{L}(y^{[L](i)})\in\mathbb{R}^{n%
_{L}}\quad
i=1,\ldots,N
\ell=L,L-1,\ldots,1
\bar{z}^{[\ell](i)}\hskip 10.243pt=\bar{y}^{[\ell](i)}\odot(\sigma^{[\ell]})^{%
\prime}(z^{[\ell](i)})\hskip 6.82881pt\in\mathbb{R}^{n_{\ell}}\quad
i=1,\ldots,N
\bar{y}^{[\ell-1](i)}=(W^{[\ell-1]})^{\top}\bar{z}^{[\ell](i)}\hskip 30.44466%
pt\in\mathbb{R}^{n_{\ell-1}}\quad
i=1,\ldots,N
\bar{W}^{[\ell-1]}\hskip 3.69899pt=\sum_{1=1}^{N}\bar{z}^{[\ell](i)}(y^{[\ell-%
1](i)})^{\top}\in\mathbb{R}^{n_{\ell}\times n_{\ell-1}}
\bar{b}^{[\ell-1]}\hskip 10.52737pt=\sum_{1=1}^{N}\bar{z}^{[\ell](i)}\hskip 47%
.23167pt\in\mathbb{R}^{n_{\ell}}
n_{0,1}\times n_{0,2}
n_{0,1}=n_{0,2}=28
\mathbb{R}^{n_{0,1}\cdot n_{0,2}}=\mathbb{R}^{784}
n_{0,1}=n_{0,2}=1000
n_{0}=10^{6}
W^{[0]}\in\mathbb{R}^{n_{1}\times 10^{6}}
\ell
Y
f,g:\mathbb{R}^{n}\to\mathbb{R}
f
g
\displaystyle c(t)=(f\ast g)(t)=\int f(x)g(t-x)\,dx,
\displaystyle c(t)=(f\ast g)(t)=\int f(x)g(t-x)\,dx,
t\in\mathbb{R}^{n}
f
g
c:\mathbb{R}^{n}\rightarrow\mathbb{R}
f,g:\mathbb{Z}^{n}\to\mathbb{R}
\displaystyle c(t)=(f\ast g)(t)=\sum_{x\in\mathbb{Z}^{n}}f(x)g(t-x),
\displaystyle c(t)=(f\ast g)(t)=\sum_{x\in\mathbb{Z}^{n}}f(x)g(t-x),
t\in\mathbb{Z}^{n}
f
g
n
X
Y
\displaystyle f_{X}(t)=f_{Y}(t)=\begin{cases}\frac{1}{6},&\text{if }t\in\{1,2,%
3,4,5,6\},\\
0,&\text{if }t\in\mathbb{Z}\setminus\{1,2,3,4,5,6\}.\end{cases}
\displaystyle f_{X}(t)=f_{Y}(t)=\begin{cases}\frac{1}{6},&\text{if }t\in\{1,2,%
3,4,5,6\},\\
0,&\text{if }t\in\mathbb{Z}\setminus\{1,2,3,4,5,6\}.\end{cases}
\frac{1}{6}
\frac{1}{6}
f_{X+Y}(9)=\frac{1}{36}+\frac{1}{36}+\frac{1}{36}+\frac{1}{36}=\frac{1}{9},
\frac{1}{9}.
\displaystyle f_{X+Y}(9)=\sum_{x=1}^{6}f_{X}(x)f_{Y}(9-x)=(f_{X}\ast f_{Y})(9)
\displaystyle f_{X+Y}(9)=\sum_{x=1}^{6}f_{X}(x)f_{Y}(9-x)=(f_{X}\ast f_{Y})(9)
Y\in\mathbb{R}^{n_{1}\times n_{2}}
K\in\mathbb{R}^{m_{1}\times m_{2}}
m_{1}\leq n_{1}
m_{2}\leq n_{2}
Y
K
Y\ast K
\left[Y\ast K\right]_{i,j}:=\sum_{k=1}^{m_{1}}\sum_{l=1}^{m_{2}}K_{k,l}Y_{i+m_%
{1}-k,j+m_{2}-l},
1\leq i\leq n_{1}-m_{1}+1
1\leq j\leq n_{2}-m_{2}+1
Y
K
\left[Y\circledast K\right]_{i,j}:=\sum_{k=1}^{m_{1}}\sum_{l=1}^{m_{2}}K_{k,l}%
Y_{i{\color[rgb]{1,0,0}-1+k},j{\color[rgb]{1,0,0}-1+l}},
1\leq i\leq n_{1}-m_{1}+1
1\leq j\leq n_{2}-m_{2}+1
K
Y=\begin{pmatrix}1&5&-2&0&2\\
3&8&7&1&0\\
-1&0&1&2&3\\
4&2&1&-1&2\end{pmatrix},
K=\begin{pmatrix}1&2&3\\
4&5&6\\
7&8&9\end{pmatrix}.
[Y\ast K]_{1,1}
[Y\ast K]_{1,1}=\begin{pmatrix}+1\cdot 9&+5\cdot 8&-2\cdot 7&{\color[rgb]{%
.5,.5,.5}0}&{\color[rgb]{.5,.5,.5}2}\\
+3\cdot 6&+8\cdot 5&+7\cdot 4&{\color[rgb]{.5,.5,.5}1}&{\color[rgb]{.5,.5,.5}0%
}\\
-1\cdot 3&+0\cdot 2&+1\cdot 1&{\color[rgb]{.5,.5,.5}2}&{\color[rgb]{.5,.5,.5}3%
}\\
{\color[rgb]{.5,.5,.5}4}&{\color[rgb]{.5,.5,.5}2}&{\color[rgb]{.5,.5,.5}1}&{%
\color[rgb]{.5,.5,.5}-1}&{\color[rgb]{.5,.5,.5}2}\end{pmatrix}=9+40-14+18+40+2%
8-3+0+1=119.
Y
K
[Y\circledast K]_{1,1}=\begin{pmatrix}+1\cdot 1&+5\cdot 2&-2\cdot 3&{\color[%
rgb]{.5,.5,.5}0}&{\color[rgb]{.5,.5,.5}2}\\
+3\cdot 4&+8\cdot 5&+7\cdot 6&{\color[rgb]{.5,.5,.5}1}&{\color[rgb]{.5,.5,.5}0%
}\\
-1\cdot 7&+0\cdot 8&+1\cdot 9&{\color[rgb]{.5,.5,.5}2}&{\color[rgb]{.5,.5,.5}3%
}\\
{\color[rgb]{.5,.5,.5}4}&{\color[rgb]{.5,.5,.5}2}&{\color[rgb]{.5,.5,.5}1}&{%
\color[rgb]{.5,.5,.5}-1}&{\color[rgb]{.5,.5,.5}2}\end{pmatrix}=1+10-6+12+40+42%
-7+0+9=101.
[Y\circledast K]_{1,2}=\begin{pmatrix}{\color[rgb]{.5,.5,.5}1}&+5\cdot 1&-2%
\cdot 2&+0\cdot 3&{\color[rgb]{.5,.5,.5}2}\\
{\color[rgb]{.5,.5,.5}3}&+8\cdot 4&+7\cdot 5&+1\cdot 6&{\color[rgb]{.5,.5,.5}0%
}\\
{\color[rgb]{.5,.5,.5}-1}&+0\cdot 7&+1\cdot 8&+2\cdot 9&{\color[rgb]{.5,.5,.5}%
3}\\
{\color[rgb]{.5,.5,.5}4}&{\color[rgb]{.5,.5,.5}2}&{\color[rgb]{.5,.5,.5}1}&{%
\color[rgb]{.5,.5,.5}-1}&{\color[rgb]{.5,.5,.5}2}\end{pmatrix}=5-4+0+32+35+6+0%
+8+18=100.
Y\ast K=\begin{pmatrix}119&120&53\\
155&155&102\end{pmatrix}\qquad\text{and}\qquad Y\circledast K=\begin{pmatrix}1%
01&100&87\\
95&55&58\end{pmatrix}.
Y\ast K\neq Y\circledast K
4\times 5
3\times 3
(1,1)
(1,2)
(2,1)
4\times 5
3\times 3
(1,1)
(1,2)
(2,1)
m\times m
m\times m
n_{1}\times n_{2}
n_{1}-m+1\times n_{2}-m+1
Y
p\in\mathbb{N}_{0}
p=0
Y
p=1
\hat{Y}=\begin{pmatrix}0&0&0&0&0&0&0\\
0&1&5&-2&0&2&0\\
0&3&8&7&1&0&0\\
0&-1&0&1&2&3&0\\
0&4&2&1&-1&2&0\\
0&0&0&0&0&0&0\end{pmatrix},
Y
\hat{Y}
(n_{1}+2p)\times(n_{2}+2p)
p
\displaystyle(n_{1}+2p)-m+1=n_{1},
\displaystyle(n_{1}+2p)-m+1
\displaystyle=n_{1},
\displaystyle(n_{2}+2p)-m+1=n_{2},
\displaystyle(n_{2}+2p)-m+1
\displaystyle=n_{2},
p=\frac{m-1}{2}
m
s\in\mathbb{N}
s=1
s=2
7\times 7
3\times 3
s=2
7\times 7
3\times 3
s=2
s>1
\left(\frac{n_{1}-m}{s}+1\right)\times\left(\frac{n_{2}-m}{s}+1\right).
M\in\mathbb{N}
m\times m
p
s
K
M\cdot m^{2}
M
Y\in\mathbb{R}^{n_{1}\times n_{2}}
\left(\frac{n_{1}+2p-m}{s}+1\right)\times\left(\frac{n_{2}+2p-m}{s}+1\right)%
\times M,
M
M
n_{1}\times n_{2}\times n_{3},
m\times m\times n_{3},
\left(\frac{n_{1}+2p-m}{s}+1\right)\times\left(\frac{n_{2}+2p-m}{s}+1\right)%
\times 1,
M
p=0
s=1
p=0
s=1
28\times 28
5\times 5
p=2
28\times 28\times 6
784\times 1
784
\underbrace{784\cdot 784}_{weight}+\underbrace{784}_{bias}=\textbf{615440}.
y^{[0]}_{1}
y^{[0]}_{2}
y^{[0]}_{3}
y^{[0]}_{4}
y^{[0]}_{5}
y^{[1]}_{1}
y^{[1]}_{2}
y^{[1]}_{3}
y^{[1]}_{4}
y^{[1]}_{5}
y^{[2]}_{1}
y^{[2]}_{2}
y^{[2]}_{3}
y^{[2]}_{4}
y^{[2]}_{5}
y^{[0]}
y^{[1]}
y^{[2]}
m=3
s=1
p=1
y^{[2]}_{3}
y^{[0]}
y^{[1]}
y^{[2]}
m=3
s=1
p=1
y^{[2]}_{3}
\sigma:\mathbb{R}\rightarrow\mathbb{R}
Y=\{Y_{i,j,k}\}_{i,j,k}
i=1,\ldots,n_{1},j=1,\ldots,n_{2},k=1,\ldots,n_{3}
\left(\sigma(Y)\right)_{i,j,k}=\sigma(Y_{i,j,k}).
Y
m\times m
s
p
p=0
m=s=2
n_{1}\times n_{2}
\left(\frac{n_{1}+2p-m}{s}+1\right)\times\left(\frac{n_{1}+2p-m}{s}+1\right)%
\quad\stackrel{{\scriptstyle m=s=2,p=0}}{{=}}\quad\frac{n_{1}}{2}\times\frac{n%
_{2}}{2}.
2\times 2
s=2
\left(\begin{array}[]{c c | c c}1&3&0&-7\\
-2&{\color[rgb]{0.6,0.21,0}4}&{\color[rgb]{0,0.6,0}1}&-1\\
\hline\cr 0&1&{\color[rgb]{0.77734375,0.09375,0.1484375}8}&-3\\
{\color[rgb]{0,0,0.8}2}&0&4&5\end{array}\right)\stackrel{{\scriptstyle\max}}{{%
\longrightarrow}}\left(\begin{array}[]{c | c}{\color[rgb]{0.6,0.21,0}4}&{%
\color[rgb]{0,0.6,0}1}\\
\hline\cr{\color[rgb]{0,0,0.8}2}&{\color[rgb]{0.77734375,0.09375,0.1484375}8}%
\end{array}\right)
2\times 2
K=\begin{pmatrix}0.25&0.25\\
0.25&0.25\end{pmatrix},
s=2
\hskip 34.14322pt\left(\begin{array}[]{c c | c c}{\color[rgb]{0.6,0.21,0}1}&{%
\color[rgb]{0.6,0.21,0}3}&{\color[rgb]{0,0.6,0}0}&{\color[rgb]{0,0.6,0}-7}\\
{\color[rgb]{0.6,0.21,0}-2}&{\color[rgb]{0.6,0.21,0}4}&{\color[rgb]{0,0.6,0}1}%
&{\color[rgb]{0,0.6,0}-1}\\
\hline\cr{\color[rgb]{0,0,0.8}0}&{\color[rgb]{0,0,0.8}1}&{\color[rgb]{%
0.77734375,0.09375,0.1484375}8}&{\color[rgb]{0.77734375,0.09375,0.1484375}-3}%
\\
{\color[rgb]{0,0,0.8}2}&{\color[rgb]{0,0,0.8}0}&{\color[rgb]{%
0.77734375,0.09375,0.1484375}4}&{\color[rgb]{0.77734375,0.09375,0.1484375}5}%
\end{array}\right)\stackrel{{\scriptstyle\text{avg}}}{{\longrightarrow}}\left(%
\begin{array}[]{c | c}{\color[rgb]{0.6,0.21,0}1.50}&{\color[rgb]{0,0.6,0}-1.75%
}\\
\hline\cr{\color[rgb]{0,0,0.8}0.75}&{\color[rgb]{0.77734375,0.09375,0.1484375}%
3.50}\end{array}\right)
m^{2}-1
s
p
5\times 5
s=1
p=2
5\times 5
s=1
p=2
\hat{Y}_{i,j,k}=\frac{Y_{i,j,k}}{\left(\kappa+\gamma\sum\limits_{m=\max(1,k-%
\frac{n}{2})}^{\min(M,k+\frac{n}{2})}(Y_{i,j,m})^{2}\right)^{\beta}}.
Y_{i,j,k}
\hat{Y}_{i,j,k}
i,j,k
Y
i=1,\ldots,n_{1}
j=1,\ldots,n_{2}
k=1,\ldots,M
M
\kappa,\gamma,\beta,n\in\mathbb{R}
\kappa
\gamma
\beta
n
\kappa=2,\gamma=10^{-4},\beta=0.75
n=2
Y_{1,1,1}
Y_{1,1,2}
Y_{1,2,1}
n=2
Y_{1,1,1}
Y_{1,1,2}
Y_{1,2,1}
\hat{Y}_{i,j,k}=\frac{Y_{i,j,k}}{\left(\kappa+\gamma\sum\limits_{p=\max(1,i-%
\frac{n}{2})}^{\min(n_{1},i+\frac{n}{2})}\sum\limits_{q=\max(1,j-\frac{n}{2})}%
^{\min(n_{2},j+\frac{n}{2})}(Y_{p,q,k})^{2}\right)^{\beta}}.
L
\frac{\partial\mathscr{L}}{\partial W^{[\ell]}}=\frac{\partial\mathscr{L}}{%
\partial y^{[L]}}\cdot\prod_{j=L}^{\ell+2}\frac{\partial y^{[j]}}{\partial y^{%
[j-1]}}\cdot\frac{\partial y^{[\ell+1]}}{\partial W^{[\ell]}}.
L
\frac{\partial y^{[j]}}{\partial y^{[j-1]}}<1
j
L
\frac{\partial y^{[j]}}{\partial y^{[j-1]}}>1
j
L
y^{[\ell]}=y^{[\ell-1]}+\sigma^{[\ell]}(W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]})%
\qquad\text{for }\ell=1,\ldots,L,
y^{[0]}=u
+y^{[\ell-1]}
y^{[\ell-1]}
W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]}
\sigma
+
y^{[\ell]}
y^{[\ell]}
n_{\ell}
P_{\ell-1}^{\ell}\in\mathbb{R}^{n_{\ell}\times n_{\ell-1}}
y^{[\ell]}=P_{\ell-1}^{\ell}y^{[\ell-1]}+\sigma^{[\ell]}(W^{[\ell-1]}y^{[\ell-%
1]}+b^{[\ell-1]})\qquad\text{for }\ell=1,\ldots,L,
y^{[\prev]}
\mathscr{L}
W^{[0]}
W^{[1]}
W^{[2]}
L=3
L=3
W^{[\ell]}\in\mathbb{R}
\theta=(W^{[0]},W^{[1]},W^{[2]})^{\top}
\mathscr{L}(\theta)=\mathscr{L}(y^{[3]}(\theta)).
\ell=1,\ldots,L
a^{[\ell]}:=\sigma^{[\ell]}(W^{[\ell-1]}y^{[\ell-1]}),
y^{[\ell]}=y^{[\ell-1]}+a^{[\ell]}.
\displaystyle\frac{\partial\mathscr{L}}{\partial W^{[0]}}=\frac{\partial%
\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y^{[3]}}{\partial W^{[0]}}
\displaystyle\frac{\partial\mathscr{L}}{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial y%
^{[3]}}{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial}%
{\partial W^{[0]}}(y^{[2]}+a^{[3]})
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\frac{\partial}%
{\partial W^{[0]}}(y^{[2]}+a^{[3]})
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\left(\frac{%
\partial y^{[2]}}{\partial W^{[0]}}+\frac{\partial a^{[3]}}{\partial y^{[2]}}%
\cdot\frac{\partial y^{[2]}}{\partial W^{[0]}}\right)
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\left(\frac{%
\partial y^{[2]}}{\partial W^{[0]}}+\frac{\partial a^{[3]}}{\partial y^{[2]}}%
\cdot\frac{\partial y^{[2]}}{\partial W^{[0]}}\right)
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\left(\mathbb{I%
}+\frac{\partial a^{[3]}}{\partial y^{[2]}}\right)\cdot\frac{\partial y^{[2]}}%
{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\left(\mathbb{I%
}+\frac{\partial a^{[3]}}{\partial y^{[2]}}\right)\cdot\frac{\partial y^{[2]}}%
{\partial W^{[0]}}
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\left(\mathbb{I%
}+\frac{\partial a^{[3]}}{\partial y^{[2]}}\right)\cdot\left(\mathbb{I}+\frac{%
\partial a^{[2]}}{\partial y^{[1]}}\right)\cdot\frac{\partial y^{[1]}}{%
\partial W^{[0]}},
\displaystyle=\frac{\partial\mathscr{L}}{\partial y^{[3]}}\cdot\left(\mathbb{I%
}+\frac{\partial a^{[3]}}{\partial y^{[2]}}\right)\cdot\left(\mathbb{I}+\frac{%
\partial a^{[2]}}{\partial y^{[1]}}\right)\cdot\frac{\partial y^{[1]}}{%
\partial W^{[0]}},
\mathbb{I}
L
\frac{\partial\mathscr{L}}{\partial W^{[\ell]}}=\frac{\partial\mathscr{L}}{%
\partial y^{[L]}}\cdot\prod_{j=L}^{\ell+2}\left(\mathbb{I}+\frac{\partial a^{[%
j]}}{\partial y^{[j-1]}}\right)\cdot\frac{\partial y^{[\ell+1]}}{\partial W^{[%
\ell]}}.
W^{[\ell]}
y^{[j]}=a^{[j]}
\frac{\partial a^{[j]}}{\partial y^{[j-1]}}<1
j
\tau^{[\ell]}\in\mathbb{R}
\sigma
\displaystyle y^{[\ell]}=y^{[\ell-1]}+\tau^{[\ell]}\sigma(W^{[\ell-1]}y^{[\ell%
-1]}+b^{[\ell-1]})
\displaystyle y^{[\ell]}
\displaystyle=y^{[\ell-1]}+\tau^{[\ell]}\sigma(W^{[\ell-1]}y^{[\ell-1]}+b^{[%
\ell-1]})
\displaystyle\Rightarrow\quad\frac{y^{[\ell]}-y^{[\ell-1]}}{\tau^{[\ell]}}=%
\sigma(W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]}).
\displaystyle\Rightarrow\quad\frac{y^{[\ell]}-y^{[\ell-1]}}{\tau^{[\ell]}}
\displaystyle=\sigma(W^{[\ell-1]}y^{[\ell-1]}+b^{[\ell-1]}).
\sigma
\tau^{[\ell]}
y^{[\ell]},y^{[\ell-1]}
\tau^{[\ell]}
y^{[\ell-1]}
+
y^{[\ell]}
\sigma=\text{ReLU}
y^{[\ell-1]}
+
y^{[\ell]}
u
T_{\operatorname{in}}
u^{<t>},t=1,\ldots,T_{\operatorname{in}}
\displaystyle u^{<1>}
\displaystyle u^{<1>}
\displaystyle u^{<2>}u^{<3>}
\displaystyle u^{<2>}
\displaystyle u^{<3>}
\displaystyle u^{<4>}u^{<5>}
\displaystyle u^{<4>}
\displaystyle u^{<5>}
y
T_{\operatorname{out}}
y^{<t>},t=1,\ldots,T_{\operatorname{out}}
\displaystyle y^{<1>}
\displaystyle y^{<1>}
\displaystyle y^{<2>}y^{<3>}
\displaystyle y^{<2>}
\displaystyle y^{<3>}
\displaystyle y^{<4>}
\displaystyle y^{<4>}
h
u
h
y
u
h
y
u^{<1>}
h^{<1>}
y^{<1>}
u^{<2>}
h^{<2>}
y^{<2>}
u^{<3>}
h^{<3>}
y^{<3>}
\cdots
u
y
h
u
y
h
h
t
u^{<t>}
h^{<t-1>}
h^{<t>}
y^{<t>}
t=1,\ldots,T_{\operatorname{out}}
\displaystyle h^{<t>}=\sigma\left(W_{\operatorname{in}}\cdot[h^{<t-1>};u^{<t>}%
]+b\right),
\displaystyle h^{<t>}
\displaystyle=\sigma\left(W_{\operatorname{in}}\cdot[h^{<t-1>};u^{<t>}]+b%
\right),
\displaystyle y^{<t>}=W_{\operatorname{out}}\cdot h^{<t>}.
\displaystyle y^{<t>}
\displaystyle=W_{\operatorname{out}}\cdot h^{<t>}.
u^{<t>}
h^{<t-1>}
h^{<t>}
y^{<t>}
[h^{<t-1>};u^{<t>}]
h^{<0>}
t=1
W_{\operatorname{out}}h^{<t>}
y^{<t>}
T_{\operatorname{in}}\neq T_{\operatorname{out}}
W_{\operatorname{in}},W_{\operatorname{out}}
b
\sigma=\tanh
\mathscr{L}
\mathcal{F}
y^{<t>}
\mathscr{L}^{<t>}
\mathscr{L}(\theta)=\sum_{t=1}^{T_{\operatorname{out}}}\mathscr{L}^{<t>}(y^{<t%
>}(\theta)).
\theta
W_{\operatorname{in}},W_{\operatorname{out}}
b
t
u^{<i>}
i\leq t
y^{<t>}
t
h^{<t>}
g^{<t>}
x
u
x
u
y^{<t>}
t
\partial_{\theta_{i}}{\mathscr{L}}
\theta_{i}
\|\partial_{\theta_{i}}{\mathscr{L}}\|\geq C\in\mathbb{R}
C
\partial_{\theta_{i}}{\mathscr{L}}\leftarrow C\cdot\frac{\partial_{\theta_{i}}%
{\mathscr{L}}}{\|\partial_{\theta_{i}}{\mathscr{L}}\|}.
u^{<1>}
h^{<1>}
y^{<1>}
u^{<2>}
h^{<2>}
y^{<2>}
u^{<3>}
h^{<3>}
y^{<3>}
u^{<4>}
h^{<4>}
y^{<4>}
u^{<5>}
h^{<5>}
y^{<5>}
u^{<6>}
h^{<6>}
y^{<6>}
u^{<7>}
h^{<7>}
y^{<7>}
u^{<1>}
u^{<1>}
\Gamma_{r}
\Gamma_{u}
\displaystyle\Gamma_{r}=\sigma\left(W_{r}\cdot[h^{<t-1>};u^{<t>}]+b_{r}\right),
\displaystyle\Gamma_{r}
\displaystyle=\sigma\left(W_{r}\cdot[h^{<t-1>};u^{<t>}]+b_{r}\right),
\displaystyle\Gamma_{u}=\sigma\left(W_{u}\cdot[h^{<t-1>};u^{<t>}]+b_{u}\right),
\displaystyle\Gamma_{u}
\displaystyle=\sigma\left(W_{u}\cdot[h^{<t-1>};u^{<t>}]+b_{u}\right),
\displaystyle\widetilde{h}^{<t>}=\tanh\left(W_{\operatorname{in}}\cdot[\Gamma_%
{r}\odot h^{<t-1>};u^{<t>}]+b\right),
\displaystyle\widetilde{h}^{<t>}
\displaystyle=\tanh\left(W_{\operatorname{in}}\cdot[\Gamma_{r}\odot h^{<t-1>};%
u^{<t>}]+b\right),
\displaystyle h^{<t>}=\Gamma_{u}\odot\widetilde{h}^{<t>}+(1-\Gamma_{u})\odot h%
^{<t-1>},
\displaystyle h^{<t>}
\displaystyle=\Gamma_{u}\odot\widetilde{h}^{<t>}+(1-\Gamma_{u})\odot h^{<t-1>},
\displaystyle y^{<t>}=W_{\operatorname{out}}\cdot h^{<t>}.
\displaystyle y^{<t>}
\displaystyle=W_{\operatorname{out}}\cdot h^{<t>}.
\widetilde{h}^{<t>}
y^{<t>}
\Gamma_{u}=0
u^{<t>}
\cdot
\sigma
\sigma
\tanh
\cdot
1-
\cdot
h^{<t-1>}
h^{<t>}
y^{<t>}
\Gamma_{r}
\Gamma_{u}
\widetilde{h}^{<t>}
c^{<t>}
\Gamma_{f}
\Gamma_{i}
\Gamma_{o}
\displaystyle\Gamma_{f}=\sigma\left(W_{f}\cdot[h^{<t-1>};u^{<t>}]+b_{f}\right),
\displaystyle\Gamma_{f}
\displaystyle=\sigma\left(W_{f}\cdot[h^{<t-1>};u^{<t>}]+b_{f}\right),
\displaystyle\Gamma_{i}=\sigma\left(W_{i}\cdot[h^{<t-1>};u^{<t>}]+b_{i}\right),
\displaystyle\Gamma_{i}
\displaystyle=\sigma\left(W_{i}\cdot[h^{<t-1>};u^{<t>}]+b_{i}\right),
\displaystyle\Gamma_{o}=\sigma\left(W_{o}\cdot[h^{<t-1>};u^{<t>}]+b_{o}\right),
\displaystyle\Gamma_{o}
\displaystyle=\sigma\left(W_{o}\cdot[h^{<t-1>};u^{<t>}]+b_{o}\right),
\displaystyle\widetilde{c}^{<t>}=\tanh\left(W_{c}\cdot[h^{<t-1>};u^{<t>}]+b_{c%
}\right),
\displaystyle\widetilde{c}^{<t>}
\displaystyle=\tanh\left(W_{c}\cdot[h^{<t-1>};u^{<t>}]+b_{c}\right),
\displaystyle c^{<t>}=\Gamma_{f}\odot\widetilde{c}^{<t-1>}+\Gamma_{i}\odot%
\widetilde{c}^{<t>},
\displaystyle c^{<t>}
\displaystyle=\Gamma_{f}\odot\widetilde{c}^{<t-1>}+\Gamma_{i}\odot\widetilde{c%
}^{<t>},
\displaystyle h^{<t>}=\Gamma_{o}\odot\tanh(c^{<t>}),
\displaystyle h^{<t>}
\displaystyle=\Gamma_{o}\odot\tanh(c^{<t>}),
\displaystyle y^{<t>}=W_{\operatorname{out}}\cdot h^{<t>}.
\displaystyle y^{<t>}
\displaystyle=W_{\operatorname{out}}\cdot h^{<t>}.
u^{<t>}
h^{<t-1>}
c^{<t-1>}
h^{<t>}
c^{<t>}
y^{<t>}
\sigma
\sigma
\tanh
\sigma
\cdot
\cdot
\cdot
\tanh
\Gamma_{f}
\Gamma_{i}
\widetilde{c}^{<t>}
\Gamma_{o}
\Gamma_{f}=\Gamma_{i}=\Gamma_{o}=1
u^{<1>}=\begin{pmatrix}0&\ldots&0&1&0&\ldots&0\end{pmatrix}^{\top}=e_{8367},
