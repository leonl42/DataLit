<
\times
\times
\times
\times
\times
\times
\displaystyle L=-\sum_{i=1}^{N}\left(L_{1}+L_{2}\right)
\displaystyle L
\displaystyle=-\sum_{i=1}^{N}\left(L_{1}+L_{2}\right)
\displaystyle L_{1}=\log\frac{e^{s_{ii}}}{\sum_{j}e^{s_{ij}}}
\displaystyle L_{1}
\displaystyle=\log\frac{e^{s_{ii}}}{\sum_{j}e^{s_{ij}}}
\displaystyle L_{2}=\lambda\cdot\left[\max(0,m-M_{ij})\right]^{2}
\displaystyle L_{2}
\displaystyle=\lambda\cdot\left[\max(0,m-M_{ij})\right]^{2}
\displaystyle M_{ij}=\min_{j\neq i}s_{ij}
\displaystyle M_{ij}
\displaystyle=\min_{j\neq i}s_{ij}
\text{Cosine Sim}(\mathbf{A},\mathbf{B})=\frac{\sum_{i=1}^{n}A_{i}\times B_{i}%
}{\sqrt{\sum_{i=1}^{n}A_{i}^{2}}\times\sqrt{\sum_{i=1}^{n}B_{i}^{2}}}
\mathbf{A}
\mathbf{B}
n
A_{i}
B_{i}
\mathbf{A}
\mathbf{B}
k
\text{P}=\frac{\text{Number of relevant images retrieved}}{\text{Total number %
of images retrieved}}
\text{R}=\frac{\text{Number of relevant images retrieved}}{\text{Total number %
of relevant images}}
\text{MAP}=\frac{1}{Q}\sum_{q=1}^{Q}\left(\frac{1}{m_{q}}\sum_{k=1}^{m_{q}}%
\text{Precision}_{k}\right)
Q
m_{q}
q
\text{Precision}_{k}
k
\text{MAR}=\frac{1}{Q}\sum_{q=1}^{Q}\left(\frac{1}{m_{q}}\sum_{k=1}^{m_{q}}%
\text{Recall}_{k}\right)
Q
m_{q}
q
\text{Recall}_{k}
k
\text{MAF1}=\frac{1}{Q}\sum_{q=1}^{Q}\left(F1_{q}\right)
Q
F1_{q}
q
F1_{q}=2\cdot\frac{\text{Precision}_{q}\cdot\text{Recall}_{q}}{\text{Precision%
}_{q}+\text{Recall}_{q}}
k
k
\text{Mean Avg Top-}k\text{-Accuracy}=\begin{aligned} &\frac{1}{Q}\sum_{q=1}^{%
Q}\left(\text{Accuracy}_{q}^{(k)}\right)\end{aligned}
Q
\text{Accuracy}_{q}^{(k)}
k
q
\text{Accuracy}_{q}^{(k)}=\begin{cases}1&\text{if correct answer is in top }k,%
\\
0&\text{otherwise.}\end{cases}
df,img\_dir,tokenizer,transform
df,img\_dir,tokenizer,transform
self.dataframe\leftarrow dataframe
self.img\_dir\leftarrow img\_dir
self.tokenizer\leftarrow tokenizer
self.transform\leftarrow transform
encoder\_type\leftarrow type
encoder\_type=\text{'resnet50'}
encoder\_type=\text{'efficientnet'}
encoder\_type=\text{'vit'}
encoder\_type=\text{'swin\_transformer'}
encoder\_type=\text{'convnext'}
train\_loader,model,optimizer,scheduler
images,input\_ids,attention\_masks
