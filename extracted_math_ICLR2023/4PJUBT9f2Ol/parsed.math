q({\bm{z}}_{t}|{\bm{x}})=\mathcal{N}({\bm{z}}_{t}|\alpha_{t}{\bm{x}},\sigma_{t%
}^{2}{\mathbf{I}}),
{\bm{x}}
{\bm{z}}_{t}
\alpha_{t}
\sigma_{t}
{\bm{x}}
{\bm{z}}_{t}
t
{\bm{z}}_{t}
{\bm{z}}_{s}
0\leq s<t
q({\bm{z}}_{t}|{\bm{z}}_{s})=\mathcal{N}({\bm{z}}_{t}|\alpha_{t|s}{\bm{z}}_{s}%
,\sigma_{t|s}^{2}{\mathbf{I}}),
\alpha_{t|s}=\alpha_{t}/\alpha_{s}
\sigma_{t|s}^{2}=\sigma_{t}^{2}-\alpha_{t|s}^{2}\sigma_{s}^{2}
s
t
T=1
q({\bm{z}}_{T}|{\bm{x}})\approx\mathcal{N}({\bm{z}}_{T}|\mathbf{0},{\mathbf{I}})
[0,1]
q({\bm{z}}_{s}|{\bm{z}}_{t},{\bm{x}})
{\bm{x}}
q({\bm{z}}_{s}|{\bm{z}}_{t},{\bm{x}})\propto q({\bm{z}}_{t}|{\bm{z}}_{s})q({%
\bm{z}}_{s}|{\bm{x}})
q({\bm{z}}_{s}|{\bm{z}}_{t},{\bm{x}})=\mathcal{N}({\bm{z}}_{s}|{\bm{\mu}}_{t%
\to s},\sigma_{t\to s}^{2}{\mathbf{I}}),
\small\sigma_{t\to s}^{2}=\left(\frac{1}{\sigma_{s}^{2}}+\frac{\alpha_{t|s}^{2%
}}{\sigma_{t|s}^{2}}\right)^{-1}\text{ and }{\bm{\mu}}_{t\to s}=\sigma_{t\to s%
}^{2}\left(\frac{\alpha_{t|s}}{\sigma_{t|s}^{2}}{\bm{z}}_{t}+\frac{\alpha_{s}}%
{\sigma_{s}^{2}}{\bm{x}}\right)
p({\bm{z}}_{s}|{\bm{z}}_{t})
{\bm{x}}
p({\bm{z}}_{s}|{\bm{z}}_{t})=q({\bm{z}}_{s}|{\bm{z}}_{t},\hat{{\bm{x}}}({\bm{z%
}}_{t})),
\hat{{\bm{x}}}({\bm{z}}_{t})
q({\bm{z}}_{s}|{\bm{z}}_{t})\rightarrow q({\bm{z}}_{s}|{\bm{z}}_{t},{\bm{x}}=%
\mathbb{E}[{\bm{x}}|{\bm{z}}_{t}])
s\rightarrow t
\hat{{\bm{x}}}({\bm{z}}_{t})
{\bm{x}}
\hat{{\bm{{\epsilon}}}}_{t}=f_{\theta}({\bm{z}}_{t},t)
f_{\theta}
\hat{{\bm{x}}}={\bm{z}}_{t}/\alpha_{t}-\sigma_{t}/\alpha_{t}\hat{{\bm{{%
\epsilon}}}}_{t},
{\bm{z}}_{t}=\alpha_{t}{\bm{x}}+\sigma_{t}{\bm{{\epsilon}}}_{t}
{\bm{x}}
\log p(x)
\mathcal{L}=\mathbb{E}_{t\sim\mathcal{U}(0,1)}\mathbb{E}_{{\bm{{\epsilon}}}_{t%
}\sim\mathcal{N}(0,{\mathbf{I}})}[w(t)||f_{\theta}({\bm{z}}_{t},t)-{\bm{{%
\epsilon}}}_{t}||^{2}],
{\bm{z}}_{t}=\alpha_{t}{\bm{x}}_{t}+\sigma_{t}{\bm{{\epsilon}}}_{t}
w(t)
\log p(x)
w(t)=1
\frac{\partial}{\partial t}{\bm{z}}(i,j,t)=\Delta{\bm{z}}(i,j,t)
{\bm{z}}_{t}
t
{\bm{z}}_{t}={\mathbf{A}}_{t}{\bm{z}}_{0}={\mathbf{V}}{\mathbf{D}}_{t}{\mathbf%
{V}}^{\mathrm{T}}{\bm{z}}_{0}
{\mathbf{V}}^{\mathrm{T}}
{\mathbf{V}}
{\bm{z}}_{0},{\bm{z}}_{t}
{\mathbf{D}}_{t}
{\bm{\Lambda}}
t
{\mathbf{D}}_{t}=\exp(-{\bm{\Lambda}}t)
{\bm{\Lambda}}
q({\bm{z}}_{t}|{\bm{x}})=\mathcal{N}({\bm{z}}_{t}|{\mathbf{A}}_{t}{\bm{x}},%
\sigma^{2}{\mathbf{I}}).
{\bm{z}}_{t}
p({\bm{z}}_{t-1}|{\bm{z}}_{t})=\mathcal{N}({\bm{z}}_{t-1}|f_{\theta}({\bm{z}}_%
{t}),\delta^{2}{\mathbf{I}}),
{\bm{z}}_{t-1}
f_{\theta}
\delta^{2}
{\bm{z}}_{t}\sim q({\bm{z}}_{t}|{\bm{x}})
t
f_{\theta}({\bm{z}}_{t})
\mathbb{E}({\bm{z}}_{t-1}|{\bm{x}})={\mathbf{A}}_{t-1}{\bm{x}}
\mathcal{L}=\mathbb{E}_{t\sim\mathcal{U}(1,\ldots,T)}\mathbb{E}_{{\bm{z}}_{t}%
\sim q({\bm{z}}_{t}|{\bm{x}})}\left[||{\mathbf{A}}_{t-1}{\bm{x}}-f_{\theta}({%
\bm{z}}_{t},t)||^{2}\right]
{\mathbf{D}}_{t}=\exp(-{\bm{\Lambda}}\tau_{t})
\tau_{t}
t
\tau_{t}
\alpha_{t}
\sigma_{t}
t
k
t_{k}
{\bm{u}}_{k}
t
{\bm{z}}_{t}
\tau_{t}
q({\bm{z}}_{t}|{\bm{z}}_{s})
p({\bm{z}}_{s}|{\bm{z}}_{t})
q({\bm{z}}_{s}|{\bm{z}}_{t})
s\rightarrow t
q({\bm{z}}_{s}|{\bm{z}}_{t},{\bm{x}}=\mathbb{E}[{\bm{x}}|{\bm{z}}_{t}])
q({\bm{z}}_{t}|{\bm{x}})=\mathcal{N}({\bm{z}}_{t}|{\mathbf{A}}_{t}{\bm{x}},%
\sigma^{2}{\mathbf{I}})
{\mathbf{A}}_{t}={\mathbf{V}}{\mathbf{D}}_{t}{\mathbf{V}}^{\mathrm{T}}
{\mathbf{V}}^{\mathrm{T}}
{\bm{u}}_{t}={\mathbf{V}}^{\mathrm{T}}{\bm{z}}_{t}
{\bm{u}}_{t}
q({\bm{u}}_{t}|{\bm{u}}_{x})=\mathcal{N}({\bm{u}}_{t}|{\bm{d}}_{t}\cdot{\bm{u}%
}_{x},\sigma^{2}{\mathbf{I}})
{\bm{u}}_{x}={\mathbf{V}}^{\mathrm{T}}{\bm{x}}
{\bm{x}}
{\bm{d}}_{t}
{\mathbf{D}}_{t}
{\mathbf{D}}_{t}=\exp(-\bm{\Lambda}\tau_{t})
{\bm{\lambda}}
\bm{\Lambda}
{\bm{d}}_{t}=\exp(-{\bm{\lambda}}\tau_{t})
{\bm{d}}_{t}
{\bm{u}}_{t}
u^{(i)}_{t}
i
p_{\theta}({\bm{u}}_{s}|{\bm{u}}_{t})
i
q(u^{(i)}_{t}|u^{(i)}_{0})=\mathcal{N}(u^{(i)}_{t}|d^{(i)}_{t}u^{(i)}_{0},%
\sigma^{2})\quad\Leftrightarrow\quad u^{(i)}_{t}=d^{(i)}_{t}u^{(i)}_{0}+\sigma%
\epsilon_{t},\text{ with }\epsilon_{t}\sim\mathcal{N}(0,1).
s_{t}
s_{t}^{(i)}=\alpha_{t}u^{(i)}_{0}+\sigma_{t}\epsilon_{t}
\alpha_{t}=d^{(i)}_{t}
\sigma_{t}^{2}=\sigma^{2}
\alpha_{t}/\sigma_{t}
\alpha_{t},\sigma_{t}
{\bm{u}}
\alpha_{t},\sigma_{t}
{\bm{u}}
\sigma^{2}
u^{(i)}
\alpha_{t}/\sigma
q({\bm{u}}_{t}|{\bm{u}}_{s})
q({\bm{z}}_{t}|{\bm{x}})
q({\bm{u}}_{t}|{\bm{u}}_{s})=\mathcal{N}({\bm{u}}|{\bm{\alpha}}_{t|s}{\bm{u}}_%
{s},{\bm{\sigma}}^{2}_{t|s})
{\bm{\alpha}}_{t|s}={\bm{\alpha}}_{t}/{\bm{\alpha}}_{s}
{\bm{\sigma}}_{t|s}^{2}={\bm{\sigma}}_{t}^{2}-{\bm{\alpha}}^{2}_{t|s}{\bm{%
\sigma}}_{s}^{2}
{\bm{\alpha}}_{t}={\bm{d}}_{t}
\sigma_{t}^{(i)}=\sigma
{\bm{\alpha}}_{t|s}={\bm{d}}_{t}/{\bm{d}}_{s}\hskip 14.22636pt\text{and}\hskip
1%
4.22636pt{\bm{\sigma}}_{t|s}^{2}=(1-({\bm{d}}_{t}/{\bm{d}}_{s})^{2})\sigma^{2}.
{\bm{d}}_{t}
{\bm{\sigma}}_{t|s}
{\bm{z}}_{0},\ldots,{\bm{z}}_{1}
{\bm{u}}_{t}={\mathbf{V}}^{\mathrm{T}}{\bm{z}}_{t}
{\bm{u}}_{0},\ldots,{\bm{u}}_{1}
{\bm{z}}_{0},\ldots,{\bm{z}}_{1}
{\bm{u}}_{t}={\mathbf{V}}^{\mathrm{T}}{\bm{z}}_{t}
{\bm{u}}_{0},\ldots,{\bm{u}}_{1}
q({\bm{u}}_{s}|{\bm{u}}_{t},{\bm{x}})=\mathcal{N}({\bm{u}}_{s}|{\bm{\mu}}_{t%
\to s},{\bm{\sigma}}_{t\to s}^{2}),
\small{\bm{\sigma}}_{t\to s}^{2}=\left(\frac{1}{{\bm{\sigma}}_{s}^{2}}+\frac{{%
\bm{\alpha}}_{t|s}^{2}}{{\bm{\sigma}}_{t|s}^{2}}\right)^{-1}\text{ and }{\bm{%
\mu}}_{t\to s}={\bm{\sigma}}_{t\to s}^{2}\left(\frac{{\bm{\alpha}}_{t|s}}{{\bm%
{\sigma}}_{t|s}^{2}}{\bm{u}}_{t}+\frac{{\bm{\alpha}}_{s}}{{\bm{\sigma}}_{s}^{2%
}}{\bm{u}}_{x}\right).
{\bm{u}}_{x}
{\bm{d}}_{t},\sigma^{2}
{\bm{{\epsilon}}}_{t}
{\bm{\mu}}_{t\to s}
{\bm{\sigma}}_{t\to s}^{2}
s\rightarrow t
{\bm{\alpha}}_{t}
{\bm{\sigma}}_{t}
q({\bm{u}}_{t}|{\bm{u}}_{x})=\mathcal{N}({\bm{u}}_{t}|{\bm{\alpha}}_{t}{\bm{u}%
}_{x},{\bm{\sigma}}_{t}^{2}{\mathbf{I}})
{\bm{\alpha}}_{t},{\bm{\sigma}}_{t}
{\bm{\sigma}}_{t}
q({\bm{u}}_{s}|{\bm{u}}_{t},{\bm{x}})=\mathcal{N}({\bm{u}}_{s}|{\bm{\mu}}_{t%
\to s},{\bm{\sigma}}_{t\to s}^{2})
{\bm{\mu}}_{t\to s}
{\bm{x}}
{\bm{u}}_{t}={\bm{\alpha}}_{t}{\bm{u}}_{x}+{\bm{\sigma}}_{t}{\bm{u}}_{\epsilon%
,t}\quad\text{where}\quad{\bm{u}}_{x}={\mathbf{V}}^{\mathrm{T}}{\bm{x}}\text{ %
and }{\bm{u}}_{\epsilon,t}={\mathbf{V}}^{\mathrm{T}}{\bm{{\epsilon}}}_{t}
\Big{(}{\bm{u}}_{t}-{\bm{\sigma}}_{t}\hat{{\bm{u}}}_{\epsilon,t}\Big{)}/{\bm{%
\alpha}}_{t}=\hat{{\bm{u}}}_{x},
f_{\theta}
{\bm{z}}_{t}={\mathbf{V}}{\bm{u}}_{t}
\hat{{\bm{{\epsilon}}}}_{t}
{\mathbf{V}}^{\mathrm{T}}
{\mathbf{V}}
\hat{{\bm{u}}}_{\epsilon,t}={\mathbf{V}}^{\mathrm{T}}\hat{{\bm{{\epsilon}}}}_{t}
\hat{{\bm{x}}}
\hat{{\bm{u}}}_{x}={\mathbf{V}}^{\mathrm{T}}\hat{{\bm{x}}}
\hat{{\bm{\mu}}}_{t\to s}
{\bm{u}}_{x}
\hat{{\bm{u}}}_{x}
p({\bm{u}}_{s}|{\bm{u}}_{t})=q({\bm{u}}_{s}|{\bm{u}}_{t},\hat{{\bm{u}}}_{x})=%
\mathcal{N}({\bm{u}}_{s}|\hat{{\bm{\mu}}}_{t\to s},{\bm{\sigma}}_{t\to s})
\hat{{\bm{\mu}}}_{t\to s}
\hat{{\bm{u}}}_{\epsilon,t}
\hat{{\bm{u}}}_{x}
\small\hat{{\bm{\mu}}}_{t\to s}={\bm{\sigma}}_{t\to s}^{2}\left(\frac{{\bm{%
\alpha}}_{t|s}}{{\bm{\sigma}}_{t|s}^{2}}{\bm{u}}_{t}+\frac{1}{{\bm{\alpha}}_{t%
|s}{\bm{\sigma}}_{s}^{2}}({\bm{u}}_{t}-{\bm{\sigma}}_{t}\hat{{\bm{u}}}_{%
\epsilon,t})\right).
\mathcal{L}=\mathbb{E}_{t\sim\mathcal{U}(0,1)}\mathbb{E}_{{\bm{{\epsilon}}}_{t%
}\sim\mathcal{N}(0,{\mathbf{I}})}[||f_{\theta}({\bm{z}}_{t},t)-{\bm{{\epsilon}%
}}_{t}||^{2}],\quad\text{ where }{\bm{z}}_{t}={\mathbf{V}}({\bm{\alpha}}_{t}{%
\mathbf{V}}^{\mathrm{T}}{\bm{x}}_{t}+{\bm{\sigma}}_{t}{\mathbf{V}}^{\mathrm{T}%
}{\bm{{\epsilon}}}_{t}).
{\bm{z}}_{T}\sim\mathcal{N}(0,{\mathbf{I}})
t
\{\frac{T}{T},\ldots,\frac{1}{T}\}
s=t-1/T
{\bm{u}}_{t}={\mathbf{V}}^{\mathrm{T}}{\bm{z}}
\hat{{\bm{u}}}_{\epsilon,t}={\mathbf{V}}^{\mathrm{T}}f_{\theta}({\bm{z}},t)
{\bm{\sigma}}_{t\to s}
\hat{{\bm{\mu}}}_{t\to s}
{\bm{{\epsilon}}}\sim\mathcal{N}(0,{\mathbf{I}})
{\bm{z}}\leftarrow{\mathbf{V}}(\hat{{\bm{\mu}}}_{t\to s}+{\bm{\sigma}}_{t\to s%
}{\bm{{\epsilon}}})
t\sim\mathcal{U}(0,1)
{\bm{{\epsilon}}}\sim\mathcal{N}(0,{\mathbf{I}})
||{\bm{{\epsilon}}}-f_{\theta}({\mathbf{V}}{\bm{\alpha}}_{t}{\mathbf{V}}^{%
\mathrm{T}}{\bm{x}}+\sigma_{t}{\bm{{\epsilon}}},t)||^{2}
{\bm{\alpha}}_{t}
{\bm{\sigma}}_{t}
t\in[0,1]
{\bm{\sigma}}_{t}
\sigma_{t}
a_{t},\sigma_{t}
{\bm{d}}_{t}
\sigma_{t}^{2}=1-a_{t}^{2}
a_{t}=\cos(t\pi/2)
t\in[0,1]
t\to 0
t\to 1
\log a_{t}^{2}/\sigma_{t}^{2}
+10
t=0
-10
t=1
a_{t},\sigma_{t}
\sigma_{B}
\tau=\sigma_{B}^{2}/2
\sigma_{B,t}=\sigma_{B,\max}\sin(t\pi/2)^{2}
\sigma_{B,\max}
\tau_{t}=\sigma_{B,t}^{2}/2
{\bm{\alpha}}_{t|s}={\bm{\alpha}}_{t}/{\bm{\alpha}}_{s}
{\bm{d}}_{t}=\exp(-{\bm{\lambda}}\tau_{t})
{\bm{\alpha}}_{t}
s
{\bm{d}}_{t}/{\bm{d}}_{s}
{\bm{d}}_{t}=(1-d_{\min})\cdot\exp(-{\bm{\lambda}}\tau_{t})+d_{\min},
d_{\min}=0.001
d_{\min}
a_{t}
\sigma_{t}
{\bm{d}}_{t}
{\bm{\alpha}}_{t}=a_{t}\cdot{\bm{d}}_{t}\quad\text{ and }{\bm{\sigma}}_{t}=%
\mathbf{1}\sigma_{t},
\mathbf{1}
{\bm{u}}_{x}={\mathbf{V}}^{\mathrm{T}}{\bm{x}}
q({\bm{u}}_{t}|{\bm{u}}_{x})=\mathcal{N}({\bm{u}}_{t}|{\bm{\alpha}}_{t}{\bm{u}%
}_{x},{\bm{\sigma}}_{t}^{2}{\mathbf{I}})
\small q({\bm{z}}_{t}|{\bm{x}})=\mathcal{N}({\bm{z}}_{t}|{\mathbf{V}}\mathrm{%
diag}({\bm{\alpha}}_{t}){\mathbf{V}}^{\mathrm{T}}{\bm{x}},{\mathbf{V}}\mathrm{%
diag}({\bm{\sigma}}_{t}^{2}){\mathbf{V}}^{\mathrm{T}})\quad\text{where}\quad{%
\bm{u}}_{t}={\mathbf{V}}^{\mathrm{T}}{\bm{z}}_{t},
\mathrm{diag}
{\bm{u}}_{x}={\mathbf{P}}^{-1}{\bm{x}}
\small q({\bm{z}}_{t}|{\bm{x}})=\mathcal{N}({\bm{z}}_{t}|{\mathbf{P}}\mathrm{%
diag}({\bm{\alpha}}_{t}){\mathbf{P}}^{-1}{\bm{x}},{\mathbf{P}}\mathrm{diag}({%
\bm{\sigma}}_{t}^{2}){\mathbf{P}}^{\mathrm{T}})\quad\text{where}\quad{\bm{u}}_%
{t}={\mathbf{P}}^{-1}{\bm{z}}_{t}.
f_{\theta}
32\times 32
16\times 16
8\times 8
256
3
3
16\times 16
8\times 8
128
32\times 32
256
4\times 4
4
3
50000
2
\times
\times
128\times 128
f_{\theta}
64
128\times 128
128
64\times 64
256
32\times 32
384
16\times 16
512
8\times 8
3
32\times 32
16\times 16
8\times 8
10000
\times
\times
\sigma_{B,\max}
\sin^{2}
\sin
\sigma_{B,\max}=0
\sigma_{B,\max}=20
\sigma_{B,\max}=10
\sigma_{B,\max}=10
\sigma_{B,\max}=20
\sin^{2}
\sin
\sin^{2}
\sin^{2}
\sin
\sin^{2}
t=0
\sigma_{B,\max}
\times
\sigma_{B,\max}
\sigma_{B,\max}\sin(t\pi/2)^{2}
\sigma_{B,\max}\sin(t\pi/2)
\sigma_{B,\max}
\sigma_{B,\max}
1
20
\sigma_{B,\max}=20
\sigma_{B,\max}
0
1
1
2
\sigma_{B,\max}
{\bm{d}}_{t}
{\bm{\Lambda}}
{\bm{d}}_{t}
{\bm{\alpha}}_{t},{\bm{\sigma}}_{t}
q({\bm{u}}_{t}|{\bm{u}}_{x})
{\bm{x}}
{\bm{z}}_{t},{\bm{{\epsilon}}}_{t}
{\bm{z}}_{t}={\mathbf{V}}{\bm{u}}_{t}=\mathrm{IDCT}({\bm{u}}_{t})
{\bm{z}}_{t}
p({\bm{z}}_{t-1/T}|{\bm{z}}_{t})
t=T,T-1/T\ldots,1/T
10^{-8}
\hat{{\bm{{\epsilon}}}}
\hat{{\bm{x}}}
\hat{{\bm{{\epsilon}}}}
f_{\theta}
3+(3+1)=7
(3+1)
2\cdot 10^{-4}
1\cdot 10^{-4}
0.9999
128\times 128
\sigma_{B,\max}=10
\sigma_{B,\max}=20
{\bm{x}}-\hat{{\bm{x}}}
\hat{{\bm{x}}}
{\bm{u}}_{t}
\sigma_{B,\max}
64\times 64
\sigma_{B,\max}=20
\sigma_{B,\max}=0
\times
\times
\sigma_{B,\max}
