\mathcal{S}
\tilde{\mathcal{Z}}
\mathcal{S}
\tilde{\mathcal{Z}}
\langle\mathcal{S},\mathcal{A},\mathcal{R},\mathcal{T},\gamma\rangle
\mathcal{S}
\mathcal{A}
\mathcal{T}
\mathbf{s}_{t+1}\sim\mathcal{T}(\mathbf{s}_{t},\mathbf{a}_{t})
\mathcal{R}
\gamma
\mathbf{a}_{t}\sim\pi(\mathbf{s}_{t})
\pi(\mathbf{a}_{t}\mid\mathbf{s}_{t})
\mathop{\mathbb{E}}_{\mathcal{T}}\left[\sum_{t=0}^{\infty}\gamma^{t}\mathcal{R%
}(\mathbf{s}_{t})\right]
\pi(\mathbf{a}\mid\mathbf{z}_{t})
\beta
\beta
f_{\phi}
\mathbf{s}_{t}
\mathbf{z}_{t}
\mathbf{a}_{t}
\mathbf{z}_{t}
\tilde{\mathbf{z}}_{t+1}
\tilde{\mathbf{z}}_{t+1}
\mathbf{z}_{t+1}\approx\mathbf{T}_{t}\mathbf{z}_{t}
(\mathbf{z}_{t},\mathbf{a}_{t})
\displaystyle\mathbf{z}_{t}=f_{\phi}(\mathbf{s}_{t})
\displaystyle\mathbf{z}_{t}=f_{\phi}(\mathbf{s}_{t})
\displaystyle\mathbf{h}_{t}=g_{\psi}(\mathbf{z}_{t},\mathbf{a}_{t})
\displaystyle\mathbf{h}_{t}=g_{\psi}(\mathbf{z}_{t},\mathbf{a}_{t})
\displaystyle\mathbf{T}_{t}=j_{\omega}(\mathbf{h}_{t},\mathbf{a}_{t})
\displaystyle\mathbf{T}_{t}=j_{\omega}(\mathbf{h}_{t},\mathbf{a}_{t})
\displaystyle\tilde{\mathbf{z}}_{t+1}=\mathbf{T}_{t}\mathbf{z}_{t}
\displaystyle\tilde{\mathbf{z}}_{t+1}=\mathbf{T}_{t}\mathbf{z}_{t}
\mathbf{T}_{t}
\mathbf{h}_{t}\sim q_{\psi}^{t}(\mathbf{z}_{t},\mathbf{a}_{t})
p_{\psi}^{t}(\mathbf{h}\mid\mathbf{a}_{t})
\mathbf{T}_{t}
\displaystyle q_{\psi}^{t}(\mathbf{h}\mid\mathbf{z}_{t},\mathbf{a}_{t})
\displaystyle q_{\psi}^{t}(\mathbf{h}\mid\mathbf{z}_{t},\mathbf{a}_{t})
\displaystyle p_{\psi^{\prime}}^{t}(\mathbf{h}\mid\mathbf{a}_{t})
\displaystyle p_{\psi^{\prime}}^{t}(\mathbf{h}\mid\mathbf{a}_{t})
q_{\psi}^{t}(\mathbf{h}\mid\mathbf{z}_{t},\mathbf{a}_{t})
n
\mathbf{p}_{t}
g_{\psi}(\mathbf{z}_{t},\mathbf{a}_{t})
\mathbf{h}_{t}
\mathbf{p}_{t}
h_{i}=\begin{cases}1,&\text{if }p_{i}\geq 0.5\\
0,&\text{otherwise}\end{cases}
\mathbf{h}_{t}
j_{\omega}
\mathbf{T}_{t}
g_{\psi}
j_{\omega}
q_{\psi}^{t}(\mathbf{h}\mid\mathbf{z}_{t},\mathbf{a}_{t})
g_{\psi}^{\prime}(\mathbf{z}_{t},\mathbf{a}_{t})
p_{\psi^{\prime}}^{t}(\mathbf{h}\mid\mathbf{a}_{t})
\mathbf{h}_{t}
\mathbf{z}_{t}
\mathbf{z}_{t}
\mathcal{L}_{transition}=\underbrace{\log p(\mathbf{z}_{t+1}\mid\mathbf{h}_{t}%
,\mathbf{a}_{t})}_{\text{next state prediction}}+\underbrace{\beta D_{KL}\left%
[q_{\psi}^{t}(\mathbf{h}\mid\mathbf{z}_{t},\mathbf{a}_{t})\lVert p_{\psi^{%
\prime}}^{t}(\mathbf{h}\mid\mathbf{a}_{t})\right]}_{\text{parsimony}}
\tilde{\mathbf{z}}_{t+1}
\mathbf{z}_{t+1}
\mathbf{h}_{t}
\beta
j_{\omega}
(\mathbf{h}_{t},\mathbf{a}_{t})
\mathbf{R}
\mathbf{v}
\tilde{\mathbf{z}}_{t+1}=\mathbf{z}_{t}+\mathbf{v}_{t}
n
n
\frac{n(n-1)}{2}
n\times n
n\times n
\mathbf{R}
n
\mathbf{s}_{t}
\mathbf{s}_{t}
\mathbf{z}_{t}
\mathbf{z}_{t}\mid\mathbf{s}_{t}
\mathcal{B}
\mathbf{s}_{t}\in\mathcal{B}
\begin{gathered}l(\mathbf{s},\mathbf{s}^{\prime})=e^{-\tau_{\mathbf{s}}\lVert%
\mathbf{s}-\mathbf{s}^{\prime}\rVert_{2}}\\
k(\mathbf{z},\mathbf{z}^{\prime})=e^{-\tau_{\mathbf{z}}\lVert\mathbf{z}-%
\mathbf{z}^{\prime}\rVert_{2}}\end{gathered}
l(\mathbf{s},\mathbf{s}^{\prime})
k(\mathbf{z},\mathbf{z}^{\prime})
\tau_{\mathbf{s}}
\tau_{\mathbf{z}}
k(\mathbf{z},\mathbf{z}^{\prime})
l(\mathbf{s},\mathbf{s}^{\prime})
\mathcal{L}_{contrastive}=-\dfrac{1}{N}\sum_{\mathbf{s},\mathbf{s}^{\prime}\in%
\mathcal{B}\times\mathcal{B}}k(\mathbf{z},\mathbf{z}^{\prime})\log l(\mathbf{s%
},\mathbf{s}^{\prime})+(1-k(\mathbf{z},\mathbf{z}^{\prime}))\log(1-l(\mathbf{s%
},\mathbf{s}^{\prime}))
\tau_{\mathbf{s}}
\mathcal{A}=\{LEFT,RIGHT,UP,DOWN,STAY\}
STAY
\mathbf{s}\sim\mathcal{N}(\bm{\mu},\mathbf{I})
11\times 11
13\times 13
\mathbf{s}_{start}
\mathbf{s}_{goal}
-1
+1
\pi(\mathbf{a}\mid\mathbf{z})
\beta
\beta
\beta
\mathbf{h}_{t}
\beta
\beta
\beta
\mathbf{z}_{\text{goal}}
G=\sum_{t=0}^{H}e^{-\lVert\mathbf{z}_{t}-\mathbf{z}_{goal}\rVert_{2}}
\beta
\mathbf{h}_{t}
\sigma=2
\sigma=2
KL_{D}\left[q(\tilde{\mathbf{z}}_{t+1}\mid\textbf{z}_{\leq t},\textbf{u}_{\leq
t%
},\textbf{a}_{\leq t})\rVert p(\mathbf{z}_{t+1}\mid\textbf{s}_{t+1}\textbf{u}_%
{t})\right]
\mathbf{u}_{t}
\beta
\beta
\mathbf{z}_{t}\sim p(\mathbf{z}_{t}\mid\mathbf{s}_{t})
p
(\bm{\mu}_{t},\bm{\sigma}_{t})=f_{\phi}(\mathbf{s}_{t})
\mathcal{L}=\log p(\mathbf{s}_{t}\mid\mathbf{z}_{t})+\beta D_{KL}\left[q(%
\mathbf{z}_{t}\mid\mathbf{s}_{t})\lVert p(\tilde{\mathbf{z}}_{t}\mid\mathbf{z}%
_{t-1},\mathbf{a}_{t-1})\right]
\mathbf{z}_{error}=\tilde{\mathbf{z}}_{t+1}-\mathbf{z}_{t+1}
\mathcal{L}_{\text{deterministic transitions}}=\|\tilde{\mathbf{z}}_{t+1}-%
\mathbf{z}_{t+1}\rVert_{2}^{2}+e^{-\|\tilde{\mathbf{z}}_{t+1}-\mathbf{z}_{t+1}%
\rVert_{2}}
\mathcal{N}(\mathbf{T}_{t}\bm{\mu}_{t},\tilde{\bm{\sigma}}_{t+1})
\tilde{\bm{\sigma}}_{t+1}=g_{\psi}(\bm{\mu}_{t},\mathbf{a}_{t})
\mathcal{N}(\bm{\mu}_{t+1},\bm{\sigma}_{t+1})=f_{\phi}(\mathbf{s}_{t+1})
\mathcal{L}_{\text{stochastic transitions}}=D_{KL}\left[p(\mathbf{z}_{t+1})%
\lVert q(\tilde{\mathbf{z}}_{t+1})\right]+D_{KL}\left[q(\mathbf{h}\mid\mathbf{%
z}_{t},\mathbf{a}_{t})\rVert p(\mathbf{h}\mid\mathbf{a}_{t})\right]
p(\mathbf{h}_{t})
q(\mathbf{h}_{t})
\mathbf{h}_{t}
\tau_{\mathbf{s}}=100
\tau_{\mathbf{z}}=0.1
80\times 80
\mathbf{u}_{t}
B=50
N=50
\begin{split}\mathcal{L}&=\underbrace{\log p(\mathbf{s}_{t}\mid\mathbf{z}_{t},%
\mathbf{u}_{t})}_{\text{reconstruction loss}}\\
&+\beta_{1}\underbrace{D_{KL}\left[q(\tilde{\mathbf{z}}_{t+1}\mid\mathbf{z}_{t%
},\mathbf{u}_{t},\mathbf{a}_{t})\lVert p(\mathbf{z}_{t+1}\mid\mathbf{s}_{t+1},%
\mathbf{u}_{t})\right]}_{\text{transition loss}}\\
&+\beta_{2}\underbrace{D_{KL}\left[q(\mathbf{h}\mid\mathbf{z}_{t},\mathbf{u}_{%
t},\mathbf{a}_{t})\rVert p(\mathbf{h}\mid\mathbf{u}_{t},\mathbf{a}_{t})\right]%
}_{\text{parsimony}}\end{split}
\mathbf{z}_{t}
\mathbf{u}_{t}
\beta_{1}=0.1
\beta_{2}=0.5
\displaystyle\mathbf{h}_{t+1}=f(\mathbf{z}_{t},\mathbf{h}_{t},\mathbf{a}_{t})
\displaystyle\mathbf{h}_{t+1}=f(\mathbf{z}_{t},\mathbf{h}_{t},\mathbf{a}_{t})
\displaystyle\mathbf{z}_{t+1}\sim p(\mathbf{h}_{t})
\displaystyle\mathbf{z}_{t+1}\sim p(\mathbf{h}_{t})
\displaystyle\mathbf{s}_{t}\sim p(\mathbf{z}_{t},\mathbf{h}_{t})
\displaystyle\mathbf{s}_{t}\sim p(\mathbf{z}_{t},\mathbf{h}_{t})
f(\mathbf{z}_{t},\mathbf{h}_{t},\mathbf{a}_{t})
\begin{split}\mathcal{L}&=\underbrace{\log p(\mathbf{s}_{t}\mid\mathbf{z}_{t},%
\mathbf{h}_{t})}_{\text{reconstruction loss}}\\
&+\beta_{1}\underbrace{D_{KL}\left[q(\mathbf{z}_{t}\mid\mathbf{s}_{t},\mathbf{%
h}_{t})\lVert p(\mathbf{z}_{t}\mid\mathbf{h}_{t})\right]}_{\text{transition %
loss}}\end{split}
\mathbf{z}_{t}
\mathbf{h}_{t}
B=50
N=50
\beta_{1}=0.1
\mathbf{z}_{t}=f_{\phi}(\mathbf{s}_{t})
\mathbf{a}_{t}\sim\pi_{\theta_{\text{actor}}}(\mathbf{z}_{t})
r_{t},\mathbf{s}_{t+1}\sim
(\mathbf{s}_{t},\mathbf{a}_{t})
\mathcal{D}\leftarrow\mathcal{D}\ \cup(\mathbf{s}_{t},\mathbf{a}_{t},r_{t},%
\mathbf{s}_{t+1})
N
(\mathbf{s}_{t},\mathbf{a}_{t},\mathbf{s}_{t+1})\sim\mathcal{D}
\mathcal{L}_{\text{dynamics}}
\theta_{\text{dynamics}}\leftarrow\theta-\alpha\nabla\mathcal{L}_{\text{%
dynamics}}
M
(\mathbf{s}_{t},\mathbf{a}_{t},r_{t},\mathbf{s}_{t+1})\sim\mathcal{D}
\mathcal{L}_{\text{actor}},\mathcal{L}_{\text{critic}}
\theta_{\text{actor}}\leftarrow\theta_{\text{actor}}-\alpha\nabla\mathcal{L}_{%
\text{actor}}
\theta_{\text{critic}}\leftarrow\theta_{\text{critic}}-\alpha\nabla\mathcal{L}%
_{\text{critic}}
\alpha=0.5
M=15
\tau_{target}=0.1
1e-4
1e-3
H=15
I
J
K=200
1e-3
\varepsilon
\varepsilon
\mathcal{E}(N)=1-\left(\dfrac{N-1}{T}\right)^{V}
N
T
V=2.8
\mathbf{s}_{\text{start}},\mathbf{s}_{\text{goal}}\sim\mathcal{S}
\mathbf{s}_{\text{start}}\neq\mathbf{s}_{\text{goal}}
\mathbf{z}_{\text{goal}}=f_{\phi}(\mathbf{s}_{\text{goal}})
\tilde{r}(\mathbf{z})=e^{-\lVert f_{\phi}(\mathbf{s})-\mathbf{z}_{\text{goal}}%
\rVert_{2}}
\varepsilon_{i}\leftarrow\mathcal{E}(task)
\mathbf{z}_{t}=f_{\phi}(\mathbf{s}_{t})
\mathbf{a}_{t}=\begin{cases}\text{CEM}(\mathbf{z}_{t})&\text{with probability %
}1-\varepsilon_{i}\\
\text{Random}&\text{with probability }\varepsilon_{i}\end{cases}
r_{t},\mathbf{s}_{t+1}\sim
(\mathbf{s}_{t},\mathbf{a}_{t})
\mathcal{D}\leftarrow\mathcal{D}\ \cup(\mathbf{s}_{t},\mathbf{a}_{t},\mathbf{s%
}_{t+1})
N
(\mathbf{s}_{t},\mathbf{a}_{t},\mathbf{s}_{t+1})\sim\mathcal{D}
\mathcal{L}_{\text{dynamics}}
\phi_{\text{dynamics}}\leftarrow\phi-\alpha\nabla\mathcal{L}_{\text{dynamics}}
p(\mathbf{z}_{t+1}\mid\mathbf{a}_{t},\mathbf{z}_{t})
\tilde{r}(\mathbf{z})
J
\mathbf{w}\sim\mathcal{N}(0,\mathbf{I})
\mathbf{w}\in\mathbb{R}^{\mid\mathcal{A}\mid\times H}
i=1,...,I
j=1,...,J
\mathbf{a}_{1:H}\sim\text{Softmax}(\mathbf{w})
\mathbf{z}_{1:H}\sim\mathbf{p}(\mathbf{z}_{1:H}\mid\mathbf{a}_{1:H-1},\mathbf{%
z}_{1:H-1})
\mathbf{r}\leftarrow\tilde{r}(\mathbf{z})
\mathcal{K}=argsort\{\mathbf{r}_{j=1}^{J}\}_{1:H}
K
\bm{\mu}_{1:H}\leftarrow\dfrac{1}{K}\sum_{k\in\mathcal{K}}w^{k}_{1:H}
\mathbf{w}\sim\mathcal{N}(\bm{\mu},\mathbf{I})
K
