\dagger
\mathcal{B}^{*}Q(\mathbf{s},\mathbf{a})=r(\mathbf{s},\mathbf{a})+\gamma\mathbb%
{E}_{\mathbf{s}^{\prime}\sim P\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{%
a}\right)}\left[Q\left(\mathbf{s}^{\prime},\mathbf{a}^{\prime}\right)\right]
a^{\prime}
(\mathcal{S},\mathcal{A},T,r,\gamma)
\mathcal{S},\mathcal{A}
T\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)
r(\mathbf{s},\mathbf{a})
\gamma\in(0,1)
\pi_{\beta}(\mathbf{a}\mid\mathbf{s})
d^{\pi_{\beta}}(\mathbf{s})
\pi_{\beta}(\mathbf{a}\mid\mathbf{s})
\pi^{*}=\underset{\pi}{\arg\max}\mathbb{E}_{\pi}\left[\sum_{t=0}^{\infty}%
\gamma^{t}r\left(s_{t},a_{t}\right)\mid s_{0}\sim p_{0}(\cdot),a_{t}\sim\pi%
\left(\cdot\mid s_{t}\right),s_{t+1}\sim p\left(\cdot\mid s_{t},a_{t}\right)\right]
L_{TD}(\theta)=\mathbb{E}_{\left(s,a,s^{\prime}\right)\sim\mathcal{D}}\left[%
\left(r(s,a)+\gamma\max_{a^{\prime}}Q_{\hat{\theta}}\left(s^{\prime},a^{\prime%
}\right)-Q_{\theta}(s,a)\right)^{2}\right]
a^{\prime}
Q_{\theta}(s,a)
Q_{\hat{\theta}}(s^{\prime},a^{\prime})
s^{\prime}
a^{\prime}
\pi
a^{\prime}
L_{TD}(\theta)=\mathbb{E}_{\left(s,a,s^{\prime}\right)\sim\mathcal{D}}\left[%
\left(r(s,a)+\gamma\max_{a^{\prime}}Q_{\hat{\theta}}\left(s^{\prime},a^{\prime%
}\right)-Q_{\theta}(s,a)\right)^{2}\right]+penaltyterm
a^{\prime}
L_{V}(\psi)=\mathbb{E}_{(s,a)\sim\mathcal{D}}\left[L_{2}^{\tau}\left(Q_{\hat{%
\theta}}(s,a)-V_{\psi}(s)\right)\right]
L_{2}^{\tau}(u)=|\tau-1(u<0)|u^{2}
L_{Q}(\theta)=\mathbb{E}_{(s,a,s^{\prime})\sim\mathcal{D}}[(r(s,a)+\gamma V_{%
\psi}(s^{\prime})\\
-Q_{\theta}(s,a))^{2}]
L_{Q}(\theta)=\mathbb{E}_{\left(s,a,s^{\prime}\right)\sim\mathcal{D}}\left[%
\left(r(s,a)+\gamma V_{\psi}\left(s^{\prime}\right)-Q_{\theta}(s,a)\right)^{2}%
\right]+\beta\times\mathbb{E}_{s\sim\mathcal{D},a^{\prime}\sim\pi_{\theta}}[Q_%
{\theta}(s,a^{\prime})]
Q_{\hat{\theta}}(s,a^{\prime})
(s,a^{\prime})
a^{\prime}
\beta
\beta
\beta
\beta
\nabla_{\theta}L_{Q}(\theta)=\nabla_{\theta}Q(s,a)\times(\left(r(s,a)+\gamma V%
_{\psi}\left(s^{\prime}\right)-Q_{\theta}(s,a)\right)+\beta\times\nabla_{%
\theta}Q(s,a)
Q_{k}(s,a)=r+\gamma V_{k}(s^{\prime})-\beta
Q_{k}(s,a)=r+\gamma V_{k}(s^{\prime})-\beta
V(s)=\mathbb{E}_{(s,a)\sim\mathcal{D}}(Q(s,a))
\displaystyle V_{k+1}(s)=\mathbb{E}_{(s,a)\sim\mathcal{D}}(Q(s,a))=\mathbb{E}_%
{(s,a)\sim\mathcal{D}}(r+\gamma V_{k}(s^{\prime})-\beta)=\mathbb{E}_{(s,a)\sim%
\mathcal{D}}(r+\gamma V^{*}_{k}(s^{\prime})-\frac{1-\gamma^{k}}{1-\gamma}\beta)
\displaystyle V_{k+1}(s)
\displaystyle=\mathbb{E}_{(s,a)\sim\mathcal{D}}(Q(s,a))=\mathbb{E}_{(s,a)\sim%
\mathcal{D}}(r+\gamma V_{k}(s^{\prime})-\beta)=\mathbb{E}_{(s,a)\sim\mathcal{D%
}}(r+\gamma V^{*}_{k}(s^{\prime})-\frac{1-\gamma^{k}}{1-\gamma}\beta)
\displaystyle=\mathbb{E}_{(s,a)\sim\mathcal{D}}(Q^{*}(s,a)-\frac{1-\gamma^{k}}%
{1-\gamma}\beta)=V^{*}_{k+1}(s)-\frac{1-\gamma^{k}}{1-\gamma}\beta
\displaystyle=\mathbb{E}_{(s,a)\sim\mathcal{D}}(Q^{*}(s,a)-\frac{1-\gamma^{k}}%
{1-\gamma}\beta)=V^{*}_{k+1}(s)-\frac{1-\gamma^{k}}{1-\gamma}\beta
Q^{*}_{k}(s,a)
V^{*}_{k+1}(s)
\beta
V(s)=V^{*}(s)-\frac{1-\gamma^{n}}{1-\gamma}\beta
V(s)=V^{*}(s)-\frac{1-\gamma^{n}}{1-\gamma}\beta
Q(s,a)=r+\gamma V(s^{\prime})-\beta=Q^{*}(s,a)-\frac{1-\gamma^{(n+1)}}{1-%
\gamma}\beta
V^{*}
Q^{*}
\beta
Q(s,a)=Q^{*}(s,a)-\frac{1-\gamma^{(n+1)}}{1-\gamma}\beta
Q^{*}(s,a^{\prime})>Q^{*}(s,a)
Q(s,a^{\prime})=Q^{*}(s,a^{\prime})-\frac{1-\gamma^{(n_{1}+1)}}{1-\gamma})\beta
Q(s,a^{\prime})
Q^{*}(s,a^{\prime})>Q^{*}(s,a)+(\frac{1-\gamma^{(n+1)}}{1-\gamma}-\frac{1-%
\gamma^{(n_{1}+1)}}{1-\gamma})\beta
Q^{*}(s,a)>\hat{Q}(s,a)>Q^{*}(s,a)-\frac{1-\gamma^{(n+1)}}{1-\gamma}\beta
\psi
\theta
\hat{\theta}
\hat{\theta}\leftarrow\theta
\phi
\tau
\alpha
\beta
\psi
\theta
\hat{\theta}\leftarrow(1-\gamma)\hat{\theta}+\gamma\theta
\alpha
\alpha
\beta
L_{\pi}(s)=-\frac{1}{|\mathcal{B}|}\sum_{\left(s_{t},a_{t},r_{t+1},s_{t+1}%
\right)\in\mathcal{B}}E_{a_{t}^{\prime}\sim\pi\left(\cdot\mid s_{t};\theta%
\right)}\left[q_{0}\left(s_{t},a_{t}^{\prime}\right)-\alpha\ln\pi\left(a_{t}^{%
\prime}\mid s_{t};\theta\right)\right]
B
\theta
-\frac{1}{|\mathcal{B}|}
\alpha
\alpha
\beta
\alpha
\beta
\beta
\beta
\beta
\tau
\tau
\tau
\tau
\tau
\tau
\beta
\tau
\tau
\tau
\tau
\tau
\tau
\beta
\beta
\beta
r+\gamma V^{*}-\frac{1-\gamma^{(n+1)}}{1-\gamma}\beta
\beta
\beta
\beta
r+\gamma V^{*}-\frac{1-\gamma^{(n+1)}}{1-\gamma}\beta
\beta
\alpha
\alpha=1.0
\beta=0,2,4,8
\beta
\beta=0
\beta
\beta=0
\beta
\beta
r+\gamma V(s)-\frac{1-\gamma^{(n+1)}}{1-\gamma}\beta
\beta
\beta=2
V^{*}
V(s)=\mathbb{E}_{(s,a)\sim\mathcal{D}}(Q(s,a))
\beta
\pm
\pm
\pm 5.3
\pm
\pm
\pm
\pm
\pm
\pm 1.7
\pm
\pm
\pm
\pm
\pm
\pm 0.9
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm 9.4
\pm
\pm
\pm
\pm
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta=1,2,4,8
beta
\beta
\beta
\beta
\beta
\alpha
\beta
\alpha
\beta
\beta
\tau
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm 8.8
\pm
118.1\pm 30.7
159.8\pm 22.6
118.1\pm 30.7
159.8\pm 22.6
\alpha
alpha
\alpha
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\beta
\alpha
\alpha
\alpha
\alpha
\beta
\alpha
\beta
\alpha
\alpha
\alpha
\alpha
\beta
\alpha
\alpha
\alpha
\beta
\alpha
\beta
\alpha
\beta
\beta
\alpha
\alpha
\beta
\beta
\alpha
\alpha
\displaystyle\hat{Q}^{k+1}\leftarrow\arg\min_{Q}\alpha\cdot\left(\sum_{\mathbf%
{s}\in\mathcal{D}}\mathbb{E}_{\mathbf{a}\sim\mu(\mathbf{a}\mid\mathbf{s})}[Q(%
\mathbf{s},\mathbf{a})]\right)+\frac{1}{2|\mathcal{D}|}\sum_{\mathbf{s},%
\mathbf{a},\mathbf{s}^{\prime}\in\mathcal{D}}\left[\left(Q(\mathbf{s},\mathbf{%
a})-\hat{\mathcal{B}}^{\pi}\hat{Q}^{k}(\mathbf{s},\mathbf{a})\right)^{2}\right]
\displaystyle\hat{Q}^{k+1}\leftarrow\arg\min_{Q}\alpha\cdot\left(\sum_{\mathbf%
{s}\in\mathcal{D}}\mathbb{E}_{\mathbf{a}\sim\mu(\mathbf{a}\mid\mathbf{s})}[Q(%
\mathbf{s},\mathbf{a})]\right)+\frac{1}{2|\mathcal{D}|}\sum_{\mathbf{s},%
\mathbf{a},\mathbf{s}^{\prime}\in\mathcal{D}}\left[\left(Q(\mathbf{s},\mathbf{%
a})-\hat{\mathcal{B}}^{\pi}\hat{Q}^{k}(\mathbf{s},\mathbf{a})\right)^{2}\right]
\hat{\mathbb{B}^{\pi}}
\forall\mathbf{s},\mathbf{a}\in\mathcal{D},\quad\left(\hat{\mathcal{B}}^{\pi}%
\hat{Q}^{k}\right)(\mathbf{s},\mathbf{a})=r+\gamma\sum_{\mathbf{s}^{\prime}}%
\hat{T}\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)\hat{V}^{k}(s)
\tau
Q^{*}
Q^{*}
\left|\hat{Q}(s,a)-\hat{Q}^{*}(s,a)\right|\leq\frac{n_{\mu}}{n_{\pi}}\times%
\frac{1-\gamma^{(n+1)}}{1-\gamma}\times\beta
|r-r(\mathbf{s},\mathbf{a})|\leq\frac{C_{r,\delta}}{\sqrt{|\mathcal{D}(\mathbf%
{s},\mathbf{a})|}},\quad\left\|\hat{T}\left(\mathbf{s}^{\prime}\mid\mathbf{s},%
\mathbf{a}\right)-T\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)%
\right\|_{1}\leq\frac{C_{T,\delta}}{\sqrt{|\mathcal{D}(\mathbf{s},\mathbf{a})|}}
V(s)\leq\frac{2\tau R_{max}}{1-\gamma}
\mathcal{B}^{\pi}\hat{Q}^{k}
\hat{\mathcal{B}}^{\pi}\hat{Q}^{k}
\displaystyle\left|\left(\hat{\mathcal{B}}^{\pi}\hat{Q}^{k}\right)-\left(%
\mathcal{B}^{\pi}\hat{Q}^{k}\right)\right|=\left|(r-r(\mathbf{s},\mathbf{a}))+%
\gamma\sum_{\mathbf{s}^{\prime}}\left(\hat{T}\left(\mathbf{s}^{\prime}\mid%
\mathbf{s},\mathbf{a}\right)-T\left(\mathbf{s}\mathbf{s}^{\prime}\mid\mathbf{s%
},\mathbf{a}\right)\right)V(s^{\prime})\right|
\displaystyle\left|\left(\hat{\mathcal{B}}^{\pi}\hat{Q}^{k}\right)-\left(%
\mathcal{B}^{\pi}\hat{Q}^{k}\right)\right|
\displaystyle=\left|(r-r(\mathbf{s},\mathbf{a}))+\gamma\sum_{\mathbf{s}^{%
\prime}}\left(\hat{T}\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)%
-T\left(\mathbf{s}\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)\right)V(%
s^{\prime})\right|
\displaystyle\leq|r-r(\mathbf{s},\mathbf{a})|+\gamma\left|\sum_{\mathbf{s}^{%
\prime}}\left(\hat{T}\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)%
-T\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)\right)V(s^{\prime}%
)\right|
\displaystyle\leq|r-r(\mathbf{s},\mathbf{a})|+\gamma\left|\sum_{\mathbf{s}^{%
\prime}}\left(\hat{T}\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)%
-T\left(\mathbf{s}^{\prime}\mid\mathbf{s},\mathbf{a}\right)\right)V(s^{\prime}%
)\right|
\displaystyle\leq\frac{C_{r,\delta}+\gamma C_{T,\delta}2R_{\max}\tau/(1-\gamma%
)}{\sqrt{|\mathcal{D}(\mathbf{s},\mathbf{a})|}}
\displaystyle\leq\frac{C_{r,\delta}+\gamma C_{T,\delta}2R_{\max}\tau/(1-\gamma%
)}{\sqrt{|\mathcal{D}(\mathbf{s},\mathbf{a})|}}
\hat{Q}(s,a)\leq Q(s,a)+\frac{(1-\gamma^{(n+1)})n_{\mu}}{(1-\gamma)n_{\pi}}%
\beta+\frac{C_{r,\delta}+\gamma C_{T,\delta}2R_{\max}\tau/(1-\gamma)}{\sqrt{|%
\mathcal{D}(\mathbf{s},\mathbf{a})|}}
\hat{Q}^{k+1}\leftarrow\arg\min_{Q}\alpha\mathbb{E}_{\mathbf{s}\sim\mathcal{D}%
,\mathbf{a}\sim\mu(\mathbf{a}\mid\mathbf{s})}[Q(\mathbf{s},\mathbf{a})]+\frac{%
1}{2}\mathbb{E}_{\mathbf{s},\mathbf{a}\sim\mathcal{D}}\left[\left(Q(\mathbf{s}%
,\mathbf{a})-\hat{\mathcal{B}}^{\pi}\hat{Q}^{k}(\mathbf{s},\mathbf{a})\right)^%
{2}\right]
\tau
\tau
\alpha
\alpha
\tau
\tau
\tau=0.5
\tau
\alpha=3
\alpha=5
\alpha=3
\alpha=5
\tau
\alpha=3
\alpha=5
\alpha
\alpha
\beta
\beta
\beta
\tau
\gamma
\upsilon
