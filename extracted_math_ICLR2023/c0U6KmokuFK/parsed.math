\times
\times
\times
\mathcal{G}
\mathcal{G}
\mathcal{G}
\mathcal{G}
\mathcal{G}
N
(A,X)
A\in\{0,1\}^{N\times N}
N\times N
A_{ij}=1
j
i
X
N
i
X_{i}
D
1\times 1
3\times 3
5\times 5
\mathcal{G}
A
D^{N}2^{N(N-1)/2}
N
D
N=32
\mathcal{G}
\displaystyle\mathbb{P}(A,X)=\prod_{i=1}^{N}\mathbb{P}\left(A_{i,:}\middle|A_{%
i-1,:},X_{i-1},\cdots,A_{1,:},X_{1}\right)\mathbb{P}\left(X_{i}\middle|A_{i-1,%
:},X_{i-1},\cdots,A_{1,:},X_{1}\right),
\displaystyle\mathbb{P}(A,X)=\prod_{i=1}^{N}\mathbb{P}\left(A_{i,:}\middle|A_{%
i-1,:},X_{i-1},\cdots,A_{1,:},X_{1}\right)\mathbb{P}\left(X_{i}\middle|A_{i-1,%
:},X_{i-1},\cdots,A_{1,:},X_{1}\right),
A_{i,:}
X_{i}
i
A
i
A
i
i-1
\displaystyle\mathbb{P}\left(A_{i,:}\middle|A_{i-1,:},X_{i-1},\cdots,A_{1,:},X%
_{1}\right)=\sum_{k=1}^{K}\alpha_{k}\prod_{1\leq j<i}\theta_{k,i,j}
\displaystyle\mathbb{P}\left(A_{i,:}\middle|A_{i-1,:},X_{i-1},\cdots,A_{1,:},X%
_{1}\right)
\displaystyle=\sum_{k=1}^{K}\alpha_{k}\prod_{1\leq j<i}\theta_{k,i,j}
\displaystyle\mathbb{P}\left(X_{i}\middle|A_{i-1,:},X_{i-1},\cdots,A_{1,:},X_{%
1}\right)=\text{Categorical}\left(\beta_{1},\cdots,\beta_{D}\right)
\displaystyle\mathbb{P}\left(X_{i}\middle|A_{i-1,:},X_{i-1},\cdots,A_{1,:},X_{%
1}\right)
\displaystyle=\text{Categorical}\left(\beta_{1},\cdots,\beta_{D}\right)
\displaystyle\alpha_{1},\dots,\alpha_{K}=\text{Softmax}\left(\sum\nolimits_{1%
\leq j<i}\text{MLP}_{\alpha}(h^{S}_{i}-h^{S}_{j})\right)
\displaystyle\alpha_{1},\dots,\alpha_{K}
\displaystyle=\text{Softmax}\left(\sum\nolimits_{1\leq j<i}\text{MLP}_{\alpha}%
(h^{S}_{i}-h^{S}_{j})\right)
\displaystyle\beta_{1},\dots,\beta_{D}=\text{Softmax}\left(\text{MLP}_{\beta}(%
h^{S}_{i})\right)
\displaystyle\beta_{1},\dots,\beta_{D}
\displaystyle=\text{Softmax}\left(\text{MLP}_{\beta}(h^{S}_{i})\right)
\displaystyle\theta_{1,i,j},\dots,\theta_{K,i,j}=\text{Sigmoid}\left(\text{MLP%
}_{\theta}(h^{S}_{i}-h^{S}_{j})\right),
\displaystyle\theta_{1,i,j},\dots,\theta_{K,i,j}
\displaystyle=\text{Sigmoid}\left(\text{MLP}_{\theta}(h^{S}_{i}-h^{S}_{j})%
\right),
K
D
\text{MLP}_{\alpha}
\text{MLP}_{\beta}
\text{MLP}_{\theta}
h^{S}_{i}
i
S
n\leq N
n
\{h^{S}_{i}\}
s
\displaystyle m^{s}_{ij}=f([h^{s}_{i}-h^{s}_{j},\bm{1}_{ij}])
\displaystyle m^{s}_{ij}
\displaystyle=f([h^{s}_{i}-h^{s}_{j},\bm{1}_{ij}])
\displaystyle\tilde{h}^{s}_{i}=[h^{s}_{i},u_{i}]
\displaystyle\tilde{h}^{s}_{i}
\displaystyle=[h^{s}_{i},u_{i}]
\displaystyle a^{s}_{ij}=\text{Sigmoid}(g(\tilde{h}^{s}_{i}-\tilde{h}^{s}_{j}))
\displaystyle a^{s}_{ij}
\displaystyle=\text{Sigmoid}(g(\tilde{h}^{s}_{i}-\tilde{h}^{s}_{j}))
\displaystyle h^{s+1}_{i}=\text{GRU}(h^{s}_{i},\sum\nolimits_{j\in\mathcal{N}(%
i)}a^{s}_{ij}m^{s}_{ij}).
\displaystyle h^{s+1}_{i}
\displaystyle=\text{GRU}(h^{s}_{i},\sum\nolimits_{j\in\mathcal{N}(i)}a^{s}_{ij%
}m^{s}_{ij}).
\mathcal{N}(i)
i
m^{s}_{ij}
i
j
s
A_{1:i-1,1:i-1}
A_{i,:}
f
g
\bm{1}_{ij}
h^{0}_{i}
i<n
h^{0}_{n}
u_{i}
i
i
i
\mathcal{L}
\phi
\displaystyle\nabla\mathcal{L}(\phi)=\mathbb{E}_{\mathbb{P}(\mathcal{G})}\left%
[-\frac{\partial\log\mathbb{P}(\mathcal{G})}{\partial\phi}\bar{R}(\mathcal{G})%
\right],
\displaystyle\nabla\mathcal{L}(\phi)=\mathbb{E}_{\mathbb{P}(\mathcal{G})}\left%
[-\frac{\partial\log\mathbb{P}(\mathcal{G})}{\partial\phi}\bar{R}(\mathcal{G})%
\right],
\bar{R}
\bar{R}(\mathcal{G})=(R(\mathcal{G})-C)/\sigma
C
\sigma
\mathbb{P}(\mathcal{G})
\displaystyle\log\mathbb{P}(\mathcal{G})=\beta\mathbf{1}_{\bar{R}(\mathcal{G})%
\leq 0}\log(1-\mathbb{P}(\mathcal{G}))+\mathbf{1}_{\bar{R}(\mathcal{G})>0}\log%
(\mathbb{P}(\mathcal{G}))
\displaystyle\log\mathbb{P}(\mathcal{G})=\beta\mathbf{1}_{\bar{R}(\mathcal{G})%
\leq 0}\log(1-\mathbb{P}(\mathcal{G}))+\mathbf{1}_{\bar{R}(\mathcal{G})>0}\log%
(\mathbb{P}(\mathcal{G}))
\beta
\mathbb{P}(\mathcal{G})
\epsilon
\epsilon
K
S
h_{i}^{s}
m^{s}_{ij}
\mathcal{G}
N
\times
G
\times
N
\mathcal{G}
2.1\times 10^{149}
K
k
p
p
K
k
p
p
1/10
0.1\leq p\leq 0.5
(2,0.2)\leq(k,p)\leq(6,0.8)
\mathcal{G}
\beta
\epsilon=0.6
30\%
10\%
59.71_{\pm 0.09}
80.32_{\pm 0.10}
63.42_{\pm 0.30}
82.61_{\pm 0.15}
63.62_{\pm 0.07}
82.73_{\pm 0.08}
60.82_{\pm 0.24}
82.29_{\pm 0.09}
61.82_{\pm 0.09}
82.30_{\pm 0.18}
62.55_{\pm 0.15}
82.64_{\pm 0.21}
62.29_{\pm 0.39}
82.16_{\pm 0.24}
63.84_{\pm 0.13}
82.61_{\pm 0.16}
63.69_{\pm 0.28}
82.74_{\pm 0.21}
\mathcal{G}
N=12
D
1\times 1
5\times 5
1\times 1
5\times 5
\mathcal{G}
\forall i>1
A_{i,i-1}=1
1.6\times 10^{29}
p=0.4
\epsilon
423
7
9
{}_{\pm\text{0.143}}
{}_{\pm\text{0.422}}
{}_{\pm\text{0.371}}
{}_{\pm\text{0.296}}
{}_{\pm\text{0.228}}
{}_{\pm\textbf{0.072}}
4
6
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\text{conv}_{1}
\times
\texttt{conv}_{3\times 3}
\texttt{conv}_{3\times 3}
\text{conv}_{2}
\times
\texttt{conv}_{3\times 3}
\texttt{conv}_{3\times 3}
\text{conv}_{3}
\times
\mathcal{G}
\mathcal{G}
\text{conv}_{4}
\times
\mathcal{G}
\mathcal{G}
\mathcal{G}
\text{conv}_{5}
\times
\mathcal{G}
\mathcal{G}
\times
\times
\texttt{conv}_{1\times 1}
\times
\mathcal{G}
N=32
\times
\mathcal{G}
N=32
\mathcal{G}
\mathcal{G}
224\times 224
\mathcal{G}_{\text{train}}
\mathcal{G}_{\text{eval}}
\mathcal{G}_{\text{train}}
\mathcal{G}_{\text{eval}}
p=0.25
\epsilon
