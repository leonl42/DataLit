\mathrm{ReLU}
\mathrm{Dijkstra}(u)
u
\mathrm{flood}_{s}
\mathrm{flood}_{t}
\mathrm{age}
\mathrm{flood}
\mathrm{wall}
\mathrm{step}
\mathrm{ReLU}
\mathrm{age}
\mathrm{ReLU}
\mathrm{flood}
\mathrm{age}
{\rm flood}_{s}
\mathrm{flood}_{t}
\mathrm{path}
{\rm flood}_{s}
{\rm flood}_{t}
{\rm flood}_{s}
\times
{\rm flood}_{t}
\mathrm{path}
{\rm path}_{i,j}
(i,j)\in\{(1,2),(1,0),(0,1),(2,1)\}
\mathrm{path}
u
v
u
v
v
(i,j)^{\text{th}}
u
{\rm path}_{i,j}
u
{\rm age}_{u}
{\rm age}_{v}+1
{\rm path}_{v}=1
\mathrm{sawtooth}
{\rm path}_{i,j}
\mathrm{path}
{\rm path}_{i,j}
\mathrm{step}
\mathrm{PathExtract}(\cdot)
\mathrm{Dijkstra}(u)
u
\mathrm{route}
{\rm route}_{i,j}
(i,j)\in\{(1,2),(2,1),(3,2),(2,3)\}
\mathrm{route}
\mathrm{route}
\mathrm{route}
\mathrm{route}
5\times 5
{\rm route}_{(i,j)}
\mathrm{route}
{\rm route}_{(i,j)}
\mathrm{step}
{\rm path}(i,j)
\mathrm{route}
\mathrm{pebble}
\mathrm{route}
\mathrm{pebble}
\mathrm{stack}
\mathrm{stack\ direction\ chan}
\in\{0.2,0.4,0.6,0.8\}
\mathrm{stack\ rank\ chan}
\mathrm{pebble}
\mathrm{route^{t}}-\mathrm{route^{t-1}}
t
since
\mathrm{pebble}
\mathrm{stack}
\mathrm{pebble}
0
\mathrm{route}
\mathrm{stack\ rank}+\mathrm{stack\ direction}
0
\mathrm{stack}
\mathrm{route}
\mathrm{stack\ chan}=2
\mathrm{stack\ rank}
\mathrm{direction}
\mathrm{DFS}(u)
u
u
\mathrm{Dijkstra}(u)
\mathrm{PathExtract}
\mathrm{PathExtract}(\mathrm{Dijkstra}(\mathrm{u}))
O(n^{3})
O(n)
\mathrm{DFS}
\mathrm{DFS}
\mathrm{Dijkstra}(u)
\mathrm{pebble}
u
\mathrm{pebble}
\mathrm{stack}
\mathrm{Dijkstra}
\mathrm{stack}
+1
u
\mathrm{age}
\mathrm{path\_max}
\mathrm{Dijkstra}(u)
\mathrm{Dijkstra}
\mathrm{DFS}
\mathrm{path\_max}
\mathrm{path\_max}
i=0
\mathrm{prior}=\mathrm{null}
\mathrm{waiting\_time}=0
v
\mathrm{DFS}(v)
\mathrm{DFS}
u^{\mathrm{pebble}}==1
\mathrm{prior}\ !=null
\mathrm{waiting\_time}=\left|\mathrm{prior}^{\mathrm{since}}-u^{\mathrm{since}%
}\right|
\mathrm{prior}=u
\mathrm{waiting\_time}
\mathrm{Dijkstra}(u)
\mathrm{Dijkstra}(v)
v^{\mathrm{path\_max}}=v^{\mathrm{age}},
\mathrm{PathExtract}(\mathrm{Dijkstra}(\operatorname*{arg\,max}(\mathrm{path\_%
max})))
3\times 3
5\times 5
3\times 3
1
0
1
\approx 97\%
50,000
5
10000
16\times 16
\approx 9
32\times 32
\approx 13
3\times 3
4/10
\operatorname*{arg\,max}
5\times 5
5\times 5
3\times 3
3\times 3
32\times 32
3\times 3
32\times 32
3\times 3
3\times 3
W^{(m,n)}_{k}
(m,n)^{\rm th}
\mathbf{W}_{k}
{\rm flood}_{s}
{\rm flood}_{t}
{\rm age}
\mathbf{W}_{1}\in\operatorname*{\mathbb{R}}^{3\times 3}
\mathbf{W}_{1}^{(1,1)}=1
\mathbf{W}_{1}^{(k,l)}=0
\mathrm{flood}
\mathrm{source}
\mathrm{target}
\mathrm{wall}
\mathbf{W}_{T}\in\operatorname*{\mathbb{R}}^{3\times 3}
\mathbf{W}_{T}^{(k,l)}=1
(k,l)\in\{(0,1),(1,0),(1,1),(1,2),(2,1)\}
\mathbf{W}_{T}^{(k,l)}=0
\displaystyle\mathbf{W}_{1}\coloneqq\begin{bmatrix}0&0&0\\
0&1&0\\
0&0&0\end{bmatrix}\mathbf{W}_{T}\coloneqq\begin{bmatrix}0&1&0\\
1&1&1\\
0&1&0\end{bmatrix}
\displaystyle\mathbf{W}_{1}\coloneqq\begin{bmatrix}0&0&0\\
0&1&0\\
0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{T}\coloneqq\begin{bmatrix}0&1&0\\
1&1&1\\
0&1&0\end{bmatrix}
\mathbf{W}_{1}
\mathbf{W}_{T}
\mathbf{W}_{\mathrm{BFS}}[\mathrm{flood}\,,\mathrm{source}]
\xrightarrow[]{}
{\rm flood}_{s}
\mathbf{W}_{1}
{\rm flood}_{s}
\xrightarrow[]{}
{\rm flood}_{s}
\mathbf{W}_{T}
\xrightarrow[]{}
{\rm flood}_{s}
-6\mathbf{W}_{1}
\xrightarrow[]{}
{\rm flood}_{t}
\mathbf{W}_{1}
{\rm flood}_{t}
\xrightarrow[]{}
{\rm flood}_{t}
\mathbf{W}_{T}
\xrightarrow[]{}
{\rm flood}_{t}
-6\mathbf{W}_{1}
{\rm flood}_{s}
\xrightarrow[]{}
\mathbf{W}_{1}
{\rm flood}_{t}
\xrightarrow[]{}
\mathbf{W}_{1}
\xrightarrow[]{}
\mathbf{W}_{1}
\mathbf{W}_{\mathrm{BFS}}\in\operatorname*{\mathbb{R}}^{3\times 7\times 3%
\times 3}
3\times 3
3
\{\mathrm{age},\mathrm{flood}_{s},\mathrm{flood}_{t}\}
4
\{\mathrm{empty},\mathrm{wall},\mathrm{source},\mathrm{target}\}
3
\mathrm{flood}_{s}
\mathrm{flood}_{t}
\mathrm{source}
\mathrm{target}
\mathrm{age}
\mathrm{flood}
\mathbf{X}^{\mathrm{age}}
\mathrm{flood}
0
1
\mathrm{flood}
x\in[0,1]
\mathrm{step}=\begin{cases}0&\text{for }x<0\\
1&\text{for }x\geq 0\end{cases}
\mathbf{X}_{t}
t
\mathbf{X}_{t}\in\operatorname*{\mathbb{R}}^{3\times w\times h}
w
h
\mathbf{X}_{t}=\mathbf{0}
t=0
X_{\mathrm{maze}}
\mathbf{X}_{\mathrm{maze}}\in\operatorname*{\mathbb{R}}^{4\times w\times h}
\mathbf{X}^{i,j}
\mathbf{X}
i,j
\mathbf{X}^{\mathrm{channel}}
\mathbf{X}
\mathrm{channel}
\mathrm{concatenate}
\mathbf{X}
\mathrm{chan}
\mathbf{X}^{\mathrm{chan}}\leftarrow\cdots
(x,y)
\mathbf{X}
t
\displaystyle\mathbf{X}_{t}\xleftarrow[]{}\mathrm{concatenate}\left(\mathbf{X}%
_{t},\mathbf{X}_{\mathrm{maze}}\right)
\displaystyle\mathbf{X}_{t}
\displaystyle\xleftarrow[]{}\mathrm{concatenate}\left(\mathbf{X}_{t},\mathbf{X%
}_{\mathrm{maze}}\right)
\displaystyle\forall x,y,\,\mathbf{X}^{x,y}_{t+1}\xleftarrow[]{}\sum_{i=0}^{2}%
\sum_{j=0}^{2}\mathbf{W}^{i,j}_{\mathrm{BFS}}\odot\mathbf{X}_{t}^{x+i-1,y+j-1}
\displaystyle\forall x,y,\,\mathbf{X}^{x,y}_{t+1}
\displaystyle\xleftarrow[]{}\sum_{i=0}^{2}\sum_{j=0}^{2}\mathbf{W}^{i,j}_{%
\mathrm{BFS}}\odot\mathbf{X}_{t}^{x+i-1,y+j-1}
\displaystyle\mathbf{X}^{\mathrm{flood}}_{t+1}\xleftarrow{}\mathrm{step}\left(%
\mathbf{X}^{\mathrm{flood}}_{t+1},0,1\right)
\displaystyle\mathbf{X}^{\mathrm{flood}}_{t+1}
\displaystyle\xleftarrow{}\mathrm{step}\left(\mathbf{X}^{\mathrm{flood}}_{t+1}%
,0,1\right)
\mathrm{Dijkstra}
\mathrm{age}
\mathrm{Dijkstra}
5
\mathrm{path}
\mathrm{path}_{i,j}
(i,j)\in\{(0,1),(1,0),(1,2),(2,1)\}
\mathbf{W}_{(i,j)}\in\operatorname*{\mathbb{R}}^{3\times 3}
W^{(k,l)}_{(i,j)}\coloneqq 1
(k,l)=(i,j)
W^{(k,l)}_{(i,j)}\coloneqq 0
\displaystyle\mathbf{W}_{1,0}\coloneqq\begin{bmatrix}0&0&0\\
1&0&0\\
0&0&0\end{bmatrix}\mathbf{W}_{0,1}\coloneqq\begin{bmatrix}0&1&0\\
0&0&0\\
0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{1,0}\coloneqq\begin{bmatrix}0&0&0\\
1&0&0\\
0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{0,1}\coloneqq\begin{bmatrix}0&1&0\\
0&0&0\\
0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{1,2}\coloneqq\begin{bmatrix}0&0&0\\
0&0&1\\
0&0&0\end{bmatrix}\mathbf{W}_{2,1}\coloneqq\begin{bmatrix}0&0&0\\
0&0&0\\
0&1&0\end{bmatrix}
\displaystyle\mathbf{W}_{1,2}\coloneqq\begin{bmatrix}0&0&0\\
0&0&1\\
0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{2,1}\coloneqq\begin{bmatrix}0&0&0\\
0&0&0\\
0&1&0\end{bmatrix}
{\rm flood}_{s}\xrightarrow[]{}\mathrm{path}
\mathbf{W}_{1}
{\rm flood}_{t}\xrightarrow[]{}\mathrm{path}
\mathbf{W}_{1}
\mathrm{path}
\xrightarrow[]{}
{\rm path}_{i,j}
2(\mathbf{W}_{(i,j)}-\mathbf{W}_{1}
\xrightarrow[]{}
{\rm path}_{i,j}
\mathbf{W}_{(i,j)}
\mathbf{W}_{\mathrm{PE}}
\mathbf{W}_{\mathrm{PE}}\in\operatorname*{\mathbb{R}}^{5\times 8\times 3\times
3}
0
3\times 3
5
4
\mathrm{path}_{i,j}
\mathrm{path}
3
5
\mathrm{flood}_{s}
\mathrm{flood}_{t}
\mathrm{path}
-1
\mathrm{path}
\mathrm{age}
\mathrm{path}
\mathrm{path_{i,j}}
1
\mathrm{path}_{i,j}
-1
\mathbf{W}_{\mathrm{PE}}
\mathbf{b}_{\mathrm{PE}}
\mathrm{step}
\mathrm{sawtooth}
\operatorname*{ReLU}
\displaystyle\mathrm{sawtooth}_{a}(x)=\begin{cases}0&\text{for }x<-2\\
x+a-1&\text{for }x\in[a-1,a]\\
-x+a+1&\text{for }x\in[a,a+1]\\
1&\text{for }x>a+1\end{cases}
\displaystyle\mathrm{sawtooth}_{a}(x)
\displaystyle=\begin{cases}0&\text{for }x<-2\\
x+a-1&\text{for }x\in[a-1,a]\\
-x+a+1&\text{for }x\in[a,a+1]\\
1&\text{for }x>a+1\end{cases}
\mathrm{sawtooth}_{-1}
1
-1
0
1
1
0
1
\displaystyle\mathbf{X}_{t}\xleftarrow[]{}\mathrm{concatenate}\left(\mathbf{X}%
_{t},\mathbf{X}_{\mathrm{BFS}}\right)
\displaystyle\mathbf{X}_{t}
\displaystyle\xleftarrow[]{}\mathrm{concatenate}\left(\mathbf{X}_{t},\mathbf{X%
}_{\mathrm{BFS}}\right)
\displaystyle\forall x,y,\,\mathbf{X}^{x,y}_{t+1}\xleftarrow[]{}\sum_{i=0}^{2}%
\sum_{j=0}^{2}\mathbf{W}^{i,j}_{\mathrm{PE}}\odot\mathbf{X}_{t}^{x+i-1,y+j-1}+%
\mathbf{b}_{\mathrm{PE}}
\displaystyle\forall x,y,\,\mathbf{X}^{x,y}_{t+1}
\displaystyle\xleftarrow[]{}\sum_{i=0}^{2}\sum_{j=0}^{2}\mathbf{W}^{i,j}_{%
\mathrm{PE}}\odot\mathbf{X}_{t}^{x+i-1,y+j-1}+\mathbf{b}_{\mathrm{PE}}
\displaystyle\forall i,j,\,\mathbf{X}^{\mathrm{path}_{i,j}}_{t+1}\xleftarrow{}%
\mathrm{sawtooth}_{-1}\left(\mathbf{X}^{\mathrm{path}_{i,j}}_{t+1}\right)
\displaystyle\forall i,j,\,\mathbf{X}^{\mathrm{path}_{i,j}}_{t+1}
\displaystyle\xleftarrow{}\mathrm{sawtooth}_{-1}\left(\mathbf{X}^{\mathrm{path%
}_{i,j}}_{t+1}\right)
\displaystyle\mathbf{X}^{\mathrm{path}}_{t+1}\xleftarrow{}\mathrm{step}\left(%
\sum_{(i,j)}\mathbf{X}^{\mathrm{path}_{i,j}}\right)
\displaystyle\mathbf{X}^{\mathrm{path}}_{t+1}
\displaystyle\xleftarrow{}\mathrm{step}\left(\sum_{(i,j)}\mathbf{X}^{\mathrm{%
path}_{i,j}}\right)
\mathbf{W}_{2}\in\operatorname*{\mathbb{R}}^{5\times 5}
W^{(2,2)}_{2}=1
W^{(k,l)}_{2}=0
\mathbf{W}_{2}
\mathbf{W}_{1}
\mathrm{wall}
\mathrm{route}
\mathrm{stack}
\mathbf{W}_{5,(i,j)}\in\operatorname*{\mathbb{R}}^{5\times 5}
(i,j)\in\{(1,2),(2,1),(3,2),(2,3)\}
\mathrm{route}
W^{(k,l)}_{5,(i,j)}=1
(k,l)=(i,j)
W^{(k,l)}_{5,(i,j)}=0
\mathbf{W}_{2}
\mathbf{W}_{1}
\mathbf{W}_{5,(i,j)}
3\times 3
\mathbf{W}_{(i,j)}
\mathrm{route}
\mathrm{flood}
5\times 5
\mathbf{W}_{p,(1,2)}\in\operatorname*{\mathbb{R}}^{5\times 5}
\mathbf{0}
\mathbf{W}_{p,(2,1)}\in\operatorname*{\mathbb{R}}^{5\times 5}
W^{3,1}_{p,(2,1)}=1
0
\mathbf{W}_{p,(3,2)}\in\operatorname*{\mathbb{R}}^{5\times 5}
W^{m,n}_{u}\coloneqq 1
(m,n)\in\{(4,2),(3,3)\}
0
\mathbf{W}_{p,(2,3)}\in\operatorname*{\mathbb{R}}^{5\times 5}
W^{(m,n)}_{p,(2,3)}=1
(m,n)\in\{(1,3),(2,4),(3,3)\}
0
\displaystyle\mathbf{W}_{p,(2,1)}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&0&0&0\\
0&0&0&0&0\\
0&1&0&0&0\\
0&0&0&0&0\end{bmatrix}\mathbf{W}_{p,(3,2)}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&0&0&0\\
0&0&0&0&0\\
0&0&0&1&0\\
0&0&1&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{p,(2,1)}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&0&0&0\\
0&0&0&0&0\\
0&1&0&0&0\\
0&0&0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{p,(3,2)}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&0&0&0\\
0&0&0&0&0\\
0&0&0&1&0\\
0&0&1&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{p,(2,3)}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&0&1&0\\
0&0&0&0&1\\
0&0&0&1&0\\
0&0&0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{p,(2,3)}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&0&1&0\\
0&0&0&0&1\\
0&0&0&1&0\\
0&0&0&0&0\end{bmatrix}
\mathrm{stack}
\mathrm{stack}
\mathrm{stack\_rank}
{\rm stack\_rank}
\rm stack\_rank
\rm stack\_direction
\mathbf{W}_{p}\in\operatorname*{\mathbb{R}}^{5\times 5}
W^{1,2}_{p}=0.2
W^{2,1}_{p}=0.4
W^{3,2}_{p}=0.6
W^{2,3}_{p}=0.8
W^{k,l}_{p}=0
\mathbf{W}_{a}\in\operatorname*{\mathbb{R}}^{5\times 5}
W^{(m,n)}_{a}=1
(m,n)\in\{(1,2),(2,1),(3,2),(2,3)\}
W^{(m,n)}_{a}=0
\displaystyle\mathbf{W}_{p}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&\frac{1}{5}&0&0\\
0&\frac{4}{5}&0&\frac{2}{5}&0\\
0&0&\frac{3}{5}&0&0\\
0&0&0&0&0\end{bmatrix}\mathbf{W}_{a}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&1&0&0\\
0&1&0&1&0\\
0&0&1&0&0\\
0&0&0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{p}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&\frac{1}{5}&0&0\\
0&\frac{4}{5}&0&\frac{2}{5}&0\\
0&0&\frac{3}{5}&0&0\\
0&0&0&0&0\end{bmatrix}
\displaystyle\mathbf{W}_{a}\coloneqq\begin{bmatrix}0&0&0&0&0\\
0&0&1&0&0\\
0&1&0&1&0\\
0&0&1&0&0\\
0&0&0&0&0\end{bmatrix}
\rm stack\_rank
\rm stack\_direction
\mathbf{W}_{\mathrm{DFS}}\in\operatorname*{\mathbb{R}}^{3\times 3}
\mathrm{source}\xrightarrow[]{}\mathrm{route}
\mathbf{W}_{2}
\mathrm{route}
\xrightarrow[]{}
\mathrm{route}
\mathbf{W}_{2}
\mathrm{wall}
\xrightarrow[]{}
\mathrm{route}
-\mathbf{W}_{2}
\mathrm{stack}
\xrightarrow[]{}
\mathrm{route}
-\mathbf{W}_{2}
\mathrm{route}\xrightarrow[]{}\mathrm{route}_{i,j}
\mathbf{W}_{5,(i,j)}
\mathrm{route}\xrightarrow[]{}\mathrm{route}_{i,j}
\mathbf{W}_{p,(i,j)}
\mathrm{empty}\xrightarrow[]{}\mathrm{route}_{i,j}
-\mathbf{W}_{p,(i,j)}
\mathrm{source}\xrightarrow[]{}\mathrm{route}_{i,j}
-\mathbf{W}_{p,(i,j)}
\mathrm{target}\xrightarrow[]{}\mathrm{route}_{i,j}
-\mathbf{W}_{p,(i,j)}
\mathrm{pebble}
\xrightarrow[]{}
\mathrm{stack}
\mathbf{W}_{a}
\mathrm{stack}
\xrightarrow[]{}
\mathrm{stack}
\mathbf{W}_{2}
\mathrm{wall}
\xrightarrow[]{}
\mathrm{stack}
-2\mathbf{W}_{2}
\mathrm{route}
\xrightarrow[]{}
\mathrm{stack}
-2\mathbf{W}_{2}
\mathrm{pebble}\xrightarrow[]{}\rm stack\_direction
\mathbf{W}_{p}
\mathrm{stack\_direction}\xrightarrow[]{}\mathrm{stack\_direction}
\mathbf{W}_{2}
\mathrm{wall}\xrightarrow[]{}\mathrm{stack\_direction}
-2\mathbf{W}_{2}
\mathrm{route}\xrightarrow[]{}\mathrm{stack\_direction}
-2\mathbf{W}_{2}
\mathrm{pebble}\xrightarrow[]{}\rm stack\_rank
\mathbf{W}_{2}
\mathrm{stack\_direction}\xrightarrow[]{}\mathrm{stack\_rank}
\mathbf{W}_{2}
\mathrm{wall}\xrightarrow[]{}\mathrm{stack\_rank}
-2\mathbf{W}_{2}
\mathrm{route}\xrightarrow[]{}\mathrm{stack\_rank}
-2\mathbf{W}_{2}
\mathrm{stack}\xrightarrow[]{}\mathrm{stack\_rank}
\mathbf{W}_{2}
\mathrm{pebble}\xrightarrow[]{}\mathrm{since\_binary}
\mathbf{W}_{2}
\mathrm{since\_binary}\xrightarrow[]{}\mathrm{since\_binary}
\mathbf{W}_{1}
\mathrm{since\_binary}\xrightarrow[]{}\mathrm{since\_binary}
\mathbf{W}_{1}
\mathrm{since}\xrightarrow[]{}\mathrm{since}
\mathbf{W}_{1}
\mathrm{source}
\mathrm{route}
\mathrm{route}
\mathrm{wall}
\mathrm{stack}
\mathrm{route}
\mathrm{route}
\mathbf{W}_{p,(i,j)}
\mathrm{empty}
\mathrm{source}
\mathrm{target}
\mathrm{route}
\mathrm{pebble}
\mathbf{W}_{a}
\mathrm{stack}
\mathrm{stack}
\mathrm{stack}
\mathrm{wall}
\mathrm{route}
\mathrm{stack}
\mathrm{pebble}
\mathrm{stack\_direction}
\mathrm{pebble}
\mathrm{wall}
\mathbf{W}_{p}
\mathrm{stack\_direction}
\mathrm{stack}
\mathrm{route}_{i,j}
\mathrm{route}
\mathrm{wall}
\mathrm{stack}
\mathrm{route}
\mathrm{route}
\mathrm{route}
\mathrm{route}
\mathrm{wall}
\mathrm{stack}
\mathrm{route}
\mathrm{stack}
2
\mathbf{dbl\_stacked}\in\{0,1\}^{w\times h}
\mathrm{stack\_rank}
\mathrm{stack\_direction}
\mathrm{stack}
1
t-1
\mathbf{dbl\_stacked}
\mathrm{stack\_rank}
+1
\mathrm{stack\_rank}
\mathrm{pebble}
\mathrm{route}
\mathrm{pebble}
\mathrm{route}
\mathrm{sawtooth_{0}}
\mathbf{total\_rank}
\mathbf{total\_rank}\in\operatorname*{\mathbb{R}}^{w\times h}
\mathrm{stack\_rank}
\mathrm{stack\_direction}
\mathrm{total\_rank}
0
\mathrm{total\_rank}
\mathrm{step}_{0}(\mathbf{total\_rank}
L
\mathrm{stack\_rank}+1
\mathbf{total\_rank}
\mathrm{min\_total\_rank}\in\operatorname*{\mathbb{Z}}_{0}
\mathrm{min\_total\_rank}=L
\mathrm{total\_rank}-\mathrm{min\_rank}
0
\mathbf{is\_popped}\in\{0,1\}^{w\times h}
1
\mathrm{sawtooth}_{0}
\mathrm{stack}
\mathrm{stack\_rank}
\mathrm{stack\_direction}
\mathrm{is\_popped}
\mathrm{route}
\mathrm{since}
\mathrm{pebble}
\mathrm{stack}
\mathrm{pebble}
\mathrm{since}
\mathrm{since}
\displaystyle\mathbf{X}_{t}\xleftarrow[]{}\mathrm{concatenate}\left(\mathbf{X}%
_{t},\mathbf{X}_{\mathrm{maze}}\right)
\displaystyle\mathbf{X}_{t}
\displaystyle\xleftarrow[]{}\mathrm{concatenate}\left(\mathbf{X}_{t},\mathbf{X%
}_{\mathrm{maze}}\right)
\displaystyle\forall x,y,\,\mathbf{X}^{x,y}_{t+1}\xleftarrow[]{}\sum_{i=0}^{2}%
\sum_{j=0}^{2}\mathbf{W}^{i,j}_{\mathrm{DFS}}\odot\mathbf{X}_{t}^{x+i-1,y+j-1}
\displaystyle\forall x,y,\,\mathbf{X}^{x,y}_{t+1}
\displaystyle\xleftarrow[]{}\sum_{i=0}^{2}\sum_{j=0}^{2}\mathbf{W}^{i,j}_{%
\mathrm{DFS}}\odot\mathbf{X}_{t}^{x+i-1,y+j-1}
\displaystyle\forall i,j,\,\mathbf{X}_{t+1}\xleftarrow{}\mathrm{step}\left(%
\mathbf{X}^{\mathrm{route}_{i,j}}_{t+1}\right)
\displaystyle\forall i,j,\,\mathbf{X}_{t+1}
\displaystyle\xleftarrow{}\mathrm{step}\left(\mathbf{X}^{\mathrm{route}_{i,j}}%
_{t+1}\right)
\displaystyle\mathbf{X}^{\mathrm{route}}_{t+1}\leftarrow\mathrm{step}\left(%
\mathbf{X}^{\mathrm{route}}_{t+1}+\mathrm{step}\left(\sum_{(i,j)}\mathbf{X}^{%
\mathrm{route}_{i,j}}\right)\right)
\displaystyle\mathbf{X}^{\mathrm{route}}_{t+1}
\displaystyle\leftarrow\mathrm{step}\left(\mathbf{X}^{\mathrm{route}}_{t+1}+%
\mathrm{step}\left(\sum_{(i,j)}\mathbf{X}^{\mathrm{route}_{i,j}}\right)\right)
\displaystyle\forall\mathrm{chan}\in\{\mathrm{stack},\mathrm{stack\_rank},%
\mathrm{stack\_direction}\},\,
\displaystyle\forall\mathrm{chan}\in\{\mathrm{stack},\mathrm{stack\_rank},
\displaystyle\mathrm{stack\_direction}\},\,
\displaystyle\mathbf{X}^{\mathrm{chan}}_{t+1}\leftarrow\operatorname*{ReLU}%
\left(\mathbf{X}^{\mathrm{chan}}\right)
\displaystyle\mathbf{X}^{\mathrm{chan}}_{t+1}
\displaystyle\leftarrow\operatorname*{ReLU}\left(\mathbf{X}^{\mathrm{chan}}\right)
\displaystyle\mathbf{dbl\_stacked}\leftarrow\mathrm{sawtooth}_{2}\left(\mathbf%
{X}^{\mathrm{stack}}\right)
\displaystyle\mathbf{dbl\_stacked}
\displaystyle\leftarrow\mathrm{sawtooth}_{2}\left(\mathbf{X}^{\mathrm{stack}}\right)
\displaystyle\forall\mathrm{chan}\in\{\mathrm{stack},\mathrm{stack\_direction}%
\},\,
\displaystyle\forall\mathrm{chan}\in\{\mathrm{stack},
\displaystyle\mathrm{stack\_direction}\},\,
\displaystyle\mathbf{X}^{\mathrm{chan}}_{t+1}\leftarrow\mathbf{X}^{\mathrm{%
chan}}_{t+1}-\mathbf{X}^{\mathrm{chan}}_{t}\odot\mathbf{dbl\_stacked}
\displaystyle\mathbf{X}^{\mathrm{chan}}_{t+1}
\displaystyle\leftarrow\mathbf{X}^{\mathrm{chan}}_{t+1}-\mathbf{X}^{\mathrm{%
chan}}_{t}\odot\mathbf{dbl\_stacked}
\displaystyle\mathbf{X}^{\mathrm{stack}}_{t+1}\leftarrow\mathbf{X}^{\mathrm{%
stack}}_{t+1}-\left(\mathbf{X}^{\mathrm{stack}}_{t}+1\right)\odot\mathbf{dbl\_stacked}
\displaystyle\mathbf{X}^{\mathrm{stack}}_{t+1}
\displaystyle\leftarrow\mathbf{X}^{\mathrm{stack}}_{t+1}-\left(\mathbf{X}^{%
\mathrm{stack}}_{t}+1\right)\odot\mathbf{dbl\_stacked}
\displaystyle\mathbf{X}^{\mathrm{pebble}}_{t+1}\leftarrow\mathbf{X}^{\mathrm{%
route}}_{t+1}-\mathbf{X}^{\mathrm{route}}_{t}
\displaystyle\mathbf{X}^{\mathrm{pebble}}_{t+1}
\displaystyle\leftarrow\mathbf{X}^{\mathrm{route}}_{t+1}-\mathbf{X}^{\mathrm{%
route}}_{t}
\displaystyle\mathrm{is\_stuck}\leftarrow\mathrm{step}\left(\sum_{x,y}\mathbf{%
X}^{\mathrm{pebble},x,y}_{t+1}\right)
\displaystyle\mathrm{is\_stuck}
\displaystyle\leftarrow\mathrm{step}\left(\sum_{x,y}\mathbf{X}^{\mathrm{pebble%
},x,y}_{t+1}\right)
\displaystyle\mathbf{total\_rank}\leftarrow\mathbf{X}^{\mathrm{stack\_rank}}_{%
t+1}+\mathbf{X}^{\mathrm{stack\_direction}}_{t+1}
\displaystyle\mathbf{total\_rank}
\displaystyle\leftarrow\mathbf{X}^{\mathrm{stack\_rank}}_{t+1}+\mathbf{X}^{%
\mathrm{stack\_direction}}_{t+1}
\displaystyle\mathbf{total\_rank}\leftarrow\mathrm{total\_rank}+\mathrm{%
sawtooth}_{0}\left(\mathbf{total\_rank}\right)\cdot L
\displaystyle\mathbf{total\_rank}
\displaystyle\leftarrow\mathrm{total\_rank}+\mathrm{sawtooth}_{0}\left(\mathbf%
{total\_rank}\right)\cdot L
\displaystyle\mathrm{min\_total\_rank}\leftarrow\min_{x,y}\left(\mathbf{total%
\_rank}^{x,y}_{t+1}\right)
\displaystyle\mathrm{min\_total\_rank}
\displaystyle\leftarrow\min_{x,y}\left(\mathbf{total\_rank}^{x,y}_{t+1}\right)
\displaystyle\mathbf{is\_popped}\leftarrow\mathrm{sawtooth}_{0}\left(\mathbf{%
total\_rank}-\mathrm{min\_total\_rank}\right)\cdot\mathrm{is\_stuck}
\displaystyle\mathbf{is\_popped}
\displaystyle\leftarrow\mathrm{sawtooth}_{0}\left(\mathbf{total\_rank}-\mathrm%
{min\_total\_rank}\right)\cdot\mathrm{is\_stuck}
\displaystyle\forall\mathrm{chan}\in\{\mathrm{stack},\mathrm{stack\_rank},%
\mathrm{stack\_direction}\},\,
\displaystyle\forall\mathrm{chan}\in\{\mathrm{stack},\mathrm{stack\_rank},
\displaystyle\mathrm{stack\_direction}\},\,
\displaystyle\mathbf{X}^{\mathrm{chan}}_{t+1}\leftarrow\mathbf{X}^{\mathrm{%
chan}}_{t+1}-\mathbf{X}^{\mathrm{chan}}_{t+1}\odot\mathbf{is\_popped}
\displaystyle\mathbf{X}^{\mathrm{chan}}_{t+1}
\displaystyle\leftarrow\mathbf{X}^{\mathrm{chan}}_{t+1}-\mathbf{X}^{\mathrm{%
chan}}_{t+1}\odot\mathbf{is\_popped}
50,000
~{}5
