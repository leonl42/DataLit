k^{\prime}\leq k
\mathbf{v}\in\mathbb{R}^{m}
\mathbf{M}\in\mathbb{R}^{n\times m}
\textbf{c}_{j}^{(t)}\in\mathbb{R}^{m}
j\in[k]:=\{1,...,k\}
t
X\subseteq\mathbb{R}^{m}
\displaystyle X_{j}^{(t+1)}:=\{\mathbf{x}\in X|\ \mathbf{x}\text{ is assigned %
to }\mathbf{c}_{j}^{(t)}\}
\displaystyle X_{j}^{(t+1)}
\displaystyle:=\{\mathbf{x}\in X|\ \mathbf{x}\text{ is assigned to }\mathbf{c}%
_{j}^{(t)}\}
\displaystyle\omega_{j}^{(t)}:=|X_{j}^{(t)}|.
\displaystyle\omega_{j}^{(t)}
\displaystyle:=|X_{j}^{(t)}|.
k
\mathbf{x}
\mathbf{x}\text{ is assigned to }\textbf{c}_{j}^{(t)}:\iff j=\arg\min_{l\in[k]%
}\|\textbf{c}_{l}^{(t)}-\mathbf{x}\|_{2}.
X_{j}^{(t)}
j
t
\textbf{c}_{j}
\textbf{c}_{j}^{(t)}=\frac{1}{\omega_{j}^{(t)}}\sum_{x\in X_{j}^{(t)}}x.
X_{j}^{(t)}
X=\cup_{i=1}^{N}X_{i}
i\in[N]=\{1,...,N\}
X_{i}\subseteq\mathbb{R}^{m}
i
X_{j}^{(t+1)}
\omega_{j}^{(t)}
\displaystyle X_{i,j}^{(t+1)}:=\{\mathbf{x}\in X_{i}|\ \mathbf{x}\text{ is %
assigned to }\mathbf{c}_{j}^{(t)}\}
\displaystyle X_{i,j}^{(t+1)}
\displaystyle:=\{\mathbf{x}\in X_{i}|\ \mathbf{x}\text{ is assigned to }%
\mathbf{c}_{j}^{(t)}\}
\displaystyle\omega_{i,j}^{(t)}:=|X_{i,j}^{(t)}|.
\displaystyle\omega_{i,j}^{(t)}
\displaystyle:=|X_{i,j}^{(t)}|.
X_{i}
\omega_{j}^{(t)}=\sum_{i=1}^{N}\omega_{i,j}^{(t)}.
\displaystyle\textbf{c}_{j}^{(t)}=\frac{1}{\omega_{j}^{(t)}}\sum_{\mathbf{x}%
\in X_{j}^{(t)}}\mathbf{x}
\displaystyle\textbf{c}_{j}^{(t)}
\displaystyle=\frac{1}{\omega_{j}^{(t)}}\sum_{\mathbf{x}\in X_{j}^{(t)}}%
\mathbf{x}
\displaystyle=\frac{1}{\omega_{j}^{(t)}}\sum_{i=1}^{N}\omega_{i,j}^{(t)}\left(%
\frac{1}{\omega_{i,j}^{(t)}}\sum_{\textbf{x}\in X_{i,j}^{(t)}}\textbf{x}\right)
\displaystyle=\frac{1}{\omega_{j}^{(t)}}\sum_{i=1}^{N}\omega_{i,j}^{(t)}\left(%
\frac{1}{\omega_{i,j}^{(t)}}\sum_{\textbf{x}\in X_{i,j}^{(t)}}\textbf{x}\right)
\displaystyle=\sum_{i=1}^{N}\lambda_{i,j}^{(t)}\cdot\textbf{c}_{i,j}^{(t)},
\displaystyle=\sum_{i=1}^{N}\lambda_{i,j}^{(t)}\cdot\textbf{c}_{i,j}^{(t)},
\textbf{c}_{i,j}^{(t)}:=\frac{1}{\omega_{i,j}^{(t)}}\sum_{\textbf{x}\in X_{i,j%
}^{(t)}}\textbf{x}
X_{i}
\textbf{c}_{1}^{(t-1)},...,\textbf{c}_{k}^{(t-1)}
\lambda_{i,j}^{(t)}:=\frac{\omega_{i,j}^{(t)}}{\omega_{j}^{(t)}}
X
\lambda_{i,j}^{(t)}
\textbf{c}_{i,j}^{(t)}\in\mathbb{R}^{m}
j\in[k]
t
i\in[N]
\omega_{i,j}^{(t)}\in\mathbb{R}_{\geq 0}
\textbf{c}_{j}^{(t)}\in\mathbb{R}^{m}
\displaystyle\textbf{c}^{(t)}_{j}:=\sum_{i\in I_{t}}\lambda_{i,j}^{(t)}\cdot%
\textbf{c}_{i,j}^{(t)},
\displaystyle\textbf{c}^{(t)}_{j}:=\sum_{i\in I_{t}}\lambda_{i,j}^{(t)}\cdot%
\textbf{c}_{i,j}^{(t)},
\displaystyle\lambda_{i,j}^{(t)}:=\begin{cases}\frac{\omega_{i,j}^{(t)}}{\sum_%
{i\in I_{t}}\omega_{i,j}^{(t)}},&\text{if }\sum_{i\in I_{t}}\omega_{i,j}^{(t)}%
>0\\
\frac{1}{|I_{t}|},&\text{else,}\end{cases}
\displaystyle\lambda_{i,j}^{(t)}:=\begin{cases}\frac{\omega_{i,j}^{(t)}}{\sum_%
{i\in I_{t}}\omega_{i,j}^{(t)}},&\text{if }\sum_{i\in I_{t}}\omega_{i,j}^{(t)}%
>0\\
\frac{1}{|I_{t}|},&\text{else,}\end{cases}
\emptyset\neq I_{t}\subseteq\{1,...,N\}
t>0
\lambda_{i,j}^{(t)}
I_{t}\subseteq[N]
t
\textbf{c}_{j}^{(t)}\in\mathbb{R}^{m}
\eta\in(0,1]
\mu\in[0,1)
\displaystyle\textbf{d}^{(t)}_{j}:=\sum_{i\in I}\lambda_{i,j}^{(t)}\cdot%
\textbf{c}_{i,j}^{(t)}
\displaystyle\textbf{d}^{(t)}_{j}:=\sum_{i\in I}\lambda_{i,j}^{(t)}\cdot%
\textbf{c}_{i,j}^{(t)}
\displaystyle\textbf{c}^{(t+1)}_{j}=\textbf{c}^{(t)}_{j}+\eta\cdot\left(%
\textbf{d}^{(t+1)}_{j}-\textbf{c}^{(t)}_{j}\right)+\mu\cdot\left(\textbf{c}^{(%
t)}_{j}-\textbf{c}^{(t-1)}_{j}\right),
\displaystyle\textbf{c}^{(t+1)}_{j}=\textbf{c}^{(t)}_{j}+\eta\cdot\left(%
\textbf{d}^{(t+1)}_{j}-\textbf{c}^{(t)}_{j}\right)+\mu\cdot\left(\textbf{c}^{(%
t)}_{j}-\textbf{c}^{(t-1)}_{j}\right),
\textbf{c}^{(-1)}_{j}:=\textbf{c}^{(0)}_{j}
\displaystyle\omega_{i,j}^{(t+1)}:=|\{\textbf{x}\in X_{i}|\ \textbf{x}\text{ %
is assigned to centroid }\textbf{c}_{j}^{(t)}\}|.
\displaystyle\omega_{i,j}^{(t+1)}:=|\{\textbf{x}\in X_{i}|\ \textbf{x}\text{ %
is assigned to centroid }\textbf{c}_{j}^{(t)}\}|.
\displaystyle\omega_{i,j}^{(t)}:=\frac{1}{|I_{t}|}.
\displaystyle\omega_{i,j}^{(t)}:=\frac{1}{|I_{t}|}.
\textbf{c}^{(0)}_{j}\in\mathbb{R}^{m}
j=[k]
\textbf{c}_{i,j}^{(t)}\in\mathbb{R}^{m}
i\in I_{t}
\|\mathbf{C}^{(t)}-\mathbf{C}^{(t-1)}\|_{F}<\varepsilon
\varepsilon>0
\|\cdot\|_{F}
\mathbf{C}^{(t)},\mathbf{C}^{(t-1)}
\textbf{c}^{(t)}_{1},...,\textbf{c}^{(t)}_{k}
\textbf{c}^{(t-1)}_{1},...,\textbf{c}^{(t-1)}_{k}
(X_{i})_{i\in[n]}
k
n_{\text{init}}
\text{max}_{\text{global}}
\text{max}_{\text{local}}
\eta
\mu
\epsilon>0
n_{\text{clients}}
m\times k
m
\leftarrow
\infty
\text{iteration}=1,...,n_{\text{init}}
\textbf{C}\leftarrow
\textbf{C}_{\text{old}}\leftarrow
t=
\text{max}_{\text{global}}
I_{t}\leftarrow
n_{\text{clients}}
\in I_{t}
\textbf{C}_{i}
\omega_{i}
\leftarrow
X_{i}
\text{max}_{\text{local}}
\epsilon
\textbf{C}_{\text{new}}\leftarrow
(\textbf{C}_{i})_{i\in I_{t}}
(\omega_{i})_{i\in I_{t}}
\textbf{C}_{\text{old}}
\eta
\mu
\text{movement}\leftarrow\lVert\textbf{C}_{\text{new}}-\textbf{C}\rVert_{F}
\textbf{C},\textbf{C}_{\text{old}}\leftarrow\textbf{C}_{\text{new}},\textbf{C}
t\geq\text{max}_{\text{global}}
\text{movement}<\epsilon
\leftarrow
(X_{i})_{i\in[n]}
<
\leftarrow
t
t
X_{i}
X_{i}
\varepsilon>0
28\times 28
28\times 28
\mathbf{c}
\mathbf{c}\in[-1,1]^{2}
0.2
\mathbf{x}\in[-1,1]^{2}
28\times 28
n_{\text{init}}=5
28\times 28
\textit{fraction of data to sample}=0.05
\textit{t}=\textit{"sample"}
\textit{sample seed}=549786595
\textit{split seed}=154978679
\displaystyle\text{score}(X,\mathbf{C}):=\frac{1}{|X|}\sum_{j=1}^{k}\sum_{%
\mathbf{x}\in X_{j}}\|\mathbf{x}-\mathbf{c}_{j}\|_{2}^{2},
\displaystyle\text{score}(X,\mathbf{C}):=\frac{1}{|X|}\sum_{j=1}^{k}\sum_{%
\mathbf{x}\in X_{j}}\|\mathbf{x}-\mathbf{c}_{j}\|_{2}^{2},
X
\mathbf{C}
\mathbf{c}_{1},...,\mathbf{c}_{k}
X_{j}
\mathbf{c}_{j}
\frac{1}{|X|}
X
l_{\text{true}}
l_{\text{pred}}
l_{\text{pred}}
l_{\text{true}}
\displaystyle\text{v-measure}:=2\cdot\frac{\text{homogeneity}\cdot\text{%
completeness}}{\text{homogeneity}+\text{completeness}},
\displaystyle\text{v-measure}:=2\cdot\frac{\text{homogeneity}\cdot\text{%
completeness}}{\text{homogeneity}+\text{completeness}},
0
1
1
\epsilon=10^{-8}
N_{\text{steps}}=300
\text{max}_{\text{global}}=10,000
n_{\text{init}}=1
\text{max}_{\text{local}}=5
lr=0.01
m=0.8
n_{\text{clients}}=5,10,15,...,100
k
k=5
k=20
k=64
k
k
\text{datasets}\cdot\text{distributions}\cdot\text{models}\cdot\text{\#Clients%
 per round}\cdot\text{runs}=3\cdot 3\cdot 4\cdot 20\cdot 100=72,000
n_{\text{clients}}
m
n_{\text{clients}}
\pm
n_{\text{clients}}
m
n_{\text{clients}}
\pm
n_{\text{clients}}=100
\mathbf{M}\in\mathbb{R}^{m\times n}
\mathbf{M}_{\cdot,j}
X_{i}
\text{max}_{\text{local}}
\epsilon>0
\textbf{C}_{i}\in\mathbb{R}^{m\times k}
\omega_{i}\in\mathbb{R}^{k}
\textbf{C}_{i}\leftarrow
X_{i}
k
\text{max}_{\text{local}}
\epsilon
i=
\omega_{i,j}\leftarrow|\{x\in X_{i}|\ x\text{ is assigned to centroid }\textbf%
{c}_{j}\}|
\textbf{C}_{i}
\omega_{i}
(\textbf{C}_{i})_{i\in I_{t}}
(\omega_{i})_{i\in I_{t}}
\textbf{C}_{\text{old}}
\eta
\mu
\textbf{C}_{\text{new}}\in\mathbb{R}^{m\times k}
m
\leftarrow\sum_{i\in I_{t}}\omega_{i}\in\mathbb{R}^{k}
j=1,...,k
\mathbf{s}_{j}=0
\lambda_{j}\leftarrow\frac{1}{|I_{t}|}
\lambda_{j}\leftarrow\omega_{j}
(\textbf{D})_{\cdot,j}\leftarrow\frac{1}{\textbf{s}_{s}}\sum_{i\in I_{t}}%
\lambda_{j}\cdot(\textbf{C}_{i})_{\cdot,j}
\textbf{C}_{\text{new}}\leftarrow\textbf{C}+\eta\cdot(\textbf{D}-\textbf{C})+%
\mu\cdot(\textbf{C}-\textbf{C}_{\text{old}})
\textbf{C}_{\text{new}}
(X_{i})_{i\in[N]}
s\in\mathbb{R}
\leftarrow 0
B\subseteq[N]
B
i\in B
s_{i}\leftarrow
X_{i}
\frac{\sum_{i\in B}s_{i}}{|B|}
n_{\text{clients}}=1,2,...,10
n_{\text{clients}}=5,10,...,100
n_{\text{clients}}
m
n_{\text{clients}}
\pm
n_{\text{clients}}
m
n_{\text{clients}}
\pm
n_{\text{clients}}=100
n_{\text{clients}}=100
n_{\text{clients}}=100
n_{\text{clients}}=100
n_{\text{clients}}=100
n_{\text{clients}}=100
