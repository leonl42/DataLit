[0,T]
T
t_{1:N}=(t_{1},...,t_{N})
{\bm{y}}_{1:N}=({\bm{y}}_{1},\ldots,{\bm{y}}_{N})
{\bm{y}}_{i}:={\bm{y}}(t_{i})\in\mathbb{R}^{D}
N=10
N
N=10
N
{\bm{y}}_{1:N}
{\bm{x}}_{1:N}:=({\bm{x}}_{1},...,{\bm{x}}_{N})
{\bm{x}}_{i}:={\bm{x}}(t_{i})\in\mathbb{R}^{d}
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{x}}_{1},t_{1},t_{i},f_{\theta%
_{\text{dyn}}}),\quad i=2,...,N,
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{x}}_{1},t_{1},t_{i},f_{\theta%
_{\text{dyn}}}),\quad
\displaystyle i=2,...,N,
\displaystyle{\bm{y}}_{i}|{\bm{x}}_{i}\sim p({\bm{y}}_{i}|g_{\theta_{\text{dec%
}}}({\bm{x}}_{i})),\quad i=1,...,N.
\displaystyle{\bm{y}}_{i}|{\bm{x}}_{i}\sim p({\bm{y}}_{i}|g_{\theta_{\text{dec%
}}}({\bm{x}}_{i})),\quad
\displaystyle i=1,...,N.
{\bm{x}}_{1}
t_{1}
f_{\theta_{\text{dyn}}}
{\bm{x}}(t)
\mathrm{ODEsolve}({\bm{x}}_{1},t_{1},t_{i},f_{\theta_{\text{dyn}}})
t_{i}
\displaystyle\frac{d{\bm{x}}(t)}{dt}=f_{\theta_{\text{dyn}}}(t,{\bm{x}}(t)),%
\quad{\bm{x}}(t_{1})={\bm{x}}_{1},\quad t\in[t_{1},t_{i}].
\displaystyle\frac{d{\bm{x}}(t)}{dt}=f_{\theta_{\text{dyn}}}(t,{\bm{x}}(t)),%
\quad{\bm{x}}(t_{1})={\bm{x}}_{1},\quad t\in[t_{1},t_{i}].
g_{\theta_{\text{dec}}}
{\bm{x}}_{i}
p({\bm{y}}_{i}|g_{\theta_{\text{dec}}}({\bm{x}}_{i}))
\theta_{\text{dyn}}
\theta_{\text{dec}}
d\ll D
{\bm{x}}_{1:N}
{\bm{x}}_{1}
[t_{1},t_{N}]
[t_{1},t_{N}]
{\bm{y}}_{1:5}
t_{1:5}
q_{\bm{\psi}_{1}}({\bm{s}}_{1}),q_{\bm{\psi}_{2}}({\bm{s}}_{2})
{\bm{s}}_{1},{\bm{s}}_{2}
{\bm{s}}_{1},{\bm{s}}_{2}
{\bm{x}}_{1:5}
{\bm{y}}_{1:5}
t_{1:5}
q_{\bm{\psi}_{1}}({\bm{s}}_{1}),q_{\bm{\psi}_{2}}({\bm{s}}_{2})
{\bm{s}}_{1},{\bm{s}}_{2}
{\bm{s}}_{1},{\bm{s}}_{2}
{\bm{x}}_{1:5}
[t_{1},t_{4}]
{\bm{x}}_{i}
{\bm{x}}_{1}
[t_{1},t_{4}]
{\bm{x}}_{i}
{\bm{s}}_{i-1}
[t_{1},t_{4}]
{\bm{x}}_{i}
{\bm{x}}_{1}
[t_{1},t_{4}]
{\bm{x}}_{i}
{\bm{s}}_{i-1}
{\bm{s}}_{1:N-1}=({\bm{s}}_{1},\ldots,{\bm{s}}_{N-1})
{\bm{s}}_{i}\in\mathbb{R}^{d}
t_{1:N-1}
\displaystyle{\bm{x}}_{1}={\bm{s}}_{1},
\displaystyle{\bm{x}}_{1}={\bm{s}}_{1},
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{i-1},t_{i-1},t_{i},f_{%
\theta_{\text{dyn}}}),
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{i-1},t_{i-1},t_{i},f_{%
\theta_{\text{dyn}}}),
\displaystyle{\bm{y}}_{i}|{\bm{x}}_{i}\sim p\big{(}{\bm{y}}_{i}|g_{\theta_{%
\text{dec}}}\big{(}{\bm{x}}_{i})\big{)}.
\displaystyle{\bm{y}}_{i}|{\bm{x}}_{i}\sim p\big{(}{\bm{y}}_{i}|g_{\theta_{%
\text{dec}}}\big{(}{\bm{x}}_{i})\big{)}.
{\bm{x}}_{1}
{\bm{s}}_{1}
{\bm{x}}_{i}
{\bm{s}}_{i-1}
[t_{i-1},t_{i}]
{\bm{x}}_{i}
{\bm{s}}_{i}
\theta_{\text{dyn}},\theta_{\text{dec}}
{\bm{s}}_{1:N-1}
B=2
\mathcal{I}_{1}=\{2,3,4\}
\mathcal{I}_{2}=\{5,6\}
B=2
\mathcal{I}_{1}=\{2,3,4\}
\mathcal{I}_{2}=\{5,6\}
B
b\in\{1,...,B\}
\mathcal{I}_{b}
\cup_{b}\mathcal{I}_{b}=\{2,\ldots,N\}
t_{1}
b
\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}
\{t_{i}\}_{i\in\mathcal{I}_{b}}
{\bm{s}}_{b}
{\bm{s}}_{b}
t_{[b]}
\{{\bm{x}}_{i}\}_{i\in\mathcal{I}_{b}}
{\bm{s}}_{b}
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{b},t_{[b]},t_{i},f_{%
\theta_{\mathrm{dyn}}}),\quad i\in\mathcal{I}_{b}.
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{b},t_{[b]},t_{i},f_{%
\theta_{\mathrm{dyn}}}),\quad i\in\mathcal{I}_{b}.
{\bm{s}}_{1:B},\theta_{\text{dyn}}
\theta_{\text{dyn}}
\displaystyle p({\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{dec}})=p({\bm%
{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{\text{dec}}),
\displaystyle p({\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{dec}})=p({\bm%
{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{\text{dec}}),
p(\theta_{\text{dyn}}),p(\theta_{\text{dec}})
p({\bm{s}}_{1:B}|\theta_{\text{dyn}})
\displaystyle p({\bm{s}}_{1:B}|\theta_{\text{dyn}})=p({\bm{s}}_{1})\prod_{b=2}%
^{B}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{dyn}})}=p({\bm{s}}_{1})\prod_%
{b=2}^{B}{\mathcal{N}\left({\bm{s}}_{b}|\mathrm{ODEsolve}({\bm{s}}_{b-1},t_{[b%
-1]},t_{[b]},f_{\theta_{\text{dyn}}}),\sigma_{c}^{2}I\right)},
\displaystyle p({\bm{s}}_{1:B}|\theta_{\text{dyn}})
\displaystyle=p({\bm{s}}_{1})\prod_{b=2}^{B}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},%
\theta_{\text{dyn}})}=p({\bm{s}}_{1})\prod_{b=2}^{B}{\mathcal{N}\left({\bm{s}}%
_{b}|\mathrm{ODEsolve}({\bm{s}}_{b-1},t_{[b-1]},t_{[b]},f_{\theta_{\text{dyn}}%
}),\sigma_{c}^{2}I\right)},
p({\bm{s}}_{1})
\mathcal{N}
I\in\mathbb{R}^{d\times d}
\sigma_{c}^{2}
{\bm{s}}_{b}
b-1
{\bm{s}}_{2}
{\bm{x}}(t_{[2]})={\bm{x}}_{4}
\displaystyle\theta_{\text{dyn}},\theta_{\text{dec}}\sim p(\theta_{\text{dyn}}%
)p(\theta_{\text{dec}}),\quad{\bm{s}}_{1:B}|\theta_{\text{dyn}}\sim p({\bm{s}}%
_{1:B}|\theta_{\text{dyn}}),
\displaystyle\theta_{\text{dyn}},\theta_{\text{dec}}\sim p(\theta_{\text{dyn}}%
)p(\theta_{\text{dec}}),\quad{\bm{s}}_{1:B}|\theta_{\text{dyn}}\sim p({\bm{s}}%
_{1:B}|\theta_{\text{dyn}}),
\displaystyle{\bm{x}}_{1}={\bm{s}}_{1},
\displaystyle{\bm{x}}_{1}={\bm{s}}_{1},
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{b},t_{[b]},t_{i},f_{%
\theta_{\text{dyn}}}),\quad b\in\{1,...,B\},\ i\in\mathcal{I}_{b},
\displaystyle{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{b},t_{[b]},t_{i},f_{%
\theta_{\text{dyn}}}),\quad
\displaystyle b\in\{1,...,B\},\ i\in\mathcal{I}_{b},
\displaystyle{\bm{y}}_{i}|{\bm{x}}_{i}\sim p({\bm{y}}_{i}|g_{\theta_{\text{dec%
}}}({\bm{x}}_{i})),\quad i=1,...,N.
\displaystyle{\bm{y}}_{i}|{\bm{x}}_{i}\sim p({\bm{y}}_{i}|g_{\theta_{\text{dec%
}}}({\bm{x}}_{i})),\quad
\displaystyle i=1,...,N.
{\bm{x}}_{1:N}
{\bm{s}}_{1:B}
\theta_{\text{dyn}}
\displaystyle p({\bm{y}}_{1:N},{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})=p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text%
{dec}})p({\bm{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{%
\text{dec}}).
\displaystyle p({\bm{y}}_{1:N},{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})=p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text%
{dec}})p({\bm{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{%
\text{dec}}).
p(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B}|{\bm{y}}_{1:N})
\displaystyle q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})=q(%
\theta_{\text{dyn}})q(\theta_{\text{dec}})q({\bm{s}}_{1:B})=q_{\bm{\psi}_{%
\text{dyn}}}(\theta_{\text{dyn}})q_{\bm{\psi}_{\text{dec}}}(\theta_{\text{dec}%
})\prod_{b=1}^{B}{q_{\bm{\psi}_{b}}({\bm{s}}_{b})}
\displaystyle q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})
\displaystyle=q(\theta_{\text{dyn}})q(\theta_{\text{dec}})q({\bm{s}}_{1:B})=q_%
{\bm{\psi}_{\text{dyn}}}(\theta_{\text{dyn}})q_{\bm{\psi}_{\text{dec}}}(\theta%
_{\text{dec}})\prod_{b=1}^{B}{q_{\bm{\psi}_{b}}({\bm{s}}_{b})}
\bm{\psi}_{\text{dyn}}
\bm{\psi}_{\text{dec}}
\bm{\psi}_{1:B}=({\bm{\psi}_{1}},\ldots,{\bm{\psi}_{B}})
\theta_{\text{dyn}}
\theta_{\text{dec}}
{\bm{\psi}_{1:B}}
h_{\theta_{\text{enc}}}
\theta_{\text{enc}}
{\bm{y}}_{1:N}
{\bm{\psi}_{1:B}}
q_{\bm{\psi}_{b}}({\bm{s}}_{b}|{\bm{y}}_{1:N},\theta_{\text{enc}})
\bm{\psi}_{b}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:N})
q({\bm{s}}_{b})
q_{\bm{\psi}_{b}}({\bm{s}}_{b})
q_{\bm{\psi}_{\text{dyn}}}
q_{\bm{\psi}_{\text{dec}}}
q_{\bm{\psi}_{b}}
q({\bm{s}}_{1:B})
{\bm{s}}_{1:B}
{\bm{x}}_{1:N}
q({\bm{s}}_{1:B})
p({\bm{s}}_{1:B}|\theta_{\text{dyn}})
{\bm{s}}_{1:B}
{\bm{s}}_{1:B}
{\bm{s}}_{1}
\displaystyle\mathrm{KL}\big{[}q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{%
s}}_{1:B})\lVert p(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B}|{\bm%
{y}}_{1:N})\big{]},
\displaystyle\mathrm{KL}\big{[}q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{%
s}}_{1:B})\lVert p(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B}|{\bm%
{y}}_{1:N})\big{]},
\displaystyle\mathcal{L}=\underbrace{\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}%
}_{1})}\big{[}\log p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\big{]}}_{%
\textit{(i)}\text{ data likelihood}}+\sum_{b=1}^{B}\sum_{i\in\mathcal{I}_{b}}%
\underbrace{\mathbb{E}_{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{b}%
)}\big{[}\log p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{%
dec}})\big{]}}_{\textit{(ii)}\text{ data likelihood}}
\displaystyle\mathcal{L}
\displaystyle=\underbrace{\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}}_{1})}\big%
{[}\log p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\big{]}}_{\textit{(i)}%
\text{ data likelihood}}+\sum_{b=1}^{B}\sum_{i\in\mathcal{I}_{b}}\underbrace{%
\mathbb{E}_{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{b})}\big{[}%
\log p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{dec}})\big{%
]}}_{\textit{(ii)}\text{ data likelihood}}
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q({\bm{s}}_{1})\lVert p({\bm{%
s}}_{1})\big{]}}_{\textit{(iii)}\text{ initial state prior}}-\sum_{b=2}^{B}%
\underbrace{\mathbb{E}_{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})}\Big{[}\mathrm{%
KL}\big{[}q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{%
dyn}})\big{]}\Big{]}}_{\textit{(iv)}\text{ continuity prior}}
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q({\bm{s}}_{1})\lVert p({\bm{%
s}}_{1})\big{]}}_{\textit{(iii)}\text{ initial state prior}}-\sum_{b=2}^{B}%
\underbrace{\mathbb{E}_{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})}\Big{[}\mathrm{%
KL}\big{[}q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{%
dyn}})\big{]}\Big{]}}_{\textit{(iv)}\text{ continuity prior}}
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q(\theta_{\text{dyn}})\lVert p%
(\theta_{\text{dyn}})\big{]}}_{\textit{(v)}\text{ dynamics prior}}-\underbrace%
{\mathrm{KL}\big{[}q(\theta_{\text{dec}})\lVert p(\theta_{\text{dec}})\big{]}}%
_{\textit{(vi)}\text{ decoder prior}}.
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q(\theta_{\text{dyn}})\lVert p%
(\theta_{\text{dyn}})\big{]}}_{\textit{(v)}\text{ dynamics prior}}-\underbrace%
{\mathrm{KL}\big{[}q(\theta_{\text{dec}})\lVert p(\theta_{\text{dec}})\big{]}}%
_{\textit{(vi)}\text{ decoder prior}}.
{\bm{y}}_{1:m}^{*}
t_{1:m}^{*}
{\bm{y}}_{n}^{*}
t_{n}^{*}>t_{m}^{*}
\displaystyle p({\bm{y}}_{n}^{*}|{\bm{y}}_{1:m}^{*},{\bm{y}}_{1:N})\approx\int
p%
({\bm{y}}_{n}^{*}|{\bm{s}}_{1}^{*},\theta_{\text{dyn}},\theta_{\text{dec}})q_{%
\bm{\psi}_{1}^{*}}({\bm{s}}_{1}^{*})q_{\bm{\psi}_{\text{dyn}}}(\theta_{\text{%
dyn}})q_{\bm{\psi}_{\text{dec}}}(\theta_{\text{dec}})\mathrm{d}{\bm{s}}_{1}^{*%
}\mathrm{d}\theta_{\text{dyn}}\mathrm{d}\theta_{\text{dec}},
\displaystyle p({\bm{y}}_{n}^{*}|{\bm{y}}_{1:m}^{*},{\bm{y}}_{1:N})
\displaystyle\approx\int p({\bm{y}}_{n}^{*}|{\bm{s}}_{1}^{*},\theta_{\text{dyn%
}},\theta_{\text{dec}})q_{\bm{\psi}_{1}^{*}}({\bm{s}}_{1}^{*})q_{\bm{\psi}_{%
\text{dyn}}}(\theta_{\text{dyn}})q_{\bm{\psi}_{\text{dec}}}(\theta_{\text{dec}%
})\mathrm{d}{\bm{s}}_{1}^{*}\mathrm{d}\theta_{\text{dyn}}\mathrm{d}\theta_{%
\text{dec}},
\bm{\psi}_{1}^{*}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:m}^{*})
{\bm{s}}_{m}^{*}
{\bm{s}}_{1}^{*}
{\bm{s}}_{1}^{*}
B=2
{\bm{y}}_{1:5}
{\bm{s}}_{1},{\bm{s}}_{2}
t_{1},t_{3}
B=2
{\bm{y}}_{1:5}
{\bm{s}}_{1},{\bm{s}}_{2}
t_{1},t_{3}
\bm{\psi}_{1:B}
\bm{\psi}_{1:B}
\displaystyle\bm{\psi}_{1:B}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:N})=h_{\text{%
read}}(h_{\text{agg}}(h_{\text{comp}}({\bm{y}}_{1:N}))),
\displaystyle\bm{\psi}_{1:B}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:N})=h_{\text{%
read}}(h_{\text{agg}}(h_{\text{comp}}({\bm{y}}_{1:N}))),
h_{\text{comp}}:\mathbb{R}^{D}\to\mathbb{R}^{D_{\text{low}}}
{\bm{y}}_{1:N}\in\mathbb{R}^{D\times N}
{\bm{a}}_{1:N}\in\mathbb{R}^{D_{\text{low}}\times N}
D_{\text{low}}\ll D
h_{\text{agg}}:\mathbb{R}^{D_{\text{low}}\times N}\to\mathbb{R}^{D_{\text{low}%
}\times B}
{\bm{a}}_{1:N}
{\bm{b}}_{1:B}\in\mathbb{R}^{D_{\text{low}}\times B}
{\bm{b}}_{i}
{\bm{s}}_{i}
h_{\text{read}}:\mathbb{R}^{D_{\text{low}}}\to\mathbb{R}^{P}
\bm{\psi}_{1:B}\in\mathbb{R}^{P\times B}
{\bm{b}}_{1:B}
h_{\text{comp}}
h_{\text{read}}
h_{\text{agg}}
L
\ell\in\{1,\ldots,L\}
\bm{\alpha}_{1:N}^{(\ell)}:=(\bm{\alpha}_{1}^{(\ell)},\ldots,\bm{\alpha}_{N}^{%
(\ell)})\in\mathbb{R}^{D_{\text{low}}\times N}
\bm{\beta}_{1:N}^{(\ell)}:=(\bm{\beta}_{1}^{(\ell)},\ldots,\bm{\beta}_{N}^{(%
\ell)})\in\mathbb{R}^{D_{\text{low}}\times N}
\bm{\alpha}_{1:N}^{(L)}
\bm{\beta}_{1:B}^{(L)}
\bm{\alpha}_{1:N}^{(1)}={\bm{a}}_{1:N}
{\bm{b}}_{1:B}=\mathrm{FF}(\bm{\beta}_{1:B}^{(L)})
\mathrm{FF(\cdot)}
\ell
{\bm{C}}^{\text{DP}}_{ij}
{\bm{C}}_{ij}
\bm{\beta}_{i}
\displaystyle{\bm{C}}^{\text{DP}}_{ij}=\frac{\langle W_{Q}\bm{\alpha}_{i},W_{K%
}\bm{\alpha}_{j}\rangle}{\sqrt{D_{\text{low}}}},\quad{\bm{C}}_{ij}=\frac{\exp{%
({\bm{C}}^{\text{DP}}_{ij})}}{\sum_{k=1}^{N}{\exp{({\bm{C}}^{\text{DP}}_{ik})}%
}},\quad\bm{\beta}_{i}=\sum_{j=1}^{N}{{\bm{C}}_{ij}(W_{V}\bm{\alpha}_{j})},
\displaystyle{\bm{C}}^{\text{DP}}_{ij}=\frac{\langle W_{Q}\bm{\alpha}_{i},W_{K%
}\bm{\alpha}_{j}\rangle}{\sqrt{D_{\text{low}}}},\quad{\bm{C}}_{ij}=\frac{\exp{%
({\bm{C}}^{\text{DP}}_{ij})}}{\sum_{k=1}^{N}{\exp{({\bm{C}}^{\text{DP}}_{ik})}%
}},\quad\bm{\beta}_{i}=\sum_{j=1}^{N}{{\bm{C}}_{ij}(W_{V}\bm{\alpha}_{j})},
W_{Q},W_{K},W_{V}\in\mathbb{R}^{D_{\text{low}}\times D_{\text{low}}}
{\bm{C}}\in\mathbb{R}^{N\times N}
\bm{\beta}_{i}
t_{i}
{\bm{C}}^{\text{TA}}_{ij}
\displaystyle{\bm{C}}^{\text{TA}}_{ij}=\ln{({\epsilon})}\left(\frac{|t_{j}-t_{%
i}|}{\delta_{r}}\right)^{p},\quad{\bm{C}}_{ij}=\frac{\exp{({\bm{C}}^{\text{DP}%
}_{ij}+{\bm{C}}^{\text{TA}}_{ij})}}{\sum_{k=1}^{N}{\exp{({\bm{C}}^{\text{DP}}_%
{ik}+{\bm{C}}^{\text{TA}}_{ik})}}},
\displaystyle{\bm{C}}^{\text{TA}}_{ij}=\ln{({\epsilon})}\left(\frac{|t_{j}-t_{%
i}|}{\delta_{r}}\right)^{p},\quad{\bm{C}}_{ij}=\frac{\exp{({\bm{C}}^{\text{DP}%
}_{ij}+{\bm{C}}^{\text{TA}}_{ij})}}{\sum_{k=1}^{N}{\exp{({\bm{C}}^{\text{DP}}_%
{ik}+{\bm{C}}^{\text{TA}}_{ik})}}},
\epsilon\in(0,1]
p\in\mathbb{N}
\delta_{r}\in\mathbb{R}_{>0}
\exp{({\bm{C}}^{\text{DP}}_{ij}+{\bm{C}}^{\text{TA}}_{ij})}=\exp{({\bm{C}}^{%
\text{DP}}_{ij})}\exp{({\bm{C}}^{\text{TA}}_{ij})}
\bm{\beta}_{i}
\bm{\alpha}_{j}
|t_{i}-t_{j}|
\delta_{r}
\exp({\bm{C}}^{\text{DP}}_{ij})
\epsilon
p
p
\bm{\beta_{i}}
t_{i}
\displaystyle{\bm{P}}_{ij}={\bm{w}}\odot\text{hardtanh}\left(\frac{t_{j}-t_{i}%
}{\delta_{r}}\right),\quad\text{and redefine}\quad\bm{\beta}_{i}=\sum_{j=1}^{N%
}{{\bm{C}}_{ij}(W_{V}\bm{\alpha}_{j}+{\bm{P}}_{ij})},
\displaystyle{\bm{P}}_{ij}={\bm{w}}\odot\text{hardtanh}\left(\frac{t_{j}-t_{i}%
}{\delta_{r}}\right),\quad\text{and redefine}\quad\bm{\beta}_{i}=\sum_{j=1}^{N%
}{{\bm{C}}_{ij}(W_{V}\bm{\alpha}_{j}+{\bm{P}}_{ij})},
{\bm{w}}\in\mathbb{R}^{d}
\odot
\delta_{r}
\bm{\beta}_{i}
\bm{\alpha}_{j}
|t_{i}-t_{j}|<\delta_{r}
\bm{\beta}_{i}
t_{i}
{\bm{w}}
p
\delta_{r}
B=1
\bm{\psi}_{1}
{\bm{s}}_{1}
D=1024
300000
3\cdot 10^{-4}
10^{-5}
\mathrm{rtol}=\mathrm{atol}=10^{-5}
d
0.036\pm 0.007
0.068\pm 0.000
0.079\pm 0.001
0.043\pm 0.010
0.062\pm 0.002
0.043\pm 0.013
0.009\pm 0.001
0.047\pm 0.002
\mathbf{0.024\pm 0.002}
\mathbf{0.004\pm 0.001}
\mathbf{0.015\pm 0.002}
\mathbf{0.024\pm 0.001}
51
\sigma_{c}
\sigma_{c}
\sigma_{c}
\sigma_{c}
\sigma_{c}=2\cdot 10^{-5}
\sigma_{c}
q_{\bm{\psi}_{i}}({\bm{s}}_{i})
\tau^{2}_{\text{min}}>0
\tau_{\text{min}}=0
\tau_{\text{min}}=0.02
{\bm{x}}_{1:N}
{\bm{x}}_{1}
k
g_{\theta_{\text{dec}}}
[0,20]
\displaystyle\frac{d^{2}x(t)}{dt^{2}}=-9.81\sin{(x(t))}
\displaystyle\frac{d^{2}x(t)}{dt^{2}}=-9.81\sin{(x(t))}
\theta
\theta
c\theta
c\in[-4,6]
N=10
N=10
\displaystyle p({\bm{y}}_{1:N},{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})=p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text%
{dec}})p({\bm{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{%
\text{dec}})
\displaystyle p({\bm{y}}_{1:N},{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})=p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text%
{dec}})p({\bm{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{%
\text{dec}})
\displaystyle p(\theta_{\text{dyn}})=\mathcal{N}(\theta_{\text{dyn}}|\mu_{%
\theta_{\text{dyn}}},\sigma_{\theta_{\text{dyn}}}^{2}I),\quad p(\theta_{\text{%
dec}})=\mathcal{N}(\theta_{\text{dec}}|\mu_{\theta_{\text{dec}}},\sigma_{%
\theta_{\text{dec}}}^{2}I),
\displaystyle p(\theta_{\text{dyn}})=\mathcal{N}(\theta_{\text{dyn}}|\mu_{%
\theta_{\text{dyn}}},\sigma_{\theta_{\text{dyn}}}^{2}I),\quad p(\theta_{\text{%
dec}})=\mathcal{N}(\theta_{\text{dec}}|\mu_{\theta_{\text{dec}}},\sigma_{%
\theta_{\text{dec}}}^{2}I),
\displaystyle p({\bm{s}}_{1:B}|\theta_{\text{dyn}})=p({\bm{s}}_{1})\prod_{b=2}%
^{B}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{dyn}})}
\displaystyle p({\bm{s}}_{1:B}|\theta_{\text{dyn}})
\displaystyle=p({\bm{s}}_{1})\prod_{b=2}^{B}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},%
\theta_{\text{dyn}})}
\displaystyle=\mathcal{N}({\bm{s}}_{1}|\mu_{0},\sigma_{0}^{2}I)\prod_{b=2}^{B}%
{\mathcal{N}({\bm{s}}_{b}|\mathrm{ODEsolve}({\bm{s}}_{b-1},t_{[b-1]},t_{[b]},f%
_{\theta_{\text{dyn}}}),\sigma_{c}^{2}I)},
\displaystyle=\mathcal{N}({\bm{s}}_{1}|\mu_{0},\sigma_{0}^{2}I)\prod_{b=2}^{B}%
{\mathcal{N}({\bm{s}}_{b}|\mathrm{ODEsolve}({\bm{s}}_{b-1},t_{[b-1]},t_{[b]},f%
_{\theta_{\text{dyn}}}),\sigma_{c}^{2}I)},
\displaystyle p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})=p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\prod_{b=1}^{B}{p%
(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},\theta_{\text{dyn}},%
\theta_{\text{dec}})}
\displaystyle p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})
\displaystyle=p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\prod_{b=1}^{B}{%
p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},\theta_{\text{dyn}},%
\theta_{\text{dec}})}
\displaystyle=p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\prod_{b=1}^{B}%
\prod_{i\in\mathcal{I}_{b}}p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},%
\theta_{\text{dec}})
\displaystyle=p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\prod_{b=1}^{B}%
\prod_{i\in\mathcal{I}_{b}}p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},%
\theta_{\text{dec}})
\displaystyle=\mathcal{N}({\bm{y}}_{1}|g_{\theta_{\text{dec}}}({\bm{s}}_{1}),%
\sigma_{Y}^{2}I)\prod_{b=1}^{B}{\prod_{i\in\mathcal{I}_{b}}{\mathcal{N}({\bm{y%
}}_{i}|g_{\theta_{\text{dec}}}(\mathrm{ODEsolve}({\bm{s}}_{b},t_{[b]},t_{i},f_%
{\theta_{\text{dyn}}})),\sigma_{Y}^{2}I)}}
\displaystyle=\mathcal{N}({\bm{y}}_{1}|g_{\theta_{\text{dec}}}({\bm{s}}_{1}),%
\sigma_{Y}^{2}I)\prod_{b=1}^{B}{\prod_{i\in\mathcal{I}_{b}}{\mathcal{N}({\bm{y%
}}_{i}|g_{\theta_{\text{dec}}}(\mathrm{ODEsolve}({\bm{s}}_{b},t_{[b]},t_{i},f_%
{\theta_{\text{dyn}}})),\sigma_{Y}^{2}I)}}
\displaystyle=\mathcal{N}({\bm{y}}_{1}|g_{\theta_{\text{dec}}}({\bm{x}}_{1}),%
\sigma_{Y}^{2}I)\prod_{b=1}^{B}{\prod_{i\in\mathcal{I}_{b}}{\mathcal{N}({\bm{y%
}}_{i}|g_{\theta_{\text{dec}}}({\bm{x}}_{i}),\sigma_{Y}^{2}I)}},
\displaystyle=\mathcal{N}({\bm{y}}_{1}|g_{\theta_{\text{dec}}}({\bm{x}}_{1}),%
\sigma_{Y}^{2}I)\prod_{b=1}^{B}{\prod_{i\in\mathcal{I}_{b}}{\mathcal{N}({\bm{y%
}}_{i}|g_{\theta_{\text{dec}}}({\bm{x}}_{i}),\sigma_{Y}^{2}I)}},
\mathcal{N}
I\in\mathbb{R}^{d\times d}
\sigma_{Y}^{2}
\displaystyle q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})=q(%
\theta_{\text{dyn}})q(\theta_{\text{dec}})\prod_{b=1}^{B}{q({\bm{s}}_{b})}
\displaystyle q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})
\displaystyle=q(\theta_{\text{dyn}})q(\theta_{\text{dec}})\prod_{b=1}^{B}{q({%
\bm{s}}_{b})}
\displaystyle=\mathcal{N}(\theta_{\text{dyn}}|\bm{\gamma}_{\theta_{\text{dyn}}%
},\mathrm{diag}(\bm{\tau}_{\theta_{\text{dyn}}}^{2}))\mathcal{N}(\theta_{\text%
{dec}}|\bm{\gamma}_{\theta_{\text{dec}}},\mathrm{diag}(\bm{\tau}_{\theta_{%
\text{dec}}}^{2}))\prod_{b=1}^{B}{\mathcal{N}({\bm{s}}_{b}|\bm{\gamma}_{b},%
\mathrm{diag}(\bm{\tau}_{b}^{2}))},
\displaystyle=\mathcal{N}(\theta_{\text{dyn}}|\bm{\gamma}_{\theta_{\text{dyn}}%
},\mathrm{diag}(\bm{\tau}_{\theta_{\text{dyn}}}^{2}))\mathcal{N}(\theta_{\text%
{dec}}|\bm{\gamma}_{\theta_{\text{dec}}},\mathrm{diag}(\bm{\tau}_{\theta_{%
\text{dec}}}^{2}))\prod_{b=1}^{B}{\mathcal{N}({\bm{s}}_{b}|\bm{\gamma}_{b},%
\mathrm{diag}(\bm{\tau}_{b}^{2}))},
\mathrm{diag}(\bm{\tau}_{\bullet})
\bm{\tau}_{\bullet}
\displaystyle\mathcal{L}=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s%
}}_{1:B})\ln{\frac{p({\bm{y}}_{1:N},{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_%
{\text{dec}})}{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})}}d%
\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\mathcal{L}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\frac{p({\bm{y}}_{1:N},{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{%
dec}})}{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})}}d\theta_{%
\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\frac{p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{%
dec}})p({\bm{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{%
\text{dec}})}{q({\bm{s}}_{1:B})q(\theta_{\text{dyn}})q(\theta_{\text{dec}})}}d%
\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\frac{p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{%
dec}})p({\bm{s}}_{1:B}|\theta_{\text{dyn}})p(\theta_{\text{dyn}})p(\theta_{%
\text{dec}})}{q({\bm{s}}_{1:B})q(\theta_{\text{dyn}})q(\theta_{\text{dec}})}}d%
\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{dec}})}d%
\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{dec}})}d%
\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad-\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\frac{q({\bm{s}}_{1:B})}{p({\bm{s}}_{1:B}|\theta_{\text{dyn}})}}d\theta%
_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad-\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\frac{q({\bm{s}}_{1:B})}{p({\bm{s}}_{1:B}|\theta_{\text{dyn}})}}d\theta%
_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad-\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\frac{q(\theta_{\text{dyn}})}{p(\theta_{\text{dyn}})}}d\theta_{\text{%
dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad-\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\frac{q(\theta_{\text{dyn}})}{p(\theta_{\text{dyn}})}}d\theta_{\text{%
dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad-\int{q(\theta_{\text{dec}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\frac{q(\theta_{\text{dec}})}{p(\theta_{\text{dec}})}}d\theta_{\text{%
dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad-\int{q(\theta_{\text{dec}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\frac{q(\theta_{\text{dec}})}{p(\theta_{\text{dec}})}}d\theta_{\text{%
dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\mathcal{L}_{1}-\mathcal{L}_{2}-\mathcal{L}_{3}-\mathcal{L}_{4}.
\displaystyle=\mathcal{L}_{1}-\mathcal{L}_{2}-\mathcal{L}_{3}-\mathcal{L}_{4}.
\mathcal{L}_{i}
\displaystyle\mathcal{L}_{1}=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{%
\bm{s}}_{1:B})\ln{p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{%
\text{dec}})}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\mathcal{L}_{1}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1:N}|{\bm{s}}_{1:B},\theta_{\text{dyn}},\theta_{\text{dec}})}d%
\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\prod_{b=1}^{B}{p(\{%
{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{%
\text{dec}})}\right]}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\prod_{b=1}^{B}{p(\{%
{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{%
\text{dec}})}\right]}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad+\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\left[\prod_{b=1}^{B}{p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}%
_{b},\theta_{\text{dyn}},\theta_{\text{dec}})}\right]}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad+\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\left[\prod_{b=1}^{B}{p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}%
_{b},\theta_{\text{dyn}},\theta_{\text{dec}})}\right]}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad+\sum_{b=1}^{B}\int{q(\theta_{\text{dyn}},\theta_{\text{dec}%
},{\bm{s}}_{1:B})\ln{p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},%
\theta_{\text{dyn}},\theta_{\text{dec}})}d\theta_{\text{dyn}}d\theta_{\text{%
dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad+\sum_{b=1}^{B}\int{q(\theta_{\text{dyn}},\theta_{\text{dec}%
},{\bm{s}}_{1:B})\ln{p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},%
\theta_{\text{dyn}},\theta_{\text{dec}})}d\theta_{\text{dyn}}d\theta_{\text{%
dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dec}},{\bm{s}}_{1})\ln{p({\bm{y}}_{1}|{\bm{%
s}}_{1},\theta_{\text{dec}})}d\theta_{\text{dec}}d{\bm{s}}_{1}}
\displaystyle=\int{q(\theta_{\text{dec}},{\bm{s}}_{1})\ln{p({\bm{y}}_{1}|{\bm{%
s}}_{1},\theta_{\text{dec}})}d\theta_{\text{dec}}d{\bm{s}}_{1}}
\displaystyle\quad+\sum_{b=1}^{B}\int{q(\theta_{\text{dyn}},\theta_{\text{dec}%
},{\bm{s}}_{b})\ln{p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},%
\theta_{\text{dyn}},\theta_{\text{dec}})}d\theta_{\text{dyn}}d\theta_{\text{%
dec}}d{\bm{s}}_{b}}
\displaystyle\quad+\sum_{b=1}^{B}\int{q(\theta_{\text{dyn}},\theta_{\text{dec}%
},{\bm{s}}_{b})\ln{p(\{{\bm{y}}_{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},%
\theta_{\text{dyn}},\theta_{\text{dec}})}d\theta_{\text{dyn}}d\theta_{\text{%
dec}}d{\bm{s}}_{b}}
\displaystyle=\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}}_{1})}\left[\ln{p({\bm%
{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}\right]+\sum_{b=1}^{B}\mathbb{E}_{q%
(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{b})}\left[\ln{p(\{{\bm{y}}_%
{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{dec%
}})}\right]
\displaystyle=\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}}_{1})}\left[\ln{p({\bm%
{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}\right]+\sum_{b=1}^{B}\mathbb{E}_{q%
(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{b})}\left[\ln{p(\{{\bm{y}}_%
{i}\}_{i\in\mathcal{I}_{b}}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{dec%
}})}\right]
\displaystyle=\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}}_{1})}\left[\ln{p({\bm%
{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}\right]+\sum_{b=1}^{B}\sum_{i\in%
\mathcal{I}_{b}}\mathbb{E}_{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}%
_{b})}\left[\ln{p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{%
dec}})}\right]
\displaystyle=\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}}_{1})}\left[\ln{p({\bm%
{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})}\right]+\sum_{b=1}^{B}\sum_{i\in%
\mathcal{I}_{b}}\mathbb{E}_{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}%
_{b})}\left[\ln{p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{%
dec}})}\right]
\displaystyle\mathcal{L}_{2}=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{%
\bm{s}}_{1:B})\ln{\frac{q({\bm{s}}_{1:B})}{p({\bm{s}}_{1:B}|\theta_{\text{dyn}%
})}}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\mathcal{L}_{2}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\frac{q({\bm{s}}_{1:B})}{p({\bm{s}}_{1:B}|\theta_{\text{dyn}})}}d\theta_{%
\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_{1})}\prod_{b=2}^{B}{\frac{q({\bm{%
s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{dyn}})}}\right]}d\theta_%
{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_{1})}\prod_{b=2}^{B}{\frac{q({\bm{%
s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{dyn}})}}\right]}d\theta_%
{\text{dyn}}d\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_{1})}\right]}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_{1})}\right]}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad+\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\left[\prod_{b=2}^{B}{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b%
-1},\theta_{\text{dyn}})}}\right]}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{%
\bm{s}}_{1:B}}
\displaystyle\quad+\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:%
B})\ln{\left[\prod_{b=2}^{B}{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b%
-1},\theta_{\text{dyn}})}}\right]}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{%
\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_{1})}\right]}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle=\int{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})%
\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_{1})}\right]}d\theta_{\text{dyn}}d%
\theta_{\text{dec}}d{\bm{s}}_{1:B}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},\theta_{\text{dec}%
},{\bm{s}}_{1:B})\ln{\left[{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b-%
1},\theta_{\text{dyn}})}}\right]}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm%
{s}}_{1:B}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},\theta_{\text{dec}%
},{\bm{s}}_{1:B})\ln{\left[{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b-%
1},\theta_{\text{dyn}})}}\right]}d\theta_{\text{dyn}}d\theta_{\text{dec}}d{\bm%
{s}}_{1:B}}
\displaystyle=\int{q({\bm{s}}_{1})\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_%
{1})}\right]}d{\bm{s}}_{1}}
\displaystyle=\int{q({\bm{s}}_{1})\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_%
{1})}\right]}d{\bm{s}}_{1}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},{\bm{s}}_{b-1},{%
\bm{s}}_{b})\ln{\left[{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},%
\theta_{\text{dyn}})}}\right]}d\theta_{\text{dyn}}d{\bm{s}}_{b-1}d{\bm{s}}_{b}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},{\bm{s}}_{b-1},{%
\bm{s}}_{b})\ln{\left[{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{\bm{s}}_{b-1},%
\theta_{\text{dyn}})}}\right]}d\theta_{\text{dyn}}d{\bm{s}}_{b-1}d{\bm{s}}_{b}}
\displaystyle=\int{q({\bm{s}}_{1})\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_%
{1})}\right]}d{\bm{s}}_{1}}
\displaystyle=\int{q({\bm{s}}_{1})\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_%
{1})}\right]}d{\bm{s}}_{1}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})%
\left(\int q({\bm{s}}_{b})\ln{\left[{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{%
\bm{s}}_{b-1},\theta_{\text{dyn}})}}\right]}d{\bm{s}}_{b}\right)d\theta_{\text%
{dyn}}d{\bm{s}}_{b-1}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})%
\left(\int q({\bm{s}}_{b})\ln{\left[{\frac{q({\bm{s}}_{b})}{p({\bm{s}}_{b}|{%
\bm{s}}_{b-1},\theta_{\text{dyn}})}}\right]}d{\bm{s}}_{b}\right)d\theta_{\text%
{dyn}}d{\bm{s}}_{b-1}}
\displaystyle=\int{q({\bm{s}}_{1})\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_%
{1})}\right]}d{\bm{s}}_{1}}
\displaystyle=\int{q({\bm{s}}_{1})\ln{\left[\frac{q({\bm{s}}_{1})}{p({\bm{s}}_%
{1})}\right]}d{\bm{s}}_{1}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})%
\mathrm{KL}\left(q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{%
\text{dyn}})\right)d\theta_{\text{dyn}}d{\bm{s}}_{b-1}}
\displaystyle\quad+\sum_{b=2}^{B}\int{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})%
\mathrm{KL}\left(q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{%
\text{dyn}})\right)d\theta_{\text{dyn}}d{\bm{s}}_{b-1}}
\displaystyle=\mathrm{KL}\left(q({\bm{s}}_{1})\lVert p({\bm{s}}_{1})\right)+%
\sum_{b=2}^{B}\mathbb{E}_{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})}\left[\mathrm{%
KL}\left(q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{dyn%
}})\right)\right],
\displaystyle=\mathrm{KL}\left(q({\bm{s}}_{1})\lVert p({\bm{s}}_{1})\right)+%
\sum_{b=2}^{B}\mathbb{E}_{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})}\left[\mathrm{%
KL}\left(q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{dyn%
}})\right)\right],
\mathrm{KL}
\displaystyle\mathcal{L}_{3}=\mathrm{KL}(q(\theta_{\text{dyn}})\lVert p(\theta%
_{\text{dyn}})),\quad\mathcal{L}_{4}=\mathrm{KL}(q(\theta_{\text{dec}})\lVert p%
(\theta_{\text{dec}})).
\displaystyle\mathcal{L}_{3}=\mathrm{KL}(q(\theta_{\text{dyn}})\lVert p(\theta%
_{\text{dyn}})),\quad\mathcal{L}_{4}=\mathrm{KL}(q(\theta_{\text{dec}})\lVert p%
(\theta_{\text{dec}})).
\displaystyle\mathbb{E}_{p(z)}[f(z)]\approx f(\zeta),\quad\text{where }\zeta%
\text{ is sampled from }p(z).
\displaystyle\mathbb{E}_{p(z)}[f(z)]\approx f(\zeta),\quad\text{where }\zeta%
\text{ is sampled from }p(z).
\displaystyle\mathrm{KL}(q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1%
:B})\lVert p(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B}|{\bm{y}}_{%
1:N})),
\displaystyle\mathrm{KL}(q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1%
:B})\lVert p(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B}|{\bm{y}}_{%
1:N})),
\displaystyle\mathcal{L}=\underbrace{\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}%
}_{1})}\big{[}\log p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\big{]}}_{%
\textit{(i)}\text{ data likelihood}}+\sum_{b=1}^{B}\sum_{i\in\mathcal{I}_{b}}%
\underbrace{\mathbb{E}_{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{b}%
)}\big{[}\log p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{%
dec}})\big{]}}_{\textit{(ii)}\text{ data likelihood}}
\displaystyle\mathcal{L}
\displaystyle=\underbrace{\mathbb{E}_{q(\theta_{\text{dec}},{\bm{s}}_{1})}\big%
{[}\log p({\bm{y}}_{1}|{\bm{s}}_{1},\theta_{\text{dec}})\big{]}}_{\textit{(i)}%
\text{ data likelihood}}+\sum_{b=1}^{B}\sum_{i\in\mathcal{I}_{b}}\underbrace{%
\mathbb{E}_{q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{b})}\big{[}%
\log p({\bm{y}}_{i}|{\bm{s}}_{b},\theta_{\text{dyn}},\theta_{\text{dec}})\big{%
]}}_{\textit{(ii)}\text{ data likelihood}}
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q({\bm{s}}_{1})\lVert p({\bm{%
s}}_{1})\big{]}}_{\textit{(iii)}\text{ initial state prior}}-\sum_{b=2}^{B}%
\underbrace{\mathbb{E}_{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})}\Big{[}\mathrm{%
KL}\big{[}q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{%
dyn}})\big{]}\Big{]}}_{\textit{(iv)}\text{ continuity prior}}
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q({\bm{s}}_{1})\lVert p({\bm{%
s}}_{1})\big{]}}_{\textit{(iii)}\text{ initial state prior}}-\sum_{b=2}^{B}%
\underbrace{\mathbb{E}_{q(\theta_{\text{dyn}},{\bm{s}}_{b-1})}\Big{[}\mathrm{%
KL}\big{[}q({\bm{s}}_{b})\lVert p({\bm{s}}_{b}|{\bm{s}}_{b-1},\theta_{\text{%
dyn}})\big{]}\Big{]}}_{\textit{(iv)}\text{ continuity prior}}
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q(\theta_{\text{dyn}})\lVert p%
(\theta_{\text{dyn}})\big{]}}_{\textit{(v)}\text{ dynamics prior}}-\underbrace%
{\mathrm{KL}\big{[}q(\theta_{\text{dec}})\lVert p(\theta_{\text{dec}})\big{]}}%
_{\textit{(vi)}\text{ decoder prior}}.
\displaystyle\quad-\underbrace{\mathrm{KL}\big{[}q(\theta_{\text{dyn}})\lVert p%
(\theta_{\text{dyn}})\big{]}}_{\textit{(v)}\text{ dynamics prior}}-\underbrace%
{\mathrm{KL}\big{[}q(\theta_{\text{dec}})\lVert p(\theta_{\text{dec}})\big{]}}%
_{\textit{(vi)}\text{ decoder prior}}.
\theta_{\text{dyn}},\theta_{\text{dec}}
q_{\bm{\psi}_{\text{dyn}}}(\theta_{\text{dyn}}),q_{\bm{\psi}_{\text{dec}}}(%
\theta_{\text{dec}})
{\bm{s}}_{1:B}
q_{\bm{\psi}_{1}}({\bm{s}}_{1}),...,q_{\bm{\psi}_{B}}({\bm{s}}_{B})
\bm{\psi}_{1:B}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:N})
{\bm{x}}_{1:N}
{\bm{s}}_{1:B}
\mathcal{L}
{\bm{y}}_{1:N_{1}}^{*}
t_{1:N_{1}}^{*}
{\bm{y}}_{N_{1}+1:N_{2}}^{*}
t_{N_{1}+1:N_{2}}^{*}
\displaystyle p({\bm{y}}_{N_{1}+1:N_{2}}^{*}|{\bm{y}}_{1:N_{1}}^{*},{\bm{y}}_{%
1:N})\approx\int p({\bm{y}}_{N_{1}+1:N_{2}}^{*}|{\bm{s}}_{1}^{*},\theta_{\text%
{dyn}},\theta_{\text{dec}})q_{\bm{\psi}_{1}^{*}}({\bm{s}}_{1}^{*})q_{\bm{\psi}%
_{\text{dyn}}}(\theta_{\text{dyn}})q_{\bm{\psi}_{\text{dec}}}(\theta_{\text{%
dec}})d{\bm{s}}_{1}^{*}d\theta_{\text{dyn}}d\theta_{\text{dec}},
\displaystyle p({\bm{y}}_{N_{1}+1:N_{2}}^{*}|{\bm{y}}_{1:N_{1}}^{*},{\bm{y}}_{%
1:N})\approx\int p({\bm{y}}_{N_{1}+1:N_{2}}^{*}|{\bm{s}}_{1}^{*},\theta_{\text%
{dyn}},\theta_{\text{dec}})q_{\bm{\psi}_{1}^{*}}({\bm{s}}_{1}^{*})q_{\bm{\psi}%
_{\text{dyn}}}(\theta_{\text{dyn}})q_{\bm{\psi}_{\text{dec}}}(\theta_{\text{%
dec}})d{\bm{s}}_{1}^{*}d\theta_{\text{dyn}}d\theta_{\text{dec}},
\bm{\psi}_{1}^{*}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:N_{1}}^{*})
{\bm{y}}_{N_{1}+1:N_{2}}^{*}
\theta_{\text{dyn}},\theta_{\text{dec}}
q_{\bm{\psi}_{\text{dyn}}}(\theta_{\text{dyn}}),q_{\bm{\psi}_{\text{dec}}}(%
\theta_{\text{dec}})
{\bm{s}}_{1}^{*}
q_{\bm{\psi}_{1}^{*}}({\bm{s}}_{1}^{*})
\bm{\psi}_{1}^{*}=h_{\theta_{\text{enc}}}({\bm{y}}_{1:N_{1}}^{*})
{\bm{x}}_{i}=\mathrm{ODEsolve}({\bm{s}}_{1}^{*},t_{1}^{*},t_{i}^{*},f_{\theta_%
{\text{dyn}}}),\quad i\in\{N_{1}+1,...,N_{2}\}
{\bm{y}}_{i}^{*}
p({\bm{y}}_{i}^{*}|g_{\theta_{\text{dec}}}({\bm{x}}_{i})),\quad i\in\{N_{1}+1,%
...,N_{2}\}
n
{\bm{y}}_{N_{1}+1:N_{2}}^{*}
n=10
{\bm{x}}
\dot{{\bm{x}}}
{\bm{x}}\sim\text{Uniform}[0,2\pi]
\dot{{\bm{x}}}\sim\text{Uniform}[-\pi/2,\pi/2]
(t_{1},...,t_{N})
[t_{1},t_{N}]
t_{1}
t_{N}
N
[t_{1},t_{N}]
t_{1}
t_{N}
\frac{t_{N}-t_{1}}{4(N-1)}
\frac{d^{2}{\bm{x}}(t)}{dt^{2}}=-9.81\sin{({\bm{x}}(t))}
{\bm{x}},\dot{{\bm{x}}}
(t_{1},...,t_{N})
({\bm{y}}_{1},...,{\bm{y}}_{N})
{\bm{y}}_{i}=\mathrm{observe}({\bm{x}}(t_{i}))
{\bm{x}}(t_{i})
t_{i}
\mathrm{observe}(\cdot)
N
t_{1}=0
t_{N}=3
N=51
{\bm{y}}_{i}
32\times 32
{\bm{x}}
\dot{{\bm{x}}}
{\bm{x}}\sim\text{Uniform}[0,2\pi]
\dot{{\bm{x}}}\sim\text{Uniform}[\pi,2\pi]
(t_{1},...,t_{N})
[t_{1},t_{N}]
t_{1}
t_{N}
N
[t_{1},t_{N}]
t_{1}
t_{N}
\frac{t_{N}-t_{1}}{4(N-1)}
\frac{d{\bm{x}}(t)}{dt}=\dot{{\bm{x}}}
{\bm{x}}
(t_{1},...,t_{N})
({\bm{y}}_{1},...,{\bm{y}}_{N})
{\bm{y}}_{i}=\mathrm{observe}({\bm{x}}(t_{i}))
{\bm{x}}(t_{i})
t_{i}
\mathrm{observe}(\cdot)
N
t_{1}=0
t_{N}=2
N=51
{\bm{y}}_{i}
32\times 32
{\bm{v}}\in\mathbb{R}^{3}
{\bm{v}}=\frac{{\bm{v}}^{\prime}}{\lVert{\bm{v}}^{\prime}\lVert}
{\bm{v}}^{\prime}
(t_{1},...,t_{N})
[t_{1},t_{N}]
t_{1}
t_{N}
N
[t_{1},t_{N}]
t_{1}
t_{N}
\frac{t_{N}-t_{1}}{4(N-1)}
(t_{1},...,t_{N})
({\bm{y}}_{1},...,{\bm{y}}_{N})
{\bm{y}}_{i}=\mathrm{observe}(\theta(t_{i}))
\theta(t_{i})
t_{i}
\mathrm{observe}(...)
N
t_{1}=0
t_{N}=20
N=51
{\bm{y}}_{i}
32\times 32
300000
3\text{e-4}
1\text{e-5}
\text{rtol}=\text{atol}=10^{-5}
\delta_{r}
[t_{1},t_{N}]
[t_{1},t_{1}+\delta_{\text{test}}]
\delta_{\text{test}}
[t_{1},t_{N}]
[t_{1},t_{1}+\delta_{\text{test}}]
\delta_{\text{test}}
[t_{1},t_{N}]
\displaystyle p(\theta_{\text{dyn}})=\mathcal{N}(\theta_{\text{dyn}}|\mu_{%
\theta_{\text{dyn}}},\sigma_{\theta_{\text{dyn}}}^{2}I),\quad p(\theta_{\text{%
dec}})=\mathcal{N}(\theta_{\text{dec}}|\mu_{\theta_{\text{dec}}},\sigma_{%
\theta_{\text{dec}}}^{2}I),
\displaystyle p(\theta_{\text{dyn}})=\mathcal{N}(\theta_{\text{dyn}}|\mu_{%
\theta_{\text{dyn}}},\sigma_{\theta_{\text{dyn}}}^{2}I),\quad p(\theta_{\text{%
dec}})=\mathcal{N}(\theta_{\text{dec}}|\mu_{\theta_{\text{dec}}},\sigma_{%
\theta_{\text{dec}}}^{2}I),
\displaystyle p({\bm{s}}_{1:B}|\theta_{\text{dyn}})=\mathcal{N}({\bm{s}}_{1}|%
\mu_{0},\sigma_{0}^{2}I)\prod_{b=2}^{B}{\mathcal{N}({\bm{s}}_{b}|\mathrm{%
ODEsolve}({\bm{s}}_{b-1},t_{[b-1]},t_{[b]},f_{\theta_{\text{dyn}}}),\sigma_{c}%
^{2}I)}.
\displaystyle p({\bm{s}}_{1:B}|\theta_{\text{dyn}})=\mathcal{N}({\bm{s}}_{1}|%
\mu_{0},\sigma_{0}^{2}I)\prod_{b=2}^{B}{\mathcal{N}({\bm{s}}_{b}|\mathrm{%
ODEsolve}({\bm{s}}_{b-1},t_{[b-1]},t_{[b]},f_{\theta_{\text{dyn}}}),\sigma_{c}%
^{2}I)}.
\mu_{\theta_{\text{dyn}}}=\mu_{\theta_{\text{dec}}}=\bm{0}
\sigma_{\theta_{\text{dyn}}}=\sigma_{\theta_{\text{dec}}}=1
\mu_{0}=\bm{0}
\sigma_{0}=1
\sigma_{c}=\frac{\xi}{\sqrt{d}}
\xi
{\bm{s}}_{i}
{\bm{x}}_{i}
d
d=32
\xi
\xi=10^{-4}
\xi=10^{-3}
\displaystyle q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})=%
\mathcal{N}(\theta_{\text{dyn}}|\bm{\gamma}_{\theta_{\text{dyn}}},\text{diag}(%
\bm{\tau}_{\theta_{\text{dyn}}}^{2}))\mathcal{N}(\theta_{\text{dec}}|\bm{%
\gamma}_{\theta_{\text{dec}}},\text{diag}(\bm{\tau}_{\theta_{\text{dec}}}^{2})%
)\prod_{b=1}^{B}{\mathcal{N}({\bm{s}}_{b}|\bm{\gamma}_{b},\text{diag}(\bm{\tau%
}_{b}^{2}))}
\displaystyle q(\theta_{\text{dyn}},\theta_{\text{dec}},{\bm{s}}_{1:B})=%
\mathcal{N}(\theta_{\text{dyn}}|\bm{\gamma}_{\theta_{\text{dyn}}},\text{diag}(%
\bm{\tau}_{\theta_{\text{dyn}}}^{2}))\mathcal{N}(\theta_{\text{dec}}|\bm{%
\gamma}_{\theta_{\text{dec}}},\text{diag}(\bm{\tau}_{\theta_{\text{dec}}}^{2})%
)\prod_{b=1}^{B}{\mathcal{N}({\bm{s}}_{b}|\bm{\gamma}_{b},\text{diag}(\bm{\tau%
}_{b}^{2}))}
\bm{\gamma}_{b}
\bm{\tau}_{b}
\bm{\gamma}_{\theta_{\text{dyn}}}
\bm{\gamma}_{\theta_{\text{dec}}}
\bm{\tau}_{\theta_{\text{dyn}}}
\bm{\tau}_{\theta_{\text{dec}}}
9\cdot 10^{-4}
{\bm{x}}(t)\in\mathbb{R}^{d}
\displaystyle{\bm{x}}(t)=\left(\begin{array}[]{c}{\bm{x}}_{\text{p}}(t)\\
{\bm{x}}_{\text{v}}(t)\end{array}\right),
\displaystyle{\bm{x}}(t)=\left(\begin{array}[]{c}{\bm{x}}_{\text{p}}(t)\\
{\bm{x}}_{\text{v}}(t)\end{array}\right),
{\bm{x}}_{\text{p}}(t)\in\mathbb{R}^{d/2}
{\bm{x}}_{\text{v}}(t)\in\mathbb{R}^{d/2}
f_{\theta_{\text{dyn}}}(t,{\bm{x}}(t))
\displaystyle f_{\theta_{\text{dyn}}}(t,{\bm{x}}(t))=\left(\begin{array}[]{c}{%
\bm{x}}_{\text{v}}(t)\\
f_{\theta_{\text{dyn}}}^{\text{v}}(t,{\bm{x}}(t))\end{array}\right),
\displaystyle f_{\theta_{\text{dyn}}}(t,{\bm{x}}(t))=\left(\begin{array}[]{c}{%
\bm{x}}_{\text{v}}(t)\\
f_{\theta_{\text{dyn}}}^{\text{v}}(t,{\bm{x}}(t))\end{array}\right),
f_{\theta_{\text{dyn}}}^{\text{v}}(t,{\bm{x}}(t)):\mathbb{R}\times\mathbb{R}^{%
d}\to\mathbb{R}^{d/2}
f_{\theta_{\text{dyn}}}^{\text{v}}
t
d
d/2
256
d
d/2
512
d
d/2
1024
d=32
g_{\theta_{\text{dec}}}
{\bm{x}}_{i}
p({\bm{y}}_{i}|g_{\theta_{\text{dec}}}({\bm{x}}_{i}))
p({\bm{y}}_{i}|g_{\theta_{\text{dec}}}({\bm{x}}_{i}))=\mathcal{N}({\bm{y}}_{i}%
|g_{\theta_{\text{dec}}}({\bm{x}}_{i}),\sigma_{Y}^{2}I)
\sigma_{Y}
10^{-3}
\sigma_{Y}
{\bm{x}}_{i}^{\text{p}}
{\bm{x}}_{i}
g_{\theta_{\text{dec}}}
(0,1)
g_{\theta_{\text{dec}}}
8n
4n
2n
n
n
n
{\bm{y}}_{1},...,{\bm{y}}_{N}
\bm{\psi}_{1},...,\bm{\psi}_{B}
\bm{\gamma}_{1},...,\bm{\gamma}_{B}
\bm{\tau}_{1},...,\bm{\tau}_{B}
\mathcal{N}({\bm{s}}_{1}|\bm{\gamma}_{1},\text{diag}(\bm{\tau}_{1}^{2})),...,%
\mathcal{N}({\bm{s}}_{B}|\bm{\gamma}_{B},\text{diag}(\bm{\tau}_{B}^{2}))
\displaystyle\bm{\gamma}_{b}=\left(\begin{array}[]{c}\bm{\gamma}_{b}^{\text{p}%
}\\
\bm{\gamma}_{b}^{\text{v}}\end{array}\right),\bm{\tau}_{b}=\left(\begin{array}%
[]{c}\bm{\tau}_{b}^{\text{p}}\\
\bm{\tau}_{b}^{\text{v}}\end{array}\right),\quad b\in\{1,...,B\},
\displaystyle\bm{\gamma}_{b}=\left(\begin{array}[]{c}\bm{\gamma}_{b}^{\text{p}%
}\\
\bm{\gamma}_{b}^{\text{v}}\end{array}\right),\bm{\tau}_{b}=\left(\begin{array}%
[]{c}\bm{\tau}_{b}^{\text{p}}\\
\bm{\tau}_{b}^{\text{v}}\end{array}\right),\quad b\in\{1,...,B\},
d/2
\bm{\psi}_{i}
\displaystyle\bm{\psi}_{1},...,\bm{\psi}_{B}=\left(\begin{array}[]{c}\bm{%
\gamma}_{1}^{\text{p}}\\
\bm{\tau}_{1}^{\text{p}}\\
\bm{\gamma}_{1}^{\text{v}}\\
\bm{\tau}_{1}^{\text{v}}\end{array}\right),...,\left(\begin{array}[]{c}\bm{%
\gamma}_{B}^{\text{p}}\\
\bm{\tau}_{B}^{\text{p}}\\
\bm{\gamma}_{B}^{\text{v}}\\
\bm{\tau}_{B}^{\text{v}}\end{array}\right).
\displaystyle\bm{\psi}_{1},...,\bm{\psi}_{B}=\left(\begin{array}[]{c}\bm{%
\gamma}_{1}^{\text{p}}\\
\bm{\tau}_{1}^{\text{p}}\\
\bm{\gamma}_{1}^{\text{v}}\\
\bm{\tau}_{1}^{\text{v}}\end{array}\right),...,\left(\begin{array}[]{c}\bm{%
\gamma}_{B}^{\text{p}}\\
\bm{\tau}_{B}^{\text{p}}\\
\bm{\gamma}_{B}^{\text{v}}\\
\bm{\tau}_{B}^{\text{v}}\end{array}\right).
h_{\text{agg}}^{\text{p}}
h_{\text{agg}}^{\text{v}}
{\bm{b}}_{1:B}^{\text{p}}
{\bm{b}}_{1:B}^{\text{v}}
{\bm{b}}_{1:B}
h_{\text{comp}}
h_{\text{comp}}
n
2n
4n
8n
n
h_{\text{agg}}^{\text{p}}
h_{\text{agg}}^{\text{v}}
L
4
h_{\text{agg}}^{\text{p}}
8
h_{\text{agg}}^{\text{v}}
D_{\text{low}}=128
\epsilon=10^{-2}
p=\infty
\delta_{r}
15\%
[t_{1},t_{N}]
p
\delta_{r}
h_{\text{read}}
{\bm{b}}_{i}
\bm{\psi}_{i}
{\bm{b}}_{i}
\displaystyle{\bm{b}}_{i}=\left(\begin{array}[]{c}{\bm{b}}_{i}^{\text{p}}\\
{\bm{b}}_{i}^{\text{v}}\end{array}\right),
\displaystyle{\bm{b}}_{i}=\left(\begin{array}[]{c}{\bm{b}}_{i}^{\text{p}}\\
{\bm{b}}_{i}^{\text{v}}\end{array}\right),
h_{\text{read}}
\displaystyle h_{\text{read}}({\bm{b}}_{i})=\left(\begin{array}[]{c}\text{%
Linear}({\bm{b}}_{i}^{\text{p}})\\
\exp{\left(\text{Linear}({\bm{b}}_{i}^{\text{p}})\right)}\\
\text{Linear}({\bm{b}}_{i}^{\text{v}})\\
\exp{\left(\text{Linear}({\bm{b}}_{i}^{\text{v}})\right)}\end{array}\right)=%
\left(\begin{array}[]{c}\bm{\gamma}_{i}^{\text{p}}\\
\bm{\tau}_{i}^{\text{p}}\\
\bm{\gamma}_{i}^{\text{v}}\\
\bm{\tau}_{i}^{\text{v}}\end{array}\right)=\bm{\psi}_{i},
\displaystyle h_{\text{read}}({\bm{b}}_{i})=\left(\begin{array}[]{c}\text{%
Linear}({\bm{b}}_{i}^{\text{p}})\\
\exp{\left(\text{Linear}({\bm{b}}_{i}^{\text{p}})\right)}\\
\text{Linear}({\bm{b}}_{i}^{\text{v}})\\
\exp{\left(\text{Linear}({\bm{b}}_{i}^{\text{v}})\right)}\end{array}\right)=%
\left(\begin{array}[]{c}\bm{\gamma}_{i}^{\text{p}}\\
\bm{\tau}_{i}^{\text{p}}\\
\bm{\gamma}_{i}^{\text{v}}\\
\bm{\tau}_{i}^{\text{v}}\end{array}\right)=\bm{\psi}_{i},
\text{Linear}()
q_{\bm{\psi}_{i}}({\bm{s}}_{i})
\tau_{\text{min}}^{2}>0
\tau_{\text{min}}
\tau_{i}^{\text{p}}
\tau_{\text{min}}
\tau_{i}^{\text{v}}
{\bm{C}}_{ij}^{\text{DP}}+{\bm{C}}_{ij}^{\text{TA}}
-\infty
{\bm{C}}_{ij}
{\bm{C}}_{ij}
i
i
p
\delta_{r}
[t_{1},t_{1}+t_{\text{test}}]
\delta_{r}
\delta_{r}=\delta_{\text{test}}/2
\delta_{r}
p
\delta_{r}
p
\delta_{r}
t_{1}
t_{51}
t_{1}
t_{51}
t_{1}
t_{51}
t_{1}
t_{51}
t_{1}
t_{51}
t_{1}
t_{51}
N
N
N=10
N
N
N
N
N
t_{1}
t_{51}
N
t_{1}
t_{51}
N
t_{1}
t_{51}
N
t_{1}
t_{51}
N
t_{1}
t_{51}
N
t_{1}
t_{51}
1\text{e3}
1\text{e3}
1\text{e4}
1\text{e-3}
1\text{e-3}
3\text{e-4}
16
16
64
600
600
3000
5
1024
8
\sigma_{c}
\sigma_{c}
{\bm{x}}
t_{[b]}
{\bm{s}}_{[b]}
\sigma_{c}
\sigma_{c}
\sigma_{c}
\sigma_{c}
2\text{e-1}
2\text{e-2}
2\text{e-3}
2\text{e-4}
2\text{e-5}
h_{\text{agg}}
h_{\text{agg}}
