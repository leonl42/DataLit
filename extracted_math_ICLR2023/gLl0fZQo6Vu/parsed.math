{\leq}500
\mathcal{X}
\mathcal{Z}
\mathcal{A}
T(z^{\prime}\mid z,a)
q(x\mid z)
R:\Xcal\times\Acal\rightarrow\mathbb{R}
\mu_{0}(z)
z=(s,e)
s\in\mathcal{S}
e\in\mathcal{E}
z,z^{\prime}\in\mathcal{Z},a\in\Acal
T(z^{\prime}\mid z,a)=T(s^{\prime}\mid s,a)T_{e}(e^{\prime}\mid e),
(s,a)
\phi_{\star}:\Xcal\rightarrow\mathcal{S}
\phi_{\star,e}:\Xcal\rightarrow\mathcal{E}
(z_{1},x_{1},a_{1},z_{2},x_{2},a_{2},\cdots,)
z_{1}\sim\mu(\cdot)
x_{t}\sim q(\cdot\mid z_{t})
\rbr{z_{1},z_{2},\cdots}
\rbr{x_{1},x_{2},\cdots}
\pi(a\mid x)
x_{1}
x_{2}
\phi_{\star}(x_{1})=\phi_{\star}(x_{2})
\pi(\cdot\mid x_{1})=\pi(\cdot\mid x_{2})
\mathcal{D}=(\mathcal{X},\mathcal{A})
\mathcal{X}=(x_{1},x_{2},x_{3},...,x_{N})
\mathcal{A}=(a_{1},a_{2},a_{3},...,a_{N})
x_{t}\in\mathbb{R}^{m}
z_{t}
\phi:\mathbb{R}^{m}\rightarrow\mathbb{R}^{d}
\mathcal{D}
s_{t}=\phi(x_{t})
\Fcal
f\in\Fcal
\Tcal f\in\Fcal
(\Tcal f)(x,a)\equiv R(x,a)+\EE_{x^{\prime}\sim T(x^{\prime}\mid x,a)}[\max_{a%
^{\prime}}f(x^{\prime},a^{\prime})]
(x,a)\in\Xcal\times\Acal
\phi_{\star}
\phi_{\star}
\mathcal{Q}_{\Scal}=\{(s,a)\mapsto[0,1]:(s,a)\in\mathcal{S}\times\mathcal{A}\}
\mathcal{S}
\phi
\Fcal(\phi)=\{(s,a)\mapsto Q(\phi(s),a):Q\in\mathcal{Q}_{\Scal},(s,a)\in%
\mathcal{S}\times\mathcal{A}\}
\phi
\Fcal(\phi_{\star})
\phi
\Xcal
P
\Xcal
\sim_{P}
P_{1}
P_{2}
x_{1},x_{2}\in\Xcal
x_{1}\sim_{P_{1}}x_{2}
x_{1}\sim_{P_{2}}x_{2}
\phi_{\star}
\Fcal(\phi)
\phi(x_{t})
\phi(x_{t+k})
k
K
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{\begin{subarray}{c}t\sim U(0,N),\\
k\sim U(0,K)\end{subarray}}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+%
k}))\right)
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{\begin{subarray}{c}t\sim U(0,N),\\
k\sim U(0,K)\end{subarray}}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+%
k}))\right)
\phi(\cdot)
\phi(\cdot)
x
\phi(\cdot)
\phi
\phi
L_{\theta}(\mathcal{D})=-\mathbb{E}_{x_{t}\sim\mathcal{D}_{\phi}}\Big{[}Q_{%
\psi}(s_{t},\tilde{a}_{t})\Big{]}
s_{t}=\phi(\text{aug}(x_{t}))
\tilde{a}_{t}=\pi_{\theta}(s_{t})+\epsilon
\epsilon\sim\text{clip}(\mathcal{N}(0,\sigma^{2}),-c,c))
Q(s,\pi(s))
\mathcal{D}_{\phi}
\mathcal{L}_{\theta}(\mathcal{D})=-\mathbb{E}_{s_{t},a_{t}\sim\mathcal{D}_{%
\phi}}\Big{[}\lambda Q_{\psi}(s_{t},{\mathbf{a}}_{t})-(\pi_{\theta}(s_{t})-{%
\mathbf{a}}_{t})^{2}\Big{]}
(s_{t},s_{t^{\prime}})
s_{t}
s_{t^{\prime}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
k=1
{\mathbf{x}}_{t+k}
m(k)
\pm
\pm
\pm
\pm
\pm
\pm
x_{t}
\pm
\pm
\pm
k
\pm
\pm
\pm
k=1
k
k
k
f\in\Fcal(\phi_{\star})
x,a
\displaystyle R(x,a)+\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_{a^{\prime}}f(%
x^{\prime},a^{\prime})]
\displaystyle R(x,a)+\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_{a^{\prime}}f(%
x^{\prime},a^{\prime})]
\Fcal(\phi_{\star})
f\in\Fcal(\phi_{\star})
\displaystyle R(x,a)+\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_{a^{\prime}}f(%
x^{\prime},a^{\prime})]
\displaystyle R(x,a)+\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_{a^{\prime}}f(%
x^{\prime},a^{\prime})]
\displaystyle=R(\phi_{\star}(x),a)+\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_%
{a^{\prime}}f(\phi_{\star}(x^{\prime}),a^{\prime})]
\displaystyle=R(\phi_{\star}(x),a)+\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_%
{a^{\prime}}f(\phi_{\star}(x^{\prime}),a^{\prime})]
\displaystyle=R(\phi_{\star}(x),a)+\EE_{x^{\prime}\sim T(\cdot\mid\phi_{\star}%
(x),a)}[\max_{a^{\prime}}f(\phi_{\star}(x^{\prime}),a^{\prime})].
\displaystyle=R(\phi_{\star}(x),a)+\EE_{x^{\prime}\sim T(\cdot\mid\phi_{\star}%
(x),a)}[\max_{a^{\prime}}f(\phi_{\star}(x^{\prime}),a^{\prime})].
f\in\Fcal(\phi_{\star})
\displaystyle\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_{a^{\prime}}f(\phi_{%
\star}(x^{\prime}),a^{\prime})]
\displaystyle\EE_{x^{\prime}\sim T(\cdot\mid x,a)}[\max_{a^{\prime}}f(\phi_{%
\star}(x^{\prime}),a^{\prime})]
\displaystyle\stackrel{{\scriptstyle\mathrm{(a)}}}{{=}}\sum_{s^{\prime},e^{%
\prime}}\sum_{x^{\prime}\in{\tt supp}q(x^{\prime}\mid s^{\prime},e^{\prime})}q%
(x^{\prime}\mid\phi_{\star}(x^{\prime}),\phi_{\star,e}(x^{\prime}))T(s^{\prime%
}\mid\phi_{\star}(x),a)T_{e}(e^{\prime}\mid\phi_{\star,e}(x))f(s^{\prime},a^{%
\prime})
\displaystyle\stackrel{{\scriptstyle\mathrm{(a)}}}{{=}}\sum_{s^{\prime},e^{%
\prime}}\sum_{x^{\prime}\in{\tt supp}q(x^{\prime}\mid s^{\prime},e^{\prime})}q%
(x^{\prime}\mid\phi_{\star}(x^{\prime}),\phi_{\star,e}(x^{\prime}))T(s^{\prime%
}\mid\phi_{\star}(x),a)T_{e}(e^{\prime}\mid\phi_{\star,e}(x))f(s^{\prime},a^{%
\prime})
\displaystyle\stackrel{{\scriptstyle\mathrm{(b)}}}{{=}}\sum_{s^{\prime}}T(s^{%
\prime}\mid\phi_{\star}(x),a)f(s^{\prime},a^{\prime})\sum_{e^{\prime}}T_{e}(e^%
{\prime}\mid\phi_{\star,e}(x))
\displaystyle\stackrel{{\scriptstyle\mathrm{(b)}}}{{=}}\sum_{s^{\prime}}T(s^{%
\prime}\mid\phi_{\star}(x),a)f(s^{\prime},a^{\prime})\sum_{e^{\prime}}T_{e}(e^%
{\prime}\mid\phi_{\star,e}(x))
\displaystyle\stackrel{{\scriptstyle\mathrm{(c)}}}{{=}}\sum_{s^{\prime}}T(s^{%
\prime}\mid\phi_{\star}(x),a)f(s^{\prime},a^{\prime}),
\displaystyle\stackrel{{\scriptstyle\mathrm{(c)}}}{{=}}\sum_{s^{\prime}}T(s^{%
\prime}\mid\phi_{\star}(x),a)f(s^{\prime},a^{\prime}),
\mathrm{(a)}
\displaystyle T(x^{\prime}\mid x,a)=q(x^{\prime}\mid\phi_{\star}(x^{\prime}),%
\phi_{\star,e}(x^{\prime}))T(\phi_{\star}(x^{\prime})\mid\phi_{\star}(x),a)T_{%
e}(\phi_{\star,e}(x^{\prime})\mid\phi_{\star,e}(x)),
\displaystyle T(x^{\prime}\mid x,a)=q(x^{\prime}\mid\phi_{\star}(x^{\prime}),%
\phi_{\star,e}(x^{\prime}))T(\phi_{\star}(x^{\prime})\mid\phi_{\star}(x),a)T_{%
e}(\phi_{\star,e}(x^{\prime})\mid\phi_{\star,e}(x)),
\mathrm{(b)}
\mathrm{(c)}
x^{\prime}
e^{\prime}
R(\phi_{\star}(x),a)+\EE_{x^{\prime}\sim T(\cdot\mid\phi_{\star}(x),a)}[\max_{%
a^{\prime}}f(\phi_{\star}(x^{\prime}),a^{\prime})]
\Fcal(\phi_{\star})
\phi_{\star}
a
x=(x(1),x(2))
x(1),x(2)\in\{0,1\}
\displaystyle x_{t+1}(1)=x_{t}(1)\oplus x_{t}(2)
\displaystyle x_{t+1}(1)=x_{t}(1)\oplus x_{t}(2)
\displaystyle x_{t+1}(2)=x_{t}(2),
\displaystyle x_{t+1}(2)=x_{t}(2),
\oplus
T(x^{\prime}\mid x,a)=T(x^{\prime}\mid x)
\phi_{\star}=\{\ s_{0}\}
s_{0}
0
\phi(x)=(x_{1})
x_{2}
\phi_{\star}
\Qcal_{N=2}
Q\in\Qcal_{N=2}
\displaystyle Q(x_{1}=1)=1
\displaystyle Q(x_{1}=1)=1
\displaystyle Q(x_{1}=0)=0.
\displaystyle Q(x_{1}=0)=0.
\Tcal Q
\Qcal_{N=2}.
\displaystyle(TQ)(x_{1}=1,x_{2}=1)=0
\displaystyle(TQ)(x_{1}=1,x_{2}=1)=0
\displaystyle(TQ)(x_{1}=0,x_{2}=1)=1
\displaystyle(TQ)(x_{1}=0,x_{2}=1)=1
\displaystyle(TQ)(x_{1}=1,x_{2}=0)=1
\displaystyle(TQ)(x_{1}=1,x_{2}=0)=1
\displaystyle(TQ)(x_{1}=0,x_{2}=0)=0.
\displaystyle(TQ)(x_{1}=0,x_{2}=0)=0.
\Qcal_{N=2}
(TQ)
x_{1}\rightarrow\mathbb{R}
(TQ)(x_{1}=1,x_{2}=1)\neq(TQ)(x_{1}=1,x_{2}=0).
x_{2}
k>0
x,x^{\prime}\in\mathcal{X}
x
x^{\prime}
\pi:\Xcal\rightarrow\Acal
a_{t}\in\Acal
(x_{t},x_{t+k})\in{\tt supp}~{}\PP_{\pi}(X_{t},X_{t+k})
\PP_{\pi}(a_{t}\mid x_{t},x_{t+k})=\PP_{\pi}(a_{t}\mid\phi_{\star}(x_{t}),\phi%
_{\star}(x_{t+k}))
\displaystyle\mathbb{P}_{\pi,\mu}(a\mid x^{\prime},x)
\displaystyle\mathbb{P}_{\pi,\mu}(a\mid x^{\prime},x)
\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}\frac{\mathbb{P}_{\pi,\mu}(x^{%
\prime}\mid x,a)\mathbb{P}_{\pi,\mu}(a\mid x)}{\sum_{a^{\prime}}\mathbb{P}_{%
\pi,\mu}(x^{\prime}\mid x,a^{\prime})}
\displaystyle\stackrel{{\scriptstyle(a)}}{{=}}\frac{\mathbb{P}_{\pi,\mu}(x^{%
\prime}\mid x,a)\mathbb{P}_{\pi,\mu}(a\mid x)}{\sum_{a^{\prime}}\mathbb{P}_{%
\pi,\mu}(x^{\prime}\mid x,a^{\prime})}
\displaystyle\stackrel{{\scriptstyle(b)}}{{=}}\frac{\mathbb{P}_{\pi,\mu}(x^{%
\prime}\mid x,a)\pi(a\mid\phi_{\star}(x)))}{\sum_{a^{\prime}}\mathbb{P}_{\pi,%
\mu}(x^{\prime}\mid x,a^{\prime})\pi(a^{\prime}\mid\phi_{\star}(x))}
\displaystyle\stackrel{{\scriptstyle(b)}}{{=}}\frac{\mathbb{P}_{\pi,\mu}(x^{%
\prime}\mid x,a)\pi(a\mid\phi_{\star}(x)))}{\sum_{a^{\prime}}\mathbb{P}_{\pi,%
\mu}(x^{\prime}\mid x,a^{\prime})\pi(a^{\prime}\mid\phi_{\star}(x))}
\displaystyle\stackrel{{\scriptstyle(c)}}{{=}}\frac{q(x^{\prime}\mid\phi_{%
\star}(x^{\prime}),\phi_{\star,e}(x^{\prime}))\mathbb{P}_{\pi,\mu}(\phi_{\star%
}(x^{\prime})\mid\phi_{\star}(x),a)\mathbb{P}_{\pi,\mu}(\phi_{\star,e}(x^{%
\prime})\mid\phi_{\star,e}(x))\pi(a\mid\phi_{\star}(x))}{\sum_{a^{\prime}}q(x^%
{\prime}\mid\phi_{\star}(x^{\prime}),\phi_{\star,e}(x^{\prime}))\mathbb{P}_{%
\pi,\mu}(\phi_{\star}(x^{\prime})\mid\phi_{\star}(x),a^{\prime})\mathbb{P}_{%
\pi,\mu}(\phi_{\star,e}(x^{\prime})\mid\phi_{\star,e}(x))\pi(a^{\prime}\mid%
\phi_{\star}(x))}
\displaystyle\stackrel{{\scriptstyle(c)}}{{=}}\frac{q(x^{\prime}\mid\phi_{%
\star}(x^{\prime}),\phi_{\star,e}(x^{\prime}))\mathbb{P}_{\pi,\mu}(\phi_{\star%
}(x^{\prime})\mid\phi_{\star}(x),a)\mathbb{P}_{\pi,\mu}(\phi_{\star,e}(x^{%
\prime})\mid\phi_{\star,e}(x))\pi(a\mid\phi_{\star}(x))}{\sum_{a^{\prime}}q(x^%
{\prime}\mid\phi_{\star}(x^{\prime}),\phi_{\star,e}(x^{\prime}))\mathbb{P}_{%
\pi,\mu}(\phi_{\star}(x^{\prime})\mid\phi_{\star}(x),a^{\prime})\mathbb{P}_{%
\pi,\mu}(\phi_{\star,e}(x^{\prime})\mid\phi_{\star,e}(x))\pi(a^{\prime}\mid%
\phi_{\star}(x))}
\displaystyle=\frac{\mathbb{P}_{\pi,\mu}(\phi_{\star}(x^{\prime})\mid\phi_{%
\star}(x),a)\pi(a\mid\phi_{\star}(x))}{\sum_{a^{\prime}}\mathbb{P}_{\pi,\mu}(%
\phi_{\star}(x^{\prime})\mid\phi_{\star}(x),a^{\prime})\pi(a^{\prime}\mid\phi_%
{\star}(x))}.
\displaystyle=\frac{\mathbb{P}_{\pi,\mu}(\phi_{\star}(x^{\prime})\mid\phi_{%
\star}(x),a)\pi(a\mid\phi_{\star}(x))}{\sum_{a^{\prime}}\mathbb{P}_{\pi,\mu}(%
\phi_{\star}(x^{\prime})\mid\phi_{\star}(x),a^{\prime})\pi(a^{\prime}\mid\phi_%
{\star}(x))}.
(a)
(b)
\pi
(c)
\mathbb{P}_{\pi,\mu}(a\mid x^{\prime},x)=\mathbb{P}_{\pi,\mu}(a\mid\phi_{\star%
}(x^{\prime}),\phi_{\star}(x)),
\hat{\pi}:\Xcal\rightarrow\Acal
a_{t}\in\Acal
(x_{t},x_{t+k})
\PP_{\hat{\pi}}(X_{t}=x_{t},X_{t+k}=x_{t+k})>0
\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))=\PP_{\hat{%
\pi}}(a_{t}\mid\phi_{\star}(x_{t}))
\PP_{\hat{\pi}}(a_{t}=\hat{a}(\phi_{\star}(x_{t}))\mid\phi_{\star}(x_{t}))=1
\hat{a}:\mathcal{S}\xrightarrow[]{}A
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t})\PP%
_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}))}{\sum_{a^{\prime\prime}}\PP_{\hat{%
\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a^{\prime\prime})\PP_{\hat{%
\pi}}(a^{\prime\prime}\mid\phi_{\star}(x_{t}))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t})\PP%
_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}))}{\sum_{a^{\prime\prime}}\PP_{\hat{%
\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a^{\prime\prime})\PP_{\hat{%
\pi}}(a^{\prime\prime}\mid\phi_{\star}(x_{t}))}
a^{\prime}\in A
a^{\prime}=\hat{a}(\phi_{\star}(x_{t}))
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t})\PP%
_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}))}{\sum_{a^{\prime\prime}}\PP_{\hat{%
\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a^{\prime\prime})\PP_{\hat{%
\pi}}(a^{\prime\prime}\mid\phi_{\star}(x_{t}))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))
\displaystyle=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}%
),a_{t})\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}))}{\sum_{a^{\prime\prime}}%
\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a^{\prime\prime})%
\PP_{\hat{\pi}}(a^{\prime\prime}\mid\phi_{\star}(x_{t}))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t}=a^{%
\prime})}{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t}=a^%
{\prime})}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))
\displaystyle=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}%
),a_{t}=a^{\prime})}{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t%
}),a_{t}=a^{\prime})}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=1.
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))
\displaystyle=1.
\PP_{\hat{\pi}}(a_{t}=a^{\prime}\mid\phi_{\star}(x_{t}))=1
a^{\prime}=\hat{a}(\phi_{\star}(x_{t}))
a^{\prime}\neq\hat{a}(\phi_{\star}(x_{t}))
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t})\PP%
_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}))}{\sum_{a^{\prime\prime}}\PP_{\hat{%
\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a^{\prime\prime})\PP_{\hat{%
\pi}}(a^{\prime\prime}\mid\phi_{\star}(x_{t}))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))
\displaystyle=\frac{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}%
),a_{t})\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}))}{\sum_{a^{\prime\prime}}%
\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a^{\prime\prime})%
\PP_{\hat{\pi}}(a^{\prime\prime}\mid\phi_{\star}(x_{t}))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=\frac{0}{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_{t}),a_{t}=%
\hat{a}(\phi_{\star}(x_{t})))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))
\displaystyle=\frac{0}{\PP_{\hat{\pi}}(\phi_{\star}(x_{t+k}\mid\phi_{\star}(x_%
{t}),a_{t}=\hat{a}(\phi_{\star}(x_{t})))}
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}%
))=0.
\displaystyle\PP_{\hat{\pi}}(a_{t}\mid\phi_{\star}(x_{t}),\phi_{\star}(x_{t+k}))
\displaystyle=0.
\PP_{\hat{\pi}}(a_{t}=a^{\prime}\mid\phi_{\star}(x_{t}))=0
a^{\prime}\neq\hat{a}(\phi_{\star}(x_{t}))
x_{t}
x_{t+k}
\phi
f
\phi(x_{j})=f(\phi(x_{t}),a_{t:j})
\phi
\phi
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+k}))\right).
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+k}))\right).
k
\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}\operatorname*{\mathbb{E}%
}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0,K)}\text{log}\left(\PP(a%
_{t},\dots a_{t+k}\mid\phi(x_{t}),\phi(x_{t+k}))\right).
\displaystyle\PP(a_{t:t+k}\mid\phi(x_{t}),\phi(x_{t+k}))=\prod_{j=t}^{t+k}\PP(%
a_{j}\mid\phi(x_{t}),\phi(x_{t+k}),a_{t:j})
\displaystyle\PP(a_{t:t+k}\mid\phi(x_{t}),\phi(x_{t+k}))
\displaystyle=\prod_{j=t}^{t+k}\PP(a_{j}\mid\phi(x_{t}),\phi(x_{t+k}),a_{t:j})
\displaystyle\PP(a_{t:t+k}\mid\phi(x_{t}),\phi(x_{t+k}))=\prod_{j=t}^{t+k}\PP(%
a_{j}\mid\phi(x_{t}),a_{t:j},\phi(x_{t+k}))
\displaystyle\PP(a_{t:t+k}\mid\phi(x_{t}),\phi(x_{t+k}))
\displaystyle=\prod_{j=t}^{t+k}\PP(a_{j}\mid\phi(x_{t}),a_{t:j},\phi(x_{t+k}))
\displaystyle\PP(a_{t:t+k}\mid\phi(x_{t}),\phi(x_{t+k}))=\prod_{j=t}^{t+k}\PP(%
a_{j}\mid\phi(x_{j}),\phi(x_{t+k}))
\displaystyle\PP(a_{t:t+k}\mid\phi(x_{t}),\phi(x_{t+k}))
\displaystyle=\prod_{j=t}^{t+k}\PP(a_{j}\mid\phi(x_{j}),\phi(x_{t+k}))
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\text{log}\left(\prod_{j=t}^{t+k}\PP(a_{j}\mid\phi(x_{j}),\phi(x_{t+k}))\right)
\displaystyle\phi_{\star}
\displaystyle\in\operatorname*{arg\,max}_{\phi\in\Phi}\operatorname*{\mathbb{E%
}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0,K)}\text{log}\left(%
\prod_{j=t}^{t+k}\PP(a_{j}\mid\phi(x_{j}),\phi(x_{t+k}))\right)
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\sum_{j=t}^{t+k}\text{log}\left(\PP(a_{j}\mid\phi(x_{j}),\phi(x_{t+k}))\right)
\displaystyle\phi_{\star}
\displaystyle\in\operatorname*{arg\,max}_{\phi\in\Phi}\operatorname*{\mathbb{E%
}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0,K)}\sum_{j=t}^{t+k}%
\text{log}\left(\PP(a_{j}\mid\phi(x_{j}),\phi(x_{t+k}))\right)
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\operatorname*{\mathbb{E}}_{j\sim U(t,t+k)}\text{log}\left(\PP(a_{j}\mid%
\phi(x_{j}),\phi(x_{t+k}))\right)
\displaystyle\phi_{\star}
\displaystyle\in\operatorname*{arg\,max}_{\phi\in\Phi}\operatorname*{\mathbb{E%
}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0,K)}\operatorname*{%
\mathbb{E}}_{j\sim U(t,t+k)}\text{log}\left(\PP(a_{j}\mid\phi(x_{j}),\phi(x_{t%
+k}))\right)
N\gg k
t
j
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+k}))\right)
\displaystyle\phi_{\star}
\displaystyle\in\operatorname*{arg\,max}_{\phi\in\Phi}\operatorname*{\mathbb{E%
}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0,K)}\text{log}\left(\PP(%
a_{t}\mid\phi(x_{t}),\phi(x_{t+k}))\right)
\left(\PP(a_{t},\dots a_{t+k}\mid\phi(x_{t}),\phi(x_{t+k}))\right)
\phi(x_{t})
0
a_{2}
s_{2}
s_{f}
s_{0}
s_{1}
s_{2}
s_{3}
s_{f}
a_{1}
a_{1}
a_{2}
a_{2}
a_{2}
a_{2}
a_{0}
a_{0}
a_{0}
a_{0}
a_{1}
\langle s_{t},a_{t},r_{t},s_{t+1}\dots\rangle
\displaystyle\mathcal{D}=\{\underbrace{\langle s_{0},a_{0},0,s_{0},a_{0},0,s_{%
0},a_{2},0,s_{f}\rangle}_{\tau_{1}},
\displaystyle\mathcal{D}=\{
\displaystyle\underbrace{\langle s_{0},a_{0},0,s_{0},a_{0},0,s_{0},a_{2},0,s_{%
f}\rangle}_{\tau_{1}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{0},0,s_{1},a_{2},0,s_{%
f}\rangle}_{\tau_{2}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{0},0,s_{1},a_{2},0,s_{%
f}\rangle}_{\tau_{2}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{1},0,s_{2},a_{0},0,s_{%
2},a_{2},\textbf{1},s_{f}\rangle}_{\tau_{3}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{1},0,s_{2},a_{0},0,s_{%
2},a_{2},\textbf{1},s_{f}\rangle}_{\tau_{3}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{1},0,s_{2},a_{1},0,s_{%
3},a_{0},0,s_{3},a_{2},0,s_{f}\rangle}_{\tau_{4}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{1},0,s_{2},a_{1},0,s_{%
3},a_{0},0,s_{3},a_{2},0,s_{f}\rangle}_{\tau_{4}},
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{1},0,s_{2},a_{1},0,s_{%
3},a_{1},0,s_{0},a_{2},0,s_{f}\rangle}_{\tau_{5}}\}.
\displaystyle\underbrace{\langle s_{0},a_{1},0,s_{1},a_{1},0,s_{2},a_{1},0,s_{%
3},a_{1},0,s_{0},a_{2},0,s_{f}\rangle}_{\tau_{5}}\}.
\tau_{1}
s_{0}
s_{1}
s_{2}
s_{3}
s_{0}
a_{1}
\tau_{5}
p_{1}
\phi
\mathcal{S}
\mathcal{X}=\{x_{0},x_{1},x_{f}\}
\phi(s_{0})=\phi(s_{2})=x_{0}
\phi(s_{1})=\phi(s_{3})=x_{1}
\phi(s_{f})=x_{f}
\displaystyle p_{1}(a|x_{0},x_{0})=\delta_{a=a_{0}},
\displaystyle p_{1}(a|x_{0},x_{0})
\displaystyle=\delta_{a=a_{0}},
\displaystyle p_{1}(a|x_{0},x_{1})=\delta_{a=a_{1}},
\displaystyle p_{1}(a|x_{0},x_{1})
\displaystyle=\delta_{a=a_{1}},
\displaystyle p_{1}(a|x_{0},x_{f})=\delta_{a=a_{2}}.
\displaystyle p_{1}(a|x_{0},x_{f})
\displaystyle=\delta_{a=a_{2}}.
\mathcal{X}
\displaystyle\mathcal{D}=\{\underbrace{\langle x_{0},a_{0},0,x_{0},a_{0},0,x_{%
0},a_{2},0,x_{f}\rangle}_{\tau_{1}},
\displaystyle\mathcal{D}=\{
\displaystyle\underbrace{\langle x_{0},a_{0},0,x_{0},a_{0},0,x_{0},a_{2},0,x_{%
f}\rangle}_{\tau_{1}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{0},0,x_{1},a_{2},0,x_{%
f}\rangle}_{\tau_{2}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{0},0,x_{1},a_{2},0,x_{%
f}\rangle}_{\tau_{2}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{1},0,x_{0},a_{0},0,x_{%
0},a_{2},\textbf{1},x_{f}\rangle}_{\tau_{3}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{1},0,x_{0},a_{0},0,x_{%
0},a_{2},\textbf{1},x_{f}\rangle}_{\tau_{3}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{1},0,x_{0},a_{1},0,x_{%
1},a_{0},0,x_{1},a_{2},0,x_{f}\rangle}_{\tau_{4}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{1},0,x_{0},a_{1},0,x_{%
1},a_{0},0,x_{1},a_{2},0,x_{f}\rangle}_{\tau_{4}},
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{1},0,x_{0},a_{1},0,x_{%
1},a_{1},0,x_{0},a_{2},0,x_{f}\rangle}_{\tau_{5}}\}.
\displaystyle\underbrace{\langle x_{0},a_{1},0,x_{1},a_{1},0,x_{0},a_{1},0,x_{%
1},a_{1},0,x_{0},a_{2},0,x_{f}\rangle}_{\tau_{5}}\}.
a_{2}
x_{0}
1/3
x_{0}
a_{2}
s_{0}
s_{0}
s_{2}
\tau_{1}
\tau_{3}
(s_{0},s_{0})
(s_{0},s_{2})
\hat{R}_{c}=\sum_{c^{\prime}=c}^{C}r_{c}
c
\tau=\big{(}\hat{R}_{1},s_{1},a_{1},\hat{R}_{2},s_{2},a_{2},\hat{R}_{3},s_{3},%
a_{3},\ldots\big{)}
a_{c}
s_{c}
s_{1}
\hat{R}_{1}
k
k
k
k
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\phi(x_{t+k})
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+k}))\right).
\displaystyle\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}%
\operatorname*{\mathbb{E}}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0%
,K)}\text{log}\left(\PP(a_{t}\mid\phi(x_{t}),\phi(x_{t+k}))\right).
k
\phi_{\star}\in\operatorname*{arg\,max}_{\phi\in\Phi}\operatorname*{\mathbb{E}%
}_{t\sim U(0,N)}\operatorname*{\mathbb{E}}_{k\sim U(0,K)}\text{log}\left(\PP(a%
_{t},\dots a_{t+k}\mid\phi(x_{t}),\phi(x_{t+k}))\right).
k
\%
\%
\%
\%
\%
100
\times
\times
\phi(x)
s_{t}
s_{t+k}
k
84\times 84
4
84\times 84
Â±4
\times
\times
\times
84
\times
\times
\times
