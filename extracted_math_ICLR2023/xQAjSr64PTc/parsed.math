{}^{\,,1}
\pm
\%
\pm
\%
(\mathcal{S},\mathcal{A},R,\mathcal{P},\rho_{0},\gamma)
\mathcal{S}
\mathcal{A}
R(\mathbf{s},\text{a})
\mathcal{P}\left(\mathbf{~{}s}^{\prime}\mid\mathbf{s},\mathrm{a}\right)
\rho_{0}
\gamma
\mathbf{a}_{t}\sim\pi_{\phi}\left(\cdot\mid\mathbf{s}_{t}\right)
\mathbb{E}_{\mathbf{s}_{0}\sim\rho_{0},\left(\mathbf{s}_{0},\mathbf{a}_{0},%
\ldots,\mathbf{s}_{T}\right)\sim\pi}\left[\sum_{t=0}^{T-1}\gamma^{t}R\left(%
\mathbf{s}_{t},\mathbf{a}_{t}\right)\right]
T
\mathbf{z}
\mathbf{s_{t}}
\mathbf{z_{t}}
\mathbf{z}_{t+1}
\vspace{-5pt}\begin{array}[]{ll}\text{ Representation: }&\mathbf{z}_{t}=E_{%
\theta}\left(\mathbf{s}_{t}\right)\qquad\text{ Latent dynamics: }\mathbf{z}_{t%
+1}=D_{\theta}\left(\mathbf{z}_{t},\mathbf{a}_{t}\right)\\
\text{ Reward predictor: }&\hat{r}_{t}\sim R_{\theta}\left(\mathbf{z}_{t},%
\mathbf{a}_{t}\right)\end{array}
\mathbf{s},\mathbf{a},\mathbf{z}
\begin{array}[]{ll}\text{ Value: }\hat{q}_{t}=Q_{\theta}\left(\mathbf{z}_{t},%
\mathbf{a}_{t}\right)\qquad\text{ Policy: }\hat{\mathbf{a}}_{t}\sim\pi_{\phi}%
\left(\mathbf{z}_{t}\right)\end{array},
\theta
\displaystyle\mathcal{L}\left(\theta,\mathcal{D}\right)=\mathbb{E}_{\left(%
\mathbf{s},\mathbf{a},\mathbf{z}_{t},r_{t}\right)_{t:t+H}\sim\mathcal{D}}\left%
[\sum_{i=t}^{t+H}\left(c_{1}\underbrace{\left\|R_{\theta}\left(\mathbf{z}_{i},%
\mathbf{a}_{i}\right)-r_{i}\right\|_{2}^{2}}_{\text{Reward prediction}}+c_{2}%
\underbrace{\left\|D_{\theta}\left(\mathbf{z}_{i},\mathbf{a}_{i}\right)-E_{%
\theta-}\left(\mathbf{s}_{i+1}\right)\right\|_{2}^{2}}_{\text{Latent state %
consistency}}\right.\right.
\displaystyle\mathcal{L}\left(\theta,\mathcal{D}\right)=\mathbb{E}_{\left(%
\mathbf{s},\mathbf{a},\mathbf{z}_{t},r_{t}\right)_{t:t+H}\sim\mathcal{D}}\left%
[\sum_{i=t}^{t+H}\left(c_{1}\underbrace{\left\|R_{\theta}\left(\mathbf{z}_{i},%
\mathbf{a}_{i}\right)-r_{i}\right\|_{2}^{2}}_{\text{Reward prediction}}+c_{2}%
\underbrace{\left\|D_{\theta}\left(\mathbf{z}_{i},\mathbf{a}_{i}\right)-E_{%
\theta-}\left(\mathbf{s}_{i+1}\right)\right\|_{2}^{2}}_{\text{Latent state %
consistency}}\right.\right.
\displaystyle\left.\left.+c_{3}\underbrace{\left\|Q_{\theta}\left(\mathbf{z}_{%
i},\mathbf{a}_{i}\right)-\left(r_{i}+\gamma Q_{\theta^{-}}\left(\mathbf{z}_{i+%
1},\pi_{\theta}\left(\mathbf{z}_{i+1}\right)\right)\right)\right\|_{2}^{2}}_{%
\text{Value prediction }}\right)\right],
\displaystyle\left.\left.+c_{3}\underbrace{\left\|Q_{\theta}\left(\mathbf{z}_{%
i},\mathbf{a}_{i}\right)-\left(r_{i}+\gamma Q_{\theta^{-}}\left(\mathbf{z}_{i+%
1},\pi_{\theta}\left(\mathbf{z}_{i+1}\right)\right)\right)\right\|_{2}^{2}}_{%
\text{Value prediction }}\right)\right],
\pi_{\phi}
Q_{\theta}
c_{i}
H
\mathcal{D}
Q
\theta
H
\{\theta_{h}^{\text{head }}\}^{H}_{h=1}
\begin{aligned} \mathbf{z}_{t+1}=\left\{D_{\theta}\left(\mathbf{z}_{t},a_{t};%
\theta,\theta_{h}^{\text{head }}\right)\right\}_{h=1}^{H}\end{aligned}.
[\pi^{1}_{\phi}(\mathbf{z}),\cdots,\pi^{h}_{\phi}(\mathbf{z})]
\begin{aligned} \mathcal{L}_{\pi}(\phi,\mathcal{D})=\mathbb{E}_{\mathbf{z}_{t}%
\sim\mathcal{D}}\left[Q_{\theta}\left(\mathbf{z}_{t},\pi_{\phi}\left(\mathbf{z%
}_{t}\right)\right)-\alpha D_{\text{KL}}\left(\widetilde{\pi}_{\phi}\left(%
\mathbf{z}_{t}\right)\|\pi_{\phi}\left(\mathbf{z}_{t}\right)\right)\right]\end%
{aligned},
\widetilde{\pi}_{\phi}\left(\mathbf{z}_{t}\right)=\sum_{i=1}^{h}\pi_{i}\left(%
\mathbf{z}\right)/h
h^{*}
L=5
H=4
\pm
\%
\left\{g_{i}\left(\mathbf{z}_{t+1}\mid\mathbf{z}_{t},\mathbf{a}_{t}\right)\right\}
r_{t}^{\text{Disagreement }}\propto\operatorname{Var}\left\{g_{i}\left(\mathbf%
{z}_{t+1}\mid\mathbf{z}_{t},\mathbf{a}_{t}\right)\right\}\quad i=1,\ldots,N.
r_{t}^{\text{APT}}\propto\sum_{i}^{k}\log\left\|\mathbf{z}_{t}-\mathbf{z}_{k}%
\right\|^{2}.
\mathbf{w}
I(\mathbf{w}_{t},\mathbf{z}_{t})
I(\mathbf{z}_{t};\mathbf{w}_{t})=H(\mathbf{w}_{t})-H(\mathbf{w}_{t}\mid\mathbf%
{z}_{t})
H(\mathbf{w}_{t})
\log q(\mathbf{w}_{t}\mid\mathbf{z}_{t})
r_{t}^{\text{DIAYN }}\propto\log q(\mathbf{w}_{t}\mid\mathbf{z}_{t})+\text{ %
const. }
Q_{\theta}
\mathcal{L}_{Q}(\theta,\mathcal{D})=\mathbb{E}_{\left(\mathbf{s}_{t},\mathbf{a%
}_{t},r_{t},\mathbf{s}_{t+1}\right)\sim\mathcal{D}}\left[\left(Q_{\theta}\left%
(\mathbf{s}_{t},\mathbf{a}_{t}\right)-y(\mathbf{s}))^{2}\right]\right.,
y(s)=R(s,\text{a})+\gamma Q_{\bar{\theta}}\left(\mathbf{s}_{t+1},\pi_{\phi}%
\left(\mathbf{s}_{t+1}\right)\right)
\mathcal{D}
\bar{\theta}
\pi_{\phi}
Q_{\theta}
\mathcal{L}_{\pi}(\phi,\mathcal{D})=\mathbb{E}_{\mathbf{s}_{t}\sim\mathcal{D}}%
\left[Q_{\theta}\left(\mathbf{s}_{t},\pi_{\phi}\left(\mathbf{s}_{t}\right)%
\right)\right].
(|\mathcal{O}|+|\mathcal{A}|)\rightarrow
\rightarrow
\rightarrow|\mathcal{O}|
log(r+1.0)
k
k
\rightarrow
\rightarrow
\rightarrow
\theta
c_{1}
c_{2}
c_{3}
\theta^{-}
\gamma
L
H
\alpha
\mathcal{T}
\mathcal{T}
H
\alpha
h=0
S=\emptyset
E_{\theta}
D_{\theta}
R_{\theta}
Q_{\theta}
\pi_{\phi}
\mathcal{D}
M
T_{k}
k\in[1,\ldots,M]
r^{\text{int}}
r^{\text{ext}}
N_{\text{PT}}
M
N_{\text{FT}}
K
t=0,1,..N_{\text{PT}}
t==\mathcal{T}*h
\pi_{\phi}^{h}
\pi_{\phi}
h\leftarrow h+1
S\leftarrow S\cup\pi_{\phi}^{h}
\widetilde{\pi}_{\phi}\left(\mathbf{z}_{t}\right)=\sum_{i=1}^{h}\pi^{i}_{\phi}%
\left(\mathbf{z}_{t}\right)/h
\mathbf{z}_{t}=E_{\theta}\left(\mathbf{s}_{t}\right)
\mathbf{a}_{t}\sim\pi_{\theta}\left(\mathbf{z}_{t}\right)
\mathbf{s}_{t+1}\sim P\left(\cdot\mid\mathbf{s}_{t},\mathbf{a}_{t}\right)
\mathcal{D}\leftarrow\mathcal{D}\cup\left(\mathbf{s}_{t},\mathbf{a}_{t},%
\mathbf{s}_{t+1}\right)
\mathcal{D}
r^{\text{int}}
\theta
h
\phi
T_{k}\in\left[T_{1},\ldots,T_{M}\right]
\mathcal{D}
h^{*}
h^{*}
\pi^{h^{*}}_{\phi}
\pi_{\phi}^{\text{FT}}
\pi^{h^{*}}_{\phi}
t=1..N_{\text{FT}}
\mathbf{z}_{t}=E_{\theta}\left(\mathbf{s}_{t}\right)
\mathbf{a}_{t}=\textit{Plan}(\mathbf{z}_{t})
\pi_{\phi}^{\text{FT}}
\mathbf{s}_{t+1},r^{\text{ext}}_{t}\sim P\left(\cdot\mid\mathbf{s}_{t},\mathbf%
{a}_{t}\right)
\mathcal{D}\leftarrow\mathcal{D}\cup\left(\mathbf{s}_{t},\mathbf{a}_{t},r^{%
\text{ext}}_{t},\mathbf{s}_{t+1}\right)
\theta
h^{*}
\phi
T_{k}
S=\emptyset
D_{\theta}
H
S\leftarrow S\cup\pi_{\phi}^{h},h\in 1..H
\mathcal{T}
\pi_{\phi}^{h}
\pi_{\phi}
\widetilde{\pi}_{\phi}
D_{\text{KL}}\left(\widetilde{\pi}_{\phi}\left(\mathbf{z}_{t}\right)\|\pi_{%
\phi}\left(\mathbf{z}_{t}\right)\right)
[\pi^{1}_{\phi}(\mathbf{z}),\cdots,\pi^{h}_{\phi}(\mathbf{z})]
h^{*}
t
Q
E_{\theta}
D_{\theta}
R_{\theta}
Q_{\theta}
\pi_{\phi}
\mathcal{N}(\mu^{0},(\sigma^{0})^{2})
N
N_{\pi}
s_{t}
L
J
k
\mathbf{z}_{t}=E_{\theta}\left(\mathbf{s}_{t}\right)
\mathcal{N}(\mu^{0},(\sigma^{0})^{2})
j=1,..J
N
L
\mathcal{N}\left(\mu^{j-1},\left(\sigma^{j-1}\right)^{2}\right)
N_{\pi}
L
D_{\theta}
\pi_{\phi}
L
R_{\theta}
Q_{\theta}
k
\mu
\sigma
k
\mathbf{a}\sim\mathcal{N}\left(\mu^{J},\left(\sigma^{J}\right)^{2}\right)
\left\|D_{\theta}(s_{t},a_{t})-s_{t+1}\right\|_{2}^{2}
