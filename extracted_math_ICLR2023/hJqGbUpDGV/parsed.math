(\mathcal{S},\mathcal{A},P,r,\gamma)
\mathcal{S},\mathcal{A}
P(s^{\prime}|s,a)
r(s,a)
\gamma\in(0,1)
r
\left|r(s,a)\right|\leq R_{\max}
\theta\in\Theta
r(\cdot;\theta)
\theta
\pi^{*}:\Theta\times\mathcal{S}\to\Delta(\mathcal{A})
\mathcal{D}=\{(s_{t},a_{t})\}_{t=1}^{n}
\pi^{*}
(s,a)\sim w^{\pi}
\pi
w^{\pi}
w^{\pi^{*}}
w^{*}
\widetilde{\pi}:\Theta\times\mathcal{S}\to\Delta(\mathcal{A})
\widetilde{\pi}
\pi^{*}
\mathcal{D}
\displaystyle\widetilde{\theta}=\arg\min_{\theta}\frac{1}{n}\sum_{t=1}^{n}-%
\log\widetilde{\pi}(a_{t}\mid s_{t};\theta):=\arg\min_{\theta}L(\theta;%
\widetilde{\pi},\mathcal{D})\,.
\displaystyle\widetilde{\theta}
\displaystyle=\arg\min_{\theta}\frac{1}{n}\sum_{t=1}^{n}-\log\widetilde{\pi}(a%
_{t}\mid s_{t};\theta):=\arg\min_{\theta}L(\theta;\widetilde{\pi},\mathcal{D})\,.
\theta^{*}
\theta^{*}
\theta^{*}
\theta^{*}
\theta^{*}=\arg\min_{\theta}L(\theta;\pi^{*},\mathcal{D})
d_{\theta}(\theta^{*},\widetilde{\theta})
d_{\pi}(\pi^{*},\widetilde{\pi})
d_{\theta}(\theta^{*},\widetilde{\theta})=\|\widetilde{\theta}-\theta^{*}\|_{2%
}^{2}
\displaystyle d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})=\sup_{\theta\in%
\Theta}\sup_{s\in\mathcal{S}}D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta)||%
\widetilde{\pi}(\cdot\mid s;\theta))\,.
\displaystyle d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})=\sup_{\theta\in%
\Theta}\sup_{s\in\mathcal{S}}D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta)||%
\widetilde{\pi}(\cdot\mid s;\theta))\,.
\theta^{*}
\displaystyle d_{\pi}^{\mathsf{w}}(\pi^{*},\widetilde{\pi})=\mathbb{E}_{s\sim w%
^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(%
\cdot\mid s;\theta^{*}))\right]\,.
\displaystyle d_{\pi}^{\mathsf{w}}(\pi^{*},\widetilde{\pi})=\mathbb{E}_{s\sim w%
^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(%
\cdot\mid s;\theta^{*}))\right]\,.
\pi^{*}
d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})<\varepsilon
d_{\theta}(\theta^{*},\widetilde{\theta})
\mathcal{D}
\pi^{*}
\pi^{*}=\widetilde{\pi}
\mathcal{D}
\pi
\mathcal{D}
(s_{t},a_{t})\in\mathcal{D}
a_{t}=\arg\max\pi(a_{t}\mid s_{t};\theta^{*})
\mathcal{D}
\pi^{*}
\mathcal{M}
\varepsilon>0
\widetilde{\pi}
\mathcal{D}
\pi^{*}
\mathcal{D}
d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})<\varepsilon
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}>\frac{1}{2}\sup_{\theta%
,\theta^{\prime}\in\Theta}\|\theta-\theta^{\prime}\|_{2}^{2}\,.
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}>\frac{1}{2}\sup_{\theta%
,\theta^{\prime}\in\Theta}\|\theta-\theta^{\prime}\|_{2}^{2}\,.
\mathcal{D}
\pi^{*}
\pi^{*}
\pi^{*},\widetilde{\pi}
\theta\in\Theta
c>0
s\in\mathcal{S},a\in\mathcal{A}
\pi^{*}
\displaystyle\log\pi^{*}(a\mid s;\theta^{\prime})\leq\log\pi^{*}(a\mid s;%
\theta)+\nabla_{\theta}\log\pi^{*}(a\mid s;\theta)^{\top}(\theta-\theta^{%
\prime})-\frac{c}{2}\|\theta-\theta^{\prime}\|_{2}^{2}\,,
\displaystyle\log\pi^{*}(a\mid s;\theta^{\prime})\leq\log\pi^{*}(a\mid s;%
\theta)+\nabla_{\theta}\log\pi^{*}(a\mid s;\theta)^{\top}(\theta-\theta^{%
\prime})-\frac{c}{2}\|\theta-\theta^{\prime}\|_{2}^{2}\,,
\widetilde{\pi}
\pi^{*}
c>0
\pi^{*},\widetilde{\pi}
\widetilde{\theta},\theta^{*}
d_{\theta}(\theta^{*},\widetilde{\theta})
\displaystyle\mathbb{E}_{\mathcal{D}\sim\pi^{*}}\left[\|\widetilde{\theta}-%
\theta^{*}\|_{2}^{2}\right]\leq\frac{2}{c}\mathbb{E}_{s\sim w^{*}}\left[D_{%
\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;%
\theta^{*}))\right]\,.
\displaystyle\mathbb{E}_{\mathcal{D}\sim\pi^{*}}\left[\|\widetilde{\theta}-%
\theta^{*}\|_{2}^{2}\right]\leq\frac{2}{c}\mathbb{E}_{s\sim w^{*}}\left[D_{%
\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;%
\theta^{*}))\right]\,.
\pi^{*}(a\mid s;\theta)\propto\exp(Q^{*}(s,a;\theta))
\widetilde{\pi}(a\mid s;\theta)\propto\exp(\widetilde{Q}(s,a;\theta))
Q^{*}
\widetilde{Q}
\widetilde{Q}
Q^{*}
M
\left|\mathcal{S}\right|,\left|\mathcal{A}\right|<\infty
\displaystyle Q(s,a;\theta):=r(s,a;\theta)+\gamma\sum_{s^{\prime}}P(s^{\prime}%
\mid s,a)V(s;\theta)\,,\ V(s;\theta):=\log\left(\sum_{a\in\mathcal{A}}\exp(Q(s%
,a;\theta)\right)\,.
\displaystyle Q(s,a;\theta):=r(s,a;\theta)+\gamma\sum_{s^{\prime}}P(s^{\prime}%
\mid s,a)V(s;\theta)\,,\ V(s;\theta):=\log\left(\sum_{a\in\mathcal{A}}\exp(Q(s%
,a;\theta)\right)\,.
Q^{*}(s,a;\theta)
M^{*}
P
\gamma
P^{*}
P^{*}(\cdot\mid s,a)\propto(P(\cdot\mid s,a))^{n}
n\to\infty
\Delta_{P}=\sup_{s,a}\|P^{*}(\cdot\mid s,a)-\widetilde{P}(\cdot\mid s,a)\|_{1}
\pi^{*},\widetilde{\pi}
P^{*},\widetilde{P}
\displaystyle\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s;%
\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]\leq\ \frac{2|%
\mathcal{A}|R_{\max}}{(1-\gamma)^{2}}\,\Delta_{P}\,.
\displaystyle\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s;%
\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]\leq\ \frac{2|%
\mathcal{A}|R_{\max}}{(1-\gamma)^{2}}\,\Delta_{P}\,.
\gamma^{*}
\gamma^{*}\to 0
\pi^{*},\widetilde{\pi}
\gamma^{*},\widetilde{\gamma}
\displaystyle\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s;%
\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]\leq\ \frac{2|%
\mathcal{A}|R_{\max}}{(1-\widetilde{\gamma})(1-\gamma^{*})}\,\left|\widetilde{%
\gamma}-\gamma^{*}\right|\,.
\displaystyle\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s;%
\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]\leq\ \frac{2|%
\mathcal{A}|R_{\max}}{(1-\widetilde{\gamma})(1-\gamma^{*})}\,\left|\widetilde{%
\gamma}-\gamma^{*}\right|\,.
\pi^{*}
\pi^{*}=\widetilde{\pi}
\pi^{*}
\widetilde{\pi}
\theta>1
1
30\%
\theta
\widetilde{\pi}
\pi^{*}
w^{\pi}
\pi
\pi^{*}
w^{*}
\pi^{*}
P^{*}
p
p\to 0
p
\gamma^{*}
\gamma^{*}\to 0
p
p
[-1,1]^{2}
\theta\in(0,1)
\widetilde{\pi}
p
p
p
p
p
\rho\in[0,1]
\rho
10
\widetilde{\pi}
\widetilde{\pi}
\pi^{*}
\alpha
\alpha
\alpha
\widetilde{\pi}
\pi^{*}
\widetilde{\pi}
\mathcal{A}\in[0,1]
a\in\mathcal{A}
r(a;\theta)=a^{\theta}(1-a)^{1-\theta}\,,
\theta\in(0,1)
\theta
0
0
\theta
1
a_{1}
\widetilde{\pi}(a;\theta)\propto\exp(r(a;\theta))
\pi^{*}
\widetilde{\pi}
a_{1}
\displaystyle\pi^{*}(a;\theta)\propto\begin{cases}\exp(r(a;\theta))\left(%
\mathds{1}\!\left\{a\not\in(a_{1}-\frac{\delta}{2},a_{1}+\frac{\delta}{2})%
\right\}+10^{9}\ \mathds{1}\!\left\{a\in(a_{1}-\frac{\delta}{2},a_{1}+\frac{%
\delta}{2})\right\}\right)&\text{if $\theta<0.001$}\\
\exp(r(a;\theta))&\text{otherwise}\,,\end{cases}
\theta<0.001
\displaystyle\pi^{*}(a;\theta)\propto\begin{cases}\exp(r(a;\theta))\left(%
\mathds{1}\!\left\{a\not\in(a_{1}-\frac{\delta}{2},a_{1}+\frac{\delta}{2})%
\right\}+10^{9}\ \mathds{1}\!\left\{a\in(a_{1}-\frac{\delta}{2},a_{1}+\frac{%
\delta}{2})\right\}\right)&\text{if $\theta<0.001$}\\
\exp(r(a;\theta))&\text{otherwise}\,,\end{cases}
\theta<0.001
\delta\in(0,1)
a_{1}
\theta
0
d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})<c\delta
c
\delta
a_{1}=1
\widetilde{\theta}\approx 1
\theta^{*}\approx 0
3\times 3
\gamma=1
s
a
\pi(a\mid s;\theta)\propto\exp(\max(\theta,10-\theta))
\theta\in[0,4]\cup[6,10]
\widetilde{\pi}
\widetilde{\pi}(a\mid s;\theta)=\exp(\Phi(s,a;\theta))/Z(s;\theta)
\delta>0
B_{\delta}(\mathcal{D})=\bigcup_{t=1}^{n}\left(a_{t}-\frac{\delta}{2},a_{t}+%
\frac{\delta}{2}\right)
\frac{\delta}{2}
\mathcal{D}
\theta^{*}\in\Theta
\pi^{*}
\displaystyle\pi^{*}(a\mid s;\theta)=\begin{cases}\frac{1}{Z^{\prime}(s;\theta%
)}\left(\exp(\Phi(s,a;\theta))\mathds{1}\!\left\{a\not\in B_{\delta}(\mathcal{%
D})\right\}+C\ \mathds{1}\!\left\{a\in B_{\delta}(\mathcal{D})\right\}\right)&%
\text{if $\theta=\theta^{*}$}\,,\\
\frac{1}{Z(s;\theta)}\exp(\Phi(s,a;\theta))&\text{otherwise}\,,\end{cases}
\theta=\theta^{*}
\displaystyle\pi^{*}(a\mid s;\theta)=\begin{cases}\frac{1}{Z^{\prime}(s;\theta%
)}\left(\exp(\Phi(s,a;\theta))\mathds{1}\!\left\{a\not\in B_{\delta}(\mathcal{%
D})\right\}+C\ \mathds{1}\!\left\{a\in B_{\delta}(\mathcal{D})\right\}\right)&%
\text{if $\theta=\theta^{*}$}\,,\\
\frac{1}{Z(s;\theta)}\exp(\Phi(s,a;\theta))&\text{otherwise}\,,\end{cases}
\theta=\theta^{*}
C
C=\sup_{s,a,\theta}\exp(\Phi(s,a;\theta))
\mathcal{D}
\pi^{*}
\theta^{*}
\pi^{*}
\theta^{*}
\theta^{*}
\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}>\sup_{\theta,\theta^{\prime}}\|%
\theta-\theta^{\prime}\|_{2}/2
\delta
d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})<\varepsilon
\theta^{*}
s\in\mathcal{S}
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))=\int_{\mathcal{A}}\pi^{*}(a\mid s;\theta^{*})\log%
\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;\theta^{*})}da
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))=\int_{\mathcal{A}}\pi^{*}(a\mid s;\theta^{*})\log%
\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;\theta^{*})}da
\displaystyle\qquad=\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}\pi^{*}%
(a\mid s;\theta^{*})\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a%
\mid s;\theta^{*})}da+\int_{B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s;\theta^{*}%
)\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;\theta^{*})}da\,.
\displaystyle\qquad=\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}\pi^{*}%
(a\mid s;\theta^{*})\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a%
\mid s;\theta^{*})}da+\int_{B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s;\theta^{*}%
)\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;\theta^{*})}da\,.
\displaystyle\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s%
;\theta^{*})\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;%
\theta^{*})}da\leq\log\frac{Z(s;\theta^{*})}{Z^{\prime}(s;\theta^{*})}
\displaystyle\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s%
;\theta^{*})\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;%
\theta^{*})}da
\displaystyle\leq\log\frac{Z(s;\theta^{*})}{Z^{\prime}(s;\theta^{*})}
\displaystyle\leq\frac{1}{Z(s;\theta^{*})}\left|Z(s;\theta^{*})-Z^{\prime}(s;%
\theta^{*})\right|\,,
\displaystyle\leq\frac{1}{Z(s;\theta^{*})}\left|Z(s;\theta^{*})-Z^{\prime}(s;%
\theta^{*})\right|\,,
\log(t)-\log(s)\leq\frac{1}{\min\{t,s\}}\left|t-s\right|
Z^{\prime}(s;\theta^{*})=\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}%
\exp(\Phi(s,a,;\theta^{*})da+C\left|B_{\delta}(\mathcal{D})\right|\,,
\displaystyle\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s%
;\theta^{*})\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;%
\theta^{*})}da\leq\frac{C}{Z(s;\theta^{*})}\ \left|B_{\delta}(\mathcal{D})%
\right|\,.
\displaystyle\int_{\mathcal{A}\setminus B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s%
;\theta^{*})\log\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;%
\theta^{*})}da\leq\frac{C}{Z(s;\theta^{*})}\ \left|B_{\delta}(\mathcal{D})%
\right|\,.
\displaystyle\int_{B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s;\theta^{*})\log%
\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;\theta^{*})}da\leq%
\int_{B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s;\theta^{*})\left|\log{C}-\Phi(s,%
a;\theta^{*})\right|da+\log\frac{Z(s;\theta^{*})}{Z^{\prime}(s;\theta^{*})}
\displaystyle\int_{B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s;\theta^{*})\log%
\frac{\pi^{*}(a\mid s;\theta^{*})}{\widetilde{\pi}(a\mid s;\theta^{*})}da
\displaystyle\leq\int_{B_{\delta}(\mathcal{D})}\pi^{*}(a\mid s;\theta^{*})%
\left|\log{C}-\Phi(s,a;\theta^{*})\right|da+\log\frac{Z(s;\theta^{*})}{Z^{%
\prime}(s;\theta^{*})}
\displaystyle\leq 2\log{C}\left|B_{\delta}(\mathcal{D})\right|+\frac{C}{Z(s;%
\theta^{*})}\left|B_{\delta}(\mathcal{D})\right|\,,
\displaystyle\leq 2\log{C}\left|B_{\delta}(\mathcal{D})\right|+\frac{C}{Z(s;%
\theta^{*})}\left|B_{\delta}(\mathcal{D})\right|\,,
\left|\phi(s,a;\theta^{*})\right|\leq\log{C}
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))\leq 2\log{C}\left|B_{\delta}(\mathcal{D})\right|+%
\frac{2C}{Z(s;\theta^{*})}\left|B_{\delta}(\mathcal{D})\right|\,.
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))\leq 2\log{C}\left|B_{\delta}(\mathcal{D})\right|+%
\frac{2C}{Z(s;\theta^{*})}\left|B_{\delta}(\mathcal{D})\right|\,.
\left|B_{\delta}(\mathcal{D})\right|\leq n\delta
\delta=\mathcal{O}(\varepsilon/n)
d_{\pi}^{\mathsf{wc}}(\pi^{*},\widetilde{\pi})<\varepsilon
L(\theta;\pi,\mathcal{D})
\mathcal{D}
\pi
\theta
\displaystyle L(\theta;\widetilde{\pi},\mathcal{D})=\frac{1}{n}\sum_{t=1}^{n}-%
\log\widetilde{\pi}(a_{t}\mid s_{t};\theta)=\frac{1}{n}\sum_{t=1}^{n}-\log\pi^%
{*}(a_{t}\mid s_{t};\theta)+\log\frac{\pi^{*}(a_{t}\mid s_{t};\theta)}{%
\widetilde{\pi}(a_{t}\mid s_{t};\theta)}
\displaystyle L(\theta;\widetilde{\pi},\mathcal{D})=\frac{1}{n}\sum_{t=1}^{n}-%
\log\widetilde{\pi}(a_{t}\mid s_{t};\theta)
\displaystyle=\frac{1}{n}\sum_{t=1}^{n}-\log\pi^{*}(a_{t}\mid s_{t};\theta)+%
\log\frac{\pi^{*}(a_{t}\mid s_{t};\theta)}{\widetilde{\pi}(a_{t}\mid s_{t};%
\theta)}
\displaystyle=L(\theta;\pi^{*},\mathcal{D})+\frac{1}{n}\sum_{t=1}^{n}\log\frac%
{\pi^{*}(a_{t}\mid s_{t};\theta)}{\widetilde{\pi}(a_{t}\mid s_{t};\theta)}\,.
\displaystyle=L(\theta;\pi^{*},\mathcal{D})+\frac{1}{n}\sum_{t=1}^{n}\log\frac%
{\pi^{*}(a_{t}\mid s_{t};\theta)}{\widetilde{\pi}(a_{t}\mid s_{t};\theta)}\,.
\mathcal{D}
\displaystyle\mathbb{E}_{\mathcal{D}\sim\pi^{*}}\left[\frac{1}{n}\sum_{t=1}^{n%
}\log\frac{\pi^{*}(a_{t}\mid s_{t};\theta)}{\widetilde{\pi}(a_{t}\mid s_{t};%
\theta)}\right]=\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s%
;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]
\displaystyle\mathbb{E}_{\mathcal{D}\sim\pi^{*}}\left[\frac{1}{n}\sum_{t=1}^{n%
}\log\frac{\pi^{*}(a_{t}\mid s_{t};\theta)}{\widetilde{\pi}(a_{t}\mid s_{t};%
\theta)}\right]=\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s%
;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]
\pi^{*}
\theta\in\Theta
\displaystyle L(\theta;\pi^{*},\mathcal{D})\geq L(\theta^{*};\pi^{*},\mathcal{%
D})+\nabla_{\theta}L(\theta^{*};\pi^{*},\mathcal{D})^{\top}(\theta^{*}-\theta)%
+\frac{cn}{2}\|\theta-\theta^{*}\|_{2}^{2}\,.
\displaystyle L(\theta;\pi^{*},\mathcal{D})
\displaystyle\geq L(\theta^{*};\pi^{*},\mathcal{D})+\nabla_{\theta}L(\theta^{*%
};\pi^{*},\mathcal{D})^{\top}(\theta^{*}-\theta)+\frac{cn}{2}\|\theta-\theta^{%
*}\|_{2}^{2}\,.
\theta^{*}
\nabla_{\theta}L(\theta^{*};\pi^{*},\mathcal{D})=\mathbf{0}
\theta=\widetilde{\theta}
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\leq\frac{2}{c}\,\left(L%
(\widetilde{\theta};\pi^{*},\mathcal{D})-L(\theta^{*};\pi^{*},\mathcal{D})%
\right)\,.
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\leq\frac{2}{c}\,\left(L%
(\widetilde{\theta};\pi^{*},\mathcal{D})-L(\theta^{*};\pi^{*},\mathcal{D})%
\right)\,.
\widetilde{\pi}
\pi^{*}
\pi^{*},\widetilde{\pi}
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\leq\frac{2}{c}\,\left(L%
(\theta^{*};\widetilde{\pi},\mathcal{D})-L(\widetilde{\theta};\widetilde{\pi},%
\mathcal{D})\right)\,.
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\leq\frac{2}{c}\,\left(L%
(\theta^{*};\widetilde{\pi},\mathcal{D})-L(\widetilde{\theta};\widetilde{\pi},%
\mathcal{D})\right)\,.
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\leq\frac{2}{c}\,\left(L%
(\theta^{*};\widetilde{\pi},\mathcal{D})-L(\theta^{*};\pi^{*},\mathcal{D})+L(%
\widetilde{\theta};\pi^{*},\mathcal{D})-L(\widetilde{\theta};\widetilde{\pi},%
\mathcal{D})\right)
\displaystyle\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}
\displaystyle\leq\frac{2}{c}\,\left(L(\theta^{*};\widetilde{\pi},\mathcal{D})-%
L(\theta^{*};\pi^{*},\mathcal{D})+L(\widetilde{\theta};\pi^{*},\mathcal{D})-L(%
\widetilde{\theta};\widetilde{\pi},\mathcal{D})\right)
\displaystyle\leq\frac{2}{c}\,\left(\frac{1}{n}\sum_{t=1}^{n}\log\frac{\pi^{*}%
(a_{t}\mid s_{t};\theta^{*})}{\widetilde{\pi}(a_{t}\mid s_{t};\theta^{*})}-%
\frac{1}{n}\sum_{t=1}^{n}\log\frac{\pi^{*}(a_{t}\mid s_{t};\widetilde{\theta})%
}{\widetilde{\pi}(a_{t}\mid s_{t};\widetilde{\theta})}\right)\,
\displaystyle\leq\frac{2}{c}\,\left(\frac{1}{n}\sum_{t=1}^{n}\log\frac{\pi^{*}%
(a_{t}\mid s_{t};\theta^{*})}{\widetilde{\pi}(a_{t}\mid s_{t};\theta^{*})}-%
\frac{1}{n}\sum_{t=1}^{n}\log\frac{\pi^{*}(a_{t}\mid s_{t};\widetilde{\theta})%
}{\widetilde{\pi}(a_{t}\mid s_{t};\widetilde{\theta})}\right)\,
\mathcal{D}
\displaystyle\mathbb{E}\left[\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\right]%
\leq\frac{2}{c}\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*}(\cdot\mid s%
;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))-D_{\text{KL}}(\pi^{%
*}(\cdot\mid s;\widetilde{\theta})\ ||\ \widetilde{\pi}(\cdot\mid s;\widetilde%
{\theta}))\right]
\displaystyle\mathbb{E}\left[\|\widetilde{\theta}-\theta^{*}\|_{2}^{2}\right]
\displaystyle\leq\frac{2}{c}\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*%
}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))-D_{%
\text{KL}}(\pi^{*}(\cdot\mid s;\widetilde{\theta})\ ||\ \widetilde{\pi}(\cdot%
\mid s;\widetilde{\theta}))\right]
\displaystyle\leq\frac{2}{c}\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*%
}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]\,,
\displaystyle\leq\frac{2}{c}\mathbb{E}_{s\sim d^{*}}\left[D_{\text{KL}}(\pi^{*%
}(\cdot\mid s;\theta^{*})\ ||\ \widetilde{\pi}(\cdot\mid s;\theta^{*}))\right]\,,
\widetilde{\pi},\pi^{*}
\widetilde{Q},Q^{*}
s
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))=\mathbb{E}_{a\sim\pi^{*}(\cdot\mid s;\theta^{*})}%
\left[Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})\right]+\log\frac{%
\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}{\sum_{a^{\prime%
}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}\,.
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))=\mathbb{E}_{a\sim\pi^{*}(\cdot\mid s;\theta^{*})}%
\left[Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})\right]+\log\frac{%
\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}{\sum_{a^{\prime%
}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}\,.
a
\displaystyle Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})=\gamma\sum_{%
s^{\prime}}P^{*}(s^{\prime}\mid s,a)V^{*}(s^{\prime};\theta^{*})-\gamma\sum_{s%
^{\prime}}\widetilde{P}(s^{\prime}\mid s,a)\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})
\displaystyle=\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)V^{*}(s^{\prime}%
;\theta^{*})-\gamma\sum_{s^{\prime}}\widetilde{P}(s^{\prime}\mid s,a)%
\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle=\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)V^{*}(s^{\prime}%
;\theta^{*})+\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)\widetilde{V}(s^{%
\prime};\theta^{*})
\displaystyle=\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)V^{*}(s^{\prime}%
;\theta^{*})+\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)\widetilde{V}(s^{%
\prime};\theta^{*})
\displaystyle\qquad-\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)\widetilde%
{V}(s^{\prime};\theta^{*})-\gamma\sum_{s^{\prime}}\widetilde{P}(s^{\prime}\mid
s%
,a)\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle\qquad-\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}\mid s,a)\widetilde%
{V}(s^{\prime};\theta^{*})-\gamma\sum_{s^{\prime}}\widetilde{P}(s^{\prime}\mid
s%
,a)\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle=\gamma\|P^{*}(\cdot\mid s,a)-\widetilde{P}(\cdot\mid s,a)\|_{1}%
\widetilde{V}(s^{\prime};\theta^{*})+\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}%
\mid s,a)(V^{*}(s^{\prime};\theta^{*})-\widetilde{V}(s^{\prime};\theta^{*}))
\displaystyle=\gamma\|P^{*}(\cdot\mid s,a)-\widetilde{P}(\cdot\mid s,a)\|_{1}%
\widetilde{V}(s^{\prime};\theta^{*})+\gamma\sum_{s^{\prime}}P^{*}(s^{\prime}%
\mid s,a)(V^{*}(s^{\prime};\theta^{*})-\widetilde{V}(s^{\prime};\theta^{*}))
\displaystyle\leq\frac{R_{\max}}{1-\gamma}\Delta_{P}+\gamma\sum_{s^{\prime}}P^%
{*}(s^{\prime}\mid s,a)\max_{a^{\prime}}\{Q^{*}(s^{\prime},a^{\prime};\theta^{%
*})-\widetilde{Q}(s^{\prime},a^{\prime};\theta^{*})\}
\displaystyle\leq\frac{R_{\max}}{1-\gamma}\Delta_{P}+\gamma\sum_{s^{\prime}}P^%
{*}(s^{\prime}\mid s,a)\max_{a^{\prime}}\{Q^{*}(s^{\prime},a^{\prime};\theta^{%
*})-\widetilde{Q}(s^{\prime},a^{\prime};\theta^{*})\}
\displaystyle\leq\ldots
\displaystyle\leq\ldots
\displaystyle\leq\frac{R_{\max}}{(1-\gamma)^{2}}\Delta_{P}\,.
\displaystyle\leq\frac{R_{\max}}{(1-\gamma)^{2}}\Delta_{P}\,.
\displaystyle\log\frac{\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta%
^{*}))}{\sum_{a^{\prime}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}\leq\frac{1}{%
\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}\ \sum_{a^{%
\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))\log\frac{\exp(\widetilde{%
Q}(s,a^{\prime};\theta^{*}))}{\exp(Q^{*}(s,a^{\prime};\theta^{*}))}
\displaystyle\log\frac{\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta%
^{*}))}{\sum_{a^{\prime}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}
\displaystyle\leq\frac{1}{\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};%
\theta^{*}))}\ \sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))%
\log\frac{\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}{\exp(Q^{*}(s,a^{\prime%
};\theta^{*}))}
\displaystyle\leq\sum_{a^{\prime}}(\widetilde{Q}(s,a^{\prime};\theta^{*})-Q^{*%
}(s,a^{\prime};\theta^{*}))
\displaystyle\leq\sum_{a^{\prime}}(\widetilde{Q}(s,a^{\prime};\theta^{*})-Q^{*%
}(s,a^{\prime};\theta^{*}))
\displaystyle\leq\frac{|\mathcal{A}|R_{\max}}{(1-\gamma)^{2}}\Delta_{P}\,.
\displaystyle\leq\frac{|\mathcal{A}|R_{\max}}{(1-\gamma)^{2}}\Delta_{P}\,.
s
s
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))=\mathbb{E}_{a\sim\pi^{*}(\cdot\mid s;\theta^{*})}%
\left[Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})\right]+\log\frac{%
\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}{\sum_{a^{\prime%
}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}\,.
\displaystyle D_{\text{KL}}(\pi^{*}(\cdot\mid s;\theta^{*})||\widetilde{\pi}(%
\cdot\mid s;\theta^{*}))=\mathbb{E}_{a\sim\pi^{*}(\cdot\mid s;\theta^{*})}%
\left[Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})\right]+\log\frac{%
\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}{\sum_{a^{\prime%
}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}\,.
a
\displaystyle Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})=\gamma^{*}%
\sum_{s^{\prime}}P(s^{\prime}\mid s,a)V^{*}(s^{\prime};\theta^{*})-\widetilde{%
\gamma}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\widetilde{V}(s^{\prime};\theta^{%
*})
\displaystyle Q^{*}(s,a;\theta^{*})-\widetilde{Q}(s,a;\theta^{*})
\displaystyle=\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)V^{*}(s^{\prime}%
;\theta^{*})-\widetilde{\gamma}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)%
\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle=\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)V^{*}(s^{\prime}%
;\theta^{*})+\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\widetilde{V}(s^{%
\prime};\theta^{*})
\displaystyle=\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)V^{*}(s^{\prime}%
;\theta^{*})+\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\widetilde{V}(s^{%
\prime};\theta^{*})
\displaystyle\qquad-\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\widetilde%
{V}(s^{\prime};\theta^{*})-\widetilde{\gamma}\sum_{s^{\prime}}P(s^{\prime}\mid
s%
,a)\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle\qquad-\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\widetilde%
{V}(s^{\prime};\theta^{*})-\widetilde{\gamma}\sum_{s^{\prime}}P(s^{\prime}\mid
s%
,a)\widetilde{V}(s^{\prime};\theta^{*})
\displaystyle=(\gamma^{*}-\widetilde{\gamma})\sum_{s^{\prime}}P(s^{\prime}\mid
s%
,a)\widetilde{V}(s^{\prime};\theta^{*})+\gamma^{*}\sum_{s^{\prime}}P(s^{\prime%
}\mid s,a)(V^{*}(s^{\prime};\theta^{*})-\widetilde{V}(s^{\prime};\theta^{*}))
\displaystyle=(\gamma^{*}-\widetilde{\gamma})\sum_{s^{\prime}}P(s^{\prime}\mid
s%
,a)\widetilde{V}(s^{\prime};\theta^{*})+\gamma^{*}\sum_{s^{\prime}}P(s^{\prime%
}\mid s,a)(V^{*}(s^{\prime};\theta^{*})-\widetilde{V}(s^{\prime};\theta^{*}))
\displaystyle\leq\frac{R_{\max}}{1-\widetilde{\gamma}}\left|\gamma^{*}-%
\widetilde{\gamma}\right|+\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\max%
_{a^{\prime}}\{Q^{*}(s^{\prime},a^{\prime};\theta^{*})-\widetilde{Q}(s^{\prime%
},a^{\prime};\theta^{*})\}
\displaystyle\leq\frac{R_{\max}}{1-\widetilde{\gamma}}\left|\gamma^{*}-%
\widetilde{\gamma}\right|+\gamma^{*}\sum_{s^{\prime}}P(s^{\prime}\mid s,a)\max%
_{a^{\prime}}\{Q^{*}(s^{\prime},a^{\prime};\theta^{*})-\widetilde{Q}(s^{\prime%
},a^{\prime};\theta^{*})\}
\displaystyle\leq\ldots
\displaystyle\leq\ldots
\displaystyle\leq\frac{R_{\max}}{(1-\widetilde{\gamma})(1-\gamma^{*})}\left|%
\gamma^{*}-\widetilde{\gamma}\right|\,.
\displaystyle\leq\frac{R_{\max}}{(1-\widetilde{\gamma})(1-\gamma^{*})}\left|%
\gamma^{*}-\widetilde{\gamma}\right|\,.
\displaystyle\log\frac{\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta%
^{*}))}{\sum_{a^{\prime}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}\leq\frac{1}{%
\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}\ \sum_{a^{%
\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))\log\frac{\exp(\widetilde{%
Q}(s,a^{\prime};\theta^{*}))}{\exp(Q^{*}(s,a^{\prime};\theta^{*}))}
\displaystyle\log\frac{\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta%
^{*}))}{\sum_{a^{\prime}}\exp(Q^{*}(s,a^{\prime};\theta^{*}))}
\displaystyle\leq\frac{1}{\sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};%
\theta^{*}))}\ \sum_{a^{\prime}}\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))%
\log\frac{\exp(\widetilde{Q}(s,a^{\prime};\theta^{*}))}{\exp(Q^{*}(s,a^{\prime%
};\theta^{*}))}
\displaystyle\leq\sum_{a^{\prime}}(\widetilde{Q}(s,a^{\prime};\theta^{*})-Q^{*%
}(s,a^{\prime};\theta^{*}))
\displaystyle\leq\sum_{a^{\prime}}(\widetilde{Q}(s,a^{\prime};\theta^{*})-Q^{*%
}(s,a^{\prime};\theta^{*}))
\displaystyle\leq\frac{|\mathcal{A}|R_{\max}}{(1-\widetilde{\gamma})(1-\gamma)%
}\left|\widetilde{\gamma}-\gamma^{*}\right|\,.
\displaystyle\leq\frac{|\mathcal{A}|R_{\max}}{(1-\widetilde{\gamma})(1-\gamma)%
}\left|\widetilde{\gamma}-\gamma^{*}\right|\,.
p
p
8\times 4
\theta=3
0
1
p=30\%
\gamma^{*}=0.98
\pi(a\mid s;\theta)\propto\exp(Q(s,a;\theta))
Q(s,a;\theta)
\Theta=[1,4]
64
\mathcal{D}
\pi
w^{\pi}
\rho
w^{\pi}
\displaystyle w^{\pi}(s)=(1-\gamma)\rho(s)+\gamma^{*}\sum_{s^{\prime}\in%
\mathcal{S}}\sum_{a^{\prime}\in\mathcal{A}}w^{\pi}(s^{\prime})\pi(a^{\prime}%
\mid s^{\prime})P(s\mid s^{\prime},a^{\prime})\,.
\displaystyle w^{\pi}(s)=(1-\gamma)\rho(s)+\gamma^{*}\sum_{s^{\prime}\in%
\mathcal{S}}\sum_{a^{\prime}\in\mathcal{A}}w^{\pi}(s^{\prime})\pi(a^{\prime}%
\mid s^{\prime})P(s\mid s^{\prime},a^{\prime})\,.
w^{*}
\pi^{*}
\mathcal{D}
\pi^{*}
\theta\in[0,1]
\pi(a\mid s;\theta)
\theta
8
3
128
\alpha=1
600
1,000
264
\Theta=[0,1]
32
\mathcal{D}
10,000
10
\pi^{*}
p
p
p
\widetilde{\pi}
\pi^{*}
