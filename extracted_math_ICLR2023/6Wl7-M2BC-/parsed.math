k
{\bf x}
{\bf X}
{\bf x}
\ell_{2}
\|{\bf x}\|
\mathcal{N}(\mu;\sigma^{2})
\mu
\sigma^{2}
\operatorname{diag}({\bf x})
{\bf x}
\mathbb{I}_{A}(x)
A
\mathbb{I}_{A}(x)=1
x\in A
0
\mathcal{D}
\{({\bf x}_{i},y_{i}):i=1,\dots,n\}
f({\bf x};{\bf w})
{\bf w}
\mathcal{D}
\mathcal{L}(\mathcal{D};{\bf w})=\frac{1}{n}\sum_{i=1}^{n}\ell(f({\bf x}_{i};{%
\bf w}),y_{i})
\ell(\cdot,\cdot)
\displaystyle\min_{{\bf w}}\max_{\|{\bm{\epsilon}}\|\leq\rho}\mathcal{L}(%
\mathcal{D};{\bf w}+{\bm{\epsilon}}),
\displaystyle\min_{{\bf w}}\max_{\|{\bm{\epsilon}}\|\leq\rho}\mathcal{L}(%
\mathcal{D};{\bf w}+{\bm{\epsilon}}),
\rho>0
\min_{\bf w}\mathcal{L}(\mathcal{D};{\bf w})+\mathcal{R}(\mathcal{D};{\bf w})
\mathcal{R}(\mathcal{D};{\bf w})\equiv\max_{\|{\bm{\epsilon}}\|\leq\rho}%
\mathcal{L}(\mathcal{D};{\bf w}+{\bm{\epsilon}})-\mathcal{L}(\mathcal{D};{\bf w})
\displaystyle{\bf w}_{t+1}={\bf w}_{t}-\eta\nabla\mathcal{L}(\mathcal{B}_{t};{%
\bf w}_{t}+\rho_{t}\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})),
\displaystyle{\bf w}_{t+1}={\bf w}_{t}-\eta\nabla\mathcal{L}(\mathcal{B}_{t};{%
\bf w}_{t}+\rho_{t}\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})),
\mathcal{B}_{t}
\eta
\rho_{t}=\frac{\rho}{\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|}
\mathcal{L}(\mathcal{B}_{t};{\bf w})
{\bf w}_{t}
\mathcal{L}(\mathcal{B}_{t};{\bf w})
{\bf w}_{t}+\rho_{t}\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})
{\bf w}_{t}
k
{\bf w}_{t}
\operatorname{diag}([\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})]^{2})
[{\bf v}]^{2}
{\bf v}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
\operatorname{diag}([\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})]^{2})
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
\operatorname{\textsf{Var}}(\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t}))
\displaystyle\!\!\operatorname{\textsf{Var}}(\nabla\mathcal{L}(\mathcal{B}_{t}%
;{\bf w}_{t}))\!\equiv\!\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(%
\mathcal{B}_{t};{\bf w}_{t})\!-\!\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})\|^%
{2}\!=\!\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w%
}_{t})\|^{2}\!-\!\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})\|^{2}.\!\!
\displaystyle\!\!\operatorname{\textsf{Var}}(\nabla\mathcal{L}(\mathcal{B}_{t}%
;{\bf w}_{t}))\!\equiv\!\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(%
\mathcal{B}_{t};{\bf w}_{t})\!-\!\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})\|^%
{2}\!=\!\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w%
}_{t})\|^{2}\!-\!\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})\|^{2}.\!\!
\mathcal{L}
\mathcal{L}(\mathcal{D};{\bf w})
\nabla\mathcal{L}(\mathcal{D};{\bf w})=0
\operatorname{\textsf{Var}}(\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t}))=%
\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|%
^{2}
{\bf w}_{t}
\mathcal{L}(\mathcal{D};{\bf w})
\operatorname{\textsf{Var}}(\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t}))
\operatorname{\textsf{Var}}(\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t}))
{\bf w}_{t}
\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|%
^{2}
\mathbb{E}_{\mathcal{B}}\|\nabla\mathcal{L}(\mathcal{B};{\bf w}_{t})\|^{2}
\mathbb{E}_{\mathcal{B}}\|\nabla\mathcal{L}(\mathcal{B};{\bf w}_{t})\|^{2}
\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|%
^{2}
t
{\bf w}_{t}
\mathbb{E}_{\mathcal{B}_{t}}\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|%
^{2}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
400
=60
120
180
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
\mathcal{N}(\mu_{t},\sigma_{t}^{2})
\displaystyle\mu_{t}=\delta\mu_{t-1}+(1-\delta)\|\nabla\mathcal{L}(\mathcal{B}%
_{t};{\bf w}_{t})\|^{2},
\displaystyle\mu_{t}
\displaystyle=\delta\mu_{t-1}+(1-\delta)\|\nabla\mathcal{L}(\mathcal{B}_{t};{%
\bf w}_{t})\|^{2},
\displaystyle\sigma_{t}^{2}=\delta\sigma_{t-1}^{2}+(1-\delta)(\|\nabla\mathcal%
{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}-\mu_{t})^{2},
\displaystyle\sigma_{t}^{2}
\displaystyle=\delta\sigma_{t-1}^{2}+(1-\delta)(\|\nabla\mathcal{L}(\mathcal{B%
}_{t};{\bf w}_{t})\|^{2}-\mu_{t})^{2},
\delta\in(0,1)
\delta=0.9
\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})
\{\|\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}:\mathcal{B}_{t}\sim\mathcal%
{D}\}
\{\|\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}:\mathcal{B}_{t}\sim\mathcal%
{D}\}
\mu_{t}
\sigma_{t}^{2}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}\geq\mu_{t}+c_{t}\sigma_%
{t}
c_{t}
c_{t}\to-\infty
c_{t}\to\infty
{\bf w}_{t}
c_{t}
\lambda_{2}
\lambda_{1}
c_{t}=g_{\lambda_{1},\lambda_{2}}(t)\equiv\frac{t}{T}\lambda_{1}+\left(1-\frac%
{t}{T}\right)\lambda_{2}
T
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}\geq\mu_{t}+c_{t}\sigma_%
{t}
{\bf w}_{t}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}<\mu_{t}+c_{t}\sigma_{t}
\mathcal{D}
\eta
\rho
\lambda_{1}
\lambda_{2}
g_{\lambda_{1},\lambda_{2}}(t)
{\bf w}_{0}
\mu_{-1}=0
\sigma_{-1}^{2}=e^{-10}
\alpha
t=0,\dots,T-1
\mathcal{B}_{t}
\mathcal{D}
{\bf g}=\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})
\mu_{t}
\sigma_{t}^{2}
c_{t}=g_{\lambda_{1},\lambda_{2}}(t)
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}\geq\mu_{t}+c_{t}\sigma_%
{t}
{\bf g}_{s}=\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t}+\rho\nabla\mathcal{L%
}(\mathcal{B}_{t};{\bf w}_{t}))
{\bf g}_{s}
{\bf g}_{v}={\bf g}_{s}-\frac{{\bf g}^{\top}{\bf g}_{s}}{\|{\bf g}\|^{2}}{\bf g}
{\bf g}_{s}={\bf g}
{\bf g}_{s}={\bf g}+\alpha\frac{\|{\bf g}\|}{\|{\bf g}_{v}\|}{\bf g}_{v}
{\bf w}_{t+1}={\bf w}_{t}-\eta{\bf g}_{s}
{\bf w}_{T}
\mathcal{A}
\mathcal{L}(\mathcal{D};{\bf w})
\beta
{\bf w}
\|\nabla\mathcal{L}(\mathcal{D};{\bf w})-\nabla\mathcal{L}(\mathcal{D};{\bf v}%
)\|\leq\beta\|{\bf w}-{\bf v}\|
\mathbb{E}_{({\bf x}_{i},y_{i})\sim\mathcal{D}}\|\nabla\ell(f({\bf x}_{i};{\bf
w%
}),y_{i})-\nabla\mathcal{L}(\mathcal{D};{\bf w})\|^{2}\leq\sigma^{2}
\xi_{t}
t
\xi_{t}=1
0
\xi_{t}=\mathbb{I}_{\{{\bf w}:\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w})\|^{%
2}\geq\mu_{t}+c_{t}\sigma_{t}\}}({\bf w}_{t})
\xi_{t}
b
\eta=\frac{1}{4\beta\sqrt{T}}
\rho=\frac{1}{T^{\frac{1}{4}}}
\mathcal{A}
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}\left(7-6\zeta%
\right)}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{b\sqrt{T}\left(7-6\zeta%
\right)},
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}
\displaystyle\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}\left(7-6\zeta%
\right)}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{b\sqrt{T}\left(7-6\zeta%
\right)},
\zeta=\frac{1}{T}\sum_{t=0}^{T-1}\xi_{t}\in[0,1]
\zeta
\zeta=1
\text{\%SAM}\equiv 100\times\text{\#\{iterations using SAM\}}/T
T
128
0.1
0.9
0.0001
300
1200
200
10\%
\rho
\{0.01,0.02,0.05,0.1,0.2,0.5\}
\alpha
\{0.1,0.3,0.6,0.9\}
c_{t}
g_{\lambda_{1},\lambda_{2}}(t)
\lambda_{1}=-1
\lambda_{2}=1
\lambda_{1}=0
\lambda_{2}=2
95.41
\pm 0.03
0.0
\pm 0.0
78.17
\pm 0.05
0.0
\pm 0.0
96.52
\pm 0.12
100.0
\pm 0.0
80.17
\pm 0.15
100.0
\pm 0.0
96.56
\pm 0.08
100.0
\pm 0.0
80.41
\pm 0.10
100.0
\pm 0.0
96.40
\pm 0.16
50.0
\pm 0.0
80.10
\pm 0.16
50.0
\pm 0.0
\underline{\mathbf{96.63}}
\pm 0.04
50.1
\pm 0.1
\underline{\mathbf{80.48}}
\pm 0.11
49.8
\pm 0.0
96.32
\pm 0.12
20.0
\pm 0.0
79.89
\pm 0.29
20.0
\pm 0.0
\underline{96.56}
\pm 0.21
20.0
\pm 0.1
\underline{80.29}
\pm 0.37
20.0
\pm 0.0
96.34
\pm 0.12
0.0
\pm 0.0
81.56
\pm 0.14
0.0
\pm 0.0
97.27
\pm 0.11
100.0
\pm 0.0
83.42
\pm 0.05
100.0
\pm 0.0
97.29
\pm 0.11
100.0
\pm 0.0
\mathbf{84.51}
\pm 0.02
100.0
\pm 0.0
97.09
\pm 0.11
50.0
\pm 0.0
82.89
\pm 0.02
50.0
\pm 0.0
\underline{\mathbf{97.30}}
\pm 0.10
49.5
\pm 0.1
\underline{\mathbf{84.51}}
\pm 0.11
49.6
\pm 0.0
97.02
\pm 0.12
20.0
\pm 0.0
\pm 0.12
20.0
\pm 0.0
\underline{97.15}
\pm 0.08
20.0
\pm 0.0
\underline{83.92}
\pm 0.07
20.2
\pm 0.0
96.62
\pm 0.10
0.0
\pm 0.0
81.89
\pm 0.15
0.0
\pm 0.0
97.30
\pm 0.10
100.0
\pm 0.0
84.46
\pm 0.05
100.0
\pm 0.0
97.81
\pm 0.01
100.0
\pm 0.0
85.56
\pm 0.05
100.0
\pm 0.0
97.22
\pm 0.10
50.0
\pm 0.0
84.90
\pm 0.05
50.0
\pm 0.0
\underline{\mathbf{97.90}}
\pm 0.05
50.2
\pm 0.1
\underline{\mathbf{85.58}}
\pm 0.10
49.8
\pm 0.1
97.10
\pm 0.11
20.0
\pm 0.0
84.01
\pm 0.06
20.0
\pm 0.0
\underline{97.22}
\pm 0.11
20.3
\pm 0.0
\underline{84.80}
\pm 0.13
20.2
\pm 0.1
86.69
\pm 0.11
0.0
\pm 0.0
62.42
\pm 0.22
0.0
\pm 0.0
87.37
\pm 0.09
100.0
\pm 0.0
63.23
\pm 0.25
100.0
\pm 0.0
84.27
\pm 0.11
100.0
\pm 0.0
62.11
\pm 0.15
100.0
\pm 0.0
87.38
\pm 0.14
50.0
\pm 0.0
63.18
\pm 0.19
50.0
\pm 0.0
\mathbf{87.77}
\pm 0.13
49.7
\pm 0.1
63.68
\pm 0.23
49.5
\pm 0.2
87.12
\pm 0.20
20.0
\pm 0.0
63.52
\pm 0.19
20.0
\pm 0.0
87.32
\pm 0.11
20.2
\pm 0.2
\mathbf{64.16}
\pm 0.23
20.3
\pm 0.2
0.5
k=5
50\%
95\%
20\%
1000
1.28
90
0.9
0.0001
0.1
512
\rho=0.05
c_{t}
g_{\lambda_{1},\lambda_{2}}(t)
\lambda_{1}=-1
\lambda_{2}=1
\lambda_{1}=0
\lambda_{2}=2
k=5
77.11
\pm 0.14
0.0
\pm 0.0
\mathbf{77.47}
\pm 0.12
100.0
\pm 0.0
77.25
\pm 0.75
100.0
\pm 0.0
77.38
\pm 0.06
50.0
\pm 0.0
77.43
\pm 0.06
49.4
\pm 0.0
77.13
\pm 0.09
20.0
\pm 0.0
\underline{77.29}
\pm 0.08
20.3
\pm 0.0
200
0.9
0.0001
128
0.1
k=2
k
k=2
\lambda_{1}=-1
\lambda_{2}=1
c_{t}
g_{\lambda_{1},\lambda_{2}}(t)
50\%
80\%
80\%
\text{noise }=20\%
\text{noise }=40\%
\text{noise }=60\%
\text{noise }=80\%
87.92
0.0
70.82
0.0
49.61
0.0
28.23
0.0
\mathbf{94.80}
100.0
91.50
100.0
\mathbf{88.15}
100.0
\mathbf{77.40}
100.0
94.19
100.0
91.46
100.0
81.30
100.0
15.00
100.0
90.62
50.0
77.84
50.0
61.18
50.0
47.32
50.0
92.72
50.0
88.04
50.0
72.26
50.0
69.72
50.0
92.84
50.0
84.17
50.0
73.54
49.9
65.00
50.0
94.34
49.9
\mathbf{91.58}
50.0
87.85
50.0
76.90
50.0
87.43
0.0
70.82
0.0
46.26
0.0
29.00
0.0
\mathbf{95.08}
100.0
91.01
100.0
\mathbf{88.90}
100.0
\mathbf{77.32}
100.0
93.42
100.0
\underline{91.63}
100.0
82.73
100.0
10.09
100.0
89.63
50.0
74.17
50.0
58.40
50.0
59.53
50.0
92.49
50.0
86.56
50.0
63.35
50.0
68.01
50.0
92.87
50.0
82.85
50.0
71.50
50.0
65.43
50.3
94.70
50.0
\mathbf{91.80}
50.0
88.22
50.0
77.03
49.8
80\%
80\%
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
\lambda_{1}\leq\lambda_{2}
\{0,\pm 1,\pm 2\}
\lambda_{2}
\lambda_{1}
c_{t}
\|\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}_{t})\|^{2}\geq\mu_{t}+c_{t}\sigma_%
{t}
\lambda_{2}
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
{\bf w}_{t}
t
\mathcal{L}(\mathcal{D};{\bf w})
\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})\|^{2}
t
\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})\|^{2}
0
b
\eta=\frac{1}{4\beta\sqrt{T}}
\rho=1/T^{\frac{1}{4}}
\mathcal{A}
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}\left(7-6\zeta%
\right)}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{b\sqrt{T}\left(7-6\zeta%
\right)},
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}
\displaystyle\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}\left(7-6\zeta%
\right)}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{b\sqrt{T}\left(7-6\zeta%
\right)},
\zeta=\frac{1}{T}\sum_{t=0}^{T-1}\xi_{t}\in[0,1]
t
\rho>0
\displaystyle\mathbb{E}\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}+\rho\nabla%
\mathcal{L}(\mathcal{B}_{t};{\bf w}))^{\top}\nabla\mathcal{L}(\mathcal{D};{\bf
w%
})\geq\left(\frac{1}{2}-\rho\beta\right)\|\nabla\mathcal{L}(\mathcal{D};{\bf w%
})\|^{2}-\frac{\beta^{2}\rho^{2}\sigma^{2}}{2b}.
\displaystyle\mathbb{E}\nabla\mathcal{L}(\mathcal{B}_{t};{\bf w}+\rho\nabla%
\mathcal{L}(\mathcal{B}_{t};{\bf w}))^{\top}\nabla\mathcal{L}(\mathcal{D};{\bf
w%
})\geq\left(\frac{1}{2}-\rho\beta\right)\|\nabla\mathcal{L}(\mathcal{D};{\bf w%
})\|^{2}-\frac{\beta^{2}\rho^{2}\sigma^{2}}{2b}.
{\bf g}_{t}\equiv\frac{1}{b}\sum_{({\bf x}_{i},y_{i})\in\mathcal{B}_{t}}\nabla%
\ell(f({\bf x}_{i};{\bf w}_{t}),y_{i})
{\bf h}_{t}\equiv\frac{1}{b}\sum_{({\bf x}_{i},y_{i})\in\mathcal{B}_{t}}\nabla%
\ell(f({\bf x}_{i};{\bf w}_{t}+\rho{\bf g}_{t}),y_{i})
\hat{{\bf g}}_{t}\equiv\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})
\mathcal{L}(\mathcal{D};{\bf w})
\beta
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})+\hat{{\bf g}}_{t}^{\top}%
({\bf w}_{t+1}-{\bf w}_{t})+\frac{\beta}{2}\|{\bf w}_{t+1}-{\bf w}_{t}\|^{2}
\displaystyle\leq
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})+\hat{{\bf g}}_{t}^{\top}({%
\bf w}_{t+1}-{\bf w}_{t})+\frac{\beta}{2}\|{\bf w}_{t+1}-{\bf w}_{t}\|^{2}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\hat{{\bf g}}_{t}^{%
\top}\left((1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\right)+\frac{\beta\eta^{2%
}}{2}\|(1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\|^{2}
\displaystyle\leq
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\hat{{\bf g}}_{t}^{\top}%
\left((1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\right)+\frac{\beta\eta^{2}}{2}%
\|(1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\|^{2}
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta(1\!-\!\xi_{t})\hat%
{{\bf g}}_{t}^{\top}{\bf g}_{t}\!-\!\eta\xi_{t}\hat{{\bf g}}_{t}^{\top}{\bf h}%
_{t}\!+\!\frac{\beta\eta^{2}}{2}\!\left(\!(1\!-\!\xi_{t})\|{\bf g}_{t}\|^{2}\!%
+\!\xi_{t}\|{\bf h}_{t}\|^{2}\!+\!\underbrace{2\xi_{t}(1-\xi_{t}){\bf g}_{t}^{%
\top}{\bf h}_{t}}_{=0}\!\right)\!
\displaystyle=
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta(1\!-\!\xi_{t})\hat{%
{\bf g}}_{t}^{\top}{\bf g}_{t}\!-\!\eta\xi_{t}\hat{{\bf g}}_{t}^{\top}{\bf h}_%
{t}\!+\!\frac{\beta\eta^{2}}{2}\!\left(\!(1\!-\!\xi_{t})\|{\bf g}_{t}\|^{2}\!+%
\!\xi_{t}\|{\bf h}_{t}\|^{2}\!+\!\underbrace{2\xi_{t}(1-\xi_{t}){\bf g}_{t}^{%
\top}{\bf h}_{t}}_{=0}\!\right)\!
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta(1-\xi_{t})\hat{{\bf g}%
}_{t}^{\top}{\bf g}_{t}-\eta\xi_{t}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}+\frac{%
\beta\eta^{2}}{2}\left((1-\xi_{t})\|{\bf g}_{t}\|^{2}+\xi_{t}\|{\bf h}_{t}\|^{%
2}\right),
\displaystyle=
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta(1-\xi_{t})\hat{{\bf g}}%
_{t}^{\top}{\bf g}_{t}-\eta\xi_{t}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}+\frac{%
\beta\eta^{2}}{2}\left((1-\xi_{t})\|{\bf g}_{t}\|^{2}+\xi_{t}\|{\bf h}_{t}\|^{%
2}\right),
\xi_{t}(1-\xi_{t})=0
\xi_{t}\in\{0,1\}
\xi_{t}^{2}=\xi_{t}
(1-\xi_{t})^{2}=1-\xi_{t}
{\bf w}_{t}
\displaystyle\!\!\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t+1})\!\leq\!%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta(1\!-\!\xi_{t})\mathbb{%
E}\|\hat{{\bf g}}_{t}\|^{2}\!-\!\eta\xi_{t}\mathbb{E}\hat{{\bf g}}_{t}^{\top}{%
\bf h}_{t}\!+\!\frac{\beta\eta^{2}(1-\xi_{t})}{2}\mathbb{E}\|{\bf g}_{t}\|^{2}%
\!+\!\frac{\beta\eta^{2}\xi_{t}}{2}\mathbb{E}\|{\bf h}_{t}\|^{2}.
\displaystyle\!\!\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t+1})\!\leq\!%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta(1\!-\!\xi_{t})\mathbb{%
E}\|\hat{{\bf g}}_{t}\|^{2}\!-\!\eta\xi_{t}\mathbb{E}\hat{{\bf g}}_{t}^{\top}{%
\bf h}_{t}\!+\!\frac{\beta\eta^{2}(1-\xi_{t})}{2}\mathbb{E}\|{\bf g}_{t}\|^{2}%
\!+\!\frac{\beta\eta^{2}\xi_{t}}{2}\mathbb{E}\|{\bf h}_{t}\|^{2}.
\mathbb{E}\|{\bf g}_{t}\|^{2}\!=\!\mathbb{E}\|{\bf g}_{t}\!-\!\hat{{\bf g}}_{t%
}\|^{2}\!+\!\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}\!=\!\frac{\sigma^{2}}{b}\!+\!%
\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}
\mathbb{E}\|{\bf h}_{t}\|^{2}\leq 2(1+\rho^{2}\beta^{2})\frac{\sigma^{2}}{b}-(%
1-2\rho^{2}\beta^{2})\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g%
}}_{t}^{\top}{\bf h}_{t}
\displaystyle\mathbb{E}\|{\bf h}_{t}\|^{2}=\mathbb{E}\|{\bf h}_{t}-\hat{{\bf g%
}}_{t}\|^{2}-\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^%
{\top}{\bf h}_{t}
\displaystyle\mathbb{E}\|{\bf h}_{t}\|^{2}
\displaystyle=\mathbb{E}\|{\bf h}_{t}-\hat{{\bf g}}_{t}\|^{2}-\mathbb{E}\|\hat%
{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle=2\mathbb{E}\|{\bf h}_{t}-{\bf g}_{t}\|^{2}+2\mathbb{E}\|{\bf g}_%
{t}-\hat{{\bf g}}_{t}\|^{2}-\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}%
\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle=2\mathbb{E}\|{\bf h}_{t}-{\bf g}_{t}\|^{2}+2\mathbb{E}\|{\bf g}_%
{t}-\hat{{\bf g}}_{t}\|^{2}-\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}%
\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle\leq 2\rho^{2}\beta^{2}\mathbb{E}\|{\bf g}_{t}\|^{2}+\frac{2%
\sigma^{2}}{b}-\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t%
}^{\top}{\bf h}_{t}
\displaystyle\leq 2\rho^{2}\beta^{2}\mathbb{E}\|{\bf g}_{t}\|^{2}+\frac{2%
\sigma^{2}}{b}-\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t%
}^{\top}{\bf h}_{t}
\displaystyle\leq 2\rho^{2}\beta^{2}\left(\frac{\sigma^{2}}{b}+\mathbb{E}\|%
\hat{{\bf g}}_{t}\|^{2}\right)+\frac{2\sigma^{2}}{b}-\mathbb{E}\|\hat{{\bf g}}%
_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle\leq 2\rho^{2}\beta^{2}\left(\frac{\sigma^{2}}{b}+\mathbb{E}\|%
\hat{{\bf g}}_{t}\|^{2}\right)+\frac{2\sigma^{2}}{b}-\mathbb{E}\|\hat{{\bf g}}%
_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle=2(1+\rho^{2}\beta^{2})\frac{\sigma^{2}}{b}-(1-2\rho^{2}\beta^{2}%
)\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h%
}_{t},
\displaystyle=2(1+\rho^{2}\beta^{2})\frac{\sigma^{2}}{b}-(1-2\rho^{2}\beta^{2}%
)\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h%
}_{t},
\|{\bf h}_{t}-{\bf g}_{t}\|\leq\rho\beta\|{\bf g}_{t}\|
\displaystyle\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\leq\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-%
\xi_{t}\right)\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}-\eta\xi_{t}\mathbb{E}\hat{{%
\bf g}}_{t}^{\top}{\bf h}_{t}+\frac{\beta\eta^{2}(1-\xi_{t})}{2}\left(\frac{%
\sigma^{2}}{b}+\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}\right)
\displaystyle\leq\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-%
\xi_{t}\right)\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}-\eta\xi_{t}\mathbb{E}\hat{{%
\bf g}}_{t}^{\top}{\bf h}_{t}+\frac{\beta\eta^{2}(1-\xi_{t})}{2}\left(\frac{%
\sigma^{2}}{b}+\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}\right)
\displaystyle\quad\quad+\frac{\beta\eta^{2}\xi_{t}}{2}\left(2(1+\rho^{2}\beta^%
{2})\frac{\sigma^{2}}{b}-(1-2\rho^{2}\beta^{2})\mathbb{E}\|\hat{{\bf g}}_{t}\|%
^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}\right)
\displaystyle\quad\quad+\frac{\beta\eta^{2}\xi_{t}}{2}\left(2(1+\rho^{2}\beta^%
{2})\frac{\sigma^{2}}{b}-(1-2\rho^{2}\beta^{2})\mathbb{E}\|\hat{{\bf g}}_{t}\|%
^{2}+2\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}\right)
\displaystyle=\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\xi_{%
t}-\frac{\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}(1-2\rho^{2}\beta^{2})%
}{2}\right)\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}-\eta\xi_{t}\left(1-\eta\beta%
\right)\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle=\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\xi_{%
t}-\frac{\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}(1-2\rho^{2}\beta^{2})%
}{2}\right)\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}-\eta\xi_{t}\left(1-\eta\beta%
\right)\mathbb{E}\hat{{\bf g}}_{t}^{\top}{\bf h}_{t}
\displaystyle\quad\quad+\left(\frac{\beta\eta^{2}(1-\xi_{t})}{2}+\beta\eta^{2}%
\xi_{t}(1+\rho^{2}\beta^{2})\right)\frac{\sigma^{2}}{b}
\displaystyle\quad\quad+\left(\frac{\beta\eta^{2}(1-\xi_{t})}{2}+\beta\eta^{2}%
\xi_{t}(1+\rho^{2}\beta^{2})\right)\frac{\sigma^{2}}{b}
\displaystyle\leq\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-%
\xi_{t}-\frac{\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}(1-2\rho^{2}\beta%
^{2})}{2}+\xi_{t}\left(1-\eta\beta\right)(\frac{1}{2}-\rho\beta)\right)\mathbb%
{E}\|\hat{{\bf g}}_{t}\|^{2}
\displaystyle\leq\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-%
\xi_{t}-\frac{\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}(1-2\rho^{2}\beta%
^{2})}{2}+\xi_{t}\left(1-\eta\beta\right)(\frac{1}{2}-\rho\beta)\right)\mathbb%
{E}\|\hat{{\bf g}}_{t}\|^{2}
\displaystyle\quad\quad+\left(\frac{\beta\eta^{2}(1-\xi_{t})}{2}+\beta\eta^{2}%
\xi_{t}(1+\rho^{2}\beta^{2})+\eta\xi_{t}\left(1-\eta\beta\right)\frac{\beta^{2%
}\rho^{2}}{2}\right)\frac{\sigma^{2}}{b}
\displaystyle\quad\quad+\left(\frac{\beta\eta^{2}(1-\xi_{t})}{2}+\beta\eta^{2}%
\xi_{t}(1+\rho^{2}\beta^{2})+\eta\xi_{t}\left(1-\eta\beta\right)\frac{\beta^{2%
}\rho^{2}}{2}\right)\frac{\sigma^{2}}{b}
\displaystyle\leq\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-(1%
+\beta\eta-2\rho\beta)\frac{\xi_{t}}{2}-\frac{\beta\eta}{2}\right)\mathbb{E}\|%
\hat{{\bf g}}_{t}\|^{2}
\displaystyle\leq\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-(1%
+\beta\eta-2\rho\beta)\frac{\xi_{t}}{2}-\frac{\beta\eta}{2}\right)\mathbb{E}\|%
\hat{{\bf g}}_{t}\|^{2}
\displaystyle\quad\quad+\left(\eta+\xi_{t}(\eta+2\eta\rho^{2}\beta^{2}+\beta%
\rho^{2}-\eta\beta^{2}\rho^{2})\right)\frac{\eta\beta\sigma^{2}}{2b},
\displaystyle\quad\quad+\left(\eta+\xi_{t}(\eta+2\eta\rho^{2}\beta^{2}+\beta%
\rho^{2}-\eta\beta^{2}\rho^{2})\right)\frac{\eta\beta\sigma^{2}}{2b},
1-\eta\beta>0
\eta<\frac{1}{4\beta}
1+\beta\eta-2\rho\beta\leq 3/2
\beta\eta<1/4
1-(1+\beta\eta-2\rho\beta)\frac{\xi_{t}}{2}-\frac{\beta\eta}{2}>0
t
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}\leq%
\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}(\mathcal{D};{%
\bf w}_{T})}{\eta\sum_{t=0}^{T-1}\left(1-(1+\beta\eta-2\rho\beta)\frac{\xi_{t}%
}{2}-\frac{\beta\eta}{2}\right)}
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}
\displaystyle\leq\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal%
{L}(\mathcal{D};{\bf w}_{T})}{\eta\sum_{t=0}^{T-1}\left(1-(1+\beta\eta-2\rho%
\beta)\frac{\xi_{t}}{2}-\frac{\beta\eta}{2}\right)}
\displaystyle\quad+\frac{\sum_{t=0}^{T-1}\left(\eta+\xi_{t}(\eta+\eta\rho^{2}%
\beta^{2}+\beta\rho^{2})\right)}{\sum_{t=0}^{T-1}\left(1-(1+\beta\eta-2\rho%
\beta)\frac{\xi_{t}}{2}-\frac{\beta\eta}{2}\right)}\frac{\beta\sigma^{2}}{2b}
\displaystyle\quad+\frac{\sum_{t=0}^{T-1}\left(\eta+\xi_{t}(\eta+\eta\rho^{2}%
\beta^{2}+\beta\rho^{2})\right)}{\sum_{t=0}^{T-1}\left(1-(1+\beta\eta-2\rho%
\beta)\frac{\xi_{t}}{2}-\frac{\beta\eta}{2}\right)}\frac{\beta\sigma^{2}}{2b}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}%
(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}%
+\frac{T(\eta+\eta\kappa\zeta+\beta\rho^{2}\zeta)\beta\sigma^{2}}{2bT(1-\frac{%
\gamma\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}%
(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}%
+\frac{T(\eta+\eta\kappa\zeta+\beta\rho^{2}\zeta)\beta\sigma^{2}}{2bT(1-\frac{%
\gamma\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}%
(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}%
+\frac{(1+\kappa\zeta+4\beta^{2}\zeta)\eta\beta\sigma^{2}}{2b(1-\frac{\gamma%
\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}%
(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}%
+\frac{(1+\kappa\zeta+4\beta^{2}\zeta)\eta\beta\sigma^{2}}{2b(1-\frac{\gamma%
\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}%
(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}%
+\frac{(1+\kappa\zeta+4\beta^{2}\zeta)\sigma^{2}}{8b\sqrt{T}(1-\frac{\gamma%
\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}%
(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}%
+\frac{(1+\kappa\zeta+4\beta^{2}\zeta)\sigma^{2}}{8b\sqrt{T}(1-\frac{\gamma%
\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}\left(7-6\zeta%
\right)}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{b\sqrt{T}\left(7-6\zeta%
\right)},
\displaystyle\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}\left(7-6\zeta%
\right)}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{b\sqrt{T}\left(7-6\zeta%
\right)},
\gamma=1+\beta\eta-2\rho\beta\leq 3/2
\kappa=1+\rho^{2}\beta^{2}
\rho^{2}=1/\sqrt{T}
\zeta=\frac{1}{T}\sum_{t=0}^{T-1}\xi_{t}\in[0,1]
b
\eta=\frac{1}{4\beta\sqrt{T}}
\rho=1/T^{\frac{1}{4}}
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}}+\frac{(2+5%
\beta^{2})\sigma^{2}}{b\sqrt{T}}.
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}
\displaystyle\leq\frac{32\beta\left(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T})\right)}{\sqrt{T}}+\frac{(2+5%
\beta^{2})\sigma^{2}}{b\sqrt{T}}.
b
\eta=\frac{\sqrt{b}}{4\beta\sqrt{T}}
\rho=1/T^{\frac{1}{4}}
\mathcal{A}
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}\leq\frac{32\beta(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T}))}{\sqrt{Tb}(7-6\zeta)}+\frac{(1%
+\zeta+5\beta^{2}\zeta)\sigma^{2}}{\sqrt{Tb}(7-6\zeta)},
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\nabla\mathcal{L}(\mathcal{D};{%
\bf w}_{t})\|^{2}\leq\frac{32\beta(\mathcal{L}(\mathcal{D};{\bf w}_{0})-%
\mathbb{E}\mathcal{L}(\mathcal{D};{\bf w}_{T}))}{\sqrt{Tb}(7-6\zeta)}+\frac{(1%
+\zeta+5\beta^{2}\zeta)\sigma^{2}}{\sqrt{Tb}(7-6\zeta)},
\zeta=\frac{1}{T}\sum_{t=0}^{T-1}\xi_{t}\in[0,1]
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}\leq%
\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal{L}(\mathcal{D};{%
\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2})}+\frac{\eta%
\beta(1+\kappa\zeta+4\beta^{2}\zeta)\sigma^{2}}{2b(1-\frac{\gamma\zeta}{2}-%
\frac{\beta\eta}{2})}
\displaystyle\min_{0\leq t\leq T-1}\mathbb{E}\|\hat{{\bf g}}_{t}\|^{2}
\displaystyle\leq\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}\mathcal%
{L}(\mathcal{D};{\bf w}_{T})}{T\eta(1-\frac{\gamma\zeta}{2}-\frac{\beta\eta}{2%
})}+\frac{\eta\beta(1+\kappa\zeta+4\beta^{2}\zeta)\sigma^{2}}{2b(1-\frac{%
\gamma\zeta}{2}-\frac{\beta\eta}{2})}
\displaystyle\leq\frac{4\beta(\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}%
\mathcal{L}(\mathcal{D};{\bf w}_{T}))}{\sqrt{Tb}(\frac{7}{8}-\frac{3}{4}\zeta)%
}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{8\sqrt{Tb}(\frac{7}{8}-\frac{3%
\zeta}{4})}
\displaystyle\leq\frac{4\beta(\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}%
\mathcal{L}(\mathcal{D};{\bf w}_{T}))}{\sqrt{Tb}(\frac{7}{8}-\frac{3}{4}\zeta)%
}+\frac{(1+\zeta+5\beta^{2}\zeta)\sigma^{2}}{8\sqrt{Tb}(\frac{7}{8}-\frac{3%
\zeta}{4})}
\displaystyle=\frac{32\beta(\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}%
\mathcal{L}(\mathcal{D};{\bf w}_{T}))}{\sqrt{Tb}(7-6\zeta)}+\frac{(1+\zeta+5%
\beta^{2}\zeta)\sigma^{2}}{\sqrt{Tb}(7-6\zeta)}.
\displaystyle=\frac{32\beta(\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathbb{E}%
\mathcal{L}(\mathcal{D};{\bf w}_{T}))}{\sqrt{Tb}(7-6\zeta)}+\frac{(1+\zeta+5%
\beta^{2}\zeta)\sigma^{2}}{\sqrt{Tb}(7-6\zeta)}.
\rho<\frac{1}{2\beta}
\eta<\frac{1}{\beta}
\mathcal{A}
\displaystyle\min_{0\leq t\leq T-1}\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t}%
)\|^{2}\leq\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathcal{L}(\mathcal{D};%
{\bf w}_{T})}{T\eta\left(1-\frac{\beta\eta}{2}-\beta\rho\zeta\right)},
\displaystyle\min_{0\leq t\leq T-1}\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t}%
)\|^{2}\leq\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathcal{L}(\mathcal{D};%
{\bf w}_{T})}{T\eta\left(1-\frac{\beta\eta}{2}-\beta\rho\zeta\right)},
\zeta=\frac{1}{T}\sum_{t=0}^{T-1}\xi_{t}\in[0,1]
\mathcal{L}(\mathcal{D};{\bf w})
\beta
\rho>0
\displaystyle\nabla\mathcal{L}(\mathcal{D};{\bf w})^{\top}\nabla\mathcal{L}(%
\mathcal{D};{\bf w}+\rho\nabla\mathcal{L}(\mathcal{D};{\bf w}))\geq(1-\rho%
\beta)\|\nabla\mathcal{L}(\mathcal{D};{\bf w})\|^{2}.
\displaystyle\nabla\mathcal{L}(\mathcal{D};{\bf w})^{\top}\nabla\mathcal{L}(%
\mathcal{D};{\bf w}+\rho\nabla\mathcal{L}(\mathcal{D};{\bf w}))\geq(1-\rho%
\beta)\|\nabla\mathcal{L}(\mathcal{D};{\bf w})\|^{2}.
{\bf g}_{t}\equiv\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t})
{\bf h}_{t}\equiv\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t}+\rho\nabla\mathcal{%
L}(\mathcal{D};{\bf w}_{t}))
\mathcal{L}(\mathcal{D};{\bf w})
\beta
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})+{\bf g}_{t}^{\top}({\bf w%
}_{t+1}-{\bf w}_{t})+\frac{\beta}{2}\|{\bf w}_{t+1}-{\bf w}_{t}\|^{2}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})+{\bf g}_{t}^{\top}({\bf w%
}_{t+1}-{\bf w}_{t})+\frac{\beta}{2}\|{\bf w}_{t+1}-{\bf w}_{t}\|^{2}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta{\bf g}_{t}^{\top}%
\left((1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\right)+\frac{\beta\eta^{2}}{2}%
\|(1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\|^{2}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta{\bf g}_{t}^{\top}%
\left((1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\right)+\frac{\beta\eta^{2}}{2}%
\|(1-\xi_{t}){\bf g}_{t}+\xi_{t}{\bf h}_{t}\|^{2}
\displaystyle=\!\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta(1\!-\!\xi_{t})\|%
{\bf g}_{t}\|^{2}\!-\!\eta\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t}\!+\!\frac{\beta%
\eta^{2}}{2}\!\!\left(\!(1\!-\!\xi_{t})\|{\bf g}_{t}\|^{2}\!+\!\xi_{t}\|{\bf h%
}_{t}\|^{2}\!+\!\underbrace{2\xi_{t}(1\!-\!\xi_{t}){\bf g}_{t}^{\top}{\bf h}_{%
t}}_{=0}\!\right)\!
\displaystyle=\!\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta(1\!-\!\xi_{t})\|%
{\bf g}_{t}\|^{2}\!-\!\eta\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t}\!+\!\frac{\beta%
\eta^{2}}{2}\!\!\left(\!(1\!-\!\xi_{t})\|{\bf g}_{t}\|^{2}\!+\!\xi_{t}\|{\bf h%
}_{t}\|^{2}\!+\!\underbrace{2\xi_{t}(1\!-\!\xi_{t}){\bf g}_{t}^{\top}{\bf h}_{%
t}}_{=0}\!\right)\!
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\xi_{t}-\frac{%
\beta\eta(1-\xi_{t})}{2}\right)\|{\bf g}_{t}\|^{2}+\frac{\beta\eta^{2}\xi_{t}}%
{2}\|{\bf h}_{t}\|^{2}-\eta\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t},
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\xi_{t}-\frac{%
\beta\eta(1-\xi_{t})}{2}\right)\|{\bf g}_{t}\|^{2}+\frac{\beta\eta^{2}\xi_{t}}%
{2}\|{\bf h}_{t}\|^{2}-\eta\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t},
\xi_{t}(1-\xi_{t})=0
\xi_{t}\in\{0,1\}
\xi_{t}^{2}=\xi_{t}
(1-\xi_{t})^{2}=1-\xi_{t}
\|{\bf h}_{t}\|^{2}=\|{\bf h}_{t}-{\bf g}_{t}\|^{2}-\|{\bf g}_{t}\|^{2}+2{\bf g%
}_{t}^{\top}{\bf h}_{t}
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t+1})
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta\left(\!1\!-\!\xi_{%
t}-\frac{\beta\eta(1-\xi_{t})}{2}\!\right)\!\|{\bf g}_{t}\|^{2}\!+\!\frac{%
\beta\eta^{2}\xi_{t}}{2}\left(\|{\bf h}_{t}\!-\!{\bf g}_{t}\|^{2}\!-\!\|{\bf g%
}_{t}\|^{2}+2{\bf g}_{t}^{\top}{\bf h}_{t}\right)\!-\!\eta\xi_{t}{\bf g}_{t}^{%
\top}{\bf h}_{t}
\displaystyle=
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta\left(\!1\!-\!\xi_{t%
}-\frac{\beta\eta(1-\xi_{t})}{2}\!\right)\!\|{\bf g}_{t}\|^{2}\!+\!\frac{\beta%
\eta^{2}\xi_{t}}{2}\left(\|{\bf h}_{t}\!-\!{\bf g}_{t}\|^{2}\!-\!\|{\bf g}_{t}%
\|^{2}+2{\bf g}_{t}^{\top}{\bf h}_{t}\right)\!-\!\eta\xi_{t}{\bf g}_{t}^{\top}%
{\bf h}_{t}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta\left(\!1\!-\!%
\xi_{t}\!-\!\frac{\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}}{2}\right)\|%
{\bf g}_{t}\|^{2}+\frac{\beta\eta^{2}\xi_{t}}{2}\|{\bf h}_{t}-{\bf g}_{t}\|^{2%
}-\eta(1-\beta\eta)\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t}
\displaystyle\leq
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta\left(\!1\!-\!\xi_{t%
}\!-\!\frac{\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}}{2}\right)\|{\bf g%
}_{t}\|^{2}+\frac{\beta\eta^{2}\xi_{t}}{2}\|{\bf h}_{t}-{\bf g}_{t}\|^{2}-\eta%
(1-\beta\eta)\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta\!\left(\!1\!-\!%
\xi_{t}\!-\!\frac{\beta\eta(1\!-\!\xi_{t})}{2}\!+\!\frac{\beta\eta\xi_{t}}{2}%
\right)\|{\bf g}_{t}\|^{2}+\frac{\beta^{3}\eta^{2}\rho^{2}\xi_{t}}{2}\|{\bf g}%
_{t}\|^{2}-\eta(1-\beta\eta)\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t}
\displaystyle\leq
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})\!-\!\eta\!\left(\!1\!-\!\xi_%
{t}\!-\!\frac{\beta\eta(1\!-\!\xi_{t})}{2}\!+\!\frac{\beta\eta\xi_{t}}{2}%
\right)\|{\bf g}_{t}\|^{2}+\frac{\beta^{3}\eta^{2}\rho^{2}\xi_{t}}{2}\|{\bf g}%
_{t}\|^{2}-\eta(1-\beta\eta)\xi_{t}{\bf g}_{t}^{\top}{\bf h}_{t}
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\xi_{t}-\frac{%
\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}}{2}+\frac{\beta^{3}\eta\rho^{2%
}\xi_{t}}{2}+(1-\beta\eta)(1-\beta\rho)\xi_{t}\right)\|{\bf g}_{t}\|^{2}
\displaystyle=
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\xi_{t}-\frac{%
\beta\eta(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}}{2}+\frac{\beta^{3}\eta\rho^{2%
}\xi_{t}}{2}+(1-\beta\eta)(1-\beta\rho)\xi_{t}\right)\|{\bf g}_{t}\|^{2}
\displaystyle=\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\frac{\beta\eta%
(1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}}{2}+\frac{\beta^{3}\eta\xi_{t}\rho^{2}}%
{2}-\beta\eta\xi_{t}-\beta\rho\xi_{t}+\beta^{2}\eta\rho\xi_{t}\right)\|{\bf g}%
_{t}\|^{2}
\displaystyle=
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\frac{\beta\eta(%
1-\xi_{t})}{2}+\frac{\beta\eta\xi_{t}}{2}+\frac{\beta^{3}\eta\xi_{t}\rho^{2}}{%
2}-\beta\eta\xi_{t}-\beta\rho\xi_{t}+\beta^{2}\eta\rho\xi_{t}\right)\|{\bf g}_%
{t}\|^{2}
\displaystyle\leq\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\frac{\beta%
\eta}{2}-\beta\rho\xi_{t}\right)\|{\bf g}_{t}\|^{2},
\displaystyle\leq
\displaystyle\mathcal{L}(\mathcal{D};{\bf w}_{t})-\eta\left(1-\frac{\beta\eta}%
{2}-\beta\rho\xi_{t}\right)\|{\bf g}_{t}\|^{2},
\|{\bf h}_{t}-{\bf g}_{t}\|^{2}=\|\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t}+%
\rho\nabla\mathcal{L}(\mathcal{D};{\bf w}_{t}))-\nabla\mathcal{L}(\mathcal{D};%
{\bf w}_{t})\|^{2}\leq\beta^{2}\rho^{2}\|\nabla\mathcal{L}(\mathcal{D};{\bf w}%
_{t})\|^{2}=\beta^{2}\rho^{2}\|{\bf g}_{t}\|^{2}
t
t=0
T-1
\displaystyle\sum_{t=0}^{T-1}\eta\left(1-\frac{\beta\eta}{2}-\beta\rho\xi_{t}%
\right)\|{\bf g}_{t}\|^{2}\leq\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathcal{L}%
(\mathcal{D};{\bf w}_{T}).
\displaystyle\sum_{t=0}^{T-1}\eta\left(1-\frac{\beta\eta}{2}-\beta\rho\xi_{t}%
\right)\|{\bf g}_{t}\|^{2}\leq\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathcal{L}%
(\mathcal{D};{\bf w}_{T}).
\rho<\frac{1}{2\beta}
\eta<\frac{1}{\beta}
1-\frac{\beta\eta}{2}-\beta\rho\xi_{t}>0
t
\displaystyle\min_{0\leq t\leq T-1}\|{\bf g}_{t}\|^{2}\leq\frac{\mathcal{L}(%
\mathcal{D};{\bf w}_{0})-\mathcal{L}(\mathcal{D};{\bf w}_{T})}{\sum_{t=0}^{T-1%
}\eta\left(1-\frac{\beta\eta}{2}-\xi_{t}\beta\rho\right)}=\frac{\mathcal{L}(%
\mathcal{D};{\bf w}_{0})-\mathcal{L}(\mathcal{D};{\bf w}_{T})}{T\eta\left(1-%
\frac{\beta\eta}{2}-\beta\rho\zeta\right)},
\displaystyle\min_{0\leq t\leq T-1}\|{\bf g}_{t}\|^{2}\leq\frac{\mathcal{L}(%
\mathcal{D};{\bf w}_{0})-\mathcal{L}(\mathcal{D};{\bf w}_{T})}{\sum_{t=0}^{T-1%
}\eta\left(1-\frac{\beta\eta}{2}-\xi_{t}\beta\rho\right)}
\displaystyle=\frac{\mathcal{L}(\mathcal{D};{\bf w}_{0})-\mathcal{L}(\mathcal{%
D};{\bf w}_{T})}{T\eta\left(1-\frac{\beta\eta}{2}-\beta\rho\zeta\right)},
\zeta=\frac{1}{T}\sum_{t=0}^{T-1}\xi_{t}\in[0,1]
k
k
k\in\{2,3,4,5\}
k=2
k\in\{3,4,5\}
80\%
k
k
\text{noise }=20\%
\text{noise }=40\%
\text{noise }=60\%
\text{noise }=80\%
k
\mathbf{92.72}
50.0
\mathbf{88.04}
50.0
\mathbf{72.26}
50.0
\mathbf{69.72}
50.0
89.07
33.3
75.38
33.3
63.79
33.3
53.87
33.3
89.00
25.0
74.12
25.0
58.17
25.0
52.28
25.0
88.57
20.0
73.90
20.0
56.80
20.0
51.82
20.0
20\%
40\%
60\%
80\%
20\%,40\%
60\%
80\%
20\%,40\%
60\%
80\%
20\%,40\%
60\%
80\%
20\%,40\%
60\%
80\%
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
80\%
\lambda_{1}
\lambda_{2}
\lambda_{2}
\lambda_{1}
\lambda_{1}
\lambda_{2}
\lambda_{1}
\lambda_{2}
80\%
\lambda_{1}
\lambda_{2}
80\%
\lambda_{1}
\lambda_{2}
80\%
\lambda_{2}\in\{-2,-1\}
\lambda_{2}=1
\lambda_{1}
\lambda_{2}
80\%
\lambda_{2}\in\{-2,-1\}
\lambda_{2}=1
