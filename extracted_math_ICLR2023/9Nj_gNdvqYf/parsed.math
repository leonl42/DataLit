\mathcal{O}(1/\sqrt{T})
T
\mathcal{P}
k_{0}
k
R
u
\mathcal{S}=\emptyset
\mathcal{S}_{0}\leftarrow
k_{0}
\mathcal{P}
\mathcal{S}=\{({\textrm{x}},y,1):({\textrm{x}},y)\in\mathcal{S}_{0}\}
\mathcal{P}=\mathcal{P}\backslash\mathcal{S}_{0}
r=1,2,\ldots,R
\mathcal{S}_{r}=\emptyset
f_{r},g_{r}
\mathcal{S}
|\mathcal{S}_{r}|<k
({\textrm{x}},y)
\mathcal{P}
p({\textrm{x}},y)
Q\sim\textrm{Bernoulli}(p({\textrm{x}},y))
Q=1
\mathcal{S}_{r}=\mathcal{S}_{r}\cup\left\{{\left({{\textrm{x}},y,\min\left({%
\frac{1}{p({\textrm{x}},y)},u}\right)}\right)}\right\}
\mathcal{P}=\mathcal{P}\backslash\left\{{\left({{\textrm{x}},y}\right)}\right\}
\mathcal{S}=\mathcal{S}\cup\mathcal{S}_{r}
f_{R+1}
\mathcal{S}
\mathcal{S},f_{R+1}
\mathcal{X}\in\mathbb{R}^{d}
\mathcal{Y}=\{1,\ldots,c\}
({\textrm{x}},y)
\mathcal{D}
\mathcal{X}\times\mathcal{Y}
\mathcal{H}=\{h:\mathcal{X}\rightarrow\mathcal{Z}\}
\mathcal{X}
\mathcal{Z}\subset\mathbb{R}^{\mathcal{Y}}
\ell:\mathcal{Z}\times\mathcal{Y}\rightarrow\mathbb{R}
\mathcal{S}_{0}
|\mathcal{S}_{0}|=k_{0}
\mathcal{P}
r\in[1,\ldots,R]
r
f_{r}=\arg\min_{h\in\mathcal{H}}\sum_{({\textrm{x}},y,w)\in\mathcal{S}}w\cdot%
\ell(h({\textrm{x}}),y)
\mathcal{S}
r-1
f_{r},g_{r}
\mathcal{S}
r
({\textrm{x}},y)\in\mathcal{S}
({\textrm{x}},y)
\displaystyle p({\textrm{x}},y)=\left|{\textrm{P}_{f_{r}}(y|{\textrm{x}})\log{%
\textrm{P}_{f_{r}}(y|{\textrm{x}})}-\textrm{P}_{g_{r}}(y|{\textrm{x}})\log{%
\textrm{P}_{g_{r}}(y|{\textrm{x}})}}\right|
\displaystyle p({\textrm{x}},y)=\left|{\textrm{P}_{f_{r}}(y|{\textrm{x}})\log{%
\textrm{P}_{f_{r}}(y|{\textrm{x}})}-\textrm{P}_{g_{r}}(y|{\textrm{x}})\log{%
\textrm{P}_{g_{r}}(y|{\textrm{x}})}}\right|
\textrm{P}_{f_{r}}(y|{\textrm{x}})
y
f_{r}
f_{r},g_{r}
({\textrm{x}},y)
p({\textrm{x}},y)
f_{r}
\displaystyle p({\textrm{x}},\cdot)=-\sum_{y^{\prime}\in\mathcal{Y}}\textrm{P}%
_{f_{r}}(y^{\prime}|{\textrm{x}})\log_{2}{\textrm{P}_{f_{r}}(y^{\prime}|{%
\textrm{x}})}/\log_{2}{|\mathcal{Y}|}.
\displaystyle p({\textrm{x}},\cdot)=-\sum_{y^{\prime}\in\mathcal{Y}}\textrm{P}%
_{f_{r}}(y^{\prime}|{\textrm{x}})\log_{2}{\textrm{P}_{f_{r}}(y^{\prime}|{%
\textrm{x}})}/\log_{2}{|\mathcal{Y}|}.
p({\textrm{x}},\cdot)
\textrm{P}_{f_{r}}(y^{\prime}|{\textrm{x}})
1/|\mathcal{Y}|
\mathcal{Y}
y
\mathcal{S}
Q
p({\textrm{x}},y)
w
\frac{1}{p({\textrm{x}},y)}
\mathcal{P}=\mathcal{P}\backslash\left\{{\left({{\textrm{x}},y}\right)}\right\}
k
\frac{1}{|\mathcal{P}|}\sum_{i\in\mathcal{P}}\frac{Q_{i}}{p({\textrm{x}}_{i},y%
_{i})}\ell(f({\textrm{x}}_{i}),y_{i})
\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}[\ell(f({\textrm{x}}),y)]
\textrm{P}_{f_{r}}(y|{\textrm{x}})
p({\textrm{x}},y)
u
k
s({\textrm{x}})
\textrm{P}_{f}[\hat{y}|{\textrm{x}}]
\hat{y}
f
s({\textrm{x}})=1-(\textrm{P}_{f}[\hat{y}_{1}|{\textrm{x}}]-\textrm{P}_{f}[%
\hat{y}_{2}|{\textrm{x}}])
\hat{y}_{1}=\operatorname*{argmax}_{y\in\mathcal{Y}}\textrm{P}_{f}[y|{\textrm{%
x}}],\hat{y}_{2}=\operatorname*{argmax}_{y\in\mathcal{Y}\backslash y_{1}}%
\textrm{P}_{f}[y|{\textrm{x}}]
f
s({\textrm{x}})=-\sum_{y\in\mathcal{Y}}\textrm{P}_{f}(\hat{y}|{\textrm{x}})%
\log(\textrm{P}_{f}(\hat{y}|{\textrm{x}}))
s({\textrm{x}})=1-\max_{y\in\mathcal{Y}}\textrm{P}_{f}(\hat{y}|{\textrm{x}})
k
k
k
k
k
k
\{0.001,0.002,0.005,0.01,0.1\}
r
\mathcal{O}\left({dkT}\right)
d=4096\times 100
T
k
k/100
r
k
k
10^{-4}
5\times 10^{8}
p({\textrm{x}},\cdot)=-\textrm{P}_{f_{r}}(y|{\textrm{x}})\log_{2}{\textrm{P}_{%
f_{r}}(y|{\textrm{x}})}-\left({1-\textrm{P}_{f_{r}}(y|{\textrm{x}})}\right)%
\log_{2}\left({1-\textrm{P}_{f_{r}}(y|{\textrm{x}})}\right)
\textrm{P}_{f_{r}}(y|{\textrm{x}})
r
r
T
L(h)=\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}[\ell(h({\textrm{x}}),y)]
h\in\mathcal{H}
h^{*}=\operatorname*{argmin}_{h\in\mathcal{H}}L(h)
\ell:\mathcal{Z}\times\mathcal{Y}\rightarrow[0,1]
[0,1]
\mathcal{H}
({\textrm{x}}_{1},y_{1}),({\textrm{x}}_{2},y_{2}),\ldots,({\textrm{x}}_{T},y_{%
T})
\mathcal{D}
\mathcal{H}_{t}
t
\mathcal{H}_{1}=\mathcal{H}
t
Q_{t}\in\left\{{0,1}\right\}
p_{t}
\displaystyle p_{t}=\max_{f,g\in\mathcal{H}_{t}}\ell(f({\textrm{x}}_{t}),y_{t}%
)-\ell(g({\textrm{x}}_{t}),y_{t})
\displaystyle p_{t}=\max_{f,g\in\mathcal{H}_{t}}\ell(f({\textrm{x}}_{t}),y_{t}%
)-\ell(g({\textrm{x}}_{t}),y_{t})
\mathcal{H}_{t}=\left\{{h\in\mathcal{H}_{t-1}:\frac{1}{t}\sum_{s=1}^{t}\frac{Q%
_{s}}{p_{s}}\ell(h({\textrm{x}}_{s}),y_{s})\leq\min_{h^{\prime}\in\mathcal{H}_%
{t-1}}\frac{1}{t}\sum_{s=1}^{t}\frac{Q_{s}}{p_{s}}\ell(h^{\prime}({\textrm{x}}%
_{s}),y_{s})+\Delta_{t-1}}\right\}
\Delta_{t-1}=\sqrt{\frac{8\log(2T(T+1)|\mathcal{H}|^{2}/\delta)}{t-1}}
Q_{t}=1
f,g
\min_{h\in\mathcal{H}_{t-1}}\frac{1}{t}\sum_{s=1}^{t}\frac{Q_{s}}{p_{s}}\ell(h%
({\textrm{x}}_{s}),y_{s})
f,g\in\mathcal{H}_{t}
y\in\mathcal{Y}
p_{t}
f
g
\mathcal{H}_{t}
\mathcal{P}=\{({\textrm{x}}_{i},y_{i})\}_{i=1}^{T}\sim\mathcal{D}^{T}
m<T
\mathcal{S}=\{({\textrm{x}}^{\prime}_{i},y^{\prime}_{i})\}_{i=1}^{m}
w_{1},\ldots,w_{m}
\epsilon>0
h\in\mathcal{H}
\left|\sum_{i=1}^{m}w_{i}\ell(h({\textrm{x}}_{i}^{\prime}),y_{i}^{\prime})-%
\sum_{i=1}^{T}\ell(h({\textrm{x}}_{i}),y_{i})\right|\leq\epsilon T
h^{\prime}=\operatorname*{argmin}_{h\in\mathcal{H}}\sum_{i=1}^{m}w_{i}\ell(h({%
\textrm{x}}_{i}^{\prime}),y_{i}^{\prime})
\epsilon>0
\delta>0
1-\delta
L(h^{\prime})\leq L(h^{*})+2\epsilon+2\sqrt{\ln(4/\delta)/2T}.
\epsilon
m
m
\epsilon=O(1/m)
\epsilon=O(1/\sqrt{m})
\epsilon
m
\ell_{1}
T
h^{*}\in\mathcal{H}
h^{*}=\operatorname*{argmin}_{h\in\mathcal{H}}L(h)
\delta>0
1-\delta
t\geq 1
t\in\left\{{1,2\ldots,T}\right\}
h^{*}\in\mathcal{H}_{t}
L(f)-L(g)\leq 2\Delta_{t-1}
f,g\in\mathcal{H}_{t}
h_{T}
L(h_{T})-L(h^{*})\leq 2\Delta_{T-1}=\mathcal{O}\big{(}\sqrt{\log(T/\delta)/T}%
\big{)}.
m=\mathcal{O}(T)
\mathcal{O}(1/\sqrt{T})
\mathcal{O}(T)
\theta_{\textrm{AL}}
\displaystyle\theta_{\textrm{AL}}=\sup_{r\geq 0}\frac{\mathbb{E}_{{\textrm{x}}%
\sim\mathcal{X}}\left[\max_{h\in\mathcal{B}_{\textrm{AL}}(h^{*},r)}\max_{y\in%
\mathcal{Y}}|\ell(h(x),y)-\ell(h^{*}(x),y)|\right]}{r},
\displaystyle\theta_{\textrm{AL}}=\sup_{r\geq 0}\frac{\mathbb{E}_{{\textrm{x}}%
\sim\mathcal{X}}\left[\max_{h\in\mathcal{B}_{\textrm{AL}}(h^{*},r)}\max_{y\in%
\mathcal{Y}}|\ell(h(x),y)-\ell(h^{*}(x),y)|\right]}{r},
\mathcal{B}_{\textrm{AL}}(h^{*},r)=\{h\in\mathcal{H}:\rho_{\textrm{AL}}(h,h^{*%
})\leq r\}
\rho_{\textrm{AL}}(f,g)=\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}[\sup_{y\in%
\mathcal{Y}}|\ell(f({\textrm{x}}),y)-\ell(g({\textrm{x}}),y)|]
\rho_{\textrm{S}}(f,g)=\mathbb{E}_{({\textrm{x}},y)\in\mathcal{D}}[|\ell(f({%
\textrm{x}}),y)-\ell(g({\textrm{x}}),y)|]
\mathcal{B}_{\textrm{S}}(h^{*},r)=\{h\in\mathcal{H}:\rho_{\textrm{S}}(h,h^{*})%
\leq r\}
r\geq 0
\displaystyle\theta_{\textrm{S}}=\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}}%
,y)\sim\mathcal{D}}\left[\max_{h\in\mathcal{B}_{\textrm{S}}(h^{*},r)}|\ell(h({%
\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|\right]}{r}.
\displaystyle\theta_{\textrm{S}}=\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}}%
,y)\sim\mathcal{D}}\left[\max_{h\in\mathcal{B}_{\textrm{S}}(h^{*},r)}|\ell(h({%
\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|\right]}{r}.
y\in\mathcal{Y}
\rho
\theta_{\textrm{S}}
\mathcal{F}_{t}=\{({\textrm{x}}_{i},y_{i},Q_{i})\}_{i=1}^{t}
t
\delta>0
1-\delta
\sum_{t=1}^{T}\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}%
\big{|}\mathcal{F}_{t-1}}\right]=\mathcal{O}\Big{(}\theta_{\textrm{S}}\left({L%
(h^{*})T+\sqrt{T\log({T/\delta})}}\right)\Big{)}.
T
K_{\ell}=\sup_{z,z^{\prime}\in\mathcal{Z}}\frac{\max_{y\in\mathcal{Y}}|\ell(z,%
y)-\ell(z^{\prime},y)|}{\min_{y\in\mathcal{Y}}|\ell(z,y)-\ell(z^{\prime},y)|}
1-\delta
\mathcal{O}\left({\theta_{\textrm{AL}}K_{\ell}\left({L(h^{*})T+\sqrt{T\log({T/%
\delta})}}\right)}\right)
\theta_{\textrm{AL}}K_{\ell}
\theta_{\textrm{S}}
\theta_{\textrm{S}}
\theta_{\textrm{AL}}
K_{\ell}
\theta_{\textrm{S}}\leq\theta_{\textrm{AL}}K_{\ell}
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
\times
k
1+\frac{j}{10}
j
({\textrm{x}},y)
\displaystyle p({\textrm{x}},y)=-\textrm{P}_{f_{r}}(y|{\textrm{x}})\log{%
\textrm{P}_{f_{r}}(y|{\textrm{x}})}.
\displaystyle p({\textrm{x}},y)=-\textrm{P}_{f_{r}}(y|{\textrm{x}})\log{%
\textrm{P}_{f_{r}}(y|{\textrm{x}})}.
\textrm{P}_{f_{r}}(y|{\textrm{x}})
y
f_{r}
\textrm{P}_{f_{r}}(y|{\textrm{x}})
\displaystyle L(h^{\prime})=\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}[\ell(%
h^{\prime}({\textrm{x}}),y)]
\displaystyle L(h^{\prime})
\displaystyle=\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}[\ell(h^{\prime}({%
\textrm{x}}),y)]
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{T}\ell(h^{\prime}({\textrm{x}}_{i}),y_%
{i})+\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{T}\ell(h^{\prime}({\textrm{x}}_{i}),y_%
{i})+\sqrt{\frac{\ln(4/\delta)}{2T}}
0\leq\ell(\cdot)\leq 1
0\leq\ell(\cdot)\leq 1
0\leq\ell(\cdot)\leq 1
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{m}w_{i}\ell(h^{\prime}({\textrm{x}}_{i%
}^{\prime}),y_{i}^{\prime})+\epsilon+\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{m}w_{i}\ell(h^{\prime}({\textrm{x}}_{i%
}^{\prime}),y_{i}^{\prime})+\epsilon+\sqrt{\frac{\ln(4/\delta)}{2T}}
h^{\prime}
h^{\prime}
h^{\prime}
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{m}w_{i}\ell(h^{*}({\textrm{x}}_{i}^{%
\prime}),y_{i})+\epsilon+\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{m}w_{i}\ell(h^{*}({\textrm{x}}_{i}^{%
\prime}),y_{i})+\epsilon+\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{T}\ell(h^{*}({\textrm{x}}_{i}),y_{i})+%
2\epsilon+\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\frac{1}{T}\sum_{i=1}^{T}\ell(h^{*}({\textrm{x}}_{i}),y_{i})+%
2\epsilon+\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}[\ell(h^{*}({%
\textrm{x}}),y)]+2\epsilon+2\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle\leq\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}[\ell(h^{*}({%
\textrm{x}}),y)]+2\epsilon+2\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle=L(h^{*})+2\epsilon+2\sqrt{\frac{\ln(4/\delta)}{2T}}
\displaystyle=L(h^{*})+2\epsilon+2\sqrt{\frac{\ln(4/\delta)}{2T}}
\mathcal{P}
\mathcal{S}_{0}=\emptyset,\mathcal{H}_{0}=\mathcal{H}
t=1,2,\ldots,T
({\textrm{x}}_{t},y_{t})
\mathcal{P}
\displaystyle\mathcal{H}_{t}=\left\{h\in\mathcal{H}_{t-1}:\frac{1}{t-1}\sum_{i%
=1}^{t-1}\frac{Q_{i}}{p_{i}}\ell(h({\textrm{x}}_{i}),y_{i})\leq\min_{h\in%
\mathcal{H}_{t-1}}\frac{1}{t-1}\sum_{i=1}^{t-1}\frac{Q_{i}}{p_{i}}\ell(h({%
\textrm{x}}_{i}),y_{i})+\Delta_{t-1}\right\}
\displaystyle\mathcal{H}_{t}
\displaystyle=\left\{h\in\mathcal{H}_{t-1}:\frac{1}{t-1}\sum_{i=1}^{t-1}\frac{%
Q_{i}}{p_{i}}\ell(h({\textrm{x}}_{i}),y_{i})\leq\min_{h\in\mathcal{H}_{t-1}}%
\frac{1}{t-1}\sum_{i=1}^{t-1}\frac{Q_{i}}{p_{i}}\ell(h({\textrm{x}}_{i}),y_{i}%
)+\Delta_{t-1}\right\}
\Delta_{t-1}=\sqrt{\frac{8\log(2T(T+1)|\mathcal{H}|^{2}/\delta)}{t-1}}
p_{t}=\max_{f,g\in\mathcal{H}_{t}}\ell(f({\textrm{x}}_{t}),y_{t})-\ell(g({%
\textrm{x}}_{t}),y_{t})
Q_{t}\sim\textrm{Bernoulli}(p_{t})
Q_{t}=1
\mathcal{S}_{t}=\mathcal{S}_{t-1}\cup\left\{{\left({{\textrm{x}}_{t},y_{t},%
\frac{1}{p_{t}}}\right)}\right\}
\mathcal{S}_{t}=\mathcal{S}_{t-1}
h_{t}=\arg\min_{h\in H}\sum_{({\textrm{x}},y,w)\in\mathcal{S}_{t}}w\cdot\ell(h%
({\textrm{x}}),y)
h_{T}
L_{t-1}(f)=\frac{1}{t-1}\left(\sum_{i=1}^{t-1}\frac{Q_{i}}{p_{i}}\ell(f({%
\textrm{x}}_{i}),y_{i})\right).
\delta>0
1-\delta
t\in\left\{{1,\ldots,T}\right\}
f,g\in\mathcal{H}_{t-1}
|L_{t-1}(f)-L_{t-1}(g)-L(f)+L(g)|\leq\Delta_{t-1}.
t\in\left\{{1,\ldots,T}\right\}
f,g\in\mathcal{H}_{t-1}
Z_{i}=\frac{Q_{i}}{p_{i}}\left(\ell(f({\textrm{x}}_{i}),y_{i})-\ell(g({\textrm%
{x}}_{i}),y_{i})\right)-\left(L(f)-L(g)\right)
i\in\left\{{1,\ldots,t-1}\right\}.
Z_{i}
\mathbb{E}\left[{Z_{i}|Z_{1},\ldots Z_{i-1}}\right]=\mathbb{E}\left[{\frac{Q_{%
i}}{p_{i}}(\ell(f({\textrm{x}}_{i}),y_{i})-\ell(g({\textrm{x}}_{i}),y_{i})-(L(%
f)-L(g))|Z_{1},\ldots Z_{i-1}}\right]=0.
|Z_{i}|\leq\frac{1}{p_{i}}|\ell(f({\textrm{x}}_{i}),y_{i})-\ell(g({\textrm{x}}%
_{i}),y_{i})|+|L(f)-L(g)|\leq 2
p_{i}\geq|\ell(f({\textrm{x}}_{i}),y_{i})-\ell(g({\textrm{x}}_{i}),y_{i})|
f,g\in\mathcal{H}_{t-1}
\displaystyle\Pr[|L_{t-1}(f)-L_{t-1}(g)-L(f)+L(g)|\geq\Delta_{t-1}]
\displaystyle\Pr[|L_{t-1}(f)-L_{t-1}(g)-L(f)+L(g)|\geq\Delta_{t-1}]
\displaystyle\leq 2\exp(-(t-1)\Delta_{t-1}^{2}/8)=\frac{\delta}{T(T+1)|H|^{2}},
\displaystyle\leq 2\exp(-(t-1)\Delta_{t-1}^{2}/8)=\frac{\delta}{T(T+1)|H|^{2}},
({\textrm{x}}_{t},y_{t})
\mathcal{H}_{t-1}
\mathcal{H}
f,g\in\mathcal{H}
t-1
T
h^{*}\in\mathcal{H}_{t}
h^{*}\in\mathcal{H}_{1}=\mathcal{H}
h^{*}\in\mathcal{H}_{t-1}
h^{*}\in\mathcal{H}_{t}
h^{\prime}=\operatorname*{argmin}_{f\in\mathcal{H}_{t-1}}L_{t-1}(f)
L_{t-1}(h^{*})-L_{t-1}(h^{{}^{\prime}})\leq L(h^{*})-L(h{{}^{\prime}})+\Delta_%
{t-1}\leq\Delta_{t-1}
L(h^{*})-L(h^{\prime})\leq 0
h^{*}
L_{t-1}(h^{*})\leq L_{t-1}(h^{{}^{\prime}})+\Delta_{t-1}
h^{*}\in\mathcal{H}_{t}
\mathcal{H}_{t}
\mathcal{H}_{t}\subseteq H_{t-1}
f,g\in\mathcal{H}_{t}
\displaystyle L(f)-L(g)\leq L_{t-1}(f)-L_{t-1}(g)+\Delta_{t-1}
\displaystyle L(f)-L(g)\leq L_{t-1}(f)-L_{t-1}(g)+\Delta_{t-1}
\displaystyle\leq L_{t-1}(h^{\prime})+\Delta_{t-1}-L_{t-1}(h^{\prime})+\Delta_%
{t-1}\leq 2\Delta_{t-1}.
\displaystyle\leq L_{t-1}(h^{\prime})+\Delta_{t-1}-L_{t-1}(h^{\prime})+\Delta_%
{t-1}\leq 2\Delta_{t-1}.
h^{*},h_{t}\in\mathcal{H}_{t}
\mathcal{H}_{t}\subset\{h\in\mathcal{H}:L(h)\leq L(h^{*})+2\Delta_{t-1}\}
h^{*}
\displaystyle\rho_{\textrm{S}}(h,h^{*})=\mathbb{E}_{({\textrm{x}},y)\in%
\mathcal{D}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|\leq L(h)+L(h%
^{*})\leq 2L(h^{*})+2\Delta_{t-1}.
\displaystyle\rho_{\textrm{S}}(h,h^{*})=\mathbb{E}_{({\textrm{x}},y)\in%
\mathcal{D}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|\leq L(h)+L(h%
^{*})\leq 2L(h^{*})+2\Delta_{t-1}.
r=2L(h^{*})+2\Delta_{t-1}
\mathcal{H}_{t}\subset\mathcal{B}_{\textrm{S}}(h^{*},r)
\displaystyle\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[p_{t}|%
\mathcal{F}_{t-1}]=\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[\sup_{f%
,g\in\mathcal{H}_{t}}|\ell(f({\textrm{x}}_{t}),y_{t})-\ell(g({\textrm{x}}_{t})%
,y_{t})||\mathcal{F}_{t-1}]
\displaystyle\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[p_{t}|%
\mathcal{F}_{t-1}]
\displaystyle=\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[\sup_{f,g\in%
\mathcal{H}_{t}}|\ell(f({\textrm{x}}_{t}),y_{t})-\ell(g({\textrm{x}}_{t}),y_{t%
})||\mathcal{F}_{t-1}]
\displaystyle\leq 2\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[\sup_{h%
\in\mathcal{H}_{t}}|\ell(h({\textrm{x}}_{t}),y_{t})-\ell(h^{*}({\textrm{x}}_{t%
}),y_{t})||\mathcal{F}_{t-1}]
\displaystyle\leq 2\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[\sup_{h%
\in\mathcal{H}_{t}}|\ell(h({\textrm{x}}_{t}),y_{t})-\ell(h^{*}({\textrm{x}}_{t%
}),y_{t})||\mathcal{F}_{t-1}]
\displaystyle\leq 2\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[\sup_{h%
\in\mathcal{B}_{\textrm{S}}(h^{*},r)}|\ell(h({\textrm{x}}_{t}),y_{t})-\ell(h^{%
*}({\textrm{x}}_{t}),y_{t})|]
\displaystyle\leq 2\mathbb{E}_{({\textrm{x}}_{t},y_{t})\in\mathcal{D}}[\sup_{h%
\in\mathcal{B}_{\textrm{S}}(h^{*},r)}|\ell(h({\textrm{x}}_{t}),y_{t})-\ell(h^{%
*}({\textrm{x}}_{t}),y_{t})|]
\displaystyle\leq 2\theta_{\textrm{S}}r=4\theta_{\textrm{S}}(L(h^{*})+\Delta_{%
t-1})
\displaystyle\leq 2\theta_{\textrm{S}}r=4\theta_{\textrm{S}}(L(h^{*})+\Delta_{%
t-1})
t\in[T]
\mathcal{O}\left({\theta_{\textrm{S}}L(h^{*})T+\theta_{\textrm{S}}\sqrt{T}}\right)
\displaystyle\mathcal{B}_{\textrm{IWAL}}(h^{*},r)\subseteq\mathcal{B}_{\textrm%
{S}}(h^{*},r)\subseteq\mathcal{B}_{\textrm{IWAL}}(h^{*},K_{\ell}r).
\displaystyle\mathcal{B}_{\textrm{IWAL}}(h^{*},r)\subseteq\mathcal{B}_{\textrm%
{S}}(h^{*},r)\subseteq\mathcal{B}_{\textrm{IWAL}}(h^{*},K_{\ell}r).
h\in\mathcal{B}_{\textrm{S}}(h^{*},r)
K_{\ell}
\displaystyle r\geq\rho_{\textrm{S}}(h,h^{*})=\mathbb{E}_{({\textrm{x}},y)\in%
\mathcal{D}}\left[{|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}%
\right]\geq\frac{1}{K_{\ell}}\mathbb{E}_{{\textrm{x}}\in\mathcal{X}}\sup_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|=\frac{1}{K_{%
\ell}}\rho_{\textrm{IWAL}}(h,h^{*})
\displaystyle r
\displaystyle\geq\rho_{\textrm{S}}(h,h^{*})=\mathbb{E}_{({\textrm{x}},y)\in%
\mathcal{D}}\left[{|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}%
\right]\geq\frac{1}{K_{\ell}}\mathbb{E}_{{\textrm{x}}\in\mathcal{X}}\sup_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|=\frac{1}{K_{%
\ell}}\rho_{\textrm{IWAL}}(h,h^{*})
\displaystyle K_{\ell}=\sup_{z,z^{\prime}\in\mathcal{Z}}\frac{\max_{y\in%
\mathcal{Y}}|\ell(z,y)-\ell(z^{\prime},y)|}{\min_{y\in\mathcal{Y}}|\ell(z,y)-%
\ell(z^{\prime},y)|}
\displaystyle K_{\ell}
\displaystyle=\sup_{z,z^{\prime}\in\mathcal{Z}}\frac{\max_{y\in\mathcal{Y}}|%
\ell(z,y)-\ell(z^{\prime},y)|}{\min_{y\in\mathcal{Y}}|\ell(z,y)-\ell(z^{\prime%
},y)|}
\displaystyle\geq\sup_{{\textrm{x}}\sim\mathcal{X}}\frac{\max_{y\in\mathcal{Y}%
}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\min_{y\in\mathcal{Y}}%
|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}
\displaystyle\geq\sup_{{\textrm{x}}\sim\mathcal{X}}\frac{\max_{y\in\mathcal{Y}%
}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\min_{y\in\mathcal{Y}}%
|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}
\displaystyle\geq\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}\frac{\max_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\min_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}
\displaystyle\geq\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}\frac{\max_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\min_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}
\displaystyle\geq\frac{\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}\max_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\mathbb{E}_%
{{\textrm{x}}\sim\mathcal{X}}\min_{y\in\mathcal{Y}}|\ell(h({\textrm{x}}),y)-%
\ell(h^{*}({\textrm{x}}),y)|}
\displaystyle\geq\frac{\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}\max_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\mathbb{E}_%
{{\textrm{x}}\sim\mathcal{X}}\min_{y\in\mathcal{Y}}|\ell(h({\textrm{x}}),y)-%
\ell(h^{*}({\textrm{x}}),y)|}
\displaystyle\geq\frac{\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}\max_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\mathbb{E}_%
{({\textrm{x}},y)\sim\mathcal{D}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{%
x}}),y)|}
\displaystyle\geq\frac{\mathbb{E}_{{\textrm{x}}\sim\mathcal{X}}\max_{y\in%
\mathcal{Y}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{x}}),y)|}{\mathbb{E}_%
{({\textrm{x}},y)\sim\mathcal{D}}|\ell(h({\textrm{x}}),y)-\ell(h^{*}({\textrm{%
x}}),y)|}
\theta_{\textrm{S}}
\theta_{\textrm{S}}
\theta_{\textrm{S}}
\displaystyle\theta_{\textrm{S}}=\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}}%
,y)\sim\mathcal{D}}\left[\max_{h\in\mathcal{B}_{\textrm{S}}(h^{*},r)}|\ell(h(x%
),y)-\ell(h^{*}(x),y)|\right]}{r}
\displaystyle\theta_{\textrm{S}}
\displaystyle=\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{D}}%
\left[\max_{h\in\mathcal{B}_{\textrm{S}}(h^{*},r)}|\ell(h(x),y)-\ell(h^{*}(x),%
y)|\right]}{r}
\displaystyle\leq\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{%
D}}\left[\max_{h\in\mathcal{B}_{\textrm{IWAL}}(h^{*},K_{\ell}r)}|\ell(h(x),y)-%
\ell(h^{*}(x),y)|\right]}{r}
\displaystyle\leq\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}},y)\sim\mathcal{%
D}}\left[\max_{h\in\mathcal{B}_{\textrm{IWAL}}(h^{*},K_{\ell}r)}|\ell(h(x),y)-%
\ell(h^{*}(x),y)|\right]}{r}
K_{\ell}r
r
K_{\ell}r
r
K_{\ell}r
r
\displaystyle=K_{\ell}\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}},y)\sim%
\mathcal{D}}\left[\max_{h\in\mathcal{B}_{\textrm{IWAL}}(h^{*},r)}|\ell(h(x),y)%
-\ell(h^{*}(x),y)|\right]}{r}
\displaystyle=K_{\ell}\sup_{r\geq 0}\frac{\mathbb{E}_{({\textrm{x}},y)\sim%
\mathcal{D}}\left[\max_{h\in\mathcal{B}_{\textrm{IWAL}}(h^{*},r)}|\ell(h(x),y)%
-\ell(h^{*}(x),y)|\right]}{r}
\displaystyle\leq K_{\ell}\sup_{r\geq 0}\frac{\mathbb{E}_{{\textrm{x}}\in%
\mathcal{X}}\left[\max_{h\in\mathcal{B}_{\textrm{IWAL}}(h^{*},r)}\sup_{y\in%
\mathcal{Y}}|\ell(h(x),y)-\ell(h^{*}(x),y)|\right]}{r}
\displaystyle\leq K_{\ell}\sup_{r\geq 0}\frac{\mathbb{E}_{{\textrm{x}}\in%
\mathcal{X}}\left[\max_{h\in\mathcal{B}_{\textrm{IWAL}}(h^{*},r)}\sup_{y\in%
\mathcal{Y}}|\ell(h(x),y)-\ell(h^{*}(x),y)|\right]}{r}
\displaystyle=K_{\ell}\theta_{\textrm{IWAL}}.
\displaystyle=K_{\ell}\theta_{\textrm{IWAL}}.
\displaystyle\Delta^{\textrm{EIWeS}}_{t}=\frac{2}{t}\Big{(}\sqrt{\sum_{t=1}^{T%
}p_{t}}+6\sqrt{\log\left({(3+t)t^{2}/\delta}\right)}\Big{)}\cdot\sqrt{\log%
\left({8T^{2}|\mathcal{H}|^{2}\log(T)/\delta}\right)}
\displaystyle\Delta^{\textrm{EIWeS}}_{t}=\frac{2}{t}\Big{(}\sqrt{\sum_{t=1}^{T%
}p_{t}}+6\sqrt{\log\left({(3+t)t^{2}/\delta}\right)}\Big{)}\cdot\sqrt{\log%
\left({8T^{2}|\mathcal{H}|^{2}\log(T)/\delta}\right)}
L(h^{*})
L(h^{*})=0
\mathcal{O}\left({\log^{3}\left({T}\right)}\right)
T
\mathcal{O}\left({\sqrt{T\log\left({T}\right)}}\right)
\delta>0
T\geq 3
1-\delta
\displaystyle\sum_{t=1}^{T}\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}%
}[p_{t}|\mathcal{F}_{t-1}]\leq\theta_{\textrm{S}}\left({L(h^{*})T+\mathcal{O}%
\left({\sqrt{L(h^{*})T\log(T/\delta)}}\right)}\right)+\mathcal{O}\left({\log^{%
3}(T/\delta)}\right).
\displaystyle\sum_{t=1}^{T}\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}%
}[p_{t}|\mathcal{F}_{t-1}]\leq\theta_{\textrm{S}}\left({L(h^{*})T+\mathcal{O}%
\left({\sqrt{L(h^{*})T\log(T/\delta)}}\right)}\right)+\mathcal{O}\left({\log^{%
3}(T/\delta)}\right).
t\geq 3
\displaystyle\sum_{t=1}^{T}\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}%
}\left[{p_{t}\big{|}\mathcal{F}_{t-1}}\right]=4\theta_{\textrm{S}}\left({L(h^{%
*})+\Delta_{t-1}}\right).
\displaystyle\sum_{t=1}^{T}\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}%
}\left[{p_{t}\big{|}\mathcal{F}_{t-1}}\right]=4\theta_{\textrm{S}}\left({L(h^{%
*})+\Delta_{t-1}}\right).
\Delta^{\textrm{EIWeS}}_{t-1}
\Delta_{t-1}
\sum_{t=1}^{T}p_{t}
\sum_{t=1}^{T}\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}%
\big{|}\mathcal{F}_{t-1}}\right]
\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}|\mathcal{F}_{%
t-1}}\right]
\displaystyle\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}%
\big{|}\mathcal{F}_{t-1}}\right]\leq 4\theta_{\textrm{S}}L(h^{*})+\frac{4%
\theta_{\textrm{S}}c_{1}}{t-1}\sqrt{\sum_{s=1}^{t-1}\mathbb{E}_{({\textrm{x}}_%
{t},y_{t})\sim\mathcal{D}}\left[{p_{s}|\mathcal{F}_{s-1}}\right]}+c_{2}\left({%
\frac{\log\left({(t-1)|\mathcal{H}|/\delta}\right)}{t-1}}\right).
\displaystyle\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}%
\big{|}\mathcal{F}_{t-1}}\right]\leq 4\theta_{\textrm{S}}L(h^{*})+\frac{4%
\theta_{\textrm{S}}c_{1}}{t-1}\sqrt{\sum_{s=1}^{t-1}\mathbb{E}_{({\textrm{x}}_%
{t},y_{t})\sim\mathcal{D}}\left[{p_{s}|\mathcal{F}_{s-1}}\right]}+c_{2}\left({%
\frac{\log\left({(t-1)|\mathcal{H}|/\delta}\right)}{t-1}}\right).
c_{1}=2\sqrt{\log\left({\frac{8T^{2}|\mathcal{H}|^{2}\log\left({T}\right)}{%
\delta}}\right)}
c_{2}
t\geq 3
c_{3}=\mathcal{O}\left({\sqrt{\log\left({T|\mathcal{H}|/\delta}\right)}}\right)
c_{4}=\mathcal{O}\left({\log^{2}\left({T|\mathcal{H}|/\delta}\right)}\right)
\displaystyle\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}%
\big{|}\mathcal{F}_{t-1}}\right]\leq 4\theta_{\textrm{S}}L(h^{*})+c_{3}\sqrt{%
\frac{L(h^{*})}{t-1}}+\frac{c_{4}}{t-1}
\displaystyle\mathbb{E}_{({\textrm{x}}_{t},y_{t})\sim\mathcal{D}}\left[{p_{t}%
\big{|}\mathcal{F}_{t-1}}\right]\leq 4\theta_{\textrm{S}}L(h^{*})+c_{3}\sqrt{%
\frac{L(h^{*})}{t-1}}+\frac{c_{4}}{t-1}
t\in[T]
|\mathcal{H}|
