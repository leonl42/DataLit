x_{1},\ldots,x_{N}
N
\texttt{[CLS]},x_{1},\ldots,x_{N}\texttt{[SEP]}
\mathbf{\bm{h}}_{\texttt{[CLS]}},\mathbf{\bm{h}}_{1},\ldots,\mathbf{\bm{h}}_{N%
},\mathbf{\bm{h}}_{\texttt{[SEP]}}\in\mathbb{R}^{d}
d
\mathbf{\bm{h}}_{0}
\mathbf{\bm{h}}_{\texttt{[CLS]}}
\mathcal{E}=\{E_{1},\ldots,E_{K}\}
E_{k}
k
E_{k}
\texttt{BERT}^{E}
\displaystyle\mathbf{\bm{h}}^{E_{k}}_{\texttt{[CLS]}}=\texttt{BERT}^{E}(E_{k}),
\displaystyle\mathbf{\bm{h}}^{E_{k}}_{\texttt{[CLS]}}=\texttt{BERT}^{E}(E_{k}),
\displaystyle\mathbf{\bm{e}}_{k}=\texttt{Linear}^{E}(\mathbf{\bm{h}}^{E_{k}}_{%
\texttt{[CLS]}}),
\displaystyle\mathbf{\bm{e}}_{k}=\texttt{Linear}^{E}(\mathbf{\bm{h}}^{E_{k}}_{%
\texttt{[CLS]}}),
\mathbf{\bm{e}}_{k}\in\mathbb{R}^{d}
E_{k}
\texttt{BERT}^{T}
\displaystyle\mathbf{\bm{h}}^{T}_{1},\ldots,\mathbf{\bm{h}}^{T}_{N}=\texttt{%
BERT}^{T}(x_{1},\ldots,x_{N}).
\displaystyle\mathbf{\bm{h}}^{T}_{1},\ldots,\mathbf{\bm{h}}^{T}_{N}
\displaystyle=\texttt{BERT}^{T}(x_{1},\ldots,x_{N}).
(i,j)
i
j
(\cdot,\cdot)={\cos(\cdot,\cdot)\over\tau}
\tau
(i,j)
\mathbf{\bm{s}}_{i,j}=\texttt{Linear}^{S}(\mathbf{\bm{h}}^{T}_{i}\oplus\mathbf%
{\bm{h}}^{T}_{j}\oplus D(j-i)),
\mathbf{\bm{h}}^{T}_{i},\mathbf{\bm{h}}^{T}_{j}
\mathbf{\bm{s}}_{i,j}\in\mathbb{R}^{d}
\texttt{Linear}^{S}
\oplus
D(j-i)\in\mathbb{R}^{m}
(j-i)
D\in\mathbb{R}^{N\times m}
\ell_{\texttt{span}}=-\log{\exp(\text{sim}(\mathbf{\bm{s}}_{i,j},\mathbf{\bm{e%
}}_{k}))\over\sum_{\mathbf{\bm{s}}^{\prime}\in\mathcal{S}^{-}_{k}\cup{\mathbf{%
\bm{s}}_{i,j}}\exp(\text{sim}(\mathbf{\bm{s}}^{\prime},\mathbf{\bm{e}}_{k}))}},
(i,j)
E_{k}
\mathcal{S}^{-}_{k}
E_{k}
\mathbf{\bm{e}}_{k}
E_{k}
e_{k}^{\text{B}}=\texttt{Linear}^{E}_{B}(\mathbf{\bm{h}}^{E_{k}}_{\texttt{[CLS%
]}}),e_{k}^{\text{Q}}=\texttt{Linear}^{E}_{Q}(\mathbf{\bm{h}}^{E_{k}}_{\texttt%
{[CLS]}}),
e_{k}^{\text{B}},e_{k}^{\text{Q}}
\mathbf{\bm{h}}^{E_{k}}_{\texttt{[CLS]}}
\mathbf{\bm{u}}_{n}=\texttt{Linear}^{T}_{B}(\mathbf{\bm{h}}^{T}_{n}),\mathbf{%
\bm{v}}_{n}=\texttt{Linear}^{T}_{Q}(\mathbf{\bm{h}}^{T}_{n})
\mathbf{\bm{h}}^{T}_{n}
e^{k}_{\text{B}},e^{k}_{\text{Q}}
\displaystyle\ell_{\text{start}}=-\log{\exp(\text{sim}(\mathbf{\bm{u}}_{i},%
\mathbf{\bm{e}}_{k}^{\text{B}}))\over\sum_{\mathbf{\bm{u}}^{\prime}\in\mathcal%
{U}^{-}_{k}\cup{\mathbf{\bm{u}}_{i}}}\exp(\text{sim}(\mathbf{\bm{u}}^{\prime},%
\mathbf{\bm{e}}_{k}^{\text{B}}))}
\displaystyle\ell_{\text{start}}=-\log{\exp(\text{sim}(\mathbf{\bm{u}}_{i},%
\mathbf{\bm{e}}_{k}^{\text{B}}))\over\sum_{\mathbf{\bm{u}}^{\prime}\in\mathcal%
{U}^{-}_{k}\cup{\mathbf{\bm{u}}_{i}}}\exp(\text{sim}(\mathbf{\bm{u}}^{\prime},%
\mathbf{\bm{e}}_{k}^{\text{B}}))}
\displaystyle\ell_{\text{end}}=-\log{\exp(\text{sim}(\mathbf{\bm{v}}_{j},%
\mathbf{\bm{e}}_{k}^{\text{Q}}))\over\sum_{\mathbf{\bm{v}}^{\prime}\in\mathcal%
{V}^{-}_{k}\cup{\mathbf{\bm{v}}_{j}}}\exp(\text{sim}(\mathbf{\bm{v}}^{\prime},%
\mathbf{\bm{e}}_{k}^{\text{Q}}))},
\displaystyle\ell_{\text{end}}=-\log{\exp(\text{sim}(\mathbf{\bm{v}}_{j},%
\mathbf{\bm{e}}_{k}^{\text{Q}}))\over\sum_{\mathbf{\bm{v}}^{\prime}\in\mathcal%
{V}^{-}_{k}\cup{\mathbf{\bm{v}}_{j}}}\exp(\text{sim}(\mathbf{\bm{v}}^{\prime},%
\mathbf{\bm{e}}_{k}^{\text{Q}}))},
\mathcal{U}^{-}_{k},\mathcal{V}^{-}_{k}
k
\ell^{+}_{\texttt{start}}
\ell^{+}_{\texttt{start}}=\beta\ell_{\texttt{start}}-(1-\beta)\log{\exp(\text{%
sim}(\mathbf{\bm{u}}_{\texttt{[CLS]}},\mathbf{\bm{e}}_{k}^{\text{B}}))\over%
\sum_{\mathbf{\bm{u}}^{\prime}\in\mathcal{U}^{-}_{k}\exp(\text{sim}(\mathbf{%
\bm{u}}^{\prime},\mathbf{\bm{e}}_{k}^{\text{B}}))}}.
\ell^{+}_{\texttt{end}}
\mathbf{\bm{s}}_{0,0}
\ell^{+}_{\texttt{span}}
\ell^{+}_{\texttt{span}}=\beta\ell_{\texttt{span}}-(1-\beta)\log{\exp(\text{%
sim}(\mathbf{\bm{s}}_{0,0},\mathbf{\bm{e}}_{k}))\over\sum_{\mathbf{\bm{s}}^{%
\prime}\in\mathcal{S}^{-}_{k}\exp(\text{sim}(\mathbf{\bm{s}}^{\prime},\mathbf{%
\bm{e}}_{k}))}}.
\beta
\mathcal{L}=\alpha\ell^{+}_{\texttt{start}}+\gamma\ell^{+}_{\texttt{end}}+%
\lambda\ell^{+}_{\texttt{span}},
\alpha,\gamma,\lambda
L
E_{k}
(i,j)
\text{sim}(\mathbf{\bm{u}}_{i},\mathbf{\bm{e}}_{k}^{\text{B}})<\text{sim}(%
\mathbf{\bm{u}}_{\texttt{[CLS]}},\mathbf{\bm{e}}_{k}^{\text{B}})
\text{sim}(\mathbf{\bm{v}}_{j},\mathbf{\bm{e}}_{k}^{\text{Q}})<\text{sim}(%
\mathbf{\bm{v}}_{\texttt{[CLS]}},\mathbf{\bm{e}}_{k}^{\text{Q}})
\text{sim}(\mathbf{\bm{s}}_{i,j},\mathbf{\bm{e}}_{k})>\text{sim}(\mathbf{\bm{s%
}}_{0,0},\mathbf{\bm{e}}_{k})
\dagger
\dagger
\text{sim}(\mathbf{\bm{u}}_{\texttt{[CLS]}},\mathbf{\bm{e}}_{k}^{\text{B}})
\text{sim}(\mathbf{\bm{s}}_{0,0},\mathbf{\bm{e}}_{k})
\alpha\ell_{\texttt{start}}+\gamma\ell_{\texttt{end}}+\lambda\ell_{\texttt{%
joint}}
{}_{\text{span}}
{}_{\text{start}}
{}_{\text{end}}
{}_{\text{span}}
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
\leftrightarrow
{}_{\text{span}}
{}_{\text{start}}
{}_{\text{end}}
{}_{\text{span}}
{}_{\text{end}}
{}_{\text{span}}
{}_{\text{start}}
{}_{\text{end}}
{}_{\text{start}}
\mathcal{O}(L^{2})
L
N_{\text{templates}}=N_{\text{text spans}}\times N_{\text{entity types}}
\mathcal{O}(N_{\text{documents}}\times N_{\text{text spans}}\times N_{\text{%
entity types}})
\mathcal{O}(N_{\text{entity types}})
\mathcal{O}(L^{2})
L
L
\mathcal{O}(L^{2})
L=256
L
L
L
\alpha=0.2,\gamma=0.2,\lambda=0.6
N=128
N=256
\mathcal{S}=\{(i,j)|i,j=1,\ldots,N,0\leq j-i\leq L\}
\mathcal{E}=\{E_{1},\ldots,E_{K}\}
M=\{\}
E_{k}\in\mathcal{E}
b_{null},e_{null},s_{null}
(i,j)\in\mathcal{S}
b,e,s
b<b_{null}
e<e_{null}
s>s_{null}
M=M\bigcup\{(i,j,E_{k})\}
M
M
\hat{D}
\hat{M}=\{\}
\hat{D}
(i,j,E_{k})
\hat{D}
(i,j)
\hat{M}
\hat{M}=\hat{M}\cup\{(i,j,E_{k})\}
\hat{M}
|\mathcal{E}|
y
y
