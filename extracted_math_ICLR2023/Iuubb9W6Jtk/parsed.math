P(X,Y)
P(X,Y)
{\cal X}
P_{X|Y}
{\cal Y}
{\cal Y}_{\text{OOD}}
x\sim P(x|y\in{\cal Y}_{\text{ID}})
x\sim P(x|y\in{\cal Y}_{\text{\text{OOD}}})
\kappa
{\cal Y}_{\text{OOD}}
\kappa
s_{10})
s_{10})
\mathcal{X}
\mathcal{Y}={\cal Y}_{\text{ID}}\cup{\cal Y}_{\text{OOD}}
P(\mathcal{X},\mathcal{Y})
\mathcal{X}\times\mathcal{Y}
f
f:\mathcal{X}\rightarrow{\cal Y}_{\text{ID}}
x
\hat{y}_{f}(x)
f
T_{m}=\{(x_{i},y_{i})\}_{i=1}^{m}\subseteq(\mathcal{X}\times{\cal Y}_{\text{ID%
}})
P(\mathcal{X},{\cal Y}_{\text{ID}})
\hat{r}(f|T_{m})\triangleq\frac{1}{m}\sum_{i=1}^{m}\ell(f(x_{i}),y_{i})
\ell:{\cal Y}_{\text{ID}}\times{\cal Y}_{\text{ID}}\rightarrow\mathbb{R}^{+}
f
x\sim P({\cal X},{\cal Y}_{\text{OOD}})
\kappa(x,\hat{y}|f)
x\in{\mathcal{X}}
\hat{y}\in{{\cal Y}_{\text{ID}}}
x
\kappa
\hat{y}
x
f
\mathcal{X}
\kappa
f
\kappa(x,\hat{y}|f)\triangleq f(x)_{\hat{y}}
\kappa
\kappa
f
\kappa
f
\kappa
\mathcal{X}
(x_{1},y_{1}),(x_{2},y_{2})\sim P(\mathcal{X},\mathcal{Y})
x_{1}
x_{2}
\kappa
\kappa
x_{2}
x_{1}
\mathbf{Pr}[\kappa(x_{1},\hat{y_{1}}|f)<\kappa(x_{2},\hat{y_{2}}|f)\ |\ x_{1}%
\sim P({\cal X},{\cal Y}_{\text{OOD}})\land x_{2}\sim P({\cal X},{\cal Y}_{%
\text{ID}})]
\kappa
f,\kappa,{\cal Y}_{\text{OOD}},group\_size=|{\cal Y}_{\text{ID}}|
\bar{y}\in{\cal Y}_{\text{OOD}}
\text{Split all samples of class }\bar{y}\text{ into two sets: }c_{est}^{\bar{%
y}}\text{ and }c_{test}^{\bar{y}}
\text{Set the severity score of class }\bar{y}\text{ to be: }s(\bar{y}|f,%
\kappa)=\frac{1}{|c_{est}^{\bar{y}}|}\sum_{x\in c_{est}^{\bar{y}}}\kappa(x|f).
\text{Insert the class and its score }(\bar{y},s(\bar{y}|f,\kappa))\text{ into%
 }classes\_array
\text{Sort }classes\_array\text{ in ascending order by each OOD class' score }%
s(\bar{y}|f,\kappa)
i<|{\cal Y}_{\text{OOD}}|-group\_size
group\_size
grp\_array[i]=classes\_array[i:i+group\_size]
i<11
sev\_benchmark[i]=\{x\mid x\in c_{test}^{\bar{y}}\text{ s.t. }\bar{y}\in grp\_%
array[j]\text{ and }j=[\frac{i}{10}\cdot|grp\_array|]\}
sev\_benchmark
{\cal Y}_{\text{OOD}}
s_{f,\kappa}(\bar{y})
\kappa
\bar{y}\in{\cal Y}_{\text{OOD}}
f
\kappa
\bar{y}
\kappa
s(\bar{y}|f,\kappa)
\kappa
\bar{y}
s(\bar{y}|f,\kappa)
c_{est}^{\bar{y}}
c_{test}^{\bar{y}}
s
{\cal Y}_{\text{OOD}}
i\in[0,10]
i^{th}
\bar{y}
f,\kappa
s(\bar{y}|f,\kappa)=\frac{1}{|c_{est}^{\bar{y}}|}\sum_{x\in c_{est}^{\bar{y}}}%
\kappa(x|f).
G
|{\cal Y}_{\text{ID}}|
{\cal Y}_{\text{OOD}}
1000
20,000
{20,000\choose 1000}=2.5\times 10^{1722}
|{\cal Y}_{\text{\text{ID}}}|
|{\cal Y}_{\text{OOD}}|-|{\cal Y}_{\text{\text{ID}}}|+1
|{\cal Y}_{\text{OOD}}|-|{\cal Y}_{\text{\text{ID}}}|+1
\bar{y}_{i}\in{\cal Y}_{\text{OOD}}
s(\bar{y}|f,\kappa)
|{\cal Y}_{\text{ID}}|
|{\cal Y}_{\text{OOD}}|-|{\cal Y}_{\text{\text{ID}}}|+1
\bar{y}_{i}\in{\cal Y}_{\text{OOD}}
s(\bar{y}|f,\kappa)
|{\cal Y}_{\text{ID}}|
\{10\cdot i\}_{i=0}^{i=10}
i
c_{test}^{\bar{y}}
i
50
50
|c_{test}^{\bar{y}}|=50
150
|c_{est}^{\bar{y}}|=150
200
200
200
200
{\cal Y}_{\text{OOD}}
{\cal Y}_{\text{ID}}
\kappa
\kappa
\kappa
\kappa
s>3
s\leq 3
s_{0}-s_{8}
[0.6,0.73]
[0.34,0.43]
[0.4,0.5]
[0.54,0.77]
i\in[0,10]
\kappa
\kappa
\kappa
f
\kappa
(f,\kappa)
\kappa
0.4\%
9\%
\kappa
\kappa
10.6\%
\kappa
\kappa
\kappa
\kappa
\kappa
\kappa
P(y|x)
(x_{1},y_{1}),(x_{2},y_{2})\sim P(\mathcal{X},\mathcal{Y})
\ell(f(x_{1}),y_{1})>\ell(f(x_{2}),y_{2})
\kappa
\kappa
x_{2}
x_{1}
\mathbf{Pr}[\kappa(x_{1},\hat{y}|f)<\kappa(x_{2},\hat{y}|f)|\ell(f(x_{1}),y_{1%
})>\ell(f(x_{2}),y_{2})]
c_{est}^{\bar{y}}
\mathcal{A}
Z
\mathcal{B}
K
K
Z
\text{AUROC}(\mathcal{A},Z)>\text{AUROC}(\mathcal{B},K)
R\neq Z
\text{AUROC}(\mathcal{A},R)~{}\geq~{}\text{AUROC}(\mathcal{A},Z)
Z
\mathcal{A}
R
K
\text{AUROC}(\mathcal{A},K)\geq\text{AUROC}(\mathcal{A},Z)
\text{AUROC}(\mathcal{A},K)\geq\text{AUROC}(\mathcal{A},Z)>\text{AUROC}(%
\mathcal{B},K)\Rightarrow\text{AUROC}(\mathcal{A},K)>\text{AUROC}(\mathcal{B},K)
K
\mathcal{A}
\mathcal{B}
(CLIP,\kappa_{cosine\ similarity})
\kappa_{cosine\ similarity}
s_{0}-s_{8}
[0.6,0.73]
[0.34,0.43]
s_{9}
s_{10}
s_{9},s_{10})
[0.54,0.77]
s_{i}
s_{j}
j
i
s\in\{7,8,9\}
s\in\{7,8,9\}
\epsilon
1\cdot 10^{-5}
