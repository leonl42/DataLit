L_{i}
H\times W
4\times 4\times 3
2\times 2\times C_{i-1}
i
\times C_{i}
F_{1}\in\mathbb{R}^{\frac{H}{4}\times\frac{W}{4}\times C_{1}}
F_{2}\in\mathbb{R}^{\frac{H}{8}\times\frac{W}{8}\times C_{2}}
F_{3}\in\mathbb{R}^{\frac{H}{16}\times\frac{W}{16}\times C_{3}}
F_{4}\in\mathbb{R}^{\frac{H}{32}\times\frac{W}{32}\times C_{4}}
F_{1},F_{2},F_{3},F_{4}
\tilde{h}^{l}=MCSA/MSA(LN(h^{l-1}))+h^{l-1}
h^{l}=ConvFFN(LN(\tilde{h}^{l}))+\tilde{h}^{l}
LN
ConvFFN
MCSA/MSA
\tilde{h}^{l}
h^{l}
l
h^{l-1}
l-1
x_{i}\in\mathbb{R}^{H_{i}\times W_{i}\times C_{i}}
i
H_{i}^{{}^{\prime}}\times W_{i}^{{}^{\prime}}
H_{i}^{{}^{\prime}}
W_{i}^{{}^{\prime}}
H_{i}^{{}^{\prime}}=\left\lfloor\frac{H_{i}+2p-k}{s}\right\rfloor+1,W_{i}^{{}^%
{\prime}}=\left\lfloor\frac{W_{i}+2p-k}{s}\right\rfloor+1
p
k
s
p
s
3\times 3
\times
\times
P_{i}
C_{i}
N_{i}
E_{i}
i
P_{i}
C_{i}
N_{i}
E_{i}
i
\times
P_{1}=4;C_{1}=32
P_{1}=4;C_{1}=64
56\times 56
\left[\begin{aligned} N_{1}=1\\[-3.0pt]
E_{1}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{1}=1\\[-3.0pt]
E_{1}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{1}=1\\[-3.0pt]
E_{1}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{1}=1\\[-3.0pt]
E_{1}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{1}=1\\[-3.0pt]
E_{1}=4\end{aligned}\right]\times
\times
P_{2}=2;C_{2}=64
P_{2}=2;C_{2}=128
\times
\left[\begin{aligned} N_{2}=2\\[-3.0pt]
E_{2}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{2}=2\\[-3.0pt]
E_{2}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{2}=2\\[-3.0pt]
E_{2}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{2}=2\\[-3.0pt]
E_{2}=8\end{aligned}\right]\times
\left[\begin{aligned} N_{2}=2\\[-3.0pt]
E_{2}=4\end{aligned}\right]\times
\times
P_{3}=2;C_{3}=160
P_{3}=2;C_{3}=320
\times
\left[\begin{aligned} N_{3}=5\\[-3.0pt]
E_{3}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{3}=5\\[-3.0pt]
E_{3}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{3}=5\\[-3.0pt]
E_{3}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{3}=5\\[-3.0pt]
E_{3}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{3}=5\\[-3.0pt]
E_{3}=4\end{aligned}\right]\times
\times
P_{4}=2;C_{4}=256
P_{4}=2;C_{4}=512
\times
\left[\begin{aligned} N_{4}=8\\[-3.0pt]
E_{4}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{4}=8\\[-3.0pt]
E_{4}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{4}=8\\[-3.0pt]
E_{4}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{4}=8\\[-3.0pt]
E_{4}=4\end{aligned}\right]\times
\left[\begin{aligned} N_{4}=8\\[-3.0pt]
E_{4}=4\end{aligned}\right]\times
SA(Q,K,V)=softmax(\frac{QK^{T}}{\sqrt{d}}+B)V
Q,K,V\in\mathbb{R}^{HW\times d}
HW
d
B
CSA(Q,K,V)=softmax(\frac{qK^{T}}{\sqrt{d}})^{T}V,
q\in\mathbb{R}^{1\times d}
MCSA(Q,K,V)=Concat(head_{1},...head_{h})W^{O},
head_{i}=CSA(QW_{i}^{Q},KW_{i}^{K},VW_{i}^{V})
W_{i}^{Q}\in\mathbb{R}^{d\times\hat{d}}
W_{i}^{K}\in\mathbb{R}^{d\times\hat{d}}
W_{i}^{V}\in\mathbb{R}^{d\times\hat{d}}
h
d
\hat{d}=d/h
AP^{b}
AP^{b}_{50}
AP^{b}_{75}
+1.3\sim 2.4
+5.7\%\sim 10.5\%
