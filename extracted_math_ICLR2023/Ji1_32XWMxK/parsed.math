Q
Q
Q
Q
Q
Q
Q
Q
Q
+0.1
+1
Q
Q
Q
Q
Q
Q^{+}(s,a):=Q(s,a)+\frac{C}{(N(s,a)+1)^{M}},
N(s,a)
M,C>0
Q^{+}
Q
Q^{+}
Q
Q
Q
Q^{+}
Q
Q^{*}
Q^{+}
\mathcal{S},\mathcal{A},P,R)
\mathcal{S}
\mathcal{A}
P(\cdot|s,a)
R(\cdot|s,a)
\gamma\in[0,1)
\mathbb{E}[\sum_{t=0}^{\infty}\gamma^{t}r_{t}|r_{t}\sim R(\cdot|s_{t},a_{t})]
\pi(\cdot|s)
Q^{\pi}(s,a):=\mathbb{E}[\sum_{t=0}^{\infty}\gamma^{t}r_{t}|a_{t}\sim\pi(\cdot%
|s_{t})]
Q^{*}:=\max_{\pi}Q^{\pi}
Q
Q(s,a;\theta)\approx Q^{*}(s,a)
\theta
r_{t}
\beta/\sqrt{N(s_{t},a_{t})}
N(s_{t},a_{t})
\theta
\mathcal{L}
y_{t}
\mathcal{L}[\theta]\,:=\,\mathbb{E}\!\Big{[}\Big{(}\overbrace{r_{t}+\!{%
\textstyle\frac{\beta}{\sqrt{N(s_{t},a_{t})}}}+\gamma\max_{a^{\prime}}Q(s_{t+1%
},a^{\prime};\theta^{-})}^{y_{t}}\!-Q(s_{t},a_{t};\theta)\Big{)}^{\!2}\Big{|}%
\,(s_{t},a_{t},r_{t},s_{t+1})\!\sim\!D\Big{]}.\!\!
D
D
(s_{t},a_{t},r_{t},s_{t+1})
s_{t+1}
a_{t}
s_{t}
r_{t}
\theta^{-}
Q
Q
Q
Q
Q^{+}(s,a):=Q(s,a)+\frac{C}{(N(s,a)+1)^{M}},
Q^{+}
Q
Q
[-2,2]
[-2,2]
Q
\frac{C}{(N(s,a)+1)^{M}}
Q
H
\eta_{1}
1
Q
Q(s,a)+H\cdot\mathbbm{1}\{N(s,a)<1\}
N(s,a)
(s,a)
\mathbbm{1}
(N(s,a)+1)^{-M}
M
Q
M
Q
Q
Q
C
Q^{+}
C:=H
C:=1/(1-\gamma)
1
C
Q^{+}
N
Q^{+}
t
Q^{+}
Q
Q^{+}
Q^{+}
Q^{+}
Q^{+}
Q_{t}(s,a)\leftarrow 0,N(s,a,t)\leftarrow 0,\forall(s,a,t)\in\mathcal{S}\times%
\mathcal{A}\times\{1,...,H,H+1\}
k=1,...,K
t=1,...,H
a_{t}\leftarrow\operatorname*{arg\,max}_{a}Q_{t}^{+}(s_{t},a)
r(s_{t},a_{t},t)
s_{t+1}
N(s_{t},a_{t},t)
Q_{t}(s_{t},a_{t})\leftarrow(1-\eta_{N})Q_{t}(s_{t},a_{t})+\eta_{N}(r(s_{t},a_%
{t},t)+b_{N}^{T}+\min\{H,\max_{a^{\prime}}Q_{t+1}^{+}(s_{t+1},a^{\prime})\})
Q
0
Q^{+}
p\in(0,1)
1-p
Q^{+}
\mathcal{O}(\sqrt{H^{4}SAT\log(SAT/p)})
M\geq 1
\mathcal{O}(H^{1+M}SAT^{1-M}+\sqrt{H^{4}SAT\log(SAT/p)})
0<M<1
Q^{+}
Q
Q^{*}
H/(N(s,a)+1)^{M}
T
M>1
M\to\infty
M\geq 1
M
b^{T}_{N}
Q
\theta
Q_{\theta}
Q^{+}
a_{t}=\operatorname*{arg\,max}_{a}\big{\{}Q_{\theta}(s,a)+{\frac{C_{\text{%
action}}}{({N}(s,a)+1)^{M}}}\big{\}},
C_{\text{action}}
\epsilon
n
Q
y_{t}\!:=\!{\textstyle\sum\limits_{i=0}^{n-1}}\gamma^{i}\Big{(}r(s_{t+i},a_{t+%
i})+{\textstyle\frac{\beta}{\sqrt{{N}(s_{t+i},a_{t+i})}}}\Big{)}\!\,+\,\gamma^%
{n}\max_{a^{\prime}}\!\Big{\{}\!Q_{\theta^{-}}(s_{t+n},a^{\prime})+{\frac{C_{%
\text{bootstrap}}}{({N}(s_{t+n},a^{\prime})+1)^{M}}}\!\Big{\}}.\!\!
C_{\text{bootstrap}}
Q
Q
Q
\frac{C}{(N(s,a)+1)^{M}}
Q^{+}
Q
Q
Q
Q
Q
Q
Q
Q
Q
Q
E
E
E
\epsilon
\epsilon
\epsilon
1
0.01
\beta/\sqrt{{N}(s,a)}
Q^{+}
Q
Q^{+}
Q
n
Q
4
Q
0
10
Q
Q^{+}
C_{\text{action}}=100
4
Q
0
10
Q
Q^{+}
C_{\text{action}}=100
1/4
Q
Q^{+}
\mathcal{S},\mathcal{A},\{P_{t}\},\{R_{t}\},H,\rho
\mathcal{S}
\mathcal{A}
P_{t}(\cdot|s,a)
t=1,...,H
R_{t}(\cdot|s,a)
a
s
H
\rho
R_{t}(\cdot|s,a)\in[0,1]
S
A
N(s,a,t)
(s,a)
t
\pi_{t}:\mathcal{S}\to\mathcal{A}
\pi:=\{\pi_{t}\}
t
Q
t
\pi
Q^{\pi}_{t}(s,a):=\mathbb{E}\left[r+Q^{\pi}_{t+1}(s^{\prime},\pi_{t+1}(s^{%
\prime}))\,|\,{\scriptstyle r\sim R_{t}(\cdot|s,a),\,s^{\prime}\sim P_{t}(%
\cdot|s,a)}\right]
Q^{\pi}_{t}(s,a)=0,\forall t>H
K
T:=KH
\text{Regret}(K)=\sum_{k=1}^{K}\big{(}\max_{\pi^{*}}Q^{\pi^{*}}_{1}(s^{k}_{1},%
\pi^{*}_{1}(s^{k}_{1}))-Q^{\pi^{k}}_{1}(s^{k}_{1},\pi^{k}_{1}(s^{k}_{1}))\big{%
)}.
s_{1}^{k}
\pi^{k}
k
1-p
0<p<1
Q
1-p
\mathcal{O}(\sqrt{H^{4}SAT\log(SAT/p)}
Q
t\leq H
H
\eta_{N}=\frac{H+1}{H+N}
N:=N(s_{t},a_{t},t)
(s_{t},a_{t})
t
\eta_{1}=1
t
s_{t}
s_{t+1}
a_{t}
r_{t}
Q_{t}(s_{t},a_{t})\leftarrow(1-\eta_{N})\,Q_{t}(s_{t},a_{t})+\eta_{N}\big{(}r_%
{t}+b_{N}^{T}+\min\{H,\max_{a^{\prime}}Q_{t+1}(s_{t+1},a^{\prime})\}\big{)},
b^{T}_{N}:=2\sqrt{\frac{H^{3}\text{log}(SAT/p)}{N}}
\exists c>0
b^{T}_{N}:=c\sqrt{\frac{H^{3}\text{log}(SAT/p)}{N}}
c=2
s
\phi(s)=\text{sign}(Af(s)),
f
s
D
A
k\times D
\mathcal{N}(0,1)
k
k
\phi(s)
N(s,a)
\phi(s)
Q^{+}
\{0,...,255\}
Q
0.001
1
100
\phi(s):=(\mathbbm{1}\{x\leq s\})\in\{0,1\}^{1}00
+10
0
0
1
2
3
3
[0,1]
(24,24,1)
p=0.25
4
\gamma=0.99
0.0005
5
1
Q
100
\epsilon
0.01
\epsilon
1
0.01
\{100,50\text{k},100\text{k}\}
64
10
200
32
\beta=0.1
\{0.1,1,10\}
\{0.1,1,10\}
M\in\{0.1,0.5,2,10\},C_{\text{action}}\in\{0.1,1,10\},C_{\text{bootstrap}}\in%
\{0.01,0.1,1,10\}
\epsilon
100
0.5
C_{\text{action}}
1
C_{\text{bootstrap}}
1
2
C_{\text{action}}
10
2
C_{\text{action}}
10
C_{\text{bootstrap}}
10
M
0.1
C_{\text{action}}
10
C_{\text{bootstrap}}
1
0.5
C_{\text{action}}
1
C_{\text{bootstrap}}
1
2
C_{\text{action}}
10
C_{\text{bootstrap}}
1
10
C_{\text{action}}
10
C_{\text{bootstrap}}
10
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\mathcal{A}=4
3
Q
1
\epsilon
1
0.01
50
\epsilon
1
0.01
\{100,50\text{k},100\text{k}\}
64
250
1000
128
\beta\in\{0.01,0.1,1,10,100\}
\beta=0.1
\{0.1,1,10\}
\{0.1,1,10\}
M=2
C_{\text{action}}\in\{0.1,1,10,100\},C_{\text{bootstrap}}\in\{0.01,0.1,1,10\}
128
|\mathcal{A}|
\beta_{rnd}\in\{0.001,0.01,0.1,1,10,100\}
E
0
\beta_{dora}\in\{\}
\beta_{dora}=
\beta_{dora\_action}\in\{\}
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\rightarrow
Q
\rightarrow
\rightarrow
\rightarrow
\rightarrow
\mathcal{A}=4
K=10
\beta_{bsp}\in\{0.1,1,3,10,30,100\}
\epsilon
100
\beta=0.1
0.1
\beta_{rnd}=10
\beta_{dora}=0.01
\beta_{dora}=0.01
\beta_{dora\_action}=0.1
\beta_{bsp}=100
2
C_{\text{action}}
100
C_{\text{bootstrap}}
0.01
2
C_{\text{action}}
100
2
C_{\text{action}}
100
C_{\text{bootstrap}}
0.1
3
Q
12.5
50
\epsilon
1
0.01
1
32
4
1
8000
\beta_{mmc}\in\{0.005,0.01,0.025\}
\beta\in\{0.01,0.1,1\}
M=2
C_{\text{action}}\in\{0.1,1\},C_{\text{bootstrap}}\in\{0.01,0.1\}
\beta\in\{0.01,0.1\}
512
\beta_{rnd}\in\{0.001,0.01,0.1,1\}
K=10
\beta_{bsp}\in\{0.1,1,10,100\}
\beta=0.01,\beta_{mmc}=0.01
\beta_{rnd}=0.1,\beta_{mmc}=0.01
\beta_{bsp}=0.1,\beta_{mmc}=0.025
=2
C_{\text{action}}=0.1
C_{\text{bootstrap}}=0.01
\beta_{mmc}=0.01
=2
C_{\text{action}}=0.1,\beta_{mmc}=0.005
s
\beta_{rnd}||\text{predictor}(s)-\text{target}(s)||_{2}^{2}
E
n
n
\gamma_{E}=0.99
(\text{batch size}*4)
\frac{\beta_{dora}}{\sqrt{-\log E(s,a)}}
Q
\frac{\beta_{dora\_action}}{\sqrt{-\log E(s,a)}}
1/K
K
Q_{k}+\beta_{bsp}p_{k}
p_{k}
Q_{k}
\beta_{bsp}
3
Q
3
y_{t}
y_{mmc}:=(1-\beta_{mmc})y_{t}+\beta_{mmc}(\sum_{i=0}^{\infty}\gamma^{i}r(s_{t+%
i},a_{t+i}))
0
1000
M\in\{0.1,0.5,2,10\}
M
M\in\{0.1,0.5,2,10\}
M
\epsilon
M
0.1
M
M=0.5
M=2
Q^{+}
C_{\text{bootstrap}}=0.01
Q^{+}
C_{\text{bootstrap}}=0.01
Q
\frac{1}{(x+1)^{M}}
M
\mathbbm{1}\{x<1\}
M
x
\frac{1}{(x+1)^{M}}
M
\mathbbm{1}\{x<1\}
M
x
M
\mathbbm{1}\{x<1\}
Q
Q
Q
Q^{+}
Q
a_{t}\leftarrow\text{Uniform}\{\operatorname*{arg\,max}_{a}Q_{t}(s_{t},a)\}.
H=1
Q
Q
H=1
0.1
1
Q
H=1
0.1
1
+1
0.1
\forall a,Q_{1}(s,a)=0
Q_{1}(s,L)=\eta_{1}(\underbrace{0.1}_{\text{MDP reward}}+\underbrace{r_{\text{%
int}}}_{\text{Intrinsic Reward}}+\underbrace{b}_{\text{Bootstrap}})>0.
Q_{1}(s,L)>0=Q_{1}(s,R)
Q_{1}(s,L)
0.1
\frac{1}{2}
0.9T
M
b^{T}_{i}
b^{T}_{i}
M>0
p
\lambda>1
a\in(0,1)
p<1-a
H=1,S=1
A=2
+1
a
0
a/\lambda
p>0
\lambda
a
\lambda
M>\frac{\log(\frac{\lambda}{a})}{\log(\frac{\log(p)}{\log(1-a)})}
Q^{+}
Q
a/\lambda>0
(1-a)^{R}
R
R
0
R
(1-a)^{R}
(1-a)
0
Q
Q_{1}(s,L)=0,Q_{1}(s,R)=a/\lambda
\frac{1}{(R+1)^{M}}\geq\frac{a}{\lambda},
R
(\frac{\lambda}{a})^{1/M}
(1-a)^{R}<p
\displaystyle(1-a)^{R}<p\iff(1-a)^{(\lambda/a)^{1/M}}<p
\displaystyle(1-a)^{R}<p
\displaystyle\iff(1-a)^{(\lambda/a)^{1/M}}<p
\displaystyle\iff(\lambda/a)^{1/M}\log(1-a)<\log(p)
\displaystyle\iff(\lambda/a)^{1/M}\log(1-a)<\log(p)
\displaystyle\iff(\lambda/a)^{1/M}>\log(p)/\log(1-a)
\displaystyle\iff(\lambda/a)^{1/M}>\log(p)/\log(1-a)
\displaystyle\iff(1/M)\log(\lambda/a)>\log(\log(p)/\log(1-a))
\displaystyle\iff(1/M)\log(\lambda/a)>\log(\log(p)/\log(1-a))
\displaystyle\iff M<\log(\lambda/a)/\log(\log(p)/\log(1-a))
\displaystyle\iff M<\log(\lambda/a)/\log(\log(p)/\log(1-a))
\lambda
M>\log(\lambda/a)/\log(\log(p)/\log(1-a))
\lambda
\log(\lambda/a)
0
(1-a)^{R}
p
K
K
b^{T}_{N}
Z_{0},...,Z_{n}
\forall i\exists c_{i}:|Z_{i}-Z_{i-1}|<c_{i}
P(Z_{n}-Z_{0}\geq t)\leq\exp{\frac{-t^{2}}{2\sum_{i=1}^{n}c_{i}^{2}}}
