\epsilon=8
\{(x_{i},y_{i})\}_{i=1}^{n}
(x,y)\in\mathbb{R}^{p}\times\{1,-1\},(x-b)|y\sim\mathcal{N}(0,I_{2\times 2})
b=(1.5,0)
y=1
b=(0,1.5)
y
\epsilon=8
\{(x_{i},y_{i})\}_{i=1}^{n}
(x,y)\in\mathbb{R}^{p}\times\{1,-1\},(x-b)|y\sim\mathcal{N}(0,I_{2\times 2})
b=(1.5,0)
y=1
b=(0,1.5)
y
(\epsilon,\delta)
\mathcal{M}:\mathcal{X}\rightarrow\mathcal{Y}
(\epsilon,\delta)
X,X^{\prime}\in\mathcal{X}
Y\subset\mathcal{Y},\mathbb{P}(\mathcal{M}(X)\in Y)\leq\exp(\epsilon)\mathbb{P%
}\left(\mathcal{M}\left(X^{\prime}\right)\in Y\right)+\delta
\theta
\mathcal{B}_{t}
\theta^{(t+1)}=\theta^{(t)}-\eta_{t}\left\{\frac{1}{B}\sum_{i\in\mathcal{B}_{t%
}}\operatorname{clip}_{C}\left(\nabla\mathcal{L}_{i}\left(\theta^{(t)}\right)%
\right)+\xi\right\},
\eta_{t}
t
\mathcal{L}\left(\theta^{(t)}\right)
\operatorname{clip}_{C}\left(\nabla\mathcal{L}_{i}\left(\theta^{(t)}\right)\right)
\operatorname{clip}_{C}\left(\nabla\mathcal{L}_{i}\left(\theta^{(t)}\right)%
\right)=\nabla\mathcal{L}_{i}\left(\theta^{(t)}\right)\cdot\min\left(1,C/\|%
\nabla\mathcal{L}_{i}\left(\theta^{(t)}\right)\|_{2}\right)
\xi
\xi\sim\mathcal{N}\left(0,C^{2}\frac{\sigma^{2}}{B^{2}}I_{p}\right)
\sigma
B
p
p
Y
X
h_{\theta}
\theta
C
p
\Delta^{C-1}
y
P(Y=y\mid h_{\theta}(X)=p)=p_{y}
X
Y
k
k
h_{\theta}
\forall p^{*}\in[0,1],P\left(Y\in\arg\max p\mid\max h_{\theta}(X)=p^{*}\right)%
=p^{*},
p^{*}
p^{*}
\mathbb{E}\left[\mid p^{*}-\mathbb{E}\left[Y\in\arg\max h_{\theta}(X)\left|%
\max h_{\theta}(X)=p^{*}\right]\right|\right].
M
B_{1},\dots,B_{M}
\displaystyle\text{ECE}=\sum_{m=1}^{M}\frac{\left|B_{m}\right|}{n}\left|%
\operatorname{acc}\left(B_{m}\right)-\operatorname{conf}\left(B_{m}\right)%
\right|,
\displaystyle\text{ECE}=\sum_{m=1}^{M}\frac{\left|B_{m}\right|}{n}\left|%
\operatorname{acc}\left(B_{m}\right)-\operatorname{conf}\left(B_{m}\right)%
\right|,
\operatorname{acc}\left(B_{m}\right)=\frac{1}{\left|B_{m}\right|}\sum_{i\in B_%
{m}}\mathbf{1}\left(y_{i}=\arg\max h_{\theta}(\textbf{x}_{i})\right)
\operatorname{conf}\left(B_{m}\right)=\frac{1}{\left|B_{m}\right|}\sum_{i\in B%
_{m}}h_{\theta}(\textbf{x}_{i})
\{(\textbf{x}_{i},y_{i})\}_{i=1}^{n}
P(X,Y)
\text{conf}(B_{m})
\text{acc}(B_{m})
\text{conf}(B_{m})
\operatorname{softmax}(h_{\theta}(\textbf{x}))
g_{\phi}
\operatorname{softmax}(g_{\phi}\circ h_{\theta}(\textbf{x}))
g_{\phi}
X_{\text{recal}}
\min_{\phi}\mathbb{E}[\ell(\operatorname{softmax}(g_{\phi}\circ h_{\theta}(%
\textbf{x})),y)].
g_{\phi}
g_{\phi}(\textbf{x})=\textbf{x}/T
g_{\phi}(\textbf{x})=\mathbf{W}\textbf{x}+\mathbf{b}
\ell
(X_{\text{train}})
(X_{\text{recal}})
X_{\text{train}}
X_{\text{recal}}
g_{\phi}
X=\{\left(\mathbf{x_{1}},y_{1}\right),...,\left(\mathbf{x_{n}},y_{n}\right)\}
\alpha
h_{\theta}
g_{\phi}
X_{\text{train}},X_{\text{recal}}=\mathrm{RandomSplit}(X,\alpha)
h_{\theta}(\textbf{x})
\min_{\theta}\mathbb{E}\left[\ell\left(\operatorname{softmax}\left(h_{\theta}(%
\textbf{x})\right),y\right)\right]
X_{\text{train}}
g_{\phi}
\min_{\phi}\mathbb{E}\left[\ell\left(\operatorname{softmax}\left(g_{\phi}\circ
h%
_{\theta}(\textbf{x})\right),y\right)\right]
X_{\text{recal}}
g_{\phi}\circ h_{\theta}(\cdot)
(\epsilon,\delta)
(\epsilon,\delta)
X_{\text{train}}
X_{\text{recal}}
\epsilon=8
\epsilon=3
\epsilon=8
\epsilon=3
\epsilon=8
\epsilon=8
\times
\times
X_{\text{recal}}
X_{\text{recal}}
\epsilon=8
\epsilon=8
\epsilon=8
\epsilon=8
\epsilon=8
\epsilon=8
\epsilon
\epsilon
\epsilon
\epsilon
1\%
\epsilon
1\%
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\ell_{2}
\epsilon
\epsilon=8
\epsilon=8
\epsilon=8
M_{1}:\mathcal{X}_{1}\to\mathcal{Y}
M_{2}:\mathcal{X}_{2}\times\mathcal{Y}\to\mathcal{Z}
(\epsilon,\delta)
M:\mathcal{X}\to\mathcal{Y}\times\mathcal{Z}
\displaystyle M(X)=(y,z),\quad y=M_{1}(X_{1}),\quad z=M_{2}(X_{2},y),
\displaystyle M(X)=(y,z),\quad y=M_{1}(X_{1}),\quad z=M_{2}(X_{2},y),
(X_{1},X_{2})
X
X
(\epsilon,\delta)
X
X^{\prime}
X=(X_{1},X_{2})
X^{\prime}=(X_{1},X_{2}^{\prime})
X_{2}
X_{2}^{\prime}
M
(\epsilon,\delta)
M_{2}
(\epsilon,\delta)
X=(X_{1},X_{2})
X^{\prime}=(X_{1}^{\prime},X_{2})
X_{1}
X_{1}^{\prime}
R
M_{2}
R=r
M_{2}
M_{2}(r)
O=\cup_{o_{1}\in O_{1}}\{o_{1}\}\times O_{2}(o_{1})\subset\mathcal{Y}\times%
\mathcal{Z}
M_{2}
R=r
\displaystyle{M_{2}(r)}^{-1}(X_{2},S)=\{y\in\mathcal{Y}\mid M_{2}(r)(X_{2},y)%
\in S\}.
\displaystyle{M_{2}(r)}^{-1}(X_{2},S)=\{y\in\mathcal{Y}\mid M_{2}(r)(X_{2},y)%
\in S\}.
\displaystyle\Pr\left(M(X)\in O\mid R=r\right)=\sum_{o_{1}\in O_{1}}\Pr\left(M%
_{1}(X_{1})=o_{1}\right)\Pr\left(M_{2}(X_{2},o_{1})\in O_{2}(o_{1})\mid R=r\right)
\displaystyle\Pr\left(M(X)\in O\mid R=r\right)
\displaystyle=\sum_{o_{1}\in O_{1}}\Pr\left(M_{1}(X_{1})=o_{1}\right)\Pr\left(%
M_{2}(X_{2},o_{1})\in O_{2}(o_{1})\mid R=r\right)
\displaystyle=\sum_{o_{1}\in O_{1}}\Pr\left(M_{1}(X_{1})=o_{1}\right)\mathbbm{%
1}\left[M_{2}(r)(X_{2},o_{1})\in O_{2}(o_{1})\right]
\displaystyle=\sum_{o_{1}\in O_{1}}\Pr\left(M_{1}(X_{1})=o_{1}\right)\mathbbm{%
1}\left[M_{2}(r)(X_{2},o_{1})\in O_{2}(o_{1})\right]
\displaystyle=\sum_{o_{1}\in O_{1}}\Pr\left(M_{1}(X_{1})=o_{1},\;M_{1}(X_{1})%
\in{M_{2}(r)}^{-1}(X_{2},O_{2}(o_{1}))\right)
\displaystyle=\sum_{o_{1}\in O_{1}}\Pr\left(M_{1}(X_{1})=o_{1},\;M_{1}(X_{1})%
\in{M_{2}(r)}^{-1}(X_{2},O_{2}(o_{1}))\right)
\displaystyle=\Pr\left(M_{1}(X_{1})\in\cup_{o_{1}\in O_{1}}\left(\{o_{1}\}\cap%
{M_{2}(r)}^{-1}(X_{2},O_{2}(o_{1}))\right)\right)
\displaystyle=\Pr\left(M_{1}(X_{1})\in\cup_{o_{1}\in O_{1}}\left(\{o_{1}\}\cap%
{M_{2}(r)}^{-1}(X_{2},O_{2}(o_{1}))\right)\right)
\displaystyle\leq e^{\epsilon}\Pr\left(M_{1}(X_{1}^{\prime})\in\cup_{o_{1}\in O%
_{1}}\left(\{o_{1}\}\cap{M_{2}(r)}^{-1}(X_{2},O_{2}(o_{1}))\right)\right)+\delta
\displaystyle\leq e^{\epsilon}\Pr\left(M_{1}(X_{1}^{\prime})\in\cup_{o_{1}\in O%
_{1}}\left(\{o_{1}\}\cap{M_{2}(r)}^{-1}(X_{2},O_{2}(o_{1}))\right)\right)+\delta
\displaystyle=e^{\epsilon}\Pr\left(M(X^{\prime})\in O\mid R=r\right)+\delta.
\displaystyle=e^{\epsilon}\Pr\left(M(X^{\prime})\in O\mid R=r\right)+\delta.
R
\Pr\left(M(X)\in O\right)\leq e^{\epsilon}\Pr\left(M(X^{\prime})\in O\right)+\delta
X
X^{\prime}
10k
2*1.5
4k
C\in\{0.1,0.5,1\}
\epsilon
\epsilon
\delta
20
20
\ell_{2}
\ell_{2}
\{1e-1,1e-2,1e-3,1e-4\}
\{0.1,0.2,0.3,0.4\}
\{2,4,6,8\}
\ell_{2}
1e-1
0.1
8
1.0
0.1
10
Z\in\{100,500,1000\}
\{6,8,18\}
0.046
\tau=6.08
0.005
0.028
\epsilon=3
\epsilon=3
\epsilon=3
p\in\{0.6,0.8\}
0.2
