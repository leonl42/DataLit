\rho>0
\widetilde{O}\big{(}\frac{1}{\sqrt{n}}+\frac{\sqrt{d}}{n\rho}\big{)}
\widetilde{O}(\rho\cdot\text{Retraining Complexity})
d
n
\widetilde{O}\big{(}\frac{1}{\sqrt{n}}+\big{(}\frac{\sqrt{d}}{n\rho}\big{)}^{1%
/2}\big{)}
\widetilde{O}\big{(}\frac{1}{\sqrt{n}}+\frac{1}{(n\rho)^{2/3}}\big{)}
\widetilde{O}\big{(}\frac{1}{\sqrt{n}}+\frac{1}{(n\rho)^{1/3}}\big{)}
\hat{L}(w;S)=\frac{1}{n}\sum_{i=1}^{n}\ell(w;z_{i})
S=\bc{z_{i}}_{i=1}^{n}
w
w_{1}
\displaystyle w_{t+1}=w_{t}-\eta\nabla\hat{L}(w_{t};S)=w_{t}-\eta\br{\frac{1}{%
n}\sum_{i=1}^{n}\nabla\ell(w_{t};z_{i})}
\displaystyle w_{t+1}=w_{t}-\eta\nabla\hat{L}(w_{t};S)=w_{t}-\eta\br{\frac{1}{%
n}\sum_{i=1}^{n}\nabla\ell(w_{t};z_{i})}
\eta
z_{n}
S^{\prime}=\bc{z_{i}}_{i=1}^{n-1}
S^{\prime}
\nabla\hat{L}(w_{1};S^{\prime})=\frac{1}{n-1}\big{(}n\nabla\hat{L}(w_{1};S)-%
\nabla\ell(w_{1};z_{n})\big{)}
w_{2}^{\prime}=w_{1}-\eta\nabla\hat{L}(w_{1};S^{\prime})
w_{2}^{\prime}
w_{2}
\frac{1}{n}\sum_{i=1}^{n}\nabla\ell(w_{t};z_{i})
k
\rho
T
O(\sqrt{T}\rho)
\rho
\widetilde{O}(\rho)
\textstyle\widetilde{O}\br{\frac{1}{\sqrt{n}}+\br{\frac{\sqrt{d}}{n\rho}}^{2/3}}
\rho
O\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{d}}{n\rho}}
\widetilde{O}(\rho n)
O\br{\frac{1}{\sqrt{n}}+\frac{d^{1/4}}{\sqrt{n\rho}}}
\widetilde{O}(\rho n)
O\Big{(}\frac{1}{\sqrt{n}}+\frac{1}{\br{n\rho}^{2/3}}\Big{)}
\rho\approx{n}^{-1/4}
O(n^{3/4})
\widetilde{O}\br{\frac{1}{\sqrt{n}}+\frac{1}{\br{n\rho}^{1/3}}}
\mathsf{VR{\text{-}}FW}
\frac{1}{\sqrt{n}}+\frac{\sqrt{d}}{n\rho}
\mathsf{DA}
\frac{1}{\sqrt{n}}+\frac{d^{1/4}}{\sqrt{n\rho}}
\mathsf{JL+VR{\text{-}}FW}
\frac{1}{\sqrt{n}}+\frac{1}{\br{n\rho}^{2/3}}
\mathsf{JL+DA}
\frac{1}{\sqrt{n}}+\frac{1}{\br{n\rho}^{1/3}}
\rho
\mathsf{VR{\text{-}}FW}
\mathsf{DA}
\mathsf{JL}
\rho
\mathsf{VR{\text{-}}FW}
\mathsf{DA}
\mathsf{JL}
\textstyle\frac{1}{\sqrt{n}}+\big{(}\frac{\sqrt{d}}{n\rho}\big{)}^{\frac{2}{3}}
n
d
\rho
k
\cZ
\cW
\cM
\mathbf{A}:\cZ^{*}\rightarrow\cW\times\cM
\mathbf{U}:\cW\times\cM\times\cZ\rightarrow\cW\times\cM
\cA
\cU
\cW
\mathbf{A}
\mathbf{U}
(\mathbf{A},\mathbf{U})
S
z\in\cZ
\cE\subseteq\cW\times\cM
\mathbb{P}\br{\mathbf{A}\br{S\backslash\bc{z}}\in\cE}=\mathbb{P}\br{\mathbf{U}%
\br{\mathbf{A}(S),z}\in\cE}
(\mathbf{A},\mathbf{U})
S
z\in\cZ
\cE\subseteq\cW\times\cM
\mathbb{P}\br{\mathcal{A}\br{S\backslash\bc{z}}\in\cE}=\mathbb{P}\br{\mathcal{%
U}\br{\mathbf{A}(S),z}\in\cE}
n
P
Q
\mathsf{TV}(P,Q)=\begin{subarray}{c}\sup\\
\text{measurable}\ \cE\end{subarray}\abs{P(\cE)-Q(\cE)}.
\cA
\rho
S
S^{\prime}
\abs{S\Delta S^{\prime}}=1
\mathsf{TV}\br{\cA(S),\cA(S^{\prime})}\leq\rho
P
Q
\pi
P
Q
\pi
\mathbb{P}_{(x,y)\sim\pi}\bc{x\neq y}=\mathsf{TV}(P,Q)
P=\cA(S)
Q=\cA(S^{\prime})
P
Q
P
Q
P
Q
\rho
P
Q
P
Q
\rho
P
Q
u
u^{\prime}
r
P
r
r
Q
\mathsf{Reflect}(u,u^{\prime},r)=u-u^{\prime}+r,
Q
\cW\subset\bbR^{d}
D
\ell:\cW\times\cZ\rightarrow\bbR
\forall z\in\cZ
n
\cD
\cZ
L(w;\cD):=\underset{z\sim\cD}{\mathbb{E}}\ell(w;z).
L(w;\cD)-L(w^{*};\cD)
w^{*}
\cW
\ell(w;(x,y))=\phi_{y}\br{\ip{w}{x}}
\phi_{y}:\bbR\rightarrow\bbR
\norm{\cX}
x\in\cX\subseteq\bbR^{d}
\norm{x}\leq\norm{\cX}
\cW=\bbR^{d}
\Phi\in\bbR^{k\times d}
(\beta,\gamma)
u,v\in\bbR^{d}
1-\gamma
\mathbb{P}\br{\abs{\ip{\Phi u}{\Phi v}\!-\!\ip{u}{v}}\geq\beta\norm{u}\norm{v}%
}\!\leq\!\gamma
\cQ\subseteq\cW^{\cW^{*}\times\cZ^{*}}
\cQ
\bc{w_{i}}_{i<t}
S
\cW
\bc{U_{t}}_{t}
\cS
S
T
\bc{q_{t}(\cdot)}_{t\leq T}
q_{t}\in\cQ
\bc{U_{t}(\cdot)}_{t\leq T}
\cS(\cdot)
w_{1}\in\cW
t=1
T-1
u_{t}=q_{t}\br{\bc{w_{i}}_{i\leq t},S}
w_{t+1}=U_{t}(\bc{w_{i}}_{i\leq t},u_{t})
\hat{w}=\cS\br{\bc{w_{t}}_{t\leq T}}
q(\bc{w}_{i},S)
\abs{S}
q
\bc{w_{i}}_{i}
\rho
\frac{\mathbb{E}_{(\mathbf{A},\mathbf{U})}\left[\text{{Query complexity of %
unlearning algorithm }}\ \mathbf{U}\right]}{\mathbb{E}_{\mathbf{A}}\left[\text%
{{Query complexity of learning algorithm}}\ \ \mathbf{A}\right]}
\rho
\rho
\rho
\rho
\Theta(n)
\bc{q_{t}}_{t\geq 1}
q_{t}:\cW^{t}\times\cZ^{n}\rightarrow\cW
q_{1}(w_{1},S)=p_{1}(w_{1},z_{1})
t>1
q_{t}(\bc{w_{i}}_{i\leq t},S)=q_{t-1}(\bc{w_{i}}_{i<t},S)+p_{t}\big{(}\bc{w_{i%
}}_{i\leq t},z_{t})\big{)}
\bc{p_{t}}_{t\geq 1}
p_{t}:\cW^{*}\times\cZ\rightarrow\cW
(z_{1},z_{1}+z_{2},\ldots)
\bc{p_{t}}_{t}
q:\cW^{*}\!\times\!\cZ^{n}\!\rightarrow\!\cW
B
\displaystyle\sup_{\bc{w_{i}}_{i}}\sup_{S,S^{\prime}:\abs{S\Delta S^{\prime}}=%
1}\norm{q\br{\bc{w_{i}}_{i},S}-q\br{\bc{w_{i}}_{i},S^{\prime}}}\leq B.
\displaystyle\sup_{\bc{w_{i}}_{i}}\sup_{S,S^{\prime}:\abs{S\Delta S^{\prime}}=%
1}\norm{q\br{\bc{w_{i}}_{i},S}-q\br{\bc{w_{i}}_{i},S^{\prime}}}\leq B.
n
n
\cT
\sum_{i=1}^{7}p_{i}(\bc{w_{j}}_{j\leq i},z_{i})
7
4,2
1
\displaystyle\big{(}{\sum_{i=1}^{4}p_{i}(\bc{w_{j}}_{j\leq i},z_{i})+\xi_{1}}%
\big{)}+\big{(}{\sum_{i=5}^{6}p_{i}(\bc{w_{j}}_{j\leq i},z_{i})\xi_{2}}\big{)}
\displaystyle\big{(}{\sum_{i=1}^{4}p_{i}(\bc{w_{j}}_{j\leq i},z_{i})+\xi_{1}}%
\big{)}+\big{(}{\sum_{i=5}^{6}p_{i}(\bc{w_{j}}_{j\leq i},z_{i})\xi_{2}}\big{)}
\displaystyle+\big{(}{p_{7}(\bc{w_{j}}_{j\leq i},z_{i})+\xi_{3}}\big{)},
\displaystyle+\big{(}{p_{7}(\bc{w_{j}}_{j\leq i},z_{i})+\xi_{3}}\big{)},
\xi_{i}
B=\bc{0,1}^{\log n}
\cT=\bc{v_{b}}_{b\in B}
(u,r,w,z)
u\in\bbR^{d}
r\in\bbR^{d}
w\in\bbR^{d}
z\in\cZ
\mathsf{leaf}:[n]\rightarrow\bc{0,1}^{\log{n}}
\mathsf{Append}(u,\sigma;\cT)
\cT
u
u+\cN(0,\sigma^{2}\bbI)
u
u_{b}
v_{b}
r_{b}
\mathsf{GetPrefixSum}(t;\cT)
t\in\bbN
t
\cT
t
\mathsf{Get}(b;\cT)
b\in\bc{0,1}^{\log{n}}
\cT
b
\mathsf{Set}(b,v;\cT)
b\in\bc{0,1}^{\log{n}}
b
\cT
v
+\xi_{8}
+\xi_{4}
+\xi_{2}
p_{1}(w_{0})
~{}+~{}\xi_{1}
z_{7}
p_{2}(w_{\leq 1})
z_{2}
p_{3}(w_{\leq 2})
~{}+~{}\xi_{3}
z_{1}
p_{4}(w_{\leq 3})
z_{5}
+\xi_{6}
p_{5}(w_{\leq 4})
+~{}\xi_{5}
z_{4}
p_{6}(w_{\leq 5})
z_{3}
p_{7}(w_{\leq 6})
+~{}\xi_{7}
z_{6}
p_{8}(w_{\leq 7})
z_{8}
-{\color[rgb]{0.2,0.2,1}g}+{\color[rgb]{1,0.2,0.2}\ g^{\prime}}
+\xi_{4}
+\xi_{2}
p_{1}(w_{0})
~{}~{}+~{}\xi_{1}
z_{7}
p_{2}(w_{\leq 1})
z_{2}
p_{3}(w_{\leq 2})
~{}~{}+~{}\xi_{3}
z_{1}
p_{4}(w_{\leq 3})
z_{5}
-{\color[rgb]{0.2,0.2,1}g}+{\color[rgb]{1,0.2,0.2}\ g^{\prime}}
-{\color[rgb]{0.2,0.2,1}g}+{\color[rgb]{1,0.2,0.2}\ g^{\prime}}
-{\color[rgb]{0.2,0.2,1}g}+{\color[rgb]{1,0.2,0.2}\ g^{\prime}}
z_{4}
z_{8}
p_{6}(w_{\leq 5})
z_{3}
p_{7}(w_{\leq 6})
~{}~{}+~{}\xi_{7}
z_{6}
p_{8}(w_{\leq 7})
z_{8}
+\xi_{i}
{\color[rgb]{0.5,0.5,1}z_{i}}
{\color[rgb]{0.5,0.5,1}z_{4}}
{\color[rgb]{1,0.5,0.5}z_{8}}
-{\color[rgb]{0.5,0.5,1}g}+{\color[rgb]{1,0.5,0.5}g^{\prime}}
i
+\xi_{i}
{\color[rgb]{0.5,0.5,1}z_{i}}
{\color[rgb]{0.5,0.5,1}z_{4}}
{\color[rgb]{1,0.5,0.5}z_{8}}
-{\color[rgb]{0.5,0.5,1}g}+{\color[rgb]{1,0.5,0.5}g^{\prime}}
i
\mathsf{TreeLearn}(t_{0};\cT)
\mathsf{TreeLearn}(t_{0};\cT)
S
T
B
\bc{p_{t}}_{t\leq T}
\bc{U_{t}}_{t\leq T}
\sigma
t_{0}=1
\cT
\br{\cdot,\cdot,w_{t_{0}},\cdot}=\mathsf{Get}(\mathsf{leaf}(t_{0});\cT)
t=t_{0}
\abs{S}-1
u_{t}=p_{t}(\bc{w_{t}}_{i\leq t},z_{t})
\mathsf{Append}(u_{t},\sigma;\cT)
r_{t}=\mathsf{GetPrefixSum}(t;\cT)
w_{t+1}=U_{t}\br{\bc{w_{t}}_{\leq t},r_{t}}
\mathsf{Set}(\mathsf{leaf}(t),\br{u_{t},r_{t},w_{t},z_{t}};\cT)
\hat{w}=\cS\br{\bc{w_{t}}_{t}}
\mathsf{TreeUnlearn}
\mathsf{TreeUnlearn}
z_{j}
\cT
s=\mathsf{leaf}(j)
l=\mathsf{leaf}(\abs{S})
\br{\cdot,\cdot,w,z}=\mathsf{Get}(s;\cT)
\br{\cdot,\cdot,\cdot,z^{\prime}}=\mathsf{Get}({l};\cT)
g=p_{j}(\bc{w_{q}}_{q\leq s},z)
g^{\prime}=p_{j}(\bc{w_{q}}_{q\leq s},z^{\prime})
\mathsf{path}=\bc{{l}\rightarrow\cdots\rightarrow\text{root}}
{l}
b\in\mathsf{path}
u_{b}=u_{b}-g^{\prime}
{l}
\cT
b=s
\text{ct}=1
j=\abs{S}
b=\emptyset
b\neq\emptyset
(u,r,\cdot,\cdot)=\mathsf{Get}(b;\cT)
u^{\prime}=u-g+g^{\prime}
\mathsf{Unif}\br{0,1}\leq\frac{\phi_{\cN(u,\sigma^{2}\bbI)}(r)}{\phi_{\cN(u^{%
\prime},\sigma^{2}\bbI)}(r)}
b=s
\mathsf{Set}(b,\br{u^{\prime},r,w,z^{\prime}};\cT)
\mathsf{Set}(b,\br{u^{\prime},r,\emptyset,\emptyset};\cT)
r^{\prime}=\mathsf{Reflect}(u,u^{\prime},r)
b=s
\mathsf{Set}(b;\br{u^{\prime},r^{\prime},\emptyset,z^{\prime}};\cT)
w^{\prime}=U_{j}\br{\bc{w_{q}}_{q\leq b},\mathsf{GetPrefixSum}(j;\cT)}
\mathsf{Set}(b,\br{u^{\prime},r^{\prime},w^{\prime},z^{\prime}};\cT)
\mathsf{Set}(b,\br{u^{\prime},r^{\prime},\emptyset,\emptyset};\cT)
\mathsf{TreeLearn}(j+\text{ct};\cT)
b
\text{ct}=\text{ct}+2^{\abs{s}-\abs{b}-1}
b
b
S=S\backslash\bc{z_{j}}
\hat{w}=\cS(\bc{w_{b}}_{b})
z_{j}
v_{s}
z_{j}
z
z_{j}
z^{\prime}
v_{l}
z^{\prime}
v_{l}
v_{l}
z
z^{\prime}
z
v_{s}
\log{n}
v_{s}
v_{s}
z
z^{\prime}
g=p_{j}(\bc{w_{q}}_{q\leq s},z)
g^{\prime}=p_{j}(\bc{w_{q}}_{q\leq s},z^{\prime})
v_{s}
z
u
z^{\prime}
u^{\prime}=u-g^{\prime}+g
\cN(0,\sigma^{2}\bbI)
u
r
\cN(u^{\prime},\sigma^{2}\bbI)
\cN(u^{\prime},\sigma^{2}\bbI)
r
r
\cN(u^{\prime},\sigma^{2}\bbI)
r
\cN(u^{\prime},\sigma^{2}\bbI)
r
u
u^{\prime}
\frac{\phi_{\cN(u,\sigma^{2}\bbI)}(r)}{\phi_{\cN(u^{\prime},\sigma^{2}\bbI)}(r)}
v_{s}
r^{\prime}
\sigma^{2}=\frac{64B^{2}\text{log}^{2}(n)}{\rho}
\rho
\widetilde{O}\br{\rho}
w\mapsto\ell(w;z)
H
G
z
x\mapsto f(x)
G
H
\abs{f(x_{1})-f(x_{2})}\leq G\norm{x_{1}-x_{2}}
\norm{\nabla f(x_{1})-\nabla f(x_{2})}\leq H\norm{x_{1}-x_{2}}
u_{t}
\gamma_{t}=\frac{1}{t+1}
\displaystyle u_{t}=\br{1-\gamma_{t}}\br{u_{t-1}+\nabla\ell(w_{t};z_{t})-%
\nabla\ell(w_{t-1};z_{t})}+\gamma_{t}\nabla\ell(w_{t};z_{t})
\displaystyle u_{t}
\displaystyle=\br{1-\gamma_{t}}\br{u_{t-1}+\nabla\ell(w_{t};z_{t})-\nabla\ell(%
w_{t-1};z_{t})}+\gamma_{t}\nabla\ell(w_{t};z_{t})
\displaystyle=\frac{1}{t+1}\sum_{i=1}^{t}\br{\br{i+1}\nabla\ell(w_{i};z_{i})-i%
\nabla\ell(w_{i-1};z_{i})}
\displaystyle=\frac{1}{t+1}\sum_{i=1}^{t}\br{\br{i+1}\nabla\ell(w_{i};z_{i})-i%
\nabla\ell(w_{i-1};z_{i})}
B=2\br{HD+G}
\rho\leq 1
\ell:\cW\times\cZ\rightarrow\bbR
H
G
\cW
D
\sigma^{2}=\frac{64\br{HD+G}^{2}\text{log}^{2}(n)}{\rho^{2}}
t_{0}=1
\eta_{t}=\frac{1}{t+1}
S
n
\cD
\hat{w}
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\br{\br{G+HD}D\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{d}}{n\rho}}}.
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\br{\br{G+HD}D\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{d}}{n\rho}}}.
\widetilde{O}\br{\rho n}
w\mapsto\ell(w;z)
G
\forall\ z\in\cZ
\displaystyle w_{t+1}=\Pi_{\cW}\Big{(}w_{0}-\eta\sum_{i=1}^{t}\nabla\ell(w_{i}%
;z_{i})\Big{)},
\displaystyle w_{t+1}=\Pi_{\cW}\Big{(}w_{0}-\eta\sum_{i=1}^{t}\nabla\ell(w_{i}%
;z_{i})\Big{)},
\Pi
\cW
G
\rho\leq 1
\ell:\cW\times\cZ\rightarrow\bbR
G
\cW
D
\sigma^{2}=\frac{64G^{2}\text{log}^{2}(n)}{\rho^{2}}
t_{0}=1
\eta=\frac{Dd^{1/4}\sqrt{\log{n}}}{G\sqrt{n\rho}}
S
n
\cD
\hat{w}
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\Bigg{(}GD\Bigg{(}\frac{1}{\sqrt{n}}+\sqrt{\frac{\sqrt{d}}{n\rho}}\Bigg{)}%
\Bigg{)}.
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\Bigg{(}GD\Bigg{(}\frac{1}{\sqrt{n}}+\sqrt{\frac{\sqrt{d}}{n\rho}}\Bigg{)}%
\Bigg{)}.
\widetilde{O}\br{\rho n}
S
\ell
\cA
\Phi\in\bbR^{d\times k}
\sigma^{2}
\Phi S=\bc{\Phi x_{i}}_{i=1}^{n}
\widetilde{w}=\cA(\ell,\Phi S,2G\norm{\cX},2H\norm{\cX}^{2},\sigma)
\hat{w}=\Phi^{\top}\widetilde{w}
\Phi
\phi_{y}:\bbR\rightarrow\bbR
H
G
y\in\cY
\rho\leq 1
\ell:\cW\times\cX\times\cY\rightarrow\bbR
H
G
\sigma^{2}=\widetilde{O}\br{\frac{\br{H\norm{\cX}^{2}\norm{w^{*}}+G\norm{\cX}}%
^{2}}{\rho^{2}}}
t_{0}=1
\eta_{t}=\frac{1}{t+1}
k=\widetilde{O}\br{\br{\frac{H\norm{\cX}^{2}\norm{w^{*}}}{\br{H\norm{\cX}^{2}%
\norm{w^{*}}+G\norm{\cX}}}}^{2/3}\br{n\rho}^{2/3}}
S
n
\cD
\hat{w}
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\Bigg{(}\frac{\br{G\norm{\cX}+H\norm{\cX}^{2}\norm{w^{*}}}\norm{w^{*}}}{\sqrt{%
n}}
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\Bigg{(}\frac{\br{G\norm{\cX}+H\norm{\cX}^{2}\norm{w^{*}}}\norm{w^{*}}}{\sqrt{%
n}}
\displaystyle+\frac{H^{1/3}G^{2/3}\norm{w^{*}}^{4/3}\norm{\cX}^{4/3}+H\norm{%
\cX}^{2}\norm{w^{*}}^{2}}{(n\rho)^{2/3}}\Bigg{)}.
\displaystyle+\frac{H^{1/3}G^{2/3}\norm{w^{*}}^{4/3}\norm{\cX}^{4/3}+H\norm{%
\cX}^{2}\norm{w^{*}}^{2}}{(n\rho)^{2/3}}\Bigg{)}.
\widetilde{O}\br{\rho n}
\phi_{y}:\bbR\rightarrow\bbR
G
y\in\cY
\rho\leq 1
\ell:\cW\times\cX\times\cY\rightarrow\bbR
G
\sigma^{2}=O\br{\frac{G^{2}\norm{\cX}^{2}}{\rho^{2}}}
t_{0}=1
\eta=\frac{\norm{w^{*}}d^{1/4}\sqrt{\log{n}}}{G\norm{\cX}\sqrt{n\rho}}
k=\sqrt{n\rho}
S
n
\cD
\hat{w}
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\Big{(}G\norm{\cX}\norm{w^{*}}\Big{(}\frac{1}{\sqrt{n}}+\frac{1}{\br{n\rho}^{1%
/3}}\Big{)}\Big{)}.
\displaystyle\mathbb{E}\left[L(\hat{w};\cD)-L(w^{*};\cD)\right]=\widetilde{O}%
\Big{(}G\norm{\cX}\norm{w^{*}}\Big{(}\frac{1}{\sqrt{n}}+\frac{1}{\br{n\rho}^{1%
/3}}\Big{)}\Big{)}.
\widetilde{O}\br{\rho n}
\rho
S
\alpha(\rho,\abs{S};\cP)
\cP
\sigma^{2}
n
\rho
\rho/2
\rho/4
\rho
n
n
n
\Theta(n)
n
R
\hat{w}_{i}
i
S_{i}
\mathbb{E}[L(\hat{w}_{i};\cD)]-\min_{w}L(w;\cD)=\alpha(\rho,\abs{S_{i}};\cP)
V
\widetilde{O}(\rho V)
V
R
\cA
(\alpha,\epsilon(\alpha))
S
S^{\prime}
\abs{S\Delta S^{\prime}}=1
\alpha
\cA(S)
\cA(S^{\prime})
\phi_{\cA(S)}
\phi_{\cA(S^{\prime})}
\displaystyle D_{\alpha}\br{\cA(S)\|\cA(S^{\prime})}=\frac{1}{\alpha-1}\ln{\br%
{\int_{\text{Range}(\cA)}\phi_{\cA(S)}(x)^{\alpha}\phi_{\cA(S^{\prime})}(x)^{1%
-\alpha}dx}}
\displaystyle D_{\alpha}\br{\cA(S)\|\cA(S^{\prime})}=\frac{1}{\alpha-1}\ln{\br%
{\int_{\text{Range}(\cA)}\phi_{\cA(S)}(x)^{\alpha}\phi_{\cA(S^{\prime})}(x)^{1%
-\alpha}dx}}
D_{\alpha}(\cA(S)\|\cA(S^{\prime}))\leq\epsilon(\alpha)
\implies
(\alpha,\epsilon(\alpha))
\textstyle\Big{(}1-\textrm{exp}\Big{(}{-\underset{\alpha\downarrow 1}{\lim}~{}%
\epsilon(\alpha)}\Big{)}\Big{)}^{\frac{1}{2}}
\underset{\alpha\downarrow 1}{\lim}\D_{\alpha}(P\|Q)=\text{KL}\br{P\|Q}
KL(\cdot\|\cdot)
q:\cW^{*}\times\cZ^{n}\rightarrow\cW
q\br{\bc{w_{i}}_{i};S}=\sum_{j\in S}p_{j}\br{\bc{w_{i}}_{i};z_{j}}
p_{j}:\cW^{*}\times\cZ\rightarrow\cW
B
\mathsf{LearnLinearQueries}(w_{t_{0}},t_{0})
\mathsf{LearnLinearQueries}(w_{t_{0}},t_{0})
S
t_{0}
T
\bc{q_{t}(\cdot)}_{t\leq T}
\bc{U_{t}(\cdot)}_{t\leq T}
\cS(\cdot)
\sigma^{2}
w_{1}\in\cW
t=t_{0}
T-1
u_{t}=q_{t}\br{\bc{w_{i}}_{i\leq t};S}
r_{t}=u_{t}+\xi_{t}
\xi_{t}\sim\cN(0,\sigma^{2}\bbI_{d})
w_{t+1}=U_{t}(\bc{w_{i}}_{i\leq t},r_{t})
\mathsf{Save}\br{u_{t},r_{t},w_{t+1}}
\hat{w}=\cS\br{\bc{w_{t}}_{t\leq T}}
z_{j}
t=1
T-1
\br{u_{t},r_{t},w_{t}}=\mathsf{Load}\br{}
u_{t}^{\prime}=u_{t}-p^{j}_{t}\br{\bc{w_{i}}_{i\leq t};z_{j}}
\mathsf{Unif}\br{0,1}\leq\frac{\phi_{\cN(u_{t},\sigma^{2}\bbI)}\br{r_{t}}}{%
\phi_{\cN(u_{t}^{\prime},\sigma^{2}\bbI)}\br{r_{t}}}
\mathsf{Save}\br{u_{t}^{\prime}}
r_{t}^{\prime}=\mathsf{reflect}(r_{t},u_{t},u_{t}^{\prime})
w_{t+1}=U_{t}\br{\bc{w_{i}}_{i\leq t},r_{t}^{\prime}}
\mathsf{LearnLinearQueries}(w_{t+1},t+1)
\sigma^{2}=\frac{64B^{2}}{n^{2}\rho^{2}}
\rho
O\br{\rho\sqrt{T}}
C
\bc{w_{t}^{c}}_{c=1}^{C}
\displaystyle w_{t}=\frac{1}{C}\sum_{c=1}^{C}w_{t}^{c}.
\displaystyle w_{t}=\frac{1}{C}\sum_{c=1}^{C}w_{t}^{c}.
w_{t}
\cP
C
T
\cP
w_{1}\in\cW
t=1
T-1
c=1
C
w^{c}_{t+1}=\mathsf{ClientUpdate}\br{c,w_{t-1},\cP}
w_{t+1}=\frac{1}{C}\sum_{c=1}^{C}w_{t+1}^{c}
\hat{w}=\cS\br{\bc{w_{t}}_{t\leq T}}
k
k
k
C
T
S=\bc{z_{i}}_{i=1}^{n}
\bc{w_{c}}_{c=1}^{C}
t=1
T-1
c=1
C
S_{c}=\bc{z^{c}_{1},z^{c}_{2},\ldots z^{c}_{\abs{S_{c}}}}
w_{c}
c=1
C
w_{c}=\frac{1}{\abs{S_{c}}}\sum_{i=1}^{\abs{S_{c}}}z^{c}_{i}
\bc{w_{c}}_{c=1}^{C}
(u,\sigma;\cT)
(u,\sigma;\cT)
u
\sigma
\cT
s
q
1
s
\mathsf{path}=\bc{s\rightarrow\cdots\text{root}}
s
q+1
\mathsf{UpdateTree}(u,\mathsf{path},\sigma;\cT)
(u,\mathsf{path},\sigma;\cT)
(u,\mathsf{path},\sigma;\cT)
u
\mathsf{path}
\sigma
\cT
b\in\mathsf{path}
u_{b}=u_{b}+u
b
b
\xi\sim\cN(0,\sigma^{2}\bbI)
r_{b}=u_{b}+\xi
(t;\cT)
(t;\cT)
t\in\bbN
\cT
g\in\bbR^{p}
0
s\leftarrow\mathsf{leaf}(t)
\mathsf{path}
s
b\neq\emptyset
b
b
g=g+r_{b}
g
Q
T=n
\log{n}\rho
S
S^{\prime}
P
Q
\mathfrak{T}=\br{\bbR^{d}\times\bbR^{d}\times\bbR^{d}\times[n]}^{n}
S
S^{\prime}
v
v^{\prime}
s
s^{\prime}
v\leq v
s\leq s^{\prime}
b
P_{b}\br{\cdot|\cT_{\leq b}}
\mathbf{p}
[n]
p_{b}
b
b
\mu
\mathbf{p}
p_{b}
\mu(\mathbf{p})
\mu(p_{b}|p_{\leq b})
\mathbf{p}
p_{b}
\cT^{(1)}
S
\cT^{(2)}
P^{\mathbf{p}}
Q^{\mathbf{p}}
P
Q
\mathbf{p}
P
\displaystyle\phi_{P}\br{\cT^{(1)}}=\prod_{b\in B}\phi_{P_{b}}\br{v^{(1)}_{b}|%
\cT^{(1)}_{\leq b}}=\prod_{b\in B}\mu(p_{b}^{(1)}|p^{(1)}_{\leq b})\phi_{P^{p^%
{(1)}_{\leq b}}_{b}}\br{u^{(1)}_{b},r^{(1)}_{b},w^{(1)}_{b}|\cT^{(1)}_{\leq b}}
\displaystyle\phi_{P}\br{\cT^{(1)}}=\prod_{b\in B}\phi_{P_{b}}\br{v^{(1)}_{b}|%
\cT^{(1)}_{\leq b}}=\prod_{b\in B}\mu(p_{b}^{(1)}|p^{(1)}_{\leq b})\phi_{P^{p^%
{(1)}_{\leq b}}_{b}}\br{u^{(1)}_{b},r^{(1)}_{b},w^{(1)}_{b}|\cT^{(1)}_{\leq b}}
\mathbf{p}^{(1)}
\displaystyle\phi_{P}^{\mathbf{p}^{(1)}}(\cT^{(1)})=\prod_{b\in B}\phi_{P_{b}^%
{\mathbf{p}^{(1)}_{\leq b}}}\br{u^{(1)}_{b},r^{(1)}_{b},w^{(1)}|\cT_{\leq b}^{%
(1)}}
\displaystyle\phi_{P}^{\mathbf{p}^{(1)}}(\cT^{(1)})=\prod_{b\in B}\phi_{P_{b}^%
{\mathbf{p}^{(1)}_{\leq b}}}\br{u^{(1)}_{b},r^{(1)}_{b},w^{(1)}|\cT_{\leq b}^{%
(1)}}
\widetilde{\cT}^{(1)}
\widetilde{\cT}^{(2)}
\br{r_{b}}_{b}
\widetilde{P}
\widetilde{P}_{b}
\widetilde{P}^{\mathbf{p}}
\widetilde{P}_{b}^{\mathbf{p}}
\widetilde{Q}
\widetilde{Q}_{b}
\widetilde{Q}^{\mathbf{p}}
\widetilde{Q}_{b}^{\mathbf{p}}
\widetilde{\cT}
0<\rho\leq 1,B\geq 0,n\in\bbN
B
\sigma^{2}=\frac{64B^{2}\text{log}^{2}(n)}{\rho^{2}}
\widetilde{\cT}
\rho
\epsilon(\alpha)\leq\text{log}^{2}(n)\cdot\frac{64\alpha B^{2}}{\sigma^{2}}%
\alpha\rho^{2}
\rho\leq 1
j
n
\mathbf{p}^{(1)}
\mathbf{p}^{(2)}
E\subseteq[n]^{n}
E^{\prime}\subseteq[n-1]^{n-1}
\displaystyle\mathbb{P}_{\mathbf{p}^{(1)}}\br{\mathbf{p}^{(1)}\in E}=\mu_{n}(E)
\displaystyle\mathbb{P}_{\mathbf{p}^{(1)}}\br{\mathbf{p}^{(1)}\in E}=\mu_{n}(E)
\displaystyle\mathbb{P}_{\mathbf{p}^{(2)}}\br{\mathbf{p}^{(2)}\in E^{\prime}}=%
\mu_{n-1}(E^{\prime})
\displaystyle\mathbb{P}_{\mathbf{p}^{(2)}}\br{\mathbf{p}^{(2)}\in E^{\prime}}=%
\mu_{n-1}(E^{\prime})
\mathbf{p}^{(1)}
\mathbf{p}^{(2)}
\mathbf{p}^{(1)}\sim\mu_{n}
h=\br{h_{i}}_{i=1}^{n-1}
h_{i}\in[n-1]
[h,j]
h
j
\displaystyle\mathbb{P}_{\mathbf{p}^{(2)}}\br{h}=\frac{1}{n+1}\mathbb{P}_{%
\mathbf{p}^{(1)}}\br{[h,j]}=\mu_{n-1}(h)
\displaystyle\mathbb{P}_{\mathbf{p}^{(2)}}\br{h}=\frac{1}{n+1}\mathbb{P}_{%
\mathbf{p}^{(1)}}\br{[h,j]}=\mu_{n-1}(h)
E\subseteq\R^{d\abs{\cT^{(2)}}}
\mathbb{P}\br{\widetilde{\cT}^{(2)}\in E|\mathbf{p}^{(1)},\mathbf{p}^{(2)}}=%
\widetilde{Q}^{\mathbf{p}^{(2)}}(E).
\widetilde{\cT}^{(2)}
\br{v^{(1)}_{b}}_{b}
\br{v^{(2)}_{b}}_{b}
j
s=\mathsf{leaf}(j)
\mathsf{prefix}(s)
\mathsf{suffix}(s)
s
\leq
E\subseteq\bbR^{d\abs{\widetilde{\cT}^{(2)}}}
r_{\leq b}
E^{r_{\leq b}}_{b}
\displaystyle E^{r_{\leq b}}_{b}=\bc{e\in\bbR^{d}:\exists\mathbf{\overline{e}}%
\in\br{\times_{>b}\bbR^{d}}:\br{r_{\leq b},e,\mathbf{\overline{e}}}\in E}
\displaystyle E^{r_{\leq b}}_{b}=\bc{e\in\bbR^{d}:\exists\mathbf{\overline{e}}%
\in\br{\times_{>b}\bbR^{d}}:\br{r_{\leq b},e,\mathbf{\overline{e}}}\in E}
\times_{>b}\bbR^{d}
\bbR^{d}
>b
\abs{\cT^{(1)}}
E^{r_{\leq b}}_{\geq b}
\displaystyle E^{r_{\leq b}}_{\geq b}=\bc{\mathbf{e}\in\br{\times_{\geq b}\bbR%
^{d}}:\br{{r_{\leq b}},\mathbf{e}}\in E}
\displaystyle E^{r_{\leq b}}_{\geq b}=\bc{\mathbf{e}\in\br{\times_{\geq b}\bbR%
^{d}}:\br{{r_{\leq b}},\mathbf{e}}\in E}
E_{<b}
\displaystyle E_{<b}=\bc{\mathbf{e}\in\br{\times_{<b}\bbR^{d}}:\exists\mathbf{%
\overline{e}}\in\br{\times_{\geq b}\bbR^{d}}:\br{\mathbf{e},\mathbf{\overline{%
e}}}\in E}
\displaystyle E_{<b}=\bc{\mathbf{e}\in\br{\times_{<b}\bbR^{d}}:\exists\mathbf{%
\overline{e}}\in\br{\times_{\geq b}\bbR^{d}}:\br{\mathbf{e},\mathbf{\overline{%
e}}}\in E}
\displaystyle\mathbb{P}\br{\widetilde{\cT}^{(2)}\in E|\mathbf{p}^{(1)},\mathbf%
{p}^{(2)}}=\prod_{b\in\mathsf{prefix}(s)}\mathbb{P}\br{r_{b}^{(2)}\in E_{b}^{r%
_{<b}^{(2)}}|p_{b}^{(2)},r^{(2)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{%
\geq s}\in E^{r_{<s}^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1%
)},\mathbf{p}^{(2)}}
\displaystyle\mathbb{P}\br{\widetilde{\cT}^{(2)}\in E|\mathbf{p}^{(1)},\mathbf%
{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}\mathbb{P}\br{r_{b}^{(2)}\in E_{b}%
^{r_{<b}^{(2)}}|p_{b}^{(2)},r^{(2)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{%
\geq s}\in E^{r_{<s}^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1%
)},\mathbf{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}\mathbb{P}\br{r_{b}^{(1)}\in E_{b}%
^{r_{<b}^{(1)}}|p_{b}^{(1)},r^{(1)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{%
\geq s}\in E^{r_{<s}^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1%
)},\mathbf{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}\mathbb{P}\br{r_{b}^{(1)}\in E_{b}%
^{r_{<b}^{(1)}}|p_{b}^{(1)},r^{(1)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{%
\geq s}\in E^{r_{<s}^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1%
)},\mathbf{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}P_{b}\br{E_{b}^{r_{<b}^{(1)}}|p_{b%
}^{(1)},r^{(1)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\geq s}\in E^{r_{<s}%
^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}P_{b}\br{E_{b}^{r_{<b}^{(1)}}|p_{b%
}^{(1)},r^{(1)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\geq s}\in E^{r_{<s}%
^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}Q_{b}\br{E_{b}^{r_{<b}^{(2)}}|p_{b%
}^{(2)},r^{(2)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\geq s}\in E^{r_{<s}%
^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle=\prod_{b\in\mathsf{prefix}(s)}Q_{b}\br{E_{b}^{r_{<b}^{(2)}}|p_{b%
}^{(2)},r^{(2)}_{<b}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\geq s}\in E^{r_{<s}%
^{(2)}}_{\geq s}|\widetilde{\cT}^{(2)}_{<s},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle=Q_{<s}\br{E_{<s}|p_{<s}^{(2)},r^{(2)}_{<s}}\mathbb{P}\br{%
\widetilde{\cT}^{(2)}_{\geq s}\in E^{r_{<s}^{(2)}}_{\geq s}|\widetilde{\cT}^{(%
2)}_{<s},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle=Q_{<s}\br{E_{<s}|p_{<s}^{(2)},r^{(2)}_{<s}}\mathbb{P}\br{%
\widetilde{\cT}^{(2)}_{\geq s}\in E^{r_{<s}^{(2)}}_{\geq s}|\widetilde{\cT}^{(%
2)}_{<s},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
r^{(1)}_{\leq b}=r^{(2)}_{\leq b}
p^{(1)}_{b}=p^{(2)}_{b}
b<s
r^{(1)}_{b}
P_{b}
Q_{<s}
I
I=s
s
\mathsf{prefix}(s)
Q_{<s}=Q
I=s+1
\widetilde{\cT}^{(2)}_{\geq s}=\widetilde{\cT}^{(2)}_{s}=r_{s}^{(2)}
r^{(1)}_{s}
\cN(u^{(1)},\sigma^{2}\bbI)
r^{(2)}_{s}
\cN(u^{(2)},\sigma^{2}\bbI)
\displaystyle\mathbb{P}\br{r_{s}^{(2)}\in E_{s}^{r^{(2)}_{<s}}|\mathbf{p}^{(1)%
},\mathbf{p}^{(2)}}=Q^{p^{(2)}_{s}}_{s}\br{E_{s}^{r^{(2)}_{<s}}}
\displaystyle\mathbb{P}\br{r_{s}^{(2)}\in E_{s}^{r^{(2)}_{<s}}|\mathbf{p}^{(1)%
},\mathbf{p}^{(2)}}=Q^{p^{(2)}_{s}}_{s}\br{E_{s}^{r^{(2)}_{<s}}}
\displaystyle\mathbb{P}\br{\widetilde{\cT}^{(2)}\in E|\mathbf{p}^{(1)},\mathbf%
{p}^{(2)}}=Q_{<s}\br{E_{<s}|p_{<s}^{(2)},r_{<s}^{(2)}}\widetilde{Q}_{s}^{p_{s}%
^{(2)}}\br{E_{s}^{r^{(2)}_{<s}}}=\widetilde{Q}^{\mathbf{p}^{(2)}}(E)
\displaystyle\mathbb{P}\br{\widetilde{\cT}^{(2)}\in E|\mathbf{p}^{(1)},\mathbf%
{p}^{(2)}}=Q_{<s}\br{E_{<s}|p_{<s}^{(2)},r_{<s}^{(2)}}\widetilde{Q}_{s}^{p_{s}%
^{(2)}}\br{E_{s}^{r^{(2)}_{<s}}}=\widetilde{Q}^{\mathbf{p}^{(2)}}(E)
I=k
E
\displaystyle\mathbb{P}\br{\cT^{(2)}_{\leq k}\in E|\mathbf{p}^{(1)},\mathbf{p}%
^{(2)}}=\widetilde{Q}_{\leq{k}}\br{E|\mathbf{p}^{(2)}}
\displaystyle\mathbb{P}\br{\cT^{(2)}_{\leq k}\in E|\mathbf{p}^{(1)},\mathbf{p}%
^{(2)}}=\widetilde{Q}_{\leq{k}}\br{E|\mathbf{p}^{(2)}}
k+1
\mathsf{A}
k
\mathsf{AP}
k+1
s
\mathsf{APA}
\mathsf{APR}
\mathsf{AN}
k+1
s
\mathsf{R}
\mathsf{R}
r^{(2)}_{k+1}\sim\widetilde{Q}_{k+1}(\cdot|\widetilde{\cT}^{(2)}_{\leq k},%
\mathbf{p}^{(2)})
\mathsf{AN}
r_{k+1}^{(2)}=r_{k+1}^{(1)}
\displaystyle\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1}|\mathsf%
{AN},\cT^{(2)}_{\leq k},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}=\widetilde{P}_{k+1}%
\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}%
}=\widetilde{Q}_{k+1}\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(2)},%
\widetilde{\cT}^{(2)}_{\leq k}}
\displaystyle\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1}|\mathsf%
{AN},\cT^{(2)}_{\leq k},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}=\widetilde{P}_{k+1}%
\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}%
}=\widetilde{Q}_{k+1}\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(2)},%
\widetilde{\cT}^{(2)}_{\leq k}}
r_{k+1}^{(2)}
k+1
s
P_{k+1}
\mathsf{AP}
\displaystyle\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1}|\mathsf%
{AP},\mathbf{p}^{(1)}\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}}=\mathbb{P}\br{r_{%
k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1},\mathsf{APA}|\mathsf{AP},\mathbf{p}^{%
(1)},\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}}
\displaystyle\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1}|\mathsf%
{AP},\mathbf{p}^{(1)}\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}}
\displaystyle=\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1},%
\mathsf{APA}|\mathsf{AP},\mathbf{p}^{(1)},\mathbf{p}^{(2)},\widetilde{\cT}^{(2%
)}_{\leq k}}
\displaystyle+\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1},%
\mathsf{APR}|\mathsf{AP},\mathbf{p}^{(1)},\mathbf{p}^{(2)},\widetilde{\cT}^{(2%
)}_{\leq k}}
\displaystyle+\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1},%
\mathsf{APR}|\mathsf{AP},\mathbf{p}^{(1)},\mathbf{p}^{(2)},\widetilde{\cT}^{(2%
)}_{\leq k}}
\displaystyle=\widetilde{Q}_{k+1}\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(1%
)},\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}}
\displaystyle=\widetilde{Q}_{k+1}\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(1%
)},\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}}
\mathsf{AP}
\mathsf{AN}
\displaystyle\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1}|\mathsf%
{AN},\cT^{(2)}_{\leq k},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}=\widetilde{Q}_{k+1}%
\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}}
\displaystyle\mathbb{P}\br{r_{k+1}^{(2)}\in E^{r_{\leq k}^{(2)}}_{k+1}|\mathsf%
{AN},\cT^{(2)}_{\leq k},\mathbf{p}^{(1)},\mathbf{p}^{(2)}}=\widetilde{Q}_{k+1}%
\br{E^{r_{\leq k}^{(2)}}_{k+1}|\mathbf{p}^{(2)},\widetilde{\cT}^{(2)}_{\leq k}}
\phi_{\leq k}^{(\mathsf{A)}},\phi_{\leq k}^{(\mathsf{R)}}
\widetilde{\cT}^{(2)}_{\leq k}
\mathsf{A}
\mathsf{R}
T_{k}=\abs{\widetilde{\cT}^{(2)}_{\leq k}}
E
\displaystyle\mathbb{P}\br{\widetilde{\cT}_{\leq k+1}^{(2)}\in E|\mathbf{p}^{(%
1)},\mathbf{p}^{(2)}}=\mathbb{P}\br{r^{(2)}_{k+1}\in E^{r_{\leq k}^{(2)}}_{k+1%
}|\mathsf{A},\widetilde{\cT}^{(2)}_{\leq k}\in E_{\leq k},\mathbf{p}^{(1)},%
\mathbf{p}^{(2)}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\leq k}\in E^{r_{\leq k}%
^{(2)}}_{k+1},\mathsf{A}|\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle\mathbb{P}\br{\widetilde{\cT}_{\leq k+1}^{(2)}\in E|\mathbf{p}^{(%
1)},\mathbf{p}^{(2)}}
\displaystyle=\mathbb{P}\br{r^{(2)}_{k+1}\in E^{r_{\leq k}^{(2)}}_{k+1}|%
\mathsf{A},\widetilde{\cT}^{(2)}_{\leq k}\in E_{\leq k},\mathbf{p}^{(1)},%
\mathbf{p}^{(2)}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\leq k}\in E^{r_{\leq k}%
^{(2)}}_{k+1},\mathsf{A}|\mathbf{p}^{(1)},\mathbf{p}^{(2)}}
\displaystyle+\mathbb{P}\br{r^{(2)}_{k+1}\in E^{r_{\leq k}^{(2)}}_{k+1}|%
\mathsf{R},\widetilde{\cT}^{(2)}_{\leq k}\in E_{\leq k},\mathbf{p}^{(1)},%
\mathbf{p}^{(2)}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\leq k}\in E_{\leq k},%
\mathsf{R}|\mathbf{p}^{(1)},p^{(2)}}
\displaystyle+\mathbb{P}\br{r^{(2)}_{k+1}\in E^{r_{\leq k}^{(2)}}_{k+1}|%
\mathsf{R},\widetilde{\cT}^{(2)}_{\leq k}\in E_{\leq k},\mathbf{p}^{(1)},%
\mathbf{p}^{(2)}}\mathbb{P}\br{\widetilde{\cT}^{(2)}_{\leq k}\in E_{\leq k},%
\mathsf{R}|\mathbf{p}^{(1)},p^{(2)}}
\displaystyle=\Huge\int_{\mathbb{R}^{dT_{k+1}}}\mathbbm{1}\br{r_{k+1}^{(2)}\in
E%
^{r_{\leq k}^{(2)}}_{k+1}}\mathbbm{1}\br{\widetilde{\cT}^{(2)}_{\leq k}\in E_{%
\leq k}}\big{(}\mathbbm{1}\br{\widetilde{\cT}^{(2)}_{\leq k}\in\mathsf{A}}\phi%
^{(\mathsf{A})}_{\leq k}\br{\widetilde{\cT}^{\mathsf{(2)}}_{\leq k}}
\displaystyle=\Huge\int_{\mathbb{R}^{dT_{k+1}}}\mathbbm{1}\br{r_{k+1}^{(2)}\in
E%
^{r_{\leq k}^{(2)}}_{k+1}}\mathbbm{1}\br{\widetilde{\cT}^{(2)}_{\leq k}\in E_{%
\leq k}}\big{(}\mathbbm{1}\br{\widetilde{\cT}^{(2)}_{\leq k}\in\mathsf{A}}\phi%
^{(\mathsf{A})}_{\leq k}\br{\widetilde{\cT}^{\mathsf{(2)}}_{\leq k}}
\displaystyle+\mathbbm{1}\br{\widetilde{\cT}^{(2)}_{\leq k}\in\mathsf{R}}\phi^%
{(\mathsf{R})}_{\leq k}\br{\widetilde{\cT}^{\mathsf{(2)}}_{\leq k}}\bigg{)}%
\phi_{\widetilde{Q}^{\mathbf{p}^{(2)}}_{k+1}}\br{r_{k+1}^{(2)}|\widetilde{\cT}%
_{\leq k}^{(2)}}d\widetilde{\cT}_{\leq k}^{(2)}dr^{(2)}_{k+1}
\displaystyle+\mathbbm{1}\br{\widetilde{\cT}^{(2)}_{\leq k}\in\mathsf{R}}\phi^%
{(\mathsf{R})}_{\leq k}\br{\widetilde{\cT}^{\mathsf{(2)}}_{\leq k}}\bigg{)}%
\phi_{\widetilde{Q}^{\mathbf{p}^{(2)}}_{k+1}}\br{r_{k+1}^{(2)}|\widetilde{\cT}%
_{\leq k}^{(2)}}d\widetilde{\cT}_{\leq k}^{(2)}dr^{(2)}_{k+1}
\displaystyle=\Huge\int_{\mathbb{R}^{dT_{k+1}}}\mathbbm{1}\br{\cT_{\leq k+1}^{%
(2)}\in E}\phi_{Q^{p^{(2)}}_{\leq k}}\br{\widetilde{\cT}^{(2)}_{\leq k}}\phi_{%
\widetilde{Q}^{p^{(2)}}_{k+1}}\br{r_{k+1}^{(2)}|\widetilde{\cT}_{\leq k}^{(2)}%
}d\widetilde{\cT}_{\leq k}^{(2)}dr^{(2)}_{k+1}
\displaystyle=\Huge\int_{\mathbb{R}^{dT_{k+1}}}\mathbbm{1}\br{\cT_{\leq k+1}^{%
(2)}\in E}\phi_{Q^{p^{(2)}}_{\leq k}}\br{\widetilde{\cT}^{(2)}_{\leq k}}\phi_{%
\widetilde{Q}^{p^{(2)}}_{k+1}}\br{r_{k+1}^{(2)}|\widetilde{\cT}_{\leq k}^{(2)}%
}d\widetilde{\cT}_{\leq k}^{(2)}dr^{(2)}_{k+1}
\displaystyle=\widetilde{Q}^{p^{(2)}}_{\leq{k+1}}\br{E}
\displaystyle=\widetilde{Q}^{p^{(2)}}_{\leq{k+1}}\br{E}
E\subseteq\mathfrak{T}
\mathbb{P}[\cT^{(2)}\in E]=Q(E)
\cT
u_{b}
w_{b}
\widetilde{\cT}
E=E_{u}\times E_{r}\times E_{w}\times E_{z}
\displaystyle\mathbb{P}[\cT^{(2)}\in E]=\mathbb{E}_{\mathbf{p}^{(1)}}\mathbb{P%
}\br{\cT^{(2)}\in E_{u}\times E_{r}\times E_{w}\times E_{z}|\mathbf{p}^{(1)},%
\mathbf{p}^{(2)}\in E_{z}}\mathbb{P}\br{\mathbf{p}^{(2)}\in E_{z}}
\displaystyle\mathbb{P}[\cT^{(2)}\in E]
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}\mathbb{P}\br{\cT^{(2)}\in E_{u}%
\times E_{r}\times E_{w}\times E_{z}|\mathbf{p}^{(1)},\mathbf{p}^{(2)}\in E_{z%
}}\mathbb{P}\br{\mathbf{p}^{(2)}\in E_{z}}
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}\mathbb{P}\br{\widetilde{\cT}^{(2)}%
\in E_{r}|\mathbf{p}^{(1)},\mathbf{p}^{(2)}}\mu_{n-1}(E_{z})
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}\mathbb{P}\br{\widetilde{\cT}^{(2)}%
\in E_{r}|\mathbf{p}^{(1)},\mathbf{p}^{(2)}}\mu_{n-1}(E_{z})
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}\widetilde{Q}^{\mathbf{p}^{(2)}}\br%
{E_{r}}\mu_{n-1}(E_{2})
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}\widetilde{Q}^{\mathbf{p}^{(2)}}\br%
{E_{r}}\mu_{n-1}(E_{2})
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}Q^{\mathbf{p}^{(2)}}\br{E_{u}\times
E%
_{w}\times E_{r}}\mu_{n-1}(E_{z})
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)}}Q^{\mathbf{p}^{(2)}}\br{E_{u}\times
E%
_{w}\times E_{r}}\mu_{n-1}(E_{z})
\displaystyle=Q(E)
\displaystyle=Q(E)
w_{b}
u_{b}
r_{\leq b}
\log{n}\rho
b
s
\mathsf{path}
\mathsf{Accept}
\displaystyle\mathbb{P}\br{\mathsf{Accept}}=\mathbb{E}_{\cT^{(1)},\cT^{(2)},%
\bc{u_{b}}}\prod_{b\in\mathsf{path}}\mathbbm{1}\br{u_{b}\leq\frac{\phi_{%
\widetilde{Q}^{\mathbf{p}^{(2)}}_{b}}\br{r^{(1)}_{b}|\cT^{(1)}_{<b}}}{\phi_{%
\widetilde{P}^{\mathbf{p}^{(2)}}_{b}}\br{r^{(1)}_{b}|\cT^{(1)}_{<b}}}}
\displaystyle\mathbb{P}\br{\mathsf{Accept}}
\displaystyle=\mathbb{E}_{\cT^{(1)},\cT^{(2)},\bc{u_{b}}}\prod_{b\in\mathsf{%
path}}\mathbbm{1}\br{u_{b}\leq\frac{\phi_{\widetilde{Q}^{\mathbf{p}^{(2)}}_{b}%
}\br{r^{(1)}_{b}|\cT^{(1)}_{<b}}}{\phi_{\widetilde{P}^{\mathbf{p}^{(2)}}_{b}}%
\br{r^{(1)}_{b}|\cT^{(1)}_{<b}}}}
\displaystyle=\mathbb{E}_{\widetilde{\cT}^{(1)},\mathbf{p}^{(1)},\mathbf{p}^{(%
2)}}\prod_{b\in\mathsf{path}}\mathbb{P}\br{u_{b}\leq\frac{\phi_{\widetilde{Q}^%
{\mathbf{p}^{(2)}}_{b}}\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b}}}{\phi_{%
\widetilde{P}^{\mathbf{p}^{(1)}}_{b}}\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b%
}}}}
\displaystyle=\mathbb{E}_{\widetilde{\cT}^{(1)},\mathbf{p}^{(1)},\mathbf{p}^{(%
2)}}\prod_{b\in\mathsf{path}}\mathbb{P}\br{u_{b}\leq\frac{\phi_{\widetilde{Q}^%
{\mathbf{p}^{(2)}}_{b}}\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b}}}{\phi_{%
\widetilde{P}^{\mathbf{p}^{(1)}}_{b}}\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b%
}}}}
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)},\mathbf{p}^{(2)}}\prod_{b\in\mathsf%
{path}}\Huge\int_{\bbR^{d}}\min\br{\phi_{\widetilde{Q}^{\mathbf{p}^{(2)}}_{b}}%
\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b}},\phi_{\widetilde{P}^{\mathbf{p}^{(%
1)}}_{b}}\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b}}}dr^{(2)}_{b}
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)},\mathbf{p}^{(2)}}\prod_{b\in\mathsf%
{path}}\Huge\int_{\bbR^{d}}\min\br{\phi_{\widetilde{Q}^{\mathbf{p}^{(2)}}_{b}}%
\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b}},\phi_{\widetilde{P}^{\mathbf{p}^{(%
1)}}_{b}}\br{r^{(1)}_{b}|\widetilde{\cT}^{(1)}_{<b}}}dr^{(2)}_{b}
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)},\mathbf{p}^{(2)}}\prod_{b\in\mathsf%
{path}}\br{1-\mathsf{TV}\br{\widetilde{Q}_{b}^{\mathbf{p}^{(2)}},\widetilde{P}%
_{b}^{\mathbf{p}^{(1)}}|\widetilde{\cT}^{(1)}_{<b}}}
\displaystyle=\mathbb{E}_{\mathbf{p}^{(1)},\mathbf{p}^{(2)}}\prod_{b\in\mathsf%
{path}}\br{1-\mathsf{TV}\br{\widetilde{Q}_{b}^{\mathbf{p}^{(2)}},\widetilde{P}%
_{b}^{\mathbf{p}^{(1)}}|\widetilde{\cT}^{(1)}_{<b}}}
\displaystyle=\prod_{b\in\mathsf{path}}\br{1-\rho_{b}}
\displaystyle=\prod_{b\in\mathsf{path}}\br{1-\rho_{b}}
\displaystyle\geq 1-\sum_{b\in\mathsf{path}}\rho_{b}
\displaystyle\geq 1-\sum_{b\in\mathsf{path}}\rho_{b}
\displaystyle\geq 1-\log{n}\max_{b}\rho_{b}
\displaystyle\geq 1-\log{n}\max_{b}\rho_{b}
\displaystyle\geq 1-\log{n}\rho
\displaystyle\geq 1-\log{n}\rho
\rho_{b}
b
\rho_{b}\leq\rho
\rho
\bc{a_{i}}_{i=1}^{k}
a_{i}\in(0,1)
i
\sum_{i=1}^{k}a_{i}\leq 1
\prod_{i=1}^{k}\br{1-a_{i}}\geq 1-\sum_{i=1}^{k}a_{i}
k
k=1
k
\displaystyle\prod_{i=1}^{k}\br{1-a_{i}}=\prod_{i=1}^{k-1}\br{1-a_{i}}\br{1-a_%
{k}}\geq\br{1-\sum_{i=1}^{k-1}a_{i}}\br{1-a_{k}}
\displaystyle\prod_{i=1}^{k}\br{1-a_{i}}=\prod_{i=1}^{k-1}\br{1-a_{i}}\br{1-a_%
{k}}
\displaystyle\geq\br{1-\sum_{i=1}^{k-1}a_{i}}\br{1-a_{k}}
\displaystyle=1-\sum_{i=1}^{k}a_{i}+\br{\sum_{i=1}^{k-1}a_{i}}a_{k}
\displaystyle=1-\sum_{i=1}^{k}a_{i}+\br{\sum_{i=1}^{k-1}a_{i}}a_{k}
\displaystyle\geq 1-\sum_{i=1}^{k}a_{i}
\displaystyle\geq 1-\sum_{i=1}^{k}a_{i}
(t_{0};\cT)
(t_{0};\cT)
S
(w,z)\mapsto\ell(w,z)
T
\sigma
\bc{\eta_{t}}_{t}
t_{0}=1
\cT
w_{t_{0}}=0
t=1
T-1
u_{t}=\sum_{i=1}^{t}\br{\br{i+1}\nabla\ell(w_{i};z_{i})-i\nabla\ell(w_{i-1};z_%
{i})}
\mathsf{Append}(u_{t},\sigma;\cT)
r_{t}=\mathsf{GetPrefixSum}(t;\cT)
v_{t}=\arg\min_{w\in\cW}\ip{w}{\frac{r_{t}}{t+1}}
w_{t+1}=(1-\eta_{t})w_{t}+\eta_{t}v_{t}
\mathsf{Set}(\mathsf{leaf}(t),\br{u_{t},r_{t},w_{t},z_{t}};\cT)
\hat{w}=w_{T}
d_{t}=\frac{r_{t}}{t+1}
\displaystyle L(w_{t+1};\cD)\leq L(w_{t};\cD)+\ip{\nabla L(w_{t};\cD)}{w_{t+1}%
-w_{t}}+\frac{H}{2}\norm{w_{t+1}-w_{t}}^{2}
\displaystyle L(w_{t+1};\cD)
\displaystyle\leq L(w_{t};\cD)+\ip{\nabla L(w_{t};\cD)}{w_{t+1}-w_{t}}+\frac{H%
}{2}\norm{w_{t+1}-w_{t}}^{2}
\displaystyle\leq L(w_{t};\cD)+\eta_{t}\ip{\nabla L(w_{t};\cD)-d_{t}}{v_{t}-w_%
{t}}+\ip{d_{t}}{v_{t}-w_{t}}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle\leq L(w_{t};\cD)+\eta_{t}\ip{\nabla L(w_{t};\cD)-d_{t}}{v_{t}-w_%
{t}}+\ip{d_{t}}{v_{t}-w_{t}}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle=L(w_{t};\cD)+\eta_{t}\ip{\nabla L(w_{t};\cD)-d_{t}}{v_{t}-w_{t}}%
+\eta_{t}\ip{d_{t}}{w^{*}-w_{t}}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle=L(w_{t};\cD)+\eta_{t}\ip{\nabla L(w_{t};\cD)-d_{t}}{v_{t}-w_{t}}%
+\eta_{t}\ip{d_{t}}{w^{*}-w_{t}}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle\leq L(w_{t};\cD)+\eta_{t}\ip{\nabla L(w_{t};\cD)}{w^{*}-w_{t}}+%
\eta_{t}\ip{d_{t}-\nabla L(w_{t})}{w^{*}-v_{t}}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle\leq L(w_{t};\cD)+\eta_{t}\ip{\nabla L(w_{t};\cD)}{w^{*}-w_{t}}+%
\eta_{t}\ip{d_{t}-\nabla L(w_{t})}{w^{*}-v_{t}}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle\leq\br{1-\eta_{t}}L(w_{t};\cD)-\eta_{t}L(w^{*};\cD)+\frac{2D}{t+%
1}\norm{d_{t}-\nabla L(w_{t};\cD)}+\frac{\eta_{t}^{2}HD^{2}}{2}
\displaystyle\leq\br{1-\eta_{t}}L(w_{t};\cD)-\eta_{t}L(w^{*};\cD)+\frac{2D}{t+%
1}\norm{d_{t}-\nabla L(w_{t};\cD)}+\frac{\eta_{t}^{2}HD^{2}}{2}
D
v_{t}
\displaystyle\mathbb{E}[L(w_{t+1};\cD)-L(w^{*};\cD)]
\displaystyle\mathbb{E}[L(w_{t+1};\cD)-L(w^{*};\cD)]
\displaystyle\leq\br{1-\eta_{t}}\mathbb{E}[L(w_{t};\cD)-L(w^{*};\cD)]+%
\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{(t+1)^{3/2}}+\frac{\sqrt{d}}{\br{t+1}^%
{2}\rho}}}
\displaystyle\leq\br{1-\eta_{t}}\mathbb{E}[L(w_{t};\cD)-L(w^{*};\cD)]+%
\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{(t+1)^{3/2}}+\frac{\sqrt{d}}{\br{t+1}^%
{2}\rho}}}
\displaystyle+\frac{HD^{2}}{2\br{t+1}^{2}}
\displaystyle+\frac{HD^{2}}{2\br{t+1}^{2}}
\displaystyle\mathbb{E}[L(w_{T};\cD)-L(w^{*};\cD)]\leq\br{L(w_{1};\cD)-L(w^{*}%
)}\prod_{t=1}^{T-1}\br{1-\eta_{t}}
\displaystyle\mathbb{E}[L(w_{T};\cD)-L(w^{*};\cD)]
\displaystyle\leq\br{L(w_{1};\cD)-L(w^{*})}\prod_{t=1}^{T-1}\br{1-\eta_{t}}
\displaystyle+\sum_{i=1}^{T-1}\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{(i+1)^{3%
/2}}+\frac{\sqrt{d}}{\br{i+1}^{2}\rho}}+\frac{HD^{2}}{\br{i+1}^{2}}}\prod_{t=i%
+1}^{T-1}\br{1-\eta_{t}}
\displaystyle+\sum_{i=1}^{T-1}\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{(i+1)^{3%
/2}}+\frac{\sqrt{d}}{\br{i+1}^{2}\rho}}+\frac{HD^{2}}{\br{i+1}^{2}}}\prod_{t=i%
+1}^{T-1}\br{1-\eta_{t}}
\displaystyle\leq\frac{HD^{2}}{T}
\displaystyle\leq\frac{HD^{2}}{T}
\displaystyle+\sum_{i=1}^{T-1}\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{\br{i+1}%
^{1/2}}+\frac{\sqrt{d}}{\br{i+1}\rho}}+\frac{HD^{2}}{\br{i+1}}}\frac{1}{T}
\displaystyle+\sum_{i=1}^{T-1}\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{\br{i+1}%
^{1/2}}+\frac{\sqrt{d}}{\br{i+1}\rho}}+\frac{HD^{2}}{\br{i+1}}}\frac{1}{T}
\displaystyle\leq\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{\sqrt{T}}+\frac{\sqrt%
{d}}{T\rho}}+\frac{HD^{2}}{T}}
\displaystyle\leq\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{\sqrt{T}}+\frac{\sqrt%
{d}}{T\rho}}+\frac{HD^{2}}{T}}
\displaystyle\leq\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{\sqrt{T}}+\frac{\sqrt%
{d}}{T\rho}}}
\displaystyle\leq\widetilde{O}\br{\br{HD+G}D\br{\frac{1}{\sqrt{T}}+\frac{\sqrt%
{d}}{T\rho}}}
\prod_{t=i+1}^{T-1}\br{1-\eta_{t}}=\frac{i+1}{T-1}
T=n
u_{t}=\sum_{i=1}^{t}\br{\br{i+1}\nabla\ell(w_{i};z_{i})-i\nabla\ell(w_{i-1};z_%
{i})}
\displaystyle\norm{\br{\br{i+1}\nabla\ell(w_{i};z)-i\nabla\ell(w_{i-1};z)}-\br%
{\br{i+1}\nabla\ell(w_{i};z^{\prime})-i\nabla\ell(w_{i-1};z^{\prime})}}
\displaystyle\norm{\br{\br{i+1}\nabla\ell(w_{i};z)-i\nabla\ell(w_{i-1};z)}-\br%
{\br{i+1}\nabla\ell(w_{i};z^{\prime})-i\nabla\ell(w_{i-1};z^{\prime})}}
\displaystyle\leq iH\norm{w_{i}-w_{i-i}}+2G
\displaystyle\leq iH\norm{w_{i}-w_{i-i}}+2G
\displaystyle\leq iH\eta_{i-1}\norm{v_{i-1}-w_{i-1}}+2G
\displaystyle\leq iH\eta_{i-1}\norm{v_{i-1}-w_{i-1}}+2G
\displaystyle\leq 2\br{HD+G}
\displaystyle\leq 2\br{HD+G}
D
\Theta(n)
\widetilde{O}(\rho)
\widetilde{O}(\rho n)
\mathbb{E}\norm{\frac{r_{t}}{t+1}-\nabla L(w_{t};\cD)}^{2}\leq\widetilde{O}\br%
{\br{HD+G}^{2}\br{\frac{1}{t+1}+\frac{d}{\br{t+1}^{2}\rho^{2}}}}
d_{t}:=\frac{r_{t}}{t+1}
\widetilde{d}_{t}
\xi_{t}
\displaystyle\mathbb{E}\norm{d_{t}-\nabla L(w_{t};\D)}^{2}=\mathbb{E}\norm{%
\widetilde{d}_{t}-\nabla L(w_{t};\D)}^{2}+\mathbb{E}\norm{\xi_{t}}^{2}
\displaystyle\mathbb{E}\norm{d_{t}-\nabla L(w_{t};\D)}^{2}
\displaystyle=\mathbb{E}\norm{\widetilde{d}_{t}-\nabla L(w_{t};\D)}^{2}+%
\mathbb{E}\norm{\xi_{t}}^{2}
\displaystyle\leq\widetilde{O}\br{\frac{\br{HD+G}^{2}}{t+1}}+\sum_{i=1}^{\log{%
n}}\frac{d\sigma^{2}}{\br{t+1}^{2}\rho^{2}}
\displaystyle\leq\widetilde{O}\br{\frac{\br{HD+G}^{2}}{t+1}}+\sum_{i=1}^{\log{%
n}}\frac{d\sigma^{2}}{\br{t+1}^{2}\rho^{2}}
\displaystyle=\widetilde{O}\br{\br{HD+G}^{2}\br{\frac{1}{t+1}+\frac{d}{\br{t+1%
}^{2}\rho^{2}}}}
\displaystyle=\widetilde{O}\br{\br{HD+G}^{2}\br{\frac{1}{t+1}+\frac{d}{\br{t+1%
}^{2}\rho^{2}}}}
\alpha=1
\sigma
\log{n}
1/(t+1)^{2}
r_{t}/(t+1)
r_{t}
\sigma
(t_{0};\cT)
(t_{0};\cT)
S
(w,z)\mapsto\ell(w,z)
T
\bc{\eta_{t}}_{t}
t_{0}=1
\cT
w_{t_{0}}=0
t=1
T-1
u_{t}=\sum_{i=1}^{t}\nabla\ell(w_{i};z_{i})
\mathsf{Append}(u_{t},\sigma;\cT)
r_{t}=\mathsf{GetPrefixSum}(t;\cT)
w_{t+1}=\Pi_{\cW}\br{w_{0}-\eta_{t}p_{t}}
\mathsf{Set}(\mathsf{leaf}(t),\br{u_{t},r_{t},w_{t},z_{t}};\cT)
\hat{w}=w_{T}
\epsilon/\text{log}^{2}(1/\delta)^{2}
\rho
\sigma=\widetilde{O}\br{\frac{G^{2}}{\rho^{2}}}
\widetilde{O}\br{\frac{G^{2}\text{log}^{4}(1/\delta)}{\epsilon^{2}}}
u_{t}=\sum_{i=1}^{t}\nabla\ell(w_{t};z_{i})
\displaystyle\norm{\nabla\ell(w_{t};z)-\nabla\ell(w_{t};z^{\prime})}\leq 2G
\displaystyle\norm{\nabla\ell(w_{t};z)-\nabla\ell(w_{t};z^{\prime})}\leq 2G
\Theta(n)
\widetilde{O}(\rho)
\widetilde{O}(\rho n)
\alpha\leq 1
k=O\br{\log{n/\beta}/\alpha^{2}}
1-\beta
S
\norm{\Phi x_{i}}\leq\br{1+\alpha}\norm{\x_{i}}\leq 2\norm{\cX}
\widetilde{G}=2G\norm{\cX}
\widetilde{H}=4H\norm{\cX}^{2}
\Phi\cD
\cD
(x,y)\mapsto(\Phi x,y)
1-\beta
\displaystyle\mathbb{E}[L(\hat{w};\cD)-L(w^{*};\cD)]=\mathbb{E}[L(\Phi^{\top}%
\widetilde{w};\cD)-L(\Phi w^{*};\Phi\cD)]+\mathbb{E}[L(\Phi w^{*};\Phi\cD)-L(w%
^{*};\cD)]
\displaystyle\mathbb{E}[L(\hat{w};\cD)-L(w^{*};\cD)]
\displaystyle=\mathbb{E}[L(\Phi^{\top}\widetilde{w};\cD)-L(\Phi w^{*};\Phi\cD)%
]+\mathbb{E}[L(\Phi w^{*};\Phi\cD)-L(w^{*};\cD)]
\displaystyle=\mathbb{E}[L(\widetilde{w};\Phi\cD)-L(\Phi w^{*};\Phi\cD)]+%
\mathbb{E}[\phi_{y}(\ip{\Phi w^{*}}{\Phi x})-\phi_{y}\br{\ip{w^{*}}{x}}]
\displaystyle=\mathbb{E}[L(\widetilde{w};\Phi\cD)-L(\Phi w^{*};\Phi\cD)]+%
\mathbb{E}[\phi_{y}(\ip{\Phi w^{*}}{\Phi x})-\phi_{y}\br{\ip{w^{*}}{x}}]
\displaystyle\leq\widetilde{O}\br{\br{\widetilde{G}+\widetilde{H}\norm{w^{*}}}%
\norm{w^{*}}\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{k}}{n\rho}}}+\frac{H}{2}\mathbb%
{E}\abs{\ip{\Phi x}{\Phi w^{*}}-\ip{x}{w^{*}}}^{2}
\displaystyle\leq\widetilde{O}\br{\br{\widetilde{G}+\widetilde{H}\norm{w^{*}}}%
\norm{w^{*}}\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{k}}{n\rho}}}+\frac{H}{2}\mathbb%
{E}\abs{\ip{\Phi x}{\Phi w^{*}}-\ip{x}{w^{*}}}^{2}
\displaystyle\leq\widetilde{O}\br{\br{\widetilde{G}+\widetilde{H}\norm{w^{*}}}%
\norm{w^{*}}\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{k}}{n\rho}}+\frac{\widetilde{H}%
\norm{w^{*}}^{2}}{k}}
\displaystyle\leq\widetilde{O}\br{\br{\widetilde{G}+\widetilde{H}\norm{w^{*}}}%
\norm{w^{*}}\br{\frac{1}{\sqrt{n}}+\frac{\sqrt{k}}{n\rho}}+\frac{\widetilde{H}%
\norm{w^{*}}^{2}}{k}}
\displaystyle=\widetilde{O}\br{\frac{\br{\widetilde{G}+\widetilde{H}\norm{w^{*%
}}}\norm{w^{*}}}{\sqrt{n}}+\frac{\widetilde{H}^{1/3}\widetilde{G}^{2/3}\norm{w%
^{*}}^{4/3}+\widetilde{H}\norm{w^{*}}^{2}}{(n\rho)^{2/3}}}
\displaystyle=\widetilde{O}\br{\frac{\br{\widetilde{G}+\widetilde{H}\norm{w^{*%
}}}\norm{w^{*}}}{\sqrt{n}}+\frac{\widetilde{H}^{1/3}\widetilde{G}^{2/3}\norm{w%
^{*}}^{4/3}+\widetilde{H}\norm{w^{*}}^{2}}{(n\rho)^{2/3}}}
\phi_{y}
w^{*}
k
L(\hat{w};\cD)-L(w^{*};\cD)\leq G\norm{\hat{w}-w^{*}}
\norm{\hat{w}-w^{*}}=\text{poly}(n,d)
\beta
\sigma
\gamma(\widetilde{H},\widetilde{G})\leq\frac{\tau}{2}
\rho
\widetilde{O}(\rho)
\Theta(n)
\widetilde{O}(\rho n)
\alpha\leq 1
k=O\br{\log{n/\beta}/\alpha^{2}}
1-\beta
S
\norm{\Phi x_{i}}\leq\br{1+\alpha}\norm{\x_{i}}\leq 2\norm{\cX}
\widetilde{G}=2G\norm{\cX}
\Phi\cD
\cD
(x,y)\mapsto(\Phi x,y)
1-\beta
\displaystyle\mathbb{E}[L(\hat{w};\cD)-L(w^{*};\cD)]=\mathbb{E}[L(\Phi^{\top}%
\widetilde{w};\cD)-L(\Phi w^{*};\Phi\cD)]+\mathbb{E}[L(\Phi w^{*};\Phi\cD)-L(w%
^{*};\cD)]
\displaystyle\mathbb{E}[L(\hat{w};\cD)-L(w^{*};\cD)]
\displaystyle=\mathbb{E}[L(\Phi^{\top}\widetilde{w};\cD)-L(\Phi w^{*};\Phi\cD)%
]+\mathbb{E}[L(\Phi w^{*};\Phi\cD)-L(w^{*};\cD)]
\displaystyle=\mathbb{E}[L(\widetilde{w};\Phi\cD)-L(\Phi w^{*};\Phi\cD)]+%
\mathbb{E}[\phi_{y}(\ip{\Phi w^{*}}{\Phi x})-\phi_{y}\br{\ip{w^{*}}{x}}]
\displaystyle=\mathbb{E}[L(\widetilde{w};\Phi\cD)-L(\Phi w^{*};\Phi\cD)]+%
\mathbb{E}[\phi_{y}(\ip{\Phi w^{*}}{\Phi x})-\phi_{y}\br{\ip{w^{*}}{x}}]
\displaystyle\leq\widetilde{O}\br{\widetilde{G}\norm{w^{*}}\br{\frac{1}{\sqrt{%
n}}+\sqrt{\frac{\sqrt{k}}{n\rho}}}}+G\mathbb{E}\abs{\ip{\Phi x}{\Phi w^{*}}-%
\ip{x}{w^{*}}}
\displaystyle\leq\widetilde{O}\br{\widetilde{G}\norm{w^{*}}\br{\frac{1}{\sqrt{%
n}}+\sqrt{\frac{\sqrt{k}}{n\rho}}}}+G\mathbb{E}\abs{\ip{\Phi x}{\Phi w^{*}}-%
\ip{x}{w^{*}}}
\displaystyle\leq\widetilde{O}\br{\widetilde{G}\norm{w^{*}}\br{\frac{1}{\sqrt{%
n}}+\sqrt{\frac{\sqrt{k}}{n\rho}}}+\frac{\widetilde{G}\norm{w^{*}}}{\sqrt{k}}}
\displaystyle\leq\widetilde{O}\br{\widetilde{G}\norm{w^{*}}\br{\frac{1}{\sqrt{%
n}}+\sqrt{\frac{\sqrt{k}}{n\rho}}}+\frac{\widetilde{G}\norm{w^{*}}}{\sqrt{k}}}
\displaystyle\leq\widetilde{O}\br{\widetilde{G}\norm{w^{*}}\br{\frac{1}{\sqrt{%
n}}+\frac{1}{\br{n\rho}^{1/3}}}}
\displaystyle\leq\widetilde{O}\br{\widetilde{G}\norm{w^{*}}\br{\frac{1}{\sqrt{%
n}}+\frac{1}{\br{n\rho}^{1/3}}}}
\phi_{y}
k
\beta
\cA
\widetilde{H}
\widetilde{G}
\gamma(\widetilde{H},\widetilde{G})
k=O\br{\log{2n/\tau}}
\cA
H
G
\frac{\tau}{2}+\gamma\br{2G\norm{\cX},4H\norm{\cX}^{2}}
S
G_{S}
\bc{w\mapsto\ell(w;z)}_{z\in S}
H_{S}
\alpha\leq 1
k=O\br{\log{n/\beta}}
1-\beta
S
\norm{\Phi x_{i}}\leq 2\norm{\cX}
E_{\text{JL}}
E_{\text{JL}}
G_{S}
H_{S}
2G\norm{\cX}
2H\norm{\cX}^{2}
\widetilde{\gamma}:=\gamma\br{2G\norm{\cX},4H\norm{\cX}^{2}}
\beta=\rho/2
P_{\Phi}
Q_{\Phi}
S
S^{\prime}
\displaystyle\text{TV}(P_{\Phi},Q_{\Phi})=\sup_{E}\mathbb{P}_{w\sim P}\br{w\in
E%
}-\mathbb{P}_{w\sim Q}\br{w\in E}
\displaystyle\text{TV}(P_{\Phi},Q_{\Phi})
\displaystyle=\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E}-\mathbb{P}_{w\sim Q}\br{%
w\in E}
\displaystyle=\sup_{E}\Big{(}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}}%
\mathbb{P}(E_{\text{JL}})+\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}^{\prime%
}}\mathbb{P}(E_{\text{JL}}^{\prime})
\displaystyle=\sup_{E}\Big{(}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}}%
\mathbb{P}(E_{\text{JL}})+\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}^{\prime%
}}\mathbb{P}(E_{\text{JL}}^{\prime})
\displaystyle-\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}}\mathbb{P}(E_{\text%
{JL}})-\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}^{\prime}}\mathbb{P}(E_{%
\text{JL}}^{\prime})\Big{)}
\displaystyle-\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}}\mathbb{P}(E_{\text%
{JL}})-\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}^{\prime}}\mathbb{P}(E_{%
\text{JL}}^{\prime})\Big{)}
\displaystyle\leq\br{\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}}-%
\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}}}\mathbb{P}(E_{\text{JL}})
\displaystyle\leq\br{\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}}-%
\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}}}\mathbb{P}(E_{\text{JL}})
\displaystyle+\br{\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}^{\prime%
}}-\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}^{\prime}}}\mathbb{P}(E_{\text{%
JL}}^{\prime})
\displaystyle+\br{\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}^{\prime%
}}-\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}^{\prime}}}\mathbb{P}(E_{\text{%
JL}}^{\prime})
\displaystyle\leq\br{\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}}-%
\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}}}+\rho/2
\displaystyle\leq\br{\sup_{E}\mathbb{P}_{w\sim P}\br{w\in E|E_{\text{JL}}}-%
\mathbb{P}_{w\sim Q}\br{w\in E|E_{\text{JL}}}}+\rho/2
\displaystyle\leq\widetilde{\gamma}+\rho/2
\displaystyle\leq\widetilde{\gamma}+\rho/2
\br{r_{b}}_{b}
S^{\prime}
O(1)
\rho
\widetilde{O}(\rho)
V
\widetilde{O}(\rho V)
R
\hat{w}_{i}
i
S_{i}
\mathbb{E}[L(\hat{w}_{i};\cD)]-\min_{w}L(w;\cD)=\alpha(\rho,\abs{S_{i}};\cP)
R
O(\rho R)
