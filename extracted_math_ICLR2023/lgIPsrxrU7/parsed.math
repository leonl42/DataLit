K
K
l_{2},l_{\infty}
K
K
l_{2}
f
y\in\mathcal{Y}
x\in\mathcal{X}
x
n
x_{i}
d
x
\mathcal{S}(x)
l_{0}
x
x^{\prime}
l_{0}
\epsilon
x^{\prime}
l_{0}
x
\displaystyle\max_{x^{\prime}\in\mathcal{S}(x)}\mathcal{L}(f(x^{\prime}),y)~{}%
~{}\text{s.t.}~{}~{}\|x^{\prime}-x\|_{0}\leq\epsilon.
\displaystyle\max_{x^{\prime}\in\mathcal{S}(x)}\mathcal{L}(f(x^{\prime}),y)~{}%
~{}\text{s.t.}~{}~{}\|x^{\prime}-x\|_{0}\leq\epsilon.
\mathcal{S}(x)
\mathcal{S}(x)
x
x
\mathcal{S}(x)
x^{\prime}_{i}
\textit{Categorical}(\pi_{i})
\pi_{i}\in\Pi_{i}=(0,1)^{d}
\pi_{i,j}
i
j
\pi_{i}
\textit{Categorical}(\pi_{i})
x
\pi_{i}
\pi=[\pi_{0};\pi_{1};...;\pi_{n}]\in\Pi\subset\mathbb{R}^{n\times d}
\pi
\Pi
\max_{\pi\in\Pi}\mathbb{E}_{x^{\prime}\sim\pi}\mathcal{L}(f(x^{\prime}),y)~{}~%
{}\text{s.t.}~{}~{}\Pr_{x^{\prime}\sim\pi}(\|x^{\prime}-x\|_{0}\geq\epsilon)\leq\delta
\epsilon
\delta
\pi
x^{\prime}
\pi
x^{\prime}
l_{0}
x
\epsilon
x^{\prime}
x
\pi
x^{\prime}
x^{\prime}
x^{\prime}_{i}
x^{\prime}
n=3
d=4
x^{\prime}_{i}
x^{\prime}
\pi_{i}
n=3
d=4
x^{\prime}_{i}
x^{\prime}
\pi_{i}
l_{0}
l_{0}
x^{\prime}
x
\pi_{i}
x_{i}
\mathcal{L}_{CE}(\pi_{i},x_{i})
i\in|x|
\mathcal{L}_{CE}(\pi_{i},x_{i})
x^{\prime}_{i}
\pi_{i}
x_{i}
\sum_{i\in|n|}\mathcal{L}_{CE}(\pi_{i},x_{i})
x^{\prime}
l_{0}
\|x^{\prime}-x\|_{0}
\pi
\sum_{i\in|n|}\mathcal{L}_{CE}(\pi_{i},x_{i})
\zeta
\max_{\pi\in\Pi}\mathbb{E}_{x^{\prime}\sim\pi}\mathcal{L}(f(x^{\prime}),y)~{}~%
{}\text{s.t.}~{}~{}\sum_{i\in|n|}\mathcal{L}_{CE}(x_{i},\pi_{i})-\zeta\leq 0
x^{\prime}
\epsilon
\pi
\max_{\pi\in\Pi}\Biggl{(}\mathbb{E}_{x^{\prime}\sim\pi}\mathcal{L}(f(x^{\prime%
}),y)\Biggr{)}-\lambda\left[\sum_{i\in|n|}\mathcal{L}_{CE}(x_{i},\pi_{i})-%
\zeta\right]^{+}
\lambda
[\cdot]^{+}
\max(\cdot,0)
\pi
\pi_{i}\in(0,C]^{d}
C>0
x^{\prime}_{i}
x^{\prime}_{ij}=\frac{\exp((\log\pi_{ij}+g_{j})/\tau)}{\sum_{j=1}^{d}\exp((%
\log\pi_{ij}+g_{j})/\tau)},~{}~{}\text{for}~{}j=1,...,d
g_{j}
(0,1)
\tau
\pi
\displaystyle\begin{split}\frac{\partial\mathbb{E}_{x^{\prime}\sim\pi}\mathcal%
{L}(f(x^{\prime}),y)}{\partial\pi}\approx\frac{\partial}{\partial\pi}\mathbb{E%
}_{g}\mathcal{L}(f(x^{\prime}(\pi,g)),y)\\
=\mathbb{E}_{g}\left[\frac{\partial\mathcal{L}}{\partial x^{\prime}}\frac{%
\partial x^{\prime}}{\partial\pi}\right]\approx\frac{1}{n_{g}}\sum_{i=1}^{n_{g%
}}\left[\frac{\partial\mathcal{L}}{\partial x^{\prime}}\frac{\partial x^{%
\prime}(\pi,g_{i})}{\partial\pi}\right]\end{split}
\displaystyle\begin{split}\frac{\partial\mathbb{E}_{x^{\prime}\sim\pi}\mathcal%
{L}(f(x^{\prime}),y)}{\partial\pi}\approx\frac{\partial}{\partial\pi}\mathbb{E%
}_{g}\mathcal{L}(f(x^{\prime}(\pi,g)),y)\\
=\mathbb{E}_{g}\left[\frac{\partial\mathcal{L}}{\partial x^{\prime}}\frac{%
\partial x^{\prime}}{\partial\pi}\right]\approx\frac{1}{n_{g}}\sum_{i=1}^{n_{g%
}}\left[\frac{\partial\mathcal{L}}{\partial x^{\prime}}\frac{\partial x^{%
\prime}(\pi,g_{i})}{\partial\pi}\right]\end{split}
n_{g}
g
x^{\prime}
\pi
\pi
(0,C]^{d}
\mathcal{D}
\epsilon
n_{g}
\lambda
I
\gamma
\pi
\pi^{0}
t\leq I
\nabla_{\pi}\mathbb{E}_{\pi}\mathcal{L}\approx\frac{1}{n_{g}}\sum_{i=1}^{n_{g}%
}\left[\frac{\partial\mathcal{L}}{\partial x^{\prime}}\frac{\partial x^{\prime%
}(\pi^{t},g_{i})}{\partial\pi}\right]
\widetilde{\pi}^{t+1}=\pi^{t}+\gamma\left(\nabla_{\pi}\mathbb{E}_{\pi}\mathcal%
{L}-\lambda\nabla_{\pi}[\mathcal{L}_{CE}(\pi_{t},x)-\zeta]^{+}\right)
(0,C]^{d}
\pi^{t+1}=\max(\widetilde{\pi}^{t+1},C)
N
n
d
\epsilon
C_{1}
n_{g}
I
N\cdot\mathcal{O}(nd+d^{\epsilon})
N\cdot\mathcal{O}(nd+\epsilon d)
N\cdot\mathcal{O}(1+d^{\epsilon})
N\cdot\mathcal{O}(1+\epsilon d)
C_{1}N\cdot\mathcal{O}(1)
d
\epsilon
f
\theta
\min_{\theta}\left[\max_{\pi}\mathbb{E}_{x^{\prime}\sim\pi}\left(\mathcal{L}(f%
(x^{\prime};\theta),y)-\lambda\left[\sum_{i\in|n|}\mathcal{L}_{CE}(x_{i},\pi_{%
i})-\zeta\right]^{+}\right)\right]
\lambda
\lambda
\mathcal{L}_{CE}(x,\pi)-\zeta
\lambda
n_{adv}
\theta
\lambda
\mathcal{D}
\theta
\epsilon
n_{adv}
\lambda^{0}
\alpha
I
\theta
B=\{x^{1},...,x^{m}\}
i=1,...,m~{}
x^{i}
\pi^{i}
n_{adv}
\{x^{\prime i}_{1},...,X^{\prime i}_{n_{adv}}\}
\pi^{i}
\theta
\lambda=(\lambda-\alpha(\zeta-\frac{1}{m}\sum_{i\in[m]}\sum_{j\in[n]}\mathcal{%
L}_{\text{CE}}(x^{i}_{j},\pi^{i}_{j})))^{+}
95\%
95\%
\epsilon=1
\epsilon=2
\epsilon=3
\epsilon=4
\epsilon=5
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\uparrow
\downarrow
\pm
\pm
-
-
-
-
-
-
\pm
\pm
\pm
\pm
\pm
\pm
\pm
-
-
-
-
-
-
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
-
-
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
-
-
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\epsilon=2
\epsilon=2
\epsilon=3
\epsilon=3
\epsilon=4
\epsilon=4
1-SR
1-SR
\epsilon
1
5
\zeta
\zeta
\zeta
l_{0}
\epsilon
1-\text{success rate}
l_{2}
l_{2}
\mathcal{S}(x)
10\%
\zeta
\zeta
\zeta=0.1
\zeta=0.2
\zeta=0.32
\zeta=0.4
\pi^{*}
\pi
\pi
\epsilon=1,3,5
\zeta
\zeta
\zeta
\zeta
\zeta
\zeta
\zeta=0.4
N
n
d
\epsilon
n_{g}
I
n_{g}
N\cdot n_{g}\cdot\mathcal{O}(1)\cdot I=C_{1}N\cdot\mathcal{O}(1)
C_{1}
n_{g}
I
i_{th}
d-1
i_{th}
\epsilon
nd+d^{\epsilon}
N\cdot[\mathcal{O}(nd)+\mathcal{O}(d^{\epsilon})]=N\cdot\mathcal{O}(nd+d^{%
\epsilon})
i_{th}
nd+\epsilon d
N\cdot[\mathcal{O}(nd)+\mathcal{O}(\epsilon d)]=N\cdot\mathcal{O}(nd+\epsilon d)
\epsilon
N\cdot[\mathcal{O}(1)+\mathcal{O}(d^{\epsilon})]=N\cdot\mathcal{O}(1+d^{%
\epsilon})
N\cdot[\mathcal{O}(1)+\mathcal{O}(\epsilon d)]=N\cdot\mathcal{O}(1+\epsilon d).
95\%
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pi
\mathcal{L}(f(x,\theta),Y)+\max_{\pi}\mathbb{E}_{x^{\prime}\sim\pi}\mathcal{L}%
(f(x^{\prime},\theta),f(x,\theta))/\lambda
1/\lambda
1/\lambda=1
1/\lambda=5
