+60\%
+61\%
+61\%
\beta
+28\%
\mathcal{D}=\{\mathbf{x}^{i}\}_{i=1}^{N}
\mathbf{x}^{i}
\mathbf{x}^{i}
\mathbf{z}
\mathbf{x}
\mathbf{z}=(z_{1},\ldots,z_{k})
p(\mathbf{z})
\mathbf{z}\sim p(\mathbf{z})
\mathbf{x}
\mathbf{x}\sim p(\mathbf{x}|\mathbf{z})
\mathcal{D}
f_{\phi}
\mathbf{x}
\mathbf{z}
f_{\phi}(\mathbf{x})\approx\mathbb{E}[\mathbf{z}|\mathbf{x}]
\mathbf{z}
p(\mathbf{z})
p(\mathbf{x}|\mathbf{z})
p_{\theta}(\mathbf{x},\mathbf{z})=p_{\theta}(\mathbf{z})p_{\theta}(\mathbf{x}|%
\mathbf{z})
\mathbf{z},\mathbf{x}
p(\mathbf{z})=p(z_{1})p(z_{2})\ldots p(z_{k}).
p_{\theta}(\mathbf{z})
\mathbf{z}
\mathcal{S}(p(\mathbf{z}))
p(\mathbf{z})
\{\mathbf{z}\in\mathcal{Z}\,|\,p(\mathbf{z})>0\}
\mathcal{S}(p(\mathbf{z}))
\mathcal{S}(p(\mathbf{z}))=\mathcal{S}(p(z_{1}))\times\mathcal{S}(p(z_{2}))%
\times...\times\mathcal{S}(p(z_{k}))\stackrel{{\scriptstyle\text{def}}}{{=}}%
\mathcal{S}^{\times}(p(\mathbf{z}))
\times
\Rightarrow
\nRightarrow
z_{1}
z_{2}
\mathbf{z}=f_{\phi}(\mathbf{x})
\bar{q}_{\phi}(\mathbf{z})=\mathbb{E}_{\mathbf{x}}[f_{\phi}(\mathbf{x})]
\bar{q}_{\phi}(\mathbf{z})
q_{\phi}(\mathbf{z})
f_{\phi}
\bar{q}_{\phi}(\mathbf{z})
\mathcal{S}(\bar{q}_{\phi}(\mathbf{z}))
\mathcal{S}^{\times}(\bar{q}_{\phi}(\mathbf{z}))
\mathcal{S}
\mathcal{S}^{\times}
\mathcal{S}^{\times}(\bar{q}_{\phi}(\mathbf{z}))
\mathcal{S}(\bar{q}_{\phi}(\mathbf{z}))
\mathcal{S}
\mathcal{S}^{\times}
d(\mathbf{z},\mathbf{z}^{\prime})
\mathcal{Z}
\mathcal{Z}=\mathbb{R}^{k}
\mathcal{S}^{\times}
\mathcal{S}
\displaystyle d_{H}(\mathcal{S},\mathcal{S}^{\times})=\max\left(\sup_{\mathbf{%
z}\in\mathcal{S}^{\times}}\left[\inf_{\mathbf{z}^{\prime}\in\mathcal{S}}d(%
\mathbf{z},\mathbf{z}^{\prime})\right],\sup_{\mathbf{z}\in\mathcal{S}}\left[%
\inf_{\mathbf{z}^{\prime}\in\mathcal{S}^{\times}}d(\mathbf{z},\mathbf{z}^{%
\prime})\right]\right)=\sup_{\mathbf{z}\in\mathcal{S}^{\times}}\left[\inf_{%
\mathbf{z}^{\prime}\in\mathcal{S}}d(\mathbf{z},\mathbf{z}^{\prime})\right]
\displaystyle d_{H}(\mathcal{S},\mathcal{S}^{\times})=\max\left(\sup_{\mathbf{%
z}\in\mathcal{S}^{\times}}\left[\inf_{\mathbf{z}^{\prime}\in\mathcal{S}}d(%
\mathbf{z},\mathbf{z}^{\prime})\right],\sup_{\mathbf{z}\in\mathcal{S}}\left[%
\inf_{\mathbf{z}^{\prime}\in\mathcal{S}^{\times}}d(\mathbf{z},\mathbf{z}^{%
\prime})\right]\right)=\sup_{\mathbf{z}\in\mathcal{S}^{\times}}\left[\inf_{%
\mathbf{z}^{\prime}\in\mathcal{S}}d(\mathbf{z},\mathbf{z}^{\prime})\right]
\mathcal{S}\subset\mathcal{S}^{\times}
\{\mathbf{x}\}_{i}^{N}
\{f_{\phi}(\mathbf{x})\}_{i}^{N}
b
\mathbf{X}
b
k
\mathbf{Z}=f_{\phi}(\mathbf{X})
\in\mathbb{R}^{b\times k}
\mathcal{S}\approx\mathbf{Z}
\mathcal{S}^{\times}\approx\mathbf{Z}_{:,1}\times\mathbf{Z}_{:,2}\times...%
\times\mathbf{Z}_{:,k}=\{(z_{1},\ldots,z_{k}),\;z_{1}\in\mathbf{Z}_{:,1},%
\ldots,z_{k}\in\mathbf{Z}_{:,k}\}
\mathbf{Z}_{:,j}
j^{\mathrm{th}}
\mathbf{Z}
\textstyle\hat{d}_{H}(\mathbf{Z})=\max_{\mathbf{z}\in\mathbf{Z}_{:,1}\times%
\mathbf{Z}_{:,2}\times...\times\mathbf{Z}_{:,k}}\left[\min_{\mathbf{z}^{\prime%
}\in\mathbf{Z}}d(\mathbf{z},\mathbf{z}^{\prime})\right]
\mathbf{z}^{\prime}\in\mathbf{Z}
\mathbf{Z}
\hat{d}_{H}
k
\begin{split}\textstyle\hat{d}^{(2)}_{H}(\mathbf{Z})=\sum_{i=1}^{k-1}\sum_{j=i%
+1}^{k}\max_{\mathbf{z}\in\mathbf{Z}_{:,i}\times\mathbf{Z}_{:,j}}\left[\min_{%
\mathbf{z}^{\prime}\in\mathbf{Z}_{:,(i,j)}}d(\mathbf{z},\mathbf{z}^{\prime})%
\right]\end{split}
\mathbf{Z}_{:,(i,j)}
i
j
\mathbf{z}=f_{\phi}(\mathbf{x})
\phi
d(\mathbf{z},\mathbf{z}^{\prime})
\mathbf{z}_{:,i}
\displaystyle\ell_{\mathrm{SAE}}(\mathbf{x};\phi,\theta)=-\mathbb{E}_{q_{\phi}%
(\mathbf{z}|\mathbf{x})}\left[\log p_{\theta}(\mathbf{x}|\mathbf{z})\right]
\displaystyle\ell_{\mathrm{SAE}}(\mathbf{x};\phi,\theta)=-\mathbb{E}_{q_{\phi}%
(\mathbf{z}|\mathbf{x})}\left[\log p_{\theta}(\mathbf{x}|\mathbf{z})\right]
q_{\phi}(\mathbf{z}|\mathbf{x})=\mathcal{N}(f_{\phi}(\mathbf{x}),\Sigma_{\phi}%
(\mathbf{x}))
f_{\phi}
\Sigma_{\phi}(\mathbf{x})
\log p_{\theta}(\mathbf{x}|\mathbf{z})=\|r_{\theta}(z)-x\|^{2}
r_{\theta}
f_{\phi}(\mathbf{x})
\mathbf{x}
\Sigma_{\phi}(\mathbf{x})
\textstyle\mathcal{L}_{\mathrm{HFS}}(\mathcal{D};\phi,\theta)=\mathbb{E}_{%
\mathbf{X}\overset{b}{\sim}\mathcal{D}}\left[\gamma\hat{d}^{(2)}_{H}(f_{\phi}(%
\mathbf{X}))+\frac{1}{b}\sum_{\mathbf{x}\in\mathbf{X}}\ell_{\mathrm{SAE}}(%
\mathbf{x};\phi,\theta)\right]
\mathbf{X}\overset{b}{\sim}\mathcal{D}
b
f_{\phi}(\mathbf{X})
\mathbf{Z}
\gamma
\beta
\begin{split}\textstyle\mathcal{L}^{\beta\mathrm{VAE}}_{\mathrm{HFS}}(\mathcal%
{D};\phi,\theta)=\mathbb{E}_{\mathbf{X}\overset{b}{\sim}\mathcal{D}}&\big{[}%
\gamma\hat{d}^{(2)}_{H}(\mathbf{Z})+\frac{1}{b}\textstyle\sum_{\mathbf{x}\in%
\mathbf{X}}\big{(}\ell_{\mathrm{SAE}}(\mathbf{x};\phi,\theta)+\beta D_{\text{%
KL}}(q_{\phi}(\mathbf{z}|\mathbf{x})||p_{\theta}(\mathbf{z}))\big{)}\big{]}%
\end{split}
D_{\mathrm{KL}}
p_{\theta}(\mathbf{z})
\beta
\gamma=0
\mathcal{L}_{\text{{{\color[rgb]{0,.5,.5}HFS}}}}
\beta=0
\beta
p(\mathbf{z})
\beta
\beta
\beta
\beta
p(z_{1},z_{2})\propto\exp\left(-(z_{1}-f(z_{2}))^{2}/(2\sigma^{2})\right)
\sigma
z_{1}
z_{2}
f(z)=z
f(z)=1-z
\geq
\geq
\beta
\beta
\beta
\beta
\mathbf{+30\%}
\mathbf{+60\%}
\mathbf{+140\%}
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\sigma
\sigma
\sigma
\sigma
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
+80\%
\beta
+80\%
\beta
\beta
\beta
4\%
45\%
+80\%
\hat{d}^{(2)}_{H}
\gamma
\beta
\beta
\rightarrow
\hat{d}^{(2)}_{H}
\gamma
\beta
\beta
\rightarrow
\gamma
\beta
+60\%
\begin{split}\textstyle\hat{d}^{(2)}_{H,avg}(\mathbf{Z})=\sum_{i=1}^{k}\sum_{j%
=i+1}^{k}\frac{1}{|\mathbf{Z}_{:,i}\times\mathbf{Z}_{:,j}|}\sum_{\mathbf{z}\in%
\mathbf{Z}_{:,i}\times\mathbf{Z}_{:,j}}\left[\min_{\mathbf{z}^{\prime}\in%
\mathbf{Z}_{:,(i,j)}}d(\mathbf{z},\mathbf{z}^{\prime})\right]\end{split}
\hat{\mathcal{S}}^{\times}
\mathcal{S}^{\times}\approx\hat{\mathcal{S}}^{\times}=\mathbf{Z}_{:,1}\times%
\mathbf{Z}_{:,2}\times...\times\mathbf{Z}_{:,k}
\hat{\mathcal{S}}^{\times}_{i,j}=\mathbf{Z}_{:,i}\times\mathbf{Z}_{:,j}
\hat{\mathcal{S}}^{\times}
\hat{\mathcal{S}}^{\times}_{\text{sub}}
\begin{split}\hat{d}_{H,\text{sub}}&=\max_{\mathbf{z}\in\hat{\mathcal{S}}^{%
\times}_{\text{sub}}}\left[\min_{\mathbf{z}^{\prime}\in\mathbf{Z}}d(\mathbf{z}%
,\mathbf{z}^{\prime})\right]\end{split}
\hat{d}^{(2)}_{H}
\max
\hat{d}_{H,\text{sub}}
\max
\min
\begin{split}\hat{d}^{(2)}_{H,\text{prob}}&=\sum_{i=1}^{k}\sum_{j=i+1}^{k}\max%
_{\mathbf{z}\in\hat{\mathcal{S}}^{\times}(Z)}\left[\mathbb{E}_{\mathbf{z}^{%
\prime}\sim p_{\text{softmin}}\left(\cdot|\mathbf{z},\mathbf{Z}_{:,(i,j)},\tau%
\right)}\left[d(\mathbf{z},\mathbf{z}^{\prime})\right]\right]\end{split}
p_{\text{softmin}}(\mathbf{z}^{\prime}|\mathbf{z},\mathbf{Z},\tau)=\frac{\exp(%
-d(\mathbf{z},\mathbf{z}^{\prime})/\tau)}{\sum_{\mathbf{z}^{*}\in\mathbf{Z}}%
\exp(-d(\mathbf{z},\mathbf{z}^{*})/\tau)}
\tilde{d}
\hat{d}
\begin{split}\sigma_{\text{min}}\left(\mathbf{z},\mathbf{z}^{\prime},\mathbf{Z%
}\right)&=\frac{\exp(-d(\mathbf{z},\mathbf{z}^{\prime})/\tau_{1})}{\sum_{%
\mathbf{z}^{*}\in\mathbf{Z}}\exp(-d(\mathbf{z},\mathbf{z}^{*})/\tau_{1})}\\
d_{\text{min}}^{\text{soft}}(\mathbf{z},\mathbf{Z})&=\sum_{\mathbf{z}^{\prime}%
\in\mathbf{Z}}\sigma_{\text{min}}\left(\mathbf{z},\mathbf{z}^{\prime},\mathbf{%
Z}\right)d(\mathbf{z},\mathbf{z}^{\prime})\\
\tilde{d}^{(2)}_{H}(\mathbf{Z})&=\sum_{i=1}^{k}\sum_{j=i+1}^{k}\sum_{\mathbf{z%
}\in\mathbf{Z}_{:,(i,j)}}\frac{\exp(d_{\text{min}}^{\text{soft}}(\mathbf{z},%
\mathbf{Z}_{:,(i,j)})/\tau_{2})}{\sum_{\mathbf{z}^{*}\in\mathbf{Z}_{:,(i,j)}}%
\exp(d_{\text{min}}^{\text{soft}}(\mathbf{z}^{*},\mathbf{Z}_{:,(i,j)})/\tau_{2%
})}d_{\text{min}}^{\text{soft}}(\mathbf{z},\mathbf{Z}_{:,(i,j)})\end{split}
\tau_{1}
\tau_{1}
\tau_{1}
\min
\tau_{2}
\max
\tau_{2}\rightarrow\infty
\hat{d}^{(2)}_{H}
\max
\hat{d}^{(2)}_{H,avg}
\min
\hat{d}^{(2)}_{H,prob}
\gamma\in\{1,3,10,30,100,300,1000,3000,10000\}
\hat{d}^{(2)}_{H}
\max
\hat{d}^{(2)}_{H,avg}
\min
\hat{d}^{(2)}_{H,prob}
\gamma\in\{1,3,10,30,100,300,1000,3000,10000\}
\downarrow
\hat{d}^{(2)}_{H}
\hat{d}^{(2)}_{H,avg}
\hat{d}^{(2)}_{H,prob}
\hat{d}^{sub}_{H}
\hat{d}^{sub}_{H}
\hat{d}^{sub}_{H}
8\cdot 10^{3}
\hat{d}^{sub}_{H}
8\cdot 10^{4}
\hat{d}^{sub}_{H}
8\cdot 10^{5}
\max
\max
\hat{d}^{(2)}_{H}
64\%
~{}75\%
\gamma\in\{0.01,0.1,1,10,100\}
\hat{d}^{(2)}_{H}
64\%
~{}75\%
\gamma\in\{0.01,0.1,1,10,100\}
\downarrow
\hat{d}_{H}^{(2)}
\max
\min
d(\mathbf{z},\mathbf{z}^{\prime})
\max
\min
\gamma\in\{1,3,10,30,100,300,1000,3000,10000\}
\max
\min
\min
\max
\max
\max
\min
\tau_{1}
\tau_{2}
\tau_{2}
\hat{d}^{(2)}_{H}
k
k\choose 2
\mathcal{L}_{\text{HFS}}
\beta
\beta
\hat{d}^{(2)}_{H}
\gamma=100
\delta\in\{0,1,3,10,30,100,300,1000,3000,10000\}
\in\{10^{-6},10^{-5},10^{-4},10^{-3},10^{-2},10^{-1}\}
\hat{d}^{(2)}_{H}
\gamma=100
\delta\in\{0,1,3,10,30,100,300,1000,3000,10000\}
\in\{10^{-6},10^{-5},10^{-4},10^{-3},10^{-2},10^{-1}\}
\downarrow
\rightarrow
\rho
\mathcal{L}_{\text{scale}}=\sum_{i=1}^{d}\max\left[0,1-\sqrt{\text{Var}\left[%
\mathbf{z}_{:,i}\right]}\right]
[a,b]
\mathcal{L}_{\text{scale}}=\sum_{i=1}^{d}\max\left[0,b-\max(\mathbf{z}_{:,i})%
\right]+\max\left[0,\min(\mathbf{z}_{:,i})-a\right]
\gamma
\gamma
\delta
\delta\in\{0,1,3,10,30,100,300,1000,3000,10000\}
\in\{10^{-6},10^{-5},10^{-4},10^{-3},10^{-2},10^{-1}\}
\gamma
\gamma
\beta
\beta
\gamma
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\beta
\beta
\beta
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\beta
\beta
\beta
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\sigma
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
\beta
R\in\mathbb{R}^{d\times k}
d
k
\text{DCI-D}=\sum_{i}^{d}(1-H(\text{Norm}(R_{i,:}))\sum_{j}^{k}\frac{R_{i,j}}{%
\sum_{i^{*}}\sum_{j^{*}}R_{i^{*},j^{*}}}
\text{MIG}=\frac{1}{k}\sum_{i=1}^{k}\frac{I(\tilde{z}_{\tilde{m}(k,1)},z_{k})-%
I(\tilde{z}_{\tilde{m}(k,2)},z_{k})}{H(z_{k})}
k
z_{k}
H(z_{k})
z_{k}
\tilde{z}_{i}
i
\tilde{m}(k,n)
n
k
d
k
\text{Modularity}=\frac{1}{d}\sum_{i}^{d}\frac{\sum_{j}(m_{i,j}\cdot\mathbb{I}%
_{j=\text{argmax}_{g}m_{i,g}})^{2}}{(\max_{g}m_{i,g})^{2}(k-1)}
i
i
m_{i,j}
i
j
64\times 64\times n_{c}
n_{c}
32,4\times 4
\times
64,4\times 4
\times
\times
64,4\times 4
\times
32,4\times 4
n_{c},4\times 4
\beta_{1}=0.9,\beta_{2}=0.999,\epsilon=10^{-8}
10^{-4}
\beta_{1}=0.5,\beta_{2}=0.9,\epsilon=10^{-8}
\beta
\beta
\beta
\beta
\beta
c_{\text{max}}
\beta
\gamma
\beta
\gamma
10^{5}
\gamma=10^{3}
p(c_{i},c_{j})
\hat{d}^{(2)}_{H}
\hat{d}^{(2)}_{H}
