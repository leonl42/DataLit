X\in\mathcal{X}
Y\in\mathcal{Y}
f\colon\mathcal{X}\times\mathcal{T}\rightarrow\mathcal{Y}
\mathcal{T}\triangleq\mathcal{T}_{1}\times\ldots\times\mathcal{T}_{n}
n
(\tau_{1},\ldots,\tau_{n})
f
f
\mathcal{D}_{\textrm{train}}
n
\mathcal{D}_{\textrm{train}}
f
n=3
(\tau_{1},\tau_{2},\tau_{3})
\{Q_{1},\ldots,Q_{c+1}\}
Q_{i}(\tau_{1},\ldots,\tau_{n})=\mathbb{E}[q_{i}(X,Y;\tau_{1},\ldots,\tau_{n})]
q_{i}
c
\{\alpha_{1},\ldots,\alpha_{c}\}\in\mathbb{R}^{c}
Q_{c+1}
(\tau_{1},\ldots,\tau_{n})
Q_{i}
\mathcal{D}_{\mathrm{cal}}=(X_{i},Y_{i})
i=1,\ldots,m
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\mathcal{D}_{\mathrm{cal}}
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
Q_{i}(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\mathcal{D}_{\mathrm{cal}}
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\{Q_{1},\ldots,Q_{c}\}
(\alpha,\delta)
\mathcal{D}_{\mathrm{cal}}=\{(X_{i},Y_{i})\}_{i=1}^{m}
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\{Q_{i}(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})\}_{i=1}^{c}
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\{\alpha_{i}\}_{i=1}^{c}
\delta\in(0,1)
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
(\alpha,\delta)
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\mathbb{P}\left(Q_{i}(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})\leq\alpha_{i}%
\right)\geq 1-\delta,\>\>\forall 1\leq i\leq c\quad\text{simultaneously,}
\mathcal{D}_{\mathrm{cal}}
(\alpha,\delta)
Q_{c+1}
Q_{c+1}(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
f
\bm{\tau}=(\tau_{1},\ldots,\tau_{n})\in\mathcal{T}
Q
\mathcal{T}_{g}
\mathcal{T}
\bm{\tau}\in\mathcal{T}_{g}
H_{\bm{\tau}}\colon Q(\bm{\tau})>\alpha
H_{\bm{\tau}}
\bm{\tau}
p^{\textrm{cal}}(\bm{\tau},\alpha)=p(\hat{Q}^{\mathrm{cal}}(\bm{\tau});\alpha,m)
H_{\bm{\tau}}
\hat{Q}^{\mathrm{cal}}(\bm{\tau})
p(\cdot)
\bm{\tau}
\mathcal{T}_{g}
\bm{\tau}
\delta\in(0,1)
H_{\bm{\tau}}:\exists i\text{ where }Q_{i}(\bm{\tau})>\alpha_{i}
p^{\textrm{cal}}(\bm{\tau},\bm{\alpha})=\max_{1\leq i\leq c}p(\hat{Q}_{i}^{%
\textrm{cal}}(\bm{\tau});\alpha_{i},m),\quad\text{with $\bm{\alpha}=(\alpha_{1%
},\ldots,\alpha_{c})$.}
\bm{\alpha}=(\alpha_{1},\ldots,\alpha_{c})
H_{\bm{\tau}}
\bm{\tau}
H_{\bm{\tau}}
\delta
H_{\bm{\tau}}
\delta/|\mathcal{T}_{g}|
\bm{\tau}\in\mathcal{T}_{g}
|\mathcal{T}_{g}|
\mathcal{T}
\bm{\tau}\in\mathcal{T}_{g}
\mathcal{T}
Q_{c+1}
\begin{split}\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad\hat{Q}_{c+1}(\tau_{1},\ldots,\tau_{n})\quad\textrm{s.t.}\quad\hat{Q}_{%
i}(\tau_{1},\ldots,\tau_{n})<\alpha_{i},\>\>\forall 1\leq i\leq c,\end{split}
\hat{Q}_{i}
(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
1-\delta
Q_{i}(\hat{\tau}_{1},\ldots,\hat{\tau}_{n})
\alpha_{i}
1-\delta
H_{\bm{\tau}}
\mathcal{D}_{\mathrm{opt}}
\mathcal{D}_{\mathrm{testing}}
m_{1}
m_{2}
k\geq 1
\mathcal{D}_{\mathrm{opt}}
\displaystyle\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad\{\hat{Q}^{\mathrm{opt}}_{1}(\tau_{1},\ldots,\tau_{n}),\ldots,\hat{Q}^{%
\mathrm{opt}}_{c+k}(\tau_{1},\ldots,\tau_{n})\}.
\displaystyle\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad
\displaystyle\{\hat{Q}^{\mathrm{opt}}_{1}(\tau_{1},\ldots,\tau_{n}),\ldots,%
\hat{Q}^{\mathrm{opt}}_{c+k}(\tau_{1},\ldots,\tau_{n})\}.
\mathcal{T}_{\textrm{par}}=\{\bm{\tau}^{\prime}\in\mathcal{T}:\;\{\bm{\tau}^{%
\prime\prime}\in\mathcal{T}:\;\bm{\tau}^{\prime\prime}\succ\bm{\tau}^{\prime},%
\bm{\tau}^{\prime}\neq\bm{\tau}^{\prime\prime}\;\}=\emptyset\}.
\bm{\tau}^{\prime\prime}\succ\bm{\tau}^{\prime}
\hat{Q}_{i}^{\mathrm{opt}}(\bm{\tau}^{\prime\prime})<\hat{Q}^{\mathrm{opt}}_{i%
}(\bm{\tau}^{\prime}),\>\forall 1\leq i\leq c+k
\mathcal{D}_{\textrm{opt}}
\bm{\tau}\in\mathcal{T}_{\textrm{par}}
p^{\textrm{opt}}(\bm{\tau},\bm{\alpha})=\max_{1\leq i\leq c}p(\hat{Q}_{i}^{%
\mathrm{opt}}(\bm{\tau});\alpha_{i},m_{1})
\mathcal{D}_{\mathrm{opt}}
c
[0,1]
\alpha_{i}\ll\alpha_{j})
k
c>1
\mathcal{T}^{\prime}_{\textrm{par}}=\operatorname*{arg\,min}_{\bm{\tau}\in%
\mathcal{T}_{\textrm{par}}}\left\{p^{\textrm{opt}}(\bm{\tau},\bm{\alpha}),\hat%
{Q}^{\textrm{opt}}_{c+1}(\bm{\tau}),\ldots,\hat{Q}^{\textrm{opt}}_{c+k}(\bm{%
\tau})\right\}
\mathcal{T}_{\mathrm{par}}
\{1,\ldots,c\}
\{c+1,\ldots,c+k\}
p^{\textrm{opt}}(\bm{\tau},\bm{\alpha})
Q_{1}
\alpha
Q_{2}
Q_{1}
Q_{1}
\alpha
Q_{2}
Q_{1}
\mathcal{T}_{\mathrm{par}}
\mathcal{D}_{\mathrm{opt}}
\mathcal{D}_{\mathrm{testing}}
\mathcal{T}_{r}\subseteq\mathcal{T}_{\textrm{par}}
H_{\bm{\tau}}
\mathcal{T}^{*}=\operatorname*{arg\,min}_{\bm{\tau}\in\mathcal{T}_{r}}\{\hat{Q%
}^{\mathrm{testing}}_{c+1}(\bm{\tau}),\ldots,\hat{Q}^{\mathrm{testing}}_{c+k}(%
\bm{\tau})\}
k=1
k>1
\bm{\alpha}
f
n
\bm{\tau}=(\tau_{1},\ldots,\tau_{n})
\mathcal{D}_{\mathrm{cal}}=\mathcal{D}_{\mathrm{opt}}\cup\mathcal{D}_{\mathrm{%
testing}}
m
m_{1}
m_{2}
\{Q_{1},\ldots,Q_{c+k}\}
\bm{\alpha}=\{\alpha_{1},\ldots,\alpha_{c}\}
c
\delta
B
\mathcal{D}_{\textrm{opt}},\bm{\alpha}
\operatorname*{arg\,min}_{\bm{\tau}\in\mathcal{T}}\{\hat{Q}^{\textrm{opt}}_{1}%
(\bm{\tau}),\ldots,\hat{Q}^{\textrm{opt}}_{c+k}(\bm{\tau})\}
B
\bm{\tau}^{1},\ldots,\bm{\tau}^{B}
p^{\textrm{opt}}(\bm{\tau},\bm{\alpha})=\max_{1\leq i\leq c}p(\hat{Q}^{\textrm%
{opt}}_{i}(\bm{\tau});\alpha_{i},m_{1})
p^{\textrm{opt}}(\bm{\tau},\bm{\alpha})
\mathcal{T}_{\textrm{opt}}=(\bm{\tau}^{(1)},\ldots,\bm{\tau}^{(B)})
\mathcal{T}_{\textrm{opt}}
\mathcal{D}_{\textrm{testing}}
\mathcal{T}_{\textrm{opt}}
\bm{\alpha}
\delta
\hat{Q}^{\textrm{testing}}_{i}(\bm{\tau})=\frac{1}{m_{2}}\sum_{(x,y)\in%
\mathcal{D}_{\textrm{testing}}}q_{i}(x,y;\bm{\tau}),1\leq i\leq c
\bm{\tau}\in\mathcal{T}_{\textrm{opt}}
p^{\textrm{testing}}(\bm{\tau},\bm{\alpha})=\max_{1\leq i\leq c}p(\hat{Q}^{%
\textrm{testing}}_{i}(\bm{\tau});\alpha_{i},m_{2})
\mathcal{T}_{r}=\{\bm{\tau}^{(j)}:j<J\},\>\>J=\min_{j}\{j:p^{\textrm{testing}}%
(\bm{\tau}^{(j)},\bm{\alpha})\geq\delta\}
\mathcal{T}^{*}=\operatorname*{arg\,min}_{\bm{\tau}\in\mathcal{T}_{r}}\{\hat{Q%
}_{c+1}(\bm{\tau}),\ldots,\hat{Q}_{c+k}(\bm{\tau})\}
\mathcal{T}^{*}
\mathcal{D}_{\mathrm{cal}}=\{(X_{i},Y_{i})\}_{i=1}^{m}
\mathcal{D}_{\mathrm{opt}}
\mathcal{D}_{\mathrm{testing}}
p^{\mathrm{testing}}(\bm{\tau},\bm{\alpha})
\bm{\tau}
\mathbb{P}(p^{\mathrm{testing}}(\bm{\tau},\bm{\alpha})\leq u)\leq u
u\in[0,1]
\mathcal{D}_{\mathrm{testing}}
\mathcal{T}^{*}
(\alpha,\delta)
k>1
\mathcal{T}^{*}
\bm{\tau}_{i}^{*}\in\mathcal{T}^{*}
\mathcal{T}^{*}
(X,Y)
\bm{\tau}_{j}^{*}\in\mathcal{T}^{*}
\Delta_{j}
\Delta\in\mathbb{R}^{|\mathcal{T}^{*}|}
|\mathcal{T}^{*}|-1
(\alpha,\delta)
k
\mathcal{T}^{*}
(\alpha,\delta)
K
W
L(X)
\tau^{\textrm{tok}}
L_{j}(X;\tau^{\textrm{tok}})
j
\tau^{\textrm{layer}}
K_{\textrm{exit}}(X;\tau^{\textrm{layer}})
W_{j}(\tau^{\textrm{head}})
j
f(\cdot;\bm{\tau}_{0})
Q_{\textrm{cost}}(\bm{\tau})=\mathbb{E}\Bigg{[}\frac{\sum_{j=1}^{K_{\textrm{%
exit}}(X;\tau^{\textrm{layer}})}W_{j}(\tau^{\textrm{head}})\cdot L_{j}(X;\tau^%
{\textrm{tok}})^{2}}{\sum_{j=1}^{K}W\cdot L(X)^{2}}\Bigg{]}.
D(X,Y;\bm{\tau})=\mathbf{1}\{f(X;\bm{\tau}_{0})=Y\}-\mathbf{1}\{f(X;\bm{\tau})%
=Y\}
0
1
1
Q_{\textrm{acc}}(\bm{\tau})=\mathbb{E}\left[D(X,Y;\bm{\tau})\right]=\mathbb{E}%
\left[\mathbf{1}\{f(X;\bm{\tau}_{0})=Y\}\right]-\mathbb{E}\left[\mathbf{1}\{f(%
X;\bm{\tau})=Y\}\right],
[0,1]
D(X,Y;\bm{\tau})^{\prime}=\left[D(X,Y;\bm{\tau})\right]_{+}
\mathbb{E}\left[D(X,Y;\bm{\tau})\right]\leq\mathbb{E}\left[D^{\prime}(X,Y;\bm{%
\tau})\right]
\mathbb{E}\left[D^{\prime}(X,Y;\bm{\tau})\mid Y=y\right]\leq\alpha,\>\>\forall
y%
\in\mathcal{Y}.
Q_{\textrm{acc-class}}(y;\bm{\tau})=\mathbb{E}\left[D^{\prime}(X,Y;\bm{\tau})%
\cdot\mathbf{1}\{Y=y\}+\alpha\cdot\mathbf{1}\{Y\neq y\}\right]\leq\alpha,\>\>%
\forall y\in\mathcal{Y}.
|\mathcal{Y}|
\lambda
\max_{y}f(X,y;\bm{\tau})
20\%
Q_{\textrm{abstention-rate}}(\bm{\tau},\lambda)=\mathbb{E}\big{[}\mathbf{1}%
\big{\{}\max_{y}f(X,y;\bm{\tau})<\lambda\big{\}}\big{]}.
K=12
W=12
\alpha\in\{0.025,0.5,\ldots,0.2\}
\delta=0.1
100
\alpha\in\{0.025,0.5,\ldots,0.2\}
\delta=0.1
100
\alpha
(\alpha,\delta)
6480
18
20
18
\alpha
\alpha
\alpha
\alpha
\alpha
\delta=0.1
\alpha_{1}
\alpha_{2}=0.15
\alpha_{1}
\alpha_{1}
100
\alpha=0.05
100
\alpha=0.05
100
\alpha_{1}\in\{0.025,0.5,\ldots,0.2\}
\alpha_{2}=0.15
\delta=0.1
100
\alpha_{1}\in\{0.025,0.5,\ldots,0.2\}
\alpha_{2}=0.15
\delta=0.1
50
\alpha
p_{i}(\bm{\tau},\bm{\alpha})
H_{\bm{\tau},i}:Q_{i}(\bm{\tau})>\alpha_{i}
i\in\{1,\ldots,c\}
p(\bm{\tau},\bm{\alpha}):=\max_{1\leq i\leq c}p_{i}(\bm{\tau},\alpha_{i})
\bm{\tau}
H_{\bm{\tau}}:\exists i\text{ where }Q_{i}(\bm{\tau})>\alpha_{i}
\mathbb{P}\left(p(\bm{\tau},\bm{\alpha})\leq u\right)\leq u
\mathcal{I}\subseteq\{1,\ldots,c\}
\bm{\tau}
\begin{split}\mathbb{P}\Big{(}p(\bm{\tau},\bm{\alpha})\leq u\Big{)}&\leq%
\mathbb{P}\left(\max_{i\in\mathcal{I}}p_{i}(\bm{\tau},\bm{\alpha})\leq u\right%
)\\
&=\mathbb{P}\left(\bigcap_{i\in\mathcal{I}}p_{i}(\bm{\tau},\alpha_{i})\leq u%
\right)\leq\max_{i\in\mathcal{I}}\mathbb{P}\left(p(\bm{\tau},\alpha_{i})\leq u%
\right).\end{split}
i\in\mathcal{I}
\mathbb{P}\left(p_{i}(\bm{\tau},\alpha_{i})\leq u\right)\leq u
\max_{i\in\mathcal{I}}\mathbb{P}\left(p(\bm{\tau},\alpha_{i})\leq u\right)\leq
u
\mathbb{P}\left(p(\bm{\tau},\bm{\alpha})\leq u\right)\leq u
\mathcal{D}_{\mathrm{opt}}
\mathcal{D}_{\mathrm{testing}}
\mathcal{D}_{\mathrm{testing}}
\mathcal{D}_{\mathrm{opt}}
p^{\mathrm{testing}}(\bm{\tau},\bm{\alpha})
H_{\bm{\tau}}
(\alpha,\delta)
\mathcal{T}_{r}
H_{\bm{\tau}^{\prime}}
p(\bm{\tau}^{\prime},\bm{\alpha})
H_{\bm{\tau}^{\prime}}
\bm{\tau}^{\prime}
\delta
H_{\bm{\tau}^{\prime}}
H_{\bm{\tau}}
H_{\bm{\tau}}
\delta
\mathcal{T}^{*}\subseteq\mathcal{T}_{r}
1-\delta
\mathcal{T}^{*}
(\alpha,\delta)
(X,Y)
\bm{\tau}_{j}^{*}\in\mathcal{T}^{*}
\Delta_{j}
\Delta\in\mathbb{R}^{|\mathcal{T}^{*}|}
|\mathcal{T}^{*}|-1
\mathcal{D}_{\mathrm{cal}}
\mathcal{T}^{*}
Q_{i}(\bm{\tau}_{j}^{*})=\mathbb{E}[q_{i}(X,Y;\bm{\tau}_{j}^{*})]
\bm{\tau}_{j}^{*}\in\mathcal{T}^{*}
i\in\{1,\ldots,c\}
Q_{i}
\begin{split}Q_{i}(\bm{\tau}^{\textrm{share}})&=\sum_{j=1}^{|\mathcal{T}^{*}|}%
\Delta_{j}Q_{i}(\bm{\tau}_{j}^{*})\\
&\leq\sum_{j=1}^{|\mathcal{T}^{*}|}\Delta_{j}\max_{j^{\prime}}Q_{i}(\bm{\tau}_%
{j^{\prime}}^{*})=\max_{j^{\prime}}Q_{i}(\bm{\tau}_{j^{\prime}}^{*}).\end{split}
E
\bm{\tau}_{j}^{*}\in\mathcal{T}^{*}
Q_{i}
\alpha_{i}
\mathcal{D}_{\mathrm{cal}}
1-\delta
\mathbb{P}\left(Q_{i}(\bm{\tau}^{\textrm{share}})\leq\alpha_{i}\right)\geq%
\mathbb{P}(\max_{j^{\prime}}Q_{i}(\bm{\tau}_{j^{\prime}}^{*})\leq\alpha_{i})%
\geq 1-\delta,~{}~{}\forall i\in\{1,\ldots,c\}\text{ simultaneously.}
\bm{\tau}^{\mathrm{share}}
(\alpha,\delta)
\Delta
P(Y=y)>0
f_{X|Y}(X|Y=y)
\frac{f_{XY}(X,Y=y)}{P(Y=y)}=\frac{f_{XY}(X,Y=y)}{\mathbb{E}\left[\mathbf{1}\{%
Y=y\}\right]}
0
\mathbb{E}\left[D^{\prime}(X,Y;\tau)|Y=y\right]=\frac{\mathbb{E}\left[D^{%
\prime}(X,Y;\tau)\cdot\mathbf{1}\{Y=y\}\right]}{\mathbb{E}\left[\mathbf{1}\{Y=%
y\}\right]}\leq\alpha.
\mathbb{E}\left[\mathbf{1}\{Y=y\}\right]
\mathbb{E}\left[D^{\prime}(X,Y;\tau)\cdot\mathbf{1}\{Y=y\}\right]\leq\alpha%
\cdot{\mathbb{E}\left[\mathbf{1}\{Y=y\}\right]}=\alpha\cdot\left(1-\mathbb{E}%
\left[\mathbf{1}\{Y\neq y\}\right]\right)
\mathbb{E}\left[D^{\prime}(X,Y;\tau)\cdot\mathbf{1}\{Y=y\}+\alpha\cdot\mathbf{%
1}\{Y\neq y\}\right]\leq\alpha,\>\>\forall y\in\mathcal{Y}
\alpha
\begin{split}p(\bm{\tau},\alpha)=\max_{y\in\mathcal{Y}}p\left(\hat{Q}_{\textrm%
{acc-class}}(y,\bm{\tau});\alpha,m\right)=p\left(\max_{y\in\mathcal{Y}}\hat{Q}%
_{\textrm{acc-class}}(y,\bm{\tau});\alpha,m\right).\end{split}
|\mathcal{Y}|
\hat{Q}_{\textrm{acc-worst}}(\bm{\tau})=\max_{y\in\mathcal{Y}}\hat{Q}_{\textrm%
{acc-class}}(y,\bm{\tau})
\begin{split}&Q_{\textrm{select-cost}}(\bm{\tau},\lambda)=\\
&\hskip 42.67912pt\mathbb{E}\left[q_{\textrm{cost}}(X;\bm{\tau})\cdot\mathbf{1%
}\left\{\max_{y}f(X,y;\bm{\tau})\geq\lambda\right\}+\alpha\cdot\mathbf{1}\left%
\{\max_{y}f(X,y;\bm{\tau})<\lambda\right\}\right]\end{split}
\begin{split}&Q_{\textrm{select-acc}}(\bm{\tau},\lambda)=\\
&\hskip 42.67912pt\mathbb{E}\left[q_{\textrm{acc}}(X;\bm{\tau})\cdot\mathbf{1}%
\left\{\max_{y}f(X,y;\bm{\tau})\geq\lambda\right\}+\alpha\cdot\mathbf{1}\left%
\{\max_{y}f(X,y;\bm{\tau})<\lambda\right\}\right].\end{split}
K
L
x
x=\left(x_{1},\ldots,x_{L}\right)
e=\left(e_{1},\ldots,e_{L}\right)
h_{j}=\left(h_{j,1},\ldots,h_{j,L}\right)
k
W
a_{j}=\sum_{w=1}^{W}\textrm{Attn}_{j,w}(h_{j-1})
|\mathcal{Y}|
f(x,y)
y
\mathcal{L}
s^{\textrm{tok}}_{j}:\mathcal{X}\rightarrow\mathbb{R}
h_{j,l}
r_{l}=\left\|\frac{\partial f(x,y_{c})}{\partial e_{l}}\odot e_{l}\right\|_{2}
y_{c}
\odot
k
s^{\textrm{tok}}_{j}(x_{l})<\tau^{\textrm{tok}}
L_{j}(x;\tau^{\textrm{tok}})=\sum_{l=1}^{L}\bigcap_{j^{\prime}=1}^{j}\mathbf{1%
}\left\{s^{\textrm{tok}}_{j^{\prime}}(x_{l})>\tau^{\textrm{tok}}\right\}
f_{j}:\mathcal{X}\rightarrow\mathcal{Y}
s^{\textrm{layer}}_{j}(x)=\sum_{y\in|\mathcal{Y}|}p_{j}(y|x)\log p_{j}(y|x)
p_{j}(y|x)
k
s^{\textrm{layer}}_{j}(x)<\tau^{\textrm{layer}}
k
x
K_{\textrm{exit}}(x;\tau^{\textrm{layer}})=\operatorname*{arg\,min}_{j}\left\{%
j\in\{1,\ldots,K\}\Big{|}s^{\textrm{layer}}_{j}(x)<\tau^{\textrm{layer}}\right\}
(w,j),\>1\leq j\leq K,1\leq w\leq W
s^{\textrm{head}}_{j}(w)
s^{\textrm{head}}_{j}(w)=\left|\textrm{Attn}_{j,w}(h_{j-1})^{T}\frac{\partial%
\mathcal{L}}{\partial\textrm{Attn}_{j,w}(h_{j-1})}\right|.
s^{\textrm{head}}_{j}(w)<\tau^{\textrm{head}}
W_{j}(\tau^{\textrm{head}})=\sum_{w=1}^{W}\mathbf{1}\left\{s^{\textrm{head}}_{%
j}(w)>\tau^{\textrm{head}}\right\}
x
2
32
2
32
|\mathcal{Y}|
2
20
5
10
5
4
115
5
7.6
5
2
\sim 10
5
\sim 5.5
3.4
2
\sim 360
5
10
5
3
\sim 250
\sim 150
30
10
86
50
50
\alpha=0.05,\delta=0.1
\alpha=0.05,\delta=0.1
\bm{\alpha}
\delta
\displaystyle\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad\left\{\hat{Q}_{c+1}(\tau_{1},\ldots,\tau_{n}),\ldots,\hat{Q}_{c+k}(%
\tau_{1},\ldots,\tau_{n})\right\}
\displaystyle\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad
\displaystyle\left\{\hat{Q}_{c+1}(\tau_{1},\ldots,\tau_{n}),\ldots,\hat{Q}_{c+%
k}(\tau_{1},\ldots,\tau_{n})\right\}
\displaystyle\textrm{s.t.}\hat{Q}_{i}(\tau_{1},\ldots,\tau_{n})<\alpha_{i}-%
\epsilon,\>\>\forall 1\leq i\leq c
\displaystyle\hat{Q}_{i}(\tau_{1},\ldots,\tau_{n})<\alpha_{i}-\epsilon,\>\>%
\forall 1\leq i\leq c
\epsilon
[0,\ldots,\min_{i}\alpha_{i}]
\epsilon
\displaystyle\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad\left\{\hat{Q}_{c+1}(\tau_{1},\ldots,\tau_{n}),\ldots,\hat{Q}_{c+k}(%
\tau_{1},\ldots,\tau_{n})\right\}
\displaystyle\operatorname*{arg\,min}_{(\tau_{1},\ldots,\tau_{n})\in\mathcal{T%
}}\quad
\displaystyle\left\{\hat{Q}_{c+1}(\tau_{1},\ldots,\tau_{n}),\ldots,\hat{Q}_{c+%
k}(\tau_{1},\ldots,\tau_{n})\right\}
\displaystyle\textrm{s.t.}\hat{Q}_{i}(\tau_{1},\ldots,\tau_{n})<\alpha_{i}-%
\epsilon_{i},\>\>\forall 1\leq i\leq c
\displaystyle\hat{Q}_{i}(\tau_{1},\ldots,\tau_{n})<\alpha_{i}-\epsilon_{i},\>%
\>\forall 1\leq i\leq c
\epsilon_{i}
[0,\ldots,\alpha_{i}]
(\epsilon_{1},\ldots,\epsilon_{c})
f
6480
18
20
18
6480
18
20
18
\alpha
\alpha,\delta
\alpha
\delta=0.1
\alpha\in\{0.025,0.5,\ldots,0.2\}
\delta=0.1
100
\alpha\in\{0.025,0.5,\ldots,0.2\}
\delta=0.1
100
\alpha\in\{0.1,0.2,0.3\}
\delta=0.1
100
\alpha\in\{0.1,0.2,0.3\}
\delta=0.1
100
\alpha=0.1
\alpha=0.2
\alpha=0.3
0.05
0.04
0.14
0.09
0.03
0.02
0.09
0.06
0.02
0.00
0.05
0.03
0.05
0.04
0.15
0.10
0.02
0.02
0.09
0.06
0.00
0.00
0.06
0.03
0.26
0.10
0.22
0.25
0.17
0.05
0.26
0.11
0.02
0.01
0.12
0.05
0.05
0.04
0.13
0.09
0.02
0.02
0.08
0.06
0.02
0.00
0.05
0.03
\alpha
10
\alpha
10
\alpha=0.025
\alpha=0.05
\alpha=0.1
\times 2.34
\times 1.71
\times\mathbf{1.38}
\mathbf{\times 1.89}
\times 2.89
\times 4.45
\times\mathbf{1.59}
\times 2.16
\times 3.12
\times 4.45
\times 1.99
\times 2.71
\times 2.11
\times 1.69
\times 1.35
\times 1.66
\times 2.38
\times 1.99
\times 1.50
\times 2.15
\times 2.80
\times 4.18
\times 1.89
\times 2.69
\times 2.38
\times 3.86
\times 1.37
\times 1.85
\times 2.95
\times 4.2
\times 1.56
\times 2.16
\times 3.65
\times 4.20
\times 1.94
\times 2.73
\mathbf{\times 2.42}
\mathbf{\times 4.82}
\times 1.37
\times 1.86
\mathbf{\times 3.00}
\mathbf{\times 4.82}
\mathbf{\times 1.59}
\mathbf{\times 2.18}
\times\mathbf{3.65}
\times\mathbf{4.82}
\times\mathbf{2.02}
\times\mathbf{2.86}
\lambda
\lambda
\lambda
\alpha_{1}\in\{0.025,0.5,\ldots,0.2\}
\alpha_{2}=0.15
\delta=0.1
100
\alpha_{1}\in\{0.025,0.5,\ldots,0.2\}
\alpha_{2}=0.15
\delta=0.1
100
\alpha_{1}\in\{0.025,0.5,\ldots,0.2\}
\alpha_{2}=0.1
\delta=0.1
100
\alpha_{1}\in\{0.025,0.5,\ldots,0.2\}
\alpha_{2}=0.1
\delta=0.1
100
\mathcal{T}_{g}
\mathcal{T}_{r}\subseteq\mathcal{T}_{g}
\mathbb{P}\left(|\mathcal{T}_{r}\cap\mathcal{T}_{0}|\geq 1\right)\leq\delta
\mathcal{T}_{0}\subseteq\mathcal{T}_{g}
\mathcal{H}_{BF}=\left\{H_{\bm{\tau}}:p^{\textrm{cal}}(\bm{\tau},\bm{\alpha})<%
\delta/|\mathcal{T}_{g}|\right\}
H_{\bm{\tau}^{(1)}},\ldots,H_{\bm{\tau}^{(|\mathcal{T}_{g}|)}}
\mathcal{H}_{FST}=\{H_{(j)}:j<J\},\>\>J=\min_{j}\{j:p_{(j)}\geq\delta\}
n=1
G
i
\beta
0
1
\beta
\beta
f
n
\bm{\tau}=(\tau_{1},\ldots,\tau_{n})
\mathcal{D}_{\textrm{cal}}
m
Q
\alpha
\delta
\mathcal{T}_{g}
\mathcal{D}_{\textrm{cal}}
\mathcal{T}_{g}
\alpha
\delta
\bm{\tau}\in\mathcal{T}_{g}
H_{\bm{\tau}}:\>Q(\bm{\tau})\geq\alpha
\mathcal{D}_{\textrm{cal}}
\hat{Q}^{\textrm{cal}}(\bm{\tau})=\frac{1}{m}\sum_{(x,y)\in\mathcal{D}_{%
\textrm{cal}}}q(x,y;\bm{\tau})
p^{\textrm{cal}}(\bm{\tau},\alpha)=p\left(\hat{Q}^{\textrm{cal}}(\bm{\tau});%
\alpha,m\right)=e^{-2m\left(\alpha-\hat{Q}^{\textrm{cal}}(\bm{\tau})\right)^{2%
}_{+}}
\mathcal{T}_{r}\subseteq\mathcal{T}_{g}
\mathcal{T}_{r}
f
n
\bm{\tau}=(\bm{\tau}_{1},\ldots,\tau_{n})
\mathcal{D}_{\textrm{cal}}
m
Q_{1},\ldots,Q_{c}
\bm{\alpha}=(\alpha_{1},\ldots,\alpha_{c})
\delta
I\times J\times K
\mathcal{T}_{g}=\{\tau_{1}^{1},\ldots,\tau_{1}^{I}\}\times\{\tau_{2}^{1},%
\ldots,\tau_{2}^{J}\}\times\{\tau_{3}^{1},\ldots,\tau_{3}^{K}\}
\tau^{i,j,k}=(\tau_{1}^{i},\tau_{2}^{j},\tau_{3}^{k})
W
I\times J\times K
W_{{i^{\prime},j^{\prime},k^{\prime}}\rightarrow{i,j,k}}
\mathbf{A}
I\times J\times K
\sum_{i,j,k}A_{i,j,k}=\delta
\mathcal{D}_{\textrm{cal}},\bm{\alpha},\mathbf{A}
\bm{\tau}\in\mathcal{T}_{g}
\bm{\tau}\in\mathcal{T}_{g}
\hat{Q}^{\textrm{cal}}_{i}(\bm{\tau})=\frac{1}{m}\sum_{(x,y)\in\mathcal{D}_{%
\textrm{cal}}}q_{i}(x,y;\bm{\tau})
\bm{\tau}\in\mathcal{T}_{g}
p^{\textrm{cal}}(\bm{\tau},\bm{\alpha})=\max_{1\leq i\leq c}p\left(\hat{Q}^{%
\textrm{cal}}_{i}(\bm{\tau});\alpha_{i},m\right)
\mathcal{T}_{r}\leftarrow\textsc{Sgt}\left(W,p^{\textrm{cal}}(\bm{\tau},\bm{%
\alpha})\right)
\mathcal{T}_{r}
W,p^{\textrm{cal}}(\bm{\tau},\bm{\alpha})
\mathcal{I}=\{1,\ldots,I\}\times\{1,\ldots,J\}\times\{1,\ldots,K\}
\mathcal{T}_{r}\leftarrow\{\}
i^{*},j^{*},k^{*}=\operatorname*{arg\,min}_{(i,j,k)\in\mathcal{I}}p^{\textrm{%
cal}}(\bm{\tau}^{i,j,k},\bm{\alpha})/A_{i,j,k}
|\mathcal{I}|\geq 1
p^{\textrm{cal}}(\bm{\tau}^{i,j,k},\bm{\alpha})<A_{i^{*},j^{*},k^{*}}
\mathcal{T}_{r}\leftarrow\mathcal{T}_{r}\cup\bm{\tau}^{i^{*},j^{*},k^{*}}
\mathcal{I}\leftarrow\mathcal{I}/(i^{*},j^{*},k^{*})
A_{i,j,k}\leftarrow A_{i,j,k}+A_{i*,j*,k*}W_{{i*,j*,k*}\rightarrow{i,j,k}},%
\forall(i,j,k)\in\mathcal{I}
i^{*},j^{*},k^{*}=\operatorname*{arg\,min}_{(i,j,k)\in\mathcal{I}}p^{\textrm{%
cal}}(\bm{\tau}^{i,j,k},\bm{\alpha})/A_{i,j,k}
\mathcal{T}_{r}
f
n
\bm{\tau}=(\tau_{1},\ldots,\tau_{n})
\mathcal{D}_{\mathrm{cal}}=\mathcal{D}_{\mathrm{opt}}\cup\mathcal{D}_{\mathrm{%
testing}}
m
m_{1}
m_{2}
Q_{1},\ldots,Q_{c}
\bm{\alpha}=(\alpha_{1},\ldots,\alpha_{c})
\delta
\bm{\gamma}=(\gamma_{1},\ldots,\gamma_{n})
\gamma_{j}
j
\bm{\tau}_{\textrm{min}}
\bm{\tau}_{\textrm{max}}
\mathcal{D}_{\textrm{opt}},\bm{\alpha}
\operatorname*{arg\,min}_{\bm{\tau}\in\mathcal{T}}\hat{Q}^{\textrm{opt}}_{c}(%
\bm{\tau}),\textrm{ s.t. }\hat{Q}^{\textrm{opt}}_{i}(\bm{\tau})<\alpha_{i},%
\forall 1\leq i\leq c-1
\bm{\tau}_{\textrm{opt}}
\mathcal{T}_{\textrm{opt}}\leftarrow\textsc{CreatePath}\left(\bm{\tau}_{%
\textrm{min}},\bm{\tau}_{\textrm{opt}},\bm{\gamma}\right)\cup\textsc{%
CreatePath}\left(\bm{\tau}_{\textrm{opt}},\bm{\tau}_{\textrm{max}},\bm{\gamma}\right)
\mathcal{T}_{\textrm{opt}}
\bm{\tau}^{\textrm{start}},\bm{\tau}^{\textrm{end}},\bm{\gamma}
\bm{\tau}^{(0)}\leftarrow\bm{\tau}_{\textrm{start}}
i\leftarrow 1
\bm{\tau}^{(i)}\neq\bm{\tau}^{\textrm{end}}
p_{\textrm{min}}\leftarrow\infty
j\in\{1,\ldots,n\}
\tilde{\tau}^{(i)}_{j}\leftarrow\tau^{(i)}_{j}+\gamma_{j}
\tilde{\tau}^{(i)}_{j}>\tau^{\textrm{end}}_{j}
\bm{\tau}^{\textrm{next}}\leftarrow\left(\tau^{(i)}_{1},\ldots,\tilde{\tau}^{(%
i)}_{j},\ldots,\tau^{(i)}_{n}\right)
p^{\textrm{opt}}(\bm{\tau}^{\textrm{next}},\bm{\alpha})<p_{\textrm{min}}
\bm{\tau}^{(i)}\leftarrow\bm{\tau}^{\textrm{next}}
p_{\textrm{min}}\leftarrow p^{\textrm{opt}}(\bm{\tau}^{\textrm{next}},\bm{%
\alpha})
i\leftarrow i+1
\left(\bm{\tau}^{(0)},\ldots,\bm{\tau}^{(i)}\right)
\mathcal{D}_{\textrm{testing}}
\mathcal{T}_{\textrm{opt}}
\bm{\alpha}
\delta
