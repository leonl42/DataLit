\Pi_{1}
\Pi_{2}
b_{1}
\pi_{1}
\Pi_{1}
\Pi_{2}
b_{1}
\pi_{1}
(\mathcal{S},\mathcal{A},P,\gamma)
\mathcal{S}
\mathcal{A}
P:\mathcal{S}\times\mathcal{A}\times\mathcal{S}\to\mathbb{R}
\gamma
\tau\in\mathcal{T}
(R_{\tau},\rho_{\tau})
R_{\tau}:\mathcal{S}\to\mathbb{R}
\rho_{\tau}:\mathcal{S}\to\mathbb{R}
\{(s_{i},a_{i})\}
s_{i}
q_{i}:=\sum_{j=i+1}^{\infty}\gamma^{j-i-1}R(s_{j})
K_{\tau}
(b_{\tau 1},b_{\tau 2},\ldots)
\mathcal{B}
b
\pi_{b}
a\in\mathcal{A}
\mathcal{A}^{+}:=\mathcal{A}\cup\{\textsc{stop}\}
\mathcal{A}^{+}
\pi_{b}
b
\mathcal{D}\leftarrow\emptyset
|\mathcal{D}|<D
\tau
\tau\sim\textrm{curriculum}(\cdot)
d=\{(s_{i},a_{i},(b_{i}=K_{\tau,i}),q_{i},\tau),\ldots\}\sim\Pi_{\tau}
\mathcal{D}\leftarrow\mathcal{D}\cup d
b\in\mathcal{B},\tau\in\mathcal{T}
d=\{(s_{i},a_{i},b^{\prime},q_{i},\tau^{\prime})\in\mathcal{D}:b^{\prime}=b,%
\tau^{\prime}=\tau\}
\theta_{b}\leftarrow\theta_{b}+\frac{\alpha}{D}\sum_{d}\big{(}\nabla\log\pi_{b%
}(a_{i}|s_{i})\big{)}\big{(}q_{i}-c_{\tau}(s_{i})\big{)}
\eta_{\tau}\leftarrow\eta_{\tau}+\frac{\beta}{D}\sum_{d}\big{(}\nabla c_{\tau}%
(s_{i})\big{)}\big{(}q_{i}-c_{\tau}(s_{i})\big{)}
\textsc{train-step}(\mathbf{\Pi},\textrm{curriculum})
\textsc{train-step}(\mathbf{\Pi},\textrm{curriculum})
(b_{1},b_{2},\dots)
\Pi_{\tau}
i
0
\pi_{b_{i}}
\pi_{b_{i+1}}
\Pi_{\tau}
\mathcal{S}\times\mathcal{B}
\displaystyle(s,b_{i})\to(s^{\prime},b_{i})
\displaystyle(s,b_{i})
\displaystyle\to(s^{\prime},b_{i})
\displaystyle\textrm{with pr.}{\textstyle\sum_{a\in\mathcal{A}}}\pi_{b_{i}}(a|%
s)\cdot P(s^{\prime}|s,a)
\displaystyle{\textstyle\sum_{a\in\mathcal{A}}}\pi_{b_{i}}(a|s)\cdot P(s^{%
\prime}|s,a)
\displaystyle\to(s,b_{i+1})
\displaystyle\to(s,b_{i+1})
\displaystyle\textrm{with pr.}\pi_{b_{i}}(\textsc{stop}|s)
\displaystyle\pi_{b_{i}}(\textsc{stop}|s)
\Pi_{\tau}
\mathcal{S}\times\mathcal{B}
\mathcal{S}
\mathbf{\Pi}:=\bigcup_{\tau}\{\Pi_{\tau}\}
\pi_{b}
\theta_{b}
\theta_{b}
J(\mathbf{\Pi}):=\sum_{\tau}J(\Pi_{\tau}):=\sum_{\tau}\mathbb{E}_{s_{i}\sim\Pi%
_{\tau}}\big{[}\sum_{i}\gamma^{i}R_{\tau}(s_{i})\big{]}
\tau\in\mathcal{T}
\mathbf{\Pi}=\textsc{init}()
\ell_{\textrm{max}}\leftarrow 1
r_{\textrm{min}}\leftarrow-\infty
\ell_{\textrm{max}}
\mathcal{T}^{\prime}=\{\tau\in\mathcal{T}:|K_{\tau}|\leq\ell_{\textrm{max}}\}
\textrm{curriculum}(\cdot)=\textrm{Unif}(\mathcal{T}^{\prime})
r_{\textrm{min}}<r_{\textrm{good}}
\textsc{train-step}(\mathbf{\Pi},\textrm{curriculum})
\displaystyle\textrm{curriculum}(\tau)\propto\mathbb{1}[\tau\in\mathcal{T}^{%
\prime}](1-\hat{\mathbb{E}}r_{\tau})\quad\forall\tau\in\mathcal{T}
r_{\textrm{min}}\leftarrow\min_{\tau\in\mathcal{T}^{\prime}}\hat{\mathbb{E}}r_%
{\tau}
\ell_{\textrm{max}}\leftarrow\ell_{\textrm{max}}+1
\pi
b
s_{i}
\mathcal{A}^{+}
a_{i}
\pi
b
s_{i}
\mathcal{A}^{+}
a_{i}
\pi
\theta
\nabla_{\theta}J(\pi)=\sum_{i}\big{(}\nabla_{\theta}\log\pi(a_{i}|s_{i})\big{)%
}\big{(}q_{i}-c(s_{i})\big{)},
c
q_{i}
s_{i}
\lambda=1
c
V_{\pi}(s_{i})=\mathbb{E}_{\pi}q_{i}
\pi
s_{i}
\pi_{b}
\Pi_{\tau}
R_{\tau}
\nabla_{\theta_{b}}J(\mathbf{\Pi})=\sum_{t:b\in K_{\tau}}\nabla_{\theta_{b}}J(%
\Pi_{\tau})
\pi_{b}
\displaystyle\nabla_{\theta}J(\mathbf{\Pi})=\sum_{\tau}\nabla_{\theta}J(\Pi_{%
\tau})
\displaystyle\nabla_{\theta}
\displaystyle J(\mathbf{\Pi})=\sum_{\tau}\nabla_{\theta}J(\Pi_{\tau})
\displaystyle=\sum_{\tau}\sum_{i}\big{(}\nabla_{\theta_{b}}\log\pi_{b}(a_{\tau
i%
}|s_{\tau i})\big{)}\big{(}q_{i}-c_{\tau}(s_{\tau i})\big{)},
\displaystyle=\sum_{\tau}\sum_{i}\big{(}\nabla_{\theta_{b}}\log\pi_{b}(a_{\tau
i%
}|s_{\tau i})\big{)}\big{(}q_{i}-c_{\tau}(s_{\tau i})\big{)},
(s_{\tau i},a_{\tau i})
\pi_{b}
\tau
c_{\tau}
\tau
c_{\tau}
\eta_{\tau}
\displaystyle\nabla_{\eta_{\tau}}\bigg{[}-\frac{1}{2}\sum_{i}(q_{i}-c_{\tau}(s%
_{i}))^{2}\bigg{]}
\displaystyle\nabla_{\eta_{\tau}}\bigg{[}-\frac{1}{2}\sum_{i}(
\displaystyle q_{i}-c_{\tau}(s_{i}))^{2}\bigg{]}
\displaystyle=\sum_{i}\big{(}\nabla_{\eta_{\tau}}c_{\tau}(s_{i})\big{)}\big{(}%
q_{i}-c_{\tau}(s_{i})\big{)}.
\displaystyle=\sum_{i}\big{(}\nabla_{\eta_{\tau}}c_{\tau}(s_{i})\big{)}\big{(}%
q_{i}-c_{\tau}(s_{i})\big{)}.
R_{\tau}(s_{i})+\gamma V_{\tau}(s_{i+1})-V_{\tau}(s_{i})
\mathbf{\Pi}
\mathcal{D}
\mathcal{D}
D
\alpha
\beta
0<q_{i}<1
\hat{\mathbb{E}}r_{\tau}
\tau
1-\hat{\mathbb{E}}r_{\tau}
\ell_{\textrm{max}}
\ell_{\textrm{max}}
\mathbf{\Pi}
\hat{\mathbb{E}}r_{\tau}
r_{\textrm{good}}
\ell_{\textrm{max}}
D
\gamma=0.9
r_{\textrm{good}}
\ell_{\textrm{max}}
\ell_{\textrm{max}}
\mathcal{B}
\mathcal{A}
