T
E
C
C
\mathcal{D}
\mathcal{D}^{tr}
\mathcal{D}^{val}
\mathcal{D}_{u}
\mathcal{D}^{tr}
\mathcal{D}_{u}
\mathcal{D}^{tr}
\mathcal{D}^{val}
\mathcal{D}^{val}
T
T
T
X\in D_{u}
N
\{P_{i}\}_{i=1}^{N}
T
X
\sigma(P_{i},X;T)
P_{i}
P_{i}
r
N\times r
\mathcal{M}(X;T,r)
X-\mathcal{M}(X;T,r)
E
D
\mathcal{M}(X;T,r)
E
D
\mathcal{L}_{rec}
j
\mathcal{M}_{j}(X;T,r)
\sigma(\mathcal{M}_{j}(X;T,r),X;T)
T
E
D
\small\begin{array}[]{l}E^{*}(T),D^{*}=\underset{E,D}{\text{argmin}}\sum%
\limits_{X\in\mathcal{D}_{u}}\sum\limits_{j=1}^{N\times r}\sigma(\mathcal{M}_{%
j}(X;T,r),X;T)\times\\
\qquad\qquad\quad\mathcal{L}_{rec}(X-\mathcal{M}(X;T,r),\mathcal{M}_{j}(X;T,r)%
;E,D).\end{array}
E^{*}(T)
E^{*}
T
E^{*}
T
E^{*}(T)
E^{*}(T)
C
\mathcal{L}_{cls}
\mathcal{D}^{tr}
C^{*}(E^{*}(T))=\underset{C}{\text{argmin}}\;\mathcal{L}_{cls}(\mathcal{D}^{tr%
};E^{*}(T),C).
\mathcal{D}^{val}
E^{*}(T)
C^{*}(E^{*}(T))
T
T
\underset{T}{\text{min}}\;\mathcal{L}_{cls}(\mathcal{D}^{val};E^{*}(T),C^{*}(E%
^{*}(T))).
\small\begin{array}[]{l}\underset{T}{\text{min}}\;\mathcal{L}_{cls}(\mathcal{D%
}^{val};E^{*}(T),C^{*}(E^{*}(T)))\\
\\
s.t.\;C^{*}(E^{*}(T))=\underset{C}{\text{argmin}}\;\mathcal{L}_{cls}(\mathcal{%
D}^{tr};E^{*}(T),C)\\
\quad\;\;E^{*}(T),D^{*}=\underset{E,D}{\text{argmin}}\sum\limits_{X\in\mathcal%
{D}_{u}}\sum\limits_{j=1}^{N\times r}\sigma(\mathcal{M}_{j}(X;T,r),X;T)\times%
\\
\quad\;\;\qquad\qquad\quad\;\mathcal{L}_{rec}(X-\mathcal{M}(X;T,r),\mathcal{M}%
_{j}(X;T,r);E,D)\end{array}
E^{*}(T)
T
E^{*}(T)
D^{*}
E
D
E^{*}(T)
C^{*}(E^{*}(T))
C
E^{*}(T)
C^{*}(E^{*}(T))
T
{}^{\text{*}}
{}^{\text{*}}
{}^{\text{*}}
{}^{\text{*}}
D^{tr}
D^{val}
D_{u}
D^{tr}
\beta
1e-4
4e-5
D
D
D
\scriptsize\begin{array}[]{l}\underset{T}{\text{min}}\;\mathcal{L}_{cls}(%
\mathcal{D}^{val};E^{*}(T),C^{*})\\
s.t.\;E^{*}(T),D^{*},C^{*}=\underset{E,D,C}{\text{argmin}}\;\mathcal{L}_{cls}(%
\mathcal{D}^{tr};E,C)\;+\;\gamma\sum\limits_{X\in\mathcal{D}_{u}}\sum\limits_{%
j=1}^{N\times r}\\
\;\;\;\;\;\;\sigma(\mathcal{M}_{j}(X;T,r),X;T)\mathcal{L}_{rec}(X-\mathcal{M}(%
X;T,r),\mathcal{M}_{j}(X;T,r);E,D),\end{array}
\gamma
E
\gamma
2\times 2
4\times 4
8\times 8
2\times 2
8\times 8
32\times 32
E
D
C
T
\mathcal{D}
\mathcal{D}^{tr}
\mathcal{D}
\mathcal{D}^{val}
\mathcal{D}
\mathcal{D}_{u}
\mathcal{D}
X
\mathcal{D}
\mathcal{M}(.)
\mathcal{L}_{rec}(.)
\mathcal{L}_{cls}(.)
\sigma(.)
\eta_{E}
\eta_{C}
\eta_{T}
r
\frac{\partial\cdot}{\partial\cdot}
\frac{d\cdot}{d\cdot}
\nabla^{2}f(X,Y)
f(X,Y)
Y
X
\frac{\partial^{2}f(X,Y)}{\partial X\partial Y}
E^{*}(T)
E^{*}(T)\approx E^{\prime}=E-\eta_{E}\cdot\nabla_{E}\sum\limits_{X\in\mathcal{%
D}_{u}}\sum\limits_{j=1}^{N\times r}\sigma(\mathcal{M}_{j}(X;T,r),X;T)\mathcal%
{L}_{rec}(X-\mathcal{M}(X;T,r),\mathcal{M}_{j}(X;T,r);E,D)
\eta_{E}
E^{\prime}
\mathcal{L}_{cls}(E^{\prime}(T),C,\mathcal{D}^{tr})
C^{*}(E^{*}(T))
C^{*}(E^{*}(T))\approx C^{\prime}=C-\eta_{C}\cdot\nabla_{C}\mathcal{L}_{cls}(%
\mathcal{D}^{tr};E^{\prime}(T),C)
E^{\prime}(T)
C^{\prime}(E^{\prime}(T))
\mathcal{L}_{cls}(E^{\prime}(T),C^{\prime}(E^{\prime}(T)),\mathcal{D}^{val})
T
T\leftarrow T-\eta_{T}\cdot\nabla_{T}\mathcal{L}_{cls}(\mathcal{D}^{val};E^{%
\prime}(T),C^{\prime}(E^{\prime}(T)))
\nabla_{T}\mathcal{L}_{cls}(\mathcal{D}^{val};E^{\prime}(T),C^{\prime}(E^{%
\prime}(T)))=\frac{\partial\mathcal{L}_{cls}^{val}}{\partial T}+\frac{\partial%
\mathcal{L}_{cls}^{val}}{\partial E^{\prime}}\frac{\partial E^{\prime}}{%
\partial T}+\frac{\partial\mathcal{L}_{cls}^{val}}{\partial C^{\prime}}\frac{%
\partial C^{\prime}}{\partial E^{\prime}}\frac{\partial E^{\prime}}{\partial T}
\frac{\partial E^{\prime}}{\partial T}=-\eta_{E}\cdot\nabla_{E,T}^{2}\sum%
\limits_{X\in\mathcal{D}_{u}}\sum\limits_{j=1}^{N\times r}\sigma(\mathcal{M}_{%
j}(X;T,r),X;T)\mathcal{L}_{rec}(X-\mathcal{M}(X;T,r),\mathcal{M}_{j}(X;T,r);E,D)
\frac{\partial C^{\prime}}{\partial E^{\prime}}=\eta_{C}\cdot\nabla_{C,E^{%
\prime}}^{2}\mathcal{L}_{cls}^{tr}
\mathcal{L}_{cls}^{val}=\mathcal{L}_{cls}(\mathcal{D}^{val};E^{\prime}(T),C^{%
\prime}(E^{\prime}(T)))
\mathcal{L}_{cls}^{tr}=\mathcal{L}_{cls}(\mathcal{D}^{tr};E^{\prime}(T),C)
f(x)
\nabla f(x)\approx\frac{f(x+\delta x)-f(x)}{\delta x}
\epsilon
\Delta T
\Delta T
\sigma(.)
\sigma(\cdot)
\sigma(.)
\mathcal{L}_{rec}
T
\sigma(.)
\mathcal{L}_{rec}
1e-4
0.05
16\times 16
\beta_{1},\beta_{2}=0.9,0.95
4e-5
0.05
\beta_{1},\beta_{2}=0.9,0.95
4e-5
\times
0.05
\beta_{1},\beta_{2}=0.9,0.95
1e-3
0.05
2\times 2
\beta_{1},\beta_{2}=0.9,0.95
1e-3
0.05
\beta_{1},\beta_{2}=0.9,0.95
1e-3
\times
0.05
\beta_{1},\beta_{2}=0.9,0.95
\times
224\times 224
16\times 16
14\times 14=196
224\times 224
\text{MLO-MAE}_{pre}
1e-4
5e-5
