(\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}})
(\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}}).
4
L=2
\mathcal{L}=\{m^{1}_{1},m^{1}_{3},m^{2}_{1},m^{2}_{2}\}
\Pi_{\text{PT}}^{1}
\Pi_{\text{PT}}^{2}
\Pi_{\text{NT}}^{1}
4
L=2
\mathcal{L}=\{m^{1}_{1},m^{1}_{3},m^{2}_{1},m^{2}_{2}\}
\Pi_{\text{PT}}^{1}
\Pi_{\text{PT}}^{2}
\Pi_{\text{NT}}^{1}
\pi=(m^{i})_{i=1}^{L}
m^{L}\circ...\circ m^{2}\circ m^{1}
t-1
i
\mathcal{L}^{i}
i
\mathcal{L}^{i}
m^{i}_{\text{new}}
f
l
l
\mathcal{L}\leftarrow(),\bm{\pi}^{*}\leftarrow()
t
\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}},\mathbf{X}^{\text{val}},\mathbf{%
Y}^{\text{val}}
\pi^{*}_{\text{SA}}\leftarrow(m^{1}_{\text{new}},...,m^{L}_{\text{new}})
f^{*}_{\text{SA}}\leftarrow\textsc{TrainAndEvaluate}(\pi^{*}_{\text{SA}},%
\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}},\mathbf{X}^{\text{val}},\mathbf{%
Y}^{\text{val}})
\pi^{*}_{\text{PT}},f^{*}_{\text{PT}}\leftarrow\textsc{FindBestPTPath}(%
\mathcal{L},\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}},\mathbf{X}^{\text{%
val}},\mathbf{Y}^{\text{val}})
\pi^{*}_{\text{NT}},f^{*}_{\text{NT}}\leftarrow\textsc{FindBestNTPath}(%
\mathcal{L},\bm{\pi^{*}},\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}},\mathbf%
{X}^{\text{val}},\mathbf{Y}^{\text{val}})
\pi^{*}\leftarrow\pi^{*}_{j}
j=\operatorname*{arg\,max}_{j^{\prime}\in\{\text{SA, PT, NT}\}}f^{*}_{j^{%
\prime}}
\mathcal{L,\pi^{*}}
(\bm{\pi^{*}},\pi^{*})
m^{1},m^{2},m^{3}
\mathbf{x}
\mathbf{h}^{1}
\mathbf{h}^{2}
m^{1},m^{2},m^{3}
\mathbf{x}
\mathbf{h}^{1}
\mathbf{h}^{2}
l
\mathcal{L}
(\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}})
(\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}})
\bm{\pi}\leftarrow(\,)
\mathbf{f}\leftarrow(\,)
\mathbf{m}\leftarrow(\,)
\ell\leftarrow 1
L
m^{\ell}\leftarrow\operatorname*{arg\,max}_{m\in\mathcal{L}^{\ell}}p\left(%
\mathbf{m}\oplus(m)\,|\,\mathbf{X}^{\text{tr}}\right)
\pi\leftarrow\mathbf{m}\oplus(m^{\ell})\oplus(m^{\ell+1}_{\text{new}},...,m^{L%
}_{\text{new}})
\oplus
f\leftarrow\textsc{TrainAndEvaluate}(\pi,\mathbf{X}^{\text{tr}},\mathbf{Y}^{%
\text{tr}},\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}})
(\bm{\pi},\pi)
(\bm{f},f)
(\bm{m},m^{\ell})
i\leftarrow\operatorname*{arg\,max}_{i^{\prime}}\mathbf{f}[i^{\prime}]
\bm{\pi}[i],\mathbf{f}[i]
\ell
\mathcal{L}^{i}
i\in\{1,...,\ell\}
\Pi_{\text{PT}}^{\ell}=\mathcal{L}^{1}\times...\times\mathcal{L}^{\ell}\times%
\{m_{\text{new}}^{\ell+1}\}\times...\times\{m_{\text{new}}^{L}\}.
\mathbf{x}
m^{1}\ldots m^{\ell},
\mathbf{h}^{1}\ldots\mathbf{h}^{\ell-1}
\mathbf{h}^{j+1}=m^{j+1}(\mathbf{h}_{j}).
\mathbf{h}^{\ell-1}
\mathbf{h}^{j}
\mathbf{h}^{j+1}=m^{j+1}(\mathbf{h}^{j}).
p(m^{1},...,m^{\ell},\mathbf{x},\mathbf{h}^{1}...,\mathbf{h}^{\ell-1})=p(%
\mathbf{x}|\mathbf{h}^{1},m^{1})\left(\prod_{i=1}^{\ell-2}p(\mathbf{h}^{i}|%
\mathbf{h}^{i+1},m^{i+1})\right)p(\mathbf{h}^{\ell-1}|m^{\ell})\prod_{i=1}^{%
\ell}p(m^{i}).
\mathbf{h}^{j+1}=m^{j+1}(\mathbf{h}^{j})
p(m^{i})
p(\mathbf{h}^{i-1}|m^{i})
p(m^{1},...,m^{\ell}\,|\,\mathbf{x})\propto p(m^{1},...,m^{\ell},\mathbf{x})=p%
(\mathbf{x}|m^{1})\left(\prod_{i=2}^{\ell-1}\frac{p(\mathbf{h}^{i-1}|m^{i})}{%
\sum_{m\in\mathcal{L}_{i}}p(\mathbf{h}^{i-1}|m)p(m)}\right)\prod_{i=1}^{\ell}p%
(m^{i}).
p(m^{i})
p(\mathbf{h}^{i-1}|m^{i})
m^{i}
\mathbf{h}^{i-1}_{1}\ldots\mathbf{h}^{i-1}_{N}\in\mathbb{R}^{v}
m^{i}
k\ll v
v+v^{2}
k+k^{2}
\ell\in\{1\ldots L\}
p(m_{1}\ldots m_{\ell}\,|\,\mathbf{X}^{\text{tr}})
\ell
m_{\ell}\in\mathcal{L}^{\ell}
\ell\in\{1\ldots L\}
L
L
L-\ell
\ell
\ell
\Pi_{\text{NT}}^{\ell}=\{m_{\text{new}}^{1}\}\times...\times\{m_{\text{new}}^{%
L-\ell}\}\times\mathcal{L}^{L-\ell+1}\times...\times\mathcal{L}^{L}
\ell
\ell
\pi\in\Pi_{\text{NT}}^{\ell}
p(m^{L-\ell+1},...,m^{L})
p(\mathbf{Y}^{\text{val}}|\mathbf{X}^{\text{val}},m^{L-\ell+1},...,m^{L})
p(m^{L-\ell+1},...,m^{L}|\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}})%
\propto p(\mathbf{Y}^{\text{val}}|\mathbf{X}^{\text{val}},m^{L-\ell+1},...,m^{%
L})p(m^{L-\ell+1},...,m^{L}).
p(m^{L-\ell+1},...,m^{L})\propto 1
m^{L-\ell+1},...,m^{L}
\pi^{*}
p(\mathbf{Y}^{\text{val}}|\mathbf{X}^{\text{val}},m^{L-\ell+1},...,m^{L})
\lambda=(m^{L-\ell+1},...,m^{L})
f(\lambda)=p(\mathbf{Y}^{\text{val}}|\mathbf{X}^{\text{val}},\lambda)
\kappa
f(\lambda)\sim GP(\mathbf{0},\kappa(\lambda,\lambda^{\prime}))
\lambda^{\prime}
\kappa
m^{L-\ell+1},...,m^{L}
m^{L-\ell+1}\circ...\circ m^{L}
\kappa(\lambda,\lambda^{\prime})=\sigma^{2}\exp\left\{-d(\lambda,\lambda^{%
\prime})^{2}/(2\gamma^{2})\right\}
d
\sigma
\gamma
d
\ell
L-\ell+1
\mathcal{L}
\bm{\pi^{*}}
(\mathbf{X}^{\text{tr}},\mathbf{Y}^{\text{tr}})
(\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}})
\bm{\pi}\leftarrow()
\mathbf{f}\leftarrow()
\ell_{\text{min}}
\ell_{\text{min}}
\bm{\pi^{*}}
\bm{\lambda}\leftarrow(\pi^{\prime}[L-\ell_{\text{min}}+1:L]\text{ for }\pi^{%
\prime}\in\bm{\pi^{*}})
\bm{\lambda^{\prime}}\leftarrow()
\pi^{\prime}
\mathit{iter}\leftarrow 1
\text{min}(c,\mathit{len}(\bm{\pi^{*}}))
\lambda\leftarrow\operatorname*{arg\,max}_{\lambda\in\bm{\lambda}}\text{UCB}(p%
_{\text{GP}}(f|\lambda,\bm{\lambda^{\prime}},\mathbf{f}))
\pi\leftarrow(m^{1}_{\text{new}},...,m^{L-\ell_{\text{min}}}_{\text{new}})\oplus\lambda
\oplus
f\leftarrow\textsc{TrainAndEvaluate}(\pi,\mathbf{X}^{\text{tr}},\mathbf{Y}^{%
\text{tr}},\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}})
(\bm{\pi},\pi)
(\bm{\lambda^{\prime}},\lambda)
(\bm{f},f)
i\leftarrow\operatorname*{arg\,max}_{i}\mathbf{f}[i]
\pi^{\prime}\leftarrow\text{the path
in }\bm{\pi^{*}}\text{ that has }\bm{\lambda^{\prime}}[i]=\pi^{\prime}[L-\ell_%
{\text{min}}+1:L]
\pi^{\prime}
\ell\leftarrow L-\ell_{\min}
2
\pi\leftarrow(m^{1}_{\text{new}},...,m^{\ell-1}_{\text{new}})\oplus\pi^{\prime%
}[\ell:L]
f\leftarrow\textsc{TrainAndEvaluate}(\pi,\mathbf{X}^{\text{tr}},\mathbf{Y}^{%
\text{tr}},\mathbf{X}^{\text{val}},\mathbf{Y}^{\text{val}})
(\bm{\pi},\pi)
(\bm{f},f)
i\leftarrow\operatorname*{arg\,max}_{i^{\prime}}\mathbf{f}[i^{\prime}]
\bm{\pi}[i],\mathbf{f}[i]
\bm{\pi}^{*}
\pi^{\prime}\in\bm{\pi}^{*}
\pi^{\prime}
\pi^{\prime}
\ell_{\text{min}}
\ell_{\text{min}}
c
c
\bm{\pi}
\bm{\lambda^{\prime}}
\mathbf{f}
p_{\text{GP}}
\pi^{\prime}
\pi^{\prime}
c+L-\ell_{\text{min}}-1
L
\mathit{Tr}^{-1}
\mathcal{F}
\mathcal{A}
6
60
8
6
\mathcal{O}(6^{8})
3
3
S^{-}
S^{\text{out}}
S^{\text{out*}}
S^{\text{out**}}
S^{\text{few}}
S^{\text{pl}}
S^{+}
S^{-}
S^{\text{out}}
S^{\text{out*}}
S^{\text{out**}}
S^{\text{few}}
S^{\text{pl}}
S^{+}
\mathcal{A}
S^{\text{few}}
\mathbf{88.12}
S^{\text{out}}
\mathbf{78.15}
S^{\text{out*}}
\mathbf{75.72}
S^{\text{out**}}
\mathbf{75.73}
S^{\text{pl}}
\mathbf{93.79}
S^{-}
\mathbf{81.92}
S^{+}
\mathbf{75.08}
\mathbf{81.13}
\mathcal{F}
\mathbf{0.}
\mathit{Tr}^{-1}
S^{\text{few}}
\mathbf{46.07}
S^{\text{out}}
\mathbf{15.41}
\mathbf{15.41}
S^{\text{out*}}
\mathbf{12.53}
\mathbf{12.53}
S^{\text{out**}}
\mathbf{12.04}
S^{\text{pl}}
\mathbf{00.20}
\mathbf{00.20}
S^{-}
\mathbf{34.29}
\mathbf{34.29}
S^{+}
\mathbf{0.}
\mathbf{17.22}
\mathcal{A}
S^{\text{in}}
\mathbf{92.82}
S^{\text{sp}}
\mathbf{92.99}
\mathbf{92.38}
\mathcal{F}
\mathbf{0.}
\mathit{Tr}^{-1}
S^{\text{in}}
\mathbf{22.28}
S^{\text{sp}}
\mathbf{30.27}
\mathbf{22.97}
+2.7
+9.02
S^{-}
S^{\text{out}}
S^{\text{out*}}
S^{\text{out**}}
Tr^{-1}
S^{-}
S^{\text{out**}}
+10.33
S^{\text{few}}
+34.65
Tr^{-1}(S^{\text{few}})
S^{\text{in}}
S^{\text{sp}}
S^{\text{in}}
S^{\text{sp}}
S^{\text{in}}
S^{\text{sp}}
S^{\text{in}}
S^{\text{sp}}
S^{sp}
5
\mathcal{O}(6^{3}=216)
+14.67
Tr^{-1}(S^{\text{in}})
+23.65
Tr^{-1}(S^{\text{sp}})
S^{\text{pl}}
\mathcal{A}(S^{\text{pl}})
S^{+}
\mathcal{A}(S^{\text{few}})
S^{\text{long}}
60
+7.37
+8.83
+12.25
S^{-}
S^{\text{out}}
S^{\text{pl}}
S^{+}
S^{\text{in}}
S^{-}
S^{\text{out}}
S^{\text{pl}}
S^{+}
S^{\text{in}}
\mathcal{A}
S^{\text{in}}
\mathbf{69.45}
68.18
68.34
S^{\text{out}}
\mathbf{66.78}
\mathbf{66.78}
\mathbf{66.78}
S^{\text{pl}}
\mathbf{64.67}
\mathbf{64.67}
S^{-}
\mathbf{67.24}
\mathbf{67.24}
\mathbf{67.24}
S^{+}
\mathbf{63.11}
\mathbf{66.00}
\mathcal{F}
\mathbf{0.}
\mathit{Tr}^{-1}
S^{\text{in}}
\mathbf{17.41}
S^{\text{out}}
\mathbf{17.46}
S^{\text{pl}}
\mathbf{0.}
\mathbf{0.}
\mathbf{0.}
\mathbf{0.}
\mathbf{0.}
S^{-}
\mathbf{20.74}
\mathbf{20.74}
\mathbf{20.74}
\mathbf{20.74}
S^{+}
0.
0.
0.
\mathbf{0.}
\mathbf{10.81}
S^{\text{long}}
S^{\text{long}}
S^{\text{pl}}
S^{\text{+}}
S^{-}
S^{\text{out}}
S^{\text{sp}}
5
\mathcal{O}(6^{5})
S^{-}
S^{\text{out}}
S^{\text{pl}}
S^{+}
S^{in}
S^{\text{long}}
100
\mathbf{69.65}
55.04
65.64
64.49
4
L+1
\mathcal{A}
S=(\Psi_{1},\Psi_{2},...,\Psi_{|S|})
\mathcal{A}(S)=\frac{1}{|S|}\sum_{t=1}^{|S|}\mathcal{A}^{|S|}(\Psi_{t})
\Psi_{t}
t
\mathcal{A}^{|S|}(\Psi_{t})
Tr^{-1}
\mathcal{A}_{\text{SA}}
Tr^{-1}(S)=\mathcal{A}^{|S|}(\Psi_{|S|})-\mathcal{A}_{\text{SA}}(\Psi_{|S|}).
\mathcal{F}(S)=\frac{1}{|S|}\sum_{t=1}^{|S|}\mathcal{A}^{|S|}(\Psi_{t})-%
\mathcal{A}^{t}(\Psi_{t})
\mathcal{O}(t^{l_{\text{min}}})
3
m^{1},m^{2},m^{3}
\mathbf{x}
\mathbf{h}^{1}
\mathbf{h}^{2}
m^{1},m^{2},m^{3}
\mathbf{x}
\mathbf{h}^{1}
\mathbf{h}^{2}
p(m^{1},...,m^{l}|\mathbf{x}_{1},...,\mathbf{x}_{N})
l=3
p(m^{1},m^{2},m^{3},\mathbf{x},\mathbf{h}^{1},\mathbf{h}^{2})=p(m^{1})p(m^{2})%
p(m^{3})p(\mathbf{x}|\mathbf{h}^{1},m^{1})p(\mathbf{h}^{1}|\mathbf{h}^{2},m^{2%
})p(\mathbf{h}^{2}|m^{3})
p(\mathbf{x}|\mathbf{h}^{1},m^{1})
\begin{split}p(\mathbf{x}|\mathbf{h}^{1},m^{1})=\frac{p(\mathbf{x},\mathbf{h}^%
{1},m^{1})}{p(\mathbf{h}^{1},m^{1})}=\frac{p(\mathbf{h}^{1}|\mathbf{x},m^{1})p%
(\mathbf{x}|m^{1})p(m^{1})}{p(\mathbf{h}^{1})p(m^{1})}=\frac{p(\mathbf{h}^{1}|%
\mathbf{x},m^{1})p(\mathbf{x}|m^{1})}{\sum_{m^{2^{\prime}}}p(\mathbf{h}^{1}|m^%
{2^{\prime}})p(m^{2^{\prime}})}.\end{split}
p(\mathbf{h}^{1}|\mathbf{h}^{2},m^{2})
p(\mathbf{h}^{1}|\mathbf{h}^{2},m^{2})=\frac{p(\mathbf{h}^{1},\mathbf{h}^{2},m%
^{2})}{p(\mathbf{h}^{2},m^{2})}=\frac{p(\mathbf{h}^{2}|\mathbf{h}^{1},m^{2})p(%
\mathbf{h}^{1}|m^{2})p(m^{2})}{p(\mathbf{h}^{2})p(m^{2})}=\frac{p(\mathbf{h}^{%
2}|\mathbf{h}^{1},m^{2})p(\mathbf{h}^{1}|m^{2})}{\sum_{m^{3^{\prime}}}p(%
\mathbf{h}^{2}|m^{3^{\prime}})p(m^{3^{\prime}})}.\\

p(m^{1},m^{2},m^{3},\mathbf{x}_{1},\mathbf{h}^{1},\mathbf{h}^{2})\\
=p(m^{1})p(m^{2})p(m^{3})\frac{p(\mathbf{h}^{1}|\mathbf{x},m^{1})p(\mathbf{x}|%
m^{1})}{\sum_{m^{2^{\prime}}}p(\mathbf{h}^{1}|m^{2^{\prime}})p(m^{2^{\prime}})%
}\frac{p(\mathbf{h}^{2}|\mathbf{h}^{1},m^{2})p(\mathbf{h}^{1}|m^{2})}{\sum_{m^%
{3^{\prime}}}p(\mathbf{h}^{2}|m^{3^{\prime}})p(m^{3^{\prime}})}p(\mathbf{h}^{2%
}|m^{3}).\\

p(\mathbf{h}^{1}|\mathbf{x},m^{1})
p(\mathbf{h}^{2}|\mathbf{h}^{1},m^{2})
\mathbf{h}^{i}=m^{i}(\mathbf{h}^{i-1})
\delta
p(\mathbf{h}^{i}|\mathbf{h}^{i-1},m^{i})=\delta(\mathbf{h}^{i}-m^{i}(\mathbf{h%
}^{i-1}))
\int_{-\infty}^{\infty}f(z)\delta(z-c)dz=f(c)
\begin{split}&p(m^{1},m^{2},m^{3}|\mathbf{x})\propto p(m^{1},m^{2},m^{3},%
\mathbf{x})\\
&=\int\int p(m^{1},m^{2},m^{3},\mathbf{x},\mathbf{h}^{1^{\prime}},\mathbf{h}^{%
2^{\prime}})d\mathbf{h}^{1^{\prime}}d\mathbf{h}^{2^{\prime}}\\
&=\int\int p(m^{1})p(m^{2})p(m^{3})\frac{p(\mathbf{h}^{1^{\prime}}|\mathbf{x},%
m^{1})p(\mathbf{x}|m^{1})}{\sum_{m^{2^{\prime}}}p(\mathbf{h}^{1^{\prime}}|m^{2%
^{\prime}})p(m^{2^{\prime}})}\frac{p(\mathbf{h}^{2^{\prime}}|\mathbf{h}^{1^{%
\prime}},m^{2})p(\mathbf{h}^{1^{\prime}}|m^{2})}{\sum_{m^{3^{\prime}}}p(%
\mathbf{h}^{2^{\prime}}|m^{3^{\prime}})p(m^{3^{\prime}})}p(\mathbf{h}^{2^{%
\prime}}|m^{3})d\mathbf{h}^{1^{\prime}}d\mathbf{h}^{2^{\prime}}\\
&=\int p(m^{1})p(m^{2})p(m^{3})\frac{p(\mathbf{x}|m^{1})}{\sum_{m^{2^{\prime}}%
}p(\mathbf{h}^{1}|m^{2^{\prime}})p(m^{2^{\prime}})}\frac{p(\mathbf{h}^{2^{%
\prime}}|\mathbf{h}^{1},m^{2})p(\mathbf{h}^{1}|m^{2})}{\sum_{m^{3^{\prime}}}p(%
\mathbf{h}^{2^{\prime}}|m^{3^{\prime}})p(m^{3^{\prime}})}p(\mathbf{h}^{2^{%
\prime}}|m^{3})d\mathbf{h}^{2^{\prime}}\\
&=p(m^{1})p(m^{2})p(m^{3})\frac{p(\mathbf{x}|m^{1})}{\sum_{m^{2^{\prime}}}p(%
\mathbf{h}^{1}|m^{2^{\prime}})p(m^{2^{\prime}})}\frac{p(\mathbf{h}^{1}|m^{2})}%
{\sum_{m^{3^{\prime}}}p(\mathbf{h}^{2}|m^{3^{\prime}})p(m^{3^{\prime}})}p(%
\mathbf{h}^{2}|m^{3})\end{split}
\mathbf{h}^{1}
\mathbf{h}^{2}
\mathbf{x}
m^{1}
m^{2}
p(m^{i})
m_{a}^{i}
m_{b}^{i}
\Psi_{a}
\mathcal{A}^{a}(\Psi_{a})
\Psi_{b}
\mathcal{A}^{b}(\Psi_{b})=\mathcal{A}^{a}(\Psi_{a})+\Delta
\Delta>0
m_{a}^{i}
m_{b}^{i}
m_{b}^{i}
p(m^{i}_{j})=\frac{\exp\{\mathcal{A}^{j}(\Psi_{j})/T\}}{\sum_{m^{i}_{j^{\prime%
}}\in\mathcal{L}^{i}}\exp\{\mathcal{A}^{j^{\prime}}(\Psi_{j^{\prime}})/T\}}.
T
\mathbf{x}
i-1
i
\mathbf{h}^{i-1}
m_{a}^{i}
\xi
m_{b}^{i}
p(\mathbf{h}^{i-1}|m_{a}^{i})=\xi p(\mathbf{h}^{i-1}|m_{b}^{i})
m_{b}^{i}
m_{a}^{i}
m_{b}^{i}
T
m_{a}^{i}
m_{b}^{i}
\begin{split}p(m^{1},...,m^{i}_{a}|\mathbf{x})&=p(m^{1},...,m^{i}_{b}|\mathbf{%
x})\\
p(m_{a}^{i})p(\mathbf{h}^{i-1}|m_{a}^{i})&=p(m_{b}^{i})p(\mathbf{h}^{i-1}|m_{b%
}^{i})\\
\frac{p(m_{a}^{i})}{p(m_{b}^{i})}&=\frac{p(\mathbf{h}^{i-1}|m_{b}^{i})}{p(%
\mathbf{h}^{i-1}|m_{a}^{i})}\\
\frac{\exp\{\mathcal{A}^{a}(\Psi_{a})/T\}}{\exp\{(\mathcal{A}^{a}(\Psi_{a})+%
\Delta)/T\}}&=\frac{p(\mathbf{h}^{i-1}|m_{b}^{i})}{p(\mathbf{h}^{i-1}|m_{a}^{i%
})}\\
\frac{\mathcal{A}^{a}(\Psi_{a})}{T}-\frac{\mathcal{A}^{a}(\Psi_{a})+\Delta}{T}%
&=\log p(\mathbf{h}^{i-1}|m_{b}^{i})-\log p(\mathbf{h}^{i-1}|m_{a}^{i})\\
T&=\frac{-\Delta}{\log p(\mathbf{h}^{i-1}|m_{b}^{i})-\log p(\mathbf{h}^{i-1}|m%
_{a}^{i})}\\
T&=\frac{\Delta}{\xi}.\end{split}
f:\Omega\rightarrow\mathbb{R}^{r}
g:\Omega\rightarrow\mathbb{R}^{r}
\langle f\;,\;g\rangle=\int_{\Omega}f(\mathbf{z})\cdot g(\mathbf{z})d\mathbf{z%
}\text{ .}
d(f,g):=||f-g||=\sqrt{\langle f-g\;,\;f-g\rangle}=\sqrt{\int_{\Omega}(f(%
\mathbf{z})-g(\mathbf{z}))\cdot(f(\mathbf{z})-g(\mathbf{z}))d\mathbf{z}}\text{%
 .}
1.11.0
100
16
377
T=0.001
T=0.6247744509446062
k=20
\beta=2
l_{min}=3
40
(L-2)
c=L+l_{min}
5
2L+t
t
(2L+t)\tau_{\text{SA}}
\tau_{\text{SA}}
\lambda=1000
15
40
S^{\text{pl}}
S^{-}
S^{\text{out}}
S^{\text{in}}
S^{+}
S^{\text{long}}
S^{\textit{sp}}
S^{\textit{few}}
S^{\textit{out*}}
S^{\textit{out**}}
\Psi_{t}=(D_{j},h_{j},g_{k})
D_{j}
h_{j}
g_{k}
g\circ h
h_{j}
g_{k}
j
k
j<t
k<t
j=t
k=t
j=t
k=t
\Psi_{t}
\Psi^{+}
\Psi^{-}
\Psi^{--}
10
S^{\textit{pl}}
[\Psi_{1}^{+},\Psi_{2}^{+},\Psi_{3}^{+},\Psi_{4}^{+},\Psi_{5}^{+},\Psi_{6}^{+}]
S^{-}
[\color[rgb]{0,0,1}\Psi_{1}^{+},\color[rgb]{0,0,0}\Psi_{2}^{-},\Psi_{3}^{-},%
\Psi_{4}^{-},\Psi_{5}^{-},\color[rgb]{0,0,1}\Psi_{1}^{-}\color[rgb]{0,0,0}]
S^{\textit{out}}
[\Psi_{1}^{+},\Psi_{2}^{-},\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^{-},\Psi_{6}^{-}%
=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[rgb]{0,0,1}h_{1}\color[rgb]%
{0,0,0},g_{6})]
S^{\textit{out*}}
[\Psi_{1}^{-},\Psi_{2}^{+}=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[%
rgb]{0,0,1}h_{1}\color[rgb]{0,0,0},g_{2}),\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^{%
-},\Psi_{6}^{-}=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[rgb]{0,0,1}h%
_{1}\color[rgb]{0,0,0},g_{6})]
S^{\textit{out**}}
[\Psi_{1}^{-},\Psi_{2}^{+}=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[%
rgb]{0,0,1}h_{1}\color[rgb]{0,0,0},g_{2}),\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^{%
-},\color[rgb]{0,0,1}\Psi_{1}^{-}\color[rgb]{0,0,0}]
S^{\textit{in}}
[\Psi_{1}^{+},\Psi_{2}^{-},\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^{-},\Psi_{6}^{-}%
=(D_{6},h_{6},\color[rgb]{0,0,1}g_{1}\color[rgb]{0,0,0})]
S^{\textit{sp}}
[\Psi_{1}^{+},\Psi_{2}^{-},\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^{-},\Psi_{6}^{-}%
=(D_{6},h_{6},\color[rgb]{0,0,1}g_{1}\color[rgb]{0,0,0})]
S^{\textit{few}}
[\color[rgb]{0,0,1}\Psi_{1}^{+}\color[rgb]{0,0,0},\color[rgb]{1,0,0}\Psi_{2}^{%
+}\color[rgb]{0,0,0},\Psi_{3}^{-},\Psi_{4}^{-}=(\color[rgb]{0,0,1}D_{1}\color[%
rgb]{0,0,0},\color[rgb]{0,0,1}h_{1}\color[rgb]{0,0,0},\color[rgb]{0,1,0}g_{4}%
\color[rgb]{0,0,0}),\Psi_{5}^{-},\Psi_{6}^{--}=(\color[rgb]{1,0,0}D_{2}\color[%
rgb]{0,0,0},\color[rgb]{1,0,0}h_{2}\color[rgb]{0,0,0},\color[rgb]{0,1,0}g_{4}%
\color[rgb]{0,0,0})]
S^{+}
[\color[rgb]{0,0,1}\Psi_{1}^{-},\color[rgb]{0,0,0}\Psi_{2}^{-},\Psi_{3}^{-},%
\Psi_{4}^{-},\Psi_{5}^{-},\color[rgb]{0,0,1}\Psi_{1}^{+}\color[rgb]{0,0,0}]
S^{\text{long}}
[\Psi_{i}]_{i=1}^{60}
6
S^{\textit{pl}}=[\Psi_{1}^{+},\Psi_{2}^{+},\Psi_{3}^{+},\Psi_{4}^{+},\Psi_{5}^%
{+},\Psi_{6}^{+}]
6
1.
2.
S^{-}=[\color[rgb]{0,0,1}\Psi_{1}^{+},\color[rgb]{0,0,0}\Psi_{2}^{-},\Psi_{3}^%
{-},\Psi_{4}^{-},\Psi_{5}^{-},\color[rgb]{0,0,1}\Psi_{1}^{-}\color[rgb]{0,0,0}]
3.
3.a
S^{\textit{out}}=[\Psi_{1}^{+},\Psi_{2}^{-},\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}%
^{-},\Psi_{6}^{-}=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[rgb]{0,0,1%
}h_{1}\color[rgb]{0,0,0},g_{6})]
h_{1}
S^{\textit{out*}}=[\Psi_{1}^{-},\Psi_{2}^{+}=(\color[rgb]{0,0,1}D_{1}\color[%
rgb]{0,0,0},\color[rgb]{0,0,1}h_{1}\color[rgb]{0,0,0},g_{2}),\Psi_{3}^{-},\Psi%
_{4}^{-},\Psi_{5}^{-},\Psi_{6}^{-}=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},%
\color[rgb]{0,0,1}h_{1}\color[rgb]{0,0,0},g_{6})]
h_{1}
\Psi_{1}
\Psi_{2}
\Psi_{6}
S^{\textit{out**}}=[\Psi_{1}^{-},\Psi_{2}^{+}=(\color[rgb]{0,0,1}D_{1}\color[%
rgb]{0,0,0},\color[rgb]{0,0,1}h_{1}\color[rgb]{0,0,0},g_{2}),\Psi_{3}^{-},\Psi%
_{4}^{-},\Psi_{5}^{-},\color[rgb]{0,0,1}\Psi_{1}^{-}\color[rgb]{0,0,0}]
\Psi_{1}
\Psi_{2}
S^{\textit{in}}=[\Psi_{1}^{+}
\Psi_{2}^{-},\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^{-},\Psi_{6}^{-}=(D_{6},h_{6},%
\color[rgb]{0,0,1}g_{1}\color[rgb]{0,0,0})]
S^{\textit{sp}}=[\Psi_{1}^{+},\Psi_{2}^{-},\Psi_{3}^{-},\Psi_{4}^{-},\Psi_{5}^%
{-},\Psi_{6}^{-}=(D_{6},h_{6},\color[rgb]{0,0,1}g_{1}\color[rgb]{0,0,0})]
S^{\textit{few}}=[\color[rgb]{0,0,1}\Psi_{1}^{+}\color[rgb]{0,0,0}=(\color[rgb%
]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[rgb]{0,0,1}h_{1}\color[rgb]{0,0,0}),%
\color[rgb]{1,0,0}\Psi_{2}^{+}\color[rgb]{0,0,0}=(\color[rgb]{1,0,0}D_{2}%
\color[rgb]{0,0,0},\color[rgb]{1,0,0}h_{2}\color[rgb]{0,0,0}),\Psi_{3}^{-},%
\Psi_{4}^{-}=(\color[rgb]{0,0,1}D_{1}\color[rgb]{0,0,0},\color[rgb]{0,0,1}h_{1%
}\color[rgb]{0,0,0},\color[rgb]{0,1,0}g_{4}\color[rgb]{0,0,0}),\Psi_{5}^{-},%
\Psi_{6}^{--}=(\color[rgb]{1,0,0}D_{2}\color[rgb]{0,0,0},\color[rgb]{1,0,0}h_{%
2}\color[rgb]{0,0,0},\color[rgb]{0,1,0}g_{4}\color[rgb]{0,0,0})]
h_{1}
g_{1}
\Psi_{4}
g_{4}
\Psi_{2}
\Psi_{4}
h_{2}
g_{4}
S^{+}=[\color[rgb]{0,0,1}\Psi_{1}^{-},\color[rgb]{0,0,0}\Psi_{2}^{-},\Psi_{3}^%
{-},\Psi_{4}^{-},\Psi_{5}^{-},\color[rgb]{0,0,1}\Psi_{1}^{+}\color[rgb]{0,0,0}]
S^{\text{long}}=[\Psi_{i}]_{i=1}^{60}
60
\Psi_{t}^{-}
50
\frac{1}{3}
\Psi_{t}^{+}
\frac{1}{10}
\Psi_{t}^{--}
9
\{(D_{i},h_{i})\}_{i=1}^{9}
16
\{g_{i}\}_{i=1}^{16}
144
9
\mathbb{R}^{28\times 28}\rightarrow\mathbb{R}^{8}
D_{i}
h_{i}
33
[0,1,2,4:12,15,17:21,24:28,30,34,35,37:41,46,47]
8
i
\text{EMNIST}_{2}
\text{MNIST}_{1}
9
\text{MNIST}_{1}
\text{FMNIST}_{1}
\{\text{EMNIST}_{i}\}_{i=1}^{3}
\{\text{KMNIST}_{i}\}_{i=1}^{4}
4800
g^{(2)}
g^{(2)}
\mathbb{R}^{16}\rightarrow\{0,1\}
g_{i}
8
2
g_{i}(\mathbf{x})=g_{k}^{(2)}(g_{j}^{(1)}(\mathbf{x}[:8]),g_{j}^{(1)}(\mathbf{%
x}[8:]))
g_{j}^{(1)}
1
8
g_{1}^{(1)}
1
2
g^{(1)}
4
g^{(1)}
g_{1}^{(1)}
g_{1}^{(2)}
g_{1}^{(3)}
g_{1}^{(4)}
1
8
g_{k}^{(2)}:\mathbb{R}^{2}\rightarrow\{0,1\}
4
g^{(2)}
4
8*8=64
4
g^{(1)}
4
g^{(2)}
16
g
\{g_{(k-1)*4+j}(\mathbf{x})=g_{k}^{(2)}(g_{j}^{(1)}(\mathbf{x}[:8]),g_{j}^{(1)%
}(\mathbf{x}[8:])),k\in\{1,2,3,4\},j\in\{1,2,3,4\}\}.
\Psi=(D_{\text{MNIST}_{1}},h_{\text{MNIST}_{1}},g=(g_{\text{XOR}}^{(2)},g^{(1)%
}_{1}))
h_{\text{MNIST}}
g^{(1)}_{1}
g_{\text{XOR}}^{(2)}
0
\Psi=(D_{\text{MNIST}_{1}},h_{\text{MNIST}_{1}},g=(g_{\text{XOR}}^{(2)},g^{(1)%
}_{1}))
h_{\text{MNIST}}
g^{(1)}_{1}
g_{\text{XOR}}^{(2)}
0
9
\{(D_{i},h_{i})\}_{i=1}^{9}
16
144
\{\Psi_{(k-1)*9+j}=(D_{k},h_{k},g_{j}),k\in\{1,...,9\},j\in\{1,...,16\}\}
\Psi_{i}=(D_{k},h_{k},g_{j})
D_{i}
h_{i}
g_{j}
\Psi=(D_{\text{MNIST}_{1}},h_{\text{MNIST}_{1}},g=(g_{\text{XOR}}^{(2)},g^{(1)%
}_{1}))
S^{\text{sp}}
\mathbb{R}^{28\times 28}
\mathbb{R}^{784}
l
l
l^{(1)}
l^{(2)}
S^{\text{long}}
l^{(1)}
(D_{i},h_{i})
l^{(2)}
\{g_{i}\}_{i=1}^{16}
S^{\text{long}}
\Psi_{i}^{+}
n_{\text{tr}}^{+}=(30000,\text{All}_{\text{tr}},\text{All})
30000
64
S^{-},S^{\text{out}},S^{\text{out*}},S^{\text{out**}},S^{\text{few}},S^{+}
\Psi^{-}
n_{\text{tr}}^{-}=(10000,100,\text{All})
100
S^{\text{in}}
S^{\text{sp}}
n_{\text{tr}}^{-}=(10000,\text{All}_{\text{tr}},30)
30
64
\Psi^{-}
S^{\text{long}}
(10000,100,\text{All})
(10000,\text{All}_{\text{tr}},30)
\Psi^{--}
n_{\text{tr}}^{--}=(10,20,10)
10
20
10
\Psi^{--}
n_{\text{val}}^{--}=(10,20,10)
n_{\text{val}}^{--}=(5000,\text{All}_{\text{val}},\text{All})
n_{\text{test}}^{--}=(5000,\text{All}_{\text{test}},\text{All})
\zeta_{\text{CNN}}:\mathbb{R}^{28\times 28}\rightarrow\mathbb{R}^{8}
\zeta_{\text{MLP}}:\mathbb{R}^{16}\rightarrow\mathbb{R}^{1}
2
64
sigmoid
\Psi_{k}=(D_{i},h_{i},g_{j})
(\mathbf{x}^{1},\mathbf{x}^{2})
\zeta_{\text{comp}}=\zeta_{\text{MLP}}(\textit{concatenate}(\zeta_{\text{CNN}}%
(\mathbf{x}^{2}),\zeta_{\text{CNN}}(\mathbf{x}^{2})))
2
\zeta_{\text{CNN}}
2
\zeta_{\text{MLP}}
8
6
\mathcal{O}(6^{8}=1679616)
6
S^{\text{sp}}
\zeta_{\text{CNN}}
\zeta_{\text{FC}}
64
ReLU
0.00016
0.97
32
1200
6000
k
k
k=\{10,20,40\}
rp\_10
rp\_20
rp\_40
10^{-8}
9
9
N
9
\{q_{i}\}_{i}^{9}
p_{j}
100
j
p_{j}
q_{j}
0
q_{j}
p_{j}
9
N
N
N
N
N
N
N
N=\{50,
100
500
1000
5000
10000
20000
30000
44000\}
5
N\geq 500
N=50
N=100
N
k
100
l_{min}
S^{\text{in}+}=[\Psi_{1}^{+},\Psi_{2}^{+},...,\Psi_{15}^{+},\Psi_{16}^{-}=(D_{%
6},h_{6},\color[rgb]{0,0,1}g_{1}\color[rgb]{0,0,0})]
16
g
n_{\text{tr}}^{-}=(10000,\text{All}_{\text{tr}},30)
30
64
5
S^{\text{in}+}
5
S^{\text{in}+}
10
10
10*5=50
s_{\text{BO}}^{\text{NT},l}
s_{\text{BO}}^{\text{NT},l}
2
2
\text{EI}(p_{\text{GP}}(f|\lambda,\bm{\lambda^{\prime}},\mathbf{f}))
S^{\text{in}+}
11.5
17
sim_{v}
k_{v}(\pi_{j}^{\text{NT},l},\pi_{k}^{\text{NT},l};Z)=\sigma_{0}^{2}+\sigma_{1}%
^{2}sim_{v}(\pi_{j}^{\text{NT},l},\pi_{k}^{\text{NT},l};Z)
\sigma_{0}
\sigma_{1}
Z
\begin{split}sim_{\text{cov}}(f_{1},f_{2};Z):=COV(\cup_{i}f(z_{i}),\cup_{i}g(z%
_{i}))\text{ .}\end{split}
PC
[-1,1]
\begin{split}sim_{\text{pc}}(f_{1},f_{2};Z):=PC(\cup_{i}f(z_{i}),\cup_{i}g(z_{%
i}))\text{ .}\end{split}
z_{i}
sim_{\text{gdp}}(f_{1},f_{2};Z):=\frac{1}{V}\sum_{i=1}^{V}\left(\frac{\nabla f%
_{1}(z_{i})}{\|\nabla f_{1}(z_{i})\|_{2}}\right)\cdot\left(\frac{\nabla f_{2}(%
z_{i})}{\|\nabla f_{2}(z_{i})\|_{2}}\right)\quad.
3
3
3
S^{-}
S^{+}
S^{\text{in}}
S^{\text{out}}
S^{\text{pl}}
S^{\text{long}}
S^{\text{in}}
S^{\text{out}}
S^{\text{long}}
100
1
1
5
64
4
1e-3
1e-3
64
100
\mathcal{A}
S^{\text{in}}
\pm
\pm
\pm
\pm
\pm
\mathbf{69.5}
\pm
\pm
\pm
S^{\text{out}}
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{66.8}
\pm
\mathbf{66.8}
\pm
S^{\text{pl}}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{64.7}
\pm
S^{-}
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{67.2}
\pm
\mathbf{67.2}
\pm
S^{+}
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{63.1}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{66.}
\pm
\mathcal{F}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{0.}
\pm
\mathit{Tr}^{-1}
S^{\text{in}}
\pm
\pm
\pm
\pm
\pm
\mathbf{17.4}
\pm
\pm
\pm
S^{\text{out}}
\pm
\pm
\pm
\pm
\mathbf{17.5}
\pm
\pm
\pm
\pm
S^{\text{pl}}
\pm
\pm
\pm
\mathbf{0.}
\pm
\mathbf{0.}
\pm
\pm
\mathbf{0.}
\pm
\mathbf{0.}
\pm
S^{-}
\pm
\pm
\pm
\pm
\mathbf{20.7}
\pm
\pm
\mathbf{20.7}
\pm
\mathbf{20.7}
\pm
S^{+}
0.
\pm
\pm
\pm
\pm
\pm
\pm
0.
\pm
\mathbf{0.}
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathbf{10.8}
\pm
S^{-}
S^{\text{out}}
S^{\text{pl}}
S^{+}
S^{\text{in}}
S^{-}
S^{\text{out}}
S^{\text{pl}}
S^{+}
S^{\text{in}}
7
6
\beta_{1}=0.9
\beta_{1}=0.999
\epsilon=10^{-8}
6
(\{10^{-2},10^{-3}\})
\{0,10^{-5},10^{-4}\}
300
\mathcal{A}
S^{\text{in}}
\mathbf{63.41}
63.10
S^{\text{out}}
\mathbf{78.15}
\mathbf{78.15}
S^{\text{pl}}
\mathbf{93.79}
\mathbf{93.79}
S^{-}
\mathbf{81.92}
\mathbf{81.92}
S^{+}
\mathbf{74.54}
\mathbf{78.29}
\mathit{Tr}^{-1}
S^{\text{in}}
\mathbf{32.57}
\mathbf{32.57}
S^{\text{out}}
\mathbf{15.41}
\mathbf{15.41}
\mathbf{15.41}
S^{\text{pl}}
\mathbf{00.20}
\mathbf{00.20}
\mathbf{00.20}
S^{-}
\mathbf{34.29}
\mathbf{34.29}
\mathbf{34.29}
S^{+}
\mathbf{16.49}
