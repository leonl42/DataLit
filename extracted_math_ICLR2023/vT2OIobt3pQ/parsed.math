M
\{\mathcal{D}_{i}\}_{i=1}^{M}
i
f_{i}
\theta_{i}
\mathbb{R}^{D}
\mathbb{R}^{K}
h_{i}
w_{i}
\mathbb{R}^{C}
\mathcal{P}
\min_{\{\{\theta_{i},w_{i}\}\}^{M}_{i=1}}\frac{1}{M}\sum^{M}_{i=1}\mathcal{L}_%
{i}(\mathcal{D}_{i},\theta_{i},w_{i},\mathcal{P}).
i
c
P^{c}_{i}=\mathbb{E}_{({\bm{x}},c)\sim\mathcal{D}_{i,c}}\ f_{i}({\bm{x}};%
\theta_{i}),
\mathcal{D}_{i,c}
\mathcal{D}_{i}
c
\bar{P}^{c}=\frac{1}{|\mathcal{N}_{c}|}\sum_{i\in\mathcal{N}_{c}}\frac{|%
\mathcal{D}_{i,c}|}{N_{c}}P^{c}_{i},
\mathcal{N}_{c}
N_{c}
c
c
\mathcal{P}=\{\bar{P}^{c}\}^{C}_{c=1}
\mathcal{L}_{i}:=\mathbb{E}_{({\bm{x}},y)\sim\mathcal{D}_{i}}\ell(h_{i}(f_{i}(%
{\bm{x}};\theta_{i});w_{i}),y)+\lambda\mathbb{E}_{c\sim\mathcal{C}_{i}}\phi(P^%
{c}_{i},\bar{P}^{c}),
\ell
\lambda
\phi
\mathcal{C}_{i}
i
\mathcal{C}
\{\acute{P}^{c}\}^{C}_{c=1}
\theta_{F}
\{\acute{P}^{c}\}^{C}_{c=1}
\theta_{F}
\hat{\mathcal{P}}=\{\hat{P}^{c}\}^{C}_{c=1}
\acute{P}^{c}\in\mathbb{R}^{K}
c
F
\theta_{F}
\acute{P}^{c}
F
\forall c\in[C],\hat{P}^{c}=F(\acute{P}^{c};\theta_{F})
\hat{P}^{c}\in\mathbb{R}^{K}
F
\hat{P}^{c}
\{\acute{P}^{c},\theta_{F}\}
\theta_{F}
c
c
\hat{\mathcal{P}}
\min_{\hat{\mathcal{P}}}\ \sum^{C}_{c=1}\mathcal{L}^{c}_{P},
\mathcal{L}^{c}_{P}=\sum_{i\in\mathcal{I}^{t}}-\log\frac{e^{-\phi(P^{c}_{i},%
\hat{P}^{c})}}{e^{-\phi(P^{c}_{i},\hat{P}^{c})}+\sum_{c^{\prime}}e^{-\phi(P^{c%
}_{i},\hat{P}^{c^{\prime}})}},
c^{\prime}\in[C],c^{\prime}\neq c
\mathcal{I}^{t}
t
\rho
C
\hat{\mathcal{P}}
\delta
\mathcal{L}^{c}_{P}
\mathcal{L}^{c}_{P}=\sum_{i\in\mathcal{I}^{t}}-\log\frac{e^{-(\phi(P^{c}_{i},%
\hat{P}^{c})+\delta)}}{e^{-(\phi(P^{c}_{i},\hat{P}^{c})+\delta)}+\sum_{c^{%
\prime}}e^{-\phi(P^{c}_{i},\hat{P}^{c^{\prime}})}},
\delta>0
\mathcal{L}^{c}_{P}
\tilde{\mathcal{L}}^{c}_{P}
\mathcal{L}^{c}_{P}\propto\tilde{\mathcal{L}}^{c}_{P}:=\sum_{i\in\mathcal{I}^{%
t}}\sum_{c^{\prime}}e^{\phi(P^{c}_{i},\hat{P}^{c})-\phi(P^{c}_{i},\hat{P}^{c^{%
\prime}})+\delta},
P^{c}_{i}
\hat{P}^{c}
P^{c}_{i}
\hat{P}^{c^{\prime}}
\delta
M
\hat{\mathcal{P}}
\eta
T
t=1,\ldots,T
\mathcal{I}^{t}
\hat{\mathcal{P}}
\mathcal{I}^{t}
i\in\mathcal{I}^{t}
i
i
\mathcal{P}_{i}
i
\mathcal{P}_{i}
\delta(t)
\hat{\mathcal{P}}
\delta
\delta(t)
\tau
\delta(t)=\min(\max_{c\in[C],c^{\prime}\in[C],c\neq c^{\prime}}\phi(Q^{c}_{t},%
Q^{c^{\prime}}_{t}),\tau),
Q^{c}_{t}=\frac{1}{|\mathcal{P}^{c}_{t}|}\sum_{i\in\mathcal{I}^{t}}P^{c}_{i},%
\forall c\in[C]
\bar{P}^{c}
\mathcal{P}^{c}_{t}=\{P^{c}_{i}\}_{i\in\mathcal{I}^{t}}
\tau
\mathcal{L}^{c}_{P}=\sum_{i\in\mathcal{I}^{t}}-\log\frac{e^{-(\phi(P^{c}_{i},%
\hat{P}^{c})+\delta(t))}}{e^{-(\phi(P^{c}_{i},\hat{P}^{c})+\delta(t))}+\sum_{c%
^{\prime}}e^{-\phi(P^{c}_{i},\hat{P}^{c^{\prime}})}}.
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\mathcal{L}_{i}
i
\mathcal{L}_{i}:=\mathbb{E}_{({\bm{x}},y)\sim\mathcal{D}_{i}}\ell(h_{i}(f_{i}(%
{\bm{x}};\theta_{i});w_{i}),y)+\lambda\mathbb{E}_{c\sim\mathcal{C}_{i}}\phi(P^%
{c}_{i},\hat{P}^{c}),
\hat{P}^{c}
\bar{P}^{c}
\phi
C
|\mathcal{D}_{i,c}|
\rho=0.5
\rho=0.5
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
X
(i\mod X)
i
K
K=512
q_{c,i}\sim Dir(\beta)
c
i
q_{c,i}
c
i
Dir(\beta)
\beta
\rho=1
\eta=0.01
\lambda=0.1
\tau=100
S=100
\sim
\rho=0.5
E
E
E=5
E=10
E=20
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K
K
K=64
K=256
K=1024
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
K
K=64
K=256
K=1024
K=64
K=256
\Theta
\theta_{g}
w_{g}
r
|\theta_{g}|\gg K\times C
C_{i}
i
\Theta
\theta_{g}
w_{g}
r
|\theta_{g}|\gg K\times C
C_{i}
i
\sum^{M}_{i=1}|w_{i}|\times 2
\sum^{M}_{i=1}(|w_{i}|\times 2+|\Theta|)
M\times(|\theta_{g}|+|w_{g}|)\times 2
M\times(|\theta_{g}|+|w_{g}|)\times 2\times r
\sum^{M}_{i=1}C\times(C_{i}+C)
\sum^{M}_{i=1}K\times(C_{i}+C)
\sum^{M}_{i=1}K\times(C_{i}+C)
5.12\times
5.12\times
F
F
\{\acute{P}^{c}\}^{C}_{c=1}
F
F
\tau
S
\tau=100
S=100
\tau
S
\tau=100
S=100
\tau
S
1
10
100
1000
1
10
100
1000
\tau
S
\tau
1
100
\tau=1000
\tau
\delta(t)
\tau
S
S=100
S=1000
S=100
\tau=1
S=1
S=1
K
\alpha=0.5
\beta=0.5
T_{start}=0.95
T_{end}=0.95
\gamma=1
\lambda=0.1
\lambda=0.1
\tau=100
S=100
5\times 5,32
5\times 5
32
2\times 2
2\times 2
5\times 5,32
5\times 5
32
2\times 2
2\times 2
5\times 5,32
2\times 2
5\times 5,32
2\times 2
5\times 5,64
2\times 2
5\times 5,32
2\times 2
5\times 5,32
2\times 2
5\times 5,64
2\times 2
5\times 5,32
2\times 2
5\times 5,32
2\times 2
5\times 5,64
2\times 2
5\times 5,32
2\times 2
5\times 5,32
2\times 2
5\times 5,64
2\times 2
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\beta=0.1
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\pm
\sim
\beta=0.1
\beta=0.1
\beta=0.1
\beta=0.1
\beta=0.1
\beta=0.1
