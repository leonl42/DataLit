{\mathcal{G}}_{0}
{\mathcal{G}}_{1}
{\mathcal{G}}_{0}
{\mathcal{G}}_{1}
{\mathcal{D}}=\{
\}
3
{\mathcal{D}}=\{
\}
3
{\mathcal{D}}
{\mathcal{D}}
K
{\mathcal{D}}
K
{\mathcal{D}}
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})
{\mathcal{V}}
{\mathcal{E}}
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})\in{\mathcal{D}}
{\mathcal{G}}_{M}({\mathcal{V}}_{M},{\mathcal{E}}_{M})
{\mathcal{G}}_{M}({\mathcal{V}}_{M},{\mathcal{E}}_{M})
{\mathcal{F}}\in{\mathcal{V}}_{M}
{\mathcal{E}}_{M}
{\mathcal{G}}
{\mathcal{G}}_{M}^{(0)}({\mathcal{V}}_{M}^{(0)},{\mathcal{E}}_{M}^{(0)})={%
\mathcal{G}}({\mathcal{V}},{\mathcal{E}})
\oplus
{\mathcal{F}}_{ij}={\mathcal{F}}_{i}\oplus{\mathcal{F}}_{j}
{\mathcal{F}}_{i}
{\mathcal{F}}_{j}
{\mathcal{F}}_{ij}
{\mathcal{F}}_{i}
{\mathcal{F}}_{j}
{\mathcal{G}}_{M}^{(k)}({\mathcal{V}}_{M}^{(k)},{\mathcal{E}}_{M}^{(k)})
k^{\rm th}
k=0,\cdots,K-1
({\mathcal{F}}_{i},{\mathcal{F}}_{j})
{\mathcal{F}}_{ij}={\mathcal{F}}_{i}\oplus{\mathcal{F}}_{j}
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}_{M}^{(k)}
{\mathcal{G}}_{M}^{(k)}
{\mathcal{F}}_{ij}={\mathcal{F}}_{i}\oplus{\mathcal{F}}_{j}
{\mathcal{F}}_{ij}
{\mathcal{M}}^{(k)}
({\mathcal{F}}_{i},{\mathcal{F}}_{j})
{\mathcal{F}}_{ij}
(\text{CCC},\text{C})
(\text{CC},\text{CC})
k
{\mathcal{F}}_{i}\oplus{\mathcal{F}}_{j}=={\mathcal{M}}^{(k)}
{\mathcal{F}}_{i}
{\mathcal{F}}_{j}
{\mathcal{G}}_{M}^{(k+1)}({\mathcal{V}}_{M}^{(k+1)},{\mathcal{E}}_{M}^{(k+1)})
K
\{{\mathcal{M}}^{(k)}\}_{k=0}^{K-1}
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})\in{\mathcal{D}}
{\mathcal{G}}_{M}({\mathcal{V}}_{M},{\mathcal{E}}_{M})={\mathcal{G}}_{M}^{(K)}%
({\mathcal{V}}_{M}^{(K)},{\mathcal{E}}_{M}^{(K)})
*
*
{\mathcal{F}}
{\mathcal{F}}^{*}
\mbox{Vocab}=\cup_{{\mathcal{G}}_{M}({\mathcal{V}}_{M},{\mathcal{E}}_{M})\in{%
\mathcal{D}}}\{{\mathcal{F}}^{*}:{\mathcal{F}}\in{\mathcal{V}}_{M}\}
*
O(K|{\mathcal{D}}|e)
K
|{\mathcal{D}}|
e=\max_{{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})\in{\mathcal{D}}}|{\mathcal{%
E}}|
k
10
90
3,000
\sim 133K
\sim 219K
6
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})
O(K|{\mathcal{E}}|)
{\bm{h}}_{{\mathcal{F}}^{*}}
{\bm{h}}_{v}
{}_{\text{motif}}
t^{\rm th}
{\bm{h}}_{{\mathcal{G}}_{t}}
{\bm{h}}_{v}
{}_{\text{pmol}}
v_{t}
[{\bm{z}},{\bm{h}}_{{\mathcal{G}}_{t}},{\bm{h}}_{v_{t}}]
{\bm{h}}_{{\mathcal{F}}^{*}}
{\bm{h}}_{v}
{}_{\text{motif}}
t^{\rm th}
{\bm{h}}_{{\mathcal{G}}_{t}}
{\bm{h}}_{v}
{}_{\text{pmol}}
v_{t}
[{\bm{z}},{\bm{h}}_{{\mathcal{G}}_{t}},{\bm{h}}_{v_{t}}]
{\mathcal{G}}_{t}
t
{\mathcal{G}}_{t}
v
{\bm{h}}_{v}
{\mathcal{G}}
{\bm{h}}_{{\mathcal{G}}}
{\mathcal{C}}_{{\mathcal{G}}}
{\mathcal{G}}
{\mathcal{C}}_{\text{Vocab}}=\cup_{{\mathcal{F}}^{*}\in\text{Vocab}}{\mathcal{%
C}}_{{\mathcal{F}}^{*}}
t^{\rm th}
{\mathcal{G}}_{t}
v_{t}
{\mathcal{G}}_{t}
{\mathcal{Q}}
{\mathcal{C}}_{{\mathcal{G}}_{t}}
t^{\rm th}
{\mathcal{Q}}
v_{t}
{\mathcal{Q}}
{\mathcal{F}}^{*}
{\mathcal{G}}_{t}
{\mathcal{F}}^{*}
\mathcal{Q}
{\mathcal{Q}}
v_{t}
{}_{\text{pmol}}
{\mathcal{G}}_{t}
{\bm{h}}_{v_{t}}
v_{t}
{\bm{h}}_{{\mathcal{G}}_{t}}
{\mathcal{G}}_{t}
{\mathcal{F}}^{*}\in\text{Vocab}
{}_{\text{motif}}
{\bm{h}}_{v}
v\in{\mathcal{C}}_{\text{Vocab}}
{\mathcal{C}}_{\text{Vocab}}
{\mathcal{C}}_{{\mathcal{G}}_{t}}\setminus\{v_{t}\}
{}_{\text{query}}
{}_{\text{key}}
P_{v}
P_{v}=\underset{{v\in{\mathcal{C}}_{\text{Vocab}}\cup{\mathcal{C}}_{{\mathcal{%
G}}_{t}}\setminus\{v_{t}\}}}{\mbox{softmax}}\left(\mbox{NN}_{\text{query}}%
\left(\left[{\bm{z}},{\bm{h}}_{{\mathcal{G}}_{t}},{\bm{h}}_{v_{t}}\right]%
\right)\cdot\mbox{NN}_{\text{key}}({\bm{h}}_{v})\right),
{\bm{z}}
{\bm{z}}
{\bm{z}}
{\bm{z}}
v
v_{t}
\arg\max P_{v}
P_{v}
v
v\in{\mathcal{C}}_{\text{Vocab}}
v\in{\mathcal{C}}_{{\mathcal{G}}_{t}}
v\in{\mathcal{C}}_{\text{Vocab}}
v\in{\mathcal{C}}_{{\mathcal{F}}^{*}}
{\mathcal{F}}^{*}
{\mathcal{G}}_{t}
v_{t}
v
v\in{\mathcal{C}}_{{\mathcal{G}}_{t}}
v_{t}
v
\mathcal{Q}
0^{\rm th}
{}_{\text{start}}
{\mathcal{G}}_{0}
P_{{\mathcal{F}}^{*}}
P_{{\mathcal{F}}^{*}}=\underset{{\mathcal{F}}^{*}\in\mbox{Vocab}}{\mbox{%
softmax}}\left(\mbox{NN}_{\text{start}}({\bm{z}})\cdot\mbox{NN}_{\text{key}}({%
\bm{h}}_{{\mathcal{F}}^{*}})\right),\quad{\bm{h}}_{{\mathcal{F}}^{*}}=\mbox{%
GNN}_{\text{motif}}({\mathcal{F}}^{*}).
{\mathcal{G}}
{\bm{h}}_{{\mathcal{G}}}
{\bm{z}}
{\bm{h}}_{{\mathcal{G}}}
{\bm{z}}
{\mathcal{G}}
{\mathcal{G}}
\hat{\mathcal{G}}
{\bm{z}}
{}_{\text{mol}}
{\mathcal{G}}
{\bm{h}}_{{\mathcal{G}}}={\rm GNN}_{\rm mol}({\mathcal{G}})
{\bm{z}}
q(\cdot|{\mathcal{G}})={\mathcal{N}}\left(\bm{\mu}({\bm{h}}_{\mathcal{G}}),%
\exp(\bm{\Sigma}({\bm{h}}_{\mathcal{G}}))\right)
{\bm{\mu}}
{\bm{\Sigma}}
{\bm{z}}
{}_{\text{pmol}}
{}_{\text{motif}}
{}_{\text{query}}
{}_{\text{key}}
{}_{\text{start}}
\mathbb{E}_{{\mathcal{G}}\sim{\mathcal{D}}}\left[\mathcal{L}({\mathcal{G}})%
\right]=\mathbb{E}_{{\mathcal{G}}\sim{\mathcal{D}}}\left[\mathcal{L}_{rec}({%
\mathcal{G}})+\beta_{prior}\cdot\mathcal{L}_{prior}({\mathcal{G}})+\beta_{prop%
}\cdot\mathcal{L}_{prop}({\mathcal{G}})\right].
\mathcal{L}_{rec}({\mathcal{G}})
{\mathcal{G}}
\mathcal{L}_{prior}({\mathcal{G}})=D_{\mathrm{KL}}(q(\cdot|{\mathcal{G}})\|%
\mathcal{N}(\mathbf{0},{\bm{I}}))
\mathcal{L}_{prop}({\mathcal{G}})
{\bm{z}}
\beta_{prior}
\beta_{prop}
t\geq 1
{\mathcal{Q}}
\mathcal{L}_{rec}({\mathcal{G}})
\mathcal{L}_{rec}({\mathcal{G}})
\mathcal{L}_{rec}({\mathcal{G}})
{}_{\text{motif}}
{}_{\text{motif}}
{}_{\text{motif}}
100\%
1000
500
500
\text{C}_{11}\text{H}_{24}
\text{C}_{11}\text{H}_{24}
N
N
{}_{\text{motif}}
{}_{\text{motif}}
C_{11}H_{24}
7
80,000
10,000
1.0
{\mathcal{D}}=\{{\mathcal{G}}_{1},{\mathcal{G}}_{2},\cdots,{\mathcal{G}}_{|{%
\mathcal{D}}|}\}
K
\{{\mathcal{M}}^{(k)}\}_{k=0}^{k-1}
\mbox{Vocab}=\{{\mathcal{F}}^{*}\}
{\mathcal{D}}_{M}^{(0)}\leftarrow\{\}
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})\in{\mathcal{D}}
{\mathcal{G}}_{M}^{(0)}({\mathcal{V}}_{M}^{(0)},{\mathcal{E}}_{M}^{(0)})%
\leftarrow{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})
{\mathcal{D}}_{M}^{(0)}\leftarrow{\mathcal{D}}_{M}^{(0)}\cup\{{\mathcal{G}}_{M%
}^{(0)}\}
k=0
K-1
\mbox{Count}()
{\mathcal{G}}_{M}^{(k)}({\mathcal{V}}_{M}^{(k)},{\mathcal{E}}_{M}^{(k)})\in{%
\mathcal{D}}_{M}^{(k)}
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}_{M}^{(k)}
{\mathcal{M}}\leftarrow{\mathcal{F}}_{i}\oplus{\mathcal{F}}_{j}
\mbox{Count}({\mathcal{M}})\leftarrow\mbox{Count}({\mathcal{M}})+1
{\mathcal{M}}^{(k)}\leftarrow\arg\max\mbox{Count}({\mathcal{M}})
{\mathcal{D}}_{M}^{(k+1)}\leftarrow\{\}
{\mathcal{G}}_{M}^{(k)}({\mathcal{V}}_{M}^{(k)},{\mathcal{E}}_{M}^{(k)})\in{%
\mathcal{D}}_{M}^{(k)}
{\mathcal{G}}_{M}^{(k+1)}({\mathcal{V}}_{M}^{(k+1)},{\mathcal{E}}_{M}^{(k+1)})%
\leftarrow{\mathcal{G}}_{M}^{(k)}({\mathcal{V}}_{M}^{(k)},{\mathcal{E}}_{M}^{(%
k)})
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}_{M}^{(k)}
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}^{(k+1)}_{M}\,\&\&\,{%
\mathcal{F}}_{i}\oplus{\mathcal{F}}_{j}=={\mathcal{M}}^{(k)}
{\mathcal{F}}_{i}
{\mathcal{F}}_{j}
{\mathcal{G}}_{M}^{(k+1)}
{\mathcal{D}}_{M}^{(k+1)}\leftarrow{\mathcal{D}}_{M}^{(k+1)}\cup\{{\mathcal{G}%
}_{M}^{(k+1)}\}
\mbox{Vocab}\leftarrow\{\}
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})\in{\mathcal{D}}
{\mathcal{G}}_{M}^{(0)}({\mathcal{V}}_{M}^{(0)},{\mathcal{E}}_{M}^{(0)})%
\leftarrow{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})
k=0
K-1
{\mathcal{G}}_{M}^{(k+1)}({\mathcal{V}}_{M}^{(k+1)},{\mathcal{E}}_{M}^{(k+1)})%
\leftarrow{\mathcal{G}}_{M}^{(k)}({\mathcal{V}}_{M}^{(k)},{\mathcal{E}}_{M}^{(%
k)})
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}^{(k)}_{M}
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}^{(k+1)}_{M}\,\&\&\,{%
\mathcal{F}}_{i}\oplus F_{j}=={\mathcal{M}}^{(k)}
{\mathcal{F}}_{i}
{\mathcal{F}}_{j}
{\mathcal{G}}^{(k+1)}_{M}
\mbox{Vocab}\leftarrow\mbox{Vocab}\cup\{{\mathcal{F}}^{*}\mbox{ for }{\mathcal%
{F}}\in{\mathcal{V}}^{(K)}_{M}\}
{\mathcal{G}}_{M}({\mathcal{V}}_{M},{\mathcal{E}}_{M})
{\mathcal{F}}\in{\mathcal{V}}_{M}
{\mathcal{F}}(\hat{{\mathcal{V}}},\hat{{\mathcal{E}}})
{\mathcal{G}}({\mathcal{V}},{\mathcal{E}})
\hat{{\mathcal{V}}}\subset{\mathcal{V}}
\hat{{\mathcal{E}}}\subset{\mathcal{E}}
{\mathcal{F}}
{\mathcal{E}}_{M}
F_{i}({\mathcal{V}}_{i},{\mathcal{E}}_{i}),F_{j}({\mathcal{V}}_{j},{\mathcal{E%
}}_{j})\in{\mathcal{V}}_{M}
({\mathcal{F}}_{i},{\mathcal{F}}_{j})\in{\mathcal{E}}_{M}\iff\exists a\in{%
\mathcal{V}}_{i},b\in{\mathcal{V}}_{j},(a,b)\in{\mathcal{E}}
\oplus
{\mathcal{F}}_{ij}({\mathcal{V}}_{ij},{\mathcal{E}}_{ij})={\mathcal{F}}_{i}%
\oplus{\mathcal{F}}_{j}
{\mathcal{F}}_{i}({\mathcal{V}}_{i},{\mathcal{E}}_{i})
{\mathcal{F}}_{j}({\mathcal{V}}_{j},{\mathcal{E}}_{j})
{\mathcal{V}}_{ij}={\mathcal{V}}_{i}\cup{\mathcal{V}}_{j},\quad{\mathcal{E}}_{%
ij}={\mathcal{E}}_{i}\cup{\mathcal{E}}_{j}\cup\{(a,b)\in{\mathcal{E}}|a\in{%
\mathcal{V}}_{i},b\in{\mathcal{V}}_{j}\},
{\mathcal{F}}_{ij}
{\mathcal{F}}_{i}
{\mathcal{F}}_{j}
{\mathcal{F}}(\hat{{\mathcal{V}}},\hat{{\mathcal{E}}})\in{\mathcal{V}}_{M}
{\mathcal{F}}^{*}(\hat{{\mathcal{V}}}^{*},\hat{{\mathcal{E}}}^{*})
\displaystyle\hat{{\mathcal{V}}}^{*}=\hat{{\mathcal{V}}}\cup\{a^{*}|a\in{%
\mathcal{V}},\exists b\in\hat{{\mathcal{V}}},(a,b)\in{\mathcal{E}}\},
\displaystyle\hat{{\mathcal{V}}}^{*}=\hat{{\mathcal{V}}}\cup\{a^{*}|a\in{%
\mathcal{V}},\exists b\in\hat{{\mathcal{V}}},(a,b)\in{\mathcal{E}}\},
\displaystyle\hat{{\mathcal{E}}}^{*}=\{(a,b)\in{\mathcal{E}}|a\in\hat{{%
\mathcal{V}}}^{*},b\in\hat{{\mathcal{V}}}^{*}\},
\displaystyle\hat{{\mathcal{E}}}^{*}=\{(a,b)\in{\mathcal{E}}|a\in\hat{{%
\mathcal{V}}}^{*},b\in\hat{{\mathcal{V}}}^{*}\},
a^{*}
a
*
*
{\mathcal{D}}=\{\text{CC, CN, CNN, CN=O, CC=O}\}
\{\text{CN, CC}\}
\{\text{C, CN}\}
\{\text{CC, N}\}
{\mathcal{C}}_{{\mathcal{G}}}
{\mathcal{G}}
{\mathcal{C}}_{\text{Vocab}}=\cup_{{\mathcal{F}}^{*}\in\text{Vocab}}{\mathcal{%
C}}_{{\mathcal{F}}^{*}}
\mbox{Vocab}=\{{\mathcal{F}}^{*}\}
{\bm{z}}
{\mathcal{G}}
{\mathcal{C}}_{\text{Vocab}}\leftarrow\bigcup_{{\mathcal{F}}^{*}\in\text{Vocab%
}}{\mathcal{C}}_{{\mathcal{F}}^{*}}
P_{{\mathcal{F}}^{*}}
{\mathcal{F}}^{*}\sim P_{{\mathcal{F}}^{*}}
{\mathcal{G}}\leftarrow{\mathcal{F}}^{*}
{\mathcal{Q}}\leftarrow\emptyset
v\in{\mathcal{C}}_{{\mathcal{F}}^{*}}
\mathcal{Q}.put(v)
{\mathcal{Q}}\neq\emptyset
v_{t}\leftarrow\mathcal{Q}.get()
{\mathcal{C}}\leftarrow{\mathcal{C}}_{\text{Vocab}}\cup{\mathcal{C}}_{{%
\mathcal{G}}}\setminus\{v_{t}\}
P_{v}
{\mathcal{C}}
v\sim P_{v}
v\in{\mathcal{C}}_{\text{Vocab}}
v
{\mathcal{F}}^{*}\in\mbox{Vocab}
{\mathcal{G}}\leftarrow{\mathcal{G}}.\mbox{AddMotif}({\mathcal{F}}^{*})
{\mathcal{G}}\leftarrow{\mathcal{G}}.\mbox{Merge}(v_{t},v)
v^{\prime}\in{\mathcal{C}}_{{\mathcal{F}}^{*}}\setminus\{v\}
\mathcal{Q}.put(v^{\prime})
v\in{\mathcal{C}}_{{\mathcal{G}}}\setminus\{v_{t}\}
{\mathcal{G}}\leftarrow{\mathcal{G}}.\mbox{Merge}(v_{t},v)
\mathcal{Q}\leftarrow\mathcal{Q}\setminus\{v\}
{}_{\text{mol}}
{\bm{\mu}}
{\bm{\Sigma}}
{}_{\text{prop}}
{}_{\text{pmol}}
{}_{\text{motif}}
{}_{\text{start}}
{}_{\text{query}}
{}_{\text{key}}
3
256
3
192,16,16,16,16
256
256
{}_{\text{mol}}
{}_{\text{pmol}}
15
{}_{\text{motif}}
6
1000
500
100,000
{\mathcal{B}}
{\mathcal{L}}_{{\mathcal{B}}}=\mathbb{E}_{{\mathcal{G}}\sim{\mathcal{B}}}\left%
[\beta_{prior}\cdot\mathcal{L}_{prior}({\mathcal{G}})+\mathcal{L}_{rec}({%
\mathcal{G}})+\beta_{prop}\cdot\mathcal{L}_{prop}({\mathcal{G}})\right].
{\mathcal{L}}_{rec}
{\mathcal{G}}_{t}
t
{\bm{z}}
\displaystyle{\mathcal{L}}_{rec}({\mathcal{G}})=-\mathbb{E}_{z\sim q(\cdot|{%
\mathcal{G}})}\left[\log p({\mathcal{G}}_{0}|{\bm{z}})+\sum_{t}\log p({%
\mathcal{G}}_{t+1}|{\bm{z}},{\mathcal{G}}_{t})\right]
\displaystyle{\mathcal{L}}_{rec}({\mathcal{G}})
\displaystyle=-\mathbb{E}_{z\sim q(\cdot|{\mathcal{G}})}\left[\log p({\mathcal%
{G}}_{0}|{\bm{z}})+\sum_{t}\log p({\mathcal{G}}_{t+1}|{\bm{z}},{\mathcal{G}}_{%
t})\right]
\displaystyle=-\mathbb{E}_{z\sim q(\cdot|{\mathcal{G}})}\left[\log p({\mathcal%
{F}}^{*}_{0}|{\bm{z}})+\sum_{t}\log p(u_{t}|{\bm{z}},{\mathcal{G}}_{t},v_{t})%
\right],
\displaystyle=-\mathbb{E}_{z\sim q(\cdot|{\mathcal{G}})}\left[\log p({\mathcal%
{F}}^{*}_{0}|{\bm{z}})+\sum_{t}\log p(u_{t}|{\bm{z}},{\mathcal{G}}_{t},v_{t})%
\right],
{\mathcal{F}}^{*}_{0}
v_{t}
u_{t}
t^{\rm th}
\displaystyle\log p({\mathcal{F}}_{0}^{*}|{\bm{z}})\leftarrow\log\frac{\exp(%
\text{NN}_{\text{start}}({\bm{z}})\cdot\text{NN}_{\text{key}}({\bm{h}}_{{%
\mathcal{F}}^{*}_{0}}))}{\sum_{{\mathcal{F}}^{*}\in{\mathcal{I}}_{{\mathcal{F}%
}^{*}}}\exp(\text{NN}_{\text{start}}({\bm{z}})\cdot\text{NN}_{\text{key}}({\bm%
{h}}_{{\mathcal{F}}^{*}}))},
\displaystyle\log p({\mathcal{F}}_{0}^{*}|{\bm{z}})
\displaystyle\leftarrow\log\frac{\exp(\text{NN}_{\text{start}}({\bm{z}})\cdot%
\text{NN}_{\text{key}}({\bm{h}}_{{\mathcal{F}}^{*}_{0}}))}{\sum_{{\mathcal{F}}%
^{*}\in{\mathcal{I}}_{{\mathcal{F}}^{*}}}\exp(\text{NN}_{\text{start}}({\bm{z}%
})\cdot\text{NN}_{\text{key}}({\bm{h}}_{{\mathcal{F}}^{*}}))},
\displaystyle\log p(u_{t}|{\bm{z}},{\mathcal{G}}_{t},v_{t})\leftarrow\log\frac%
{\exp(\text{NN}_{\text{query}}([{\bm{z}},{\bm{h}}_{{\mathcal{G}}_{t}},{\bm{h}}%
_{v_{t}}])\cdot\text{NN}_{\text{key}}({\bm{h}}_{u_{t}}))}{\sum_{v\in{\mathcal{%
I}}_{v}}\exp(\text{NN}_{\text{query}}([{\bm{z}},{\bm{h}}_{{\mathcal{G}}_{t}},{%
\bm{h}}_{v_{t}}])\cdot\text{NN}_{\text{key}}({\bm{h}}_{v}))},
\displaystyle\log p(u_{t}|{\bm{z}},{\mathcal{G}}_{t},v_{t})
\displaystyle\leftarrow\log\frac{\exp(\text{NN}_{\text{query}}([{\bm{z}},{\bm{%
h}}_{{\mathcal{G}}_{t}},{\bm{h}}_{v_{t}}])\cdot\text{NN}_{\text{key}}({\bm{h}}%
_{u_{t}}))}{\sum_{v\in{\mathcal{I}}_{v}}\exp(\text{NN}_{\text{query}}([{\bm{z}%
},{\bm{h}}_{{\mathcal{G}}_{t}},{\bm{h}}_{v_{t}}])\cdot\text{NN}_{\text{key}}({%
\bm{h}}_{v}))},
{\mathcal{I}}_{{\mathcal{F}}^{*}}
{\mathcal{I}}_{v}
{\mathcal{B}}
\beta_{prior}
3,000
400,000
\beta_{prior}
0.4
\beta_{prop}
0.3
99.68\%
98.6\%
98.28\%
325.7
54.4
1000
500
1000
500
100
500
{}_{\text{motif}}
{}_{\text{motif}}
{}_{\text{motif}}
{}_{\text{motif}}
100,000
100,000
1
3
5
500
8.499
1000
8.282
9.667
4096
{}_{\text{motif}}
